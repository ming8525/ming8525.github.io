"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_esri_calcite-components_dist_esm_calcite-tree_2_entry_js"],{

/***/ "./node_modules/@esri/calcite-components/dist/esm/browser-ece29da7.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/browser-ece29da7.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ getUserAgentString)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */
function getUserAgentData() {
  return navigator.userAgentData;
}
function getUserAgentString() {
  const uaData = getUserAgentData();
  return uaData?.brands
    ? uaData.brands.map(({ brand, version }) => `${brand}/${version}`).join(" ")
    : navigator.userAgent;
}



//# sourceMappingURL=browser-ece29da7.js.map

/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/esm/calcite-tree_2.entry.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/calcite-tree_2.entry.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calcite_tree: () => (/* binding */ Tree),
/* harmony export */   calcite_tree_item: () => (/* binding */ TreeItem)
/* harmony export */ });
/* harmony import */ var _index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-86faef9c.js */ "./node_modules/@esri/calcite-components/dist/esm/index-86faef9c.js");
/* harmony import */ var _dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom-ed00a585.js */ "./node_modules/@esri/calcite-components/dist/esm/dom-ed00a585.js");
/* harmony import */ var _conditionalSlot_f6710875_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./conditionalSlot-f6710875.js */ "./node_modules/@esri/calcite-components/dist/esm/conditionalSlot-f6710875.js");
/* harmony import */ var _interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./interactive-cbd8a6dc.js */ "./node_modules/@esri/calcite-components/dist/esm/interactive-cbd8a6dc.js");
/* harmony import */ var _resources_cf82388c_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./resources-cf82388c.js */ "./node_modules/@esri/calcite-components/dist/esm/resources-cf82388c.js");
/* harmony import */ var _component_f94cab72_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./component-f94cab72.js */ "./node_modules/@esri/calcite-components/dist/esm/component-f94cab72.js");
/* harmony import */ var _guid_21fecfa4_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./guid-21fecfa4.js */ "./node_modules/@esri/calcite-components/dist/esm/guid-21fecfa4.js");
/* harmony import */ var _observers_71d332db_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./observers-71d332db.js */ "./node_modules/@esri/calcite-components/dist/esm/observers-71d332db.js");
/* harmony import */ var _browser_ece29da7_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./browser-ece29da7.js */ "./node_modules/@esri/calcite-components/dist/esm/browser-ece29da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */










function isTreeItem(element) {
  return element?.tagName === "CALCITE-TREE-ITEM";
}
function getTraversableItems(root) {
  return Array.from(root.querySelectorAll("calcite-tree-item:not([disabled])")).filter((item) => {
    let currentItem = item;
    while (currentItem !== root && currentItem !== undefined) {
      const parent = currentItem.parentElement;
      const traversable = !isTreeItem(parent) || !parent.hasChildren || parent.expanded;
      if (!traversable) {
        return false;
      }
      currentItem = currentItem.parentElement;
    }
    return true;
  });
}

const treeCss = ":host{display:block}:host(:focus){outline:2px solid transparent;outline-offset:2px}:host([hidden]){display:none}[hidden]{display:none}";

const Tree = class {
  constructor(hostRef) {
    (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteTreeSelect = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteTreeSelect", 6);
    this.keyDownHandler = (event) => {
      if (this.child) {
        return;
      }
      const root = this.el;
      const target = event.target;
      const supportedKeys = ["ArrowRight", "ArrowDown", "ArrowLeft", "ArrowUp", "Home", "End", "Tab"];
      if (!(isTreeItem(target) && this.el.contains(target)) || !supportedKeys.includes(event.key)) {
        return;
      }
      const traversableItems = getTraversableItems(root);
      if (event.key === "Tab") {
        // root tabindex will be restored when blurred/focused
        traversableItems.forEach((item) => (item.tabIndex = -1));
        return;
      }
      if (event.key === "ArrowDown") {
        const currentItemIndex = traversableItems.indexOf(target);
        const nextItem = traversableItems[currentItemIndex + 1];
        nextItem?.focus();
        event.preventDefault();
        return;
      }
      if (event.key === "ArrowUp") {
        const currentItemIndex = traversableItems.indexOf(target);
        const previousItem = traversableItems[currentItemIndex - 1];
        previousItem?.focus();
        event.preventDefault();
        return;
      }
      if (event.key === "ArrowLeft") {
        if (target.hasChildren && target.expanded) {
          target.expanded = false;
          event.preventDefault();
          return;
        }
        const rootToItemPath = traversableItems.slice(0, traversableItems.indexOf(target)).reverse();
        const parentItem = rootToItemPath.find((item) => item.depth === target.depth - 1);
        parentItem?.focus();
        event.preventDefault();
        return;
      }
      if (event.key === "ArrowRight") {
        if (!target.disabled && target.hasChildren) {
          if (!target.expanded) {
            target.expanded = true;
            event.preventDefault();
          }
          else {
            const currentItemIndex = traversableItems.indexOf(target);
            const nextItem = traversableItems[currentItemIndex + 1];
            nextItem?.focus();
            event.preventDefault();
          }
        }
        return;
      }
      if (event.key === "Home") {
        const firstNode = traversableItems.shift();
        if (firstNode) {
          firstNode.focus();
          event.preventDefault();
        }
        return;
      }
      if (event.key === "End") {
        const lastNode = traversableItems.pop();
        if (lastNode) {
          lastNode.focus();
          event.preventDefault();
        }
        return;
      }
    };
    this.lines = false;
    this.child = undefined;
    this.scale = "m";
    this.selectionMode = "single";
    this.selectedItems = [];
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  componentWillRender() {
    const parent = this.el.parentElement?.closest("calcite-tree");
    this.lines = parent ? parent.lines : this.lines;
    this.scale = parent ? parent.scale : this.scale;
    this.selectionMode = parent ? parent.selectionMode : this.selectionMode;
    this.child = !!parent;
  }
  render() {
    return ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.H, { "aria-multiselectable": this.child
        ? undefined
        : (this.selectionMode === "multiple" || this.selectionMode === "multichildren").toString(), onKeyDown: this.keyDownHandler, role: !this.child ? "tree" : undefined, tabIndex: this.getRootTabIndex() }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", null)));
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  onFocus() {
    if (!this.child) {
      const focusTarget = this.el.querySelector("calcite-tree-item[selected]:not([disabled])") || this.el.querySelector("calcite-tree-item:not([disabled])");
      (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.d)(focusTarget);
    }
  }
  onFocusIn(event) {
    const focusedFromRootOrOutsideTree = event.relatedTarget === this.el || !this.el.contains(event.relatedTarget);
    if (focusedFromRootOrOutsideTree) {
      // gives user the ability to tab into external elements (modifying tabindex property will not work in firefox)
      this.el.removeAttribute("tabindex");
    }
  }
  onFocusOut(event) {
    const willFocusOutsideTree = !this.el.contains(event.relatedTarget);
    if (willFocusOutsideTree) {
      this.el.tabIndex = this.getRootTabIndex();
    }
  }
  onInternalTreeItemSelect(event) {
    if (this.child) {
      return;
    }
    const target = event.target;
    const childItems = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.z)(target.querySelectorAll("calcite-tree-item"));
    event.preventDefault();
    event.stopPropagation();
    if (this.selectionMode === "ancestors") {
      this.updateAncestorTree(event);
      return;
    }
    const isNoneSelectionMode = this.selectionMode === "none";
    const shouldSelect = this.selectionMode !== null &&
      (!target.hasChildren ||
        (target.hasChildren &&
          (this.selectionMode === "children" || this.selectionMode === "multichildren")));
    const shouldDeselectAllChildren = this.selectionMode === "multichildren" && target.hasChildren;
    const shouldModifyToCurrentSelection = !isNoneSelectionMode &&
      event.detail.modifyCurrentSelection &&
      (this.selectionMode === "multiple" || this.selectionMode === "multichildren");
    const shouldClearCurrentSelection = !shouldModifyToCurrentSelection &&
      (((this.selectionMode === "single" || this.selectionMode === "multiple") &&
        childItems.length <= 0) ||
        this.selectionMode === "children" ||
        this.selectionMode === "multichildren");
    const shouldUpdateExpand = ["multiple", "none", "single", "single-persist"].includes(this.selectionMode) &&
      target.hasChildren;
    const targetItems = [];
    if (shouldSelect) {
      targetItems.push(target);
    }
    if (shouldClearCurrentSelection) {
      const selectedItems = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.z)(this.el.querySelectorAll("calcite-tree-item[selected]"));
      selectedItems.forEach((treeItem) => {
        if (!targetItems.includes(treeItem)) {
          treeItem.selected = false;
        }
      });
    }
    if (shouldUpdateExpand &&
      ["multiple", "none", "single", "single-persist"].includes(this.selectionMode)) {
      target.expanded = !target.expanded;
    }
    if (shouldDeselectAllChildren) {
      childItems.forEach((item) => {
        item.selected = false;
        if (item.hasChildren) {
          item.expanded = false;
        }
      });
    }
    if (shouldModifyToCurrentSelection) {
      window.getSelection().removeAllRanges();
    }
    if (shouldModifyToCurrentSelection && target.selected) {
      targetItems.forEach((treeItem) => {
        if (!treeItem.disabled) {
          treeItem.selected = false;
        }
      });
    }
    else if (!isNoneSelectionMode) {
      targetItems.forEach((treeItem) => {
        if (!treeItem.disabled) {
          treeItem.selected = true;
        }
      });
    }
    this.selectedItems = isNoneSelectionMode
      ? []
      : (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.z)(this.el.querySelectorAll("calcite-tree-item")).filter((i) => i.selected);
    this.calciteTreeSelect.emit();
    event.stopPropagation();
  }
  updateAncestorTree(event) {
    const item = event.target;
    const updateItem = event.detail.updateItem;
    if (item.disabled || (item.indeterminate && !updateItem)) {
      return;
    }
    const ancestors = [];
    let parent = item.parentElement.closest("calcite-tree-item");
    while (parent) {
      ancestors.push(parent);
      parent = parent.parentElement.closest("calcite-tree-item");
    }
    const childItems = Array.from(item.querySelectorAll("calcite-tree-item:not([disabled])"));
    const childItemsWithNoChildren = childItems.filter((child) => !child.hasChildren);
    const childItemsWithChildren = childItems.filter((child) => child.hasChildren);
    let futureSelected;
    if (updateItem) {
      futureSelected = item.hasChildren ? !(item.selected || item.indeterminate) : !item.selected;
    }
    else {
      futureSelected = item.selected;
    }
    childItemsWithNoChildren.forEach((el) => {
      el.selected = futureSelected;
      el.indeterminate = false;
    });
    function updateItemState(childItems, item) {
      const selected = childItems.filter((child) => child.selected);
      const unselected = childItems.filter((child) => !child.selected);
      item.selected = selected.length === childItems.length;
      item.indeterminate = selected.length > 0 && unselected.length > 0;
    }
    childItemsWithChildren.reverse().forEach((el) => {
      const directChildItems = Array.from(el.querySelectorAll(":scope > calcite-tree > calcite-tree-item"));
      updateItemState(directChildItems, el);
    });
    if (updateItem) {
      if (item.hasChildren) {
        updateItemState(childItems, item);
      }
      else {
        item.selected = futureSelected;
        item.indeterminate = false;
      }
    }
    ancestors.forEach((ancestor) => {
      const descendants = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.z)(ancestor.querySelectorAll("calcite-tree-item"));
      const activeDescendants = descendants.filter((el) => el.selected);
      if (activeDescendants.length === 0) {
        ancestor.selected = false;
        ancestor.indeterminate = false;
        return;
      }
      const indeterminate = activeDescendants.length < descendants.length;
      ancestor.indeterminate = indeterminate;
      ancestor.selected = !indeterminate;
    });
    this.selectedItems = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.z)(this.el.querySelectorAll("calcite-tree-item")).filter((i) => i.selected);
    if (updateItem) {
      this.calciteTreeSelect.emit();
    }
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  getRootTabIndex() {
    return !this.child ? 0 : -1;
  }
  get el() { return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
};
Tree.style = treeCss;

const CSS = {
  actionsEnd: "actions-end",
  checkboxLabel: "checkbox-label",
  checkbox: "checkbox",
  chevron: "chevron",
  nodeContainer: "node-container",
  childrenContainer: "children-container",
  bulletPointIcon: "bullet-point",
  checkmarkIcon: "checkmark",
  itemExpanded: "item--expanded",
  iconStart: "icon-start",
  nodeAndActionsContainer: "node-actions-container",
};
const SLOTS = {
  actionsEnd: "actions-end",
  children: "children",
};
const ICONS = {
  bulletPoint: "bullet-point",
  checkmark: "check",
  chevronRight: "chevron-right",
  blank: "blank",
};

const treeItemCss = ":host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block;max-inline-size:100%;cursor:pointer;color:var(--calcite-color-text-3)}.node-actions-container{display:flex}:host([calcite-hydrated-hidden]){visibility:hidden !important;pointer-events:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([scale=s]){font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) .node-actions-container{min-block-size:1.5rem}:host([scale=s]) .node-actions-container .node-container .checkbox,:host([scale=s]) .node-actions-container .node-container .chevron,:host([scale=s]) .node-actions-container .node-container .checkmark,:host([scale=s]) .node-actions-container .node-container .bullet-point{margin-inline:0.25rem}:host([scale=s]) .node-actions-container .node-container .icon-start{margin-inline:0.75rem}:host([scale=m]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) .node-actions-container{min-block-size:2rem}:host([scale=m]) .node-actions-container .node-container .checkbox,:host([scale=m]) .node-actions-container .node-container .chevron,:host([scale=m]) .node-actions-container .node-container .checkmark,:host([scale=m]) .node-actions-container .node-container .bullet-point{margin-inline:0.5rem}:host([scale=m]) .node-actions-container .node-container .icon-start{margin-inline:0.75rem}:host([scale=l]){font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .node-actions-container{min-block-size:2.75rem}:host([scale=l]) .node-actions-container .node-container .checkbox,:host([scale=l]) .node-actions-container .node-container .chevron,:host([scale=l]) .node-actions-container .node-container .checkmark,:host([scale=l]) .node-actions-container .node-container .bullet-point{margin-inline:0.75rem}:host([scale=l]) .node-actions-container .node-container .icon-start{margin-inline:0.75rem}:host([lines]) .children-container:after{position:absolute;inset-block-start:0px;z-index:var(--calcite-z-index);inline-size:1px;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;block-size:96%;content:\"\";background-color:var(--calcite-color-border-2)}:host(:not([lines])) .node-container:after{display:none}::slotted(*){min-inline-size:0px;max-inline-size:100%;overflow-wrap:break-word;color:inherit;text-decoration:none !important}::slotted(*):hover{text-decoration:none !important}::slotted(a){inline-size:100%;text-decoration-line:none}:host{outline:2px solid transparent;outline-offset:2px}:host .node-container{outline-color:transparent}:host:focus .node-container,:host:active .node-container{outline:2px solid var(--calcite-color-brand);outline-offset:calc(\n            -2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-offset-invert-focus),\n                1\n              )\n            )\n          )}:host(:focus:not([disabled])) .node-container{outline:2px solid transparent;outline-offset:2px;outline:2px solid var(--calcite-color-brand);outline-offset:calc(\n            -2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-offset-invert-focus),\n                1\n              )\n            )\n          )}.actions-end{display:flex;flex-direction:row;align-items:center;align-self:stretch}.checkbox{line-height:0}.checkbox-label{pointer-events:none;display:flex;align-items:center}.checkbox:focus{outline:2px solid transparent;outline-offset:2px}.children-container{position:relative;block-size:0px;transform-origin:top;overflow:hidden;opacity:0;margin-inline-start:1.25rem;transform:scaleY(0);transition:var(--calcite-animation-timing) cubic-bezier(0.215, 0.44, 0.42, 0.88), opacity var(--calcite-animation-timing) cubic-bezier(0.215, 0.44, 0.42, 0.88), all var(--calcite-animation-timing) ease-in-out}.item--expanded>.children-container{overflow:visible;opacity:1;transform:none;block-size:auto}.node-container{position:relative;display:flex;min-inline-size:0px;flex-grow:1;align-items:center}.node-container .checkmark,.node-container .bullet-point{opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;color:var(--calcite-color-border-1)}.node-container:hover .checkmark,.node-container:hover .bullet-point,:host([selected]) .node-container:hover .checkmark,:host([selected]) .node-container:hover .bullet-point,:host(:focus:not([disabled])) .node-container .checkmark,:host(:focus:not([disabled])) .node-container .bullet-point{opacity:1}:host([selected]) .node-container,:host([selected]) .node-container:hover{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-text-1)}:host([selected]) .node-container .bullet-point,:host([selected]) .node-container .checkmark,:host([selected]) .node-container:hover .bullet-point,:host([selected]) .node-container:hover .checkmark{opacity:1;color:var(--calcite-color-brand)}:host([selection-mode=none]:not([has-children])):host([scale=s]) .node-container{padding-inline-start:0.5rem}:host([selection-mode=none]:not([has-children])):host([scale=m]) .node-container{padding-inline-start:1rem}:host([selection-mode=none]:not([has-children])):host([scale=l]) .node-container{padding-inline-start:1.5rem}:host(:not([has-children])):host([scale=s]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.25rem}:host(:not([has-children])):host([scale=m]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.5rem}:host(:not([has-children])):host([scale=l]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.75rem}:host([has-children]) .node-container[data-selection-mode=ancestors] .checkbox{margin-inline-start:0}:host([has-children]) .node-container .bullet-point,:host([has-children]) .node-container .checkmark{display:none}.chevron{position:relative;align-self:center;color:var(--calcite-color-text-3);transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;flex:0 0 auto;transform:rotate(0deg)}.calcite--rtl .chevron{transform:rotate(180deg)}.item--expanded .node-container>.chevron{transform:rotate(90deg)}:host([selected]) .checkmark,:host([selected]) .bullet-point{color:var(--calcite-color-brand)}:host([hidden]){display:none}[hidden]{display:none}";

const TreeItem = class {
  constructor(hostRef) {
    (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteInternalTreeItemSelect = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteInternalTreeItemSelect", 6);
    this.iconClickHandler = (event) => {
      event.stopPropagation();
      this.expanded = !this.expanded;
    };
    this.childrenClickHandler = (event) => event.stopPropagation();
    this.userChangedValue = false;
    this.updateParentIsExpanded = (el, expanded) => {
      const items = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.e)(el, SLOTS.children, {
        all: true,
        selector: "calcite-tree-item",
      });
      items.forEach((item) => (item.parentExpanded = expanded));
    };
    this.actionsEndSlotChangeHandler = (event) => {
      this.hasEndActions = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.b)(event);
    };
    this.disabled = false;
    this.expanded = false;
    this.iconFlipRtl = undefined;
    this.iconStart = undefined;
    this.selected = false;
    this.parentExpanded = false;
    this.depth = -1;
    this.hasChildren = null;
    this.lines = undefined;
    this.scale = undefined;
    this.indeterminate = false;
    this.selectionMode = undefined;
    this.hasEndActions = false;
    this.updateAfterInitialRender = false;
  }
  expandedHandler(newValue) {
    this.updateParentIsExpanded(this.el, newValue);
  }
  handleSelectedChange(value) {
    if (this.selectionMode === "ancestors" && !this.userChangedValue) {
      if (value) {
        this.indeterminate = false;
      }
      this.calciteInternalTreeItemSelect.emit({
        modifyCurrentSelection: true,
        updateItem: false,
      });
    }
  }
  getSelectionMode() {
    this.isSelectionMultiLike =
      this.selectionMode === "multiple" || this.selectionMode === "multichildren";
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  connectedCallback() {
    this.parentTreeItem = this.el.parentElement?.closest("calcite-tree-item");
    if (this.parentTreeItem) {
      const { expanded } = this.parentTreeItem;
      this.updateParentIsExpanded(this.parentTreeItem, expanded);
    }
    (0,_conditionalSlot_f6710875_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    (0,_interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
  }
  disconnectedCallback() {
    (0,_conditionalSlot_f6710875_js__WEBPACK_IMPORTED_MODULE_2__.d)(this);
    (0,_interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
  }
  componentWillRender() {
    this.hasChildren = !!this.el.querySelector("calcite-tree");
    this.depth = 0;
    let parentTree = this.el.closest("calcite-tree");
    if (!parentTree) {
      return;
    }
    this.selectionMode = parentTree.selectionMode;
    this.scale = parentTree.scale || "m";
    this.lines = parentTree.lines;
    let nextParentTree;
    while (parentTree) {
      nextParentTree = parentTree.parentElement?.closest("calcite-tree");
      if (nextParentTree === parentTree) {
        break;
      }
      else {
        parentTree = nextParentTree;
        this.depth = this.depth + 1;
      }
    }
  }
  componentWillLoad() {
    requestAnimationFrame(() => (this.updateAfterInitialRender = true));
  }
  componentDidLoad() {
    this.updateAncestorTree();
  }
  componentDidRender() {
    (0,_interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_3__.u)(this, () => false // programmatically focusable
    );
  }
  render() {
    const rtl = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.g)(this.el) === "rtl";
    const showBulletPoint = this.selectionMode === "single" || this.selectionMode === "children";
    const showCheckmark = this.selectionMode === "multiple" || this.selectionMode === "multichildren";
    const showBlank = this.selectionMode === "none" && !this.hasChildren;
    const chevron = this.hasChildren ? ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { class: {
        [CSS.chevron]: true,
        [_resources_cf82388c_js__WEBPACK_IMPORTED_MODULE_4__.C.rtl]: rtl,
      }, "data-test-id": "icon", icon: ICONS.chevronRight, onClick: this.iconClickHandler, scale: (0,_component_f94cab72_js__WEBPACK_IMPORTED_MODULE_5__.g)(this.scale) })) : null;
    const defaultSlotNode = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { key: "default-slot" });
    const checkbox = this.selectionMode === "ancestors" ? ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("label", { class: CSS.checkboxLabel, key: "checkbox-label" }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-checkbox", { checked: this.selected, class: CSS.checkbox, "data-test-id": "checkbox", indeterminate: this.hasChildren && this.indeterminate, scale: this.scale, tabIndex: -1 }), defaultSlotNode)) : null;
    const selectedIcon = showBulletPoint
      ? ICONS.bulletPoint
      : showCheckmark
        ? ICONS.checkmark
        : showBlank
          ? ICONS.blank
          : null;
    const itemIndicator = selectedIcon ? ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { class: {
        [CSS.bulletPointIcon]: selectedIcon === ICONS.bulletPoint,
        [CSS.checkmarkIcon]: selectedIcon === ICONS.checkmark,
        [_resources_cf82388c_js__WEBPACK_IMPORTED_MODULE_4__.C.rtl]: rtl,
      }, icon: selectedIcon, scale: (0,_component_f94cab72_js__WEBPACK_IMPORTED_MODULE_5__.g)(this.scale) })) : null;
    const hidden = !(this.parentExpanded || this.depth === 1);
    const isExpanded = this.updateAfterInitialRender && this.expanded;
    const { hasEndActions } = this;
    const slotNode = ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { key: "actionsEndSlot", name: SLOTS.actionsEnd, onSlotchange: this.actionsEndSlotChangeHandler }));
    const iconStartEl = ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { class: CSS.iconStart, flipRtl: this.iconFlipRtl === "start" || this.iconFlipRtl === "both", icon: this.iconStart, scale: (0,_component_f94cab72_js__WEBPACK_IMPORTED_MODULE_5__.g)(this.scale) }));
    return ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.H, { "aria-expanded": this.hasChildren ? (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.t)(isExpanded) : undefined, "aria-hidden": (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.t)(hidden), "aria-selected": this.selected ? "true" : showCheckmark ? "false" : undefined, "calcite-hydrated-hidden": hidden, role: "treeitem" }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: { [CSS.itemExpanded]: isExpanded } }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: CSS.nodeAndActionsContainer }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
        [CSS.nodeContainer]: true,
        [_resources_cf82388c_js__WEBPACK_IMPORTED_MODULE_4__.C.rtl]: rtl,
      }, "data-selection-mode": this.selectionMode,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: (el) => (this.defaultSlotWrapper = el) }, chevron, itemIndicator, this.iconStart ? iconStartEl : null, checkbox ? checkbox : defaultSlotNode), (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: CSS.actionsEnd, hidden: !hasEndActions, ref: (el) => (this.actionSlotWrapper = el) }, slotNode)), (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
        [CSS.childrenContainer]: true,
        [_resources_cf82388c_js__WEBPACK_IMPORTED_MODULE_4__.C.rtl]: rtl,
      }, "data-test-id": "calcite-tree-children", onClick: this.childrenClickHandler, role: this.hasChildren ? "group" : undefined }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: SLOTS.children })))));
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  onClick(event) {
    if (this.disabled || this.isActionEndEvent(event)) {
      return;
    }
    // Solve for if the item is clicked somewhere outside the slotted anchor.
    // Anchor is triggered anywhere you click
    const [link] = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_1__.A)(this.el, "a");
    if (link && event.composedPath()[0].tagName.toLowerCase() !== "a") {
      const target = link.target === "" ? "_self" : link.target;
      window.open(link.href, target);
    }
    this.calciteInternalTreeItemSelect.emit({
      modifyCurrentSelection: this.selectionMode === "ancestors" || this.isSelectionMultiLike,
      updateItem: true,
    });
    this.userChangedValue = true;
  }
  keyDownHandler(event) {
    if (this.isActionEndEvent(event) || event.defaultPrevented) {
      return;
    }
    switch (event.key) {
      case " ":
        this.userChangedValue = true;
        this.calciteInternalTreeItemSelect.emit({
          modifyCurrentSelection: this.isSelectionMultiLike,
          updateItem: true,
        });
        event.preventDefault();
        break;
      case "Enter":
        // activates a node, i.e., performs its default action. For parent nodes, one possible default action is to open or close the node. In single-select trees where selection does not follow focus (see note below), the default action is typically to select the focused node.
        const link = Array.from(this.el.children).find((el) => el.matches("a"));
        this.userChangedValue = true;
        if (link) {
          link.click();
          this.selected = true;
        }
        else {
          this.calciteInternalTreeItemSelect.emit({
            modifyCurrentSelection: this.isSelectionMultiLike,
            updateItem: true,
          });
        }
        event.preventDefault();
    }
  }
  //--------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  isActionEndEvent(event) {
    const composedPath = event.composedPath();
    return composedPath.includes(this.actionSlotWrapper);
  }
  /**
   * This is meant to be called in `componentDidLoad` in order to take advantage of the hierarchical component lifecycle
   * and help check for item selection as items are initialized
   *
   * @private
   */
  updateAncestorTree() {
    const parentItem = this.parentTreeItem;
    if (this.selectionMode !== "ancestors" || !parentItem) {
      return;
    }
    if (this.selected) {
      const parentTree = this.el.parentElement;
      const siblings = Array.from(parentTree?.children);
      const selectedSiblings = siblings.filter((child) => child.selected);
      if (siblings.length === selectedSiblings.length) {
        parentItem.selected = true;
        parentItem.indeterminate = false;
      }
      else if (selectedSiblings.length > 0) {
        parentItem.indeterminate = true;
      }
      const childItems = Array.from(this.el.querySelectorAll("calcite-tree-item:not([disabled])"));
      childItems.forEach((item) => {
        item.selected = true;
        item.indeterminate = false;
      });
    }
    else if (this.indeterminate) {
      const parentItem = this.parentTreeItem;
      parentItem.indeterminate = true;
    }
  }
  get el() { return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
  static get watchers() { return {
    "expanded": ["expandedHandler"],
    "selected": ["handleSelectedChange"],
    "selectionMode": ["getSelectionMode"]
  }; }
};
TreeItem.style = treeItemCss;



//# sourceMappingURL=calcite-tree_2.entry.js.map

/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/esm/component-f94cab72.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/component-f94cab72.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ componentOnReady),
/* harmony export */   g: () => (/* binding */ getIconScale)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */
function getIconScale(componentScale) {
  return componentScale === "l" ? "m" : "s";
}
/**
 * This util helps us wait for a component to be ready for both lazy-loading (`dist` output) and non-lazy-loading (`components` output) components.
 *
 * Based on https://github.com/ionic-team/ionic-framework/blob/1a8bd6d/core/src/utils/helpers.ts#L60C1-L79C3
 *
 * @param el - the host element to wait for
 */
async function componentOnReady(el) {
  await (isStencilEl(el)
    ? el.componentOnReady()
    : new Promise((resolve) => requestAnimationFrame(() => resolve())));
}
function isStencilEl(el) {
  return typeof el.componentOnReady === "function";
}



//# sourceMappingURL=component-f94cab72.js.map

/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/esm/conditionalSlot-f6710875.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/conditionalSlot-f6710875.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ connectConditionalSlotComponent),
/* harmony export */   d: () => (/* binding */ disconnectConditionalSlotComponent)
/* harmony export */ });
/* harmony import */ var _index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-86faef9c.js */ "./node_modules/@esri/calcite-components/dist/esm/index-86faef9c.js");
/* harmony import */ var _observers_71d332db_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observers-71d332db.js */ "./node_modules/@esri/calcite-components/dist/esm/observers-71d332db.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */



const observed = new Set();
let mutationObserver;
const observerOptions = { childList: true };
/**
 * Helper to set up a conditional slot component on connectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function connectConditionalSlotComponent(component) {
  if (!mutationObserver) {
    mutationObserver = (0,_observers_71d332db_js__WEBPACK_IMPORTED_MODULE_1__.c)("mutation", processMutations);
  }
  mutationObserver.observe(component.el, observerOptions);
}
/**
 * Helper to tear down a conditional slot component on disconnectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function disconnectConditionalSlotComponent(component) {
  observed.delete(component.el);
  // we explicitly process queued mutations and disconnect and reconnect
  // the observer until MutationObserver gets an `unobserve` method
  // see https://github.com/whatwg/dom/issues/126
  processMutations(mutationObserver.takeRecords());
  mutationObserver.disconnect();
  for (const [element] of observed.entries()) {
    mutationObserver.observe(element, observerOptions);
  }
}
function processMutations(mutations) {
  mutations.forEach(({ target }) => {
    (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.f)(target);
  });
}



//# sourceMappingURL=conditionalSlot-f6710875.js.map

/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/esm/interactive-cbd8a6dc.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/interactive-cbd8a6dc.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ connectInteractive),
/* harmony export */   d: () => (/* binding */ disconnectInteractive),
/* harmony export */   u: () => (/* binding */ updateHostInteraction)
/* harmony export */ });
/* harmony import */ var _browser_ece29da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./browser-ece29da7.js */ "./node_modules/@esri/calcite-components/dist/esm/browser-ece29da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */


// ⚠️ browser-sniffing is not a best practice and should be avoided ⚠️
const isFirefox = /firefox/i.test((0,_browser_ece29da7_js__WEBPACK_IMPORTED_MODULE_0__.g)());
const interactiveElementToParent = isFirefox
  ? new WeakMap()
  : null;
function interceptedClick() {
  const { disabled } = this;
  if (!disabled) {
    HTMLElement.prototype.click.call(this);
  }
}
function onPointerDown(event) {
  const interactiveElement = event.target;
  if (isFirefox && !interactiveElementToParent.get(interactiveElement)) {
    return;
  }
  const { disabled } = interactiveElement;
  if (disabled) {
    // prevent click from moving focus on host
    event.preventDefault();
  }
}
const nonBubblingWhenDisabledMouseEvents = ["mousedown", "mouseup", "click"];
function onNonBubblingWhenDisabledMouseEvent(event) {
  if (isFirefox && !interactiveElementToParent.get(event.target)) {
    return;
  }
  const { disabled } = event.target;
  // prevent disallowed mouse events from being emitted on the disabled host (per https://github.com/whatwg/html/issues/5886)
  //⚠ we generally avoid stopping propagation of events, but this is needed to adhere to the intended spec changes above ⚠
  if (disabled) {
    event.stopImmediatePropagation();
    event.preventDefault();
  }
}
const captureOnlyOptions = { capture: true };
/**
 * This helper updates the host element to prevent keyboard interaction on its subtree and sets the appropriate aria attribute for accessibility.
 *
 * This should be used in the `componentDidRender` lifecycle hook.
 *
 * **Notes**
 *
 * this util is not needed for simple components whose root element or elements are an interactive component (custom element or native control). For those cases, set the `disabled` props on the root components instead.
 * technically, users can override `tabindex` and restore keyboard navigation, but this will be considered user error
 *
 * @param component
 * @param hostIsTabbable – when set to true or its predicate returns true, the host is tabbable and will be managed by the helper. Set to "managed" for cases where a component's parent determines which item is tabbable (i.e., sets `tabindex` to allow tabbing).
 */
function updateHostInteraction(component, hostIsTabbable = false) {
  if (component.disabled) {
    component.el.setAttribute("tabindex", "-1");
    component.el.setAttribute("aria-disabled", "true");
    if (component.el.contains(document.activeElement)) {
      document.activeElement.blur();
    }
    blockInteraction(component);
    return;
  }
  restoreInteraction(component);
  if (typeof hostIsTabbable === "function") {
    component.el.setAttribute("tabindex", hostIsTabbable.call(component) ? "0" : "-1");
  }
  else if (hostIsTabbable === true) {
    component.el.setAttribute("tabindex", "0");
  }
  else if (hostIsTabbable === false) {
    component.el.removeAttribute("tabindex");
  }
  else ;
  component.el.removeAttribute("aria-disabled");
}
function blockInteraction(component) {
  component.el.click = interceptedClick;
  addInteractionListeners(isFirefox ? getParentElement(component) : component.el);
}
function addInteractionListeners(element) {
  if (!element) {
    // this path is only applicable to Firefox
    return;
  }
  element.addEventListener("pointerdown", onPointerDown, captureOnlyOptions);
  nonBubblingWhenDisabledMouseEvents.forEach((event) => element.addEventListener(event, onNonBubblingWhenDisabledMouseEvent, captureOnlyOptions));
}
function getParentElement(component) {
  return interactiveElementToParent.get(component.el);
}
function restoreInteraction(component) {
  delete component.el.click; // fallback on HTMLElement.prototype.click
  removeInteractionListeners(isFirefox ? getParentElement(component) : component.el);
}
function removeInteractionListeners(element) {
  if (!element) {
    // this path is only applicable to Firefox
    return;
  }
  element.removeEventListener("pointerdown", onPointerDown, captureOnlyOptions);
  nonBubblingWhenDisabledMouseEvents.forEach((event) => element.removeEventListener(event, onNonBubblingWhenDisabledMouseEvent, captureOnlyOptions));
}
/**
 * This utility helps disable components consistently in Firefox.
 *
 * It needs to be called in `connectedCallback` and is only needed for Firefox as it does not call capture event listeners before non-capture ones (see https://bugzilla.mozilla.org/show_bug.cgi?id=1731504).
 *
 * @param component
 */
function connectInteractive(component) {
  if (!component.disabled || !isFirefox) {
    return;
  }
  const parent = component.el.parentElement || component.el; /* assume element is host if it has no parent when connected */
  interactiveElementToParent.set(component.el, parent);
  blockInteraction(component);
}
/**
 * This utility restores interactivity to disabled components consistently in Firefox.
 *
 * It needs to be called in `disconnectedCallback` and is only needed for Firefox as it does not call capture event listeners before non-capture ones (see https://bugzilla.mozilla.org/show_bug.cgi?id=1731504).
 *
 * @param component
 */
function disconnectInteractive(component) {
  if (!isFirefox) {
    return;
  }
  // always remove on disconnect as render or connect will restore it
  interactiveElementToParent.delete(component.el);
  restoreInteraction(component);
}



//# sourceMappingURL=interactive-cbd8a6dc.js.map

/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/esm/observers-71d332db.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/observers-71d332db.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createObserver)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */
/**
 * This utility ensures observers are created only for browser contexts.
 *
 * @param type - the type of observer to create
 * @param callback - the observer callback
 * @param options - the observer options
 */
function createObserver(type, callback, options) {
  const Observer = getObserver(type);
  return new Observer(callback, options);
}
function getObserver(type) {
  // based on https://github.com/whatwg/dom/issues/126#issuecomment-1049814948
  class ExtendedMutationObserver extends window.MutationObserver {
    constructor(callback) {
      super(callback);
      this.observedEntry = [];
      this.callback = callback;
    }
    observe(target, options) {
      this.observedEntry.push({ target, options });
      return super.observe(target, options);
    }
    unobserve(target) {
      const newObservedEntries = this.observedEntry.filter((observed) => observed.target !== target);
      this.observedEntry = [];
      this.callback(super.takeRecords(), this);
      this.disconnect();
      newObservedEntries.forEach((observed) => this.observe(observed.target, observed.options));
    }
  }
  return (function () {
    return (type === "intersection"
      ? window.IntersectionObserver
      : type === "mutation"
        ? ExtendedMutationObserver
        : window.ResizeObserver);
  })();
}



//# sourceMappingURL=observers-71d332db.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsY2l0ZS1jb21wb25lbnRzL2NodW5rcy92ZW5kb3JzLW5vZGVfbW9kdWxlc19lc3JpX2NhbGNpdGUtY29tcG9uZW50c19kaXN0X2VzbV9jYWxjaXRlLXRyZWVfMl9lbnRyeV9qcy5idW5kbGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsZ0JBQWdCLFFBQVEsTUFBTSxHQUFHLFFBQVE7QUFDcEU7QUFDQTs7QUFFbUM7O0FBRW5DOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUM2RztBQUNzRjtBQUNyRTtBQUNGO0FBQ2pFO0FBQ0M7QUFDaEM7QUFDSztBQUNGOztBQUUvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUEsdUJBQXVCLGNBQWMsY0FBYyw4QkFBOEIsbUJBQW1CLGdCQUFnQixhQUFhLFNBQVMsYUFBYTs7QUFFdko7QUFDQTtBQUNBLElBQUkscURBQWdCO0FBQ3BCLDZCQUE2QixxREFBVztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTJGOztBQUUzRjs7Ozs7Ozs7Ozs7Ozs7QUMzSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsaUJBQWlCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUUrQjs7QUFFL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2VzbS9icm93c2VyLWVjZTI5ZGE3LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvZXNtL2NhbGNpdGUtdHJlZV8yLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvZXNtL2NvbXBvbmVudC1mOTRjYWI3Mi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vbm9kZV9tb2R1bGVzL0Blc3JpL2NhbGNpdGUtY29tcG9uZW50cy9kaXN0L2VzbS9jb25kaXRpb25hbFNsb3QtZjY3MTA4NzUuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9lc20vaW50ZXJhY3RpdmUtY2JkOGE2ZGMuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9lc20vb2JzZXJ2ZXJzLTcxZDMzMmRiLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2Mi4wLjBcbiAqL1xuZnVuY3Rpb24gZ2V0VXNlckFnZW50RGF0YSgpIHtcbiAgcmV0dXJuIG5hdmlnYXRvci51c2VyQWdlbnREYXRhO1xufVxuZnVuY3Rpb24gZ2V0VXNlckFnZW50U3RyaW5nKCkge1xuICBjb25zdCB1YURhdGEgPSBnZXRVc2VyQWdlbnREYXRhKCk7XG4gIHJldHVybiB1YURhdGE/LmJyYW5kc1xuICAgID8gdWFEYXRhLmJyYW5kcy5tYXAoKHsgYnJhbmQsIHZlcnNpb24gfSkgPT4gYCR7YnJhbmR9LyR7dmVyc2lvbn1gKS5qb2luKFwiIFwiKVxuICAgIDogbmF2aWdhdG9yLnVzZXJBZ2VudDtcbn1cblxuZXhwb3J0IHsgZ2V0VXNlckFnZW50U3RyaW5nIGFzIGcgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YnJvd3Nlci1lY2UyOWRhNy5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvbWFpbi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjIuMC4wXG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgSCBhcyBIb3N0LCBnIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LTg2ZmFlZjljLmpzJztcbmltcG9ydCB7IGQgYXMgZm9jdXNFbGVtZW50LCB6IGFzIG5vZGVMaXN0VG9BcnJheSwgZSBhcyBnZXRTbG90dGVkLCBiIGFzIHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQsIGcgYXMgZ2V0RWxlbWVudERpciwgdCBhcyB0b0FyaWFCb29sZWFuLCBBIGFzIGZpbHRlckRpcmVjdENoaWxkcmVuIH0gZnJvbSAnLi9kb20tZWQwMGE1ODUuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50LCBkIGFzIGRpc2Nvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQgfSBmcm9tICcuL2NvbmRpdGlvbmFsU2xvdC1mNjcxMDg3NS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RJbnRlcmFjdGl2ZSwgZCBhcyBkaXNjb25uZWN0SW50ZXJhY3RpdmUsIHUgYXMgdXBkYXRlSG9zdEludGVyYWN0aW9uIH0gZnJvbSAnLi9pbnRlcmFjdGl2ZS1jYmQ4YTZkYy5qcyc7XG5pbXBvcnQgeyBDIGFzIENTU19VVElMSVRZIH0gZnJvbSAnLi9yZXNvdXJjZXMtY2Y4MjM4OGMuanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRJY29uU2NhbGUgfSBmcm9tICcuL2NvbXBvbmVudC1mOTRjYWI3Mi5qcyc7XG5pbXBvcnQgJy4vZ3VpZC0yMWZlY2ZhNC5qcyc7XG5pbXBvcnQgJy4vb2JzZXJ2ZXJzLTcxZDMzMmRiLmpzJztcbmltcG9ydCAnLi9icm93c2VyLWVjZTI5ZGE3LmpzJztcblxuZnVuY3Rpb24gaXNUcmVlSXRlbShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50Py50YWdOYW1lID09PSBcIkNBTENJVEUtVFJFRS1JVEVNXCI7XG59XG5mdW5jdGlvbiBnZXRUcmF2ZXJzYWJsZUl0ZW1zKHJvb3QpIHtcbiAgcmV0dXJuIEFycmF5LmZyb20ocm9vdC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS10cmVlLWl0ZW06bm90KFtkaXNhYmxlZF0pXCIpKS5maWx0ZXIoKGl0ZW0pID0+IHtcbiAgICBsZXQgY3VycmVudEl0ZW0gPSBpdGVtO1xuICAgIHdoaWxlIChjdXJyZW50SXRlbSAhPT0gcm9vdCAmJiBjdXJyZW50SXRlbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBwYXJlbnQgPSBjdXJyZW50SXRlbS5wYXJlbnRFbGVtZW50O1xuICAgICAgY29uc3QgdHJhdmVyc2FibGUgPSAhaXNUcmVlSXRlbShwYXJlbnQpIHx8ICFwYXJlbnQuaGFzQ2hpbGRyZW4gfHwgcGFyZW50LmV4cGFuZGVkO1xuICAgICAgaWYgKCF0cmF2ZXJzYWJsZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjdXJyZW50SXRlbSA9IGN1cnJlbnRJdGVtLnBhcmVudEVsZW1lbnQ7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9KTtcbn1cblxuY29uc3QgdHJlZUNzcyA9IFwiOmhvc3R7ZGlzcGxheTpibG9ja306aG9zdCg6Zm9jdXMpe291dGxpbmU6MnB4IHNvbGlkIHRyYW5zcGFyZW50O291dGxpbmUtb2Zmc2V0OjJweH06aG9zdChbaGlkZGVuXSl7ZGlzcGxheTpub25lfVtoaWRkZW5de2Rpc3BsYXk6bm9uZX1cIjtcblxuY29uc3QgVHJlZSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgdGhpcy5jYWxjaXRlVHJlZVNlbGVjdCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZVRyZWVTZWxlY3RcIiwgNik7XG4gICAgdGhpcy5rZXlEb3duSGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgaWYgKHRoaXMuY2hpbGQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3Qgcm9vdCA9IHRoaXMuZWw7XG4gICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICBjb25zdCBzdXBwb3J0ZWRLZXlzID0gW1wiQXJyb3dSaWdodFwiLCBcIkFycm93RG93blwiLCBcIkFycm93TGVmdFwiLCBcIkFycm93VXBcIiwgXCJIb21lXCIsIFwiRW5kXCIsIFwiVGFiXCJdO1xuICAgICAgaWYgKCEoaXNUcmVlSXRlbSh0YXJnZXQpICYmIHRoaXMuZWwuY29udGFpbnModGFyZ2V0KSkgfHwgIXN1cHBvcnRlZEtleXMuaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB0cmF2ZXJzYWJsZUl0ZW1zID0gZ2V0VHJhdmVyc2FibGVJdGVtcyhyb290KTtcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiVGFiXCIpIHtcbiAgICAgICAgLy8gcm9vdCB0YWJpbmRleCB3aWxsIGJlIHJlc3RvcmVkIHdoZW4gYmx1cnJlZC9mb2N1c2VkXG4gICAgICAgIHRyYXZlcnNhYmxlSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gKGl0ZW0udGFiSW5kZXggPSAtMSkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93RG93blwiKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRJdGVtSW5kZXggPSB0cmF2ZXJzYWJsZUl0ZW1zLmluZGV4T2YodGFyZ2V0KTtcbiAgICAgICAgY29uc3QgbmV4dEl0ZW0gPSB0cmF2ZXJzYWJsZUl0ZW1zW2N1cnJlbnRJdGVtSW5kZXggKyAxXTtcbiAgICAgICAgbmV4dEl0ZW0/LmZvY3VzKCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dVcFwiKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRJdGVtSW5kZXggPSB0cmF2ZXJzYWJsZUl0ZW1zLmluZGV4T2YodGFyZ2V0KTtcbiAgICAgICAgY29uc3QgcHJldmlvdXNJdGVtID0gdHJhdmVyc2FibGVJdGVtc1tjdXJyZW50SXRlbUluZGV4IC0gMV07XG4gICAgICAgIHByZXZpb3VzSXRlbT8uZm9jdXMoKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd0xlZnRcIikge1xuICAgICAgICBpZiAodGFyZ2V0Lmhhc0NoaWxkcmVuICYmIHRhcmdldC5leHBhbmRlZCkge1xuICAgICAgICAgIHRhcmdldC5leHBhbmRlZCA9IGZhbHNlO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJvb3RUb0l0ZW1QYXRoID0gdHJhdmVyc2FibGVJdGVtcy5zbGljZSgwLCB0cmF2ZXJzYWJsZUl0ZW1zLmluZGV4T2YodGFyZ2V0KSkucmV2ZXJzZSgpO1xuICAgICAgICBjb25zdCBwYXJlbnRJdGVtID0gcm9vdFRvSXRlbVBhdGguZmluZCgoaXRlbSkgPT4gaXRlbS5kZXB0aCA9PT0gdGFyZ2V0LmRlcHRoIC0gMSk7XG4gICAgICAgIHBhcmVudEl0ZW0/LmZvY3VzKCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dSaWdodFwiKSB7XG4gICAgICAgIGlmICghdGFyZ2V0LmRpc2FibGVkICYmIHRhcmdldC5oYXNDaGlsZHJlbikge1xuICAgICAgICAgIGlmICghdGFyZ2V0LmV4cGFuZGVkKSB7XG4gICAgICAgICAgICB0YXJnZXQuZXhwYW5kZWQgPSB0cnVlO1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50SXRlbUluZGV4ID0gdHJhdmVyc2FibGVJdGVtcy5pbmRleE9mKHRhcmdldCk7XG4gICAgICAgICAgICBjb25zdCBuZXh0SXRlbSA9IHRyYXZlcnNhYmxlSXRlbXNbY3VycmVudEl0ZW1JbmRleCArIDFdO1xuICAgICAgICAgICAgbmV4dEl0ZW0/LmZvY3VzKCk7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQua2V5ID09PSBcIkhvbWVcIikge1xuICAgICAgICBjb25zdCBmaXJzdE5vZGUgPSB0cmF2ZXJzYWJsZUl0ZW1zLnNoaWZ0KCk7XG4gICAgICAgIGlmIChmaXJzdE5vZGUpIHtcbiAgICAgICAgICBmaXJzdE5vZGUuZm9jdXMoKTtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRW5kXCIpIHtcbiAgICAgICAgY29uc3QgbGFzdE5vZGUgPSB0cmF2ZXJzYWJsZUl0ZW1zLnBvcCgpO1xuICAgICAgICBpZiAobGFzdE5vZGUpIHtcbiAgICAgICAgICBsYXN0Tm9kZS5mb2N1cygpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5saW5lcyA9IGZhbHNlO1xuICAgIHRoaXMuY2hpbGQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zY2FsZSA9IFwibVwiO1xuICAgIHRoaXMuc2VsZWN0aW9uTW9kZSA9IFwic2luZ2xlXCI7XG4gICAgdGhpcy5zZWxlY3RlZEl0ZW1zID0gW107XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29tcG9uZW50V2lsbFJlbmRlcigpIHtcbiAgICBjb25zdCBwYXJlbnQgPSB0aGlzLmVsLnBhcmVudEVsZW1lbnQ/LmNsb3Nlc3QoXCJjYWxjaXRlLXRyZWVcIik7XG4gICAgdGhpcy5saW5lcyA9IHBhcmVudCA/IHBhcmVudC5saW5lcyA6IHRoaXMubGluZXM7XG4gICAgdGhpcy5zY2FsZSA9IHBhcmVudCA/IHBhcmVudC5zY2FsZSA6IHRoaXMuc2NhbGU7XG4gICAgdGhpcy5zZWxlY3Rpb25Nb2RlID0gcGFyZW50ID8gcGFyZW50LnNlbGVjdGlvbk1vZGUgOiB0aGlzLnNlbGVjdGlvbk1vZGU7XG4gICAgdGhpcy5jaGlsZCA9ICEhcGFyZW50O1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKGgoSG9zdCwgeyBcImFyaWEtbXVsdGlzZWxlY3RhYmxlXCI6IHRoaXMuY2hpbGRcbiAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgOiAodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpcGxlXCIgfHwgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpY2hpbGRyZW5cIikudG9TdHJpbmcoKSwgb25LZXlEb3duOiB0aGlzLmtleURvd25IYW5kbGVyLCByb2xlOiAhdGhpcy5jaGlsZCA/IFwidHJlZVwiIDogdW5kZWZpbmVkLCB0YWJJbmRleDogdGhpcy5nZXRSb290VGFiSW5kZXgoKSB9LCBoKFwic2xvdFwiLCBudWxsKSkpO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIEV2ZW50IExpc3RlbmVyc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIG9uRm9jdXMoKSB7XG4gICAgaWYgKCF0aGlzLmNoaWxkKSB7XG4gICAgICBjb25zdCBmb2N1c1RhcmdldCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcImNhbGNpdGUtdHJlZS1pdGVtW3NlbGVjdGVkXTpub3QoW2Rpc2FibGVkXSlcIikgfHwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiY2FsY2l0ZS10cmVlLWl0ZW06bm90KFtkaXNhYmxlZF0pXCIpO1xuICAgICAgZm9jdXNFbGVtZW50KGZvY3VzVGFyZ2V0KTtcbiAgICB9XG4gIH1cbiAgb25Gb2N1c0luKGV2ZW50KSB7XG4gICAgY29uc3QgZm9jdXNlZEZyb21Sb290T3JPdXRzaWRlVHJlZSA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQgPT09IHRoaXMuZWwgfHwgIXRoaXMuZWwuY29udGFpbnMoZXZlbnQucmVsYXRlZFRhcmdldCk7XG4gICAgaWYgKGZvY3VzZWRGcm9tUm9vdE9yT3V0c2lkZVRyZWUpIHtcbiAgICAgIC8vIGdpdmVzIHVzZXIgdGhlIGFiaWxpdHkgdG8gdGFiIGludG8gZXh0ZXJuYWwgZWxlbWVudHMgKG1vZGlmeWluZyB0YWJpbmRleCBwcm9wZXJ0eSB3aWxsIG5vdCB3b3JrIGluIGZpcmVmb3gpXG4gICAgICB0aGlzLmVsLnJlbW92ZUF0dHJpYnV0ZShcInRhYmluZGV4XCIpO1xuICAgIH1cbiAgfVxuICBvbkZvY3VzT3V0KGV2ZW50KSB7XG4gICAgY29uc3Qgd2lsbEZvY3VzT3V0c2lkZVRyZWUgPSAhdGhpcy5lbC5jb250YWlucyhldmVudC5yZWxhdGVkVGFyZ2V0KTtcbiAgICBpZiAod2lsbEZvY3VzT3V0c2lkZVRyZWUpIHtcbiAgICAgIHRoaXMuZWwudGFiSW5kZXggPSB0aGlzLmdldFJvb3RUYWJJbmRleCgpO1xuICAgIH1cbiAgfVxuICBvbkludGVybmFsVHJlZUl0ZW1TZWxlY3QoZXZlbnQpIHtcbiAgICBpZiAodGhpcy5jaGlsZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgY29uc3QgY2hpbGRJdGVtcyA9IG5vZGVMaXN0VG9BcnJheSh0YXJnZXQucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtXCIpKTtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwiYW5jZXN0b3JzXCIpIHtcbiAgICAgIHRoaXMudXBkYXRlQW5jZXN0b3JUcmVlKGV2ZW50KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaXNOb25lU2VsZWN0aW9uTW9kZSA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJub25lXCI7XG4gICAgY29uc3Qgc2hvdWxkU2VsZWN0ID0gdGhpcy5zZWxlY3Rpb25Nb2RlICE9PSBudWxsICYmXG4gICAgICAoIXRhcmdldC5oYXNDaGlsZHJlbiB8fFxuICAgICAgICAodGFyZ2V0Lmhhc0NoaWxkcmVuICYmXG4gICAgICAgICAgKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJjaGlsZHJlblwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIpKSk7XG4gICAgY29uc3Qgc2hvdWxkRGVzZWxlY3RBbGxDaGlsZHJlbiA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIgJiYgdGFyZ2V0Lmhhc0NoaWxkcmVuO1xuICAgIGNvbnN0IHNob3VsZE1vZGlmeVRvQ3VycmVudFNlbGVjdGlvbiA9ICFpc05vbmVTZWxlY3Rpb25Nb2RlICYmXG4gICAgICBldmVudC5kZXRhaWwubW9kaWZ5Q3VycmVudFNlbGVjdGlvbiAmJlxuICAgICAgKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aXBsZVwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIpO1xuICAgIGNvbnN0IHNob3VsZENsZWFyQ3VycmVudFNlbGVjdGlvbiA9ICFzaG91bGRNb2RpZnlUb0N1cnJlbnRTZWxlY3Rpb24gJiZcbiAgICAgICgoKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJzaW5nbGVcIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGlwbGVcIikgJiZcbiAgICAgICAgY2hpbGRJdGVtcy5sZW5ndGggPD0gMCkgfHxcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImNoaWxkcmVuXCIgfHxcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpY2hpbGRyZW5cIik7XG4gICAgY29uc3Qgc2hvdWxkVXBkYXRlRXhwYW5kID0gW1wibXVsdGlwbGVcIiwgXCJub25lXCIsIFwic2luZ2xlXCIsIFwic2luZ2xlLXBlcnNpc3RcIl0uaW5jbHVkZXModGhpcy5zZWxlY3Rpb25Nb2RlKSAmJlxuICAgICAgdGFyZ2V0Lmhhc0NoaWxkcmVuO1xuICAgIGNvbnN0IHRhcmdldEl0ZW1zID0gW107XG4gICAgaWYgKHNob3VsZFNlbGVjdCkge1xuICAgICAgdGFyZ2V0SXRlbXMucHVzaCh0YXJnZXQpO1xuICAgIH1cbiAgICBpZiAoc2hvdWxkQ2xlYXJDdXJyZW50U2VsZWN0aW9uKSB7XG4gICAgICBjb25zdCBzZWxlY3RlZEl0ZW1zID0gbm9kZUxpc3RUb0FycmF5KHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtW3NlbGVjdGVkXVwiKSk7XG4gICAgICBzZWxlY3RlZEl0ZW1zLmZvckVhY2goKHRyZWVJdGVtKSA9PiB7XG4gICAgICAgIGlmICghdGFyZ2V0SXRlbXMuaW5jbHVkZXModHJlZUl0ZW0pKSB7XG4gICAgICAgICAgdHJlZUl0ZW0uc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzaG91bGRVcGRhdGVFeHBhbmQgJiZcbiAgICAgIFtcIm11bHRpcGxlXCIsIFwibm9uZVwiLCBcInNpbmdsZVwiLCBcInNpbmdsZS1wZXJzaXN0XCJdLmluY2x1ZGVzKHRoaXMuc2VsZWN0aW9uTW9kZSkpIHtcbiAgICAgIHRhcmdldC5leHBhbmRlZCA9ICF0YXJnZXQuZXhwYW5kZWQ7XG4gICAgfVxuICAgIGlmIChzaG91bGREZXNlbGVjdEFsbENoaWxkcmVuKSB7XG4gICAgICBjaGlsZEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgaXRlbS5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICBpZiAoaXRlbS5oYXNDaGlsZHJlbikge1xuICAgICAgICAgIGl0ZW0uZXhwYW5kZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzaG91bGRNb2RpZnlUb0N1cnJlbnRTZWxlY3Rpb24pIHtcbiAgICAgIHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKTtcbiAgICB9XG4gICAgaWYgKHNob3VsZE1vZGlmeVRvQ3VycmVudFNlbGVjdGlvbiAmJiB0YXJnZXQuc2VsZWN0ZWQpIHtcbiAgICAgIHRhcmdldEl0ZW1zLmZvckVhY2goKHRyZWVJdGVtKSA9PiB7XG4gICAgICAgIGlmICghdHJlZUl0ZW0uZGlzYWJsZWQpIHtcbiAgICAgICAgICB0cmVlSXRlbS5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoIWlzTm9uZVNlbGVjdGlvbk1vZGUpIHtcbiAgICAgIHRhcmdldEl0ZW1zLmZvckVhY2goKHRyZWVJdGVtKSA9PiB7XG4gICAgICAgIGlmICghdHJlZUl0ZW0uZGlzYWJsZWQpIHtcbiAgICAgICAgICB0cmVlSXRlbS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdGVkSXRlbXMgPSBpc05vbmVTZWxlY3Rpb25Nb2RlXG4gICAgICA/IFtdXG4gICAgICA6IG5vZGVMaXN0VG9BcnJheSh0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKSkuZmlsdGVyKChpKSA9PiBpLnNlbGVjdGVkKTtcbiAgICB0aGlzLmNhbGNpdGVUcmVlU2VsZWN0LmVtaXQoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuICB1cGRhdGVBbmNlc3RvclRyZWUoZXZlbnQpIHtcbiAgICBjb25zdCBpdGVtID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IHVwZGF0ZUl0ZW0gPSBldmVudC5kZXRhaWwudXBkYXRlSXRlbTtcbiAgICBpZiAoaXRlbS5kaXNhYmxlZCB8fCAoaXRlbS5pbmRldGVybWluYXRlICYmICF1cGRhdGVJdGVtKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBhbmNlc3RvcnMgPSBbXTtcbiAgICBsZXQgcGFyZW50ID0gaXRlbS5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKTtcbiAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICBhbmNlc3RvcnMucHVzaChwYXJlbnQpO1xuICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudEVsZW1lbnQuY2xvc2VzdChcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xuICAgIH1cbiAgICBjb25zdCBjaGlsZEl0ZW1zID0gQXJyYXkuZnJvbShpdGVtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJjYWxjaXRlLXRyZWUtaXRlbTpub3QoW2Rpc2FibGVkXSlcIikpO1xuICAgIGNvbnN0IGNoaWxkSXRlbXNXaXRoTm9DaGlsZHJlbiA9IGNoaWxkSXRlbXMuZmlsdGVyKChjaGlsZCkgPT4gIWNoaWxkLmhhc0NoaWxkcmVuKTtcbiAgICBjb25zdCBjaGlsZEl0ZW1zV2l0aENoaWxkcmVuID0gY2hpbGRJdGVtcy5maWx0ZXIoKGNoaWxkKSA9PiBjaGlsZC5oYXNDaGlsZHJlbik7XG4gICAgbGV0IGZ1dHVyZVNlbGVjdGVkO1xuICAgIGlmICh1cGRhdGVJdGVtKSB7XG4gICAgICBmdXR1cmVTZWxlY3RlZCA9IGl0ZW0uaGFzQ2hpbGRyZW4gPyAhKGl0ZW0uc2VsZWN0ZWQgfHwgaXRlbS5pbmRldGVybWluYXRlKSA6ICFpdGVtLnNlbGVjdGVkO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGZ1dHVyZVNlbGVjdGVkID0gaXRlbS5zZWxlY3RlZDtcbiAgICB9XG4gICAgY2hpbGRJdGVtc1dpdGhOb0NoaWxkcmVuLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICBlbC5zZWxlY3RlZCA9IGZ1dHVyZVNlbGVjdGVkO1xuICAgICAgZWwuaW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xuICAgIH0pO1xuICAgIGZ1bmN0aW9uIHVwZGF0ZUl0ZW1TdGF0ZShjaGlsZEl0ZW1zLCBpdGVtKSB7XG4gICAgICBjb25zdCBzZWxlY3RlZCA9IGNoaWxkSXRlbXMuZmlsdGVyKChjaGlsZCkgPT4gY2hpbGQuc2VsZWN0ZWQpO1xuICAgICAgY29uc3QgdW5zZWxlY3RlZCA9IGNoaWxkSXRlbXMuZmlsdGVyKChjaGlsZCkgPT4gIWNoaWxkLnNlbGVjdGVkKTtcbiAgICAgIGl0ZW0uc2VsZWN0ZWQgPSBzZWxlY3RlZC5sZW5ndGggPT09IGNoaWxkSXRlbXMubGVuZ3RoO1xuICAgICAgaXRlbS5pbmRldGVybWluYXRlID0gc2VsZWN0ZWQubGVuZ3RoID4gMCAmJiB1bnNlbGVjdGVkLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIGNoaWxkSXRlbXNXaXRoQ2hpbGRyZW4ucmV2ZXJzZSgpLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICBjb25zdCBkaXJlY3RDaGlsZEl0ZW1zID0gQXJyYXkuZnJvbShlbC5xdWVyeVNlbGVjdG9yQWxsKFwiOnNjb3BlID4gY2FsY2l0ZS10cmVlID4gY2FsY2l0ZS10cmVlLWl0ZW1cIikpO1xuICAgICAgdXBkYXRlSXRlbVN0YXRlKGRpcmVjdENoaWxkSXRlbXMsIGVsKTtcbiAgICB9KTtcbiAgICBpZiAodXBkYXRlSXRlbSkge1xuICAgICAgaWYgKGl0ZW0uaGFzQ2hpbGRyZW4pIHtcbiAgICAgICAgdXBkYXRlSXRlbVN0YXRlKGNoaWxkSXRlbXMsIGl0ZW0pO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGl0ZW0uc2VsZWN0ZWQgPSBmdXR1cmVTZWxlY3RlZDtcbiAgICAgICAgaXRlbS5pbmRldGVybWluYXRlID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGFuY2VzdG9ycy5mb3JFYWNoKChhbmNlc3RvcikgPT4ge1xuICAgICAgY29uc3QgZGVzY2VuZGFudHMgPSBub2RlTGlzdFRvQXJyYXkoYW5jZXN0b3IucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtXCIpKTtcbiAgICAgIGNvbnN0IGFjdGl2ZURlc2NlbmRhbnRzID0gZGVzY2VuZGFudHMuZmlsdGVyKChlbCkgPT4gZWwuc2VsZWN0ZWQpO1xuICAgICAgaWYgKGFjdGl2ZURlc2NlbmRhbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBhbmNlc3Rvci5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICBhbmNlc3Rvci5pbmRldGVybWluYXRlID0gZmFsc2U7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGluZGV0ZXJtaW5hdGUgPSBhY3RpdmVEZXNjZW5kYW50cy5sZW5ndGggPCBkZXNjZW5kYW50cy5sZW5ndGg7XG4gICAgICBhbmNlc3Rvci5pbmRldGVybWluYXRlID0gaW5kZXRlcm1pbmF0ZTtcbiAgICAgIGFuY2VzdG9yLnNlbGVjdGVkID0gIWluZGV0ZXJtaW5hdGU7XG4gICAgfSk7XG4gICAgdGhpcy5zZWxlY3RlZEl0ZW1zID0gbm9kZUxpc3RUb0FycmF5KHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtXCIpKS5maWx0ZXIoKGkpID0+IGkuc2VsZWN0ZWQpO1xuICAgIGlmICh1cGRhdGVJdGVtKSB7XG4gICAgICB0aGlzLmNhbGNpdGVUcmVlU2VsZWN0LmVtaXQoKTtcbiAgICB9XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGdldFJvb3RUYWJJbmRleCgpIHtcbiAgICByZXR1cm4gIXRoaXMuY2hpbGQgPyAwIDogLTE7XG4gIH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcblRyZWUuc3R5bGUgPSB0cmVlQ3NzO1xuXG5jb25zdCBDU1MgPSB7XG4gIGFjdGlvbnNFbmQ6IFwiYWN0aW9ucy1lbmRcIixcbiAgY2hlY2tib3hMYWJlbDogXCJjaGVja2JveC1sYWJlbFwiLFxuICBjaGVja2JveDogXCJjaGVja2JveFwiLFxuICBjaGV2cm9uOiBcImNoZXZyb25cIixcbiAgbm9kZUNvbnRhaW5lcjogXCJub2RlLWNvbnRhaW5lclwiLFxuICBjaGlsZHJlbkNvbnRhaW5lcjogXCJjaGlsZHJlbi1jb250YWluZXJcIixcbiAgYnVsbGV0UG9pbnRJY29uOiBcImJ1bGxldC1wb2ludFwiLFxuICBjaGVja21hcmtJY29uOiBcImNoZWNrbWFya1wiLFxuICBpdGVtRXhwYW5kZWQ6IFwiaXRlbS0tZXhwYW5kZWRcIixcbiAgaWNvblN0YXJ0OiBcImljb24tc3RhcnRcIixcbiAgbm9kZUFuZEFjdGlvbnNDb250YWluZXI6IFwibm9kZS1hY3Rpb25zLWNvbnRhaW5lclwiLFxufTtcbmNvbnN0IFNMT1RTID0ge1xuICBhY3Rpb25zRW5kOiBcImFjdGlvbnMtZW5kXCIsXG4gIGNoaWxkcmVuOiBcImNoaWxkcmVuXCIsXG59O1xuY29uc3QgSUNPTlMgPSB7XG4gIGJ1bGxldFBvaW50OiBcImJ1bGxldC1wb2ludFwiLFxuICBjaGVja21hcms6IFwiY2hlY2tcIixcbiAgY2hldnJvblJpZ2h0OiBcImNoZXZyb24tcmlnaHRcIixcbiAgYmxhbms6IFwiYmxhbmtcIixcbn07XG5cbmNvbnN0IHRyZWVJdGVtQ3NzID0gXCI6aG9zdChbZGlzYWJsZWRdKXtjdXJzb3I6ZGVmYXVsdDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTtvcGFjaXR5OnZhcigtLWNhbGNpdGUtb3BhY2l0eS1kaXNhYmxlZCl9Omhvc3QoW2Rpc2FibGVkXSkgKiw6aG9zdChbZGlzYWJsZWRdKSA6OnNsb3R0ZWQoKil7cG9pbnRlci1ldmVudHM6bm9uZX06aG9zdHtkaXNwbGF5OmJsb2NrO21heC1pbmxpbmUtc2l6ZToxMDAlO2N1cnNvcjpwb2ludGVyO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0zKX0ubm9kZS1hY3Rpb25zLWNvbnRhaW5lcntkaXNwbGF5OmZsZXh9Omhvc3QoW2NhbGNpdGUtaHlkcmF0ZWQtaGlkZGVuXSl7dmlzaWJpbGl0eTpoaWRkZW4gIWltcG9ydGFudDtwb2ludGVyLWV2ZW50czpub25lfTpob3N0KFtkaXNhYmxlZF0pIDo6c2xvdHRlZChbY2FsY2l0ZS1oeWRyYXRlZF1bZGlzYWJsZWRdKSw6aG9zdChbZGlzYWJsZWRdKSBbY2FsY2l0ZS1oeWRyYXRlZF1bZGlzYWJsZWRde29wYWNpdHk6MX06aG9zdChbc2NhbGU9c10pe2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMik7bGluZS1oZWlnaHQ6MXJlbX06aG9zdChbc2NhbGU9c10pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVye21pbi1ibG9jay1zaXplOjEuNXJlbX06aG9zdChbc2NhbGU9c10pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVyIC5ub2RlLWNvbnRhaW5lciAuY2hlY2tib3gsOmhvc3QoW3NjYWxlPXNdKSAubm9kZS1hY3Rpb25zLWNvbnRhaW5lciAubm9kZS1jb250YWluZXIgLmNoZXZyb24sOmhvc3QoW3NjYWxlPXNdKSAubm9kZS1hY3Rpb25zLWNvbnRhaW5lciAubm9kZS1jb250YWluZXIgLmNoZWNrbWFyayw6aG9zdChbc2NhbGU9c10pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVyIC5ub2RlLWNvbnRhaW5lciAuYnVsbGV0LXBvaW50e21hcmdpbi1pbmxpbmU6MC4yNXJlbX06aG9zdChbc2NhbGU9c10pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVyIC5ub2RlLWNvbnRhaW5lciAuaWNvbi1zdGFydHttYXJnaW4taW5saW5lOjAuNzVyZW19Omhvc3QoW3NjYWxlPW1dKXtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTEpO2xpbmUtaGVpZ2h0OjFyZW19Omhvc3QoW3NjYWxlPW1dKSAubm9kZS1hY3Rpb25zLWNvbnRhaW5lcnttaW4tYmxvY2stc2l6ZToycmVtfTpob3N0KFtzY2FsZT1tXSkgLm5vZGUtYWN0aW9ucy1jb250YWluZXIgLm5vZGUtY29udGFpbmVyIC5jaGVja2JveCw6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVyIC5ub2RlLWNvbnRhaW5lciAuY2hldnJvbiw6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVyIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJrLDpob3N0KFtzY2FsZT1tXSkgLm5vZGUtYWN0aW9ucy1jb250YWluZXIgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7bWFyZ2luLWlubGluZTowLjVyZW19Omhvc3QoW3NjYWxlPW1dKSAubm9kZS1hY3Rpb25zLWNvbnRhaW5lciAubm9kZS1jb250YWluZXIgLmljb24tc3RhcnR7bWFyZ2luLWlubGluZTowLjc1cmVtfTpob3N0KFtzY2FsZT1sXSl7Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLTApO2xpbmUtaGVpZ2h0OjEuMjVyZW19Omhvc3QoW3NjYWxlPWxdKSAubm9kZS1hY3Rpb25zLWNvbnRhaW5lcnttaW4tYmxvY2stc2l6ZToyLjc1cmVtfTpob3N0KFtzY2FsZT1sXSkgLm5vZGUtYWN0aW9ucy1jb250YWluZXIgLm5vZGUtY29udGFpbmVyIC5jaGVja2JveCw6aG9zdChbc2NhbGU9bF0pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVyIC5ub2RlLWNvbnRhaW5lciAuY2hldnJvbiw6aG9zdChbc2NhbGU9bF0pIC5ub2RlLWFjdGlvbnMtY29udGFpbmVyIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJrLDpob3N0KFtzY2FsZT1sXSkgLm5vZGUtYWN0aW9ucy1jb250YWluZXIgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7bWFyZ2luLWlubGluZTowLjc1cmVtfTpob3N0KFtzY2FsZT1sXSkgLm5vZGUtYWN0aW9ucy1jb250YWluZXIgLm5vZGUtY29udGFpbmVyIC5pY29uLXN0YXJ0e21hcmdpbi1pbmxpbmU6MC43NXJlbX06aG9zdChbbGluZXNdKSAuY2hpbGRyZW4tY29udGFpbmVyOmFmdGVye3Bvc2l0aW9uOmFic29sdXRlO2luc2V0LWJsb2NrLXN0YXJ0OjBweDt6LWluZGV4OnZhcigtLWNhbGNpdGUtei1pbmRleCk7aW5saW5lLXNpemU6MXB4O3RyYW5zaXRpb24tcHJvcGVydHk6Y29sb3IsIGJhY2tncm91bmQtY29sb3IsIGJvcmRlci1jb2xvciwgdGV4dC1kZWNvcmF0aW9uLWNvbG9yLCBmaWxsLCBzdHJva2U7dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTt0cmFuc2l0aW9uLWR1cmF0aW9uOjE1MG1zO3RyYW5zaXRpb246YWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQgMHMsIG91dGxpbmUgMHMsIG91dGxpbmUtb2Zmc2V0IDBzO2Jsb2NrLXNpemU6OTYlO2NvbnRlbnQ6XFxcIlxcXCI7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWJvcmRlci0yKX06aG9zdCg6bm90KFtsaW5lc10pKSAubm9kZS1jb250YWluZXI6YWZ0ZXJ7ZGlzcGxheTpub25lfTo6c2xvdHRlZCgqKXttaW4taW5saW5lLXNpemU6MHB4O21heC1pbmxpbmUtc2l6ZToxMDAlO292ZXJmbG93LXdyYXA6YnJlYWstd29yZDtjb2xvcjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjpub25lICFpbXBvcnRhbnR9OjpzbG90dGVkKCopOmhvdmVye3RleHQtZGVjb3JhdGlvbjpub25lICFpbXBvcnRhbnR9OjpzbG90dGVkKGEpe2lubGluZS1zaXplOjEwMCU7dGV4dC1kZWNvcmF0aW9uLWxpbmU6bm9uZX06aG9zdHtvdXRsaW5lOjJweCBzb2xpZCB0cmFuc3BhcmVudDtvdXRsaW5lLW9mZnNldDoycHh9Omhvc3QgLm5vZGUtY29udGFpbmVye291dGxpbmUtY29sb3I6dHJhbnNwYXJlbnR9Omhvc3Q6Zm9jdXMgLm5vZGUtY29udGFpbmVyLDpob3N0OmFjdGl2ZSAubm9kZS1jb250YWluZXJ7b3V0bGluZToycHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1icmFuZCk7b3V0bGluZS1vZmZzZXQ6Y2FsYyhcXG4gICAgICAgICAgICAtMnB4ICpcXG4gICAgICAgICAgICBjYWxjKFxcbiAgICAgICAgICAgICAgMSAtXFxuICAgICAgICAgICAgICAyICogY2xhbXAoXFxuICAgICAgICAgICAgICAgIDAsXFxuICAgICAgICAgICAgICAgIHZhcigtLWNhbGNpdGUtb2Zmc2V0LWludmVydC1mb2N1cyksXFxuICAgICAgICAgICAgICAgIDFcXG4gICAgICAgICAgICAgIClcXG4gICAgICAgICAgICApXFxuICAgICAgICAgICl9Omhvc3QoOmZvY3VzOm5vdChbZGlzYWJsZWRdKSkgLm5vZGUtY29udGFpbmVye291dGxpbmU6MnB4IHNvbGlkIHRyYW5zcGFyZW50O291dGxpbmUtb2Zmc2V0OjJweDtvdXRsaW5lOjJweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKTtvdXRsaW5lLW9mZnNldDpjYWxjKFxcbiAgICAgICAgICAgIC0ycHggKlxcbiAgICAgICAgICAgIGNhbGMoXFxuICAgICAgICAgICAgICAxIC1cXG4gICAgICAgICAgICAgIDIgKiBjbGFtcChcXG4gICAgICAgICAgICAgICAgMCxcXG4gICAgICAgICAgICAgICAgdmFyKC0tY2FsY2l0ZS1vZmZzZXQtaW52ZXJ0LWZvY3VzKSxcXG4gICAgICAgICAgICAgICAgMVxcbiAgICAgICAgICAgICAgKVxcbiAgICAgICAgICAgIClcXG4gICAgICAgICAgKX0uYWN0aW9ucy1lbmR7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7YWxpZ24tc2VsZjpzdHJldGNofS5jaGVja2JveHtsaW5lLWhlaWdodDowfS5jaGVja2JveC1sYWJlbHtwb2ludGVyLWV2ZW50czpub25lO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXJ9LmNoZWNrYm94OmZvY3Vze291dGxpbmU6MnB4IHNvbGlkIHRyYW5zcGFyZW50O291dGxpbmUtb2Zmc2V0OjJweH0uY2hpbGRyZW4tY29udGFpbmVye3Bvc2l0aW9uOnJlbGF0aXZlO2Jsb2NrLXNpemU6MHB4O3RyYW5zZm9ybS1vcmlnaW46dG9wO292ZXJmbG93OmhpZGRlbjtvcGFjaXR5OjA7bWFyZ2luLWlubGluZS1zdGFydDoxLjI1cmVtO3RyYW5zZm9ybTpzY2FsZVkoMCk7dHJhbnNpdGlvbjp2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpIGN1YmljLWJlemllcigwLjIxNSwgMC40NCwgMC40MiwgMC44OCksIG9wYWNpdHkgdmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBjdWJpYy1iZXppZXIoMC4yMTUsIDAuNDQsIDAuNDIsIDAuODgpLCBhbGwgdmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBlYXNlLWluLW91dH0uaXRlbS0tZXhwYW5kZWQ+LmNoaWxkcmVuLWNvbnRhaW5lcntvdmVyZmxvdzp2aXNpYmxlO29wYWNpdHk6MTt0cmFuc2Zvcm06bm9uZTtibG9jay1zaXplOmF1dG99Lm5vZGUtY29udGFpbmVye3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6ZmxleDttaW4taW5saW5lLXNpemU6MHB4O2ZsZXgtZ3JvdzoxO2FsaWduLWl0ZW1zOmNlbnRlcn0ubm9kZS1jb250YWluZXIgLmNoZWNrbWFyaywubm9kZS1jb250YWluZXIgLmJ1bGxldC1wb2ludHtvcGFjaXR5OjA7dHJhbnNpdGlvbjphbGwgdmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBlYXNlLWluLW91dCAwcywgb3V0bGluZSAwcywgb3V0bGluZS1vZmZzZXQgMHM7Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMSl9Lm5vZGUtY29udGFpbmVyOmhvdmVyIC5jaGVja21hcmssLm5vZGUtY29udGFpbmVyOmhvdmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyOmhvdmVyIC5jaGVja21hcmssOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyOmhvdmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoOmZvY3VzOm5vdChbZGlzYWJsZWRdKSkgLm5vZGUtY29udGFpbmVyIC5jaGVja21hcmssOmhvc3QoOmZvY3VzOm5vdChbZGlzYWJsZWRdKSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7b3BhY2l0eToxfTpob3N0KFtzZWxlY3RlZF0pIC5ub2RlLWNvbnRhaW5lciw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXI6aG92ZXJ7Zm9udC13ZWlnaHQ6dmFyKC0tY2FsY2l0ZS1mb250LXdlaWdodC1tZWRpdW0pO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0xKX06aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXIgLmJ1bGxldC1wb2ludCw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXIgLmNoZWNrbWFyayw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXI6aG92ZXIgLmJ1bGxldC1wb2ludCw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXI6aG92ZXIgLmNoZWNrbWFya3tvcGFjaXR5OjE7Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1icmFuZCl9Omhvc3QoW3NlbGVjdGlvbi1tb2RlPW5vbmVdOm5vdChbaGFzLWNoaWxkcmVuXSkpOmhvc3QoW3NjYWxlPXNdKSAubm9kZS1jb250YWluZXJ7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MC41cmVtfTpob3N0KFtzZWxlY3Rpb24tbW9kZT1ub25lXTpub3QoW2hhcy1jaGlsZHJlbl0pKTpob3N0KFtzY2FsZT1tXSkgLm5vZGUtY29udGFpbmVye3BhZGRpbmctaW5saW5lLXN0YXJ0OjFyZW19Omhvc3QoW3NlbGVjdGlvbi1tb2RlPW5vbmVdOm5vdChbaGFzLWNoaWxkcmVuXSkpOmhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXJ7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MS41cmVtfTpob3N0KDpub3QoW2hhcy1jaGlsZHJlbl0pKTpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyW2RhdGEtc2VsZWN0aW9uLW1vZGU9YW5jZXN0b3JzXSAuY2hlY2tib3h7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MS4yNXJlbX06aG9zdCg6bm90KFtoYXMtY2hpbGRyZW5dKSk6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lcltkYXRhLXNlbGVjdGlvbi1tb2RlPWFuY2VzdG9yc10gLmNoZWNrYm94e3BhZGRpbmctaW5saW5lLXN0YXJ0OjEuNXJlbX06aG9zdCg6bm90KFtoYXMtY2hpbGRyZW5dKSk6aG9zdChbc2NhbGU9bF0pIC5ub2RlLWNvbnRhaW5lcltkYXRhLXNlbGVjdGlvbi1tb2RlPWFuY2VzdG9yc10gLmNoZWNrYm94e3BhZGRpbmctaW5saW5lLXN0YXJ0OjEuNzVyZW19Omhvc3QoW2hhcy1jaGlsZHJlbl0pIC5ub2RlLWNvbnRhaW5lcltkYXRhLXNlbGVjdGlvbi1tb2RlPWFuY2VzdG9yc10gLmNoZWNrYm94e21hcmdpbi1pbmxpbmUtc3RhcnQ6MH06aG9zdChbaGFzLWNoaWxkcmVuXSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoW2hhcy1jaGlsZHJlbl0pIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJre2Rpc3BsYXk6bm9uZX0uY2hldnJvbntwb3NpdGlvbjpyZWxhdGl2ZTthbGlnbi1zZWxmOmNlbnRlcjtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMyk7dHJhbnNpdGlvbjphbGwgdmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBlYXNlLWluLW91dCAwcywgb3V0bGluZSAwcywgb3V0bGluZS1vZmZzZXQgMHM7ZmxleDowIDAgYXV0bzt0cmFuc2Zvcm06cm90YXRlKDBkZWcpfS5jYWxjaXRlLS1ydGwgLmNoZXZyb257dHJhbnNmb3JtOnJvdGF0ZSgxODBkZWcpfS5pdGVtLS1leHBhbmRlZCAubm9kZS1jb250YWluZXI+LmNoZXZyb257dHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyl9Omhvc3QoW3NlbGVjdGVkXSkgLmNoZWNrbWFyayw6aG9zdChbc2VsZWN0ZWRdKSAuYnVsbGV0LXBvaW50e2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBUcmVlSXRlbSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxUcmVlSXRlbVNlbGVjdCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZUludGVybmFsVHJlZUl0ZW1TZWxlY3RcIiwgNik7XG4gICAgdGhpcy5pY29uQ2xpY2tIYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHRoaXMuZXhwYW5kZWQgPSAhdGhpcy5leHBhbmRlZDtcbiAgICB9O1xuICAgIHRoaXMuY2hpbGRyZW5DbGlja0hhbmRsZXIgPSAoZXZlbnQpID0+IGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMudXNlckNoYW5nZWRWYWx1ZSA9IGZhbHNlO1xuICAgIHRoaXMudXBkYXRlUGFyZW50SXNFeHBhbmRlZCA9IChlbCwgZXhwYW5kZWQpID0+IHtcbiAgICAgIGNvbnN0IGl0ZW1zID0gZ2V0U2xvdHRlZChlbCwgU0xPVFMuY2hpbGRyZW4sIHtcbiAgICAgICAgYWxsOiB0cnVlLFxuICAgICAgICBzZWxlY3RvcjogXCJjYWxjaXRlLXRyZWUtaXRlbVwiLFxuICAgICAgfSk7XG4gICAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiAoaXRlbS5wYXJlbnRFeHBhbmRlZCA9IGV4cGFuZGVkKSk7XG4gICAgfTtcbiAgICB0aGlzLmFjdGlvbnNFbmRTbG90Q2hhbmdlSGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5oYXNFbmRBY3Rpb25zID0gc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudChldmVudCk7XG4gICAgfTtcbiAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5leHBhbmRlZCA9IGZhbHNlO1xuICAgIHRoaXMuaWNvbkZsaXBSdGwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5pY29uU3RhcnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zZWxlY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMucGFyZW50RXhwYW5kZWQgPSBmYWxzZTtcbiAgICB0aGlzLmRlcHRoID0gLTE7XG4gICAgdGhpcy5oYXNDaGlsZHJlbiA9IG51bGw7XG4gICAgdGhpcy5saW5lcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjYWxlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuaW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xuICAgIHRoaXMuc2VsZWN0aW9uTW9kZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhhc0VuZEFjdGlvbnMgPSBmYWxzZTtcbiAgICB0aGlzLnVwZGF0ZUFmdGVySW5pdGlhbFJlbmRlciA9IGZhbHNlO1xuICB9XG4gIGV4cGFuZGVkSGFuZGxlcihuZXdWYWx1ZSkge1xuICAgIHRoaXMudXBkYXRlUGFyZW50SXNFeHBhbmRlZCh0aGlzLmVsLCBuZXdWYWx1ZSk7XG4gIH1cbiAgaGFuZGxlU2VsZWN0ZWRDaGFuZ2UodmFsdWUpIHtcbiAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImFuY2VzdG9yc1wiICYmICF0aGlzLnVzZXJDaGFuZ2VkVmFsdWUpIHtcbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmluZGV0ZXJtaW5hdGUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2FsY2l0ZUludGVybmFsVHJlZUl0ZW1TZWxlY3QuZW1pdCh7XG4gICAgICAgIG1vZGlmeUN1cnJlbnRTZWxlY3Rpb246IHRydWUsXG4gICAgICAgIHVwZGF0ZUl0ZW06IGZhbHNlLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGdldFNlbGVjdGlvbk1vZGUoKSB7XG4gICAgdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSA9XG4gICAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGlwbGVcIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIExpZmVjeWNsZVxuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHRoaXMucGFyZW50VHJlZUl0ZW0gPSB0aGlzLmVsLnBhcmVudEVsZW1lbnQ/LmNsb3Nlc3QoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKTtcbiAgICBpZiAodGhpcy5wYXJlbnRUcmVlSXRlbSkge1xuICAgICAgY29uc3QgeyBleHBhbmRlZCB9ID0gdGhpcy5wYXJlbnRUcmVlSXRlbTtcbiAgICAgIHRoaXMudXBkYXRlUGFyZW50SXNFeHBhbmRlZCh0aGlzLnBhcmVudFRyZWVJdGVtLCBleHBhbmRlZCk7XG4gICAgfVxuICAgIGNvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQodGhpcyk7XG4gICAgY29ubmVjdEludGVyYWN0aXZlKHRoaXMpO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGRpc2Nvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQodGhpcyk7XG4gICAgZGlzY29ubmVjdEludGVyYWN0aXZlKHRoaXMpO1xuICB9XG4gIGNvbXBvbmVudFdpbGxSZW5kZXIoKSB7XG4gICAgdGhpcy5oYXNDaGlsZHJlbiA9ICEhdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiY2FsY2l0ZS10cmVlXCIpO1xuICAgIHRoaXMuZGVwdGggPSAwO1xuICAgIGxldCBwYXJlbnRUcmVlID0gdGhpcy5lbC5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlXCIpO1xuICAgIGlmICghcGFyZW50VHJlZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPSBwYXJlbnRUcmVlLnNlbGVjdGlvbk1vZGU7XG4gICAgdGhpcy5zY2FsZSA9IHBhcmVudFRyZWUuc2NhbGUgfHwgXCJtXCI7XG4gICAgdGhpcy5saW5lcyA9IHBhcmVudFRyZWUubGluZXM7XG4gICAgbGV0IG5leHRQYXJlbnRUcmVlO1xuICAgIHdoaWxlIChwYXJlbnRUcmVlKSB7XG4gICAgICBuZXh0UGFyZW50VHJlZSA9IHBhcmVudFRyZWUucGFyZW50RWxlbWVudD8uY2xvc2VzdChcImNhbGNpdGUtdHJlZVwiKTtcbiAgICAgIGlmIChuZXh0UGFyZW50VHJlZSA9PT0gcGFyZW50VHJlZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBwYXJlbnRUcmVlID0gbmV4dFBhcmVudFRyZWU7XG4gICAgICAgIHRoaXMuZGVwdGggPSB0aGlzLmRlcHRoICsgMTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+ICh0aGlzLnVwZGF0ZUFmdGVySW5pdGlhbFJlbmRlciA9IHRydWUpKTtcbiAgfVxuICBjb21wb25lbnREaWRMb2FkKCkge1xuICAgIHRoaXMudXBkYXRlQW5jZXN0b3JUcmVlKCk7XG4gIH1cbiAgY29tcG9uZW50RGlkUmVuZGVyKCkge1xuICAgIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbih0aGlzLCAoKSA9PiBmYWxzZSAvLyBwcm9ncmFtbWF0aWNhbGx5IGZvY3VzYWJsZVxuICAgICk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHJ0bCA9IGdldEVsZW1lbnREaXIodGhpcy5lbCkgPT09IFwicnRsXCI7XG4gICAgY29uc3Qgc2hvd0J1bGxldFBvaW50ID0gdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcInNpbmdsZVwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJjaGlsZHJlblwiO1xuICAgIGNvbnN0IHNob3dDaGVja21hcmsgPSB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGlwbGVcIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiO1xuICAgIGNvbnN0IHNob3dCbGFuayA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJub25lXCIgJiYgIXRoaXMuaGFzQ2hpbGRyZW47XG4gICAgY29uc3QgY2hldnJvbiA9IHRoaXMuaGFzQ2hpbGRyZW4gPyAoaChcImNhbGNpdGUtaWNvblwiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1MuY2hldnJvbl06IHRydWUsXG4gICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBydGwsXG4gICAgICB9LCBcImRhdGEtdGVzdC1pZFwiOiBcImljb25cIiwgaWNvbjogSUNPTlMuY2hldnJvblJpZ2h0LCBvbkNsaWNrOiB0aGlzLmljb25DbGlja0hhbmRsZXIsIHNjYWxlOiBnZXRJY29uU2NhbGUodGhpcy5zY2FsZSkgfSkpIDogbnVsbDtcbiAgICBjb25zdCBkZWZhdWx0U2xvdE5vZGUgPSBoKFwic2xvdFwiLCB7IGtleTogXCJkZWZhdWx0LXNsb3RcIiB9KTtcbiAgICBjb25zdCBjaGVja2JveCA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJhbmNlc3RvcnNcIiA/IChoKFwibGFiZWxcIiwgeyBjbGFzczogQ1NTLmNoZWNrYm94TGFiZWwsIGtleTogXCJjaGVja2JveC1sYWJlbFwiIH0sIGgoXCJjYWxjaXRlLWNoZWNrYm94XCIsIHsgY2hlY2tlZDogdGhpcy5zZWxlY3RlZCwgY2xhc3M6IENTUy5jaGVja2JveCwgXCJkYXRhLXRlc3QtaWRcIjogXCJjaGVja2JveFwiLCBpbmRldGVybWluYXRlOiB0aGlzLmhhc0NoaWxkcmVuICYmIHRoaXMuaW5kZXRlcm1pbmF0ZSwgc2NhbGU6IHRoaXMuc2NhbGUsIHRhYkluZGV4OiAtMSB9KSwgZGVmYXVsdFNsb3ROb2RlKSkgOiBudWxsO1xuICAgIGNvbnN0IHNlbGVjdGVkSWNvbiA9IHNob3dCdWxsZXRQb2ludFxuICAgICAgPyBJQ09OUy5idWxsZXRQb2ludFxuICAgICAgOiBzaG93Q2hlY2ttYXJrXG4gICAgICAgID8gSUNPTlMuY2hlY2ttYXJrXG4gICAgICAgIDogc2hvd0JsYW5rXG4gICAgICAgICAgPyBJQ09OUy5ibGFua1xuICAgICAgICAgIDogbnVsbDtcbiAgICBjb25zdCBpdGVtSW5kaWNhdG9yID0gc2VsZWN0ZWRJY29uID8gKGgoXCJjYWxjaXRlLWljb25cIiwgeyBjbGFzczoge1xuICAgICAgICBbQ1NTLmJ1bGxldFBvaW50SWNvbl06IHNlbGVjdGVkSWNvbiA9PT0gSUNPTlMuYnVsbGV0UG9pbnQsXG4gICAgICAgIFtDU1MuY2hlY2ttYXJrSWNvbl06IHNlbGVjdGVkSWNvbiA9PT0gSUNPTlMuY2hlY2ttYXJrLFxuICAgICAgICBbQ1NTX1VUSUxJVFkucnRsXTogcnRsLFxuICAgICAgfSwgaWNvbjogc2VsZWN0ZWRJY29uLCBzY2FsZTogZ2V0SWNvblNjYWxlKHRoaXMuc2NhbGUpIH0pKSA6IG51bGw7XG4gICAgY29uc3QgaGlkZGVuID0gISh0aGlzLnBhcmVudEV4cGFuZGVkIHx8IHRoaXMuZGVwdGggPT09IDEpO1xuICAgIGNvbnN0IGlzRXhwYW5kZWQgPSB0aGlzLnVwZGF0ZUFmdGVySW5pdGlhbFJlbmRlciAmJiB0aGlzLmV4cGFuZGVkO1xuICAgIGNvbnN0IHsgaGFzRW5kQWN0aW9ucyB9ID0gdGhpcztcbiAgICBjb25zdCBzbG90Tm9kZSA9IChoKFwic2xvdFwiLCB7IGtleTogXCJhY3Rpb25zRW5kU2xvdFwiLCBuYW1lOiBTTE9UUy5hY3Rpb25zRW5kLCBvblNsb3RjaGFuZ2U6IHRoaXMuYWN0aW9uc0VuZFNsb3RDaGFuZ2VIYW5kbGVyIH0pKTtcbiAgICBjb25zdCBpY29uU3RhcnRFbCA9IChoKFwiY2FsY2l0ZS1pY29uXCIsIHsgY2xhc3M6IENTUy5pY29uU3RhcnQsIGZsaXBSdGw6IHRoaXMuaWNvbkZsaXBSdGwgPT09IFwic3RhcnRcIiB8fCB0aGlzLmljb25GbGlwUnRsID09PSBcImJvdGhcIiwgaWNvbjogdGhpcy5pY29uU3RhcnQsIHNjYWxlOiBnZXRJY29uU2NhbGUodGhpcy5zY2FsZSkgfSkpO1xuICAgIHJldHVybiAoaChIb3N0LCB7IFwiYXJpYS1leHBhbmRlZFwiOiB0aGlzLmhhc0NoaWxkcmVuID8gdG9BcmlhQm9vbGVhbihpc0V4cGFuZGVkKSA6IHVuZGVmaW5lZCwgXCJhcmlhLWhpZGRlblwiOiB0b0FyaWFCb29sZWFuKGhpZGRlbiksIFwiYXJpYS1zZWxlY3RlZFwiOiB0aGlzLnNlbGVjdGVkID8gXCJ0cnVlXCIgOiBzaG93Q2hlY2ttYXJrID8gXCJmYWxzZVwiIDogdW5kZWZpbmVkLCBcImNhbGNpdGUtaHlkcmF0ZWQtaGlkZGVuXCI6IGhpZGRlbiwgcm9sZTogXCJ0cmVlaXRlbVwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogeyBbQ1NTLml0ZW1FeHBhbmRlZF06IGlzRXhwYW5kZWQgfSB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IENTUy5ub2RlQW5kQWN0aW9uc0NvbnRhaW5lciB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgW0NTUy5ub2RlQ29udGFpbmVyXTogdHJ1ZSxcbiAgICAgICAgW0NTU19VVElMSVRZLnJ0bF06IHJ0bCxcbiAgICAgIH0sIFwiZGF0YS1zZWxlY3Rpb24tbW9kZVwiOiB0aGlzLnNlbGVjdGlvbk1vZGUsXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QvanN4LXNvcnQtcHJvcHMgLS0gcmVmIHNob3VsZCBiZSBsYXN0IHNvIG5vZGUgYXR0cnMvcHJvcHMgYXJlIGluIHN5bmMgKHNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vcHVsbC82NTMwKVxuICAgICAgcmVmOiAoZWwpID0+ICh0aGlzLmRlZmF1bHRTbG90V3JhcHBlciA9IGVsKSB9LCBjaGV2cm9uLCBpdGVtSW5kaWNhdG9yLCB0aGlzLmljb25TdGFydCA/IGljb25TdGFydEVsIDogbnVsbCwgY2hlY2tib3ggPyBjaGVja2JveCA6IGRlZmF1bHRTbG90Tm9kZSksIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLmFjdGlvbnNFbmQsIGhpZGRlbjogIWhhc0VuZEFjdGlvbnMsIHJlZjogKGVsKSA9PiAodGhpcy5hY3Rpb25TbG90V3JhcHBlciA9IGVsKSB9LCBzbG90Tm9kZSkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgW0NTUy5jaGlsZHJlbkNvbnRhaW5lcl06IHRydWUsXG4gICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBydGwsXG4gICAgICB9LCBcImRhdGEtdGVzdC1pZFwiOiBcImNhbGNpdGUtdHJlZS1jaGlsZHJlblwiLCBvbkNsaWNrOiB0aGlzLmNoaWxkcmVuQ2xpY2tIYW5kbGVyLCByb2xlOiB0aGlzLmhhc0NoaWxkcmVuID8gXCJncm91cFwiIDogdW5kZWZpbmVkIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogU0xPVFMuY2hpbGRyZW4gfSkpKSkpO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIEV2ZW50IExpc3RlbmVyc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIG9uQ2xpY2soZXZlbnQpIHtcbiAgICBpZiAodGhpcy5kaXNhYmxlZCB8fCB0aGlzLmlzQWN0aW9uRW5kRXZlbnQoZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIFNvbHZlIGZvciBpZiB0aGUgaXRlbSBpcyBjbGlja2VkIHNvbWV3aGVyZSBvdXRzaWRlIHRoZSBzbG90dGVkIGFuY2hvci5cbiAgICAvLyBBbmNob3IgaXMgdHJpZ2dlcmVkIGFueXdoZXJlIHlvdSBjbGlja1xuICAgIGNvbnN0IFtsaW5rXSA9IGZpbHRlckRpcmVjdENoaWxkcmVuKHRoaXMuZWwsIFwiYVwiKTtcbiAgICBpZiAobGluayAmJiBldmVudC5jb21wb3NlZFBhdGgoKVswXS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09IFwiYVwiKSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSBsaW5rLnRhcmdldCA9PT0gXCJcIiA/IFwiX3NlbGZcIiA6IGxpbmsudGFyZ2V0O1xuICAgICAgd2luZG93Lm9wZW4obGluay5ocmVmLCB0YXJnZXQpO1xuICAgIH1cbiAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xuICAgICAgbW9kaWZ5Q3VycmVudFNlbGVjdGlvbjogdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImFuY2VzdG9yc1wiIHx8IHRoaXMuaXNTZWxlY3Rpb25NdWx0aUxpa2UsXG4gICAgICB1cGRhdGVJdGVtOiB0cnVlLFxuICAgIH0pO1xuICAgIHRoaXMudXNlckNoYW5nZWRWYWx1ZSA9IHRydWU7XG4gIH1cbiAga2V5RG93bkhhbmRsZXIoZXZlbnQpIHtcbiAgICBpZiAodGhpcy5pc0FjdGlvbkVuZEV2ZW50KGV2ZW50KSB8fCBldmVudC5kZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHN3aXRjaCAoZXZlbnQua2V5KSB7XG4gICAgICBjYXNlIFwiIFwiOlxuICAgICAgICB0aGlzLnVzZXJDaGFuZ2VkVmFsdWUgPSB0cnVlO1xuICAgICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xuICAgICAgICAgIG1vZGlmeUN1cnJlbnRTZWxlY3Rpb246IHRoaXMuaXNTZWxlY3Rpb25NdWx0aUxpa2UsXG4gICAgICAgICAgdXBkYXRlSXRlbTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIkVudGVyXCI6XG4gICAgICAgIC8vIGFjdGl2YXRlcyBhIG5vZGUsIGkuZS4sIHBlcmZvcm1zIGl0cyBkZWZhdWx0IGFjdGlvbi4gRm9yIHBhcmVudCBub2Rlcywgb25lIHBvc3NpYmxlIGRlZmF1bHQgYWN0aW9uIGlzIHRvIG9wZW4gb3IgY2xvc2UgdGhlIG5vZGUuIEluIHNpbmdsZS1zZWxlY3QgdHJlZXMgd2hlcmUgc2VsZWN0aW9uIGRvZXMgbm90IGZvbGxvdyBmb2N1cyAoc2VlIG5vdGUgYmVsb3cpLCB0aGUgZGVmYXVsdCBhY3Rpb24gaXMgdHlwaWNhbGx5IHRvIHNlbGVjdCB0aGUgZm9jdXNlZCBub2RlLlxuICAgICAgICBjb25zdCBsaW5rID0gQXJyYXkuZnJvbSh0aGlzLmVsLmNoaWxkcmVuKS5maW5kKChlbCkgPT4gZWwubWF0Y2hlcyhcImFcIikpO1xuICAgICAgICB0aGlzLnVzZXJDaGFuZ2VkVmFsdWUgPSB0cnVlO1xuICAgICAgICBpZiAobGluaykge1xuICAgICAgICAgIGxpbmsuY2xpY2soKTtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xuICAgICAgICAgICAgbW9kaWZ5Q3VycmVudFNlbGVjdGlvbjogdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSxcbiAgICAgICAgICAgIHVwZGF0ZUl0ZW06IHRydWUsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgaXNBY3Rpb25FbmRFdmVudChldmVudCkge1xuICAgIGNvbnN0IGNvbXBvc2VkUGF0aCA9IGV2ZW50LmNvbXBvc2VkUGF0aCgpO1xuICAgIHJldHVybiBjb21wb3NlZFBhdGguaW5jbHVkZXModGhpcy5hY3Rpb25TbG90V3JhcHBlcik7XG4gIH1cbiAgLyoqXG4gICAqIFRoaXMgaXMgbWVhbnQgdG8gYmUgY2FsbGVkIGluIGBjb21wb25lbnREaWRMb2FkYCBpbiBvcmRlciB0byB0YWtlIGFkdmFudGFnZSBvZiB0aGUgaGllcmFyY2hpY2FsIGNvbXBvbmVudCBsaWZlY3ljbGVcbiAgICogYW5kIGhlbHAgY2hlY2sgZm9yIGl0ZW0gc2VsZWN0aW9uIGFzIGl0ZW1zIGFyZSBpbml0aWFsaXplZFxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgdXBkYXRlQW5jZXN0b3JUcmVlKCkge1xuICAgIGNvbnN0IHBhcmVudEl0ZW0gPSB0aGlzLnBhcmVudFRyZWVJdGVtO1xuICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZGUgIT09IFwiYW5jZXN0b3JzXCIgfHwgIXBhcmVudEl0ZW0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuc2VsZWN0ZWQpIHtcbiAgICAgIGNvbnN0IHBhcmVudFRyZWUgPSB0aGlzLmVsLnBhcmVudEVsZW1lbnQ7XG4gICAgICBjb25zdCBzaWJsaW5ncyA9IEFycmF5LmZyb20ocGFyZW50VHJlZT8uY2hpbGRyZW4pO1xuICAgICAgY29uc3Qgc2VsZWN0ZWRTaWJsaW5ncyA9IHNpYmxpbmdzLmZpbHRlcigoY2hpbGQpID0+IGNoaWxkLnNlbGVjdGVkKTtcbiAgICAgIGlmIChzaWJsaW5ncy5sZW5ndGggPT09IHNlbGVjdGVkU2libGluZ3MubGVuZ3RoKSB7XG4gICAgICAgIHBhcmVudEl0ZW0uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICBwYXJlbnRJdGVtLmluZGV0ZXJtaW5hdGUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHNlbGVjdGVkU2libGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICBwYXJlbnRJdGVtLmluZGV0ZXJtaW5hdGUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgY2hpbGRJdGVtcyA9IEFycmF5LmZyb20odGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS10cmVlLWl0ZW06bm90KFtkaXNhYmxlZF0pXCIpKTtcbiAgICAgIGNoaWxkSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBpdGVtLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgaXRlbS5pbmRldGVybWluYXRlID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAodGhpcy5pbmRldGVybWluYXRlKSB7XG4gICAgICBjb25zdCBwYXJlbnRJdGVtID0gdGhpcy5wYXJlbnRUcmVlSXRlbTtcbiAgICAgIHBhcmVudEl0ZW0uaW5kZXRlcm1pbmF0ZSA9IHRydWU7XG4gICAgfVxuICB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICBcImV4cGFuZGVkXCI6IFtcImV4cGFuZGVkSGFuZGxlclwiXSxcbiAgICBcInNlbGVjdGVkXCI6IFtcImhhbmRsZVNlbGVjdGVkQ2hhbmdlXCJdLFxuICAgIFwic2VsZWN0aW9uTW9kZVwiOiBbXCJnZXRTZWxlY3Rpb25Nb2RlXCJdXG4gIH07IH1cbn07XG5UcmVlSXRlbS5zdHlsZSA9IHRyZWVJdGVtQ3NzO1xuXG5leHBvcnQgeyBUcmVlIGFzIGNhbGNpdGVfdHJlZSwgVHJlZUl0ZW0gYXMgY2FsY2l0ZV90cmVlX2l0ZW0gfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2FsY2l0ZS10cmVlXzIuZW50cnkuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYyLjAuMFxuICovXG5mdW5jdGlvbiBnZXRJY29uU2NhbGUoY29tcG9uZW50U2NhbGUpIHtcbiAgcmV0dXJuIGNvbXBvbmVudFNjYWxlID09PSBcImxcIiA/IFwibVwiIDogXCJzXCI7XG59XG4vKipcbiAqIFRoaXMgdXRpbCBoZWxwcyB1cyB3YWl0IGZvciBhIGNvbXBvbmVudCB0byBiZSByZWFkeSBmb3IgYm90aCBsYXp5LWxvYWRpbmcgKGBkaXN0YCBvdXRwdXQpIGFuZCBub24tbGF6eS1sb2FkaW5nIChgY29tcG9uZW50c2Agb3V0cHV0KSBjb21wb25lbnRzLlxuICpcbiAqIEJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9pb25pYy10ZWFtL2lvbmljLWZyYW1ld29yay9ibG9iLzFhOGJkNmQvY29yZS9zcmMvdXRpbHMvaGVscGVycy50cyNMNjBDMS1MNzlDM1xuICpcbiAqIEBwYXJhbSBlbCAtIHRoZSBob3N0IGVsZW1lbnQgdG8gd2FpdCBmb3JcbiAqL1xuYXN5bmMgZnVuY3Rpb24gY29tcG9uZW50T25SZWFkeShlbCkge1xuICBhd2FpdCAoaXNTdGVuY2lsRWwoZWwpXG4gICAgPyBlbC5jb21wb25lbnRPblJlYWR5KClcbiAgICA6IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcmVzb2x2ZSgpKSkpO1xufVxuZnVuY3Rpb24gaXNTdGVuY2lsRWwoZWwpIHtcbiAgcmV0dXJuIHR5cGVvZiBlbC5jb21wb25lbnRPblJlYWR5ID09PSBcImZ1bmN0aW9uXCI7XG59XG5cbmV4cG9ydCB7IGNvbXBvbmVudE9uUmVhZHkgYXMgYywgZ2V0SWNvblNjYWxlIGFzIGcgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29tcG9uZW50LWY5NGNhYjcyLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2Mi4wLjBcbiAqL1xuaW1wb3J0IHsgZiBhcyBmb3JjZVVwZGF0ZSB9IGZyb20gJy4vaW5kZXgtODZmYWVmOWMuanMnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVPYnNlcnZlciB9IGZyb20gJy4vb2JzZXJ2ZXJzLTcxZDMzMmRiLmpzJztcblxuY29uc3Qgb2JzZXJ2ZWQgPSBuZXcgU2V0KCk7XG5sZXQgbXV0YXRpb25PYnNlcnZlcjtcbmNvbnN0IG9ic2VydmVyT3B0aW9ucyA9IHsgY2hpbGRMaXN0OiB0cnVlIH07XG4vKipcbiAqIEhlbHBlciB0byBzZXQgdXAgYSBjb25kaXRpb25hbCBzbG90IGNvbXBvbmVudCBvbiBjb25uZWN0ZWRDYWxsYmFjay5cbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50XG4gKiBAZGVwcmVjYXRlZCBVc2UgYG9uU2xvdGNoYW5nZWAgZXZlbnQgd2l0aCBgc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudGAgRE9NIHV0aWxpdHkgaW5zdGVhZC5cbiAqXG4gKiBgYGBcbiAqIDxzbG90IG9uU2xvdGNoYW5nZT17KGV2ZW50KSA9PiB0aGlzLm15U2xvdEhhc0VsZW1lbnQgPSBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50KGV2ZW50KX0gLz59XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudChjb21wb25lbnQpIHtcbiAgaWYgKCFtdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgbXV0YXRpb25PYnNlcnZlciA9IGNyZWF0ZU9ic2VydmVyKFwibXV0YXRpb25cIiwgcHJvY2Vzc011dGF0aW9ucyk7XG4gIH1cbiAgbXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKGNvbXBvbmVudC5lbCwgb2JzZXJ2ZXJPcHRpb25zKTtcbn1cbi8qKlxuICogSGVscGVyIHRvIHRlYXIgZG93biBhIGNvbmRpdGlvbmFsIHNsb3QgY29tcG9uZW50IG9uIGRpc2Nvbm5lY3RlZENhbGxiYWNrLlxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqIEBkZXByZWNhdGVkIFVzZSBgb25TbG90Y2hhbmdlYCBldmVudCB3aXRoIGBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50YCBET00gdXRpbGl0eSBpbnN0ZWFkLlxuICpcbiAqIGBgYFxuICogPHNsb3Qgb25TbG90Y2hhbmdlPXsoZXZlbnQpID0+IHRoaXMubXlTbG90SGFzRWxlbWVudCA9IHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQoZXZlbnQpfSAvPn1cbiAqIGBgYFxuICovXG5mdW5jdGlvbiBkaXNjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50KGNvbXBvbmVudCkge1xuICBvYnNlcnZlZC5kZWxldGUoY29tcG9uZW50LmVsKTtcbiAgLy8gd2UgZXhwbGljaXRseSBwcm9jZXNzIHF1ZXVlZCBtdXRhdGlvbnMgYW5kIGRpc2Nvbm5lY3QgYW5kIHJlY29ubmVjdFxuICAvLyB0aGUgb2JzZXJ2ZXIgdW50aWwgTXV0YXRpb25PYnNlcnZlciBnZXRzIGFuIGB1bm9ic2VydmVgIG1ldGhvZFxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3doYXR3Zy9kb20vaXNzdWVzLzEyNlxuICBwcm9jZXNzTXV0YXRpb25zKG11dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKSk7XG4gIG11dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICBmb3IgKGNvbnN0IFtlbGVtZW50XSBvZiBvYnNlcnZlZC5lbnRyaWVzKCkpIHtcbiAgICBtdXRhdGlvbk9ic2VydmVyLm9ic2VydmUoZWxlbWVudCwgb2JzZXJ2ZXJPcHRpb25zKTtcbiAgfVxufVxuZnVuY3Rpb24gcHJvY2Vzc011dGF0aW9ucyhtdXRhdGlvbnMpIHtcbiAgbXV0YXRpb25zLmZvckVhY2goKHsgdGFyZ2V0IH0pID0+IHtcbiAgICBmb3JjZVVwZGF0ZSh0YXJnZXQpO1xuICB9KTtcbn1cblxuZXhwb3J0IHsgY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCBhcyBjLCBkaXNjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50IGFzIGQgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uZGl0aW9uYWxTbG90LWY2NzEwODc1LmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2Mi4wLjBcbiAqL1xuaW1wb3J0IHsgZyBhcyBnZXRVc2VyQWdlbnRTdHJpbmcgfSBmcm9tICcuL2Jyb3dzZXItZWNlMjlkYTcuanMnO1xuXG4vLyDimqDvuI8gYnJvd3Nlci1zbmlmZmluZyBpcyBub3QgYSBiZXN0IHByYWN0aWNlIGFuZCBzaG91bGQgYmUgYXZvaWRlZCDimqDvuI9cbmNvbnN0IGlzRmlyZWZveCA9IC9maXJlZm94L2kudGVzdChnZXRVc2VyQWdlbnRTdHJpbmcoKSk7XG5jb25zdCBpbnRlcmFjdGl2ZUVsZW1lbnRUb1BhcmVudCA9IGlzRmlyZWZveFxuICA/IG5ldyBXZWFrTWFwKClcbiAgOiBudWxsO1xuZnVuY3Rpb24gaW50ZXJjZXB0ZWRDbGljaygpIHtcbiAgY29uc3QgeyBkaXNhYmxlZCB9ID0gdGhpcztcbiAgaWYgKCFkaXNhYmxlZCkge1xuICAgIEhUTUxFbGVtZW50LnByb3RvdHlwZS5jbGljay5jYWxsKHRoaXMpO1xuICB9XG59XG5mdW5jdGlvbiBvblBvaW50ZXJEb3duKGV2ZW50KSB7XG4gIGNvbnN0IGludGVyYWN0aXZlRWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgaWYgKGlzRmlyZWZveCAmJiAhaW50ZXJhY3RpdmVFbGVtZW50VG9QYXJlbnQuZ2V0KGludGVyYWN0aXZlRWxlbWVudCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgeyBkaXNhYmxlZCB9ID0gaW50ZXJhY3RpdmVFbGVtZW50O1xuICBpZiAoZGlzYWJsZWQpIHtcbiAgICAvLyBwcmV2ZW50IGNsaWNrIGZyb20gbW92aW5nIGZvY3VzIG9uIGhvc3RcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG59XG5jb25zdCBub25CdWJibGluZ1doZW5EaXNhYmxlZE1vdXNlRXZlbnRzID0gW1wibW91c2Vkb3duXCIsIFwibW91c2V1cFwiLCBcImNsaWNrXCJdO1xuZnVuY3Rpb24gb25Ob25CdWJibGluZ1doZW5EaXNhYmxlZE1vdXNlRXZlbnQoZXZlbnQpIHtcbiAgaWYgKGlzRmlyZWZveCAmJiAhaW50ZXJhY3RpdmVFbGVtZW50VG9QYXJlbnQuZ2V0KGV2ZW50LnRhcmdldCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgeyBkaXNhYmxlZCB9ID0gZXZlbnQudGFyZ2V0O1xuICAvLyBwcmV2ZW50IGRpc2FsbG93ZWQgbW91c2UgZXZlbnRzIGZyb20gYmVpbmcgZW1pdHRlZCBvbiB0aGUgZGlzYWJsZWQgaG9zdCAocGVyIGh0dHBzOi8vZ2l0aHViLmNvbS93aGF0d2cvaHRtbC9pc3N1ZXMvNTg4NilcbiAgLy/imqAgd2UgZ2VuZXJhbGx5IGF2b2lkIHN0b3BwaW5nIHByb3BhZ2F0aW9uIG9mIGV2ZW50cywgYnV0IHRoaXMgaXMgbmVlZGVkIHRvIGFkaGVyZSB0byB0aGUgaW50ZW5kZWQgc3BlYyBjaGFuZ2VzIGFib3ZlIOKaoFxuICBpZiAoZGlzYWJsZWQpIHtcbiAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG59XG5jb25zdCBjYXB0dXJlT25seU9wdGlvbnMgPSB7IGNhcHR1cmU6IHRydWUgfTtcbi8qKlxuICogVGhpcyBoZWxwZXIgdXBkYXRlcyB0aGUgaG9zdCBlbGVtZW50IHRvIHByZXZlbnQga2V5Ym9hcmQgaW50ZXJhY3Rpb24gb24gaXRzIHN1YnRyZWUgYW5kIHNldHMgdGhlIGFwcHJvcHJpYXRlIGFyaWEgYXR0cmlidXRlIGZvciBhY2Nlc3NpYmlsaXR5LlxuICpcbiAqIFRoaXMgc2hvdWxkIGJlIHVzZWQgaW4gdGhlIGBjb21wb25lbnREaWRSZW5kZXJgIGxpZmVjeWNsZSBob29rLlxuICpcbiAqICoqTm90ZXMqKlxuICpcbiAqIHRoaXMgdXRpbCBpcyBub3QgbmVlZGVkIGZvciBzaW1wbGUgY29tcG9uZW50cyB3aG9zZSByb290IGVsZW1lbnQgb3IgZWxlbWVudHMgYXJlIGFuIGludGVyYWN0aXZlIGNvbXBvbmVudCAoY3VzdG9tIGVsZW1lbnQgb3IgbmF0aXZlIGNvbnRyb2wpLiBGb3IgdGhvc2UgY2FzZXMsIHNldCB0aGUgYGRpc2FibGVkYCBwcm9wcyBvbiB0aGUgcm9vdCBjb21wb25lbnRzIGluc3RlYWQuXG4gKiB0ZWNobmljYWxseSwgdXNlcnMgY2FuIG92ZXJyaWRlIGB0YWJpbmRleGAgYW5kIHJlc3RvcmUga2V5Ym9hcmQgbmF2aWdhdGlvbiwgYnV0IHRoaXMgd2lsbCBiZSBjb25zaWRlcmVkIHVzZXIgZXJyb3JcbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50XG4gKiBAcGFyYW0gaG9zdElzVGFiYmFibGUg4oCTIHdoZW4gc2V0IHRvIHRydWUgb3IgaXRzIHByZWRpY2F0ZSByZXR1cm5zIHRydWUsIHRoZSBob3N0IGlzIHRhYmJhYmxlIGFuZCB3aWxsIGJlIG1hbmFnZWQgYnkgdGhlIGhlbHBlci4gU2V0IHRvIFwibWFuYWdlZFwiIGZvciBjYXNlcyB3aGVyZSBhIGNvbXBvbmVudCdzIHBhcmVudCBkZXRlcm1pbmVzIHdoaWNoIGl0ZW0gaXMgdGFiYmFibGUgKGkuZS4sIHNldHMgYHRhYmluZGV4YCB0byBhbGxvdyB0YWJiaW5nKS5cbiAqL1xuZnVuY3Rpb24gdXBkYXRlSG9zdEludGVyYWN0aW9uKGNvbXBvbmVudCwgaG9zdElzVGFiYmFibGUgPSBmYWxzZSkge1xuICBpZiAoY29tcG9uZW50LmRpc2FibGVkKSB7XG4gICAgY29tcG9uZW50LmVsLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gICAgY29tcG9uZW50LmVsLnNldEF0dHJpYnV0ZShcImFyaWEtZGlzYWJsZWRcIiwgXCJ0cnVlXCIpO1xuICAgIGlmIChjb21wb25lbnQuZWwuY29udGFpbnMoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkpIHtcbiAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuICAgIH1cbiAgICBibG9ja0ludGVyYWN0aW9uKGNvbXBvbmVudCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIHJlc3RvcmVJbnRlcmFjdGlvbihjb21wb25lbnQpO1xuICBpZiAodHlwZW9mIGhvc3RJc1RhYmJhYmxlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBjb21wb25lbnQuZWwuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgaG9zdElzVGFiYmFibGUuY2FsbChjb21wb25lbnQpID8gXCIwXCIgOiBcIi0xXCIpO1xuICB9XG4gIGVsc2UgaWYgKGhvc3RJc1RhYmJhYmxlID09PSB0cnVlKSB7XG4gICAgY29tcG9uZW50LmVsLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiMFwiKTtcbiAgfVxuICBlbHNlIGlmIChob3N0SXNUYWJiYWJsZSA9PT0gZmFsc2UpIHtcbiAgICBjb21wb25lbnQuZWwucmVtb3ZlQXR0cmlidXRlKFwidGFiaW5kZXhcIik7XG4gIH1cbiAgZWxzZSA7XG4gIGNvbXBvbmVudC5lbC5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWRpc2FibGVkXCIpO1xufVxuZnVuY3Rpb24gYmxvY2tJbnRlcmFjdGlvbihjb21wb25lbnQpIHtcbiAgY29tcG9uZW50LmVsLmNsaWNrID0gaW50ZXJjZXB0ZWRDbGljaztcbiAgYWRkSW50ZXJhY3Rpb25MaXN0ZW5lcnMoaXNGaXJlZm94ID8gZ2V0UGFyZW50RWxlbWVudChjb21wb25lbnQpIDogY29tcG9uZW50LmVsKTtcbn1cbmZ1bmN0aW9uIGFkZEludGVyYWN0aW9uTGlzdGVuZXJzKGVsZW1lbnQpIHtcbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgLy8gdGhpcyBwYXRoIGlzIG9ubHkgYXBwbGljYWJsZSB0byBGaXJlZm94XG4gICAgcmV0dXJuO1xuICB9XG4gIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIG9uUG9pbnRlckRvd24sIGNhcHR1cmVPbmx5T3B0aW9ucyk7XG4gIG5vbkJ1YmJsaW5nV2hlbkRpc2FibGVkTW91c2VFdmVudHMuZm9yRWFjaCgoZXZlbnQpID0+IGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgb25Ob25CdWJibGluZ1doZW5EaXNhYmxlZE1vdXNlRXZlbnQsIGNhcHR1cmVPbmx5T3B0aW9ucykpO1xufVxuZnVuY3Rpb24gZ2V0UGFyZW50RWxlbWVudChjb21wb25lbnQpIHtcbiAgcmV0dXJuIGludGVyYWN0aXZlRWxlbWVudFRvUGFyZW50LmdldChjb21wb25lbnQuZWwpO1xufVxuZnVuY3Rpb24gcmVzdG9yZUludGVyYWN0aW9uKGNvbXBvbmVudCkge1xuICBkZWxldGUgY29tcG9uZW50LmVsLmNsaWNrOyAvLyBmYWxsYmFjayBvbiBIVE1MRWxlbWVudC5wcm90b3R5cGUuY2xpY2tcbiAgcmVtb3ZlSW50ZXJhY3Rpb25MaXN0ZW5lcnMoaXNGaXJlZm94ID8gZ2V0UGFyZW50RWxlbWVudChjb21wb25lbnQpIDogY29tcG9uZW50LmVsKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUludGVyYWN0aW9uTGlzdGVuZXJzKGVsZW1lbnQpIHtcbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgLy8gdGhpcyBwYXRoIGlzIG9ubHkgYXBwbGljYWJsZSB0byBGaXJlZm94XG4gICAgcmV0dXJuO1xuICB9XG4gIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIG9uUG9pbnRlckRvd24sIGNhcHR1cmVPbmx5T3B0aW9ucyk7XG4gIG5vbkJ1YmJsaW5nV2hlbkRpc2FibGVkTW91c2VFdmVudHMuZm9yRWFjaCgoZXZlbnQpID0+IGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgb25Ob25CdWJibGluZ1doZW5EaXNhYmxlZE1vdXNlRXZlbnQsIGNhcHR1cmVPbmx5T3B0aW9ucykpO1xufVxuLyoqXG4gKiBUaGlzIHV0aWxpdHkgaGVscHMgZGlzYWJsZSBjb21wb25lbnRzIGNvbnNpc3RlbnRseSBpbiBGaXJlZm94LlxuICpcbiAqIEl0IG5lZWRzIHRvIGJlIGNhbGxlZCBpbiBgY29ubmVjdGVkQ2FsbGJhY2tgIGFuZCBpcyBvbmx5IG5lZWRlZCBmb3IgRmlyZWZveCBhcyBpdCBkb2VzIG5vdCBjYWxsIGNhcHR1cmUgZXZlbnQgbGlzdGVuZXJzIGJlZm9yZSBub24tY2FwdHVyZSBvbmVzIChzZWUgaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTczMTUwNCkuXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICovXG5mdW5jdGlvbiBjb25uZWN0SW50ZXJhY3RpdmUoY29tcG9uZW50KSB7XG4gIGlmICghY29tcG9uZW50LmRpc2FibGVkIHx8ICFpc0ZpcmVmb3gpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgcGFyZW50ID0gY29tcG9uZW50LmVsLnBhcmVudEVsZW1lbnQgfHwgY29tcG9uZW50LmVsOyAvKiBhc3N1bWUgZWxlbWVudCBpcyBob3N0IGlmIGl0IGhhcyBubyBwYXJlbnQgd2hlbiBjb25uZWN0ZWQgKi9cbiAgaW50ZXJhY3RpdmVFbGVtZW50VG9QYXJlbnQuc2V0KGNvbXBvbmVudC5lbCwgcGFyZW50KTtcbiAgYmxvY2tJbnRlcmFjdGlvbihjb21wb25lbnQpO1xufVxuLyoqXG4gKiBUaGlzIHV0aWxpdHkgcmVzdG9yZXMgaW50ZXJhY3Rpdml0eSB0byBkaXNhYmxlZCBjb21wb25lbnRzIGNvbnNpc3RlbnRseSBpbiBGaXJlZm94LlxuICpcbiAqIEl0IG5lZWRzIHRvIGJlIGNhbGxlZCBpbiBgZGlzY29ubmVjdGVkQ2FsbGJhY2tgIGFuZCBpcyBvbmx5IG5lZWRlZCBmb3IgRmlyZWZveCBhcyBpdCBkb2VzIG5vdCBjYWxsIGNhcHR1cmUgZXZlbnQgbGlzdGVuZXJzIGJlZm9yZSBub24tY2FwdHVyZSBvbmVzIChzZWUgaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTczMTUwNCkuXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICovXG5mdW5jdGlvbiBkaXNjb25uZWN0SW50ZXJhY3RpdmUoY29tcG9uZW50KSB7XG4gIGlmICghaXNGaXJlZm94KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8vIGFsd2F5cyByZW1vdmUgb24gZGlzY29ubmVjdCBhcyByZW5kZXIgb3IgY29ubmVjdCB3aWxsIHJlc3RvcmUgaXRcbiAgaW50ZXJhY3RpdmVFbGVtZW50VG9QYXJlbnQuZGVsZXRlKGNvbXBvbmVudC5lbCk7XG4gIHJlc3RvcmVJbnRlcmFjdGlvbihjb21wb25lbnQpO1xufVxuXG5leHBvcnQgeyBjb25uZWN0SW50ZXJhY3RpdmUgYXMgYywgZGlzY29ubmVjdEludGVyYWN0aXZlIGFzIGQsIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbiBhcyB1IH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWludGVyYWN0aXZlLWNiZDhhNmRjLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2Mi4wLjBcbiAqL1xuLyoqXG4gKiBUaGlzIHV0aWxpdHkgZW5zdXJlcyBvYnNlcnZlcnMgYXJlIGNyZWF0ZWQgb25seSBmb3IgYnJvd3NlciBjb250ZXh0cy5cbiAqXG4gKiBAcGFyYW0gdHlwZSAtIHRoZSB0eXBlIG9mIG9ic2VydmVyIHRvIGNyZWF0ZVxuICogQHBhcmFtIGNhbGxiYWNrIC0gdGhlIG9ic2VydmVyIGNhbGxiYWNrXG4gKiBAcGFyYW0gb3B0aW9ucyAtIHRoZSBvYnNlcnZlciBvcHRpb25zXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZU9ic2VydmVyKHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zKSB7XG4gIGNvbnN0IE9ic2VydmVyID0gZ2V0T2JzZXJ2ZXIodHlwZSk7XG4gIHJldHVybiBuZXcgT2JzZXJ2ZXIoY2FsbGJhY2ssIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gZ2V0T2JzZXJ2ZXIodHlwZSkge1xuICAvLyBiYXNlZCBvbiBodHRwczovL2dpdGh1Yi5jb20vd2hhdHdnL2RvbS9pc3N1ZXMvMTI2I2lzc3VlY29tbWVudC0xMDQ5ODE0OTQ4XG4gIGNsYXNzIEV4dGVuZGVkTXV0YXRpb25PYnNlcnZlciBleHRlbmRzIHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihjYWxsYmFjaykge1xuICAgICAgc3VwZXIoY2FsbGJhY2spO1xuICAgICAgdGhpcy5vYnNlcnZlZEVudHJ5ID0gW107XG4gICAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfVxuICAgIG9ic2VydmUodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgICB0aGlzLm9ic2VydmVkRW50cnkucHVzaCh7IHRhcmdldCwgb3B0aW9ucyB9KTtcbiAgICAgIHJldHVybiBzdXBlci5vYnNlcnZlKHRhcmdldCwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHVub2JzZXJ2ZSh0YXJnZXQpIHtcbiAgICAgIGNvbnN0IG5ld09ic2VydmVkRW50cmllcyA9IHRoaXMub2JzZXJ2ZWRFbnRyeS5maWx0ZXIoKG9ic2VydmVkKSA9PiBvYnNlcnZlZC50YXJnZXQgIT09IHRhcmdldCk7XG4gICAgICB0aGlzLm9ic2VydmVkRW50cnkgPSBbXTtcbiAgICAgIHRoaXMuY2FsbGJhY2soc3VwZXIudGFrZVJlY29yZHMoKSwgdGhpcyk7XG4gICAgICB0aGlzLmRpc2Nvbm5lY3QoKTtcbiAgICAgIG5ld09ic2VydmVkRW50cmllcy5mb3JFYWNoKChvYnNlcnZlZCkgPT4gdGhpcy5vYnNlcnZlKG9ic2VydmVkLnRhcmdldCwgb2JzZXJ2ZWQub3B0aW9ucykpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gKHR5cGUgPT09IFwiaW50ZXJzZWN0aW9uXCJcbiAgICAgID8gd2luZG93LkludGVyc2VjdGlvbk9ic2VydmVyXG4gICAgICA6IHR5cGUgPT09IFwibXV0YXRpb25cIlxuICAgICAgICA/IEV4dGVuZGVkTXV0YXRpb25PYnNlcnZlclxuICAgICAgICA6IHdpbmRvdy5SZXNpemVPYnNlcnZlcik7XG4gIH0pKCk7XG59XG5cbmV4cG9ydCB7IGNyZWF0ZU9ic2VydmVyIGFzIGMgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JzZXJ2ZXJzLTcxZDMzMmRiLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==