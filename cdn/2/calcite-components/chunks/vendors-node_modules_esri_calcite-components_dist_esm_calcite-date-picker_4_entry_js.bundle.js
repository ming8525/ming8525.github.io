"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-node_modules_esri_calcite-components_dist_esm_calcite-date-picker_4_entry_js"],{

/***/ "./node_modules/@esri/calcite-components/dist/esm/Heading-b6ae61b8.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/Heading-b6ae61b8.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   H: () => (/* binding */ Heading),
/* harmony export */   c: () => (/* binding */ constrainHeadingLevel)
/* harmony export */ });
/* harmony import */ var _index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-86faef9c.js */ "./node_modules/@esri/calcite-components/dist/esm/index-86faef9c.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */


function constrainHeadingLevel(level) {
  return Math.min(Math.max(Math.ceil(level), 1), 6);
}
const Heading = (props, children) => {
  const HeadingTag = props.level ? `h${props.level}` : "div";
  delete props.level;
  return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(HeadingTag, { ...props }, children);
};



//# sourceMappingURL=Heading-b6ae61b8.js.map

/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/esm/calcite-date-picker_4.entry.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/calcite-date-picker_4.entry.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calcite_date_picker: () => (/* binding */ DatePicker),
/* harmony export */   calcite_date_picker_day: () => (/* binding */ DatePickerDay),
/* harmony export */   calcite_date_picker_month: () => (/* binding */ DatePickerMonth),
/* harmony export */   calcite_date_picker_month_header: () => (/* binding */ DatePickerMonthHeader)
/* harmony export */ });
/* harmony import */ var _index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-86faef9c.js */ "./node_modules/@esri/calcite-components/dist/esm/index-86faef9c.js");
/* harmony import */ var _utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils-ad0af80b.js */ "./node_modules/@esri/calcite-components/dist/esm/utils-ad0af80b.js");
/* harmony import */ var _loadable_b17396e0_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./loadable-b17396e0.js */ "./node_modules/@esri/calcite-components/dist/esm/loadable-b17396e0.js");
/* harmony import */ var _locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locale-6e783cf0.js */ "./node_modules/@esri/calcite-components/dist/esm/locale-6e783cf0.js");
/* harmony import */ var _t9n_0bcdca54_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./t9n-0bcdca54.js */ "./node_modules/@esri/calcite-components/dist/esm/t9n-0bcdca54.js");
/* harmony import */ var _dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./dom-ed00a585.js */ "./node_modules/@esri/calcite-components/dist/esm/dom-ed00a585.js");
/* harmony import */ var _interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./interactive-cbd8a6dc.js */ "./node_modules/@esri/calcite-components/dist/esm/interactive-cbd8a6dc.js");
/* harmony import */ var _key_61f82ddb_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./key-61f82ddb.js */ "./node_modules/@esri/calcite-components/dist/esm/key-61f82ddb.js");
/* harmony import */ var _Heading_b6ae61b8_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Heading-b6ae61b8.js */ "./node_modules/@esri/calcite-components/dist/esm/Heading-b6ae61b8.js");
/* harmony import */ var _component_f94cab72_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./component-f94cab72.js */ "./node_modules/@esri/calcite-components/dist/esm/component-f94cab72.js");
/* harmony import */ var _observers_71d332db_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./observers-71d332db.js */ "./node_modules/@esri/calcite-components/dist/esm/observers-71d332db.js");
/* harmony import */ var _guid_21fecfa4_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./guid-21fecfa4.js */ "./node_modules/@esri/calcite-components/dist/esm/guid-21fecfa4.js");
/* harmony import */ var _resources_cf82388c_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./resources-cf82388c.js */ "./node_modules/@esri/calcite-components/dist/esm/resources-cf82388c.js");
/* harmony import */ var _browser_ece29da7_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./browser-ece29da7.js */ "./node_modules/@esri/calcite-components/dist/esm/browser-ece29da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */















const HEADING_LEVEL = 2;
const DATE_PICKER_FORMAT_OPTIONS = { dateStyle: "full" };

const datePickerCss = ":host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{display:inline-block;inline-size:auto;overflow:visible;border-radius:0px;border-width:1px;border-style:solid;border-color:var(--calcite-color-border-1);vertical-align:top}:host([scale=s]){inline-size:234px;min-inline-size:216px;max-inline-size:380px}:host([scale=m]){inline-size:304px;min-inline-size:272px;max-inline-size:480px}:host([scale=l]){inline-size:370px;min-inline-size:320px;max-inline-size:600px}:host([hidden]){display:none}[hidden]{display:none}";

const DatePicker = class {
  constructor(hostRef) {
    (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteDatePickerChange = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteDatePickerChange", 6);
    this.calciteDatePickerRangeChange = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteDatePickerRangeChange", 6);
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    this.keyDownHandler = (event) => {
      if (event.key === "Escape") {
        this.resetActiveDates();
      }
    };
    this.monthHeaderSelectChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthActiveDateChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthHoverChange = (event) => {
      if (!this.range) {
        this.hoverRange = undefined;
        return;
      }
      const { valueAsDate } = this;
      const start = Array.isArray(valueAsDate) && valueAsDate[0];
      const end = Array.isArray(valueAsDate) && valueAsDate[1];
      const date = new Date(event.detail);
      this.hoverRange = {
        focused: this.activeRange || "start",
        start,
        end,
      };
      if (!this.proximitySelectionDisabled) {
        if (end) {
          const startDiff = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.j)(date, start);
          const endDiff = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.j)(date, end);
          if (endDiff > 0) {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
          else if (startDiff < 0) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else if (startDiff > endDiff) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          if (start) {
            if (date < start) {
              this.hoverRange = {
                focused: "start",
                start: date,
                end: start,
              };
            }
            else {
              this.hoverRange.end = date;
              this.hoverRange.focused = "end";
            }
          }
        }
      }
      else {
        if (!end) {
          if (date < start) {
            this.hoverRange = {
              focused: "start",
              start: date,
              end: start,
            };
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          this.hoverRange = undefined;
        }
      }
      event.stopPropagation();
    };
    this.monthMouseOutChange = () => {
      if (this.hoverRange) {
        this.hoverRange = undefined;
      }
    };
    this.resetActiveDates = () => {
      const { valueAsDate } = this;
      if (!Array.isArray(valueAsDate) && valueAsDate && valueAsDate !== this.activeDate) {
        this.activeDate = new Date(valueAsDate);
      }
      if (Array.isArray(valueAsDate)) {
        if (valueAsDate[0] && valueAsDate[0] !== this.activeStartDate) {
          this.activeStartDate = new Date(valueAsDate[0]);
        }
        if (valueAsDate[1] && valueAsDate[1] !== this.activeEndDate) {
          this.activeEndDate = new Date(valueAsDate[1]);
        }
      }
    };
    /**
     * Event handler for when the selected date changes
     *
     * @param event
     */
    this.monthDateChange = (event) => {
      const date = new Date(event.detail);
      const isoDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.c)(date);
      if (!this.range && isoDate === (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.valueAsDate)) {
        return;
      }
      if (!this.range) {
        this.value = isoDate || "";
        this.valueAsDate = date || null;
        this.activeDate = date || null;
        this.calciteDatePickerChange.emit();
        return;
      }
      const start = this.getStartDate();
      const end = this.getEndDate();
      if (!start || (!end && date < start)) {
        if (start) {
          this.setEndDate(new Date(start));
        }
        if (this.activeRange == "end") {
          this.setEndDate(date);
        }
        else {
          this.setStartDate(date);
        }
      }
      else if (!end) {
        this.setEndDate(date);
      }
      else {
        if (!this.proximitySelectionDisabled) {
          if (this.activeRange) {
            if (this.activeRange == "end") {
              this.setEndDate(date);
            }
            else {
              this.setStartDate(date);
            }
          }
          else {
            const startDiff = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.j)(date, start);
            const endDiff = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.j)(date, end);
            if (endDiff === 0 || startDiff < 0) {
              this.setStartDate(date);
            }
            else if (startDiff === 0 || endDiff < 0) {
              this.setEndDate(date);
            }
            else if (startDiff < endDiff) {
              this.setStartDate(date);
            }
            else {
              this.setEndDate(date);
            }
          }
        }
        else {
          this.setStartDate(date);
        }
      }
      this.calciteDatePickerChange.emit();
    };
    this.activeDate = undefined;
    this.activeRange = undefined;
    this.value = undefined;
    this.headingLevel = undefined;
    this.valueAsDate = undefined;
    this.minAsDate = undefined;
    this.maxAsDate = undefined;
    this.min = undefined;
    this.max = undefined;
    this.numberingSystem = undefined;
    this.scale = "m";
    this.range = false;
    this.proximitySelectionDisabled = false;
    this.messageOverrides = undefined;
    this.messages = undefined;
    this.activeEndDate = undefined;
    this.activeStartDate = undefined;
    this.dateTimeFormat = undefined;
    this.defaultMessages = undefined;
    this.effectiveLocale = "";
    this.endAsDate = undefined;
    this.hoverRange = undefined;
    this.localeData = undefined;
    this.mostRecentRangeValue = undefined;
    this.startAsDate = undefined;
  }
  activeDateWatcher(newActiveDate) {
    if (this.activeRange === "end") {
      this.activeEndDate = newActiveDate;
    }
  }
  valueAsDateWatcher(newValueAsDate) {
    if (this.range && Array.isArray(newValueAsDate)) {
      const { activeStartDate, activeEndDate } = this;
      const newActiveStartDate = newValueAsDate[0];
      const newActiveEndDate = newValueAsDate[1];
      this.activeStartDate = activeStartDate !== newActiveStartDate && newActiveStartDate;
      this.activeEndDate = activeEndDate !== newActiveEndDate && newActiveEndDate;
    }
    else if (newValueAsDate && newValueAsDate !== this.activeDate) {
      this.activeDate = newValueAsDate;
    }
  }
  onMinChanged(min) {
    if (min) {
      this.minAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.e)(min);
    }
  }
  onMaxChanged(max) {
    if (max) {
      this.maxAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.e)(max);
    }
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  //--------------------------------------------------------------------------
  //
  //  Public Methods
  //
  //--------------------------------------------------------------------------
  /** Sets focus on the component's first focusable element. */
  async setFocus() {
    await (0,_loadable_b17396e0_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    this.el.focus();
  }
  /**
   * Resets active date state.
   * @internal
   */
  async reset() {
    this.resetActiveDates();
    this.mostRecentRangeValue = undefined;
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  connectedCallback() {
    (0,_locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    (0,_t9n_0bcdca54_js__WEBPACK_IMPORTED_MODULE_4__.c)(this);
    if (Array.isArray(this.value)) {
      this.valueAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.g)(this.value);
    }
    else if (this.value) {
      this.valueAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.value);
    }
    if (this.min) {
      this.minAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.min);
    }
    if (this.max) {
      this.maxAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.max);
    }
  }
  disconnectedCallback() {
    (0,_locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
    (0,_t9n_0bcdca54_js__WEBPACK_IMPORTED_MODULE_4__.d)(this);
  }
  async componentWillLoad() {
    (0,_loadable_b17396e0_js__WEBPACK_IMPORTED_MODULE_2__.s)(this);
    await this.loadLocaleData();
    this.onMinChanged(this.min);
    this.onMaxChanged(this.max);
    await (0,_t9n_0bcdca54_js__WEBPACK_IMPORTED_MODULE_4__.s)(this);
  }
  componentDidLoad() {
    (0,_loadable_b17396e0_js__WEBPACK_IMPORTED_MODULE_2__.a)(this);
  }
  render() {
    const date = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(this.range && Array.isArray(this.valueAsDate) ? this.valueAsDate[0] : this.valueAsDate, this.minAsDate, this.maxAsDate);
    let activeDate = this.getActiveDate(date, this.minAsDate, this.maxAsDate);
    const endDate = this.range && Array.isArray(this.valueAsDate)
      ? (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(this.valueAsDate[1], this.minAsDate, this.maxAsDate)
      : null;
    const activeEndDate = this.getActiveEndDate(endDate, this.minAsDate, this.maxAsDate);
    if ((this.activeRange === "end" ||
      (this.hoverRange?.focused === "end" && (!this.proximitySelectionDisabled || endDate))) &&
      activeEndDate) {
      activeDate = activeEndDate;
    }
    if (this.range && this.mostRecentRangeValue) {
      activeDate = this.mostRecentRangeValue;
    }
    const minDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? this.minAsDate
        : date || this.minAsDate
      : this.minAsDate;
    const maxDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? endDate || this.maxAsDate
        : this.maxAsDate
      : this.maxAsDate;
    return ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.H, { onBlur: this.resetActiveDates, onKeyDown: this.keyDownHandler }, this.renderCalendar(activeDate, maxDate, minDate, date, endDate)));
  }
  effectiveLocaleChange() {
    (0,_t9n_0bcdca54_js__WEBPACK_IMPORTED_MODULE_4__.u)(this, this.effectiveLocale);
  }
  valueHandler(value) {
    if (Array.isArray(value)) {
      this.valueAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.g)(value);
    }
    else if (value) {
      this.valueAsDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.e)(value);
    }
  }
  async loadLocaleData() {
    _locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.numberFormatOptions = {
      numberingSystem: this.numberingSystem,
      locale: this.effectiveLocale,
      useGrouping: false,
    };
    this.localeData = await (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.f)(this.effectiveLocale);
    this.dateTimeFormat = (0,_locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.e)(this.effectiveLocale, DATE_PICKER_FORMAT_OPTIONS);
  }
  /**
   * Render calcite-date-picker-month-header and calcite-date-picker-month
   *
   * @param activeDate
   * @param maxDate
   * @param minDate
   * @param date
   * @param endDate
   */
  renderCalendar(activeDate, maxDate, minDate, date, endDate) {
    return (this.localeData && [
      (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker-month-header", { activeDate: activeDate, headingLevel: this.headingLevel || HEADING_LEVEL, localeData: this.localeData, max: maxDate, messages: this.messages, min: minDate, onCalciteInternalDatePickerSelect: this.monthHeaderSelectChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date || new Date() }),
      (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker-month", { activeDate: activeDate, dateTimeFormat: this.dateTimeFormat, endDate: this.range ? endDate : undefined, hoverRange: this.hoverRange, localeData: this.localeData, max: maxDate, min: minDate, onCalciteInternalDatePickerActiveDateChange: this.monthActiveDateChange, onCalciteInternalDatePickerHover: this.monthHoverChange, onCalciteInternalDatePickerMouseOut: this.monthMouseOutChange, onCalciteInternalDatePickerSelect: this.monthDateChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date, startDate: this.range ? date : undefined }),
    ]);
  }
  getEndDate() {
    return (Array.isArray(this.valueAsDate) && this.valueAsDate[1]) || undefined;
  }
  setEndDate(date) {
    const startDate = this.getStartDate();
    const newEndDate = date ? (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.s)(date) : date;
    this.value = [(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.c)(startDate), (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.c)(date)];
    this.valueAsDate = [startDate, date];
    this.mostRecentRangeValue = newEndDate;
    this.calciteDatePickerRangeChange.emit();
    this.activeEndDate = date || null;
  }
  getStartDate() {
    return Array.isArray(this.valueAsDate) && this.valueAsDate[0];
  }
  setStartDate(date) {
    const endDate = this.getEndDate();
    this.value = [(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.c)(date), (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.c)(endDate)];
    this.valueAsDate = [date, endDate];
    this.mostRecentRangeValue = date;
    this.calciteDatePickerRangeChange.emit();
    this.activeStartDate = date || null;
  }
  /**
   * Get an active date using the value, or current date as default
   *
   * @param value
   * @param min
   * @param max
   */
  getActiveDate(value, min, max) {
    return (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(this.activeDate, min, max) || value || (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(new Date(), min, max);
  }
  getActiveEndDate(value, min, max) {
    return ((0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(this.activeEndDate, min, max) || value || (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(new Date(), min, max));
  }
  static get delegatesFocus() { return true; }
  static get assetsDirs() { return ["assets"]; }
  get el() { return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
  static get watchers() { return {
    "activeDate": ["activeDateWatcher"],
    "valueAsDate": ["valueAsDateWatcher"],
    "min": ["onMinChanged"],
    "max": ["onMaxChanged"],
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange", "loadLocaleData"],
    "value": ["valueHandler"]
  }; }
};
DatePicker.style = datePickerCss;

const datePickerDayCss = ":host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{position:relative;display:flex;cursor:pointer;color:var(--calcite-color-text-3)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.day-v-wrapper{flex:1 1 auto}.day-wrapper{position:relative;display:flex;flex-direction:column;align-items:center}:host([range]) .day-wrapper:before,:host([range]) .day-wrapper:after,:host([range-hover]) .day-wrapper:before,:host([range-hover]) .day-wrapper:after{pointer-events:none;position:absolute;inset-block:0;content:\"\";block-size:var(--calcite-internal-day-size);inline-size:var(--calcite-internal-day-size)}.day{z-index:var(--calcite-z-index);display:flex;align-items:center;justify-content:center;border-radius:9999px;font-size:var(--calcite-font-size--2);line-height:1rem;line-height:1;color:var(--calcite-color-text-3);outline-color:transparent;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;background:none;box-shadow:0 0 0 2px transparent;block-size:var(--calcite-internal-day-size);inline-size:var(--calcite-internal-day-size)}.text{margin-block:1px 0px;margin-inline-start:0px}:host([scale=s]){--calcite-internal-day-size:27px}:host([scale=s]) .day-v-wrapper{padding-block:0.125rem}:host([scale=s]) .day-wrapper{padding:0px}:host([scale=s]) .day{font-size:var(--calcite-font-size--2)}:host([scale=m]){--calcite-internal-day-size:33px}:host([scale=m]) .day-v-wrapper{padding-block:0.25rem}:host([scale=m]) .day-wrapper{padding:0px}:host([scale=m]) .day{font-size:var(--calcite-font-size--1)}:host([scale=l]){--calcite-internal-day-size:43px}:host([scale=l]) .day-v-wrapper{padding-block:0.25rem}:host([scale=l]) .day-wrapper{padding-inline:0.25rem}:host([scale=l]) .day{font-size:var(--calcite-font-size-0)}:host(:not([current-month])) .day{opacity:var(--calcite-opacity-disabled)}:host(:hover:not([disabled]):not([selected])) .day,:host([active]:not([range]):not([selected])) .day{background-color:var(--calcite-color-foreground-2);color:var(--calcite-color-text-1)}:host(:focus),:host([active]){outline:2px solid transparent;outline-offset:2px}:host(:focus:not([disabled])) .day{outline:2px solid var(--calcite-color-brand);outline-offset:calc(\n            2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-offset-invert-focus),\n                1\n              )\n            )\n          )}:host([selected]) .day{font-weight:var(--calcite-font-weight-medium);background-color:var(--calcite-color-brand);color:var(--calcite-color-foreground-1)}:host(:focus:not([disabled])) .day,:host([start-of-range]:not(:focus)) .day,:host([end-of-range]:not(:focus)) .day{box-shadow:0 0 0 2px var(--calcite-color-foreground-1)}:host([range-hover]:not([selected])) .day-wrapper:before,:host([highlighted]:not([selected])) .day-wrapper:before{inset-inline-end:50%;border-radius:0}:host([range-hover]:not([selected])) .day-wrapper:after,:host([highlighted]:not([selected])) .day-wrapper:after{inset-inline-start:50%;border-radius:0}:host([range-hover]:not([selected])) .day,:host([highlighted]:not([selected])) .day{color:var(--calcite-color-text-1)}:host([highlighted]) .day-wrapper:before,:host([highlighted]) .day-wrapper:after,:host([selected]:not(.hover--outside-range)) .day-wrapper:before,:host([selected]:not(.hover--outside-range)) .day-wrapper:after{background-color:var(--calcite-color-foreground-current)}:host([range-hover]:not([selected])) .day-wrapper:before,:host([range-hover]:not([selected])) .day-wrapper:after{background-color:var(--calcite-color-foreground-2)}:host(:hover[range-hover]:not([selected]).focused--end) .day-wrapper:before,:host([highlighted][end-of-range]) .day-wrapper:before,:host([highlighted][range-edge=end]) .day-wrapper:before,:host([range-hover][range-edge=end]) .day-wrapper:before,:host(:hover[range-hover].focused--end.hover--outside-range) .day-wrapper:before{inset-inline-end:50%}:host(:hover[range-hover]:not([selected]).focused--end) .day-wrapper:after,:host([highlighted][end-of-range]) .day-wrapper:after,:host([highlighted][range-edge=end]) .day-wrapper:after,:host([range-hover][range-edge=end]) .day-wrapper:after,:host(:hover[range-hover].focused--end.hover--outside-range) .day-wrapper:after{inset-inline-start:50%;border-start-end-radius:var(--calcite-internal-day-size);border-end-end-radius:var(--calcite-internal-day-size);inline-size:calc(var(--calcite-internal-day-size) / 2)}:host([highlighted][start-of-range]) .day-wrapper:before,:host([highlighted][range-edge=start]) .day-wrapper:before,:host([range-hover][range-edge=start]) .day-wrapper:before,:host(:hover[range-hover]:not([selected]).focused--start) .day-wrapper:before,:host([start-of-range].hover--inside-range) .day-wrapper:before,:host(:hover[range-hover].focused--start.hover--outside-range) .day-wrapper:before{inset-inline-end:50%;border-start-start-radius:var(--calcite-internal-day-size);border-end-start-radius:var(--calcite-internal-day-size);inline-size:calc(var(--calcite-internal-day-size) / 2)}:host([highlighted][start-of-range]) .day-wrapper:after,:host([highlighted][range-edge=start]) .day-wrapper:after,:host([range-hover][range-edge=start]) .day-wrapper:after,:host(:hover[range-hover]:not([selected]).focused--start) .day-wrapper:after,:host([start-of-range].hover--inside-range) .day-wrapper:after,:host(:hover[range-hover].focused--start.hover--outside-range) .day-wrapper:after{inset-inline-start:50%}:host([range-hover][start-of-range][range-edge=end]) .day-wrapper:after,:host([range-hover][start-of-range][range-edge=end]) .day-wrapper:before,:host([range-hover][end-of-range][range-edge=start]) .day-wrapper:after,:host([range-hover][end-of-range][range-edge=start]) .day-wrapper:before,:host([start-of-range][range-edge=end].hover--inside-range) .day-wrapper:after,:host([start-of-range][range-edge=end].hover--inside-range) .day-wrapper:before,:host([end-of-range]) .day-wrapper:after,:host([end-of-range]) .day-wrapper:before{content:unset}:host(:hover[range-hover]:not([selected]).focused--start) .day,:host(:hover[range-hover]:not([selected]).focused--end) .day,:host(:hover[range-hover]:not([selected]).focused--start.hover--outside-range) .day,:host(:hover[range-hover]:not([selected]).focused--end.hover--outside-range) .day{box-shadow:0 0 0 2px var(--calcite-color-foreground-1)}@media (forced-colors: active){.day{border-radius:0px}:host([selected]){outline:2px solid canvasText}:host(:hover:not([selected])) .day{border-radius:50%}:host([range][selected]) .day-wrapper:before,:host([range][selected]) .day-wrapper:after,:host([highlighted]) .day-wrapper:before,:host([highlighted]) .day-wrapper:after,:host([range-hover]:not([selected])) .day-wrapper:before,:host([range-hover]:not([selected])) .day-wrapper:after{background-color:highlight}:host([range-hover]) .day-wrapper:before,:host([range-hover]) .day-wrapper:after,:host([range][selected][start-of-range]) .day-wrapper:before,:host([range][selected][start-of-range]) .day-wrapper:after,:host([range][selected][end-of-range]) .day-wrapper:before,:host([range][selected][end-of-range]) .day-wrapper:after{background-color:canvas}}:host([hidden]){display:none}[hidden]{display:none}";

const DatePickerDay = class {
  constructor(hostRef) {
    (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteDaySelect = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteDaySelect", 6);
    this.calciteInternalDayHover = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteInternalDayHover", 6);
    //--------------------------------------------------------------------------
    //
    //  Event Listeners
    //
    //--------------------------------------------------------------------------
    this.onClick = () => {
      if (this.disabled) {
        return;
      }
      this.calciteDaySelect.emit();
    };
    this.keyDownHandler = (event) => {
      if ((0,_key_61f82ddb_js__WEBPACK_IMPORTED_MODULE_7__.i)(event.key)) {
        !this.disabled && this.calciteDaySelect.emit();
        event.preventDefault();
      }
    };
    this.day = undefined;
    this.dateTimeFormat = undefined;
    this.disabled = false;
    this.currentMonth = false;
    this.selected = false;
    this.highlighted = false;
    this.range = false;
    this.rangeEdge = undefined;
    this.startOfRange = false;
    this.endOfRange = false;
    this.rangeHover = false;
    this.active = false;
    this.scale = undefined;
    this.value = undefined;
  }
  pointerOverHandler() {
    if (this.disabled) {
      return;
    }
    this.calciteInternalDayHover.emit();
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  componentWillLoad() {
    this.parentDatePickerEl = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.el, "calcite-date-picker");
  }
  render() {
    const dayId = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.value).replaceAll("-", "");
    if (this.parentDatePickerEl) {
      const { numberingSystem, lang: locale } = this.parentDatePickerEl;
      _locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.numberFormatOptions = {
        useGrouping: false,
        ...(numberingSystem && { numberingSystem }),
        ...(locale && { locale }),
      };
    }
    const formattedDay = _locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.localize(String(this.day));
    const dayLabel = this.dateTimeFormat.format(this.value);
    return ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.H, { "aria-disabled": (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_5__.t)(this.disabled), "aria-label": dayLabel, "aria-selected": (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_5__.t)(this.active), id: dayId, onClick: this.onClick, onKeyDown: this.keyDownHandler, role: "button" }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { "aria-hidden": "true", class: { "day-v-wrapper": true } }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "day-wrapper" }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "day" }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "text" }, formattedDay))))));
  }
  connectedCallback() {
    (0,_interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_6__.c)(this);
  }
  componentDidRender() {
    (0,_interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_6__.u)(this, this.isTabbable);
  }
  disconnectedCallback() {
    (0,_interactive_cbd8a6dc_js__WEBPACK_IMPORTED_MODULE_6__.d)(this);
  }
  isTabbable() {
    return this.active;
  }
  get el() { return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
};
DatePickerDay.style = datePickerDayCss;

const datePickerMonthCss = ":host([hidden]){display:none}[hidden]{display:none}.calendar{margin-block-end:0.25rem}.week-headers{display:flex;border-width:0px;border-block-start-width:1px;border-style:solid;border-color:var(--calcite-color-border-3);padding-block:0px;padding-inline:0.25rem}.week-header{text-align:center;font-weight:var(--calcite-font-weight-bold);color:var(--calcite-color-text-3);inline-size:14.2857142857%}.day{display:flex;min-inline-size:0px;justify-content:center;inline-size:14.2857142857%}.day calcite-date-picker-day{inline-size:100%}:host([scale=s]) .week-header{padding-inline:0px;padding-block:0.5rem 0.75rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=m]) .week-header{padding-inline:0px;padding-block:0.75rem 1rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=l]) .week-header{padding-inline:0px;padding-block:1rem 1.25rem;font-size:var(--calcite-font-size--1);line-height:1rem}.week-days{display:flex;flex-direction:row;padding-block:0px;padding-inline:6px}.week-days:focus{outline:2px solid transparent;outline-offset:2px}";

const DAYS_PER_WEEK = 7;
const DAYS_MAXIMUM_INDEX = 6;
const DatePickerMonth = class {
  constructor(hostRef) {
    (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteInternalDatePickerSelect = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteInternalDatePickerSelect", 6);
    this.calciteInternalDatePickerHover = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteInternalDatePickerHover", 6);
    this.calciteInternalDatePickerActiveDateChange = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteInternalDatePickerActiveDateChange", 6);
    this.calciteInternalDatePickerMouseOut = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteInternalDatePickerMouseOut", 6);
    //--------------------------------------------------------------------------
    //
    //  Event Listeners
    //
    //--------------------------------------------------------------------------
    this.keyDownHandler = (event) => {
      if (event.defaultPrevented) {
        return;
      }
      const isRTL = this.el.dir === "rtl";
      switch (event.key) {
        case "ArrowUp":
          event.preventDefault();
          this.addDays(-7);
          break;
        case "ArrowRight":
          event.preventDefault();
          this.addDays(isRTL ? -1 : 1);
          break;
        case "ArrowDown":
          event.preventDefault();
          this.addDays(7);
          break;
        case "ArrowLeft":
          event.preventDefault();
          this.addDays(isRTL ? 1 : -1);
          break;
        case "PageUp":
          event.preventDefault();
          this.addMonths(-1);
          break;
        case "PageDown":
          event.preventDefault();
          this.addMonths(1);
          break;
        case "Home":
          event.preventDefault();
          this.activeDate.setDate(1);
          this.addDays();
          break;
        case "End":
          event.preventDefault();
          this.activeDate.setDate(new Date(this.activeDate.getFullYear(), this.activeDate.getMonth() + 1, 0).getDate());
          this.addDays();
          break;
        case "Enter":
        case " ":
          event.preventDefault();
          break;
        case "Tab":
          this.activeFocus = false;
      }
    };
    /**
     * Once user is not interacting via keyboard,
     * disable auto focusing of active date
     */
    this.disableActiveFocus = () => {
      this.activeFocus = false;
    };
    this.dayHover = (event) => {
      const target = event.target;
      if (target.disabled) {
        this.calciteInternalDatePickerMouseOut.emit();
      }
      else {
        this.calciteInternalDatePickerHover.emit(target.value);
      }
      event.stopPropagation();
    };
    this.daySelect = (event) => {
      const target = event.target;
      this.calciteInternalDatePickerSelect.emit(target.value);
    };
    this.dateTimeFormat = undefined;
    this.selectedDate = undefined;
    this.activeDate = new Date();
    this.startDate = undefined;
    this.endDate = undefined;
    this.min = undefined;
    this.max = undefined;
    this.scale = undefined;
    this.localeData = undefined;
    this.hoverRange = undefined;
  }
  pointerOutHandler() {
    this.calciteInternalDatePickerMouseOut.emit();
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  render() {
    const month = this.activeDate.getMonth();
    const year = this.activeDate.getFullYear();
    const startOfWeek = this.localeData.weekStart % 7;
    const { abbreviated, short, narrow } = this.localeData.days;
    const weekDays = this.scale === "s" ? narrow || short || abbreviated : short || abbreviated || narrow;
    const adjustedWeekDays = [...weekDays.slice(startOfWeek, 7), ...weekDays.slice(0, startOfWeek)];
    const curMonDays = this.getCurrentMonthDays(month, year);
    const prevMonDays = this.getPreviousMonthDays(month, year, startOfWeek);
    const nextMonDays = this.getNextMonthDays(month, year, startOfWeek);
    let dayInWeek = 0;
    const getDayInWeek = () => dayInWeek++ % 7;
    const days = [
      ...prevMonDays.map((day) => {
        return {
          active: false,
          day,
          dayInWeek: getDayInWeek(),
          date: new Date(year, month - 1, day),
        };
      }),
      ...curMonDays.map((day) => {
        const date = new Date(year, month, day);
        const active = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, this.activeDate);
        return {
          active,
          currentMonth: true,
          day,
          dayInWeek: getDayInWeek(),
          date,
          ref: true,
        };
      }),
      ...nextMonDays.map((day) => {
        return {
          active: false,
          day,
          dayInWeek: getDayInWeek(),
          date: new Date(year, month + 1, day),
        };
      }),
    ];
    const weeks = [];
    for (let i = 0; i < days.length; i += 7) {
      weeks.push(days.slice(i, i + 7));
    }
    return ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.H, { onFocusOut: this.disableActiveFocus, onKeyDown: this.keyDownHandler }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "calendar", role: "grid" }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "week-headers", role: "row" }, adjustedWeekDays.map((weekday) => ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "week-header", role: "columnheader" }, weekday)))), weeks.map((days) => ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "week-days", role: "row" }, days.map((day) => this.renderDateDay(day))))))));
  }
  //--------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  /**
   * Add n months to the current month
   *
   * @param step
   */
  addMonths(step) {
    const nextDate = new Date(this.activeDate);
    nextDate.setMonth(this.activeDate.getMonth() + step);
    this.calciteInternalDatePickerActiveDateChange.emit((0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(nextDate, this.min, this.max));
    this.activeFocus = true;
  }
  /**
   * Add n days to the current date
   *
   * @param step
   */
  addDays(step = 0) {
    const nextDate = new Date(this.activeDate);
    nextDate.setDate(this.activeDate.getDate() + step);
    this.calciteInternalDatePickerActiveDateChange.emit((0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(nextDate, this.min, this.max));
    this.activeFocus = true;
  }
  /**
   * Get dates for last days of the previous month
   *
   * @param month
   * @param year
   * @param startOfWeek
   */
  getPreviousMonthDays(month, year, startOfWeek) {
    const lastDate = new Date(year, month, 0);
    const date = lastDate.getDate();
    const startDay = lastDate.getDay();
    const days = [];
    if (startDay === (startOfWeek + DAYS_MAXIMUM_INDEX) % DAYS_PER_WEEK) {
      return days;
    }
    if (startDay === startOfWeek) {
      return [date];
    }
    for (let i = (DAYS_PER_WEEK + startDay - startOfWeek) % DAYS_PER_WEEK; i >= 0; i--) {
      days.push(date - i);
    }
    return days;
  }
  /**
   * Get dates for the current month
   *
   * @param month
   * @param year
   */
  getCurrentMonthDays(month, year) {
    const num = new Date(year, month + 1, 0).getDate();
    const days = [];
    for (let i = 0; i < num; i++) {
      days.push(i + 1);
    }
    return days;
  }
  /**
   * Get dates for first days of the next month
   *
   * @param month
   * @param year
   * @param startOfWeek
   */
  getNextMonthDays(month, year, startOfWeek) {
    const endDay = new Date(year, month + 1, 0).getDay();
    const days = [];
    if (endDay === (startOfWeek + DAYS_MAXIMUM_INDEX) % DAYS_PER_WEEK) {
      return days;
    }
    for (let i = 0; i < (DAYS_MAXIMUM_INDEX - (endDay - startOfWeek)) % DAYS_PER_WEEK; i++) {
      days.push(i + 1);
    }
    return days;
  }
  /**
   * Determine if the date is in between the start and end dates
   *
   * @param date
   */
  betweenSelectedRange(date) {
    return !!(this.startDate &&
      this.endDate &&
      date > this.startDate &&
      date < this.endDate &&
      !this.isRangeHover(date));
  }
  /**
   * Determine if the date should be in selected state
   *
   * @param date
   */
  isSelected(date) {
    return !!((0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, this.selectedDate) ||
      (this.startDate && (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, this.startDate)) ||
      (this.endDate && (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, this.endDate)));
  }
  /**
   * Determine if the date is the start of the date range
   *
   * @param date
   */
  isStartOfRange(date) {
    return !!(this.startDate &&
      !(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(this.startDate, this.endDate) &&
      (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(this.startDate, date) &&
      !this.isEndOfRange(date));
  }
  isEndOfRange(date) {
    return !!((this.endDate && !(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(this.startDate, this.endDate) && (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(this.endDate, date)) ||
      (!this.endDate &&
        this.hoverRange &&
        (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(this.startDate, this.hoverRange.end) &&
        (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, this.hoverRange.end)));
  }
  /**
   * Render calcite-date-picker-day
   *
   * @param active.active
   * @param active
   * @param day
   * @param dayInWeek
   * @param date
   * @param currentMonth
   * @param ref
   * @param active.currentMonth
   * @param active.date
   * @param active.day
   * @param active.dayInWeek
   * @param active.ref
   */
  renderDateDay({ active, currentMonth, date, day, dayInWeek, ref }) {
    const isFocusedOnStart = this.isFocusedOnStart();
    const isHoverInRange = this.isHoverInRange() ||
      (!this.endDate && this.hoverRange && (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(this.hoverRange?.end, this.startDate));
    return ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "day", key: date.toDateString(), role: "gridcell" }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker-day", { active: active, class: {
        "hover--inside-range": this.startDate && isHoverInRange,
        "hover--outside-range": this.startDate && !isHoverInRange,
        "focused--start": isFocusedOnStart,
        "focused--end": !isFocusedOnStart,
      }, currentMonth: currentMonth, dateTimeFormat: this.dateTimeFormat, day: day, disabled: !(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.i)(date, this.min, this.max), endOfRange: this.isEndOfRange(date), highlighted: this.betweenSelectedRange(date), onCalciteDaySelect: this.daySelect, onCalciteInternalDayHover: this.dayHover, range: !!this.startDate && !!this.endDate && !(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(this.startDate, this.endDate), rangeEdge: dayInWeek === 0 ? "start" : dayInWeek === 6 ? "end" : undefined, rangeHover: this.isRangeHover(date), scale: this.scale, selected: this.isSelected(date), startOfRange: this.isStartOfRange(date), value: date,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: (el) => {
        // when moving via keyboard, focus must be updated on active date
        if (ref && active && this.activeFocus) {
          el?.focus();
        }
      } })));
  }
  isFocusedOnStart() {
    return this.hoverRange?.focused === "start";
  }
  isHoverInRange() {
    if (!this.hoverRange) {
      return false;
    }
    const { start, end } = this.hoverRange;
    return !!((!this.isFocusedOnStart() && this.startDate && (!this.endDate || end < this.endDate)) ||
      (this.isFocusedOnStart() && this.startDate && start > this.startDate));
  }
  isRangeHover(date) {
    if (!this.hoverRange) {
      return false;
    }
    const { start, end } = this.hoverRange;
    const isStart = this.isFocusedOnStart();
    const insideRange = this.isHoverInRange();
    const cond1 = insideRange &&
      ((!isStart && date > this.startDate && (date < end || (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, end))) ||
        (isStart && date < this.endDate && (date > start || (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, start))));
    const cond2 = !insideRange &&
      ((!isStart && date >= this.endDate && (date < end || (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, end))) ||
        (isStart &&
          ((this.startDate && date < this.startDate) ||
            (this.endDate && (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, this.startDate))) &&
          ((start && date > start) || (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.k)(date, start))));
    return cond1 || cond2;
  }
  get el() { return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
};
DatePickerMonth.style = datePickerMonthCss;

const CSS = {
  header: "header",
  month: "month",
  chevron: "chevron",
  suffix: "suffix",
  yearSuffix: "year--suffix",
  yearWrap: "year-wrap",
  textReverse: "text--reverse",
};
const ICON = {
  chevronLeft: "chevron-left",
  chevronRight: "chevron-right",
};

const datePickerMonthHeaderCss = ":host{display:block}.header{display:flex;justify-content:space-between;padding-block:0px;padding-inline:0.25rem}:host([scale=s]) .text{margin-block:0.5rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=s]) .chevron{block-size:2.25rem}:host([scale=m]) .text{margin-block:0.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=m]) .chevron{block-size:3rem}:host([scale=l]) .text{margin-block:1rem;font-size:var(--calcite-font-size-1);line-height:1.5rem}:host([scale=l]) .chevron{block-size:3.5rem}.chevron{margin-inline:-0.25rem;box-sizing:content-box;display:flex;flex-grow:0;cursor:pointer;align-items:center;justify-content:center;border-style:none;background-color:var(--calcite-color-foreground-1);padding-inline:0.25rem;color:var(--calcite-color-text-3);outline:2px solid transparent;outline-offset:2px;outline-color:transparent;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;inline-size:14.2857142857%}.chevron:focus{outline:2px solid var(--calcite-color-brand);outline-offset:calc(\n            -2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-offset-invert-focus),\n                1\n              )\n            )\n          )}.chevron:hover,.chevron:focus{background-color:var(--calcite-color-foreground-2);fill:var(--calcite-color-text-1);color:var(--calcite-color-text-1)}.chevron:active{background-color:var(--calcite-color-foreground-3)}.chevron[aria-disabled=true]{pointer-events:none;opacity:0}.text{margin-block:auto;display:flex;inline-size:100%;flex:1 1 auto;align-items:center;justify-content:center;text-align:center;line-height:1}.text--reverse{flex-direction:row-reverse}.month,.year,.suffix{margin-inline:0.25rem;margin-block:auto;display:inline-block;background-color:var(--calcite-color-foreground-1);font-weight:var(--calcite-font-weight-medium);line-height:1.25;color:var(--calcite-color-text-1);font-size:inherit}.year{position:relative;inline-size:2.5rem;border-style:none;background-color:transparent;text-align:center;font-family:inherit;outline-color:transparent}.year:hover{transition-duration:100ms;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-property:outline-color;outline:2px solid var(--calcite-color-border-2);outline-offset:2px}.year:focus{outline:2px solid var(--calcite-color-brand);outline-offset:calc(\n            2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-offset-invert-focus),\n                1\n              )\n            )\n          )}.year--suffix{text-align:start}.year-wrap{position:relative}.suffix{inset-block-start:0px;white-space:nowrap;text-align:start;inset-inline-start:0}:host([hidden]){display:none}[hidden]{display:none}";

const DatePickerMonthHeader = class {
  constructor(hostRef) {
    (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteInternalDatePickerSelect = (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteInternalDatePickerSelect", 6);
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    /**
     * Increment year on UP/DOWN keys
     *
     * @param event
     */
    this.onYearKey = (event) => {
      const localizedYear = this.parseCalendarYear(event.target.value);
      switch (event.key) {
        case "ArrowDown":
          event.preventDefault();
          this.setYear({ localizedYear, offset: -1 });
          break;
        case "ArrowUp":
          event.preventDefault();
          this.setYear({ localizedYear, offset: 1 });
          break;
      }
    };
    this.onYearChange = (event) => {
      this.setYear({
        localizedYear: this.parseCalendarYear(event.target.value),
      });
    };
    this.onYearInput = (event) => {
      this.setYear({
        localizedYear: this.parseCalendarYear(event.target.value),
        commit: false,
      });
    };
    this.prevMonthClick = (event) => {
      this.handleArrowClick(event, this.prevMonthDate);
    };
    this.prevMonthKeydown = (event) => {
      if ((0,_key_61f82ddb_js__WEBPACK_IMPORTED_MODULE_7__.i)(event.key)) {
        this.prevMonthClick(event);
      }
    };
    this.nextMonthClick = (event) => {
      this.handleArrowClick(event, this.nextMonthDate);
    };
    this.nextMonthKeydown = (event) => {
      if ((0,_key_61f82ddb_js__WEBPACK_IMPORTED_MODULE_7__.i)(event.key)) {
        this.nextMonthClick(event);
      }
    };
    /*
     * Update active month on clicks of left/right arrows
     */
    this.handleArrowClick = (event, date) => {
      event.preventDefault();
      this.calciteInternalDatePickerSelect.emit(date);
    };
    this.selectedDate = undefined;
    this.activeDate = undefined;
    this.headingLevel = undefined;
    this.min = undefined;
    this.max = undefined;
    this.scale = undefined;
    this.localeData = undefined;
    this.messages = undefined;
    this.nextMonthDate = undefined;
    this.prevMonthDate = undefined;
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  componentWillLoad() {
    this.parentDatePickerEl = (0,_dom_ed00a585_js__WEBPACK_IMPORTED_MODULE_5__.c)(this.el, "calcite-date-picker");
  }
  connectedCallback() {
    this.setNextPrevMonthDates();
  }
  render() {
    return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: CSS.header }, this.renderContent());
  }
  renderContent() {
    const { messages, localeData, activeDate } = this;
    if (!activeDate || !localeData) {
      return null;
    }
    if (this.parentDatePickerEl) {
      const { numberingSystem, lang: locale } = this.parentDatePickerEl;
      _locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.numberFormatOptions = {
        useGrouping: false,
        ...(numberingSystem && { numberingSystem }),
        ...(locale && { locale }),
      };
    }
    const activeMonth = activeDate.getMonth();
    const { months, unitOrder } = localeData;
    const localizedMonth = (months.wide || months.narrow || months.abbreviated)[activeMonth];
    const localizedYear = this.formatCalendarYear(activeDate.getFullYear());
    const order = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.l)(unitOrder);
    const reverse = order.indexOf("y") < order.indexOf("m");
    const suffix = localeData.year?.suffix;
    return ((0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.F, null, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("a", { "aria-disabled": `${this.prevMonthDate.getMonth() === activeMonth}`, "aria-label": messages.prevMonth, class: CSS.chevron, href: "#", onClick: this.prevMonthClick, onKeyDown: this.prevMonthKeydown, role: "button", tabindex: this.prevMonthDate.getMonth() === activeMonth ? -1 : 0 }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { "flip-rtl": true, icon: ICON.chevronLeft, scale: (0,_component_f94cab72_js__WEBPACK_IMPORTED_MODULE_9__.g)(this.scale) })), (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: { text: true, [CSS.textReverse]: reverse } }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)(_Heading_b6ae61b8_js__WEBPACK_IMPORTED_MODULE_8__.H, { class: CSS.month, level: this.headingLevel }, localizedMonth), (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: CSS.yearWrap }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("input", { "aria-label": messages.year, class: {
        year: true,
        [CSS.yearSuffix]: !!suffix,
      }, inputmode: "numeric", maxlength: "4", minlength: "1", onChange: this.onYearChange, onInput: this.onYearInput, onKeyDown: this.onYearKey, pattern: "\\d*", type: "text", value: localizedYear,
      // eslint-disable-next-line react/jsx-sort-props -- ref should be last so node attrs/props are in sync (see https://github.com/Esri/calcite-design-system/pull/6530)
      ref: (el) => (this.yearInput = el) }), suffix && (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: CSS.suffix }, suffix))), (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("a", { "aria-disabled": `${this.nextMonthDate.getMonth() === activeMonth}`, "aria-label": messages.nextMonth, class: CSS.chevron, href: "#", onClick: this.nextMonthClick, onKeyDown: this.nextMonthKeydown, role: "button", tabindex: this.nextMonthDate.getMonth() === activeMonth ? -1 : 0 }, (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { "flip-rtl": true, icon: ICON.chevronRight, scale: (0,_component_f94cab72_js__WEBPACK_IMPORTED_MODULE_9__.g)(this.scale) }))));
  }
  setNextPrevMonthDates() {
    if (!this.activeDate) {
      return;
    }
    this.nextMonthDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)((0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.n)(this.activeDate), this.min, this.max);
    this.prevMonthDate = (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)((0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.p)(this.activeDate), this.min, this.max);
  }
  formatCalendarYear(year) {
    return _locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.localize(`${(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.m)(year, this.localeData)}`);
  }
  parseCalendarYear(year) {
    return _locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.localize(`${(0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.o)(Number(_locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.delocalize(year)), this.localeData)}`);
  }
  getInRangeDate({ localizedYear, offset = 0, }) {
    const { min, max, activeDate } = this;
    const parsedYear = Number(_locale_6e783cf0_js__WEBPACK_IMPORTED_MODULE_3__.n.delocalize(localizedYear));
    const length = parsedYear.toString().length;
    const year = isNaN(parsedYear) ? false : parsedYear + offset;
    const inRange = year && (!min || min.getFullYear() <= year) && (!max || max.getFullYear() >= year);
    // if you've supplied a year and it's in range
    if (year && inRange && length === localizedYear.length) {
      const nextDate = new Date(activeDate);
      nextDate.setFullYear(year);
      return (0,_utils_ad0af80b_js__WEBPACK_IMPORTED_MODULE_1__.h)(nextDate, min, max);
    }
  }
  /**
   * Parse localized year string from input,
   * set to active if in range
   *
   * @param root0
   * @param root0.localizedYear
   * @param root0.commit
   * @param root0.offset
   */
  setYear({ localizedYear, commit = true, offset = 0, }) {
    const { yearInput, activeDate } = this;
    const inRangeDate = this.getInRangeDate({ localizedYear, offset });
    // if you've supplied a year and it's in range, update active date
    if (inRangeDate) {
      this.calciteInternalDatePickerSelect.emit(inRangeDate);
    }
    if (commit) {
      yearInput.value = this.formatCalendarYear((inRangeDate || activeDate).getFullYear());
    }
  }
  get el() { return (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
  static get watchers() { return {
    "min": ["setNextPrevMonthDates"],
    "max": ["setNextPrevMonthDates"],
    "activeDate": ["setNextPrevMonthDates"]
  }; }
};
DatePickerMonthHeader.style = datePickerMonthHeaderCss;



//# sourceMappingURL=calcite-date-picker_4.entry.js.map

/***/ }),

/***/ "./node_modules/@esri/calcite-components/dist/esm/loadable-b17396e0.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@esri/calcite-components/dist/esm/loadable-b17396e0.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ setComponentLoaded),
/* harmony export */   b: () => (/* binding */ componentLoaded),
/* harmony export */   c: () => (/* binding */ componentFocusable),
/* harmony export */   s: () => (/* binding */ setUpLoadableComponent)
/* harmony export */ });
/* harmony import */ var _index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-86faef9c.js */ "./node_modules/@esri/calcite-components/dist/esm/index-86faef9c.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.0.0
 */


const resolveMap = new WeakMap();
const promiseMap = new WeakMap();
/**
 * This helper util sets up the component for the ability to know when the component has been loaded.
 *
 * This should be used in the `componentWillLoad` lifecycle hook.
 *
 * ```
 * componentWillLoad(): void {
 *   setUpLoadableComponent(this);
 * }
 * ```
 *
 * @param component
 */
function setUpLoadableComponent(component) {
  promiseMap.set(component, new Promise((resolve) => resolveMap.set(component, resolve)));
}
/**
 * This helper util lets the loadable component know that it is now loaded.
 *
 * This should be used in the `componentDidLoad` lifecycle hook.
 *
 * ```
 * componentDidLoad(): void {
 *   setComponentLoaded(this);
 * }
 * ```
 *
 * @param component
 */
function setComponentLoaded(component) {
  resolveMap.get(component)();
}
/**
 * This helper util can be used to ensure a component has been loaded (The "componentDidLoad" Stencil lifecycle method has been called).
 *
 * Requires requires `LoadableComponent` to be implemented.
 *
 * A component developer can await this method before proceeding with any logic that requires a component to be loaded first.
 *
 * ```
 * async myMethod(): Promise<void> {
 *   await componentLoaded(this);
 * }
 * ```
 *
 * @param component
 * @returns Promise<void>
 */
function componentLoaded(component) {
  return promiseMap.get(component);
}
/**
 * This helper util can be used to ensuring the component is loaded and rendered by the browser (The "componentDidLoad" Stencil lifecycle method has been called and any internal elements are focusable).
 *
 * Requires requires `LoadableComponent` to be implemented.
 *
 * A component developer can await this method before proceeding with any logic that requires a component to be loaded first and then an internal element be focused.
 *
 * ```
 * async setFocus(): Promise<void> {
 *   await componentFocusable(this);
 *   this.internalElement?.focus();
 * }
 * ```
 *
 * @param component
 * @returns Promise<void>
 */
async function componentFocusable(component) {
  await componentLoaded(component);
  (0,_index_86faef9c_js__WEBPACK_IMPORTED_MODULE_0__.f)(component);
  return new Promise((resolve) => requestAnimationFrame(() => resolve()));
}



//# sourceMappingURL=loadable-b17396e0.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsY2l0ZS1jb21wb25lbnRzL2NodW5rcy92ZW5kb3JzLW5vZGVfbW9kdWxlc19lc3JpX2NhbGNpdGUtY29tcG9uZW50c19kaXN0X2VzbV9jYWxjaXRlLWRhdGUtcGlja2VyXzRfZW50cnlfanMuYnVuZGxlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDd0M7O0FBRXhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLFlBQVk7QUFDbkQ7QUFDQSxTQUFTLHFEQUFDLGVBQWUsVUFBVTtBQUNuQzs7QUFFb0Q7O0FBRXBEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDNEg7QUFDOEs7QUFDbkw7QUFDb0I7QUFDaEI7QUFDNUI7QUFDNkI7QUFDbkU7QUFDSjtBQUNPO0FBQzNCO0FBQ0w7QUFDSztBQUNGOztBQUUvQjtBQUNBLHFDQUFxQzs7QUFFckMsNkJBQTZCLHNCQUFzQixtREFBbUQsa0NBQWtDLHNDQUFzQyxRQUFRLHNCQUFzQixNQUFNLHFCQUFxQixpQkFBaUIsaUJBQWlCLGtCQUFrQixpQkFBaUIsbUJBQW1CLDJDQUEyQyxtQkFBbUIsaUJBQWlCLGtCQUFrQixzQkFBc0Isc0JBQXNCLGlCQUFpQixrQkFBa0Isc0JBQXNCLHNCQUFzQixpQkFBaUIsa0JBQWtCLHNCQUFzQixzQkFBc0IsZ0JBQWdCLGFBQWEsU0FBUyxhQUFhOztBQUU3cEI7QUFDQTtBQUNBLElBQUkscURBQWdCO0FBQ3BCLG1DQUFtQyxxREFBVztBQUM5Qyx3Q0FBd0MscURBQVc7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxjQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHFEQUFXO0FBQ3ZDLDBCQUEwQixxREFBVztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxjQUFjO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFEQUFTO0FBQy9CLHFDQUFxQyxxREFBUztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIscURBQVc7QUFDekMsNEJBQTRCLHFEQUFXO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QkFBdUI7QUFDbkMsOEJBQThCLGtEQUFxQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEscURBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkNBQTJDO0FBQ3ZELFlBQVksd0JBQXdCO0FBQ3BDLDhDQUE4Qyx1QkFBdUI7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTyxxREFBVTtBQUM5QiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVnTTs7QUFFaE07Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ25pQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUN1RDs7QUFFdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxxREFBVztBQUNiO0FBQ0E7O0FBRStHOztBQUUvRyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvZXNtL0hlYWRpbmctYjZhZTYxYjguanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL25vZGVfbW9kdWxlcy9AZXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvZGlzdC9lc20vY2FsY2l0ZS1kYXRlLXBpY2tlcl80LmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9ub2RlX21vZHVsZXMvQGVzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Rpc3QvZXNtL2xvYWRhYmxlLWIxNzM5NmUwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2Mi4wLjBcbiAqL1xuaW1wb3J0IHsgaCB9IGZyb20gJy4vaW5kZXgtODZmYWVmOWMuanMnO1xuXG5mdW5jdGlvbiBjb25zdHJhaW5IZWFkaW5nTGV2ZWwobGV2ZWwpIHtcbiAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KE1hdGguY2VpbChsZXZlbCksIDEpLCA2KTtcbn1cbmNvbnN0IEhlYWRpbmcgPSAocHJvcHMsIGNoaWxkcmVuKSA9PiB7XG4gIGNvbnN0IEhlYWRpbmdUYWcgPSBwcm9wcy5sZXZlbCA/IGBoJHtwcm9wcy5sZXZlbH1gIDogXCJkaXZcIjtcbiAgZGVsZXRlIHByb3BzLmxldmVsO1xuICByZXR1cm4gaChIZWFkaW5nVGFnLCB7IC4uLnByb3BzIH0sIGNoaWxkcmVuKTtcbn07XG5cbmV4cG9ydCB7IEhlYWRpbmcgYXMgSCwgY29uc3RyYWluSGVhZGluZ0xldmVsIGFzIGMgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SGVhZGluZy1iNmFlNjFiOC5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1kZXNpZ24tc3lzdGVtL2Jsb2IvbWFpbi9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjIuMC4wXG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgSCBhcyBIb3N0LCBnIGFzIGdldEVsZW1lbnQsIEYgYXMgRnJhZ21lbnQgfSBmcm9tICcuL2luZGV4LTg2ZmFlZjljLmpzJztcbmltcG9ydCB7IGogYXMgZ2V0RGF5c0RpZmYsIGMgYXMgZGF0ZVRvSVNPLCBlIGFzIGRhdGVGcm9tSVNPLCBnIGFzIGdldFZhbHVlQXNEYXRlUmFuZ2UsIGggYXMgZGF0ZUZyb21SYW5nZSwgZiBhcyBnZXRMb2NhbGVEYXRhLCBzIGFzIHNldEVuZE9mRGF5LCBrIGFzIHNhbWVEYXRlLCBpIGFzIGluUmFuZ2UsIGwgYXMgZ2V0T3JkZXIsIG4gYXMgbmV4dE1vbnRoLCBwIGFzIHByZXZNb250aCwgbSBhcyBmb3JtYXRDYWxlbmRhclllYXIsIG8gYXMgcGFyc2VDYWxlbmRhclllYXIgfSBmcm9tICcuL3V0aWxzLWFkMGFmODBiLmpzJztcbmltcG9ydCB7IGMgYXMgY29tcG9uZW50Rm9jdXNhYmxlLCBzIGFzIHNldFVwTG9hZGFibGVDb21wb25lbnQsIGEgYXMgc2V0Q29tcG9uZW50TG9hZGVkIH0gZnJvbSAnLi9sb2FkYWJsZS1iMTczOTZlMC5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RMb2NhbGl6ZWQsIGQgYXMgZGlzY29ubmVjdExvY2FsaXplZCwgbiBhcyBudW1iZXJTdHJpbmdGb3JtYXR0ZXIsIGUgYXMgZ2V0RGF0ZVRpbWVGb3JtYXQgfSBmcm9tICcuL2xvY2FsZS02ZTc4M2NmMC5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RNZXNzYWdlcywgZCBhcyBkaXNjb25uZWN0TWVzc2FnZXMsIHMgYXMgc2V0VXBNZXNzYWdlcywgdSBhcyB1cGRhdGVNZXNzYWdlcyB9IGZyb20gJy4vdDluLTBiY2RjYTU0LmpzJztcbmltcG9ydCB7IGMgYXMgY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5LCB0IGFzIHRvQXJpYUJvb2xlYW4gfSBmcm9tICcuL2RvbS1lZDAwYTU4NS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbm5lY3RJbnRlcmFjdGl2ZSwgdSBhcyB1cGRhdGVIb3N0SW50ZXJhY3Rpb24sIGQgYXMgZGlzY29ubmVjdEludGVyYWN0aXZlIH0gZnJvbSAnLi9pbnRlcmFjdGl2ZS1jYmQ4YTZkYy5qcyc7XG5pbXBvcnQgeyBpIGFzIGlzQWN0aXZhdGlvbktleSB9IGZyb20gJy4va2V5LTYxZjgyZGRiLmpzJztcbmltcG9ydCB7IEggYXMgSGVhZGluZyB9IGZyb20gJy4vSGVhZGluZy1iNmFlNjFiOC5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldEljb25TY2FsZSB9IGZyb20gJy4vY29tcG9uZW50LWY5NGNhYjcyLmpzJztcbmltcG9ydCAnLi9vYnNlcnZlcnMtNzFkMzMyZGIuanMnO1xuaW1wb3J0ICcuL2d1aWQtMjFmZWNmYTQuanMnO1xuaW1wb3J0ICcuL3Jlc291cmNlcy1jZjgyMzg4Yy5qcyc7XG5pbXBvcnQgJy4vYnJvd3Nlci1lY2UyOWRhNy5qcyc7XG5cbmNvbnN0IEhFQURJTkdfTEVWRUwgPSAyO1xuY29uc3QgREFURV9QSUNLRVJfRk9STUFUX09QVElPTlMgPSB7IGRhdGVTdHlsZTogXCJmdWxsXCIgfTtcblxuY29uc3QgZGF0ZVBpY2tlckNzcyA9IFwiOmhvc3R7Ym94LXNpemluZzpib3JkZXItYm94O2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTEpO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0yKTtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTEpfTpob3N0ICp7Ym94LXNpemluZzpib3JkZXItYm94fTpob3N0e2Rpc3BsYXk6aW5saW5lLWJsb2NrO2lubGluZS1zaXplOmF1dG87b3ZlcmZsb3c6dmlzaWJsZTtib3JkZXItcmFkaXVzOjBweDtib3JkZXItd2lkdGg6MXB4O2JvcmRlci1zdHlsZTpzb2xpZDtib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMSk7dmVydGljYWwtYWxpZ246dG9wfTpob3N0KFtzY2FsZT1zXSl7aW5saW5lLXNpemU6MjM0cHg7bWluLWlubGluZS1zaXplOjIxNnB4O21heC1pbmxpbmUtc2l6ZTozODBweH06aG9zdChbc2NhbGU9bV0pe2lubGluZS1zaXplOjMwNHB4O21pbi1pbmxpbmUtc2l6ZToyNzJweDttYXgtaW5saW5lLXNpemU6NDgwcHh9Omhvc3QoW3NjYWxlPWxdKXtpbmxpbmUtc2l6ZTozNzBweDttaW4taW5saW5lLXNpemU6MzIwcHg7bWF4LWlubGluZS1zaXplOjYwMHB4fTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBEYXRlUGlja2VyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLmNhbGNpdGVEYXRlUGlja2VyQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlRGF0ZVBpY2tlckNoYW5nZVwiLCA2KTtcbiAgICB0aGlzLmNhbGNpdGVEYXRlUGlja2VyUmFuZ2VDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVEYXRlUGlja2VyUmFuZ2VDaGFuZ2VcIiwgNik7XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMua2V5RG93bkhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgdGhpcy5yZXNldEFjdGl2ZURhdGVzKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm1vbnRoSGVhZGVyU2VsZWN0Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZXZlbnQuZGV0YWlsKTtcbiAgICAgIGlmICghdGhpcy5yYW5nZSkge1xuICAgICAgICB0aGlzLmFjdGl2ZURhdGUgPSBkYXRlO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gZGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IGRhdGU7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm1vbnRoQWN0aXZlRGF0ZUNoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRldGFpbCk7XG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVEYXRlID0gZGF0ZTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIikge1xuICAgICAgICAgIHRoaXMuYWN0aXZlRW5kRGF0ZSA9IGRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSBkYXRlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUgPSBkYXRlO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5tb250aEhvdmVyQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcbiAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB7IHZhbHVlQXNEYXRlIH0gPSB0aGlzO1xuICAgICAgY29uc3Qgc3RhcnQgPSBBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSAmJiB2YWx1ZUFzRGF0ZVswXTtcbiAgICAgIGNvbnN0IGVuZCA9IEFycmF5LmlzQXJyYXkodmFsdWVBc0RhdGUpICYmIHZhbHVlQXNEYXRlWzFdO1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRldGFpbCk7XG4gICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB7XG4gICAgICAgIGZvY3VzZWQ6IHRoaXMuYWN0aXZlUmFuZ2UgfHwgXCJzdGFydFwiLFxuICAgICAgICBzdGFydCxcbiAgICAgICAgZW5kLFxuICAgICAgfTtcbiAgICAgIGlmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCkge1xuICAgICAgICBpZiAoZW5kKSB7XG4gICAgICAgICAgY29uc3Qgc3RhcnREaWZmID0gZ2V0RGF5c0RpZmYoZGF0ZSwgc3RhcnQpO1xuICAgICAgICAgIGNvbnN0IGVuZERpZmYgPSBnZXREYXlzRGlmZihkYXRlLCBlbmQpO1xuICAgICAgICAgIGlmIChlbmREaWZmID4gMCkge1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmVuZCA9IGRhdGU7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwiZW5kXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHN0YXJ0RGlmZiA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5zdGFydCA9IGRhdGU7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwic3RhcnRcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoc3RhcnREaWZmID4gZW5kRGlmZikge1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLnN0YXJ0ID0gZGF0ZTtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5mb2N1c2VkID0gXCJzdGFydFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcImVuZFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBpZiAoc3RhcnQpIHtcbiAgICAgICAgICAgIGlmIChkYXRlIDwgc3RhcnQpIHtcbiAgICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0ge1xuICAgICAgICAgICAgICAgIGZvY3VzZWQ6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgICBzdGFydDogZGF0ZSxcbiAgICAgICAgICAgICAgICBlbmQ6IHN0YXJ0LFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xuICAgICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwiZW5kXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgaWYgKCFlbmQpIHtcbiAgICAgICAgICBpZiAoZGF0ZSA8IHN0YXJ0KSB7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB7XG4gICAgICAgICAgICAgIGZvY3VzZWQ6IFwic3RhcnRcIixcbiAgICAgICAgICAgICAgc3RhcnQ6IGRhdGUsXG4gICAgICAgICAgICAgIGVuZDogc3RhcnQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcImVuZFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH07XG4gICAgdGhpcy5tb250aE1vdXNlT3V0Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaG92ZXJSYW5nZSkge1xuICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnJlc2V0QWN0aXZlRGF0ZXMgPSAoKSA9PiB7XG4gICAgICBjb25zdCB7IHZhbHVlQXNEYXRlIH0gPSB0aGlzO1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSAmJiB2YWx1ZUFzRGF0ZSAmJiB2YWx1ZUFzRGF0ZSAhPT0gdGhpcy5hY3RpdmVEYXRlKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlRGF0ZSA9IG5ldyBEYXRlKHZhbHVlQXNEYXRlKTtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSkge1xuICAgICAgICBpZiAodmFsdWVBc0RhdGVbMF0gJiYgdmFsdWVBc0RhdGVbMF0gIT09IHRoaXMuYWN0aXZlU3RhcnREYXRlKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSBuZXcgRGF0ZSh2YWx1ZUFzRGF0ZVswXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlQXNEYXRlWzFdICYmIHZhbHVlQXNEYXRlWzFdICE9PSB0aGlzLmFjdGl2ZUVuZERhdGUpIHtcbiAgICAgICAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBuZXcgRGF0ZSh2YWx1ZUFzRGF0ZVsxXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIHdoZW4gdGhlIHNlbGVjdGVkIGRhdGUgY2hhbmdlc1xuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICovXG4gICAgdGhpcy5tb250aERhdGVDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShldmVudC5kZXRhaWwpO1xuICAgICAgY29uc3QgaXNvRGF0ZSA9IGRhdGVUb0lTTyhkYXRlKTtcbiAgICAgIGlmICghdGhpcy5yYW5nZSAmJiBpc29EYXRlID09PSBkYXRlVG9JU08odGhpcy52YWx1ZUFzRGF0ZSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLnJhbmdlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSBpc29EYXRlIHx8IFwiXCI7XG4gICAgICAgIHRoaXMudmFsdWVBc0RhdGUgPSBkYXRlIHx8IG51bGw7XG4gICAgICAgIHRoaXMuYWN0aXZlRGF0ZSA9IGRhdGUgfHwgbnVsbDtcbiAgICAgICAgdGhpcy5jYWxjaXRlRGF0ZVBpY2tlckNoYW5nZS5lbWl0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5nZXRTdGFydERhdGUoKTtcbiAgICAgIGNvbnN0IGVuZCA9IHRoaXMuZ2V0RW5kRGF0ZSgpO1xuICAgICAgaWYgKCFzdGFydCB8fCAoIWVuZCAmJiBkYXRlIDwgc3RhcnQpKSB7XG4gICAgICAgIGlmIChzdGFydCkge1xuICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZShuZXcgRGF0ZShzdGFydCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09IFwiZW5kXCIpIHtcbiAgICAgICAgICB0aGlzLnNldEVuZERhdGUoZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKCFlbmQpIHtcbiAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCkge1xuICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PSBcImVuZFwiKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLnNldFN0YXJ0RGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydERpZmYgPSBnZXREYXlzRGlmZihkYXRlLCBzdGFydCk7XG4gICAgICAgICAgICBjb25zdCBlbmREaWZmID0gZ2V0RGF5c0RpZmYoZGF0ZSwgZW5kKTtcbiAgICAgICAgICAgIGlmIChlbmREaWZmID09PSAwIHx8IHN0YXJ0RGlmZiA8IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdGFydERpZmYgPT09IDAgfHwgZW5kRGlmZiA8IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3RhcnREaWZmIDwgZW5kRGlmZikge1xuICAgICAgICAgICAgICB0aGlzLnNldFN0YXJ0RGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLnNldEVuZERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKGRhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLmNhbGNpdGVEYXRlUGlja2VyQ2hhbmdlLmVtaXQoKTtcbiAgICB9O1xuICAgIHRoaXMuYWN0aXZlRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmFjdGl2ZVJhbmdlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5oZWFkaW5nTGV2ZWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy52YWx1ZUFzRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1pbkFzRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1heEFzRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1pbiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1heCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm51bWJlcmluZ1N5c3RlbSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjYWxlID0gXCJtXCI7XG4gICAgdGhpcy5yYW5nZSA9IGZhbHNlO1xuICAgIHRoaXMucHJveGltaXR5U2VsZWN0aW9uRGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLm1lc3NhZ2VPdmVycmlkZXMgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5tZXNzYWdlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5kYXRlVGltZUZvcm1hdCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmRlZmF1bHRNZXNzYWdlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmVmZmVjdGl2ZUxvY2FsZSA9IFwiXCI7XG4gICAgdGhpcy5lbmRBc0RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5ob3ZlclJhbmdlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubG9jYWxlRGF0YSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1vc3RSZWNlbnRSYW5nZVZhbHVlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc3RhcnRBc0RhdGUgPSB1bmRlZmluZWQ7XG4gIH1cbiAgYWN0aXZlRGF0ZVdhdGNoZXIobmV3QWN0aXZlRGF0ZSkge1xuICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiKSB7XG4gICAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBuZXdBY3RpdmVEYXRlO1xuICAgIH1cbiAgfVxuICB2YWx1ZUFzRGF0ZVdhdGNoZXIobmV3VmFsdWVBc0RhdGUpIHtcbiAgICBpZiAodGhpcy5yYW5nZSAmJiBBcnJheS5pc0FycmF5KG5ld1ZhbHVlQXNEYXRlKSkge1xuICAgICAgY29uc3QgeyBhY3RpdmVTdGFydERhdGUsIGFjdGl2ZUVuZERhdGUgfSA9IHRoaXM7XG4gICAgICBjb25zdCBuZXdBY3RpdmVTdGFydERhdGUgPSBuZXdWYWx1ZUFzRGF0ZVswXTtcbiAgICAgIGNvbnN0IG5ld0FjdGl2ZUVuZERhdGUgPSBuZXdWYWx1ZUFzRGF0ZVsxXTtcbiAgICAgIHRoaXMuYWN0aXZlU3RhcnREYXRlID0gYWN0aXZlU3RhcnREYXRlICE9PSBuZXdBY3RpdmVTdGFydERhdGUgJiYgbmV3QWN0aXZlU3RhcnREYXRlO1xuICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gYWN0aXZlRW5kRGF0ZSAhPT0gbmV3QWN0aXZlRW5kRGF0ZSAmJiBuZXdBY3RpdmVFbmREYXRlO1xuICAgIH1cbiAgICBlbHNlIGlmIChuZXdWYWx1ZUFzRGF0ZSAmJiBuZXdWYWx1ZUFzRGF0ZSAhPT0gdGhpcy5hY3RpdmVEYXRlKSB7XG4gICAgICB0aGlzLmFjdGl2ZURhdGUgPSBuZXdWYWx1ZUFzRGF0ZTtcbiAgICB9XG4gIH1cbiAgb25NaW5DaGFuZ2VkKG1pbikge1xuICAgIGlmIChtaW4pIHtcbiAgICAgIHRoaXMubWluQXNEYXRlID0gZGF0ZUZyb21JU08obWluKTtcbiAgICB9XG4gIH1cbiAgb25NYXhDaGFuZ2VkKG1heCkge1xuICAgIGlmIChtYXgpIHtcbiAgICAgIHRoaXMubWF4QXNEYXRlID0gZGF0ZUZyb21JU08obWF4KTtcbiAgICB9XG4gIH1cbiAgb25NZXNzYWdlc0NoYW5nZSgpIHtcbiAgICAvKiB3aXJlZCB1cCBieSB0OW4gdXRpbCAqL1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFB1YmxpYyBNZXRob2RzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLyoqIFNldHMgZm9jdXMgb24gdGhlIGNvbXBvbmVudCdzIGZpcnN0IGZvY3VzYWJsZSBlbGVtZW50LiAqL1xuICBhc3luYyBzZXRGb2N1cygpIHtcbiAgICBhd2FpdCBjb21wb25lbnRGb2N1c2FibGUodGhpcyk7XG4gICAgdGhpcy5lbC5mb2N1cygpO1xuICB9XG4gIC8qKlxuICAgKiBSZXNldHMgYWN0aXZlIGRhdGUgc3RhdGUuXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgYXN5bmMgcmVzZXQoKSB7XG4gICAgdGhpcy5yZXNldEFjdGl2ZURhdGVzKCk7XG4gICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgfVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGNvbm5lY3RMb2NhbGl6ZWQodGhpcyk7XG4gICAgY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMudmFsdWUpKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZ2V0VmFsdWVBc0RhdGVSYW5nZSh0aGlzLnZhbHVlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgdGhpcy52YWx1ZUFzRGF0ZSA9IGRhdGVGcm9tSVNPKHRoaXMudmFsdWUpO1xuICAgIH1cbiAgICBpZiAodGhpcy5taW4pIHtcbiAgICAgIHRoaXMubWluQXNEYXRlID0gZGF0ZUZyb21JU08odGhpcy5taW4pO1xuICAgIH1cbiAgICBpZiAodGhpcy5tYXgpIHtcbiAgICAgIHRoaXMubWF4QXNEYXRlID0gZGF0ZUZyb21JU08odGhpcy5tYXgpO1xuICAgIH1cbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBkaXNjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xuICAgIGRpc2Nvbm5lY3RNZXNzYWdlcyh0aGlzKTtcbiAgfVxuICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICBzZXRVcExvYWRhYmxlQ29tcG9uZW50KHRoaXMpO1xuICAgIGF3YWl0IHRoaXMubG9hZExvY2FsZURhdGEoKTtcbiAgICB0aGlzLm9uTWluQ2hhbmdlZCh0aGlzLm1pbik7XG4gICAgdGhpcy5vbk1heENoYW5nZWQodGhpcy5tYXgpO1xuICAgIGF3YWl0IHNldFVwTWVzc2FnZXModGhpcyk7XG4gIH1cbiAgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICBzZXRDb21wb25lbnRMb2FkZWQodGhpcyk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGRhdGUgPSBkYXRlRnJvbVJhbmdlKHRoaXMucmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKSA/IHRoaXMudmFsdWVBc0RhdGVbMF0gOiB0aGlzLnZhbHVlQXNEYXRlLCB0aGlzLm1pbkFzRGF0ZSwgdGhpcy5tYXhBc0RhdGUpO1xuICAgIGxldCBhY3RpdmVEYXRlID0gdGhpcy5nZXRBY3RpdmVEYXRlKGRhdGUsIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSk7XG4gICAgY29uc3QgZW5kRGF0ZSA9IHRoaXMucmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKVxuICAgICAgPyBkYXRlRnJvbVJhbmdlKHRoaXMudmFsdWVBc0RhdGVbMV0sIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSlcbiAgICAgIDogbnVsbDtcbiAgICBjb25zdCBhY3RpdmVFbmREYXRlID0gdGhpcy5nZXRBY3RpdmVFbmREYXRlKGVuZERhdGUsIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSk7XG4gICAgaWYgKCh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiIHx8XG4gICAgICAodGhpcy5ob3ZlclJhbmdlPy5mb2N1c2VkID09PSBcImVuZFwiICYmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCB8fCBlbmREYXRlKSkpICYmXG4gICAgICBhY3RpdmVFbmREYXRlKSB7XG4gICAgICBhY3RpdmVEYXRlID0gYWN0aXZlRW5kRGF0ZTtcbiAgICB9XG4gICAgaWYgKHRoaXMucmFuZ2UgJiYgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSkge1xuICAgICAgYWN0aXZlRGF0ZSA9IHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IG1pbkRhdGUgPSB0aGlzLnJhbmdlICYmIHRoaXMuYWN0aXZlUmFuZ2VcbiAgICAgID8gdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJzdGFydFwiXG4gICAgICAgID8gdGhpcy5taW5Bc0RhdGVcbiAgICAgICAgOiBkYXRlIHx8IHRoaXMubWluQXNEYXRlXG4gICAgICA6IHRoaXMubWluQXNEYXRlO1xuICAgIGNvbnN0IG1heERhdGUgPSB0aGlzLnJhbmdlICYmIHRoaXMuYWN0aXZlUmFuZ2VcbiAgICAgID8gdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJzdGFydFwiXG4gICAgICAgID8gZW5kRGF0ZSB8fCB0aGlzLm1heEFzRGF0ZVxuICAgICAgICA6IHRoaXMubWF4QXNEYXRlXG4gICAgICA6IHRoaXMubWF4QXNEYXRlO1xuICAgIHJldHVybiAoaChIb3N0LCB7IG9uQmx1cjogdGhpcy5yZXNldEFjdGl2ZURhdGVzLCBvbktleURvd246IHRoaXMua2V5RG93bkhhbmRsZXIgfSwgdGhpcy5yZW5kZXJDYWxlbmRhcihhY3RpdmVEYXRlLCBtYXhEYXRlLCBtaW5EYXRlLCBkYXRlLCBlbmREYXRlKSkpO1xuICB9XG4gIGVmZmVjdGl2ZUxvY2FsZUNoYW5nZSgpIHtcbiAgICB1cGRhdGVNZXNzYWdlcyh0aGlzLCB0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XG4gIH1cbiAgdmFsdWVIYW5kbGVyKHZhbHVlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZ2V0VmFsdWVBc0RhdGVSYW5nZSh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZGF0ZUZyb21JU08odmFsdWUpO1xuICAgIH1cbiAgfVxuICBhc3luYyBsb2FkTG9jYWxlRGF0YSgpIHtcbiAgICBudW1iZXJTdHJpbmdGb3JtYXR0ZXIubnVtYmVyRm9ybWF0T3B0aW9ucyA9IHtcbiAgICAgIG51bWJlcmluZ1N5c3RlbTogdGhpcy5udW1iZXJpbmdTeXN0ZW0sXG4gICAgICBsb2NhbGU6IHRoaXMuZWZmZWN0aXZlTG9jYWxlLFxuICAgICAgdXNlR3JvdXBpbmc6IGZhbHNlLFxuICAgIH07XG4gICAgdGhpcy5sb2NhbGVEYXRhID0gYXdhaXQgZ2V0TG9jYWxlRGF0YSh0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XG4gICAgdGhpcy5kYXRlVGltZUZvcm1hdCA9IGdldERhdGVUaW1lRm9ybWF0KHRoaXMuZWZmZWN0aXZlTG9jYWxlLCBEQVRFX1BJQ0tFUl9GT1JNQVRfT1BUSU9OUyk7XG4gIH1cbiAgLyoqXG4gICAqIFJlbmRlciBjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoLWhlYWRlciBhbmQgY2FsY2l0ZS1kYXRlLXBpY2tlci1tb250aFxuICAgKlxuICAgKiBAcGFyYW0gYWN0aXZlRGF0ZVxuICAgKiBAcGFyYW0gbWF4RGF0ZVxuICAgKiBAcGFyYW0gbWluRGF0ZVxuICAgKiBAcGFyYW0gZGF0ZVxuICAgKiBAcGFyYW0gZW5kRGF0ZVxuICAgKi9cbiAgcmVuZGVyQ2FsZW5kYXIoYWN0aXZlRGF0ZSwgbWF4RGF0ZSwgbWluRGF0ZSwgZGF0ZSwgZW5kRGF0ZSkge1xuICAgIHJldHVybiAodGhpcy5sb2NhbGVEYXRhICYmIFtcbiAgICAgIGgoXCJjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoLWhlYWRlclwiLCB7IGFjdGl2ZURhdGU6IGFjdGl2ZURhdGUsIGhlYWRpbmdMZXZlbDogdGhpcy5oZWFkaW5nTGV2ZWwgfHwgSEVBRElOR19MRVZFTCwgbG9jYWxlRGF0YTogdGhpcy5sb2NhbGVEYXRhLCBtYXg6IG1heERhdGUsIG1lc3NhZ2VzOiB0aGlzLm1lc3NhZ2VzLCBtaW46IG1pbkRhdGUsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlclNlbGVjdDogdGhpcy5tb250aEhlYWRlclNlbGVjdENoYW5nZSwgc2NhbGU6IHRoaXMuc2NhbGUsIHNlbGVjdGVkRGF0ZTogdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIiA/IGVuZERhdGUgOiBkYXRlIHx8IG5ldyBEYXRlKCkgfSksXG4gICAgICBoKFwiY2FsY2l0ZS1kYXRlLXBpY2tlci1tb250aFwiLCB7IGFjdGl2ZURhdGU6IGFjdGl2ZURhdGUsIGRhdGVUaW1lRm9ybWF0OiB0aGlzLmRhdGVUaW1lRm9ybWF0LCBlbmREYXRlOiB0aGlzLnJhbmdlID8gZW5kRGF0ZSA6IHVuZGVmaW5lZCwgaG92ZXJSYW5nZTogdGhpcy5ob3ZlclJhbmdlLCBsb2NhbGVEYXRhOiB0aGlzLmxvY2FsZURhdGEsIG1heDogbWF4RGF0ZSwgbWluOiBtaW5EYXRlLCBvbkNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJBY3RpdmVEYXRlQ2hhbmdlOiB0aGlzLm1vbnRoQWN0aXZlRGF0ZUNoYW5nZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VySG92ZXI6IHRoaXMubW9udGhIb3ZlckNoYW5nZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyTW91c2VPdXQ6IHRoaXMubW9udGhNb3VzZU91dENoYW5nZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyU2VsZWN0OiB0aGlzLm1vbnRoRGF0ZUNoYW5nZSwgc2NhbGU6IHRoaXMuc2NhbGUsIHNlbGVjdGVkRGF0ZTogdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIiA/IGVuZERhdGUgOiBkYXRlLCBzdGFydERhdGU6IHRoaXMucmFuZ2UgPyBkYXRlIDogdW5kZWZpbmVkIH0pLFxuICAgIF0pO1xuICB9XG4gIGdldEVuZERhdGUoKSB7XG4gICAgcmV0dXJuIChBcnJheS5pc0FycmF5KHRoaXMudmFsdWVBc0RhdGUpICYmIHRoaXMudmFsdWVBc0RhdGVbMV0pIHx8IHVuZGVmaW5lZDtcbiAgfVxuICBzZXRFbmREYXRlKGRhdGUpIHtcbiAgICBjb25zdCBzdGFydERhdGUgPSB0aGlzLmdldFN0YXJ0RGF0ZSgpO1xuICAgIGNvbnN0IG5ld0VuZERhdGUgPSBkYXRlID8gc2V0RW5kT2ZEYXkoZGF0ZSkgOiBkYXRlO1xuICAgIHRoaXMudmFsdWUgPSBbZGF0ZVRvSVNPKHN0YXJ0RGF0ZSksIGRhdGVUb0lTTyhkYXRlKV07XG4gICAgdGhpcy52YWx1ZUFzRGF0ZSA9IFtzdGFydERhdGUsIGRhdGVdO1xuICAgIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUgPSBuZXdFbmREYXRlO1xuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJSYW5nZUNoYW5nZS5lbWl0KCk7XG4gICAgdGhpcy5hY3RpdmVFbmREYXRlID0gZGF0ZSB8fCBudWxsO1xuICB9XG4gIGdldFN0YXJ0RGF0ZSgpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKSAmJiB0aGlzLnZhbHVlQXNEYXRlWzBdO1xuICB9XG4gIHNldFN0YXJ0RGF0ZShkYXRlKSB7XG4gICAgY29uc3QgZW5kRGF0ZSA9IHRoaXMuZ2V0RW5kRGF0ZSgpO1xuICAgIHRoaXMudmFsdWUgPSBbZGF0ZVRvSVNPKGRhdGUpLCBkYXRlVG9JU08oZW5kRGF0ZSldO1xuICAgIHRoaXMudmFsdWVBc0RhdGUgPSBbZGF0ZSwgZW5kRGF0ZV07XG4gICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IGRhdGU7XG4gICAgdGhpcy5jYWxjaXRlRGF0ZVBpY2tlclJhbmdlQ2hhbmdlLmVtaXQoKTtcbiAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGUgfHwgbnVsbDtcbiAgfVxuICAvKipcbiAgICogR2V0IGFuIGFjdGl2ZSBkYXRlIHVzaW5nIHRoZSB2YWx1ZSwgb3IgY3VycmVudCBkYXRlIGFzIGRlZmF1bHRcbiAgICpcbiAgICogQHBhcmFtIHZhbHVlXG4gICAqIEBwYXJhbSBtaW5cbiAgICogQHBhcmFtIG1heFxuICAgKi9cbiAgZ2V0QWN0aXZlRGF0ZSh2YWx1ZSwgbWluLCBtYXgpIHtcbiAgICByZXR1cm4gZGF0ZUZyb21SYW5nZSh0aGlzLmFjdGl2ZURhdGUsIG1pbiwgbWF4KSB8fCB2YWx1ZSB8fCBkYXRlRnJvbVJhbmdlKG5ldyBEYXRlKCksIG1pbiwgbWF4KTtcbiAgfVxuICBnZXRBY3RpdmVFbmREYXRlKHZhbHVlLCBtaW4sIG1heCkge1xuICAgIHJldHVybiAoZGF0ZUZyb21SYW5nZSh0aGlzLmFjdGl2ZUVuZERhdGUsIG1pbiwgbWF4KSB8fCB2YWx1ZSB8fCBkYXRlRnJvbVJhbmdlKG5ldyBEYXRlKCksIG1pbiwgbWF4KSk7XG4gIH1cbiAgc3RhdGljIGdldCBkZWxlZ2F0ZXNGb2N1cygpIHsgcmV0dXJuIHRydWU7IH1cbiAgc3RhdGljIGdldCBhc3NldHNEaXJzKCkgeyByZXR1cm4gW1wiYXNzZXRzXCJdOyB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICBcImFjdGl2ZURhdGVcIjogW1wiYWN0aXZlRGF0ZVdhdGNoZXJcIl0sXG4gICAgXCJ2YWx1ZUFzRGF0ZVwiOiBbXCJ2YWx1ZUFzRGF0ZVdhdGNoZXJcIl0sXG4gICAgXCJtaW5cIjogW1wib25NaW5DaGFuZ2VkXCJdLFxuICAgIFwibWF4XCI6IFtcIm9uTWF4Q2hhbmdlZFwiXSxcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogW1wib25NZXNzYWdlc0NoYW5nZVwiXSxcbiAgICBcImVmZmVjdGl2ZUxvY2FsZVwiOiBbXCJlZmZlY3RpdmVMb2NhbGVDaGFuZ2VcIiwgXCJsb2FkTG9jYWxlRGF0YVwiXSxcbiAgICBcInZhbHVlXCI6IFtcInZhbHVlSGFuZGxlclwiXVxuICB9OyB9XG59O1xuRGF0ZVBpY2tlci5zdHlsZSA9IGRhdGVQaWNrZXJDc3M7XG5cbmNvbnN0IGRhdGVQaWNrZXJEYXlDc3MgPSBcIjpob3N0KFtkaXNhYmxlZF0pe2N1cnNvcjpkZWZhdWx0Oy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lO29wYWNpdHk6dmFyKC0tY2FsY2l0ZS1vcGFjaXR5LWRpc2FibGVkKX06aG9zdChbZGlzYWJsZWRdKSAqLDpob3N0KFtkaXNhYmxlZF0pIDo6c2xvdHRlZCgqKXtwb2ludGVyLWV2ZW50czpub25lfTpob3N0e3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6ZmxleDtjdXJzb3I6cG9pbnRlcjtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMyl9Omhvc3QoW2Rpc2FibGVkXSkgOjpzbG90dGVkKFtjYWxjaXRlLWh5ZHJhdGVkXVtkaXNhYmxlZF0pLDpob3N0KFtkaXNhYmxlZF0pIFtjYWxjaXRlLWh5ZHJhdGVkXVtkaXNhYmxlZF17b3BhY2l0eToxfS5kYXktdi13cmFwcGVye2ZsZXg6MSAxIGF1dG99LmRheS13cmFwcGVye3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6Y2VudGVyfTpob3N0KFtyYW5nZV0pIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW3JhbmdlXSkgLmRheS13cmFwcGVyOmFmdGVyLDpob3N0KFtyYW5nZS1ob3Zlcl0pIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW3JhbmdlLWhvdmVyXSkgLmRheS13cmFwcGVyOmFmdGVye3BvaW50ZXItZXZlbnRzOm5vbmU7cG9zaXRpb246YWJzb2x1dGU7aW5zZXQtYmxvY2s6MDtjb250ZW50OlxcXCJcXFwiO2Jsb2NrLXNpemU6dmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kYXktc2l6ZSk7aW5saW5lLXNpemU6dmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kYXktc2l6ZSl9LmRheXt6LWluZGV4OnZhcigtLWNhbGNpdGUtei1pbmRleCk7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2JvcmRlci1yYWRpdXM6OTk5OXB4O2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMik7bGluZS1oZWlnaHQ6MXJlbTtsaW5lLWhlaWdodDoxO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0zKTtvdXRsaW5lLWNvbG9yOnRyYW5zcGFyZW50O3RyYW5zaXRpb246YWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQgMHMsIG91dGxpbmUgMHMsIG91dGxpbmUtb2Zmc2V0IDBzO2JhY2tncm91bmQ6bm9uZTtib3gtc2hhZG93OjAgMCAwIDJweCB0cmFuc3BhcmVudDtibG9jay1zaXplOnZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGF5LXNpemUpO2lubGluZS1zaXplOnZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGF5LXNpemUpfS50ZXh0e21hcmdpbi1ibG9jazoxcHggMHB4O21hcmdpbi1pbmxpbmUtc3RhcnQ6MHB4fTpob3N0KFtzY2FsZT1zXSl7LS1jYWxjaXRlLWludGVybmFsLWRheS1zaXplOjI3cHh9Omhvc3QoW3NjYWxlPXNdKSAuZGF5LXYtd3JhcHBlcntwYWRkaW5nLWJsb2NrOjAuMTI1cmVtfTpob3N0KFtzY2FsZT1zXSkgLmRheS13cmFwcGVye3BhZGRpbmc6MHB4fTpob3N0KFtzY2FsZT1zXSkgLmRheXtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTIpfTpob3N0KFtzY2FsZT1tXSl7LS1jYWxjaXRlLWludGVybmFsLWRheS1zaXplOjMzcHh9Omhvc3QoW3NjYWxlPW1dKSAuZGF5LXYtd3JhcHBlcntwYWRkaW5nLWJsb2NrOjAuMjVyZW19Omhvc3QoW3NjYWxlPW1dKSAuZGF5LXdyYXBwZXJ7cGFkZGluZzowcHh9Omhvc3QoW3NjYWxlPW1dKSAuZGF5e2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMSl9Omhvc3QoW3NjYWxlPWxdKXstLWNhbGNpdGUtaW50ZXJuYWwtZGF5LXNpemU6NDNweH06aG9zdChbc2NhbGU9bF0pIC5kYXktdi13cmFwcGVye3BhZGRpbmctYmxvY2s6MC4yNXJlbX06aG9zdChbc2NhbGU9bF0pIC5kYXktd3JhcHBlcntwYWRkaW5nLWlubGluZTowLjI1cmVtfTpob3N0KFtzY2FsZT1sXSkgLmRheXtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtMCl9Omhvc3QoOm5vdChbY3VycmVudC1tb250aF0pKSAuZGF5e29wYWNpdHk6dmFyKC0tY2FsY2l0ZS1vcGFjaXR5LWRpc2FibGVkKX06aG9zdCg6aG92ZXI6bm90KFtkaXNhYmxlZF0pOm5vdChbc2VsZWN0ZWRdKSkgLmRheSw6aG9zdChbYWN0aXZlXTpub3QoW3JhbmdlXSk6bm90KFtzZWxlY3RlZF0pKSAuZGF5e2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTIpO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0xKX06aG9zdCg6Zm9jdXMpLDpob3N0KFthY3RpdmVdKXtvdXRsaW5lOjJweCBzb2xpZCB0cmFuc3BhcmVudDtvdXRsaW5lLW9mZnNldDoycHh9Omhvc3QoOmZvY3VzOm5vdChbZGlzYWJsZWRdKSkgLmRheXtvdXRsaW5lOjJweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKTtvdXRsaW5lLW9mZnNldDpjYWxjKFxcbiAgICAgICAgICAgIDJweCAqXFxuICAgICAgICAgICAgY2FsYyhcXG4gICAgICAgICAgICAgIDEgLVxcbiAgICAgICAgICAgICAgMiAqIGNsYW1wKFxcbiAgICAgICAgICAgICAgICAwLFxcbiAgICAgICAgICAgICAgICB2YXIoLS1jYWxjaXRlLW9mZnNldC1pbnZlcnQtZm9jdXMpLFxcbiAgICAgICAgICAgICAgICAxXFxuICAgICAgICAgICAgICApXFxuICAgICAgICAgICAgKVxcbiAgICAgICAgICApfTpob3N0KFtzZWxlY3RlZF0pIC5kYXl7Zm9udC13ZWlnaHQ6dmFyKC0tY2FsY2l0ZS1mb250LXdlaWdodC1tZWRpdW0pO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1icmFuZCk7Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTEpfTpob3N0KDpmb2N1czpub3QoW2Rpc2FibGVkXSkpIC5kYXksOmhvc3QoW3N0YXJ0LW9mLXJhbmdlXTpub3QoOmZvY3VzKSkgLmRheSw6aG9zdChbZW5kLW9mLXJhbmdlXTpub3QoOmZvY3VzKSkgLmRheXtib3gtc2hhZG93OjAgMCAwIDJweCB2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMSl9Omhvc3QoW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkpIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW2hpZ2hsaWdodGVkXTpub3QoW3NlbGVjdGVkXSkpIC5kYXktd3JhcHBlcjpiZWZvcmV7aW5zZXQtaW5saW5lLWVuZDo1MCU7Ym9yZGVyLXJhZGl1czowfTpob3N0KFtyYW5nZS1ob3Zlcl06bm90KFtzZWxlY3RlZF0pKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW2hpZ2hsaWdodGVkXTpub3QoW3NlbGVjdGVkXSkpIC5kYXktd3JhcHBlcjphZnRlcntpbnNldC1pbmxpbmUtc3RhcnQ6NTAlO2JvcmRlci1yYWRpdXM6MH06aG9zdChbcmFuZ2UtaG92ZXJdOm5vdChbc2VsZWN0ZWRdKSkgLmRheSw6aG9zdChbaGlnaGxpZ2h0ZWRdOm5vdChbc2VsZWN0ZWRdKSkgLmRheXtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSl9Omhvc3QoW2hpZ2hsaWdodGVkXSkgLmRheS13cmFwcGVyOmJlZm9yZSw6aG9zdChbaGlnaGxpZ2h0ZWRdKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3NlbGVjdGVkXTpub3QoLmhvdmVyLS1vdXRzaWRlLXJhbmdlKSkgLmRheS13cmFwcGVyOmJlZm9yZSw6aG9zdChbc2VsZWN0ZWRdOm5vdCguaG92ZXItLW91dHNpZGUtcmFuZ2UpKSAuZGF5LXdyYXBwZXI6YWZ0ZXJ7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtY3VycmVudCl9Omhvc3QoW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkpIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkpIC5kYXktd3JhcHBlcjphZnRlcntiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0yKX06aG9zdCg6aG92ZXJbcmFuZ2UtaG92ZXJdOm5vdChbc2VsZWN0ZWRdKS5mb2N1c2VkLS1lbmQpIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW2hpZ2hsaWdodGVkXVtlbmQtb2YtcmFuZ2VdKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KFtoaWdobGlnaHRlZF1bcmFuZ2UtZWRnZT1lbmRdKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KFtyYW5nZS1ob3Zlcl1bcmFuZ2UtZWRnZT1lbmRdKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KDpob3ZlcltyYW5nZS1ob3Zlcl0uZm9jdXNlZC0tZW5kLmhvdmVyLS1vdXRzaWRlLXJhbmdlKSAuZGF5LXdyYXBwZXI6YmVmb3Jle2luc2V0LWlubGluZS1lbmQ6NTAlfTpob3N0KDpob3ZlcltyYW5nZS1ob3Zlcl06bm90KFtzZWxlY3RlZF0pLmZvY3VzZWQtLWVuZCkgLmRheS13cmFwcGVyOmFmdGVyLDpob3N0KFtoaWdobGlnaHRlZF1bZW5kLW9mLXJhbmdlXSkgLmRheS13cmFwcGVyOmFmdGVyLDpob3N0KFtoaWdobGlnaHRlZF1bcmFuZ2UtZWRnZT1lbmRdKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3JhbmdlLWhvdmVyXVtyYW5nZS1lZGdlPWVuZF0pIC5kYXktd3JhcHBlcjphZnRlciw6aG9zdCg6aG92ZXJbcmFuZ2UtaG92ZXJdLmZvY3VzZWQtLWVuZC5ob3Zlci0tb3V0c2lkZS1yYW5nZSkgLmRheS13cmFwcGVyOmFmdGVye2luc2V0LWlubGluZS1zdGFydDo1MCU7Ym9yZGVyLXN0YXJ0LWVuZC1yYWRpdXM6dmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kYXktc2l6ZSk7Ym9yZGVyLWVuZC1lbmQtcmFkaXVzOnZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGF5LXNpemUpO2lubGluZS1zaXplOmNhbGModmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kYXktc2l6ZSkgLyAyKX06aG9zdChbaGlnaGxpZ2h0ZWRdW3N0YXJ0LW9mLXJhbmdlXSkgLmRheS13cmFwcGVyOmJlZm9yZSw6aG9zdChbaGlnaGxpZ2h0ZWRdW3JhbmdlLWVkZ2U9c3RhcnRdKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KFtyYW5nZS1ob3Zlcl1bcmFuZ2UtZWRnZT1zdGFydF0pIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoOmhvdmVyW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkuZm9jdXNlZC0tc3RhcnQpIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW3N0YXJ0LW9mLXJhbmdlXS5ob3Zlci0taW5zaWRlLXJhbmdlKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KDpob3ZlcltyYW5nZS1ob3Zlcl0uZm9jdXNlZC0tc3RhcnQuaG92ZXItLW91dHNpZGUtcmFuZ2UpIC5kYXktd3JhcHBlcjpiZWZvcmV7aW5zZXQtaW5saW5lLWVuZDo1MCU7Ym9yZGVyLXN0YXJ0LXN0YXJ0LXJhZGl1czp2YXIoLS1jYWxjaXRlLWludGVybmFsLWRheS1zaXplKTtib3JkZXItZW5kLXN0YXJ0LXJhZGl1czp2YXIoLS1jYWxjaXRlLWludGVybmFsLWRheS1zaXplKTtpbmxpbmUtc2l6ZTpjYWxjKHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZGF5LXNpemUpIC8gMil9Omhvc3QoW2hpZ2hsaWdodGVkXVtzdGFydC1vZi1yYW5nZV0pIC5kYXktd3JhcHBlcjphZnRlciw6aG9zdChbaGlnaGxpZ2h0ZWRdW3JhbmdlLWVkZ2U9c3RhcnRdKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3JhbmdlLWhvdmVyXVtyYW5nZS1lZGdlPXN0YXJ0XSkgLmRheS13cmFwcGVyOmFmdGVyLDpob3N0KDpob3ZlcltyYW5nZS1ob3Zlcl06bm90KFtzZWxlY3RlZF0pLmZvY3VzZWQtLXN0YXJ0KSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3N0YXJ0LW9mLXJhbmdlXS5ob3Zlci0taW5zaWRlLXJhbmdlKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoOmhvdmVyW3JhbmdlLWhvdmVyXS5mb2N1c2VkLS1zdGFydC5ob3Zlci0tb3V0c2lkZS1yYW5nZSkgLmRheS13cmFwcGVyOmFmdGVye2luc2V0LWlubGluZS1zdGFydDo1MCV9Omhvc3QoW3JhbmdlLWhvdmVyXVtzdGFydC1vZi1yYW5nZV1bcmFuZ2UtZWRnZT1lbmRdKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3JhbmdlLWhvdmVyXVtzdGFydC1vZi1yYW5nZV1bcmFuZ2UtZWRnZT1lbmRdKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KFtyYW5nZS1ob3Zlcl1bZW5kLW9mLXJhbmdlXVtyYW5nZS1lZGdlPXN0YXJ0XSkgLmRheS13cmFwcGVyOmFmdGVyLDpob3N0KFtyYW5nZS1ob3Zlcl1bZW5kLW9mLXJhbmdlXVtyYW5nZS1lZGdlPXN0YXJ0XSkgLmRheS13cmFwcGVyOmJlZm9yZSw6aG9zdChbc3RhcnQtb2YtcmFuZ2VdW3JhbmdlLWVkZ2U9ZW5kXS5ob3Zlci0taW5zaWRlLXJhbmdlKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3N0YXJ0LW9mLXJhbmdlXVtyYW5nZS1lZGdlPWVuZF0uaG92ZXItLWluc2lkZS1yYW5nZSkgLmRheS13cmFwcGVyOmJlZm9yZSw6aG9zdChbZW5kLW9mLXJhbmdlXSkgLmRheS13cmFwcGVyOmFmdGVyLDpob3N0KFtlbmQtb2YtcmFuZ2VdKSAuZGF5LXdyYXBwZXI6YmVmb3Jle2NvbnRlbnQ6dW5zZXR9Omhvc3QoOmhvdmVyW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkuZm9jdXNlZC0tc3RhcnQpIC5kYXksOmhvc3QoOmhvdmVyW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkuZm9jdXNlZC0tZW5kKSAuZGF5LDpob3N0KDpob3ZlcltyYW5nZS1ob3Zlcl06bm90KFtzZWxlY3RlZF0pLmZvY3VzZWQtLXN0YXJ0LmhvdmVyLS1vdXRzaWRlLXJhbmdlKSAuZGF5LDpob3N0KDpob3ZlcltyYW5nZS1ob3Zlcl06bm90KFtzZWxlY3RlZF0pLmZvY3VzZWQtLWVuZC5ob3Zlci0tb3V0c2lkZS1yYW5nZSkgLmRheXtib3gtc2hhZG93OjAgMCAwIDJweCB2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMSl9QG1lZGlhIChmb3JjZWQtY29sb3JzOiBhY3RpdmUpey5kYXl7Ym9yZGVyLXJhZGl1czowcHh9Omhvc3QoW3NlbGVjdGVkXSl7b3V0bGluZToycHggc29saWQgY2FudmFzVGV4dH06aG9zdCg6aG92ZXI6bm90KFtzZWxlY3RlZF0pKSAuZGF5e2JvcmRlci1yYWRpdXM6NTAlfTpob3N0KFtyYW5nZV1bc2VsZWN0ZWRdKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KFtyYW5nZV1bc2VsZWN0ZWRdKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW2hpZ2hsaWdodGVkXSkgLmRheS13cmFwcGVyOmJlZm9yZSw6aG9zdChbaGlnaGxpZ2h0ZWRdKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkpIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW3JhbmdlLWhvdmVyXTpub3QoW3NlbGVjdGVkXSkpIC5kYXktd3JhcHBlcjphZnRlcntiYWNrZ3JvdW5kLWNvbG9yOmhpZ2hsaWdodH06aG9zdChbcmFuZ2UtaG92ZXJdKSAuZGF5LXdyYXBwZXI6YmVmb3JlLDpob3N0KFtyYW5nZS1ob3Zlcl0pIC5kYXktd3JhcHBlcjphZnRlciw6aG9zdChbcmFuZ2VdW3NlbGVjdGVkXVtzdGFydC1vZi1yYW5nZV0pIC5kYXktd3JhcHBlcjpiZWZvcmUsOmhvc3QoW3JhbmdlXVtzZWxlY3RlZF1bc3RhcnQtb2YtcmFuZ2VdKSAuZGF5LXdyYXBwZXI6YWZ0ZXIsOmhvc3QoW3JhbmdlXVtzZWxlY3RlZF1bZW5kLW9mLXJhbmdlXSkgLmRheS13cmFwcGVyOmJlZm9yZSw6aG9zdChbcmFuZ2VdW3NlbGVjdGVkXVtlbmQtb2YtcmFuZ2VdKSAuZGF5LXdyYXBwZXI6YWZ0ZXJ7YmFja2dyb3VuZC1jb2xvcjpjYW52YXN9fTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9W2hpZGRlbl17ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBEYXRlUGlja2VyRGF5ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLmNhbGNpdGVEYXlTZWxlY3QgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVEYXlTZWxlY3RcIiwgNik7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxEYXlIb3ZlciA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZUludGVybmFsRGF5SG92ZXJcIiwgNik7XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIEV2ZW50IExpc3RlbmVyc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMub25DbGljayA9ICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2FsY2l0ZURheVNlbGVjdC5lbWl0KCk7XG4gICAgfTtcbiAgICB0aGlzLmtleURvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoaXNBY3RpdmF0aW9uS2V5KGV2ZW50LmtleSkpIHtcbiAgICAgICAgIXRoaXMuZGlzYWJsZWQgJiYgdGhpcy5jYWxjaXRlRGF5U2VsZWN0LmVtaXQoKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuZGF5ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZGF0ZVRpbWVGb3JtYXQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMuY3VycmVudE1vbnRoID0gZmFsc2U7XG4gICAgdGhpcy5zZWxlY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMuaGlnaGxpZ2h0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLnJhbmdlID0gZmFsc2U7XG4gICAgdGhpcy5yYW5nZUVkZ2UgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zdGFydE9mUmFuZ2UgPSBmYWxzZTtcbiAgICB0aGlzLmVuZE9mUmFuZ2UgPSBmYWxzZTtcbiAgICB0aGlzLnJhbmdlSG92ZXIgPSBmYWxzZTtcbiAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgIHRoaXMuc2NhbGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgfVxuICBwb2ludGVyT3ZlckhhbmRsZXIoKSB7XG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxEYXlIb3Zlci5lbWl0KCk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgdGhpcy5wYXJlbnREYXRlUGlja2VyRWwgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkodGhpcy5lbCwgXCJjYWxjaXRlLWRhdGUtcGlja2VyXCIpO1xuICB9XG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBkYXlJZCA9IGRhdGVUb0lTTyh0aGlzLnZhbHVlKS5yZXBsYWNlQWxsKFwiLVwiLCBcIlwiKTtcbiAgICBpZiAodGhpcy5wYXJlbnREYXRlUGlja2VyRWwpIHtcbiAgICAgIGNvbnN0IHsgbnVtYmVyaW5nU3lzdGVtLCBsYW5nOiBsb2NhbGUgfSA9IHRoaXMucGFyZW50RGF0ZVBpY2tlckVsO1xuICAgICAgbnVtYmVyU3RyaW5nRm9ybWF0dGVyLm51bWJlckZvcm1hdE9wdGlvbnMgPSB7XG4gICAgICAgIHVzZUdyb3VwaW5nOiBmYWxzZSxcbiAgICAgICAgLi4uKG51bWJlcmluZ1N5c3RlbSAmJiB7IG51bWJlcmluZ1N5c3RlbSB9KSxcbiAgICAgICAgLi4uKGxvY2FsZSAmJiB7IGxvY2FsZSB9KSxcbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IGZvcm1hdHRlZERheSA9IG51bWJlclN0cmluZ0Zvcm1hdHRlci5sb2NhbGl6ZShTdHJpbmcodGhpcy5kYXkpKTtcbiAgICBjb25zdCBkYXlMYWJlbCA9IHRoaXMuZGF0ZVRpbWVGb3JtYXQuZm9ybWF0KHRoaXMudmFsdWUpO1xuICAgIHJldHVybiAoaChIb3N0LCB7IFwiYXJpYS1kaXNhYmxlZFwiOiB0b0FyaWFCb29sZWFuKHRoaXMuZGlzYWJsZWQpLCBcImFyaWEtbGFiZWxcIjogZGF5TGFiZWwsIFwiYXJpYS1zZWxlY3RlZFwiOiB0b0FyaWFCb29sZWFuKHRoaXMuYWN0aXZlKSwgaWQ6IGRheUlkLCBvbkNsaWNrOiB0aGlzLm9uQ2xpY2ssIG9uS2V5RG93bjogdGhpcy5rZXlEb3duSGFuZGxlciwgcm9sZTogXCJidXR0b25cIiB9LCBoKFwiZGl2XCIsIHsgXCJhcmlhLWhpZGRlblwiOiBcInRydWVcIiwgY2xhc3M6IHsgXCJkYXktdi13cmFwcGVyXCI6IHRydWUgfSB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZGF5LXdyYXBwZXJcIiB9LCBoKFwic3BhblwiLCB7IGNsYXNzOiBcImRheVwiIH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwidGV4dFwiIH0sIGZvcm1hdHRlZERheSkpKSkpKTtcbiAgfVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBjb25uZWN0SW50ZXJhY3RpdmUodGhpcyk7XG4gIH1cbiAgY29tcG9uZW50RGlkUmVuZGVyKCkge1xuICAgIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbih0aGlzLCB0aGlzLmlzVGFiYmFibGUpO1xuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGRpc2Nvbm5lY3RJbnRlcmFjdGl2ZSh0aGlzKTtcbiAgfVxuICBpc1RhYmJhYmxlKCkge1xuICAgIHJldHVybiB0aGlzLmFjdGl2ZTtcbiAgfVxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG59O1xuRGF0ZVBpY2tlckRheS5zdHlsZSA9IGRhdGVQaWNrZXJEYXlDc3M7XG5cbmNvbnN0IGRhdGVQaWNrZXJNb250aENzcyA9IFwiOmhvc3QoW2hpZGRlbl0pe2Rpc3BsYXk6bm9uZX1baGlkZGVuXXtkaXNwbGF5Om5vbmV9LmNhbGVuZGFye21hcmdpbi1ibG9jay1lbmQ6MC4yNXJlbX0ud2Vlay1oZWFkZXJze2Rpc3BsYXk6ZmxleDtib3JkZXItd2lkdGg6MHB4O2JvcmRlci1ibG9jay1zdGFydC13aWR0aDoxcHg7Ym9yZGVyLXN0eWxlOnNvbGlkO2JvcmRlci1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWJvcmRlci0zKTtwYWRkaW5nLWJsb2NrOjBweDtwYWRkaW5nLWlubGluZTowLjI1cmVtfS53ZWVrLWhlYWRlcnt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXdlaWdodDp2YXIoLS1jYWxjaXRlLWZvbnQtd2VpZ2h0LWJvbGQpO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0zKTtpbmxpbmUtc2l6ZToxNC4yODU3MTQyODU3JX0uZGF5e2Rpc3BsYXk6ZmxleDttaW4taW5saW5lLXNpemU6MHB4O2p1c3RpZnktY29udGVudDpjZW50ZXI7aW5saW5lLXNpemU6MTQuMjg1NzE0Mjg1NyV9LmRheSBjYWxjaXRlLWRhdGUtcGlja2VyLWRheXtpbmxpbmUtc2l6ZToxMDAlfTpob3N0KFtzY2FsZT1zXSkgLndlZWstaGVhZGVye3BhZGRpbmctaW5saW5lOjBweDtwYWRkaW5nLWJsb2NrOjAuNXJlbSAwLjc1cmVtO2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMik7bGluZS1oZWlnaHQ6MXJlbX06aG9zdChbc2NhbGU9bV0pIC53ZWVrLWhlYWRlcntwYWRkaW5nLWlubGluZTowcHg7cGFkZGluZy1ibG9jazowLjc1cmVtIDFyZW07Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLS0yKTtsaW5lLWhlaWdodDoxcmVtfTpob3N0KFtzY2FsZT1sXSkgLndlZWstaGVhZGVye3BhZGRpbmctaW5saW5lOjBweDtwYWRkaW5nLWJsb2NrOjFyZW0gMS4yNXJlbTtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTEpO2xpbmUtaGVpZ2h0OjFyZW19LndlZWstZGF5c3tkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93O3BhZGRpbmctYmxvY2s6MHB4O3BhZGRpbmctaW5saW5lOjZweH0ud2Vlay1kYXlzOmZvY3Vze291dGxpbmU6MnB4IHNvbGlkIHRyYW5zcGFyZW50O291dGxpbmUtb2Zmc2V0OjJweH1cIjtcblxuY29uc3QgREFZU19QRVJfV0VFSyA9IDc7XG5jb25zdCBEQVlTX01BWElNVU1fSU5ERVggPSA2O1xuY29uc3QgRGF0ZVBpY2tlck1vbnRoID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJTZWxlY3QgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJTZWxlY3RcIiwgNik7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VySG92ZXIgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJIb3ZlclwiLCA2KTtcbiAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJBY3RpdmVEYXRlQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyQWN0aXZlRGF0ZUNoYW5nZVwiLCA2KTtcbiAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJNb3VzZU91dCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlck1vdXNlT3V0XCIsIDYpO1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBFdmVudCBMaXN0ZW5lcnNcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICB0aGlzLmtleURvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBpc1JUTCA9IHRoaXMuZWwuZGlyID09PSBcInJ0bFwiO1xuICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcbiAgICAgICAgY2FzZSBcIkFycm93VXBcIjpcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHRoaXMuYWRkRGF5cygtNyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJBcnJvd1JpZ2h0XCI6XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0aGlzLmFkZERheXMoaXNSVEwgPyAtMSA6IDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiQXJyb3dEb3duXCI6XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0aGlzLmFkZERheXMoNyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJBcnJvd0xlZnRcIjpcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHRoaXMuYWRkRGF5cyhpc1JUTCA/IDEgOiAtMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJQYWdlVXBcIjpcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHRoaXMuYWRkTW9udGhzKC0xKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIlBhZ2VEb3duXCI6XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0aGlzLmFkZE1vbnRocygxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIkhvbWVcIjpcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHRoaXMuYWN0aXZlRGF0ZS5zZXREYXRlKDEpO1xuICAgICAgICAgIHRoaXMuYWRkRGF5cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiRW5kXCI6XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0aGlzLmFjdGl2ZURhdGUuc2V0RGF0ZShuZXcgRGF0ZSh0aGlzLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKSwgdGhpcy5hY3RpdmVEYXRlLmdldE1vbnRoKCkgKyAxLCAwKS5nZXREYXRlKCkpO1xuICAgICAgICAgIHRoaXMuYWRkRGF5cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiRW50ZXJcIjpcbiAgICAgICAgY2FzZSBcIiBcIjpcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiVGFiXCI6XG4gICAgICAgICAgdGhpcy5hY3RpdmVGb2N1cyA9IGZhbHNlO1xuICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogT25jZSB1c2VyIGlzIG5vdCBpbnRlcmFjdGluZyB2aWEga2V5Ym9hcmQsXG4gICAgICogZGlzYWJsZSBhdXRvIGZvY3VzaW5nIG9mIGFjdGl2ZSBkYXRlXG4gICAgICovXG4gICAgdGhpcy5kaXNhYmxlQWN0aXZlRm9jdXMgPSAoKSA9PiB7XG4gICAgICB0aGlzLmFjdGl2ZUZvY3VzID0gZmFsc2U7XG4gICAgfTtcbiAgICB0aGlzLmRheUhvdmVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICBpZiAodGFyZ2V0LmRpc2FibGVkKSB7XG4gICAgICAgIHRoaXMuY2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlck1vdXNlT3V0LmVtaXQoKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJIb3Zlci5lbWl0KHRhcmdldC52YWx1ZSk7XG4gICAgICB9XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9O1xuICAgIHRoaXMuZGF5U2VsZWN0ID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJTZWxlY3QuZW1pdCh0YXJnZXQudmFsdWUpO1xuICAgIH07XG4gICAgdGhpcy5kYXRlVGltZUZvcm1hdCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmFjdGl2ZURhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIHRoaXMuc3RhcnREYXRlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZW5kRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1pbiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1heCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjYWxlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubG9jYWxlRGF0YSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gIH1cbiAgcG9pbnRlck91dEhhbmRsZXIoKSB7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyTW91c2VPdXQuZW1pdCgpO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIExpZmVjeWNsZVxuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBtb250aCA9IHRoaXMuYWN0aXZlRGF0ZS5nZXRNb250aCgpO1xuICAgIGNvbnN0IHllYXIgPSB0aGlzLmFjdGl2ZURhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICBjb25zdCBzdGFydE9mV2VlayA9IHRoaXMubG9jYWxlRGF0YS53ZWVrU3RhcnQgJSA3O1xuICAgIGNvbnN0IHsgYWJicmV2aWF0ZWQsIHNob3J0LCBuYXJyb3cgfSA9IHRoaXMubG9jYWxlRGF0YS5kYXlzO1xuICAgIGNvbnN0IHdlZWtEYXlzID0gdGhpcy5zY2FsZSA9PT0gXCJzXCIgPyBuYXJyb3cgfHwgc2hvcnQgfHwgYWJicmV2aWF0ZWQgOiBzaG9ydCB8fCBhYmJyZXZpYXRlZCB8fCBuYXJyb3c7XG4gICAgY29uc3QgYWRqdXN0ZWRXZWVrRGF5cyA9IFsuLi53ZWVrRGF5cy5zbGljZShzdGFydE9mV2VlaywgNyksIC4uLndlZWtEYXlzLnNsaWNlKDAsIHN0YXJ0T2ZXZWVrKV07XG4gICAgY29uc3QgY3VyTW9uRGF5cyA9IHRoaXMuZ2V0Q3VycmVudE1vbnRoRGF5cyhtb250aCwgeWVhcik7XG4gICAgY29uc3QgcHJldk1vbkRheXMgPSB0aGlzLmdldFByZXZpb3VzTW9udGhEYXlzKG1vbnRoLCB5ZWFyLCBzdGFydE9mV2Vlayk7XG4gICAgY29uc3QgbmV4dE1vbkRheXMgPSB0aGlzLmdldE5leHRNb250aERheXMobW9udGgsIHllYXIsIHN0YXJ0T2ZXZWVrKTtcbiAgICBsZXQgZGF5SW5XZWVrID0gMDtcbiAgICBjb25zdCBnZXREYXlJbldlZWsgPSAoKSA9PiBkYXlJbldlZWsrKyAlIDc7XG4gICAgY29uc3QgZGF5cyA9IFtcbiAgICAgIC4uLnByZXZNb25EYXlzLm1hcCgoZGF5KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWN0aXZlOiBmYWxzZSxcbiAgICAgICAgICBkYXksXG4gICAgICAgICAgZGF5SW5XZWVrOiBnZXREYXlJbldlZWsoKSxcbiAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSksXG4gICAgICAgIH07XG4gICAgICB9KSxcbiAgICAgIC4uLmN1ck1vbkRheXMubWFwKChkYXkpID0+IHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpO1xuICAgICAgICBjb25zdCBhY3RpdmUgPSBzYW1lRGF0ZShkYXRlLCB0aGlzLmFjdGl2ZURhdGUpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFjdGl2ZSxcbiAgICAgICAgICBjdXJyZW50TW9udGg6IHRydWUsXG4gICAgICAgICAgZGF5LFxuICAgICAgICAgIGRheUluV2VlazogZ2V0RGF5SW5XZWVrKCksXG4gICAgICAgICAgZGF0ZSxcbiAgICAgICAgICByZWY6IHRydWUsXG4gICAgICAgIH07XG4gICAgICB9KSxcbiAgICAgIC4uLm5leHRNb25EYXlzLm1hcCgoZGF5KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWN0aXZlOiBmYWxzZSxcbiAgICAgICAgICBkYXksXG4gICAgICAgICAgZGF5SW5XZWVrOiBnZXREYXlJbldlZWsoKSxcbiAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIGRheSksXG4gICAgICAgIH07XG4gICAgICB9KSxcbiAgICBdO1xuICAgIGNvbnN0IHdlZWtzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXlzLmxlbmd0aDsgaSArPSA3KSB7XG4gICAgICB3ZWVrcy5wdXNoKGRheXMuc2xpY2UoaSwgaSArIDcpKTtcbiAgICB9XG4gICAgcmV0dXJuIChoKEhvc3QsIHsgb25Gb2N1c091dDogdGhpcy5kaXNhYmxlQWN0aXZlRm9jdXMsIG9uS2V5RG93bjogdGhpcy5rZXlEb3duSGFuZGxlciB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiY2FsZW5kYXJcIiwgcm9sZTogXCJncmlkXCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcIndlZWstaGVhZGVyc1wiLCByb2xlOiBcInJvd1wiIH0sIGFkanVzdGVkV2Vla0RheXMubWFwKCh3ZWVrZGF5KSA9PiAoaChcInNwYW5cIiwgeyBjbGFzczogXCJ3ZWVrLWhlYWRlclwiLCByb2xlOiBcImNvbHVtbmhlYWRlclwiIH0sIHdlZWtkYXkpKSkpLCB3ZWVrcy5tYXAoKGRheXMpID0+IChoKFwiZGl2XCIsIHsgY2xhc3M6IFwid2Vlay1kYXlzXCIsIHJvbGU6IFwicm93XCIgfSwgZGF5cy5tYXAoKGRheSkgPT4gdGhpcy5yZW5kZXJEYXRlRGF5KGRheSkpKSkpKSkpO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBBZGQgbiBtb250aHMgdG8gdGhlIGN1cnJlbnQgbW9udGhcbiAgICpcbiAgICogQHBhcmFtIHN0ZXBcbiAgICovXG4gIGFkZE1vbnRocyhzdGVwKSB7XG4gICAgY29uc3QgbmV4dERhdGUgPSBuZXcgRGF0ZSh0aGlzLmFjdGl2ZURhdGUpO1xuICAgIG5leHREYXRlLnNldE1vbnRoKHRoaXMuYWN0aXZlRGF0ZS5nZXRNb250aCgpICsgc3RlcCk7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyQWN0aXZlRGF0ZUNoYW5nZS5lbWl0KGRhdGVGcm9tUmFuZ2UobmV4dERhdGUsIHRoaXMubWluLCB0aGlzLm1heCkpO1xuICAgIHRoaXMuYWN0aXZlRm9jdXMgPSB0cnVlO1xuICB9XG4gIC8qKlxuICAgKiBBZGQgbiBkYXlzIHRvIHRoZSBjdXJyZW50IGRhdGVcbiAgICpcbiAgICogQHBhcmFtIHN0ZXBcbiAgICovXG4gIGFkZERheXMoc3RlcCA9IDApIHtcbiAgICBjb25zdCBuZXh0RGF0ZSA9IG5ldyBEYXRlKHRoaXMuYWN0aXZlRGF0ZSk7XG4gICAgbmV4dERhdGUuc2V0RGF0ZSh0aGlzLmFjdGl2ZURhdGUuZ2V0RGF0ZSgpICsgc3RlcCk7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyQWN0aXZlRGF0ZUNoYW5nZS5lbWl0KGRhdGVGcm9tUmFuZ2UobmV4dERhdGUsIHRoaXMubWluLCB0aGlzLm1heCkpO1xuICAgIHRoaXMuYWN0aXZlRm9jdXMgPSB0cnVlO1xuICB9XG4gIC8qKlxuICAgKiBHZXQgZGF0ZXMgZm9yIGxhc3QgZGF5cyBvZiB0aGUgcHJldmlvdXMgbW9udGhcbiAgICpcbiAgICogQHBhcmFtIG1vbnRoXG4gICAqIEBwYXJhbSB5ZWFyXG4gICAqIEBwYXJhbSBzdGFydE9mV2Vla1xuICAgKi9cbiAgZ2V0UHJldmlvdXNNb250aERheXMobW9udGgsIHllYXIsIHN0YXJ0T2ZXZWVrKSB7XG4gICAgY29uc3QgbGFzdERhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCk7XG4gICAgY29uc3QgZGF0ZSA9IGxhc3REYXRlLmdldERhdGUoKTtcbiAgICBjb25zdCBzdGFydERheSA9IGxhc3REYXRlLmdldERheSgpO1xuICAgIGNvbnN0IGRheXMgPSBbXTtcbiAgICBpZiAoc3RhcnREYXkgPT09IChzdGFydE9mV2VlayArIERBWVNfTUFYSU1VTV9JTkRFWCkgJSBEQVlTX1BFUl9XRUVLKSB7XG4gICAgICByZXR1cm4gZGF5cztcbiAgICB9XG4gICAgaWYgKHN0YXJ0RGF5ID09PSBzdGFydE9mV2Vlaykge1xuICAgICAgcmV0dXJuIFtkYXRlXTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IChEQVlTX1BFUl9XRUVLICsgc3RhcnREYXkgLSBzdGFydE9mV2VlaykgJSBEQVlTX1BFUl9XRUVLOyBpID49IDA7IGktLSkge1xuICAgICAgZGF5cy5wdXNoKGRhdGUgLSBpKTtcbiAgICB9XG4gICAgcmV0dXJuIGRheXM7XG4gIH1cbiAgLyoqXG4gICAqIEdldCBkYXRlcyBmb3IgdGhlIGN1cnJlbnQgbW9udGhcbiAgICpcbiAgICogQHBhcmFtIG1vbnRoXG4gICAqIEBwYXJhbSB5ZWFyXG4gICAqL1xuICBnZXRDdXJyZW50TW9udGhEYXlzKG1vbnRoLCB5ZWFyKSB7XG4gICAgY29uc3QgbnVtID0gbmV3IERhdGUoeWVhciwgbW9udGggKyAxLCAwKS5nZXREYXRlKCk7XG4gICAgY29uc3QgZGF5cyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtOyBpKyspIHtcbiAgICAgIGRheXMucHVzaChpICsgMSk7XG4gICAgfVxuICAgIHJldHVybiBkYXlzO1xuICB9XG4gIC8qKlxuICAgKiBHZXQgZGF0ZXMgZm9yIGZpcnN0IGRheXMgb2YgdGhlIG5leHQgbW9udGhcbiAgICpcbiAgICogQHBhcmFtIG1vbnRoXG4gICAqIEBwYXJhbSB5ZWFyXG4gICAqIEBwYXJhbSBzdGFydE9mV2Vla1xuICAgKi9cbiAgZ2V0TmV4dE1vbnRoRGF5cyhtb250aCwgeWVhciwgc3RhcnRPZldlZWspIHtcbiAgICBjb25zdCBlbmREYXkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIDApLmdldERheSgpO1xuICAgIGNvbnN0IGRheXMgPSBbXTtcbiAgICBpZiAoZW5kRGF5ID09PSAoc3RhcnRPZldlZWsgKyBEQVlTX01BWElNVU1fSU5ERVgpICUgREFZU19QRVJfV0VFSykge1xuICAgICAgcmV0dXJuIGRheXM7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgKERBWVNfTUFYSU1VTV9JTkRFWCAtIChlbmREYXkgLSBzdGFydE9mV2VlaykpICUgREFZU19QRVJfV0VFSzsgaSsrKSB7XG4gICAgICBkYXlzLnB1c2goaSArIDEpO1xuICAgIH1cbiAgICByZXR1cm4gZGF5cztcbiAgfVxuICAvKipcbiAgICogRGV0ZXJtaW5lIGlmIHRoZSBkYXRlIGlzIGluIGJldHdlZW4gdGhlIHN0YXJ0IGFuZCBlbmQgZGF0ZXNcbiAgICpcbiAgICogQHBhcmFtIGRhdGVcbiAgICovXG4gIGJldHdlZW5TZWxlY3RlZFJhbmdlKGRhdGUpIHtcbiAgICByZXR1cm4gISEodGhpcy5zdGFydERhdGUgJiZcbiAgICAgIHRoaXMuZW5kRGF0ZSAmJlxuICAgICAgZGF0ZSA+IHRoaXMuc3RhcnREYXRlICYmXG4gICAgICBkYXRlIDwgdGhpcy5lbmREYXRlICYmXG4gICAgICAhdGhpcy5pc1JhbmdlSG92ZXIoZGF0ZSkpO1xuICB9XG4gIC8qKlxuICAgKiBEZXRlcm1pbmUgaWYgdGhlIGRhdGUgc2hvdWxkIGJlIGluIHNlbGVjdGVkIHN0YXRlXG4gICAqXG4gICAqIEBwYXJhbSBkYXRlXG4gICAqL1xuICBpc1NlbGVjdGVkKGRhdGUpIHtcbiAgICByZXR1cm4gISEoc2FtZURhdGUoZGF0ZSwgdGhpcy5zZWxlY3RlZERhdGUpIHx8XG4gICAgICAodGhpcy5zdGFydERhdGUgJiYgc2FtZURhdGUoZGF0ZSwgdGhpcy5zdGFydERhdGUpKSB8fFxuICAgICAgKHRoaXMuZW5kRGF0ZSAmJiBzYW1lRGF0ZShkYXRlLCB0aGlzLmVuZERhdGUpKSk7XG4gIH1cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiB0aGUgZGF0ZSBpcyB0aGUgc3RhcnQgb2YgdGhlIGRhdGUgcmFuZ2VcbiAgICpcbiAgICogQHBhcmFtIGRhdGVcbiAgICovXG4gIGlzU3RhcnRPZlJhbmdlKGRhdGUpIHtcbiAgICByZXR1cm4gISEodGhpcy5zdGFydERhdGUgJiZcbiAgICAgICFzYW1lRGF0ZSh0aGlzLnN0YXJ0RGF0ZSwgdGhpcy5lbmREYXRlKSAmJlxuICAgICAgc2FtZURhdGUodGhpcy5zdGFydERhdGUsIGRhdGUpICYmXG4gICAgICAhdGhpcy5pc0VuZE9mUmFuZ2UoZGF0ZSkpO1xuICB9XG4gIGlzRW5kT2ZSYW5nZShkYXRlKSB7XG4gICAgcmV0dXJuICEhKCh0aGlzLmVuZERhdGUgJiYgIXNhbWVEYXRlKHRoaXMuc3RhcnREYXRlLCB0aGlzLmVuZERhdGUpICYmIHNhbWVEYXRlKHRoaXMuZW5kRGF0ZSwgZGF0ZSkpIHx8XG4gICAgICAoIXRoaXMuZW5kRGF0ZSAmJlxuICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgJiZcbiAgICAgICAgc2FtZURhdGUodGhpcy5zdGFydERhdGUsIHRoaXMuaG92ZXJSYW5nZS5lbmQpICYmXG4gICAgICAgIHNhbWVEYXRlKGRhdGUsIHRoaXMuaG92ZXJSYW5nZS5lbmQpKSk7XG4gIH1cbiAgLyoqXG4gICAqIFJlbmRlciBjYWxjaXRlLWRhdGUtcGlja2VyLWRheVxuICAgKlxuICAgKiBAcGFyYW0gYWN0aXZlLmFjdGl2ZVxuICAgKiBAcGFyYW0gYWN0aXZlXG4gICAqIEBwYXJhbSBkYXlcbiAgICogQHBhcmFtIGRheUluV2Vla1xuICAgKiBAcGFyYW0gZGF0ZVxuICAgKiBAcGFyYW0gY3VycmVudE1vbnRoXG4gICAqIEBwYXJhbSByZWZcbiAgICogQHBhcmFtIGFjdGl2ZS5jdXJyZW50TW9udGhcbiAgICogQHBhcmFtIGFjdGl2ZS5kYXRlXG4gICAqIEBwYXJhbSBhY3RpdmUuZGF5XG4gICAqIEBwYXJhbSBhY3RpdmUuZGF5SW5XZWVrXG4gICAqIEBwYXJhbSBhY3RpdmUucmVmXG4gICAqL1xuICByZW5kZXJEYXRlRGF5KHsgYWN0aXZlLCBjdXJyZW50TW9udGgsIGRhdGUsIGRheSwgZGF5SW5XZWVrLCByZWYgfSkge1xuICAgIGNvbnN0IGlzRm9jdXNlZE9uU3RhcnQgPSB0aGlzLmlzRm9jdXNlZE9uU3RhcnQoKTtcbiAgICBjb25zdCBpc0hvdmVySW5SYW5nZSA9IHRoaXMuaXNIb3ZlckluUmFuZ2UoKSB8fFxuICAgICAgKCF0aGlzLmVuZERhdGUgJiYgdGhpcy5ob3ZlclJhbmdlICYmIHNhbWVEYXRlKHRoaXMuaG92ZXJSYW5nZT8uZW5kLCB0aGlzLnN0YXJ0RGF0ZSkpO1xuICAgIHJldHVybiAoaChcImRpdlwiLCB7IGNsYXNzOiBcImRheVwiLCBrZXk6IGRhdGUudG9EYXRlU3RyaW5nKCksIHJvbGU6IFwiZ3JpZGNlbGxcIiB9LCBoKFwiY2FsY2l0ZS1kYXRlLXBpY2tlci1kYXlcIiwgeyBhY3RpdmU6IGFjdGl2ZSwgY2xhc3M6IHtcbiAgICAgICAgXCJob3Zlci0taW5zaWRlLXJhbmdlXCI6IHRoaXMuc3RhcnREYXRlICYmIGlzSG92ZXJJblJhbmdlLFxuICAgICAgICBcImhvdmVyLS1vdXRzaWRlLXJhbmdlXCI6IHRoaXMuc3RhcnREYXRlICYmICFpc0hvdmVySW5SYW5nZSxcbiAgICAgICAgXCJmb2N1c2VkLS1zdGFydFwiOiBpc0ZvY3VzZWRPblN0YXJ0LFxuICAgICAgICBcImZvY3VzZWQtLWVuZFwiOiAhaXNGb2N1c2VkT25TdGFydCxcbiAgICAgIH0sIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoLCBkYXRlVGltZUZvcm1hdDogdGhpcy5kYXRlVGltZUZvcm1hdCwgZGF5OiBkYXksIGRpc2FibGVkOiAhaW5SYW5nZShkYXRlLCB0aGlzLm1pbiwgdGhpcy5tYXgpLCBlbmRPZlJhbmdlOiB0aGlzLmlzRW5kT2ZSYW5nZShkYXRlKSwgaGlnaGxpZ2h0ZWQ6IHRoaXMuYmV0d2VlblNlbGVjdGVkUmFuZ2UoZGF0ZSksIG9uQ2FsY2l0ZURheVNlbGVjdDogdGhpcy5kYXlTZWxlY3QsIG9uQ2FsY2l0ZUludGVybmFsRGF5SG92ZXI6IHRoaXMuZGF5SG92ZXIsIHJhbmdlOiAhIXRoaXMuc3RhcnREYXRlICYmICEhdGhpcy5lbmREYXRlICYmICFzYW1lRGF0ZSh0aGlzLnN0YXJ0RGF0ZSwgdGhpcy5lbmREYXRlKSwgcmFuZ2VFZGdlOiBkYXlJbldlZWsgPT09IDAgPyBcInN0YXJ0XCIgOiBkYXlJbldlZWsgPT09IDYgPyBcImVuZFwiIDogdW5kZWZpbmVkLCByYW5nZUhvdmVyOiB0aGlzLmlzUmFuZ2VIb3ZlcihkYXRlKSwgc2NhbGU6IHRoaXMuc2NhbGUsIHNlbGVjdGVkOiB0aGlzLmlzU2VsZWN0ZWQoZGF0ZSksIHN0YXJ0T2ZSYW5nZTogdGhpcy5pc1N0YXJ0T2ZSYW5nZShkYXRlKSwgdmFsdWU6IGRhdGUsXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QvanN4LXNvcnQtcHJvcHMgLS0gcmVmIHNob3VsZCBiZSBsYXN0IHNvIG5vZGUgYXR0cnMvcHJvcHMgYXJlIGluIHN5bmMgKHNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vcHVsbC82NTMwKVxuICAgICAgcmVmOiAoZWwpID0+IHtcbiAgICAgICAgLy8gd2hlbiBtb3ZpbmcgdmlhIGtleWJvYXJkLCBmb2N1cyBtdXN0IGJlIHVwZGF0ZWQgb24gYWN0aXZlIGRhdGVcbiAgICAgICAgaWYgKHJlZiAmJiBhY3RpdmUgJiYgdGhpcy5hY3RpdmVGb2N1cykge1xuICAgICAgICAgIGVsPy5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICB9IH0pKSk7XG4gIH1cbiAgaXNGb2N1c2VkT25TdGFydCgpIHtcbiAgICByZXR1cm4gdGhpcy5ob3ZlclJhbmdlPy5mb2N1c2VkID09PSBcInN0YXJ0XCI7XG4gIH1cbiAgaXNIb3ZlckluUmFuZ2UoKSB7XG4gICAgaWYgKCF0aGlzLmhvdmVyUmFuZ2UpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSB0aGlzLmhvdmVyUmFuZ2U7XG4gICAgcmV0dXJuICEhKCghdGhpcy5pc0ZvY3VzZWRPblN0YXJ0KCkgJiYgdGhpcy5zdGFydERhdGUgJiYgKCF0aGlzLmVuZERhdGUgfHwgZW5kIDwgdGhpcy5lbmREYXRlKSkgfHxcbiAgICAgICh0aGlzLmlzRm9jdXNlZE9uU3RhcnQoKSAmJiB0aGlzLnN0YXJ0RGF0ZSAmJiBzdGFydCA+IHRoaXMuc3RhcnREYXRlKSk7XG4gIH1cbiAgaXNSYW5nZUhvdmVyKGRhdGUpIHtcbiAgICBpZiAoIXRoaXMuaG92ZXJSYW5nZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IHRoaXMuaG92ZXJSYW5nZTtcbiAgICBjb25zdCBpc1N0YXJ0ID0gdGhpcy5pc0ZvY3VzZWRPblN0YXJ0KCk7XG4gICAgY29uc3QgaW5zaWRlUmFuZ2UgPSB0aGlzLmlzSG92ZXJJblJhbmdlKCk7XG4gICAgY29uc3QgY29uZDEgPSBpbnNpZGVSYW5nZSAmJlxuICAgICAgKCghaXNTdGFydCAmJiBkYXRlID4gdGhpcy5zdGFydERhdGUgJiYgKGRhdGUgPCBlbmQgfHwgc2FtZURhdGUoZGF0ZSwgZW5kKSkpIHx8XG4gICAgICAgIChpc1N0YXJ0ICYmIGRhdGUgPCB0aGlzLmVuZERhdGUgJiYgKGRhdGUgPiBzdGFydCB8fCBzYW1lRGF0ZShkYXRlLCBzdGFydCkpKSk7XG4gICAgY29uc3QgY29uZDIgPSAhaW5zaWRlUmFuZ2UgJiZcbiAgICAgICgoIWlzU3RhcnQgJiYgZGF0ZSA+PSB0aGlzLmVuZERhdGUgJiYgKGRhdGUgPCBlbmQgfHwgc2FtZURhdGUoZGF0ZSwgZW5kKSkpIHx8XG4gICAgICAgIChpc1N0YXJ0ICYmXG4gICAgICAgICAgKCh0aGlzLnN0YXJ0RGF0ZSAmJiBkYXRlIDwgdGhpcy5zdGFydERhdGUpIHx8XG4gICAgICAgICAgICAodGhpcy5lbmREYXRlICYmIHNhbWVEYXRlKGRhdGUsIHRoaXMuc3RhcnREYXRlKSkpICYmXG4gICAgICAgICAgKChzdGFydCAmJiBkYXRlID4gc3RhcnQpIHx8IHNhbWVEYXRlKGRhdGUsIHN0YXJ0KSkpKTtcbiAgICByZXR1cm4gY29uZDEgfHwgY29uZDI7XG4gIH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcbkRhdGVQaWNrZXJNb250aC5zdHlsZSA9IGRhdGVQaWNrZXJNb250aENzcztcblxuY29uc3QgQ1NTID0ge1xuICBoZWFkZXI6IFwiaGVhZGVyXCIsXG4gIG1vbnRoOiBcIm1vbnRoXCIsXG4gIGNoZXZyb246IFwiY2hldnJvblwiLFxuICBzdWZmaXg6IFwic3VmZml4XCIsXG4gIHllYXJTdWZmaXg6IFwieWVhci0tc3VmZml4XCIsXG4gIHllYXJXcmFwOiBcInllYXItd3JhcFwiLFxuICB0ZXh0UmV2ZXJzZTogXCJ0ZXh0LS1yZXZlcnNlXCIsXG59O1xuY29uc3QgSUNPTiA9IHtcbiAgY2hldnJvbkxlZnQ6IFwiY2hldnJvbi1sZWZ0XCIsXG4gIGNoZXZyb25SaWdodDogXCJjaGV2cm9uLXJpZ2h0XCIsXG59O1xuXG5jb25zdCBkYXRlUGlja2VyTW9udGhIZWFkZXJDc3MgPSBcIjpob3N0e2Rpc3BsYXk6YmxvY2t9LmhlYWRlcntkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZy1ibG9jazowcHg7cGFkZGluZy1pbmxpbmU6MC4yNXJlbX06aG9zdChbc2NhbGU9c10pIC50ZXh0e21hcmdpbi1ibG9jazowLjVyZW07Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLS0xKTtsaW5lLWhlaWdodDoxcmVtfTpob3N0KFtzY2FsZT1zXSkgLmNoZXZyb257YmxvY2stc2l6ZToyLjI1cmVtfTpob3N0KFtzY2FsZT1tXSkgLnRleHR7bWFyZ2luLWJsb2NrOjAuNzVyZW07Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLTApO2xpbmUtaGVpZ2h0OjEuMjVyZW19Omhvc3QoW3NjYWxlPW1dKSAuY2hldnJvbntibG9jay1zaXplOjNyZW19Omhvc3QoW3NjYWxlPWxdKSAudGV4dHttYXJnaW4tYmxvY2s6MXJlbTtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtMSk7bGluZS1oZWlnaHQ6MS41cmVtfTpob3N0KFtzY2FsZT1sXSkgLmNoZXZyb257YmxvY2stc2l6ZTozLjVyZW19LmNoZXZyb257bWFyZ2luLWlubGluZTotMC4yNXJlbTtib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6ZmxleDtmbGV4LWdyb3c6MDtjdXJzb3I6cG9pbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtib3JkZXItc3R5bGU6bm9uZTtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0xKTtwYWRkaW5nLWlubGluZTowLjI1cmVtO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0zKTtvdXRsaW5lOjJweCBzb2xpZCB0cmFuc3BhcmVudDtvdXRsaW5lLW9mZnNldDoycHg7b3V0bGluZS1jb2xvcjp0cmFuc3BhcmVudDt0cmFuc2l0aW9uOmFsbCB2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpIGVhc2UtaW4tb3V0IDBzLCBvdXRsaW5lIDBzLCBvdXRsaW5lLW9mZnNldCAwcztpbmxpbmUtc2l6ZToxNC4yODU3MTQyODU3JX0uY2hldnJvbjpmb2N1c3tvdXRsaW5lOjJweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKTtvdXRsaW5lLW9mZnNldDpjYWxjKFxcbiAgICAgICAgICAgIC0ycHggKlxcbiAgICAgICAgICAgIGNhbGMoXFxuICAgICAgICAgICAgICAxIC1cXG4gICAgICAgICAgICAgIDIgKiBjbGFtcChcXG4gICAgICAgICAgICAgICAgMCxcXG4gICAgICAgICAgICAgICAgdmFyKC0tY2FsY2l0ZS1vZmZzZXQtaW52ZXJ0LWZvY3VzKSxcXG4gICAgICAgICAgICAgICAgMVxcbiAgICAgICAgICAgICAgKVxcbiAgICAgICAgICAgIClcXG4gICAgICAgICAgKX0uY2hldnJvbjpob3ZlciwuY2hldnJvbjpmb2N1c3tiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0yKTtmaWxsOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0xKTtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSl9LmNoZXZyb246YWN0aXZle2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTMpfS5jaGV2cm9uW2FyaWEtZGlzYWJsZWQ9dHJ1ZV17cG9pbnRlci1ldmVudHM6bm9uZTtvcGFjaXR5OjB9LnRleHR7bWFyZ2luLWJsb2NrOmF1dG87ZGlzcGxheTpmbGV4O2lubGluZS1zaXplOjEwMCU7ZmxleDoxIDEgYXV0bzthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt0ZXh0LWFsaWduOmNlbnRlcjtsaW5lLWhlaWdodDoxfS50ZXh0LS1yZXZlcnNle2ZsZXgtZGlyZWN0aW9uOnJvdy1yZXZlcnNlfS5tb250aCwueWVhciwuc3VmZml4e21hcmdpbi1pbmxpbmU6MC4yNXJlbTttYXJnaW4tYmxvY2s6YXV0bztkaXNwbGF5OmlubGluZS1ibG9jaztiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0xKTtmb250LXdlaWdodDp2YXIoLS1jYWxjaXRlLWZvbnQtd2VpZ2h0LW1lZGl1bSk7bGluZS1oZWlnaHQ6MS4yNTtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSk7Zm9udC1zaXplOmluaGVyaXR9LnllYXJ7cG9zaXRpb246cmVsYXRpdmU7aW5saW5lLXNpemU6Mi41cmVtO2JvcmRlci1zdHlsZTpub25lO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1mYW1pbHk6aW5oZXJpdDtvdXRsaW5lLWNvbG9yOnRyYW5zcGFyZW50fS55ZWFyOmhvdmVye3RyYW5zaXRpb24tZHVyYXRpb246MTAwbXM7dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTt0cmFuc2l0aW9uLXByb3BlcnR5Om91dGxpbmUtY29sb3I7b3V0bGluZToycHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMik7b3V0bGluZS1vZmZzZXQ6MnB4fS55ZWFyOmZvY3Vze291dGxpbmU6MnB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpO291dGxpbmUtb2Zmc2V0OmNhbGMoXFxuICAgICAgICAgICAgMnB4ICpcXG4gICAgICAgICAgICBjYWxjKFxcbiAgICAgICAgICAgICAgMSAtXFxuICAgICAgICAgICAgICAyICogY2xhbXAoXFxuICAgICAgICAgICAgICAgIDAsXFxuICAgICAgICAgICAgICAgIHZhcigtLWNhbGNpdGUtb2Zmc2V0LWludmVydC1mb2N1cyksXFxuICAgICAgICAgICAgICAgIDFcXG4gICAgICAgICAgICAgIClcXG4gICAgICAgICAgICApXFxuICAgICAgICAgICl9LnllYXItLXN1ZmZpeHt0ZXh0LWFsaWduOnN0YXJ0fS55ZWFyLXdyYXB7cG9zaXRpb246cmVsYXRpdmV9LnN1ZmZpeHtpbnNldC1ibG9jay1zdGFydDowcHg7d2hpdGUtc3BhY2U6bm93cmFwO3RleHQtYWxpZ246c3RhcnQ7aW5zZXQtaW5saW5lLXN0YXJ0OjB9Omhvc3QoW2hpZGRlbl0pe2Rpc3BsYXk6bm9uZX1baGlkZGVuXXtkaXNwbGF5Om5vbmV9XCI7XG5cbmNvbnN0IERhdGVQaWNrZXJNb250aEhlYWRlciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyU2VsZWN0ID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyU2VsZWN0XCIsIDYpO1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvKipcbiAgICAgKiBJbmNyZW1lbnQgeWVhciBvbiBVUC9ET1dOIGtleXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqL1xuICAgIHRoaXMub25ZZWFyS2V5ID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBsb2NhbGl6ZWRZZWFyID0gdGhpcy5wYXJzZUNhbGVuZGFyWWVhcihldmVudC50YXJnZXQudmFsdWUpO1xuICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcbiAgICAgICAgY2FzZSBcIkFycm93RG93blwiOlxuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgdGhpcy5zZXRZZWFyKHsgbG9jYWxpemVkWWVhciwgb2Zmc2V0OiAtMSB9KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIkFycm93VXBcIjpcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHRoaXMuc2V0WWVhcih7IGxvY2FsaXplZFllYXIsIG9mZnNldDogMSB9KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMub25ZZWFyQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLnNldFllYXIoe1xuICAgICAgICBsb2NhbGl6ZWRZZWFyOiB0aGlzLnBhcnNlQ2FsZW5kYXJZZWFyKGV2ZW50LnRhcmdldC52YWx1ZSksXG4gICAgICB9KTtcbiAgICB9O1xuICAgIHRoaXMub25ZZWFySW5wdXQgPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMuc2V0WWVhcih7XG4gICAgICAgIGxvY2FsaXplZFllYXI6IHRoaXMucGFyc2VDYWxlbmRhclllYXIoZXZlbnQudGFyZ2V0LnZhbHVlKSxcbiAgICAgICAgY29tbWl0OiBmYWxzZSxcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdGhpcy5wcmV2TW9udGhDbGljayA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVBcnJvd0NsaWNrKGV2ZW50LCB0aGlzLnByZXZNb250aERhdGUpO1xuICAgIH07XG4gICAgdGhpcy5wcmV2TW9udGhLZXlkb3duID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoaXNBY3RpdmF0aW9uS2V5KGV2ZW50LmtleSkpIHtcbiAgICAgICAgdGhpcy5wcmV2TW9udGhDbGljayhldmVudCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm5leHRNb250aENsaWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzLmhhbmRsZUFycm93Q2xpY2soZXZlbnQsIHRoaXMubmV4dE1vbnRoRGF0ZSk7XG4gICAgfTtcbiAgICB0aGlzLm5leHRNb250aEtleWRvd24gPSAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChpc0FjdGl2YXRpb25LZXkoZXZlbnQua2V5KSkge1xuICAgICAgICB0aGlzLm5leHRNb250aENsaWNrKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIC8qXG4gICAgICogVXBkYXRlIGFjdGl2ZSBtb250aCBvbiBjbGlja3Mgb2YgbGVmdC9yaWdodCBhcnJvd3NcbiAgICAgKi9cbiAgICB0aGlzLmhhbmRsZUFycm93Q2xpY2sgPSAoZXZlbnQsIGRhdGUpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbERhdGVQaWNrZXJTZWxlY3QuZW1pdChkYXRlKTtcbiAgICB9O1xuICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuYWN0aXZlRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhlYWRpbmdMZXZlbCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1pbiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1heCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjYWxlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubG9jYWxlRGF0YSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm1lc3NhZ2VzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubmV4dE1vbnRoRGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnByZXZNb250aERhdGUgPSB1bmRlZmluZWQ7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgdGhpcy5wYXJlbnREYXRlUGlja2VyRWwgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkodGhpcy5lbCwgXCJjYWxjaXRlLWRhdGUtcGlja2VyXCIpO1xuICB9XG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIHRoaXMuc2V0TmV4dFByZXZNb250aERhdGVzKCk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiBoKFwiZGl2XCIsIHsgY2xhc3M6IENTUy5oZWFkZXIgfSwgdGhpcy5yZW5kZXJDb250ZW50KCkpO1xuICB9XG4gIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgY29uc3QgeyBtZXNzYWdlcywgbG9jYWxlRGF0YSwgYWN0aXZlRGF0ZSB9ID0gdGhpcztcbiAgICBpZiAoIWFjdGl2ZURhdGUgfHwgIWxvY2FsZURhdGEpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpZiAodGhpcy5wYXJlbnREYXRlUGlja2VyRWwpIHtcbiAgICAgIGNvbnN0IHsgbnVtYmVyaW5nU3lzdGVtLCBsYW5nOiBsb2NhbGUgfSA9IHRoaXMucGFyZW50RGF0ZVBpY2tlckVsO1xuICAgICAgbnVtYmVyU3RyaW5nRm9ybWF0dGVyLm51bWJlckZvcm1hdE9wdGlvbnMgPSB7XG4gICAgICAgIHVzZUdyb3VwaW5nOiBmYWxzZSxcbiAgICAgICAgLi4uKG51bWJlcmluZ1N5c3RlbSAmJiB7IG51bWJlcmluZ1N5c3RlbSB9KSxcbiAgICAgICAgLi4uKGxvY2FsZSAmJiB7IGxvY2FsZSB9KSxcbiAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IGFjdGl2ZU1vbnRoID0gYWN0aXZlRGF0ZS5nZXRNb250aCgpO1xuICAgIGNvbnN0IHsgbW9udGhzLCB1bml0T3JkZXIgfSA9IGxvY2FsZURhdGE7XG4gICAgY29uc3QgbG9jYWxpemVkTW9udGggPSAobW9udGhzLndpZGUgfHwgbW9udGhzLm5hcnJvdyB8fCBtb250aHMuYWJicmV2aWF0ZWQpW2FjdGl2ZU1vbnRoXTtcbiAgICBjb25zdCBsb2NhbGl6ZWRZZWFyID0gdGhpcy5mb3JtYXRDYWxlbmRhclllYXIoYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpKTtcbiAgICBjb25zdCBvcmRlciA9IGdldE9yZGVyKHVuaXRPcmRlcik7XG4gICAgY29uc3QgcmV2ZXJzZSA9IG9yZGVyLmluZGV4T2YoXCJ5XCIpIDwgb3JkZXIuaW5kZXhPZihcIm1cIik7XG4gICAgY29uc3Qgc3VmZml4ID0gbG9jYWxlRGF0YS55ZWFyPy5zdWZmaXg7XG4gICAgcmV0dXJuIChoKEZyYWdtZW50LCBudWxsLCBoKFwiYVwiLCB7IFwiYXJpYS1kaXNhYmxlZFwiOiBgJHt0aGlzLnByZXZNb250aERhdGUuZ2V0TW9udGgoKSA9PT0gYWN0aXZlTW9udGh9YCwgXCJhcmlhLWxhYmVsXCI6IG1lc3NhZ2VzLnByZXZNb250aCwgY2xhc3M6IENTUy5jaGV2cm9uLCBocmVmOiBcIiNcIiwgb25DbGljazogdGhpcy5wcmV2TW9udGhDbGljaywgb25LZXlEb3duOiB0aGlzLnByZXZNb250aEtleWRvd24sIHJvbGU6IFwiYnV0dG9uXCIsIHRhYmluZGV4OiB0aGlzLnByZXZNb250aERhdGUuZ2V0TW9udGgoKSA9PT0gYWN0aXZlTW9udGggPyAtMSA6IDAgfSwgaChcImNhbGNpdGUtaWNvblwiLCB7IFwiZmxpcC1ydGxcIjogdHJ1ZSwgaWNvbjogSUNPTi5jaGV2cm9uTGVmdCwgc2NhbGU6IGdldEljb25TY2FsZSh0aGlzLnNjYWxlKSB9KSksIGgoXCJkaXZcIiwgeyBjbGFzczogeyB0ZXh0OiB0cnVlLCBbQ1NTLnRleHRSZXZlcnNlXTogcmV2ZXJzZSB9IH0sIGgoSGVhZGluZywgeyBjbGFzczogQ1NTLm1vbnRoLCBsZXZlbDogdGhpcy5oZWFkaW5nTGV2ZWwgfSwgbG9jYWxpemVkTW9udGgpLCBoKFwic3BhblwiLCB7IGNsYXNzOiBDU1MueWVhcldyYXAgfSwgaChcImlucHV0XCIsIHsgXCJhcmlhLWxhYmVsXCI6IG1lc3NhZ2VzLnllYXIsIGNsYXNzOiB7XG4gICAgICAgIHllYXI6IHRydWUsXG4gICAgICAgIFtDU1MueWVhclN1ZmZpeF06ICEhc3VmZml4LFxuICAgICAgfSwgaW5wdXRtb2RlOiBcIm51bWVyaWNcIiwgbWF4bGVuZ3RoOiBcIjRcIiwgbWlubGVuZ3RoOiBcIjFcIiwgb25DaGFuZ2U6IHRoaXMub25ZZWFyQ2hhbmdlLCBvbklucHV0OiB0aGlzLm9uWWVhcklucHV0LCBvbktleURvd246IHRoaXMub25ZZWFyS2V5LCBwYXR0ZXJuOiBcIlxcXFxkKlwiLCB0eXBlOiBcInRleHRcIiwgdmFsdWU6IGxvY2FsaXplZFllYXIsXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QvanN4LXNvcnQtcHJvcHMgLS0gcmVmIHNob3VsZCBiZSBsYXN0IHNvIG5vZGUgYXR0cnMvcHJvcHMgYXJlIGluIHN5bmMgKHNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWRlc2lnbi1zeXN0ZW0vcHVsbC82NTMwKVxuICAgICAgcmVmOiAoZWwpID0+ICh0aGlzLnllYXJJbnB1dCA9IGVsKSB9KSwgc3VmZml4ICYmIGgoXCJzcGFuXCIsIHsgY2xhc3M6IENTUy5zdWZmaXggfSwgc3VmZml4KSkpLCBoKFwiYVwiLCB7IFwiYXJpYS1kaXNhYmxlZFwiOiBgJHt0aGlzLm5leHRNb250aERhdGUuZ2V0TW9udGgoKSA9PT0gYWN0aXZlTW9udGh9YCwgXCJhcmlhLWxhYmVsXCI6IG1lc3NhZ2VzLm5leHRNb250aCwgY2xhc3M6IENTUy5jaGV2cm9uLCBocmVmOiBcIiNcIiwgb25DbGljazogdGhpcy5uZXh0TW9udGhDbGljaywgb25LZXlEb3duOiB0aGlzLm5leHRNb250aEtleWRvd24sIHJvbGU6IFwiYnV0dG9uXCIsIHRhYmluZGV4OiB0aGlzLm5leHRNb250aERhdGUuZ2V0TW9udGgoKSA9PT0gYWN0aXZlTW9udGggPyAtMSA6IDAgfSwgaChcImNhbGNpdGUtaWNvblwiLCB7IFwiZmxpcC1ydGxcIjogdHJ1ZSwgaWNvbjogSUNPTi5jaGV2cm9uUmlnaHQsIHNjYWxlOiBnZXRJY29uU2NhbGUodGhpcy5zY2FsZSkgfSkpKSk7XG4gIH1cbiAgc2V0TmV4dFByZXZNb250aERhdGVzKCkge1xuICAgIGlmICghdGhpcy5hY3RpdmVEYXRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubmV4dE1vbnRoRGF0ZSA9IGRhdGVGcm9tUmFuZ2UobmV4dE1vbnRoKHRoaXMuYWN0aXZlRGF0ZSksIHRoaXMubWluLCB0aGlzLm1heCk7XG4gICAgdGhpcy5wcmV2TW9udGhEYXRlID0gZGF0ZUZyb21SYW5nZShwcmV2TW9udGgodGhpcy5hY3RpdmVEYXRlKSwgdGhpcy5taW4sIHRoaXMubWF4KTtcbiAgfVxuICBmb3JtYXRDYWxlbmRhclllYXIoeWVhcikge1xuICAgIHJldHVybiBudW1iZXJTdHJpbmdGb3JtYXR0ZXIubG9jYWxpemUoYCR7Zm9ybWF0Q2FsZW5kYXJZZWFyKHllYXIsIHRoaXMubG9jYWxlRGF0YSl9YCk7XG4gIH1cbiAgcGFyc2VDYWxlbmRhclllYXIoeWVhcikge1xuICAgIHJldHVybiBudW1iZXJTdHJpbmdGb3JtYXR0ZXIubG9jYWxpemUoYCR7cGFyc2VDYWxlbmRhclllYXIoTnVtYmVyKG51bWJlclN0cmluZ0Zvcm1hdHRlci5kZWxvY2FsaXplKHllYXIpKSwgdGhpcy5sb2NhbGVEYXRhKX1gKTtcbiAgfVxuICBnZXRJblJhbmdlRGF0ZSh7IGxvY2FsaXplZFllYXIsIG9mZnNldCA9IDAsIH0pIHtcbiAgICBjb25zdCB7IG1pbiwgbWF4LCBhY3RpdmVEYXRlIH0gPSB0aGlzO1xuICAgIGNvbnN0IHBhcnNlZFllYXIgPSBOdW1iZXIobnVtYmVyU3RyaW5nRm9ybWF0dGVyLmRlbG9jYWxpemUobG9jYWxpemVkWWVhcikpO1xuICAgIGNvbnN0IGxlbmd0aCA9IHBhcnNlZFllYXIudG9TdHJpbmcoKS5sZW5ndGg7XG4gICAgY29uc3QgeWVhciA9IGlzTmFOKHBhcnNlZFllYXIpID8gZmFsc2UgOiBwYXJzZWRZZWFyICsgb2Zmc2V0O1xuICAgIGNvbnN0IGluUmFuZ2UgPSB5ZWFyICYmICghbWluIHx8IG1pbi5nZXRGdWxsWWVhcigpIDw9IHllYXIpICYmICghbWF4IHx8IG1heC5nZXRGdWxsWWVhcigpID49IHllYXIpO1xuICAgIC8vIGlmIHlvdSd2ZSBzdXBwbGllZCBhIHllYXIgYW5kIGl0J3MgaW4gcmFuZ2VcbiAgICBpZiAoeWVhciAmJiBpblJhbmdlICYmIGxlbmd0aCA9PT0gbG9jYWxpemVkWWVhci5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IG5leHREYXRlID0gbmV3IERhdGUoYWN0aXZlRGF0ZSk7XG4gICAgICBuZXh0RGF0ZS5zZXRGdWxsWWVhcih5ZWFyKTtcbiAgICAgIHJldHVybiBkYXRlRnJvbVJhbmdlKG5leHREYXRlLCBtaW4sIG1heCk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBQYXJzZSBsb2NhbGl6ZWQgeWVhciBzdHJpbmcgZnJvbSBpbnB1dCxcbiAgICogc2V0IHRvIGFjdGl2ZSBpZiBpbiByYW5nZVxuICAgKlxuICAgKiBAcGFyYW0gcm9vdDBcbiAgICogQHBhcmFtIHJvb3QwLmxvY2FsaXplZFllYXJcbiAgICogQHBhcmFtIHJvb3QwLmNvbW1pdFxuICAgKiBAcGFyYW0gcm9vdDAub2Zmc2V0XG4gICAqL1xuICBzZXRZZWFyKHsgbG9jYWxpemVkWWVhciwgY29tbWl0ID0gdHJ1ZSwgb2Zmc2V0ID0gMCwgfSkge1xuICAgIGNvbnN0IHsgeWVhcklucHV0LCBhY3RpdmVEYXRlIH0gPSB0aGlzO1xuICAgIGNvbnN0IGluUmFuZ2VEYXRlID0gdGhpcy5nZXRJblJhbmdlRGF0ZSh7IGxvY2FsaXplZFllYXIsIG9mZnNldCB9KTtcbiAgICAvLyBpZiB5b3UndmUgc3VwcGxpZWQgYSB5ZWFyIGFuZCBpdCdzIGluIHJhbmdlLCB1cGRhdGUgYWN0aXZlIGRhdGVcbiAgICBpZiAoaW5SYW5nZURhdGUpIHtcbiAgICAgIHRoaXMuY2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlclNlbGVjdC5lbWl0KGluUmFuZ2VEYXRlKTtcbiAgICB9XG4gICAgaWYgKGNvbW1pdCkge1xuICAgICAgeWVhcklucHV0LnZhbHVlID0gdGhpcy5mb3JtYXRDYWxlbmRhclllYXIoKGluUmFuZ2VEYXRlIHx8IGFjdGl2ZURhdGUpLmdldEZ1bGxZZWFyKCkpO1xuICAgIH1cbiAgfVxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgXCJtaW5cIjogW1wic2V0TmV4dFByZXZNb250aERhdGVzXCJdLFxuICAgIFwibWF4XCI6IFtcInNldE5leHRQcmV2TW9udGhEYXRlc1wiXSxcbiAgICBcImFjdGl2ZURhdGVcIjogW1wic2V0TmV4dFByZXZNb250aERhdGVzXCJdXG4gIH07IH1cbn07XG5EYXRlUGlja2VyTW9udGhIZWFkZXIuc3R5bGUgPSBkYXRlUGlja2VyTW9udGhIZWFkZXJDc3M7XG5cbmV4cG9ydCB7IERhdGVQaWNrZXIgYXMgY2FsY2l0ZV9kYXRlX3BpY2tlciwgRGF0ZVBpY2tlckRheSBhcyBjYWxjaXRlX2RhdGVfcGlja2VyX2RheSwgRGF0ZVBpY2tlck1vbnRoIGFzIGNhbGNpdGVfZGF0ZV9waWNrZXJfbW9udGgsIERhdGVQaWNrZXJNb250aEhlYWRlciBhcyBjYWxjaXRlX2RhdGVfcGlja2VyX21vbnRoX2hlYWRlciB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jYWxjaXRlLWRhdGUtcGlja2VyXzQuZW50cnkuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtZGVzaWduLXN5c3RlbS9ibG9iL21haW4vTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYyLjAuMFxuICovXG5pbXBvcnQgeyBmIGFzIGZvcmNlVXBkYXRlIH0gZnJvbSAnLi9pbmRleC04NmZhZWY5Yy5qcyc7XG5cbmNvbnN0IHJlc29sdmVNYXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgcHJvbWlzZU1hcCA9IG5ldyBXZWFrTWFwKCk7XG4vKipcbiAqIFRoaXMgaGVscGVyIHV0aWwgc2V0cyB1cCB0aGUgY29tcG9uZW50IGZvciB0aGUgYWJpbGl0eSB0byBrbm93IHdoZW4gdGhlIGNvbXBvbmVudCBoYXMgYmVlbiBsb2FkZWQuXG4gKlxuICogVGhpcyBzaG91bGQgYmUgdXNlZCBpbiB0aGUgYGNvbXBvbmVudFdpbGxMb2FkYCBsaWZlY3ljbGUgaG9vay5cbiAqXG4gKiBgYGBcbiAqIGNvbXBvbmVudFdpbGxMb2FkKCk6IHZvaWQge1xuICogICBzZXRVcExvYWRhYmxlQ29tcG9uZW50KHRoaXMpO1xuICogfVxuICogYGBgXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICovXG5mdW5jdGlvbiBzZXRVcExvYWRhYmxlQ29tcG9uZW50KGNvbXBvbmVudCkge1xuICBwcm9taXNlTWFwLnNldChjb21wb25lbnQsIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXNvbHZlTWFwLnNldChjb21wb25lbnQsIHJlc29sdmUpKSk7XG59XG4vKipcbiAqIFRoaXMgaGVscGVyIHV0aWwgbGV0cyB0aGUgbG9hZGFibGUgY29tcG9uZW50IGtub3cgdGhhdCBpdCBpcyBub3cgbG9hZGVkLlxuICpcbiAqIFRoaXMgc2hvdWxkIGJlIHVzZWQgaW4gdGhlIGBjb21wb25lbnREaWRMb2FkYCBsaWZlY3ljbGUgaG9vay5cbiAqXG4gKiBgYGBcbiAqIGNvbXBvbmVudERpZExvYWQoKTogdm9pZCB7XG4gKiAgIHNldENvbXBvbmVudExvYWRlZCh0aGlzKTtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqL1xuZnVuY3Rpb24gc2V0Q29tcG9uZW50TG9hZGVkKGNvbXBvbmVudCkge1xuICByZXNvbHZlTWFwLmdldChjb21wb25lbnQpKCk7XG59XG4vKipcbiAqIFRoaXMgaGVscGVyIHV0aWwgY2FuIGJlIHVzZWQgdG8gZW5zdXJlIGEgY29tcG9uZW50IGhhcyBiZWVuIGxvYWRlZCAoVGhlIFwiY29tcG9uZW50RGlkTG9hZFwiIFN0ZW5jaWwgbGlmZWN5Y2xlIG1ldGhvZCBoYXMgYmVlbiBjYWxsZWQpLlxuICpcbiAqIFJlcXVpcmVzIHJlcXVpcmVzIGBMb2FkYWJsZUNvbXBvbmVudGAgdG8gYmUgaW1wbGVtZW50ZWQuXG4gKlxuICogQSBjb21wb25lbnQgZGV2ZWxvcGVyIGNhbiBhd2FpdCB0aGlzIG1ldGhvZCBiZWZvcmUgcHJvY2VlZGluZyB3aXRoIGFueSBsb2dpYyB0aGF0IHJlcXVpcmVzIGEgY29tcG9uZW50IHRvIGJlIGxvYWRlZCBmaXJzdC5cbiAqXG4gKiBgYGBcbiAqIGFzeW5jIG15TWV0aG9kKCk6IFByb21pc2U8dm9pZD4ge1xuICogICBhd2FpdCBjb21wb25lbnRMb2FkZWQodGhpcyk7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50XG4gKiBAcmV0dXJucyBQcm9taXNlPHZvaWQ+XG4gKi9cbmZ1bmN0aW9uIGNvbXBvbmVudExvYWRlZChjb21wb25lbnQpIHtcbiAgcmV0dXJuIHByb21pc2VNYXAuZ2V0KGNvbXBvbmVudCk7XG59XG4vKipcbiAqIFRoaXMgaGVscGVyIHV0aWwgY2FuIGJlIHVzZWQgdG8gZW5zdXJpbmcgdGhlIGNvbXBvbmVudCBpcyBsb2FkZWQgYW5kIHJlbmRlcmVkIGJ5IHRoZSBicm93c2VyIChUaGUgXCJjb21wb25lbnREaWRMb2FkXCIgU3RlbmNpbCBsaWZlY3ljbGUgbWV0aG9kIGhhcyBiZWVuIGNhbGxlZCBhbmQgYW55IGludGVybmFsIGVsZW1lbnRzIGFyZSBmb2N1c2FibGUpLlxuICpcbiAqIFJlcXVpcmVzIHJlcXVpcmVzIGBMb2FkYWJsZUNvbXBvbmVudGAgdG8gYmUgaW1wbGVtZW50ZWQuXG4gKlxuICogQSBjb21wb25lbnQgZGV2ZWxvcGVyIGNhbiBhd2FpdCB0aGlzIG1ldGhvZCBiZWZvcmUgcHJvY2VlZGluZyB3aXRoIGFueSBsb2dpYyB0aGF0IHJlcXVpcmVzIGEgY29tcG9uZW50IHRvIGJlIGxvYWRlZCBmaXJzdCBhbmQgdGhlbiBhbiBpbnRlcm5hbCBlbGVtZW50IGJlIGZvY3VzZWQuXG4gKlxuICogYGBgXG4gKiBhc3luYyBzZXRGb2N1cygpOiBQcm9taXNlPHZvaWQ+IHtcbiAqICAgYXdhaXQgY29tcG9uZW50Rm9jdXNhYmxlKHRoaXMpO1xuICogICB0aGlzLmludGVybmFsRWxlbWVudD8uZm9jdXMoKTtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqIEByZXR1cm5zIFByb21pc2U8dm9pZD5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gY29tcG9uZW50Rm9jdXNhYmxlKGNvbXBvbmVudCkge1xuICBhd2FpdCBjb21wb25lbnRMb2FkZWQoY29tcG9uZW50KTtcbiAgZm9yY2VVcGRhdGUoY29tcG9uZW50KTtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcmVzb2x2ZSgpKSk7XG59XG5cbmV4cG9ydCB7IHNldENvbXBvbmVudExvYWRlZCBhcyBhLCBjb21wb25lbnRMb2FkZWQgYXMgYiwgY29tcG9uZW50Rm9jdXNhYmxlIGFzIGMsIHNldFVwTG9hZGFibGVDb21wb25lbnQgYXMgcyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2FkYWJsZS1iMTczOTZlMC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=