"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-9bb17d"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-preference.entry.js":
/*!*************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-preference.entry.js ***!
  \*************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_feature_layer_preference: () => (/* binding */ ArcgisNewItemPagesFeatureLayerPreference)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/* harmony import */ var _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui-bca7bcd1.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js");
/* harmony import */ var _feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./feature-layer-79fb302c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-79fb302c.js");
/* harmony import */ var _feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./feature-layer-58e18b03.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./functional-44de8fcf.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js");
/* harmony import */ var _guid_aeaed84d_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./guid-aeaed84d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-aeaed84d.js");
/* harmony import */ var _url_4c3ae54c_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./url-4c3ae54c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/url-4c3ae54c.js");
/* harmony import */ var _thumbnail_bcb89e69_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./thumbnail-bcb89e69.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/thumbnail-bcb89e69.js");
/* harmony import */ var _portal_d518b571_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./portal-d518b571.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-d518b571.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _service_8c2c4241_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./service-8c2c4241.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/service-8c2c4241.js");
/* harmony import */ var _user_3ea69c3a_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./user-3ea69c3a.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/user-3ea69c3a.js");
/* harmony import */ var _query_d62660d4_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./query-d62660d4.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/query-d62660d4.js");
/* harmony import */ var _api_2e3a136f_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./api-2e3a136f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/api-2e3a136f.js");
/* harmony import */ var _string_58a5fef3_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./string-58a5fef3.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/string-58a5fef3.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _item_c58ffced_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./item-c58ffced.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-c58ffced.js");
/* harmony import */ var _server_item_8d384796_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./server-item-8d384796.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/server-item-8d384796.js");
/* harmony import */ var _item_3535552d_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./item-3535552d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-3535552d.js");
/* harmony import */ var _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./item-properties-10491b2e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-properties-10491b2e.js");
/* harmony import */ var _functional_81373f6d_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./functional-81373f6d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-81373f6d.js");
/* harmony import */ var _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./item-types-2029b06b.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-2029b06b.js");
/* harmony import */ var _feature_layer_17b64946_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./feature-layer-17b64946.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-17b64946.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



























const ArcgisNewItemPagesFeatureLayerPreference = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.newItemUpdatePage = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
        this.featureLayerInfos = [];
        this.showCaptureGPS = true;
        this.layerPreference = {
            captureGPS: false,
            enableZDefaults: false,
            enableMDefaults: false
        };
    }
    handleNext() {
        const { featureLayerInfos, layerPreference } = this;
        const newLayerInfos = (0,_feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_3__.m)(featureLayerInfos, layerPreference);
        _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.serviceInfo = Object.assign(Object.assign({}, _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.serviceInfo), { enableZDefaults: layerPreference.enableZDefaults, enableMDefaults: layerPreference.enableMDefaults, layers: newLayerInfos.filter((info) => info.type === "Feature Layer"), tables: newLayerInfos.filter((info) => info.type === "Table") });
        this.newItemUpdatePage.emit("itemProperties");
    }
    async componentWillLoad() {
        var _a, _b;
        const { i18n } = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_2__.u;
        this.i18n = i18n.featureLayerFromScratch;
        const { serviceInfo } = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a;
        const featureServiceInfo = serviceInfo;
        this.featureLayerInfos = [...featureServiceInfo.layers, ...featureServiceInfo.tables].sort((infoA, infoB) => infoA.id - infoB.id);
        this.layerPreference = {
            captureGPS: this.featureLayerInfos.some(_feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_3__.l),
            enableZDefaults: (_a = featureServiceInfo.enableZDefaults) !== null && _a !== void 0 ? _a : this.featureLayerInfos.some(_feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_3__.d),
            enableMDefaults: (_b = featureServiceInfo.enableMDefaults) !== null && _b !== void 0 ? _b : this.featureLayerInfos.some(_feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_3__.e)
        };
        this.showCaptureGPS = this.featureLayerInfos.some((info) => info.type === "Feature Layer" &&
            ["esriGeometryPoint", "esriGeometryPolygon", "esriGeometryPolyline"].includes(info.geometryType));
    }
    render() {
        const { i18n, layerPreference, showCaptureGPS } = this;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-layer-preference", { i18n: i18n, defaultPreference: layerPreference, showCaptureGPS: showCaptureGPS, onLayerPreferenceChange: (event) => {
                const { layerPreference } = this;
                const detail = event.detail;
                if (!layerPreference.captureGPS && detail.captureGPS) {
                    (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_4__.e)("captureGPS");
                }
                if (!layerPreference.enableZDefaults && detail.enableZDefaults) {
                    (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_4__.e)("enableZDefaults");
                }
                if (!layerPreference.enableMDefaults && detail.enableMDefaults) {
                    (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_4__.e)("enableMDefaults");
                }
                this.layerPreference = detail;
            } })));
    }
};



//# sourceMappingURL=arcgis-new-item-pages-feature-layer-preference.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js":
/*!*******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ featureServiceEndTelemetry),
/* harmony export */   b: () => (/* binding */ filterChangeTelemetry),
/* harmony export */   c: () => (/* binding */ featureLayerTypeTelemetry),
/* harmony export */   e: () => (/* binding */ enableLayerPreferenceTelemetry),
/* harmony export */   f: () => (/* binding */ featureLayerErrorTelemetry),
/* harmony export */   i: () => (/* binding */ itemExpandedTelemetry)
/* harmony export */ });
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



const TELEMETRY_ID = "create feature layer";
const TELEMETRY_PAGE_NAME = "my content";
const addFeatureLayerTypeToTelemetry = (type) => {
    switch (type) {
        case "build":
            return "blank";
        case "existing":
            return "fs";
        case "template":
            return "template";
        case "link":
            return "url";
    }
};
const enableLayerPreferenceTelemetry = (type) => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `enable ${type === "captureGPS" ? "gps" : type === "enableZDefaults" ? "z" : "m"}`, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const itemExpandedTelemetry = (type) => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `expand ${type} details`, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const filterChangeTelemetry = () => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "filter", {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const featureLayerTypeTelemetry = (type) => {
    const telemetryType = addFeatureLayerTypeToTelemetry(type);
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "from option", {
        category: TELEMETRY_ID,
        attribute: telemetryType,
        pageName: TELEMETRY_PAGE_NAME
    });
};
const featureServiceEndTelemetry = () => {
    const { addFeatureLayerType, serviceInfo } = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a;
    const featureLayerServiceInfo = serviceInfo;
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.endWorkflow(TELEMETRY_ID, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME,
        count: featureLayerServiceInfo.layers.length,
        number: featureLayerServiceInfo.tables.length
    });
};
const featureLayerErrorTelemetry = (errString) => {
    var _a;
    (_a = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry) === null || _a === void 0 ? void 0 : _a.logError({
        category: TELEMETRY_ID,
        error: errString
    });
};



//# sourceMappingURL=feature-layer-58e18b03.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLW5ldy1pdGUtOWJiMTdkLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzRGO0FBQ2pDO0FBQ047QUFDcUY7QUFDeEQ7QUFDckQ7QUFDQztBQUNJO0FBQ047QUFDRDtBQUNNO0FBQ0g7QUFDSztBQUNKO0FBQ0g7QUFDQztBQUNGO0FBQ0c7QUFDSDtBQUNDO0FBQ087QUFDUDtBQUNXO0FBQ0w7QUFDQTtBQUNHOztBQUVyQztBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEIsaUNBQWlDLHFEQUFXO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxQ0FBcUM7QUFDckQsOEJBQThCLDZEQUFvQjtBQUNsRCxRQUFRLG9EQUFZLDZDQUE2QyxFQUFFLG9EQUFZLGlCQUFpQiwwT0FBME87QUFDMVU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsT0FBTyxFQUFFLDhDQUFZO0FBQ3JDO0FBQ0EsZ0JBQWdCLGNBQWMsRUFBRSxvREFBWTtBQUM1QztBQUNBO0FBQ0E7QUFDQSxvREFBb0QseURBQWU7QUFDbkUsb0lBQW9JLHlEQUFlO0FBQ25KLG9JQUFvSSx5REFBZTtBQUNuSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdDQUF3QztBQUN4RCxnQkFBZ0IscURBQUMsQ0FBQyxpREFBSSxRQUFRLHFEQUFDLHVDQUF1QztBQUN0RSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQSxvQkFBb0IsNkRBQThCO0FBQ2xEO0FBQ0E7QUFDQSxvQkFBb0IsNkRBQThCO0FBQ2xEO0FBQ0E7QUFDQSxvQkFBb0IsNkRBQThCO0FBQ2xEO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTs7QUFFc0c7O0FBRXRHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyRkE7QUFDQTtBQUNBO0FBQ0E7QUFDd0Q7QUFDRzs7QUFFM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDLHlHQUF5Ryx1RUFBdUU7QUFDaEw7QUFDQSxrREFBa0Qsb0RBQVk7QUFDOUQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHNCQUFzQixrREFBVztBQUNqQyx5R0FBeUcsTUFBTTtBQUMvRztBQUNBLGtEQUFrRCxvREFBWTtBQUM5RDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0E7QUFDQSxrREFBa0Qsb0RBQVk7QUFDOUQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZLG1DQUFtQyxFQUFFLG9EQUFZO0FBQzdEO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGtEQUFXO0FBQ3JCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRXlNOztBQUV6TSIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1uZXctaXRlbS1wYWdlcy1mZWF0dXJlLWxheWVyLXByZWZlcmVuY2UuZW50cnkuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vZmVhdHVyZS1sYXllci01OGUxOGIwMy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgSCBhcyBIb3N0IH0gZnJvbSAnLi9pbmRleC1lM2JmN2RhNy5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tZGJiZTJmNTcuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWJjYTdiY2QxLmpzJztcbmltcG9ydCB7IG0gYXMgbWVyZ2VMYXllclByZWZlcmVuY2UsIGwgYXMgbGF5ZXJDYXB0dXJlR1BTLCBkIGFzIGxheWVyVXNlWlZhbHVlcywgZSBhcyBsYXllclVzZU1WYWx1ZXMgfSBmcm9tICcuL2ZlYXR1cmUtbGF5ZXItNzlmYjMwMmMuanMnO1xuaW1wb3J0IHsgZSBhcyBlbmFibGVMYXllclByZWZlcmVuY2VUZWxlbWV0cnkgfSBmcm9tICcuL2ZlYXR1cmUtbGF5ZXItNThlMThiMDMuanMnO1xuaW1wb3J0ICcuL2luZGV4LTA1OTU2Y2FiLmpzJztcbmltcG9ydCAnLi9jb25maWctNzVhZGY5NjIuanMnO1xuaW1wb3J0ICcuL2Z1bmN0aW9uYWwtNDRkZThmY2YuanMnO1xuaW1wb3J0ICcuL2d1aWQtYWVhZWQ4NGQuanMnO1xuaW1wb3J0ICcuL3VybC00YzNhZTU0Yy5qcyc7XG5pbXBvcnQgJy4vdGh1bWJuYWlsLWJjYjg5ZTY5LmpzJztcbmltcG9ydCAnLi9wb3J0YWwtZDUxOGI1NzEuanMnO1xuaW1wb3J0ICcuL2xvYWRNb2R1bGVzLWI0YWMxMjQ3LmpzJztcbmltcG9ydCAnLi9zZXJ2aWNlLThjMmM0MjQxLmpzJztcbmltcG9ydCAnLi91c2VyLTNlYTY5YzNhLmpzJztcbmltcG9ydCAnLi9xdWVyeS1kNjI2NjBkNC5qcyc7XG5pbXBvcnQgJy4vYXBpLTJlM2ExMzZmLmpzJztcbmltcG9ydCAnLi9zdHJpbmctNThhNWZlZjMuanMnO1xuaW1wb3J0ICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5pbXBvcnQgJy4vaXRlbS1jNThmZmNlZC5qcyc7XG5pbXBvcnQgJy4vc2VydmVyLWl0ZW0tOGQzODQ3OTYuanMnO1xuaW1wb3J0ICcuL2l0ZW0tMzUzNTU1MmQuanMnO1xuaW1wb3J0ICcuL2l0ZW0tcHJvcGVydGllcy0xMDQ5MWIyZS5qcyc7XG5pbXBvcnQgJy4vZnVuY3Rpb25hbC04MTM3M2Y2ZC5qcyc7XG5pbXBvcnQgJy4vaXRlbS10eXBlcy0yMDI5YjA2Yi5qcyc7XG5pbXBvcnQgJy4vZmVhdHVyZS1sYXllci0xN2I2NDk0Ni5qcyc7XG5cbmNvbnN0IEFyY2dpc05ld0l0ZW1QYWdlc0ZlYXR1cmVMYXllclByZWZlcmVuY2UgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJuZXdJdGVtVXBkYXRlUGFnZVwiLCA3KTtcbiAgICAgICAgdGhpcy5mZWF0dXJlTGF5ZXJJbmZvcyA9IFtdO1xuICAgICAgICB0aGlzLnNob3dDYXB0dXJlR1BTID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sYXllclByZWZlcmVuY2UgPSB7XG4gICAgICAgICAgICBjYXB0dXJlR1BTOiBmYWxzZSxcbiAgICAgICAgICAgIGVuYWJsZVpEZWZhdWx0czogZmFsc2UsXG4gICAgICAgICAgICBlbmFibGVNRGVmYXVsdHM6IGZhbHNlXG4gICAgICAgIH07XG4gICAgfVxuICAgIGhhbmRsZU5leHQoKSB7XG4gICAgICAgIGNvbnN0IHsgZmVhdHVyZUxheWVySW5mb3MsIGxheWVyUHJlZmVyZW5jZSB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgbmV3TGF5ZXJJbmZvcyA9IG1lcmdlTGF5ZXJQcmVmZXJlbmNlKGZlYXR1cmVMYXllckluZm9zLCBsYXllclByZWZlcmVuY2UpO1xuICAgICAgICBhZGRJdGVtU3RhdGUuc2VydmljZUluZm8gPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGFkZEl0ZW1TdGF0ZS5zZXJ2aWNlSW5mbyksIHsgZW5hYmxlWkRlZmF1bHRzOiBsYXllclByZWZlcmVuY2UuZW5hYmxlWkRlZmF1bHRzLCBlbmFibGVNRGVmYXVsdHM6IGxheWVyUHJlZmVyZW5jZS5lbmFibGVNRGVmYXVsdHMsIGxheWVyczogbmV3TGF5ZXJJbmZvcy5maWx0ZXIoKGluZm8pID0+IGluZm8udHlwZSA9PT0gXCJGZWF0dXJlIExheWVyXCIpLCB0YWJsZXM6IG5ld0xheWVySW5mb3MuZmlsdGVyKChpbmZvKSA9PiBpbmZvLnR5cGUgPT09IFwiVGFibGVcIikgfSk7XG4gICAgICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UuZW1pdChcIml0ZW1Qcm9wZXJ0aWVzXCIpO1xuICAgIH1cbiAgICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgY29uc3QgeyBpMThuIH0gPSB1aVN0b3JlU3RhdGU7XG4gICAgICAgIHRoaXMuaTE4biA9IGkxOG4uZmVhdHVyZUxheWVyRnJvbVNjcmF0Y2g7XG4gICAgICAgIGNvbnN0IHsgc2VydmljZUluZm8gfSA9IGFkZEl0ZW1TdGF0ZTtcbiAgICAgICAgY29uc3QgZmVhdHVyZVNlcnZpY2VJbmZvID0gc2VydmljZUluZm87XG4gICAgICAgIHRoaXMuZmVhdHVyZUxheWVySW5mb3MgPSBbLi4uZmVhdHVyZVNlcnZpY2VJbmZvLmxheWVycywgLi4uZmVhdHVyZVNlcnZpY2VJbmZvLnRhYmxlc10uc29ydCgoaW5mb0EsIGluZm9CKSA9PiBpbmZvQS5pZCAtIGluZm9CLmlkKTtcbiAgICAgICAgdGhpcy5sYXllclByZWZlcmVuY2UgPSB7XG4gICAgICAgICAgICBjYXB0dXJlR1BTOiB0aGlzLmZlYXR1cmVMYXllckluZm9zLnNvbWUobGF5ZXJDYXB0dXJlR1BTKSxcbiAgICAgICAgICAgIGVuYWJsZVpEZWZhdWx0czogKF9hID0gZmVhdHVyZVNlcnZpY2VJbmZvLmVuYWJsZVpEZWZhdWx0cykgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogdGhpcy5mZWF0dXJlTGF5ZXJJbmZvcy5zb21lKGxheWVyVXNlWlZhbHVlcyksXG4gICAgICAgICAgICBlbmFibGVNRGVmYXVsdHM6IChfYiA9IGZlYXR1cmVTZXJ2aWNlSW5mby5lbmFibGVNRGVmYXVsdHMpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHRoaXMuZmVhdHVyZUxheWVySW5mb3Muc29tZShsYXllclVzZU1WYWx1ZXMpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2hvd0NhcHR1cmVHUFMgPSB0aGlzLmZlYXR1cmVMYXllckluZm9zLnNvbWUoKGluZm8pID0+IGluZm8udHlwZSA9PT0gXCJGZWF0dXJlIExheWVyXCIgJiZcbiAgICAgICAgICAgIFtcImVzcmlHZW9tZXRyeVBvaW50XCIsIFwiZXNyaUdlb21ldHJ5UG9seWdvblwiLCBcImVzcmlHZW9tZXRyeVBvbHlsaW5lXCJdLmluY2x1ZGVzKGluZm8uZ2VvbWV0cnlUeXBlKSk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBpMThuLCBsYXllclByZWZlcmVuY2UsIHNob3dDYXB0dXJlR1BTIH0gPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImFyY2dpcy1uZXctaXRlbS1sYXllci1wcmVmZXJlbmNlXCIsIHsgaTE4bjogaTE4biwgZGVmYXVsdFByZWZlcmVuY2U6IGxheWVyUHJlZmVyZW5jZSwgc2hvd0NhcHR1cmVHUFM6IHNob3dDYXB0dXJlR1BTLCBvbkxheWVyUHJlZmVyZW5jZUNoYW5nZTogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBsYXllclByZWZlcmVuY2UgfSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgY29uc3QgZGV0YWlsID0gZXZlbnQuZGV0YWlsO1xuICAgICAgICAgICAgICAgIGlmICghbGF5ZXJQcmVmZXJlbmNlLmNhcHR1cmVHUFMgJiYgZGV0YWlsLmNhcHR1cmVHUFMpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlTGF5ZXJQcmVmZXJlbmNlVGVsZW1ldHJ5KFwiY2FwdHVyZUdQU1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFsYXllclByZWZlcmVuY2UuZW5hYmxlWkRlZmF1bHRzICYmIGRldGFpbC5lbmFibGVaRGVmYXVsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlTGF5ZXJQcmVmZXJlbmNlVGVsZW1ldHJ5KFwiZW5hYmxlWkRlZmF1bHRzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWxheWVyUHJlZmVyZW5jZS5lbmFibGVNRGVmYXVsdHMgJiYgZGV0YWlsLmVuYWJsZU1EZWZhdWx0cykge1xuICAgICAgICAgICAgICAgICAgICBlbmFibGVMYXllclByZWZlcmVuY2VUZWxlbWV0cnkoXCJlbmFibGVNRGVmYXVsdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMubGF5ZXJQcmVmZXJlbmNlID0gZGV0YWlsO1xuICAgICAgICAgICAgfSB9KSkpO1xuICAgIH1cbn07XG5cbmV4cG9ydCB7IEFyY2dpc05ld0l0ZW1QYWdlc0ZlYXR1cmVMYXllclByZWZlcmVuY2UgYXMgYXJjZ2lzX25ld19pdGVtX3BhZ2VzX2ZlYXR1cmVfbGF5ZXJfcHJlZmVyZW5jZSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcmNnaXMtbmV3LWl0ZW0tcGFnZXMtZmVhdHVyZS1sYXllci1wcmVmZXJlbmNlLmVudHJ5LmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYyBhcyBjb25maWdTdGF0ZSB9IGZyb20gJy4vY29uZmlnLTc1YWRmOTYyLmpzJztcbmltcG9ydCB7IGEgYXMgYWRkSXRlbVN0YXRlIH0gZnJvbSAnLi9hZGQtaXRlbS1kYmJlMmY1Ny5qcyc7XG5cbmNvbnN0IFRFTEVNRVRSWV9JRCA9IFwiY3JlYXRlIGZlYXR1cmUgbGF5ZXJcIjtcbmNvbnN0IFRFTEVNRVRSWV9QQUdFX05BTUUgPSBcIm15IGNvbnRlbnRcIjtcbmNvbnN0IGFkZEZlYXR1cmVMYXllclR5cGVUb1RlbGVtZXRyeSA9ICh0eXBlKSA9PiB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgXCJidWlsZFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiYmxhbmtcIjtcbiAgICAgICAgY2FzZSBcImV4aXN0aW5nXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJmc1wiO1xuICAgICAgICBjYXNlIFwidGVtcGxhdGVcIjpcbiAgICAgICAgICAgIHJldHVybiBcInRlbXBsYXRlXCI7XG4gICAgICAgIGNhc2UgXCJsaW5rXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJ1cmxcIjtcbiAgICB9XG59O1xuY29uc3QgZW5hYmxlTGF5ZXJQcmVmZXJlbmNlVGVsZW1ldHJ5ID0gKHR5cGUpID0+IHtcbiAgICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gICAgdGVsZW1ldHJ5ID09PSBudWxsIHx8IHRlbGVtZXRyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZW1ldHJ5LnN0ZXBXb3JrZmxvdyhURUxFTUVUUllfSUQsIGBlbmFibGUgJHt0eXBlID09PSBcImNhcHR1cmVHUFNcIiA/IFwiZ3BzXCIgOiB0eXBlID09PSBcImVuYWJsZVpEZWZhdWx0c1wiID8gXCJ6XCIgOiBcIm1cIn1gLCB7XG4gICAgICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgICAgIGF0dHJpYnV0ZTogYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5KGFkZEl0ZW1TdGF0ZS5hZGRGZWF0dXJlTGF5ZXJUeXBlKSxcbiAgICAgICAgcGFnZU5hbWU6IFRFTEVNRVRSWV9QQUdFX05BTUVcbiAgICB9KTtcbn07XG5jb25zdCBpdGVtRXhwYW5kZWRUZWxlbWV0cnkgPSAodHlwZSkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeTtcbiAgICB0ZWxlbWV0cnkgPT09IG51bGwgfHwgdGVsZW1ldHJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZWxlbWV0cnkuc3RlcFdvcmtmbG93KFRFTEVNRVRSWV9JRCwgYGV4cGFuZCAke3R5cGV9IGRldGFpbHNgLCB7XG4gICAgICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgICAgIGF0dHJpYnV0ZTogYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5KGFkZEl0ZW1TdGF0ZS5hZGRGZWF0dXJlTGF5ZXJUeXBlKSxcbiAgICAgICAgcGFnZU5hbWU6IFRFTEVNRVRSWV9QQUdFX05BTUVcbiAgICB9KTtcbn07XG5jb25zdCBmaWx0ZXJDaGFuZ2VUZWxlbWV0cnkgPSAoKSA9PiB7XG4gICAgY29uc3QgdGVsZW1ldHJ5ID0gY29uZmlnU3RhdGUudGVsZW1ldHJ5O1xuICAgIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5zdGVwV29ya2Zsb3coVEVMRU1FVFJZX0lELCBcImZpbHRlclwiLCB7XG4gICAgICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgICAgIGF0dHJpYnV0ZTogYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5KGFkZEl0ZW1TdGF0ZS5hZGRGZWF0dXJlTGF5ZXJUeXBlKSxcbiAgICAgICAgcGFnZU5hbWU6IFRFTEVNRVRSWV9QQUdFX05BTUVcbiAgICB9KTtcbn07XG5jb25zdCBmZWF0dXJlTGF5ZXJUeXBlVGVsZW1ldHJ5ID0gKHR5cGUpID0+IHtcbiAgICBjb25zdCB0ZWxlbWV0cnlUeXBlID0gYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5KHR5cGUpO1xuICAgIGNvbnN0IHRlbGVtZXRyeSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeTtcbiAgICB0ZWxlbWV0cnkgPT09IG51bGwgfHwgdGVsZW1ldHJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZWxlbWV0cnkuc3RlcFdvcmtmbG93KFRFTEVNRVRSWV9JRCwgXCJmcm9tIG9wdGlvblwiLCB7XG4gICAgICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgICAgIGF0dHJpYnV0ZTogdGVsZW1ldHJ5VHlwZSxcbiAgICAgICAgcGFnZU5hbWU6IFRFTEVNRVRSWV9QQUdFX05BTUVcbiAgICB9KTtcbn07XG5jb25zdCBmZWF0dXJlU2VydmljZUVuZFRlbGVtZXRyeSA9ICgpID0+IHtcbiAgICBjb25zdCB7IGFkZEZlYXR1cmVMYXllclR5cGUsIHNlcnZpY2VJbmZvIH0gPSBhZGRJdGVtU3RhdGU7XG4gICAgY29uc3QgZmVhdHVyZUxheWVyU2VydmljZUluZm8gPSBzZXJ2aWNlSW5mbztcbiAgICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gICAgdGVsZW1ldHJ5ID09PSBudWxsIHx8IHRlbGVtZXRyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZW1ldHJ5LmVuZFdvcmtmbG93KFRFTEVNRVRSWV9JRCwge1xuICAgICAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgICAgICBhdHRyaWJ1dGU6IGFkZEZlYXR1cmVMYXllclR5cGVUb1RlbGVtZXRyeShhZGRGZWF0dXJlTGF5ZXJUeXBlKSxcbiAgICAgICAgcGFnZU5hbWU6IFRFTEVNRVRSWV9QQUdFX05BTUUsXG4gICAgICAgIGNvdW50OiBmZWF0dXJlTGF5ZXJTZXJ2aWNlSW5mby5sYXllcnMubGVuZ3RoLFxuICAgICAgICBudW1iZXI6IGZlYXR1cmVMYXllclNlcnZpY2VJbmZvLnRhYmxlcy5sZW5ndGhcbiAgICB9KTtcbn07XG5jb25zdCBmZWF0dXJlTGF5ZXJFcnJvclRlbGVtZXRyeSA9IChlcnJTdHJpbmcpID0+IHtcbiAgICB2YXIgX2E7XG4gICAgKF9hID0gY29uZmlnU3RhdGUudGVsZW1ldHJ5KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubG9nRXJyb3Ioe1xuICAgICAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgICAgICBlcnJvcjogZXJyU3RyaW5nXG4gICAgfSk7XG59O1xuXG5leHBvcnQgeyBmZWF0dXJlU2VydmljZUVuZFRlbGVtZXRyeSBhcyBhLCBmaWx0ZXJDaGFuZ2VUZWxlbWV0cnkgYXMgYiwgZmVhdHVyZUxheWVyVHlwZVRlbGVtZXRyeSBhcyBjLCBlbmFibGVMYXllclByZWZlcmVuY2VUZWxlbWV0cnkgYXMgZSwgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnkgYXMgZiwgaXRlbUV4cGFuZGVkVGVsZW1ldHJ5IGFzIGkgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmVhdHVyZS1sYXllci01OGUxOGIwMy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=