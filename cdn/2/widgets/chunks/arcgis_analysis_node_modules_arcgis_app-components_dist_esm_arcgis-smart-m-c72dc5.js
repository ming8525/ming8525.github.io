"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-smart-m-c72dc5"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping-dropdown.entry.js":
/*!********************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping-dropdown.entry.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_smart_mapping_dropdown: () => (/* binding */ ArcgisSmartMappingDropdown)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./raster-unique-value-0976ec7f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-unique-value-0976ec7f.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _commonEnums_fcf13661_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./commonEnums-fcf13661.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonEnums-fcf13661.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locale-050b6db9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./commonFunctions-b0830e9e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-b0830e9e.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */










const arcgisSmartMappingDropdownCss = ".dropdown{overflow-y:auto;padding:6px}.dropdown-item{border-top:1px solid #ddd;padding:5px;border-left:4px solid #ffffff;display:flex;cursor:pointer}.dropdown-item:focus{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand));padding:5px;display:flex}.dropdown-item:hover{background-color:rgba(0, 0, 0, 0.035)}.selected{border-left:4px solid var(--calcite-color-brand)}.arcgis--rtl .dropdown-item{border-left:0;border-right:4px solid #ffffff}.arcgis--rtl .selected{border-left:0;border-right:4px solid var(--calcite-color-brand)}.dropdown-item-icon{min-width:16px;background-repeat:no-repeat;height:48px;padding:0;display:inline-block}.dropdown-item-text{display:inline;padding:0 10px}.dropdown-item-title{font-weight:bold;padding:6px 0;line-height:18px}.dropdown-item-msg{font-size:80%;line-height:16px}";

const ArcgisSmartMappingDropdown = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisSmartMappingDropdownClose = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingDropdownClose", 7);
        this.arcgisSmartMappingDropdownChange = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingDropdownChange", 7);
        this.dropdownItems = [];
        this.resizeObserver = new ResizeObserver((boundingRects) => {
            const panel = boundingRects.pop();
            this.adjustedWidth = panel.contentRect.width;
        });
        this.buttonNode = undefined;
        this.infos = undefined;
        this.adjustedWidth = undefined;
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    componentDidLoad() {
        const selectedItem = this.dropdownItems.find((item) => item.classList.contains("selected"));
        requestAnimationFrame(() => selectedItem.focus());
        this.resizeObserver.observe(this.buttonNode);
    }
    disconnectedCallback() {
        this.resizeObserver.unobserve(this.buttonNode);
    }
    // --------------------------------------------------------------------------
    //
    // Render Methods
    //
    //--------------------------------------------------------------------------
    render() {
        var _a, _b;
        const { strings, isRTL } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const distanceToTop = (_a = this.buttonNode) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect().top;
        const distanceToBottom = window.innerHeight - ((_b = this.buttonNode) === null || _b === void 0 ? void 0 : _b.getBoundingClientRect().bottom);
        const distance = distanceToBottom < distanceToTop ? distanceToTop : distanceToBottom;
        const popupLocation = distanceToBottom < distanceToTop ? "top" : "bottom";
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-popover", { class: `js-app-flyout ${isRTL ? _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_4__.C.rtl : ""}`, label: strings.dropdown.dropdownOptions, referenceElement: this.buttonNode, offsetDistance: 3, offsetSkidding: 0, pointerDisabled: true, autoClose: true, open: true, onCalcitePopoverClose: () => {
                this.arcgisSmartMappingDropdownClose.emit(this.key);
                this.key = undefined;
            }, placement: popupLocation }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "dropdown", style: {
                width: `${this.adjustedWidth}px`,
                maxHeight: `${distance}px`
            } }, this.infos.map((info, idx) => this.renderDropdownItem(info, idx, this.infos.length)))));
    }
    renderDropdownItem(info, idx, length) {
        const selected = info.selected ? "selected" : "";
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { role: "menuitem", onClick: () => !this.infos[idx].selected && this.arcgisSmartMappingDropdownChange.emit(this.infos[idx]), tabindex: "0", ref: (node) => {
                if (node) {
                    this.dropdownItems.push(node);
                }
            }, onKeyDown: (event) => {
                if (event.key === " " || event.key === "Enter") {
                    event.preventDefault();
                    event.stopPropagation();
                    !this.infos[idx].selected &&
                        this.arcgisSmartMappingDropdownChange.emit(this.infos[idx]);
                }
                else if (event.key === "ArrowUp") {
                    const selectedIdx = idx === 0 ? length - 1 : idx - 1;
                    this.dropdownItems[selectedIdx % length].focus();
                }
                else if (event.key === "ArrowDown") {
                    this.dropdownItems[(idx + 1) % length].focus();
                }
                else if (event.key === "Escape") {
                    this.key = "Escape";
                }
            }, class: `dropdown-item ${selected}` }, info.iconPath && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "dropdown-item-icon", style: {
                backgroundImage: `url(${(0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.a)(`./assets/arcgis-smart-mapping-dropdown-images/`)}${info.iconPath}`
            } })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "dropdown-item-text" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "dropdown-item-title" }, info.title), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "dropdown-item-msg" }, info.msg))));
    }
};
ArcgisSmartMappingDropdown.style = arcgisSmartMappingDropdownCss;



//# sourceMappingURL=arcgis-smart-mapping-dropdown.entry.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLXNtYXJ0LW0tYzcyZGM1LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNvRztBQUN6QjtBQUN4QztBQUNBO0FBQzJCO0FBQ2hDO0FBQ0g7QUFDRTtBQUNVOztBQUV2QyxpREFBaUQsZ0JBQWdCLFlBQVksZUFBZSwwQkFBMEIsWUFBWSw4QkFBOEIsYUFBYSxlQUFlLHFCQUFxQiw0RUFBNEUsWUFBWSxhQUFhLHFCQUFxQixzQ0FBc0MsVUFBVSxpREFBaUQsNEJBQTRCLGNBQWMsK0JBQStCLHVCQUF1QixjQUFjLGtEQUFrRCxvQkFBb0IsZUFBZSw0QkFBNEIsWUFBWSxVQUFVLHFCQUFxQixvQkFBb0IsZUFBZSxlQUFlLHFCQUFxQixpQkFBaUIsY0FBYyxpQkFBaUIsbUJBQW1CLGNBQWMsaUJBQWlCOztBQUUvMUI7QUFDQTtBQUNBLFFBQVEscURBQWdCO0FBQ3hCLCtDQUErQyxxREFBVztBQUMxRCxnREFBZ0QscURBQVc7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlCQUFpQixFQUFFLCtEQUFpQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxREFBQyxzQkFBc0Isd0JBQXdCLFFBQVEsd0RBQVcsVUFBVTtBQUM1RjtBQUNBO0FBQ0EsYUFBYSw0QkFBNEIsRUFBRSxxREFBQyxVQUFVO0FBQ3RELDBCQUEwQixtQkFBbUI7QUFDN0MsOEJBQThCLFNBQVM7QUFDdkMsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxREFBQyxVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsMEJBQTBCLFNBQVMsR0FBRyxvQkFBb0IscURBQUMsVUFBVTtBQUNsRix3Q0FBd0MscURBQVksbURBQW1ELEVBQUUsY0FBYztBQUN2SCxlQUFlLElBQUkscURBQUMsVUFBVSw2QkFBNkIsRUFBRSxxREFBQyxVQUFVLDhCQUE4QixlQUFlLHFEQUFDLFVBQVUsNEJBQTRCO0FBQzVKO0FBQ0E7QUFDQTs7QUFFdUU7O0FBRXZFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLXNtYXJ0LW1hcHBpbmctZHJvcGRvd24uZW50cnkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIGEgYXMgZ2V0QXNzZXRQYXRoIH0gZnJvbSAnLi9pbmRleC1lM2JmN2RhNy5qcyc7XG5pbXBvcnQgeyBzIGFzIHNtYXJ0TWFwcGluZ1N0YXRlIH0gZnJvbSAnLi9yYXN0ZXItdW5pcXVlLXZhbHVlLTA5NzZlYzdmLmpzJztcbmltcG9ydCAnLi9sb2FkTW9kdWxlcy1iNGFjMTI0Ny5qcyc7XG5pbXBvcnQgJy4vY29tbW9uRW51bXMtZmNmMTM2NjEuanMnO1xuaW1wb3J0IHsgQyBhcyBDU1NfVVRJTElUWSB9IGZyb20gJy4vbGFuZ3VhZ2VVdGlsLWVmMGU1NGIyLmpzJztcbmltcG9ydCAnLi9sb2NhbGUtMDUwYjZkYjkuanMnO1xuaW1wb3J0ICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5pbXBvcnQgJy4vaW5kZXgtMDU5NTZjYWIuanMnO1xuaW1wb3J0ICcuL2NvbW1vbkZ1bmN0aW9ucy1iMDgzMGU5ZS5qcyc7XG5cbmNvbnN0IGFyY2dpc1NtYXJ0TWFwcGluZ0Ryb3Bkb3duQ3NzID0gXCIuZHJvcGRvd257b3ZlcmZsb3cteTphdXRvO3BhZGRpbmc6NnB4fS5kcm9wZG93bi1pdGVte2JvcmRlci10b3A6MXB4IHNvbGlkICNkZGQ7cGFkZGluZzo1cHg7Ym9yZGVyLWxlZnQ6NHB4IHNvbGlkICNmZmZmZmY7ZGlzcGxheTpmbGV4O2N1cnNvcjpwb2ludGVyfS5kcm9wZG93bi1pdGVtOmZvY3Vze291dGxpbmU6MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtdWktZm9jdXMtY29sb3IsIHZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpKTtwYWRkaW5nOjVweDtkaXNwbGF5OmZsZXh9LmRyb3Bkb3duLWl0ZW06aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsIDAsIDAsIDAuMDM1KX0uc2VsZWN0ZWR7Ym9yZGVyLWxlZnQ6NHB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpfS5hcmNnaXMtLXJ0bCAuZHJvcGRvd24taXRlbXtib3JkZXItbGVmdDowO2JvcmRlci1yaWdodDo0cHggc29saWQgI2ZmZmZmZn0uYXJjZ2lzLS1ydGwgLnNlbGVjdGVke2JvcmRlci1sZWZ0OjA7Ym9yZGVyLXJpZ2h0OjRweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKX0uZHJvcGRvd24taXRlbS1pY29ue21pbi13aWR0aDoxNnB4O2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtoZWlnaHQ6NDhweDtwYWRkaW5nOjA7ZGlzcGxheTppbmxpbmUtYmxvY2t9LmRyb3Bkb3duLWl0ZW0tdGV4dHtkaXNwbGF5OmlubGluZTtwYWRkaW5nOjAgMTBweH0uZHJvcGRvd24taXRlbS10aXRsZXtmb250LXdlaWdodDpib2xkO3BhZGRpbmc6NnB4IDA7bGluZS1oZWlnaHQ6MThweH0uZHJvcGRvd24taXRlbS1tc2d7Zm9udC1zaXplOjgwJTtsaW5lLWhlaWdodDoxNnB4fVwiO1xuXG5jb25zdCBBcmNnaXNTbWFydE1hcHBpbmdEcm9wZG93biA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRHJvcGRvd25DbG9zZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzU21hcnRNYXBwaW5nRHJvcGRvd25DbG9zZVwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdEcm9wZG93bkNoYW5nZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzU21hcnRNYXBwaW5nRHJvcGRvd25DaGFuZ2VcIiwgNyk7XG4gICAgICAgIHRoaXMuZHJvcGRvd25JdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKChib3VuZGluZ1JlY3RzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwYW5lbCA9IGJvdW5kaW5nUmVjdHMucG9wKCk7XG4gICAgICAgICAgICB0aGlzLmFkanVzdGVkV2lkdGggPSBwYW5lbC5jb250ZW50UmVjdC53aWR0aDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnV0dG9uTm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5pbmZvcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hZGp1c3RlZFdpZHRoID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTGlmZWN5Y2xlXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRJdGVtID0gdGhpcy5kcm9wZG93bkl0ZW1zLmZpbmQoKGl0ZW0pID0+IGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKFwic2VsZWN0ZWRcIikpO1xuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gc2VsZWN0ZWRJdGVtLmZvY3VzKCkpO1xuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyLm9ic2VydmUodGhpcy5idXR0b25Ob2RlKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIudW5vYnNlcnZlKHRoaXMuYnV0dG9uTm9kZSk7XG4gICAgfVxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyBSZW5kZXIgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgY29uc3QgeyBzdHJpbmdzLCBpc1JUTCB9ID0gc21hcnRNYXBwaW5nU3RhdGU7XG4gICAgICAgIGNvbnN0IGRpc3RhbmNlVG9Ub3AgPSAoX2EgPSB0aGlzLmJ1dHRvbk5vZGUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG4gICAgICAgIGNvbnN0IGRpc3RhbmNlVG9Cb3R0b20gPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSAoKF9iID0gdGhpcy5idXR0b25Ob2RlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tKTtcbiAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBkaXN0YW5jZVRvQm90dG9tIDwgZGlzdGFuY2VUb1RvcCA/IGRpc3RhbmNlVG9Ub3AgOiBkaXN0YW5jZVRvQm90dG9tO1xuICAgICAgICBjb25zdCBwb3B1cExvY2F0aW9uID0gZGlzdGFuY2VUb0JvdHRvbSA8IGRpc3RhbmNlVG9Ub3AgPyBcInRvcFwiIDogXCJib3R0b21cIjtcbiAgICAgICAgcmV0dXJuIChoKFwiY2FsY2l0ZS1wb3BvdmVyXCIsIHsgY2xhc3M6IGBqcy1hcHAtZmx5b3V0ICR7aXNSVEwgPyBDU1NfVVRJTElUWS5ydGwgOiBcIlwifWAsIGxhYmVsOiBzdHJpbmdzLmRyb3Bkb3duLmRyb3Bkb3duT3B0aW9ucywgcmVmZXJlbmNlRWxlbWVudDogdGhpcy5idXR0b25Ob2RlLCBvZmZzZXREaXN0YW5jZTogMywgb2Zmc2V0U2tpZGRpbmc6IDAsIHBvaW50ZXJEaXNhYmxlZDogdHJ1ZSwgYXV0b0Nsb3NlOiB0cnVlLCBvcGVuOiB0cnVlLCBvbkNhbGNpdGVQb3BvdmVyQ2xvc2U6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Ryb3Bkb3duQ2xvc2UuZW1pdCh0aGlzLmtleSk7XG4gICAgICAgICAgICAgICAgdGhpcy5rZXkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9LCBwbGFjZW1lbnQ6IHBvcHVwTG9jYXRpb24gfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImRyb3Bkb3duXCIsIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IGAke3RoaXMuYWRqdXN0ZWRXaWR0aH1weGAsXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0OiBgJHtkaXN0YW5jZX1weGBcbiAgICAgICAgICAgIH0gfSwgdGhpcy5pbmZvcy5tYXAoKGluZm8sIGlkeCkgPT4gdGhpcy5yZW5kZXJEcm9wZG93bkl0ZW0oaW5mbywgaWR4LCB0aGlzLmluZm9zLmxlbmd0aCkpKSkpO1xuICAgIH1cbiAgICByZW5kZXJEcm9wZG93bkl0ZW0oaW5mbywgaWR4LCBsZW5ndGgpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBpbmZvLnNlbGVjdGVkID8gXCJzZWxlY3RlZFwiIDogXCJcIjtcbiAgICAgICAgcmV0dXJuIChoKFwiZGl2XCIsIHsgcm9sZTogXCJtZW51aXRlbVwiLCBvbkNsaWNrOiAoKSA9PiAhdGhpcy5pbmZvc1tpZHhdLnNlbGVjdGVkICYmIHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRHJvcGRvd25DaGFuZ2UuZW1pdCh0aGlzLmluZm9zW2lkeF0pLCB0YWJpbmRleDogXCIwXCIsIHJlZjogKG5vZGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3Bkb3duSXRlbXMucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBvbktleURvd246IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IFwiIFwiIHx8IGV2ZW50LmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAhdGhpcy5pbmZvc1tpZHhdLnNlbGVjdGVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Ryb3Bkb3duQ2hhbmdlLmVtaXQodGhpcy5pbmZvc1tpZHhdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93VXBcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZElkeCA9IGlkeCA9PT0gMCA/IGxlbmd0aCAtIDEgOiBpZHggLSAxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3Bkb3duSXRlbXNbc2VsZWN0ZWRJZHggJSBsZW5ndGhdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd0Rvd25cIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3Bkb3duSXRlbXNbKGlkeCArIDEpICUgbGVuZ3RoXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5rZXkgPSBcIkVzY2FwZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGNsYXNzOiBgZHJvcGRvd24taXRlbSAke3NlbGVjdGVkfWAgfSwgaW5mby5pY29uUGF0aCAmJiAoaChcImRpdlwiLCB7IGNsYXNzOiBcImRyb3Bkb3duLWl0ZW0taWNvblwiLCBzdHlsZToge1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmRJbWFnZTogYHVybCgke2dldEFzc2V0UGF0aChgLi9hc3NldHMvYXJjZ2lzLXNtYXJ0LW1hcHBpbmctZHJvcGRvd24taW1hZ2VzL2ApfSR7aW5mby5pY29uUGF0aH1gXG4gICAgICAgICAgICB9IH0pKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImRyb3Bkb3duLWl0ZW0tdGV4dFwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJkcm9wZG93bi1pdGVtLXRpdGxlXCIgfSwgaW5mby50aXRsZSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJkcm9wZG93bi1pdGVtLW1zZ1wiIH0sIGluZm8ubXNnKSkpKTtcbiAgICB9XG59O1xuQXJjZ2lzU21hcnRNYXBwaW5nRHJvcGRvd24uc3R5bGUgPSBhcmNnaXNTbWFydE1hcHBpbmdEcm9wZG93bkNzcztcblxuZXhwb3J0IHsgQXJjZ2lzU21hcnRNYXBwaW5nRHJvcGRvd24gYXMgYXJjZ2lzX3NtYXJ0X21hcHBpbmdfZHJvcGRvd24gfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXJjZ2lzLXNtYXJ0LW1hcHBpbmctZHJvcGRvd24uZW50cnkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9