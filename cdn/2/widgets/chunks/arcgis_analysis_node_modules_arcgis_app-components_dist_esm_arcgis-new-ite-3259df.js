"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-3259df"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-from-url.entry.js":
/*!***********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-from-url.entry.js ***!
  \***********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_feature_layer_from_url: () => (/* binding */ ArcgisNewItemPagesFeatureLayerFromUrl)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _portal_d518b571_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./portal-d518b571.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-d518b571.js");
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./item-properties-10491b2e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-properties-10491b2e.js");
/* harmony import */ var _feature_layer_573bb473_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./feature-layer-573bb473.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-573bb473.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/* harmony import */ var _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ui-bca7bcd1.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js");
/* harmony import */ var _feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./feature-layer-79fb302c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-79fb302c.js");
/* harmony import */ var _feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./feature-layer-58e18b03.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _url_4c3ae54c_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./url-4c3ae54c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/url-4c3ae54c.js");
/* harmony import */ var _functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./functional-44de8fcf.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _functional_81373f6d_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./functional-81373f6d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-81373f6d.js");
/* harmony import */ var _server_item_8d384796_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./server-item-8d384796.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/server-item-8d384796.js");
/* harmony import */ var _item_3535552d_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./item-3535552d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-3535552d.js");
/* harmony import */ var _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./item-types-2029b06b.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-2029b06b.js");
/* harmony import */ var _ags_eb458a03_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./ags-eb458a03.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ags-eb458a03.js");
/* harmony import */ var _url_35875a10_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./url-35875a10.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/url-35875a10.js");
/* harmony import */ var _storage_0353a769_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./storage-0353a769.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/storage-0353a769.js");
/* harmony import */ var _file_bf8ab90f_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./file-bf8ab90f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-bf8ab90f.js");
/* harmony import */ var _guid_aeaed84d_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./guid-aeaed84d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-aeaed84d.js");
/* harmony import */ var _store_6a88e6c5_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./store-6a88e6c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-6a88e6c5.js");
/* harmony import */ var _thumbnail_bcb89e69_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./thumbnail-bcb89e69.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/thumbnail-bcb89e69.js");
/* harmony import */ var _service_8c2c4241_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./service-8c2c4241.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/service-8c2c4241.js");
/* harmony import */ var _user_3ea69c3a_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./user-3ea69c3a.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/user-3ea69c3a.js");
/* harmony import */ var _query_d62660d4_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./query-d62660d4.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/query-d62660d4.js");
/* harmony import */ var _api_2e3a136f_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./api-2e3a136f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/api-2e3a136f.js");
/* harmony import */ var _string_58a5fef3_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./string-58a5fef3.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/string-58a5fef3.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _item_c58ffced_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./item-c58ffced.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-c58ffced.js");
/* harmony import */ var _feature_layer_17b64946_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./feature-layer-17b64946.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-17b64946.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */

































const arcgisNewItemPagesFeatureLayerFromUrlCss = ".input{margin-top:1rem}.label{margin-top:1rem;display:block}";

const ArcgisNewItemPagesFeatureLayerFromUrl = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.newItemUpdatePage = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
        this.url = undefined;
        this.error = undefined;
        this.loading = undefined;
    }
    async componentWillLoad() {
        this.i18n = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_6__.u.i18n.featureLayerFromUrl;
        this.commonI18n = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_6__.u.i18n.common;
        this.url = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_5__.a.serviceInfoUrl;
    }
    async handleNext() {
        var _a, _b, _c, _d, _e;
        const { url } = this;
        if (!url) {
            (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_8__.f)("Empty URL");
            this.inputRef.setFocus();
            this.error = "missingUrl";
            return;
        }
        const { error: urlError } = (0,_feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_7__.g)(url);
        if (urlError) {
            (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_8__.f)("Invalid URL");
            this.inputRef.setFocus();
            this.error = urlError.code;
            return;
        }
        this.loading = true;
        // https://devtopia.esri.com/WebGIS/arcgis-portal-app/blob/master/src/js/arcgisonline/sharing/dijit/dialog/PublishWizard.js#L390
        const featureLayerTermIndex = url.toLowerCase().indexOf("/featureserver");
        const serviceUrl = url.substring(0, featureLayerTermIndex) + "/FeatureServer";
        try {
            const { result } = await (0,_feature_layer_573bb473_js__WEBPACK_IMPORTED_MODULE_4__.B)({ url: serviceUrl });
            if (!!(result === null || result === void 0 ? void 0 : result.isSecured)) {
                _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_5__.a.checkAuth = true;
            }
            const { layers, serviceInfo, tables } = await (0,_feature_layer_573bb473_js__WEBPACK_IMPORTED_MODULE_4__.q)(url, (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_1__.g)(_config_75adf962_js__WEBPACK_IMPORTED_MODULE_2__.c.portal), false, result === null || result === void 0 ? void 0 : result.isSecured);
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_5__.a.serviceInfo = Object.assign(Object.assign({}, serviceInfo), { layers,
                tables });
            let title = (_a = serviceInfo.documentInfo) === null || _a === void 0 ? void 0 : _a.title;
            const serviceInfoLayers = (_b = serviceInfo.layers) !== null && _b !== void 0 ? _b : [];
            const serviceInfoTables = (_c = serviceInfo.tables) !== null && _c !== void 0 ? _c : [];
            if (!title) {
                if (serviceInfoLayers.length === 1 && serviceInfoTables.length === 0) {
                    title = serviceInfoLayers[0].name;
                }
                else if (serviceInfoTables.length === 1 && serviceInfoLayers.length === 0) {
                    title = serviceInfoTables[0].name;
                }
            }
            _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_3__.i.title = title;
            _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_3__.i.snippet = (_d = serviceInfo.serviceDescription) !== null && _d !== void 0 ? _d : "";
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_5__.a.description = (_e = serviceInfo.description) !== null && _e !== void 0 ? _e : "";
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_5__.a.serviceInfoUrl = url;
            this.loading = false;
            this.newItemUpdatePage.emit("featureLayerSummary");
        }
        catch (error) {
            (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_8__.f)("Service doesn't exist");
            this.error = "serviceNotExist";
        }
    }
    handleInputChange(e) {
        this.url = e.target.value;
    }
    render() {
        const { loading, i18n, commonI18n, error, url } = this;
        const { title, description } = i18n.error[error] || {};
        const { portal } = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_2__.c;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-loader", { active: loading, text: _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_6__.u.i18n.urlType.getServiceInfo }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { class: "label" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-description", { header: commonI18n.url, content: i18n.description }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-input", { placeholder: portal.isPortal
                ? "https://webadaptorhost.domain.com/webadaptorname/rest/services/service/servicetype"
                : "https://myserver.com/arcgis/rest/services/folder/service/FeatureServer", onCalciteInputInput: (e) => this.handleInputChange(e), class: "input", scale: "l", ref: (ele) => (this.inputRef = ele), value: url })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { heading: title, description: description, active: !!error, onAlertDismiss: () => (this.error = null) })));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisNewItemPagesFeatureLayerFromUrl.style = arcgisNewItemPagesFeatureLayerFromUrlCss;



//# sourceMappingURL=arcgis-new-item-pages-feature-layer-from-url.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js":
/*!*******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ featureServiceEndTelemetry),
/* harmony export */   b: () => (/* binding */ filterChangeTelemetry),
/* harmony export */   c: () => (/* binding */ featureLayerTypeTelemetry),
/* harmony export */   e: () => (/* binding */ enableLayerPreferenceTelemetry),
/* harmony export */   f: () => (/* binding */ featureLayerErrorTelemetry),
/* harmony export */   i: () => (/* binding */ itemExpandedTelemetry)
/* harmony export */ });
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



const TELEMETRY_ID = "create feature layer";
const TELEMETRY_PAGE_NAME = "my content";
const addFeatureLayerTypeToTelemetry = (type) => {
    switch (type) {
        case "build":
            return "blank";
        case "existing":
            return "fs";
        case "template":
            return "template";
        case "link":
            return "url";
    }
};
const enableLayerPreferenceTelemetry = (type) => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `enable ${type === "captureGPS" ? "gps" : type === "enableZDefaults" ? "z" : "m"}`, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const itemExpandedTelemetry = (type) => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `expand ${type} details`, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const filterChangeTelemetry = () => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "filter", {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const featureLayerTypeTelemetry = (type) => {
    const telemetryType = addFeatureLayerTypeToTelemetry(type);
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "from option", {
        category: TELEMETRY_ID,
        attribute: telemetryType,
        pageName: TELEMETRY_PAGE_NAME
    });
};
const featureServiceEndTelemetry = () => {
    const { addFeatureLayerType, serviceInfo } = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a;
    const featureLayerServiceInfo = serviceInfo;
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.endWorkflow(TELEMETRY_ID, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME,
        count: featureLayerServiceInfo.layers.length,
        number: featureLayerServiceInfo.tables.length
    });
};
const featureLayerErrorTelemetry = (errString) => {
    var _a;
    (_a = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry) === null || _a === void 0 ? void 0 : _a.logError({
        category: TELEMETRY_ID,
        error: errString
    });
};



//# sourceMappingURL=feature-layer-58e18b03.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLW5ldy1pdGUtMzI1OWRmLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzZHO0FBQ2xEO0FBQ0g7QUFDaUI7QUFDZ0M7QUFDOUM7QUFDTjtBQUMwQjtBQUNEO0FBQzNDO0FBQ1I7QUFDTztBQUNMO0FBQ0s7QUFDQztBQUNQO0FBQ007QUFDUDtBQUNBO0FBQ0k7QUFDSDtBQUNBO0FBQ0M7QUFDSTtBQUNGO0FBQ0g7QUFDQztBQUNGO0FBQ0c7QUFDSDtBQUNDO0FBQ1M7O0FBRXJDLHlEQUF5RCxnQkFBZ0IsT0FBTyxnQkFBZ0IsY0FBYzs7QUFFOUc7QUFDQTtBQUNBLFFBQVEscURBQWdCO0FBQ3hCLGlDQUFpQyxxREFBVztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDhDQUFZO0FBQ2hDLDBCQUEwQiw4Q0FBWTtBQUN0QyxtQkFBbUIsb0RBQVk7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLE1BQU07QUFDdEI7QUFDQSxZQUFZLDZEQUEwQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0IsRUFBRSw2REFBMkI7QUFDL0Q7QUFDQSxZQUFZLDZEQUEwQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsU0FBUyxRQUFRLDZEQUF3QixHQUFHLGlCQUFpQjtBQUNqRjtBQUNBLGdCQUFnQixvREFBWTtBQUM1QjtBQUNBLG9CQUFvQiw4QkFBOEIsUUFBUSw2REFBc0IsTUFBTSxzREFBYyxDQUFDLGtEQUFXO0FBQ2hILFlBQVksb0RBQVksNkNBQTZDLGtCQUFrQjtBQUN2Rix3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkRBQW1CO0FBQy9CLFlBQVksMkRBQW1CO0FBQy9CLFlBQVksb0RBQVk7QUFDeEIsWUFBWSxvREFBWTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksNkRBQTBCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdDQUF3QztBQUN4RCxnQkFBZ0IscUJBQXFCO0FBQ3JDLGdCQUFnQixTQUFTLEVBQUUsa0RBQVc7QUFDdEMsZ0JBQWdCLHFEQUFDLENBQUMsaURBQUksUUFBUSxxREFBQyw2QkFBNkIsdUJBQXVCLDhDQUFZLDhCQUE4QixHQUFHLHFEQUFDLG9CQUFvQixnQkFBZ0IsRUFBRSxxREFBQyxrQ0FBa0MsbURBQW1ELEdBQUcscURBQUMsb0JBQW9CO0FBQ3JSO0FBQ0EsZ09BQWdPLElBQUkscURBQUMsNEJBQTRCLHNHQUFzRztBQUN2VztBQUNBLGVBQWUsT0FBTyxxREFBVTtBQUNoQztBQUNBOztBQUVpRzs7QUFFakc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3hIQTtBQUNBO0FBQ0E7QUFDQTtBQUN3RDtBQUNHOztBQUUzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isa0RBQVc7QUFDakMseUdBQXlHLHVFQUF1RTtBQUNoTDtBQUNBLGtEQUFrRCxvREFBWTtBQUM5RDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esc0JBQXNCLGtEQUFXO0FBQ2pDLHlHQUF5RyxNQUFNO0FBQy9HO0FBQ0Esa0RBQWtELG9EQUFZO0FBQzlEO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxzQkFBc0Isa0RBQVc7QUFDakM7QUFDQTtBQUNBLGtEQUFrRCxvREFBWTtBQUM5RDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isa0RBQVc7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVksbUNBQW1DLEVBQUUsb0RBQVk7QUFDN0Q7QUFDQSxzQkFBc0Isa0RBQVc7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFVBQVUsa0RBQVc7QUFDckI7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFeU07O0FBRXpNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLW5ldy1pdGVtLXBhZ2VzLWZlYXR1cmUtbGF5ZXItZnJvbS11cmwuZW50cnkuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vZmVhdHVyZS1sYXllci01OGUxOGIwMy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgSCBhcyBIb3N0LCBkIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0UmVzdEJhc2VVcmwgfSBmcm9tICcuL3BvcnRhbC1kNTE4YjU3MS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbmZpZ1N0YXRlIH0gZnJvbSAnLi9jb25maWctNzVhZGY5NjIuanMnO1xuaW1wb3J0IHsgaSBhcyBpdGVtUHJvcGVydGllc1N0YXRlIH0gZnJvbSAnLi9pdGVtLXByb3BlcnRpZXMtMTA0OTFiMmUuanMnO1xuaW1wb3J0IHsgQiBhcyBnZXRTZWN1cmVkQUdTU2VydmljZUluZm8sIHEgYXMgZ2V0U2VydmljZUFuZExheWVySW5mbyB9IGZyb20gJy4vZmVhdHVyZS1sYXllci01NzNiYjQ3My5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tZGJiZTJmNTcuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWJjYTdiY2QxLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0RmVhdHVyZUxheWVySW5kZXhGcm9tVXJsIH0gZnJvbSAnLi9mZWF0dXJlLWxheWVyLTc5ZmIzMDJjLmpzJztcbmltcG9ydCB7IGYgYXMgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnkgfSBmcm9tICcuL2ZlYXR1cmUtbGF5ZXItNThlMThiMDMuanMnO1xuaW1wb3J0ICcuL2xvYWRNb2R1bGVzLWI0YWMxMjQ3LmpzJztcbmltcG9ydCAnLi91cmwtNGMzYWU1NGMuanMnO1xuaW1wb3J0ICcuL2Z1bmN0aW9uYWwtNDRkZThmY2YuanMnO1xuaW1wb3J0ICcuL2luZGV4LTA1OTU2Y2FiLmpzJztcbmltcG9ydCAnLi9mdW5jdGlvbmFsLTgxMzczZjZkLmpzJztcbmltcG9ydCAnLi9zZXJ2ZXItaXRlbS04ZDM4NDc5Ni5qcyc7XG5pbXBvcnQgJy4vaXRlbS0zNTM1NTUyZC5qcyc7XG5pbXBvcnQgJy4vaXRlbS10eXBlcy0yMDI5YjA2Yi5qcyc7XG5pbXBvcnQgJy4vYWdzLWViNDU4YTAzLmpzJztcbmltcG9ydCAnLi91cmwtMzU4NzVhMTAuanMnO1xuaW1wb3J0ICcuL3N0b3JhZ2UtMDM1M2E3NjkuanMnO1xuaW1wb3J0ICcuL2ZpbGUtYmY4YWI5MGYuanMnO1xuaW1wb3J0ICcuL2d1aWQtYWVhZWQ4NGQuanMnO1xuaW1wb3J0ICcuL3N0b3JlLTZhODhlNmM1LmpzJztcbmltcG9ydCAnLi90aHVtYm5haWwtYmNiODllNjkuanMnO1xuaW1wb3J0ICcuL3NlcnZpY2UtOGMyYzQyNDEuanMnO1xuaW1wb3J0ICcuL3VzZXItM2VhNjljM2EuanMnO1xuaW1wb3J0ICcuL3F1ZXJ5LWQ2MjY2MGQ0LmpzJztcbmltcG9ydCAnLi9hcGktMmUzYTEzNmYuanMnO1xuaW1wb3J0ICcuL3N0cmluZy01OGE1ZmVmMy5qcyc7XG5pbXBvcnQgJy4vZG9tLTRkMzY3Njc3LmpzJztcbmltcG9ydCAnLi9pdGVtLWM1OGZmY2VkLmpzJztcbmltcG9ydCAnLi9mZWF0dXJlLWxheWVyLTE3YjY0OTQ2LmpzJztcblxuY29uc3QgYXJjZ2lzTmV3SXRlbVBhZ2VzRmVhdHVyZUxheWVyRnJvbVVybENzcyA9IFwiLmlucHV0e21hcmdpbi10b3A6MXJlbX0ubGFiZWx7bWFyZ2luLXRvcDoxcmVtO2Rpc3BsYXk6YmxvY2t9XCI7XG5cbmNvbnN0IEFyY2dpc05ld0l0ZW1QYWdlc0ZlYXR1cmVMYXllckZyb21VcmwgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJuZXdJdGVtVXBkYXRlUGFnZVwiLCA3KTtcbiAgICAgICAgdGhpcy51cmwgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZXJyb3IgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubG9hZGluZyA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIHRoaXMuaTE4biA9IHVpU3RvcmVTdGF0ZS5pMThuLmZlYXR1cmVMYXllckZyb21Vcmw7XG4gICAgICAgIHRoaXMuY29tbW9uSTE4biA9IHVpU3RvcmVTdGF0ZS5pMThuLmNvbW1vbjtcbiAgICAgICAgdGhpcy51cmwgPSBhZGRJdGVtU3RhdGUuc2VydmljZUluZm9Vcmw7XG4gICAgfVxuICAgIGFzeW5jIGhhbmRsZU5leHQoKSB7XG4gICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2U7XG4gICAgICAgIGNvbnN0IHsgdXJsIH0gPSB0aGlzO1xuICAgICAgICBpZiAoIXVybCkge1xuICAgICAgICAgICAgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnkoXCJFbXB0eSBVUkxcIik7XG4gICAgICAgICAgICB0aGlzLmlucHV0UmVmLnNldEZvY3VzKCk7XG4gICAgICAgICAgICB0aGlzLmVycm9yID0gXCJtaXNzaW5nVXJsXCI7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBlcnJvcjogdXJsRXJyb3IgfSA9IGdldEZlYXR1cmVMYXllckluZGV4RnJvbVVybCh1cmwpO1xuICAgICAgICBpZiAodXJsRXJyb3IpIHtcbiAgICAgICAgICAgIGZlYXR1cmVMYXllckVycm9yVGVsZW1ldHJ5KFwiSW52YWxpZCBVUkxcIik7XG4gICAgICAgICAgICB0aGlzLmlucHV0UmVmLnNldEZvY3VzKCk7XG4gICAgICAgICAgICB0aGlzLmVycm9yID0gdXJsRXJyb3IuY29kZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAvLyBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtcG9ydGFsLWFwcC9ibG9iL21hc3Rlci9zcmMvanMvYXJjZ2lzb25saW5lL3NoYXJpbmcvZGlqaXQvZGlhbG9nL1B1Ymxpc2hXaXphcmQuanMjTDM5MFxuICAgICAgICBjb25zdCBmZWF0dXJlTGF5ZXJUZXJtSW5kZXggPSB1cmwudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiL2ZlYXR1cmVzZXJ2ZXJcIik7XG4gICAgICAgIGNvbnN0IHNlcnZpY2VVcmwgPSB1cmwuc3Vic3RyaW5nKDAsIGZlYXR1cmVMYXllclRlcm1JbmRleCkgKyBcIi9GZWF0dXJlU2VydmVyXCI7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7IHJlc3VsdCB9ID0gYXdhaXQgZ2V0U2VjdXJlZEFHU1NlcnZpY2VJbmZvKHsgdXJsOiBzZXJ2aWNlVXJsIH0pO1xuICAgICAgICAgICAgaWYgKCEhKHJlc3VsdCA9PT0gbnVsbCB8fCByZXN1bHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlc3VsdC5pc1NlY3VyZWQpKSB7XG4gICAgICAgICAgICAgICAgYWRkSXRlbVN0YXRlLmNoZWNrQXV0aCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB7IGxheWVycywgc2VydmljZUluZm8sIHRhYmxlcyB9ID0gYXdhaXQgZ2V0U2VydmljZUFuZExheWVySW5mbyh1cmwsIGdldFJlc3RCYXNlVXJsKGNvbmZpZ1N0YXRlLnBvcnRhbCksIGZhbHNlLCByZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXN1bHQuaXNTZWN1cmVkKTtcbiAgICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5zZXJ2aWNlSW5mbyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgc2VydmljZUluZm8pLCB7IGxheWVycyxcbiAgICAgICAgICAgICAgICB0YWJsZXMgfSk7XG4gICAgICAgICAgICBsZXQgdGl0bGUgPSAoX2EgPSBzZXJ2aWNlSW5mby5kb2N1bWVudEluZm8pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50aXRsZTtcbiAgICAgICAgICAgIGNvbnN0IHNlcnZpY2VJbmZvTGF5ZXJzID0gKF9iID0gc2VydmljZUluZm8ubGF5ZXJzKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBbXTtcbiAgICAgICAgICAgIGNvbnN0IHNlcnZpY2VJbmZvVGFibGVzID0gKF9jID0gc2VydmljZUluZm8udGFibGVzKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBbXTtcbiAgICAgICAgICAgIGlmICghdGl0bGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VydmljZUluZm9MYXllcnMubGVuZ3RoID09PSAxICYmIHNlcnZpY2VJbmZvVGFibGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZSA9IHNlcnZpY2VJbmZvTGF5ZXJzWzBdLm5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlcnZpY2VJbmZvVGFibGVzLmxlbmd0aCA9PT0gMSAmJiBzZXJ2aWNlSW5mb0xheWVycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSBzZXJ2aWNlSW5mb1RhYmxlc1swXS5uYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGl0ZW1Qcm9wZXJ0aWVzU3RhdGUudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgICAgIGl0ZW1Qcm9wZXJ0aWVzU3RhdGUuc25pcHBldCA9IChfZCA9IHNlcnZpY2VJbmZvLnNlcnZpY2VEZXNjcmlwdGlvbikgIT09IG51bGwgJiYgX2QgIT09IHZvaWQgMCA/IF9kIDogXCJcIjtcbiAgICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5kZXNjcmlwdGlvbiA9IChfZSA9IHNlcnZpY2VJbmZvLmRlc2NyaXB0aW9uKSAhPT0gbnVsbCAmJiBfZSAhPT0gdm9pZCAwID8gX2UgOiBcIlwiO1xuICAgICAgICAgICAgYWRkSXRlbVN0YXRlLnNlcnZpY2VJbmZvVXJsID0gdXJsO1xuICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQoXCJmZWF0dXJlTGF5ZXJTdW1tYXJ5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnkoXCJTZXJ2aWNlIGRvZXNuJ3QgZXhpc3RcIik7XG4gICAgICAgICAgICB0aGlzLmVycm9yID0gXCJzZXJ2aWNlTm90RXhpc3RcIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVJbnB1dENoYW5nZShlKSB7XG4gICAgICAgIHRoaXMudXJsID0gZS50YXJnZXQudmFsdWU7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBsb2FkaW5nLCBpMThuLCBjb21tb25JMThuLCBlcnJvciwgdXJsIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7IHRpdGxlLCBkZXNjcmlwdGlvbiB9ID0gaTE4bi5lcnJvcltlcnJvcl0gfHwge307XG4gICAgICAgIGNvbnN0IHsgcG9ydGFsIH0gPSBjb25maWdTdGF0ZTtcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhcmNnaXMtbmV3LWl0ZW0tbG9hZGVyXCIsIHsgYWN0aXZlOiBsb2FkaW5nLCB0ZXh0OiB1aVN0b3JlU3RhdGUuaTE4bi51cmxUeXBlLmdldFNlcnZpY2VJbmZvIH0pLCBoKFwiY2FsY2l0ZS1sYWJlbFwiLCB7IGNsYXNzOiBcImxhYmVsXCIgfSwgaChcImFyY2dpcy1uZXctaXRlbS1kZXNjcmlwdGlvblwiLCB7IGhlYWRlcjogY29tbW9uSTE4bi51cmwsIGNvbnRlbnQ6IGkxOG4uZGVzY3JpcHRpb24gfSksIGgoXCJjYWxjaXRlLWlucHV0XCIsIHsgcGxhY2Vob2xkZXI6IHBvcnRhbC5pc1BvcnRhbFxuICAgICAgICAgICAgICAgID8gXCJodHRwczovL3dlYmFkYXB0b3Job3N0LmRvbWFpbi5jb20vd2ViYWRhcHRvcm5hbWUvcmVzdC9zZXJ2aWNlcy9zZXJ2aWNlL3NlcnZpY2V0eXBlXCJcbiAgICAgICAgICAgICAgICA6IFwiaHR0cHM6Ly9teXNlcnZlci5jb20vYXJjZ2lzL3Jlc3Qvc2VydmljZXMvZm9sZGVyL3NlcnZpY2UvRmVhdHVyZVNlcnZlclwiLCBvbkNhbGNpdGVJbnB1dElucHV0OiAoZSkgPT4gdGhpcy5oYW5kbGVJbnB1dENoYW5nZShlKSwgY2xhc3M6IFwiaW5wdXRcIiwgc2NhbGU6IFwibFwiLCByZWY6IChlbGUpID0+ICh0aGlzLmlucHV0UmVmID0gZWxlKSwgdmFsdWU6IHVybCB9KSksIGgoXCJhcmNnaXMtbmV3LWl0ZW0tYWxlcnRcIiwgeyBoZWFkaW5nOiB0aXRsZSwgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLCBhY3RpdmU6ICEhZXJyb3IsIG9uQWxlcnREaXNtaXNzOiAoKSA9PiAodGhpcy5lcnJvciA9IG51bGwpIH0pKSk7XG4gICAgfVxuICAgIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5BcmNnaXNOZXdJdGVtUGFnZXNGZWF0dXJlTGF5ZXJGcm9tVXJsLnN0eWxlID0gYXJjZ2lzTmV3SXRlbVBhZ2VzRmVhdHVyZUxheWVyRnJvbVVybENzcztcblxuZXhwb3J0IHsgQXJjZ2lzTmV3SXRlbVBhZ2VzRmVhdHVyZUxheWVyRnJvbVVybCBhcyBhcmNnaXNfbmV3X2l0ZW1fcGFnZXNfZmVhdHVyZV9sYXllcl9mcm9tX3VybCB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcmNnaXMtbmV3LWl0ZW0tcGFnZXMtZmVhdHVyZS1sYXllci1mcm9tLXVybC5lbnRyeS5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IGMgYXMgY29uZmlnU3RhdGUgfSBmcm9tICcuL2NvbmZpZy03NWFkZjk2Mi5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tZGJiZTJmNTcuanMnO1xuXG5jb25zdCBURUxFTUVUUllfSUQgPSBcImNyZWF0ZSBmZWF0dXJlIGxheWVyXCI7XG5jb25zdCBURUxFTUVUUllfUEFHRV9OQU1FID0gXCJteSBjb250ZW50XCI7XG5jb25zdCBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkgPSAodHlwZSkgPT4ge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlIFwiYnVpbGRcIjpcbiAgICAgICAgICAgIHJldHVybiBcImJsYW5rXCI7XG4gICAgICAgIGNhc2UgXCJleGlzdGluZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIFwiZnNcIjtcbiAgICAgICAgY2FzZSBcInRlbXBsYXRlXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJ0ZW1wbGF0ZVwiO1xuICAgICAgICBjYXNlIFwibGlua1wiOlxuICAgICAgICAgICAgcmV0dXJuIFwidXJsXCI7XG4gICAgfVxufTtcbmNvbnN0IGVuYWJsZUxheWVyUHJlZmVyZW5jZVRlbGVtZXRyeSA9ICh0eXBlKSA9PiB7XG4gICAgY29uc3QgdGVsZW1ldHJ5ID0gY29uZmlnU3RhdGUudGVsZW1ldHJ5O1xuICAgIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5zdGVwV29ya2Zsb3coVEVMRU1FVFJZX0lELCBgZW5hYmxlICR7dHlwZSA9PT0gXCJjYXB0dXJlR1BTXCIgPyBcImdwc1wiIDogdHlwZSA9PT0gXCJlbmFibGVaRGVmYXVsdHNcIiA/IFwielwiIDogXCJtXCJ9YCwge1xuICAgICAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgICAgICBhdHRyaWJ1dGU6IGFkZEZlYXR1cmVMYXllclR5cGVUb1RlbGVtZXRyeShhZGRJdGVtU3RhdGUuYWRkRmVhdHVyZUxheWVyVHlwZSksXG4gICAgICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FXG4gICAgfSk7XG59O1xuY29uc3QgaXRlbUV4cGFuZGVkVGVsZW1ldHJ5ID0gKHR5cGUpID0+IHtcbiAgICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gICAgdGVsZW1ldHJ5ID09PSBudWxsIHx8IHRlbGVtZXRyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZW1ldHJ5LnN0ZXBXb3JrZmxvdyhURUxFTUVUUllfSUQsIGBleHBhbmQgJHt0eXBlfSBkZXRhaWxzYCwge1xuICAgICAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgICAgICBhdHRyaWJ1dGU6IGFkZEZlYXR1cmVMYXllclR5cGVUb1RlbGVtZXRyeShhZGRJdGVtU3RhdGUuYWRkRmVhdHVyZUxheWVyVHlwZSksXG4gICAgICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FXG4gICAgfSk7XG59O1xuY29uc3QgZmlsdGVyQ2hhbmdlVGVsZW1ldHJ5ID0gKCkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeTtcbiAgICB0ZWxlbWV0cnkgPT09IG51bGwgfHwgdGVsZW1ldHJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZWxlbWV0cnkuc3RlcFdvcmtmbG93KFRFTEVNRVRSWV9JRCwgXCJmaWx0ZXJcIiwge1xuICAgICAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgICAgICBhdHRyaWJ1dGU6IGFkZEZlYXR1cmVMYXllclR5cGVUb1RlbGVtZXRyeShhZGRJdGVtU3RhdGUuYWRkRmVhdHVyZUxheWVyVHlwZSksXG4gICAgICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FXG4gICAgfSk7XG59O1xuY29uc3QgZmVhdHVyZUxheWVyVHlwZVRlbGVtZXRyeSA9ICh0eXBlKSA9PiB7XG4gICAgY29uc3QgdGVsZW1ldHJ5VHlwZSA9IGFkZEZlYXR1cmVMYXllclR5cGVUb1RlbGVtZXRyeSh0eXBlKTtcbiAgICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gICAgdGVsZW1ldHJ5ID09PSBudWxsIHx8IHRlbGVtZXRyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZW1ldHJ5LnN0ZXBXb3JrZmxvdyhURUxFTUVUUllfSUQsIFwiZnJvbSBvcHRpb25cIiwge1xuICAgICAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgICAgICBhdHRyaWJ1dGU6IHRlbGVtZXRyeVR5cGUsXG4gICAgICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FXG4gICAgfSk7XG59O1xuY29uc3QgZmVhdHVyZVNlcnZpY2VFbmRUZWxlbWV0cnkgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBhZGRGZWF0dXJlTGF5ZXJUeXBlLCBzZXJ2aWNlSW5mbyB9ID0gYWRkSXRlbVN0YXRlO1xuICAgIGNvbnN0IGZlYXR1cmVMYXllclNlcnZpY2VJbmZvID0gc2VydmljZUluZm87XG4gICAgY29uc3QgdGVsZW1ldHJ5ID0gY29uZmlnU3RhdGUudGVsZW1ldHJ5O1xuICAgIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5lbmRXb3JrZmxvdyhURUxFTUVUUllfSUQsIHtcbiAgICAgICAgY2F0ZWdvcnk6IFRFTEVNRVRSWV9JRCxcbiAgICAgICAgYXR0cmlidXRlOiBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkoYWRkRmVhdHVyZUxheWVyVHlwZSksXG4gICAgICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FLFxuICAgICAgICBjb3VudDogZmVhdHVyZUxheWVyU2VydmljZUluZm8ubGF5ZXJzLmxlbmd0aCxcbiAgICAgICAgbnVtYmVyOiBmZWF0dXJlTGF5ZXJTZXJ2aWNlSW5mby50YWJsZXMubGVuZ3RoXG4gICAgfSk7XG59O1xuY29uc3QgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnkgPSAoZXJyU3RyaW5nKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIChfYSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxvZ0Vycm9yKHtcbiAgICAgICAgY2F0ZWdvcnk6IFRFTEVNRVRSWV9JRCxcbiAgICAgICAgZXJyb3I6IGVyclN0cmluZ1xuICAgIH0pO1xufTtcblxuZXhwb3J0IHsgZmVhdHVyZVNlcnZpY2VFbmRUZWxlbWV0cnkgYXMgYSwgZmlsdGVyQ2hhbmdlVGVsZW1ldHJ5IGFzIGIsIGZlYXR1cmVMYXllclR5cGVUZWxlbWV0cnkgYXMgYywgZW5hYmxlTGF5ZXJQcmVmZXJlbmNlVGVsZW1ldHJ5IGFzIGUsIGZlYXR1cmVMYXllckVycm9yVGVsZW1ldHJ5IGFzIGYsIGl0ZW1FeHBhbmRlZFRlbGVtZXRyeSBhcyBpIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZlYXR1cmUtbGF5ZXItNThlMThiMDMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9