"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-7b7029"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-browser_10.entry.js":
/*!********************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-browser_10.entry.js ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_browser: () => (/* binding */ ArcgisBrowser),
/* harmony export */   arcgis_browser_actions: () => (/* binding */ ArcgisBrowserActions),
/* harmony export */   arcgis_browser_filter: () => (/* binding */ ArcgisBrowserFilter),
/* harmony export */   arcgis_browser_filter_date: () => (/* binding */ ArcgisBrowserFilterDate),
/* harmony export */   arcgis_browser_filter_status: () => (/* binding */ ArcgisBrowserFilterStatus),
/* harmony export */   arcgis_browser_filters: () => (/* binding */ ArcgisItemBrowserFilters),
/* harmony export */   arcgis_browser_pagination: () => (/* binding */ ArcgisBrowserPagination),
/* harmony export */   arcgis_browser_search: () => (/* binding */ ArcgisBrowserSearch),
/* harmony export */   arcgis_browser_sort: () => (/* binding */ ArcgisBrowserSort),
/* harmony export */   arcgis_browser_top_bar: () => (/* binding */ ArcgisBrowserTopBar)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./locale-050b6db9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js");
/* harmony import */ var _types_a031c1da_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./types-a031c1da.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/types-a031c1da.js");
/* harmony import */ var _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./resize-a17b7292.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/resize-a17b7292.js");
/* harmony import */ var _store_8b1b0846_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./store-8b1b0846.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-8b1b0846.js");
/* harmony import */ var _functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./functional-44de8fcf.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js");
/* harmony import */ var _utils_2f459d6d_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils-2f459d6d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-2f459d6d.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */











/** Get the human readable number values for a given search pagination result */
function calculatePageBoundaries({ start, num, total }) {
    start = Math.min(start, total);
    total = Math.min(total, 10000);
    const end = Math.min(total, Math.max(start + num - 1, 0));
    return {
        start,
        end,
        total
    };
}

const arcgisBrowserCss = ":host{position:relative;display:flex;height:100%;flex-direction:column;overflow-y:auto;overflow-x:hidden;background-color:var(--calcite-color-background);--arcgis-browser-max-width:100%;--arcgis-browser-pane-width:18.75rem;--arcgis-browser-pane-z-index:11}:host([height=auto]){height:auto;min-height:100%;flex:1 1 100%}.wrapper{display:flex;height:100%;flex-direction:column;overflow:hidden}.wrapper--fixed{overflow:hidden}.wrapper--auto{flex:1 1 100%}.wrapper--full{transform:translate(0, 0)}.panel{display:flex;height:100%;flex-direction:column;overflow:hidden}.top-bar{position:sticky;top:0px;right:0px;left:0px;z-index:20;flex-shrink:0;flex-grow:0;border-bottom:1px solid var(--calcite-color-border-3)}.scrolling{position:relative;display:flex;min-height:0px;width:100%;flex:1 1 0%;flex-direction:column}.scrolling--full{overflow-y:scroll}.preview-position{position:absolute;inset:0px;margin-left:auto;margin-right:auto;width:100%;max-width:var(--arcgis-browser-max-width)}.preview-position--with-top-bar{top:3rem}.two-up{margin-left:auto;margin-right:auto;display:flex;width:100%;flex:1 1 auto;flex-direction:row;max-width:var(--arcgis-browser-max-width)}.two-up.small{margin-top:-1px}.content{position:relative;display:flex;min-width:0px;flex:1 1 0%;overflow:hidden}.content__top{position:relative;display:flex;height:1.5rem;flex-grow:0;align-items:center;justify-content:space-between;padding-top:1.25rem;padding-bottom:0.75rem;font-size:0.875rem;color:var(--calcite-color-text-1);z-index:2}.content__top__end{margin-inline-start:auto;display:grid;gap:0.5rem;grid-template-columns:auto auto}.actions{flex:1 1 0%}.filter-status{flex:1 1 0%}.content__view{min-width:0px;flex:1 1 0%;margin-inline-end:0.25rem;padding-inline-end:1rem;padding-inline-start:1rem}.content__view--padded-bottom{padding-bottom:1rem}.content__view--no-filters{margin-inline-start:0.25rem;padding-inline-start:1rem}.pane{pointer-events:none;visibility:hidden;display:flex;height:100%;background-color:var(--calcite-color-background);opacity:0;transition-duration:var(--calcite-internal-animation-timing-medium);transition-property:transform, visibility, opacity;border-left:1px solid var(--calcite-color-border-3);border-right:1px solid var(--calcite-color-border-3)}.pane--open{pointer-events:auto;visibility:visible;opacity:1;transform:translate(0);box-shadow:4px 0px 16px 0px rgba(0, 0, 0, 0.06)}.preview{width:0px;flex-shrink:0;flex-grow:0;position:absolute;top:0px;bottom:0px;inset-inline-start:0;transition-duration:var(--calcite-internal-animation-timing-medium);transition-property:width;z-index:var(--arcgis-browser-pane-z-index)}.preview--fixed{position:fixed}.preview--active{overflow:auto;width:var(--arcgis-browser-pane-width);box-shadow:rgba(0, 0, 0, 0.06) 4px 0px 16px 0px}.filter-panel,.preview-panel{position:relative;height:100%;background-color:var(--calcite-color-background)}.filter-panel__content{padding-left:1rem;padding-right:1rem;padding-top:0.75rem;padding-bottom:0px}.filter-status--mobile{width:100%}.filter-status--active{display:block}.sheet{pointer-events:none;position:fixed;inset:0px;z-index:110}.sheet__background{position:absolute;inset:0px;opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;background-color:rgba(0, 0, 0, 0.2)}.sheet--active .sheet__background{opacity:1}.sheet--active{pointer-events:auto;opacity:1}.sheet__contents{position:absolute;inset:0px;opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;top:3rem;transform:translate3d(0, 24px, 0)}.sheet--active .sheet__contents{opacity:1;transform:translate3d(0, 0, 0)}.hide{display:none}.aria-hidden{height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;position:absolute;top:0px;bottom:0px;width:0px;inset-inline-end:0}.content__view--flex{display:flex;flex-direction:column}.cover{display:flex;flex:1 1 0%;align-items:flex-start;justify-content:center;overflow:auto;padding-bottom:1rem;padding-top:0.25rem}.no-results{margin-left:auto;margin-right:auto;max-width:28rem;padding-left:1.5rem;padding-right:1.5rem;font-size:0.875rem;color:var(--calcite-color-text-2)}.results-wrapper{flex:1 1 0%}.results-wrapper--spaced{padding-top:1.5rem}.loader{--calcite-loader-padding:0}.filters{box-sizing:border-box;width:16rem;flex-grow:0;padding-inline-start:1.5rem;padding-inline-end:0px;width:var(--arcgis-browser-pane-width)}.filters--sticky{position:sticky;top:0px;height:100%}.filters__content{overflow-y:auto;height:100%;padding-top:1.5rem;box-sizing:border-box;scrollbar-gutter:stable}.filters--empty{display:none}.filters--active{opacity:1;transform:translate3d(0, 0, 0)}.filters__title{margin-left:0px;margin-right:0px;margin-bottom:1rem;margin-top:0px;padding-bottom:1rem;padding-top:0px;font-size:0.875rem;font-weight:500;color:var(--calcite-color-text-1);padding-inline-start:0.75rem;border-bottom:1px solid var(--calcite-color-border-3)}.range{font-size:0.875rem;color:var(--calcite-color-text-1)}.container{display:flex;height:100%;width:100%;flex-direction:column;background-color:var(--calcite-color-background)}.container__header{display:flex;flex:0 1 auto;flex-direction:row;background-color:var(--calcite-color-foreground-1)}.container__header__text{margin:0px;flex:1 1 0%;padding-left:0.75rem;padding-right:0.75rem;padding-top:.875rem;padding-bottom:.875rem;font-size:1rem;font-weight:500;color:var(--calcite-color-text-2)}.container__content{flex:1 1 0%;overflow:auto}.container__footer{box-sizing:border-box;width:100%;flex:0 1 auto;background-color:var(--calcite-color-foreground-1);padding:0.5rem}.small .filters{padding:0px}.small .filters__content{padding-left:1rem;padding-right:1rem}.small .content__view{padding-inline:0.5rem;margin-inline:0}.small .content__view--panel{padding-inline:0}@media screen and (max-width: 640px){:host{--arcgis-browser-pane-width:100%}}";

const ArcgisBrowser = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.ariaUpdate = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "ariaUpdate", 7);
        this.handleResize = () => requestAnimationFrame(this.updatePreviewPosition);
        this.updatePreviewPosition = () => {
            if (this.formFactor === "small" || this.height !== "auto" || !this.previewContainer) {
                return;
            }
            const rect = this.previewContainer.getBoundingClientRect();
            const { x, y, height } = rect;
            const maxY = height + y;
            this.previewBoundingBox = {
                top: Math.max(y, 0),
                left: x,
                bottom: maxY > window.innerHeight ? 0 : window.innerHeight - maxY
            };
        };
        this.panel = undefined;
        this.preview = undefined;
        this.loading = undefined;
        this.hideContentTop = undefined;
        this.selected = undefined;
        this.alwaysShowSelection = undefined;
        this.alwaysShowContent = undefined;
        this.response = undefined;
        this.store = undefined;
        this.api = 4;
        this.formFactor = undefined;
        this.searchTerm = undefined;
        this.height = "full";
        this.pageRangeText = undefined;
        this.noResults = undefined;
        this.previewBoundingBox = undefined;
        this.initialHide = true;
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el);
        this.i18n = locale[0];
        (0,_store_8b1b0846_js__WEBPACK_IMPORTED_MODULE_5__.o)(this.store, this.updatePreviewPosition);
        window.addEventListener("scroll", this.handleResize);
        window.addEventListener("resize", this.handleResize);
    }
    disconnectedCallback() {
        window.removeEventListener("resize", this.handleResize);
        window.removeEventListener("scroll", this.handleResize);
    }
    async updatePage(searchResponse) {
        const ranges = await this.updatePageRange(searchResponse);
        this.pageRangeText = ranges[0];
        this.ariaUpdate.emit(ranges[1]);
        this.noResults = (searchResponse === null || searchResponse === void 0 ? void 0 : searchResponse.total) === 0;
        this.initialHide = false;
    }
    renderPopoverContents(showFilters, showPreview, isSheet) {
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { style: {
                width: isSheet ? "100%" : `${this.store.state.width || 0}px`,
                height: isSheet ? "100%" : `${this.store.state.height || 0}px`
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: { hide: !showPreview, "preview-panel": true } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "preview" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: { hide: !showFilters, "filter-panel": true } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("article", { class: "container" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("header", { class: "container__header" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("h2", { class: "container__header__text" }, this.i18n.browser.filters), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-action", { text: this.i18n.browser.close, appearance: "solid", scale: "m", icon: "x", onClick: () => {
                this.store.state.filtersExpanded = false;
            } })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "container__content" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "container__content__scroll" }, (this.store.state.panel || isSheet) && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "filter-container__content", key: "filter-container-content" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "sort" }))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "filters" }))), this.formFactor === "small" && this.hasActiveFilter(this.store) && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "filter-status--mobile container__footer" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-browser-filter-status", { class: "filter-status", filters: this.store.state.filters })))))));
    }
    async updatePageRange(page) {
        const { start, end, total } = calculatePageBoundaries(page);
        const options = { api: this.api, places: 0, type: "decimal" };
        const startString = await (0,_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.f)(start, options);
        const endString = await (0,_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.f)(end, options);
        const totalString = (await (0,_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.f)(total, options)) + (total >= 10000 ? "+" : "");
        if (this.store.state.lang === "en") {
            return [
                `${startString}-${endString} of ${totalString}`,
                `${startString}-${endString} of ${totalString} item${total === 1 ? "" : "s"}`
            ];
        }
        return [
            this.i18n.browser.pageRange
                .replace("${start}", startString)
                .replace("${end}", endString)
                .replace("${total}", totalString),
            this.i18n.browser.pageRangeAria
                .replace("${start}", startString)
                .replace("${end}", endString)
                .replace("${total}", totalString)
        ];
    }
    renderFlow() {
        const { formFactor, loading, noResults, panel } = this;
        const autoHeight = this.height === "auto";
        const showSortInFilters = this.store.state.panel || this.store.state.width < _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.b.sm;
        const showFilters = this.store.state.filtersExpanded &&
            (!this.store.state.filtersEmpty || (!this.store.state.sortEmpty && showSortInFilters));
        const showPreview = !!this.store.state.preview;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "panel" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: { "top-bar": true, "top-bar--small": formFactor === "small" } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "top-bar" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                scrolling: true,
                "scrolling--full": !autoHeight || panel
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                "two-up": true,
                [formFactor]: true
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-start" }), loading && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content__view content__view--flex" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "cover" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-loader", { class: "loader", label: "" })))), noResults && !loading && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content__view content__view--flex" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "cover" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "no-results" }, this.renderNoResults())))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                hide: loading || noResults,
                content__view: true,
                "content__view--panel": !!this.store.state.panel,
                "content__view--flex": !loading && !noResults
            } }, !this.store.state.panel && !this.hideContentTop && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content__top" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: { selection: true, hide: !this.alwaysShowSelection } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "selection" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "range" }, this.pageRangeText), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "actions" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "actions" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content__top__end" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "view" }), !showSortInFilters && (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "sort" })))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "flow-content" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "pagination" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-end" })))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "scroll-end" })), !this.store.state.panel || window.innerWidth < this.store.state.width * 2 ? ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                sheet: true,
                "sheet--active": showFilters || showPreview
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "sheet__background" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "sheet__contents" }, this.renderPopoverContents(showFilters, showPreview, true)))) : ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-popover", { overlayPositioning: "fixed", open: showPreview || showFilters, label: "filters", referenceElement: this.el, offsetSkidding: 0, offsetDistance: 0, triggerDisabled: true, pointerDisabled: true, placement: this.store.state.panel ? "trailing" : "auto", onCalcitePopoverOpen: (event) => {
                if (!this.store.state.panel || window.innerWidth < this.store.state.width * 2) {
                    event.target.style.transform = "none";
                }
            } }, this.renderPopoverContents(showFilters, showPreview)))));
    }
    hasActiveFilter(store) {
        // certain filters should still show empty state, not no results state
        return Object.values((store === null || store === void 0 ? void 0 : store.state.filters) || {})
            .filter(({ id }) => !_types_a031c1da_js__WEBPACK_IMPORTED_MODULE_3__.I.includes(id))
            .some((filter) => filter.value);
    }
    renderNoResults() {
        const showMessage = this.noResults && !this.loading;
        const hasFilters = this.hasActiveFilter(this.store) || !!this.searchTerm;
        if (!showMessage) {
            return null;
        }
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: { cover: true } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "no-results" }, hasFilters ? (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "no-results" }) : (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "no-content" }))));
    }
    render() {
        const { loading, noResults, formFactor, hideContentTop, alwaysShowContent, panel, initialHide } = this;
        const autoHeight = this.height === "auto";
        const maxHeight = `${(this.store.state.height || window.innerHeight) - 48}px`;
        const maxHeightStyle = this.height === "auto" ? {} : { maxHeight };
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, formFactor === "small" ? (this.renderFlow()) : ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                wrapper: true,
                "wrapper--fixed": this.store.state.filtersExpanded,
                "wrapper--auto": autoHeight,
                "wrapper--full": this.height === "full"
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "top-bar" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "top-bar" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                "preview-position": true,
                "preview-position--with-top-bar": !this.store.state.topbarEmpty
            }, ref: (el) => (this.previewContainer = el) }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                preview: true,
                "preview--active": !!this.store.state.preview,
                "preview--fixed": autoHeight
            }, style: autoHeight && this.previewBoundingBox
                ? {
                    top: `${this.previewBoundingBox.top || 0}px`,
                    insetInlineStart: `${this.previewBoundingBox.left || 0}px`,
                    bottom: `${this.previewBoundingBox.bottom || 0}px`
                }
                : {} }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                pane: true,
                "pane--open": !!this.store.state.preview
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "preview" })))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                scrolling: true,
                "scrolling--full": !autoHeight || panel
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                "two-up": true,
                [formFactor]: true
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                filters: true,
                "filters--sticky": !autoHeight,
                "filters--empty": this.store.state.filtersEmpty && !this.store.state.preview,
                "filters--active": this.store.state.filtersExpanded
            }, style: maxHeightStyle }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "filters__content", style: maxHeightStyle }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "filters" }))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-start" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                content__view: true,
                "content__view--no-filters": this.store.state.filtersEmpty && !this.store.state.preview,
                "content__view--flex": true
            } }, !hideContentTop && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content__top" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: { selection: true, hide: !this.alwaysShowSelection } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "selection" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "range" }, this.pageRangeText), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "actions" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "actions" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "content__top__end" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "view" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "sort" })))), loading && !alwaysShowContent && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "cover" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-loader", { class: "loader", label: this.i18n.browser.loading }))), this.renderNoResults(), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                hide: (loading && !alwaysShowContent) || noResults || initialHide,
                "results-wrapper--spaced": hideContentTop,
                "results-wrapper": true
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                hide: loading || noResults
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "pagination" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-end" }))))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "scroll-end" }))))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
    static get watchers() { return {
        "response": ["updatePage"]
    }; }
};
ArcgisBrowser.style = arcgisBrowserCss;

const arcgisBrowserActionsCss = ":host{position:relative;margin-left:1rem;margin-right:1rem;display:flex;justify-content:flex-end}.wrapper{display:flex;padding-inline-start:0.25rem;border-inline-start:1px solid var(--calcite-color-border-1);border-inline-end:1px solid var(--calcite-color-border-1)}.button{margin-inline-end:0.25rem}.measure-container{position:absolute;height:0px;width:100%;overflow:hidden}.measure-text{visibility:hidden;height:0px;width:auto;overflow:hidden;font-size:0.875rem}";

const ArcgisBrowserActions = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.actionWidths = [];
        // icon + internal padding + button padding + margin
        this.buttonPadding = 16 + 16 + 16 + 24 + 16;
        this.handleResizeEvent = (e) => {
            e.stopPropagation();
            this.resize(e.detail.width);
        };
        this.actions = [];
        this.store = undefined;
        this.selection = undefined;
        this.visibleActions = [];
        this.overflowActions = [];
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].actions;
        (0,_resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.s)(this.store).observe(this.el);
        this.el.addEventListener("arcgisBrowserResize", this.handleResizeEvent);
    }
    disconnectedCallback() {
        var _a, _b, _c, _d;
        (_c = (_b = (_a = this.store) === null || _a === void 0 ? void 0 : _a.state) === null || _b === void 0 ? void 0 : _b.resizeObserver) === null || _c === void 0 ? void 0 : _c.unobserve(this.el);
        (_d = this.el) === null || _d === void 0 ? void 0 : _d.removeEventListener("arcgisBrowserResize", this.handleResizeEvent);
    }
    resize(width) {
        this.elementWidth = width;
        this.calculateOverflow();
    }
    actionUpdateHandler(newActions) {
        this.actionWidths = newActions === null || newActions === void 0 ? void 0 : newActions.map((action) => {
            // add width of action to the width
            this.measureText.textContent = action.text;
            return {
                action,
                width: this.measureText.offsetWidth + this.buttonPadding
            };
        });
        this.calculateOverflow();
    }
    async calculateOverflow() {
        var _a;
        this.measureText.textContent = this.i18n.more;
        const result = (_a = this.actionWidths) === null || _a === void 0 ? void 0 : _a.reduce(({ width, visible, overflow }, { action, width: actionWidth }) => {
            width += actionWidth;
            if (width >= this.elementWidth) {
                return { width, visible, overflow: [...overflow, action] };
            }
            return { width, visible: [...visible, action], overflow };
        }, { visible: [], overflow: [], width: this.moreWidth });
        this.visibleActions = result.visible;
        this.overflowActions = result.overflow;
    }
    render() {
        const { visibleActions, overflowActions, selection, i18n } = this;
        const hasOverflow = (overflowActions === null || overflowActions === void 0 ? void 0 : overflowActions.length) > 0;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "measure-container" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "measure-text", "aria-hidden": true, ref: (el) => {
                this.measureText = el;
                // the first time we have access to this node and i18n, calculate how wide the more button will be
                if (!this.moreWidth && i18n) {
                    el.textContent = i18n.more;
                    this.moreWidth = el.scrollWidth + this.buttonPadding;
                }
            } })), (selection === null || selection === void 0 ? void 0 : selection.length) > 0 && ((visibleActions === null || visibleActions === void 0 ? void 0 : visibleActions.length) > 0 || hasOverflow) && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("nav", { class: "wrapper" }, visibleActions.map(({ text, icon, onClick, id }) => ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { key: id !== null && id !== void 0 ? id : `${text}-${icon}`, class: "button", "icon-start": icon, onClick: () => onClick(), appearance: "transparent", kind: "neutral" }, text))), hasOverflow && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown", { widthScale: "m", placement: "bottom-end" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { slot: "trigger", kind: "neutral", iconEnd: "chevron-down", appearance: "transparent" }, i18n.more), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown-group", { selectionMode: "none" }, overflowActions.map((action) => ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown-item", { iconStart: action.icon, onCalciteDropdownItemSelect: () => {
                action.onClick();
            } }, action.text))))))))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
    static get watchers() { return {
        "actions": ["actionUpdateHandler"]
    }; }
};
ArcgisBrowserActions.style = arcgisBrowserActionsCss;

const ArcgisBrowserFilter = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBrowserFilterRemove = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserFilterRemove", 7);
        this.expanded = undefined;
        this.heading = undefined;
        this.active = undefined;
        this.noPadding = undefined;
        this.clearDisabled = undefined;
        this.filterID = undefined;
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].filter;
    }
    componentDidLoad() {
        if (this.accordionItem) {
            if (this.expanded) {
                this.accordionItem.expanded = true;
            }
            const content = this.accordionItem.shadowRoot.querySelector(".content");
            if (content && this.noPadding) {
                content.style.padding = "0";
            }
        }
    }
    componentDidRender() {
        var _a, _b;
        const icon = (_b = (_a = this.accordionItem) === null || _a === void 0 ? void 0 : _a.shadowRoot) === null || _b === void 0 ? void 0 : _b.querySelector(".icon-position--end");
        if (icon) {
            icon.classList.remove("icon-position--end");
            icon.classList.add("icon-position--start");
        }
    }
    render() {
        const { active, clearDisabled, heading, i18n } = this;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { style: { position: "relative" } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-accordion-item", { heading: heading, ref: (el) => {
                this.accordionItem = el;
                el.iconPosition = "start";
                el.iconType = "chevron";
            }, expanded: this.expanded,
            // @ts-ignore
            onCalciteInternalAccordionItemSelect: (e) => {
                this.expanded = !this.expanded;
            }, style: {
                "--calcite-accordion-item-background": "var(--calcite-color-background)",
                "--calcite-accordion-item-icon-spacing-start": "0",
                "--calcite-accordion-item-icon-spacing-end": ".5rem",
                "--calcite-accordion-item-padding": ".75rem .5rem",
                "--calcite-accordion-icon-margin": ".5rem",
                borderTop: "1px solid var(--calcite-color-border-1)"
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { slot: "actions-end" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "action" }), active && !clearDisabled && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { kind: "neutral", appearance: "transparent", onClick: () => {
                this.arcgisBrowserFilterRemove.emit(this.filterID);
            } }, i18n.clear))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { style: { margin: this.noPadding ? "0" : "0 .75rem" } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", null)))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};

const DAY = 1000 * 60 * 60 * 24;
function getStartOfDay(date) {
    const ts = (date || new Date()).valueOf();
    const start = new Date(ts);
    start.setHours(0, 0, 0, 0);
    return start.valueOf();
}

const ArcgisBrowserFilterDate = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBrowserFilter = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserFilter", 7);
        this.today = new Date();
        this.resetDatePicker = () => {
            this.range = null;
            this.start = null;
            this.end = null;
        };
        this.renderRange = (key) => {
            const { i18n, range } = this;
            return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-tree-item", { "data-range": key, selected: key === range }, i18n[key]));
        };
        this.property = undefined;
        this.serverProperty = undefined;
        this.range = undefined;
        this.start = undefined;
        this.end = undefined;
        this.store = undefined;
        this.expanded = undefined;
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].filterDate;
    }
    componentDidLoad() {
        if (this.range && (this.range !== "custom" || (this.start && this.end))) {
            this.arcgisBrowserFilter.emit(this.getEventDetail());
        }
        (0,_store_8b1b0846_js__WEBPACK_IMPORTED_MODULE_5__.a)(this.property, this.store, () => this.resetDatePicker());
    }
    getValue() {
        const { range, start, end } = this;
        const startOfDay = getStartOfDay();
        const endOfDay = startOfDay + DAY - 1;
        switch (range) {
            case "yesterday":
                return [startOfDay - DAY, startOfDay - 1];
            case "today":
                return [startOfDay, endOfDay];
            case "last7":
                return [startOfDay - DAY * 7, endOfDay];
            case "last30":
                return [startOfDay - DAY * 30, endOfDay];
            case "custom":
                const customStart = getStartOfDay(start);
                const customEnd = getStartOfDay(end);
                return [customStart, customEnd + DAY - 1];
            default:
                return null;
        }
    }
    getEventDetail() {
        const { property, range, i18n, serverProperty } = this;
        const value = this.getValue();
        const serverProp = serverProperty !== null && serverProperty !== void 0 ? serverProperty : (property === "modified" ? property : "uploaded");
        return {
            id: property,
            value: value ? `(${serverProp}:[${value[0]} TO ${value[1]}])` : "",
            range,
            start: (value === null || value === void 0 ? void 0 : value[0]) && new Date(value === null || value === void 0 ? void 0 : value[0]),
            end: (value === null || value === void 0 ? void 0 : value[1]) && new Date(value === null || value === void 0 ? void 0 : value[1]),
            label: this.i18n[property].replace("${date}", i18n[range])
        };
    }
    isActive() {
        return !!this.range && (this.range !== "custom" || !!(this.start && this.end));
    }
    render() {
        const { i18n, property, range, start, end } = this;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-browser-filter", { heading: i18n.title[property], expanded: this.expanded, active: this.isActive(), filterID: this.property, onArcgisBrowserFilterRemove: () => {
                this.resetDatePicker();
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-tree", { selectionMode: "children", scale: "m", onCalciteTreeSelect: (event) => {
                var _a, _b;
                const node = event.target;
                const range = (_b = (_a = node.selectedItems) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.dataset.range;
                this.range = this.range === range ? null : range;
                if (this.range === "custom" && !(this.start && this.end)) {
                    return;
                }
                this.arcgisBrowserFilter.emit(this.getEventDetail());
            } }, ["today", "yesterday", "last7", "last30", "custom"].map(this.renderRange)), range === "custom" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker", { onCalciteDatePickerRangeChange: (event) => {
                const node = event.target;
                const startDate = node.valueAsDate[0];
                const endDate = node.valueAsDate[1];
                if (startDate && endDate) {
                    this.start = startDate;
                    this.end = endDate;
                    this.arcgisBrowserFilter.emit(this.getEventDetail());
                }
            }, scale: "s", valueAsDate: [start, end], maxAsDate: this.today, range: true, style: {
                marginTop: ".5rem",
                marginBottom: ".5rem",
                marginInlineStart: "2rem",
                width: "12.75rem"
            } })))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};

const arcgisBrowserFilterStatusCss = ":host{display:flex;align-items:center}calcite-chip{max-width:100%;--calcite-color-foreground-2:var(--calcite-color-foreground-1)}.filters{margin-inline-end:0.25rem;margin-inline-start:1rem}.link{--calcite-font-size--2:var(--calcite-font-size--1);--calcite-color-brand:var(--calcite-color-text-link)}.popover-content{max-width:28rem;padding:0.75rem}.clear-button{margin-inline-start:0.25rem}";

const ArcgisBrowserFilterStatus = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBrowserFilterClear = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserFilterClear", 7);
        this.arcgisBrowserFilterRemove = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserFilterRemove", 7);
        this.renderChip = (filter) => {
            return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-chip", { scale: "s", value: filter.id, key: filter.id, closable: true, appearance: "outline", onCalciteChipClose: () => {
                    this.arcgisBrowserFilterRemove.emit(filter.id);
                } }, filter.label));
        };
        this.filters = {};
        this.hiddenFilterIds = undefined;
        this.componentWidth = undefined;
        this.browserWidth = undefined;
        this.popoverOpen = false;
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].filterStatus;
    }
    getValidFilters() {
        const validFilters = Object.values(this.filters).filter((filter) => {
            // certain filters should not appear in the list of filter chips
            if (_types_a031c1da_js__WEBPACK_IMPORTED_MODULE_3__.I.includes(filter.id)) {
                return false;
            }
            return (filter === null || filter === void 0 ? void 0 : filter.value) && (filter === null || filter === void 0 ? void 0 : filter.label);
        });
        const { componentWidth, browserWidth } = this;
        return validFilters.reduce((acc, filter) => {
            var _a;
            // this is just a heuristic to determine chip width without having to use getClientRect() which would be very slow
            // number of chars * average char width plus chip padding
            const width = (((_a = filter.label) === null || _a === void 0 ? void 0 : _a.length) || 0) * 8 + 32;
            acc.length += width;
            if (!componentWidth || browserWidth < _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.b.sm || componentWidth - acc.length > 180) {
                acc.inBounds.push(filter);
            }
            else {
                acc.outOfBounds.push(filter);
            }
            return acc;
        }, { length: 0, inBounds: [], outOfBounds: [] });
    }
    render() {
        const { inBounds, outOfBounds } = this.getValidFilters();
        const hasOverflow = !!(outOfBounds === null || outOfBounds === void 0 ? void 0 : outOfBounds.length);
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (inBounds.length > 0 || hasOverflow) && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-chip-group", { label: this.i18n.filters, scale: "s" }, inBounds.map(this.renderChip), hasOverflow && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { id: "popover-button", round: true, kind: "neutral", appearance: "outline", scale: "s" }, "+ ", outOfBounds.length)))), hasOverflow && [
            (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-popover", { label: this.i18n.additional, referenceElement: "popover-button", placement: "bottom-end" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "popover-content" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-chip-group", { label: this.i18n.additional, scale: "s" }, outOfBounds.map(this.renderChip))))
        ], outOfBounds.length + inBounds.length > 1 && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { class: "clear-button", scale: "s", appearance: "transparent", kind: "brand", onClick: () => {
                this.arcgisBrowserFilterClear.emit();
            } }, this.i18n.clearAllFilters))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisBrowserFilterStatus.style = arcgisBrowserFilterStatusCss;

const ArcgisItemBrowserFilters = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.store = undefined;
    }
    render() {
        var _a, _b;
        const addPadding = ((_a = this.store) === null || _a === void 0 ? void 0 : _a.state.panel) || ((_b = this.store) === null || _b === void 0 ? void 0 : _b.state.width) < _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.b.sm;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { style: { padding: addPadding ? "0 1rem 1rem" : "0" } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "top" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-accordion", { appearance: "transparent", iconType: "chevron", scale: "m", "icon-position": "start", ref: (el) => {
                this.store.state.filterElement = el;
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", null)), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "bottom" })));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};

const arcgisBrowserPaginationCss = ".wrapper{display:flex;justify-content:center;padding-left:0.5rem;padding-right:0.5rem;padding-top:2rem;padding-bottom:2rem}.hide{display:none}";

const ArcgisBrowserPagination = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBrowserPage = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserPage", 7);
        this.total = undefined;
        this.start = undefined;
        this.num = 60;
        this.store = undefined;
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].pagination;
        const { start, total, num } = this;
        this.arcgisBrowserPage.emit({ start, total, num });
    }
    render() {
        const { start, total, num, i18n } = this;
        const scale = this.store.state.width > _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.b.sm ? "m" : "s";
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "wrapper" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-pagination", { onCalcitePaginationChange: (event) => {
                const node = event.target;
                this.arcgisBrowserPage.emit({
                    start: node.startItem,
                    total: node.totalItems,
                    num: node.pageSize
                });
            }, startItem: start, totalItems: Math.min(total, 10000 - num), pageSize: num, scale: scale, messageOverrides: { next: i18n.next, previous: i18n.prev }, class: {
                hide: !total || total < num
            } })));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisBrowserPagination.style = arcgisBrowserPaginationCss;

const arcgisBrowserSearchCss = ":host{position:relative;display:block}.search{pointer-events:none;position:absolute;z-index:10;margin-top:1rem;font-size:0.875rem;color:var(--calcite-color-text-1);inset-inline-start:1.5rem}.x{position:absolute;top:0px;z-index:10;margin-top:0.25rem;cursor:pointer;border-style:none;padding:0.5rem;color:var(--calcite-color-text-1);outline:2px solid transparent;outline-offset:2px;inset-inline-end:0.25rem;background:transparent}.input{position:relative;z-index:0;box-sizing:border-box;display:block;height:3rem;width:100%;border-style:none;padding-top:1rem;padding-bottom:1rem;padding-left:3rem;padding-right:3rem;font-size:0.875rem;color:var(--calcite-color-text-1);--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-duration:150ms;background-color:transparent;border-bottom:2px solid transparent;font-family:inherit}.input::-webkit-search-cancel-button{display:none}.input::-ms-clear{display:none}.input:focus{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);outline:2px solid transparent;outline-offset:2px;border-bottom-color:var(--calcite-color-brand)}";

const ArcgisBrowserSearch = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBrowserSearch = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserSearch", 7);
        this.arcgisBrowserSearchInput = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserSearchInput", 7);
        this.debouncedInput = (0,_functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_6__.d)((term) => {
            const containsWildcard = term.includes("*");
            this.showClear = !!term;
            if (containsWildcard) {
                this.containsWildcard = true;
            }
            else {
                this.containsWildcard = false;
                this.arcgisBrowserSearch.emit(term);
            }
        }, 400);
        this.term = undefined;
        this.placeholder = undefined;
        this.showClear = false;
        this.containsWildcard = false;
    }
    async componentWillLoad() {
        var _a;
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].search;
        if (this.term) {
            this.showClear = true;
        }
        this.containsWildcard = (_a = this.term) === null || _a === void 0 ? void 0 : _a.includes("*");
    }
    async componentDidLoad() {
        this.arcgisBrowserSearch.emit(this.term);
    }
    termChanged(newTerm) {
        if (this.searchInput.value !== newTerm) {
            this.showClear = !!newTerm;
            this.arcgisBrowserSearch.emit(newTerm);
        }
    }
    render() {
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { icon: "search", scale: "s", class: "search" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("input", { class: "input", value: this.term, placeholder: this.placeholder || this.i18n.search, ref: (el) => (this.searchInput = el), "aria-label": this.placeholder || this.i18n.search, onInput: (e) => {
                const term = e.currentTarget.value;
                if (!(term === null || term === void 0 ? void 0 : term.includes("*"))) {
                    this.containsWildcard = false;
                }
                this.arcgisBrowserSearchInput.emit(term);
                this.debouncedInput(term);
            } }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-alert", { open: this.containsWildcard, scale: "m", kind: "danger", icon: "exclamation-mark-triangle", label: this.i18n.wildcard, onCalciteAlertClose: () => {
                this.containsWildcard = false;
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { slot: "message" }, this.i18n.wildcard)), this.showClear && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("button", { class: "x", "aria-label": this.i18n.clear, onClick: () => {
                this.arcgisBrowserSearchInput.emit("");
                this.arcgisBrowserSearch.emit("");
                this.showClear = false;
                if (this.searchInput) {
                    this.searchInput.value = "";
                    this.searchInput.focus();
                }
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { icon: "x", scale: "m", class: "x--icon" })))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
    static get watchers() { return {
        "term": ["termChanged"]
    }; }
};
ArcgisBrowserSearch.style = arcgisBrowserSearchCss;

const arcgisBrowserSortCss = ".dropdown-wrap{display:flex;align-items:center}.radio-wrapper{padding:1rem}.medium{font-weight:500}";

const ArcgisBrowserSort = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisBrowserSortFieldChange = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserSortFieldChange", 7);
        this.arcgisBrowserSortOrderChange = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisBrowserSortOrderChange", 7);
        this.sortOrders = ["asc", "desc"];
        this.options = undefined;
        this.field = undefined;
        this.order = undefined;
        this.store = undefined;
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].sort;
    }
    renderFieldOption(option, selectedField, i18n) {
        const { store } = this;
        const info = (0,_utils_2f459d6d_js__WEBPACK_IMPORTED_MODULE_7__.g)(option, i18n, store);
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown-item", { selected: selectedField === option, onCalciteDropdownItemSelect: () => this.arcgisBrowserSortFieldChange.emit(option), key: option }, info.label));
    }
    renderButton(info) {
        var _a, _b;
        const { i18n } = this;
        const baseAttrs = {
            class: "button",
            slot: "trigger",
            scale: "m",
            appearance: "outline-fill",
            kind: "neutral",
            iconStart: "sort-descending",
            iconFlipRtl: "start",
            ariaLabel: `${i18n.sortBy} ${info.label}`
        };
        return ((_b = (_a = this.store) === null || _a === void 0 ? void 0 : _a.state) === null || _b === void 0 ? void 0 : _b.width) > _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.D ? ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", Object.assign({}, baseAttrs), info.label)) : ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", Object.assign({}, baseAttrs)));
    }
    renderDropdown() {
        const { field, order, options, i18n, store } = this;
        const selectedField = options.includes(field) ? field : options[0];
        const info = (0,_utils_2f459d6d_js__WEBPACK_IMPORTED_MODULE_7__.g)(selectedField, i18n, store);
        const selectedOrder = order || info.defaultSortOrder;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown", { placement: "bottom-end", scale: "m", overlayPositioning: "fixed", widthScale: "m" }, this.renderButton(info), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown-group", { selectionMode: "single", "group-title": i18n.sortBy }, this.options.map((option) => this.renderFieldOption(option, selectedField, i18n))), info.showSortOrder && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown-group", { selectionMode: "single", "group-title": i18n.sortDirection }, this.sortOrders.map((order) => ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-dropdown-item", { key: order, selected: selectedOrder === order, onCalciteDropdownItemSelect: () => this.arcgisBrowserSortOrderChange.emit(order) }, info.sortOrderLabels[order])))))));
    }
    renderFieldRadio(option, selectedField, i18n) {
        const info = (0,_utils_2f459d6d_js__WEBPACK_IMPORTED_MODULE_7__.g)(option, i18n);
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { layout: "inline", alignment: "start" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-radio-button", { value: option, name: "sort_field", checked: selectedField === option }), info.label));
    }
    renderRadioButtons() {
        const { field, order, options, i18n, store } = this;
        const selectedField = options.includes(field) ? field : options[0];
        const info = (0,_utils_2f459d6d_js__WEBPACK_IMPORTED_MODULE_7__.g)(selectedField, i18n, store);
        const selectedOrder = order || info.defaultSortOrder;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "radio-wrapper" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { scale: "m" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "medium" }, i18n.sortBy), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-radio-button-group", { name: "sort_field", layout: "vertical", role: "radiogroup", onCalciteRadioButtonGroupChange: (event) => this.arcgisBrowserSortFieldChange.emit(event.target.selectedItem.value) }, this.options.map((option) => this.renderFieldRadio(option, selectedField, i18n)))), info.showSortOrder && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { scale: "m" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "medium" }, i18n.sortDirection), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-radio-button-group", { name: "sort_order", layout: "vertical", role: "radiogroup", onCalciteRadioButtonGroupChange: (event) => this.arcgisBrowserSortOrderChange.emit(event.target.selectedItem.value) }, this.sortOrders.map((order) => ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { layout: "inline", alignment: "start" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-radio-button", { value: order, name: "sort_order", checked: selectedOrder === order }), info.sortOrderLabels[order]))))))));
    }
    render() {
        return this.store.state.panel ||
            (this.store.state.width && this.store.state.width < _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.b.sm)
            ? this.renderRadioButtons()
            : this.renderDropdown();
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisBrowserSort.style = arcgisBrowserSortCss;

const arcgisBrowserTopBarCss = ":host{position:relative;display:block;background-color:var(--arcgis-browser-top-bar-background)}.wrapper{margin-left:auto;margin-right:auto;display:flex;max-width:var(--arcgis-browser-max-width)}.search-and-sort{display:flex;flex:1 1 0%;align-items:center;padding-inline-end:1.5rem}.search{flex:1 1 0%}.sort{display:flex;align-items:center}.filter{margin-top:0.25rem;margin-bottom:0.25rem;display:flex;align-items:center;justify-content:center;padding-left:0.5rem;padding-right:0.5rem}.filter--left{border-inline-end:1px solid var(--calcite-color-border-3)}.large .filter{display:none}.rel{position:relative}.bucket--small{text-align:center;border-bottom:1px solid var(--calcite-color-border-3)}.indicator{pointer-events:none;position:absolute;top:0px;z-index:20;height:0.5rem;width:0.5rem;border-radius:50%;background-color:var(--calcite-color-brand);inset-inline-start:0}.small .search-and-sort{padding-inline-end:1rem}";

const ArcgisBrowserTopBar = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.store = undefined;
        this.filtersDisabled = undefined;
        this.width = undefined;
    }
    async componentWillLoad() {
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.el, "arcgis-browser");
        this.i18n = locale[0].topBar;
        // @ts-ignore
        this.store.onChange("width", (width) => {
            var _a;
            this.width = (_a = this.searchWrapper) === null || _a === void 0 ? void 0 : _a.offsetWidth;
        });
    }
    getFormFactor() {
        const width = this.store.state.width;
        switch (true) {
            case width <= _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.b.sm:
                return "small";
            case width <= _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_4__.b.md:
                return "medium";
            default:
                return "large";
        }
    }
    handleClick() {
        this.store.state.preview = null;
        this.store.state.filtersExpanded = !this.store.state.filtersExpanded;
    }
    render() {
        const formFactor = this.getFormFactor();
        const showFilterButton = formFactor === "small" &&
            (!this.store.state.filtersEmpty || !this.store.state.sortEmpty) &&
            !this.filtersDisabled;
        const hasActiveFilter = Object.values(this.store.state.filters || {}).some((filter) => filter.value);
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, formFactor === "small" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "bucket bucket--small" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "bucket" }))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: { [formFactor]: true, wrapper: true } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-start" }), showFilterButton && !this.store.state.panel && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "filter filter--left" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "rel" }, hasActiveFilter && (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "indicator" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { class: "filter-toggle", scale: "s", appearance: "transparent", kind: "neutral", iconStart: "sliders", "aria-label": "toggle-filters", onClick: () => this.handleClick(), "aria-expanded": this.store.state.filtersExpanded }, this.i18n.filter)))), formFactor !== "small" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "bucket" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "bucket" }))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "search-and-sort", ref: (el) => {
                this.searchWrapper = el;
                if (!this.width) {
                    requestAnimationFrame(() => (this.width = el === null || el === void 0 ? void 0 : el.offsetWidth));
                }
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "search" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "search" })), !showFilterButton && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-browser-filter-status", { componentWidth: this.width, browserWidth: this.store.state.width, class: "filter-status", filters: this.store.state.filters }))), showFilterButton && this.store.state.panel && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "filter" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "rel" }, hasActiveFilter && (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "indicator" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { class: "filter-toggle", scale: "s", appearance: "transparent", kind: "neutral", iconStart: "sliders", "aria-label": this.i18n.filter, onClick: () => this.handleClick(), "aria-expanded": this.store.state.filtersExpanded })))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-end" }))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisBrowserTopBar.style = arcgisBrowserTopBarCss;



//# sourceMappingURL=arcgis-browser_10.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ arrayToLookupMap),
/* harmony export */   b: () => (/* binding */ unique),
/* harmony export */   c: () => (/* binding */ throttle),
/* harmony export */   d: () => (/* binding */ debounce),
/* harmony export */   e: () => (/* binding */ escapeRegExp),
/* harmony export */   f: () => (/* binding */ arraysAreEquivalent),
/* harmony export */   g: () => (/* binding */ chunk),
/* harmony export */   i: () => (/* binding */ isDefined),
/* harmony export */   m: () => (/* binding */ minDelay),
/* harmony export */   t: () => (/* binding */ timeout),
/* harmony export */   u: () => (/* binding */ uniqueBy)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
/**
 * Call a function only after it has not been called for n milliseconds
 * @param fn    - function to call
 * @param delay - delay in milliseconds
 */
const debounce = (fn, delay) => {
    let timeout;
    let status = "idle";
    function flush(...args) {
        status = "flushed";
        return debounced(...args);
    }
    function invoke(...args) {
        status = "invoked";
        return debounced(...args);
    }
    function cancel(...args) {
        status = "cancelled";
        return debounced(...args);
    }
    function getStatus() {
        return status;
    }
    const debounced = (...args) => new Promise((resolve) => {
        switch (status) {
            case "flushed":
                status = "idle";
                if (timeout) {
                    clearTimeout(timeout);
                    resolve(fn(...args));
                }
                else {
                    resolve(null);
                }
                break;
            case "invoked":
                clearTimeout(timeout);
                status = "idle";
                resolve(fn(...args));
                break;
            case "cancelled":
                clearTimeout(timeout);
                status = "idle";
                resolve(null);
                break;
            default:
                if (timeout) {
                    clearTimeout(timeout);
                }
                status = "pending";
                timeout = setTimeout(() => {
                    status = "idle";
                    return resolve(fn(...args));
                }, delay);
                break;
        }
    });
    debounced.flush = flush;
    debounced.invoke = invoke;
    debounced.cancel = cancel;
    debounced.getStatus = getStatus;
    return debounced;
};
/**
 * Call a function only after n milliseconds have elapsed
 * @param fn    - function to call
 * @param delay - delay in milliseconds
 */
const throttle = (fn, delay) => {
    let timeout;
    return (...args) => new Promise((resolve) => {
        if (timeout) {
            return;
        }
        timeout = setTimeout(() => {
            clearTimeout(timeout);
            timeout = undefined;
            resolve(fn(...args));
        }, delay);
    });
};
function escapeRegExp(str) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"); // $& means the whole matched string
}
function isDefined(value) {
    return value !== undefined && value !== null;
}
/**
 * Set a minimum time for a promise to resolve (useful for preventing flash of loaders)
 */
async function minDelay(promise, minDelay) {
    await Promise.all([promise, timeout(minDelay)]);
    return promise;
}
/**
 * Helper method to inline setTimeout as an await in async functions
 */
function timeout(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
}
const arrayToLookupMap = (dataArr, getKeyAndItem) => Object.fromEntries((dataArr || []).map((item) => {
    const { key, data } = getKeyAndItem(item);
    return [key, data];
}));
/**
 * Check whether two arrays have the same number of elements
 * and whether they contain the same elements
 * regardless of order
 */
const arraysAreEquivalent = (arr1, arr2) => arr1.length === arr2.length && arr1.reduce((memo, str) => memo && arr2.indexOf(str) > -1, true);
function uniqueBy(myArr, getItemId) {
    const resultArr = [];
    const lookupMap = {};
    myArr.forEach((item) => {
        const id = getItemId(item);
        if (lookupMap[id] == null) {
            lookupMap[id] = item;
            resultArr.push(item);
        }
    });
    return resultArr;
}
function unique(myArr) {
    const primitives = { boolean: {}, number: {}, string: {} };
    const objs = [];
    return myArr.filter((item) => {
        let type = typeof item;
        if (type in primitives) {
            return primitives[type].hasOwnProperty(item) ? false : (primitives[type][item] = true);
        }
        else {
            return objs.indexOf(item) >= 0 ? false : objs.push(item);
        }
    });
}
const chunk = (arr, size) => [...Array(Math.ceil(arr.length / size))].map((_, i) => arr.slice(size * i, size + size * i));



//# sourceMappingURL=functional-44de8fcf.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js":
/*!******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CSS_UTILITY),
/* harmony export */   a: () => (/* binding */ formatDate),
/* harmony export */   b: () => (/* binding */ formatPlural),
/* harmony export */   f: () => (/* binding */ formatNumber),
/* harmony export */   g: () => (/* binding */ getElementDir),
/* harmony export */   l: () => (/* binding */ languageMap)
/* harmony export */ });
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



const languageMap = new Map([
    ["ar", "ar"],
    ["bg", "bg"],
    ["bs", "bs"],
    ["ca", "ca"],
    ["cs", "cs"],
    ["da", "da"],
    ["de", "de"],
    ["el", "el"],
    ["en", "en"],
    ["es", "es"],
    ["et", "et"],
    ["fi", "fi"],
    ["fr", "fr"],
    ["he", "he"],
    ["hr", "hr"],
    ["hu", "hu"],
    ["id", "id"],
    ["it", "it"],
    ["ja", "ja"],
    ["ko", "ko"],
    ["lt", "lt"],
    ["lv", "lv"],
    ["nb", "nb"],
    ["nl", "nl"],
    ["pl", "pl"],
    ["pt-br", "pt-BR"],
    ["pt-pt", "pt-PT"],
    ["ro", "ro"],
    ["ru", "ru"],
    ["sk", "sk"],
    ["sl", "sl"],
    ["sr", "sr"],
    ["sv", "sv"],
    ["th", "th"],
    ["tr", "tr"],
    ["uk", "uk"],
    ["vi", "vi"],
    ["zh-cn", "zh-CN"],
    ["zh-hk", "zh-HK"],
    ["zh-tw", "zh-TW"]
]);
// rtl
function getElementDir(el) {
    return getElementProp(el, "dir", "ltr");
}
function getElementProp(el, prop, value) {
    const closestWithProp = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_1__.c)(el, `[${prop}]`);
    return closestWithProp ? closestWithProp.getAttribute(prop) : value;
}
// css
const CSS_UTILITY = {
    rtl: "arcgis--rtl"
};
async function formatNumber(number, options) {
    const { api, type, places } = options || {};
    if (api === 4) {
        const [intl] = await (0,_loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__.l)(["esri/intl"]);
        const numberFormatIntlOptions = intl.convertNumberFormatToIntlOptions({
            places,
            style: type,
            digitSeparator: true
        });
        return intl.formatNumber(number, Object.assign(Object.assign({}, numberFormatIntlOptions), { style: type }));
    }
    const [dojoNumber] = await (0,_loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__.l)(["dojo/number"]);
    return dojoNumber.format(number, {
        type,
        places,
        pattern: options === null || options === void 0 ? void 0 : options.pattern
    });
}
const cache = {};
function formatDate(date) {
    const lang = document.documentElement.lang;
    const dayShortMonthYear = {
        year: "numeric",
        month: "short",
        day: "numeric"
    };
    if (!cache[lang]) {
        cache[lang] = new Intl.DateTimeFormat(document.documentElement.lang, dayShortMonthYear);
    }
    return cache[lang].format(date);
}
function formatPlural(lang, stringObj, number) {
    const singles = ["id", "ja", "ko", "th", "vi", "zh-cn", "zh-hk", "zh-tw"];
    const likeEnglish = [
        "en",
        "ca",
        "da",
        "de",
        "el",
        "es",
        "et",
        "fi",
        "hi",
        "hu",
        "it",
        "nb",
        "nl",
        "pt-pt",
        "sv",
        "tr"
    ];
    const locale = lang !== null && lang !== void 0 ? lang : "en";
    // if the number is one, or it is a "simple" language, return the 1 string
    if (number === 1 || singles.includes(locale)) {
        return stringObj.single.replace("${number}", "1");
    }
    // if the number is not 1 and the language uses the same pluralization strategy as english,
    // return the multiple string
    if (number !== 1 && likeEnglish.includes(locale)) {
        return stringObj.multiple.replace("${number}", `${number}`);
    }
    // if none of the above worked, return the "unknown" string
    return stringObj.unknown.replace("${number}", `${number}`);
}



//# sourceMappingURL=languageUtil-ef0e54b2.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getComponentClosestLanguage),
/* harmony export */   g: () => (/* binding */ getLocaleComponentStrings)
/* harmony export */ });
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




// https://medium.com/stencil-tricks/implementing-internationalisation-i18n-with-stencil-5e6559554117
function getComponentClosestLanguage(element) {
    var _a, _b, _c;
    const closestElement = (_a = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
    // language set by the calling application or browser. defaults to english.
    const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
    if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
        return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
    }
    else {
        // "ru-RU" maps to "ru" use case
        if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
            return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang.slice(0, 2));
        }
        else {
            return "en";
        }
    }
}
function getComponentClosestLanguageIntl(element) {
    var _a, _b, _c;
    // it's OK if we don't have the 4 letter language file for it
    // 4 letter language code needed for formatting numbers
    const closestElement = (_a = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
    // language set by the calling application or browser. defaults to english.
    const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
    if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
        return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
    }
    else {
        if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
            // we support the 2 letter coded language
            // e.g. it-CH vs it
            return lang;
        }
        else {
            return "en";
        }
    }
}
function fetchLocaleStringsForComponent(componentName, locale) {
    return new Promise((resolve, reject) => {
        fetch((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_2__.a)(`../arcgis-app-assets/i18n/${componentName}.i18n.${locale}.json`)).then((result) => {
            if (result.ok)
                resolve(result.json());
            else
                reject();
        }, () => reject());
    });
}
const stringCache = {};
function fetchLocaleStringsFromCache(componentName, locale) {
    const id = `${componentName}${locale}`;
    if (!stringCache[id]) {
        stringCache[id] = fetchLocaleStringsForComponent(componentName, locale);
    }
    return stringCache[id];
}
/**
 * Get strings and language codes.
 * This method returns 2 language codes.
 * The first one returns a code that's also supported as a language file.
 * The second one returns a code where there is support for the first 2 letters of the code as part of a language file,
 * but will return the original 4 letter code from the page.
 * E.g. For "it-ch" it will return "it" as the first language code and "it-ch" as the second.
 * The second one is required for esri.intl.setLocale() to get the correct formatting.
 *
 * If a tagName is provided it will overwite the element's tagName
 *
 *  @return [ strings, first language code, second language code]
 */
async function getLocaleComponentStrings(element, tagName) {
    const componentName = tagName || element.tagName.toLowerCase();
    const componentLanguage = getComponentClosestLanguage(element);
    const componentLanguageIntl = getComponentClosestLanguageIntl(element);
    let strings;
    try {
        strings = await fetchLocaleStringsFromCache(componentName, componentLanguage);
    }
    catch (e) {
        console.warn(`no locale for ${componentName} (${componentLanguage}) loading default locale en.`);
        strings = await fetchLocaleStringsFromCache(componentName, "en");
    }
    return [strings, componentLanguage, componentLanguageIntl];
}



//# sourceMappingURL=locale-050b6db9.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/resize-a17b7292.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/resize-a17b7292.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   D: () => (/* binding */ DROPDOWN_ICON_DISPLAY_CUTOFF_SIZE),
/* harmony export */   b: () => (/* binding */ breakpoints),
/* harmony export */   s: () => (/* binding */ setupResizeObserver)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
const breakpoints = {
    xxs: 320,
    xs: 480,
    sm: 640,
    md: 768,
    lg: 1024,
    xl: 1280
};
const DROPDOWN_ICON_DISPLAY_CUTOFF_SIZE = 960;
function setupResizeObserver(store) {
    var _a;
    var _b;
    (_a = (_b = store.state).resizeObserver) !== null && _a !== void 0 ? _a : (_b.resizeObserver = new ResizeObserver(resizeHandler));
    return store.state.resizeObserver;
}
/**
 * resize handler will be called when items get resized
 * an event is dispatched on each element, passing the new width and height
 */
function resizeHandler(entries) {
    entries.forEach((entry) => {
        if (entry.contentRect.width > 0) {
            const event = new CustomEvent("arcgisBrowserResize", {
                detail: { width: entry.contentRect.width, height: entry.contentRect.height }
            });
            entry.target.dispatchEvent(event);
        }
    });
}



//# sourceMappingURL=resize-a17b7292.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-8b1b0846.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-8b1b0846.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ onBrowserFilterRemove),
/* harmony export */   b: () => (/* binding */ onGroupIdChange),
/* harmony export */   g: () => (/* binding */ getStore),
/* harmony export */   o: () => (/* binding */ onPreviewChange)
/* harmony export */ });
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const onBrowserFilterRemove = (id, store, callback) => {
    // @ts-ignore
    store.onChange("filters", (filters) => {
        if (!filters[id] || !filters[id].value) {
            callback();
        }
    });
};
const onPreviewChange = (store, callback) => {
    // @ts-ignore
    store.onChange("preview", (preview) => {
        callback();
    });
};
const onGroupIdChange = (store, callback) => {
    // @ts-ignore
    store.onChange("groupId", (preview) => {
        callback();
    });
};
const STORE_LOOKUP = new Map();
function getStore(el, browserTag) {
    const existingStore = STORE_LOOKUP.get(el);
    if (existingStore) {
        return existingStore;
    }
    const browser = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(el, browserTag);
    if (browser) {
        STORE_LOOKUP.set(el, browser.store);
        return browser.store;
    }
    return null;
}



//# sourceMappingURL=store-8b1b0846.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/types-a031c1da.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/types-a031c1da.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ ITEM_BROWSER_BUILT_IN_FILTERS),
/* harmony export */   a: () => (/* binding */ ITEM_BROWSER_MAX_ITEMS)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
const ITEM_BROWSER_BUILT_IN_FILTERS = ["folder", "group", "contentType"];
const ITEM_BROWSER_MAX_ITEMS = 99999; // arbitrary large number so it show all items



//# sourceMappingURL=types-a031c1da.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-2f459d6d.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-2f459d6d.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getDefaultSortOrder),
/* harmony export */   g: () => (/* binding */ getSortFieldInfo)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
const sortLookup = {
    title: ["asc", "alphabetical"],
    owner: ["asc", "alphabetical"],
    numviews: ["desc", "num"],
    relevance: ["desc"],
    modified: ["desc", "recent"],
    created: ["desc", "recent"],
    size: ["desc", "size"]
};
function getSortFieldInfo(field, i18n, store) {
    var _a;
    const [defaultSortOrder, labelType] = sortLookup[field];
    const label = field === "modified" && ((_a = store === null || store === void 0 ? void 0 : store.state) === null || _a === void 0 ? void 0 : _a.recycleBin) ? i18n.deleted : i18n[field];
    const sortOrderLabels = {
        asc: i18n[`${labelType}Asc`],
        desc: i18n[`${labelType}Desc`]
    };
    return {
        label,
        showSortOrder: !!labelType,
        defaultSortOrder,
        sortOrderLabels
    };
}
function getDefaultSortOrder(field) {
    const [defaultSortOrder] = sortLookup[field];
    return defaultSortOrder;
}



//# sourceMappingURL=utils-2f459d6d.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTdiNzAyOS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzZHO0FBQzlDO0FBQ087QUFDRztBQUNpRDtBQUNuQztBQUM5QjtBQUNHO0FBQ3pCO0FBQ1I7O0FBRTNCO0FBQ0EsbUNBQW1DLG1CQUFtQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZ0NBQWdDLGtCQUFrQixhQUFhLFlBQVksc0JBQXNCLGdCQUFnQixrQkFBa0IsaURBQWlELGdDQUFnQyxxQ0FBcUMsaUNBQWlDLHFCQUFxQixZQUFZLGdCQUFnQixjQUFjLFNBQVMsYUFBYSxZQUFZLHNCQUFzQixnQkFBZ0IsZ0JBQWdCLGdCQUFnQixlQUFlLGNBQWMsZUFBZSwwQkFBMEIsT0FBTyxhQUFhLFlBQVksc0JBQXNCLGdCQUFnQixTQUFTLGdCQUFnQixRQUFRLFVBQVUsU0FBUyxXQUFXLGNBQWMsWUFBWSxzREFBc0QsV0FBVyxrQkFBa0IsYUFBYSxlQUFlLFdBQVcsWUFBWSxzQkFBc0IsaUJBQWlCLGtCQUFrQixrQkFBa0Isa0JBQWtCLFVBQVUsaUJBQWlCLGtCQUFrQixXQUFXLDBDQUEwQyxnQ0FBZ0MsU0FBUyxRQUFRLGlCQUFpQixrQkFBa0IsYUFBYSxXQUFXLGNBQWMsbUJBQW1CLDBDQUEwQyxjQUFjLGdCQUFnQixTQUFTLGtCQUFrQixhQUFhLGNBQWMsWUFBWSxnQkFBZ0IsY0FBYyxrQkFBa0IsYUFBYSxjQUFjLFlBQVksbUJBQW1CLDhCQUE4QixvQkFBb0IsdUJBQXVCLG1CQUFtQixrQ0FBa0MsVUFBVSxtQkFBbUIseUJBQXlCLGFBQWEsV0FBVyxnQ0FBZ0MsU0FBUyxZQUFZLGVBQWUsWUFBWSxlQUFlLGNBQWMsWUFBWSwwQkFB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0EsaUNBQWlDLHNCQUFzQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLFlBQVk7QUFDeEI7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixXQUFXLFlBQVk7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRWlNOztBQUVqTTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL0lBO0FBQ0E7QUFDQTtBQUNBO0FBQzZEO0FBQ2M7O0FBRTNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsbURBQWlDLFNBQVMsS0FBSztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksb0JBQW9CO0FBQ2hDO0FBQ0EsNkJBQTZCLDJEQUFXO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHVFQUF1RSw4QkFBOEIsYUFBYTtBQUNsSDtBQUNBLCtCQUErQiwyREFBVztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxPQUFPO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLE9BQU8sTUFBTSxPQUFPO0FBQ2pFO0FBQ0E7QUFDQSx3Q0FBd0MsT0FBTyxNQUFNLE9BQU87QUFDNUQ7O0FBRXlIOztBQUV6SDs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaElBO0FBQ0E7QUFDQTtBQUNBO0FBQzJFO0FBQ2I7QUFDTjs7QUFFeEQ7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1EQUFpQztBQUNsRTtBQUNBO0FBQ0EsUUFBUSx3REFBVztBQUNuQixlQUFlLHdEQUFXO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0RBQVc7QUFDdkIsbUJBQW1CLHdEQUFXO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1EQUFpQztBQUNsRTtBQUNBO0FBQ0EsUUFBUSx3REFBVztBQUNuQixlQUFlLHdEQUFXO0FBQzFCO0FBQ0E7QUFDQSxZQUFZLHdEQUFXO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHFEQUFZLDhCQUE4QixjQUFjLFFBQVEsT0FBTztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGNBQWMsRUFBRSxPQUFPO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxlQUFlLEdBQUcsa0JBQWtCO0FBQzFFO0FBQ0E7QUFDQTtBQUNBOztBQUU0RTs7QUFFNUU7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCLGFBQWE7QUFDYjtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUU4Rjs7QUFFOUY7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUMyRTs7QUFFM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtREFBaUM7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVpRzs7QUFFakc7Ozs7Ozs7Ozs7Ozs7OztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDOztBQUVxQzs7QUFFM0U7Ozs7Ozs7Ozs7Ozs7OztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixVQUFVO0FBQy9CLHNCQUFzQixVQUFVO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFMkQ7O0FBRTNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLWJyb3dzZXJfMTAuZW50cnkuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vZnVuY3Rpb25hbC00NGRlOGZjZi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vbG9jYWxlLTA1MGI2ZGI5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL3Jlc2l6ZS1hMTdiNzI5Mi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9zdG9yZS04YjFiMDg0Ni5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS90eXBlcy1hMDMxYzFkYS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS91dGlscy0yZjQ1OWQ2ZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgSCBhcyBIb3N0LCBkIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcbmltcG9ydCB7IGYgYXMgZm9ybWF0TnVtYmVyIH0gZnJvbSAnLi9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzIH0gZnJvbSAnLi9sb2NhbGUtMDUwYjZkYjkuanMnO1xuaW1wb3J0IHsgSSBhcyBJVEVNX0JST1dTRVJfQlVJTFRfSU5fRklMVEVSUyB9IGZyb20gJy4vdHlwZXMtYTAzMWMxZGEuanMnO1xuaW1wb3J0IHsgYiBhcyBicmVha3BvaW50cywgcyBhcyBzZXR1cFJlc2l6ZU9ic2VydmVyLCBEIGFzIERST1BET1dOX0lDT05fRElTUExBWV9DVVRPRkZfU0laRSB9IGZyb20gJy4vcmVzaXplLWExN2I3MjkyLmpzJztcbmltcG9ydCB7IG8gYXMgb25QcmV2aWV3Q2hhbmdlLCBhIGFzIG9uQnJvd3NlckZpbHRlclJlbW92ZSB9IGZyb20gJy4vc3RvcmUtOGIxYjA4NDYuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWJvdW5jZSB9IGZyb20gJy4vZnVuY3Rpb25hbC00NGRlOGZjZi5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFNvcnRGaWVsZEluZm8gfSBmcm9tICcuL3V0aWxzLTJmNDU5ZDZkLmpzJztcbmltcG9ydCAnLi9sb2FkTW9kdWxlcy1iNGFjMTI0Ny5qcyc7XG5pbXBvcnQgJy4vZG9tLTRkMzY3Njc3LmpzJztcblxuLyoqIEdldCB0aGUgaHVtYW4gcmVhZGFibGUgbnVtYmVyIHZhbHVlcyBmb3IgYSBnaXZlbiBzZWFyY2ggcGFnaW5hdGlvbiByZXN1bHQgKi9cbmZ1bmN0aW9uIGNhbGN1bGF0ZVBhZ2VCb3VuZGFyaWVzKHsgc3RhcnQsIG51bSwgdG90YWwgfSkge1xuICAgIHN0YXJ0ID0gTWF0aC5taW4oc3RhcnQsIHRvdGFsKTtcbiAgICB0b3RhbCA9IE1hdGgubWluKHRvdGFsLCAxMDAwMCk7XG4gICAgY29uc3QgZW5kID0gTWF0aC5taW4odG90YWwsIE1hdGgubWF4KHN0YXJ0ICsgbnVtIC0gMSwgMCkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0LFxuICAgICAgICBlbmQsXG4gICAgICAgIHRvdGFsXG4gICAgfTtcbn1cblxuY29uc3QgYXJjZ2lzQnJvd3NlckNzcyA9IFwiOmhvc3R7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O2hlaWdodDoxMDAlO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtvdmVyZmxvdy15OmF1dG87b3ZlcmZsb3cteDpoaWRkZW47YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWJhY2tncm91bmQpOy0tYXJjZ2lzLWJyb3dzZXItbWF4LXdpZHRoOjEwMCU7LS1hcmNnaXMtYnJvd3Nlci1wYW5lLXdpZHRoOjE4Ljc1cmVtOy0tYXJjZ2lzLWJyb3dzZXItcGFuZS16LWluZGV4OjExfTpob3N0KFtoZWlnaHQ9YXV0b10pe2hlaWdodDphdXRvO21pbi1oZWlnaHQ6MTAwJTtmbGV4OjEgMSAxMDAlfS53cmFwcGVye2Rpc3BsYXk6ZmxleDtoZWlnaHQ6MTAwJTtmbGV4LWRpcmVjdGlvbjpjb2x1bW47b3ZlcmZsb3c6aGlkZGVufS53cmFwcGVyLS1maXhlZHtvdmVyZmxvdzpoaWRkZW59LndyYXBwZXItLWF1dG97ZmxleDoxIDEgMTAwJX0ud3JhcHBlci0tZnVsbHt0cmFuc2Zvcm06dHJhbnNsYXRlKDAsIDApfS5wYW5lbHtkaXNwbGF5OmZsZXg7aGVpZ2h0OjEwMCU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO292ZXJmbG93OmhpZGRlbn0udG9wLWJhcntwb3NpdGlvbjpzdGlja3k7dG9wOjBweDtyaWdodDowcHg7bGVmdDowcHg7ei1pbmRleDoyMDtmbGV4LXNocmluazowO2ZsZXgtZ3JvdzowO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYm9yZGVyLTMpfS5zY3JvbGxpbmd7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O21pbi1oZWlnaHQ6MHB4O3dpZHRoOjEwMCU7ZmxleDoxIDEgMCU7ZmxleC1kaXJlY3Rpb246Y29sdW1ufS5zY3JvbGxpbmctLWZ1bGx7b3ZlcmZsb3cteTpzY3JvbGx9LnByZXZpZXctcG9zaXRpb257cG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MHB4O21hcmdpbi1sZWZ0OmF1dG87bWFyZ2luLXJpZ2h0OmF1dG87d2lkdGg6MTAwJTttYXgtd2lkdGg6dmFyKC0tYXJjZ2lzLWJyb3dzZXItbWF4LXdpZHRoKX0ucHJldmlldy1wb3NpdGlvbi0td2l0aC10b3AtYmFye3RvcDozcmVtfS50d28tdXB7bWFyZ2luLWxlZnQ6YXV0bzttYXJnaW4tcmlnaHQ6YXV0bztkaXNwbGF5OmZsZXg7d2lkdGg6MTAwJTtmbGV4OjEgMSBhdXRvO2ZsZXgtZGlyZWN0aW9uOnJvdzttYXgtd2lkdGg6dmFyKC0tYXJjZ2lzLWJyb3dzZXItbWF4LXdpZHRoKX0udHdvLXVwLnNtYWxse21hcmdpbi10b3A6LTFweH0uY29udGVudHtwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmZsZXg7bWluLXdpZHRoOjBweDtmbGV4OjEgMSAwJTtvdmVyZmxvdzpoaWRkZW59LmNvbnRlbnRfX3RvcHtwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmZsZXg7aGVpZ2h0OjEuNXJlbTtmbGV4LWdyb3c6MDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZy10b3A6MS4yNXJlbTtwYWRkaW5nLWJvdHRvbTowLjc1cmVtO2ZvbnQtc2l6ZTowLjg3NXJlbTtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSk7ei1pbmRleDoyfS5jb250ZW50X190b3BfX2VuZHttYXJnaW4taW5saW5lLXN0YXJ0OmF1dG87ZGlzcGxheTpncmlkO2dhcDowLjVyZW07Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOmF1dG8gYXV0b30uYWN0aW9uc3tmbGV4OjEgMSAwJX0uZmlsdGVyLXN0YXR1c3tmbGV4OjEgMSAwJX0uY29udGVudF9fdmlld3ttaW4td2lkdGg6MHB4O2ZsZXg6MSAxIDAlO21hcmdpbi1pbmxpbmUtZW5kOjAuMjVyZW07cGFkZGluZy1pbmxpbmUtZW5kOjFyZW07cGFkZGluZy1pbmxpbmUtc3RhcnQ6MXJlbX0uY29udGVudF9fdmlldy0tcGFkZGVkLWJvdHRvbXtwYWRkaW5nLWJvdHRvbToxcmVtfS5jb250ZW50X192aWV3LS1uby1maWx0ZXJze21hcmdpbi1pbmxpbmUtc3RhcnQ6MC4yNXJlbTtwYWRkaW5nLWlubGluZS1zdGFydDoxcmVtfS5wYW5le3BvaW50ZXItZXZlbnRzOm5vbmU7dmlzaWJpbGl0eTpoaWRkZW47ZGlzcGxheTpmbGV4O2hlaWdodDoxMDAlO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1iYWNrZ3JvdW5kKTtvcGFjaXR5OjA7dHJhbnNpdGlvbi1kdXJhdGlvbjp2YXIoLS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctbWVkaXVtKTt0cmFuc2l0aW9uLXByb3BlcnR5OnRyYW5zZm9ybSwgdmlzaWJpbGl0eSwgb3BhY2l0eTtib3JkZXItbGVmdDoxcHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMyk7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJvcmRlci0zKX0ucGFuZS0tb3Blbntwb2ludGVyLWV2ZW50czphdXRvO3Zpc2liaWxpdHk6dmlzaWJsZTtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZSgwKTtib3gtc2hhZG93OjRweCAwcHggMTZweCAwcHggcmdiYSgwLCAwLCAwLCAwLjA2KX0ucHJldmlld3t3aWR0aDowcHg7ZmxleC1zaHJpbms6MDtmbGV4LWdyb3c6MDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MHB4O2JvdHRvbTowcHg7aW5zZXQtaW5saW5lLXN0YXJ0OjA7dHJhbnNpdGlvbi1kdXJhdGlvbjp2YXIoLS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctbWVkaXVtKTt0cmFuc2l0aW9uLXByb3BlcnR5OndpZHRoO3otaW5kZXg6dmFyKC0tYXJjZ2lzLWJyb3dzZXItcGFuZS16LWluZGV4KX0ucHJldmlldy0tZml4ZWR7cG9zaXRpb246Zml4ZWR9LnByZXZpZXctLWFjdGl2ZXtvdmVyZmxvdzphdXRvO3dpZHRoOnZhcigtLWFyY2dpcy1icm93c2VyLXBhbmUtd2lkdGgpO2JveC1zaGFkb3c6cmdiYSgwLCAwLCAwLCAwLjA2KSA0cHggMHB4IDE2cHggMHB4fS5maWx0ZXItcGFuZWwsLnByZXZpZXctcGFuZWx7cG9zaXRpb246cmVsYXRpdmU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWJhY2tncm91bmQpfS5maWx0ZXItcGFuZWxfX2NvbnRlbnR7cGFkZGluZy1sZWZ0OjFyZW07cGFkZGluZy1yaWdodDoxcmVtO3BhZGRpbmctdG9wOjAuNzVyZW07cGFkZGluZy1ib3R0b206MHB4fS5maWx0ZXItc3RhdHVzLS1tb2JpbGV7d2lkdGg6MTAwJX0uZmlsdGVyLXN0YXR1cy0tYWN0aXZle2Rpc3BsYXk6YmxvY2t9LnNoZWV0e3BvaW50ZXItZXZlbnRzOm5vbmU7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MHB4O3otaW5kZXg6MTEwfS5zaGVldF9fYmFja2dyb3VuZHtwb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowcHg7b3BhY2l0eTowO3RyYW5zaXRpb246YWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQgMHMsIG91dGxpbmUgMHMsIG91dGxpbmUtb2Zmc2V0IDBzO2JhY2tncm91bmQtY29sb3I6cmdiYSgwLCAwLCAwLCAwLjIpfS5zaGVldC0tYWN0aXZlIC5zaGVldF9fYmFja2dyb3VuZHtvcGFjaXR5OjF9LnNoZWV0LS1hY3RpdmV7cG9pbnRlci1ldmVudHM6YXV0bztvcGFjaXR5OjF9LnNoZWV0X19jb250ZW50c3twb3NpdGlvbjphYnNvbHV0ZTtpbnNldDowcHg7b3BhY2l0eTowO3RyYW5zaXRpb246YWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQgMHMsIG91dGxpbmUgMHMsIG91dGxpbmUtb2Zmc2V0IDBzO3RvcDozcmVtO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLCAyNHB4LCAwKX0uc2hlZXQtLWFjdGl2ZSAuc2hlZXRfX2NvbnRlbnRze29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwgMCwgMCl9LmhpZGV7ZGlzcGxheTpub25lfS5hcmlhLWhpZGRlbntoZWlnaHQ6MXB4O3BhZGRpbmc6MDttYXJnaW46LTFweDtvdmVyZmxvdzpoaWRkZW47Y2xpcDpyZWN0KDAsIDAsIDAsIDApO3doaXRlLXNwYWNlOm5vd3JhcDtib3JkZXItd2lkdGg6MDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MHB4O2JvdHRvbTowcHg7d2lkdGg6MHB4O2luc2V0LWlubGluZS1lbmQ6MH0uY29udGVudF9fdmlldy0tZmxleHtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1ufS5jb3ZlcntkaXNwbGF5OmZsZXg7ZmxleDoxIDEgMCU7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO292ZXJmbG93OmF1dG87cGFkZGluZy1ib3R0b206MXJlbTtwYWRkaW5nLXRvcDowLjI1cmVtfS5uby1yZXN1bHRze21hcmdpbi1sZWZ0OmF1dG87bWFyZ2luLXJpZ2h0OmF1dG87bWF4LXdpZHRoOjI4cmVtO3BhZGRpbmctbGVmdDoxLjVyZW07cGFkZGluZy1yaWdodDoxLjVyZW07Zm9udC1zaXplOjAuODc1cmVtO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0yKX0ucmVzdWx0cy13cmFwcGVye2ZsZXg6MSAxIDAlfS5yZXN1bHRzLXdyYXBwZXItLXNwYWNlZHtwYWRkaW5nLXRvcDoxLjVyZW19LmxvYWRlcnstLWNhbGNpdGUtbG9hZGVyLXBhZGRpbmc6MH0uZmlsdGVyc3tib3gtc2l6aW5nOmJvcmRlci1ib3g7d2lkdGg6MTZyZW07ZmxleC1ncm93OjA7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MS41cmVtO3BhZGRpbmctaW5saW5lLWVuZDowcHg7d2lkdGg6dmFyKC0tYXJjZ2lzLWJyb3dzZXItcGFuZS13aWR0aCl9LmZpbHRlcnMtLXN0aWNreXtwb3NpdGlvbjpzdGlja3k7dG9wOjBweDtoZWlnaHQ6MTAwJX0uZmlsdGVyc19fY29udGVudHtvdmVyZmxvdy15OmF1dG87aGVpZ2h0OjEwMCU7cGFkZGluZy10b3A6MS41cmVtO2JveC1zaXppbmc6Ym9yZGVyLWJveDtzY3JvbGxiYXItZ3V0dGVyOnN0YWJsZX0uZmlsdGVycy0tZW1wdHl7ZGlzcGxheTpub25lfS5maWx0ZXJzLS1hY3RpdmV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLCAwLCAwKX0uZmlsdGVyc19fdGl0bGV7bWFyZ2luLWxlZnQ6MHB4O21hcmdpbi1yaWdodDowcHg7bWFyZ2luLWJvdHRvbToxcmVtO21hcmdpbi10b3A6MHB4O3BhZGRpbmctYm90dG9tOjFyZW07cGFkZGluZy10b3A6MHB4O2ZvbnQtc2l6ZTowLjg3NXJlbTtmb250LXdlaWdodDo1MDA7Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci10ZXh0LTEpO3BhZGRpbmctaW5saW5lLXN0YXJ0OjAuNzVyZW07Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMyl9LnJhbmdle2ZvbnQtc2l6ZTowLjg3NXJlbTtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSl9LmNvbnRhaW5lcntkaXNwbGF5OmZsZXg7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWJhY2tncm91bmQpfS5jb250YWluZXJfX2hlYWRlcntkaXNwbGF5OmZsZXg7ZmxleDowIDEgYXV0bztmbGV4LWRpcmVjdGlvbjpyb3c7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMSl9LmNvbnRhaW5lcl9faGVhZGVyX190ZXh0e21hcmdpbjowcHg7ZmxleDoxIDEgMCU7cGFkZGluZy1sZWZ0OjAuNzVyZW07cGFkZGluZy1yaWdodDowLjc1cmVtO3BhZGRpbmctdG9wOi44NzVyZW07cGFkZGluZy1ib3R0b206Ljg3NXJlbTtmb250LXNpemU6MXJlbTtmb250LXdlaWdodDo1MDA7Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci10ZXh0LTIpfS5jb250YWluZXJfX2NvbnRlbnR7ZmxleDoxIDEgMCU7b3ZlcmZsb3c6YXV0b30uY29udGFpbmVyX19mb290ZXJ7Ym94LXNpemluZzpib3JkZXItYm94O3dpZHRoOjEwMCU7ZmxleDowIDEgYXV0bztiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0xKTtwYWRkaW5nOjAuNXJlbX0uc21hbGwgLmZpbHRlcnN7cGFkZGluZzowcHh9LnNtYWxsIC5maWx0ZXJzX19jb250ZW50e3BhZGRpbmctbGVmdDoxcmVtO3BhZGRpbmctcmlnaHQ6MXJlbX0uc21hbGwgLmNvbnRlbnRfX3ZpZXd7cGFkZGluZy1pbmxpbmU6MC41cmVtO21hcmdpbi1pbmxpbmU6MH0uc21hbGwgLmNvbnRlbnRfX3ZpZXctLXBhbmVse3BhZGRpbmctaW5saW5lOjB9QG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjQwcHgpezpob3N0ey0tYXJjZ2lzLWJyb3dzZXItcGFuZS13aWR0aDoxMDAlfX1cIjtcblxuY29uc3QgQXJjZ2lzQnJvd3NlciA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJpYVVwZGF0ZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJpYVVwZGF0ZVwiLCA3KTtcbiAgICAgICAgdGhpcy5oYW5kbGVSZXNpemUgPSAoKSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy51cGRhdGVQcmV2aWV3UG9zaXRpb24pO1xuICAgICAgICB0aGlzLnVwZGF0ZVByZXZpZXdQb3NpdGlvbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZvcm1GYWN0b3IgPT09IFwic21hbGxcIiB8fCB0aGlzLmhlaWdodCAhPT0gXCJhdXRvXCIgfHwgIXRoaXMucHJldmlld0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLnByZXZpZXdDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb25zdCB7IHgsIHksIGhlaWdodCB9ID0gcmVjdDtcbiAgICAgICAgICAgIGNvbnN0IG1heFkgPSBoZWlnaHQgKyB5O1xuICAgICAgICAgICAgdGhpcy5wcmV2aWV3Qm91bmRpbmdCb3ggPSB7XG4gICAgICAgICAgICAgICAgdG9wOiBNYXRoLm1heCh5LCAwKSxcbiAgICAgICAgICAgICAgICBsZWZ0OiB4LFxuICAgICAgICAgICAgICAgIGJvdHRvbTogbWF4WSA+IHdpbmRvdy5pbm5lckhlaWdodCA/IDAgOiB3aW5kb3cuaW5uZXJIZWlnaHQgLSBtYXhZXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnBhbmVsID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByZXZpZXcgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubG9hZGluZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5oaWRlQ29udGVudFRvcCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hbHdheXNTaG93U2VsZWN0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmFsd2F5c1Nob3dDb250ZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlc3BvbnNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnN0b3JlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmFwaSA9IDQ7XG4gICAgICAgIHRoaXMuZm9ybUZhY3RvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZWFyY2hUZXJtID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmhlaWdodCA9IFwiZnVsbFwiO1xuICAgICAgICB0aGlzLnBhZ2VSYW5nZVRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubm9SZXN1bHRzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByZXZpZXdCb3VuZGluZ0JveCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5pbml0aWFsSGlkZSA9IHRydWU7XG4gICAgfVxuICAgIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgICAgICBjb25zdCBsb2NhbGUgPSBhd2FpdCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzKHRoaXMuZWwpO1xuICAgICAgICB0aGlzLmkxOG4gPSBsb2NhbGVbMF07XG4gICAgICAgIG9uUHJldmlld0NoYW5nZSh0aGlzLnN0b3JlLCB0aGlzLnVwZGF0ZVByZXZpZXdQb3NpdGlvbik7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIHRoaXMuaGFuZGxlUmVzaXplKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5oYW5kbGVSZXNpemUpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5oYW5kbGVSZXNpemUpO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCB0aGlzLmhhbmRsZVJlc2l6ZSk7XG4gICAgfVxuICAgIGFzeW5jIHVwZGF0ZVBhZ2Uoc2VhcmNoUmVzcG9uc2UpIHtcbiAgICAgICAgY29uc3QgcmFuZ2VzID0gYXdhaXQgdGhpcy51cGRhdGVQYWdlUmFuZ2Uoc2VhcmNoUmVzcG9uc2UpO1xuICAgICAgICB0aGlzLnBhZ2VSYW5nZVRleHQgPSByYW5nZXNbMF07XG4gICAgICAgIHRoaXMuYXJpYVVwZGF0ZS5lbWl0KHJhbmdlc1sxXSk7XG4gICAgICAgIHRoaXMubm9SZXN1bHRzID0gKHNlYXJjaFJlc3BvbnNlID09PSBudWxsIHx8IHNlYXJjaFJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZWFyY2hSZXNwb25zZS50b3RhbCkgPT09IDA7XG4gICAgICAgIHRoaXMuaW5pdGlhbEhpZGUgPSBmYWxzZTtcbiAgICB9XG4gICAgcmVuZGVyUG9wb3ZlckNvbnRlbnRzKHNob3dGaWx0ZXJzLCBzaG93UHJldmlldywgaXNTaGVldCkge1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBzdHlsZToge1xuICAgICAgICAgICAgICAgIHdpZHRoOiBpc1NoZWV0ID8gXCIxMDAlXCIgOiBgJHt0aGlzLnN0b3JlLnN0YXRlLndpZHRoIHx8IDB9cHhgLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaXNTaGVldCA/IFwiMTAwJVwiIDogYCR7dGhpcy5zdG9yZS5zdGF0ZS5oZWlnaHQgfHwgMH1weGBcbiAgICAgICAgICAgIH0gfSwgaChcImRpdlwiLCB7IGNsYXNzOiB7IGhpZGU6ICFzaG93UHJldmlldywgXCJwcmV2aWV3LXBhbmVsXCI6IHRydWUgfSB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwicHJldmlld1wiIH0pKSwgaChcImRpdlwiLCB7IGNsYXNzOiB7IGhpZGU6ICFzaG93RmlsdGVycywgXCJmaWx0ZXItcGFuZWxcIjogdHJ1ZSB9IH0sIGgoXCJhcnRpY2xlXCIsIHsgY2xhc3M6IFwiY29udGFpbmVyXCIgfSwgaChcImhlYWRlclwiLCB7IGNsYXNzOiBcImNvbnRhaW5lcl9faGVhZGVyXCIgfSwgaChcImgyXCIsIHsgY2xhc3M6IFwiY29udGFpbmVyX19oZWFkZXJfX3RleHRcIiB9LCB0aGlzLmkxOG4uYnJvd3Nlci5maWx0ZXJzKSwgaChcImNhbGNpdGUtYWN0aW9uXCIsIHsgdGV4dDogdGhpcy5pMThuLmJyb3dzZXIuY2xvc2UsIGFwcGVhcmFuY2U6IFwic29saWRcIiwgc2NhbGU6IFwibVwiLCBpY29uOiBcInhcIiwgb25DbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmUuc3RhdGUuZmlsdGVyc0V4cGFuZGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9IH0pKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImNvbnRhaW5lcl9fY29udGVudFwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJjb250YWluZXJfX2NvbnRlbnRfX3Njcm9sbFwiIH0sICh0aGlzLnN0b3JlLnN0YXRlLnBhbmVsIHx8IGlzU2hlZXQpICYmIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZmlsdGVyLWNvbnRhaW5lcl9fY29udGVudFwiLCBrZXk6IFwiZmlsdGVyLWNvbnRhaW5lci1jb250ZW50XCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInNvcnRcIiB9KSkpLCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiZmlsdGVyc1wiIH0pKSksIHRoaXMuZm9ybUZhY3RvciA9PT0gXCJzbWFsbFwiICYmIHRoaXMuaGFzQWN0aXZlRmlsdGVyKHRoaXMuc3RvcmUpICYmIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZmlsdGVyLXN0YXR1cy0tbW9iaWxlIGNvbnRhaW5lcl9fZm9vdGVyXCIgfSwgaChcImFyY2dpcy1icm93c2VyLWZpbHRlci1zdGF0dXNcIiwgeyBjbGFzczogXCJmaWx0ZXItc3RhdHVzXCIsIGZpbHRlcnM6IHRoaXMuc3RvcmUuc3RhdGUuZmlsdGVycyB9KSkpKSkpKTtcbiAgICB9XG4gICAgYXN5bmMgdXBkYXRlUGFnZVJhbmdlKHBhZ2UpIHtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgZW5kLCB0b3RhbCB9ID0gY2FsY3VsYXRlUGFnZUJvdW5kYXJpZXMocGFnZSk7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7IGFwaTogdGhpcy5hcGksIHBsYWNlczogMCwgdHlwZTogXCJkZWNpbWFsXCIgfTtcbiAgICAgICAgY29uc3Qgc3RhcnRTdHJpbmcgPSBhd2FpdCBmb3JtYXROdW1iZXIoc3RhcnQsIG9wdGlvbnMpO1xuICAgICAgICBjb25zdCBlbmRTdHJpbmcgPSBhd2FpdCBmb3JtYXROdW1iZXIoZW5kLCBvcHRpb25zKTtcbiAgICAgICAgY29uc3QgdG90YWxTdHJpbmcgPSAoYXdhaXQgZm9ybWF0TnVtYmVyKHRvdGFsLCBvcHRpb25zKSkgKyAodG90YWwgPj0gMTAwMDAgPyBcIitcIiA6IFwiXCIpO1xuICAgICAgICBpZiAodGhpcy5zdG9yZS5zdGF0ZS5sYW5nID09PSBcImVuXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgYCR7c3RhcnRTdHJpbmd9LSR7ZW5kU3RyaW5nfSBvZiAke3RvdGFsU3RyaW5nfWAsXG4gICAgICAgICAgICAgICAgYCR7c3RhcnRTdHJpbmd9LSR7ZW5kU3RyaW5nfSBvZiAke3RvdGFsU3RyaW5nfSBpdGVtJHt0b3RhbCA9PT0gMSA/IFwiXCIgOiBcInNcIn1gXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB0aGlzLmkxOG4uYnJvd3Nlci5wYWdlUmFuZ2VcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIiR7c3RhcnR9XCIsIHN0YXJ0U3RyaW5nKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiJHtlbmR9XCIsIGVuZFN0cmluZylcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIiR7dG90YWx9XCIsIHRvdGFsU3RyaW5nKSxcbiAgICAgICAgICAgIHRoaXMuaTE4bi5icm93c2VyLnBhZ2VSYW5nZUFyaWFcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIiR7c3RhcnR9XCIsIHN0YXJ0U3RyaW5nKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiJHtlbmR9XCIsIGVuZFN0cmluZylcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIiR7dG90YWx9XCIsIHRvdGFsU3RyaW5nKVxuICAgICAgICBdO1xuICAgIH1cbiAgICByZW5kZXJGbG93KCkge1xuICAgICAgICBjb25zdCB7IGZvcm1GYWN0b3IsIGxvYWRpbmcsIG5vUmVzdWx0cywgcGFuZWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGF1dG9IZWlnaHQgPSB0aGlzLmhlaWdodCA9PT0gXCJhdXRvXCI7XG4gICAgICAgIGNvbnN0IHNob3dTb3J0SW5GaWx0ZXJzID0gdGhpcy5zdG9yZS5zdGF0ZS5wYW5lbCB8fCB0aGlzLnN0b3JlLnN0YXRlLndpZHRoIDwgYnJlYWtwb2ludHMuc207XG4gICAgICAgIGNvbnN0IHNob3dGaWx0ZXJzID0gdGhpcy5zdG9yZS5zdGF0ZS5maWx0ZXJzRXhwYW5kZWQgJiZcbiAgICAgICAgICAgICghdGhpcy5zdG9yZS5zdGF0ZS5maWx0ZXJzRW1wdHkgfHwgKCF0aGlzLnN0b3JlLnN0YXRlLnNvcnRFbXB0eSAmJiBzaG93U29ydEluRmlsdGVycykpO1xuICAgICAgICBjb25zdCBzaG93UHJldmlldyA9ICEhdGhpcy5zdG9yZS5zdGF0ZS5wcmV2aWV3O1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBjbGFzczogXCJwYW5lbFwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogeyBcInRvcC1iYXJcIjogdHJ1ZSwgXCJ0b3AtYmFyLS1zbWFsbFwiOiBmb3JtRmFjdG9yID09PSBcInNtYWxsXCIgfSB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwidG9wLWJhclwiIH0pKSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsaW5nOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwic2Nyb2xsaW5nLS1mdWxsXCI6ICFhdXRvSGVpZ2h0IHx8IHBhbmVsXG4gICAgICAgICAgICB9IH0sIGgoXCJkaXZcIiwgeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIFwidHdvLXVwXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgW2Zvcm1GYWN0b3JdOiB0cnVlXG4gICAgICAgICAgICB9IH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJjb250ZW50XCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImNvbnRlbnQtc3RhcnRcIiB9KSwgbG9hZGluZyAmJiAoaChcImRpdlwiLCB7IGNsYXNzOiBcImNvbnRlbnRfX3ZpZXcgY29udGVudF9fdmlldy0tZmxleFwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJjb3ZlclwiIH0sIGgoXCJjYWxjaXRlLWxvYWRlclwiLCB7IGNsYXNzOiBcImxvYWRlclwiLCBsYWJlbDogXCJcIiB9KSkpKSwgbm9SZXN1bHRzICYmICFsb2FkaW5nICYmIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwiY29udGVudF9fdmlldyBjb250ZW50X192aWV3LS1mbGV4XCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImNvdmVyXCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcIm5vLXJlc3VsdHNcIiB9LCB0aGlzLnJlbmRlck5vUmVzdWx0cygpKSkpKSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgaGlkZTogbG9hZGluZyB8fCBub1Jlc3VsdHMsXG4gICAgICAgICAgICAgICAgY29udGVudF9fdmlldzogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcImNvbnRlbnRfX3ZpZXctLXBhbmVsXCI6ICEhdGhpcy5zdG9yZS5zdGF0ZS5wYW5lbCxcbiAgICAgICAgICAgICAgICBcImNvbnRlbnRfX3ZpZXctLWZsZXhcIjogIWxvYWRpbmcgJiYgIW5vUmVzdWx0c1xuICAgICAgICAgICAgfSB9LCAhdGhpcy5zdG9yZS5zdGF0ZS5wYW5lbCAmJiAhdGhpcy5oaWRlQ29udGVudFRvcCAmJiAoaChcImRpdlwiLCB7IGNsYXNzOiBcImNvbnRlbnRfX3RvcFwiIH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IHsgc2VsZWN0aW9uOiB0cnVlLCBoaWRlOiAhdGhpcy5hbHdheXNTaG93U2VsZWN0aW9uIH0gfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInNlbGVjdGlvblwiIH0pKSwgaChcInNwYW5cIiwgeyBjbGFzczogXCJyYW5nZVwiIH0sIHRoaXMucGFnZVJhbmdlVGV4dCksIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwiYWN0aW9uc1wiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJhY3Rpb25zXCIgfSkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiY29udGVudF9fdG9wX19lbmRcIiB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwidmlld1wiIH0pLCAhc2hvd1NvcnRJbkZpbHRlcnMgJiYgaChcInNsb3RcIiwgeyBuYW1lOiBcInNvcnRcIiB9KSkpKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImZsb3ctY29udGVudFwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJjb250ZW50XCIgfSkpLCBoKFwic2xvdFwiLCB7IG5hbWU6IFwicGFnaW5hdGlvblwiIH0pLCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiY29udGVudC1lbmRcIiB9KSkpKSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInNjcm9sbC1lbmRcIiB9KSksICF0aGlzLnN0b3JlLnN0YXRlLnBhbmVsIHx8IHdpbmRvdy5pbm5lcldpZHRoIDwgdGhpcy5zdG9yZS5zdGF0ZS53aWR0aCAqIDIgPyAoaChcImRpdlwiLCB7IGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgc2hlZXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJzaGVldC0tYWN0aXZlXCI6IHNob3dGaWx0ZXJzIHx8IHNob3dQcmV2aWV3XG4gICAgICAgICAgICB9IH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJzaGVldF9fYmFja2dyb3VuZFwiIH0pLCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwic2hlZXRfX2NvbnRlbnRzXCIgfSwgdGhpcy5yZW5kZXJQb3BvdmVyQ29udGVudHMoc2hvd0ZpbHRlcnMsIHNob3dQcmV2aWV3LCB0cnVlKSkpKSA6IChoKFwiY2FsY2l0ZS1wb3BvdmVyXCIsIHsgb3ZlcmxheVBvc2l0aW9uaW5nOiBcImZpeGVkXCIsIG9wZW46IHNob3dQcmV2aWV3IHx8IHNob3dGaWx0ZXJzLCBsYWJlbDogXCJmaWx0ZXJzXCIsIHJlZmVyZW5jZUVsZW1lbnQ6IHRoaXMuZWwsIG9mZnNldFNraWRkaW5nOiAwLCBvZmZzZXREaXN0YW5jZTogMCwgdHJpZ2dlckRpc2FibGVkOiB0cnVlLCBwb2ludGVyRGlzYWJsZWQ6IHRydWUsIHBsYWNlbWVudDogdGhpcy5zdG9yZS5zdGF0ZS5wYW5lbCA/IFwidHJhaWxpbmdcIiA6IFwiYXV0b1wiLCBvbkNhbGNpdGVQb3BvdmVyT3BlbjogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnN0b3JlLnN0YXRlLnBhbmVsIHx8IHdpbmRvdy5pbm5lcldpZHRoIDwgdGhpcy5zdG9yZS5zdGF0ZS53aWR0aCAqIDIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0LnN0eWxlLnRyYW5zZm9ybSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gfSwgdGhpcy5yZW5kZXJQb3BvdmVyQ29udGVudHMoc2hvd0ZpbHRlcnMsIHNob3dQcmV2aWV3KSkpKSk7XG4gICAgfVxuICAgIGhhc0FjdGl2ZUZpbHRlcihzdG9yZSkge1xuICAgICAgICAvLyBjZXJ0YWluIGZpbHRlcnMgc2hvdWxkIHN0aWxsIHNob3cgZW1wdHkgc3RhdGUsIG5vdCBubyByZXN1bHRzIHN0YXRlXG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKChzdG9yZSA9PT0gbnVsbCB8fCBzdG9yZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RvcmUuc3RhdGUuZmlsdGVycykgfHwge30pXG4gICAgICAgICAgICAuZmlsdGVyKCh7IGlkIH0pID0+ICFJVEVNX0JST1dTRVJfQlVJTFRfSU5fRklMVEVSUy5pbmNsdWRlcyhpZCkpXG4gICAgICAgICAgICAuc29tZSgoZmlsdGVyKSA9PiBmaWx0ZXIudmFsdWUpO1xuICAgIH1cbiAgICByZW5kZXJOb1Jlc3VsdHMoKSB7XG4gICAgICAgIGNvbnN0IHNob3dNZXNzYWdlID0gdGhpcy5ub1Jlc3VsdHMgJiYgIXRoaXMubG9hZGluZztcbiAgICAgICAgY29uc3QgaGFzRmlsdGVycyA9IHRoaXMuaGFzQWN0aXZlRmlsdGVyKHRoaXMuc3RvcmUpIHx8ICEhdGhpcy5zZWFyY2hUZXJtO1xuICAgICAgICBpZiAoIXNob3dNZXNzYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBjbGFzczogeyBjb3ZlcjogdHJ1ZSB9IH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJuby1yZXN1bHRzXCIgfSwgaGFzRmlsdGVycyA/IGgoXCJzbG90XCIsIHsgbmFtZTogXCJuby1yZXN1bHRzXCIgfSkgOiBoKFwic2xvdFwiLCB7IG5hbWU6IFwibm8tY29udGVudFwiIH0pKSkpO1xuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgbG9hZGluZywgbm9SZXN1bHRzLCBmb3JtRmFjdG9yLCBoaWRlQ29udGVudFRvcCwgYWx3YXlzU2hvd0NvbnRlbnQsIHBhbmVsLCBpbml0aWFsSGlkZSB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgYXV0b0hlaWdodCA9IHRoaXMuaGVpZ2h0ID09PSBcImF1dG9cIjtcbiAgICAgICAgY29uc3QgbWF4SGVpZ2h0ID0gYCR7KHRoaXMuc3RvcmUuc3RhdGUuaGVpZ2h0IHx8IHdpbmRvdy5pbm5lckhlaWdodCkgLSA0OH1weGA7XG4gICAgICAgIGNvbnN0IG1heEhlaWdodFN0eWxlID0gdGhpcy5oZWlnaHQgPT09IFwiYXV0b1wiID8ge30gOiB7IG1heEhlaWdodCB9O1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgZm9ybUZhY3RvciA9PT0gXCJzbWFsbFwiID8gKHRoaXMucmVuZGVyRmxvdygpKSA6IChoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICB3cmFwcGVyOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwid3JhcHBlci0tZml4ZWRcIjogdGhpcy5zdG9yZS5zdGF0ZS5maWx0ZXJzRXhwYW5kZWQsXG4gICAgICAgICAgICAgICAgXCJ3cmFwcGVyLS1hdXRvXCI6IGF1dG9IZWlnaHQsXG4gICAgICAgICAgICAgICAgXCJ3cmFwcGVyLS1mdWxsXCI6IHRoaXMuaGVpZ2h0ID09PSBcImZ1bGxcIlxuICAgICAgICAgICAgfSB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwidG9wLWJhclwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJ0b3AtYmFyXCIgfSkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBcInByZXZpZXctcG9zaXRpb25cIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInByZXZpZXctcG9zaXRpb24tLXdpdGgtdG9wLWJhclwiOiAhdGhpcy5zdG9yZS5zdGF0ZS50b3BiYXJFbXB0eVxuICAgICAgICAgICAgfSwgcmVmOiAoZWwpID0+ICh0aGlzLnByZXZpZXdDb250YWluZXIgPSBlbCkgfSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgcHJldmlldzogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInByZXZpZXctLWFjdGl2ZVwiOiAhIXRoaXMuc3RvcmUuc3RhdGUucHJldmlldyxcbiAgICAgICAgICAgICAgICBcInByZXZpZXctLWZpeGVkXCI6IGF1dG9IZWlnaHRcbiAgICAgICAgICAgIH0sIHN0eWxlOiBhdXRvSGVpZ2h0ICYmIHRoaXMucHJldmlld0JvdW5kaW5nQm94XG4gICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgIHRvcDogYCR7dGhpcy5wcmV2aWV3Qm91bmRpbmdCb3gudG9wIHx8IDB9cHhgLFxuICAgICAgICAgICAgICAgICAgICBpbnNldElubGluZVN0YXJ0OiBgJHt0aGlzLnByZXZpZXdCb3VuZGluZ0JveC5sZWZ0IHx8IDB9cHhgLFxuICAgICAgICAgICAgICAgICAgICBib3R0b206IGAke3RoaXMucHJldmlld0JvdW5kaW5nQm94LmJvdHRvbSB8fCAwfXB4YFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA6IHt9IH0sIGgoXCJkaXZcIiwgeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIHBhbmU6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJwYW5lLS1vcGVuXCI6ICEhdGhpcy5zdG9yZS5zdGF0ZS5wcmV2aWV3XG4gICAgICAgICAgICB9IH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJwcmV2aWV3XCIgfSkpKSksIGgoXCJkaXZcIiwgeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIHNjcm9sbGluZzogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInNjcm9sbGluZy0tZnVsbFwiOiAhYXV0b0hlaWdodCB8fCBwYW5lbFxuICAgICAgICAgICAgfSB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBcInR3by11cFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFtmb3JtRmFjdG9yXTogdHJ1ZVxuICAgICAgICAgICAgfSB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJzOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwiZmlsdGVycy0tc3RpY2t5XCI6ICFhdXRvSGVpZ2h0LFxuICAgICAgICAgICAgICAgIFwiZmlsdGVycy0tZW1wdHlcIjogdGhpcy5zdG9yZS5zdGF0ZS5maWx0ZXJzRW1wdHkgJiYgIXRoaXMuc3RvcmUuc3RhdGUucHJldmlldyxcbiAgICAgICAgICAgICAgICBcImZpbHRlcnMtLWFjdGl2ZVwiOiB0aGlzLnN0b3JlLnN0YXRlLmZpbHRlcnNFeHBhbmRlZFxuICAgICAgICAgICAgfSwgc3R5bGU6IG1heEhlaWdodFN0eWxlIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJmaWx0ZXJzX19jb250ZW50XCIsIHN0eWxlOiBtYXhIZWlnaHRTdHlsZSB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiZmlsdGVyc1wiIH0pKSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJjb250ZW50XCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImNvbnRlbnQtc3RhcnRcIiB9KSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgY29udGVudF9fdmlldzogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcImNvbnRlbnRfX3ZpZXctLW5vLWZpbHRlcnNcIjogdGhpcy5zdG9yZS5zdGF0ZS5maWx0ZXJzRW1wdHkgJiYgIXRoaXMuc3RvcmUuc3RhdGUucHJldmlldyxcbiAgICAgICAgICAgICAgICBcImNvbnRlbnRfX3ZpZXctLWZsZXhcIjogdHJ1ZVxuICAgICAgICAgICAgfSB9LCAhaGlkZUNvbnRlbnRUb3AgJiYgKGgoXCJkaXZcIiwgeyBjbGFzczogXCJjb250ZW50X190b3BcIiB9LCBoKFwic3BhblwiLCB7IGNsYXNzOiB7IHNlbGVjdGlvbjogdHJ1ZSwgaGlkZTogIXRoaXMuYWx3YXlzU2hvd1NlbGVjdGlvbiB9IH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJzZWxlY3Rpb25cIiB9KSksIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwicmFuZ2VcIiB9LCB0aGlzLnBhZ2VSYW5nZVRleHQpLCBoKFwic3BhblwiLCB7IGNsYXNzOiBcImFjdGlvbnNcIiB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiYWN0aW9uc1wiIH0pKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImNvbnRlbnRfX3RvcF9fZW5kXCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInZpZXdcIiB9KSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInNvcnRcIiB9KSkpKSwgbG9hZGluZyAmJiAhYWx3YXlzU2hvd0NvbnRlbnQgJiYgKGgoXCJkaXZcIiwgeyBjbGFzczogXCJjb3ZlclwiIH0sIGgoXCJjYWxjaXRlLWxvYWRlclwiLCB7IGNsYXNzOiBcImxvYWRlclwiLCBsYWJlbDogdGhpcy5pMThuLmJyb3dzZXIubG9hZGluZyB9KSkpLCB0aGlzLnJlbmRlck5vUmVzdWx0cygpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBoaWRlOiAobG9hZGluZyAmJiAhYWx3YXlzU2hvd0NvbnRlbnQpIHx8IG5vUmVzdWx0cyB8fCBpbml0aWFsSGlkZSxcbiAgICAgICAgICAgICAgICBcInJlc3VsdHMtd3JhcHBlci0tc3BhY2VkXCI6IGhpZGVDb250ZW50VG9wLFxuICAgICAgICAgICAgICAgIFwicmVzdWx0cy13cmFwcGVyXCI6IHRydWVcbiAgICAgICAgICAgIH0gfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImNvbnRlbnRcIiB9KSksIGgoXCJkaXZcIiwgeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIGhpZGU6IGxvYWRpbmcgfHwgbm9SZXN1bHRzXG4gICAgICAgICAgICB9IH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJwYWdpbmF0aW9uXCIgfSksIGgoXCJzbG90XCIsIHsgbmFtZTogXCJjb250ZW50LWVuZFwiIH0pKSkpKSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInNjcm9sbC1lbmRcIiB9KSkpKSkpO1xuICAgIH1cbiAgICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gICAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICAgICAgXCJyZXNwb25zZVwiOiBbXCJ1cGRhdGVQYWdlXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc0Jyb3dzZXIuc3R5bGUgPSBhcmNnaXNCcm93c2VyQ3NzO1xuXG5jb25zdCBhcmNnaXNCcm93c2VyQWN0aW9uc0NzcyA9IFwiOmhvc3R7cG9zaXRpb246cmVsYXRpdmU7bWFyZ2luLWxlZnQ6MXJlbTttYXJnaW4tcmlnaHQ6MXJlbTtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kfS53cmFwcGVye2Rpc3BsYXk6ZmxleDtwYWRkaW5nLWlubGluZS1zdGFydDowLjI1cmVtO2JvcmRlci1pbmxpbmUtc3RhcnQ6MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYm9yZGVyLTEpO2JvcmRlci1pbmxpbmUtZW5kOjFweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJvcmRlci0xKX0uYnV0dG9ue21hcmdpbi1pbmxpbmUtZW5kOjAuMjVyZW19Lm1lYXN1cmUtY29udGFpbmVye3Bvc2l0aW9uOmFic29sdXRlO2hlaWdodDowcHg7d2lkdGg6MTAwJTtvdmVyZmxvdzpoaWRkZW59Lm1lYXN1cmUtdGV4dHt2aXNpYmlsaXR5OmhpZGRlbjtoZWlnaHQ6MHB4O3dpZHRoOmF1dG87b3ZlcmZsb3c6aGlkZGVuO2ZvbnQtc2l6ZTowLjg3NXJlbX1cIjtcblxuY29uc3QgQXJjZ2lzQnJvd3NlckFjdGlvbnMgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFjdGlvbldpZHRocyA9IFtdO1xuICAgICAgICAvLyBpY29uICsgaW50ZXJuYWwgcGFkZGluZyArIGJ1dHRvbiBwYWRkaW5nICsgbWFyZ2luXG4gICAgICAgIHRoaXMuYnV0dG9uUGFkZGluZyA9IDE2ICsgMTYgKyAxNiArIDI0ICsgMTY7XG4gICAgICAgIHRoaXMuaGFuZGxlUmVzaXplRXZlbnQgPSAoZSkgPT4ge1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMucmVzaXplKGUuZGV0YWlsLndpZHRoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5hY3Rpb25zID0gW107XG4gICAgICAgIHRoaXMuc3RvcmUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnZpc2libGVBY3Rpb25zID0gW107XG4gICAgICAgIHRoaXMub3ZlcmZsb3dBY3Rpb25zID0gW107XG4gICAgfVxuICAgIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgICAgICBjb25zdCBsb2NhbGUgPSBhd2FpdCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzKHRoaXMuZWwsIFwiYXJjZ2lzLWJyb3dzZXJcIik7XG4gICAgICAgIHRoaXMuaTE4biA9IGxvY2FsZVswXS5hY3Rpb25zO1xuICAgICAgICBzZXR1cFJlc2l6ZU9ic2VydmVyKHRoaXMuc3RvcmUpLm9ic2VydmUodGhpcy5lbCk7XG4gICAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc0Jyb3dzZXJSZXNpemVcIiwgdGhpcy5oYW5kbGVSZXNpemVFdmVudCk7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIChfYyA9IChfYiA9IChfYSA9IHRoaXMuc3RvcmUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdGF0ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnJlc2l6ZU9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MudW5vYnNlcnZlKHRoaXMuZWwpO1xuICAgICAgICAoX2QgPSB0aGlzLmVsKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc0Jyb3dzZXJSZXNpemVcIiwgdGhpcy5oYW5kbGVSZXNpemVFdmVudCk7XG4gICAgfVxuICAgIHJlc2l6ZSh3aWR0aCkge1xuICAgICAgICB0aGlzLmVsZW1lbnRXaWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZU92ZXJmbG93KCk7XG4gICAgfVxuICAgIGFjdGlvblVwZGF0ZUhhbmRsZXIobmV3QWN0aW9ucykge1xuICAgICAgICB0aGlzLmFjdGlvbldpZHRocyA9IG5ld0FjdGlvbnMgPT09IG51bGwgfHwgbmV3QWN0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmV3QWN0aW9ucy5tYXAoKGFjdGlvbikgPT4ge1xuICAgICAgICAgICAgLy8gYWRkIHdpZHRoIG9mIGFjdGlvbiB0byB0aGUgd2lkdGhcbiAgICAgICAgICAgIHRoaXMubWVhc3VyZVRleHQudGV4dENvbnRlbnQgPSBhY3Rpb24udGV4dDtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLm1lYXN1cmVUZXh0Lm9mZnNldFdpZHRoICsgdGhpcy5idXR0b25QYWRkaW5nXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVPdmVyZmxvdygpO1xuICAgIH1cbiAgICBhc3luYyBjYWxjdWxhdGVPdmVyZmxvdygpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB0aGlzLm1lYXN1cmVUZXh0LnRleHRDb250ZW50ID0gdGhpcy5pMThuLm1vcmU7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IChfYSA9IHRoaXMuYWN0aW9uV2lkdGhzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVkdWNlKCh7IHdpZHRoLCB2aXNpYmxlLCBvdmVyZmxvdyB9LCB7IGFjdGlvbiwgd2lkdGg6IGFjdGlvbldpZHRoIH0pID0+IHtcbiAgICAgICAgICAgIHdpZHRoICs9IGFjdGlvbldpZHRoO1xuICAgICAgICAgICAgaWYgKHdpZHRoID49IHRoaXMuZWxlbWVudFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgd2lkdGgsIHZpc2libGUsIG92ZXJmbG93OiBbLi4ub3ZlcmZsb3csIGFjdGlvbl0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7IHdpZHRoLCB2aXNpYmxlOiBbLi4udmlzaWJsZSwgYWN0aW9uXSwgb3ZlcmZsb3cgfTtcbiAgICAgICAgfSwgeyB2aXNpYmxlOiBbXSwgb3ZlcmZsb3c6IFtdLCB3aWR0aDogdGhpcy5tb3JlV2lkdGggfSk7XG4gICAgICAgIHRoaXMudmlzaWJsZUFjdGlvbnMgPSByZXN1bHQudmlzaWJsZTtcbiAgICAgICAgdGhpcy5vdmVyZmxvd0FjdGlvbnMgPSByZXN1bHQub3ZlcmZsb3c7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyB2aXNpYmxlQWN0aW9ucywgb3ZlcmZsb3dBY3Rpb25zLCBzZWxlY3Rpb24sIGkxOG4gfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGhhc092ZXJmbG93ID0gKG92ZXJmbG93QWN0aW9ucyA9PT0gbnVsbCB8fCBvdmVyZmxvd0FjdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG92ZXJmbG93QWN0aW9ucy5sZW5ndGgpID4gMDtcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwibWVhc3VyZS1jb250YWluZXJcIiB9LCBoKFwic3BhblwiLCB7IGNsYXNzOiBcIm1lYXN1cmUtdGV4dFwiLCBcImFyaWEtaGlkZGVuXCI6IHRydWUsIHJlZjogKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZWFzdXJlVGV4dCA9IGVsO1xuICAgICAgICAgICAgICAgIC8vIHRoZSBmaXJzdCB0aW1lIHdlIGhhdmUgYWNjZXNzIHRvIHRoaXMgbm9kZSBhbmQgaTE4biwgY2FsY3VsYXRlIGhvdyB3aWRlIHRoZSBtb3JlIGJ1dHRvbiB3aWxsIGJlXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1vcmVXaWR0aCAmJiBpMThuKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gaTE4bi5tb3JlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vcmVXaWR0aCA9IGVsLnNjcm9sbFdpZHRoICsgdGhpcy5idXR0b25QYWRkaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gfSkpLCAoc2VsZWN0aW9uID09PSBudWxsIHx8IHNlbGVjdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogc2VsZWN0aW9uLmxlbmd0aCkgPiAwICYmICgodmlzaWJsZUFjdGlvbnMgPT09IG51bGwgfHwgdmlzaWJsZUFjdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZpc2libGVBY3Rpb25zLmxlbmd0aCkgPiAwIHx8IGhhc092ZXJmbG93KSAmJiAoaChcIm5hdlwiLCB7IGNsYXNzOiBcIndyYXBwZXJcIiB9LCB2aXNpYmxlQWN0aW9ucy5tYXAoKHsgdGV4dCwgaWNvbiwgb25DbGljaywgaWQgfSkgPT4gKGgoXCJjYWxjaXRlLWJ1dHRvblwiLCB7IGtleTogaWQgIT09IG51bGwgJiYgaWQgIT09IHZvaWQgMCA/IGlkIDogYCR7dGV4dH0tJHtpY29ufWAsIGNsYXNzOiBcImJ1dHRvblwiLCBcImljb24tc3RhcnRcIjogaWNvbiwgb25DbGljazogKCkgPT4gb25DbGljaygpLCBhcHBlYXJhbmNlOiBcInRyYW5zcGFyZW50XCIsIGtpbmQ6IFwibmV1dHJhbFwiIH0sIHRleHQpKSksIGhhc092ZXJmbG93ICYmIChoKFwiY2FsY2l0ZS1kcm9wZG93blwiLCB7IHdpZHRoU2NhbGU6IFwibVwiLCBwbGFjZW1lbnQ6IFwiYm90dG9tLWVuZFwiIH0sIGgoXCJjYWxjaXRlLWJ1dHRvblwiLCB7IHNsb3Q6IFwidHJpZ2dlclwiLCBraW5kOiBcIm5ldXRyYWxcIiwgaWNvbkVuZDogXCJjaGV2cm9uLWRvd25cIiwgYXBwZWFyYW5jZTogXCJ0cmFuc3BhcmVudFwiIH0sIGkxOG4ubW9yZSksIGgoXCJjYWxjaXRlLWRyb3Bkb3duLWdyb3VwXCIsIHsgc2VsZWN0aW9uTW9kZTogXCJub25lXCIgfSwgb3ZlcmZsb3dBY3Rpb25zLm1hcCgoYWN0aW9uKSA9PiAoaChcImNhbGNpdGUtZHJvcGRvd24taXRlbVwiLCB7IGljb25TdGFydDogYWN0aW9uLmljb24sIG9uQ2FsY2l0ZURyb3Bkb3duSXRlbVNlbGVjdDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFjdGlvbi5vbkNsaWNrKCk7XG4gICAgICAgICAgICB9IH0sIGFjdGlvbi50ZXh0KSkpKSkpKSkpKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxuICAgIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgICAgIFwiYWN0aW9uc1wiOiBbXCJhY3Rpb25VcGRhdGVIYW5kbGVyXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc0Jyb3dzZXJBY3Rpb25zLnN0eWxlID0gYXJjZ2lzQnJvd3NlckFjdGlvbnNDc3M7XG5cbmNvbnN0IEFyY2dpc0Jyb3dzZXJGaWx0ZXIgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFyY2dpc0Jyb3dzZXJGaWx0ZXJSZW1vdmUgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc0Jyb3dzZXJGaWx0ZXJSZW1vdmVcIiwgNyk7XG4gICAgICAgIHRoaXMuZXhwYW5kZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuaGVhZGluZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubm9QYWRkaW5nID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNsZWFyRGlzYWJsZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZmlsdGVySUQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgICAgICBjb25zdCBsb2NhbGUgPSBhd2FpdCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzKHRoaXMuZWwsIFwiYXJjZ2lzLWJyb3dzZXJcIik7XG4gICAgICAgIHRoaXMuaTE4biA9IGxvY2FsZVswXS5maWx0ZXI7XG4gICAgfVxuICAgIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgICAgIGlmICh0aGlzLmFjY29yZGlvbkl0ZW0pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmV4cGFuZGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY2NvcmRpb25JdGVtLmV4cGFuZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLmFjY29yZGlvbkl0ZW0uc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRlbnRcIik7XG4gICAgICAgICAgICBpZiAoY29udGVudCAmJiB0aGlzLm5vUGFkZGluZykge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUucGFkZGluZyA9IFwiMFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbXBvbmVudERpZFJlbmRlcigpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgY29uc3QgaWNvbiA9IChfYiA9IChfYSA9IHRoaXMuYWNjb3JkaW9uSXRlbSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNoYWRvd1Jvb3QpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5xdWVyeVNlbGVjdG9yKFwiLmljb24tcG9zaXRpb24tLWVuZFwiKTtcbiAgICAgICAgaWYgKGljb24pIHtcbiAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LnJlbW92ZShcImljb24tcG9zaXRpb24tLWVuZFwiKTtcbiAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LmFkZChcImljb24tcG9zaXRpb24tLXN0YXJ0XCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBhY3RpdmUsIGNsZWFyRGlzYWJsZWQsIGhlYWRpbmcsIGkxOG4gfSA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoaChcImRpdlwiLCB7IHN0eWxlOiB7IHBvc2l0aW9uOiBcInJlbGF0aXZlXCIgfSB9LCBoKFwiY2FsY2l0ZS1hY2NvcmRpb24taXRlbVwiLCB7IGhlYWRpbmc6IGhlYWRpbmcsIHJlZjogKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY2NvcmRpb25JdGVtID0gZWw7XG4gICAgICAgICAgICAgICAgZWwuaWNvblBvc2l0aW9uID0gXCJzdGFydFwiO1xuICAgICAgICAgICAgICAgIGVsLmljb25UeXBlID0gXCJjaGV2cm9uXCI7XG4gICAgICAgICAgICB9LCBleHBhbmRlZDogdGhpcy5leHBhbmRlZCxcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIG9uQ2FsY2l0ZUludGVybmFsQWNjb3JkaW9uSXRlbVNlbGVjdDogKGUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4cGFuZGVkID0gIXRoaXMuZXhwYW5kZWQ7XG4gICAgICAgICAgICB9LCBzdHlsZToge1xuICAgICAgICAgICAgICAgIFwiLS1jYWxjaXRlLWFjY29yZGlvbi1pdGVtLWJhY2tncm91bmRcIjogXCJ2YXIoLS1jYWxjaXRlLWNvbG9yLWJhY2tncm91bmQpXCIsXG4gICAgICAgICAgICAgICAgXCItLWNhbGNpdGUtYWNjb3JkaW9uLWl0ZW0taWNvbi1zcGFjaW5nLXN0YXJ0XCI6IFwiMFwiLFxuICAgICAgICAgICAgICAgIFwiLS1jYWxjaXRlLWFjY29yZGlvbi1pdGVtLWljb24tc3BhY2luZy1lbmRcIjogXCIuNXJlbVwiLFxuICAgICAgICAgICAgICAgIFwiLS1jYWxjaXRlLWFjY29yZGlvbi1pdGVtLXBhZGRpbmdcIjogXCIuNzVyZW0gLjVyZW1cIixcbiAgICAgICAgICAgICAgICBcIi0tY2FsY2l0ZS1hY2NvcmRpb24taWNvbi1tYXJnaW5cIjogXCIuNXJlbVwiLFxuICAgICAgICAgICAgICAgIGJvcmRlclRvcDogXCIxcHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMSlcIlxuICAgICAgICAgICAgfSB9LCBoKFwiZGl2XCIsIHsgc2xvdDogXCJhY3Rpb25zLWVuZFwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJhY3Rpb25cIiB9KSwgYWN0aXZlICYmICFjbGVhckRpc2FibGVkICYmIChoKFwiY2FsY2l0ZS1idXR0b25cIiwgeyBraW5kOiBcIm5ldXRyYWxcIiwgYXBwZWFyYW5jZTogXCJ0cmFuc3BhcmVudFwiLCBvbkNsaWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyRmlsdGVyUmVtb3ZlLmVtaXQodGhpcy5maWx0ZXJJRCk7XG4gICAgICAgICAgICB9IH0sIGkxOG4uY2xlYXIpKSksIGgoXCJkaXZcIiwgeyBzdHlsZTogeyBtYXJnaW46IHRoaXMubm9QYWRkaW5nID8gXCIwXCIgOiBcIjAgLjc1cmVtXCIgfSB9LCBoKFwic2xvdFwiLCBudWxsKSkpKSk7XG4gICAgfVxuICAgIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5cbmNvbnN0IERBWSA9IDEwMDAgKiA2MCAqIDYwICogMjQ7XG5mdW5jdGlvbiBnZXRTdGFydE9mRGF5KGRhdGUpIHtcbiAgICBjb25zdCB0cyA9IChkYXRlIHx8IG5ldyBEYXRlKCkpLnZhbHVlT2YoKTtcbiAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKHRzKTtcbiAgICBzdGFydC5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgICByZXR1cm4gc3RhcnQudmFsdWVPZigpO1xufVxuXG5jb25zdCBBcmNnaXNCcm93c2VyRmlsdGVyRGF0ZSA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzQnJvd3NlckZpbHRlciA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzQnJvd3NlckZpbHRlclwiLCA3KTtcbiAgICAgICAgdGhpcy50b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHRoaXMucmVzZXREYXRlUGlja2VyID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yYW5nZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuZW5kID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZW5kZXJSYW5nZSA9IChrZXkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgaTE4biwgcmFuZ2UgfSA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLXRyZWUtaXRlbVwiLCB7IFwiZGF0YS1yYW5nZVwiOiBrZXksIHNlbGVjdGVkOiBrZXkgPT09IHJhbmdlIH0sIGkxOG5ba2V5XSkpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnByb3BlcnR5ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNlcnZlclByb3BlcnR5ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJhbmdlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnN0YXJ0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmVuZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zdG9yZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5leHBhbmRlZCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsZSA9IGF3YWl0IGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3ModGhpcy5lbCwgXCJhcmNnaXMtYnJvd3NlclwiKTtcbiAgICAgICAgdGhpcy5pMThuID0gbG9jYWxlWzBdLmZpbHRlckRhdGU7XG4gICAgfVxuICAgIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgICAgIGlmICh0aGlzLnJhbmdlICYmICh0aGlzLnJhbmdlICE9PSBcImN1c3RvbVwiIHx8ICh0aGlzLnN0YXJ0ICYmIHRoaXMuZW5kKSkpIHtcbiAgICAgICAgICAgIHRoaXMuYXJjZ2lzQnJvd3NlckZpbHRlci5lbWl0KHRoaXMuZ2V0RXZlbnREZXRhaWwoKSk7XG4gICAgICAgIH1cbiAgICAgICAgb25Ccm93c2VyRmlsdGVyUmVtb3ZlKHRoaXMucHJvcGVydHksIHRoaXMuc3RvcmUsICgpID0+IHRoaXMucmVzZXREYXRlUGlja2VyKCkpO1xuICAgIH1cbiAgICBnZXRWYWx1ZSgpIHtcbiAgICAgICAgY29uc3QgeyByYW5nZSwgc3RhcnQsIGVuZCB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qgc3RhcnRPZkRheSA9IGdldFN0YXJ0T2ZEYXkoKTtcbiAgICAgICAgY29uc3QgZW5kT2ZEYXkgPSBzdGFydE9mRGF5ICsgREFZIC0gMTtcbiAgICAgICAgc3dpdGNoIChyYW5nZSkge1xuICAgICAgICAgICAgY2FzZSBcInllc3RlcmRheVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBbc3RhcnRPZkRheSAtIERBWSwgc3RhcnRPZkRheSAtIDFdO1xuICAgICAgICAgICAgY2FzZSBcInRvZGF5XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtzdGFydE9mRGF5LCBlbmRPZkRheV07XG4gICAgICAgICAgICBjYXNlIFwibGFzdDdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gW3N0YXJ0T2ZEYXkgLSBEQVkgKiA3LCBlbmRPZkRheV07XG4gICAgICAgICAgICBjYXNlIFwibGFzdDMwXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtzdGFydE9mRGF5IC0gREFZICogMzAsIGVuZE9mRGF5XTtcbiAgICAgICAgICAgIGNhc2UgXCJjdXN0b21cIjpcbiAgICAgICAgICAgICAgICBjb25zdCBjdXN0b21TdGFydCA9IGdldFN0YXJ0T2ZEYXkoc3RhcnQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1c3RvbUVuZCA9IGdldFN0YXJ0T2ZEYXkoZW5kKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gW2N1c3RvbVN0YXJ0LCBjdXN0b21FbmQgKyBEQVkgLSAxXTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0RXZlbnREZXRhaWwoKSB7XG4gICAgICAgIGNvbnN0IHsgcHJvcGVydHksIHJhbmdlLCBpMThuLCBzZXJ2ZXJQcm9wZXJ0eSB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldFZhbHVlKCk7XG4gICAgICAgIGNvbnN0IHNlcnZlclByb3AgPSBzZXJ2ZXJQcm9wZXJ0eSAhPT0gbnVsbCAmJiBzZXJ2ZXJQcm9wZXJ0eSAhPT0gdm9pZCAwID8gc2VydmVyUHJvcGVydHkgOiAocHJvcGVydHkgPT09IFwibW9kaWZpZWRcIiA/IHByb3BlcnR5IDogXCJ1cGxvYWRlZFwiKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBwcm9wZXJ0eSxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSA/IGAoJHtzZXJ2ZXJQcm9wfTpbJHt2YWx1ZVswXX0gVE8gJHt2YWx1ZVsxXX1dKWAgOiBcIlwiLFxuICAgICAgICAgICAgcmFuZ2UsXG4gICAgICAgICAgICBzdGFydDogKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWx1ZVswXSkgJiYgbmV3IERhdGUodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbHVlWzBdKSxcbiAgICAgICAgICAgIGVuZDogKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWx1ZVsxXSkgJiYgbmV3IERhdGUodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbHVlWzFdKSxcbiAgICAgICAgICAgIGxhYmVsOiB0aGlzLmkxOG5bcHJvcGVydHldLnJlcGxhY2UoXCIke2RhdGV9XCIsIGkxOG5bcmFuZ2VdKVxuICAgICAgICB9O1xuICAgIH1cbiAgICBpc0FjdGl2ZSgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5yYW5nZSAmJiAodGhpcy5yYW5nZSAhPT0gXCJjdXN0b21cIiB8fCAhISh0aGlzLnN0YXJ0ICYmIHRoaXMuZW5kKSk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBpMThuLCBwcm9wZXJ0eSwgcmFuZ2UsIHN0YXJ0LCBlbmQgfSA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoaChcImFyY2dpcy1icm93c2VyLWZpbHRlclwiLCB7IGhlYWRpbmc6IGkxOG4udGl0bGVbcHJvcGVydHldLCBleHBhbmRlZDogdGhpcy5leHBhbmRlZCwgYWN0aXZlOiB0aGlzLmlzQWN0aXZlKCksIGZpbHRlcklEOiB0aGlzLnByb3BlcnR5LCBvbkFyY2dpc0Jyb3dzZXJGaWx0ZXJSZW1vdmU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0RGF0ZVBpY2tlcigpO1xuICAgICAgICAgICAgfSB9LCBoKFwiY2FsY2l0ZS10cmVlXCIsIHsgc2VsZWN0aW9uTW9kZTogXCJjaGlsZHJlblwiLCBzY2FsZTogXCJtXCIsIG9uQ2FsY2l0ZVRyZWVTZWxlY3Q6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgICAgICAgICBjb25zdCByYW5nZSA9IChfYiA9IChfYSA9IG5vZGUuc2VsZWN0ZWRJdGVtcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hWzBdKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZGF0YXNldC5yYW5nZTtcbiAgICAgICAgICAgICAgICB0aGlzLnJhbmdlID0gdGhpcy5yYW5nZSA9PT0gcmFuZ2UgPyBudWxsIDogcmFuZ2U7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmFuZ2UgPT09IFwiY3VzdG9tXCIgJiYgISh0aGlzLnN0YXJ0ICYmIHRoaXMuZW5kKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzQnJvd3NlckZpbHRlci5lbWl0KHRoaXMuZ2V0RXZlbnREZXRhaWwoKSk7XG4gICAgICAgICAgICB9IH0sIFtcInRvZGF5XCIsIFwieWVzdGVyZGF5XCIsIFwibGFzdDdcIiwgXCJsYXN0MzBcIiwgXCJjdXN0b21cIl0ubWFwKHRoaXMucmVuZGVyUmFuZ2UpKSwgcmFuZ2UgPT09IFwiY3VzdG9tXCIgJiYgKGgoXCJkaXZcIiwgbnVsbCwgaChcImNhbGNpdGUtZGF0ZS1waWNrZXJcIiwgeyBvbkNhbGNpdGVEYXRlUGlja2VyUmFuZ2VDaGFuZ2U6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBldmVudC50YXJnZXQ7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gbm9kZS52YWx1ZUFzRGF0ZVswXTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmREYXRlID0gbm9kZS52YWx1ZUFzRGF0ZVsxXTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnREYXRlICYmIGVuZERhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydCA9IHN0YXJ0RGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmQgPSBlbmREYXRlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc0Jyb3dzZXJGaWx0ZXIuZW1pdCh0aGlzLmdldEV2ZW50RGV0YWlsKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHNjYWxlOiBcInNcIiwgdmFsdWVBc0RhdGU6IFtzdGFydCwgZW5kXSwgbWF4QXNEYXRlOiB0aGlzLnRvZGF5LCByYW5nZTogdHJ1ZSwgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICBtYXJnaW5Ub3A6IFwiLjVyZW1cIixcbiAgICAgICAgICAgICAgICBtYXJnaW5Cb3R0b206IFwiLjVyZW1cIixcbiAgICAgICAgICAgICAgICBtYXJnaW5JbmxpbmVTdGFydDogXCIycmVtXCIsXG4gICAgICAgICAgICAgICAgd2lkdGg6IFwiMTIuNzVyZW1cIlxuICAgICAgICAgICAgfSB9KSkpKSk7XG4gICAgfVxuICAgIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5cbmNvbnN0IGFyY2dpc0Jyb3dzZXJGaWx0ZXJTdGF0dXNDc3MgPSBcIjpob3N0e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXJ9Y2FsY2l0ZS1jaGlwe21heC13aWR0aDoxMDAlOy0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTI6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTEpfS5maWx0ZXJze21hcmdpbi1pbmxpbmUtZW5kOjAuMjVyZW07bWFyZ2luLWlubGluZS1zdGFydDoxcmVtfS5saW5rey0tY2FsY2l0ZS1mb250LXNpemUtLTI6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTEpOy0tY2FsY2l0ZS1jb2xvci1icmFuZDp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtbGluayl9LnBvcG92ZXItY29udGVudHttYXgtd2lkdGg6MjhyZW07cGFkZGluZzowLjc1cmVtfS5jbGVhci1idXR0b257bWFyZ2luLWlubGluZS1zdGFydDowLjI1cmVtfVwiO1xuXG5jb25zdCBBcmNnaXNCcm93c2VyRmlsdGVyU3RhdHVzID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyRmlsdGVyQ2xlYXIgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc0Jyb3dzZXJGaWx0ZXJDbGVhclwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyRmlsdGVyUmVtb3ZlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNCcm93c2VyRmlsdGVyUmVtb3ZlXCIsIDcpO1xuICAgICAgICB0aGlzLnJlbmRlckNoaXAgPSAoZmlsdGVyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWNoaXBcIiwgeyBzY2FsZTogXCJzXCIsIHZhbHVlOiBmaWx0ZXIuaWQsIGtleTogZmlsdGVyLmlkLCBjbG9zYWJsZTogdHJ1ZSwgYXBwZWFyYW5jZTogXCJvdXRsaW5lXCIsIG9uQ2FsY2l0ZUNoaXBDbG9zZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc0Jyb3dzZXJGaWx0ZXJSZW1vdmUuZW1pdChmaWx0ZXIuaWQpO1xuICAgICAgICAgICAgICAgIH0gfSwgZmlsdGVyLmxhYmVsKSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmlsdGVycyA9IHt9O1xuICAgICAgICB0aGlzLmhpZGRlbkZpbHRlcklkcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb21wb25lbnRXaWR0aCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5icm93c2VyV2lkdGggPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucG9wb3Zlck9wZW4gPSBmYWxzZTtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsZSA9IGF3YWl0IGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3ModGhpcy5lbCwgXCJhcmNnaXMtYnJvd3NlclwiKTtcbiAgICAgICAgdGhpcy5pMThuID0gbG9jYWxlWzBdLmZpbHRlclN0YXR1cztcbiAgICB9XG4gICAgZ2V0VmFsaWRGaWx0ZXJzKCkge1xuICAgICAgICBjb25zdCB2YWxpZEZpbHRlcnMgPSBPYmplY3QudmFsdWVzKHRoaXMuZmlsdGVycykuZmlsdGVyKChmaWx0ZXIpID0+IHtcbiAgICAgICAgICAgIC8vIGNlcnRhaW4gZmlsdGVycyBzaG91bGQgbm90IGFwcGVhciBpbiB0aGUgbGlzdCBvZiBmaWx0ZXIgY2hpcHNcbiAgICAgICAgICAgIGlmIChJVEVNX0JST1dTRVJfQlVJTFRfSU5fRklMVEVSUy5pbmNsdWRlcyhmaWx0ZXIuaWQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChmaWx0ZXIgPT09IG51bGwgfHwgZmlsdGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmaWx0ZXIudmFsdWUpICYmIChmaWx0ZXIgPT09IG51bGwgfHwgZmlsdGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmaWx0ZXIubGFiZWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgeyBjb21wb25lbnRXaWR0aCwgYnJvd3NlcldpZHRoIH0gPSB0aGlzO1xuICAgICAgICByZXR1cm4gdmFsaWRGaWx0ZXJzLnJlZHVjZSgoYWNjLCBmaWx0ZXIpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIC8vIHRoaXMgaXMganVzdCBhIGhldXJpc3RpYyB0byBkZXRlcm1pbmUgY2hpcCB3aWR0aCB3aXRob3V0IGhhdmluZyB0byB1c2UgZ2V0Q2xpZW50UmVjdCgpIHdoaWNoIHdvdWxkIGJlIHZlcnkgc2xvd1xuICAgICAgICAgICAgLy8gbnVtYmVyIG9mIGNoYXJzICogYXZlcmFnZSBjaGFyIHdpZHRoIHBsdXMgY2hpcCBwYWRkaW5nXG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9ICgoKF9hID0gZmlsdGVyLmxhYmVsKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubGVuZ3RoKSB8fCAwKSAqIDggKyAzMjtcbiAgICAgICAgICAgIGFjYy5sZW5ndGggKz0gd2lkdGg7XG4gICAgICAgICAgICBpZiAoIWNvbXBvbmVudFdpZHRoIHx8IGJyb3dzZXJXaWR0aCA8IGJyZWFrcG9pbnRzLnNtIHx8IGNvbXBvbmVudFdpZHRoIC0gYWNjLmxlbmd0aCA+IDE4MCkge1xuICAgICAgICAgICAgICAgIGFjYy5pbkJvdW5kcy5wdXNoKGZpbHRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhY2Mub3V0T2ZCb3VuZHMucHVzaChmaWx0ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwgeyBsZW5ndGg6IDAsIGluQm91bmRzOiBbXSwgb3V0T2ZCb3VuZHM6IFtdIH0pO1xuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgaW5Cb3VuZHMsIG91dE9mQm91bmRzIH0gPSB0aGlzLmdldFZhbGlkRmlsdGVycygpO1xuICAgICAgICBjb25zdCBoYXNPdmVyZmxvdyA9ICEhKG91dE9mQm91bmRzID09PSBudWxsIHx8IG91dE9mQm91bmRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvdXRPZkJvdW5kcy5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgKGluQm91bmRzLmxlbmd0aCA+IDAgfHwgaGFzT3ZlcmZsb3cpICYmIChoKFwiY2FsY2l0ZS1jaGlwLWdyb3VwXCIsIHsgbGFiZWw6IHRoaXMuaTE4bi5maWx0ZXJzLCBzY2FsZTogXCJzXCIgfSwgaW5Cb3VuZHMubWFwKHRoaXMucmVuZGVyQ2hpcCksIGhhc092ZXJmbG93ICYmIChoKFwiY2FsY2l0ZS1idXR0b25cIiwgeyBpZDogXCJwb3BvdmVyLWJ1dHRvblwiLCByb3VuZDogdHJ1ZSwga2luZDogXCJuZXV0cmFsXCIsIGFwcGVhcmFuY2U6IFwib3V0bGluZVwiLCBzY2FsZTogXCJzXCIgfSwgXCIrIFwiLCBvdXRPZkJvdW5kcy5sZW5ndGgpKSkpLCBoYXNPdmVyZmxvdyAmJiBbXG4gICAgICAgICAgICBoKFwiY2FsY2l0ZS1wb3BvdmVyXCIsIHsgbGFiZWw6IHRoaXMuaTE4bi5hZGRpdGlvbmFsLCByZWZlcmVuY2VFbGVtZW50OiBcInBvcG92ZXItYnV0dG9uXCIsIHBsYWNlbWVudDogXCJib3R0b20tZW5kXCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcInBvcG92ZXItY29udGVudFwiIH0sIGgoXCJjYWxjaXRlLWNoaXAtZ3JvdXBcIiwgeyBsYWJlbDogdGhpcy5pMThuLmFkZGl0aW9uYWwsIHNjYWxlOiBcInNcIiB9LCBvdXRPZkJvdW5kcy5tYXAodGhpcy5yZW5kZXJDaGlwKSkpKVxuICAgICAgICBdLCBvdXRPZkJvdW5kcy5sZW5ndGggKyBpbkJvdW5kcy5sZW5ndGggPiAxICYmIChoKFwiY2FsY2l0ZS1idXR0b25cIiwgeyBjbGFzczogXCJjbGVhci1idXR0b25cIiwgc2NhbGU6IFwic1wiLCBhcHBlYXJhbmNlOiBcInRyYW5zcGFyZW50XCIsIGtpbmQ6IFwiYnJhbmRcIiwgb25DbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzQnJvd3NlckZpbHRlckNsZWFyLmVtaXQoKTtcbiAgICAgICAgICAgIH0gfSwgdGhpcy5pMThuLmNsZWFyQWxsRmlsdGVycykpKSk7XG4gICAgfVxuICAgIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5BcmNnaXNCcm93c2VyRmlsdGVyU3RhdHVzLnN0eWxlID0gYXJjZ2lzQnJvd3NlckZpbHRlclN0YXR1c0NzcztcblxuY29uc3QgQXJjZ2lzSXRlbUJyb3dzZXJGaWx0ZXJzID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy5zdG9yZSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBjb25zdCBhZGRQYWRkaW5nID0gKChfYSA9IHRoaXMuc3RvcmUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdGF0ZS5wYW5lbCkgfHwgKChfYiA9IHRoaXMuc3RvcmUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zdGF0ZS53aWR0aCkgPCBicmVha3BvaW50cy5zbTtcbiAgICAgICAgcmV0dXJuIChoKFwiZGl2XCIsIG51bGwsIGgoXCJkaXZcIiwgeyBzdHlsZTogeyBwYWRkaW5nOiBhZGRQYWRkaW5nID8gXCIwIDFyZW0gMXJlbVwiIDogXCIwXCIgfSB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwidG9wXCIgfSkpLCBoKFwiY2FsY2l0ZS1hY2NvcmRpb25cIiwgeyBhcHBlYXJhbmNlOiBcInRyYW5zcGFyZW50XCIsIGljb25UeXBlOiBcImNoZXZyb25cIiwgc2NhbGU6IFwibVwiLCBcImljb24tcG9zaXRpb25cIjogXCJzdGFydFwiLCByZWY6IChlbCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmUuc3RhdGUuZmlsdGVyRWxlbWVudCA9IGVsO1xuICAgICAgICAgICAgfSB9LCBoKFwic2xvdFwiLCBudWxsKSksIGgoXCJzbG90XCIsIHsgbmFtZTogXCJib3R0b21cIiB9KSkpO1xuICAgIH1cbiAgICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG59O1xuXG5jb25zdCBhcmNnaXNCcm93c2VyUGFnaW5hdGlvbkNzcyA9IFwiLndyYXBwZXJ7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7cGFkZGluZy1sZWZ0OjAuNXJlbTtwYWRkaW5nLXJpZ2h0OjAuNXJlbTtwYWRkaW5nLXRvcDoycmVtO3BhZGRpbmctYm90dG9tOjJyZW19LmhpZGV7ZGlzcGxheTpub25lfVwiO1xuXG5jb25zdCBBcmNnaXNCcm93c2VyUGFnaW5hdGlvbiA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzQnJvd3NlclBhZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc0Jyb3dzZXJQYWdlXCIsIDcpO1xuICAgICAgICB0aGlzLnRvdGFsID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnN0YXJ0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLm51bSA9IDYwO1xuICAgICAgICB0aGlzLnN0b3JlID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICAgICAgY29uc3QgbG9jYWxlID0gYXdhaXQgZ2V0TG9jYWxlQ29tcG9uZW50U3RyaW5ncyh0aGlzLmVsLCBcImFyY2dpcy1icm93c2VyXCIpO1xuICAgICAgICB0aGlzLmkxOG4gPSBsb2NhbGVbMF0ucGFnaW5hdGlvbjtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgdG90YWwsIG51bSB9ID0gdGhpcztcbiAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyUGFnZS5lbWl0KHsgc3RhcnQsIHRvdGFsLCBudW0gfSk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgdG90YWwsIG51bSwgaTE4biB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qgc2NhbGUgPSB0aGlzLnN0b3JlLnN0YXRlLndpZHRoID4gYnJlYWtwb2ludHMuc20gPyBcIm1cIiA6IFwic1wiO1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBjbGFzczogXCJ3cmFwcGVyXCIgfSwgaChcImNhbGNpdGUtcGFnaW5hdGlvblwiLCB7IG9uQ2FsY2l0ZVBhZ2luYXRpb25DaGFuZ2U6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBldmVudC50YXJnZXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyUGFnZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IG5vZGUuc3RhcnRJdGVtLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbDogbm9kZS50b3RhbEl0ZW1zLFxuICAgICAgICAgICAgICAgICAgICBudW06IG5vZGUucGFnZVNpemVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIHN0YXJ0SXRlbTogc3RhcnQsIHRvdGFsSXRlbXM6IE1hdGgubWluKHRvdGFsLCAxMDAwMCAtIG51bSksIHBhZ2VTaXplOiBudW0sIHNjYWxlOiBzY2FsZSwgbWVzc2FnZU92ZXJyaWRlczogeyBuZXh0OiBpMThuLm5leHQsIHByZXZpb3VzOiBpMThuLnByZXYgfSwgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBoaWRlOiAhdG90YWwgfHwgdG90YWwgPCBudW1cbiAgICAgICAgICAgIH0gfSkpKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcbkFyY2dpc0Jyb3dzZXJQYWdpbmF0aW9uLnN0eWxlID0gYXJjZ2lzQnJvd3NlclBhZ2luYXRpb25Dc3M7XG5cbmNvbnN0IGFyY2dpc0Jyb3dzZXJTZWFyY2hDc3MgPSBcIjpob3N0e3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2t9LnNlYXJjaHtwb2ludGVyLWV2ZW50czpub25lO3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6MTA7bWFyZ2luLXRvcDoxcmVtO2ZvbnQtc2l6ZTowLjg3NXJlbTtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSk7aW5zZXQtaW5saW5lLXN0YXJ0OjEuNXJlbX0ueHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MHB4O3otaW5kZXg6MTA7bWFyZ2luLXRvcDowLjI1cmVtO2N1cnNvcjpwb2ludGVyO2JvcmRlci1zdHlsZTpub25lO3BhZGRpbmc6MC41cmVtO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0xKTtvdXRsaW5lOjJweCBzb2xpZCB0cmFuc3BhcmVudDtvdXRsaW5lLW9mZnNldDoycHg7aW5zZXQtaW5saW5lLWVuZDowLjI1cmVtO2JhY2tncm91bmQ6dHJhbnNwYXJlbnR9LmlucHV0e3Bvc2l0aW9uOnJlbGF0aXZlO3otaW5kZXg6MDtib3gtc2l6aW5nOmJvcmRlci1ib3g7ZGlzcGxheTpibG9jaztoZWlnaHQ6M3JlbTt3aWR0aDoxMDAlO2JvcmRlci1zdHlsZTpub25lO3BhZGRpbmctdG9wOjFyZW07cGFkZGluZy1ib3R0b206MXJlbTtwYWRkaW5nLWxlZnQ6M3JlbTtwYWRkaW5nLXJpZ2h0OjNyZW07Zm9udC1zaXplOjAuODc1cmVtO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0xKTstLXR3LXNoYWRvdzowIDAgIzAwMDA7LS10dy1zaGFkb3ctY29sb3JlZDowIDAgIzAwMDA7Ym94LXNoYWRvdzp2YXIoLS10dy1yaW5nLW9mZnNldC1zaGFkb3csIDAgMCAjMDAwMCksIHZhcigtLXR3LXJpbmctc2hhZG93LCAwIDAgIzAwMDApLCB2YXIoLS10dy1zaGFkb3cpO3RyYW5zaXRpb24tcHJvcGVydHk6Y29sb3IsIGJhY2tncm91bmQtY29sb3IsIGJvcmRlci1jb2xvciwgdGV4dC1kZWNvcmF0aW9uLWNvbG9yLCBmaWxsLCBzdHJva2UsIG9wYWNpdHksIGJveC1zaGFkb3csIHRyYW5zZm9ybSwgZmlsdGVyLCAtd2Via2l0LWJhY2tkcm9wLWZpbHRlcjt0cmFuc2l0aW9uLXByb3BlcnR5OmNvbG9yLCBiYWNrZ3JvdW5kLWNvbG9yLCBib3JkZXItY29sb3IsIHRleHQtZGVjb3JhdGlvbi1jb2xvciwgZmlsbCwgc3Ryb2tlLCBvcGFjaXR5LCBib3gtc2hhZG93LCB0cmFuc2Zvcm0sIGZpbHRlciwgYmFja2Ryb3AtZmlsdGVyO3RyYW5zaXRpb24tcHJvcGVydHk6Y29sb3IsIGJhY2tncm91bmQtY29sb3IsIGJvcmRlci1jb2xvciwgdGV4dC1kZWNvcmF0aW9uLWNvbG9yLCBmaWxsLCBzdHJva2UsIG9wYWNpdHksIGJveC1zaGFkb3csIHRyYW5zZm9ybSwgZmlsdGVyLCBiYWNrZHJvcC1maWx0ZXIsIC13ZWJraXQtYmFja2Ryb3AtZmlsdGVyO3RyYW5zaXRpb24tZHVyYXRpb246MTUwbXM7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXItYm90dG9tOjJweCBzb2xpZCB0cmFuc3BhcmVudDtmb250LWZhbWlseTppbmhlcml0fS5pbnB1dDo6LXdlYmtpdC1zZWFyY2gtY2FuY2VsLWJ1dHRvbntkaXNwbGF5Om5vbmV9LmlucHV0OjotbXMtY2xlYXJ7ZGlzcGxheTpub25lfS5pbnB1dDpmb2N1c3stLXR3LXNoYWRvdzowIDAgIzAwMDA7LS10dy1zaGFkb3ctY29sb3JlZDowIDAgIzAwMDA7Ym94LXNoYWRvdzp2YXIoLS10dy1yaW5nLW9mZnNldC1zaGFkb3csIDAgMCAjMDAwMCksIHZhcigtLXR3LXJpbmctc2hhZG93LCAwIDAgIzAwMDApLCB2YXIoLS10dy1zaGFkb3cpO291dGxpbmU6MnB4IHNvbGlkIHRyYW5zcGFyZW50O291dGxpbmUtb2Zmc2V0OjJweDtib3JkZXItYm90dG9tLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpfVwiO1xuXG5jb25zdCBBcmNnaXNCcm93c2VyU2VhcmNoID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyU2VhcmNoID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNCcm93c2VyU2VhcmNoXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc0Jyb3dzZXJTZWFyY2hJbnB1dCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzQnJvd3NlclNlYXJjaElucHV0XCIsIDcpO1xuICAgICAgICB0aGlzLmRlYm91bmNlZElucHV0ID0gZGVib3VuY2UoKHRlcm0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5zV2lsZGNhcmQgPSB0ZXJtLmluY2x1ZGVzKFwiKlwiKTtcbiAgICAgICAgICAgIHRoaXMuc2hvd0NsZWFyID0gISF0ZXJtO1xuICAgICAgICAgICAgaWYgKGNvbnRhaW5zV2lsZGNhcmQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5zV2lsZGNhcmQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluc1dpbGRjYXJkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyU2VhcmNoLmVtaXQodGVybSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDQwMCk7XG4gICAgICAgIHRoaXMudGVybSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wbGFjZWhvbGRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zaG93Q2xlYXIgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb250YWluc1dpbGRjYXJkID0gZmFsc2U7XG4gICAgfVxuICAgIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGxvY2FsZSA9IGF3YWl0IGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3ModGhpcy5lbCwgXCJhcmNnaXMtYnJvd3NlclwiKTtcbiAgICAgICAgdGhpcy5pMThuID0gbG9jYWxlWzBdLnNlYXJjaDtcbiAgICAgICAgaWYgKHRoaXMudGVybSkge1xuICAgICAgICAgICAgdGhpcy5zaG93Q2xlYXIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGFpbnNXaWxkY2FyZCA9IChfYSA9IHRoaXMudGVybSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwiKlwiKTtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyU2VhcmNoLmVtaXQodGhpcy50ZXJtKTtcbiAgICB9XG4gICAgdGVybUNoYW5nZWQobmV3VGVybSkge1xuICAgICAgICBpZiAodGhpcy5zZWFyY2hJbnB1dC52YWx1ZSAhPT0gbmV3VGVybSkge1xuICAgICAgICAgICAgdGhpcy5zaG93Q2xlYXIgPSAhIW5ld1Rlcm07XG4gICAgICAgICAgICB0aGlzLmFyY2dpc0Jyb3dzZXJTZWFyY2guZW1pdChuZXdUZXJtKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoaChIb3N0LCBudWxsLCBoKFwiY2FsY2l0ZS1pY29uXCIsIHsgaWNvbjogXCJzZWFyY2hcIiwgc2NhbGU6IFwic1wiLCBjbGFzczogXCJzZWFyY2hcIiB9KSwgaChcImlucHV0XCIsIHsgY2xhc3M6IFwiaW5wdXRcIiwgdmFsdWU6IHRoaXMudGVybSwgcGxhY2Vob2xkZXI6IHRoaXMucGxhY2Vob2xkZXIgfHwgdGhpcy5pMThuLnNlYXJjaCwgcmVmOiAoZWwpID0+ICh0aGlzLnNlYXJjaElucHV0ID0gZWwpLCBcImFyaWEtbGFiZWxcIjogdGhpcy5wbGFjZWhvbGRlciB8fCB0aGlzLmkxOG4uc2VhcmNoLCBvbklucHV0OiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRlcm0gPSBlLmN1cnJlbnRUYXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKCEodGVybSA9PT0gbnVsbCB8fCB0ZXJtID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZXJtLmluY2x1ZGVzKFwiKlwiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluc1dpbGRjYXJkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzQnJvd3NlclNlYXJjaElucHV0LmVtaXQodGVybSk7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWJvdW5jZWRJbnB1dCh0ZXJtKTtcbiAgICAgICAgICAgIH0gfSksIGgoXCJjYWxjaXRlLWFsZXJ0XCIsIHsgb3BlbjogdGhpcy5jb250YWluc1dpbGRjYXJkLCBzY2FsZTogXCJtXCIsIGtpbmQ6IFwiZGFuZ2VyXCIsIGljb246IFwiZXhjbGFtYXRpb24tbWFyay10cmlhbmdsZVwiLCBsYWJlbDogdGhpcy5pMThuLndpbGRjYXJkLCBvbkNhbGNpdGVBbGVydENsb3NlOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluc1dpbGRjYXJkID0gZmFsc2U7XG4gICAgICAgICAgICB9IH0sIGgoXCJkaXZcIiwgeyBzbG90OiBcIm1lc3NhZ2VcIiB9LCB0aGlzLmkxOG4ud2lsZGNhcmQpKSwgdGhpcy5zaG93Q2xlYXIgJiYgKGgoXCJidXR0b25cIiwgeyBjbGFzczogXCJ4XCIsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLmkxOG4uY2xlYXIsIG9uQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc0Jyb3dzZXJTZWFyY2hJbnB1dC5lbWl0KFwiXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzQnJvd3NlclNlYXJjaC5lbWl0KFwiXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0NsZWFyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VhcmNoSW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hJbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IH0sIGgoXCJjYWxjaXRlLWljb25cIiwgeyBpY29uOiBcInhcIiwgc2NhbGU6IFwibVwiLCBjbGFzczogXCJ4LS1pY29uXCIgfSkpKSkpO1xuICAgIH1cbiAgICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gICAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICAgICAgXCJ0ZXJtXCI6IFtcInRlcm1DaGFuZ2VkXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc0Jyb3dzZXJTZWFyY2guc3R5bGUgPSBhcmNnaXNCcm93c2VyU2VhcmNoQ3NzO1xuXG5jb25zdCBhcmNnaXNCcm93c2VyU29ydENzcyA9IFwiLmRyb3Bkb3duLXdyYXB7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcn0ucmFkaW8td3JhcHBlcntwYWRkaW5nOjFyZW19Lm1lZGl1bXtmb250LXdlaWdodDo1MDB9XCI7XG5cbmNvbnN0IEFyY2dpc0Jyb3dzZXJTb3J0ID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy5hcmNnaXNCcm93c2VyU29ydEZpZWxkQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNCcm93c2VyU29ydEZpZWxkQ2hhbmdlXCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc0Jyb3dzZXJTb3J0T3JkZXJDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc0Jyb3dzZXJTb3J0T3JkZXJDaGFuZ2VcIiwgNyk7XG4gICAgICAgIHRoaXMuc29ydE9yZGVycyA9IFtcImFzY1wiLCBcImRlc2NcIl07XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5maWVsZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5vcmRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zdG9yZSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsZSA9IGF3YWl0IGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3ModGhpcy5lbCwgXCJhcmNnaXMtYnJvd3NlclwiKTtcbiAgICAgICAgdGhpcy5pMThuID0gbG9jYWxlWzBdLnNvcnQ7XG4gICAgfVxuICAgIHJlbmRlckZpZWxkT3B0aW9uKG9wdGlvbiwgc2VsZWN0ZWRGaWVsZCwgaTE4bikge1xuICAgICAgICBjb25zdCB7IHN0b3JlIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCBpbmZvID0gZ2V0U29ydEZpZWxkSW5mbyhvcHRpb24sIGkxOG4sIHN0b3JlKTtcbiAgICAgICAgcmV0dXJuIChoKFwiY2FsY2l0ZS1kcm9wZG93bi1pdGVtXCIsIHsgc2VsZWN0ZWQ6IHNlbGVjdGVkRmllbGQgPT09IG9wdGlvbiwgb25DYWxjaXRlRHJvcGRvd25JdGVtU2VsZWN0OiAoKSA9PiB0aGlzLmFyY2dpc0Jyb3dzZXJTb3J0RmllbGRDaGFuZ2UuZW1pdChvcHRpb24pLCBrZXk6IG9wdGlvbiB9LCBpbmZvLmxhYmVsKSk7XG4gICAgfVxuICAgIHJlbmRlckJ1dHRvbihpbmZvKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGNvbnN0IHsgaTE4biB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgYmFzZUF0dHJzID0ge1xuICAgICAgICAgICAgY2xhc3M6IFwiYnV0dG9uXCIsXG4gICAgICAgICAgICBzbG90OiBcInRyaWdnZXJcIixcbiAgICAgICAgICAgIHNjYWxlOiBcIm1cIixcbiAgICAgICAgICAgIGFwcGVhcmFuY2U6IFwib3V0bGluZS1maWxsXCIsXG4gICAgICAgICAgICBraW5kOiBcIm5ldXRyYWxcIixcbiAgICAgICAgICAgIGljb25TdGFydDogXCJzb3J0LWRlc2NlbmRpbmdcIixcbiAgICAgICAgICAgIGljb25GbGlwUnRsOiBcInN0YXJ0XCIsXG4gICAgICAgICAgICBhcmlhTGFiZWw6IGAke2kxOG4uc29ydEJ5fSAke2luZm8ubGFiZWx9YFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gKChfYiA9IChfYSA9IHRoaXMuc3RvcmUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdGF0ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLndpZHRoKSA+IERST1BET1dOX0lDT05fRElTUExBWV9DVVRPRkZfU0laRSA/IChoKFwiY2FsY2l0ZS1idXR0b25cIiwgT2JqZWN0LmFzc2lnbih7fSwgYmFzZUF0dHJzKSwgaW5mby5sYWJlbCkpIDogKGgoXCJjYWxjaXRlLWJ1dHRvblwiLCBPYmplY3QuYXNzaWduKHt9LCBiYXNlQXR0cnMpKSk7XG4gICAgfVxuICAgIHJlbmRlckRyb3Bkb3duKCkge1xuICAgICAgICBjb25zdCB7IGZpZWxkLCBvcmRlciwgb3B0aW9ucywgaTE4biwgc3RvcmUgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkRmllbGQgPSBvcHRpb25zLmluY2x1ZGVzKGZpZWxkKSA/IGZpZWxkIDogb3B0aW9uc1swXTtcbiAgICAgICAgY29uc3QgaW5mbyA9IGdldFNvcnRGaWVsZEluZm8oc2VsZWN0ZWRGaWVsZCwgaTE4biwgc3RvcmUpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZE9yZGVyID0gb3JkZXIgfHwgaW5mby5kZWZhdWx0U29ydE9yZGVyO1xuICAgICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWRyb3Bkb3duXCIsIHsgcGxhY2VtZW50OiBcImJvdHRvbS1lbmRcIiwgc2NhbGU6IFwibVwiLCBvdmVybGF5UG9zaXRpb25pbmc6IFwiZml4ZWRcIiwgd2lkdGhTY2FsZTogXCJtXCIgfSwgdGhpcy5yZW5kZXJCdXR0b24oaW5mbyksIGgoXCJjYWxjaXRlLWRyb3Bkb3duLWdyb3VwXCIsIHsgc2VsZWN0aW9uTW9kZTogXCJzaW5nbGVcIiwgXCJncm91cC10aXRsZVwiOiBpMThuLnNvcnRCeSB9LCB0aGlzLm9wdGlvbnMubWFwKChvcHRpb24pID0+IHRoaXMucmVuZGVyRmllbGRPcHRpb24ob3B0aW9uLCBzZWxlY3RlZEZpZWxkLCBpMThuKSkpLCBpbmZvLnNob3dTb3J0T3JkZXIgJiYgKGgoXCJjYWxjaXRlLWRyb3Bkb3duLWdyb3VwXCIsIHsgc2VsZWN0aW9uTW9kZTogXCJzaW5nbGVcIiwgXCJncm91cC10aXRsZVwiOiBpMThuLnNvcnREaXJlY3Rpb24gfSwgdGhpcy5zb3J0T3JkZXJzLm1hcCgob3JkZXIpID0+IChoKFwiY2FsY2l0ZS1kcm9wZG93bi1pdGVtXCIsIHsga2V5OiBvcmRlciwgc2VsZWN0ZWQ6IHNlbGVjdGVkT3JkZXIgPT09IG9yZGVyLCBvbkNhbGNpdGVEcm9wZG93bkl0ZW1TZWxlY3Q6ICgpID0+IHRoaXMuYXJjZ2lzQnJvd3NlclNvcnRPcmRlckNoYW5nZS5lbWl0KG9yZGVyKSB9LCBpbmZvLnNvcnRPcmRlckxhYmVsc1tvcmRlcl0pKSkpKSkpO1xuICAgIH1cbiAgICByZW5kZXJGaWVsZFJhZGlvKG9wdGlvbiwgc2VsZWN0ZWRGaWVsZCwgaTE4bikge1xuICAgICAgICBjb25zdCBpbmZvID0gZ2V0U29ydEZpZWxkSW5mbyhvcHRpb24sIGkxOG4pO1xuICAgICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWxhYmVsXCIsIHsgbGF5b3V0OiBcImlubGluZVwiLCBhbGlnbm1lbnQ6IFwic3RhcnRcIiB9LCBoKFwiY2FsY2l0ZS1yYWRpby1idXR0b25cIiwgeyB2YWx1ZTogb3B0aW9uLCBuYW1lOiBcInNvcnRfZmllbGRcIiwgY2hlY2tlZDogc2VsZWN0ZWRGaWVsZCA9PT0gb3B0aW9uIH0pLCBpbmZvLmxhYmVsKSk7XG4gICAgfVxuICAgIHJlbmRlclJhZGlvQnV0dG9ucygpIHtcbiAgICAgICAgY29uc3QgeyBmaWVsZCwgb3JkZXIsIG9wdGlvbnMsIGkxOG4sIHN0b3JlIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCBzZWxlY3RlZEZpZWxkID0gb3B0aW9ucy5pbmNsdWRlcyhmaWVsZCkgPyBmaWVsZCA6IG9wdGlvbnNbMF07XG4gICAgICAgIGNvbnN0IGluZm8gPSBnZXRTb3J0RmllbGRJbmZvKHNlbGVjdGVkRmllbGQsIGkxOG4sIHN0b3JlKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRPcmRlciA9IG9yZGVyIHx8IGluZm8uZGVmYXVsdFNvcnRPcmRlcjtcbiAgICAgICAgcmV0dXJuIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwicmFkaW8td3JhcHBlclwiIH0sIGgoXCJjYWxjaXRlLWxhYmVsXCIsIHsgc2NhbGU6IFwibVwiIH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwibWVkaXVtXCIgfSwgaTE4bi5zb3J0QnkpLCBoKFwiY2FsY2l0ZS1yYWRpby1idXR0b24tZ3JvdXBcIiwgeyBuYW1lOiBcInNvcnRfZmllbGRcIiwgbGF5b3V0OiBcInZlcnRpY2FsXCIsIHJvbGU6IFwicmFkaW9ncm91cFwiLCBvbkNhbGNpdGVSYWRpb0J1dHRvbkdyb3VwQ2hhbmdlOiAoZXZlbnQpID0+IHRoaXMuYXJjZ2lzQnJvd3NlclNvcnRGaWVsZENoYW5nZS5lbWl0KGV2ZW50LnRhcmdldC5zZWxlY3RlZEl0ZW0udmFsdWUpIH0sIHRoaXMub3B0aW9ucy5tYXAoKG9wdGlvbikgPT4gdGhpcy5yZW5kZXJGaWVsZFJhZGlvKG9wdGlvbiwgc2VsZWN0ZWRGaWVsZCwgaTE4bikpKSksIGluZm8uc2hvd1NvcnRPcmRlciAmJiAoaChcImNhbGNpdGUtbGFiZWxcIiwgeyBzY2FsZTogXCJtXCIgfSwgaChcInNwYW5cIiwgeyBjbGFzczogXCJtZWRpdW1cIiB9LCBpMThuLnNvcnREaXJlY3Rpb24pLCBoKFwiY2FsY2l0ZS1yYWRpby1idXR0b24tZ3JvdXBcIiwgeyBuYW1lOiBcInNvcnRfb3JkZXJcIiwgbGF5b3V0OiBcInZlcnRpY2FsXCIsIHJvbGU6IFwicmFkaW9ncm91cFwiLCBvbkNhbGNpdGVSYWRpb0J1dHRvbkdyb3VwQ2hhbmdlOiAoZXZlbnQpID0+IHRoaXMuYXJjZ2lzQnJvd3NlclNvcnRPcmRlckNoYW5nZS5lbWl0KGV2ZW50LnRhcmdldC5zZWxlY3RlZEl0ZW0udmFsdWUpIH0sIHRoaXMuc29ydE9yZGVycy5tYXAoKG9yZGVyKSA9PiAoaChcImNhbGNpdGUtbGFiZWxcIiwgeyBsYXlvdXQ6IFwiaW5saW5lXCIsIGFsaWdubWVudDogXCJzdGFydFwiIH0sIGgoXCJjYWxjaXRlLXJhZGlvLWJ1dHRvblwiLCB7IHZhbHVlOiBvcmRlciwgbmFtZTogXCJzb3J0X29yZGVyXCIsIGNoZWNrZWQ6IHNlbGVjdGVkT3JkZXIgPT09IG9yZGVyIH0pLCBpbmZvLnNvcnRPcmRlckxhYmVsc1tvcmRlcl0pKSkpKSkpKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5zdGF0ZS5wYW5lbCB8fFxuICAgICAgICAgICAgKHRoaXMuc3RvcmUuc3RhdGUud2lkdGggJiYgdGhpcy5zdG9yZS5zdGF0ZS53aWR0aCA8IGJyZWFrcG9pbnRzLnNtKVxuICAgICAgICAgICAgPyB0aGlzLnJlbmRlclJhZGlvQnV0dG9ucygpXG4gICAgICAgICAgICA6IHRoaXMucmVuZGVyRHJvcGRvd24oKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcbkFyY2dpc0Jyb3dzZXJTb3J0LnN0eWxlID0gYXJjZ2lzQnJvd3NlclNvcnRDc3M7XG5cbmNvbnN0IGFyY2dpc0Jyb3dzZXJUb3BCYXJDc3MgPSBcIjpob3N0e3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1hcmNnaXMtYnJvd3Nlci10b3AtYmFyLWJhY2tncm91bmQpfS53cmFwcGVye21hcmdpbi1sZWZ0OmF1dG87bWFyZ2luLXJpZ2h0OmF1dG87ZGlzcGxheTpmbGV4O21heC13aWR0aDp2YXIoLS1hcmNnaXMtYnJvd3Nlci1tYXgtd2lkdGgpfS5zZWFyY2gtYW5kLXNvcnR7ZGlzcGxheTpmbGV4O2ZsZXg6MSAxIDAlO2FsaWduLWl0ZW1zOmNlbnRlcjtwYWRkaW5nLWlubGluZS1lbmQ6MS41cmVtfS5zZWFyY2h7ZmxleDoxIDEgMCV9LnNvcnR7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcn0uZmlsdGVye21hcmdpbi10b3A6MC4yNXJlbTttYXJnaW4tYm90dG9tOjAuMjVyZW07ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3BhZGRpbmctbGVmdDowLjVyZW07cGFkZGluZy1yaWdodDowLjVyZW19LmZpbHRlci0tbGVmdHtib3JkZXItaW5saW5lLWVuZDoxcHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMyl9LmxhcmdlIC5maWx0ZXJ7ZGlzcGxheTpub25lfS5yZWx7cG9zaXRpb246cmVsYXRpdmV9LmJ1Y2tldC0tc21hbGx7dGV4dC1hbGlnbjpjZW50ZXI7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMyl9LmluZGljYXRvcntwb2ludGVyLWV2ZW50czpub25lO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowcHg7ei1pbmRleDoyMDtoZWlnaHQ6MC41cmVtO3dpZHRoOjAuNXJlbTtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpO2luc2V0LWlubGluZS1zdGFydDowfS5zbWFsbCAuc2VhcmNoLWFuZC1zb3J0e3BhZGRpbmctaW5saW5lLWVuZDoxcmVtfVwiO1xuXG5jb25zdCBBcmNnaXNCcm93c2VyVG9wQmFyID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy5zdG9yZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5maWx0ZXJzRGlzYWJsZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMud2lkdGggPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgICAgICBjb25zdCBsb2NhbGUgPSBhd2FpdCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzKHRoaXMuZWwsIFwiYXJjZ2lzLWJyb3dzZXJcIik7XG4gICAgICAgIHRoaXMuaTE4biA9IGxvY2FsZVswXS50b3BCYXI7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgdGhpcy5zdG9yZS5vbkNoYW5nZShcIndpZHRoXCIsICh3aWR0aCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgdGhpcy53aWR0aCA9IChfYSA9IHRoaXMuc2VhcmNoV3JhcHBlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm9mZnNldFdpZHRoO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0Rm9ybUZhY3RvcigpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSB0aGlzLnN0b3JlLnN0YXRlLndpZHRoO1xuICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgIGNhc2Ugd2lkdGggPD0gYnJlYWtwb2ludHMuc206XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic21hbGxcIjtcbiAgICAgICAgICAgIGNhc2Ugd2lkdGggPD0gYnJlYWtwb2ludHMubWQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibWVkaXVtXCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBcImxhcmdlXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlQ2xpY2soKSB7XG4gICAgICAgIHRoaXMuc3RvcmUuc3RhdGUucHJldmlldyA9IG51bGw7XG4gICAgICAgIHRoaXMuc3RvcmUuc3RhdGUuZmlsdGVyc0V4cGFuZGVkID0gIXRoaXMuc3RvcmUuc3RhdGUuZmlsdGVyc0V4cGFuZGVkO1xuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IGZvcm1GYWN0b3IgPSB0aGlzLmdldEZvcm1GYWN0b3IoKTtcbiAgICAgICAgY29uc3Qgc2hvd0ZpbHRlckJ1dHRvbiA9IGZvcm1GYWN0b3IgPT09IFwic21hbGxcIiAmJlxuICAgICAgICAgICAgKCF0aGlzLnN0b3JlLnN0YXRlLmZpbHRlcnNFbXB0eSB8fCAhdGhpcy5zdG9yZS5zdGF0ZS5zb3J0RW1wdHkpICYmXG4gICAgICAgICAgICAhdGhpcy5maWx0ZXJzRGlzYWJsZWQ7XG4gICAgICAgIGNvbnN0IGhhc0FjdGl2ZUZpbHRlciA9IE9iamVjdC52YWx1ZXModGhpcy5zdG9yZS5zdGF0ZS5maWx0ZXJzIHx8IHt9KS5zb21lKChmaWx0ZXIpID0+IGZpbHRlci52YWx1ZSk7XG4gICAgICAgIHJldHVybiAoaChIb3N0LCBudWxsLCBmb3JtRmFjdG9yID09PSBcInNtYWxsXCIgJiYgKGgoXCJkaXZcIiwgeyBjbGFzczogXCJidWNrZXQgYnVja2V0LS1zbWFsbFwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJidWNrZXRcIiB9KSkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IHsgW2Zvcm1GYWN0b3JdOiB0cnVlLCB3cmFwcGVyOiB0cnVlIH0gfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImNvbnRlbnQtc3RhcnRcIiB9KSwgc2hvd0ZpbHRlckJ1dHRvbiAmJiAhdGhpcy5zdG9yZS5zdGF0ZS5wYW5lbCAmJiAoaChcImRpdlwiLCB7IGNsYXNzOiBcImZpbHRlciBmaWx0ZXItLWxlZnRcIiB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwicmVsXCIgfSwgaGFzQWN0aXZlRmlsdGVyICYmIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwiaW5kaWNhdG9yXCIgfSksIGgoXCJjYWxjaXRlLWJ1dHRvblwiLCB7IGNsYXNzOiBcImZpbHRlci10b2dnbGVcIiwgc2NhbGU6IFwic1wiLCBhcHBlYXJhbmNlOiBcInRyYW5zcGFyZW50XCIsIGtpbmQ6IFwibmV1dHJhbFwiLCBpY29uU3RhcnQ6IFwic2xpZGVyc1wiLCBcImFyaWEtbGFiZWxcIjogXCJ0b2dnbGUtZmlsdGVyc1wiLCBvbkNsaWNrOiAoKSA9PiB0aGlzLmhhbmRsZUNsaWNrKCksIFwiYXJpYS1leHBhbmRlZFwiOiB0aGlzLnN0b3JlLnN0YXRlLmZpbHRlcnNFeHBhbmRlZCB9LCB0aGlzLmkxOG4uZmlsdGVyKSkpKSwgZm9ybUZhY3RvciAhPT0gXCJzbWFsbFwiICYmIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwiYnVja2V0XCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImJ1Y2tldFwiIH0pKSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJzZWFyY2gtYW5kLXNvcnRcIiwgcmVmOiAoZWwpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaFdyYXBwZXIgPSBlbDtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMud2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+ICh0aGlzLndpZHRoID0gZWwgPT09IG51bGwgfHwgZWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVsLm9mZnNldFdpZHRoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwic2VhcmNoXCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInNlYXJjaFwiIH0pKSwgIXNob3dGaWx0ZXJCdXR0b24gJiYgKGgoXCJhcmNnaXMtYnJvd3Nlci1maWx0ZXItc3RhdHVzXCIsIHsgY29tcG9uZW50V2lkdGg6IHRoaXMud2lkdGgsIGJyb3dzZXJXaWR0aDogdGhpcy5zdG9yZS5zdGF0ZS53aWR0aCwgY2xhc3M6IFwiZmlsdGVyLXN0YXR1c1wiLCBmaWx0ZXJzOiB0aGlzLnN0b3JlLnN0YXRlLmZpbHRlcnMgfSkpKSwgc2hvd0ZpbHRlckJ1dHRvbiAmJiB0aGlzLnN0b3JlLnN0YXRlLnBhbmVsICYmIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZmlsdGVyXCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcInJlbFwiIH0sIGhhc0FjdGl2ZUZpbHRlciAmJiBoKFwic3BhblwiLCB7IGNsYXNzOiBcImluZGljYXRvclwiIH0pLCBoKFwiY2FsY2l0ZS1idXR0b25cIiwgeyBjbGFzczogXCJmaWx0ZXItdG9nZ2xlXCIsIHNjYWxlOiBcInNcIiwgYXBwZWFyYW5jZTogXCJ0cmFuc3BhcmVudFwiLCBraW5kOiBcIm5ldXRyYWxcIiwgaWNvblN0YXJ0OiBcInNsaWRlcnNcIiwgXCJhcmlhLWxhYmVsXCI6IHRoaXMuaTE4bi5maWx0ZXIsIG9uQ2xpY2s6ICgpID0+IHRoaXMuaGFuZGxlQ2xpY2soKSwgXCJhcmlhLWV4cGFuZGVkXCI6IHRoaXMuc3RvcmUuc3RhdGUuZmlsdGVyc0V4cGFuZGVkIH0pKSkpLCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiY29udGVudC1lbmRcIiB9KSkpKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcbkFyY2dpc0Jyb3dzZXJUb3BCYXIuc3R5bGUgPSBhcmNnaXNCcm93c2VyVG9wQmFyQ3NzO1xuXG5leHBvcnQgeyBBcmNnaXNCcm93c2VyIGFzIGFyY2dpc19icm93c2VyLCBBcmNnaXNCcm93c2VyQWN0aW9ucyBhcyBhcmNnaXNfYnJvd3Nlcl9hY3Rpb25zLCBBcmNnaXNCcm93c2VyRmlsdGVyIGFzIGFyY2dpc19icm93c2VyX2ZpbHRlciwgQXJjZ2lzQnJvd3NlckZpbHRlckRhdGUgYXMgYXJjZ2lzX2Jyb3dzZXJfZmlsdGVyX2RhdGUsIEFyY2dpc0Jyb3dzZXJGaWx0ZXJTdGF0dXMgYXMgYXJjZ2lzX2Jyb3dzZXJfZmlsdGVyX3N0YXR1cywgQXJjZ2lzSXRlbUJyb3dzZXJGaWx0ZXJzIGFzIGFyY2dpc19icm93c2VyX2ZpbHRlcnMsIEFyY2dpc0Jyb3dzZXJQYWdpbmF0aW9uIGFzIGFyY2dpc19icm93c2VyX3BhZ2luYXRpb24sIEFyY2dpc0Jyb3dzZXJTZWFyY2ggYXMgYXJjZ2lzX2Jyb3dzZXJfc2VhcmNoLCBBcmNnaXNCcm93c2VyU29ydCBhcyBhcmNnaXNfYnJvd3Nlcl9zb3J0LCBBcmNnaXNCcm93c2VyVG9wQmFyIGFzIGFyY2dpc19icm93c2VyX3RvcF9iYXIgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXJjZ2lzLWJyb3dzZXJfMTAuZW50cnkuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG4vKipcbiAqIENhbGwgYSBmdW5jdGlvbiBvbmx5IGFmdGVyIGl0IGhhcyBub3QgYmVlbiBjYWxsZWQgZm9yIG4gbWlsbGlzZWNvbmRzXG4gKiBAcGFyYW0gZm4gICAgLSBmdW5jdGlvbiB0byBjYWxsXG4gKiBAcGFyYW0gZGVsYXkgLSBkZWxheSBpbiBtaWxsaXNlY29uZHNcbiAqL1xuY29uc3QgZGVib3VuY2UgPSAoZm4sIGRlbGF5KSA9PiB7XG4gICAgbGV0IHRpbWVvdXQ7XG4gICAgbGV0IHN0YXR1cyA9IFwiaWRsZVwiO1xuICAgIGZ1bmN0aW9uIGZsdXNoKC4uLmFyZ3MpIHtcbiAgICAgICAgc3RhdHVzID0gXCJmbHVzaGVkXCI7XG4gICAgICAgIHJldHVybiBkZWJvdW5jZWQoLi4uYXJncyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGludm9rZSguLi5hcmdzKSB7XG4gICAgICAgIHN0YXR1cyA9IFwiaW52b2tlZFwiO1xuICAgICAgICByZXR1cm4gZGVib3VuY2VkKC4uLmFyZ3MpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjYW5jZWwoLi4uYXJncykge1xuICAgICAgICBzdGF0dXMgPSBcImNhbmNlbGxlZFwiO1xuICAgICAgICByZXR1cm4gZGVib3VuY2VkKC4uLmFyZ3MpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRTdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiBzdGF0dXM7XG4gICAgfVxuICAgIGNvbnN0IGRlYm91bmNlZCA9ICguLi5hcmdzKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICBzd2l0Y2ggKHN0YXR1cykge1xuICAgICAgICAgICAgY2FzZSBcImZsdXNoZWRcIjpcbiAgICAgICAgICAgICAgICBzdGF0dXMgPSBcImlkbGVcIjtcbiAgICAgICAgICAgICAgICBpZiAodGltZW91dCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZm4oLi4uYXJncykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiaW52b2tlZFwiOlxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICBzdGF0dXMgPSBcImlkbGVcIjtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGZuKC4uLmFyZ3MpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJjYW5jZWxsZWRcIjpcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICAgICAgc3RhdHVzID0gXCJpZGxlXCI7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgaWYgKHRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0dXMgPSBcInBlbmRpbmdcIjtcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IFwiaWRsZVwiO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShmbiguLi5hcmdzKSk7XG4gICAgICAgICAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZGVib3VuY2VkLmZsdXNoID0gZmx1c2g7XG4gICAgZGVib3VuY2VkLmludm9rZSA9IGludm9rZTtcbiAgICBkZWJvdW5jZWQuY2FuY2VsID0gY2FuY2VsO1xuICAgIGRlYm91bmNlZC5nZXRTdGF0dXMgPSBnZXRTdGF0dXM7XG4gICAgcmV0dXJuIGRlYm91bmNlZDtcbn07XG4vKipcbiAqIENhbGwgYSBmdW5jdGlvbiBvbmx5IGFmdGVyIG4gbWlsbGlzZWNvbmRzIGhhdmUgZWxhcHNlZFxuICogQHBhcmFtIGZuICAgIC0gZnVuY3Rpb24gdG8gY2FsbFxuICogQHBhcmFtIGRlbGF5IC0gZGVsYXkgaW4gbWlsbGlzZWNvbmRzXG4gKi9cbmNvbnN0IHRocm90dGxlID0gKGZuLCBkZWxheSkgPT4ge1xuICAgIGxldCB0aW1lb3V0O1xuICAgIHJldHVybiAoLi4uYXJncykgPT4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgaWYgKHRpbWVvdXQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICB0aW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmVzb2x2ZShmbiguLi5hcmdzKSk7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICB9KTtcbn07XG5mdW5jdGlvbiBlc2NhcGVSZWdFeHAoc3RyKSB7XG4gICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgXCJcXFxcJCZcIik7IC8vICQmIG1lYW5zIHRoZSB3aG9sZSBtYXRjaGVkIHN0cmluZ1xufVxuZnVuY3Rpb24gaXNEZWZpbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGw7XG59XG4vKipcbiAqIFNldCBhIG1pbmltdW0gdGltZSBmb3IgYSBwcm9taXNlIHRvIHJlc29sdmUgKHVzZWZ1bCBmb3IgcHJldmVudGluZyBmbGFzaCBvZiBsb2FkZXJzKVxuICovXG5hc3luYyBmdW5jdGlvbiBtaW5EZWxheShwcm9taXNlLCBtaW5EZWxheSkge1xuICAgIGF3YWl0IFByb21pc2UuYWxsKFtwcm9taXNlLCB0aW1lb3V0KG1pbkRlbGF5KV0pO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuLyoqXG4gKiBIZWxwZXIgbWV0aG9kIHRvIGlubGluZSBzZXRUaW1lb3V0IGFzIGFuIGF3YWl0IGluIGFzeW5jIGZ1bmN0aW9uc1xuICovXG5mdW5jdGlvbiB0aW1lb3V0KG1zKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG59XG5jb25zdCBhcnJheVRvTG9va3VwTWFwID0gKGRhdGFBcnIsIGdldEtleUFuZEl0ZW0pID0+IE9iamVjdC5mcm9tRW50cmllcygoZGF0YUFyciB8fCBbXSkubWFwKChpdGVtKSA9PiB7XG4gICAgY29uc3QgeyBrZXksIGRhdGEgfSA9IGdldEtleUFuZEl0ZW0oaXRlbSk7XG4gICAgcmV0dXJuIFtrZXksIGRhdGFdO1xufSkpO1xuLyoqXG4gKiBDaGVjayB3aGV0aGVyIHR3byBhcnJheXMgaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgZWxlbWVudHNcbiAqIGFuZCB3aGV0aGVyIHRoZXkgY29udGFpbiB0aGUgc2FtZSBlbGVtZW50c1xuICogcmVnYXJkbGVzcyBvZiBvcmRlclxuICovXG5jb25zdCBhcnJheXNBcmVFcXVpdmFsZW50ID0gKGFycjEsIGFycjIpID0+IGFycjEubGVuZ3RoID09PSBhcnIyLmxlbmd0aCAmJiBhcnIxLnJlZHVjZSgobWVtbywgc3RyKSA9PiBtZW1vICYmIGFycjIuaW5kZXhPZihzdHIpID4gLTEsIHRydWUpO1xuZnVuY3Rpb24gdW5pcXVlQnkobXlBcnIsIGdldEl0ZW1JZCkge1xuICAgIGNvbnN0IHJlc3VsdEFyciA9IFtdO1xuICAgIGNvbnN0IGxvb2t1cE1hcCA9IHt9O1xuICAgIG15QXJyLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSBnZXRJdGVtSWQoaXRlbSk7XG4gICAgICAgIGlmIChsb29rdXBNYXBbaWRdID09IG51bGwpIHtcbiAgICAgICAgICAgIGxvb2t1cE1hcFtpZF0gPSBpdGVtO1xuICAgICAgICAgICAgcmVzdWx0QXJyLnB1c2goaXRlbSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0QXJyO1xufVxuZnVuY3Rpb24gdW5pcXVlKG15QXJyKSB7XG4gICAgY29uc3QgcHJpbWl0aXZlcyA9IHsgYm9vbGVhbjoge30sIG51bWJlcjoge30sIHN0cmluZzoge30gfTtcbiAgICBjb25zdCBvYmpzID0gW107XG4gICAgcmV0dXJuIG15QXJyLmZpbHRlcigoaXRlbSkgPT4ge1xuICAgICAgICBsZXQgdHlwZSA9IHR5cGVvZiBpdGVtO1xuICAgICAgICBpZiAodHlwZSBpbiBwcmltaXRpdmVzKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJpbWl0aXZlc1t0eXBlXS5oYXNPd25Qcm9wZXJ0eShpdGVtKSA/IGZhbHNlIDogKHByaW1pdGl2ZXNbdHlwZV1baXRlbV0gPSB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBvYmpzLmluZGV4T2YoaXRlbSkgPj0gMCA/IGZhbHNlIDogb2Jqcy5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5jb25zdCBjaHVuayA9IChhcnIsIHNpemUpID0+IFsuLi5BcnJheShNYXRoLmNlaWwoYXJyLmxlbmd0aCAvIHNpemUpKV0ubWFwKChfLCBpKSA9PiBhcnIuc2xpY2Uoc2l6ZSAqIGksIHNpemUgKyBzaXplICogaSkpO1xuXG5leHBvcnQgeyBhcnJheVRvTG9va3VwTWFwIGFzIGEsIHVuaXF1ZSBhcyBiLCB0aHJvdHRsZSBhcyBjLCBkZWJvdW5jZSBhcyBkLCBlc2NhcGVSZWdFeHAgYXMgZSwgYXJyYXlzQXJlRXF1aXZhbGVudCBhcyBmLCBjaHVuayBhcyBnLCBpc0RlZmluZWQgYXMgaSwgbWluRGVsYXkgYXMgbSwgdGltZW91dCBhcyB0LCB1bmlxdWVCeSBhcyB1IH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZ1bmN0aW9uYWwtNDRkZThmY2YuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyBsIGFzIGxvYWRNb2R1bGVzIH0gZnJvbSAnLi9sb2FkTW9kdWxlcy1iNGFjMTI0Ny5qcyc7XG5pbXBvcnQgeyBjIGFzIGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeSB9IGZyb20gJy4vZG9tLTRkMzY3Njc3LmpzJztcblxuY29uc3QgbGFuZ3VhZ2VNYXAgPSBuZXcgTWFwKFtcbiAgICBbXCJhclwiLCBcImFyXCJdLFxuICAgIFtcImJnXCIsIFwiYmdcIl0sXG4gICAgW1wiYnNcIiwgXCJic1wiXSxcbiAgICBbXCJjYVwiLCBcImNhXCJdLFxuICAgIFtcImNzXCIsIFwiY3NcIl0sXG4gICAgW1wiZGFcIiwgXCJkYVwiXSxcbiAgICBbXCJkZVwiLCBcImRlXCJdLFxuICAgIFtcImVsXCIsIFwiZWxcIl0sXG4gICAgW1wiZW5cIiwgXCJlblwiXSxcbiAgICBbXCJlc1wiLCBcImVzXCJdLFxuICAgIFtcImV0XCIsIFwiZXRcIl0sXG4gICAgW1wiZmlcIiwgXCJmaVwiXSxcbiAgICBbXCJmclwiLCBcImZyXCJdLFxuICAgIFtcImhlXCIsIFwiaGVcIl0sXG4gICAgW1wiaHJcIiwgXCJoclwiXSxcbiAgICBbXCJodVwiLCBcImh1XCJdLFxuICAgIFtcImlkXCIsIFwiaWRcIl0sXG4gICAgW1wiaXRcIiwgXCJpdFwiXSxcbiAgICBbXCJqYVwiLCBcImphXCJdLFxuICAgIFtcImtvXCIsIFwia29cIl0sXG4gICAgW1wibHRcIiwgXCJsdFwiXSxcbiAgICBbXCJsdlwiLCBcImx2XCJdLFxuICAgIFtcIm5iXCIsIFwibmJcIl0sXG4gICAgW1wibmxcIiwgXCJubFwiXSxcbiAgICBbXCJwbFwiLCBcInBsXCJdLFxuICAgIFtcInB0LWJyXCIsIFwicHQtQlJcIl0sXG4gICAgW1wicHQtcHRcIiwgXCJwdC1QVFwiXSxcbiAgICBbXCJyb1wiLCBcInJvXCJdLFxuICAgIFtcInJ1XCIsIFwicnVcIl0sXG4gICAgW1wic2tcIiwgXCJza1wiXSxcbiAgICBbXCJzbFwiLCBcInNsXCJdLFxuICAgIFtcInNyXCIsIFwic3JcIl0sXG4gICAgW1wic3ZcIiwgXCJzdlwiXSxcbiAgICBbXCJ0aFwiLCBcInRoXCJdLFxuICAgIFtcInRyXCIsIFwidHJcIl0sXG4gICAgW1widWtcIiwgXCJ1a1wiXSxcbiAgICBbXCJ2aVwiLCBcInZpXCJdLFxuICAgIFtcInpoLWNuXCIsIFwiemgtQ05cIl0sXG4gICAgW1wiemgtaGtcIiwgXCJ6aC1IS1wiXSxcbiAgICBbXCJ6aC10d1wiLCBcInpoLVRXXCJdXG5dKTtcbi8vIHJ0bFxuZnVuY3Rpb24gZ2V0RWxlbWVudERpcihlbCkge1xuICAgIHJldHVybiBnZXRFbGVtZW50UHJvcChlbCwgXCJkaXJcIiwgXCJsdHJcIik7XG59XG5mdW5jdGlvbiBnZXRFbGVtZW50UHJvcChlbCwgcHJvcCwgdmFsdWUpIHtcbiAgICBjb25zdCBjbG9zZXN0V2l0aFByb3AgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWwsIGBbJHtwcm9wfV1gKTtcbiAgICByZXR1cm4gY2xvc2VzdFdpdGhQcm9wID8gY2xvc2VzdFdpdGhQcm9wLmdldEF0dHJpYnV0ZShwcm9wKSA6IHZhbHVlO1xufVxuLy8gY3NzXG5jb25zdCBDU1NfVVRJTElUWSA9IHtcbiAgICBydGw6IFwiYXJjZ2lzLS1ydGxcIlxufTtcbmFzeW5jIGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW1iZXIsIG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IGFwaSwgdHlwZSwgcGxhY2VzIH0gPSBvcHRpb25zIHx8IHt9O1xuICAgIGlmIChhcGkgPT09IDQpIHtcbiAgICAgICAgY29uc3QgW2ludGxdID0gYXdhaXQgbG9hZE1vZHVsZXMoW1wiZXNyaS9pbnRsXCJdKTtcbiAgICAgICAgY29uc3QgbnVtYmVyRm9ybWF0SW50bE9wdGlvbnMgPSBpbnRsLmNvbnZlcnROdW1iZXJGb3JtYXRUb0ludGxPcHRpb25zKHtcbiAgICAgICAgICAgIHBsYWNlcyxcbiAgICAgICAgICAgIHN0eWxlOiB0eXBlLFxuICAgICAgICAgICAgZGlnaXRTZXBhcmF0b3I6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpbnRsLmZvcm1hdE51bWJlcihudW1iZXIsIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgbnVtYmVyRm9ybWF0SW50bE9wdGlvbnMpLCB7IHN0eWxlOiB0eXBlIH0pKTtcbiAgICB9XG4gICAgY29uc3QgW2Rvam9OdW1iZXJdID0gYXdhaXQgbG9hZE1vZHVsZXMoW1wiZG9qby9udW1iZXJcIl0pO1xuICAgIHJldHVybiBkb2pvTnVtYmVyLmZvcm1hdChudW1iZXIsIHtcbiAgICAgICAgdHlwZSxcbiAgICAgICAgcGxhY2VzLFxuICAgICAgICBwYXR0ZXJuOiBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMucGF0dGVyblxuICAgIH0pO1xufVxuY29uc3QgY2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkge1xuICAgIGNvbnN0IGxhbmcgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZztcbiAgICBjb25zdCBkYXlTaG9ydE1vbnRoWWVhciA9IHtcbiAgICAgICAgeWVhcjogXCJudW1lcmljXCIsXG4gICAgICAgIG1vbnRoOiBcInNob3J0XCIsXG4gICAgICAgIGRheTogXCJudW1lcmljXCJcbiAgICB9O1xuICAgIGlmICghY2FjaGVbbGFuZ10pIHtcbiAgICAgICAgY2FjaGVbbGFuZ10gPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZywgZGF5U2hvcnRNb250aFllYXIpO1xuICAgIH1cbiAgICByZXR1cm4gY2FjaGVbbGFuZ10uZm9ybWF0KGRhdGUpO1xufVxuZnVuY3Rpb24gZm9ybWF0UGx1cmFsKGxhbmcsIHN0cmluZ09iaiwgbnVtYmVyKSB7XG4gICAgY29uc3Qgc2luZ2xlcyA9IFtcImlkXCIsIFwiamFcIiwgXCJrb1wiLCBcInRoXCIsIFwidmlcIiwgXCJ6aC1jblwiLCBcInpoLWhrXCIsIFwiemgtdHdcIl07XG4gICAgY29uc3QgbGlrZUVuZ2xpc2ggPSBbXG4gICAgICAgIFwiZW5cIixcbiAgICAgICAgXCJjYVwiLFxuICAgICAgICBcImRhXCIsXG4gICAgICAgIFwiZGVcIixcbiAgICAgICAgXCJlbFwiLFxuICAgICAgICBcImVzXCIsXG4gICAgICAgIFwiZXRcIixcbiAgICAgICAgXCJmaVwiLFxuICAgICAgICBcImhpXCIsXG4gICAgICAgIFwiaHVcIixcbiAgICAgICAgXCJpdFwiLFxuICAgICAgICBcIm5iXCIsXG4gICAgICAgIFwibmxcIixcbiAgICAgICAgXCJwdC1wdFwiLFxuICAgICAgICBcInN2XCIsXG4gICAgICAgIFwidHJcIlxuICAgIF07XG4gICAgY29uc3QgbG9jYWxlID0gbGFuZyAhPT0gbnVsbCAmJiBsYW5nICE9PSB2b2lkIDAgPyBsYW5nIDogXCJlblwiO1xuICAgIC8vIGlmIHRoZSBudW1iZXIgaXMgb25lLCBvciBpdCBpcyBhIFwic2ltcGxlXCIgbGFuZ3VhZ2UsIHJldHVybiB0aGUgMSBzdHJpbmdcbiAgICBpZiAobnVtYmVyID09PSAxIHx8IHNpbmdsZXMuaW5jbHVkZXMobG9jYWxlKSkge1xuICAgICAgICByZXR1cm4gc3RyaW5nT2JqLnNpbmdsZS5yZXBsYWNlKFwiJHtudW1iZXJ9XCIsIFwiMVwiKTtcbiAgICB9XG4gICAgLy8gaWYgdGhlIG51bWJlciBpcyBub3QgMSBhbmQgdGhlIGxhbmd1YWdlIHVzZXMgdGhlIHNhbWUgcGx1cmFsaXphdGlvbiBzdHJhdGVneSBhcyBlbmdsaXNoLFxuICAgIC8vIHJldHVybiB0aGUgbXVsdGlwbGUgc3RyaW5nXG4gICAgaWYgKG51bWJlciAhPT0gMSAmJiBsaWtlRW5nbGlzaC5pbmNsdWRlcyhsb2NhbGUpKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmdPYmoubXVsdGlwbGUucmVwbGFjZShcIiR7bnVtYmVyfVwiLCBgJHtudW1iZXJ9YCk7XG4gICAgfVxuICAgIC8vIGlmIG5vbmUgb2YgdGhlIGFib3ZlIHdvcmtlZCwgcmV0dXJuIHRoZSBcInVua25vd25cIiBzdHJpbmdcbiAgICByZXR1cm4gc3RyaW5nT2JqLnVua25vd24ucmVwbGFjZShcIiR7bnVtYmVyfVwiLCBgJHtudW1iZXJ9YCk7XG59XG5cbmV4cG9ydCB7IENTU19VVElMSVRZIGFzIEMsIGZvcm1hdERhdGUgYXMgYSwgZm9ybWF0UGx1cmFsIGFzIGIsIGZvcm1hdE51bWJlciBhcyBmLCBnZXRFbGVtZW50RGlyIGFzIGcsIGxhbmd1YWdlTWFwIGFzIGwgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGFuZ3VhZ2VVdGlsLWVmMGU1NGIyLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYyBhcyBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkgfSBmcm9tICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5pbXBvcnQgeyBsIGFzIGxhbmd1YWdlTWFwIH0gZnJvbSAnLi9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMnO1xuaW1wb3J0IHsgYSBhcyBnZXRBc3NldFBhdGggfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcblxuLy8gaHR0cHM6Ly9tZWRpdW0uY29tL3N0ZW5jaWwtdHJpY2tzL2ltcGxlbWVudGluZy1pbnRlcm5hdGlvbmFsaXNhdGlvbi1pMThuLXdpdGgtc3RlbmNpbC01ZTY1NTk1NTQxMTdcbmZ1bmN0aW9uIGdldENvbXBvbmVudENsb3Nlc3RMYW5ndWFnZShlbGVtZW50KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgY29uc3QgY2xvc2VzdEVsZW1lbnQgPSAoX2EgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWxlbWVudCwgXCJbbGFuZ11cIikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYyA9IChfYiA9IGVsZW1lbnQuc2hhZG93Um9vdCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm93bmVyRG9jdW1lbnQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgLy8gbGFuZ3VhZ2Ugc2V0IGJ5IHRoZSBjYWxsaW5nIGFwcGxpY2F0aW9uIG9yIGJyb3dzZXIuIGRlZmF1bHRzIHRvIGVuZ2xpc2guXG4gICAgY29uc3QgbGFuZyA9ICgoY2xvc2VzdEVsZW1lbnQgPT09IG51bGwgfHwgY2xvc2VzdEVsZW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNsb3Nlc3RFbGVtZW50LmxhbmcpIHx8IChuYXZpZ2F0b3IgPT09IG51bGwgfHwgbmF2aWdhdG9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBuYXZpZ2F0b3IubGFuZ3VhZ2UpIHx8IFwiZW5cIikudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAobGFuZ3VhZ2VNYXAuaGFzKGxhbmcpKSB7XG4gICAgICAgIHJldHVybiBsYW5ndWFnZU1hcC5nZXQobGFuZyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvLyBcInJ1LVJVXCIgbWFwcyB0byBcInJ1XCIgdXNlIGNhc2VcbiAgICAgICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nLnNsaWNlKDAsIDIpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGxhbmd1YWdlTWFwLmdldChsYW5nLnNsaWNlKDAsIDIpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcImVuXCI7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2VJbnRsKGVsZW1lbnQpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAvLyBpdCdzIE9LIGlmIHdlIGRvbid0IGhhdmUgdGhlIDQgbGV0dGVyIGxhbmd1YWdlIGZpbGUgZm9yIGl0XG4gICAgLy8gNCBsZXR0ZXIgbGFuZ3VhZ2UgY29kZSBuZWVkZWQgZm9yIGZvcm1hdHRpbmcgbnVtYmVyc1xuICAgIGNvbnN0IGNsb3Nlc3RFbGVtZW50ID0gKF9hID0gY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5KGVsZW1lbnQsIFwiW2xhbmddXCIpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoX2MgPSAoX2IgPSBlbGVtZW50LnNoYWRvd1Jvb3QpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5vd25lckRvY3VtZW50KSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuZG9jdW1lbnRFbGVtZW50O1xuICAgIC8vIGxhbmd1YWdlIHNldCBieSB0aGUgY2FsbGluZyBhcHBsaWNhdGlvbiBvciBicm93c2VyLiBkZWZhdWx0cyB0byBlbmdsaXNoLlxuICAgIGNvbnN0IGxhbmcgPSAoKGNsb3Nlc3RFbGVtZW50ID09PSBudWxsIHx8IGNsb3Nlc3RFbGVtZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjbG9zZXN0RWxlbWVudC5sYW5nKSB8fCAobmF2aWdhdG9yID09PSBudWxsIHx8IG5hdmlnYXRvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmF2aWdhdG9yLmxhbmd1YWdlKSB8fCBcImVuXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nKSkge1xuICAgICAgICByZXR1cm4gbGFuZ3VhZ2VNYXAuZ2V0KGxhbmcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nLnNsaWNlKDAsIDIpKSkge1xuICAgICAgICAgICAgLy8gd2Ugc3VwcG9ydCB0aGUgMiBsZXR0ZXIgY29kZWQgbGFuZ3VhZ2VcbiAgICAgICAgICAgIC8vIGUuZy4gaXQtQ0ggdnMgaXRcbiAgICAgICAgICAgIHJldHVybiBsYW5nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiZW5cIjtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGZldGNoTG9jYWxlU3RyaW5nc0ZvckNvbXBvbmVudChjb21wb25lbnROYW1lLCBsb2NhbGUpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBmZXRjaChnZXRBc3NldFBhdGgoYC4uL2FyY2dpcy1hcHAtYXNzZXRzL2kxOG4vJHtjb21wb25lbnROYW1lfS5pMThuLiR7bG9jYWxlfS5qc29uYCkpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5vaylcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5qc29uKCkpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICB9LCAoKSA9PiByZWplY3QoKSk7XG4gICAgfSk7XG59XG5jb25zdCBzdHJpbmdDYWNoZSA9IHt9O1xuZnVuY3Rpb24gZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIGxvY2FsZSkge1xuICAgIGNvbnN0IGlkID0gYCR7Y29tcG9uZW50TmFtZX0ke2xvY2FsZX1gO1xuICAgIGlmICghc3RyaW5nQ2FjaGVbaWRdKSB7XG4gICAgICAgIHN0cmluZ0NhY2hlW2lkXSA9IGZldGNoTG9jYWxlU3RyaW5nc0ZvckNvbXBvbmVudChjb21wb25lbnROYW1lLCBsb2NhbGUpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyaW5nQ2FjaGVbaWRdO1xufVxuLyoqXG4gKiBHZXQgc3RyaW5ncyBhbmQgbGFuZ3VhZ2UgY29kZXMuXG4gKiBUaGlzIG1ldGhvZCByZXR1cm5zIDIgbGFuZ3VhZ2UgY29kZXMuXG4gKiBUaGUgZmlyc3Qgb25lIHJldHVybnMgYSBjb2RlIHRoYXQncyBhbHNvIHN1cHBvcnRlZCBhcyBhIGxhbmd1YWdlIGZpbGUuXG4gKiBUaGUgc2Vjb25kIG9uZSByZXR1cm5zIGEgY29kZSB3aGVyZSB0aGVyZSBpcyBzdXBwb3J0IGZvciB0aGUgZmlyc3QgMiBsZXR0ZXJzIG9mIHRoZSBjb2RlIGFzIHBhcnQgb2YgYSBsYW5ndWFnZSBmaWxlLFxuICogYnV0IHdpbGwgcmV0dXJuIHRoZSBvcmlnaW5hbCA0IGxldHRlciBjb2RlIGZyb20gdGhlIHBhZ2UuXG4gKiBFLmcuIEZvciBcIml0LWNoXCIgaXQgd2lsbCByZXR1cm4gXCJpdFwiIGFzIHRoZSBmaXJzdCBsYW5ndWFnZSBjb2RlIGFuZCBcIml0LWNoXCIgYXMgdGhlIHNlY29uZC5cbiAqIFRoZSBzZWNvbmQgb25lIGlzIHJlcXVpcmVkIGZvciBlc3JpLmludGwuc2V0TG9jYWxlKCkgdG8gZ2V0IHRoZSBjb3JyZWN0IGZvcm1hdHRpbmcuXG4gKlxuICogSWYgYSB0YWdOYW1lIGlzIHByb3ZpZGVkIGl0IHdpbGwgb3ZlcndpdGUgdGhlIGVsZW1lbnQncyB0YWdOYW1lXG4gKlxuICogIEByZXR1cm4gWyBzdHJpbmdzLCBmaXJzdCBsYW5ndWFnZSBjb2RlLCBzZWNvbmQgbGFuZ3VhZ2UgY29kZV1cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYWxlQ29tcG9uZW50U3RyaW5ncyhlbGVtZW50LCB0YWdOYW1lKSB7XG4gICAgY29uc3QgY29tcG9uZW50TmFtZSA9IHRhZ05hbWUgfHwgZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgY29tcG9uZW50TGFuZ3VhZ2UgPSBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2UoZWxlbWVudCk7XG4gICAgY29uc3QgY29tcG9uZW50TGFuZ3VhZ2VJbnRsID0gZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlSW50bChlbGVtZW50KTtcbiAgICBsZXQgc3RyaW5ncztcbiAgICB0cnkge1xuICAgICAgICBzdHJpbmdzID0gYXdhaXQgZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudExhbmd1YWdlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBubyBsb2NhbGUgZm9yICR7Y29tcG9uZW50TmFtZX0gKCR7Y29tcG9uZW50TGFuZ3VhZ2V9KSBsb2FkaW5nIGRlZmF1bHQgbG9jYWxlIGVuLmApO1xuICAgICAgICBzdHJpbmdzID0gYXdhaXQgZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIFwiZW5cIik7XG4gICAgfVxuICAgIHJldHVybiBbc3RyaW5ncywgY29tcG9uZW50TGFuZ3VhZ2UsIGNvbXBvbmVudExhbmd1YWdlSW50bF07XG59XG5cbmV4cG9ydCB7IGdldENvbXBvbmVudENsb3Nlc3RMYW5ndWFnZSBhcyBhLCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzIGFzIGcgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9jYWxlLTA1MGI2ZGI5LmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuY29uc3QgYnJlYWtwb2ludHMgPSB7XG4gICAgeHhzOiAzMjAsXG4gICAgeHM6IDQ4MCxcbiAgICBzbTogNjQwLFxuICAgIG1kOiA3NjgsXG4gICAgbGc6IDEwMjQsXG4gICAgeGw6IDEyODBcbn07XG5jb25zdCBEUk9QRE9XTl9JQ09OX0RJU1BMQVlfQ1VUT0ZGX1NJWkUgPSA5NjA7XG5mdW5jdGlvbiBzZXR1cFJlc2l6ZU9ic2VydmVyKHN0b3JlKSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBfYjtcbiAgICAoX2EgPSAoX2IgPSBzdG9yZS5zdGF0ZSkucmVzaXplT2JzZXJ2ZXIpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYi5yZXNpemVPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcihyZXNpemVIYW5kbGVyKSk7XG4gICAgcmV0dXJuIHN0b3JlLnN0YXRlLnJlc2l6ZU9ic2VydmVyO1xufVxuLyoqXG4gKiByZXNpemUgaGFuZGxlciB3aWxsIGJlIGNhbGxlZCB3aGVuIGl0ZW1zIGdldCByZXNpemVkXG4gKiBhbiBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2ggZWxlbWVudCwgcGFzc2luZyB0aGUgbmV3IHdpZHRoIGFuZCBoZWlnaHRcbiAqL1xuZnVuY3Rpb24gcmVzaXplSGFuZGxlcihlbnRyaWVzKSB7XG4gICAgZW50cmllcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xuICAgICAgICBpZiAoZW50cnkuY29udGVudFJlY3Qud2lkdGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudChcImFyY2dpc0Jyb3dzZXJSZXNpemVcIiwge1xuICAgICAgICAgICAgICAgIGRldGFpbDogeyB3aWR0aDogZW50cnkuY29udGVudFJlY3Qud2lkdGgsIGhlaWdodDogZW50cnkuY29udGVudFJlY3QuaGVpZ2h0IH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZW50cnkudGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmV4cG9ydCB7IERST1BET1dOX0lDT05fRElTUExBWV9DVVRPRkZfU0laRSBhcyBELCBicmVha3BvaW50cyBhcyBiLCBzZXR1cFJlc2l6ZU9ic2VydmVyIGFzIHMgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVzaXplLWExN2I3MjkyLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYyBhcyBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkgfSBmcm9tICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5cbmNvbnN0IG9uQnJvd3NlckZpbHRlclJlbW92ZSA9IChpZCwgc3RvcmUsIGNhbGxiYWNrKSA9PiB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHN0b3JlLm9uQ2hhbmdlKFwiZmlsdGVyc1wiLCAoZmlsdGVycykgPT4ge1xuICAgICAgICBpZiAoIWZpbHRlcnNbaWRdIHx8ICFmaWx0ZXJzW2lkXS52YWx1ZSkge1xuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbmNvbnN0IG9uUHJldmlld0NoYW5nZSA9IChzdG9yZSwgY2FsbGJhY2spID0+IHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgc3RvcmUub25DaGFuZ2UoXCJwcmV2aWV3XCIsIChwcmV2aWV3KSA9PiB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgfSk7XG59O1xuY29uc3Qgb25Hcm91cElkQ2hhbmdlID0gKHN0b3JlLCBjYWxsYmFjaykgPT4ge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBzdG9yZS5vbkNoYW5nZShcImdyb3VwSWRcIiwgKHByZXZpZXcpID0+IHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICB9KTtcbn07XG5jb25zdCBTVE9SRV9MT09LVVAgPSBuZXcgTWFwKCk7XG5mdW5jdGlvbiBnZXRTdG9yZShlbCwgYnJvd3NlclRhZykge1xuICAgIGNvbnN0IGV4aXN0aW5nU3RvcmUgPSBTVE9SRV9MT09LVVAuZ2V0KGVsKTtcbiAgICBpZiAoZXhpc3RpbmdTdG9yZSkge1xuICAgICAgICByZXR1cm4gZXhpc3RpbmdTdG9yZTtcbiAgICB9XG4gICAgY29uc3QgYnJvd3NlciA9IGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeShlbCwgYnJvd3NlclRhZyk7XG4gICAgaWYgKGJyb3dzZXIpIHtcbiAgICAgICAgU1RPUkVfTE9PS1VQLnNldChlbCwgYnJvd3Nlci5zdG9yZSk7XG4gICAgICAgIHJldHVybiBicm93c2VyLnN0b3JlO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IHsgb25Ccm93c2VyRmlsdGVyUmVtb3ZlIGFzIGEsIG9uR3JvdXBJZENoYW5nZSBhcyBiLCBnZXRTdG9yZSBhcyBnLCBvblByZXZpZXdDaGFuZ2UgYXMgbyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yZS04YjFiMDg0Ni5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmNvbnN0IElURU1fQlJPV1NFUl9CVUlMVF9JTl9GSUxURVJTID0gW1wiZm9sZGVyXCIsIFwiZ3JvdXBcIiwgXCJjb250ZW50VHlwZVwiXTtcbmNvbnN0IElURU1fQlJPV1NFUl9NQVhfSVRFTVMgPSA5OTk5OTsgLy8gYXJiaXRyYXJ5IGxhcmdlIG51bWJlciBzbyBpdCBzaG93IGFsbCBpdGVtc1xuXG5leHBvcnQgeyBJVEVNX0JST1dTRVJfQlVJTFRfSU5fRklMVEVSUyBhcyBJLCBJVEVNX0JST1dTRVJfTUFYX0lURU1TIGFzIGEgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHlwZXMtYTAzMWMxZGEuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5jb25zdCBzb3J0TG9va3VwID0ge1xuICAgIHRpdGxlOiBbXCJhc2NcIiwgXCJhbHBoYWJldGljYWxcIl0sXG4gICAgb3duZXI6IFtcImFzY1wiLCBcImFscGhhYmV0aWNhbFwiXSxcbiAgICBudW12aWV3czogW1wiZGVzY1wiLCBcIm51bVwiXSxcbiAgICByZWxldmFuY2U6IFtcImRlc2NcIl0sXG4gICAgbW9kaWZpZWQ6IFtcImRlc2NcIiwgXCJyZWNlbnRcIl0sXG4gICAgY3JlYXRlZDogW1wiZGVzY1wiLCBcInJlY2VudFwiXSxcbiAgICBzaXplOiBbXCJkZXNjXCIsIFwic2l6ZVwiXVxufTtcbmZ1bmN0aW9uIGdldFNvcnRGaWVsZEluZm8oZmllbGQsIGkxOG4sIHN0b3JlKSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IFtkZWZhdWx0U29ydE9yZGVyLCBsYWJlbFR5cGVdID0gc29ydExvb2t1cFtmaWVsZF07XG4gICAgY29uc3QgbGFiZWwgPSBmaWVsZCA9PT0gXCJtb2RpZmllZFwiICYmICgoX2EgPSBzdG9yZSA9PT0gbnVsbCB8fCBzdG9yZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RvcmUuc3RhdGUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yZWN5Y2xlQmluKSA/IGkxOG4uZGVsZXRlZCA6IGkxOG5bZmllbGRdO1xuICAgIGNvbnN0IHNvcnRPcmRlckxhYmVscyA9IHtcbiAgICAgICAgYXNjOiBpMThuW2Ake2xhYmVsVHlwZX1Bc2NgXSxcbiAgICAgICAgZGVzYzogaTE4bltgJHtsYWJlbFR5cGV9RGVzY2BdXG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBsYWJlbCxcbiAgICAgICAgc2hvd1NvcnRPcmRlcjogISFsYWJlbFR5cGUsXG4gICAgICAgIGRlZmF1bHRTb3J0T3JkZXIsXG4gICAgICAgIHNvcnRPcmRlckxhYmVsc1xuICAgIH07XG59XG5mdW5jdGlvbiBnZXREZWZhdWx0U29ydE9yZGVyKGZpZWxkKSB7XG4gICAgY29uc3QgW2RlZmF1bHRTb3J0T3JkZXJdID0gc29ydExvb2t1cFtmaWVsZF07XG4gICAgcmV0dXJuIGRlZmF1bHRTb3J0T3JkZXI7XG59XG5cbmV4cG9ydCB7IGdldERlZmF1bHRTb3J0T3JkZXIgYXMgYSwgZ2V0U29ydEZpZWxkSW5mbyBhcyBnIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLTJmNDU5ZDZkLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==