"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-e20d65"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping-symbol-button.entry.js":
/*!*************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping-symbol-button.entry.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_smart_mapping_symbol_button: () => (/* binding */ ArcgisSmartMappingSymbolButton)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./raster-unique-value-0976ec7f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-unique-value-0976ec7f.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./commonFunctions-b0830e9e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-b0830e9e.js");
/* harmony import */ var _raster_renderer_a62f152c_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./raster-renderer-a62f152c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-renderer-a62f152c.js");
/* harmony import */ var _raster_symbolStyler_9b32ef48_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./raster-symbolStyler-9b32ef48.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-symbolStyler-9b32ef48.js");
/* harmony import */ var _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./symbolStyler-04635b2b.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/symbolStyler-04635b2b.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./locale-050b6db9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js");
/* harmony import */ var _commonEnums_fcf13661_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./commonEnums-fcf13661.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonEnums-fcf13661.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _location_e26b539f_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./location-e26b539f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/location-e26b539f.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */














const arcgisSmartMappingSymbolButtonCss = ".half{width:49%}.symbol-selector{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:1px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.symbol-selector:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.symbol-selector:active{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.symbol-selector:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.symbol-selector.selected{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.symbol-icon{max-height:30px;overflow:hidden}.symbol-icon.transparent{height:15px;width:100%}.symbol-icon.transparent svg{height:15px;width:95%;stroke:#e0e0e0;stroke-width:1px}.symbol-is-white{background-color:#f3f3f3}.symbol-edit-button{padding:1px;height:18px;width:18px;border:none;cursor:pointer;color:var(--calcite-ui-icon-color)}.symbol-edit-button:focus{outline:none}.classed-color-icon{width:100%;height:16px;overflow:hidden;border-radius:0}.classed-color-icon-section{height:16px;display:inline-block}";

const ArcgisSmartMappingSymbolButton = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisSmartMappingSymbolButtonSymbolChange = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingSymbolButtonSymbolChange", 7);
        this.resizeObserver = new ResizeObserver((boundingRects) => {
            const symbolBox = boundingRects.pop();
            this.symbolNodeWidth = symbolBox.contentRect.width;
        });
        // --------------------------------------------------------------------------
        //
        //  Private methods
        //
        // --------------------------------------------------------------------------
        this.afterCreateSymbolDiv = (options, element, projectionOptions, vnodeSelector, properties, children, isRetry) => {
            var _a;
            if (!element) {
                return;
            }
            const { modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
            const { colors, symbol } = options;
            const parentNode = this.buttonNode;
            const parentNodeWidth = parentNode ? parentNode.getBoundingClientRect().width : 0;
            if (parentNode && !parentNodeWidth && !isRetry) {
                // wait a bit, maybe we can refresh with the correct length of color ramp
                setTimeout(() => this.afterCreateSymbolDiv(options, element, projectionOptions, vnodeSelector, properties, children, true), 500);
                return;
            }
            const padding = 40;
            // remove old symbol if there is one
            while ((_a = element === null || element === void 0 ? void 0 : element.childNodes) === null || _a === void 0 ? void 0 : _a.length) {
                element.removeChild(element.childNodes[0]);
            }
            if (colors) {
                const colorIcon = modules.symbolUtils.renderColorRampPreviewHTML(colors, {
                    align: "horizontal",
                    width: parentNodeWidth ? parentNodeWidth - padding : 150,
                    height: 16
                });
                element.appendChild(colorIcon);
            }
            else if (symbol) {
                const panelWidth = parentNodeWidth
                    ? Math.round(modules.screenUtils.px2pt(parentNodeWidth - padding))
                    : 110;
                const isLine = symbol.type === "simple-line" ||
                    (symbol.type === "cim" && symbol.data.symbol.type === "CIMLineSymbol");
                const isPolygon = symbol.type === "simple-fill" ||
                    (symbol.type === "cim" && symbol.data.symbol.type === "CIMPolygonSymbol");
                const isCimPoint = symbol.type === "cim" && !isLine && !isPolygon;
                const size = isLine
                    ? { width: panelWidth, height: symbol.type === "simple-line" ? 3 : 6 }
                    : isPolygon
                        ? { width: panelWidth, height: 12 }
                        : isCimPoint
                            ? 16
                            : 14;
                modules.symbolUtils
                    .renderPreviewHTML(symbol, {
                    size,
                    symbolConfig: isPolygon ? { isSquareFill: true } : undefined
                })
                    .then((node) => {
                    //console.log("size", size, node);
                    // 12pts = 16px; 16pts = 21px
                    element.style.height = isPolygon ? "16px" : isCimPoint ? "21px" : "auto";
                    element.appendChild(node);
                });
            }
        };
        this.handleClick = async () => {
            const { internalPopoverReferenceElement, label, popoverNode, buttonNode } = this;
            const { strings } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
            if (popoverNode) {
                this.onPopoverClose();
            }
            else {
                (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.E)();
                this.selected = true;
                const symbolStylerDiv = document.createElement("div");
                symbolStylerDiv.className = "symbol-styler-div";
                this.popoverNode = (0,_symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.c)({
                    referenceElement: typeof internalPopoverReferenceElement === "string"
                        ? document.getElementById(internalPopoverReferenceElement)
                        : internalPopoverReferenceElement,
                    heading: label || strings.styler.symbolStyle
                });
                this.popoverNode.addEventListener("arcgisSmartMappingStylerPopoverClose", () => {
                    this.onPopoverClose();
                    // if we do this too early the enter key executes on the focused div
                    setTimeout(() => buttonNode.focus(), 300);
                });
                this.popoverNode.addEventListener("arcgisSmartMappingStylerPopoverDisconnected", () => {
                    this.onPopoverClose();
                });
                const onClickCall = this.getOnClickCall();
                this.symbolStylerWatchScaleHandle = await onClickCall({
                    popoverNode: this.popoverNode,
                    onChange: () => {
                        (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.ab)();
                        this.arcgisSmartMappingSymbolButtonSymbolChange.emit();
                    }
                });
            }
        };
        this.type = undefined;
        this.rampType = undefined;
        this.label = undefined;
        this.hideLabel = undefined;
        this.symbol = undefined;
        this.colors = undefined;
        this.width = undefined;
        this.popoverReferenceElement = undefined;
        this.selected = false;
        this.symbolNodeWidth = undefined;
    }
    //--------------------------------------------------------------------------
    //
    //  public calls
    //
    //--------------------------------------------------------------------------
    async setFocus() {
        var _a;
        (_a = this.buttonNode) === null || _a === void 0 ? void 0 : _a.focus();
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    disconnectedCallback() {
        this.resizeObserver.unobserve(this.buttonNode);
    }
    componentDidLoad() {
        this.internalPopoverReferenceElement = this.popoverReferenceElement;
        if (!this.internalPopoverReferenceElement) {
            const panelNode = (0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_3__.q)(this.hostElement, "calcite-panel");
            const flowItemNode = (0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_3__.q)(this.hostElement, "calcite-flow-item");
            this.internalPopoverReferenceElement = flowItemNode || panelNode;
        }
        // for correct symbol width
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.hostElement);
        this.resizeObserver.observe(this.buttonNode);
    }
    // --------------------------------------------------------------------------
    //
    //  Render Methods
    //
    //--------------------------------------------------------------------------
    render() {
        const { label, width, hideLabel } = this;
        const { strings } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: `block-content-padding ${width === "half" ? "half" : ""}` }, !hideLabel && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { id: "symbol-button-label" }, label || strings.styler.symbolStyle, this.renderSymbolButton())), hideLabel && this.renderSymbolButton())));
    }
    renderSymbolButton() {
        const { rampType, symbol, colors, selected } = this;
        const { layer, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const rendererType = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.i)(layer) ? (0,_raster_renderer_a62f152c_js__WEBPACK_IMPORTED_MODULE_4__.g)() : (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.g)();
        if (rendererType === "raster-class-breaks") {
            colors === null || colors === void 0 ? void 0 : colors.forEach((color, idx) => {
                if (color.r === 0 && color.g === 0 && color.b === 0 && color.a === 0) {
                    colors[idx] = new modules.esriColor([255, 255, 255, 0]);
                }
            });
        }
        // classed ramp
        let colorsIcon = rampType === "discrete" && (colors === null || colors === void 0 ? void 0 : colors.length)
            ? colors.map((color, idx) => {
                var _a;
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { key: `symbol-button-icon-${idx}`, class: "classed-color-icon-section", style: {
                        width: `${95 / Math.min(10, colors.length)}%`,
                        backgroundColor: `${(_a = color === null || color === void 0 ? void 0 : color.toHex()) !== null && _a !== void 0 ? _a : "#ffffff"}`
                    } }));
            })
            : null;
        const isTransparent = !rampType && (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.aE)(symbol);
        const type = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.D)(layer) || "point";
        const symbolClasses = {
            "symbol-selector": true,
            "symbol-is-white": (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.aq)(symbol),
            selected
        };
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: symbolClasses, onClick: this.handleClick, role: "button", tabIndex: 0, "aria-labelledby": "symbol-button-label", "aria-haspopup": "true", "aria-expanded": !!selected, onKeyDown: (event) => {
                if (event.key === " " || event.key === "Enter") {
                    event.preventDefault();
                    event.stopPropagation();
                    this.handleClick();
                }
            }, ref: (node) => this.buttonNode = node }, isTransparent ? (this.renderTransparentSymbol(symbol)) : rampType === "discrete" ? ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "classed-color-icon", "aria-hidden": "true" }, colorsIcon)) : ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { key: `${symbol || colors}`, class: `symbol-icon ${type}`, style: { width: `${this.symbolNodeWidth * 0.95}px` }, ref: (node) => {
                this.afterCreateSymbolDiv({ colors, symbol }, node);
                this.symbolNode = node;
            }, "aria-hidden": "true" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "symbol-edit-button" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { scale: "s", icon: "pencil" }))));
    }
    renderTransparentSymbol(key) {
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { key: key, class: "symbol-icon transparent", "aria-hidden": "true", style: { width: `${this.symbolNodeWidth * 0.95}px` }, ref: (node) => (this.symbolNode = node) }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg", { xmlns: "http://www.w3.org/2000/svg" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("defs", null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("pattern", { id: "16cf9653474-widget-3-bg-fill", patternUnits: "userSpaceOnUse", x: "0", y: "0", width: "15", height: "15" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("image", { x: "0", y: "0", width: "15", height: "15", href: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2Ij48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNjY2MiIC8+PHBhdGggZD0iTTAgMCBMOCAwIEw4IDggTDAgOCBaIiBmaWxsPSIjZmZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDgpIiAvPjxwYXRoIGQ9Ik0wIDAgTDggMCBMOCA4IEwwIDggWiIgZmlsbD0iI2NjYyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCw4KSIgLz48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNmZmYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgsMCkiIC8+PC9zdmc+" }))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("rect", { x: "0", y: "0", fill: "url(#16cf9653474-widget-3-bg-fill)", height: "100%", width: "100%" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("rect", { x: "0", y: "0", fill: "url(#16cf9653474-widget-3-ramp-fill)", height: "100%", width: "100%" }))));
    }
    getOnClickCall() {
        const { type } = this;
        switch (type) {
            case "background":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.o;
            case "simple":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.y;
            case "size":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.x;
            case "color-ramp":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.w;
            case "relationship-ramp":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.v;
            case "geo-rss-point":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.u.bind(this, "point");
            case "geo-rss-line":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.u.bind(this, "line");
            case "geo-rss-polygon":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.u.bind(this, "polygon");
            case "dot-density-ramp":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.t;
            case "dot-density-background":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.q;
            case "dot-density-value":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.b;
            case "heatmap-ramp":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.p;
            case "background":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.o;
            case "predominance-ramp":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.n;
            case "above":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.m;
            case "below":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.l;
            case "chart-ramp":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.k;
            case "type-ramp":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.j;
            case "raster-flow":
                return _raster_symbolStyler_9b32ef48_js__WEBPACK_IMPORTED_MODULE_5__.h;
            case "raster-stretch":
                return _raster_symbolStyler_9b32ef48_js__WEBPACK_IMPORTED_MODULE_5__.g;
            case "raster-shaded-relief":
                return _raster_symbolStyler_9b32ef48_js__WEBPACK_IMPORTED_MODULE_5__.f;
            case "raster-class-breaks":
                return _raster_symbolStyler_9b32ef48_js__WEBPACK_IMPORTED_MODULE_5__.e;
            case "raster-unique-value":
                return _raster_symbolStyler_9b32ef48_js__WEBPACK_IMPORTED_MODULE_5__.d;
            case "default":
                return _symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.i;
        }
    }
    onPopoverClose() {
        var _a;
        (_a = this.symbolStylerWatchScaleHandle) === null || _a === void 0 ? void 0 : _a.remove();
        this.selected = false;
        (0,_symbolStyler_04635b2b_js__WEBPACK_IMPORTED_MODULE_6__.r)(this.popoverNode);
        this.popoverNode = undefined;
    }
    get hostElement() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisSmartMappingSymbolButton.style = arcgisSmartMappingSymbolButtonCss;



//# sourceMappingURL=arcgis-smart-mapping-symbol-button.entry.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLWUyMGQ2NS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQytIO0FBQzRHO0FBQ3hNO0FBQ3FDO0FBQ0c7QUFDbU07QUFDaWM7QUFDM3FCO0FBQ1Q7QUFDRztBQUNLO0FBQ047QUFDRzs7QUFFaEMsaURBQWlELFVBQVUsaUJBQWlCLGFBQWEsWUFBWSw4QkFBOEIsbUJBQW1CLGdCQUFnQixlQUFlLG1EQUFtRCxrQ0FBa0MsK0NBQStDLGlCQUFpQixtQkFBbUIsNkNBQTZDLHVCQUF1Qiw2REFBNkQsd0JBQXdCLDZEQUE2RCx1QkFBdUIsNkRBQTZELDZDQUE2QyxtQkFBbUIsMEJBQTBCLDZEQUE2RCxhQUFhLGdCQUFnQixnQkFBZ0IseUJBQXlCLFlBQVksV0FBVyw2QkFBNkIsWUFBWSxVQUFVLGVBQWUsaUJBQWlCLGlCQUFpQix5QkFBeUIsb0JBQW9CLFlBQVksWUFBWSxXQUFXLFlBQVksZUFBZSxtQ0FBbUMsMEJBQTBCLGFBQWEsb0JBQW9CLFdBQVcsWUFBWSxnQkFBZ0IsZ0JBQWdCLDRCQUE0QixZQUFZLHFCQUFxQjs7QUFFNXhDO0FBQ0E7QUFDQSxRQUFRLHFEQUFnQjtBQUN4QiwwREFBMEQscURBQVc7QUFDckU7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVUsRUFBRSwrREFBaUI7QUFDakQsb0JBQW9CLGlCQUFpQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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REFBNkI7QUFDcEQ7QUFDQSx1QkFBdUIsd0RBQW9DO0FBQzNEO0FBQ0EsdUJBQXVCLHdEQUEwQjtBQUNqRDtBQUNBLHVCQUF1Qix3REFBMEI7QUFDakQ7QUFDQSx1QkFBdUIsd0RBQTBCO0FBQ2pEO0FBQ0EsdUJBQXVCLHdEQUFrQztBQUN6RDtBQUNBLHVCQUF1Qix3REFBd0M7QUFDL0Q7QUFDQSx1QkFBdUIsd0RBQW1DO0FBQzFEO0FBQ0EsdUJBQXVCLHdEQUErQjtBQUN0RDtBQUNBLHVCQUF1Qix3REFBOEI7QUFDckQ7QUFDQSx1QkFBdUIsd0RBQW9DO0FBQzNEO0FBQ0EsdUJBQXVCLHdEQUFrQztBQUN6RDtBQUNBLHVCQUF1Qix3REFBa0M7QUFDekQ7QUFDQSx1QkFBdUIsd0RBQTZCO0FBQ3BEO0FBQ0EsdUJBQXVCLHdEQUE0QjtBQUNuRDtBQUNBLHVCQUF1QiwrREFBOEI7QUFDckQ7QUFDQSx1QkFBdUIsK0RBQWlDO0FBQ3hEO0FBQ0EsdUJBQXVCLCtEQUFzQztBQUM3RDtBQUNBLHVCQUF1QiwrREFBeUM7QUFDaEU7QUFDQSx1QkFBdUIsK0RBQTBDO0FBQ2pFO0FBQ0EsdUJBQXVCLHdEQUEyQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDREQUF5QjtBQUNqQztBQUNBO0FBQ0Esd0JBQXdCLE9BQU8scURBQVU7QUFDekM7QUFDQTs7QUFFZ0Y7O0FBRWhGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLXNtYXJ0LW1hcHBpbmctc3ltYm9sLWJ1dHRvbi5lbnRyeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgZiBhcyBmb3JjZVVwZGF0ZSwgaCwgSCBhcyBIb3N0LCBkIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcbmltcG9ydCB7IEUgYXMgY2xvc2VQb3BvdmVycywgYWIgYXMgdXBkYXRlUmVuZGVyZXIsIGkgYXMgaXNSYXN0ZXJMYXllciwgZyBhcyBnZXRSZW5kZXJlclR5cGUsIGFFIGFzIGlzU3ltYm9sVHJhbnNwYXJlbnQsIGFxIGFzIGlzU3ltYm9sQWxtb3N0V2hpdGUsIHMgYXMgc21hcnRNYXBwaW5nU3RhdGUsIEQgYXMgZ2V0R2VvbWV0cnlUeXBlIH0gZnJvbSAnLi9yYXN0ZXItdW5pcXVlLXZhbHVlLTA5NzZlYzdmLmpzJztcbmltcG9ydCAnLi9sb2FkTW9kdWxlcy1iNGFjMTI0Ny5qcyc7XG5pbXBvcnQgeyBxIGFzIHF1ZXJ5UGFyZW50RWxlbWVudCB9IGZyb20gJy4vY29tbW9uRnVuY3Rpb25zLWIwODMwZTllLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0UmFzdGVyUmVuZGVyZXJUeXBlIH0gZnJvbSAnLi9yYXN0ZXItcmVuZGVyZXItYTYyZjE1MmMuanMnO1xuaW1wb3J0IHsgZCBhcyBidWlsZFN5bWJvbFN0eWxlckZvclJhc3RlclVuaXF1ZVZhbHVlc1JhbXAsIGUgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JSYXN0ZXJDbGFzc0JyZWFrc1JhbXAsIGYgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JSYXN0ZXJTaGFkZWRSZWxpZWYsIGcgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JSYXN0ZXJTdHJldGNoLCBoIGFzIGJ1aWxkU3ltYm9sU3R5bGVyRm9yUmFzdGVyRmxvdyB9IGZyb20gJy4vcmFzdGVyLXN5bWJvbFN0eWxlci05YjMyZWY0OC5qcyc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZVN5bWJvbFN0eWxlclBvcG92ZXIsIGkgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JEZWZhdWx0LCBqIGFzIGJ1aWxkU3ltYm9sU3R5bGVyRm9yVHlwZVJhbXAsIGsgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JDaGFydFJhbXAsIGwgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JDb2xvclNpemVCZWxvdywgbSBhcyBidWlsZFN5bWJvbFN0eWxlckZvckNvbG9yU2l6ZUFib3ZlLCBuIGFzIGJ1aWxkU3ltYm9sU3R5bGVyRm9yUHJlZG9taW5hbmNlUmFtcCwgbyBhcyBidWlsZFN5bWJvbFN0eWxlckZvckJhY2tncm91bmQsIHAgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JIZWF0bWFwUmFtcCwgYiBhcyBidWlsZFN5bWJvbFN0eWxlckZvckRvdERlbnNpdHlWYWx1ZSwgcSBhcyBidWlsZFN5bWJvbFN0eWxlckZvckRvdERlbnNpdHlCYWNrZ3JvdW5kLCB0IGFzIGJ1aWxkU3ltYm9sU3R5bGVyRm9yRG90RGVuc2l0eVJhbXAsIHUgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JHZW9SU1MsIHYgYXMgYnVpbGRTeW1ib2xTdHlsZXJGb3JSZWxhdGlvbnNoaXBSYW1wLCB3IGFzIGJ1aWxkU3ltYm9sU3R5bGVyRm9yQ29sb3JSYW1wLCB4IGFzIGJ1aWxkU3ltYm9sU3R5bGVyRm9yU2l6ZSwgeSBhcyBidWlsZFN5bWJvbFN0eWxlckZvclNpbXBsZSwgciBhcyByZW1vdmVTeW1ib2xTdHlsZXJQb3BvdmVyIH0gZnJvbSAnLi9zeW1ib2xTdHlsZXItMDQ2MzViMmIuanMnO1xuaW1wb3J0ICcuL2xhbmd1YWdlVXRpbC1lZjBlNTRiMi5qcyc7XG5pbXBvcnQgJy4vZG9tLTRkMzY3Njc3LmpzJztcbmltcG9ydCAnLi9sb2NhbGUtMDUwYjZkYjkuanMnO1xuaW1wb3J0ICcuL2NvbW1vbkVudW1zLWZjZjEzNjYxLmpzJztcbmltcG9ydCAnLi9pbmRleC0wNTk1NmNhYi5qcyc7XG5pbXBvcnQgJy4vbG9jYXRpb24tZTI2YjUzOWYuanMnO1xuXG5jb25zdCBhcmNnaXNTbWFydE1hcHBpbmdTeW1ib2xCdXR0b25Dc3MgPSBcIi5oYWxme3dpZHRoOjQ5JX0uc3ltYm9sLXNlbGVjdG9ye2Rpc3BsYXk6ZmxleDtwYWRkaW5nOjZweDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjthbGlnbi1pdGVtczpjZW50ZXI7Ym9yZGVyLXJhZGl1czowO2N1cnNvcjpwb2ludGVyO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTEpO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0xKTtib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTMpO2JvcmRlci13aWR0aDoxcHg7Ym9yZGVyLXN0eWxlOnNvbGlkO2JveC1zaGFkb3c6dHJhbnNwYXJlbnQgMHB4IDBweCAwcHggMXB4IGluc2V0fS5zeW1ib2wtc2VsZWN0b3I6aG92ZXJ7Ym94LXNoYWRvdzppbnNldCAwIDAgMCAxcHggdmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTMpfS5zeW1ib2wtc2VsZWN0b3I6YWN0aXZle2JveC1zaGFkb3c6aW5zZXQgMCAwIDAgMnB4IHZhcigtLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0zKX0uc3ltYm9sLXNlbGVjdG9yOmZvY3Vze2JveC1zaGFkb3c6aW5zZXQgMCAwIDAgMnB4IHZhcigtLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0zKTtvdXRsaW5lOjJweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKTtvdXRsaW5lLW9mZnNldDoycHh9LnN5bWJvbC1zZWxlY3Rvci5zZWxlY3RlZHtib3gtc2hhZG93Omluc2V0IDAgMCAwIDJweCB2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMyl9LnN5bWJvbC1pY29ue21heC1oZWlnaHQ6MzBweDtvdmVyZmxvdzpoaWRkZW59LnN5bWJvbC1pY29uLnRyYW5zcGFyZW50e2hlaWdodDoxNXB4O3dpZHRoOjEwMCV9LnN5bWJvbC1pY29uLnRyYW5zcGFyZW50IHN2Z3toZWlnaHQ6MTVweDt3aWR0aDo5NSU7c3Ryb2tlOiNlMGUwZTA7c3Ryb2tlLXdpZHRoOjFweH0uc3ltYm9sLWlzLXdoaXRle2JhY2tncm91bmQtY29sb3I6I2YzZjNmM30uc3ltYm9sLWVkaXQtYnV0dG9ue3BhZGRpbmc6MXB4O2hlaWdodDoxOHB4O3dpZHRoOjE4cHg7Ym9yZGVyOm5vbmU7Y3Vyc29yOnBvaW50ZXI7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS1pY29uLWNvbG9yKX0uc3ltYm9sLWVkaXQtYnV0dG9uOmZvY3Vze291dGxpbmU6bm9uZX0uY2xhc3NlZC1jb2xvci1pY29ue3dpZHRoOjEwMCU7aGVpZ2h0OjE2cHg7b3ZlcmZsb3c6aGlkZGVuO2JvcmRlci1yYWRpdXM6MH0uY2xhc3NlZC1jb2xvci1pY29uLXNlY3Rpb257aGVpZ2h0OjE2cHg7ZGlzcGxheTppbmxpbmUtYmxvY2t9XCI7XG5cbmNvbnN0IEFyY2dpc1NtYXJ0TWFwcGluZ1N5bWJvbEJ1dHRvbiA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nU3ltYm9sQnV0dG9uU3ltYm9sQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNTbWFydE1hcHBpbmdTeW1ib2xCdXR0b25TeW1ib2xDaGFuZ2VcIiwgNyk7XG4gICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGJvdW5kaW5nUmVjdHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN5bWJvbEJveCA9IGJvdW5kaW5nUmVjdHMucG9wKCk7XG4gICAgICAgICAgICB0aGlzLnN5bWJvbE5vZGVXaWR0aCA9IHN5bWJvbEJveC5jb250ZW50UmVjdC53aWR0aDtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vXG4gICAgICAgIC8vICBQcml2YXRlIG1ldGhvZHNcbiAgICAgICAgLy9cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgdGhpcy5hZnRlckNyZWF0ZVN5bWJvbERpdiA9IChvcHRpb25zLCBlbGVtZW50LCBwcm9qZWN0aW9uT3B0aW9ucywgdm5vZGVTZWxlY3RvciwgcHJvcGVydGllcywgY2hpbGRyZW4sIGlzUmV0cnkpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHsgbW9kdWxlcyB9ID0gc21hcnRNYXBwaW5nU3RhdGU7XG4gICAgICAgICAgICBjb25zdCB7IGNvbG9ycywgc3ltYm9sIH0gPSBvcHRpb25zO1xuICAgICAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IHRoaXMuYnV0dG9uTm9kZTtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudE5vZGVXaWR0aCA9IHBhcmVudE5vZGUgPyBwYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoIDogMDtcbiAgICAgICAgICAgIGlmIChwYXJlbnROb2RlICYmICFwYXJlbnROb2RlV2lkdGggJiYgIWlzUmV0cnkpIHtcbiAgICAgICAgICAgICAgICAvLyB3YWl0IGEgYml0LCBtYXliZSB3ZSBjYW4gcmVmcmVzaCB3aXRoIHRoZSBjb3JyZWN0IGxlbmd0aCBvZiBjb2xvciByYW1wXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmFmdGVyQ3JlYXRlU3ltYm9sRGl2KG9wdGlvbnMsIGVsZW1lbnQsIHByb2plY3Rpb25PcHRpb25zLCB2bm9kZVNlbGVjdG9yLCBwcm9wZXJ0aWVzLCBjaGlsZHJlbiwgdHJ1ZSksIDUwMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcGFkZGluZyA9IDQwO1xuICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBzeW1ib2wgaWYgdGhlcmUgaXMgb25lXG4gICAgICAgICAgICB3aGlsZSAoKF9hID0gZWxlbWVudCA9PT0gbnVsbCB8fCBlbGVtZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlbGVtZW50LmNoaWxkTm9kZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQuY2hpbGROb2Rlc1swXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29sb3JzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29sb3JJY29uID0gbW9kdWxlcy5zeW1ib2xVdGlscy5yZW5kZXJDb2xvclJhbXBQcmV2aWV3SFRNTChjb2xvcnMsIHtcbiAgICAgICAgICAgICAgICAgICAgYWxpZ246IFwiaG9yaXpvbnRhbFwiLFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogcGFyZW50Tm9kZVdpZHRoID8gcGFyZW50Tm9kZVdpZHRoIC0gcGFkZGluZyA6IDE1MCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxNlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY29sb3JJY29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHN5bWJvbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhbmVsV2lkdGggPSBwYXJlbnROb2RlV2lkdGhcbiAgICAgICAgICAgICAgICAgICAgPyBNYXRoLnJvdW5kKG1vZHVsZXMuc2NyZWVuVXRpbHMucHgycHQocGFyZW50Tm9kZVdpZHRoIC0gcGFkZGluZykpXG4gICAgICAgICAgICAgICAgICAgIDogMTEwO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzTGluZSA9IHN5bWJvbC50eXBlID09PSBcInNpbXBsZS1saW5lXCIgfHxcbiAgICAgICAgICAgICAgICAgICAgKHN5bWJvbC50eXBlID09PSBcImNpbVwiICYmIHN5bWJvbC5kYXRhLnN5bWJvbC50eXBlID09PSBcIkNJTUxpbmVTeW1ib2xcIik7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNQb2x5Z29uID0gc3ltYm9sLnR5cGUgPT09IFwic2ltcGxlLWZpbGxcIiB8fFxuICAgICAgICAgICAgICAgICAgICAoc3ltYm9sLnR5cGUgPT09IFwiY2ltXCIgJiYgc3ltYm9sLmRhdGEuc3ltYm9sLnR5cGUgPT09IFwiQ0lNUG9seWdvblN5bWJvbFwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpc0NpbVBvaW50ID0gc3ltYm9sLnR5cGUgPT09IFwiY2ltXCIgJiYgIWlzTGluZSAmJiAhaXNQb2x5Z29uO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpemUgPSBpc0xpbmVcbiAgICAgICAgICAgICAgICAgICAgPyB7IHdpZHRoOiBwYW5lbFdpZHRoLCBoZWlnaHQ6IHN5bWJvbC50eXBlID09PSBcInNpbXBsZS1saW5lXCIgPyAzIDogNiB9XG4gICAgICAgICAgICAgICAgICAgIDogaXNQb2x5Z29uXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHsgd2lkdGg6IHBhbmVsV2lkdGgsIGhlaWdodDogMTIgfVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBpc0NpbVBvaW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAxNlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMTQ7XG4gICAgICAgICAgICAgICAgbW9kdWxlcy5zeW1ib2xVdGlsc1xuICAgICAgICAgICAgICAgICAgICAucmVuZGVyUHJldmlld0hUTUwoc3ltYm9sLCB7XG4gICAgICAgICAgICAgICAgICAgIHNpemUsXG4gICAgICAgICAgICAgICAgICAgIHN5bWJvbENvbmZpZzogaXNQb2x5Z29uID8geyBpc1NxdWFyZUZpbGw6IHRydWUgfSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChub2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJzaXplXCIsIHNpemUsIG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAvLyAxMnB0cyA9IDE2cHg7IDE2cHRzID0gMjFweFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmhlaWdodCA9IGlzUG9seWdvbiA/IFwiMTZweFwiIDogaXNDaW1Qb2ludCA/IFwiMjFweFwiIDogXCJhdXRvXCI7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlQ2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGludGVybmFsUG9wb3ZlclJlZmVyZW5jZUVsZW1lbnQsIGxhYmVsLCBwb3BvdmVyTm9kZSwgYnV0dG9uTm9kZSB9ID0gdGhpcztcbiAgICAgICAgICAgIGNvbnN0IHsgc3RyaW5ncyB9ID0gc21hcnRNYXBwaW5nU3RhdGU7XG4gICAgICAgICAgICBpZiAocG9wb3Zlck5vZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uUG9wb3ZlckNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbG9zZVBvcG92ZXJzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3ltYm9sU3R5bGVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgICAgICBzeW1ib2xTdHlsZXJEaXYuY2xhc3NOYW1lID0gXCJzeW1ib2wtc3R5bGVyLWRpdlwiO1xuICAgICAgICAgICAgICAgIHRoaXMucG9wb3Zlck5vZGUgPSBjcmVhdGVTeW1ib2xTdHlsZXJQb3BvdmVyKHtcbiAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlRWxlbWVudDogdHlwZW9mIGludGVybmFsUG9wb3ZlclJlZmVyZW5jZUVsZW1lbnQgPT09IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaW50ZXJuYWxQb3BvdmVyUmVmZXJlbmNlRWxlbWVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogaW50ZXJuYWxQb3BvdmVyUmVmZXJlbmNlRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZzogbGFiZWwgfHwgc3RyaW5ncy5zdHlsZXIuc3ltYm9sU3R5bGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcG92ZXJOb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNTbWFydE1hcHBpbmdTdHlsZXJQb3BvdmVyQ2xvc2VcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uUG9wb3ZlckNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvIHRoaXMgdG9vIGVhcmx5IHRoZSBlbnRlciBrZXkgZXhlY3V0ZXMgb24gdGhlIGZvY3VzZWQgZGl2XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gYnV0dG9uTm9kZS5mb2N1cygpLCAzMDApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMucG9wb3Zlck5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc1NtYXJ0TWFwcGluZ1N0eWxlclBvcG92ZXJEaXNjb25uZWN0ZWRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uUG9wb3ZlckNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb25DbGlja0NhbGwgPSB0aGlzLmdldE9uQ2xpY2tDYWxsKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zeW1ib2xTdHlsZXJXYXRjaFNjYWxlSGFuZGxlID0gYXdhaXQgb25DbGlja0NhbGwoe1xuICAgICAgICAgICAgICAgICAgICBwb3BvdmVyTm9kZTogdGhpcy5wb3BvdmVyTm9kZSxcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVJlbmRlcmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ1N5bWJvbEJ1dHRvblN5bWJvbENoYW5nZS5lbWl0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy50eXBlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJhbXBUeXBlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxhYmVsID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmhpZGVMYWJlbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zeW1ib2wgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuY29sb3JzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLndpZHRoID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvcG92ZXJSZWZlcmVuY2VFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3ltYm9sTm9kZVdpZHRoID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgcHVibGljIGNhbGxzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgc2V0Rm9jdXMoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgKF9hID0gdGhpcy5idXR0b25Ob2RlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZm9jdXMoKTtcbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIExpZmVjeWNsZVxuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyLnVub2JzZXJ2ZSh0aGlzLmJ1dHRvbk5vZGUpO1xuICAgIH1cbiAgICBjb21wb25lbnREaWRMb2FkKCkge1xuICAgICAgICB0aGlzLmludGVybmFsUG9wb3ZlclJlZmVyZW5jZUVsZW1lbnQgPSB0aGlzLnBvcG92ZXJSZWZlcmVuY2VFbGVtZW50O1xuICAgICAgICBpZiAoIXRoaXMuaW50ZXJuYWxQb3BvdmVyUmVmZXJlbmNlRWxlbWVudCkge1xuICAgICAgICAgICAgY29uc3QgcGFuZWxOb2RlID0gcXVlcnlQYXJlbnRFbGVtZW50KHRoaXMuaG9zdEVsZW1lbnQsIFwiY2FsY2l0ZS1wYW5lbFwiKTtcbiAgICAgICAgICAgIGNvbnN0IGZsb3dJdGVtTm9kZSA9IHF1ZXJ5UGFyZW50RWxlbWVudCh0aGlzLmhvc3RFbGVtZW50LCBcImNhbGNpdGUtZmxvdy1pdGVtXCIpO1xuICAgICAgICAgICAgdGhpcy5pbnRlcm5hbFBvcG92ZXJSZWZlcmVuY2VFbGVtZW50ID0gZmxvd0l0ZW1Ob2RlIHx8IHBhbmVsTm9kZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBmb3IgY29ycmVjdCBzeW1ib2wgd2lkdGhcbiAgICAgICAgZm9yY2VVcGRhdGUodGhpcy5ob3N0RWxlbWVudCk7XG4gICAgICAgIHRoaXMucmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmJ1dHRvbk5vZGUpO1xuICAgIH1cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFJlbmRlciBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCB7IGxhYmVsLCB3aWR0aCwgaGlkZUxhYmVsIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7IHN0cmluZ3MgfSA9IHNtYXJ0TWFwcGluZ1N0YXRlO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImRpdlwiLCB7IGNsYXNzOiBgYmxvY2stY29udGVudC1wYWRkaW5nICR7d2lkdGggPT09IFwiaGFsZlwiID8gXCJoYWxmXCIgOiBcIlwifWAgfSwgIWhpZGVMYWJlbCAmJiAoaChcImNhbGNpdGUtbGFiZWxcIiwgeyBpZDogXCJzeW1ib2wtYnV0dG9uLWxhYmVsXCIgfSwgbGFiZWwgfHwgc3RyaW5ncy5zdHlsZXIuc3ltYm9sU3R5bGUsIHRoaXMucmVuZGVyU3ltYm9sQnV0dG9uKCkpKSwgaGlkZUxhYmVsICYmIHRoaXMucmVuZGVyU3ltYm9sQnV0dG9uKCkpKSk7XG4gICAgfVxuICAgIHJlbmRlclN5bWJvbEJ1dHRvbigpIHtcbiAgICAgICAgY29uc3QgeyByYW1wVHlwZSwgc3ltYm9sLCBjb2xvcnMsIHNlbGVjdGVkIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7IGxheWVyLCBtb2R1bGVzIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgY29uc3QgcmVuZGVyZXJUeXBlID0gaXNSYXN0ZXJMYXllcihsYXllcikgPyBnZXRSYXN0ZXJSZW5kZXJlclR5cGUoKSA6IGdldFJlbmRlcmVyVHlwZSgpO1xuICAgICAgICBpZiAocmVuZGVyZXJUeXBlID09PSBcInJhc3Rlci1jbGFzcy1icmVha3NcIikge1xuICAgICAgICAgICAgY29sb3JzID09PSBudWxsIHx8IGNvbG9ycyA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29sb3JzLmZvckVhY2goKGNvbG9yLCBpZHgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY29sb3IuciA9PT0gMCAmJiBjb2xvci5nID09PSAwICYmIGNvbG9yLmIgPT09IDAgJiYgY29sb3IuYSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnNbaWR4XSA9IG5ldyBtb2R1bGVzLmVzcmlDb2xvcihbMjU1LCAyNTUsIDI1NSwgMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIGNsYXNzZWQgcmFtcFxuICAgICAgICBsZXQgY29sb3JzSWNvbiA9IHJhbXBUeXBlID09PSBcImRpc2NyZXRlXCIgJiYgKGNvbG9ycyA9PT0gbnVsbCB8fCBjb2xvcnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbG9ycy5sZW5ndGgpXG4gICAgICAgICAgICA/IGNvbG9ycy5tYXAoKGNvbG9yLCBpZHgpID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiZGl2XCIsIHsga2V5OiBgc3ltYm9sLWJ1dHRvbi1pY29uLSR7aWR4fWAsIGNsYXNzOiBcImNsYXNzZWQtY29sb3ItaWNvbi1zZWN0aW9uXCIsIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogYCR7OTUgLyBNYXRoLm1pbigxMCwgY29sb3JzLmxlbmd0aCl9JWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGAkeyhfYSA9IGNvbG9yID09PSBudWxsIHx8IGNvbG9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb2xvci50b0hleCgpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBcIiNmZmZmZmZcIn1gXG4gICAgICAgICAgICAgICAgICAgIH0gfSkpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgY29uc3QgaXNUcmFuc3BhcmVudCA9ICFyYW1wVHlwZSAmJiBpc1N5bWJvbFRyYW5zcGFyZW50KHN5bWJvbCk7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBnZXRHZW9tZXRyeVR5cGUobGF5ZXIpIHx8IFwicG9pbnRcIjtcbiAgICAgICAgY29uc3Qgc3ltYm9sQ2xhc3NlcyA9IHtcbiAgICAgICAgICAgIFwic3ltYm9sLXNlbGVjdG9yXCI6IHRydWUsXG4gICAgICAgICAgICBcInN5bWJvbC1pcy13aGl0ZVwiOiBpc1N5bWJvbEFsbW9zdFdoaXRlKHN5bWJvbCksXG4gICAgICAgICAgICBzZWxlY3RlZFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBjbGFzczogc3ltYm9sQ2xhc3Nlcywgb25DbGljazogdGhpcy5oYW5kbGVDbGljaywgcm9sZTogXCJidXR0b25cIiwgdGFiSW5kZXg6IDAsIFwiYXJpYS1sYWJlbGxlZGJ5XCI6IFwic3ltYm9sLWJ1dHRvbi1sYWJlbFwiLCBcImFyaWEtaGFzcG9wdXBcIjogXCJ0cnVlXCIsIFwiYXJpYS1leHBhbmRlZFwiOiAhIXNlbGVjdGVkLCBvbktleURvd246IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IFwiIFwiIHx8IGV2ZW50LmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNsaWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgcmVmOiAobm9kZSkgPT4gdGhpcy5idXR0b25Ob2RlID0gbm9kZSB9LCBpc1RyYW5zcGFyZW50ID8gKHRoaXMucmVuZGVyVHJhbnNwYXJlbnRTeW1ib2woc3ltYm9sKSkgOiByYW1wVHlwZSA9PT0gXCJkaXNjcmV0ZVwiID8gKGgoXCJkaXZcIiwgeyBjbGFzczogXCJjbGFzc2VkLWNvbG9yLWljb25cIiwgXCJhcmlhLWhpZGRlblwiOiBcInRydWVcIiB9LCBjb2xvcnNJY29uKSkgOiAoaChcImRpdlwiLCB7IGtleTogYCR7c3ltYm9sIHx8IGNvbG9yc31gLCBjbGFzczogYHN5bWJvbC1pY29uICR7dHlwZX1gLCBzdHlsZTogeyB3aWR0aDogYCR7dGhpcy5zeW1ib2xOb2RlV2lkdGggKiAwLjk1fXB4YCB9LCByZWY6IChub2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZnRlckNyZWF0ZVN5bWJvbERpdih7IGNvbG9ycywgc3ltYm9sIH0sIG5vZGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ltYm9sTm9kZSA9IG5vZGU7XG4gICAgICAgICAgICB9LCBcImFyaWEtaGlkZGVuXCI6IFwidHJ1ZVwiIH0pKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcInN5bWJvbC1lZGl0LWJ1dHRvblwiIH0sIGgoXCJjYWxjaXRlLWljb25cIiwgeyBzY2FsZTogXCJzXCIsIGljb246IFwicGVuY2lsXCIgfSkpKSk7XG4gICAgfVxuICAgIHJlbmRlclRyYW5zcGFyZW50U3ltYm9sKGtleSkge1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBrZXk6IGtleSwgY2xhc3M6IFwic3ltYm9sLWljb24gdHJhbnNwYXJlbnRcIiwgXCJhcmlhLWhpZGRlblwiOiBcInRydWVcIiwgc3R5bGU6IHsgd2lkdGg6IGAke3RoaXMuc3ltYm9sTm9kZVdpZHRoICogMC45NX1weGAgfSwgcmVmOiAobm9kZSkgPT4gKHRoaXMuc3ltYm9sTm9kZSA9IG5vZGUpIH0sIGgoXCJzdmdcIiwgeyB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIH0sIGgoXCJkZWZzXCIsIG51bGwsIGgoXCJwYXR0ZXJuXCIsIHsgaWQ6IFwiMTZjZjk2NTM0NzQtd2lkZ2V0LTMtYmctZmlsbFwiLCBwYXR0ZXJuVW5pdHM6IFwidXNlclNwYWNlT25Vc2VcIiwgeDogXCIwXCIsIHk6IFwiMFwiLCB3aWR0aDogXCIxNVwiLCBoZWlnaHQ6IFwiMTVcIiB9LCBoKFwiaW1hZ2VcIiwgeyB4OiBcIjBcIiwgeTogXCIwXCIsIHdpZHRoOiBcIjE1XCIsIGhlaWdodDogXCIxNVwiLCBocmVmOiBcImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIWmxjbk5wYjI0OUlqRXVNU0lnYUdWcFoyaDBQU0l4TmlJZ2QybGtkR2c5SWpFMklqNDhjR0YwYUNCa1BTSk5NQ0F3SUV3NElEQWdURGdnT0NCTU1DQTRJRm9pSUdacGJHdzlJaU5qWTJNaUlDOCtQSEJoZEdnZ1pEMGlUVEFnTUNCTU9DQXdJRXc0SURnZ1REQWdPQ0JhSWlCbWFXeHNQU0lqWm1abUlpQjBjbUZ1YzJadmNtMDlJblJ5WVc1emJHRjBaU2d3TERncElpQXZQanh3WVhSb0lHUTlJazB3SURBZ1REZ2dNQ0JNT0NBNElFd3dJRGdnV2lJZ1ptbHNiRDBpSTJOall5SWdkSEpoYm5ObWIzSnRQU0owY21GdWMyeGhkR1VvT0N3NEtTSWdMejQ4Y0dGMGFDQmtQU0pOTUNBd0lFdzRJREFnVERnZ09DQk1NQ0E0SUZvaUlHWnBiR3c5SWlObVptWWlJSFJ5WVc1elptOXliVDBpZEhKaGJuTnNZWFJsS0Rnc01Da2lJQzgrUEM5emRtYytcIiB9KSkpLCBoKFwicmVjdFwiLCB7IHg6IFwiMFwiLCB5OiBcIjBcIiwgZmlsbDogXCJ1cmwoIzE2Y2Y5NjUzNDc0LXdpZGdldC0zLWJnLWZpbGwpXCIsIGhlaWdodDogXCIxMDAlXCIsIHdpZHRoOiBcIjEwMCVcIiB9KSwgaChcInJlY3RcIiwgeyB4OiBcIjBcIiwgeTogXCIwXCIsIGZpbGw6IFwidXJsKCMxNmNmOTY1MzQ3NC13aWRnZXQtMy1yYW1wLWZpbGwpXCIsIGhlaWdodDogXCIxMDAlXCIsIHdpZHRoOiBcIjEwMCVcIiB9KSkpKTtcbiAgICB9XG4gICAgZ2V0T25DbGlja0NhbGwoKSB7XG4gICAgICAgIGNvbnN0IHsgdHlwZSB9ID0gdGhpcztcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwiYmFja2dyb3VuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZFN5bWJvbFN0eWxlckZvckJhY2tncm91bmQ7XG4gICAgICAgICAgICBjYXNlIFwic2ltcGxlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkU3ltYm9sU3R5bGVyRm9yU2ltcGxlO1xuICAgICAgICAgICAgY2FzZSBcInNpemVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JTaXplO1xuICAgICAgICAgICAgY2FzZSBcImNvbG9yLXJhbXBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JDb2xvclJhbXA7XG4gICAgICAgICAgICBjYXNlIFwicmVsYXRpb25zaGlwLXJhbXBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JSZWxhdGlvbnNoaXBSYW1wO1xuICAgICAgICAgICAgY2FzZSBcImdlby1yc3MtcG9pbnRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JHZW9SU1MuYmluZCh0aGlzLCBcInBvaW50XCIpO1xuICAgICAgICAgICAgY2FzZSBcImdlby1yc3MtbGluZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZFN5bWJvbFN0eWxlckZvckdlb1JTUy5iaW5kKHRoaXMsIFwibGluZVwiKTtcbiAgICAgICAgICAgIGNhc2UgXCJnZW8tcnNzLXBvbHlnb25cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JHZW9SU1MuYmluZCh0aGlzLCBcInBvbHlnb25cIik7XG4gICAgICAgICAgICBjYXNlIFwiZG90LWRlbnNpdHktcmFtcFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZFN5bWJvbFN0eWxlckZvckRvdERlbnNpdHlSYW1wO1xuICAgICAgICAgICAgY2FzZSBcImRvdC1kZW5zaXR5LWJhY2tncm91bmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JEb3REZW5zaXR5QmFja2dyb3VuZDtcbiAgICAgICAgICAgIGNhc2UgXCJkb3QtZGVuc2l0eS12YWx1ZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZFN5bWJvbFN0eWxlckZvckRvdERlbnNpdHlWYWx1ZTtcbiAgICAgICAgICAgIGNhc2UgXCJoZWF0bWFwLXJhbXBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JIZWF0bWFwUmFtcDtcbiAgICAgICAgICAgIGNhc2UgXCJiYWNrZ3JvdW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkU3ltYm9sU3R5bGVyRm9yQmFja2dyb3VuZDtcbiAgICAgICAgICAgIGNhc2UgXCJwcmVkb21pbmFuY2UtcmFtcFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZFN5bWJvbFN0eWxlckZvclByZWRvbWluYW5jZVJhbXA7XG4gICAgICAgICAgICBjYXNlIFwiYWJvdmVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JDb2xvclNpemVBYm92ZTtcbiAgICAgICAgICAgIGNhc2UgXCJiZWxvd1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZFN5bWJvbFN0eWxlckZvckNvbG9yU2l6ZUJlbG93O1xuICAgICAgICAgICAgY2FzZSBcImNoYXJ0LXJhbXBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JDaGFydFJhbXA7XG4gICAgICAgICAgICBjYXNlIFwidHlwZS1yYW1wXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkU3ltYm9sU3R5bGVyRm9yVHlwZVJhbXA7XG4gICAgICAgICAgICBjYXNlIFwicmFzdGVyLWZsb3dcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JSYXN0ZXJGbG93O1xuICAgICAgICAgICAgY2FzZSBcInJhc3Rlci1zdHJldGNoXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkU3ltYm9sU3R5bGVyRm9yUmFzdGVyU3RyZXRjaDtcbiAgICAgICAgICAgIGNhc2UgXCJyYXN0ZXItc2hhZGVkLXJlbGllZlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBidWlsZFN5bWJvbFN0eWxlckZvclJhc3RlclNoYWRlZFJlbGllZjtcbiAgICAgICAgICAgIGNhc2UgXCJyYXN0ZXItY2xhc3MtYnJlYWtzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkU3ltYm9sU3R5bGVyRm9yUmFzdGVyQ2xhc3NCcmVha3NSYW1wO1xuICAgICAgICAgICAgY2FzZSBcInJhc3Rlci11bmlxdWUtdmFsdWVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JSYXN0ZXJVbmlxdWVWYWx1ZXNSYW1wO1xuICAgICAgICAgICAgY2FzZSBcImRlZmF1bHRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRTeW1ib2xTdHlsZXJGb3JEZWZhdWx0O1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uUG9wb3ZlckNsb3NlKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIChfYSA9IHRoaXMuc3ltYm9sU3R5bGVyV2F0Y2hTY2FsZUhhbmRsZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgIHJlbW92ZVN5bWJvbFN0eWxlclBvcG92ZXIodGhpcy5wb3BvdmVyTm9kZSk7XG4gICAgICAgIHRoaXMucG9wb3Zlck5vZGUgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGdldCBob3N0RWxlbWVudCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5BcmNnaXNTbWFydE1hcHBpbmdTeW1ib2xCdXR0b24uc3R5bGUgPSBhcmNnaXNTbWFydE1hcHBpbmdTeW1ib2xCdXR0b25Dc3M7XG5cbmV4cG9ydCB7IEFyY2dpc1NtYXJ0TWFwcGluZ1N5bWJvbEJ1dHRvbiBhcyBhcmNnaXNfc21hcnRfbWFwcGluZ19zeW1ib2xfYnV0dG9uIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFyY2dpcy1zbWFydC1tYXBwaW5nLXN5bWJvbC1idXR0b24uZW50cnkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9