"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_ba-infographic_node_modules_arcgis_business-analyst-components_dis-5bda86"],{

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-date-picker.entry.js":
/*!**********************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-date-picker.entry.js ***!
  \**********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calcite_date_picker: () => (/* binding */ DatePicker)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./date-19bc8c04.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-19bc8c04.js");
/* harmony import */ var _locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./locale-706df4c7.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-706df4c7.js");
/* harmony import */ var _t9n_9603ff05_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./t9n-9603ff05.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/t9n-9603ff05.js");
/* harmony import */ var _utils_af03caad_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils-af03caad.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/utils-af03caad.js");












/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const HEADING_LEVEL = 2;

const datePickerCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{position:relative;display:inline-block;inline-size:100%;overflow:visible;border-radius:0px;border-width:1px;border-style:solid;border-color:var(--calcite-ui-border-1);background-color:var(--calcite-ui-foreground-1);vertical-align:top}:host([scale=s]){max-inline-size:216px}:host([scale=m]){max-inline-size:286px}:host([scale=l]){max-inline-size:398px}";

const DatePicker = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteDatePickerChange = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteDatePickerChange", 6);
    this.calciteDatePickerRangeChange = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteDatePickerRangeChange", 6);
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    this.keyDownHandler = (event) => {
      if (event.key === "Escape") {
        this.reset();
      }
    };
    this.monthHeaderSelectChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthActiveDateChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthHoverChange = (event) => {
      if (!this.range) {
        this.hoverRange = undefined;
        return;
      }
      const { valueAsDate } = this;
      const start = Array.isArray(valueAsDate) && valueAsDate[0];
      const end = Array.isArray(valueAsDate) && valueAsDate[1];
      const date = new Date(event.detail);
      this.hoverRange = {
        focused: this.activeRange || "start",
        start,
        end
      };
      if (!this.proximitySelectionDisabled) {
        if (end) {
          const startDiff = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, start);
          const endDiff = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, end);
          if (endDiff > 0) {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
          else if (startDiff < 0) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else if (startDiff > endDiff) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          if (start) {
            if (date < start) {
              this.hoverRange = {
                focused: "start",
                start: date,
                end: start
              };
            }
            else {
              this.hoverRange.end = date;
              this.hoverRange.focused = "end";
            }
          }
        }
      }
      else {
        if (!end) {
          if (date < start) {
            this.hoverRange = {
              focused: "start",
              start: date,
              end: start
            };
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          this.hoverRange = undefined;
        }
      }
      event.stopPropagation();
    };
    this.monthMouseOutChange = () => {
      if (this.hoverRange) {
        this.hoverRange = undefined;
      }
    };
    /**
     * Reset active date and close
     */
    this.reset = () => {
      const { valueAsDate } = this;
      if (!Array.isArray(valueAsDate) &&
        valueAsDate &&
        valueAsDate?.getTime() !== this.activeDate?.getTime()) {
        this.activeDate = new Date(valueAsDate);
      }
      if (Array.isArray(valueAsDate)) {
        if (valueAsDate[0] &&
          valueAsDate[0]?.getTime() !==
            (this.activeStartDate instanceof Date && this.activeStartDate?.getTime())) {
          this.activeStartDate = new Date(valueAsDate[0]);
        }
        if (valueAsDate[1] &&
          valueAsDate[1]?.getTime() !==
            (this.activeStartDate instanceof Date && this.activeEndDate?.getTime())) {
          this.activeEndDate = new Date(valueAsDate[1]);
        }
      }
    };
    /**
     * Event handler for when the selected date changes
     *
     * @param event
     */
    this.monthDateChange = (event) => {
      const date = new Date(event.detail);
      const isoDate = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.b)(date);
      if (!this.range && isoDate === (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.b)(this.valueAsDate)) {
        return;
      }
      if (!this.range) {
        this.value = isoDate || "";
        this.valueAsDate = date || null;
        this.activeDate = date || null;
        this.calciteDatePickerChange.emit();
        return;
      }
      const start = this.getStartDate();
      const end = this.getEndDate();
      if (!start || (!end && date < start)) {
        if (start) {
          this.setEndDate(new Date(start));
        }
        if (this.activeRange == "end") {
          this.setEndDate(date);
        }
        else {
          this.setStartDate(date);
        }
      }
      else if (!end) {
        this.setEndDate(date);
      }
      else {
        if (!this.proximitySelectionDisabled) {
          if (this.activeRange) {
            if (this.activeRange == "end") {
              this.setEndDate(date);
            }
            else {
              this.setStartDate(date);
            }
          }
          else {
            const startDiff = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, start);
            const endDiff = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, end);
            if (endDiff === 0 || startDiff < 0) {
              this.setStartDate(date);
            }
            else if (startDiff === 0 || endDiff < 0) {
              this.setEndDate(date);
            }
            else if (startDiff < endDiff) {
              this.setStartDate(date);
            }
            else {
              this.setEndDate(date);
            }
          }
        }
        else {
          this.setStartDate(date);
        }
      }
      this.calciteDatePickerChange.emit();
    };
    this.activeDate = undefined;
    this.activeRange = undefined;
    this.value = undefined;
    this.headingLevel = undefined;
    this.valueAsDate = undefined;
    this.minAsDate = undefined;
    this.maxAsDate = undefined;
    this.min = undefined;
    this.max = undefined;
    this.numberingSystem = undefined;
    this.scale = "m";
    this.range = false;
    this.proximitySelectionDisabled = false;
    this.messageOverrides = undefined;
    this.messages = undefined;
    this.activeStartDate = undefined;
    this.activeEndDate = undefined;
    this.startAsDate = undefined;
    this.endAsDate = undefined;
    this.effectiveLocale = "";
    this.defaultMessages = undefined;
    this.localeData = undefined;
    this.hoverRange = undefined;
  }
  activeDateWatcher(newActiveDate) {
    if (this.activeRange === "end") {
      this.activeEndDate = newActiveDate;
    }
  }
  valueAsDateWatcher(newValueAsDate) {
    if (this.range && Array.isArray(newValueAsDate)) {
      const { activeStartDate, activeEndDate } = this;
      const newActiveStartDate = newValueAsDate[0];
      const newActiveEndDate = newValueAsDate[1];
      this.activeStartDate = activeStartDate !== newActiveStartDate && newActiveStartDate;
      this.activeEndDate = activeEndDate !== newActiveEndDate && newActiveEndDate;
    }
    else if (newValueAsDate && newValueAsDate !== this.activeDate) {
      this.activeDate = newValueAsDate;
    }
  }
  onMinChanged(min) {
    if (min) {
      this.minAsDate = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.c)(min);
    }
  }
  onMaxChanged(max) {
    if (max) {
      this.maxAsDate = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.c)(max);
    }
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  connectedCallback() {
    (0,_locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    (0,_t9n_9603ff05_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    if (Array.isArray(this.value)) {
      this.valueAsDate = (0,_utils_af03caad_js__WEBPACK_IMPORTED_MODULE_4__.g)(this.value);
    }
    else if (this.value) {
      this.valueAsDate = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.value);
    }
    if (this.min) {
      this.minAsDate = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.min);
    }
    if (this.max) {
      this.maxAsDate = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.max);
    }
  }
  disconnectedCallback() {
    (0,_locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_2__.d)(this);
    (0,_t9n_9603ff05_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
  }
  async componentWillLoad() {
    await this.loadLocaleData();
    this.onMinChanged(this.min);
    this.onMaxChanged(this.max);
    await (0,_t9n_9603ff05_js__WEBPACK_IMPORTED_MODULE_3__.s)(this);
  }
  render() {
    const date = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.range && Array.isArray(this.valueAsDate) ? this.valueAsDate[0] : this.valueAsDate, this.minAsDate, this.maxAsDate);
    let activeDate = this.getActiveDate(date, this.minAsDate, this.maxAsDate);
    const endDate = this.range && Array.isArray(this.valueAsDate)
      ? (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.valueAsDate[1], this.minAsDate, this.maxAsDate)
      : null;
    const activeEndDate = this.getActiveEndDate(endDate, this.minAsDate, this.maxAsDate);
    if ((this.activeRange === "end" ||
      (this.hoverRange?.focused === "end" && (!this.proximitySelectionDisabled || endDate))) &&
      activeEndDate) {
      activeDate = activeEndDate;
    }
    if (this.range && this.mostRecentRangeValue) {
      activeDate = this.mostRecentRangeValue;
    }
    const minDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? this.minAsDate
        : date || this.minAsDate
      : this.minAsDate;
    const maxDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? endDate || this.maxAsDate
        : this.maxAsDate
      : this.maxAsDate;
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.H, { onBlur: this.reset, onKeyDown: this.keyDownHandler, role: "application" }, this.renderCalendar(activeDate, maxDate, minDate, date, endDate)));
  }
  effectiveLocaleChange() {
    (0,_t9n_9603ff05_js__WEBPACK_IMPORTED_MODULE_3__.u)(this, this.effectiveLocale);
  }
  valueHandler(value) {
    if (Array.isArray(value)) {
      this.valueAsDate = (0,_utils_af03caad_js__WEBPACK_IMPORTED_MODULE_4__.g)(value);
    }
    else if (value) {
      this.valueAsDate = (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.c)(value);
    }
  }
  async loadLocaleData() {
    _locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_2__.n.numberFormatOptions = {
      numberingSystem: this.numberingSystem,
      locale: this.effectiveLocale,
      useGrouping: false
    };
    this.localeData = await (0,_utils_af03caad_js__WEBPACK_IMPORTED_MODULE_4__.a)(this.effectiveLocale);
  }
  /**
   * Render calcite-date-picker-month-header and calcite-date-picker-month
   *
   * @param activeDate
   * @param maxDate
   * @param minDate
   * @param date
   * @param endDate
   */
  renderCalendar(activeDate, maxDate, minDate, date, endDate) {
    return (this.localeData && [
      (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker-month-header", { activeDate: activeDate, headingLevel: this.headingLevel || HEADING_LEVEL, localeData: this.localeData, max: maxDate, messages: this.messages, min: minDate, onCalciteInternalDatePickerSelect: this.monthHeaderSelectChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date || new Date() }),
      (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker-month", { activeDate: activeDate, endDate: this.range ? endDate : undefined, hoverRange: this.hoverRange, localeData: this.localeData, max: maxDate, min: minDate, onCalciteInternalDatePickerActiveDateChange: this.monthActiveDateChange, onCalciteInternalDatePickerHover: this.monthHoverChange, onCalciteInternalDatePickerMouseOut: this.monthMouseOutChange, onCalciteInternalDatePickerSelect: this.monthDateChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date, startDate: this.range ? date : undefined })
    ]);
  }
  getEndDate() {
    return (Array.isArray(this.valueAsDate) && this.valueAsDate[1]) || undefined;
  }
  setEndDate(date) {
    const startDate = this.getStartDate();
    const newEndDate = date ? (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.s)(date) : date;
    this.value = [(0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.b)(startDate), (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.b)(date)];
    this.valueAsDate = [startDate, date];
    this.mostRecentRangeValue = newEndDate;
    this.calciteDatePickerRangeChange.emit();
    this.activeEndDate = date || null;
  }
  getStartDate() {
    return Array.isArray(this.valueAsDate) && this.valueAsDate[0];
  }
  setStartDate(date) {
    const endDate = this.getEndDate();
    this.value = [(0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.b)(date), (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.b)(endDate)];
    this.valueAsDate = [date, endDate];
    this.mostRecentRangeValue = date;
    this.calciteDatePickerRangeChange.emit();
    this.activeStartDate = date || null;
  }
  /**
   * Get an active date using the value, or current date as default
   *
   * @param value
   * @param min
   * @param max
   */
  getActiveDate(value, min, max) {
    return (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.activeDate, min, max) || value || (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.e)(new Date(), min, max);
  }
  getActiveEndDate(value, min, max) {
    return ((0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.activeEndDate, min, max) || value || (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_1__.e)(new Date(), min, max));
  }
  static get delegatesFocus() { return true; }
  static get assetsDirs() { return ["assets"]; }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
  static get watchers() { return {
    "activeDate": ["activeDateWatcher"],
    "valueAsDate": ["valueAsDateWatcher"],
    "min": ["onMinChanged"],
    "max": ["onMaxChanged"],
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange", "loadLocaleData"],
    "value": ["valueHandler"]
  }; }
};
DatePicker.style = datePickerCss;



//# sourceMappingURL=calcite-date-picker.entry.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-19bc8c04.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-19bc8c04.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ dateFromLocalizedString),
/* harmony export */   b: () => (/* binding */ dateToISO),
/* harmony export */   c: () => (/* binding */ dateFromISO),
/* harmony export */   d: () => (/* binding */ datePartsFromLocalizedString),
/* harmony export */   e: () => (/* binding */ dateFromRange),
/* harmony export */   f: () => (/* binding */ sameDate),
/* harmony export */   g: () => (/* binding */ getDaysDiff),
/* harmony export */   h: () => (/* binding */ getOrder),
/* harmony export */   i: () => (/* binding */ inRange),
/* harmony export */   n: () => (/* binding */ nextMonth),
/* harmony export */   p: () => (/* binding */ prevMonth),
/* harmony export */   s: () => (/* binding */ setEndOfDay)
/* harmony export */ });
/* harmony import */ var _locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locale-706df4c7.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-706df4c7.js");


/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
/**
 * Check if date is within a min and max
 *
 * @param date
 * @param min
 * @param max
 */
function inRange(date, min, max) {
  if (!date) {
    return;
  }
  const time = date.getTime();
  const afterMin = !(min instanceof Date) || time >= min.getTime();
  const beforeMax = !(max instanceof Date) || time <= max.getTime();
  return afterMin && beforeMax;
}
/**
 * Ensures date is within range,
 * returns min or max if out of bounds
 *
 * @param date
 * @param min
 * @param max
 */
function dateFromRange(date, min, max) {
  if (!(date instanceof Date)) {
    return null;
  }
  const time = date.getTime();
  const beforeMin = min instanceof Date && time < min.getTime();
  const afterMax = max instanceof Date && time > max.getTime();
  if (beforeMin) {
    return min;
  }
  if (afterMax) {
    return max;
  }
  return date;
}
/**
 * Parse an iso8601 string (YYYY-mm-dd) into a valid date.
 * TODO: handle time when time of day UI is added
 *
 * @param iso8601
 * @param isEndDate
 */
function dateFromISO(iso8601, isEndDate = false) {
  if (iso8601 instanceof Date) {
    return iso8601;
  }
  if (!iso8601 || typeof iso8601 !== "string") {
    return null;
  }
  const d = iso8601.split(/[: T-]/).map(parseFloat);
  const date = new Date(d[0], (d[1] || 1) - 1, d[2] || 1);
  date.setFullYear(d[0]);
  if (isNaN(date.getTime())) {
    throw new Error(`Invalid ISO 8601 date: "${iso8601}"`);
  }
  if (isEndDate) {
    return setEndOfDay(date);
  }
  return date;
}
/**
 * Parse a localized date string into a valid Date.
 * return false if date is invalid, or out of range
 *
 * @param value
 * @param localeData
 */
function dateFromLocalizedString(value, localeData) {
  if (!localeData) {
    return null;
  }
  const { separator } = localeData;
  const { day, month, year } = parseDateString(value, localeData);
  const date = new Date(year, month, day);
  date.setFullYear(year);
  const validDay = day > 0;
  const validMonth = month > -1;
  const validDate = !isNaN(date.getTime());
  const validLength = value.split(separator).filter((c) => c).length > 2;
  const validYear = year.toString().length > 0;
  if (validDay && validMonth && validDate && validLength && validYear) {
    return date;
  }
  return null;
}
/**
 * Retrieve day, month, and year strings from a localized string
 *
 * @param string
 * @param localeData
 */
function datePartsFromLocalizedString(string, localeData) {
  const { separator, unitOrder } = localeData;
  const order = getOrder(unitOrder);
  const values = string.split(separator).map((part) => _locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_0__.n.delocalize(part));
  const day = values[order.indexOf("d")];
  const month = values[order.indexOf("m")];
  const year = values[order.indexOf("y")];
  return { day, month, year };
}
/**
 * Return first portion of ISO string (YYYY-mm-dd)
 *
 * @param date
 */
function dateToISO(date) {
  if (date instanceof Date) {
    return new Date(date.getTime() - date.getTimezoneOffset() * 60000).toISOString().split("T")[0];
  }
  return "";
}
/**
 * Check if two dates are the same day, month, year
 *
 * @param d1
 * @param d2
 */
function sameDate(d1, d2) {
  return (d1 instanceof Date &&
    d2 instanceof Date &&
    d1.getDate() === d2.getDate() &&
    d1.getMonth() === d2.getMonth() &&
    d1.getFullYear() === d2.getFullYear());
}
/**
 * Get a date one month in the past
 *
 * @param date
 */
function prevMonth(date) {
  const month = date.getMonth();
  const nextDate = new Date(date);
  nextDate.setMonth(month - 1);
  // date doesn't exist in new month, use last day
  if (month === nextDate.getMonth()) {
    return new Date(date.getFullYear(), month, 0);
  }
  return nextDate;
}
/**
 * Get a date one month in the future
 *
 * @param date
 */
function nextMonth(date) {
  const month = date.getMonth();
  const nextDate = new Date(date);
  nextDate.setMonth(month + 1);
  // date doesn't exist in new month, use last day
  if ((month + 2) % 7 === nextDate.getMonth() % 7) {
    return new Date(date.getFullYear(), month + 2, 0);
  }
  return nextDate;
}
/**
 * Parse numeric units for day, month, and year from a localized string
 * month starts at 0 (can pass to date constructor)
 * can return values as number or string
 *
 * @param string
 * @param localeData
 */
function parseDateString(string, localeData) {
  const { day, month, year } = datePartsFromLocalizedString(string, localeData);
  return {
    day: parseInt(day),
    month: parseInt(month) - 1,
    year: parseInt(year)
  };
}
/**
 * Based on the unitOrder string, find order of month, day, and year for locale
 *
 * @param unitOrder
 */
function getOrder(unitOrder) {
  const signifiers = ["d", "m", "y"];
  const order = unitOrder.toLowerCase();
  return signifiers.sort((a, b) => order.indexOf(a) - order.indexOf(b));
}
/**
 * Get number of days between two dates
 *
 * @param date1
 * @param date2
 */
function getDaysDiff(date1, date2) {
  const ts1 = date1.getTime();
  const ts2 = date2.getTime();
  return (ts1 - ts2) / (1000 * 3600 * 24);
}
/**
 * Set time of the day to the end.
 *
 * @param {Date} date Date.
 * @returns {Date} Date with time set to end of day .
 */
function setEndOfDay(date) {
  date.setHours(23, 59, 59, 999);
  return date;
}



//# sourceMappingURL=date-19bc8c04.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/t9n-9603ff05.js":
/*!*********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/t9n-9603ff05.js ***!
  \*********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ connectMessages),
/* harmony export */   d: () => (/* binding */ disconnectMessages),
/* harmony export */   s: () => (/* binding */ setUpMessages),
/* harmony export */   u: () => (/* binding */ updateMessages)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locale-706df4c7.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-706df4c7.js");



/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const componentLangToMessageBundleCache = {};
async function getMessageBundle(lang, component) {
  const key = `${component}_${lang}`;
  if (componentLangToMessageBundleCache[key]) {
    return componentLangToMessageBundleCache[key];
  }
  componentLangToMessageBundleCache[key] = fetch((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.a)(`./assets/${component}/t9n/messages_${lang}.json`))
    .then((resp) => {
    if (!resp.ok) {
      throwMessageFetchError();
    }
    return resp.json();
  })
    .catch(() => throwMessageFetchError());
  return componentLangToMessageBundleCache[key];
}
function throwMessageFetchError() {
  throw new Error("could not fetch component message bundle");
}
function mergeMessages(component) {
  component.messages = {
    ...component.defaultMessages,
    ...component.messageOverrides
  };
}
/**
 * This utility sets up the messages used by the component. It should be awaited in the `componentWillLoad` lifecycle hook.
 *
 * @param component
 */
async function setUpMessages(component) {
  component.defaultMessages = await fetchMessages(component, component.effectiveLocale);
  mergeMessages(component);
}
async function fetchMessages(component, lang) {
  const { el } = component;
  const tag = el.tagName.toLowerCase();
  const componentName = tag.replace("calcite-", "");
  return getMessageBundle((0,_locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_1__.g)(lang, "t9n"), componentName);
}
/**
 * This utility must be set up for the component to update its default message bundle if the locale changes.
 *
 * It can be set up in **either** of the following ways:
 *
 * 1. called from `LocalizedComponent`'s `onLocaleChange` method or
 * 2. called from a watcher configured to watch `LocalizedComponent`'s `effectiveLocale` prop
 *
 * @param component
 * @param lang
 */
async function updateMessages(component, lang) {
  component.defaultMessages = await fetchMessages(component, lang);
  mergeMessages(component);
}
/**
 * This utility sets up internals for messages support.
 *
 * It needs to be called in `connectedCallback`
 *
 * **Note**: this must be called after `LocalizedComponent`'s `connectLocalized` method.
 *
 * @param component
 */
function connectMessages(component) {
  component.onMessagesChange = defaultOnMessagesChange;
}
/**
 * This utility tears down internals for messages support.
 *
 * It needs to be called in `disconnectedCallback`
 *
 * @param component
 */
function disconnectMessages(component) {
  component.onMessagesChange = undefined;
}
function defaultOnMessagesChange() {
  mergeMessages(this);
}



//# sourceMappingURL=t9n-9603ff05.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/utils-af03caad.js":
/*!***********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/utils-af03caad.js ***!
  \***********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getLocaleData),
/* harmony export */   g: () => (/* binding */ getValueAsDateRange)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./date-19bc8c04.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-19bc8c04.js");
/* harmony import */ var _locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locale-706df4c7.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-706df4c7.js");




/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
/**
 * CLDR cache.
 * Exported for testing purposes.
 *
 * @private
 */
const translationCache = {};
/**
 * CLDR request cache.
 * Exported for testing purposes.
 *
 * @private
 */
const requestCache = {};
/**
 * Fetch calendar data for a given locale from list of supported languages
 *
 * @param lang
 * @public
 */
async function getLocaleData(lang) {
  const locale = (0,_locale_706df4c7_js__WEBPACK_IMPORTED_MODULE_0__.g)(lang);
  if (translationCache[locale]) {
    return translationCache[locale];
  }
  if (!requestCache[locale]) {
    requestCache[locale] = fetch((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.a)(`./assets/date-picker/nls/${locale}.json`))
      .then((resp) => resp.json())
      .catch(() => {
      console.error(`Translations for "${locale}" not found or invalid, falling back to english`);
      return getLocaleData("en");
    });
  }
  const data = await requestCache[locale];
  translationCache[locale] = data;
  return data;
}
/**
 *  Maps value to valueAsDate
 *
 * @param value
 */
function getValueAsDateRange(value) {
  return value.map((v, index) => (0,_date_19bc8c04_js__WEBPACK_IMPORTED_MODULE_2__.c)(v, index === 1));
}



//# sourceMappingURL=utils-af03caad.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYmEtaW5mb2dyYXBoaWNfbm9kZV9tb2R1bGVzX2FyY2dpc19idXNpbmVzcy1hbmFseXN0LWNvbXBvbmVudHNfZGlzLTViZGE4Ni5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkc7QUFDaUI7QUFDWDtBQUNRO0FBQ3hDO0FBQ3hEO0FBQ007QUFDTDtBQUNLO0FBQ047QUFDTTs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFDQUFxQyxHQUFHLFVBQVUsS0FBSyxXQUFXLG1CQUFtQixHQUFHLFVBQVUsa0NBQWtDLEtBQUssVUFBVSxnQ0FBZ0MsaUJBQWlCLEdBQUcsVUFBVSxpQ0FBaUMsS0FBSyxVQUFVLGdDQUFnQyxvQkFBb0IsR0FBRyxVQUFVLGlDQUFpQyxLQUFLLFVBQVUsNEJBQTRCLE1BQU0saUZBQWlGLHFFQUFxRSwrRkFBK0YsaUdBQWlHLCtGQUErRixpQkFBaUIsVUFBVSx5QkFBeUIsbURBQW1ELHFCQUFxQixrQkFBa0IsMEJBQTBCLHVCQUF1Qix3QkFBd0IscUJBQXFCLDJCQUEyQix3QkFBd0Isd0NBQXdDLE1BQU0sc0NBQXNDLE1BQU0saUVBQWlFLGtDQUFrQyxnQkFBZ0IsYUFBYSxNQUFNLGtCQUFrQixxQkFBcUIsaUJBQWlCLGlCQUFpQixrQkFBa0IsaUJBQWlCLG1CQUFtQix3Q0FBd0MsZ0RBQWdELG1CQUFtQixpQkFBaUIsc0JBQXNCLGlCQUFpQixzQkFBc0IsaUJBQWlCLHNCQUFzQjs7QUFFdnFEO0FBQ0E7QUFDQSxJQUFJLHFEQUFnQjtBQUNwQixtQ0FBbUMscURBQVc7QUFDOUMsd0NBQXdDLHFEQUFXO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsUUFBUTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxZQUFZO0FBQ3RCLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSx1QkFBdUI7QUFDakM7QUFDQSx1REFBdUQsa0RBQXFCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsTUFBTTtBQUNqQixhQUFhLE1BQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFaVA7O0FBRWpQOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdk53RDtBQUNPOztBQUUvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVLEdBQUcsS0FBSztBQUNuQztBQUNBO0FBQ0E7QUFDQSxpREFBaUQscURBQVksYUFBYSxVQUFVLGdCQUFnQixLQUFLO0FBQ3pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLEtBQUs7QUFDZjtBQUNBO0FBQ0EsMEJBQTBCLHNEQUFrQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVrRzs7QUFFbEc7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzNGd0Q7QUFDRjtBQUNTOztBQUUvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHNEQUFrQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxxREFBWSw2QkFBNkIsT0FBTztBQUNqRjtBQUNBO0FBQ0EseUNBQXlDLE9BQU87QUFDaEQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBVztBQUM1Qzs7QUFFd0Q7O0FBRXhEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9iYS1pbmZvZ3JhcGhpYy9ub2RlX21vZHVsZXMvQGFyY2dpcy9idXNpbmVzcy1hbmFseXN0LWNvbXBvbmVudHMvZGlzdC9zdGVuY2lsLWNvbXBvbmVudHMvZGlzdC9lc20vY2FsY2l0ZS1kYXRlLXBpY2tlci5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS9kYXRlLTE5YmM4YzA0LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYmEtaW5mb2dyYXBoaWMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYnVzaW5lc3MtYW5hbHlzdC1jb21wb25lbnRzL2Rpc3Qvc3RlbmNpbC1jb21wb25lbnRzL2Rpc3QvZXNtL3Q5bi05NjAzZmYwNS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS91dGlscy1hZjAzY2FhZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCwgZyBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC00ZTY0NzQxMS5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldERheXNEaWZmLCBiIGFzIGRhdGVUb0lTTywgYyBhcyBkYXRlRnJvbUlTTywgZSBhcyBkYXRlRnJvbVJhbmdlLCBzIGFzIHNldEVuZE9mRGF5IH0gZnJvbSAnLi9kYXRlLTE5YmM4YzA0LmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdExvY2FsaXplZCwgZCBhcyBkaXNjb25uZWN0TG9jYWxpemVkLCBuIGFzIG51bWJlclN0cmluZ0Zvcm1hdHRlciB9IGZyb20gJy4vbG9jYWxlLTcwNmRmNGM3LmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdE1lc3NhZ2VzLCBkIGFzIGRpc2Nvbm5lY3RNZXNzYWdlcywgcyBhcyBzZXRVcE1lc3NhZ2VzLCB1IGFzIHVwZGF0ZU1lc3NhZ2VzIH0gZnJvbSAnLi90OW4tOTYwM2ZmMDUuanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRWYWx1ZUFzRGF0ZVJhbmdlLCBhIGFzIGdldExvY2FsZURhdGEgfSBmcm9tICcuL3V0aWxzLWFmMDNjYWFkLmpzJztcbmltcG9ydCAnLi9kb20tMTk5N2JmYWYuanMnO1xuaW1wb3J0ICcuL2luZGV4LmVzbS02N2YwZjI1YS5qcyc7XG5pbXBvcnQgJy4vZ3VpZC04OGEzNzI5Zi5qcyc7XG5pbXBvcnQgJy4vcmVzb3VyY2VzLTQ4NDM2ZWVhLmpzJztcbmltcG9ydCAnLi9rZXktYjc1NDkxYzQuanMnO1xuaW1wb3J0ICcuL29ic2VydmVycy01Njc0MGU5OS5qcyc7XG5cbi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjAuNVxuICovXG5jb25zdCBIRUFESU5HX0xFVkVMID0gMjtcblxuY29uc3QgZGF0ZVBpY2tlckNzcyA9IFwiQGtleWZyYW1lcyBpbnswJXtvcGFjaXR5OjB9MTAwJXtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgaW4tZG93bnswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIC01cHgsIDApfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAwLCAwKX19QGtleWZyYW1lcyBpbi11cHswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDVweCwgMCl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDAsIDApfX1Aa2V5ZnJhbWVzIGluLXNjYWxlezAle29wYWNpdHk6MDt0cmFuc2Zvcm06c2NhbGUzRCgwLjk1LCAwLjk1LCAxKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06c2NhbGUzRCgxLCAxLCAxKX19OnJvb3R7LS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmc6Y2FsYygxNTBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3Rvcjp2YXIoLS1jYWxjaXRlLWR1cmF0aW9uLWZhY3RvciwgMSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctZmFzdDpjYWxjKDEwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKTstLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1tZWRpdW06Y2FsYygyMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctc2xvdzpjYWxjKDMwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKX0uY2FsY2l0ZS1hbmltYXRle29wYWNpdHk6MDthbmltYXRpb24tZmlsbC1tb2RlOmJvdGg7YW5pbWF0aW9uLWR1cmF0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyl9LmNhbGNpdGUtYW5pbWF0ZV9faW57YW5pbWF0aW9uLW5hbWU6aW59LmNhbGNpdGUtYW5pbWF0ZV9faW4tZG93bnthbmltYXRpb24tbmFtZTppbi1kb3dufS5jYWxjaXRlLWFuaW1hdGVfX2luLXVwe2FuaW1hdGlvbi1uYW1lOmluLXVwfS5jYWxjaXRlLWFuaW1hdGVfX2luLXNjYWxle2FuaW1hdGlvbi1uYW1lOmluLXNjYWxlfUBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKXs6cm9vdHstLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yOjB9fTpyb290ey0tY2FsY2l0ZS1mbG9hdGluZy11aS10cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyk7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXotaW5kZXg6NjAwfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9Omhvc3R7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7aW5saW5lLXNpemU6MTAwJTtvdmVyZmxvdzp2aXNpYmxlO2JvcmRlci1yYWRpdXM6MHB4O2JvcmRlci13aWR0aDoxcHg7Ym9yZGVyLXN0eWxlOnNvbGlkO2JvcmRlci1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0xKTtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKTt2ZXJ0aWNhbC1hbGlnbjp0b3B9Omhvc3QoW3NjYWxlPXNdKXttYXgtaW5saW5lLXNpemU6MjE2cHh9Omhvc3QoW3NjYWxlPW1dKXttYXgtaW5saW5lLXNpemU6Mjg2cHh9Omhvc3QoW3NjYWxlPWxdKXttYXgtaW5saW5lLXNpemU6Mzk4cHh9XCI7XG5cbmNvbnN0IERhdGVQaWNrZXIgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVEYXRlUGlja2VyQ2hhbmdlXCIsIDYpO1xuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJSYW5nZUNoYW5nZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZURhdGVQaWNrZXJSYW5nZUNoYW5nZVwiLCA2KTtcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdGhpcy5rZXlEb3duSGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm1vbnRoSGVhZGVyU2VsZWN0Q2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZXZlbnQuZGV0YWlsKTtcbiAgICAgIGlmICghdGhpcy5yYW5nZSkge1xuICAgICAgICB0aGlzLmFjdGl2ZURhdGUgPSBkYXRlO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gZGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IGRhdGU7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm1vbnRoQWN0aXZlRGF0ZUNoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRldGFpbCk7XG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVEYXRlID0gZGF0ZTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIikge1xuICAgICAgICAgIHRoaXMuYWN0aXZlRW5kRGF0ZSA9IGRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSBkYXRlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUgPSBkYXRlO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5tb250aEhvdmVyQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcbiAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB7IHZhbHVlQXNEYXRlIH0gPSB0aGlzO1xuICAgICAgY29uc3Qgc3RhcnQgPSBBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSAmJiB2YWx1ZUFzRGF0ZVswXTtcbiAgICAgIGNvbnN0IGVuZCA9IEFycmF5LmlzQXJyYXkodmFsdWVBc0RhdGUpICYmIHZhbHVlQXNEYXRlWzFdO1xuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRldGFpbCk7XG4gICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB7XG4gICAgICAgIGZvY3VzZWQ6IHRoaXMuYWN0aXZlUmFuZ2UgfHwgXCJzdGFydFwiLFxuICAgICAgICBzdGFydCxcbiAgICAgICAgZW5kXG4gICAgICB9O1xuICAgICAgaWYgKCF0aGlzLnByb3hpbWl0eVNlbGVjdGlvbkRpc2FibGVkKSB7XG4gICAgICAgIGlmIChlbmQpIHtcbiAgICAgICAgICBjb25zdCBzdGFydERpZmYgPSBnZXREYXlzRGlmZihkYXRlLCBzdGFydCk7XG4gICAgICAgICAgY29uc3QgZW5kRGlmZiA9IGdldERheXNEaWZmKGRhdGUsIGVuZCk7XG4gICAgICAgICAgaWYgKGVuZERpZmYgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZW5kID0gZGF0ZTtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5mb2N1c2VkID0gXCJlbmRcIjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoc3RhcnREaWZmIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLnN0YXJ0ID0gZGF0ZTtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5mb2N1c2VkID0gXCJzdGFydFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChzdGFydERpZmYgPiBlbmREaWZmKSB7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2Uuc3RhcnQgPSBkYXRlO1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcInN0YXJ0XCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmVuZCA9IGRhdGU7XG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwiZW5kXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGlmIChzdGFydCkge1xuICAgICAgICAgICAgaWYgKGRhdGUgPCBzdGFydCkge1xuICAgICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB7XG4gICAgICAgICAgICAgICAgZm9jdXNlZDogXCJzdGFydFwiLFxuICAgICAgICAgICAgICAgIHN0YXJ0OiBkYXRlLFxuICAgICAgICAgICAgICAgIGVuZDogc3RhcnRcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZW5kID0gZGF0ZTtcbiAgICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcImVuZFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmICghZW5kKSB7XG4gICAgICAgICAgaWYgKGRhdGUgPCBzdGFydCkge1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0ge1xuICAgICAgICAgICAgICBmb2N1c2VkOiBcInN0YXJ0XCIsXG4gICAgICAgICAgICAgIHN0YXJ0OiBkYXRlLFxuICAgICAgICAgICAgICBlbmQ6IHN0YXJ0XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcImVuZFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH07XG4gICAgdGhpcy5tb250aE1vdXNlT3V0Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuaG92ZXJSYW5nZSkge1xuICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXNldCBhY3RpdmUgZGF0ZSBhbmQgY2xvc2VcbiAgICAgKi9cbiAgICB0aGlzLnJlc2V0ID0gKCkgPT4ge1xuICAgICAgY29uc3QgeyB2YWx1ZUFzRGF0ZSB9ID0gdGhpcztcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZUFzRGF0ZSkgJiZcbiAgICAgICAgdmFsdWVBc0RhdGUgJiZcbiAgICAgICAgdmFsdWVBc0RhdGU/LmdldFRpbWUoKSAhPT0gdGhpcy5hY3RpdmVEYXRlPy5nZXRUaW1lKCkpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVEYXRlID0gbmV3IERhdGUodmFsdWVBc0RhdGUpO1xuICAgICAgfVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVBc0RhdGUpKSB7XG4gICAgICAgIGlmICh2YWx1ZUFzRGF0ZVswXSAmJlxuICAgICAgICAgIHZhbHVlQXNEYXRlWzBdPy5nZXRUaW1lKCkgIT09XG4gICAgICAgICAgICAodGhpcy5hY3RpdmVTdGFydERhdGUgaW5zdGFuY2VvZiBEYXRlICYmIHRoaXMuYWN0aXZlU3RhcnREYXRlPy5nZXRUaW1lKCkpKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSBuZXcgRGF0ZSh2YWx1ZUFzRGF0ZVswXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlQXNEYXRlWzFdICYmXG4gICAgICAgICAgdmFsdWVBc0RhdGVbMV0/LmdldFRpbWUoKSAhPT1cbiAgICAgICAgICAgICh0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSBpbnN0YW5jZW9mIERhdGUgJiYgdGhpcy5hY3RpdmVFbmREYXRlPy5nZXRUaW1lKCkpKSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gbmV3IERhdGUodmFsdWVBc0RhdGVbMV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBFdmVudCBoYW5kbGVyIGZvciB3aGVuIHRoZSBzZWxlY3RlZCBkYXRlIGNoYW5nZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqL1xuICAgIHRoaXMubW9udGhEYXRlQ2hhbmdlID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZXZlbnQuZGV0YWlsKTtcbiAgICAgIGNvbnN0IGlzb0RhdGUgPSBkYXRlVG9JU08oZGF0ZSk7XG4gICAgICBpZiAoIXRoaXMucmFuZ2UgJiYgaXNvRGF0ZSA9PT0gZGF0ZVRvSVNPKHRoaXMudmFsdWVBc0RhdGUpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5yYW5nZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gaXNvRGF0ZSB8fCBcIlwiO1xuICAgICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZGF0ZSB8fCBudWxsO1xuICAgICAgICB0aGlzLmFjdGl2ZURhdGUgPSBkYXRlIHx8IG51bGw7XG4gICAgICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJDaGFuZ2UuZW1pdCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBzdGFydCA9IHRoaXMuZ2V0U3RhcnREYXRlKCk7XG4gICAgICBjb25zdCBlbmQgPSB0aGlzLmdldEVuZERhdGUoKTtcbiAgICAgIGlmICghc3RhcnQgfHwgKCFlbmQgJiYgZGF0ZSA8IHN0YXJ0KSkge1xuICAgICAgICBpZiAoc3RhcnQpIHtcbiAgICAgICAgICB0aGlzLnNldEVuZERhdGUobmV3IERhdGUoc3RhcnQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PSBcImVuZFwiKSB7XG4gICAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKGRhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIGlmICghZW5kKSB7XG4gICAgICAgIHRoaXMuc2V0RW5kRGF0ZShkYXRlKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBpZiAoIXRoaXMucHJveGltaXR5U2VsZWN0aW9uRGlzYWJsZWQpIHtcbiAgICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlUmFuZ2UgPT0gXCJlbmRcIikge1xuICAgICAgICAgICAgICB0aGlzLnNldEVuZERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnREaWZmID0gZ2V0RGF5c0RpZmYoZGF0ZSwgc3RhcnQpO1xuICAgICAgICAgICAgY29uc3QgZW5kRGlmZiA9IGdldERheXNEaWZmKGRhdGUsIGVuZCk7XG4gICAgICAgICAgICBpZiAoZW5kRGlmZiA9PT0gMCB8fCBzdGFydERpZmYgPCAwKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKGRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3RhcnREaWZmID09PSAwIHx8IGVuZERpZmYgPCAwKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHN0YXJ0RGlmZiA8IGVuZERpZmYpIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNldFN0YXJ0RGF0ZShkYXRlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5jYWxjaXRlRGF0ZVBpY2tlckNoYW5nZS5lbWl0KCk7XG4gICAgfTtcbiAgICB0aGlzLmFjdGl2ZURhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hY3RpdmVSYW5nZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnZhbHVlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuaGVhZGluZ0xldmVsID0gdW5kZWZpbmVkO1xuICAgIHRoaXMudmFsdWVBc0RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5taW5Bc0RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5tYXhBc0RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5taW4gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5tYXggPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5udW1iZXJpbmdTeXN0ZW0gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zY2FsZSA9IFwibVwiO1xuICAgIHRoaXMucmFuZ2UgPSBmYWxzZTtcbiAgICB0aGlzLnByb3hpbWl0eVNlbGVjdGlvbkRpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5tZXNzYWdlT3ZlcnJpZGVzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubWVzc2FnZXMgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hY3RpdmVFbmREYXRlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc3RhcnRBc0RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5lbmRBc0RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5lZmZlY3RpdmVMb2NhbGUgPSBcIlwiO1xuICAgIHRoaXMuZGVmYXVsdE1lc3NhZ2VzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubG9jYWxlRGF0YSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XG4gIH1cbiAgYWN0aXZlRGF0ZVdhdGNoZXIobmV3QWN0aXZlRGF0ZSkge1xuICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiKSB7XG4gICAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBuZXdBY3RpdmVEYXRlO1xuICAgIH1cbiAgfVxuICB2YWx1ZUFzRGF0ZVdhdGNoZXIobmV3VmFsdWVBc0RhdGUpIHtcbiAgICBpZiAodGhpcy5yYW5nZSAmJiBBcnJheS5pc0FycmF5KG5ld1ZhbHVlQXNEYXRlKSkge1xuICAgICAgY29uc3QgeyBhY3RpdmVTdGFydERhdGUsIGFjdGl2ZUVuZERhdGUgfSA9IHRoaXM7XG4gICAgICBjb25zdCBuZXdBY3RpdmVTdGFydERhdGUgPSBuZXdWYWx1ZUFzRGF0ZVswXTtcbiAgICAgIGNvbnN0IG5ld0FjdGl2ZUVuZERhdGUgPSBuZXdWYWx1ZUFzRGF0ZVsxXTtcbiAgICAgIHRoaXMuYWN0aXZlU3RhcnREYXRlID0gYWN0aXZlU3RhcnREYXRlICE9PSBuZXdBY3RpdmVTdGFydERhdGUgJiYgbmV3QWN0aXZlU3RhcnREYXRlO1xuICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gYWN0aXZlRW5kRGF0ZSAhPT0gbmV3QWN0aXZlRW5kRGF0ZSAmJiBuZXdBY3RpdmVFbmREYXRlO1xuICAgIH1cbiAgICBlbHNlIGlmIChuZXdWYWx1ZUFzRGF0ZSAmJiBuZXdWYWx1ZUFzRGF0ZSAhPT0gdGhpcy5hY3RpdmVEYXRlKSB7XG4gICAgICB0aGlzLmFjdGl2ZURhdGUgPSBuZXdWYWx1ZUFzRGF0ZTtcbiAgICB9XG4gIH1cbiAgb25NaW5DaGFuZ2VkKG1pbikge1xuICAgIGlmIChtaW4pIHtcbiAgICAgIHRoaXMubWluQXNEYXRlID0gZGF0ZUZyb21JU08obWluKTtcbiAgICB9XG4gIH1cbiAgb25NYXhDaGFuZ2VkKG1heCkge1xuICAgIGlmIChtYXgpIHtcbiAgICAgIHRoaXMubWF4QXNEYXRlID0gZGF0ZUZyb21JU08obWF4KTtcbiAgICB9XG4gIH1cbiAgb25NZXNzYWdlc0NoYW5nZSgpIHtcbiAgICAvKiB3aXJlZCB1cCBieSB0OW4gdXRpbCAqL1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBMaWZlY3ljbGVcbiAgLy9cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgY29ubmVjdExvY2FsaXplZCh0aGlzKTtcbiAgICBjb25uZWN0TWVzc2FnZXModGhpcyk7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy52YWx1ZSkpIHtcbiAgICAgIHRoaXMudmFsdWVBc0RhdGUgPSBnZXRWYWx1ZUFzRGF0ZVJhbmdlKHRoaXMudmFsdWUpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0aGlzLnZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZGF0ZUZyb21JU08odGhpcy52YWx1ZSk7XG4gICAgfVxuICAgIGlmICh0aGlzLm1pbikge1xuICAgICAgdGhpcy5taW5Bc0RhdGUgPSBkYXRlRnJvbUlTTyh0aGlzLm1pbik7XG4gICAgfVxuICAgIGlmICh0aGlzLm1heCkge1xuICAgICAgdGhpcy5tYXhBc0RhdGUgPSBkYXRlRnJvbUlTTyh0aGlzLm1heCk7XG4gICAgfVxuICB9XG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgIGRpc2Nvbm5lY3RMb2NhbGl6ZWQodGhpcyk7XG4gICAgZGlzY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xuICB9XG4gIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgIGF3YWl0IHRoaXMubG9hZExvY2FsZURhdGEoKTtcbiAgICB0aGlzLm9uTWluQ2hhbmdlZCh0aGlzLm1pbik7XG4gICAgdGhpcy5vbk1heENoYW5nZWQodGhpcy5tYXgpO1xuICAgIGF3YWl0IHNldFVwTWVzc2FnZXModGhpcyk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGRhdGUgPSBkYXRlRnJvbVJhbmdlKHRoaXMucmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKSA/IHRoaXMudmFsdWVBc0RhdGVbMF0gOiB0aGlzLnZhbHVlQXNEYXRlLCB0aGlzLm1pbkFzRGF0ZSwgdGhpcy5tYXhBc0RhdGUpO1xuICAgIGxldCBhY3RpdmVEYXRlID0gdGhpcy5nZXRBY3RpdmVEYXRlKGRhdGUsIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSk7XG4gICAgY29uc3QgZW5kRGF0ZSA9IHRoaXMucmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKVxuICAgICAgPyBkYXRlRnJvbVJhbmdlKHRoaXMudmFsdWVBc0RhdGVbMV0sIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSlcbiAgICAgIDogbnVsbDtcbiAgICBjb25zdCBhY3RpdmVFbmREYXRlID0gdGhpcy5nZXRBY3RpdmVFbmREYXRlKGVuZERhdGUsIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSk7XG4gICAgaWYgKCh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiIHx8XG4gICAgICAodGhpcy5ob3ZlclJhbmdlPy5mb2N1c2VkID09PSBcImVuZFwiICYmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCB8fCBlbmREYXRlKSkpICYmXG4gICAgICBhY3RpdmVFbmREYXRlKSB7XG4gICAgICBhY3RpdmVEYXRlID0gYWN0aXZlRW5kRGF0ZTtcbiAgICB9XG4gICAgaWYgKHRoaXMucmFuZ2UgJiYgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSkge1xuICAgICAgYWN0aXZlRGF0ZSA9IHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IG1pbkRhdGUgPSB0aGlzLnJhbmdlICYmIHRoaXMuYWN0aXZlUmFuZ2VcbiAgICAgID8gdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJzdGFydFwiXG4gICAgICAgID8gdGhpcy5taW5Bc0RhdGVcbiAgICAgICAgOiBkYXRlIHx8IHRoaXMubWluQXNEYXRlXG4gICAgICA6IHRoaXMubWluQXNEYXRlO1xuICAgIGNvbnN0IG1heERhdGUgPSB0aGlzLnJhbmdlICYmIHRoaXMuYWN0aXZlUmFuZ2VcbiAgICAgID8gdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJzdGFydFwiXG4gICAgICAgID8gZW5kRGF0ZSB8fCB0aGlzLm1heEFzRGF0ZVxuICAgICAgICA6IHRoaXMubWF4QXNEYXRlXG4gICAgICA6IHRoaXMubWF4QXNEYXRlO1xuICAgIHJldHVybiAoaChIb3N0LCB7IG9uQmx1cjogdGhpcy5yZXNldCwgb25LZXlEb3duOiB0aGlzLmtleURvd25IYW5kbGVyLCByb2xlOiBcImFwcGxpY2F0aW9uXCIgfSwgdGhpcy5yZW5kZXJDYWxlbmRhcihhY3RpdmVEYXRlLCBtYXhEYXRlLCBtaW5EYXRlLCBkYXRlLCBlbmREYXRlKSkpO1xuICB9XG4gIGVmZmVjdGl2ZUxvY2FsZUNoYW5nZSgpIHtcbiAgICB1cGRhdGVNZXNzYWdlcyh0aGlzLCB0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XG4gIH1cbiAgdmFsdWVIYW5kbGVyKHZhbHVlKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZ2V0VmFsdWVBc0RhdGVSYW5nZSh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlQXNEYXRlID0gZGF0ZUZyb21JU08odmFsdWUpO1xuICAgIH1cbiAgfVxuICBhc3luYyBsb2FkTG9jYWxlRGF0YSgpIHtcbiAgICBudW1iZXJTdHJpbmdGb3JtYXR0ZXIubnVtYmVyRm9ybWF0T3B0aW9ucyA9IHtcbiAgICAgIG51bWJlcmluZ1N5c3RlbTogdGhpcy5udW1iZXJpbmdTeXN0ZW0sXG4gICAgICBsb2NhbGU6IHRoaXMuZWZmZWN0aXZlTG9jYWxlLFxuICAgICAgdXNlR3JvdXBpbmc6IGZhbHNlXG4gICAgfTtcbiAgICB0aGlzLmxvY2FsZURhdGEgPSBhd2FpdCBnZXRMb2NhbGVEYXRhKHRoaXMuZWZmZWN0aXZlTG9jYWxlKTtcbiAgfVxuICAvKipcbiAgICogUmVuZGVyIGNhbGNpdGUtZGF0ZS1waWNrZXItbW9udGgtaGVhZGVyIGFuZCBjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoXG4gICAqXG4gICAqIEBwYXJhbSBhY3RpdmVEYXRlXG4gICAqIEBwYXJhbSBtYXhEYXRlXG4gICAqIEBwYXJhbSBtaW5EYXRlXG4gICAqIEBwYXJhbSBkYXRlXG4gICAqIEBwYXJhbSBlbmREYXRlXG4gICAqL1xuICByZW5kZXJDYWxlbmRhcihhY3RpdmVEYXRlLCBtYXhEYXRlLCBtaW5EYXRlLCBkYXRlLCBlbmREYXRlKSB7XG4gICAgcmV0dXJuICh0aGlzLmxvY2FsZURhdGEgJiYgW1xuICAgICAgaChcImNhbGNpdGUtZGF0ZS1waWNrZXItbW9udGgtaGVhZGVyXCIsIHsgYWN0aXZlRGF0ZTogYWN0aXZlRGF0ZSwgaGVhZGluZ0xldmVsOiB0aGlzLmhlYWRpbmdMZXZlbCB8fCBIRUFESU5HX0xFVkVMLCBsb2NhbGVEYXRhOiB0aGlzLmxvY2FsZURhdGEsIG1heDogbWF4RGF0ZSwgbWVzc2FnZXM6IHRoaXMubWVzc2FnZXMsIG1pbjogbWluRGF0ZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyU2VsZWN0OiB0aGlzLm1vbnRoSGVhZGVyU2VsZWN0Q2hhbmdlLCBzY2FsZTogdGhpcy5zY2FsZSwgc2VsZWN0ZWREYXRlOiB0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiID8gZW5kRGF0ZSA6IGRhdGUgfHwgbmV3IERhdGUoKSB9KSxcbiAgICAgIGgoXCJjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoXCIsIHsgYWN0aXZlRGF0ZTogYWN0aXZlRGF0ZSwgZW5kRGF0ZTogdGhpcy5yYW5nZSA/IGVuZERhdGUgOiB1bmRlZmluZWQsIGhvdmVyUmFuZ2U6IHRoaXMuaG92ZXJSYW5nZSwgbG9jYWxlRGF0YTogdGhpcy5sb2NhbGVEYXRhLCBtYXg6IG1heERhdGUsIG1pbjogbWluRGF0ZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyQWN0aXZlRGF0ZUNoYW5nZTogdGhpcy5tb250aEFjdGl2ZURhdGVDaGFuZ2UsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlckhvdmVyOiB0aGlzLm1vbnRoSG92ZXJDaGFuZ2UsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlck1vdXNlT3V0OiB0aGlzLm1vbnRoTW91c2VPdXRDaGFuZ2UsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlclNlbGVjdDogdGhpcy5tb250aERhdGVDaGFuZ2UsIHNjYWxlOiB0aGlzLnNjYWxlLCBzZWxlY3RlZERhdGU6IHRoaXMuYWN0aXZlUmFuZ2UgPT09IFwiZW5kXCIgPyBlbmREYXRlIDogZGF0ZSwgc3RhcnREYXRlOiB0aGlzLnJhbmdlID8gZGF0ZSA6IHVuZGVmaW5lZCB9KVxuICAgIF0pO1xuICB9XG4gIGdldEVuZERhdGUoKSB7XG4gICAgcmV0dXJuIChBcnJheS5pc0FycmF5KHRoaXMudmFsdWVBc0RhdGUpICYmIHRoaXMudmFsdWVBc0RhdGVbMV0pIHx8IHVuZGVmaW5lZDtcbiAgfVxuICBzZXRFbmREYXRlKGRhdGUpIHtcbiAgICBjb25zdCBzdGFydERhdGUgPSB0aGlzLmdldFN0YXJ0RGF0ZSgpO1xuICAgIGNvbnN0IG5ld0VuZERhdGUgPSBkYXRlID8gc2V0RW5kT2ZEYXkoZGF0ZSkgOiBkYXRlO1xuICAgIHRoaXMudmFsdWUgPSBbZGF0ZVRvSVNPKHN0YXJ0RGF0ZSksIGRhdGVUb0lTTyhkYXRlKV07XG4gICAgdGhpcy52YWx1ZUFzRGF0ZSA9IFtzdGFydERhdGUsIGRhdGVdO1xuICAgIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUgPSBuZXdFbmREYXRlO1xuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJSYW5nZUNoYW5nZS5lbWl0KCk7XG4gICAgdGhpcy5hY3RpdmVFbmREYXRlID0gZGF0ZSB8fCBudWxsO1xuICB9XG4gIGdldFN0YXJ0RGF0ZSgpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKSAmJiB0aGlzLnZhbHVlQXNEYXRlWzBdO1xuICB9XG4gIHNldFN0YXJ0RGF0ZShkYXRlKSB7XG4gICAgY29uc3QgZW5kRGF0ZSA9IHRoaXMuZ2V0RW5kRGF0ZSgpO1xuICAgIHRoaXMudmFsdWUgPSBbZGF0ZVRvSVNPKGRhdGUpLCBkYXRlVG9JU08oZW5kRGF0ZSldO1xuICAgIHRoaXMudmFsdWVBc0RhdGUgPSBbZGF0ZSwgZW5kRGF0ZV07XG4gICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IGRhdGU7XG4gICAgdGhpcy5jYWxjaXRlRGF0ZVBpY2tlclJhbmdlQ2hhbmdlLmVtaXQoKTtcbiAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGUgfHwgbnVsbDtcbiAgfVxuICAvKipcbiAgICogR2V0IGFuIGFjdGl2ZSBkYXRlIHVzaW5nIHRoZSB2YWx1ZSwgb3IgY3VycmVudCBkYXRlIGFzIGRlZmF1bHRcbiAgICpcbiAgICogQHBhcmFtIHZhbHVlXG4gICAqIEBwYXJhbSBtaW5cbiAgICogQHBhcmFtIG1heFxuICAgKi9cbiAgZ2V0QWN0aXZlRGF0ZSh2YWx1ZSwgbWluLCBtYXgpIHtcbiAgICByZXR1cm4gZGF0ZUZyb21SYW5nZSh0aGlzLmFjdGl2ZURhdGUsIG1pbiwgbWF4KSB8fCB2YWx1ZSB8fCBkYXRlRnJvbVJhbmdlKG5ldyBEYXRlKCksIG1pbiwgbWF4KTtcbiAgfVxuICBnZXRBY3RpdmVFbmREYXRlKHZhbHVlLCBtaW4sIG1heCkge1xuICAgIHJldHVybiAoZGF0ZUZyb21SYW5nZSh0aGlzLmFjdGl2ZUVuZERhdGUsIG1pbiwgbWF4KSB8fCB2YWx1ZSB8fCBkYXRlRnJvbVJhbmdlKG5ldyBEYXRlKCksIG1pbiwgbWF4KSk7XG4gIH1cbiAgc3RhdGljIGdldCBkZWxlZ2F0ZXNGb2N1cygpIHsgcmV0dXJuIHRydWU7IH1cbiAgc3RhdGljIGdldCBhc3NldHNEaXJzKCkgeyByZXR1cm4gW1wiYXNzZXRzXCJdOyB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICBcImFjdGl2ZURhdGVcIjogW1wiYWN0aXZlRGF0ZVdhdGNoZXJcIl0sXG4gICAgXCJ2YWx1ZUFzRGF0ZVwiOiBbXCJ2YWx1ZUFzRGF0ZVdhdGNoZXJcIl0sXG4gICAgXCJtaW5cIjogW1wib25NaW5DaGFuZ2VkXCJdLFxuICAgIFwibWF4XCI6IFtcIm9uTWF4Q2hhbmdlZFwiXSxcbiAgICBcIm1lc3NhZ2VPdmVycmlkZXNcIjogW1wib25NZXNzYWdlc0NoYW5nZVwiXSxcbiAgICBcImVmZmVjdGl2ZUxvY2FsZVwiOiBbXCJlZmZlY3RpdmVMb2NhbGVDaGFuZ2VcIiwgXCJsb2FkTG9jYWxlRGF0YVwiXSxcbiAgICBcInZhbHVlXCI6IFtcInZhbHVlSGFuZGxlclwiXVxuICB9OyB9XG59O1xuRGF0ZVBpY2tlci5zdHlsZSA9IGRhdGVQaWNrZXJDc3M7XG5cbmV4cG9ydCB7IERhdGVQaWNrZXIgYXMgY2FsY2l0ZV9kYXRlX3BpY2tlciB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jYWxjaXRlLWRhdGUtcGlja2VyLmVudHJ5LmpzLm1hcCIsImltcG9ydCB7IG4gYXMgbnVtYmVyU3RyaW5nRm9ybWF0dGVyIH0gZnJvbSAnLi9sb2NhbGUtNzA2ZGY0YzcuanMnO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuLyoqXG4gKiBDaGVjayBpZiBkYXRlIGlzIHdpdGhpbiBhIG1pbiBhbmQgbWF4XG4gKlxuICogQHBhcmFtIGRhdGVcbiAqIEBwYXJhbSBtaW5cbiAqIEBwYXJhbSBtYXhcbiAqL1xuZnVuY3Rpb24gaW5SYW5nZShkYXRlLCBtaW4sIG1heCkge1xuICBpZiAoIWRhdGUpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgdGltZSA9IGRhdGUuZ2V0VGltZSgpO1xuICBjb25zdCBhZnRlck1pbiA9ICEobWluIGluc3RhbmNlb2YgRGF0ZSkgfHwgdGltZSA+PSBtaW4uZ2V0VGltZSgpO1xuICBjb25zdCBiZWZvcmVNYXggPSAhKG1heCBpbnN0YW5jZW9mIERhdGUpIHx8IHRpbWUgPD0gbWF4LmdldFRpbWUoKTtcbiAgcmV0dXJuIGFmdGVyTWluICYmIGJlZm9yZU1heDtcbn1cbi8qKlxuICogRW5zdXJlcyBkYXRlIGlzIHdpdGhpbiByYW5nZSxcbiAqIHJldHVybnMgbWluIG9yIG1heCBpZiBvdXQgb2YgYm91bmRzXG4gKlxuICogQHBhcmFtIGRhdGVcbiAqIEBwYXJhbSBtaW5cbiAqIEBwYXJhbSBtYXhcbiAqL1xuZnVuY3Rpb24gZGF0ZUZyb21SYW5nZShkYXRlLCBtaW4sIG1heCkge1xuICBpZiAoIShkYXRlIGluc3RhbmNlb2YgRGF0ZSkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB0aW1lID0gZGF0ZS5nZXRUaW1lKCk7XG4gIGNvbnN0IGJlZm9yZU1pbiA9IG1pbiBpbnN0YW5jZW9mIERhdGUgJiYgdGltZSA8IG1pbi5nZXRUaW1lKCk7XG4gIGNvbnN0IGFmdGVyTWF4ID0gbWF4IGluc3RhbmNlb2YgRGF0ZSAmJiB0aW1lID4gbWF4LmdldFRpbWUoKTtcbiAgaWYgKGJlZm9yZU1pbikge1xuICAgIHJldHVybiBtaW47XG4gIH1cbiAgaWYgKGFmdGVyTWF4KSB7XG4gICAgcmV0dXJuIG1heDtcbiAgfVxuICByZXR1cm4gZGF0ZTtcbn1cbi8qKlxuICogUGFyc2UgYW4gaXNvODYwMSBzdHJpbmcgKFlZWVktbW0tZGQpIGludG8gYSB2YWxpZCBkYXRlLlxuICogVE9ETzogaGFuZGxlIHRpbWUgd2hlbiB0aW1lIG9mIGRheSBVSSBpcyBhZGRlZFxuICpcbiAqIEBwYXJhbSBpc284NjAxXG4gKiBAcGFyYW0gaXNFbmREYXRlXG4gKi9cbmZ1bmN0aW9uIGRhdGVGcm9tSVNPKGlzbzg2MDEsIGlzRW5kRGF0ZSA9IGZhbHNlKSB7XG4gIGlmIChpc284NjAxIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgIHJldHVybiBpc284NjAxO1xuICB9XG4gIGlmICghaXNvODYwMSB8fCB0eXBlb2YgaXNvODYwMSAhPT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGQgPSBpc284NjAxLnNwbGl0KC9bOiBULV0vKS5tYXAocGFyc2VGbG9hdCk7XG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkWzBdLCAoZFsxXSB8fCAxKSAtIDEsIGRbMl0gfHwgMSk7XG4gIGRhdGUuc2V0RnVsbFllYXIoZFswXSk7XG4gIGlmIChpc05hTihkYXRlLmdldFRpbWUoKSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgSVNPIDg2MDEgZGF0ZTogXCIke2lzbzg2MDF9XCJgKTtcbiAgfVxuICBpZiAoaXNFbmREYXRlKSB7XG4gICAgcmV0dXJuIHNldEVuZE9mRGF5KGRhdGUpO1xuICB9XG4gIHJldHVybiBkYXRlO1xufVxuLyoqXG4gKiBQYXJzZSBhIGxvY2FsaXplZCBkYXRlIHN0cmluZyBpbnRvIGEgdmFsaWQgRGF0ZS5cbiAqIHJldHVybiBmYWxzZSBpZiBkYXRlIGlzIGludmFsaWQsIG9yIG91dCBvZiByYW5nZVxuICpcbiAqIEBwYXJhbSB2YWx1ZVxuICogQHBhcmFtIGxvY2FsZURhdGFcbiAqL1xuZnVuY3Rpb24gZGF0ZUZyb21Mb2NhbGl6ZWRTdHJpbmcodmFsdWUsIGxvY2FsZURhdGEpIHtcbiAgaWYgKCFsb2NhbGVEYXRhKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgeyBzZXBhcmF0b3IgfSA9IGxvY2FsZURhdGE7XG4gIGNvbnN0IHsgZGF5LCBtb250aCwgeWVhciB9ID0gcGFyc2VEYXRlU3RyaW5nKHZhbHVlLCBsb2NhbGVEYXRhKTtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpO1xuICBkYXRlLnNldEZ1bGxZZWFyKHllYXIpO1xuICBjb25zdCB2YWxpZERheSA9IGRheSA+IDA7XG4gIGNvbnN0IHZhbGlkTW9udGggPSBtb250aCA+IC0xO1xuICBjb25zdCB2YWxpZERhdGUgPSAhaXNOYU4oZGF0ZS5nZXRUaW1lKCkpO1xuICBjb25zdCB2YWxpZExlbmd0aCA9IHZhbHVlLnNwbGl0KHNlcGFyYXRvcikuZmlsdGVyKChjKSA9PiBjKS5sZW5ndGggPiAyO1xuICBjb25zdCB2YWxpZFllYXIgPSB5ZWFyLnRvU3RyaW5nKCkubGVuZ3RoID4gMDtcbiAgaWYgKHZhbGlkRGF5ICYmIHZhbGlkTW9udGggJiYgdmFsaWREYXRlICYmIHZhbGlkTGVuZ3RoICYmIHZhbGlkWWVhcikge1xuICAgIHJldHVybiBkYXRlO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuLyoqXG4gKiBSZXRyaWV2ZSBkYXksIG1vbnRoLCBhbmQgeWVhciBzdHJpbmdzIGZyb20gYSBsb2NhbGl6ZWQgc3RyaW5nXG4gKlxuICogQHBhcmFtIHN0cmluZ1xuICogQHBhcmFtIGxvY2FsZURhdGFcbiAqL1xuZnVuY3Rpb24gZGF0ZVBhcnRzRnJvbUxvY2FsaXplZFN0cmluZyhzdHJpbmcsIGxvY2FsZURhdGEpIHtcbiAgY29uc3QgeyBzZXBhcmF0b3IsIHVuaXRPcmRlciB9ID0gbG9jYWxlRGF0YTtcbiAgY29uc3Qgb3JkZXIgPSBnZXRPcmRlcih1bml0T3JkZXIpO1xuICBjb25zdCB2YWx1ZXMgPSBzdHJpbmcuc3BsaXQoc2VwYXJhdG9yKS5tYXAoKHBhcnQpID0+IG51bWJlclN0cmluZ0Zvcm1hdHRlci5kZWxvY2FsaXplKHBhcnQpKTtcbiAgY29uc3QgZGF5ID0gdmFsdWVzW29yZGVyLmluZGV4T2YoXCJkXCIpXTtcbiAgY29uc3QgbW9udGggPSB2YWx1ZXNbb3JkZXIuaW5kZXhPZihcIm1cIildO1xuICBjb25zdCB5ZWFyID0gdmFsdWVzW29yZGVyLmluZGV4T2YoXCJ5XCIpXTtcbiAgcmV0dXJuIHsgZGF5LCBtb250aCwgeWVhciB9O1xufVxuLyoqXG4gKiBSZXR1cm4gZmlyc3QgcG9ydGlvbiBvZiBJU08gc3RyaW5nIChZWVlZLW1tLWRkKVxuICpcbiAqIEBwYXJhbSBkYXRlXG4gKi9cbmZ1bmN0aW9uIGRhdGVUb0lTTyhkYXRlKSB7XG4gIGlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSAtIGRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwKS50b0lTT1N0cmluZygpLnNwbGl0KFwiVFwiKVswXTtcbiAgfVxuICByZXR1cm4gXCJcIjtcbn1cbi8qKlxuICogQ2hlY2sgaWYgdHdvIGRhdGVzIGFyZSB0aGUgc2FtZSBkYXksIG1vbnRoLCB5ZWFyXG4gKlxuICogQHBhcmFtIGQxXG4gKiBAcGFyYW0gZDJcbiAqL1xuZnVuY3Rpb24gc2FtZURhdGUoZDEsIGQyKSB7XG4gIHJldHVybiAoZDEgaW5zdGFuY2VvZiBEYXRlICYmXG4gICAgZDIgaW5zdGFuY2VvZiBEYXRlICYmXG4gICAgZDEuZ2V0RGF0ZSgpID09PSBkMi5nZXREYXRlKCkgJiZcbiAgICBkMS5nZXRNb250aCgpID09PSBkMi5nZXRNb250aCgpICYmXG4gICAgZDEuZ2V0RnVsbFllYXIoKSA9PT0gZDIuZ2V0RnVsbFllYXIoKSk7XG59XG4vKipcbiAqIEdldCBhIGRhdGUgb25lIG1vbnRoIGluIHRoZSBwYXN0XG4gKlxuICogQHBhcmFtIGRhdGVcbiAqL1xuZnVuY3Rpb24gcHJldk1vbnRoKGRhdGUpIHtcbiAgY29uc3QgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XG4gIGNvbnN0IG5leHREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gIG5leHREYXRlLnNldE1vbnRoKG1vbnRoIC0gMSk7XG4gIC8vIGRhdGUgZG9lc24ndCBleGlzdCBpbiBuZXcgbW9udGgsIHVzZSBsYXN0IGRheVxuICBpZiAobW9udGggPT09IG5leHREYXRlLmdldE1vbnRoKCkpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCBtb250aCwgMCk7XG4gIH1cbiAgcmV0dXJuIG5leHREYXRlO1xufVxuLyoqXG4gKiBHZXQgYSBkYXRlIG9uZSBtb250aCBpbiB0aGUgZnV0dXJlXG4gKlxuICogQHBhcmFtIGRhdGVcbiAqL1xuZnVuY3Rpb24gbmV4dE1vbnRoKGRhdGUpIHtcbiAgY29uc3QgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XG4gIGNvbnN0IG5leHREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gIG5leHREYXRlLnNldE1vbnRoKG1vbnRoICsgMSk7XG4gIC8vIGRhdGUgZG9lc24ndCBleGlzdCBpbiBuZXcgbW9udGgsIHVzZSBsYXN0IGRheVxuICBpZiAoKG1vbnRoICsgMikgJSA3ID09PSBuZXh0RGF0ZS5nZXRNb250aCgpICUgNykge1xuICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIG1vbnRoICsgMiwgMCk7XG4gIH1cbiAgcmV0dXJuIG5leHREYXRlO1xufVxuLyoqXG4gKiBQYXJzZSBudW1lcmljIHVuaXRzIGZvciBkYXksIG1vbnRoLCBhbmQgeWVhciBmcm9tIGEgbG9jYWxpemVkIHN0cmluZ1xuICogbW9udGggc3RhcnRzIGF0IDAgKGNhbiBwYXNzIHRvIGRhdGUgY29uc3RydWN0b3IpXG4gKiBjYW4gcmV0dXJuIHZhbHVlcyBhcyBudW1iZXIgb3Igc3RyaW5nXG4gKlxuICogQHBhcmFtIHN0cmluZ1xuICogQHBhcmFtIGxvY2FsZURhdGFcbiAqL1xuZnVuY3Rpb24gcGFyc2VEYXRlU3RyaW5nKHN0cmluZywgbG9jYWxlRGF0YSkge1xuICBjb25zdCB7IGRheSwgbW9udGgsIHllYXIgfSA9IGRhdGVQYXJ0c0Zyb21Mb2NhbGl6ZWRTdHJpbmcoc3RyaW5nLCBsb2NhbGVEYXRhKTtcbiAgcmV0dXJuIHtcbiAgICBkYXk6IHBhcnNlSW50KGRheSksXG4gICAgbW9udGg6IHBhcnNlSW50KG1vbnRoKSAtIDEsXG4gICAgeWVhcjogcGFyc2VJbnQoeWVhcilcbiAgfTtcbn1cbi8qKlxuICogQmFzZWQgb24gdGhlIHVuaXRPcmRlciBzdHJpbmcsIGZpbmQgb3JkZXIgb2YgbW9udGgsIGRheSwgYW5kIHllYXIgZm9yIGxvY2FsZVxuICpcbiAqIEBwYXJhbSB1bml0T3JkZXJcbiAqL1xuZnVuY3Rpb24gZ2V0T3JkZXIodW5pdE9yZGVyKSB7XG4gIGNvbnN0IHNpZ25pZmllcnMgPSBbXCJkXCIsIFwibVwiLCBcInlcIl07XG4gIGNvbnN0IG9yZGVyID0gdW5pdE9yZGVyLnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiBzaWduaWZpZXJzLnNvcnQoKGEsIGIpID0+IG9yZGVyLmluZGV4T2YoYSkgLSBvcmRlci5pbmRleE9mKGIpKTtcbn1cbi8qKlxuICogR2V0IG51bWJlciBvZiBkYXlzIGJldHdlZW4gdHdvIGRhdGVzXG4gKlxuICogQHBhcmFtIGRhdGUxXG4gKiBAcGFyYW0gZGF0ZTJcbiAqL1xuZnVuY3Rpb24gZ2V0RGF5c0RpZmYoZGF0ZTEsIGRhdGUyKSB7XG4gIGNvbnN0IHRzMSA9IGRhdGUxLmdldFRpbWUoKTtcbiAgY29uc3QgdHMyID0gZGF0ZTIuZ2V0VGltZSgpO1xuICByZXR1cm4gKHRzMSAtIHRzMikgLyAoMTAwMCAqIDM2MDAgKiAyNCk7XG59XG4vKipcbiAqIFNldCB0aW1lIG9mIHRoZSBkYXkgdG8gdGhlIGVuZC5cbiAqXG4gKiBAcGFyYW0ge0RhdGV9IGRhdGUgRGF0ZS5cbiAqIEByZXR1cm5zIHtEYXRlfSBEYXRlIHdpdGggdGltZSBzZXQgdG8gZW5kIG9mIGRheSAuXG4gKi9cbmZ1bmN0aW9uIHNldEVuZE9mRGF5KGRhdGUpIHtcbiAgZGF0ZS5zZXRIb3VycygyMywgNTksIDU5LCA5OTkpO1xuICByZXR1cm4gZGF0ZTtcbn1cblxuZXhwb3J0IHsgZGF0ZUZyb21Mb2NhbGl6ZWRTdHJpbmcgYXMgYSwgZGF0ZVRvSVNPIGFzIGIsIGRhdGVGcm9tSVNPIGFzIGMsIGRhdGVQYXJ0c0Zyb21Mb2NhbGl6ZWRTdHJpbmcgYXMgZCwgZGF0ZUZyb21SYW5nZSBhcyBlLCBzYW1lRGF0ZSBhcyBmLCBnZXREYXlzRGlmZiBhcyBnLCBnZXRPcmRlciBhcyBoLCBpblJhbmdlIGFzIGksIG5leHRNb250aCBhcyBuLCBwcmV2TW9udGggYXMgcCwgc2V0RW5kT2ZEYXkgYXMgcyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRlLTE5YmM4YzA0LmpzLm1hcCIsImltcG9ydCB7IGEgYXMgZ2V0QXNzZXRQYXRoIH0gZnJvbSAnLi9pbmRleC00ZTY0NzQxMS5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFN1cHBvcnRlZExvY2FsZSB9IGZyb20gJy4vbG9jYWxlLTcwNmRmNGM3LmpzJztcblxuLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtY29tcG9uZW50cy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuMC41XG4gKi9cbmNvbnN0IGNvbXBvbmVudExhbmdUb01lc3NhZ2VCdW5kbGVDYWNoZSA9IHt9O1xuYXN5bmMgZnVuY3Rpb24gZ2V0TWVzc2FnZUJ1bmRsZShsYW5nLCBjb21wb25lbnQpIHtcbiAgY29uc3Qga2V5ID0gYCR7Y29tcG9uZW50fV8ke2xhbmd9YDtcbiAgaWYgKGNvbXBvbmVudExhbmdUb01lc3NhZ2VCdW5kbGVDYWNoZVtrZXldKSB7XG4gICAgcmV0dXJuIGNvbXBvbmVudExhbmdUb01lc3NhZ2VCdW5kbGVDYWNoZVtrZXldO1xuICB9XG4gIGNvbXBvbmVudExhbmdUb01lc3NhZ2VCdW5kbGVDYWNoZVtrZXldID0gZmV0Y2goZ2V0QXNzZXRQYXRoKGAuL2Fzc2V0cy8ke2NvbXBvbmVudH0vdDluL21lc3NhZ2VzXyR7bGFuZ30uanNvbmApKVxuICAgIC50aGVuKChyZXNwKSA9PiB7XG4gICAgaWYgKCFyZXNwLm9rKSB7XG4gICAgICB0aHJvd01lc3NhZ2VGZXRjaEVycm9yKCk7XG4gICAgfVxuICAgIHJldHVybiByZXNwLmpzb24oKTtcbiAgfSlcbiAgICAuY2F0Y2goKCkgPT4gdGhyb3dNZXNzYWdlRmV0Y2hFcnJvcigpKTtcbiAgcmV0dXJuIGNvbXBvbmVudExhbmdUb01lc3NhZ2VCdW5kbGVDYWNoZVtrZXldO1xufVxuZnVuY3Rpb24gdGhyb3dNZXNzYWdlRmV0Y2hFcnJvcigpIHtcbiAgdGhyb3cgbmV3IEVycm9yKFwiY291bGQgbm90IGZldGNoIGNvbXBvbmVudCBtZXNzYWdlIGJ1bmRsZVwiKTtcbn1cbmZ1bmN0aW9uIG1lcmdlTWVzc2FnZXMoY29tcG9uZW50KSB7XG4gIGNvbXBvbmVudC5tZXNzYWdlcyA9IHtcbiAgICAuLi5jb21wb25lbnQuZGVmYXVsdE1lc3NhZ2VzLFxuICAgIC4uLmNvbXBvbmVudC5tZXNzYWdlT3ZlcnJpZGVzXG4gIH07XG59XG4vKipcbiAqIFRoaXMgdXRpbGl0eSBzZXRzIHVwIHRoZSBtZXNzYWdlcyB1c2VkIGJ5IHRoZSBjb21wb25lbnQuIEl0IHNob3VsZCBiZSBhd2FpdGVkIGluIHRoZSBgY29tcG9uZW50V2lsbExvYWRgIGxpZmVjeWNsZSBob29rLlxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2V0VXBNZXNzYWdlcyhjb21wb25lbnQpIHtcbiAgY29tcG9uZW50LmRlZmF1bHRNZXNzYWdlcyA9IGF3YWl0IGZldGNoTWVzc2FnZXMoY29tcG9uZW50LCBjb21wb25lbnQuZWZmZWN0aXZlTG9jYWxlKTtcbiAgbWVyZ2VNZXNzYWdlcyhjb21wb25lbnQpO1xufVxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hNZXNzYWdlcyhjb21wb25lbnQsIGxhbmcpIHtcbiAgY29uc3QgeyBlbCB9ID0gY29tcG9uZW50O1xuICBjb25zdCB0YWcgPSBlbC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGNvbXBvbmVudE5hbWUgPSB0YWcucmVwbGFjZShcImNhbGNpdGUtXCIsIFwiXCIpO1xuICByZXR1cm4gZ2V0TWVzc2FnZUJ1bmRsZShnZXRTdXBwb3J0ZWRMb2NhbGUobGFuZywgXCJ0OW5cIiksIGNvbXBvbmVudE5hbWUpO1xufVxuLyoqXG4gKiBUaGlzIHV0aWxpdHkgbXVzdCBiZSBzZXQgdXAgZm9yIHRoZSBjb21wb25lbnQgdG8gdXBkYXRlIGl0cyBkZWZhdWx0IG1lc3NhZ2UgYnVuZGxlIGlmIHRoZSBsb2NhbGUgY2hhbmdlcy5cbiAqXG4gKiBJdCBjYW4gYmUgc2V0IHVwIGluICoqZWl0aGVyKiogb2YgdGhlIGZvbGxvd2luZyB3YXlzOlxuICpcbiAqIDEuIGNhbGxlZCBmcm9tIGBMb2NhbGl6ZWRDb21wb25lbnRgJ3MgYG9uTG9jYWxlQ2hhbmdlYCBtZXRob2Qgb3JcbiAqIDIuIGNhbGxlZCBmcm9tIGEgd2F0Y2hlciBjb25maWd1cmVkIHRvIHdhdGNoIGBMb2NhbGl6ZWRDb21wb25lbnRgJ3MgYGVmZmVjdGl2ZUxvY2FsZWAgcHJvcFxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqIEBwYXJhbSBsYW5nXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2VzKGNvbXBvbmVudCwgbGFuZykge1xuICBjb21wb25lbnQuZGVmYXVsdE1lc3NhZ2VzID0gYXdhaXQgZmV0Y2hNZXNzYWdlcyhjb21wb25lbnQsIGxhbmcpO1xuICBtZXJnZU1lc3NhZ2VzKGNvbXBvbmVudCk7XG59XG4vKipcbiAqIFRoaXMgdXRpbGl0eSBzZXRzIHVwIGludGVybmFscyBmb3IgbWVzc2FnZXMgc3VwcG9ydC5cbiAqXG4gKiBJdCBuZWVkcyB0byBiZSBjYWxsZWQgaW4gYGNvbm5lY3RlZENhbGxiYWNrYFxuICpcbiAqICoqTm90ZSoqOiB0aGlzIG11c3QgYmUgY2FsbGVkIGFmdGVyIGBMb2NhbGl6ZWRDb21wb25lbnRgJ3MgYGNvbm5lY3RMb2NhbGl6ZWRgIG1ldGhvZC5cbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50XG4gKi9cbmZ1bmN0aW9uIGNvbm5lY3RNZXNzYWdlcyhjb21wb25lbnQpIHtcbiAgY29tcG9uZW50Lm9uTWVzc2FnZXNDaGFuZ2UgPSBkZWZhdWx0T25NZXNzYWdlc0NoYW5nZTtcbn1cbi8qKlxuICogVGhpcyB1dGlsaXR5IHRlYXJzIGRvd24gaW50ZXJuYWxzIGZvciBtZXNzYWdlcyBzdXBwb3J0LlxuICpcbiAqIEl0IG5lZWRzIHRvIGJlIGNhbGxlZCBpbiBgZGlzY29ubmVjdGVkQ2FsbGJhY2tgXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICovXG5mdW5jdGlvbiBkaXNjb25uZWN0TWVzc2FnZXMoY29tcG9uZW50KSB7XG4gIGNvbXBvbmVudC5vbk1lc3NhZ2VzQ2hhbmdlID0gdW5kZWZpbmVkO1xufVxuZnVuY3Rpb24gZGVmYXVsdE9uTWVzc2FnZXNDaGFuZ2UoKSB7XG4gIG1lcmdlTWVzc2FnZXModGhpcyk7XG59XG5cbmV4cG9ydCB7IGNvbm5lY3RNZXNzYWdlcyBhcyBjLCBkaXNjb25uZWN0TWVzc2FnZXMgYXMgZCwgc2V0VXBNZXNzYWdlcyBhcyBzLCB1cGRhdGVNZXNzYWdlcyBhcyB1IH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXQ5bi05NjAzZmYwNS5qcy5tYXAiLCJpbXBvcnQgeyBhIGFzIGdldEFzc2V0UGF0aCB9IGZyb20gJy4vaW5kZXgtNGU2NDc0MTEuanMnO1xuaW1wb3J0IHsgYyBhcyBkYXRlRnJvbUlTTyB9IGZyb20gJy4vZGF0ZS0xOWJjOGMwNC5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFN1cHBvcnRlZExvY2FsZSB9IGZyb20gJy4vbG9jYWxlLTcwNmRmNGM3LmpzJztcblxuLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtY29tcG9uZW50cy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuMC41XG4gKi9cbi8qKlxuICogQ0xEUiBjYWNoZS5cbiAqIEV4cG9ydGVkIGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbmNvbnN0IHRyYW5zbGF0aW9uQ2FjaGUgPSB7fTtcbi8qKlxuICogQ0xEUiByZXF1ZXN0IGNhY2hlLlxuICogRXhwb3J0ZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgcmVxdWVzdENhY2hlID0ge307XG4vKipcbiAqIEZldGNoIGNhbGVuZGFyIGRhdGEgZm9yIGEgZ2l2ZW4gbG9jYWxlIGZyb20gbGlzdCBvZiBzdXBwb3J0ZWQgbGFuZ3VhZ2VzXG4gKlxuICogQHBhcmFtIGxhbmdcbiAqIEBwdWJsaWNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYWxlRGF0YShsYW5nKSB7XG4gIGNvbnN0IGxvY2FsZSA9IGdldFN1cHBvcnRlZExvY2FsZShsYW5nKTtcbiAgaWYgKHRyYW5zbGF0aW9uQ2FjaGVbbG9jYWxlXSkge1xuICAgIHJldHVybiB0cmFuc2xhdGlvbkNhY2hlW2xvY2FsZV07XG4gIH1cbiAgaWYgKCFyZXF1ZXN0Q2FjaGVbbG9jYWxlXSkge1xuICAgIHJlcXVlc3RDYWNoZVtsb2NhbGVdID0gZmV0Y2goZ2V0QXNzZXRQYXRoKGAuL2Fzc2V0cy9kYXRlLXBpY2tlci9ubHMvJHtsb2NhbGV9Lmpzb25gKSlcbiAgICAgIC50aGVuKChyZXNwKSA9PiByZXNwLmpzb24oKSlcbiAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBUcmFuc2xhdGlvbnMgZm9yIFwiJHtsb2NhbGV9XCIgbm90IGZvdW5kIG9yIGludmFsaWQsIGZhbGxpbmcgYmFjayB0byBlbmdsaXNoYCk7XG4gICAgICByZXR1cm4gZ2V0TG9jYWxlRGF0YShcImVuXCIpO1xuICAgIH0pO1xuICB9XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCByZXF1ZXN0Q2FjaGVbbG9jYWxlXTtcbiAgdHJhbnNsYXRpb25DYWNoZVtsb2NhbGVdID0gZGF0YTtcbiAgcmV0dXJuIGRhdGE7XG59XG4vKipcbiAqICBNYXBzIHZhbHVlIHRvIHZhbHVlQXNEYXRlXG4gKlxuICogQHBhcmFtIHZhbHVlXG4gKi9cbmZ1bmN0aW9uIGdldFZhbHVlQXNEYXRlUmFuZ2UodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLm1hcCgodiwgaW5kZXgpID0+IGRhdGVGcm9tSVNPKHYsIGluZGV4ID09PSAxKSk7XG59XG5cbmV4cG9ydCB7IGdldExvY2FsZURhdGEgYXMgYSwgZ2V0VmFsdWVBc0RhdGVSYW5nZSBhcyBnIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLWFmMDNjYWFkLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==