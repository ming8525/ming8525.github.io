"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-1c1d2f"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-group-badges_2.entry.js":
/*!************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-group-badges_2.entry.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_group_badges: () => (/* binding */ ArcgisItemBadges),
/* harmony export */   arcgis_group_card: () => (/* binding */ ArcgisGroupCard)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./functional-44de8fcf.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./locale-050b6db9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js");
/* harmony import */ var _store_da3fccd5_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./store-da3fccd5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-da3fccd5.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./resize-a17b7292.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/resize-a17b7292.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _store_8b1b0846_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./store-8b1b0846.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-8b1b0846.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */












function getBadges(group, portal) {
    const badges = [];
    if (portal.id) {
        if (group.capabilities && group.capabilities.includes("updateitemcontrol")) {
            badges.push("SharedUpdate");
        }
        if (group.isOpenData && group.orgId === portal.id) {
            badges.push("OpenData");
        }
        if (portal.featuredItemsGroupQuery && portal.featuredItemsGroupQuery === `id:${group.id}`) {
            badges.push("Gallery");
        }
    }
    if ((group.collaborationInfo && group.collaborationInfo.collaborationId) ||
        (group.capabilities && group.capabilities.includes("distributed"))) {
        badges.push("Collaboration");
    }
    if (!group.membershipAccess && !portal.isPortal && group.orgId !== "none") {
        badges.push("AnyOrg");
    }
    if (group.membershipAccess === "collaboration") {
        badges.push("Partnered");
    }
    // if shared update with no collaboration OR distributed collaboration, only show when group is in the user's org
    if (badges.includes("SharedUpdate") && !badges.includes("Partnered") && group.orgId !== portal.id) {
        badges.splice(badges.indexOf("SharedUpdate"), 1);
    }
    return badges;
}

const arcgisGroupBadgesCss = ":host{display:flex}.badge{display:inline-block;margin-inline-end:0.25rem}";

const ArcgisItemBadges = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.group = undefined;
        this.portal = undefined;
        this.width = "full";
        this.appearance = undefined;
        this.empty = false;
        this.showTooltips = false;
        this.scale = "m";
        this.badges = [];
    }
    componentWillLoad() {
        if (this.group) {
            this.updateBadges(this.group);
        }
    }
    updateBadges(group) {
        var _a;
        this.badges = getBadges(group, this.portal);
        if (!((_a = this.badges) === null || _a === void 0 ? void 0 : _a.length)) {
            this.empty = true;
        }
    }
    render() {
        const { width, scale, badges, showTooltips, appearance } = this;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, badges.map((badge) => ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-group-badge", { appearance: appearance, key: badge, class: "badge", badgeType: badge, width: width, scale: scale, showTooltip: showTooltips })))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
    static get watchers() { return {
        "group": ["updateBadges"]
    }; }
};
ArcgisItemBadges.style = arcgisGroupBadgesCss;

const arcgisGroupCardCss = ":host{display:block;min-width:0px}.group-card{position:relative;display:flex;height:100%;flex-direction:column;color:var(--calcite-color-text-1);opacity:0;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transition-duration:150ms;outline-color:transparent;background-color:var(--calcite-color-foreground-1);transition-property:background-color, outline, outline-offset, opacity;border:1px solid var(--calcite-color-border-3)}.group-card:focus{z-index:10;outline:2px solid var(--calcite-color-brand);outline-offset:-2px}.group-card--loaded{opacity:1}.group-card--selected{border-color:var(--calcite-color-brand)}.group-card--hoverable{cursor:pointer}.group-card__top{padding:1rem}.group-card__hover-text{position:absolute;inset:0px;display:flex;align-items:center;justify-content:center;text-align:center;font-size:1rem;font-weight:500;opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;background-color:rgba(21, 21, 21, 0.7);color:white}.group-card__upper{flex:1 1 0%;background-color:var(--calcite-color-foreground-1);transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s}.group-card__upper:hover{background-color:var(--calcite-color-background)}.group-card__upper:hover .group-card__hover-text,.group-card:focus .group-card__hover-text{opacity:1}.group-card__upper--compact{display:flex;align-items:center;padding-top:0.5rem;padding-bottom:0.5rem;padding-left:0.75rem;padding-right:0.75rem}.group-card__upper--link{color:var(--calcite-color-text-1);text-decoration-line:none;outline-color:transparent}.group-card__upper--link:focus{z-index:10;outline:2px solid var(--calcite-color-brand);outline-offset:2px}.group-card__title__span{position:relative;display:inline;border-style:none;background-color:transparent;padding:0px;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;background-image:linear-gradient(transparent, transparent);background-position-x:0%, 100%;background-position-y:min(1.25em, 100%);background-repeat:no-repeat, no-repeat;background-size:100% 1px, 100% 1px}.group-card--previewed .group-card__title__span{background-image:linear-gradient(var(--calcite-color-text-3), var(--calcite-color-text-3))}.group-card__content{display:flex;min-width:0px;flex:1 1 0%;flex-direction:column}.group-card__details{display:flex;flex-direction:row;flex-wrap:wrap}.group-card__details--stacked{flex-direction:column}.group-card__detail{font-size:0.875rem;color:var(--calcite-color-text-2)}.group-card__detail__icon{margin-inline-end:0.5rem}.group-card__calendar-icon{color:var(--calcite-color-text-3);margin-inline-end:0.5rem}.group-card__footer{margin-top:auto;display:flex;align-items:center;background-color:var(--calcite-color-foreground-1);padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;border-top:1px solid var(--calcite-color-border-3)}.group-card__footer__start{display:flex;min-width:0px;flex:1 1 0%;flex-direction:row;align-items:center;overflow:hidden;margin-inline-end:0.75rem}.group-card__footer__start--selectable{margin-inline-start:1.5rem}.group-card__profile-wrap{max-width:100%;padding:0.25rem}.group-card__updated{font-size:0.875rem;color:var(--calcite-color-text-2)}.group-card__updated--xs{margin-top:0.5rem}.group-card__divider{display:flex;align-items:center;flex:0 0 auto}.group-card__divider:not([empty]):before{content:\"\";height:1.25rem;width:1px;background-color:var(--calcite-color-border-1);margin-inline:0.75rem}.group-card__details--stacked .group-card__divider:before{display:none}.group-card__divider:first-child:before{display:none}.group-card-flex{display:flex}.group-card-flex-1{min-width:0px;flex:1 1 0%}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.group-card__input{margin-inline-end:1rem;margin-top:0.125rem}.group-card__title{margin-top:0px;margin-bottom:0px;overflow-wrap:break-word;padding-top:0px;padding-bottom:0px;font-size:1rem;font-weight:500;line-height:1.375}.group-card__title--compact{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-inline-end:1rem}.group-card__summary{margin:0px;margin-top:0.25rem;margin-bottom:0.25rem;flex:1 1 0%;padding:0px;font-size:0.875rem;line-height:1.25}.group-card__thumbnail{margin-inline-end:1rem}.group-card__thumbnail--compact{width:2.75rem;height:2.75rem}.group-card__badges{margin-top:0.25rem}.group-card__owner{min-width:0px}.group-card--panel{margin-bottom:0px;cursor:pointer;border-bottom:1px solid var(--calcite-color-border-1);outline:1px solid rgba(0, 0, 0, 0)}.group-card--panel:hover{background-color:var(--calcite-color-foreground-2)}.group-card--border-top{border-top:1px solid var(--calcite-color-border-1)}.group-card--border-top:hover{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.group-card--xs .group-card__top,.group-card--xxs .group-card__top{padding:0.75rem}.group-card--xs .group-card__title--padded,.group-card--xxs .group-card__title--padded{margin-bottom:0.25rem}.group-card--xs .group-card__footer,.group-card--xxs .group-card__footer{padding-top:0.25rem;padding-bottom:0.25rem;padding-left:0.75rem;padding-right:0.75rem}.group-card--xs .group-card__detail,.group-card--xxs .group-card__detail{margin-top:0.25rem;margin-bottom:0.25rem;font-size:0.75rem;line-height:1.35}.group-card--xs .group-card__title,.group-card--xxs .group-card__title{font-size:0.875rem}.group-card--xxs .group-card__thumbnail{padding-inline-start:0.75rem;width:4.25rem}.group-card--xs .group-card__thumbnail{padding-inline-start:0.5rem;width:5rem}";

const ArcgisGroupCard = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisGroupCardSelect = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisGroupCardSelect", 7);
        this.arcgisGroupBrowserCardPreview = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisGroupBrowserCardPreview", 7);
        this.arcgisGroupBrowserInternalUIAction = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisGroupBrowserInternalUIAction", 7);
        var _a;
        this.handleResizeEvent = ({ detail }) => {
            this.resize(detail.width);
        };
        this.handleCardClick = () => {
            const { group, preview } = this;
            if (this.link) {
                return;
            }
            if (preview === "top") {
                this.arcgisGroupBrowserCardPreview.emit(group);
                return;
            }
            if (this.radioButton) {
                this.radioButton.checked = true;
                this.arcgisGroupCardSelect.emit({ group, selected: true });
            }
            else if (this.checkbox) {
                this.selected = !this.selected;
                this.arcgisGroupCardSelect.emit({ group, selected: this.selected });
            }
        };
        this.group = undefined;
        this.user = undefined;
        this.portal = undefined;
        this.api = 4;
        this.baseUrl = (_a = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c === null || _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c === void 0 ? void 0 : _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c.config) === null || _a === void 0 ? void 0 : _a.baseUrl;
        this.selected = undefined;
        this.indeterminate = undefined;
        this.view = "list";
        this.selection = "none";
        this.preview = undefined;
        this.name = undefined;
        this.showOwner = true;
        this.showDateUpdated = true;
        this.showDateCreated = false;
        this.showViewableBy = true;
        this.showSummary = false;
        this.showBadges = true;
        this.link = undefined;
        this.newTab = undefined;
        this.hover = undefined;
        this.formFactor = undefined;
        this.updatedText = "";
        this.createdText = "";
        this.loaded = undefined;
        this.width = undefined;
    }
    /* Calling this setFocus causes calcite to focus here when the user popup is closed... */
    async restoreFocus() {
        if (this.link && this.linkEl) {
            this.linkEl.focus();
            return;
        }
        if (this.preview === "top" && this.sectionEl) {
            this.sectionEl.focus();
            return;
        }
    }
    async componentWillLoad() {
        var _a, _b;
        const { el } = this;
        const locale = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_4__.g)(el);
        this.i18n = locale[0];
        // if we're inside a group browser, use that store, otherwise create one just for this card
        this.store = (0,_store_da3fccd5_js__WEBPACK_IMPORTED_MODULE_5__.g)(this.el) || (0,_index_05956cab_js__WEBPACK_IMPORTED_MODULE_6__.c)({ filters: {} });
        (_a = this.formFactor) !== null && _a !== void 0 ? _a : (this.formFactor = ((_b = this.store) === null || _b === void 0 ? void 0 : _b.state.panel) ? "xs" : "lg");
        (0,_resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.s)(this.store).observe(this.el);
        this.el.addEventListener("arcgisBrowserResize", this.handleResizeEvent);
        this.updatedText = this.i18n.lastUpdated.replace("${date}", (0,_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_3__.a)(this.group.modified));
        this.createdText = this.i18n.created.replace("${date}", (0,_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_3__.a)(this.group.created));
    }
    async componentDidLoad() {
        await (0,_functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_2__.t)(100);
        this.loaded = true;
    }
    disconnectedCallback() {
        var _a, _b, _c, _d;
        (_c = (_b = (_a = this.store) === null || _a === void 0 ? void 0 : _a.state) === null || _b === void 0 ? void 0 : _b.resizeObserver) === null || _c === void 0 ? void 0 : _c.unobserve(this.el);
        (_d = this.el) === null || _d === void 0 ? void 0 : _d.removeEventListener("arcgisBrowserResize", this.handleResizeEvent);
    }
    resize(width) {
        switch (true) {
            case width > _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.b.md:
                this.formFactor = "lg";
                break;
            case width > _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.b.sm:
                this.formFactor = "md";
                break;
            case width > _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.b.xs:
                this.formFactor = "sm";
                break;
            case width > _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.b.xxs:
                this.formFactor = "xs";
                break;
            default:
                this.formFactor = "xxs";
                break;
        }
        this.width = width;
    }
    getAccessInfo(access) {
        const info = {
            public: {
                text: this.i18n.everyone,
                icon: "globe"
            },
            private: {
                text: this.i18n.groupMembers,
                icon: "lock"
            },
            org: {
                text: this.i18n.organization,
                icon: "organization"
            }
        };
        return info[access] || info.private;
    }
    renderCompactView() {
        const { group, portal, selection, selected, formFactor, i18n, link, loaded, newTab, showBadges } = this;
        const CardTag = this.link ? "a" : "div";
        const linkAttributes = Object.assign({ href: link }, (newTab ? { target: "_blank", rel: "noopener noreferrer" } : {}));
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("section", Object.assign({ class: {
                "group-card": true,
                "group-card--hoverable": selection !== "none",
                [`group-card--${formFactor}`]: true,
                "group-card--loaded": loaded
            }, onMouseOver: () => (this.hover = true), onMouseOut: () => (this.hover = false) }, (link ? {} : { onClick: this.handleCardClick }), { ref: (el) => (this.sectionEl = el) }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(CardTag, Object.assign({ class: {
                "group-card__upper": true,
                "group-card__upper--link": !!link,
                "group-card__upper--compact": true
            } }, (link ? linkAttributes : {}), { ref: (el) => (this.linkEl = el) }), selection === "single" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-radio-button", { class: "group-card__input", checked: selected, value: group.title, name: this.name, ref: (el) => (this.radioButton = el), onClick: (e) => {
                e.stopPropagation();
            }, onCalciteRadioButtonChange: () => {
                this.arcgisGroupCardSelect.emit({ group, selected: !selected });
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "screen-readers-only" }, i18n.select.replace("${title}", group.title)))), selection === "multiple" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-checkbox", { class: "group-card__input", checked: selected, indeterminate: this.indeterminate, onClick: (e) => {
                e.stopPropagation();
            }, onCalciteCheckboxChange: () => {
                this.arcgisGroupCardSelect.emit({ group, selected: !this.selected });
            }, value: group.id, ref: (el) => (this.checkbox = el) }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "screen-readers-only" }, group.title))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "flex-0 group-card__thumbnail group-card__thumbnail--compact" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-group-thumbnail", { group: group, portal: portal, scale: "l" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card-flex-1" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("h3", { class: "group-card__title group-card__title--compact" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "group-card__title__span" }, group.title))), showBadges && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-group-badges", { group: group, portal: portal, class: "group-card__badges--compact", scale: "s", showTooltips: true, width: "narrow" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-end" }))));
    }
    render() {
        var _a, _b;
        const { group, portal, selection, selected, formFactor, api, i18n, link, loaded, newTab, showDateCreated, showDateUpdated, showOwner, showBadges, showSummary } = this;
        const baseUrl = (_a = this.baseUrl) !== null && _a !== void 0 ? _a : (_b = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c.config) === null || _b === void 0 ? void 0 : _b.baseUrl;
        const current = _store_da3fccd5_js__WEBPACK_IMPORTED_MODULE_5__.a.preview === this.group.id;
        const topPreview = this.preview === "top";
        const CardTag = this.link ? "a" : "div";
        const linkAttributes = Object.assign({ href: link }, (newTab ? { target: "_blank", rel: "noopener noreferrer" } : {}));
        const topPreviewAttributes = {
            tabIndex: 0,
            role: "button",
            "aria-haspopup": "dialog",
            "aria-labelledby": "open-details",
            onKeyPress: (e) => {
                if (e.key === "Enter" || e.key == " ") {
                    e.preventDefault();
                    this.handleCardClick();
                }
            }
        };
        const accessInfo = this.getAccessInfo(group.access);
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, this.view === "compact" ? (this.renderCompactView()) : ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("section", Object.assign({ class: {
                "group-card": true,
                "group-card--hoverable": selection !== "none",
                [`group-card--${formFactor}`]: true,
                "group-card--loaded": loaded
            } }, (link ? {} : { onClick: this.handleCardClick }), (topPreview && !link ? topPreviewAttributes : {}), { ref: (el) => (this.sectionEl = el) }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-top" }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(CardTag, Object.assign({ class: { "group-card__upper": true, "group-card__upper--link": !!link } }, (link ? linkAttributes : {}), { onMouseOver: () => (this.hover = true), onMouseOut: () => (this.hover = false) }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card-flex group-card__top" }, selection === "single" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-radio-button", { class: "group-card__input", checked: selected, value: group.title, name: this.name, ref: (el) => (this.radioButton = el), onClick: (e) => {
                e.stopPropagation();
            }, onCalciteRadioButtonChange: () => {
                this.arcgisGroupCardSelect.emit({ group, selected: !selected });
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "screen-readers-only" }, i18n.select.replace("${title}", group.title)))), selection === "multiple" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-checkbox", { class: "group-card__input", checked: selected, indeterminate: this.indeterminate, onClick: (e) => {
                e.stopPropagation();
            }, onCalciteCheckboxChange: () => {
                this.arcgisGroupCardSelect.emit({ group, selected: !this.selected });
            }, value: group.id, ref: (el) => (this.checkbox = el) }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "screen-readers-only" }, group.title))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "flex-0 group-card__thumbnail" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-group-thumbnail", { group: group, portal: portal, scale: "xl" })), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card-flex-1" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card-flex" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card__content" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("h3", { class: {
                "group-card__title": true,
                "group-card__title--padded": showSummary && !!group.snippet
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "group-card__title__span" }, group.title)), showSummary && group.snippet && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("p", { class: "group-card__summary" }, group.snippet.length > 250
            ? `${group.snippet.substring(0, 250)}…`
            : group.snippet)), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                "group-card__details": true,
                "group-card__details--stacked": this.width < 580
            } }, showDateCreated && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "group-card__detail group-card__divider" }, this.createdText)), showDateUpdated && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "group-card__detail group-card__divider" }, this.updatedText)), this.showViewableBy && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "group-card__detail group-card__divider" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { icon: accessInfo.icon, scale: "s", class: "group-card__detail__icon" }), " ", i18n.viewableBy.replace("${level}", accessInfo.text))), showBadges && this.width >= _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.b.sm && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-group-badges", { appearance: this.hover ? "outline-fill" : "solid", group: group, portal: portal, width: this.width < 840 ? "narrow" : "full", class: "group-card__badges group-card__detail group-card__divider", scale: "s", showTooltips: true }))), showBadges && this.width < _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.b.sm && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-group-badges", { appearance: this.hover ? "outline-fill" : "solid", group: group, portal: portal, width: this.width < _resize_a17b7292_js__WEBPACK_IMPORTED_MODULE_7__.b.xxs ? "narrow" : "full", class: "group-card__badges", scale: "s", showTooltips: true })))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "content-end" })))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card__footer", onClick: (e) => {
                e.stopPropagation();
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card__footer__start" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "actions-start" }), showOwner && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "group-card__profile-wrap", onClick: (e) => {
                e.preventDefault();
                e.stopPropagation();
            } }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-user-popup", { underline: true, username: group.owner, api: api, portal: portal, baseUrl: baseUrl, class: "group-card__owner", onArcgisUserPopupInternalUIAction: (e) => {
                e.stopPropagation();
                this.arcgisGroupBrowserInternalUIAction.emit(e.detail);
            } })))), this.preview === "action" && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { scale: "s", appearance: current ? "solid" : "outline-fill", kind: "neutral", onClick: (e) => {
                e.preventDefault();
                e.stopPropagation();
                this.arcgisGroupBrowserCardPreview.emit(this.group);
            } }, current ? i18n.hidePreview : i18n.preview)), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: "actions-end" }))))));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisGroupCard.style = arcgisGroupCardCss;



//# sourceMappingURL=arcgis-group-badges_2.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ configState),
/* harmony export */   o: () => (/* binding */ onConfigChange)
/* harmony export */ });
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const configStore = (0,_index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__.c)({
    portal: null,
    user: null,
    api: 4,
    scale: "m"
});
const configState = configStore.state;
const onConfigChange = configStore.onChange;



//# sourceMappingURL=config-75adf962.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ arrayToLookupMap),
/* harmony export */   b: () => (/* binding */ unique),
/* harmony export */   c: () => (/* binding */ throttle),
/* harmony export */   d: () => (/* binding */ debounce),
/* harmony export */   e: () => (/* binding */ escapeRegExp),
/* harmony export */   f: () => (/* binding */ arraysAreEquivalent),
/* harmony export */   g: () => (/* binding */ chunk),
/* harmony export */   i: () => (/* binding */ isDefined),
/* harmony export */   m: () => (/* binding */ minDelay),
/* harmony export */   t: () => (/* binding */ timeout),
/* harmony export */   u: () => (/* binding */ uniqueBy)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
/**
 * Call a function only after it has not been called for n milliseconds
 * @param fn    - function to call
 * @param delay - delay in milliseconds
 */
const debounce = (fn, delay) => {
    let timeout;
    let status = "idle";
    function flush(...args) {
        status = "flushed";
        return debounced(...args);
    }
    function invoke(...args) {
        status = "invoked";
        return debounced(...args);
    }
    function cancel(...args) {
        status = "cancelled";
        return debounced(...args);
    }
    function getStatus() {
        return status;
    }
    const debounced = (...args) => new Promise((resolve) => {
        switch (status) {
            case "flushed":
                status = "idle";
                if (timeout) {
                    clearTimeout(timeout);
                    resolve(fn(...args));
                }
                else {
                    resolve(null);
                }
                break;
            case "invoked":
                clearTimeout(timeout);
                status = "idle";
                resolve(fn(...args));
                break;
            case "cancelled":
                clearTimeout(timeout);
                status = "idle";
                resolve(null);
                break;
            default:
                if (timeout) {
                    clearTimeout(timeout);
                }
                status = "pending";
                timeout = setTimeout(() => {
                    status = "idle";
                    return resolve(fn(...args));
                }, delay);
                break;
        }
    });
    debounced.flush = flush;
    debounced.invoke = invoke;
    debounced.cancel = cancel;
    debounced.getStatus = getStatus;
    return debounced;
};
/**
 * Call a function only after n milliseconds have elapsed
 * @param fn    - function to call
 * @param delay - delay in milliseconds
 */
const throttle = (fn, delay) => {
    let timeout;
    return (...args) => new Promise((resolve) => {
        if (timeout) {
            return;
        }
        timeout = setTimeout(() => {
            clearTimeout(timeout);
            timeout = undefined;
            resolve(fn(...args));
        }, delay);
    });
};
function escapeRegExp(str) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"); // $& means the whole matched string
}
function isDefined(value) {
    return value !== undefined && value !== null;
}
/**
 * Set a minimum time for a promise to resolve (useful for preventing flash of loaders)
 */
async function minDelay(promise, minDelay) {
    await Promise.all([promise, timeout(minDelay)]);
    return promise;
}
/**
 * Helper method to inline setTimeout as an await in async functions
 */
function timeout(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
}
const arrayToLookupMap = (dataArr, getKeyAndItem) => Object.fromEntries((dataArr || []).map((item) => {
    const { key, data } = getKeyAndItem(item);
    return [key, data];
}));
/**
 * Check whether two arrays have the same number of elements
 * and whether they contain the same elements
 * regardless of order
 */
const arraysAreEquivalent = (arr1, arr2) => arr1.length === arr2.length && arr1.reduce((memo, str) => memo && arr2.indexOf(str) > -1, true);
function uniqueBy(myArr, getItemId) {
    const resultArr = [];
    const lookupMap = {};
    myArr.forEach((item) => {
        const id = getItemId(item);
        if (lookupMap[id] == null) {
            lookupMap[id] = item;
            resultArr.push(item);
        }
    });
    return resultArr;
}
function unique(myArr) {
    const primitives = { boolean: {}, number: {}, string: {} };
    const objs = [];
    return myArr.filter((item) => {
        let type = typeof item;
        if (type in primitives) {
            return primitives[type].hasOwnProperty(item) ? false : (primitives[type][item] = true);
        }
        else {
            return objs.indexOf(item) >= 0 ? false : objs.push(item);
        }
    });
}
const chunk = (arr, size) => [...Array(Math.ceil(arr.length / size))].map((_, i) => arr.slice(size * i, size + size * i));



//# sourceMappingURL=functional-44de8fcf.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createStore)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const appendToMap = (map, propName, value) => {
    const items = map.get(propName);
    if (!items) {
        map.set(propName, [value]);
    }
    else if (!items.includes(value)) {
        items.push(value);
    }
};
const debounce = (fn, ms) => {
    let timeoutId;
    return (...args) => {
        if (timeoutId) {
            clearTimeout(timeoutId);
        }
        timeoutId = setTimeout(() => {
            timeoutId = 0;
            fn(...args);
        }, ms);
    };
};

/**
 * Check if a possible element isConnected.
 * The property might not be there, so we check for it.
 *
 * We want it to return true if isConnected is not a property,
 * otherwise we would remove these elements and would not update.
 *
 * Better leak in Edge than to be useless.
 */
const isConnected = (maybeElement) => !('isConnected' in maybeElement) || maybeElement.isConnected;
const cleanupElements = debounce((map) => {
    for (let key of map.keys()) {
        map.set(key, map.get(key).filter(isConnected));
    }
}, 2000);
const stencilSubscription = () => {
    if (typeof _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.g !== 'function') {
        // If we are not in a stencil project, we do nothing.
        // This function is not really exported by @stencil/core.
        return {};
    }
    const elmsToUpdate = new Map();
    return {
        dispose: () => elmsToUpdate.clear(),
        get: (propName) => {
            const elm = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.g)();
            if (elm) {
                appendToMap(elmsToUpdate, propName, elm);
            }
        },
        set: (propName) => {
            const elements = elmsToUpdate.get(propName);
            if (elements) {
                elmsToUpdate.set(propName, elements.filter(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.f));
            }
            cleanupElements(elmsToUpdate);
        },
        reset: () => {
            elmsToUpdate.forEach((elms) => elms.forEach(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.f));
            cleanupElements(elmsToUpdate);
        },
    };
};

const unwrap = (val) => (typeof val === 'function' ? val() : val);
const createObservableMap = (defaultState, shouldUpdate = (a, b) => a !== b) => {
    const unwrappedState = unwrap(defaultState);
    let states = new Map(Object.entries(unwrappedState !== null && unwrappedState !== void 0 ? unwrappedState : {}));
    const handlers = {
        dispose: [],
        get: [],
        set: [],
        reset: [],
    };
    const reset = () => {
        var _a;
        // When resetting the state, the default state may be a function - unwrap it to invoke it.
        // otherwise, the state won't be properly reset
        states = new Map(Object.entries((_a = unwrap(defaultState)) !== null && _a !== void 0 ? _a : {}));
        handlers.reset.forEach((cb) => cb());
    };
    const dispose = () => {
        // Call first dispose as resetting the state would
        // cause less updates ;)
        handlers.dispose.forEach((cb) => cb());
        reset();
    };
    const get = (propName) => {
        handlers.get.forEach((cb) => cb(propName));
        return states.get(propName);
    };
    const set = (propName, value) => {
        const oldValue = states.get(propName);
        if (shouldUpdate(value, oldValue, propName)) {
            states.set(propName, value);
            handlers.set.forEach((cb) => cb(propName, value, oldValue));
        }
    };
    const state = (typeof Proxy === 'undefined'
        ? {}
        : new Proxy(unwrappedState, {
            get(_, propName) {
                return get(propName);
            },
            ownKeys(_) {
                return Array.from(states.keys());
            },
            getOwnPropertyDescriptor() {
                return {
                    enumerable: true,
                    configurable: true,
                };
            },
            has(_, propName) {
                return states.has(propName);
            },
            set(_, propName, value) {
                set(propName, value);
                return true;
            },
        }));
    const on = (eventName, callback) => {
        handlers[eventName].push(callback);
        return () => {
            removeFromArray(handlers[eventName], callback);
        };
    };
    const onChange = (propName, cb) => {
        const unSet = on('set', (key, newValue) => {
            if (key === propName) {
                cb(newValue);
            }
        });
        // We need to unwrap the defaultState because it might be a function.
        // Otherwise we might not be sending the right reset value.
        const unReset = on('reset', () => cb(unwrap(defaultState)[propName]));
        return () => {
            unSet();
            unReset();
        };
    };
    const use = (...subscriptions) => {
        const unsubs = subscriptions.reduce((unsubs, subscription) => {
            if (subscription.set) {
                unsubs.push(on('set', subscription.set));
            }
            if (subscription.get) {
                unsubs.push(on('get', subscription.get));
            }
            if (subscription.reset) {
                unsubs.push(on('reset', subscription.reset));
            }
            if (subscription.dispose) {
                unsubs.push(on('dispose', subscription.dispose));
            }
            return unsubs;
        }, []);
        return () => unsubs.forEach((unsub) => unsub());
    };
    const forceUpdate = (key) => {
        const oldValue = states.get(key);
        handlers.set.forEach((cb) => cb(key, oldValue, oldValue));
    };
    return {
        state,
        get,
        set,
        on,
        onChange,
        use,
        dispose,
        reset,
        forceUpdate,
    };
};
const removeFromArray = (array, item) => {
    const index = array.indexOf(item);
    if (index >= 0) {
        array[index] = array[array.length - 1];
        array.length--;
    }
};

const createStore = (defaultState, shouldUpdate) => {
    const map = createObservableMap(defaultState, shouldUpdate);
    map.use(stencilSubscription());
    return map;
};



//# sourceMappingURL=index-05956cab.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js":
/*!******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CSS_UTILITY),
/* harmony export */   a: () => (/* binding */ formatDate),
/* harmony export */   b: () => (/* binding */ formatPlural),
/* harmony export */   f: () => (/* binding */ formatNumber),
/* harmony export */   g: () => (/* binding */ getElementDir),
/* harmony export */   l: () => (/* binding */ languageMap)
/* harmony export */ });
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



const languageMap = new Map([
    ["ar", "ar"],
    ["bg", "bg"],
    ["bs", "bs"],
    ["ca", "ca"],
    ["cs", "cs"],
    ["da", "da"],
    ["de", "de"],
    ["el", "el"],
    ["en", "en"],
    ["es", "es"],
    ["et", "et"],
    ["fi", "fi"],
    ["fr", "fr"],
    ["he", "he"],
    ["hr", "hr"],
    ["hu", "hu"],
    ["id", "id"],
    ["it", "it"],
    ["ja", "ja"],
    ["ko", "ko"],
    ["lt", "lt"],
    ["lv", "lv"],
    ["nb", "nb"],
    ["nl", "nl"],
    ["pl", "pl"],
    ["pt-br", "pt-BR"],
    ["pt-pt", "pt-PT"],
    ["ro", "ro"],
    ["ru", "ru"],
    ["sk", "sk"],
    ["sl", "sl"],
    ["sr", "sr"],
    ["sv", "sv"],
    ["th", "th"],
    ["tr", "tr"],
    ["uk", "uk"],
    ["vi", "vi"],
    ["zh-cn", "zh-CN"],
    ["zh-hk", "zh-HK"],
    ["zh-tw", "zh-TW"]
]);
// rtl
function getElementDir(el) {
    return getElementProp(el, "dir", "ltr");
}
function getElementProp(el, prop, value) {
    const closestWithProp = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_1__.c)(el, `[${prop}]`);
    return closestWithProp ? closestWithProp.getAttribute(prop) : value;
}
// css
const CSS_UTILITY = {
    rtl: "arcgis--rtl"
};
async function formatNumber(number, options) {
    const { api, type, places } = options || {};
    if (api === 4) {
        const [intl] = await (0,_loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__.l)(["esri/intl"]);
        const numberFormatIntlOptions = intl.convertNumberFormatToIntlOptions({
            places,
            style: type,
            digitSeparator: true
        });
        return intl.formatNumber(number, Object.assign(Object.assign({}, numberFormatIntlOptions), { style: type }));
    }
    const [dojoNumber] = await (0,_loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__.l)(["dojo/number"]);
    return dojoNumber.format(number, {
        type,
        places,
        pattern: options === null || options === void 0 ? void 0 : options.pattern
    });
}
const cache = {};
function formatDate(date) {
    const lang = document.documentElement.lang;
    const dayShortMonthYear = {
        year: "numeric",
        month: "short",
        day: "numeric"
    };
    if (!cache[lang]) {
        cache[lang] = new Intl.DateTimeFormat(document.documentElement.lang, dayShortMonthYear);
    }
    return cache[lang].format(date);
}
function formatPlural(lang, stringObj, number) {
    const singles = ["id", "ja", "ko", "th", "vi", "zh-cn", "zh-hk", "zh-tw"];
    const likeEnglish = [
        "en",
        "ca",
        "da",
        "de",
        "el",
        "es",
        "et",
        "fi",
        "hi",
        "hu",
        "it",
        "nb",
        "nl",
        "pt-pt",
        "sv",
        "tr"
    ];
    const locale = lang !== null && lang !== void 0 ? lang : "en";
    // if the number is one, or it is a "simple" language, return the 1 string
    if (number === 1 || singles.includes(locale)) {
        return stringObj.single.replace("${number}", "1");
    }
    // if the number is not 1 and the language uses the same pluralization strategy as english,
    // return the multiple string
    if (number !== 1 && likeEnglish.includes(locale)) {
        return stringObj.multiple.replace("${number}", `${number}`);
    }
    // if none of the above worked, return the "unknown" string
    return stringObj.unknown.replace("${number}", `${number}`);
}



//# sourceMappingURL=languageUtil-ef0e54b2.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getComponentClosestLanguage),
/* harmony export */   g: () => (/* binding */ getLocaleComponentStrings)
/* harmony export */ });
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




// https://medium.com/stencil-tricks/implementing-internationalisation-i18n-with-stencil-5e6559554117
function getComponentClosestLanguage(element) {
    var _a, _b, _c;
    const closestElement = (_a = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
    // language set by the calling application or browser. defaults to english.
    const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
    if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
        return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
    }
    else {
        // "ru-RU" maps to "ru" use case
        if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
            return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang.slice(0, 2));
        }
        else {
            return "en";
        }
    }
}
function getComponentClosestLanguageIntl(element) {
    var _a, _b, _c;
    // it's OK if we don't have the 4 letter language file for it
    // 4 letter language code needed for formatting numbers
    const closestElement = (_a = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
    // language set by the calling application or browser. defaults to english.
    const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
    if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
        return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
    }
    else {
        if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
            // we support the 2 letter coded language
            // e.g. it-CH vs it
            return lang;
        }
        else {
            return "en";
        }
    }
}
function fetchLocaleStringsForComponent(componentName, locale) {
    return new Promise((resolve, reject) => {
        fetch((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_2__.a)(`../arcgis-app-assets/i18n/${componentName}.i18n.${locale}.json`)).then((result) => {
            if (result.ok)
                resolve(result.json());
            else
                reject();
        }, () => reject());
    });
}
const stringCache = {};
function fetchLocaleStringsFromCache(componentName, locale) {
    const id = `${componentName}${locale}`;
    if (!stringCache[id]) {
        stringCache[id] = fetchLocaleStringsForComponent(componentName, locale);
    }
    return stringCache[id];
}
/**
 * Get strings and language codes.
 * This method returns 2 language codes.
 * The first one returns a code that's also supported as a language file.
 * The second one returns a code where there is support for the first 2 letters of the code as part of a language file,
 * but will return the original 4 letter code from the page.
 * E.g. For "it-ch" it will return "it" as the first language code and "it-ch" as the second.
 * The second one is required for esri.intl.setLocale() to get the correct formatting.
 *
 * If a tagName is provided it will overwite the element's tagName
 *
 *  @return [ strings, first language code, second language code]
 */
async function getLocaleComponentStrings(element, tagName) {
    const componentName = tagName || element.tagName.toLowerCase();
    const componentLanguage = getComponentClosestLanguage(element);
    const componentLanguageIntl = getComponentClosestLanguageIntl(element);
    let strings;
    try {
        strings = await fetchLocaleStringsFromCache(componentName, componentLanguage);
    }
    catch (e) {
        console.warn(`no locale for ${componentName} (${componentLanguage}) loading default locale en.`);
        strings = await fetchLocaleStringsFromCache(componentName, "en");
    }
    return [strings, componentLanguage, componentLanguageIntl];
}



//# sourceMappingURL=locale-050b6db9.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/resize-a17b7292.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/resize-a17b7292.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   D: () => (/* binding */ DROPDOWN_ICON_DISPLAY_CUTOFF_SIZE),
/* harmony export */   b: () => (/* binding */ breakpoints),
/* harmony export */   s: () => (/* binding */ setupResizeObserver)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
const breakpoints = {
    xxs: 320,
    xs: 480,
    sm: 640,
    md: 768,
    lg: 1024,
    xl: 1280
};
const DROPDOWN_ICON_DISPLAY_CUTOFF_SIZE = 960;
function setupResizeObserver(store) {
    var _a;
    var _b;
    (_a = (_b = store.state).resizeObserver) !== null && _a !== void 0 ? _a : (_b.resizeObserver = new ResizeObserver(resizeHandler));
    return store.state.resizeObserver;
}
/**
 * resize handler will be called when items get resized
 * an event is dispatched on each element, passing the new width and height
 */
function resizeHandler(entries) {
    entries.forEach((entry) => {
        if (entry.contentRect.width > 0) {
            const event = new CustomEvent("arcgisBrowserResize", {
                detail: { width: entry.contentRect.width, height: entry.contentRect.height }
            });
            entry.target.dispatchEvent(event);
        }
    });
}



//# sourceMappingURL=resize-a17b7292.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-8b1b0846.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-8b1b0846.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ onBrowserFilterRemove),
/* harmony export */   b: () => (/* binding */ onGroupIdChange),
/* harmony export */   g: () => (/* binding */ getStore),
/* harmony export */   o: () => (/* binding */ onPreviewChange)
/* harmony export */ });
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const onBrowserFilterRemove = (id, store, callback) => {
    // @ts-ignore
    store.onChange("filters", (filters) => {
        if (!filters[id] || !filters[id].value) {
            callback();
        }
    });
};
const onPreviewChange = (store, callback) => {
    // @ts-ignore
    store.onChange("preview", (preview) => {
        callback();
    });
};
const onGroupIdChange = (store, callback) => {
    // @ts-ignore
    store.onChange("groupId", (preview) => {
        callback();
    });
};
const STORE_LOOKUP = new Map();
function getStore(el, browserTag) {
    const existingStore = STORE_LOOKUP.get(el);
    if (existingStore) {
        return existingStore;
    }
    const browser = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(el, browserTag);
    if (browser) {
        STORE_LOOKUP.set(el, browser.store);
        return browser.store;
    }
    return null;
}



//# sourceMappingURL=store-8b1b0846.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-da3fccd5.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-da3fccd5.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ groupBrowserState),
/* harmony export */   g: () => (/* binding */ getGroupBrowserStore)
/* harmony export */ });
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _store_8b1b0846_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./store-8b1b0846.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-8b1b0846.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



function getGroupBrowserStore(el) {
    return (0,_store_8b1b0846_js__WEBPACK_IMPORTED_MODULE_1__.g)(el, "arcgis-group-browser");
}
const GroupBrowserStore = (0,_index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__.c)({ filters: {} });
const groupBrowserState = GroupBrowserStore.state;



//# sourceMappingURL=store-da3fccd5.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTFjMWQyZi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDNkc7QUFDckQ7QUFDQTtBQUNLO0FBQ1M7QUFDa0I7QUFDakM7QUFDMkI7QUFDL0M7QUFDUjtBQUNFOztBQUU3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RkFBdUYsU0FBUztBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxvQ0FBb0MsYUFBYSxPQUFPLHFCQUFxQiwwQkFBMEI7O0FBRXZHO0FBQ0E7QUFDQSxRQUFRLHFEQUFnQjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBaUQ7QUFDakUsZ0JBQWdCLHFEQUFDLENBQUMsaURBQUksK0JBQStCLHFEQUFDLHlCQUF5Qiw2SEFBNkg7QUFDNU07QUFDQSxlQUFlLE9BQU8scURBQVU7QUFDaEMsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGtDQUFrQyxjQUFjLGNBQWMsWUFBWSxrQkFBa0IsYUFBYSxZQUFZLHNCQUFzQixrQ0FBa0MsVUFBVSxzQkFBc0IsOEJBQThCLHVHQUF1RywwQkFBMEIsMEJBQTBCLG1EQUFtRCx1RUFBdUUsK0NBQStDLGtCQUFrQixXQUFXLDZDQUE2QyxvQkFBb0Isb0JBQW9CLFVBQVUsc0JBQXNCLHdDQUF3Qyx1QkFBdUIsZUFBZSxpQkFBaUIsYUFB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QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixtREFBaUM7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVpRzs7QUFFakc7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ3VEO0FBQ0g7O0FBRXBEO0FBQ0EsV0FBVyxxREFBUTtBQUNuQjtBQUNBLDBCQUEwQixxREFBVyxHQUFHLGFBQWE7QUFDckQ7O0FBRTZEOztBQUU3RCIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1ncm91cC1iYWRnZXNfMi5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9jb25maWctNzVhZGY5NjIuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vZnVuY3Rpb25hbC00NGRlOGZjZi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9pbmRleC0wNTk1NmNhYi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vbG9jYWxlLTA1MGI2ZGI5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL3Jlc2l6ZS1hMTdiNzI5Mi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9zdG9yZS04YjFiMDg0Ni5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9zdG9yZS1kYTNmY2NkNS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgaCwgSCBhcyBIb3N0LCBkIGFzIGdldEVsZW1lbnQsIGMgYXMgY3JlYXRlRXZlbnQgfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcbmltcG9ydCB7IGMgYXMgY29uZmlnU3RhdGUgfSBmcm9tICcuL2NvbmZpZy03NWFkZjk2Mi5qcyc7XG5pbXBvcnQgeyB0IGFzIHRpbWVvdXQgfSBmcm9tICcuL2Z1bmN0aW9uYWwtNDRkZThmY2YuanMnO1xuaW1wb3J0IHsgYSBhcyBmb3JtYXREYXRlIH0gZnJvbSAnLi9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzIH0gZnJvbSAnLi9sb2NhbGUtMDUwYjZkYjkuanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRHcm91cEJyb3dzZXJTdG9yZSwgYSBhcyBncm91cEJyb3dzZXJTdGF0ZSB9IGZyb20gJy4vc3RvcmUtZGEzZmNjZDUuanMnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVTdG9yZSB9IGZyb20gJy4vaW5kZXgtMDU5NTZjYWIuanMnO1xuaW1wb3J0IHsgcyBhcyBzZXR1cFJlc2l6ZU9ic2VydmVyLCBiIGFzIGJyZWFrcG9pbnRzIH0gZnJvbSAnLi9yZXNpemUtYTE3YjcyOTIuanMnO1xuaW1wb3J0ICcuL2xvYWRNb2R1bGVzLWI0YWMxMjQ3LmpzJztcbmltcG9ydCAnLi9kb20tNGQzNjc2NzcuanMnO1xuaW1wb3J0ICcuL3N0b3JlLThiMWIwODQ2LmpzJztcblxuZnVuY3Rpb24gZ2V0QmFkZ2VzKGdyb3VwLCBwb3J0YWwpIHtcbiAgICBjb25zdCBiYWRnZXMgPSBbXTtcbiAgICBpZiAocG9ydGFsLmlkKSB7XG4gICAgICAgIGlmIChncm91cC5jYXBhYmlsaXRpZXMgJiYgZ3JvdXAuY2FwYWJpbGl0aWVzLmluY2x1ZGVzKFwidXBkYXRlaXRlbWNvbnRyb2xcIikpIHtcbiAgICAgICAgICAgIGJhZGdlcy5wdXNoKFwiU2hhcmVkVXBkYXRlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChncm91cC5pc09wZW5EYXRhICYmIGdyb3VwLm9yZ0lkID09PSBwb3J0YWwuaWQpIHtcbiAgICAgICAgICAgIGJhZGdlcy5wdXNoKFwiT3BlbkRhdGFcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBvcnRhbC5mZWF0dXJlZEl0ZW1zR3JvdXBRdWVyeSAmJiBwb3J0YWwuZmVhdHVyZWRJdGVtc0dyb3VwUXVlcnkgPT09IGBpZDoke2dyb3VwLmlkfWApIHtcbiAgICAgICAgICAgIGJhZGdlcy5wdXNoKFwiR2FsbGVyeVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoKGdyb3VwLmNvbGxhYm9yYXRpb25JbmZvICYmIGdyb3VwLmNvbGxhYm9yYXRpb25JbmZvLmNvbGxhYm9yYXRpb25JZCkgfHxcbiAgICAgICAgKGdyb3VwLmNhcGFiaWxpdGllcyAmJiBncm91cC5jYXBhYmlsaXRpZXMuaW5jbHVkZXMoXCJkaXN0cmlidXRlZFwiKSkpIHtcbiAgICAgICAgYmFkZ2VzLnB1c2goXCJDb2xsYWJvcmF0aW9uXCIpO1xuICAgIH1cbiAgICBpZiAoIWdyb3VwLm1lbWJlcnNoaXBBY2Nlc3MgJiYgIXBvcnRhbC5pc1BvcnRhbCAmJiBncm91cC5vcmdJZCAhPT0gXCJub25lXCIpIHtcbiAgICAgICAgYmFkZ2VzLnB1c2goXCJBbnlPcmdcIik7XG4gICAgfVxuICAgIGlmIChncm91cC5tZW1iZXJzaGlwQWNjZXNzID09PSBcImNvbGxhYm9yYXRpb25cIikge1xuICAgICAgICBiYWRnZXMucHVzaChcIlBhcnRuZXJlZFwiKTtcbiAgICB9XG4gICAgLy8gaWYgc2hhcmVkIHVwZGF0ZSB3aXRoIG5vIGNvbGxhYm9yYXRpb24gT1IgZGlzdHJpYnV0ZWQgY29sbGFib3JhdGlvbiwgb25seSBzaG93IHdoZW4gZ3JvdXAgaXMgaW4gdGhlIHVzZXIncyBvcmdcbiAgICBpZiAoYmFkZ2VzLmluY2x1ZGVzKFwiU2hhcmVkVXBkYXRlXCIpICYmICFiYWRnZXMuaW5jbHVkZXMoXCJQYXJ0bmVyZWRcIikgJiYgZ3JvdXAub3JnSWQgIT09IHBvcnRhbC5pZCkge1xuICAgICAgICBiYWRnZXMuc3BsaWNlKGJhZGdlcy5pbmRleE9mKFwiU2hhcmVkVXBkYXRlXCIpLCAxKTtcbiAgICB9XG4gICAgcmV0dXJuIGJhZGdlcztcbn1cblxuY29uc3QgYXJjZ2lzR3JvdXBCYWRnZXNDc3MgPSBcIjpob3N0e2Rpc3BsYXk6ZmxleH0uYmFkZ2V7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLWlubGluZS1lbmQ6MC4yNXJlbX1cIjtcblxuY29uc3QgQXJjZ2lzSXRlbUJhZGdlcyA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuZ3JvdXAgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucG9ydGFsID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLndpZHRoID0gXCJmdWxsXCI7XG4gICAgICAgIHRoaXMuYXBwZWFyYW5jZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5lbXB0eSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNob3dUb29sdGlwcyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNjYWxlID0gXCJtXCI7XG4gICAgICAgIHRoaXMuYmFkZ2VzID0gW107XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgICAgICBpZiAodGhpcy5ncm91cCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVCYWRnZXModGhpcy5ncm91cCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdXBkYXRlQmFkZ2VzKGdyb3VwKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdGhpcy5iYWRnZXMgPSBnZXRCYWRnZXMoZ3JvdXAsIHRoaXMucG9ydGFsKTtcbiAgICAgICAgaWYgKCEoKF9hID0gdGhpcy5iYWRnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5sZW5ndGgpKSB7XG4gICAgICAgICAgICB0aGlzLmVtcHR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgd2lkdGgsIHNjYWxlLCBiYWRnZXMsIHNob3dUb29sdGlwcywgYXBwZWFyYW5jZSB9ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGJhZGdlcy5tYXAoKGJhZGdlKSA9PiAoaChcImFyY2dpcy1ncm91cC1iYWRnZVwiLCB7IGFwcGVhcmFuY2U6IGFwcGVhcmFuY2UsIGtleTogYmFkZ2UsIGNsYXNzOiBcImJhZGdlXCIsIGJhZGdlVHlwZTogYmFkZ2UsIHdpZHRoOiB3aWR0aCwgc2NhbGU6IHNjYWxlLCBzaG93VG9vbHRpcDogc2hvd1Rvb2x0aXBzIH0pKSkpKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxuICAgIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgICAgIFwiZ3JvdXBcIjogW1widXBkYXRlQmFkZ2VzXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc0l0ZW1CYWRnZXMuc3R5bGUgPSBhcmNnaXNHcm91cEJhZGdlc0NzcztcblxuY29uc3QgYXJjZ2lzR3JvdXBDYXJkQ3NzID0gXCI6aG9zdHtkaXNwbGF5OmJsb2NrO21pbi13aWR0aDowcHh9Lmdyb3VwLWNhcmR7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O2hlaWdodDoxMDAlO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSk7b3BhY2l0eTowOy0tdHctc2hhZG93OjAgMCAjMDAwMDstLXR3LXNoYWRvdy1jb2xvcmVkOjAgMCAjMDAwMDtib3gtc2hhZG93OnZhcigtLXR3LXJpbmctb2Zmc2V0LXNoYWRvdywgMCAwICMwMDAwKSwgdmFyKC0tdHctcmluZy1zaGFkb3csIDAgMCAjMDAwMCksIHZhcigtLXR3LXNoYWRvdyk7dHJhbnNpdGlvbi1kdXJhdGlvbjoxNTBtcztvdXRsaW5lLWNvbG9yOnRyYW5zcGFyZW50O2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTEpO3RyYW5zaXRpb24tcHJvcGVydHk6YmFja2dyb3VuZC1jb2xvciwgb3V0bGluZSwgb3V0bGluZS1vZmZzZXQsIG9wYWNpdHk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1jYWxjaXRlLWNvbG9yLWJvcmRlci0zKX0uZ3JvdXAtY2FyZDpmb2N1c3t6LWluZGV4OjEwO291dGxpbmU6MnB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpO291dGxpbmUtb2Zmc2V0Oi0ycHh9Lmdyb3VwLWNhcmQtLWxvYWRlZHtvcGFjaXR5OjF9Lmdyb3VwLWNhcmQtLXNlbGVjdGVke2JvcmRlci1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWJyYW5kKX0uZ3JvdXAtY2FyZC0taG92ZXJhYmxle2N1cnNvcjpwb2ludGVyfS5ncm91cC1jYXJkX190b3B7cGFkZGluZzoxcmVtfS5ncm91cC1jYXJkX19ob3Zlci10ZXh0e3Bvc2l0aW9uOmFic29sdXRlO2luc2V0OjBweDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjFyZW07Zm9udC13ZWlnaHQ6NTAwO29wYWNpdHk6MDt0cmFuc2l0aW9uOmFsbCB2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpIGVhc2UtaW4tb3V0IDBzLCBvdXRsaW5lIDBzLCBvdXRsaW5lLW9mZnNldCAwcztiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjEsIDIxLCAyMSwgMC43KTtjb2xvcjp3aGl0ZX0uZ3JvdXAtY2FyZF9fdXBwZXJ7ZmxleDoxIDEgMCU7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMSk7dHJhbnNpdGlvbjphbGwgdmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBlYXNlLWluLW91dCAwcywgb3V0bGluZSAwcywgb3V0bGluZS1vZmZzZXQgMHN9Lmdyb3VwLWNhcmRfX3VwcGVyOmhvdmVye2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1iYWNrZ3JvdW5kKX0uZ3JvdXAtY2FyZF9fdXBwZXI6aG92ZXIgLmdyb3VwLWNhcmRfX2hvdmVyLXRleHQsLmdyb3VwLWNhcmQ6Zm9jdXMgLmdyb3VwLWNhcmRfX2hvdmVyLXRleHR7b3BhY2l0eToxfS5ncm91cC1jYXJkX191cHBlci0tY29tcGFjdHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmctdG9wOjAuNXJlbTtwYWRkaW5nLWJvdHRvbTowLjVyZW07cGFkZGluZy1sZWZ0OjAuNzVyZW07cGFkZGluZy1yaWdodDowLjc1cmVtfS5ncm91cC1jYXJkX191cHBlci0tbGlua3tjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMSk7dGV4dC1kZWNvcmF0aW9uLWxpbmU6bm9uZTtvdXRsaW5lLWNvbG9yOnRyYW5zcGFyZW50fS5ncm91cC1jYXJkX191cHBlci0tbGluazpmb2N1c3t6LWluZGV4OjEwO291dGxpbmU6MnB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYnJhbmQpO291dGxpbmUtb2Zmc2V0OjJweH0uZ3JvdXAtY2FyZF9fdGl0bGVfX3NwYW57cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTppbmxpbmU7Ym9yZGVyLXN0eWxlOm5vbmU7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDtwYWRkaW5nOjBweDt0cmFuc2l0aW9uOmFsbCB2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpIGVhc2UtaW4tb3V0IDBzLCBvdXRsaW5lIDBzLCBvdXRsaW5lLW9mZnNldCAwcztiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCh0cmFuc3BhcmVudCwgdHJhbnNwYXJlbnQpO2JhY2tncm91bmQtcG9zaXRpb24teDowJSwgMTAwJTtiYWNrZ3JvdW5kLXBvc2l0aW9uLXk6bWluKDEuMjVlbSwgMTAwJSk7YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0LCBuby1yZXBlYXQ7YmFja2dyb3VuZC1zaXplOjEwMCUgMXB4LCAxMDAlIDFweH0uZ3JvdXAtY2FyZC0tcHJldmlld2VkIC5ncm91cC1jYXJkX190aXRsZV9fc3BhbntiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCh2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMyksIHZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0zKSl9Lmdyb3VwLWNhcmRfX2NvbnRlbnR7ZGlzcGxheTpmbGV4O21pbi13aWR0aDowcHg7ZmxleDoxIDEgMCU7ZmxleC1kaXJlY3Rpb246Y29sdW1ufS5ncm91cC1jYXJkX19kZXRhaWxze2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC13cmFwOndyYXB9Lmdyb3VwLWNhcmRfX2RldGFpbHMtLXN0YWNrZWR7ZmxleC1kaXJlY3Rpb246Y29sdW1ufS5ncm91cC1jYXJkX19kZXRhaWx7Zm9udC1zaXplOjAuODc1cmVtO2NvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItdGV4dC0yKX0uZ3JvdXAtY2FyZF9fZGV0YWlsX19pY29ue21hcmdpbi1pbmxpbmUtZW5kOjAuNXJlbX0uZ3JvdXAtY2FyZF9fY2FsZW5kYXItaWNvbntjb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXRleHQtMyk7bWFyZ2luLWlubGluZS1lbmQ6MC41cmVtfS5ncm91cC1jYXJkX19mb290ZXJ7bWFyZ2luLXRvcDphdXRvO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMSk7cGFkZGluZy1sZWZ0OjFyZW07cGFkZGluZy1yaWdodDoxcmVtO3BhZGRpbmctdG9wOjAuNXJlbTtwYWRkaW5nLWJvdHRvbTowLjVyZW07Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMyl9Lmdyb3VwLWNhcmRfX2Zvb3Rlcl9fc3RhcnR7ZGlzcGxheTpmbGV4O21pbi13aWR0aDowcHg7ZmxleDoxIDEgMCU7ZmxleC1kaXJlY3Rpb246cm93O2FsaWduLWl0ZW1zOmNlbnRlcjtvdmVyZmxvdzpoaWRkZW47bWFyZ2luLWlubGluZS1lbmQ6MC43NXJlbX0uZ3JvdXAtY2FyZF9fZm9vdGVyX19zdGFydC0tc2VsZWN0YWJsZXttYXJnaW4taW5saW5lLXN0YXJ0OjEuNXJlbX0uZ3JvdXAtY2FyZF9fcHJvZmlsZS13cmFwe21heC13aWR0aDoxMDAlO3BhZGRpbmc6MC4yNXJlbX0uZ3JvdXAtY2FyZF9fdXBkYXRlZHtmb250LXNpemU6MC44NzVyZW07Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci10ZXh0LTIpfS5ncm91cC1jYXJkX191cGRhdGVkLS14c3ttYXJnaW4tdG9wOjAuNXJlbX0uZ3JvdXAtY2FyZF9fZGl2aWRlcntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2ZsZXg6MCAwIGF1dG99Lmdyb3VwLWNhcmRfX2RpdmlkZXI6bm90KFtlbXB0eV0pOmJlZm9yZXtjb250ZW50OlxcXCJcXFwiO2hlaWdodDoxLjI1cmVtO3dpZHRoOjFweDtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtY29sb3ItYm9yZGVyLTEpO21hcmdpbi1pbmxpbmU6MC43NXJlbX0uZ3JvdXAtY2FyZF9fZGV0YWlscy0tc3RhY2tlZCAuZ3JvdXAtY2FyZF9fZGl2aWRlcjpiZWZvcmV7ZGlzcGxheTpub25lfS5ncm91cC1jYXJkX19kaXZpZGVyOmZpcnN0LWNoaWxkOmJlZm9yZXtkaXNwbGF5Om5vbmV9Lmdyb3VwLWNhcmQtZmxleHtkaXNwbGF5OmZsZXh9Lmdyb3VwLWNhcmQtZmxleC0xe21pbi13aWR0aDowcHg7ZmxleDoxIDEgMCV9LnNjcmVlbi1yZWFkZXJzLW9ubHl7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MXB4O2hlaWdodDoxcHg7cGFkZGluZzowO21hcmdpbjotMXB4O292ZXJmbG93OmhpZGRlbjtjbGlwOnJlY3QoMCwgMCwgMCwgMCk7d2hpdGUtc3BhY2U6bm93cmFwO2JvcmRlci13aWR0aDowfS5ncm91cC1jYXJkX19pbnB1dHttYXJnaW4taW5saW5lLWVuZDoxcmVtO21hcmdpbi10b3A6MC4xMjVyZW19Lmdyb3VwLWNhcmRfX3RpdGxle21hcmdpbi10b3A6MHB4O21hcmdpbi1ib3R0b206MHB4O292ZXJmbG93LXdyYXA6YnJlYWstd29yZDtwYWRkaW5nLXRvcDowcHg7cGFkZGluZy1ib3R0b206MHB4O2ZvbnQtc2l6ZToxcmVtO2ZvbnQtd2VpZ2h0OjUwMDtsaW5lLWhlaWdodDoxLjM3NX0uZ3JvdXAtY2FyZF9fdGl0bGUtLWNvbXBhY3R7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7d2hpdGUtc3BhY2U6bm93cmFwO21hcmdpbi1pbmxpbmUtZW5kOjFyZW19Lmdyb3VwLWNhcmRfX3N1bW1hcnl7bWFyZ2luOjBweDttYXJnaW4tdG9wOjAuMjVyZW07bWFyZ2luLWJvdHRvbTowLjI1cmVtO2ZsZXg6MSAxIDAlO3BhZGRpbmc6MHB4O2ZvbnQtc2l6ZTowLjg3NXJlbTtsaW5lLWhlaWdodDoxLjI1fS5ncm91cC1jYXJkX190aHVtYm5haWx7bWFyZ2luLWlubGluZS1lbmQ6MXJlbX0uZ3JvdXAtY2FyZF9fdGh1bWJuYWlsLS1jb21wYWN0e3dpZHRoOjIuNzVyZW07aGVpZ2h0OjIuNzVyZW19Lmdyb3VwLWNhcmRfX2JhZGdlc3ttYXJnaW4tdG9wOjAuMjVyZW19Lmdyb3VwLWNhcmRfX293bmVye21pbi13aWR0aDowcHh9Lmdyb3VwLWNhcmQtLXBhbmVse21hcmdpbi1ib3R0b206MHB4O2N1cnNvcjpwb2ludGVyO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYm9yZGVyLTEpO291dGxpbmU6MXB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMCl9Lmdyb3VwLWNhcmQtLXBhbmVsOmhvdmVye2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTIpfS5ncm91cC1jYXJkLS1ib3JkZXItdG9we2JvcmRlci10b3A6MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtY29sb3ItYm9yZGVyLTEpfS5ncm91cC1jYXJkLS1ib3JkZXItdG9wOmhvdmVyey0tdHctc2hhZG93OjAgMCAjMDAwMDstLXR3LXNoYWRvdy1jb2xvcmVkOjAgMCAjMDAwMDtib3gtc2hhZG93OnZhcigtLXR3LXJpbmctb2Zmc2V0LXNoYWRvdywgMCAwICMwMDAwKSwgdmFyKC0tdHctcmluZy1zaGFkb3csIDAgMCAjMDAwMCksIHZhcigtLXR3LXNoYWRvdyl9Lmdyb3VwLWNhcmQtLXhzIC5ncm91cC1jYXJkX190b3AsLmdyb3VwLWNhcmQtLXh4cyAuZ3JvdXAtY2FyZF9fdG9we3BhZGRpbmc6MC43NXJlbX0uZ3JvdXAtY2FyZC0teHMgLmdyb3VwLWNhcmRfX3RpdGxlLS1wYWRkZWQsLmdyb3VwLWNhcmQtLXh4cyAuZ3JvdXAtY2FyZF9fdGl0bGUtLXBhZGRlZHttYXJnaW4tYm90dG9tOjAuMjVyZW19Lmdyb3VwLWNhcmQtLXhzIC5ncm91cC1jYXJkX19mb290ZXIsLmdyb3VwLWNhcmQtLXh4cyAuZ3JvdXAtY2FyZF9fZm9vdGVye3BhZGRpbmctdG9wOjAuMjVyZW07cGFkZGluZy1ib3R0b206MC4yNXJlbTtwYWRkaW5nLWxlZnQ6MC43NXJlbTtwYWRkaW5nLXJpZ2h0OjAuNzVyZW19Lmdyb3VwLWNhcmQtLXhzIC5ncm91cC1jYXJkX19kZXRhaWwsLmdyb3VwLWNhcmQtLXh4cyAuZ3JvdXAtY2FyZF9fZGV0YWlse21hcmdpbi10b3A6MC4yNXJlbTttYXJnaW4tYm90dG9tOjAuMjVyZW07Zm9udC1zaXplOjAuNzVyZW07bGluZS1oZWlnaHQ6MS4zNX0uZ3JvdXAtY2FyZC0teHMgLmdyb3VwLWNhcmRfX3RpdGxlLC5ncm91cC1jYXJkLS14eHMgLmdyb3VwLWNhcmRfX3RpdGxle2ZvbnQtc2l6ZTowLjg3NXJlbX0uZ3JvdXAtY2FyZC0teHhzIC5ncm91cC1jYXJkX190aHVtYm5haWx7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MC43NXJlbTt3aWR0aDo0LjI1cmVtfS5ncm91cC1jYXJkLS14cyAuZ3JvdXAtY2FyZF9fdGh1bWJuYWlse3BhZGRpbmctaW5saW5lLXN0YXJ0OjAuNXJlbTt3aWR0aDo1cmVtfVwiO1xuXG5jb25zdCBBcmNnaXNHcm91cENhcmQgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFyY2dpc0dyb3VwQ2FyZFNlbGVjdCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzR3JvdXBDYXJkU2VsZWN0XCIsIDcpO1xuICAgICAgICB0aGlzLmFyY2dpc0dyb3VwQnJvd3NlckNhcmRQcmV2aWV3ID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNHcm91cEJyb3dzZXJDYXJkUHJldmlld1wiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNHcm91cEJyb3dzZXJJbnRlcm5hbFVJQWN0aW9uID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNHcm91cEJyb3dzZXJJbnRlcm5hbFVJQWN0aW9uXCIsIDcpO1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuaGFuZGxlUmVzaXplRXZlbnQgPSAoeyBkZXRhaWwgfSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXNpemUoZGV0YWlsLndpZHRoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVDYXJkQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGdyb3VwLCBwcmV2aWV3IH0gPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHRoaXMubGluaykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcmV2aWV3ID09PSBcInRvcFwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNHcm91cEJyb3dzZXJDYXJkUHJldmlldy5lbWl0KGdyb3VwKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5yYWRpb0J1dHRvbikge1xuICAgICAgICAgICAgICAgIHRoaXMucmFkaW9CdXR0b24uY2hlY2tlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNHcm91cENhcmRTZWxlY3QuZW1pdCh7IGdyb3VwLCBzZWxlY3RlZDogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY2hlY2tib3gpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gIXRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNHcm91cENhcmRTZWxlY3QuZW1pdCh7IGdyb3VwLCBzZWxlY3RlZDogdGhpcy5zZWxlY3RlZCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ncm91cCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy51c2VyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvcnRhbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hcGkgPSA0O1xuICAgICAgICB0aGlzLmJhc2VVcmwgPSAoX2EgPSBjb25maWdTdGF0ZSA9PT0gbnVsbCB8fCBjb25maWdTdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlnU3RhdGUuY29uZmlnKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYmFzZVVybDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5pbmRldGVybWluYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnZpZXcgPSBcImxpc3RcIjtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb24gPSBcIm5vbmVcIjtcbiAgICAgICAgdGhpcy5wcmV2aWV3ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLm5hbWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2hvd093bmVyID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zaG93RGF0ZVVwZGF0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNob3dEYXRlQ3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNob3dWaWV3YWJsZUJ5ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zaG93U3VtbWFyeSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNob3dCYWRnZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLmxpbmsgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubmV3VGFiID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmhvdmVyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmZvcm1GYWN0b3IgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMudXBkYXRlZFRleHQgPSBcIlwiO1xuICAgICAgICB0aGlzLmNyZWF0ZWRUZXh0ID0gXCJcIjtcbiAgICAgICAgdGhpcy5sb2FkZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMud2lkdGggPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qIENhbGxpbmcgdGhpcyBzZXRGb2N1cyBjYXVzZXMgY2FsY2l0ZSB0byBmb2N1cyBoZXJlIHdoZW4gdGhlIHVzZXIgcG9wdXAgaXMgY2xvc2VkLi4uICovXG4gICAgYXN5bmMgcmVzdG9yZUZvY3VzKCkge1xuICAgICAgICBpZiAodGhpcy5saW5rICYmIHRoaXMubGlua0VsKSB7XG4gICAgICAgICAgICB0aGlzLmxpbmtFbC5mb2N1cygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByZXZpZXcgPT09IFwidG9wXCIgJiYgdGhpcy5zZWN0aW9uRWwpIHtcbiAgICAgICAgICAgIHRoaXMuc2VjdGlvbkVsLmZvY3VzKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGNvbnN0IHsgZWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGxvY2FsZSA9IGF3YWl0IGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3MoZWwpO1xuICAgICAgICB0aGlzLmkxOG4gPSBsb2NhbGVbMF07XG4gICAgICAgIC8vIGlmIHdlJ3JlIGluc2lkZSBhIGdyb3VwIGJyb3dzZXIsIHVzZSB0aGF0IHN0b3JlLCBvdGhlcndpc2UgY3JlYXRlIG9uZSBqdXN0IGZvciB0aGlzIGNhcmRcbiAgICAgICAgdGhpcy5zdG9yZSA9IGdldEdyb3VwQnJvd3NlclN0b3JlKHRoaXMuZWwpIHx8IGNyZWF0ZVN0b3JlKHsgZmlsdGVyczoge30gfSk7XG4gICAgICAgIChfYSA9IHRoaXMuZm9ybUZhY3RvcikgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKHRoaXMuZm9ybUZhY3RvciA9ICgoX2IgPSB0aGlzLnN0b3JlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iuc3RhdGUucGFuZWwpID8gXCJ4c1wiIDogXCJsZ1wiKTtcbiAgICAgICAgc2V0dXBSZXNpemVPYnNlcnZlcih0aGlzLnN0b3JlKS5vYnNlcnZlKHRoaXMuZWwpO1xuICAgICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNCcm93c2VyUmVzaXplXCIsIHRoaXMuaGFuZGxlUmVzaXplRXZlbnQpO1xuICAgICAgICB0aGlzLnVwZGF0ZWRUZXh0ID0gdGhpcy5pMThuLmxhc3RVcGRhdGVkLnJlcGxhY2UoXCIke2RhdGV9XCIsIGZvcm1hdERhdGUodGhpcy5ncm91cC5tb2RpZmllZCkpO1xuICAgICAgICB0aGlzLmNyZWF0ZWRUZXh0ID0gdGhpcy5pMThuLmNyZWF0ZWQucmVwbGFjZShcIiR7ZGF0ZX1cIiwgZm9ybWF0RGF0ZSh0aGlzLmdyb3VwLmNyZWF0ZWQpKTtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGltZW91dCgxMDApO1xuICAgICAgICB0aGlzLmxvYWRlZCA9IHRydWU7XG4gICAgfVxuICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIChfYyA9IChfYiA9IChfYSA9IHRoaXMuc3RvcmUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdGF0ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnJlc2l6ZU9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MudW5vYnNlcnZlKHRoaXMuZWwpO1xuICAgICAgICAoX2QgPSB0aGlzLmVsKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImFyY2dpc0Jyb3dzZXJSZXNpemVcIiwgdGhpcy5oYW5kbGVSZXNpemVFdmVudCk7XG4gICAgfVxuICAgIHJlc2l6ZSh3aWR0aCkge1xuICAgICAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgICAgICAgIGNhc2Ugd2lkdGggPiBicmVha3BvaW50cy5tZDpcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1GYWN0b3IgPSBcImxnXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHdpZHRoID4gYnJlYWtwb2ludHMuc206XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtRmFjdG9yID0gXCJtZFwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB3aWR0aCA+IGJyZWFrcG9pbnRzLnhzOlxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybUZhY3RvciA9IFwic21cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2Ugd2lkdGggPiBicmVha3BvaW50cy54eHM6XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtRmFjdG9yID0gXCJ4c1wiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1GYWN0b3IgPSBcInh4c1wiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB9XG4gICAgZ2V0QWNjZXNzSW5mbyhhY2Nlc3MpIHtcbiAgICAgICAgY29uc3QgaW5mbyA9IHtcbiAgICAgICAgICAgIHB1YmxpYzoge1xuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMuaTE4bi5ldmVyeW9uZSxcbiAgICAgICAgICAgICAgICBpY29uOiBcImdsb2JlXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcml2YXRlOiB7XG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5pMThuLmdyb3VwTWVtYmVycyxcbiAgICAgICAgICAgICAgICBpY29uOiBcImxvY2tcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9yZzoge1xuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMuaTE4bi5vcmdhbml6YXRpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogXCJvcmdhbml6YXRpb25cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gaW5mb1thY2Nlc3NdIHx8IGluZm8ucHJpdmF0ZTtcbiAgICB9XG4gICAgcmVuZGVyQ29tcGFjdFZpZXcoKSB7XG4gICAgICAgIGNvbnN0IHsgZ3JvdXAsIHBvcnRhbCwgc2VsZWN0aW9uLCBzZWxlY3RlZCwgZm9ybUZhY3RvciwgaTE4biwgbGluaywgbG9hZGVkLCBuZXdUYWIsIHNob3dCYWRnZXMgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IENhcmRUYWcgPSB0aGlzLmxpbmsgPyBcImFcIiA6IFwiZGl2XCI7XG4gICAgICAgIGNvbnN0IGxpbmtBdHRyaWJ1dGVzID0gT2JqZWN0LmFzc2lnbih7IGhyZWY6IGxpbmsgfSwgKG5ld1RhYiA/IHsgdGFyZ2V0OiBcIl9ibGFua1wiLCByZWw6IFwibm9vcGVuZXIgbm9yZWZlcnJlclwiIH0gOiB7fSkpO1xuICAgICAgICByZXR1cm4gKGgoXCJzZWN0aW9uXCIsIE9iamVjdC5hc3NpZ24oeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIFwiZ3JvdXAtY2FyZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwiZ3JvdXAtY2FyZC0taG92ZXJhYmxlXCI6IHNlbGVjdGlvbiAhPT0gXCJub25lXCIsXG4gICAgICAgICAgICAgICAgW2Bncm91cC1jYXJkLS0ke2Zvcm1GYWN0b3J9YF06IHRydWUsXG4gICAgICAgICAgICAgICAgXCJncm91cC1jYXJkLS1sb2FkZWRcIjogbG9hZGVkXG4gICAgICAgICAgICB9LCBvbk1vdXNlT3ZlcjogKCkgPT4gKHRoaXMuaG92ZXIgPSB0cnVlKSwgb25Nb3VzZU91dDogKCkgPT4gKHRoaXMuaG92ZXIgPSBmYWxzZSkgfSwgKGxpbmsgPyB7fSA6IHsgb25DbGljazogdGhpcy5oYW5kbGVDYXJkQ2xpY2sgfSksIHsgcmVmOiAoZWwpID0+ICh0aGlzLnNlY3Rpb25FbCA9IGVsKSB9KSwgaChDYXJkVGFnLCBPYmplY3QuYXNzaWduKHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBcImdyb3VwLWNhcmRfX3VwcGVyXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJncm91cC1jYXJkX191cHBlci0tbGlua1wiOiAhIWxpbmssXG4gICAgICAgICAgICAgICAgXCJncm91cC1jYXJkX191cHBlci0tY29tcGFjdFwiOiB0cnVlXG4gICAgICAgICAgICB9IH0sIChsaW5rID8gbGlua0F0dHJpYnV0ZXMgOiB7fSksIHsgcmVmOiAoZWwpID0+ICh0aGlzLmxpbmtFbCA9IGVsKSB9KSwgc2VsZWN0aW9uID09PSBcInNpbmdsZVwiICYmIChoKFwiY2FsY2l0ZS1yYWRpby1idXR0b25cIiwgeyBjbGFzczogXCJncm91cC1jYXJkX19pbnB1dFwiLCBjaGVja2VkOiBzZWxlY3RlZCwgdmFsdWU6IGdyb3VwLnRpdGxlLCBuYW1lOiB0aGlzLm5hbWUsIHJlZjogKGVsKSA9PiAodGhpcy5yYWRpb0J1dHRvbiA9IGVsKSwgb25DbGljazogKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgfSwgb25DYWxjaXRlUmFkaW9CdXR0b25DaGFuZ2U6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc0dyb3VwQ2FyZFNlbGVjdC5lbWl0KHsgZ3JvdXAsIHNlbGVjdGVkOiAhc2VsZWN0ZWQgfSk7XG4gICAgICAgICAgICB9IH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwic2NyZWVuLXJlYWRlcnMtb25seVwiIH0sIGkxOG4uc2VsZWN0LnJlcGxhY2UoXCIke3RpdGxlfVwiLCBncm91cC50aXRsZSkpKSksIHNlbGVjdGlvbiA9PT0gXCJtdWx0aXBsZVwiICYmIChoKFwiY2FsY2l0ZS1jaGVja2JveFwiLCB7IGNsYXNzOiBcImdyb3VwLWNhcmRfX2lucHV0XCIsIGNoZWNrZWQ6IHNlbGVjdGVkLCBpbmRldGVybWluYXRlOiB0aGlzLmluZGV0ZXJtaW5hdGUsIG9uQ2xpY2s6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIH0sIG9uQ2FsY2l0ZUNoZWNrYm94Q2hhbmdlOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNHcm91cENhcmRTZWxlY3QuZW1pdCh7IGdyb3VwLCBzZWxlY3RlZDogIXRoaXMuc2VsZWN0ZWQgfSk7XG4gICAgICAgICAgICB9LCB2YWx1ZTogZ3JvdXAuaWQsIHJlZjogKGVsKSA9PiAodGhpcy5jaGVja2JveCA9IGVsKSB9LCBoKFwic3BhblwiLCB7IGNsYXNzOiBcInNjcmVlbi1yZWFkZXJzLW9ubHlcIiB9LCBncm91cC50aXRsZSkpKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImZsZXgtMCBncm91cC1jYXJkX190aHVtYm5haWwgZ3JvdXAtY2FyZF9fdGh1bWJuYWlsLS1jb21wYWN0XCIgfSwgaChcImFyY2dpcy1ncm91cC10aHVtYm5haWxcIiwgeyBncm91cDogZ3JvdXAsIHBvcnRhbDogcG9ydGFsLCBzY2FsZTogXCJsXCIgfSkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZ3JvdXAtY2FyZC1mbGV4LTFcIiB9LCBoKFwiaDNcIiwgeyBjbGFzczogXCJncm91cC1jYXJkX190aXRsZSBncm91cC1jYXJkX190aXRsZS0tY29tcGFjdFwiIH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwiZ3JvdXAtY2FyZF9fdGl0bGVfX3NwYW5cIiB9LCBncm91cC50aXRsZSkpKSwgc2hvd0JhZGdlcyAmJiAoaChcImFyY2dpcy1ncm91cC1iYWRnZXNcIiwgeyBncm91cDogZ3JvdXAsIHBvcnRhbDogcG9ydGFsLCBjbGFzczogXCJncm91cC1jYXJkX19iYWRnZXMtLWNvbXBhY3RcIiwgc2NhbGU6IFwic1wiLCBzaG93VG9vbHRpcHM6IHRydWUsIHdpZHRoOiBcIm5hcnJvd1wiIH0pKSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImNvbnRlbnQtZW5kXCIgfSkpKSk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgY29uc3QgeyBncm91cCwgcG9ydGFsLCBzZWxlY3Rpb24sIHNlbGVjdGVkLCBmb3JtRmFjdG9yLCBhcGksIGkxOG4sIGxpbmssIGxvYWRlZCwgbmV3VGFiLCBzaG93RGF0ZUNyZWF0ZWQsIHNob3dEYXRlVXBkYXRlZCwgc2hvd093bmVyLCBzaG93QmFkZ2VzLCBzaG93U3VtbWFyeSB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgYmFzZVVybCA9IChfYSA9IHRoaXMuYmFzZVVybCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKF9iID0gY29uZmlnU3RhdGUuY29uZmlnKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuYmFzZVVybDtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IGdyb3VwQnJvd3NlclN0YXRlLnByZXZpZXcgPT09IHRoaXMuZ3JvdXAuaWQ7XG4gICAgICAgIGNvbnN0IHRvcFByZXZpZXcgPSB0aGlzLnByZXZpZXcgPT09IFwidG9wXCI7XG4gICAgICAgIGNvbnN0IENhcmRUYWcgPSB0aGlzLmxpbmsgPyBcImFcIiA6IFwiZGl2XCI7XG4gICAgICAgIGNvbnN0IGxpbmtBdHRyaWJ1dGVzID0gT2JqZWN0LmFzc2lnbih7IGhyZWY6IGxpbmsgfSwgKG5ld1RhYiA/IHsgdGFyZ2V0OiBcIl9ibGFua1wiLCByZWw6IFwibm9vcGVuZXIgbm9yZWZlcnJlclwiIH0gOiB7fSkpO1xuICAgICAgICBjb25zdCB0b3BQcmV2aWV3QXR0cmlidXRlcyA9IHtcbiAgICAgICAgICAgIHRhYkluZGV4OiAwLFxuICAgICAgICAgICAgcm9sZTogXCJidXR0b25cIixcbiAgICAgICAgICAgIFwiYXJpYS1oYXNwb3B1cFwiOiBcImRpYWxvZ1wiLFxuICAgICAgICAgICAgXCJhcmlhLWxhYmVsbGVkYnlcIjogXCJvcGVuLWRldGFpbHNcIixcbiAgICAgICAgICAgIG9uS2V5UHJlc3M6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIgfHwgZS5rZXkgPT0gXCIgXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhcmRDbGljaygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgYWNjZXNzSW5mbyA9IHRoaXMuZ2V0QWNjZXNzSW5mbyhncm91cC5hY2Nlc3MpO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgdGhpcy52aWV3ID09PSBcImNvbXBhY3RcIiA/ICh0aGlzLnJlbmRlckNvbXBhY3RWaWV3KCkpIDogKGgoXCJzZWN0aW9uXCIsIE9iamVjdC5hc3NpZ24oeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIFwiZ3JvdXAtY2FyZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwiZ3JvdXAtY2FyZC0taG92ZXJhYmxlXCI6IHNlbGVjdGlvbiAhPT0gXCJub25lXCIsXG4gICAgICAgICAgICAgICAgW2Bncm91cC1jYXJkLS0ke2Zvcm1GYWN0b3J9YF06IHRydWUsXG4gICAgICAgICAgICAgICAgXCJncm91cC1jYXJkLS1sb2FkZWRcIjogbG9hZGVkXG4gICAgICAgICAgICB9IH0sIChsaW5rID8ge30gOiB7IG9uQ2xpY2s6IHRoaXMuaGFuZGxlQ2FyZENsaWNrIH0pLCAodG9wUHJldmlldyAmJiAhbGluayA/IHRvcFByZXZpZXdBdHRyaWJ1dGVzIDoge30pLCB7IHJlZjogKGVsKSA9PiAodGhpcy5zZWN0aW9uRWwgPSBlbCkgfSksIGgoXCJzbG90XCIsIHsgbmFtZTogXCJjb250ZW50LXRvcFwiIH0pLCBoKENhcmRUYWcsIE9iamVjdC5hc3NpZ24oeyBjbGFzczogeyBcImdyb3VwLWNhcmRfX3VwcGVyXCI6IHRydWUsIFwiZ3JvdXAtY2FyZF9fdXBwZXItLWxpbmtcIjogISFsaW5rIH0gfSwgKGxpbmsgPyBsaW5rQXR0cmlidXRlcyA6IHt9KSwgeyBvbk1vdXNlT3ZlcjogKCkgPT4gKHRoaXMuaG92ZXIgPSB0cnVlKSwgb25Nb3VzZU91dDogKCkgPT4gKHRoaXMuaG92ZXIgPSBmYWxzZSkgfSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJncm91cC1jYXJkLWZsZXggZ3JvdXAtY2FyZF9fdG9wXCIgfSwgc2VsZWN0aW9uID09PSBcInNpbmdsZVwiICYmIChoKFwiY2FsY2l0ZS1yYWRpby1idXR0b25cIiwgeyBjbGFzczogXCJncm91cC1jYXJkX19pbnB1dFwiLCBjaGVja2VkOiBzZWxlY3RlZCwgdmFsdWU6IGdyb3VwLnRpdGxlLCBuYW1lOiB0aGlzLm5hbWUsIHJlZjogKGVsKSA9PiAodGhpcy5yYWRpb0J1dHRvbiA9IGVsKSwgb25DbGljazogKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgfSwgb25DYWxjaXRlUmFkaW9CdXR0b25DaGFuZ2U6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc0dyb3VwQ2FyZFNlbGVjdC5lbWl0KHsgZ3JvdXAsIHNlbGVjdGVkOiAhc2VsZWN0ZWQgfSk7XG4gICAgICAgICAgICB9IH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwic2NyZWVuLXJlYWRlcnMtb25seVwiIH0sIGkxOG4uc2VsZWN0LnJlcGxhY2UoXCIke3RpdGxlfVwiLCBncm91cC50aXRsZSkpKSksIHNlbGVjdGlvbiA9PT0gXCJtdWx0aXBsZVwiICYmIChoKFwiY2FsY2l0ZS1jaGVja2JveFwiLCB7IGNsYXNzOiBcImdyb3VwLWNhcmRfX2lucHV0XCIsIGNoZWNrZWQ6IHNlbGVjdGVkLCBpbmRldGVybWluYXRlOiB0aGlzLmluZGV0ZXJtaW5hdGUsIG9uQ2xpY2s6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIH0sIG9uQ2FsY2l0ZUNoZWNrYm94Q2hhbmdlOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNHcm91cENhcmRTZWxlY3QuZW1pdCh7IGdyb3VwLCBzZWxlY3RlZDogIXRoaXMuc2VsZWN0ZWQgfSk7XG4gICAgICAgICAgICB9LCB2YWx1ZTogZ3JvdXAuaWQsIHJlZjogKGVsKSA9PiAodGhpcy5jaGVja2JveCA9IGVsKSB9LCBoKFwic3BhblwiLCB7IGNsYXNzOiBcInNjcmVlbi1yZWFkZXJzLW9ubHlcIiB9LCBncm91cC50aXRsZSkpKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImZsZXgtMCBncm91cC1jYXJkX190aHVtYm5haWxcIiB9LCBoKFwiYXJjZ2lzLWdyb3VwLXRodW1ibmFpbFwiLCB7IGdyb3VwOiBncm91cCwgcG9ydGFsOiBwb3J0YWwsIHNjYWxlOiBcInhsXCIgfSkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZ3JvdXAtY2FyZC1mbGV4LTFcIiB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZ3JvdXAtY2FyZC1mbGV4XCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImdyb3VwLWNhcmRfX2NvbnRlbnRcIiB9LCBoKFwiaDNcIiwgeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIFwiZ3JvdXAtY2FyZF9fdGl0bGVcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcImdyb3VwLWNhcmRfX3RpdGxlLS1wYWRkZWRcIjogc2hvd1N1bW1hcnkgJiYgISFncm91cC5zbmlwcGV0XG4gICAgICAgICAgICB9IH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwiZ3JvdXAtY2FyZF9fdGl0bGVfX3NwYW5cIiB9LCBncm91cC50aXRsZSkpLCBzaG93U3VtbWFyeSAmJiBncm91cC5zbmlwcGV0ICYmIChoKFwicFwiLCB7IGNsYXNzOiBcImdyb3VwLWNhcmRfX3N1bW1hcnlcIiB9LCBncm91cC5zbmlwcGV0Lmxlbmd0aCA+IDI1MFxuICAgICAgICAgICAgPyBgJHtncm91cC5zbmlwcGV0LnN1YnN0cmluZygwLCAyNTApfeKApmBcbiAgICAgICAgICAgIDogZ3JvdXAuc25pcHBldCkpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBcImdyb3VwLWNhcmRfX2RldGFpbHNcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcImdyb3VwLWNhcmRfX2RldGFpbHMtLXN0YWNrZWRcIjogdGhpcy53aWR0aCA8IDU4MFxuICAgICAgICAgICAgfSB9LCBzaG93RGF0ZUNyZWF0ZWQgJiYgKGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwiZ3JvdXAtY2FyZF9fZGV0YWlsIGdyb3VwLWNhcmRfX2RpdmlkZXJcIiB9LCB0aGlzLmNyZWF0ZWRUZXh0KSksIHNob3dEYXRlVXBkYXRlZCAmJiAoaChcInNwYW5cIiwgeyBjbGFzczogXCJncm91cC1jYXJkX19kZXRhaWwgZ3JvdXAtY2FyZF9fZGl2aWRlclwiIH0sIHRoaXMudXBkYXRlZFRleHQpKSwgdGhpcy5zaG93Vmlld2FibGVCeSAmJiAoaChcInNwYW5cIiwgeyBjbGFzczogXCJncm91cC1jYXJkX19kZXRhaWwgZ3JvdXAtY2FyZF9fZGl2aWRlclwiIH0sIGgoXCJjYWxjaXRlLWljb25cIiwgeyBpY29uOiBhY2Nlc3NJbmZvLmljb24sIHNjYWxlOiBcInNcIiwgY2xhc3M6IFwiZ3JvdXAtY2FyZF9fZGV0YWlsX19pY29uXCIgfSksIFwiIFwiLCBpMThuLnZpZXdhYmxlQnkucmVwbGFjZShcIiR7bGV2ZWx9XCIsIGFjY2Vzc0luZm8udGV4dCkpKSwgc2hvd0JhZGdlcyAmJiB0aGlzLndpZHRoID49IGJyZWFrcG9pbnRzLnNtICYmIChoKFwiYXJjZ2lzLWdyb3VwLWJhZGdlc1wiLCB7IGFwcGVhcmFuY2U6IHRoaXMuaG92ZXIgPyBcIm91dGxpbmUtZmlsbFwiIDogXCJzb2xpZFwiLCBncm91cDogZ3JvdXAsIHBvcnRhbDogcG9ydGFsLCB3aWR0aDogdGhpcy53aWR0aCA8IDg0MCA/IFwibmFycm93XCIgOiBcImZ1bGxcIiwgY2xhc3M6IFwiZ3JvdXAtY2FyZF9fYmFkZ2VzIGdyb3VwLWNhcmRfX2RldGFpbCBncm91cC1jYXJkX19kaXZpZGVyXCIsIHNjYWxlOiBcInNcIiwgc2hvd1Rvb2x0aXBzOiB0cnVlIH0pKSksIHNob3dCYWRnZXMgJiYgdGhpcy53aWR0aCA8IGJyZWFrcG9pbnRzLnNtICYmIChoKFwiYXJjZ2lzLWdyb3VwLWJhZGdlc1wiLCB7IGFwcGVhcmFuY2U6IHRoaXMuaG92ZXIgPyBcIm91dGxpbmUtZmlsbFwiIDogXCJzb2xpZFwiLCBncm91cDogZ3JvdXAsIHBvcnRhbDogcG9ydGFsLCB3aWR0aDogdGhpcy53aWR0aCA8IGJyZWFrcG9pbnRzLnh4cyA/IFwibmFycm93XCIgOiBcImZ1bGxcIiwgY2xhc3M6IFwiZ3JvdXAtY2FyZF9fYmFkZ2VzXCIsIHNjYWxlOiBcInNcIiwgc2hvd1Rvb2x0aXBzOiB0cnVlIH0pKSkpLCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiY29udGVudC1lbmRcIiB9KSkpKSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImdyb3VwLWNhcmRfX2Zvb3RlclwiLCBvbkNsaWNrOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB9IH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJncm91cC1jYXJkX19mb290ZXJfX3N0YXJ0XCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImFjdGlvbnMtc3RhcnRcIiB9KSwgc2hvd093bmVyICYmIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwiZ3JvdXAtY2FyZF9fcHJvZmlsZS13cmFwXCIsIG9uQ2xpY2s6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB9IH0sIGgoXCJhcmNnaXMtdXNlci1wb3B1cFwiLCB7IHVuZGVybGluZTogdHJ1ZSwgdXNlcm5hbWU6IGdyb3VwLm93bmVyLCBhcGk6IGFwaSwgcG9ydGFsOiBwb3J0YWwsIGJhc2VVcmw6IGJhc2VVcmwsIGNsYXNzOiBcImdyb3VwLWNhcmRfX293bmVyXCIsIG9uQXJjZ2lzVXNlclBvcHVwSW50ZXJuYWxVSUFjdGlvbjogKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXJjZ2lzR3JvdXBCcm93c2VySW50ZXJuYWxVSUFjdGlvbi5lbWl0KGUuZGV0YWlsKTtcbiAgICAgICAgICAgIH0gfSkpKSksIHRoaXMucHJldmlldyA9PT0gXCJhY3Rpb25cIiAmJiAoaChcImNhbGNpdGUtYnV0dG9uXCIsIHsgc2NhbGU6IFwic1wiLCBhcHBlYXJhbmNlOiBjdXJyZW50ID8gXCJzb2xpZFwiIDogXCJvdXRsaW5lLWZpbGxcIiwga2luZDogXCJuZXV0cmFsXCIsIG9uQ2xpY2s6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcmNnaXNHcm91cEJyb3dzZXJDYXJkUHJldmlldy5lbWl0KHRoaXMuZ3JvdXApO1xuICAgICAgICAgICAgfSB9LCBjdXJyZW50ID8gaTE4bi5oaWRlUHJldmlldyA6IGkxOG4ucHJldmlldykpLCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiYWN0aW9ucy1lbmRcIiB9KSkpKSkpO1xuICAgIH1cbiAgICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG59O1xuQXJjZ2lzR3JvdXBDYXJkLnN0eWxlID0gYXJjZ2lzR3JvdXBDYXJkQ3NzO1xuXG5leHBvcnQgeyBBcmNnaXNJdGVtQmFkZ2VzIGFzIGFyY2dpc19ncm91cF9iYWRnZXMsIEFyY2dpc0dyb3VwQ2FyZCBhcyBhcmNnaXNfZ3JvdXBfY2FyZCB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcmNnaXMtZ3JvdXAtYmFkZ2VzXzIuZW50cnkuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyBjIGFzIGNyZWF0ZVN0b3JlIH0gZnJvbSAnLi9pbmRleC0wNTk1NmNhYi5qcyc7XG5cbmNvbnN0IGNvbmZpZ1N0b3JlID0gY3JlYXRlU3RvcmUoe1xuICAgIHBvcnRhbDogbnVsbCxcbiAgICB1c2VyOiBudWxsLFxuICAgIGFwaTogNCxcbiAgICBzY2FsZTogXCJtXCJcbn0pO1xuY29uc3QgY29uZmlnU3RhdGUgPSBjb25maWdTdG9yZS5zdGF0ZTtcbmNvbnN0IG9uQ29uZmlnQ2hhbmdlID0gY29uZmlnU3RvcmUub25DaGFuZ2U7XG5cbmV4cG9ydCB7IGNvbmZpZ1N0YXRlIGFzIGMsIG9uQ29uZmlnQ2hhbmdlIGFzIG8gfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uZmlnLTc1YWRmOTYyLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuLyoqXG4gKiBDYWxsIGEgZnVuY3Rpb24gb25seSBhZnRlciBpdCBoYXMgbm90IGJlZW4gY2FsbGVkIGZvciBuIG1pbGxpc2Vjb25kc1xuICogQHBhcmFtIGZuICAgIC0gZnVuY3Rpb24gdG8gY2FsbFxuICogQHBhcmFtIGRlbGF5IC0gZGVsYXkgaW4gbWlsbGlzZWNvbmRzXG4gKi9cbmNvbnN0IGRlYm91bmNlID0gKGZuLCBkZWxheSkgPT4ge1xuICAgIGxldCB0aW1lb3V0O1xuICAgIGxldCBzdGF0dXMgPSBcImlkbGVcIjtcbiAgICBmdW5jdGlvbiBmbHVzaCguLi5hcmdzKSB7XG4gICAgICAgIHN0YXR1cyA9IFwiZmx1c2hlZFwiO1xuICAgICAgICByZXR1cm4gZGVib3VuY2VkKC4uLmFyZ3MpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbnZva2UoLi4uYXJncykge1xuICAgICAgICBzdGF0dXMgPSBcImludm9rZWRcIjtcbiAgICAgICAgcmV0dXJuIGRlYm91bmNlZCguLi5hcmdzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2FuY2VsKC4uLmFyZ3MpIHtcbiAgICAgICAgc3RhdHVzID0gXCJjYW5jZWxsZWRcIjtcbiAgICAgICAgcmV0dXJuIGRlYm91bmNlZCguLi5hcmdzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0U3RhdHVzKCkge1xuICAgICAgICByZXR1cm4gc3RhdHVzO1xuICAgIH1cbiAgICBjb25zdCBkZWJvdW5jZWQgPSAoLi4uYXJncykgPT4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgc3dpdGNoIChzdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgXCJmbHVzaGVkXCI6XG4gICAgICAgICAgICAgICAgc3RhdHVzID0gXCJpZGxlXCI7XG4gICAgICAgICAgICAgICAgaWYgKHRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZuKC4uLmFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImludm9rZWRcIjpcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gICAgICAgICAgICAgICAgc3RhdHVzID0gXCJpZGxlXCI7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShmbiguLi5hcmdzKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY2FuY2VsbGVkXCI6XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIHN0YXR1cyA9IFwiaWRsZVwiO1xuICAgICAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGlmICh0aW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RhdHVzID0gXCJwZW5kaW5nXCI7XG4gICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSBcImlkbGVcIjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZm4oLi4uYXJncykpO1xuICAgICAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRlYm91bmNlZC5mbHVzaCA9IGZsdXNoO1xuICAgIGRlYm91bmNlZC5pbnZva2UgPSBpbnZva2U7XG4gICAgZGVib3VuY2VkLmNhbmNlbCA9IGNhbmNlbDtcbiAgICBkZWJvdW5jZWQuZ2V0U3RhdHVzID0gZ2V0U3RhdHVzO1xuICAgIHJldHVybiBkZWJvdW5jZWQ7XG59O1xuLyoqXG4gKiBDYWxsIGEgZnVuY3Rpb24gb25seSBhZnRlciBuIG1pbGxpc2Vjb25kcyBoYXZlIGVsYXBzZWRcbiAqIEBwYXJhbSBmbiAgICAtIGZ1bmN0aW9uIHRvIGNhbGxcbiAqIEBwYXJhbSBkZWxheSAtIGRlbGF5IGluIG1pbGxpc2Vjb25kc1xuICovXG5jb25zdCB0aHJvdHRsZSA9IChmbiwgZGVsYXkpID0+IHtcbiAgICBsZXQgdGltZW91dDtcbiAgICByZXR1cm4gKC4uLmFyZ3MpID0+IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIGlmICh0aW1lb3V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgdGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJlc29sdmUoZm4oLi4uYXJncykpO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfSk7XG59O1xuZnVuY3Rpb24gZXNjYXBlUmVnRXhwKHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csIFwiXFxcXCQmXCIpOyAvLyAkJiBtZWFucyB0aGUgd2hvbGUgbWF0Y2hlZCBzdHJpbmdcbn1cbmZ1bmN0aW9uIGlzRGVmaW5lZCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsO1xufVxuLyoqXG4gKiBTZXQgYSBtaW5pbXVtIHRpbWUgZm9yIGEgcHJvbWlzZSB0byByZXNvbHZlICh1c2VmdWwgZm9yIHByZXZlbnRpbmcgZmxhc2ggb2YgbG9hZGVycylcbiAqL1xuYXN5bmMgZnVuY3Rpb24gbWluRGVsYXkocHJvbWlzZSwgbWluRGVsYXkpIHtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChbcHJvbWlzZSwgdGltZW91dChtaW5EZWxheSldKTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cbi8qKlxuICogSGVscGVyIG1ldGhvZCB0byBpbmxpbmUgc2V0VGltZW91dCBhcyBhbiBhd2FpdCBpbiBhc3luYyBmdW5jdGlvbnNcbiAqL1xuZnVuY3Rpb24gdGltZW91dChtcykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xufVxuY29uc3QgYXJyYXlUb0xvb2t1cE1hcCA9IChkYXRhQXJyLCBnZXRLZXlBbmRJdGVtKSA9PiBPYmplY3QuZnJvbUVudHJpZXMoKGRhdGFBcnIgfHwgW10pLm1hcCgoaXRlbSkgPT4ge1xuICAgIGNvbnN0IHsga2V5LCBkYXRhIH0gPSBnZXRLZXlBbmRJdGVtKGl0ZW0pO1xuICAgIHJldHVybiBba2V5LCBkYXRhXTtcbn0pKTtcbi8qKlxuICogQ2hlY2sgd2hldGhlciB0d28gYXJyYXlzIGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIGVsZW1lbnRzXG4gKiBhbmQgd2hldGhlciB0aGV5IGNvbnRhaW4gdGhlIHNhbWUgZWxlbWVudHNcbiAqIHJlZ2FyZGxlc3Mgb2Ygb3JkZXJcbiAqL1xuY29uc3QgYXJyYXlzQXJlRXF1aXZhbGVudCA9IChhcnIxLCBhcnIyKSA9PiBhcnIxLmxlbmd0aCA9PT0gYXJyMi5sZW5ndGggJiYgYXJyMS5yZWR1Y2UoKG1lbW8sIHN0cikgPT4gbWVtbyAmJiBhcnIyLmluZGV4T2Yoc3RyKSA+IC0xLCB0cnVlKTtcbmZ1bmN0aW9uIHVuaXF1ZUJ5KG15QXJyLCBnZXRJdGVtSWQpIHtcbiAgICBjb25zdCByZXN1bHRBcnIgPSBbXTtcbiAgICBjb25zdCBsb29rdXBNYXAgPSB7fTtcbiAgICBteUFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gZ2V0SXRlbUlkKGl0ZW0pO1xuICAgICAgICBpZiAobG9va3VwTWFwW2lkXSA9PSBudWxsKSB7XG4gICAgICAgICAgICBsb29rdXBNYXBbaWRdID0gaXRlbTtcbiAgICAgICAgICAgIHJlc3VsdEFyci5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdEFycjtcbn1cbmZ1bmN0aW9uIHVuaXF1ZShteUFycikge1xuICAgIGNvbnN0IHByaW1pdGl2ZXMgPSB7IGJvb2xlYW46IHt9LCBudW1iZXI6IHt9LCBzdHJpbmc6IHt9IH07XG4gICAgY29uc3Qgb2JqcyA9IFtdO1xuICAgIHJldHVybiBteUFyci5maWx0ZXIoKGl0ZW0pID0+IHtcbiAgICAgICAgbGV0IHR5cGUgPSB0eXBlb2YgaXRlbTtcbiAgICAgICAgaWYgKHR5cGUgaW4gcHJpbWl0aXZlcykge1xuICAgICAgICAgICAgcmV0dXJuIHByaW1pdGl2ZXNbdHlwZV0uaGFzT3duUHJvcGVydHkoaXRlbSkgPyBmYWxzZSA6IChwcmltaXRpdmVzW3R5cGVdW2l0ZW1dID0gdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gb2Jqcy5pbmRleE9mKGl0ZW0pID49IDAgPyBmYWxzZSA6IG9ianMucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuY29uc3QgY2h1bmsgPSAoYXJyLCBzaXplKSA9PiBbLi4uQXJyYXkoTWF0aC5jZWlsKGFyci5sZW5ndGggLyBzaXplKSldLm1hcCgoXywgaSkgPT4gYXJyLnNsaWNlKHNpemUgKiBpLCBzaXplICsgc2l6ZSAqIGkpKTtcblxuZXhwb3J0IHsgYXJyYXlUb0xvb2t1cE1hcCBhcyBhLCB1bmlxdWUgYXMgYiwgdGhyb3R0bGUgYXMgYywgZGVib3VuY2UgYXMgZCwgZXNjYXBlUmVnRXhwIGFzIGUsIGFycmF5c0FyZUVxdWl2YWxlbnQgYXMgZiwgY2h1bmsgYXMgZywgaXNEZWZpbmVkIGFzIGksIG1pbkRlbGF5IGFzIG0sIHRpbWVvdXQgYXMgdCwgdW5pcXVlQnkgYXMgdSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1mdW5jdGlvbmFsLTQ0ZGU4ZmNmLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgZyBhcyBnZXRSZW5kZXJpbmdSZWYsIGYgYXMgZm9yY2VVcGRhdGUgfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcblxuY29uc3QgYXBwZW5kVG9NYXAgPSAobWFwLCBwcm9wTmFtZSwgdmFsdWUpID0+IHtcbiAgICBjb25zdCBpdGVtcyA9IG1hcC5nZXQocHJvcE5hbWUpO1xuICAgIGlmICghaXRlbXMpIHtcbiAgICAgICAgbWFwLnNldChwcm9wTmFtZSwgW3ZhbHVlXSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKCFpdGVtcy5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgaXRlbXMucHVzaCh2YWx1ZSk7XG4gICAgfVxufTtcbmNvbnN0IGRlYm91bmNlID0gKGZuLCBtcykgPT4ge1xuICAgIGxldCB0aW1lb3V0SWQ7XG4gICAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgICAgIGlmICh0aW1lb3V0SWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICB9XG4gICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGltZW91dElkID0gMDtcbiAgICAgICAgICAgIGZuKC4uLmFyZ3MpO1xuICAgICAgICB9LCBtcyk7XG4gICAgfTtcbn07XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBwb3NzaWJsZSBlbGVtZW50IGlzQ29ubmVjdGVkLlxuICogVGhlIHByb3BlcnR5IG1pZ2h0IG5vdCBiZSB0aGVyZSwgc28gd2UgY2hlY2sgZm9yIGl0LlxuICpcbiAqIFdlIHdhbnQgaXQgdG8gcmV0dXJuIHRydWUgaWYgaXNDb25uZWN0ZWQgaXMgbm90IGEgcHJvcGVydHksXG4gKiBvdGhlcndpc2Ugd2Ugd291bGQgcmVtb3ZlIHRoZXNlIGVsZW1lbnRzIGFuZCB3b3VsZCBub3QgdXBkYXRlLlxuICpcbiAqIEJldHRlciBsZWFrIGluIEVkZ2UgdGhhbiB0byBiZSB1c2VsZXNzLlxuICovXG5jb25zdCBpc0Nvbm5lY3RlZCA9IChtYXliZUVsZW1lbnQpID0+ICEoJ2lzQ29ubmVjdGVkJyBpbiBtYXliZUVsZW1lbnQpIHx8IG1heWJlRWxlbWVudC5pc0Nvbm5lY3RlZDtcbmNvbnN0IGNsZWFudXBFbGVtZW50cyA9IGRlYm91bmNlKChtYXApID0+IHtcbiAgICBmb3IgKGxldCBrZXkgb2YgbWFwLmtleXMoKSkge1xuICAgICAgICBtYXAuc2V0KGtleSwgbWFwLmdldChrZXkpLmZpbHRlcihpc0Nvbm5lY3RlZCkpO1xuICAgIH1cbn0sIDIwMDApO1xuY29uc3Qgc3RlbmNpbFN1YnNjcmlwdGlvbiA9ICgpID0+IHtcbiAgICBpZiAodHlwZW9mIGdldFJlbmRlcmluZ1JlZiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBJZiB3ZSBhcmUgbm90IGluIGEgc3RlbmNpbCBwcm9qZWN0LCB3ZSBkbyBub3RoaW5nLlxuICAgICAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIG5vdCByZWFsbHkgZXhwb3J0ZWQgYnkgQHN0ZW5jaWwvY29yZS5cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBjb25zdCBlbG1zVG9VcGRhdGUgPSBuZXcgTWFwKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGlzcG9zZTogKCkgPT4gZWxtc1RvVXBkYXRlLmNsZWFyKCksXG4gICAgICAgIGdldDogKHByb3BOYW1lKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbG0gPSBnZXRSZW5kZXJpbmdSZWYoKTtcbiAgICAgICAgICAgIGlmIChlbG0pIHtcbiAgICAgICAgICAgICAgICBhcHBlbmRUb01hcChlbG1zVG9VcGRhdGUsIHByb3BOYW1lLCBlbG0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZXQ6IChwcm9wTmFtZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBlbG1zVG9VcGRhdGUuZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50cykge1xuICAgICAgICAgICAgICAgIGVsbXNUb1VwZGF0ZS5zZXQocHJvcE5hbWUsIGVsZW1lbnRzLmZpbHRlcihmb3JjZVVwZGF0ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYW51cEVsZW1lbnRzKGVsbXNUb1VwZGF0ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0OiAoKSA9PiB7XG4gICAgICAgICAgICBlbG1zVG9VcGRhdGUuZm9yRWFjaCgoZWxtcykgPT4gZWxtcy5mb3JFYWNoKGZvcmNlVXBkYXRlKSk7XG4gICAgICAgICAgICBjbGVhbnVwRWxlbWVudHMoZWxtc1RvVXBkYXRlKTtcbiAgICAgICAgfSxcbiAgICB9O1xufTtcblxuY29uc3QgdW53cmFwID0gKHZhbCkgPT4gKHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicgPyB2YWwoKSA6IHZhbCk7XG5jb25zdCBjcmVhdGVPYnNlcnZhYmxlTWFwID0gKGRlZmF1bHRTdGF0ZSwgc2hvdWxkVXBkYXRlID0gKGEsIGIpID0+IGEgIT09IGIpID0+IHtcbiAgICBjb25zdCB1bndyYXBwZWRTdGF0ZSA9IHVud3JhcChkZWZhdWx0U3RhdGUpO1xuICAgIGxldCBzdGF0ZXMgPSBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKHVud3JhcHBlZFN0YXRlICE9PSBudWxsICYmIHVud3JhcHBlZFN0YXRlICE9PSB2b2lkIDAgPyB1bndyYXBwZWRTdGF0ZSA6IHt9KSk7XG4gICAgY29uc3QgaGFuZGxlcnMgPSB7XG4gICAgICAgIGRpc3Bvc2U6IFtdLFxuICAgICAgICBnZXQ6IFtdLFxuICAgICAgICBzZXQ6IFtdLFxuICAgICAgICByZXNldDogW10sXG4gICAgfTtcbiAgICBjb25zdCByZXNldCA9ICgpID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICAvLyBXaGVuIHJlc2V0dGluZyB0aGUgc3RhdGUsIHRoZSBkZWZhdWx0IHN0YXRlIG1heSBiZSBhIGZ1bmN0aW9uIC0gdW53cmFwIGl0IHRvIGludm9rZSBpdC5cbiAgICAgICAgLy8gb3RoZXJ3aXNlLCB0aGUgc3RhdGUgd29uJ3QgYmUgcHJvcGVybHkgcmVzZXRcbiAgICAgICAgc3RhdGVzID0gbmV3IE1hcChPYmplY3QuZW50cmllcygoX2EgPSB1bndyYXAoZGVmYXVsdFN0YXRlKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDoge30pKTtcbiAgICAgICAgaGFuZGxlcnMucmVzZXQuZm9yRWFjaCgoY2IpID0+IGNiKCkpO1xuICAgIH07XG4gICAgY29uc3QgZGlzcG9zZSA9ICgpID0+IHtcbiAgICAgICAgLy8gQ2FsbCBmaXJzdCBkaXNwb3NlIGFzIHJlc2V0dGluZyB0aGUgc3RhdGUgd291bGRcbiAgICAgICAgLy8gY2F1c2UgbGVzcyB1cGRhdGVzIDspXG4gICAgICAgIGhhbmRsZXJzLmRpc3Bvc2UuZm9yRWFjaCgoY2IpID0+IGNiKCkpO1xuICAgICAgICByZXNldCgpO1xuICAgIH07XG4gICAgY29uc3QgZ2V0ID0gKHByb3BOYW1lKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzLmdldC5mb3JFYWNoKChjYikgPT4gY2IocHJvcE5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHN0YXRlcy5nZXQocHJvcE5hbWUpO1xuICAgIH07XG4gICAgY29uc3Qgc2V0ID0gKHByb3BOYW1lLCB2YWx1ZSkgPT4ge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHN0YXRlcy5nZXQocHJvcE5hbWUpO1xuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlKHZhbHVlLCBvbGRWYWx1ZSwgcHJvcE5hbWUpKSB7XG4gICAgICAgICAgICBzdGF0ZXMuc2V0KHByb3BOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICBoYW5kbGVycy5zZXQuZm9yRWFjaCgoY2IpID0+IGNiKHByb3BOYW1lLCB2YWx1ZSwgb2xkVmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc3RhdGUgPSAodHlwZW9mIFByb3h5ID09PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IHt9XG4gICAgICAgIDogbmV3IFByb3h5KHVud3JhcHBlZFN0YXRlLCB7XG4gICAgICAgICAgICBnZXQoXywgcHJvcE5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvd25LZXlzKF8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShzdGF0ZXMua2V5cygpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGFzKF8sIHByb3BOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlcy5oYXMocHJvcE5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldChfLCBwcm9wTmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBzZXQocHJvcE5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pKTtcbiAgICBjb25zdCBvbiA9IChldmVudE5hbWUsIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICByZW1vdmVGcm9tQXJyYXkoaGFuZGxlcnNbZXZlbnROYW1lXSwgY2FsbGJhY2spO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgY29uc3Qgb25DaGFuZ2UgPSAocHJvcE5hbWUsIGNiKSA9PiB7XG4gICAgICAgIGNvbnN0IHVuU2V0ID0gb24oJ3NldCcsIChrZXksIG5ld1ZhbHVlKSA9PiB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSBwcm9wTmFtZSkge1xuICAgICAgICAgICAgICAgIGNiKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gdW53cmFwIHRoZSBkZWZhdWx0U3RhdGUgYmVjYXVzZSBpdCBtaWdodCBiZSBhIGZ1bmN0aW9uLlxuICAgICAgICAvLyBPdGhlcndpc2Ugd2UgbWlnaHQgbm90IGJlIHNlbmRpbmcgdGhlIHJpZ2h0IHJlc2V0IHZhbHVlLlxuICAgICAgICBjb25zdCB1blJlc2V0ID0gb24oJ3Jlc2V0JywgKCkgPT4gY2IodW53cmFwKGRlZmF1bHRTdGF0ZSlbcHJvcE5hbWVdKSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB1blNldCgpO1xuICAgICAgICAgICAgdW5SZXNldCgpO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgY29uc3QgdXNlID0gKC4uLnN1YnNjcmlwdGlvbnMpID0+IHtcbiAgICAgICAgY29uc3QgdW5zdWJzID0gc3Vic2NyaXB0aW9ucy5yZWR1Y2UoKHVuc3Vicywgc3Vic2NyaXB0aW9uKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnNldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdzZXQnLCBzdWJzY3JpcHRpb24uc2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLmdldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdnZXQnLCBzdWJzY3JpcHRpb24uZ2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzLnB1c2gob24oJ3Jlc2V0Jywgc3Vic2NyaXB0aW9uLnJlc2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLmRpc3Bvc2UpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbignZGlzcG9zZScsIHN1YnNjcmlwdGlvbi5kaXNwb3NlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5zdWJzO1xuICAgICAgICB9LCBbXSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB1bnN1YnMuZm9yRWFjaCgodW5zdWIpID0+IHVuc3ViKCkpO1xuICAgIH07XG4gICAgY29uc3QgZm9yY2VVcGRhdGUgPSAoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IG9sZFZhbHVlID0gc3RhdGVzLmdldChrZXkpO1xuICAgICAgICBoYW5kbGVycy5zZXQuZm9yRWFjaCgoY2IpID0+IGNiKGtleSwgb2xkVmFsdWUsIG9sZFZhbHVlKSk7XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGF0ZSxcbiAgICAgICAgZ2V0LFxuICAgICAgICBzZXQsXG4gICAgICAgIG9uLFxuICAgICAgICBvbkNoYW5nZSxcbiAgICAgICAgdXNlLFxuICAgICAgICBkaXNwb3NlLFxuICAgICAgICByZXNldCxcbiAgICAgICAgZm9yY2VVcGRhdGUsXG4gICAgfTtcbn07XG5jb25zdCByZW1vdmVGcm9tQXJyYXkgPSAoYXJyYXksIGl0ZW0pID0+IHtcbiAgICBjb25zdCBpbmRleCA9IGFycmF5LmluZGV4T2YoaXRlbSk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgYXJyYXlbaW5kZXhdID0gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV07XG4gICAgICAgIGFycmF5Lmxlbmd0aC0tO1xuICAgIH1cbn07XG5cbmNvbnN0IGNyZWF0ZVN0b3JlID0gKGRlZmF1bHRTdGF0ZSwgc2hvdWxkVXBkYXRlKSA9PiB7XG4gICAgY29uc3QgbWFwID0gY3JlYXRlT2JzZXJ2YWJsZU1hcChkZWZhdWx0U3RhdGUsIHNob3VsZFVwZGF0ZSk7XG4gICAgbWFwLnVzZShzdGVuY2lsU3Vic2NyaXB0aW9uKCkpO1xuICAgIHJldHVybiBtYXA7XG59O1xuXG5leHBvcnQgeyBjcmVhdGVTdG9yZSBhcyBjIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LTA1OTU2Y2FiLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgbCBhcyBsb2FkTW9kdWxlcyB9IGZyb20gJy4vbG9hZE1vZHVsZXMtYjRhYzEyNDcuanMnO1xuaW1wb3J0IHsgYyBhcyBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkgfSBmcm9tICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5cbmNvbnN0IGxhbmd1YWdlTWFwID0gbmV3IE1hcChbXG4gICAgW1wiYXJcIiwgXCJhclwiXSxcbiAgICBbXCJiZ1wiLCBcImJnXCJdLFxuICAgIFtcImJzXCIsIFwiYnNcIl0sXG4gICAgW1wiY2FcIiwgXCJjYVwiXSxcbiAgICBbXCJjc1wiLCBcImNzXCJdLFxuICAgIFtcImRhXCIsIFwiZGFcIl0sXG4gICAgW1wiZGVcIiwgXCJkZVwiXSxcbiAgICBbXCJlbFwiLCBcImVsXCJdLFxuICAgIFtcImVuXCIsIFwiZW5cIl0sXG4gICAgW1wiZXNcIiwgXCJlc1wiXSxcbiAgICBbXCJldFwiLCBcImV0XCJdLFxuICAgIFtcImZpXCIsIFwiZmlcIl0sXG4gICAgW1wiZnJcIiwgXCJmclwiXSxcbiAgICBbXCJoZVwiLCBcImhlXCJdLFxuICAgIFtcImhyXCIsIFwiaHJcIl0sXG4gICAgW1wiaHVcIiwgXCJodVwiXSxcbiAgICBbXCJpZFwiLCBcImlkXCJdLFxuICAgIFtcIml0XCIsIFwiaXRcIl0sXG4gICAgW1wiamFcIiwgXCJqYVwiXSxcbiAgICBbXCJrb1wiLCBcImtvXCJdLFxuICAgIFtcImx0XCIsIFwibHRcIl0sXG4gICAgW1wibHZcIiwgXCJsdlwiXSxcbiAgICBbXCJuYlwiLCBcIm5iXCJdLFxuICAgIFtcIm5sXCIsIFwibmxcIl0sXG4gICAgW1wicGxcIiwgXCJwbFwiXSxcbiAgICBbXCJwdC1iclwiLCBcInB0LUJSXCJdLFxuICAgIFtcInB0LXB0XCIsIFwicHQtUFRcIl0sXG4gICAgW1wicm9cIiwgXCJyb1wiXSxcbiAgICBbXCJydVwiLCBcInJ1XCJdLFxuICAgIFtcInNrXCIsIFwic2tcIl0sXG4gICAgW1wic2xcIiwgXCJzbFwiXSxcbiAgICBbXCJzclwiLCBcInNyXCJdLFxuICAgIFtcInN2XCIsIFwic3ZcIl0sXG4gICAgW1widGhcIiwgXCJ0aFwiXSxcbiAgICBbXCJ0clwiLCBcInRyXCJdLFxuICAgIFtcInVrXCIsIFwidWtcIl0sXG4gICAgW1widmlcIiwgXCJ2aVwiXSxcbiAgICBbXCJ6aC1jblwiLCBcInpoLUNOXCJdLFxuICAgIFtcInpoLWhrXCIsIFwiemgtSEtcIl0sXG4gICAgW1wiemgtdHdcIiwgXCJ6aC1UV1wiXVxuXSk7XG4vLyBydGxcbmZ1bmN0aW9uIGdldEVsZW1lbnREaXIoZWwpIHtcbiAgICByZXR1cm4gZ2V0RWxlbWVudFByb3AoZWwsIFwiZGlyXCIsIFwibHRyXCIpO1xufVxuZnVuY3Rpb24gZ2V0RWxlbWVudFByb3AoZWwsIHByb3AsIHZhbHVlKSB7XG4gICAgY29uc3QgY2xvc2VzdFdpdGhQcm9wID0gY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5KGVsLCBgWyR7cHJvcH1dYCk7XG4gICAgcmV0dXJuIGNsb3Nlc3RXaXRoUHJvcCA/IGNsb3Nlc3RXaXRoUHJvcC5nZXRBdHRyaWJ1dGUocHJvcCkgOiB2YWx1ZTtcbn1cbi8vIGNzc1xuY29uc3QgQ1NTX1VUSUxJVFkgPSB7XG4gICAgcnRsOiBcImFyY2dpcy0tcnRsXCJcbn07XG5hc3luYyBmdW5jdGlvbiBmb3JtYXROdW1iZXIobnVtYmVyLCBvcHRpb25zKSB7XG4gICAgY29uc3QgeyBhcGksIHR5cGUsIHBsYWNlcyB9ID0gb3B0aW9ucyB8fCB7fTtcbiAgICBpZiAoYXBpID09PSA0KSB7XG4gICAgICAgIGNvbnN0IFtpbnRsXSA9IGF3YWl0IGxvYWRNb2R1bGVzKFtcImVzcmkvaW50bFwiXSk7XG4gICAgICAgIGNvbnN0IG51bWJlckZvcm1hdEludGxPcHRpb25zID0gaW50bC5jb252ZXJ0TnVtYmVyRm9ybWF0VG9JbnRsT3B0aW9ucyh7XG4gICAgICAgICAgICBwbGFjZXMsXG4gICAgICAgICAgICBzdHlsZTogdHlwZSxcbiAgICAgICAgICAgIGRpZ2l0U2VwYXJhdG9yOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaW50bC5mb3JtYXROdW1iZXIobnVtYmVyLCBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG51bWJlckZvcm1hdEludGxPcHRpb25zKSwgeyBzdHlsZTogdHlwZSB9KSk7XG4gICAgfVxuICAgIGNvbnN0IFtkb2pvTnVtYmVyXSA9IGF3YWl0IGxvYWRNb2R1bGVzKFtcImRvam8vbnVtYmVyXCJdKTtcbiAgICByZXR1cm4gZG9qb051bWJlci5mb3JtYXQobnVtYmVyLCB7XG4gICAgICAgIHR5cGUsXG4gICAgICAgIHBsYWNlcyxcbiAgICAgICAgcGF0dGVybjogb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLnBhdHRlcm5cbiAgICB9KTtcbn1cbmNvbnN0IGNhY2hlID0ge307XG5mdW5jdGlvbiBmb3JtYXREYXRlKGRhdGUpIHtcbiAgICBjb25zdCBsYW5nID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lmxhbmc7XG4gICAgY29uc3QgZGF5U2hvcnRNb250aFllYXIgPSB7XG4gICAgICAgIHllYXI6IFwibnVtZXJpY1wiLFxuICAgICAgICBtb250aDogXCJzaG9ydFwiLFxuICAgICAgICBkYXk6IFwibnVtZXJpY1wiXG4gICAgfTtcbiAgICBpZiAoIWNhY2hlW2xhbmddKSB7XG4gICAgICAgIGNhY2hlW2xhbmddID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmxhbmcsIGRheVNob3J0TW9udGhZZWFyKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhY2hlW2xhbmddLmZvcm1hdChkYXRlKTtcbn1cbmZ1bmN0aW9uIGZvcm1hdFBsdXJhbChsYW5nLCBzdHJpbmdPYmosIG51bWJlcikge1xuICAgIGNvbnN0IHNpbmdsZXMgPSBbXCJpZFwiLCBcImphXCIsIFwia29cIiwgXCJ0aFwiLCBcInZpXCIsIFwiemgtY25cIiwgXCJ6aC1oa1wiLCBcInpoLXR3XCJdO1xuICAgIGNvbnN0IGxpa2VFbmdsaXNoID0gW1xuICAgICAgICBcImVuXCIsXG4gICAgICAgIFwiY2FcIixcbiAgICAgICAgXCJkYVwiLFxuICAgICAgICBcImRlXCIsXG4gICAgICAgIFwiZWxcIixcbiAgICAgICAgXCJlc1wiLFxuICAgICAgICBcImV0XCIsXG4gICAgICAgIFwiZmlcIixcbiAgICAgICAgXCJoaVwiLFxuICAgICAgICBcImh1XCIsXG4gICAgICAgIFwiaXRcIixcbiAgICAgICAgXCJuYlwiLFxuICAgICAgICBcIm5sXCIsXG4gICAgICAgIFwicHQtcHRcIixcbiAgICAgICAgXCJzdlwiLFxuICAgICAgICBcInRyXCJcbiAgICBdO1xuICAgIGNvbnN0IGxvY2FsZSA9IGxhbmcgIT09IG51bGwgJiYgbGFuZyAhPT0gdm9pZCAwID8gbGFuZyA6IFwiZW5cIjtcbiAgICAvLyBpZiB0aGUgbnVtYmVyIGlzIG9uZSwgb3IgaXQgaXMgYSBcInNpbXBsZVwiIGxhbmd1YWdlLCByZXR1cm4gdGhlIDEgc3RyaW5nXG4gICAgaWYgKG51bWJlciA9PT0gMSB8fCBzaW5nbGVzLmluY2x1ZGVzKGxvY2FsZSkpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZ09iai5zaW5nbGUucmVwbGFjZShcIiR7bnVtYmVyfVwiLCBcIjFcIik7XG4gICAgfVxuICAgIC8vIGlmIHRoZSBudW1iZXIgaXMgbm90IDEgYW5kIHRoZSBsYW5ndWFnZSB1c2VzIHRoZSBzYW1lIHBsdXJhbGl6YXRpb24gc3RyYXRlZ3kgYXMgZW5nbGlzaCxcbiAgICAvLyByZXR1cm4gdGhlIG11bHRpcGxlIHN0cmluZ1xuICAgIGlmIChudW1iZXIgIT09IDEgJiYgbGlrZUVuZ2xpc2guaW5jbHVkZXMobG9jYWxlKSkge1xuICAgICAgICByZXR1cm4gc3RyaW5nT2JqLm11bHRpcGxlLnJlcGxhY2UoXCIke251bWJlcn1cIiwgYCR7bnVtYmVyfWApO1xuICAgIH1cbiAgICAvLyBpZiBub25lIG9mIHRoZSBhYm92ZSB3b3JrZWQsIHJldHVybiB0aGUgXCJ1bmtub3duXCIgc3RyaW5nXG4gICAgcmV0dXJuIHN0cmluZ09iai51bmtub3duLnJlcGxhY2UoXCIke251bWJlcn1cIiwgYCR7bnVtYmVyfWApO1xufVxuXG5leHBvcnQgeyBDU1NfVVRJTElUWSBhcyBDLCBmb3JtYXREYXRlIGFzIGEsIGZvcm1hdFBsdXJhbCBhcyBiLCBmb3JtYXROdW1iZXIgYXMgZiwgZ2V0RWxlbWVudERpciBhcyBnLCBsYW5ndWFnZU1hcCBhcyBsIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxhbmd1YWdlVXRpbC1lZjBlNTRiMi5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IGMgYXMgY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5IH0gZnJvbSAnLi9kb20tNGQzNjc2NzcuanMnO1xuaW1wb3J0IHsgbCBhcyBsYW5ndWFnZU1hcCB9IGZyb20gJy4vbGFuZ3VhZ2VVdGlsLWVmMGU1NGIyLmpzJztcbmltcG9ydCB7IGEgYXMgZ2V0QXNzZXRQYXRoIH0gZnJvbSAnLi9pbmRleC1lM2JmN2RhNy5qcyc7XG5cbi8vIGh0dHBzOi8vbWVkaXVtLmNvbS9zdGVuY2lsLXRyaWNrcy9pbXBsZW1lbnRpbmctaW50ZXJuYXRpb25hbGlzYXRpb24taTE4bi13aXRoLXN0ZW5jaWwtNWU2NTU5NTU0MTE3XG5mdW5jdGlvbiBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2UoZWxlbWVudCkge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIGNvbnN0IGNsb3Nlc3RFbGVtZW50ID0gKF9hID0gY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5KGVsZW1lbnQsIFwiW2xhbmddXCIpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoX2MgPSAoX2IgPSBlbGVtZW50LnNoYWRvd1Jvb3QpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5vd25lckRvY3VtZW50KSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuZG9jdW1lbnRFbGVtZW50O1xuICAgIC8vIGxhbmd1YWdlIHNldCBieSB0aGUgY2FsbGluZyBhcHBsaWNhdGlvbiBvciBicm93c2VyLiBkZWZhdWx0cyB0byBlbmdsaXNoLlxuICAgIGNvbnN0IGxhbmcgPSAoKGNsb3Nlc3RFbGVtZW50ID09PSBudWxsIHx8IGNsb3Nlc3RFbGVtZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjbG9zZXN0RWxlbWVudC5sYW5nKSB8fCAobmF2aWdhdG9yID09PSBudWxsIHx8IG5hdmlnYXRvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmF2aWdhdG9yLmxhbmd1YWdlKSB8fCBcImVuXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nKSkge1xuICAgICAgICByZXR1cm4gbGFuZ3VhZ2VNYXAuZ2V0KGxhbmcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy8gXCJydS1SVVwiIG1hcHMgdG8gXCJydVwiIHVzZSBjYXNlXG4gICAgICAgIGlmIChsYW5ndWFnZU1hcC5oYXMobGFuZy5zbGljZSgwLCAyKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBsYW5ndWFnZU1hcC5nZXQobGFuZy5zbGljZSgwLCAyKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJlblwiO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlSW50bChlbGVtZW50KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgLy8gaXQncyBPSyBpZiB3ZSBkb24ndCBoYXZlIHRoZSA0IGxldHRlciBsYW5ndWFnZSBmaWxlIGZvciBpdFxuICAgIC8vIDQgbGV0dGVyIGxhbmd1YWdlIGNvZGUgbmVlZGVkIGZvciBmb3JtYXR0aW5nIG51bWJlcnNcbiAgICBjb25zdCBjbG9zZXN0RWxlbWVudCA9IChfYSA9IGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeShlbGVtZW50LCBcIltsYW5nXVwiKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKF9jID0gKF9iID0gZWxlbWVudC5zaGFkb3dSb290KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iub3duZXJEb2N1bWVudCkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmRvY3VtZW50RWxlbWVudDtcbiAgICAvLyBsYW5ndWFnZSBzZXQgYnkgdGhlIGNhbGxpbmcgYXBwbGljYXRpb24gb3IgYnJvd3Nlci4gZGVmYXVsdHMgdG8gZW5nbGlzaC5cbiAgICBjb25zdCBsYW5nID0gKChjbG9zZXN0RWxlbWVudCA9PT0gbnVsbCB8fCBjbG9zZXN0RWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2xvc2VzdEVsZW1lbnQubGFuZykgfHwgKG5hdmlnYXRvciA9PT0gbnVsbCB8fCBuYXZpZ2F0b3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5hdmlnYXRvci5sYW5ndWFnZSkgfHwgXCJlblwiKS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChsYW5ndWFnZU1hcC5oYXMobGFuZykpIHtcbiAgICAgICAgcmV0dXJuIGxhbmd1YWdlTWFwLmdldChsYW5nKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChsYW5ndWFnZU1hcC5oYXMobGFuZy5zbGljZSgwLCAyKSkpIHtcbiAgICAgICAgICAgIC8vIHdlIHN1cHBvcnQgdGhlIDIgbGV0dGVyIGNvZGVkIGxhbmd1YWdlXG4gICAgICAgICAgICAvLyBlLmcuIGl0LUNIIHZzIGl0XG4gICAgICAgICAgICByZXR1cm4gbGFuZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcImVuXCI7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBmZXRjaExvY2FsZVN0cmluZ3NGb3JDb21wb25lbnQoY29tcG9uZW50TmFtZSwgbG9jYWxlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgZmV0Y2goZ2V0QXNzZXRQYXRoKGAuLi9hcmNnaXMtYXBwLWFzc2V0cy9pMThuLyR7Y29tcG9uZW50TmFtZX0uaTE4bi4ke2xvY2FsZX0uanNvbmApKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQub2spXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuanNvbigpKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICByZWplY3QoKTtcbiAgICAgICAgfSwgKCkgPT4gcmVqZWN0KCkpO1xuICAgIH0pO1xufVxuY29uc3Qgc3RyaW5nQ2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGZldGNoTG9jYWxlU3RyaW5nc0Zyb21DYWNoZShjb21wb25lbnROYW1lLCBsb2NhbGUpIHtcbiAgICBjb25zdCBpZCA9IGAke2NvbXBvbmVudE5hbWV9JHtsb2NhbGV9YDtcbiAgICBpZiAoIXN0cmluZ0NhY2hlW2lkXSkge1xuICAgICAgICBzdHJpbmdDYWNoZVtpZF0gPSBmZXRjaExvY2FsZVN0cmluZ3NGb3JDb21wb25lbnQoY29tcG9uZW50TmFtZSwgbG9jYWxlKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cmluZ0NhY2hlW2lkXTtcbn1cbi8qKlxuICogR2V0IHN0cmluZ3MgYW5kIGxhbmd1YWdlIGNvZGVzLlxuICogVGhpcyBtZXRob2QgcmV0dXJucyAyIGxhbmd1YWdlIGNvZGVzLlxuICogVGhlIGZpcnN0IG9uZSByZXR1cm5zIGEgY29kZSB0aGF0J3MgYWxzbyBzdXBwb3J0ZWQgYXMgYSBsYW5ndWFnZSBmaWxlLlxuICogVGhlIHNlY29uZCBvbmUgcmV0dXJucyBhIGNvZGUgd2hlcmUgdGhlcmUgaXMgc3VwcG9ydCBmb3IgdGhlIGZpcnN0IDIgbGV0dGVycyBvZiB0aGUgY29kZSBhcyBwYXJ0IG9mIGEgbGFuZ3VhZ2UgZmlsZSxcbiAqIGJ1dCB3aWxsIHJldHVybiB0aGUgb3JpZ2luYWwgNCBsZXR0ZXIgY29kZSBmcm9tIHRoZSBwYWdlLlxuICogRS5nLiBGb3IgXCJpdC1jaFwiIGl0IHdpbGwgcmV0dXJuIFwiaXRcIiBhcyB0aGUgZmlyc3QgbGFuZ3VhZ2UgY29kZSBhbmQgXCJpdC1jaFwiIGFzIHRoZSBzZWNvbmQuXG4gKiBUaGUgc2Vjb25kIG9uZSBpcyByZXF1aXJlZCBmb3IgZXNyaS5pbnRsLnNldExvY2FsZSgpIHRvIGdldCB0aGUgY29ycmVjdCBmb3JtYXR0aW5nLlxuICpcbiAqIElmIGEgdGFnTmFtZSBpcyBwcm92aWRlZCBpdCB3aWxsIG92ZXJ3aXRlIHRoZSBlbGVtZW50J3MgdGFnTmFtZVxuICpcbiAqICBAcmV0dXJuIFsgc3RyaW5ncywgZmlyc3QgbGFuZ3VhZ2UgY29kZSwgc2Vjb25kIGxhbmd1YWdlIGNvZGVdXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3MoZWxlbWVudCwgdGFnTmFtZSkge1xuICAgIGNvbnN0IGNvbXBvbmVudE5hbWUgPSB0YWdOYW1lIHx8IGVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IGNvbXBvbmVudExhbmd1YWdlID0gZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlKGVsZW1lbnQpO1xuICAgIGNvbnN0IGNvbXBvbmVudExhbmd1YWdlSW50bCA9IGdldENvbXBvbmVudENsb3Nlc3RMYW5ndWFnZUludGwoZWxlbWVudCk7XG4gICAgbGV0IHN0cmluZ3M7XG4gICAgdHJ5IHtcbiAgICAgICAgc3RyaW5ncyA9IGF3YWl0IGZldGNoTG9jYWxlU3RyaW5nc0Zyb21DYWNoZShjb21wb25lbnROYW1lLCBjb21wb25lbnRMYW5ndWFnZSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybihgbm8gbG9jYWxlIGZvciAke2NvbXBvbmVudE5hbWV9ICgke2NvbXBvbmVudExhbmd1YWdlfSkgbG9hZGluZyBkZWZhdWx0IGxvY2FsZSBlbi5gKTtcbiAgICAgICAgc3RyaW5ncyA9IGF3YWl0IGZldGNoTG9jYWxlU3RyaW5nc0Zyb21DYWNoZShjb21wb25lbnROYW1lLCBcImVuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gW3N0cmluZ3MsIGNvbXBvbmVudExhbmd1YWdlLCBjb21wb25lbnRMYW5ndWFnZUludGxdO1xufVxuXG5leHBvcnQgeyBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2UgYXMgYSwgZ2V0TG9jYWxlQ29tcG9uZW50U3RyaW5ncyBhcyBnIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvY2FsZS0wNTBiNmRiOS5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmNvbnN0IGJyZWFrcG9pbnRzID0ge1xuICAgIHh4czogMzIwLFxuICAgIHhzOiA0ODAsXG4gICAgc206IDY0MCxcbiAgICBtZDogNzY4LFxuICAgIGxnOiAxMDI0LFxuICAgIHhsOiAxMjgwXG59O1xuY29uc3QgRFJPUERPV05fSUNPTl9ESVNQTEFZX0NVVE9GRl9TSVpFID0gOTYwO1xuZnVuY3Rpb24gc2V0dXBSZXNpemVPYnNlcnZlcihzdG9yZSkge1xuICAgIHZhciBfYTtcbiAgICB2YXIgX2I7XG4gICAgKF9hID0gKF9iID0gc3RvcmUuc3RhdGUpLnJlc2l6ZU9ic2VydmVyKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoX2IucmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIocmVzaXplSGFuZGxlcikpO1xuICAgIHJldHVybiBzdG9yZS5zdGF0ZS5yZXNpemVPYnNlcnZlcjtcbn1cbi8qKlxuICogcmVzaXplIGhhbmRsZXIgd2lsbCBiZSBjYWxsZWQgd2hlbiBpdGVtcyBnZXQgcmVzaXplZFxuICogYW4gZXZlbnQgaXMgZGlzcGF0Y2hlZCBvbiBlYWNoIGVsZW1lbnQsIHBhc3NpbmcgdGhlIG5ldyB3aWR0aCBhbmQgaGVpZ2h0XG4gKi9cbmZ1bmN0aW9uIHJlc2l6ZUhhbmRsZXIoZW50cmllcykge1xuICAgIGVudHJpZXMuZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICAgICAgaWYgKGVudHJ5LmNvbnRlbnRSZWN0LndpZHRoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoXCJhcmNnaXNCcm93c2VyUmVzaXplXCIsIHtcbiAgICAgICAgICAgICAgICBkZXRhaWw6IHsgd2lkdGg6IGVudHJ5LmNvbnRlbnRSZWN0LndpZHRoLCBoZWlnaHQ6IGVudHJ5LmNvbnRlbnRSZWN0LmhlaWdodCB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGVudHJ5LnRhcmdldC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5leHBvcnQgeyBEUk9QRE9XTl9JQ09OX0RJU1BMQVlfQ1VUT0ZGX1NJWkUgYXMgRCwgYnJlYWtwb2ludHMgYXMgYiwgc2V0dXBSZXNpemVPYnNlcnZlciBhcyBzIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlc2l6ZS1hMTdiNzI5Mi5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IGMgYXMgY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5IH0gZnJvbSAnLi9kb20tNGQzNjc2NzcuanMnO1xuXG5jb25zdCBvbkJyb3dzZXJGaWx0ZXJSZW1vdmUgPSAoaWQsIHN0b3JlLCBjYWxsYmFjaykgPT4ge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBzdG9yZS5vbkNoYW5nZShcImZpbHRlcnNcIiwgKGZpbHRlcnMpID0+IHtcbiAgICAgICAgaWYgKCFmaWx0ZXJzW2lkXSB8fCAhZmlsdGVyc1tpZF0udmFsdWUpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5jb25zdCBvblByZXZpZXdDaGFuZ2UgPSAoc3RvcmUsIGNhbGxiYWNrKSA9PiB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHN0b3JlLm9uQ2hhbmdlKFwicHJldmlld1wiLCAocHJldmlldykgPT4ge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgIH0pO1xufTtcbmNvbnN0IG9uR3JvdXBJZENoYW5nZSA9IChzdG9yZSwgY2FsbGJhY2spID0+IHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgc3RvcmUub25DaGFuZ2UoXCJncm91cElkXCIsIChwcmV2aWV3KSA9PiB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgfSk7XG59O1xuY29uc3QgU1RPUkVfTE9PS1VQID0gbmV3IE1hcCgpO1xuZnVuY3Rpb24gZ2V0U3RvcmUoZWwsIGJyb3dzZXJUYWcpIHtcbiAgICBjb25zdCBleGlzdGluZ1N0b3JlID0gU1RPUkVfTE9PS1VQLmdldChlbCk7XG4gICAgaWYgKGV4aXN0aW5nU3RvcmUpIHtcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nU3RvcmU7XG4gICAgfVxuICAgIGNvbnN0IGJyb3dzZXIgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWwsIGJyb3dzZXJUYWcpO1xuICAgIGlmIChicm93c2VyKSB7XG4gICAgICAgIFNUT1JFX0xPT0tVUC5zZXQoZWwsIGJyb3dzZXIuc3RvcmUpO1xuICAgICAgICByZXR1cm4gYnJvd3Nlci5zdG9yZTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCB7IG9uQnJvd3NlckZpbHRlclJlbW92ZSBhcyBhLCBvbkdyb3VwSWRDaGFuZ2UgYXMgYiwgZ2V0U3RvcmUgYXMgZywgb25QcmV2aWV3Q2hhbmdlIGFzIG8gfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RvcmUtOGIxYjA4NDYuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyBjIGFzIGNyZWF0ZVN0b3JlIH0gZnJvbSAnLi9pbmRleC0wNTk1NmNhYi5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFN0b3JlIH0gZnJvbSAnLi9zdG9yZS04YjFiMDg0Ni5qcyc7XG5cbmZ1bmN0aW9uIGdldEdyb3VwQnJvd3NlclN0b3JlKGVsKSB7XG4gICAgcmV0dXJuIGdldFN0b3JlKGVsLCBcImFyY2dpcy1ncm91cC1icm93c2VyXCIpO1xufVxuY29uc3QgR3JvdXBCcm93c2VyU3RvcmUgPSBjcmVhdGVTdG9yZSh7IGZpbHRlcnM6IHt9IH0pO1xuY29uc3QgZ3JvdXBCcm93c2VyU3RhdGUgPSBHcm91cEJyb3dzZXJTdG9yZS5zdGF0ZTtcblxuZXhwb3J0IHsgZ3JvdXBCcm93c2VyU3RhdGUgYXMgYSwgZ2V0R3JvdXBCcm93c2VyU3RvcmUgYXMgZyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdG9yZS1kYTNmY2NkNS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=