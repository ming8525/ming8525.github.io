"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-smart-m-492bf8"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping-class-breaks-color-slider.entry.js":
/*!*************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping-class-breaks-color-slider.entry.js ***!
  \*************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_smart_mapping_class_breaks_color_slider: () => (/* binding */ ArcgisSmartMappingClassBreaksColorSlider)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./raster-unique-value-0976ec7f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-unique-value-0976ec7f.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _precision_06a73672_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./precision-06a73672.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/precision-06a73672.js");
/* harmony import */ var _commonEnums_fcf13661_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./commonEnums-fcf13661.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonEnums-fcf13661.js");
/* harmony import */ var _color_d6da0a9a_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./color-d6da0a9a.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/color-d6da0a9a.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./locale-050b6db9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./commonFunctions-b0830e9e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-b0830e9e.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */












const arcgisSmartMappingClassBreaksColorSliderCss = ".slider-box{height:320px}.slider-box .esri-classed-color-slider{min-width:200px}.slider-box .esri-classed-color-slider .esri-slider .esri-slider__content{height:175px}.slider-box .esri-classed-color-slider .esri-slider .esri-slider__label,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__min,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.slider-box .esri-classed-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-box-buttons-front{display:flex}";

const ArcgisSmartMappingClassBreaksColorSlider = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisSmartMappingClassBreaksColorSliderChange = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingClassBreaksColorSliderChange", 7);
        this.arcgisSmartMappingClassBreaksColorSliderError = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingClassBreaksColorSliderError", 7);
        this.styleSheetStatus = "not-loaded";
    }
    // -------------------------------------------------------------------
    //
    //  Render Methods
    //
    // -------------------------------------------------------------------
    render() {
        const { config } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("link", { rel: "stylesheet", href: `${config.jsapiUrl}/themes/light/main.css`, onLoad: () => {
                this.styleSheetStatus = "loaded";
                (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.hostElement);
            }, onError: () => {
                this.styleSheetStatus = "failed";
                (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.hostElement);
            } }), this.styleSheetStatus === "loaded"
            ? this.renderClassBreaksColorSlider()
            : this.styleSheetStatus === "not-loaded"
                ? this.renderClassBreaksColorSliderLoading()
                : null));
    }
    renderClassBreaksColorSlider() {
        const { layer: smLayer, strings } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const layer = smLayer;
        const renderer = layer.renderer;
        if (renderer.classBreakInfos.length === 1) {
            if (this.classBreaksColorSlider) {
                this.classBreaksColorSlider.destroy();
                this.classBreaksColorSlider = undefined;
            }
        }
        else {
            const ok = this.prepareClassBreaksColorSlider();
            if (ok || this.classBreaksColorSlider) {
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "slider-box" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", null, strings.panels.classBreaks.dataRange), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "slider-box-buttons-front" }, this.renderInvertButton()), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (node) => {
                        if (node) {
                            this.afterClassBreaksColorSliderCreate(node);
                        }
                    } })));
            }
            else {
                return this.renderClassBreaksColorSliderLoading();
            }
        }
    }
    renderInvertButton() {
        const { strings } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-action", { text: strings.panels.classBreaks.invertSlider, icon: "arrowUpDown", onClick: () => this.handleInvertSlider() }));
    }
    renderClassBreaksColorSliderLoading() {
        const { strings } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "slider-box" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-loader", { label: strings.loading })));
    }
    // -------------------------------------------------------------------
    //
    //  Private methods
    //
    // -------------------------------------------------------------------
    prepareClassBreaksColorSlider() {
        const { layer: smLayer, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const layer = smLayer;
        const renderer = layer.renderer;
        let min;
        let max;
        min = renderer.classBreakInfos[0].minValue;
        max = renderer.classBreakInfos[renderer.classBreakInfos.length - 1].maxValue;
        ({ min, max } = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.ad)({ min, max }));
        const breaks = (0,_color_d6da0a9a_js__WEBPACK_IMPORTED_MODULE_5__.g)();
        const precision = (0,_precision_06a73672_js__WEBPACK_IMPORTED_MODULE_3__.g)(breaks);
        const config = { min, max, breaks, precision };
        if (!this.classBreaksColorSlider) {
            this.classBreaksColorSlider = new modules.ClassedColorSlider(config);
            this.createclassBreaksColorSliderChangeEvents();
        }
        else {
            this.classBreaksColorSlider.set(config);
        }
        return (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.ac)(this.classBreaksColorSlider);
    }
    afterClassBreaksColorSliderCreate(node) {
        if (!this.classBreaksColorSlider.container) {
            const divNode = document.createElement("div");
            node.append(divNode);
            this.classBreaksColorSlider.container = divNode;
        }
    }
    createclassBreaksColorSliderChangeEvents() {
        const { layer: smLayer } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const layer = smLayer;
        if (!this.classBreaksColorSlider) {
            return;
        }
        this.classBreaksColorSlider.on("min-change", (info) => {
            const renderer = layer.renderer;
            const infos = renderer.classBreakInfos;
            if (info.value > infos[0].maxValue) {
                this.handleMinMaxChange(infos[0].maxValue, infos[infos.length - 1].maxValue);
            }
            else {
                this.handleMinMaxChange(info.value, infos[infos.length - 1].maxValue);
            }
        });
        this.classBreaksColorSlider.on("max-change", (info) => {
            const renderer = layer.renderer;
            const infos = renderer.classBreakInfos;
            if (info.value < infos[infos.length - 1].minValue) {
                this.handleMinMaxChange(infos[0].minValue, infos[infos.length - 1].minValue);
            }
            else {
                this.handleMinMaxChange(infos[0].minValue, info.value);
            }
        });
        this.classBreaksColorSlider.on("thumb-change", () => this.updateRendererBreaks(this.classBreaksColorSlider.breaks));
        this.classBreaksColorSlider.on("thumb-drag", () => this.updateRendererBreaks(this.classBreaksColorSlider.breaks));
    }
    handleInvertSlider() {
        const { layer: smLayer, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const layer = smLayer;
        const renderer = layer.renderer;
        let colors = renderer.classBreakInfos.map((classBreakInfo) => {
            return ((0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.t)(classBreakInfo.symbol) ||
                new modules.esriColor({ r: 64, g: 64, b: 64, a: 1 }));
        });
        colors = colors.reverse();
        renderer.classBreakInfos.map((classBreakInfo, idx) => {
            if ((0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.t)(classBreakInfo.symbol)) {
                (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.r)(classBreakInfo.symbol, colors[idx]);
            }
        });
        (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.ab)();
        this.arcgisSmartMappingClassBreaksColorSliderChange.emit({ invertColors: true });
    }
    handleMinMaxChange(min, max) {
        const { layer: smLayer } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const layer = smLayer;
        const renderer = layer.renderer;
        let minClassBreak = renderer.classBreakInfos[0];
        let maxClassBreak = renderer.classBreakInfos[renderer.classBreakInfos.length - 1];
        minClassBreak.minValue = min;
        minClassBreak.label = `${minClassBreak.minValue.toLocaleString()} - ${minClassBreak.maxValue.toLocaleString()}`;
        maxClassBreak.maxValue = max;
        maxClassBreak.label = `${maxClassBreak.minValue.toLocaleString()} - ${maxClassBreak.maxValue.toLocaleString()}`;
        (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.ab)();
        this.arcgisSmartMappingClassBreaksColorSliderChange.emit({ updateValues: true });
    }
    updateRendererBreaks(breaks) {
        const { layer: smLayer } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.s;
        const layer = smLayer;
        const renderer = layer.renderer;
        renderer.classBreakInfos.forEach((classBreakInfo, idx) => {
            if (classBreakInfo.minValue !== breaks[idx].min ||
                classBreakInfo.maxValue !== breaks[idx].max) {
                classBreakInfo.minValue = breaks[idx].min;
                classBreakInfo.maxValue = breaks[idx].max;
                classBreakInfo.label = `${classBreakInfo.minValue.toLocaleString()} - ${classBreakInfo.maxValue.toLocaleString()}`;
            }
        });
        (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_1__.ab)();
        this.arcgisSmartMappingClassBreaksColorSliderChange.emit({ updateValues: true });
    }
    get hostElement() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisSmartMappingClassBreaksColorSlider.style = arcgisSmartMappingClassBreaksColorSliderCss;



//# sourceMappingURL=arcgis-smart-mapping-class-breaks-color-slider.entry.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLXNtYXJ0LW0tNDkyYmY4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQytIO0FBQ3FEO0FBQ2pKO0FBQzZCO0FBQzdCO0FBQzZCO0FBQzVCO0FBQ1Q7QUFDRztBQUNEO0FBQ1U7O0FBRXZDLGlFQUFpRSxhQUFhLHVDQUF1QyxnQkFBZ0IsMEVBQTBFLGFBQWEsb05BQW9OLDBCQUEwQixzT0FBc08sc0JBQXNCLHlCQUF5QixxQkFBcUIsVUFBVSwwQkFBMEIsYUFBYTs7QUFFcnlCO0FBQ0E7QUFDQSxRQUFRLHFEQUFnQjtBQUN4Qiw4REFBOEQscURBQVc7QUFDekUsNkRBQTZELHFEQUFXO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsU0FBUyxFQUFFLCtEQUFpQjtBQUM1QyxnQkFBZ0IscURBQUMsQ0FBQyxpREFBSSxRQUFRLHFEQUFDLFdBQVcsNEJBQTRCLGdCQUFnQjtBQUN0RjtBQUNBLGdCQUFnQixxREFBVztBQUMzQixhQUFhO0FBQ2I7QUFDQSxnQkFBZ0IscURBQVc7QUFDM0IsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwwQkFBMEIsRUFBRSwrREFBaUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixxREFBQyxVQUFVLHFCQUFxQixFQUFFLHFEQUFDLCtEQUErRCxxREFBQyxVQUFVLG1DQUFtQyw4QkFBOEIscURBQUMsVUFBVTtBQUNqTjtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsVUFBVSxFQUFFLCtEQUFpQjtBQUM3QyxnQkFBZ0IscURBQUMsa0NBQWtDLDhHQUE4RztBQUNqSztBQUNBO0FBQ0EsZ0JBQWdCLFVBQVUsRUFBRSwrREFBaUI7QUFDN0MsZ0JBQWdCLHFEQUFDLFVBQVUscUJBQXFCLEVBQUUscURBQUMscUJBQXFCLHdCQUF3QjtBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwwQkFBMEIsRUFBRSwrREFBaUI7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxXQUFXLEVBQUUsb0VBQWMsR0FBRyxVQUFVO0FBQ25ELHVCQUF1QixxREFBb0I7QUFDM0MsMEJBQTBCLHlEQUFnQjtBQUMxQyx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG9FQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpQkFBaUIsRUFBRSwrREFBaUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDBCQUEwQixFQUFFLCtEQUFpQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUVBQWM7QUFDbEMsd0NBQXdDLDJCQUEyQjtBQUNuRSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGdCQUFnQixtRUFBYztBQUM5QixnQkFBZ0IsbUVBQWdCO0FBQ2hDO0FBQ0EsU0FBUztBQUNULFFBQVEsb0VBQWM7QUFDdEIsbUVBQW1FLG9CQUFvQjtBQUN2RjtBQUNBO0FBQ0EsZ0JBQWdCLGlCQUFpQixFQUFFLCtEQUFpQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLHlDQUF5QyxJQUFJLHdDQUF3QztBQUN0SDtBQUNBLGlDQUFpQyx5Q0FBeUMsSUFBSSx3Q0FBd0M7QUFDdEgsUUFBUSxvRUFBYztBQUN0QixtRUFBbUUsb0JBQW9CO0FBQ3ZGO0FBQ0E7QUFDQSxnQkFBZ0IsaUJBQWlCLEVBQUUsK0RBQWlCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDBDQUEwQyxJQUFJLHlDQUF5QztBQUNqSTtBQUNBLFNBQVM7QUFDVCxRQUFRLG9FQUFjO0FBQ3RCLG1FQUFtRSxvQkFBb0I7QUFDdkY7QUFDQSx3QkFBd0IsT0FBTyxxREFBVTtBQUN6QztBQUNBOztBQUVzRzs7QUFFdEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtc21hcnQtbWFwcGluZy1jbGFzcy1icmVha3MtY29sb3Itc2xpZGVyLmVudHJ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBmIGFzIGZvcmNlVXBkYXRlLCBIIGFzIEhvc3QsIGQgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtZTNiZjdkYTcuanMnO1xuaW1wb3J0IHsgYWQgYXMgdmFsaWRhdGVNaW5NYXgsIGFjIGFzIGlzRGVmaW5lZCwgdCBhcyBnZXRTeW1ib2xDb2xvciwgciBhcyBhcHBseVN5bWJvbENvbG9yLCBhYiBhcyB1cGRhdGVSZW5kZXJlciwgcyBhcyBzbWFydE1hcHBpbmdTdGF0ZSB9IGZyb20gJy4vcmFzdGVyLXVuaXF1ZS12YWx1ZS0wOTc2ZWM3Zi5qcyc7XG5pbXBvcnQgJy4vbG9hZE1vZHVsZXMtYjRhYzEyNDcuanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRTdG9wUHJlY2lzaW9uIH0gZnJvbSAnLi9wcmVjaXNpb24tMDZhNzM2NzIuanMnO1xuaW1wb3J0ICcuL2NvbW1vbkVudW1zLWZjZjEzNjYxLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0Q2xhc3NCcmVha3NDb2xvcnMgfSBmcm9tICcuL2NvbG9yLWQ2ZGEwYTlhLmpzJztcbmltcG9ydCAnLi9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMnO1xuaW1wb3J0ICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5pbXBvcnQgJy4vbG9jYWxlLTA1MGI2ZGI5LmpzJztcbmltcG9ydCAnLi9pbmRleC0wNTk1NmNhYi5qcyc7XG5pbXBvcnQgJy4vY29tbW9uRnVuY3Rpb25zLWIwODMwZTllLmpzJztcblxuY29uc3QgYXJjZ2lzU21hcnRNYXBwaW5nQ2xhc3NCcmVha3NDb2xvclNsaWRlckNzcyA9IFwiLnNsaWRlci1ib3h7aGVpZ2h0OjMyMHB4fS5zbGlkZXItYm94IC5lc3JpLWNsYXNzZWQtY29sb3Itc2xpZGVye21pbi13aWR0aDoyMDBweH0uc2xpZGVyLWJveCAuZXNyaS1jbGFzc2VkLWNvbG9yLXNsaWRlciAuZXNyaS1zbGlkZXIgLmVzcmktc2xpZGVyX19jb250ZW50e2hlaWdodDoxNzVweH0uc2xpZGVyLWJveCAuZXNyaS1jbGFzc2VkLWNvbG9yLXNsaWRlciAuZXNyaS1zbGlkZXIgLmVzcmktc2xpZGVyX19sYWJlbCwuc2xpZGVyLWJveCAuZXNyaS1jbGFzc2VkLWNvbG9yLXNsaWRlciAuZXNyaS1zbGlkZXIgLmVzcmktc2xpZGVyX19taW4sLnNsaWRlci1ib3ggLmVzcmktY2xhc3NlZC1jb2xvci1zbGlkZXIgLmVzcmktc2xpZGVyIC5lc3JpLXNsaWRlcl9fbWF4e3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmV9LnNsaWRlci1ib3ggLmVzcmktY2xhc3NlZC1jb2xvci1zbGlkZXIgLmVzcmktc2xpZGVyIC5lc3JpLXNsaWRlcl9fbGFiZWw6aG92ZXIsLnNsaWRlci1ib3ggLmVzcmktY2xhc3NlZC1jb2xvci1zbGlkZXIgLmVzcmktc2xpZGVyIC5lc3JpLXNsaWRlcl9fbWluOmhvdmVyLC5zbGlkZXItYm94IC5lc3JpLWNsYXNzZWQtY29sb3Itc2xpZGVyIC5lc3JpLXNsaWRlciAuZXNyaS1zbGlkZXJfX21heDpob3Zlcntib3JkZXI6MXB4IHNvbGlkICNiYmI7YmFja2dyb3VuZC1jb2xvcjojZjNmM2YzO3RleHQtZGVjb3JhdGlvbjpub25lO3otaW5kZXg6MX0uc2xpZGVyLWJveC1idXR0b25zLWZyb250e2Rpc3BsYXk6ZmxleH1cIjtcblxuY29uc3QgQXJjZ2lzU21hcnRNYXBwaW5nQ2xhc3NCcmVha3NDb2xvclNsaWRlciA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xhc3NCcmVha3NDb2xvclNsaWRlckNoYW5nZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzU21hcnRNYXBwaW5nQ2xhc3NCcmVha3NDb2xvclNsaWRlckNoYW5nZVwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbGFzc0JyZWFrc0NvbG9yU2xpZGVyRXJyb3IgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1NtYXJ0TWFwcGluZ0NsYXNzQnJlYWtzQ29sb3JTbGlkZXJFcnJvclwiLCA3KTtcbiAgICAgICAgdGhpcy5zdHlsZVNoZWV0U3RhdHVzID0gXCJub3QtbG9hZGVkXCI7XG4gICAgfVxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBSZW5kZXIgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBjb25maWcgfSA9IHNtYXJ0TWFwcGluZ1N0YXRlO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImxpbmtcIiwgeyByZWw6IFwic3R5bGVzaGVldFwiLCBocmVmOiBgJHtjb25maWcuanNhcGlVcmx9L3RoZW1lcy9saWdodC9tYWluLmNzc2AsIG9uTG9hZDogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGVTaGVldFN0YXR1cyA9IFwibG9hZGVkXCI7XG4gICAgICAgICAgICAgICAgZm9yY2VVcGRhdGUodGhpcy5ob3N0RWxlbWVudCk7XG4gICAgICAgICAgICB9LCBvbkVycm9yOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHlsZVNoZWV0U3RhdHVzID0gXCJmYWlsZWRcIjtcbiAgICAgICAgICAgICAgICBmb3JjZVVwZGF0ZSh0aGlzLmhvc3RFbGVtZW50KTtcbiAgICAgICAgICAgIH0gfSksIHRoaXMuc3R5bGVTaGVldFN0YXR1cyA9PT0gXCJsb2FkZWRcIlxuICAgICAgICAgICAgPyB0aGlzLnJlbmRlckNsYXNzQnJlYWtzQ29sb3JTbGlkZXIoKVxuICAgICAgICAgICAgOiB0aGlzLnN0eWxlU2hlZXRTdGF0dXMgPT09IFwibm90LWxvYWRlZFwiXG4gICAgICAgICAgICAgICAgPyB0aGlzLnJlbmRlckNsYXNzQnJlYWtzQ29sb3JTbGlkZXJMb2FkaW5nKClcbiAgICAgICAgICAgICAgICA6IG51bGwpKTtcbiAgICB9XG4gICAgcmVuZGVyQ2xhc3NCcmVha3NDb2xvclNsaWRlcigpIHtcbiAgICAgICAgY29uc3QgeyBsYXllcjogc21MYXllciwgc3RyaW5ncyB9ID0gc21hcnRNYXBwaW5nU3RhdGU7XG4gICAgICAgIGNvbnN0IGxheWVyID0gc21MYXllcjtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSBsYXllci5yZW5kZXJlcjtcbiAgICAgICAgaWYgKHJlbmRlcmVyLmNsYXNzQnJlYWtJbmZvcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNsYXNzQnJlYWtzQ29sb3JTbGlkZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzQnJlYWtzQ29sb3JTbGlkZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG9rID0gdGhpcy5wcmVwYXJlQ2xhc3NCcmVha3NDb2xvclNsaWRlcigpO1xuICAgICAgICAgICAgaWYgKG9rIHx8IHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiAoaChcImRpdlwiLCB7IGNsYXNzOiBcInNsaWRlci1ib3hcIiB9LCBoKFwiY2FsY2l0ZS1sYWJlbFwiLCBudWxsLCBzdHJpbmdzLnBhbmVscy5jbGFzc0JyZWFrcy5kYXRhUmFuZ2UpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwic2xpZGVyLWJveC1idXR0b25zLWZyb250XCIgfSwgdGhpcy5yZW5kZXJJbnZlcnRCdXR0b24oKSksIGgoXCJkaXZcIiwgeyByZWY6IChub2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWZ0ZXJDbGFzc0JyZWFrc0NvbG9yU2xpZGVyQ3JlYXRlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IH0pKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJDbGFzc0JyZWFrc0NvbG9yU2xpZGVyTG9hZGluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlbmRlckludmVydEJ1dHRvbigpIHtcbiAgICAgICAgY29uc3QgeyBzdHJpbmdzIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctYWN0aW9uXCIsIHsgdGV4dDogc3RyaW5ncy5wYW5lbHMuY2xhc3NCcmVha3MuaW52ZXJ0U2xpZGVyLCBpY29uOiBcImFycm93VXBEb3duXCIsIG9uQ2xpY2s6ICgpID0+IHRoaXMuaGFuZGxlSW52ZXJ0U2xpZGVyKCkgfSkpO1xuICAgIH1cbiAgICByZW5kZXJDbGFzc0JyZWFrc0NvbG9yU2xpZGVyTG9hZGluZygpIHtcbiAgICAgICAgY29uc3QgeyBzdHJpbmdzIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgcmV0dXJuIChoKFwiZGl2XCIsIHsgY2xhc3M6IFwic2xpZGVyLWJveFwiIH0sIGgoXCJjYWxjaXRlLWxvYWRlclwiLCB7IGxhYmVsOiBzdHJpbmdzLmxvYWRpbmcgfSkpKTtcbiAgICB9XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFByaXZhdGUgbWV0aG9kc1xuICAgIC8vXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHByZXBhcmVDbGFzc0JyZWFrc0NvbG9yU2xpZGVyKCkge1xuICAgICAgICBjb25zdCB7IGxheWVyOiBzbUxheWVyLCBtb2R1bGVzIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSBzbUxheWVyO1xuICAgICAgICBjb25zdCByZW5kZXJlciA9IGxheWVyLnJlbmRlcmVyO1xuICAgICAgICBsZXQgbWluO1xuICAgICAgICBsZXQgbWF4O1xuICAgICAgICBtaW4gPSByZW5kZXJlci5jbGFzc0JyZWFrSW5mb3NbMF0ubWluVmFsdWU7XG4gICAgICAgIG1heCA9IHJlbmRlcmVyLmNsYXNzQnJlYWtJbmZvc1tyZW5kZXJlci5jbGFzc0JyZWFrSW5mb3MubGVuZ3RoIC0gMV0ubWF4VmFsdWU7XG4gICAgICAgICh7IG1pbiwgbWF4IH0gPSB2YWxpZGF0ZU1pbk1heCh7IG1pbiwgbWF4IH0pKTtcbiAgICAgICAgY29uc3QgYnJlYWtzID0gZ2V0Q2xhc3NCcmVha3NDb2xvcnMoKTtcbiAgICAgICAgY29uc3QgcHJlY2lzaW9uID0gZ2V0U3RvcFByZWNpc2lvbihicmVha3MpO1xuICAgICAgICBjb25zdCBjb25maWcgPSB7IG1pbiwgbWF4LCBicmVha3MsIHByZWNpc2lvbiB9O1xuICAgICAgICBpZiAoIXRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlcikge1xuICAgICAgICAgICAgdGhpcy5jbGFzc0JyZWFrc0NvbG9yU2xpZGVyID0gbmV3IG1vZHVsZXMuQ2xhc3NlZENvbG9yU2xpZGVyKGNvbmZpZyk7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZWNsYXNzQnJlYWtzQ29sb3JTbGlkZXJDaGFuZ2VFdmVudHMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlci5zZXQoY29uZmlnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNEZWZpbmVkKHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlcik7XG4gICAgfVxuICAgIGFmdGVyQ2xhc3NCcmVha3NDb2xvclNsaWRlckNyZWF0ZShub2RlKSB7XG4gICAgICAgIGlmICghdGhpcy5jbGFzc0JyZWFrc0NvbG9yU2xpZGVyLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgY29uc3QgZGl2Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICBub2RlLmFwcGVuZChkaXZOb2RlKTtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlci5jb250YWluZXIgPSBkaXZOb2RlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZWNsYXNzQnJlYWtzQ29sb3JTbGlkZXJDaGFuZ2VFdmVudHMoKSB7XG4gICAgICAgIGNvbnN0IHsgbGF5ZXI6IHNtTGF5ZXIgfSA9IHNtYXJ0TWFwcGluZ1N0YXRlO1xuICAgICAgICBjb25zdCBsYXllciA9IHNtTGF5ZXI7XG4gICAgICAgIGlmICghdGhpcy5jbGFzc0JyZWFrc0NvbG9yU2xpZGVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbGFzc0JyZWFrc0NvbG9yU2xpZGVyLm9uKFwibWluLWNoYW5nZVwiLCAoaW5mbykgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyZXIgPSBsYXllci5yZW5kZXJlcjtcbiAgICAgICAgICAgIGNvbnN0IGluZm9zID0gcmVuZGVyZXIuY2xhc3NCcmVha0luZm9zO1xuICAgICAgICAgICAgaWYgKGluZm8udmFsdWUgPiBpbmZvc1swXS5tYXhWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlTWluTWF4Q2hhbmdlKGluZm9zWzBdLm1heFZhbHVlLCBpbmZvc1tpbmZvcy5sZW5ndGggLSAxXS5tYXhWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZU1pbk1heENoYW5nZShpbmZvLnZhbHVlLCBpbmZvc1tpbmZvcy5sZW5ndGggLSAxXS5tYXhWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNsYXNzQnJlYWtzQ29sb3JTbGlkZXIub24oXCJtYXgtY2hhbmdlXCIsIChpbmZvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJlciA9IGxheWVyLnJlbmRlcmVyO1xuICAgICAgICAgICAgY29uc3QgaW5mb3MgPSByZW5kZXJlci5jbGFzc0JyZWFrSW5mb3M7XG4gICAgICAgICAgICBpZiAoaW5mby52YWx1ZSA8IGluZm9zW2luZm9zLmxlbmd0aCAtIDFdLm1pblZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVNaW5NYXhDaGFuZ2UoaW5mb3NbMF0ubWluVmFsdWUsIGluZm9zW2luZm9zLmxlbmd0aCAtIDFdLm1pblZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlTWluTWF4Q2hhbmdlKGluZm9zWzBdLm1pblZhbHVlLCBpbmZvLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlci5vbihcInRodW1iLWNoYW5nZVwiLCAoKSA9PiB0aGlzLnVwZGF0ZVJlbmRlcmVyQnJlYWtzKHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlci5icmVha3MpKTtcbiAgICAgICAgdGhpcy5jbGFzc0JyZWFrc0NvbG9yU2xpZGVyLm9uKFwidGh1bWItZHJhZ1wiLCAoKSA9PiB0aGlzLnVwZGF0ZVJlbmRlcmVyQnJlYWtzKHRoaXMuY2xhc3NCcmVha3NDb2xvclNsaWRlci5icmVha3MpKTtcbiAgICB9XG4gICAgaGFuZGxlSW52ZXJ0U2xpZGVyKCkge1xuICAgICAgICBjb25zdCB7IGxheWVyOiBzbUxheWVyLCBtb2R1bGVzIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSBzbUxheWVyO1xuICAgICAgICBjb25zdCByZW5kZXJlciA9IGxheWVyLnJlbmRlcmVyO1xuICAgICAgICBsZXQgY29sb3JzID0gcmVuZGVyZXIuY2xhc3NCcmVha0luZm9zLm1hcCgoY2xhc3NCcmVha0luZm8pID0+IHtcbiAgICAgICAgICAgIHJldHVybiAoZ2V0U3ltYm9sQ29sb3IoY2xhc3NCcmVha0luZm8uc3ltYm9sKSB8fFxuICAgICAgICAgICAgICAgIG5ldyBtb2R1bGVzLmVzcmlDb2xvcih7IHI6IDY0LCBnOiA2NCwgYjogNjQsIGE6IDEgfSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29sb3JzID0gY29sb3JzLnJldmVyc2UoKTtcbiAgICAgICAgcmVuZGVyZXIuY2xhc3NCcmVha0luZm9zLm1hcCgoY2xhc3NCcmVha0luZm8sIGlkeCkgPT4ge1xuICAgICAgICAgICAgaWYgKGdldFN5bWJvbENvbG9yKGNsYXNzQnJlYWtJbmZvLnN5bWJvbCkpIHtcbiAgICAgICAgICAgICAgICBhcHBseVN5bWJvbENvbG9yKGNsYXNzQnJlYWtJbmZvLnN5bWJvbCwgY29sb3JzW2lkeF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdXBkYXRlUmVuZGVyZXIoKTtcbiAgICAgICAgdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbGFzc0JyZWFrc0NvbG9yU2xpZGVyQ2hhbmdlLmVtaXQoeyBpbnZlcnRDb2xvcnM6IHRydWUgfSk7XG4gICAgfVxuICAgIGhhbmRsZU1pbk1heENoYW5nZShtaW4sIG1heCkge1xuICAgICAgICBjb25zdCB7IGxheWVyOiBzbUxheWVyIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSBzbUxheWVyO1xuICAgICAgICBjb25zdCByZW5kZXJlciA9IGxheWVyLnJlbmRlcmVyO1xuICAgICAgICBsZXQgbWluQ2xhc3NCcmVhayA9IHJlbmRlcmVyLmNsYXNzQnJlYWtJbmZvc1swXTtcbiAgICAgICAgbGV0IG1heENsYXNzQnJlYWsgPSByZW5kZXJlci5jbGFzc0JyZWFrSW5mb3NbcmVuZGVyZXIuY2xhc3NCcmVha0luZm9zLmxlbmd0aCAtIDFdO1xuICAgICAgICBtaW5DbGFzc0JyZWFrLm1pblZhbHVlID0gbWluO1xuICAgICAgICBtaW5DbGFzc0JyZWFrLmxhYmVsID0gYCR7bWluQ2xhc3NCcmVhay5taW5WYWx1ZS50b0xvY2FsZVN0cmluZygpfSAtICR7bWluQ2xhc3NCcmVhay5tYXhWYWx1ZS50b0xvY2FsZVN0cmluZygpfWA7XG4gICAgICAgIG1heENsYXNzQnJlYWsubWF4VmFsdWUgPSBtYXg7XG4gICAgICAgIG1heENsYXNzQnJlYWsubGFiZWwgPSBgJHttYXhDbGFzc0JyZWFrLm1pblZhbHVlLnRvTG9jYWxlU3RyaW5nKCl9IC0gJHttYXhDbGFzc0JyZWFrLm1heFZhbHVlLnRvTG9jYWxlU3RyaW5nKCl9YDtcbiAgICAgICAgdXBkYXRlUmVuZGVyZXIoKTtcbiAgICAgICAgdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbGFzc0JyZWFrc0NvbG9yU2xpZGVyQ2hhbmdlLmVtaXQoeyB1cGRhdGVWYWx1ZXM6IHRydWUgfSk7XG4gICAgfVxuICAgIHVwZGF0ZVJlbmRlcmVyQnJlYWtzKGJyZWFrcykge1xuICAgICAgICBjb25zdCB7IGxheWVyOiBzbUxheWVyIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSBzbUxheWVyO1xuICAgICAgICBjb25zdCByZW5kZXJlciA9IGxheWVyLnJlbmRlcmVyO1xuICAgICAgICByZW5kZXJlci5jbGFzc0JyZWFrSW5mb3MuZm9yRWFjaCgoY2xhc3NCcmVha0luZm8sIGlkeCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNsYXNzQnJlYWtJbmZvLm1pblZhbHVlICE9PSBicmVha3NbaWR4XS5taW4gfHxcbiAgICAgICAgICAgICAgICBjbGFzc0JyZWFrSW5mby5tYXhWYWx1ZSAhPT0gYnJlYWtzW2lkeF0ubWF4KSB7XG4gICAgICAgICAgICAgICAgY2xhc3NCcmVha0luZm8ubWluVmFsdWUgPSBicmVha3NbaWR4XS5taW47XG4gICAgICAgICAgICAgICAgY2xhc3NCcmVha0luZm8ubWF4VmFsdWUgPSBicmVha3NbaWR4XS5tYXg7XG4gICAgICAgICAgICAgICAgY2xhc3NCcmVha0luZm8ubGFiZWwgPSBgJHtjbGFzc0JyZWFrSW5mby5taW5WYWx1ZS50b0xvY2FsZVN0cmluZygpfSAtICR7Y2xhc3NCcmVha0luZm8ubWF4VmFsdWUudG9Mb2NhbGVTdHJpbmcoKX1gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdXBkYXRlUmVuZGVyZXIoKTtcbiAgICAgICAgdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbGFzc0JyZWFrc0NvbG9yU2xpZGVyQ2hhbmdlLmVtaXQoeyB1cGRhdGVWYWx1ZXM6IHRydWUgfSk7XG4gICAgfVxuICAgIGdldCBob3N0RWxlbWVudCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5BcmNnaXNTbWFydE1hcHBpbmdDbGFzc0JyZWFrc0NvbG9yU2xpZGVyLnN0eWxlID0gYXJjZ2lzU21hcnRNYXBwaW5nQ2xhc3NCcmVha3NDb2xvclNsaWRlckNzcztcblxuZXhwb3J0IHsgQXJjZ2lzU21hcnRNYXBwaW5nQ2xhc3NCcmVha3NDb2xvclNsaWRlciBhcyBhcmNnaXNfc21hcnRfbWFwcGluZ19jbGFzc19icmVha3NfY29sb3Jfc2xpZGVyIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFyY2dpcy1zbWFydC1tYXBwaW5nLWNsYXNzLWJyZWFrcy1jb2xvci1zbGlkZXIuZW50cnkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9