"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-86449a"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js":
/*!**************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addItemState),
/* harmony export */   b: () => (/* binding */ addItemUrlState),
/* harmony export */   c: () => (/* binding */ addItemRequestState),
/* harmony export */   d: () => (/* binding */ addItemStore)
/* harmony export */ });
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const addItemStore = (0,_index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__.c)({
    typeKeywords: [],
    customParameters: [],
    analyzedLocationTypes: [],
    allowStoredAuth: true,
    isSecured: null,
    checkAuth: false
});
// Entire add item state object
const addItemState = addItemStore.state;
// Subsets of add item state
const addItemRequestState = addItemStore.state;
const addItemUrlState = addItemStore.state;



//# sourceMappingURL=add-item-dbbe2f57.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-summary.entry.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-summary.entry.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_feature_layer_summary: () => (/* binding */ ArcgisNewItemPagesFeatureLayerSummary)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/* harmony import */ var _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui-bca7bcd1.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js");
/* harmony import */ var _feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./feature-layer-58e18b03.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */







const arcgisNewItemPagesFeatureLayerSummaryCss = ".info-container{padding-bottom:1.5rem}.layer-description{display:block;margin-bottom:1.5rem}.details{display:block;padding-bottom:0.5rem}.deselect-button{margin-top:1.5rem;margin-bottom:1rem}arcgis-new-item-layer-summary-item+arcgis-new-item-layer-summary-item{border-top:none}";

const ArcgisNewItemPagesFeatureLayerSummary = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.newItemUpdatePage = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
        this.featureLayerInfos = [];
        this.selectAll = () => {
            const selectedLayerInfoNames = {};
            this.featureLayerInfos.forEach((info) => {
                selectedLayerInfoNames[info.name] = true;
            });
            this.selectedLayerInfoNames = selectedLayerInfoNames;
        };
        this.deselectAll = () => {
            this.selectedLayerInfoNames = {};
        };
        this.selectOrDeselectLayer = (layerName, selected) => {
            if (selected) {
                this.selectedLayerInfoNames[layerName] = true;
            }
            else {
                delete this.selectedLayerInfoNames[layerName];
            }
            this.selectedLayerInfoNames = Object.assign({}, this.selectedLayerInfoNames);
        };
        this.selectedLayerInfoNames = {};
        this.alertInfo = undefined;
    }
    handleNext() {
        const { selectedLayerInfoNames, featureLayerInfos } = this;
        if (!Object.keys(selectedLayerInfoNames).some((name) => selectedLayerInfoNames[name] === true)) {
            (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_3__.f)("No layer chosen");
            this.setAlertMessage("noLayer");
            return;
        }
        _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.selectedServiceInfoLayersNames = Object.assign({}, selectedLayerInfoNames);
        const layerChosen = featureLayerInfos.some((info) => info.type !== "Table" && selectedLayerInfoNames[info.name]);
        this.newItemUpdatePage.emit(layerChosen ? "featureLayerPreference" : "itemProperties");
    }
    async componentWillLoad() {
        const { serviceInfo, selectedServiceInfoLayersNames, addFeatureLayerType } = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a;
        const { i18n } = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_2__.u;
        this.addCreateI18n = i18n;
        this.i18n = i18n.featureLayerSummary;
        this.creationType = addFeatureLayerType;
        this.layerName = (serviceInfo === null || serviceInfo === void 0 ? void 0 : serviceInfo.name) || _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.sourceTitle;
        const featureServiceInfo = serviceInfo;
        this.featureLayerInfos = [...featureServiceInfo.layers, ...featureServiceInfo.tables].sort((infoA, infoB) => infoA.id - infoB.id);
        let newSelectedLayerInfoNames = {};
        if (selectedServiceInfoLayersNames) {
            // This means we're going back from the next screen
            newSelectedLayerInfoNames = Object.assign({}, selectedServiceInfoLayersNames);
        }
        else {
            this.featureLayerInfos.forEach((info) => {
                newSelectedLayerInfoNames[info.name] = true;
            });
        }
        this.selectedLayerInfoNames = newSelectedLayerInfoNames;
    }
    setAlertMessage(type) {
        this.alertInfo = this.i18n.error[type];
    }
    render() {
        const { i18n, addCreateI18n, selectedLayerInfoNames, featureLayerInfos, alertInfo, creationType, layerName, selectAll, deselectAll, selectOrDeselectLayer } = this;
        const multipleLayers = featureLayerInfos.length > 1;
        const featureLayerI18n = addCreateI18n.featureLayer;
        const allowSelectAll = Object.keys(selectedLayerInfoNames).length <= 0;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-description", { class: "layer-description", header: featureLayerI18n.creationType[creationType], content: layerName, leadingIconInfo: { icon: "featureLayer", scale: "s" } }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-description", { header: i18n.layerDetails, content: multipleLayers ? i18n.deselectAnyLayers : "", class: "details" }), multipleLayers && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { kind: "neutral", class: "deselect-button", onClick: allowSelectAll ? selectAll : deselectAll }, allowSelectAll ? i18n.selectAll : i18n.deselectAll)), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "info-container" }, featureLayerInfos === null || featureLayerInfos === void 0 ? void 0 : featureLayerInfos.map((layer, index) => ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-layer-summary-item", { key: index, layerInfo: layer, translatedLayerType: featureLayerI18n.type, translatedFieldType: addCreateI18n.fieldType, selected: selectedLayerInfoNames[layer.name], hideSelect: !multipleLayers, onLayerSelectionChange: (event) => {
                selectOrDeselectLayer(layer.name, event.detail);
            }, onExpand: (event) => {
                const { expanded } = event.detail;
                if (expanded) {
                    (0,_feature_layer_58e18b03_js__WEBPACK_IMPORTED_MODULE_3__.i)("layer");
                }
            } })))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { heading: alertInfo === null || alertInfo === void 0 ? void 0 : alertInfo.title, description: alertInfo === null || alertInfo === void 0 ? void 0 : alertInfo.description, active: !!alertInfo, onAlertDismiss: () => (this.alertInfo = null) })));
    }
    get el() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisNewItemPagesFeatureLayerSummary.style = arcgisNewItemPagesFeatureLayerSummaryCss;



//# sourceMappingURL=arcgis-new-item-pages-feature-layer-summary.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ configState),
/* harmony export */   o: () => (/* binding */ onConfigChange)
/* harmony export */ });
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const configStore = (0,_index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__.c)({
    portal: null,
    user: null,
    api: 4,
    scale: "m"
});
const configState = configStore.state;
const onConfigChange = configStore.onChange;



//# sourceMappingURL=config-75adf962.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js":
/*!*******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-58e18b03.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ featureServiceEndTelemetry),
/* harmony export */   b: () => (/* binding */ filterChangeTelemetry),
/* harmony export */   c: () => (/* binding */ featureLayerTypeTelemetry),
/* harmony export */   e: () => (/* binding */ enableLayerPreferenceTelemetry),
/* harmony export */   f: () => (/* binding */ featureLayerErrorTelemetry),
/* harmony export */   i: () => (/* binding */ itemExpandedTelemetry)
/* harmony export */ });
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



const TELEMETRY_ID = "create feature layer";
const TELEMETRY_PAGE_NAME = "my content";
const addFeatureLayerTypeToTelemetry = (type) => {
    switch (type) {
        case "build":
            return "blank";
        case "existing":
            return "fs";
        case "template":
            return "template";
        case "link":
            return "url";
    }
};
const enableLayerPreferenceTelemetry = (type) => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `enable ${type === "captureGPS" ? "gps" : type === "enableZDefaults" ? "z" : "m"}`, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const itemExpandedTelemetry = (type) => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `expand ${type} details`, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const filterChangeTelemetry = () => {
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "filter", {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME
    });
};
const featureLayerTypeTelemetry = (type) => {
    const telemetryType = addFeatureLayerTypeToTelemetry(type);
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "from option", {
        category: TELEMETRY_ID,
        attribute: telemetryType,
        pageName: TELEMETRY_PAGE_NAME
    });
};
const featureServiceEndTelemetry = () => {
    const { addFeatureLayerType, serviceInfo } = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a;
    const featureLayerServiceInfo = serviceInfo;
    const telemetry = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
    telemetry === null || telemetry === void 0 ? void 0 : telemetry.endWorkflow(TELEMETRY_ID, {
        category: TELEMETRY_ID,
        attribute: addFeatureLayerTypeToTelemetry(addFeatureLayerType),
        pageName: TELEMETRY_PAGE_NAME,
        count: featureLayerServiceInfo.layers.length,
        number: featureLayerServiceInfo.tables.length
    });
};
const featureLayerErrorTelemetry = (errString) => {
    var _a;
    (_a = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry) === null || _a === void 0 ? void 0 : _a.logError({
        category: TELEMETRY_ID,
        error: errString
    });
};



//# sourceMappingURL=feature-layer-58e18b03.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createStore)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const appendToMap = (map, propName, value) => {
    const items = map.get(propName);
    if (!items) {
        map.set(propName, [value]);
    }
    else if (!items.includes(value)) {
        items.push(value);
    }
};
const debounce = (fn, ms) => {
    let timeoutId;
    return (...args) => {
        if (timeoutId) {
            clearTimeout(timeoutId);
        }
        timeoutId = setTimeout(() => {
            timeoutId = 0;
            fn(...args);
        }, ms);
    };
};

/**
 * Check if a possible element isConnected.
 * The property might not be there, so we check for it.
 *
 * We want it to return true if isConnected is not a property,
 * otherwise we would remove these elements and would not update.
 *
 * Better leak in Edge than to be useless.
 */
const isConnected = (maybeElement) => !('isConnected' in maybeElement) || maybeElement.isConnected;
const cleanupElements = debounce((map) => {
    for (let key of map.keys()) {
        map.set(key, map.get(key).filter(isConnected));
    }
}, 2000);
const stencilSubscription = () => {
    if (typeof _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.g !== 'function') {
        // If we are not in a stencil project, we do nothing.
        // This function is not really exported by @stencil/core.
        return {};
    }
    const elmsToUpdate = new Map();
    return {
        dispose: () => elmsToUpdate.clear(),
        get: (propName) => {
            const elm = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.g)();
            if (elm) {
                appendToMap(elmsToUpdate, propName, elm);
            }
        },
        set: (propName) => {
            const elements = elmsToUpdate.get(propName);
            if (elements) {
                elmsToUpdate.set(propName, elements.filter(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.f));
            }
            cleanupElements(elmsToUpdate);
        },
        reset: () => {
            elmsToUpdate.forEach((elms) => elms.forEach(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.f));
            cleanupElements(elmsToUpdate);
        },
    };
};

const unwrap = (val) => (typeof val === 'function' ? val() : val);
const createObservableMap = (defaultState, shouldUpdate = (a, b) => a !== b) => {
    const unwrappedState = unwrap(defaultState);
    let states = new Map(Object.entries(unwrappedState !== null && unwrappedState !== void 0 ? unwrappedState : {}));
    const handlers = {
        dispose: [],
        get: [],
        set: [],
        reset: [],
    };
    const reset = () => {
        var _a;
        // When resetting the state, the default state may be a function - unwrap it to invoke it.
        // otherwise, the state won't be properly reset
        states = new Map(Object.entries((_a = unwrap(defaultState)) !== null && _a !== void 0 ? _a : {}));
        handlers.reset.forEach((cb) => cb());
    };
    const dispose = () => {
        // Call first dispose as resetting the state would
        // cause less updates ;)
        handlers.dispose.forEach((cb) => cb());
        reset();
    };
    const get = (propName) => {
        handlers.get.forEach((cb) => cb(propName));
        return states.get(propName);
    };
    const set = (propName, value) => {
        const oldValue = states.get(propName);
        if (shouldUpdate(value, oldValue, propName)) {
            states.set(propName, value);
            handlers.set.forEach((cb) => cb(propName, value, oldValue));
        }
    };
    const state = (typeof Proxy === 'undefined'
        ? {}
        : new Proxy(unwrappedState, {
            get(_, propName) {
                return get(propName);
            },
            ownKeys(_) {
                return Array.from(states.keys());
            },
            getOwnPropertyDescriptor() {
                return {
                    enumerable: true,
                    configurable: true,
                };
            },
            has(_, propName) {
                return states.has(propName);
            },
            set(_, propName, value) {
                set(propName, value);
                return true;
            },
        }));
    const on = (eventName, callback) => {
        handlers[eventName].push(callback);
        return () => {
            removeFromArray(handlers[eventName], callback);
        };
    };
    const onChange = (propName, cb) => {
        const unSet = on('set', (key, newValue) => {
            if (key === propName) {
                cb(newValue);
            }
        });
        // We need to unwrap the defaultState because it might be a function.
        // Otherwise we might not be sending the right reset value.
        const unReset = on('reset', () => cb(unwrap(defaultState)[propName]));
        return () => {
            unSet();
            unReset();
        };
    };
    const use = (...subscriptions) => {
        const unsubs = subscriptions.reduce((unsubs, subscription) => {
            if (subscription.set) {
                unsubs.push(on('set', subscription.set));
            }
            if (subscription.get) {
                unsubs.push(on('get', subscription.get));
            }
            if (subscription.reset) {
                unsubs.push(on('reset', subscription.reset));
            }
            if (subscription.dispose) {
                unsubs.push(on('dispose', subscription.dispose));
            }
            return unsubs;
        }, []);
        return () => unsubs.forEach((unsub) => unsub());
    };
    const forceUpdate = (key) => {
        const oldValue = states.get(key);
        handlers.set.forEach((cb) => cb(key, oldValue, oldValue));
    };
    return {
        state,
        get,
        set,
        on,
        onChange,
        use,
        dispose,
        reset,
        forceUpdate,
    };
};
const removeFromArray = (array, item) => {
    const index = array.indexOf(item);
    if (index >= 0) {
        array[index] = array[array.length - 1];
        array.length--;
    }
};

const createStore = (defaultState, shouldUpdate) => {
    const map = createObservableMap(defaultState, shouldUpdate);
    map.use(stencilSubscription());
    return map;
};



//# sourceMappingURL=index-05956cab.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js":
/*!********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ uiStore),
/* harmony export */   u: () => (/* binding */ uiStoreState)
/* harmony export */ });
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const uiStore = (0,_index_05956cab_js__WEBPACK_IMPORTED_MODULE_0__.c)({
    nextText: "next",
    workflow: "content",
    scale: "m",
    disableScroll: false,
    featureFlags: {}
});
const uiStoreState = uiStore.state;



//# sourceMappingURL=ui-bca7bcd1.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTg2NDQ5YS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ3VEOztBQUV2RCxxQkFBcUIscURBQVc7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWdHOztBQUVoRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDNkc7QUFDbEQ7QUFDTjtBQUNxRDtBQUM3RTtBQUNDOztBQUU5QixrRUFBa0Usc0JBQXNCLG1CQUFtQixjQUFjLHFCQUFxQixTQUFTLGNBQWMsc0JBQXNCLGlCQUFpQixrQkFBa0IsbUJBQW1CLHNFQUFzRSxnQkFBZ0I7O0FBRXZVO0FBQ0E7QUFDQSxRQUFRLHFEQUFnQjtBQUN4QixpQ0FBaUMscURBQVc7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQ7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw0Q0FBNEM7QUFDNUQ7QUFDQSxZQUFZLDZEQUEwQjtBQUN0QztBQUNBO0FBQ0E7QUFDQSxRQUFRLG9EQUFZLGtEQUFrRDtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixtRUFBbUUsRUFBRSxvREFBWTtBQUNqRyxnQkFBZ0IsT0FBTyxFQUFFLDhDQUFZO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLHlHQUF5RyxvREFBWTtBQUNySDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdEO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNB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QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU0Qjs7QUFFNUI7Ozs7Ozs7Ozs7Ozs7Ozs7QUN2TUE7QUFDQTtBQUNBO0FBQ0E7QUFDdUQ7O0FBRXZELGdCQUFnQixxREFBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUUyQzs7QUFFM0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hZGQtaXRlbS1kYmJlMmY1Ny5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtbmV3LWl0ZW0tcGFnZXMtZmVhdHVyZS1sYXllci1zdW1tYXJ5LmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2NvbmZpZy03NWFkZjk2Mi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9mZWF0dXJlLWxheWVyLTU4ZTE4YjAzLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2luZGV4LTA1OTU2Y2FiLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL3VpLWJjYTdiY2QxLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVTdG9yZSB9IGZyb20gJy4vaW5kZXgtMDU5NTZjYWIuanMnO1xuXG5jb25zdCBhZGRJdGVtU3RvcmUgPSBjcmVhdGVTdG9yZSh7XG4gICAgdHlwZUtleXdvcmRzOiBbXSxcbiAgICBjdXN0b21QYXJhbWV0ZXJzOiBbXSxcbiAgICBhbmFseXplZExvY2F0aW9uVHlwZXM6IFtdLFxuICAgIGFsbG93U3RvcmVkQXV0aDogdHJ1ZSxcbiAgICBpc1NlY3VyZWQ6IG51bGwsXG4gICAgY2hlY2tBdXRoOiBmYWxzZVxufSk7XG4vLyBFbnRpcmUgYWRkIGl0ZW0gc3RhdGUgb2JqZWN0XG5jb25zdCBhZGRJdGVtU3RhdGUgPSBhZGRJdGVtU3RvcmUuc3RhdGU7XG4vLyBTdWJzZXRzIG9mIGFkZCBpdGVtIHN0YXRlXG5jb25zdCBhZGRJdGVtUmVxdWVzdFN0YXRlID0gYWRkSXRlbVN0b3JlLnN0YXRlO1xuY29uc3QgYWRkSXRlbVVybFN0YXRlID0gYWRkSXRlbVN0b3JlLnN0YXRlO1xuXG5leHBvcnQgeyBhZGRJdGVtU3RhdGUgYXMgYSwgYWRkSXRlbVVybFN0YXRlIGFzIGIsIGFkZEl0ZW1SZXF1ZXN0U3RhdGUgYXMgYywgYWRkSXRlbVN0b3JlIGFzIGQgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWRkLWl0ZW0tZGJiZTJmNTcuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCwgZCBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC1lM2JmN2RhNy5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tZGJiZTJmNTcuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWJjYTdiY2QxLmpzJztcbmltcG9ydCB7IGYgYXMgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnksIGkgYXMgaXRlbUV4cGFuZGVkVGVsZW1ldHJ5IH0gZnJvbSAnLi9mZWF0dXJlLWxheWVyLTU4ZTE4YjAzLmpzJztcbmltcG9ydCAnLi9pbmRleC0wNTk1NmNhYi5qcyc7XG5pbXBvcnQgJy4vY29uZmlnLTc1YWRmOTYyLmpzJztcblxuY29uc3QgYXJjZ2lzTmV3SXRlbVBhZ2VzRmVhdHVyZUxheWVyU3VtbWFyeUNzcyA9IFwiLmluZm8tY29udGFpbmVye3BhZGRpbmctYm90dG9tOjEuNXJlbX0ubGF5ZXItZGVzY3JpcHRpb257ZGlzcGxheTpibG9jazttYXJnaW4tYm90dG9tOjEuNXJlbX0uZGV0YWlsc3tkaXNwbGF5OmJsb2NrO3BhZGRpbmctYm90dG9tOjAuNXJlbX0uZGVzZWxlY3QtYnV0dG9ue21hcmdpbi10b3A6MS41cmVtO21hcmdpbi1ib3R0b206MXJlbX1hcmNnaXMtbmV3LWl0ZW0tbGF5ZXItc3VtbWFyeS1pdGVtK2FyY2dpcy1uZXctaXRlbS1sYXllci1zdW1tYXJ5LWl0ZW17Ym9yZGVyLXRvcDpub25lfVwiO1xuXG5jb25zdCBBcmNnaXNOZXdJdGVtUGFnZXNGZWF0dXJlTGF5ZXJTdW1tYXJ5ID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy5uZXdJdGVtVXBkYXRlUGFnZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwibmV3SXRlbVVwZGF0ZVBhZ2VcIiwgNyk7XG4gICAgICAgIHRoaXMuZmVhdHVyZUxheWVySW5mb3MgPSBbXTtcbiAgICAgICAgdGhpcy5zZWxlY3RBbGwgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZExheWVySW5mb05hbWVzID0ge307XG4gICAgICAgICAgICB0aGlzLmZlYXR1cmVMYXllckluZm9zLmZvckVhY2goKGluZm8pID0+IHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZExheWVySW5mb05hbWVzW2luZm8ubmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTGF5ZXJJbmZvTmFtZXMgPSBzZWxlY3RlZExheWVySW5mb05hbWVzO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmRlc2VsZWN0QWxsID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZExheWVySW5mb05hbWVzID0ge307XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2VsZWN0T3JEZXNlbGVjdExheWVyID0gKGxheWVyTmFtZSwgc2VsZWN0ZWQpID0+IHtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMYXllckluZm9OYW1lc1tsYXllck5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNlbGVjdGVkTGF5ZXJJbmZvTmFtZXNbbGF5ZXJOYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMYXllckluZm9OYW1lcyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuc2VsZWN0ZWRMYXllckluZm9OYW1lcyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRMYXllckluZm9OYW1lcyA9IHt9O1xuICAgICAgICB0aGlzLmFsZXJ0SW5mbyA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaGFuZGxlTmV4dCgpIHtcbiAgICAgICAgY29uc3QgeyBzZWxlY3RlZExheWVySW5mb05hbWVzLCBmZWF0dXJlTGF5ZXJJbmZvcyB9ID0gdGhpcztcbiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhzZWxlY3RlZExheWVySW5mb05hbWVzKS5zb21lKChuYW1lKSA9PiBzZWxlY3RlZExheWVySW5mb05hbWVzW25hbWVdID09PSB0cnVlKSkge1xuICAgICAgICAgICAgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnkoXCJObyBsYXllciBjaG9zZW5cIik7XG4gICAgICAgICAgICB0aGlzLnNldEFsZXJ0TWVzc2FnZShcIm5vTGF5ZXJcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYWRkSXRlbVN0YXRlLnNlbGVjdGVkU2VydmljZUluZm9MYXllcnNOYW1lcyA9IE9iamVjdC5hc3NpZ24oe30sIHNlbGVjdGVkTGF5ZXJJbmZvTmFtZXMpO1xuICAgICAgICBjb25zdCBsYXllckNob3NlbiA9IGZlYXR1cmVMYXllckluZm9zLnNvbWUoKGluZm8pID0+IGluZm8udHlwZSAhPT0gXCJUYWJsZVwiICYmIHNlbGVjdGVkTGF5ZXJJbmZvTmFtZXNbaW5mby5uYW1lXSk7XG4gICAgICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UuZW1pdChsYXllckNob3NlbiA/IFwiZmVhdHVyZUxheWVyUHJlZmVyZW5jZVwiIDogXCJpdGVtUHJvcGVydGllc1wiKTtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIGNvbnN0IHsgc2VydmljZUluZm8sIHNlbGVjdGVkU2VydmljZUluZm9MYXllcnNOYW1lcywgYWRkRmVhdHVyZUxheWVyVHlwZSB9ID0gYWRkSXRlbVN0YXRlO1xuICAgICAgICBjb25zdCB7IGkxOG4gfSA9IHVpU3RvcmVTdGF0ZTtcbiAgICAgICAgdGhpcy5hZGRDcmVhdGVJMThuID0gaTE4bjtcbiAgICAgICAgdGhpcy5pMThuID0gaTE4bi5mZWF0dXJlTGF5ZXJTdW1tYXJ5O1xuICAgICAgICB0aGlzLmNyZWF0aW9uVHlwZSA9IGFkZEZlYXR1cmVMYXllclR5cGU7XG4gICAgICAgIHRoaXMubGF5ZXJOYW1lID0gKHNlcnZpY2VJbmZvID09PSBudWxsIHx8IHNlcnZpY2VJbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZXJ2aWNlSW5mby5uYW1lKSB8fCBhZGRJdGVtU3RhdGUuc291cmNlVGl0bGU7XG4gICAgICAgIGNvbnN0IGZlYXR1cmVTZXJ2aWNlSW5mbyA9IHNlcnZpY2VJbmZvO1xuICAgICAgICB0aGlzLmZlYXR1cmVMYXllckluZm9zID0gWy4uLmZlYXR1cmVTZXJ2aWNlSW5mby5sYXllcnMsIC4uLmZlYXR1cmVTZXJ2aWNlSW5mby50YWJsZXNdLnNvcnQoKGluZm9BLCBpbmZvQikgPT4gaW5mb0EuaWQgLSBpbmZvQi5pZCk7XG4gICAgICAgIGxldCBuZXdTZWxlY3RlZExheWVySW5mb05hbWVzID0ge307XG4gICAgICAgIGlmIChzZWxlY3RlZFNlcnZpY2VJbmZvTGF5ZXJzTmFtZXMpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgbWVhbnMgd2UncmUgZ29pbmcgYmFjayBmcm9tIHRoZSBuZXh0IHNjcmVlblxuICAgICAgICAgICAgbmV3U2VsZWN0ZWRMYXllckluZm9OYW1lcyA9IE9iamVjdC5hc3NpZ24oe30sIHNlbGVjdGVkU2VydmljZUluZm9MYXllcnNOYW1lcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZlYXR1cmVMYXllckluZm9zLmZvckVhY2goKGluZm8pID0+IHtcbiAgICAgICAgICAgICAgICBuZXdTZWxlY3RlZExheWVySW5mb05hbWVzW2luZm8ubmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZWxlY3RlZExheWVySW5mb05hbWVzID0gbmV3U2VsZWN0ZWRMYXllckluZm9OYW1lcztcbiAgICB9XG4gICAgc2V0QWxlcnRNZXNzYWdlKHR5cGUpIHtcbiAgICAgICAgdGhpcy5hbGVydEluZm8gPSB0aGlzLmkxOG4uZXJyb3JbdHlwZV07XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBpMThuLCBhZGRDcmVhdGVJMThuLCBzZWxlY3RlZExheWVySW5mb05hbWVzLCBmZWF0dXJlTGF5ZXJJbmZvcywgYWxlcnRJbmZvLCBjcmVhdGlvblR5cGUsIGxheWVyTmFtZSwgc2VsZWN0QWxsLCBkZXNlbGVjdEFsbCwgc2VsZWN0T3JEZXNlbGVjdExheWVyIH0gPSB0aGlzO1xuICAgICAgICBjb25zdCBtdWx0aXBsZUxheWVycyA9IGZlYXR1cmVMYXllckluZm9zLmxlbmd0aCA+IDE7XG4gICAgICAgIGNvbnN0IGZlYXR1cmVMYXllckkxOG4gPSBhZGRDcmVhdGVJMThuLmZlYXR1cmVMYXllcjtcbiAgICAgICAgY29uc3QgYWxsb3dTZWxlY3RBbGwgPSBPYmplY3Qua2V5cyhzZWxlY3RlZExheWVySW5mb05hbWVzKS5sZW5ndGggPD0gMDtcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhcmNnaXMtbmV3LWl0ZW0tZGVzY3JpcHRpb25cIiwgeyBjbGFzczogXCJsYXllci1kZXNjcmlwdGlvblwiLCBoZWFkZXI6IGZlYXR1cmVMYXllckkxOG4uY3JlYXRpb25UeXBlW2NyZWF0aW9uVHlwZV0sIGNvbnRlbnQ6IGxheWVyTmFtZSwgbGVhZGluZ0ljb25JbmZvOiB7IGljb246IFwiZmVhdHVyZUxheWVyXCIsIHNjYWxlOiBcInNcIiB9IH0pLCBoKFwiYXJjZ2lzLW5ldy1pdGVtLWRlc2NyaXB0aW9uXCIsIHsgaGVhZGVyOiBpMThuLmxheWVyRGV0YWlscywgY29udGVudDogbXVsdGlwbGVMYXllcnMgPyBpMThuLmRlc2VsZWN0QW55TGF5ZXJzIDogXCJcIiwgY2xhc3M6IFwiZGV0YWlsc1wiIH0pLCBtdWx0aXBsZUxheWVycyAmJiAoaChcImNhbGNpdGUtYnV0dG9uXCIsIHsga2luZDogXCJuZXV0cmFsXCIsIGNsYXNzOiBcImRlc2VsZWN0LWJ1dHRvblwiLCBvbkNsaWNrOiBhbGxvd1NlbGVjdEFsbCA/IHNlbGVjdEFsbCA6IGRlc2VsZWN0QWxsIH0sIGFsbG93U2VsZWN0QWxsID8gaTE4bi5zZWxlY3RBbGwgOiBpMThuLmRlc2VsZWN0QWxsKSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJpbmZvLWNvbnRhaW5lclwiIH0sIGZlYXR1cmVMYXllckluZm9zID09PSBudWxsIHx8IGZlYXR1cmVMYXllckluZm9zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmZWF0dXJlTGF5ZXJJbmZvcy5tYXAoKGxheWVyLCBpbmRleCkgPT4gKGgoXCJhcmNnaXMtbmV3LWl0ZW0tbGF5ZXItc3VtbWFyeS1pdGVtXCIsIHsga2V5OiBpbmRleCwgbGF5ZXJJbmZvOiBsYXllciwgdHJhbnNsYXRlZExheWVyVHlwZTogZmVhdHVyZUxheWVySTE4bi50eXBlLCB0cmFuc2xhdGVkRmllbGRUeXBlOiBhZGRDcmVhdGVJMThuLmZpZWxkVHlwZSwgc2VsZWN0ZWQ6IHNlbGVjdGVkTGF5ZXJJbmZvTmFtZXNbbGF5ZXIubmFtZV0sIGhpZGVTZWxlY3Q6ICFtdWx0aXBsZUxheWVycywgb25MYXllclNlbGVjdGlvbkNoYW5nZTogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0T3JEZXNlbGVjdExheWVyKGxheWVyLm5hbWUsIGV2ZW50LmRldGFpbCk7XG4gICAgICAgICAgICB9LCBvbkV4cGFuZDogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBleHBhbmRlZCB9ID0gZXZlbnQuZGV0YWlsO1xuICAgICAgICAgICAgICAgIGlmIChleHBhbmRlZCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtRXhwYW5kZWRUZWxlbWV0cnkoXCJsYXllclwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IH0pKSkpLCBoKFwiYXJjZ2lzLW5ldy1pdGVtLWFsZXJ0XCIsIHsgaGVhZGluZzogYWxlcnRJbmZvID09PSBudWxsIHx8IGFsZXJ0SW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWxlcnRJbmZvLnRpdGxlLCBkZXNjcmlwdGlvbjogYWxlcnRJbmZvID09PSBudWxsIHx8IGFsZXJ0SW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWxlcnRJbmZvLmRlc2NyaXB0aW9uLCBhY3RpdmU6ICEhYWxlcnRJbmZvLCBvbkFsZXJ0RGlzbWlzczogKCkgPT4gKHRoaXMuYWxlcnRJbmZvID0gbnVsbCkgfSkpKTtcbiAgICB9XG4gICAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcbkFyY2dpc05ld0l0ZW1QYWdlc0ZlYXR1cmVMYXllclN1bW1hcnkuc3R5bGUgPSBhcmNnaXNOZXdJdGVtUGFnZXNGZWF0dXJlTGF5ZXJTdW1tYXJ5Q3NzO1xuXG5leHBvcnQgeyBBcmNnaXNOZXdJdGVtUGFnZXNGZWF0dXJlTGF5ZXJTdW1tYXJ5IGFzIGFyY2dpc19uZXdfaXRlbV9wYWdlc19mZWF0dXJlX2xheWVyX3N1bW1hcnkgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXJjZ2lzLW5ldy1pdGVtLXBhZ2VzLWZlYXR1cmUtbGF5ZXItc3VtbWFyeS5lbnRyeS5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IGMgYXMgY3JlYXRlU3RvcmUgfSBmcm9tICcuL2luZGV4LTA1OTU2Y2FiLmpzJztcblxuY29uc3QgY29uZmlnU3RvcmUgPSBjcmVhdGVTdG9yZSh7XG4gICAgcG9ydGFsOiBudWxsLFxuICAgIHVzZXI6IG51bGwsXG4gICAgYXBpOiA0LFxuICAgIHNjYWxlOiBcIm1cIlxufSk7XG5jb25zdCBjb25maWdTdGF0ZSA9IGNvbmZpZ1N0b3JlLnN0YXRlO1xuY29uc3Qgb25Db25maWdDaGFuZ2UgPSBjb25maWdTdG9yZS5vbkNoYW5nZTtcblxuZXhwb3J0IHsgY29uZmlnU3RhdGUgYXMgYywgb25Db25maWdDaGFuZ2UgYXMgbyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25maWctNzVhZGY5NjIuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyBjIGFzIGNvbmZpZ1N0YXRlIH0gZnJvbSAnLi9jb25maWctNzVhZGY5NjIuanMnO1xuaW1wb3J0IHsgYSBhcyBhZGRJdGVtU3RhdGUgfSBmcm9tICcuL2FkZC1pdGVtLWRiYmUyZjU3LmpzJztcblxuY29uc3QgVEVMRU1FVFJZX0lEID0gXCJjcmVhdGUgZmVhdHVyZSBsYXllclwiO1xuY29uc3QgVEVMRU1FVFJZX1BBR0VfTkFNRSA9IFwibXkgY29udGVudFwiO1xuY29uc3QgYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5ID0gKHR5cGUpID0+IHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcImJ1aWxkXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJibGFua1wiO1xuICAgICAgICBjYXNlIFwiZXhpc3RpbmdcIjpcbiAgICAgICAgICAgIHJldHVybiBcImZzXCI7XG4gICAgICAgIGNhc2UgXCJ0ZW1wbGF0ZVwiOlxuICAgICAgICAgICAgcmV0dXJuIFwidGVtcGxhdGVcIjtcbiAgICAgICAgY2FzZSBcImxpbmtcIjpcbiAgICAgICAgICAgIHJldHVybiBcInVybFwiO1xuICAgIH1cbn07XG5jb25zdCBlbmFibGVMYXllclByZWZlcmVuY2VUZWxlbWV0cnkgPSAodHlwZSkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeTtcbiAgICB0ZWxlbWV0cnkgPT09IG51bGwgfHwgdGVsZW1ldHJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZWxlbWV0cnkuc3RlcFdvcmtmbG93KFRFTEVNRVRSWV9JRCwgYGVuYWJsZSAke3R5cGUgPT09IFwiY2FwdHVyZUdQU1wiID8gXCJncHNcIiA6IHR5cGUgPT09IFwiZW5hYmxlWkRlZmF1bHRzXCIgPyBcInpcIiA6IFwibVwifWAsIHtcbiAgICAgICAgY2F0ZWdvcnk6IFRFTEVNRVRSWV9JRCxcbiAgICAgICAgYXR0cmlidXRlOiBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkoYWRkSXRlbVN0YXRlLmFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgICAgICBwYWdlTmFtZTogVEVMRU1FVFJZX1BBR0VfTkFNRVxuICAgIH0pO1xufTtcbmNvbnN0IGl0ZW1FeHBhbmRlZFRlbGVtZXRyeSA9ICh0eXBlKSA9PiB7XG4gICAgY29uc3QgdGVsZW1ldHJ5ID0gY29uZmlnU3RhdGUudGVsZW1ldHJ5O1xuICAgIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5zdGVwV29ya2Zsb3coVEVMRU1FVFJZX0lELCBgZXhwYW5kICR7dHlwZX0gZGV0YWlsc2AsIHtcbiAgICAgICAgY2F0ZWdvcnk6IFRFTEVNRVRSWV9JRCxcbiAgICAgICAgYXR0cmlidXRlOiBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkoYWRkSXRlbVN0YXRlLmFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgICAgICBwYWdlTmFtZTogVEVMRU1FVFJZX1BBR0VfTkFNRVxuICAgIH0pO1xufTtcbmNvbnN0IGZpbHRlckNoYW5nZVRlbGVtZXRyeSA9ICgpID0+IHtcbiAgICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gICAgdGVsZW1ldHJ5ID09PSBudWxsIHx8IHRlbGVtZXRyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZW1ldHJ5LnN0ZXBXb3JrZmxvdyhURUxFTUVUUllfSUQsIFwiZmlsdGVyXCIsIHtcbiAgICAgICAgY2F0ZWdvcnk6IFRFTEVNRVRSWV9JRCxcbiAgICAgICAgYXR0cmlidXRlOiBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkoYWRkSXRlbVN0YXRlLmFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgICAgICBwYWdlTmFtZTogVEVMRU1FVFJZX1BBR0VfTkFNRVxuICAgIH0pO1xufTtcbmNvbnN0IGZlYXR1cmVMYXllclR5cGVUZWxlbWV0cnkgPSAodHlwZSkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeVR5cGUgPSBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkodHlwZSk7XG4gICAgY29uc3QgdGVsZW1ldHJ5ID0gY29uZmlnU3RhdGUudGVsZW1ldHJ5O1xuICAgIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5zdGVwV29ya2Zsb3coVEVMRU1FVFJZX0lELCBcImZyb20gb3B0aW9uXCIsIHtcbiAgICAgICAgY2F0ZWdvcnk6IFRFTEVNRVRSWV9JRCxcbiAgICAgICAgYXR0cmlidXRlOiB0ZWxlbWV0cnlUeXBlLFxuICAgICAgICBwYWdlTmFtZTogVEVMRU1FVFJZX1BBR0VfTkFNRVxuICAgIH0pO1xufTtcbmNvbnN0IGZlYXR1cmVTZXJ2aWNlRW5kVGVsZW1ldHJ5ID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgYWRkRmVhdHVyZUxheWVyVHlwZSwgc2VydmljZUluZm8gfSA9IGFkZEl0ZW1TdGF0ZTtcbiAgICBjb25zdCBmZWF0dXJlTGF5ZXJTZXJ2aWNlSW5mbyA9IHNlcnZpY2VJbmZvO1xuICAgIGNvbnN0IHRlbGVtZXRyeSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeTtcbiAgICB0ZWxlbWV0cnkgPT09IG51bGwgfHwgdGVsZW1ldHJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZWxlbWV0cnkuZW5kV29ya2Zsb3coVEVMRU1FVFJZX0lELCB7XG4gICAgICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgICAgIGF0dHJpYnV0ZTogYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5KGFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgICAgICBwYWdlTmFtZTogVEVMRU1FVFJZX1BBR0VfTkFNRSxcbiAgICAgICAgY291bnQ6IGZlYXR1cmVMYXllclNlcnZpY2VJbmZvLmxheWVycy5sZW5ndGgsXG4gICAgICAgIG51bWJlcjogZmVhdHVyZUxheWVyU2VydmljZUluZm8udGFibGVzLmxlbmd0aFxuICAgIH0pO1xufTtcbmNvbnN0IGZlYXR1cmVMYXllckVycm9yVGVsZW1ldHJ5ID0gKGVyclN0cmluZykgPT4ge1xuICAgIHZhciBfYTtcbiAgICAoX2EgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5sb2dFcnJvcih7XG4gICAgICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgICAgIGVycm9yOiBlcnJTdHJpbmdcbiAgICB9KTtcbn07XG5cbmV4cG9ydCB7IGZlYXR1cmVTZXJ2aWNlRW5kVGVsZW1ldHJ5IGFzIGEsIGZpbHRlckNoYW5nZVRlbGVtZXRyeSBhcyBiLCBmZWF0dXJlTGF5ZXJUeXBlVGVsZW1ldHJ5IGFzIGMsIGVuYWJsZUxheWVyUHJlZmVyZW5jZVRlbGVtZXRyeSBhcyBlLCBmZWF0dXJlTGF5ZXJFcnJvclRlbGVtZXRyeSBhcyBmLCBpdGVtRXhwYW5kZWRUZWxlbWV0cnkgYXMgaSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1mZWF0dXJlLWxheWVyLTU4ZTE4YjAzLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgZyBhcyBnZXRSZW5kZXJpbmdSZWYsIGYgYXMgZm9yY2VVcGRhdGUgfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcblxuY29uc3QgYXBwZW5kVG9NYXAgPSAobWFwLCBwcm9wTmFtZSwgdmFsdWUpID0+IHtcbiAgICBjb25zdCBpdGVtcyA9IG1hcC5nZXQocHJvcE5hbWUpO1xuICAgIGlmICghaXRlbXMpIHtcbiAgICAgICAgbWFwLnNldChwcm9wTmFtZSwgW3ZhbHVlXSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKCFpdGVtcy5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgaXRlbXMucHVzaCh2YWx1ZSk7XG4gICAgfVxufTtcbmNvbnN0IGRlYm91bmNlID0gKGZuLCBtcykgPT4ge1xuICAgIGxldCB0aW1lb3V0SWQ7XG4gICAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgICAgIGlmICh0aW1lb3V0SWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICB9XG4gICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGltZW91dElkID0gMDtcbiAgICAgICAgICAgIGZuKC4uLmFyZ3MpO1xuICAgICAgICB9LCBtcyk7XG4gICAgfTtcbn07XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBwb3NzaWJsZSBlbGVtZW50IGlzQ29ubmVjdGVkLlxuICogVGhlIHByb3BlcnR5IG1pZ2h0IG5vdCBiZSB0aGVyZSwgc28gd2UgY2hlY2sgZm9yIGl0LlxuICpcbiAqIFdlIHdhbnQgaXQgdG8gcmV0dXJuIHRydWUgaWYgaXNDb25uZWN0ZWQgaXMgbm90IGEgcHJvcGVydHksXG4gKiBvdGhlcndpc2Ugd2Ugd291bGQgcmVtb3ZlIHRoZXNlIGVsZW1lbnRzIGFuZCB3b3VsZCBub3QgdXBkYXRlLlxuICpcbiAqIEJldHRlciBsZWFrIGluIEVkZ2UgdGhhbiB0byBiZSB1c2VsZXNzLlxuICovXG5jb25zdCBpc0Nvbm5lY3RlZCA9IChtYXliZUVsZW1lbnQpID0+ICEoJ2lzQ29ubmVjdGVkJyBpbiBtYXliZUVsZW1lbnQpIHx8IG1heWJlRWxlbWVudC5pc0Nvbm5lY3RlZDtcbmNvbnN0IGNsZWFudXBFbGVtZW50cyA9IGRlYm91bmNlKChtYXApID0+IHtcbiAgICBmb3IgKGxldCBrZXkgb2YgbWFwLmtleXMoKSkge1xuICAgICAgICBtYXAuc2V0KGtleSwgbWFwLmdldChrZXkpLmZpbHRlcihpc0Nvbm5lY3RlZCkpO1xuICAgIH1cbn0sIDIwMDApO1xuY29uc3Qgc3RlbmNpbFN1YnNjcmlwdGlvbiA9ICgpID0+IHtcbiAgICBpZiAodHlwZW9mIGdldFJlbmRlcmluZ1JlZiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBJZiB3ZSBhcmUgbm90IGluIGEgc3RlbmNpbCBwcm9qZWN0LCB3ZSBkbyBub3RoaW5nLlxuICAgICAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIG5vdCByZWFsbHkgZXhwb3J0ZWQgYnkgQHN0ZW5jaWwvY29yZS5cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBjb25zdCBlbG1zVG9VcGRhdGUgPSBuZXcgTWFwKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGlzcG9zZTogKCkgPT4gZWxtc1RvVXBkYXRlLmNsZWFyKCksXG4gICAgICAgIGdldDogKHByb3BOYW1lKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbG0gPSBnZXRSZW5kZXJpbmdSZWYoKTtcbiAgICAgICAgICAgIGlmIChlbG0pIHtcbiAgICAgICAgICAgICAgICBhcHBlbmRUb01hcChlbG1zVG9VcGRhdGUsIHByb3BOYW1lLCBlbG0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZXQ6IChwcm9wTmFtZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBlbG1zVG9VcGRhdGUuZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50cykge1xuICAgICAgICAgICAgICAgIGVsbXNUb1VwZGF0ZS5zZXQocHJvcE5hbWUsIGVsZW1lbnRzLmZpbHRlcihmb3JjZVVwZGF0ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYW51cEVsZW1lbnRzKGVsbXNUb1VwZGF0ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0OiAoKSA9PiB7XG4gICAgICAgICAgICBlbG1zVG9VcGRhdGUuZm9yRWFjaCgoZWxtcykgPT4gZWxtcy5mb3JFYWNoKGZvcmNlVXBkYXRlKSk7XG4gICAgICAgICAgICBjbGVhbnVwRWxlbWVudHMoZWxtc1RvVXBkYXRlKTtcbiAgICAgICAgfSxcbiAgICB9O1xufTtcblxuY29uc3QgdW53cmFwID0gKHZhbCkgPT4gKHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicgPyB2YWwoKSA6IHZhbCk7XG5jb25zdCBjcmVhdGVPYnNlcnZhYmxlTWFwID0gKGRlZmF1bHRTdGF0ZSwgc2hvdWxkVXBkYXRlID0gKGEsIGIpID0+IGEgIT09IGIpID0+IHtcbiAgICBjb25zdCB1bndyYXBwZWRTdGF0ZSA9IHVud3JhcChkZWZhdWx0U3RhdGUpO1xuICAgIGxldCBzdGF0ZXMgPSBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKHVud3JhcHBlZFN0YXRlICE9PSBudWxsICYmIHVud3JhcHBlZFN0YXRlICE9PSB2b2lkIDAgPyB1bndyYXBwZWRTdGF0ZSA6IHt9KSk7XG4gICAgY29uc3QgaGFuZGxlcnMgPSB7XG4gICAgICAgIGRpc3Bvc2U6IFtdLFxuICAgICAgICBnZXQ6IFtdLFxuICAgICAgICBzZXQ6IFtdLFxuICAgICAgICByZXNldDogW10sXG4gICAgfTtcbiAgICBjb25zdCByZXNldCA9ICgpID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICAvLyBXaGVuIHJlc2V0dGluZyB0aGUgc3RhdGUsIHRoZSBkZWZhdWx0IHN0YXRlIG1heSBiZSBhIGZ1bmN0aW9uIC0gdW53cmFwIGl0IHRvIGludm9rZSBpdC5cbiAgICAgICAgLy8gb3RoZXJ3aXNlLCB0aGUgc3RhdGUgd29uJ3QgYmUgcHJvcGVybHkgcmVzZXRcbiAgICAgICAgc3RhdGVzID0gbmV3IE1hcChPYmplY3QuZW50cmllcygoX2EgPSB1bndyYXAoZGVmYXVsdFN0YXRlKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDoge30pKTtcbiAgICAgICAgaGFuZGxlcnMucmVzZXQuZm9yRWFjaCgoY2IpID0+IGNiKCkpO1xuICAgIH07XG4gICAgY29uc3QgZGlzcG9zZSA9ICgpID0+IHtcbiAgICAgICAgLy8gQ2FsbCBmaXJzdCBkaXNwb3NlIGFzIHJlc2V0dGluZyB0aGUgc3RhdGUgd291bGRcbiAgICAgICAgLy8gY2F1c2UgbGVzcyB1cGRhdGVzIDspXG4gICAgICAgIGhhbmRsZXJzLmRpc3Bvc2UuZm9yRWFjaCgoY2IpID0+IGNiKCkpO1xuICAgICAgICByZXNldCgpO1xuICAgIH07XG4gICAgY29uc3QgZ2V0ID0gKHByb3BOYW1lKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzLmdldC5mb3JFYWNoKChjYikgPT4gY2IocHJvcE5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHN0YXRlcy5nZXQocHJvcE5hbWUpO1xuICAgIH07XG4gICAgY29uc3Qgc2V0ID0gKHByb3BOYW1lLCB2YWx1ZSkgPT4ge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHN0YXRlcy5nZXQocHJvcE5hbWUpO1xuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlKHZhbHVlLCBvbGRWYWx1ZSwgcHJvcE5hbWUpKSB7XG4gICAgICAgICAgICBzdGF0ZXMuc2V0KHByb3BOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICBoYW5kbGVycy5zZXQuZm9yRWFjaCgoY2IpID0+IGNiKHByb3BOYW1lLCB2YWx1ZSwgb2xkVmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc3RhdGUgPSAodHlwZW9mIFByb3h5ID09PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IHt9XG4gICAgICAgIDogbmV3IFByb3h5KHVud3JhcHBlZFN0YXRlLCB7XG4gICAgICAgICAgICBnZXQoXywgcHJvcE5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvd25LZXlzKF8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShzdGF0ZXMua2V5cygpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGFzKF8sIHByb3BOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlcy5oYXMocHJvcE5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldChfLCBwcm9wTmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBzZXQocHJvcE5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pKTtcbiAgICBjb25zdCBvbiA9IChldmVudE5hbWUsIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICByZW1vdmVGcm9tQXJyYXkoaGFuZGxlcnNbZXZlbnROYW1lXSwgY2FsbGJhY2spO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgY29uc3Qgb25DaGFuZ2UgPSAocHJvcE5hbWUsIGNiKSA9PiB7XG4gICAgICAgIGNvbnN0IHVuU2V0ID0gb24oJ3NldCcsIChrZXksIG5ld1ZhbHVlKSA9PiB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSBwcm9wTmFtZSkge1xuICAgICAgICAgICAgICAgIGNiKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gdW53cmFwIHRoZSBkZWZhdWx0U3RhdGUgYmVjYXVzZSBpdCBtaWdodCBiZSBhIGZ1bmN0aW9uLlxuICAgICAgICAvLyBPdGhlcndpc2Ugd2UgbWlnaHQgbm90IGJlIHNlbmRpbmcgdGhlIHJpZ2h0IHJlc2V0IHZhbHVlLlxuICAgICAgICBjb25zdCB1blJlc2V0ID0gb24oJ3Jlc2V0JywgKCkgPT4gY2IodW53cmFwKGRlZmF1bHRTdGF0ZSlbcHJvcE5hbWVdKSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB1blNldCgpO1xuICAgICAgICAgICAgdW5SZXNldCgpO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgY29uc3QgdXNlID0gKC4uLnN1YnNjcmlwdGlvbnMpID0+IHtcbiAgICAgICAgY29uc3QgdW5zdWJzID0gc3Vic2NyaXB0aW9ucy5yZWR1Y2UoKHVuc3Vicywgc3Vic2NyaXB0aW9uKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnNldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdzZXQnLCBzdWJzY3JpcHRpb24uc2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLmdldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdnZXQnLCBzdWJzY3JpcHRpb24uZ2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzLnB1c2gob24oJ3Jlc2V0Jywgc3Vic2NyaXB0aW9uLnJlc2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLmRpc3Bvc2UpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbignZGlzcG9zZScsIHN1YnNjcmlwdGlvbi5kaXNwb3NlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5zdWJzO1xuICAgICAgICB9LCBbXSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB1bnN1YnMuZm9yRWFjaCgodW5zdWIpID0+IHVuc3ViKCkpO1xuICAgIH07XG4gICAgY29uc3QgZm9yY2VVcGRhdGUgPSAoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IG9sZFZhbHVlID0gc3RhdGVzLmdldChrZXkpO1xuICAgICAgICBoYW5kbGVycy5zZXQuZm9yRWFjaCgoY2IpID0+IGNiKGtleSwgb2xkVmFsdWUsIG9sZFZhbHVlKSk7XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGF0ZSxcbiAgICAgICAgZ2V0LFxuICAgICAgICBzZXQsXG4gICAgICAgIG9uLFxuICAgICAgICBvbkNoYW5nZSxcbiAgICAgICAgdXNlLFxuICAgICAgICBkaXNwb3NlLFxuICAgICAgICByZXNldCxcbiAgICAgICAgZm9yY2VVcGRhdGUsXG4gICAgfTtcbn07XG5jb25zdCByZW1vdmVGcm9tQXJyYXkgPSAoYXJyYXksIGl0ZW0pID0+IHtcbiAgICBjb25zdCBpbmRleCA9IGFycmF5LmluZGV4T2YoaXRlbSk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgYXJyYXlbaW5kZXhdID0gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV07XG4gICAgICAgIGFycmF5Lmxlbmd0aC0tO1xuICAgIH1cbn07XG5cbmNvbnN0IGNyZWF0ZVN0b3JlID0gKGRlZmF1bHRTdGF0ZSwgc2hvdWxkVXBkYXRlKSA9PiB7XG4gICAgY29uc3QgbWFwID0gY3JlYXRlT2JzZXJ2YWJsZU1hcChkZWZhdWx0U3RhdGUsIHNob3VsZFVwZGF0ZSk7XG4gICAgbWFwLnVzZShzdGVuY2lsU3Vic2NyaXB0aW9uKCkpO1xuICAgIHJldHVybiBtYXA7XG59O1xuXG5leHBvcnQgeyBjcmVhdGVTdG9yZSBhcyBjIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LTA1OTU2Y2FiLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVTdG9yZSB9IGZyb20gJy4vaW5kZXgtMDU5NTZjYWIuanMnO1xuXG5jb25zdCB1aVN0b3JlID0gY3JlYXRlU3RvcmUoe1xuICAgIG5leHRUZXh0OiBcIm5leHRcIixcbiAgICB3b3JrZmxvdzogXCJjb250ZW50XCIsXG4gICAgc2NhbGU6IFwibVwiLFxuICAgIGRpc2FibGVTY3JvbGw6IGZhbHNlLFxuICAgIGZlYXR1cmVGbGFnczoge31cbn0pO1xuY29uc3QgdWlTdG9yZVN0YXRlID0gdWlTdG9yZS5zdGF0ZTtcblxuZXhwb3J0IHsgdWlTdG9yZSBhcyBhLCB1aVN0b3JlU3RhdGUgYXMgdSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD11aS1iY2E3YmNkMS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=