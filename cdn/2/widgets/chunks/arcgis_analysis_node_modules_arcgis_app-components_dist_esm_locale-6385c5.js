"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_locale-6385c5"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js":
/*!******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CSS_UTILITY),
/* harmony export */   a: () => (/* binding */ formatDate),
/* harmony export */   b: () => (/* binding */ formatPlural),
/* harmony export */   f: () => (/* binding */ formatNumber),
/* harmony export */   g: () => (/* binding */ getElementDir),
/* harmony export */   l: () => (/* binding */ languageMap)
/* harmony export */ });
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



const languageMap = new Map([
    ["ar", "ar"],
    ["bg", "bg"],
    ["bs", "bs"],
    ["ca", "ca"],
    ["cs", "cs"],
    ["da", "da"],
    ["de", "de"],
    ["el", "el"],
    ["en", "en"],
    ["es", "es"],
    ["et", "et"],
    ["fi", "fi"],
    ["fr", "fr"],
    ["he", "he"],
    ["hr", "hr"],
    ["hu", "hu"],
    ["id", "id"],
    ["it", "it"],
    ["ja", "ja"],
    ["ko", "ko"],
    ["lt", "lt"],
    ["lv", "lv"],
    ["nb", "nb"],
    ["nl", "nl"],
    ["pl", "pl"],
    ["pt-br", "pt-BR"],
    ["pt-pt", "pt-PT"],
    ["ro", "ro"],
    ["ru", "ru"],
    ["sk", "sk"],
    ["sl", "sl"],
    ["sr", "sr"],
    ["sv", "sv"],
    ["th", "th"],
    ["tr", "tr"],
    ["uk", "uk"],
    ["vi", "vi"],
    ["zh-cn", "zh-CN"],
    ["zh-hk", "zh-HK"],
    ["zh-tw", "zh-TW"]
]);
// rtl
function getElementDir(el) {
    return getElementProp(el, "dir", "ltr");
}
function getElementProp(el, prop, value) {
    const closestWithProp = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_1__.c)(el, `[${prop}]`);
    return closestWithProp ? closestWithProp.getAttribute(prop) : value;
}
// css
const CSS_UTILITY = {
    rtl: "arcgis--rtl"
};
async function formatNumber(number, options) {
    const { api, type, places } = options || {};
    if (api === 4) {
        const [intl] = await (0,_loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__.l)(["esri/intl"]);
        const numberFormatIntlOptions = intl.convertNumberFormatToIntlOptions({
            places,
            style: type,
            digitSeparator: true
        });
        return intl.formatNumber(number, Object.assign(Object.assign({}, numberFormatIntlOptions), { style: type }));
    }
    const [dojoNumber] = await (0,_loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_0__.l)(["dojo/number"]);
    return dojoNumber.format(number, {
        type,
        places,
        pattern: options === null || options === void 0 ? void 0 : options.pattern
    });
}
const cache = {};
function formatDate(date) {
    const lang = document.documentElement.lang;
    const dayShortMonthYear = {
        year: "numeric",
        month: "short",
        day: "numeric"
    };
    if (!cache[lang]) {
        cache[lang] = new Intl.DateTimeFormat(document.documentElement.lang, dayShortMonthYear);
    }
    return cache[lang].format(date);
}
function formatPlural(lang, stringObj, number) {
    const singles = ["id", "ja", "ko", "th", "vi", "zh-cn", "zh-hk", "zh-tw"];
    const likeEnglish = [
        "en",
        "ca",
        "da",
        "de",
        "el",
        "es",
        "et",
        "fi",
        "hi",
        "hu",
        "it",
        "nb",
        "nl",
        "pt-pt",
        "sv",
        "tr"
    ];
    const locale = lang !== null && lang !== void 0 ? lang : "en";
    // if the number is one, or it is a "simple" language, return the 1 string
    if (number === 1 || singles.includes(locale)) {
        return stringObj.single.replace("${number}", "1");
    }
    // if the number is not 1 and the language uses the same pluralization strategy as english,
    // return the multiple string
    if (number !== 1 && likeEnglish.includes(locale)) {
        return stringObj.multiple.replace("${number}", `${number}`);
    }
    // if none of the above worked, return the "unknown" string
    return stringObj.unknown.replace("${number}", `${number}`);
}



//# sourceMappingURL=languageUtil-ef0e54b2.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getComponentClosestLanguage),
/* harmony export */   g: () => (/* binding */ getLocaleComponentStrings)
/* harmony export */ });
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




// https://medium.com/stencil-tricks/implementing-internationalisation-i18n-with-stencil-5e6559554117
function getComponentClosestLanguage(element) {
    var _a, _b, _c;
    const closestElement = (_a = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
    // language set by the calling application or browser. defaults to english.
    const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
    if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
        return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
    }
    else {
        // "ru-RU" maps to "ru" use case
        if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
            return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang.slice(0, 2));
        }
        else {
            return "en";
        }
    }
}
function getComponentClosestLanguageIntl(element) {
    var _a, _b, _c;
    // it's OK if we don't have the 4 letter language file for it
    // 4 letter language code needed for formatting numbers
    const closestElement = (_a = (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
    // language set by the calling application or browser. defaults to english.
    const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
    if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
        return _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
    }
    else {
        if (_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
            // we support the 2 letter coded language
            // e.g. it-CH vs it
            return lang;
        }
        else {
            return "en";
        }
    }
}
function fetchLocaleStringsForComponent(componentName, locale) {
    return new Promise((resolve, reject) => {
        fetch((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_2__.a)(`../arcgis-app-assets/i18n/${componentName}.i18n.${locale}.json`)).then((result) => {
            if (result.ok)
                resolve(result.json());
            else
                reject();
        }, () => reject());
    });
}
const stringCache = {};
function fetchLocaleStringsFromCache(componentName, locale) {
    const id = `${componentName}${locale}`;
    if (!stringCache[id]) {
        stringCache[id] = fetchLocaleStringsForComponent(componentName, locale);
    }
    return stringCache[id];
}
/**
 * Get strings and language codes.
 * This method returns 2 language codes.
 * The first one returns a code that's also supported as a language file.
 * The second one returns a code where there is support for the first 2 letters of the code as part of a language file,
 * but will return the original 4 letter code from the page.
 * E.g. For "it-ch" it will return "it" as the first language code and "it-ch" as the second.
 * The second one is required for esri.intl.setLocale() to get the correct formatting.
 *
 * If a tagName is provided it will overwite the element's tagName
 *
 *  @return [ strings, first language code, second language code]
 */
async function getLocaleComponentStrings(element, tagName) {
    const componentName = tagName || element.tagName.toLowerCase();
    const componentLanguage = getComponentClosestLanguage(element);
    const componentLanguageIntl = getComponentClosestLanguageIntl(element);
    let strings;
    try {
        strings = await fetchLocaleStringsFromCache(componentName, componentLanguage);
    }
    catch (e) {
        console.warn(`no locale for ${componentName} (${componentLanguage}) loading default locale en.`);
        strings = await fetchLocaleStringsFromCache(componentName, "en");
    }
    return [strings, componentLanguage, componentLanguageIntl];
}



//# sourceMappingURL=locale-050b6db9.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/user-0fa9ff5a.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/user-0fa9ff5a.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ fetchItemUserInfo),
/* harmony export */   b: () => (/* binding */ fetchVerified),
/* harmony export */   c: () => (/* binding */ getUserThumbnailURI),
/* harmony export */   d: () => (/* binding */ fetchUserGroups),
/* harmony export */   e: () => (/* binding */ fetchUserItemsTotal),
/* harmony export */   f: () => (/* binding */ fetchUser),
/* harmony export */   g: () => (/* binding */ getFullName)
/* harmony export */ });
/* harmony import */ var _portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./portal-d518b571.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-d518b571.js");
/* harmony import */ var _query_d62660d4_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./query-d62660d4.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/query-d62660d4.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




async function getOrgProperties(item, orgId, locale, portal, checkOnline) {
    var _a, _b;
    const hostName = ((_a = item.portal) === null || _a === void 0 ? void 0 : _a.portalHostname) || (portal === null || portal === void 0 ? void 0 : portal.portalHostname) || ((_b = portal === null || portal === void 0 ? void 0 : portal.restUrl) === null || _b === void 0 ? void 0 : _b.replace("/sharing/rest", ""));
    const portalUrl = checkOnline
        ? `https://www.arcgis.com/sharing/rest/portals/${orgId}`
        : `https://${hostName}/sharing/rest/portals/${orgId}`;
    if (!hostName && !checkOnline) {
        return null;
    }
    const options = checkOnline ? { disableIdentityLookup: true, addTokenManually: false } : {};
    const self = await (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.r)(portalUrl, {}, options);
    const { urlKey, thumbnail, customBaseUrl } = self;
    const url = `https://${urlKey}.${customBaseUrl}/`;
    const thumbnailUrl = thumbnail ? `${url}sharing/rest/portals/self/resources/${thumbnail}` : null;
    let name, description;
    try {
        const properties = await (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.r)(`${portalUrl}/resources/localizedOrgProperties`, { start: 1, num: 100 }, options);
        if (properties) {
            const localizedOrgProperties = properties[locale] || properties.default;
            name = localizedOrgProperties.name;
            description = localizedOrgProperties.description || properties.description;
        }
    }
    catch (_c) {
        // org doesn't have localized org properties
    }
    return {
        name: name || self.name,
        description: (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_2__.a)(description || self.description),
        url: `${url}home/`,
        thumbnail: thumbnailUrl
    };
}
async function fetchVerified(item, locale, portal, checkOnline) {
    var _a, _b, _c;
    const orgId = (_c = (_a = item.orgId) !== null && _a !== void 0 ? _a : (_b = item.portal) === null || _b === void 0 ? void 0 : _b.id) !== null && _c !== void 0 ? _c : portal === null || portal === void 0 ? void 0 : portal.id;
    return (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.f)(() => getOrgProperties(item, orgId, locale, portal, checkOnline), "verified", orgId);
}

async function fetchUser(username, portal, checkOnline) {
    const restBase = checkOnline ? "https://www.arcgis.com/sharing/rest/" : (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.g)(portal);
    const url = `${restBase !== null && restBase !== void 0 ? restBase : (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.g)(portal)}community/users/${username}`;
    const onlineFromPortal = (url === null || url === void 0 ? void 0 : url.includes("www.arcgis.com")) && portal.isPortal;
    const options = onlineFromPortal ? { disableIdentityLookup: true, addTokenManually: false } : {};
    return (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.f)(async () => {
        try {
            const result = await (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.r)(url, {}, options);
            return result;
        }
        catch (error) {
            // an error fetching the user likely means the user is private
            // return a user-shaped object with just the username
            return { username };
        }
    }, "user", url);
}
async function fetchItemUserInfo(item, portal, lang, checkOnline) {
    var _a, _b;
    if ((item === null || item === void 0 ? void 0 : item.contentStatus) === "public_authoritative" ||
        ((_a = item.sourceJSON) === null || _a === void 0 ? void 0 : _a.contentStatus) === "public_authoritative") {
        const verifiedInfo = await fetchVerified(item, lang, portal, checkOnline);
        if (!verifiedInfo) {
            return fetchUser(item.owner, portal, checkOnline);
        }
        const { description, name, thumbnail, url } = verifiedInfo;
        return {
            description: description ? (0,_dom_4d367677_js__WEBPACK_IMPORTED_MODULE_2__.s)(description) : "",
            fullName: name,
            username: item.owner,
            thumbnail,
            id: item.orgId || ((_b = item.portal) === null || _b === void 0 ? void 0 : _b.id),
            url
        };
    }
    return fetchUser(item.owner, portal, checkOnline);
}
async function fetchUserGroups(username, portal, checkOnline) {
    const restBase = checkOnline ? "https://www.arcgis.com/sharing/rest/" : (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.g)(portal);
    const options = checkOnline ? { disableIdentityLookup: true, addTokenManually: false } : {};
    const searchGroups = async () => (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.r)(`${restBase}community/groups`, {
        q: `(owner:"${username}")`,
        num: 100
    }, options);
    return (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.f)(searchGroups, "userGroups", username);
}
async function fetchUserItemsTotal(user, portal, checkOnline) {
    const { username } = user;
    const restBase = checkOnline ? "https://www.arcgis.com/sharing/rest/" : (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.g)(portal);
    const options = checkOnline ? { disableIdentityLookup: true, addTokenManually: false } : {};
    const searchUserItemTotal = async () => {
        const response = await (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.r)(`${restBase}search`, {
            q: `(owner:"${username}") ${_query_d62660d4_js__WEBPACK_IMPORTED_MODULE_1__.H}`,
            num: 1
        }, options);
        return response.total;
    };
    return (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.f)(searchUserItemTotal, "userItemsTotal", username);
}
function getUserThumbnailURI(user, portal, noToken = false) {
    // 4.x portal user has a property for this
    if (user.thumbnailUrl) {
        return user.thumbnailUrl;
    }
    if (!user.thumbnail) {
        return null;
    }
    // if user begins with a protocol, assume it's already fully qualified
    if (user.thumbnail.startsWith("http")) {
        return user.thumbnail;
    }
    const token = (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.e)(portal);
    return `${(0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.g)(portal)}community/users/${user.username}/info/${user.thumbnail}${token && !noToken ? `?token=${token}` : ""}`;
}
function getFullName(user, lang) {
    const { fullName, firstName, lastName, username } = user;
    if (!fullName) {
        if (firstName && lastName) {
            return lang === "ja" ? `${lastName} ${firstName}` : `${firstName} ${lastName}`;
        }
        return username;
    }
    return fullName;
}



//# sourceMappingURL=user-0fa9ff5a.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fbG9jYWxlLTYzODVjNS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzZEO0FBQ2M7O0FBRTNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsbURBQWlDLFNBQVMsS0FBSztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksb0JBQW9CO0FBQ2hDO0FBQ0EsNkJBQTZCLDJEQUFXO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHVFQUF1RSw4QkFBOEIsYUFBYTtBQUNsSDtBQUNBLCtCQUErQiwyREFBVztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxPQUFPO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLE9BQU8sTUFBTSxPQUFPO0FBQ2pFO0FBQ0E7QUFDQSx3Q0FB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O0FBQ1Q7QUFDQTtBQUNBLFdBQVcsc0RBQVM7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isc0RBQVE7QUFDMUIsY0FBYyxzREFBYyxTQUFTLGtCQUFrQixjQUFjLFFBQVEsZUFBZSxFQUFFLDhCQUE4QixNQUFNLE9BQU87QUFDekk7QUFDQTtBQUNBLFlBQVksMENBQTBDO0FBQ3REO0FBQ0E7QUFDQSxzQ0FBc0MsVUFBVSxFQUFFLFVBQVUsT0FBTyxXQUFXLEVBQUUsU0FBUztBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVrSzs7QUFFbEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vbG9jYWxlLTA1MGI2ZGI5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL3VzZXItMGZhOWZmNWEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyBsIGFzIGxvYWRNb2R1bGVzIH0gZnJvbSAnLi9sb2FkTW9kdWxlcy1iNGFjMTI0Ny5qcyc7XG5pbXBvcnQgeyBjIGFzIGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeSB9IGZyb20gJy4vZG9tLTRkMzY3Njc3LmpzJztcblxuY29uc3QgbGFuZ3VhZ2VNYXAgPSBuZXcgTWFwKFtcbiAgICBbXCJhclwiLCBcImFyXCJdLFxuICAgIFtcImJnXCIsIFwiYmdcIl0sXG4gICAgW1wiYnNcIiwgXCJic1wiXSxcbiAgICBbXCJjYVwiLCBcImNhXCJdLFxuICAgIFtcImNzXCIsIFwiY3NcIl0sXG4gICAgW1wiZGFcIiwgXCJkYVwiXSxcbiAgICBbXCJkZVwiLCBcImRlXCJdLFxuICAgIFtcImVsXCIsIFwiZWxcIl0sXG4gICAgW1wiZW5cIiwgXCJlblwiXSxcbiAgICBbXCJlc1wiLCBcImVzXCJdLFxuICAgIFtcImV0XCIsIFwiZXRcIl0sXG4gICAgW1wiZmlcIiwgXCJmaVwiXSxcbiAgICBbXCJmclwiLCBcImZyXCJdLFxuICAgIFtcImhlXCIsIFwiaGVcIl0sXG4gICAgW1wiaHJcIiwgXCJoclwiXSxcbiAgICBbXCJodVwiLCBcImh1XCJdLFxuICAgIFtcImlkXCIsIFwiaWRcIl0sXG4gICAgW1wiaXRcIiwgXCJpdFwiXSxcbiAgICBbXCJqYVwiLCBcImphXCJdLFxuICAgIFtcImtvXCIsIFwia29cIl0sXG4gICAgW1wibHRcIiwgXCJsdFwiXSxcbiAgICBbXCJsdlwiLCBcImx2XCJdLFxuICAgIFtcIm5iXCIsIFwibmJcIl0sXG4gICAgW1wibmxcIiwgXCJubFwiXSxcbiAgICBbXCJwbFwiLCBcInBsXCJdLFxuICAgIFtcInB0LWJyXCIsIFwicHQtQlJcIl0sXG4gICAgW1wicHQtcHRcIiwgXCJwdC1QVFwiXSxcbiAgICBbXCJyb1wiLCBcInJvXCJdLFxuICAgIFtcInJ1XCIsIFwicnVcIl0sXG4gICAgW1wic2tcIiwgXCJza1wiXSxcbiAgICBbXCJzbFwiLCBcInNsXCJdLFxuICAgIFtcInNyXCIsIFwic3JcIl0sXG4gICAgW1wic3ZcIiwgXCJzdlwiXSxcbiAgICBbXCJ0aFwiLCBcInRoXCJdLFxuICAgIFtcInRyXCIsIFwidHJcIl0sXG4gICAgW1widWtcIiwgXCJ1a1wiXSxcbiAgICBbXCJ2aVwiLCBcInZpXCJdLFxuICAgIFtcInpoLWNuXCIsIFwiemgtQ05cIl0sXG4gICAgW1wiemgtaGtcIiwgXCJ6aC1IS1wiXSxcbiAgICBbXCJ6aC10d1wiLCBcInpoLVRXXCJdXG5dKTtcbi8vIHJ0bFxuZnVuY3Rpb24gZ2V0RWxlbWVudERpcihlbCkge1xuICAgIHJldHVybiBnZXRFbGVtZW50UHJvcChlbCwgXCJkaXJcIiwgXCJsdHJcIik7XG59XG5mdW5jdGlvbiBnZXRFbGVtZW50UHJvcChlbCwgcHJvcCwgdmFsdWUpIHtcbiAgICBjb25zdCBjbG9zZXN0V2l0aFByb3AgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWwsIGBbJHtwcm9wfV1gKTtcbiAgICByZXR1cm4gY2xvc2VzdFdpdGhQcm9wID8gY2xvc2VzdFdpdGhQcm9wLmdldEF0dHJpYnV0ZShwcm9wKSA6IHZhbHVlO1xufVxuLy8gY3NzXG5jb25zdCBDU1NfVVRJTElUWSA9IHtcbiAgICBydGw6IFwiYXJjZ2lzLS1ydGxcIlxufTtcbmFzeW5jIGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW1iZXIsIG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IGFwaSwgdHlwZSwgcGxhY2VzIH0gPSBvcHRpb25zIHx8IHt9O1xuICAgIGlmIChhcGkgPT09IDQpIHtcbiAgICAgICAgY29uc3QgW2ludGxdID0gYXdhaXQgbG9hZE1vZHVsZXMoW1wiZXNyaS9pbnRsXCJdKTtcbiAgICAgICAgY29uc3QgbnVtYmVyRm9ybWF0SW50bE9wdGlvbnMgPSBpbnRsLmNvbnZlcnROdW1iZXJGb3JtYXRUb0ludGxPcHRpb25zKHtcbiAgICAgICAgICAgIHBsYWNlcyxcbiAgICAgICAgICAgIHN0eWxlOiB0eXBlLFxuICAgICAgICAgICAgZGlnaXRTZXBhcmF0b3I6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpbnRsLmZvcm1hdE51bWJlcihudW1iZXIsIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgbnVtYmVyRm9ybWF0SW50bE9wdGlvbnMpLCB7IHN0eWxlOiB0eXBlIH0pKTtcbiAgICB9XG4gICAgY29uc3QgW2Rvam9OdW1iZXJdID0gYXdhaXQgbG9hZE1vZHVsZXMoW1wiZG9qby9udW1iZXJcIl0pO1xuICAgIHJldHVybiBkb2pvTnVtYmVyLmZvcm1hdChudW1iZXIsIHtcbiAgICAgICAgdHlwZSxcbiAgICAgICAgcGxhY2VzLFxuICAgICAgICBwYXR0ZXJuOiBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMucGF0dGVyblxuICAgIH0pO1xufVxuY29uc3QgY2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkge1xuICAgIGNvbnN0IGxhbmcgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZztcbiAgICBjb25zdCBkYXlTaG9ydE1vbnRoWWVhciA9IHtcbiAgICAgICAgeWVhcjogXCJudW1lcmljXCIsXG4gICAgICAgIG1vbnRoOiBcInNob3J0XCIsXG4gICAgICAgIGRheTogXCJudW1lcmljXCJcbiAgICB9O1xuICAgIGlmICghY2FjaGVbbGFuZ10pIHtcbiAgICAgICAgY2FjaGVbbGFuZ10gPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZywgZGF5U2hvcnRNb250aFllYXIpO1xuICAgIH1cbiAgICByZXR1cm4gY2FjaGVbbGFuZ10uZm9ybWF0KGRhdGUpO1xufVxuZnVuY3Rpb24gZm9ybWF0UGx1cmFsKGxhbmcsIHN0cmluZ09iaiwgbnVtYmVyKSB7XG4gICAgY29uc3Qgc2luZ2xlcyA9IFtcImlkXCIsIFwiamFcIiwgXCJrb1wiLCBcInRoXCIsIFwidmlcIiwgXCJ6aC1jblwiLCBcInpoLWhrXCIsIFwiemgtdHdcIl07XG4gICAgY29uc3QgbGlrZUVuZ2xpc2ggPSBbXG4gICAgICAgIFwiZW5cIixcbiAgICAgICAgXCJjYVwiLFxuICAgICAgICBcImRhXCIsXG4gICAgICAgIFwiZGVcIixcbiAgICAgICAgXCJlbFwiLFxuICAgICAgICBcImVzXCIsXG4gICAgICAgIFwiZXRcIixcbiAgICAgICAgXCJmaVwiLFxuICAgICAgICBcImhpXCIsXG4gICAgICAgIFwiaHVcIixcbiAgICAgICAgXCJpdFwiLFxuICAgICAgICBcIm5iXCIsXG4gICAgICAgIFwibmxcIixcbiAgICAgICAgXCJwdC1wdFwiLFxuICAgICAgICBcInN2XCIsXG4gICAgICAgIFwidHJcIlxuICAgIF07XG4gICAgY29uc3QgbG9jYWxlID0gbGFuZyAhPT0gbnVsbCAmJiBsYW5nICE9PSB2b2lkIDAgPyBsYW5nIDogXCJlblwiO1xuICAgIC8vIGlmIHRoZSBudW1iZXIgaXMgb25lLCBvciBpdCBpcyBhIFwic2ltcGxlXCIgbGFuZ3VhZ2UsIHJldHVybiB0aGUgMSBzdHJpbmdcbiAgICBpZiAobnVtYmVyID09PSAxIHx8IHNpbmdsZXMuaW5jbHVkZXMobG9jYWxlKSkge1xuICAgICAgICByZXR1cm4gc3RyaW5nT2JqLnNpbmdsZS5yZXBsYWNlKFwiJHtudW1iZXJ9XCIsIFwiMVwiKTtcbiAgICB9XG4gICAgLy8gaWYgdGhlIG51bWJlciBpcyBub3QgMSBhbmQgdGhlIGxhbmd1YWdlIHVzZXMgdGhlIHNhbWUgcGx1cmFsaXphdGlvbiBzdHJhdGVneSBhcyBlbmdsaXNoLFxuICAgIC8vIHJldHVybiB0aGUgbXVsdGlwbGUgc3RyaW5nXG4gICAgaWYgKG51bWJlciAhPT0gMSAmJiBsaWtlRW5nbGlzaC5pbmNsdWRlcyhsb2NhbGUpKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmdPYmoubXVsdGlwbGUucmVwbGFjZShcIiR7bnVtYmVyfVwiLCBgJHtudW1iZXJ9YCk7XG4gICAgfVxuICAgIC8vIGlmIG5vbmUgb2YgdGhlIGFib3ZlIHdvcmtlZCwgcmV0dXJuIHRoZSBcInVua25vd25cIiBzdHJpbmdcbiAgICByZXR1cm4gc3RyaW5nT2JqLnVua25vd24ucmVwbGFjZShcIiR7bnVtYmVyfVwiLCBgJHtudW1iZXJ9YCk7XG59XG5cbmV4cG9ydCB7IENTU19VVElMSVRZIGFzIEMsIGZvcm1hdERhdGUgYXMgYSwgZm9ybWF0UGx1cmFsIGFzIGIsIGZvcm1hdE51bWJlciBhcyBmLCBnZXRFbGVtZW50RGlyIGFzIGcsIGxhbmd1YWdlTWFwIGFzIGwgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGFuZ3VhZ2VVdGlsLWVmMGU1NGIyLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYyBhcyBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkgfSBmcm9tICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5pbXBvcnQgeyBsIGFzIGxhbmd1YWdlTWFwIH0gZnJvbSAnLi9sYW5ndWFnZVV0aWwtZWYwZTU0YjIuanMnO1xuaW1wb3J0IHsgYSBhcyBnZXRBc3NldFBhdGggfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcblxuLy8gaHR0cHM6Ly9tZWRpdW0uY29tL3N0ZW5jaWwtdHJpY2tzL2ltcGxlbWVudGluZy1pbnRlcm5hdGlvbmFsaXNhdGlvbi1pMThuLXdpdGgtc3RlbmNpbC01ZTY1NTk1NTQxMTdcbmZ1bmN0aW9uIGdldENvbXBvbmVudENsb3Nlc3RMYW5ndWFnZShlbGVtZW50KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgY29uc3QgY2xvc2VzdEVsZW1lbnQgPSAoX2EgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWxlbWVudCwgXCJbbGFuZ11cIikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYyA9IChfYiA9IGVsZW1lbnQuc2hhZG93Um9vdCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm93bmVyRG9jdW1lbnQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgLy8gbGFuZ3VhZ2Ugc2V0IGJ5IHRoZSBjYWxsaW5nIGFwcGxpY2F0aW9uIG9yIGJyb3dzZXIuIGRlZmF1bHRzIHRvIGVuZ2xpc2guXG4gICAgY29uc3QgbGFuZyA9ICgoY2xvc2VzdEVsZW1lbnQgPT09IG51bGwgfHwgY2xvc2VzdEVsZW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNsb3Nlc3RFbGVtZW50LmxhbmcpIHx8IChuYXZpZ2F0b3IgPT09IG51bGwgfHwgbmF2aWdhdG9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBuYXZpZ2F0b3IubGFuZ3VhZ2UpIHx8IFwiZW5cIikudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAobGFuZ3VhZ2VNYXAuaGFzKGxhbmcpKSB7XG4gICAgICAgIHJldHVybiBsYW5ndWFnZU1hcC5nZXQobGFuZyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvLyBcInJ1LVJVXCIgbWFwcyB0byBcInJ1XCIgdXNlIGNhc2VcbiAgICAgICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nLnNsaWNlKDAsIDIpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGxhbmd1YWdlTWFwLmdldChsYW5nLnNsaWNlKDAsIDIpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcImVuXCI7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2VJbnRsKGVsZW1lbnQpIHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAvLyBpdCdzIE9LIGlmIHdlIGRvbid0IGhhdmUgdGhlIDQgbGV0dGVyIGxhbmd1YWdlIGZpbGUgZm9yIGl0XG4gICAgLy8gNCBsZXR0ZXIgbGFuZ3VhZ2UgY29kZSBuZWVkZWQgZm9yIGZvcm1hdHRpbmcgbnVtYmVyc1xuICAgIGNvbnN0IGNsb3Nlc3RFbGVtZW50ID0gKF9hID0gY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5KGVsZW1lbnQsIFwiW2xhbmddXCIpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoX2MgPSAoX2IgPSBlbGVtZW50LnNoYWRvd1Jvb3QpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5vd25lckRvY3VtZW50KSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuZG9jdW1lbnRFbGVtZW50O1xuICAgIC8vIGxhbmd1YWdlIHNldCBieSB0aGUgY2FsbGluZyBhcHBsaWNhdGlvbiBvciBicm93c2VyLiBkZWZhdWx0cyB0byBlbmdsaXNoLlxuICAgIGNvbnN0IGxhbmcgPSAoKGNsb3Nlc3RFbGVtZW50ID09PSBudWxsIHx8IGNsb3Nlc3RFbGVtZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjbG9zZXN0RWxlbWVudC5sYW5nKSB8fCAobmF2aWdhdG9yID09PSBudWxsIHx8IG5hdmlnYXRvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmF2aWdhdG9yLmxhbmd1YWdlKSB8fCBcImVuXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nKSkge1xuICAgICAgICByZXR1cm4gbGFuZ3VhZ2VNYXAuZ2V0KGxhbmcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nLnNsaWNlKDAsIDIpKSkge1xuICAgICAgICAgICAgLy8gd2Ugc3VwcG9ydCB0aGUgMiBsZXR0ZXIgY29kZWQgbGFuZ3VhZ2VcbiAgICAgICAgICAgIC8vIGUuZy4gaXQtQ0ggdnMgaXRcbiAgICAgICAgICAgIHJldHVybiBsYW5nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiZW5cIjtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGZldGNoTG9jYWxlU3RyaW5nc0ZvckNvbXBvbmVudChjb21wb25lbnROYW1lLCBsb2NhbGUpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBmZXRjaChnZXRBc3NldFBhdGgoYC4uL2FyY2dpcy1hcHAtYXNzZXRzL2kxOG4vJHtjb21wb25lbnROYW1lfS5pMThuLiR7bG9jYWxlfS5qc29uYCkpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5vaylcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5qc29uKCkpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICB9LCAoKSA9PiByZWplY3QoKSk7XG4gICAgfSk7XG59XG5jb25zdCBzdHJpbmdDYWNoZSA9IHt9O1xuZnVuY3Rpb24gZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIGxvY2FsZSkge1xuICAgIGNvbnN0IGlkID0gYCR7Y29tcG9uZW50TmFtZX0ke2xvY2FsZX1gO1xuICAgIGlmICghc3RyaW5nQ2FjaGVbaWRdKSB7XG4gICAgICAgIHN0cmluZ0NhY2hlW2lkXSA9IGZldGNoTG9jYWxlU3RyaW5nc0ZvckNvbXBvbmVudChjb21wb25lbnROYW1lLCBsb2NhbGUpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyaW5nQ2FjaGVbaWRdO1xufVxuLyoqXG4gKiBHZXQgc3RyaW5ncyBhbmQgbGFuZ3VhZ2UgY29kZXMuXG4gKiBUaGlzIG1ldGhvZCByZXR1cm5zIDIgbGFuZ3VhZ2UgY29kZXMuXG4gKiBUaGUgZmlyc3Qgb25lIHJldHVybnMgYSBjb2RlIHRoYXQncyBhbHNvIHN1cHBvcnRlZCBhcyBhIGxhbmd1YWdlIGZpbGUuXG4gKiBUaGUgc2Vjb25kIG9uZSByZXR1cm5zIGEgY29kZSB3aGVyZSB0aGVyZSBpcyBzdXBwb3J0IGZvciB0aGUgZmlyc3QgMiBsZXR0ZXJzIG9mIHRoZSBjb2RlIGFzIHBhcnQgb2YgYSBsYW5ndWFnZSBmaWxlLFxuICogYnV0IHdpbGwgcmV0dXJuIHRoZSBvcmlnaW5hbCA0IGxldHRlciBjb2RlIGZyb20gdGhlIHBhZ2UuXG4gKiBFLmcuIEZvciBcIml0LWNoXCIgaXQgd2lsbCByZXR1cm4gXCJpdFwiIGFzIHRoZSBmaXJzdCBsYW5ndWFnZSBjb2RlIGFuZCBcIml0LWNoXCIgYXMgdGhlIHNlY29uZC5cbiAqIFRoZSBzZWNvbmQgb25lIGlzIHJlcXVpcmVkIGZvciBlc3JpLmludGwuc2V0TG9jYWxlKCkgdG8gZ2V0IHRoZSBjb3JyZWN0IGZvcm1hdHRpbmcuXG4gKlxuICogSWYgYSB0YWdOYW1lIGlzIHByb3ZpZGVkIGl0IHdpbGwgb3ZlcndpdGUgdGhlIGVsZW1lbnQncyB0YWdOYW1lXG4gKlxuICogIEByZXR1cm4gWyBzdHJpbmdzLCBmaXJzdCBsYW5ndWFnZSBjb2RlLCBzZWNvbmQgbGFuZ3VhZ2UgY29kZV1cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0TG9jYWxlQ29tcG9uZW50U3RyaW5ncyhlbGVtZW50LCB0YWdOYW1lKSB7XG4gICAgY29uc3QgY29tcG9uZW50TmFtZSA9IHRhZ05hbWUgfHwgZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgY29tcG9uZW50TGFuZ3VhZ2UgPSBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2UoZWxlbWVudCk7XG4gICAgY29uc3QgY29tcG9uZW50TGFuZ3VhZ2VJbnRsID0gZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlSW50bChlbGVtZW50KTtcbiAgICBsZXQgc3RyaW5ncztcbiAgICB0cnkge1xuICAgICAgICBzdHJpbmdzID0gYXdhaXQgZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudExhbmd1YWdlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBubyBsb2NhbGUgZm9yICR7Y29tcG9uZW50TmFtZX0gKCR7Y29tcG9uZW50TGFuZ3VhZ2V9KSBsb2FkaW5nIGRlZmF1bHQgbG9jYWxlIGVuLmApO1xuICAgICAgICBzdHJpbmdzID0gYXdhaXQgZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIFwiZW5cIik7XG4gICAgfVxuICAgIHJldHVybiBbc3RyaW5ncywgY29tcG9uZW50TGFuZ3VhZ2UsIGNvbXBvbmVudExhbmd1YWdlSW50bF07XG59XG5cbmV4cG9ydCB7IGdldENvbXBvbmVudENsb3Nlc3RMYW5ndWFnZSBhcyBhLCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzIGFzIGcgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9jYWxlLTA1MGI2ZGI5LmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgZiBhcyBmcm9tQ2FjaGUsIHIgYXMgcmVxdWVzdCwgZyBhcyBnZXRSZXN0QmFzZVVybCwgZSBhcyBnZXRUb2tlbiB9IGZyb20gJy4vcG9ydGFsLWQ1MThiNTcxLmpzJztcbmltcG9ydCB7IEggYXMgSElEREVOX0lURU1TX1FVRVJZIH0gZnJvbSAnLi9xdWVyeS1kNjI2NjBkNC5qcyc7XG5pbXBvcnQgeyBhIGFzIHN0cmlwSFRNTCwgcyBhcyBzYW5pdGl6ZUhUTUwgfSBmcm9tICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5cbmFzeW5jIGZ1bmN0aW9uIGdldE9yZ1Byb3BlcnRpZXMoaXRlbSwgb3JnSWQsIGxvY2FsZSwgcG9ydGFsLCBjaGVja09ubGluZSkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgaG9zdE5hbWUgPSAoKF9hID0gaXRlbS5wb3J0YWwpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3J0YWxIb3N0bmFtZSkgfHwgKHBvcnRhbCA9PT0gbnVsbCB8fCBwb3J0YWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBvcnRhbC5wb3J0YWxIb3N0bmFtZSkgfHwgKChfYiA9IHBvcnRhbCA9PT0gbnVsbCB8fCBwb3J0YWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBvcnRhbC5yZXN0VXJsKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IucmVwbGFjZShcIi9zaGFyaW5nL3Jlc3RcIiwgXCJcIikpO1xuICAgIGNvbnN0IHBvcnRhbFVybCA9IGNoZWNrT25saW5lXG4gICAgICAgID8gYGh0dHBzOi8vd3d3LmFyY2dpcy5jb20vc2hhcmluZy9yZXN0L3BvcnRhbHMvJHtvcmdJZH1gXG4gICAgICAgIDogYGh0dHBzOi8vJHtob3N0TmFtZX0vc2hhcmluZy9yZXN0L3BvcnRhbHMvJHtvcmdJZH1gO1xuICAgIGlmICghaG9zdE5hbWUgJiYgIWNoZWNrT25saW5lKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBvcHRpb25zID0gY2hlY2tPbmxpbmUgPyB7IGRpc2FibGVJZGVudGl0eUxvb2t1cDogdHJ1ZSwgYWRkVG9rZW5NYW51YWxseTogZmFsc2UgfSA6IHt9O1xuICAgIGNvbnN0IHNlbGYgPSBhd2FpdCByZXF1ZXN0KHBvcnRhbFVybCwge30sIG9wdGlvbnMpO1xuICAgIGNvbnN0IHsgdXJsS2V5LCB0aHVtYm5haWwsIGN1c3RvbUJhc2VVcmwgfSA9IHNlbGY7XG4gICAgY29uc3QgdXJsID0gYGh0dHBzOi8vJHt1cmxLZXl9LiR7Y3VzdG9tQmFzZVVybH0vYDtcbiAgICBjb25zdCB0aHVtYm5haWxVcmwgPSB0aHVtYm5haWwgPyBgJHt1cmx9c2hhcmluZy9yZXN0L3BvcnRhbHMvc2VsZi9yZXNvdXJjZXMvJHt0aHVtYm5haWx9YCA6IG51bGw7XG4gICAgbGV0IG5hbWUsIGRlc2NyaXB0aW9uO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBhd2FpdCByZXF1ZXN0KGAke3BvcnRhbFVybH0vcmVzb3VyY2VzL2xvY2FsaXplZE9yZ1Byb3BlcnRpZXNgLCB7IHN0YXJ0OiAxLCBudW06IDEwMCB9LCBvcHRpb25zKTtcbiAgICAgICAgaWYgKHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2FsaXplZE9yZ1Byb3BlcnRpZXMgPSBwcm9wZXJ0aWVzW2xvY2FsZV0gfHwgcHJvcGVydGllcy5kZWZhdWx0O1xuICAgICAgICAgICAgbmFtZSA9IGxvY2FsaXplZE9yZ1Byb3BlcnRpZXMubmFtZTtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gbG9jYWxpemVkT3JnUHJvcGVydGllcy5kZXNjcmlwdGlvbiB8fCBwcm9wZXJ0aWVzLmRlc2NyaXB0aW9uO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChfYykge1xuICAgICAgICAvLyBvcmcgZG9lc24ndCBoYXZlIGxvY2FsaXplZCBvcmcgcHJvcGVydGllc1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiBuYW1lIHx8IHNlbGYubmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb246IHN0cmlwSFRNTChkZXNjcmlwdGlvbiB8fCBzZWxmLmRlc2NyaXB0aW9uKSxcbiAgICAgICAgdXJsOiBgJHt1cmx9aG9tZS9gLFxuICAgICAgICB0aHVtYm5haWw6IHRodW1ibmFpbFVybFxuICAgIH07XG59XG5hc3luYyBmdW5jdGlvbiBmZXRjaFZlcmlmaWVkKGl0ZW0sIGxvY2FsZSwgcG9ydGFsLCBjaGVja09ubGluZSkge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIGNvbnN0IG9yZ0lkID0gKF9jID0gKF9hID0gaXRlbS5vcmdJZCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKF9iID0gaXRlbS5wb3J0YWwpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5pZCkgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogcG9ydGFsID09PSBudWxsIHx8IHBvcnRhbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcG9ydGFsLmlkO1xuICAgIHJldHVybiBmcm9tQ2FjaGUoKCkgPT4gZ2V0T3JnUHJvcGVydGllcyhpdGVtLCBvcmdJZCwgbG9jYWxlLCBwb3J0YWwsIGNoZWNrT25saW5lKSwgXCJ2ZXJpZmllZFwiLCBvcmdJZCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoVXNlcih1c2VybmFtZSwgcG9ydGFsLCBjaGVja09ubGluZSkge1xuICAgIGNvbnN0IHJlc3RCYXNlID0gY2hlY2tPbmxpbmUgPyBcImh0dHBzOi8vd3d3LmFyY2dpcy5jb20vc2hhcmluZy9yZXN0L1wiIDogZ2V0UmVzdEJhc2VVcmwocG9ydGFsKTtcbiAgICBjb25zdCB1cmwgPSBgJHtyZXN0QmFzZSAhPT0gbnVsbCAmJiByZXN0QmFzZSAhPT0gdm9pZCAwID8gcmVzdEJhc2UgOiBnZXRSZXN0QmFzZVVybChwb3J0YWwpfWNvbW11bml0eS91c2Vycy8ke3VzZXJuYW1lfWA7XG4gICAgY29uc3Qgb25saW5lRnJvbVBvcnRhbCA9ICh1cmwgPT09IG51bGwgfHwgdXJsID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1cmwuaW5jbHVkZXMoXCJ3d3cuYXJjZ2lzLmNvbVwiKSkgJiYgcG9ydGFsLmlzUG9ydGFsO1xuICAgIGNvbnN0IG9wdGlvbnMgPSBvbmxpbmVGcm9tUG9ydGFsID8geyBkaXNhYmxlSWRlbnRpdHlMb29rdXA6IHRydWUsIGFkZFRva2VuTWFudWFsbHk6IGZhbHNlIH0gOiB7fTtcbiAgICByZXR1cm4gZnJvbUNhY2hlKGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcXVlc3QodXJsLCB7fSwgb3B0aW9ucyk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gYW4gZXJyb3IgZmV0Y2hpbmcgdGhlIHVzZXIgbGlrZWx5IG1lYW5zIHRoZSB1c2VyIGlzIHByaXZhdGVcbiAgICAgICAgICAgIC8vIHJldHVybiBhIHVzZXItc2hhcGVkIG9iamVjdCB3aXRoIGp1c3QgdGhlIHVzZXJuYW1lXG4gICAgICAgICAgICByZXR1cm4geyB1c2VybmFtZSB9O1xuICAgICAgICB9XG4gICAgfSwgXCJ1c2VyXCIsIHVybCk7XG59XG5hc3luYyBmdW5jdGlvbiBmZXRjaEl0ZW1Vc2VySW5mbyhpdGVtLCBwb3J0YWwsIGxhbmcsIGNoZWNrT25saW5lKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBpZiAoKGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbS5jb250ZW50U3RhdHVzKSA9PT0gXCJwdWJsaWNfYXV0aG9yaXRhdGl2ZVwiIHx8XG4gICAgICAgICgoX2EgPSBpdGVtLnNvdXJjZUpTT04pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jb250ZW50U3RhdHVzKSA9PT0gXCJwdWJsaWNfYXV0aG9yaXRhdGl2ZVwiKSB7XG4gICAgICAgIGNvbnN0IHZlcmlmaWVkSW5mbyA9IGF3YWl0IGZldGNoVmVyaWZpZWQoaXRlbSwgbGFuZywgcG9ydGFsLCBjaGVja09ubGluZSk7XG4gICAgICAgIGlmICghdmVyaWZpZWRJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gZmV0Y2hVc2VyKGl0ZW0ub3duZXIsIHBvcnRhbCwgY2hlY2tPbmxpbmUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgZGVzY3JpcHRpb24sIG5hbWUsIHRodW1ibmFpbCwgdXJsIH0gPSB2ZXJpZmllZEluZm87XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gPyBzYW5pdGl6ZUhUTUwoZGVzY3JpcHRpb24pIDogXCJcIixcbiAgICAgICAgICAgIGZ1bGxOYW1lOiBuYW1lLFxuICAgICAgICAgICAgdXNlcm5hbWU6IGl0ZW0ub3duZXIsXG4gICAgICAgICAgICB0aHVtYm5haWwsXG4gICAgICAgICAgICBpZDogaXRlbS5vcmdJZCB8fCAoKF9iID0gaXRlbS5wb3J0YWwpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5pZCksXG4gICAgICAgICAgICB1cmxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGZldGNoVXNlcihpdGVtLm93bmVyLCBwb3J0YWwsIGNoZWNrT25saW5lKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGZldGNoVXNlckdyb3Vwcyh1c2VybmFtZSwgcG9ydGFsLCBjaGVja09ubGluZSkge1xuICAgIGNvbnN0IHJlc3RCYXNlID0gY2hlY2tPbmxpbmUgPyBcImh0dHBzOi8vd3d3LmFyY2dpcy5jb20vc2hhcmluZy9yZXN0L1wiIDogZ2V0UmVzdEJhc2VVcmwocG9ydGFsKTtcbiAgICBjb25zdCBvcHRpb25zID0gY2hlY2tPbmxpbmUgPyB7IGRpc2FibGVJZGVudGl0eUxvb2t1cDogdHJ1ZSwgYWRkVG9rZW5NYW51YWxseTogZmFsc2UgfSA6IHt9O1xuICAgIGNvbnN0IHNlYXJjaEdyb3VwcyA9IGFzeW5jICgpID0+IHJlcXVlc3QoYCR7cmVzdEJhc2V9Y29tbXVuaXR5L2dyb3Vwc2AsIHtcbiAgICAgICAgcTogYChvd25lcjpcIiR7dXNlcm5hbWV9XCIpYCxcbiAgICAgICAgbnVtOiAxMDBcbiAgICB9LCBvcHRpb25zKTtcbiAgICByZXR1cm4gZnJvbUNhY2hlKHNlYXJjaEdyb3VwcywgXCJ1c2VyR3JvdXBzXCIsIHVzZXJuYW1lKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGZldGNoVXNlckl0ZW1zVG90YWwodXNlciwgcG9ydGFsLCBjaGVja09ubGluZSkge1xuICAgIGNvbnN0IHsgdXNlcm5hbWUgfSA9IHVzZXI7XG4gICAgY29uc3QgcmVzdEJhc2UgPSBjaGVja09ubGluZSA/IFwiaHR0cHM6Ly93d3cuYXJjZ2lzLmNvbS9zaGFyaW5nL3Jlc3QvXCIgOiBnZXRSZXN0QmFzZVVybChwb3J0YWwpO1xuICAgIGNvbnN0IG9wdGlvbnMgPSBjaGVja09ubGluZSA/IHsgZGlzYWJsZUlkZW50aXR5TG9va3VwOiB0cnVlLCBhZGRUb2tlbk1hbnVhbGx5OiBmYWxzZSB9IDoge307XG4gICAgY29uc3Qgc2VhcmNoVXNlckl0ZW1Ub3RhbCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGAke3Jlc3RCYXNlfXNlYXJjaGAsIHtcbiAgICAgICAgICAgIHE6IGAob3duZXI6XCIke3VzZXJuYW1lfVwiKSAke0hJRERFTl9JVEVNU19RVUVSWX1gLFxuICAgICAgICAgICAgbnVtOiAxXG4gICAgICAgIH0sIG9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UudG90YWw7XG4gICAgfTtcbiAgICByZXR1cm4gZnJvbUNhY2hlKHNlYXJjaFVzZXJJdGVtVG90YWwsIFwidXNlckl0ZW1zVG90YWxcIiwgdXNlcm5hbWUpO1xufVxuZnVuY3Rpb24gZ2V0VXNlclRodW1ibmFpbFVSSSh1c2VyLCBwb3J0YWwsIG5vVG9rZW4gPSBmYWxzZSkge1xuICAgIC8vIDQueCBwb3J0YWwgdXNlciBoYXMgYSBwcm9wZXJ0eSBmb3IgdGhpc1xuICAgIGlmICh1c2VyLnRodW1ibmFpbFVybCkge1xuICAgICAgICByZXR1cm4gdXNlci50aHVtYm5haWxVcmw7XG4gICAgfVxuICAgIGlmICghdXNlci50aHVtYm5haWwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIC8vIGlmIHVzZXIgYmVnaW5zIHdpdGggYSBwcm90b2NvbCwgYXNzdW1lIGl0J3MgYWxyZWFkeSBmdWxseSBxdWFsaWZpZWRcbiAgICBpZiAodXNlci50aHVtYm5haWwuc3RhcnRzV2l0aChcImh0dHBcIikpIHtcbiAgICAgICAgcmV0dXJuIHVzZXIudGh1bWJuYWlsO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbiA9IGdldFRva2VuKHBvcnRhbCk7XG4gICAgcmV0dXJuIGAke2dldFJlc3RCYXNlVXJsKHBvcnRhbCl9Y29tbXVuaXR5L3VzZXJzLyR7dXNlci51c2VybmFtZX0vaW5mby8ke3VzZXIudGh1bWJuYWlsfSR7dG9rZW4gJiYgIW5vVG9rZW4gPyBgP3Rva2VuPSR7dG9rZW59YCA6IFwiXCJ9YDtcbn1cbmZ1bmN0aW9uIGdldEZ1bGxOYW1lKHVzZXIsIGxhbmcpIHtcbiAgICBjb25zdCB7IGZ1bGxOYW1lLCBmaXJzdE5hbWUsIGxhc3ROYW1lLCB1c2VybmFtZSB9ID0gdXNlcjtcbiAgICBpZiAoIWZ1bGxOYW1lKSB7XG4gICAgICAgIGlmIChmaXJzdE5hbWUgJiYgbGFzdE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBsYW5nID09PSBcImphXCIgPyBgJHtsYXN0TmFtZX0gJHtmaXJzdE5hbWV9YCA6IGAke2ZpcnN0TmFtZX0gJHtsYXN0TmFtZX1gO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1c2VybmFtZTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bGxOYW1lO1xufVxuXG5leHBvcnQgeyBmZXRjaEl0ZW1Vc2VySW5mbyBhcyBhLCBmZXRjaFZlcmlmaWVkIGFzIGIsIGdldFVzZXJUaHVtYm5haWxVUkkgYXMgYywgZmV0Y2hVc2VyR3JvdXBzIGFzIGQsIGZldGNoVXNlckl0ZW1zVG90YWwgYXMgZSwgZmV0Y2hVc2VyIGFzIGYsIGdldEZ1bGxOYW1lIGFzIGcgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXNlci0wZmE5ZmY1YS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=