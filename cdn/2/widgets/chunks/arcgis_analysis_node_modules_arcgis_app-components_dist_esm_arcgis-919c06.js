"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-919c06"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-home.entry.js":
/*!*****************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-home.entry.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_home: () => (/* binding */ ArcgisNewItemPagesHome)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _file_bf8ab90f_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./file-bf8ab90f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-bf8ab90f.js");
/* harmony import */ var _privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./privileges-5c382f61.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-5c382f61.js");
/* harmony import */ var _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./item-properties-10491b2e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-properties-10491b2e.js");
/* harmony import */ var _server_item_8d384796_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./server-item-8d384796.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/server-item-8d384796.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/* harmony import */ var _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ui-bca7bcd1.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js");
/* harmony import */ var _utils_9b3ffcf7_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./utils-9b3ffcf7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-9b3ffcf7.js");
/* harmony import */ var _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./item-types-2029b06b.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-2029b06b.js");
/* harmony import */ var _i18n_2998ec30_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./i18n-2998ec30.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/i18n-2998ec30.js");
/* harmony import */ var _item_types_586f0301_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./item-types-586f0301.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-586f0301.js");
/* harmony import */ var _privileges_74639dae_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./privileges-74639dae.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-74639dae.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _guid_aeaed84d_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./guid-aeaed84d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-aeaed84d.js");
/* harmony import */ var _item_3535552d_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./item-3535552d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-3535552d.js");
/* harmony import */ var _url_4c3ae54c_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./url-4c3ae54c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/url-4c3ae54c.js");
/* harmony import */ var _portal_d518b571_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./portal-d518b571.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-d518b571.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./functional-44de8fcf.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js");
/* harmony import */ var _functional_81373f6d_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./functional-81373f6d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-81373f6d.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */






















const ArcgisNewItemPagesHome = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.newItemUpdatePage = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
        this.allowedFileTypes = null;
        // Triggered when a file is selected (via drop or button)
        this.fileSelectHandler = async (file, fromLocalDevice) => {
            const { user, portal, config: { helpMap, helpBase }, telemetry } = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c;
            const label = fromLocalDevice ? "your device" : "drag drop";
            const payload = {
                eventType: "new item click",
                pageName: "my content",
                category: "new item",
                label
            };
            telemetry === null || telemetry === void 0 ? void 0 : telemetry.logEvent(payload);
            _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.telemetryDetails = label;
            // Show file uploader?
            // This is probably just going to be an analyze step, not upload - on prod upload doesn't happen till you hit submit at the end
            const { title, fileName, extension } = (0,_file_bf8ab90f_js__WEBPACK_IMPORTED_MODULE_2__.s)(file);
            _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_4__.i.title = title;
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.file = file;
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.fileName = fileName;
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.newItemMode = "file";
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.extension = extension;
            // In case the user goes back to the file select page
            //  and select a different file
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.selectedFields = undefined;
            const possibleItemTypes = (0,_item_types_586f0301_js__WEBPACK_IMPORTED_MODULE_11__.f)(extension);
            const mvFlow = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.workflow === "map";
            if (possibleItemTypes.length === 1) {
                const type = possibleItemTypes[0].type;
                if (type === "GeoJson" &&
                    mvFlow &&
                    !(0,_privileges_74639dae_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal) &&
                    (0,_item_types_586f0301_js__WEBPACK_IMPORTED_MODULE_11__.i)(file.size)) {
                    // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2800
                    this.error = {
                        description: _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.i18n.publishSelect.bigGeoJsonHintPublicAccount,
                        linkText: _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.i18n.common.learnMore,
                        link: `${helpBase}${helpMap["120003923"]}`
                    };
                    return;
                }
                _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.type = type;
                // reset fields UIs with new file
                if (["Microsoft Excel", "CSV", "GeoJson"].includes(type)) {
                    _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.id = null;
                    _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.analyzeResults = null;
                    _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.selectedFields = null;
                    if (type !== "GeoJson") {
                        _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.selectedSheet = null;
                    }
                }
                _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.tileLayerPublishType = type === "3DTiles Package" ? "3dTiles" : undefined;
                const nextStep = possibleItemTypes[0].nextStep;
                // there is no reason to show publishSelect screen for users that can't publish
                // We still need to analyze csv and let users select fields if add directly
                // even if they don't have publish privilege https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2857
                const publicAccountAnalyzeTypes = ["CSV", "Microsoft Excel"];
                if (mvFlow &&
                    !(0,_privileges_74639dae_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal) &&
                    publicAccountAnalyzeTypes.includes(type)) {
                    _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.enablePublishing = false;
                    this.newItemUpdatePage.emit("publishSelect");
                }
                else if (!(0,_privileges_74639dae_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal) ||
                    (!_config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c.allowPublish && nextStep === "publishSelect")) {
                    _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.enablePublishing = false;
                    this.newItemUpdatePage.emit("itemProperties");
                }
                else {
                    this.newItemUpdatePage.emit(nextStep);
                }
            }
            else if (extension === "zip") {
                this.newItemUpdatePage.emit("zipSelect");
                _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.applicationFile = null;
            }
        };
        this.managedFocus = true;
        this.error = undefined;
    }
    componentWillLoad() {
        // Initialize with file and existing item
        //  will not make the modal go into Home
        // So this will not be called -> safe :)
        (0,_utils_9b3ffcf7_js__WEBPACK_IMPORTED_MODULE_8__.a)();
        const { allowedItemTypes, user, portal } = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c;
        if (allowedItemTypes) {
            // These type support both file and url flow
            const urlAndFileTypes = ["CSV", "GeoJson", "KML"];
            this.allowedFileTypes = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c.allowedItemTypes.filter((type) => 
            // Filter out url types that doesn't support file upload
            (!(0,_item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_9__.i)(type) || urlAndFileTypes.includes(type)) &&
                // https://devtopia.esri.com/WebGIS/arcgis-webviewer-app/issues/6013
                !!user &&
                (urlAndFileTypes.includes(type) ||
                    (!(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_3__.a)(user) && (0,_privileges_74639dae_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal))));
            const i18n = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.i18n;
            this.browserHelpText = (0,_i18n_2998ec30_js__WEBPACK_IMPORTED_MODULE_10__.r)(i18n.common.supportFileTypes, this.allowedFileTypes
                .map((type) => { var _a; return (_a = i18n.itemTypeInfo.lowercaseDisplayName[type]) !== null && _a !== void 0 ? _a : type; })
                .join(", "), "typeList");
        }
        if (_ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.workflow === "map" && !_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.existingItem) {
            // Sometimes when we go back, an item has already been created so we need to clean it up
            // For now, it only happens in MV
            // No need to await this, can be done in the background
            this.removeExistingFile();
        }
    }
    onTransitionComplete() {
        var _a;
        (_a = this.fileBrowserRef) === null || _a === void 0 ? void 0 : _a.focusMainInput();
    }
    async removeExistingFile() {
        const id = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.id;
        if (id) {
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.id = null;
            await (0,_server_item_8d384796_js__WEBPACK_IMPORTED_MODULE_5__.d)(id, { permanentDelete: true });
        }
    }
    render() {
        const mvFlow = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.workflow === "map";
        const { allowedFileTypes, error, fileSelectHandler } = this;
        const { portal, config, user, userLicensedItems } = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, null, _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c.allowedModes.includes("file") && ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-file-browser", { ref: (ele) => (this.fileBrowserRef = ele), class: { "full-height": mvFlow }, allowedExtensions: allowedFileTypes ? (0,_item_types_586f0301_js__WEBPACK_IMPORTED_MODULE_11__.m)(allowedFileTypes) : undefined, helpText: this.browserHelpText, fullHeight: mvFlow, portal: portal, config: config, user: user, userLicensedItems: userLicensedItems, onCloudDriveConnected: (event) => {
                var _a;
                const provider = event.detail;
                const payload = {
                    eventType: "new item click",
                    pageName: "my content",
                    category: "new item",
                    label: provider
                };
                (_a = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_1__.c.telemetry) === null || _a === void 0 ? void 0 : _a.logEvent(payload);
                _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_7__.u.telemetryDetails = provider;
                _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_6__.a.cloudProvider = provider;
                this.newItemUpdatePage.emit("cloud");
            }, onFileSelect: ({ detail: { file, source } }) => {
                fileSelectHandler(file, source === "local-device");
            } })), !mvFlow && (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-create-layers-list", null), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { description: error === null || error === void 0 ? void 0 : error.description, link: { href: error === null || error === void 0 ? void 0 : error.link, title: error === null || error === void 0 ? void 0 : error.linkText }, active: !!error, onAlertDismiss: () => (this.error = null) })));
    }
};



//# sourceMappingURL=arcgis-new-item-pages-home.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-bf8ab90f.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-bf8ab90f.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ sanitizeFileName),
/* harmony export */   f: () => (/* binding */ formatFileSize),
/* harmony export */   g: () => (/* binding */ getItemInfoByType),
/* harmony export */   s: () => (/* binding */ sanitizeFileInput),
/* harmony export */   v: () => (/* binding */ validateOverwriteFileName)
/* harmony export */ });
/* harmony import */ var _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./item-types-2029b06b.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-2029b06b.js");
/* harmony import */ var _guid_aeaed84d_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./guid-aeaed84d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-aeaed84d.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



function sanitizeFileName(name, addGUID) {
    //TODO: add new param to spec file.
    const expression = /(?:\.([^.]+))?$/;
    const invalidTitleCharacters = /\.|-/g;
    let fileName = name.replace(/^.*(\\|\/|:)/, "");
    let extension = (fileName && expression.exec(fileName)[1] ? expression.exec(fileName)[1].toLowerCase() : "");
    let title = "";
    if (fileName.indexOf(".rft.") > -1) {
        const [name, suffix] = fileName.split(".rft.");
        extension = `rft.${suffix}`;
        title = name;
    }
    if (fileName && !title) {
        title = fileName.lastIndexOf(".") === -1 ? fileName : fileName.substring(0, fileName.lastIndexOf("."));
    }
    // Replace any invalid characters with an underscore
    title = title.replace(invalidTitleCharacters, "_");
    // Allow file upload of existing item's file name // currently used in append
    if (addGUID) {
        title = makeUniqueFileName(title);
        fileName = `${title}.${extension}`;
    }
    return { title, fileName, extension };
}
// Helper method that takes in a file & returns the cleaned up file name as is and in title form, and the detected file extension
function sanitizeFileInput(file, addGUID) {
    return sanitizeFileName(file.name, !!addGUID);
}
function makeUniqueFileName(name) {
    return `${name}_${(0,_guid_aeaed84d_js__WEBPACK_IMPORTED_MODULE_1__.g)()}`;
}
function validateOverwriteFileName(uploadedFileName, sourceFileName) {
    let fileName = uploadedFileName;
    const position = uploadedFileName.lastIndexOf("\\");
    if (position > -1) {
        fileName = fileName.substring(position + 1, fileName.length);
    }
    return fileName.replace(/\ /g, "_") === sourceFileName.replace(/\ /g, "_");
}
function getItemInfoByType(type) {
    if (_item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_0__.a[type]) {
        return _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_0__.a[type];
    }
    else {
        return _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_0__.a[Object.keys(_item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_0__.a).find((fileType) => _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_0__.a[fileType].type === type)];
    }
}
function formatFileSize(size) {
    if (!size) {
        return "0 B";
    }
    const i = Math.floor(Math.log(size) / Math.log(1024));
    const adjustedSize = Math.round(size / Math.pow(1024, i));
    const unit = ["B", "KB", "MB", "GB", "TB"][i];
    return `${adjustedSize} ${unit}`;
}



//# sourceMappingURL=file-bf8ab90f.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-aeaed84d.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-aeaed84d.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ guid)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
function generateId(counts) {
    return counts
        .map((count) => {
        let out = "";
        for (let i = 0; i < count; i++) {
            out += (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }
        return out;
    })
        .join("-");
}
const guid = () => generateId([2, 1, 1, 1, 3]);



//# sourceMappingURL=guid-aeaed84d.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/i18n-2998ec30.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/i18n-2998ec30.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   r: () => (/* binding */ replaceI18NString)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */
const regexLookupMap = {
    fileName: /\$\{fileName\}/g,
    fileType: /\$\{type\}/g,
    typeList: /\$\{typeList\}/g,
    missingFields: /\$\{\missingFields\}/g
};
const replaceI18NString = (str, replacementString, type) => {
    const typeRegEx = new RegExp(regexLookupMap[type]);
    return str === null || str === void 0 ? void 0 : str.replace(typeRegEx, replacementString);
};



//# sourceMappingURL=i18n-2998ec30.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-586f0301.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-586f0301.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ isLargeCSV),
/* harmony export */   f: () => (/* binding */ findPossibleItemTypesByExtension),
/* harmony export */   i: () => (/* binding */ isLargeGeoJSON),
/* harmony export */   m: () => (/* binding */ mapItemTypesToFileExtensions)
/* harmony export */ });
/* harmony import */ var _functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./functional-44de8fcf.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js");
/* harmony import */ var _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item-types-2029b06b.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-2029b06b.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */



function findPossibleItemTypesByExtension(extension, validationTypes) {
    // Search item types extensions for the one imported
    let itemTypes;
    if (validationTypes) {
        itemTypes = validationTypes.map((value) => {
            return value.type;
        });
    }
    else {
        itemTypes = Object.keys(_item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_1__.a);
    }
    let possibleItemTypes = [];
    itemTypes.forEach((type) => {
        var _a;
        if (((_a = _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_1__.a[type].fileExt) === null || _a === void 0 ? void 0 : _a.indexOf(extension)) >= 0) {
            possibleItemTypes.push(_item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_1__.a[type]);
        }
    });
    return possibleItemTypes;
}
function mapItemTypesToFileExtensions(types) {
    if (!types) {
        return null;
    }
    return (0,_functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_0__.b)(types.flatMap((type) => { var _a; return (_a = _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_1__.a[type]) === null || _a === void 0 ? void 0 : _a.fileExt; }).filter((valid) => !!valid));
}
const isLargeGeoJSON = (sizeInBytes) => {
    const sizeInMB = sizeInBytes / 1024 / 1024;
    // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2553#issuecomment-3645404
    return sizeInMB > 50; // 50MB
};
const isLargeCSV = (sizeInBytes) => {
    const sizeInMB = sizeInBytes / 1024 / 1024;
    // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2875#issuecomment-3748913
    return sizeInMB > 20; // 20MB
};



//# sourceMappingURL=item-types-586f0301.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-9b3ffcf7.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-9b3ffcf7.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ resetStoreOnHome),
/* harmony export */   r: () => (/* binding */ resetAddItemStores)
/* harmony export */ });
/* harmony import */ var _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./item-properties-10491b2e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-properties-10491b2e.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/* harmony import */ var _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui-bca7bcd1.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




function resetAddItemStores() {
    _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.d.reset();
    _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_0__.a.reset();
}
const resetStoreOnHome = () => {
    if (_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.a.existingItem || _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_2__.u.workflow === "register") {
        return;
    }
    _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_1__.d.reset();
    const folder = _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_0__.i.folder;
    _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_0__.a.reset();
    _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_0__.i.folder = folder;
};



//# sourceMappingURL=utils-9b3ffcf7.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTkxOWMwNi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDNEY7QUFDcEM7QUFDSTtBQUNDO0FBQ1k7QUFDYjtBQUNEO0FBQ047QUFDTztBQUNGO0FBQ0U7QUFDNkU7QUFDMUU7QUFDbEM7QUFDRDtBQUNBO0FBQ0Q7QUFDRztBQUNLO0FBQ0Q7QUFDQTs7QUFFbEM7QUFDQTtBQUNBLFFBQVEscURBQWdCO0FBQ3hCLGlDQUFpQyxxREFBVztBQUM1QztBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isd0JBQXdCLG1CQUFtQixjQUFjLEVBQUUsa0RBQVc7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksOENBQVk7QUFDeEI7QUFDQTtBQUNBLG9CQUFvQiw2QkFBNkIsRUFBRSxvREFBaUI7QUFDcEUsWUFBWSwyREFBbUI7QUFDL0IsWUFBWSxvREFBWTtBQUN4QixZQUFZLG9EQUFZO0FBQ3hCLFlBQVksb0RBQVk7QUFDeEIsWUFBWSxvREFBWTtBQUN4QjtBQUNBO0FBQ0EsWUFBWSxvREFBWTtBQUN4QixzQ0FBc0MsMkRBQWdDO0FBQ3RFLDJCQUEyQiw4Q0FBWTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiwyREFBYztBQUNuQyxvQkFBb0IsMkRBQWM7QUFDbEM7QUFDQTtBQUNBLHFDQUFxQyw4Q0FBWTtBQUNqRCxrQ0FBa0MsOENBQVk7QUFDOUMsaUNBQWlDLFNBQVMsRUFBRSxxQkFBcUI7QUFDakU7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG9EQUFZO0FBQzVCO0FBQ0E7QUFDQSxvQkFBb0Isb0RBQVk7QUFDaEMsb0JBQW9CLG9EQUFZO0FBQ2hDLG9CQUFvQixvREFBWTtBQUNoQztBQUNBLHdCQUF3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O0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWtDOztBQUVsQzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUN1RDtBQUNZOztBQUVuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGdDQUFnQyxzREFBa0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsc0RBQWtCO0FBQ3JDLG1DQUFtQyxzREFBa0I7QUFDckQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywwREFBTSwyQkFBMkIsUUFBUSxhQUFhLHNEQUFrQiwwREFBMEQ7QUFDN0k7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7O0FBRTBIOztBQUUxSDs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ21HO0FBQ3JCO0FBQ3pCOztBQUVyRDtBQUNBLElBQUksb0RBQVk7QUFDaEIsSUFBSSwyREFBbUI7QUFDdkI7QUFDQTtBQUNBLFFBQVEsb0RBQVksaUJBQWlCLDhDQUFZO0FBQ2pEO0FBQ0E7QUFDQSxJQUFJLG9EQUFZO0FBQ2hCLG1CQUFtQiwyREFBbUI7QUFDdEMsSUFBSSwyREFBbUI7QUFDdkIsSUFBSSwyREFBbUI7QUFDdkI7O0FBRTBEOztBQUUxRCIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1uZXctaXRlbS1wYWdlcy1ob21lLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2ZpbGUtYmY4YWI5MGYuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vZ3VpZC1hZWFlZDg0ZC5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9pMThuLTI5OThlYzMwLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2l0ZW0tdHlwZXMtNTg2ZjAzMDEuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vdXRpbHMtOWIzZmZjZjcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCB9IGZyb20gJy4vaW5kZXgtZTNiZjdkYTcuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25maWdTdGF0ZSB9IGZyb20gJy4vY29uZmlnLTc1YWRmOTYyLmpzJztcbmltcG9ydCB7IHMgYXMgc2FuaXRpemVGaWxlSW5wdXQgfSBmcm9tICcuL2ZpbGUtYmY4YWI5MGYuanMnO1xuaW1wb3J0IHsgYSBhcyBpc1B1YmxpY1VzZXIgfSBmcm9tICcuL3ByaXZpbGVnZXMtNWMzODJmNjEuanMnO1xuaW1wb3J0IHsgaSBhcyBpdGVtUHJvcGVydGllc1N0YXRlIH0gZnJvbSAnLi9pdGVtLXByb3BlcnRpZXMtMTA0OTFiMmUuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWxldGVJdGVtIH0gZnJvbSAnLi9zZXJ2ZXItaXRlbS04ZDM4NDc5Ni5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tZGJiZTJmNTcuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWJjYTdiY2QxLmpzJztcbmltcG9ydCB7IGEgYXMgcmVzZXRTdG9yZU9uSG9tZSB9IGZyb20gJy4vdXRpbHMtOWIzZmZjZjcuanMnO1xuaW1wb3J0IHsgaSBhcyBpc1VybFR5cGUgfSBmcm9tICcuL2l0ZW0tdHlwZXMtMjAyOWIwNmIuanMnO1xuaW1wb3J0IHsgciBhcyByZXBsYWNlSTE4TlN0cmluZyB9IGZyb20gJy4vaTE4bi0yOTk4ZWMzMC5qcyc7XG5pbXBvcnQgeyBmIGFzIGZpbmRQb3NzaWJsZUl0ZW1UeXBlc0J5RXh0ZW5zaW9uLCBpIGFzIGlzTGFyZ2VHZW9KU09OLCBtIGFzIG1hcEl0ZW1UeXBlc1RvRmlsZUV4dGVuc2lvbnMgfSBmcm9tICcuL2l0ZW0tdHlwZXMtNTg2ZjAzMDEuanMnO1xuaW1wb3J0IHsgYSBhcyBjYW5QdWJsaXNoVHlwZSB9IGZyb20gJy4vcHJpdmlsZWdlcy03NDYzOWRhZS5qcyc7XG5pbXBvcnQgJy4vaW5kZXgtMDU5NTZjYWIuanMnO1xuaW1wb3J0ICcuL2d1aWQtYWVhZWQ4NGQuanMnO1xuaW1wb3J0ICcuL2l0ZW0tMzUzNTU1MmQuanMnO1xuaW1wb3J0ICcuL3VybC00YzNhZTU0Yy5qcyc7XG5pbXBvcnQgJy4vcG9ydGFsLWQ1MThiNTcxLmpzJztcbmltcG9ydCAnLi9sb2FkTW9kdWxlcy1iNGFjMTI0Ny5qcyc7XG5pbXBvcnQgJy4vZnVuY3Rpb25hbC00NGRlOGZjZi5qcyc7XG5pbXBvcnQgJy4vZnVuY3Rpb25hbC04MTM3M2Y2ZC5qcyc7XG5cbmNvbnN0IEFyY2dpc05ld0l0ZW1QYWdlc0hvbWUgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJuZXdJdGVtVXBkYXRlUGFnZVwiLCA3KTtcbiAgICAgICAgdGhpcy5hbGxvd2VkRmlsZVR5cGVzID0gbnVsbDtcbiAgICAgICAgLy8gVHJpZ2dlcmVkIHdoZW4gYSBmaWxlIGlzIHNlbGVjdGVkICh2aWEgZHJvcCBvciBidXR0b24pXG4gICAgICAgIHRoaXMuZmlsZVNlbGVjdEhhbmRsZXIgPSBhc3luYyAoZmlsZSwgZnJvbUxvY2FsRGV2aWNlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHVzZXIsIHBvcnRhbCwgY29uZmlnOiB7IGhlbHBNYXAsIGhlbHBCYXNlIH0sIHRlbGVtZXRyeSB9ID0gY29uZmlnU3RhdGU7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IGZyb21Mb2NhbERldmljZSA/IFwieW91ciBkZXZpY2VcIiA6IFwiZHJhZyBkcm9wXCI7XG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogXCJuZXcgaXRlbSBjbGlja1wiLFxuICAgICAgICAgICAgICAgIHBhZ2VOYW1lOiBcIm15IGNvbnRlbnRcIixcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogXCJuZXcgaXRlbVwiLFxuICAgICAgICAgICAgICAgIGxhYmVsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGVsZW1ldHJ5ID09PSBudWxsIHx8IHRlbGVtZXRyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZW1ldHJ5LmxvZ0V2ZW50KHBheWxvYWQpO1xuICAgICAgICAgICAgdWlTdG9yZVN0YXRlLnRlbGVtZXRyeURldGFpbHMgPSBsYWJlbDtcbiAgICAgICAgICAgIC8vIFNob3cgZmlsZSB1cGxvYWRlcj9cbiAgICAgICAgICAgIC8vIFRoaXMgaXMgcHJvYmFibHkganVzdCBnb2luZyB0byBiZSBhbiBhbmFseXplIHN0ZXAsIG5vdCB1cGxvYWQgLSBvbiBwcm9kIHVwbG9hZCBkb2Vzbid0IGhhcHBlbiB0aWxsIHlvdSBoaXQgc3VibWl0IGF0IHRoZSBlbmRcbiAgICAgICAgICAgIGNvbnN0IHsgdGl0bGUsIGZpbGVOYW1lLCBleHRlbnNpb24gfSA9IHNhbml0aXplRmlsZUlucHV0KGZpbGUpO1xuICAgICAgICAgICAgaXRlbVByb3BlcnRpZXNTdGF0ZS50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgYWRkSXRlbVN0YXRlLmZpbGUgPSBmaWxlO1xuICAgICAgICAgICAgYWRkSXRlbVN0YXRlLmZpbGVOYW1lID0gZmlsZU5hbWU7XG4gICAgICAgICAgICBhZGRJdGVtU3RhdGUubmV3SXRlbU1vZGUgPSBcImZpbGVcIjtcbiAgICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5leHRlbnNpb24gPSBleHRlbnNpb247XG4gICAgICAgICAgICAvLyBJbiBjYXNlIHRoZSB1c2VyIGdvZXMgYmFjayB0byB0aGUgZmlsZSBzZWxlY3QgcGFnZVxuICAgICAgICAgICAgLy8gIGFuZCBzZWxlY3QgYSBkaWZmZXJlbnQgZmlsZVxuICAgICAgICAgICAgYWRkSXRlbVN0YXRlLnNlbGVjdGVkRmllbGRzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgY29uc3QgcG9zc2libGVJdGVtVHlwZXMgPSBmaW5kUG9zc2libGVJdGVtVHlwZXNCeUV4dGVuc2lvbihleHRlbnNpb24pO1xuICAgICAgICAgICAgY29uc3QgbXZGbG93ID0gdWlTdG9yZVN0YXRlLndvcmtmbG93ID09PSBcIm1hcFwiO1xuICAgICAgICAgICAgaWYgKHBvc3NpYmxlSXRlbVR5cGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBwb3NzaWJsZUl0ZW1UeXBlc1swXS50eXBlO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcIkdlb0pzb25cIiAmJlxuICAgICAgICAgICAgICAgICAgICBtdkZsb3cgJiZcbiAgICAgICAgICAgICAgICAgICAgIWNhblB1Ymxpc2hUeXBlKHVzZXIsIHR5cGUsIHBvcnRhbCkgJiZcbiAgICAgICAgICAgICAgICAgICAgaXNMYXJnZUdlb0pTT04oZmlsZS5zaXplKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtYXBwLWNvbXBvbmVudHMvaXNzdWVzLzI4MDBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvciA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB1aVN0b3JlU3RhdGUuaTE4bi5wdWJsaXNoU2VsZWN0LmJpZ0dlb0pzb25IaW50UHVibGljQWNjb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtUZXh0OiB1aVN0b3JlU3RhdGUuaTE4bi5jb21tb24ubGVhcm5Nb3JlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluazogYCR7aGVscEJhc2V9JHtoZWxwTWFwW1wiMTIwMDAzOTIzXCJdfWBcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhZGRJdGVtU3RhdGUudHlwZSA9IHR5cGU7XG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgZmllbGRzIFVJcyB3aXRoIG5ldyBmaWxlXG4gICAgICAgICAgICAgICAgaWYgKFtcIk1pY3Jvc29mdCBFeGNlbFwiLCBcIkNTVlwiLCBcIkdlb0pzb25cIl0uaW5jbHVkZXModHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkSXRlbVN0YXRlLmlkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgYWRkSXRlbVN0YXRlLmFuYWx5emVSZXN1bHRzID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgYWRkSXRlbVN0YXRlLnNlbGVjdGVkRmllbGRzID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgIT09IFwiR2VvSnNvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRJdGVtU3RhdGUuc2VsZWN0ZWRTaGVldCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWRkSXRlbVN0YXRlLnRpbGVMYXllclB1Ymxpc2hUeXBlID0gdHlwZSA9PT0gXCIzRFRpbGVzIFBhY2thZ2VcIiA/IFwiM2RUaWxlc1wiIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRTdGVwID0gcG9zc2libGVJdGVtVHlwZXNbMF0ubmV4dFN0ZXA7XG4gICAgICAgICAgICAgICAgLy8gdGhlcmUgaXMgbm8gcmVhc29uIHRvIHNob3cgcHVibGlzaFNlbGVjdCBzY3JlZW4gZm9yIHVzZXJzIHRoYXQgY2FuJ3QgcHVibGlzaFxuICAgICAgICAgICAgICAgIC8vIFdlIHN0aWxsIG5lZWQgdG8gYW5hbHl6ZSBjc3YgYW5kIGxldCB1c2VycyBzZWxlY3QgZmllbGRzIGlmIGFkZCBkaXJlY3RseVxuICAgICAgICAgICAgICAgIC8vIGV2ZW4gaWYgdGhleSBkb24ndCBoYXZlIHB1Ymxpc2ggcHJpdmlsZWdlIGh0dHBzOi8vZGV2dG9waWEuZXNyaS5jb20vV2ViR0lTL2FyY2dpcy1hcHAtY29tcG9uZW50cy9pc3N1ZXMvMjg1N1xuICAgICAgICAgICAgICAgIGNvbnN0IHB1YmxpY0FjY291bnRBbmFseXplVHlwZXMgPSBbXCJDU1ZcIiwgXCJNaWNyb3NvZnQgRXhjZWxcIl07XG4gICAgICAgICAgICAgICAgaWYgKG12RmxvdyAmJlxuICAgICAgICAgICAgICAgICAgICAhY2FuUHVibGlzaFR5cGUodXNlciwgdHlwZSwgcG9ydGFsKSAmJlxuICAgICAgICAgICAgICAgICAgICBwdWJsaWNBY2NvdW50QW5hbHl6ZVR5cGVzLmluY2x1ZGVzKHR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5lbmFibGVQdWJsaXNoaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UuZW1pdChcInB1Ymxpc2hTZWxlY3RcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFjYW5QdWJsaXNoVHlwZSh1c2VyLCB0eXBlLCBwb3J0YWwpIHx8XG4gICAgICAgICAgICAgICAgICAgICghY29uZmlnU3RhdGUuYWxsb3dQdWJsaXNoICYmIG5leHRTdGVwID09PSBcInB1Ymxpc2hTZWxlY3RcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkSXRlbVN0YXRlLmVuYWJsZVB1Ymxpc2hpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdJdGVtVXBkYXRlUGFnZS5lbWl0KFwiaXRlbVByb3BlcnRpZXNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQobmV4dFN0ZXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGV4dGVuc2lvbiA9PT0gXCJ6aXBcIikge1xuICAgICAgICAgICAgICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UuZW1pdChcInppcFNlbGVjdFwiKTtcbiAgICAgICAgICAgICAgICBhZGRJdGVtU3RhdGUuYXBwbGljYXRpb25GaWxlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5tYW5hZ2VkRm9jdXMgPSB0cnVlO1xuICAgICAgICB0aGlzLmVycm9yID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB3aXRoIGZpbGUgYW5kIGV4aXN0aW5nIGl0ZW1cbiAgICAgICAgLy8gIHdpbGwgbm90IG1ha2UgdGhlIG1vZGFsIGdvIGludG8gSG9tZVxuICAgICAgICAvLyBTbyB0aGlzIHdpbGwgbm90IGJlIGNhbGxlZCAtPiBzYWZlIDopXG4gICAgICAgIHJlc2V0U3RvcmVPbkhvbWUoKTtcbiAgICAgICAgY29uc3QgeyBhbGxvd2VkSXRlbVR5cGVzLCB1c2VyLCBwb3J0YWwgfSA9IGNvbmZpZ1N0YXRlO1xuICAgICAgICBpZiAoYWxsb3dlZEl0ZW1UeXBlcykge1xuICAgICAgICAgICAgLy8gVGhlc2UgdHlwZSBzdXBwb3J0IGJvdGggZmlsZSBhbmQgdXJsIGZsb3dcbiAgICAgICAgICAgIGNvbnN0IHVybEFuZEZpbGVUeXBlcyA9IFtcIkNTVlwiLCBcIkdlb0pzb25cIiwgXCJLTUxcIl07XG4gICAgICAgICAgICB0aGlzLmFsbG93ZWRGaWxlVHlwZXMgPSBjb25maWdTdGF0ZS5hbGxvd2VkSXRlbVR5cGVzLmZpbHRlcigodHlwZSkgPT4gXG4gICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IHVybCB0eXBlcyB0aGF0IGRvZXNuJ3Qgc3VwcG9ydCBmaWxlIHVwbG9hZFxuICAgICAgICAgICAgKCFpc1VybFR5cGUodHlwZSkgfHwgdXJsQW5kRmlsZVR5cGVzLmluY2x1ZGVzKHR5cGUpKSAmJlxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2dG9waWEuZXNyaS5jb20vV2ViR0lTL2FyY2dpcy13ZWJ2aWV3ZXItYXBwL2lzc3Vlcy82MDEzXG4gICAgICAgICAgICAgICAgISF1c2VyICYmXG4gICAgICAgICAgICAgICAgKHVybEFuZEZpbGVUeXBlcy5pbmNsdWRlcyh0eXBlKSB8fFxuICAgICAgICAgICAgICAgICAgICAoIWlzUHVibGljVXNlcih1c2VyKSAmJiBjYW5QdWJsaXNoVHlwZSh1c2VyLCB0eXBlLCBwb3J0YWwpKSkpO1xuICAgICAgICAgICAgY29uc3QgaTE4biA9IHVpU3RvcmVTdGF0ZS5pMThuO1xuICAgICAgICAgICAgdGhpcy5icm93c2VySGVscFRleHQgPSByZXBsYWNlSTE4TlN0cmluZyhpMThuLmNvbW1vbi5zdXBwb3J0RmlsZVR5cGVzLCB0aGlzLmFsbG93ZWRGaWxlVHlwZXNcbiAgICAgICAgICAgICAgICAubWFwKCh0eXBlKSA9PiB7IHZhciBfYTsgcmV0dXJuIChfYSA9IGkxOG4uaXRlbVR5cGVJbmZvLmxvd2VyY2FzZURpc3BsYXlOYW1lW3R5cGVdKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB0eXBlOyB9KVxuICAgICAgICAgICAgICAgIC5qb2luKFwiLCBcIiksIFwidHlwZUxpc3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVpU3RvcmVTdGF0ZS53b3JrZmxvdyA9PT0gXCJtYXBcIiAmJiAhYWRkSXRlbVN0YXRlLmV4aXN0aW5nSXRlbSkge1xuICAgICAgICAgICAgLy8gU29tZXRpbWVzIHdoZW4gd2UgZ28gYmFjaywgYW4gaXRlbSBoYXMgYWxyZWFkeSBiZWVuIGNyZWF0ZWQgc28gd2UgbmVlZCB0byBjbGVhbiBpdCB1cFxuICAgICAgICAgICAgLy8gRm9yIG5vdywgaXQgb25seSBoYXBwZW5zIGluIE1WXG4gICAgICAgICAgICAvLyBObyBuZWVkIHRvIGF3YWl0IHRoaXMsIGNhbiBiZSBkb25lIGluIHRoZSBiYWNrZ3JvdW5kXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUV4aXN0aW5nRmlsZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uVHJhbnNpdGlvbkNvbXBsZXRlKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIChfYSA9IHRoaXMuZmlsZUJyb3dzZXJSZWYpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5mb2N1c01haW5JbnB1dCgpO1xuICAgIH1cbiAgICBhc3luYyByZW1vdmVFeGlzdGluZ0ZpbGUoKSB7XG4gICAgICAgIGNvbnN0IGlkID0gYWRkSXRlbVN0YXRlLmlkO1xuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5pZCA9IG51bGw7XG4gICAgICAgICAgICBhd2FpdCBkZWxldGVJdGVtKGlkLCB7IHBlcm1hbmVudERlbGV0ZTogdHJ1ZSB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IG12RmxvdyA9IHVpU3RvcmVTdGF0ZS53b3JrZmxvdyA9PT0gXCJtYXBcIjtcbiAgICAgICAgY29uc3QgeyBhbGxvd2VkRmlsZVR5cGVzLCBlcnJvciwgZmlsZVNlbGVjdEhhbmRsZXIgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHsgcG9ydGFsLCBjb25maWcsIHVzZXIsIHVzZXJMaWNlbnNlZEl0ZW1zIH0gPSBjb25maWdTdGF0ZTtcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGNvbmZpZ1N0YXRlLmFsbG93ZWRNb2Rlcy5pbmNsdWRlcyhcImZpbGVcIikgJiYgKGgoXCJhcmNnaXMtZmlsZS1icm93c2VyXCIsIHsgcmVmOiAoZWxlKSA9PiAodGhpcy5maWxlQnJvd3NlclJlZiA9IGVsZSksIGNsYXNzOiB7IFwiZnVsbC1oZWlnaHRcIjogbXZGbG93IH0sIGFsbG93ZWRFeHRlbnNpb25zOiBhbGxvd2VkRmlsZVR5cGVzID8gbWFwSXRlbVR5cGVzVG9GaWxlRXh0ZW5zaW9ucyhhbGxvd2VkRmlsZVR5cGVzKSA6IHVuZGVmaW5lZCwgaGVscFRleHQ6IHRoaXMuYnJvd3NlckhlbHBUZXh0LCBmdWxsSGVpZ2h0OiBtdkZsb3csIHBvcnRhbDogcG9ydGFsLCBjb25maWc6IGNvbmZpZywgdXNlcjogdXNlciwgdXNlckxpY2Vuc2VkSXRlbXM6IHVzZXJMaWNlbnNlZEl0ZW1zLCBvbkNsb3VkRHJpdmVDb25uZWN0ZWQ6IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm92aWRlciA9IGV2ZW50LmRldGFpbDtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICAgICAgICAgICAgICBldmVudFR5cGU6IFwibmV3IGl0ZW0gY2xpY2tcIixcbiAgICAgICAgICAgICAgICAgICAgcGFnZU5hbWU6IFwibXkgY29udGVudFwiLFxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogXCJuZXcgaXRlbVwiLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogcHJvdmlkZXJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIChfYSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxvZ0V2ZW50KHBheWxvYWQpO1xuICAgICAgICAgICAgICAgIHVpU3RvcmVTdGF0ZS50ZWxlbWV0cnlEZXRhaWxzID0gcHJvdmlkZXI7XG4gICAgICAgICAgICAgICAgYWRkSXRlbVN0YXRlLmNsb3VkUHJvdmlkZXIgPSBwcm92aWRlcjtcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQoXCJjbG91ZFwiKTtcbiAgICAgICAgICAgIH0sIG9uRmlsZVNlbGVjdDogKHsgZGV0YWlsOiB7IGZpbGUsIHNvdXJjZSB9IH0pID0+IHtcbiAgICAgICAgICAgICAgICBmaWxlU2VsZWN0SGFuZGxlcihmaWxlLCBzb3VyY2UgPT09IFwibG9jYWwtZGV2aWNlXCIpO1xuICAgICAgICAgICAgfSB9KSksICFtdkZsb3cgJiYgaChcImFyY2dpcy1uZXctaXRlbS1jcmVhdGUtbGF5ZXJzLWxpc3RcIiwgbnVsbCksIGgoXCJhcmNnaXMtbmV3LWl0ZW0tYWxlcnRcIiwgeyBkZXNjcmlwdGlvbjogZXJyb3IgPT09IG51bGwgfHwgZXJyb3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVycm9yLmRlc2NyaXB0aW9uLCBsaW5rOiB7IGhyZWY6IGVycm9yID09PSBudWxsIHx8IGVycm9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlcnJvci5saW5rLCB0aXRsZTogZXJyb3IgPT09IG51bGwgfHwgZXJyb3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVycm9yLmxpbmtUZXh0IH0sIGFjdGl2ZTogISFlcnJvciwgb25BbGVydERpc21pc3M6ICgpID0+ICh0aGlzLmVycm9yID0gbnVsbCkgfSkpKTtcbiAgICB9XG59O1xuXG5leHBvcnQgeyBBcmNnaXNOZXdJdGVtUGFnZXNIb21lIGFzIGFyY2dpc19uZXdfaXRlbV9wYWdlc19ob21lIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFyY2dpcy1uZXctaXRlbS1wYWdlcy1ob21lLmVudHJ5LmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYSBhcyBhZGRDcmVhdGVJdGVtVHlwZXMgfSBmcm9tICcuL2l0ZW0tdHlwZXMtMjAyOWIwNmIuanMnO1xuaW1wb3J0IHsgZyBhcyBndWlkIH0gZnJvbSAnLi9ndWlkLWFlYWVkODRkLmpzJztcblxuZnVuY3Rpb24gc2FuaXRpemVGaWxlTmFtZShuYW1lLCBhZGRHVUlEKSB7XG4gICAgLy9UT0RPOiBhZGQgbmV3IHBhcmFtIHRvIHNwZWMgZmlsZS5cbiAgICBjb25zdCBleHByZXNzaW9uID0gLyg/OlxcLihbXi5dKykpPyQvO1xuICAgIGNvbnN0IGludmFsaWRUaXRsZUNoYXJhY3RlcnMgPSAvXFwufC0vZztcbiAgICBsZXQgZmlsZU5hbWUgPSBuYW1lLnJlcGxhY2UoL14uKihcXFxcfFxcL3w6KS8sIFwiXCIpO1xuICAgIGxldCBleHRlbnNpb24gPSAoZmlsZU5hbWUgJiYgZXhwcmVzc2lvbi5leGVjKGZpbGVOYW1lKVsxXSA/IGV4cHJlc3Npb24uZXhlYyhmaWxlTmFtZSlbMV0udG9Mb3dlckNhc2UoKSA6IFwiXCIpO1xuICAgIGxldCB0aXRsZSA9IFwiXCI7XG4gICAgaWYgKGZpbGVOYW1lLmluZGV4T2YoXCIucmZ0LlwiKSA+IC0xKSB7XG4gICAgICAgIGNvbnN0IFtuYW1lLCBzdWZmaXhdID0gZmlsZU5hbWUuc3BsaXQoXCIucmZ0LlwiKTtcbiAgICAgICAgZXh0ZW5zaW9uID0gYHJmdC4ke3N1ZmZpeH1gO1xuICAgICAgICB0aXRsZSA9IG5hbWU7XG4gICAgfVxuICAgIGlmIChmaWxlTmFtZSAmJiAhdGl0bGUpIHtcbiAgICAgICAgdGl0bGUgPSBmaWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIikgPT09IC0xID8gZmlsZU5hbWUgOiBmaWxlTmFtZS5zdWJzdHJpbmcoMCwgZmlsZU5hbWUubGFzdEluZGV4T2YoXCIuXCIpKTtcbiAgICB9XG4gICAgLy8gUmVwbGFjZSBhbnkgaW52YWxpZCBjaGFyYWN0ZXJzIHdpdGggYW4gdW5kZXJzY29yZVxuICAgIHRpdGxlID0gdGl0bGUucmVwbGFjZShpbnZhbGlkVGl0bGVDaGFyYWN0ZXJzLCBcIl9cIik7XG4gICAgLy8gQWxsb3cgZmlsZSB1cGxvYWQgb2YgZXhpc3RpbmcgaXRlbSdzIGZpbGUgbmFtZSAvLyBjdXJyZW50bHkgdXNlZCBpbiBhcHBlbmRcbiAgICBpZiAoYWRkR1VJRCkge1xuICAgICAgICB0aXRsZSA9IG1ha2VVbmlxdWVGaWxlTmFtZSh0aXRsZSk7XG4gICAgICAgIGZpbGVOYW1lID0gYCR7dGl0bGV9LiR7ZXh0ZW5zaW9ufWA7XG4gICAgfVxuICAgIHJldHVybiB7IHRpdGxlLCBmaWxlTmFtZSwgZXh0ZW5zaW9uIH07XG59XG4vLyBIZWxwZXIgbWV0aG9kIHRoYXQgdGFrZXMgaW4gYSBmaWxlICYgcmV0dXJucyB0aGUgY2xlYW5lZCB1cCBmaWxlIG5hbWUgYXMgaXMgYW5kIGluIHRpdGxlIGZvcm0sIGFuZCB0aGUgZGV0ZWN0ZWQgZmlsZSBleHRlbnNpb25cbmZ1bmN0aW9uIHNhbml0aXplRmlsZUlucHV0KGZpbGUsIGFkZEdVSUQpIHtcbiAgICByZXR1cm4gc2FuaXRpemVGaWxlTmFtZShmaWxlLm5hbWUsICEhYWRkR1VJRCk7XG59XG5mdW5jdGlvbiBtYWtlVW5pcXVlRmlsZU5hbWUobmFtZSkge1xuICAgIHJldHVybiBgJHtuYW1lfV8ke2d1aWQoKX1gO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVPdmVyd3JpdGVGaWxlTmFtZSh1cGxvYWRlZEZpbGVOYW1lLCBzb3VyY2VGaWxlTmFtZSkge1xuICAgIGxldCBmaWxlTmFtZSA9IHVwbG9hZGVkRmlsZU5hbWU7XG4gICAgY29uc3QgcG9zaXRpb24gPSB1cGxvYWRlZEZpbGVOYW1lLmxhc3RJbmRleE9mKFwiXFxcXFwiKTtcbiAgICBpZiAocG9zaXRpb24gPiAtMSkge1xuICAgICAgICBmaWxlTmFtZSA9IGZpbGVOYW1lLnN1YnN0cmluZyhwb3NpdGlvbiArIDEsIGZpbGVOYW1lLmxlbmd0aCk7XG4gICAgfVxuICAgIHJldHVybiBmaWxlTmFtZS5yZXBsYWNlKC9cXCAvZywgXCJfXCIpID09PSBzb3VyY2VGaWxlTmFtZS5yZXBsYWNlKC9cXCAvZywgXCJfXCIpO1xufVxuZnVuY3Rpb24gZ2V0SXRlbUluZm9CeVR5cGUodHlwZSkge1xuICAgIGlmIChhZGRDcmVhdGVJdGVtVHlwZXNbdHlwZV0pIHtcbiAgICAgICAgcmV0dXJuIGFkZENyZWF0ZUl0ZW1UeXBlc1t0eXBlXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBhZGRDcmVhdGVJdGVtVHlwZXNbT2JqZWN0LmtleXMoYWRkQ3JlYXRlSXRlbVR5cGVzKS5maW5kKChmaWxlVHlwZSkgPT4gYWRkQ3JlYXRlSXRlbVR5cGVzW2ZpbGVUeXBlXS50eXBlID09PSB0eXBlKV07XG4gICAgfVxufVxuZnVuY3Rpb24gZm9ybWF0RmlsZVNpemUoc2l6ZSkge1xuICAgIGlmICghc2l6ZSkge1xuICAgICAgICByZXR1cm4gXCIwIEJcIjtcbiAgICB9XG4gICAgY29uc3QgaSA9IE1hdGguZmxvb3IoTWF0aC5sb2coc2l6ZSkgLyBNYXRoLmxvZygxMDI0KSk7XG4gICAgY29uc3QgYWRqdXN0ZWRTaXplID0gTWF0aC5yb3VuZChzaXplIC8gTWF0aC5wb3coMTAyNCwgaSkpO1xuICAgIGNvbnN0IHVuaXQgPSBbXCJCXCIsIFwiS0JcIiwgXCJNQlwiLCBcIkdCXCIsIFwiVEJcIl1baV07XG4gICAgcmV0dXJuIGAke2FkanVzdGVkU2l6ZX0gJHt1bml0fWA7XG59XG5cbmV4cG9ydCB7IHNhbml0aXplRmlsZU5hbWUgYXMgYSwgZm9ybWF0RmlsZVNpemUgYXMgZiwgZ2V0SXRlbUluZm9CeVR5cGUgYXMgZywgc2FuaXRpemVGaWxlSW5wdXQgYXMgcywgdmFsaWRhdGVPdmVyd3JpdGVGaWxlTmFtZSBhcyB2IH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZpbGUtYmY4YWI5MGYuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5mdW5jdGlvbiBnZW5lcmF0ZUlkKGNvdW50cykge1xuICAgIHJldHVybiBjb3VudHNcbiAgICAgICAgLm1hcCgoY291bnQpID0+IHtcbiAgICAgICAgbGV0IG91dCA9IFwiXCI7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgb3V0ICs9ICgoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApIHwgMCkudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pXG4gICAgICAgIC5qb2luKFwiLVwiKTtcbn1cbmNvbnN0IGd1aWQgPSAoKSA9PiBnZW5lcmF0ZUlkKFsyLCAxLCAxLCAxLCAzXSk7XG5cbmV4cG9ydCB7IGd1aWQgYXMgZyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1ndWlkLWFlYWVkODRkLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuY29uc3QgcmVnZXhMb29rdXBNYXAgPSB7XG4gICAgZmlsZU5hbWU6IC9cXCRcXHtmaWxlTmFtZVxcfS9nLFxuICAgIGZpbGVUeXBlOiAvXFwkXFx7dHlwZVxcfS9nLFxuICAgIHR5cGVMaXN0OiAvXFwkXFx7dHlwZUxpc3RcXH0vZyxcbiAgICBtaXNzaW5nRmllbGRzOiAvXFwkXFx7XFxtaXNzaW5nRmllbGRzXFx9L2dcbn07XG5jb25zdCByZXBsYWNlSTE4TlN0cmluZyA9IChzdHIsIHJlcGxhY2VtZW50U3RyaW5nLCB0eXBlKSA9PiB7XG4gICAgY29uc3QgdHlwZVJlZ0V4ID0gbmV3IFJlZ0V4cChyZWdleExvb2t1cE1hcFt0eXBlXSk7XG4gICAgcmV0dXJuIHN0ciA9PT0gbnVsbCB8fCBzdHIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0ci5yZXBsYWNlKHR5cGVSZWdFeCwgcmVwbGFjZW1lbnRTdHJpbmcpO1xufTtcblxuZXhwb3J0IHsgcmVwbGFjZUkxOE5TdHJpbmcgYXMgciB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pMThuLTI5OThlYzMwLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgYiBhcyB1bmlxdWUgfSBmcm9tICcuL2Z1bmN0aW9uYWwtNDRkZThmY2YuanMnO1xuaW1wb3J0IHsgYSBhcyBhZGRDcmVhdGVJdGVtVHlwZXMgfSBmcm9tICcuL2l0ZW0tdHlwZXMtMjAyOWIwNmIuanMnO1xuXG5mdW5jdGlvbiBmaW5kUG9zc2libGVJdGVtVHlwZXNCeUV4dGVuc2lvbihleHRlbnNpb24sIHZhbGlkYXRpb25UeXBlcykge1xuICAgIC8vIFNlYXJjaCBpdGVtIHR5cGVzIGV4dGVuc2lvbnMgZm9yIHRoZSBvbmUgaW1wb3J0ZWRcbiAgICBsZXQgaXRlbVR5cGVzO1xuICAgIGlmICh2YWxpZGF0aW9uVHlwZXMpIHtcbiAgICAgICAgaXRlbVR5cGVzID0gdmFsaWRhdGlvblR5cGVzLm1hcCgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS50eXBlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGl0ZW1UeXBlcyA9IE9iamVjdC5rZXlzKGFkZENyZWF0ZUl0ZW1UeXBlcyk7XG4gICAgfVxuICAgIGxldCBwb3NzaWJsZUl0ZW1UeXBlcyA9IFtdO1xuICAgIGl0ZW1UeXBlcy5mb3JFYWNoKCh0eXBlKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKCgoX2EgPSBhZGRDcmVhdGVJdGVtVHlwZXNbdHlwZV0uZmlsZUV4dCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluZGV4T2YoZXh0ZW5zaW9uKSkgPj0gMCkge1xuICAgICAgICAgICAgcG9zc2libGVJdGVtVHlwZXMucHVzaChhZGRDcmVhdGVJdGVtVHlwZXNbdHlwZV0pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHBvc3NpYmxlSXRlbVR5cGVzO1xufVxuZnVuY3Rpb24gbWFwSXRlbVR5cGVzVG9GaWxlRXh0ZW5zaW9ucyh0eXBlcykge1xuICAgIGlmICghdHlwZXMpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB1bmlxdWUodHlwZXMuZmxhdE1hcCgodHlwZSkgPT4geyB2YXIgX2E7IHJldHVybiAoX2EgPSBhZGRDcmVhdGVJdGVtVHlwZXNbdHlwZV0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5maWxlRXh0OyB9KS5maWx0ZXIoKHZhbGlkKSA9PiAhIXZhbGlkKSk7XG59XG5jb25zdCBpc0xhcmdlR2VvSlNPTiA9IChzaXplSW5CeXRlcykgPT4ge1xuICAgIGNvbnN0IHNpemVJbk1CID0gc2l6ZUluQnl0ZXMgLyAxMDI0IC8gMTAyNDtcbiAgICAvLyBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtYXBwLWNvbXBvbmVudHMvaXNzdWVzLzI1NTMjaXNzdWVjb21tZW50LTM2NDU0MDRcbiAgICByZXR1cm4gc2l6ZUluTUIgPiA1MDsgLy8gNTBNQlxufTtcbmNvbnN0IGlzTGFyZ2VDU1YgPSAoc2l6ZUluQnl0ZXMpID0+IHtcbiAgICBjb25zdCBzaXplSW5NQiA9IHNpemVJbkJ5dGVzIC8gMTAyNCAvIDEwMjQ7XG4gICAgLy8gaHR0cHM6Ly9kZXZ0b3BpYS5lc3JpLmNvbS9XZWJHSVMvYXJjZ2lzLWFwcC1jb21wb25lbnRzL2lzc3Vlcy8yODc1I2lzc3VlY29tbWVudC0zNzQ4OTEzXG4gICAgcmV0dXJuIHNpemVJbk1CID4gMjA7IC8vIDIwTUJcbn07XG5cbmV4cG9ydCB7IGlzTGFyZ2VDU1YgYXMgYSwgZmluZFBvc3NpYmxlSXRlbVR5cGVzQnlFeHRlbnNpb24gYXMgZiwgaXNMYXJnZUdlb0pTT04gYXMgaSwgbWFwSXRlbVR5cGVzVG9GaWxlRXh0ZW5zaW9ucyBhcyBtIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWl0ZW0tdHlwZXMtNTg2ZjAzMDEuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyBhIGFzIGl0ZW1Qcm9wZXJ0aWVzU3RvcmUsIGkgYXMgaXRlbVByb3BlcnRpZXNTdGF0ZSB9IGZyb20gJy4vaXRlbS1wcm9wZXJ0aWVzLTEwNDkxYjJlLmpzJztcbmltcG9ydCB7IGQgYXMgYWRkSXRlbVN0b3JlLCBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tZGJiZTJmNTcuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWJjYTdiY2QxLmpzJztcblxuZnVuY3Rpb24gcmVzZXRBZGRJdGVtU3RvcmVzKCkge1xuICAgIGFkZEl0ZW1TdG9yZS5yZXNldCgpO1xuICAgIGl0ZW1Qcm9wZXJ0aWVzU3RvcmUucmVzZXQoKTtcbn1cbmNvbnN0IHJlc2V0U3RvcmVPbkhvbWUgPSAoKSA9PiB7XG4gICAgaWYgKGFkZEl0ZW1TdGF0ZS5leGlzdGluZ0l0ZW0gfHwgdWlTdG9yZVN0YXRlLndvcmtmbG93ID09PSBcInJlZ2lzdGVyXCIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhZGRJdGVtU3RvcmUucmVzZXQoKTtcbiAgICBjb25zdCBmb2xkZXIgPSBpdGVtUHJvcGVydGllc1N0YXRlLmZvbGRlcjtcbiAgICBpdGVtUHJvcGVydGllc1N0b3JlLnJlc2V0KCk7XG4gICAgaXRlbVByb3BlcnRpZXNTdGF0ZS5mb2xkZXIgPSBmb2xkZXI7XG59O1xuXG5leHBvcnQgeyByZXNldFN0b3JlT25Ib21lIGFzIGEsIHJlc2V0QWRkSXRlbVN0b3JlcyBhcyByIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLTliM2ZmY2Y3LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==