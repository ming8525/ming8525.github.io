System.register(["jimu-core"], function(__WEBPACK_DYNAMIC_EXPORT__, __system_context__) {
	var __WEBPACK_EXTERNAL_MODULE_jimu_core__ = {};
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_core__, "__esModule", { value: true });
	return {
		setters: [
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_core__[key] = module[key];
				});
			}
		],
		execute: function() {
			__WEBPACK_DYNAMIC_EXPORT__(
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./jimu-core/lib/data-sources/base-classes/abstract-data-source.ts":
/*!*************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/abstract-data-source.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractDataSource: () => (/* binding */ AbstractDataSource)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _data_record__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./data-record */ "./jimu-core/lib/data-sources/base-classes/data-record.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Include the common implementations for datasource.
 */
class AbstractDataSource {
    constructor(options) {
        this.isDataSourceSet = false;
        this.records = [];
        this.dataSourceManager = options.dataSourceManager;
        Object.assign(this, options);
        this.originDataSourceJson = options.dataSourceJson;
        if (options.dataSourceJson) { // main data source
            this.isDataView = false;
            this.isLocal = false;
            if (options.dataSourceJson.url) {
                this.url = options.dataSourceJson.url;
            }
        }
        else {
            if (!options.belongToDataSource) {
                console.error('bad DataSourceConstructorOptions.');
                return;
            }
            if (options.localId) {
                this.isLocal = true;
                this.isDataView = false;
            }
            else {
                this.isLocal = false;
                this.isDataView = true;
            }
        }
        if (this.getDataSourceJson().isDataInDataSourceInstance) { // Use source records as source.
            this.sourceRecords = options.sourceRecords;
            // Reset other sources info.
            this.url = null;
        }
        if (this.isLocal) {
            this.listenSelection = false;
        }
        else {
            this.listenSelection = true;
        }
    }
    ready() {
        return Promise.resolve();
    }
    get url() {
        if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getWhetherUseProxy()) {
            return this._url;
        }
        const proxyUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDataSourceProxyUrl(this._url);
        return proxyUrl || this._url;
    }
    set url(u) {
        this._url = u;
    }
    isInAppConfig() {
        var _a, _b;
        return !!((_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig.dataSources) === null || _a === void 0 ? void 0 : _a[((_b = this.getRootDataSource()) === null || _b === void 0 ? void 0 : _b.id) || this.id]);
    }
    getLabel() {
        if (this.isLocal) {
            return this.belongToDataSource.getLabel();
        }
        if (this.isDataView) {
            if (this.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.OUTPUT_DATA_VIEW_ID && this.getDataSourceJson().isOutputFromWidget) {
                return jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'outputView' }, { dataSourceLabel: this.belongToDataSource.getLabel() });
            }
            const mainDsJson = this.getMainDataSource().getDataSourceJson();
            const dataViewJson = (mainDsJson === null || mainDsJson === void 0 ? void 0 : mainDsJson.dataViews) && mainDsJson.dataViews[this.dataViewId];
            return (dataViewJson === null || dataViewJson === void 0 ? void 0 : dataViewJson.label) || this.belongToDataSource.getLabel();
        }
        const mainDataSourceLabel = this.getDataSourceJson().label || this.getSchema().label;
        return mainDataSourceLabel;
    }
    getDataSourceJson() {
        if (this.isDataView || this.isLocal) {
            let dsJson = this.getMainDataSource().getDataSourceJson();
            if (this.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID) {
                dsJson = dsJson.set('isDataInDataSourceInstance', true);
            }
            return dsJson;
        }
        return this.dataSourceJson;
    }
    setDataSourceJson(dsJson) {
        if (!dsJson) {
            this.dataSourceJson = this.originDataSourceJson; // reset data source json
            return;
        }
        if (this.dataSourceJson) {
            this.dataSourceJson = this.traverseToMergeDataSourceJson(this.dataSourceJson, dsJson);
        }
        else {
            this.dataSourceJson = dsJson;
        }
    }
    traverseToMergeDataSourceJson(baseDsJson, newDsJson) {
        if (!baseDsJson && !newDsJson) {
            console.error('Can not merge data source json since do not have base data source json or new data source json.');
            return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
        }
        else if (!baseDsJson) {
            return newDsJson;
        }
        else if (!newDsJson) {
            return baseDsJson;
        }
        const currentDs = this.dataSourceManager.getDataSource(baseDsJson.id);
        if (!currentDs) {
            return baseDsJson;
        }
        let mergedDsJson = baseDsJson.merge(newDsJson.asMutable({ deep: true }));
        /**
         * The following properties are editable properties in data source json.
         * Other properties in data source json are not allowed to be changed. Changing them may break data source.
         */
        const editablePropertiesInDsJson = ['label', 'isHidden', 'useFields', 'query', 'dataViews', 'childDataSourceJsons', 'schema', 'url', 'itemId', 'portalUrl'];
        editablePropertiesInDsJson.forEach(key => {
            // If one editable property is deleted in new data source json, should delete it from the merged data source json.
            if (!newDsJson[key]) {
                mergedDsJson = mergedDsJson.without(key);
            }
            // If schema is updated in new data source json, use the new schema.
            if (newDsJson[key] && key === 'schema') {
                mergedDsJson = mergedDsJson.set('schema', newDsJson.schema);
            }
            // If AGOL/portal info is updated in new data source json, update the accrodingly info in the current data source.
            if (newDsJson[key] && (key === 'url' || key === 'portalUrl' || key === 'itemId')) {
                mergedDsJson = mergedDsJson.set(key, newDsJson[key]);
                currentDs[key] = newDsJson[key];
                if (currentDs.canSaveSourceRecords()) {
                    currentDs.getAllDerivedDataSources().forEach(ds => {
                        ds[key] = newDsJson[key];
                    });
                }
            }
            // If there are some fields used in previous data source json, should copy them to the merged data source json.
            if (baseDsJson[key] && key === 'useFields') {
                // If schema is updated, only copy consistant fields to the merged data source json.
                if (newDsJson.schema) {
                    mergedDsJson = mergedDsJson.set('useFields', baseDsJson.useFields.filter(jimuName => { var _a; return !!((_a = newDsJson.schema.fields) === null || _a === void 0 ? void 0 : _a[jimuName]); }));
                }
                else { // If schema keeps the same, copy all fields to the merged data source json.
                    mergedDsJson = mergedDsJson.set('useFields', baseDsJson.useFields);
                }
            }
        });
        if (mergedDsJson.childDataSourceJsons) {
            Object.keys(mergedDsJson.childDataSourceJsons).forEach(jimuChildId => {
                var _a;
                const mergedChildDsJson = currentDs.traverseToMergeDataSourceJson((_a = baseDsJson === null || baseDsJson === void 0 ? void 0 : baseDsJson.childDataSourceJsons) === null || _a === void 0 ? void 0 : _a[jimuChildId], newDsJson.childDataSourceJsons[jimuChildId]);
                mergedDsJson = mergedDsJson.setIn(['childDataSourceJsons', jimuChildId], mergedChildDsJson);
            });
        }
        return mergedDsJson;
    }
    getSchema() {
        // data view does not have schema
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getSchema();
        }
        return this.schema || {};
    }
    getSelectedFields() {
        var _a, _b, _c, _d;
        let outFields;
        if (this.isLocal) {
            return this.belongToDataSource.getSelectedFields();
        }
        if (this.isSelectionView() || this.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.OUTPUT_DATA_VIEW_ID) {
            return this.getMainDataSource().getSelectedFields();
        }
        const allFields = ((_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields) ? Object.keys(this.getSchema().fields) : [];
        if (this.isDataView) {
            outFields = (_c = (_b = this.getDataSourceJson().dataViews) === null || _b === void 0 ? void 0 : _b[this.dataViewId]) === null || _c === void 0 ? void 0 : _c.outFields;
        }
        else {
            outFields = (_d = this.getDataSourceJson().query) === null || _d === void 0 ? void 0 : _d.outFields;
        }
        if (!outFields && !this.selectedFields) {
            return allFields;
        }
        let realSelectedFields = allFields;
        if (outFields) {
            realSelectedFields = realSelectedFields.filter(fName => outFields.includes(fName));
        }
        if (this.selectedFields) {
            realSelectedFields = realSelectedFields.filter(fName => this.selectedFields.includes(fName));
        }
        // fields must in outFields, at the same time, in selectedFields
        return realSelectedFields;
    }
    // Return used filleds saved in config and fields load on demand.
    getAllUsedFields(options) {
        let usedFields;
        if (this.getLoadOnDemandUsedFields() === '*') {
            usedFields = this.getLoadOnDemandUsedFields(options);
        }
        else {
            usedFields = this.mergeUsedFields(this.getLoadOnDemandUsedFields(options), this.getConfigUsedFields(options));
        }
        if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug' && usedFields === '*') {
            console.warn('All used fields are * since used fields length equals schema fields length.');
        }
        return usedFields;
    }
    _printUsedFieldsDetail(options) {
        this.getAllUsedFields(Object.assign({ logLevel: 'debug', excludeWidgetsDoNotUseDsToQuery: true }, options));
    }
    // Return used fields load on demand.
    getLoadOnDemandUsedFields(options) {
        if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
            console.log('Load on demand fields are:', this.loadOnDemandFields);
        }
        return this.loadOnDemandFields;
    }
    // Return used fields saved in config.
    getConfigUsedFields(options) {
        var _a, _b, _c;
        /**
         * Widgets don't save used fields of local data source. Widgets can use query params to indicate which fields should be loaded.
         *
         * TODO: widget doesn't save used fields of local data source, which will cause that local data sources may not work after data mapping.
         */
        if (this.isLocal) {
            return [];
        }
        // Used fields of no_selection view should be the same as selection view.
        if (this.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION) {
            return (_a = this.getMainDataSource().getDataView(jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID)) === null || _a === void 0 ? void 0 : _a.getAllUsedFields();
        }
        if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
            console.group('Config used fields');
        }
        const widgets = (_b = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig) === null || _b === void 0 ? void 0 : _b.widgets;
        const messages = (_c = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig) === null || _c === void 0 ? void 0 : _c.messageConfigs;
        let actionsArr = [];
        messages && Object.values(messages).forEach(m => {
            var _a, _b;
            if (m.actions) {
                actionsArr = actionsArr.concat((_b = (_a = m.actions).asMutable) === null || _b === void 0 ? void 0 : _b.call(_a));
            }
        });
        const widgetsArr = widgets ? Object.values(widgets) : [];
        const jsonsWithUseDss = widgetsArr.concat(actionsArr);
        const usedFields = [];
        jsonsWithUseDss.every(w => {
            var _a, _b;
            // Whether should exclude the widget based on options and widget properties.
            const excludeTheWidgetForCurrentDs = (options === null || options === void 0 ? void 0 : options.excludeWidgetsDoNotUseDsToQuery) && ((_b = (_a = w.manifest) === null || _a === void 0 ? void 0 : _a.properties) === null || _b === void 0 ? void 0 : _b.notAutoLoadUsedFieldsData);
            w.useDataSources && w.useDataSources.every(u => {
                var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;
                /**
                 * Skip the use data source if it is not selection view of the current data source and should exclude the widget.
                 * The reason why won't skip the use data source if it is selection view is that selection view uses client-side query, it needs its main data source/data views to load its used fields from remote database.
                 */
                if ((u === null || u === void 0 ? void 0 : u.dataSourceId) !== ((_a = this.getSelectionDataView()) === null || _a === void 0 ? void 0 : _a.id) && excludeTheWidgetForCurrentDs) {
                    return true;
                }
                /**
                 * These used fields should be loaded:
                 * 1. used fields of current data source should be loaded,
                 * 2. used fields of current data source's selection view should be loaded,
                 * 3. if current data source is selection view, used fields of all data sources which are derived from the same main data source should be loaded,
                 * 4. if current data source is output data source and schema is same as its origin data source, used fields of its origin data source should be loaded,
                 * 5. if current data source is the associated data source of data source A , use fields of data source A should be loaded.
                 *
                 * 2 is to reduce requests, load more fields for selection view to use.
                 * 3 is for expression, widget can select a data view / main data, but use its selection view to create expression.
                 */
                const useCurrentDataSource = (u === null || u === void 0 ? void 0 : u.dataSourceId) === this.id;
                const useSelectionViewOfCurrentDataSource = (u === null || u === void 0 ? void 0 : u.dataSourceId) === ((_b = this.getSelectionDataView()) === null || _b === void 0 ? void 0 : _b.id);
                const useOtherViewsDerivedFromSameMainDsWithSelectionView = this.isSelectionView() && (u === null || u === void 0 ? void 0 : u.mainDataSourceId) === this.getMainDataSource().id;
                const useOriginDataSource = this.getDataSourceJson().isOutputFromWidget && !this.getDataSourceJson().schema && ((_c = this.getDataSourceJson().originDataSources) === null || _c === void 0 ? void 0 : _c.length) === 1 && (u === null || u === void 0 ? void 0 : u.dataSourceId) === this.getDataSourceJson().originDataSources[0].dataSourceId;
                const useAssociatedDataSource = (u === null || u === void 0 ? void 0 : u.dataSourceId) === ((_f = (_e = (_d = this).getAssociatedDataSource) === null || _e === void 0 ? void 0 : _e.call(_d)) === null || _f === void 0 ? void 0 : _f.id);
                if (useCurrentDataSource || useSelectionViewOfCurrentDataSource || useOtherViewsDerivedFromSameMainDsWithSelectionView || useOriginDataSource || useAssociatedDataSource) {
                    // 1. Use fields directly.
                    if (u.fields) {
                        usedFields.push(...u.fields);
                    }
                    // 2. Use fields configured in popup.
                    if (u.useFieldsInPopupInfo) {
                        const popupInfoFields = ((_l = (_k = (_j = (_h = (_g = this).getPopupInfo) === null || _h === void 0 ? void 0 : _h.call(_g)) === null || _j === void 0 ? void 0 : _j.fieldInfos) === null || _k === void 0 ? void 0 : _k.map(fieldInfo => this.findJimuFieldName(fieldInfo.fieldName))) === null || _l === void 0 ? void 0 : _l.filter(f => !!f)) || [];
                        /**
                         * If the data source doesn't have popup info but widgets declared to use popup info, will treat all fields as used fields.
                         */
                        if (popupInfoFields.length > 0) {
                            usedFields.push(...popupInfoFields);
                        }
                        else {
                            if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
                                console.warn('Config used fields are * since widget uses popup info fields, but can not find them.', w.id || w.actionId);
                            }
                            usedFields.push('*');
                        }
                    }
                    // 3. Use fields in symbol.
                    if (u.useFieldsInSymbol) {
                        if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
                            console.warn('Config used fields are * since widget uses symbol fields.', w.id || w.actionId);
                        }
                        // We do not calculate which fields are in symbol, just add all fields simply.
                        usedFields.push('*');
                    }
                }
                // Break the loop if used fields contain '*'
                return !usedFields.includes('*');
            });
            if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
                console.log('Accumulated config used fields are:', usedFields, w.id || w.actionId);
            }
            // Break the loop if used fields contain '*'
            return !usedFields.includes('*');
        });
        let configUsedFields = usedFields.includes('*') ? '*' : Array.from(new Set(usedFields));
        if (configUsedFields !== '*') {
            configUsedFields = configUsedFields.filter(f => { var _a, _b; return !!((_b = (_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields) === null || _b === void 0 ? void 0 : _b[f]); });
        }
        if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
            console.log('Final config used fields are:', usedFields);
            console.groupEnd();
        }
        return configUsedFields;
    }
    updateLoadOnDemandFields(usedFields) {
        if (!usedFields) {
            return;
        }
        this.loadOnDemandFields = this.mergeUsedFields(this.loadOnDemandFields, this.findMissingFields(usedFields, this.getConfigUsedFields()));
        if (this.loadOnDemandFields !== '*') {
            this.loadOnDemandFields = this.loadOnDemandFields.filter(f => { var _a, _b; return !!((_b = (_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields) === null || _b === void 0 ? void 0 : _b[f]); });
        }
    }
    mergeUsedFields(baseUsedFields, newUsedFields) {
        if (baseUsedFields === '*' || newUsedFields === '*') {
            return '*';
        }
        else if (Array.isArray(baseUsedFields) && Array.isArray(newUsedFields)) {
            let res = Array.from(new Set((baseUsedFields).concat(newUsedFields))).filter(f => !!f);
            if (res.length === Object.keys(this.getSchema().fields).length) {
                res = '*';
            }
            return res;
        }
        else {
            return baseUsedFields || newUsedFields || [];
        }
    }
    missingSomeFields(usedFields, currentFields) {
        if (currentFields === '*') {
            return false;
        }
        return this.findMissingFields(usedFields, currentFields).length > 0;
    }
    /**
     * Compare usedFields with currentFields, find out the fields which are in usedFields but are not in currentFields.
     */
    findMissingFields(usedFields, currentFields) {
        const selectedFields = this.getSelectedFields();
        const f1 = usedFields === '*' ? selectedFields : usedFields;
        const f2 = currentFields === '*' ? selectedFields : currentFields;
        const missingFields = [];
        f1 === null || f1 === void 0 ? void 0 : f1.forEach(f => {
            if (!(f2 === null || f2 === void 0 ? void 0 : f2.includes(f))) {
                missingFields.push(f);
            }
        });
        return missingFields;
    }
    findJimuFieldName(originFieldName) {
        const schema = this.getSchema();
        let jimuFieldName = null;
        if (schema === null || schema === void 0 ? void 0 : schema.fields) {
            jimuFieldName = Object.keys(schema.fields).find(jimuFieldName => schema.fields[jimuFieldName].name === originFieldName);
        }
        return jimuFieldName;
    }
    setSelectedFields(jimuNames) {
        this.selectedFields = jimuNames;
    }
    setSchema(schema) {
        this.schema = schema;
    }
    fetchSchema() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({}));
        });
    }
    getFetchedSchema() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getFetchedSchema();
        }
        return this.fetchedSchema;
    }
    setFetchedSchema(fetchedSchema) {
        this.fetchedSchema = fetchedSchema;
    }
    getGeometryType() {
        return null;
    }
    getReversedConfigSchema() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getReversedConfigSchema();
        }
        if (this.reverseSchema) {
            return this.reverseSchema;
        }
        if (this.isDataSourceSet) {
            const schema = this.getDataSourceJson().schema;
            const rSchema = { childSchemas: {} };
            if (!schema) {
                return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
            }
            if (!schema.childSchemas) {
                return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
                    label: schema.label,
                    childId: schema.childId,
                    jimuChildId: schema.jimuChildId
                });
            }
            Object.keys(schema.childSchemas).forEach(jimuChildId => {
                const actualChildId = schema.childSchemas[jimuChildId].childId;
                if (rSchema.childSchemas[actualChildId]) {
                    rSchema.childSchemas[actualChildId].push(this.getOneReversedConfigSchema(schema.childSchemas[jimuChildId]));
                }
                else {
                    rSchema.childSchemas[actualChildId] = [this.getOneReversedConfigSchema(schema.childSchemas[jimuChildId])];
                }
            });
            this.reverseSchema = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(rSchema);
        }
        else {
            this.reverseSchema = this.getOneReversedConfigSchema(this.getDataSourceJson().schema);
        }
        return this.reverseSchema;
    }
    setRecords(records) {
        this.records = records;
        this.addVersion();
    }
    /**
     * @param schema
     */
    getOneReversedConfigSchema(schema) {
        const reversedSchema = {};
        if (!schema) {
            return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(reversedSchema);
        }
        reversedSchema.fields = {};
        Object.keys(schema.fields).forEach(jimuName => {
            const field = schema.fields[jimuName].asMutable({ deep: true });
            if (reversedSchema.fields[field.name]) {
                (reversedSchema.fields[field.name]).push(field);
            }
            else {
                (reversedSchema.fields[field.name]) = [field];
            }
        });
        schema.childId && (reversedSchema.childId = schema.childId);
        schema.jimuChildId && (reversedSchema.jimuChildId = schema.jimuChildId);
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(reversedSchema);
    }
    getStatus() {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id] && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id].status;
    }
    setStatus(status) {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceStatusChanged(this.id, status));
    }
    getCountStatus() {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id] && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id].countStatus;
    }
    setCountStatus(status) {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceCountStatusChanged(this.id, status));
    }
    getVersion() {
        var _a;
        return (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id]) === null || _a === void 0 ? void 0 : _a.version;
    }
    addVersion() {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceVersionAdded(this.id));
    }
    getSourceVersion() {
        var _a;
        if (this.canSaveSourceRecords()) {
            return (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id]) === null || _a === void 0 ? void 0 : _a.sourceVersion;
        }
        else {
            return this.getMainDataSource().getSourceVersion();
        }
    }
    addSourceVersion() {
        if (this.canSaveSourceRecords()) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceSourceVersionAdded(this.id));
        }
    }
    getSelectedRecordIdsFromInfo() {
        var _a, _b;
        return ((_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo) === null || _a === void 0 ? void 0 : _a[this.id]) === null || _b === void 0 ? void 0 : _b.selectedIds) || (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]);
    }
    getSelectOptionsFromInfo() {
        var _a, _b;
        return (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo) === null || _a === void 0 ? void 0 : _a[this.id]) === null || _b === void 0 ? void 0 : _b.selectOptions;
    }
    updateSelectionInfo(options, triggerDataSource) {
        if (!options) {
            return;
        }
        /**
         * Update selected record ids only when current data source listens selection or current data source is the data source which triggers selection.
         */
        if (this.getListenSelection() || this.id === (triggerDataSource === null || triggerDataSource === void 0 ? void 0 : triggerDataSource.id)) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceSelectionChanged(this.id, options));
        }
    }
    buildRecord(data) {
        return new _data_record__WEBPACK_IMPORTED_MODULE_2__.SimpleDataRecordImpl(data, this);
    }
    getRecords() {
        return this.records;
    }
    getRecordsWithSelection() {
        return this.concatRecordsAndSelection(this.getSelectedRecords(), this.getRecords());
    }
    /**
     * If the selected records have not been loaded, they will be filled to the start of the records array.
     * These selected records should match query params of current data source.
     */
    concatRecordsAndSelection(selectRecords, records) {
        var _a;
        const newRecords = records || [];
        (_a = selectRecords === null || selectRecords === void 0 ? void 0 : selectRecords.reverse()) === null || _a === void 0 ? void 0 : _a.forEach(selectedRecord => {
            const isSelectedRecordLoaded = records === null || records === void 0 ? void 0 : records.some(r => (r === null || r === void 0 ? void 0 : r.getId()) === (selectedRecord === null || selectedRecord === void 0 ? void 0 : selectedRecord.getId()));
            if (!isSelectedRecordLoaded) {
                newRecords.unshift(selectedRecord);
            }
        });
        return newRecords;
    }
    clearSourceRecordsNotAddVersion() {
        this.clearRecordsNotAddVersion();
        this.sourceRecords = [];
    }
    clearSourceRecords() {
        this.clearSourceRecordsNotAddVersion();
        this.addSourceVersion();
        this.addVersion();
    }
    setSourceRecords(records) {
        if (this.canSaveSourceRecords()) {
            // Clear loaded records and selected records in current data source, will add version in the end.
            this.clearRecordsNotAddVersion();
            // Selected record ids of selection view is always empty array, no need to reset it.
            const resetSelectionInfo = !this.isSelectionView();
            if (resetSelectionInfo) {
                jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
                    this.updateSelectionInfo({ widgetId: null, ids: [] }, this.getMainDataSource());
                });
            }
            this.sourceRecords = records.filter(r => !!r).map(r => {
                r.dataSource = this;
                return r;
            });
            // Clear loaded records and selected records in derived data sources.
            this.getAllDerivedDataSources().forEach(ds => {
                ds.clearRecords();
                if (resetSelectionInfo) {
                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
                        ds.updateSelectionInfo({ widgetId: null, ids: [] }, ds.getMainDataSource());
                    });
                }
            });
            this.addSourceVersion();
            this.addVersion();
        }
    }
    getSourceRecords() {
        var _a;
        if (!this.canSaveSourceRecords()) {
            if (this.isLocalViewOfSelectionView()) { // If is local view of a selection view, should use selection view's source.
                return this.belongToDataSource.getSourceRecords();
            }
            else {
                return this.getMainDataSource().getSourceRecords();
            }
        }
        let sourceRecords = this.sourceRecords || [];
        if (this.useNoSelectionView(this)) {
            const noSelectionView = this.getMainDataSource().getDataView(jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION);
            if (noSelectionView) {
                // Change data source of record to current data source.
                sourceRecords = (_a = noSelectionView.getRecords()) === null || _a === void 0 ? void 0 : _a.map(r => {
                    r.dataSource = this;
                    return r;
                });
            }
        }
        return sourceRecords;
    }
    /**
     * Get whether a data source should use records of no_selection view as its own source records.
     *  - the data source must be selection view, no_selection view is designed as the default value of selection view.
     *  - the data source must have no source records, if it has source records, should use these source records.
     */
    useNoSelectionView(dataSource = this) {
        const sourceRecords = dataSource.sourceRecords || [];
        return dataSource.isDataView && dataSource.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID && sourceRecords.length === 0 && dataSource.getMainDataSource().getDataView(jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION) && dataSource.getMainDataSource().getSelectedRecordIds().filter(id => !!id).length === 0;
    }
    canSaveSourceRecords() {
        const isMainDataSource = !this.isDataView && !this.isLocal;
        return isMainDataSource || this.isSelectionView();
    }
    getSelectionDataView() {
        const mainDsId = (this.isDataView || this.isLocal) ? this.getMainDataSource().id : this.id;
        const selectionDv = this.dataSourceManager.getDataViewDataSource(mainDsId, jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID);
        return selectionDv;
    }
    getSelectedRecords() {
        const selectionDv = this.getSelectionDataView();
        /**
         * When getting selected records, we should return real selection, shouldn't consider no_selection view.
         * No_selection view is only used when widget using selected features as its data source.
         */
        const allSelectedRecords = selectionDv ? selectionDv.getRecords() : [];
        const selectedRecordIdsInCurrentDs = this.getSelectedRecordIds();
        return allSelectedRecords.filter(r => selectedRecordIdsInCurrentDs.includes(r.getId()));
        // const dsInfo = getAppStore().getState().dataSourcesInfo[this.id];
        // if (dsInfo.selectedIndexes) { // select by index, get records from main ds.
        //   //we use .asMutable() here, because the .map() in SeamlessImmutable will remove mutable properties.
        //   return dsInfo.selectedIndexes.asMutable().map(index => this.getRecords()[index]).filter(r => r);
        // } else if (dsInfo.selectedIds) { // select by id, get records from selection dv
        //   return dsInfo.selectedIds.asMutable().map(id => this.getRecordById(id)).filter(r => r);
        // } else {
        //   return [];
        // }
    }
    getSelectedRecordIndexes() {
        if (!(0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id]) {
            return [];
        }
        const dsId = (this.isDataView || this.isLocal) ? this.getMainDataSource().id : this.id;
        if ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[dsId].selectedIds) {
            return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[dsId].selectedIds.asMutable().map(id => {
                // we don't care the type here
                return this.getRecords().findIndex(record => record.getId() === id);
            });
        }
        else {
            return [];
        }
    }
    getSelectedRecordIds() {
        /**
         * Selection view should contains all selected records, including records selected in main data source and records selected in data views.
         *
         * Selected records of main data source also should contain all selected records.
         * The reason is that records selected in data view should be copied to main data source since data view is a subset of main data source.
         */
        if (this.isSelectionView()) {
            return this.getMainDataSource().getSelectedRecordIdsFromInfo().asMutable();
        }
        else {
            return this.getSelectedRecordIdsFromInfo().asMutable();
        }
    }
    nextRecord() {
        if (this.getSelectedRecordIndexes().length > 1) {
            console.warn('method "nextRecord" only works when single record is selected');
            return null;
        }
        if (this.getSelectedRecordIndexes().indexOf(this.getRecords().length - 1)) {
            throw Error('Reach the end of data.');
        }
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceSelectedIndexesChanged(this.id, [this.getSelectedRecordIndexes()[0]++]));
        return this.getSelectedRecords()[0];
    }
    prevRecord() {
        if (this.getSelectedRecordIndexes().length > 1) {
            console.warn('method "prevRecord" only works when single record is selected');
            return null;
        }
        if (this.getSelectedRecordIndexes().indexOf(0)) {
            throw Error('Reach the start of data.');
        }
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceSelectedIndexesChanged(this.id, [this.getSelectedRecordIndexes()[0]--]));
        return this.getSelectedRecords()[0];
    }
    getRecord(index) {
        return this.getRecords()[index];
    }
    getSourceRecord(index) {
        return this.getSourceRecords()[index];
    }
    getRecordById(id) {
        return this.getRecords().filter(record => record && record.getId() === id)[0];
    }
    getSourceRecordById(id) {
        return this.getSourceRecords().filter(record => record && record.getId() === id)[0];
    }
    clearSelection() {
        this.copySelectionToDataView([]);
        /**
         * Need to update records of selection view, then update data source info,
         * which can avoid that records of selection view haven't been updated when widgets detect data source info change event.
         */
        this.updateSelectionInfoOfDerivedDssAndChangeUrl({ widgetId: null, ids: [] });
    }
    updateSelectionInfoOfDerivedDssAndChangeUrl(options, derivedFromDataSource, forceCheck) {
        const mainDs = this.getMainDataSource();
        const updateByDs = derivedFromDataSource || mainDs;
        updateByDs.getAllDerivedDataSources().forEach(ds => {
            /**
             * Data source info of selection view and no_selection view don't save selected record ids.
             * Selection view's records and selected records should be same as main data source's selected records.
             */
            if (ds.id === this.dataSourceManager.getDataViewDataSourceId(mainDs.id, jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID) ||
                ds.id === this.dataSourceManager.getDataViewDataSourceId(mainDs.id, jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION)) {
                return;
            }
            ds.updateSelectionInfo(options, this, forceCheck);
        });
        updateByDs.updateSelectionInfo(options, this, forceCheck);
        if (updateByDs.id === mainDs.id) {
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.UrlManager.getInstance().changeHashObjectByDataSourceSelection(mainDs.id, options);
        }
    }
    selectRecord(index) {
        const record = this.getDataSourceJson().isDataInDataSourceInstance ? this.getSourceRecord(index) : this.getRecord(index);
        if (record) {
            this.copySelectionToDataView([record]);
            this.updateSelectionInfoOfDerivedDssAndChangeUrl({ widgetId: null, ids: [record.getId()] });
        }
    }
    selectRecords(options) {
        let selectRecords = [];
        if (options === null || options === void 0 ? void 0 : options.records) {
            selectRecords = options.records;
        }
        else if (options === null || options === void 0 ? void 0 : options.ids) {
            const allRecords = this.getDataSourceJson().isDataInDataSourceInstance ? this.getSourceRecords() : this.getRecords();
            selectRecords = options.ids.map(id => allRecords.find(r => (r === null || r === void 0 ? void 0 : r.getId()) === id));
        }
        this.copySelectionToDataView(selectRecords);
        this.updateSelectionInfoOfDerivedDssAndChangeUrl(options);
        return Promise.resolve({ records: selectRecords });
    }
    selectRecordById(id, record) {
        if (this.getSelectedRecordIds().find(_id => _id === id)) {
            return;
        }
        let selectRecord;
        if (this.getDataSourceJson().isDataInDataSourceInstance) {
            selectRecord = record || (id && this.getSourceRecordById(id));
        }
        else {
            selectRecord = record || (id && this.getRecordById(id));
        }
        if (!selectRecord) {
            this.copySelectionToDataView([]);
            this.updateSelectionInfoOfDerivedDssAndChangeUrl({ widgetId: null, ids: [] });
        }
        else {
            this.copySelectionToDataView([selectRecord]);
            this.updateSelectionInfoOfDerivedDssAndChangeUrl({ widgetId: null, ids: [id] });
        }
    }
    selectRecordsByIds(ids, records) {
        const allRecords = this.getDataSourceJson().isDataInDataSourceInstance ? this.getSourceRecords() : this.getRecords();
        const selectRecords = records || ids.map(id => allRecords.find(r => (r === null || r === void 0 ? void 0 : r.getId()) === id));
        this.copySelectionToDataView(selectRecords);
        this.updateSelectionInfoOfDerivedDssAndChangeUrl({ widgetId: null, ids });
    }
    copySelectionToDataView(selection) {
        const selectionDv = this.getSelectionDataView();
        if (!selectionDv) {
            return;
        }
        selectionDv.setSourceRecords(selection.filter(r => !!r));
        selectionDv.setRecords(selection.filter(r => !!r));
    }
    getInfo() {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id] || (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
    }
    clearRecords() {
        this.clearRecordsNotAddVersion();
        this.addVersion();
    }
    clearRecordsNotAddVersion() {
        if (!this.isSelectionView() && this.getSelectedRecords().length > 0) {
            this.copySelectionToDataView([]);
        }
        this.records = [];
    }
    getIdField() {
        return (this.getSchema() && this.getSchema().idField) || 'id';
    }
    getRootDataSource() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getRootDataSource();
        }
        let rootDs = this.parentDataSource;
        while (rootDs && rootDs.parentDataSource) {
            rootDs = rootDs.parentDataSource;
        }
        return rootDs;
    }
    getOriginDataSources() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getOriginDataSources();
        }
        if (!this.getDataSourceJson().originDataSources || this.getDataSourceJson().originDataSources.length === 0) {
            return [];
        }
        return this.getDataSourceJson().originDataSources.asMutable().map(useDs => this.dataSourceManager.getDataSource(useDs.dataSourceId));
    }
    getMainDataSource() {
        var _a;
        if (this.belongToDataSource) {
            return (_a = this.belongToDataSource.belongToDataSource) !== null && _a !== void 0 ? _a : this.belongToDataSource;
        }
        else {
            return this;
        }
    }
    getDataViews() {
        if (this.getMainDataSource() !== this) {
            return [];
        }
        else {
            return this.dataSourceManager.getDataSourcesAsArray().filter(ds => ds.belongToDataSource === this && ds.isDataView);
        }
    }
    getDataView(dataViewId) {
        return this.getDataViews().find(dv => dv.dataViewId === dataViewId);
    }
    /**
     * The data source's query is a data view config as well.
     */
    getDataViewConfig() {
        if (this.isLocal) {
            return this.belongToDataSource.getDataViewConfig();
        }
        if (this.isDataView) {
            return this.getDataSourceJson().dataViews && this.getDataSourceJson().dataViews[this.dataViewId];
        }
        else {
            return this.getDataSourceJson().query;
        }
    }
    getLocalDataSources() {
        if (this.isLocal) {
            return [];
        }
        else {
            return this.dataSourceManager.getDataSourcesAsArray().filter(ds => ds.belongToDataSource === this && ds.isLocal);
        }
    }
    getLocalDataSource(localId) {
        return this.getLocalDataSources().find(dv => dv.localId === localId);
    }
    getAllDerivedDataSources() {
        let dss = [];
        const dvs = this.getDataViews();
        const locals = this.getLocalDataSources();
        dss = dvs.concat(locals);
        dvs.forEach(dv => {
            dss = dss.concat(dv.getLocalDataSources());
        });
        return dss;
    }
    getSaveStatus() {
        var _a;
        return (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[this.id]) === null || _a === void 0 ? void 0 : _a.saveStatus;
    }
    setSaveStatus(status) {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceSaveStatusChanged(this.id, status));
    }
    setListenSelection(listen) {
        this.listenSelection = listen;
    }
    getListenSelection() {
        return this.listenSelection;
    }
    isSelectionView() {
        return this.isDataView && this.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID;
    }
    isLocalViewOfSelectionView() {
        return this.isLocal && this.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID;
    }
    addRecord(record) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!record) {
                return yield Promise.reject('No record passed in.');
            }
            this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Saving);
            return yield this.doAddRecord(record).then(record => {
                this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Saved);
                return record;
            }, (error) => __awaiter(this, void 0, void 0, function* () {
                this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.SaveError);
                return yield Promise.reject(error);
            }));
        });
    }
    doAddRecord(record) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getDataSourceJson().isDataInDataSourceInstance) {
                return yield this.doAddRecordToSourceRecords(record);
            }
            else {
                // return this.doAddRecordToAGOLOrPortalSource();
                return yield Promise.reject('Editing source is not ready yet.');
            }
        });
    }
    updateRecord(record) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield this.updateRecords([record]);
        });
    }
    updateRecords(records) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!records || records.length === 0) {
                return yield Promise.reject('No records passed in.');
            }
            this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Saving);
            return yield this.doUpdateRecords(records).then(isDone => {
                this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Saved);
                return isDone;
            }, (error) => __awaiter(this, void 0, void 0, function* () {
                this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.SaveError);
                return yield Promise.reject(error);
            }));
        });
    }
    doUpdateRecords(records) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getDataSourceJson().isDataInDataSourceInstance) {
                return yield this.doUpdateRecordsInSourceRecords(records);
            }
            else {
                // return this.doUpdateRecordsInAGOLOrPortalSource();
                return yield Promise.reject('Editing source is not ready yet.');
            }
        });
    }
    deleteRecord(index) {
        return __awaiter(this, void 0, void 0, function* () {
            const record = this.getRecords()[index];
            return yield this.deleteOneRecord(record);
        });
    }
    deleteRecordById(id) {
        return __awaiter(this, void 0, void 0, function* () {
            const record = this.getRecordById(id);
            return yield this.deleteOneRecord(record);
        });
    }
    deleteOneRecord(record) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!record) {
                return yield Promise.reject('No record passed in.');
            }
            this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Saving);
            return yield this.doDeleteOneRecord(record).then(isDone => {
                this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Saved);
                return isDone;
            }, (error) => __awaiter(this, void 0, void 0, function* () {
                this.setSaveStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.SaveError);
                return yield Promise.reject(error);
            }));
        });
    }
    doDeleteOneRecord(record) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getDataSourceJson().isDataInDataSourceInstance) {
                return yield this.doDeleteOneRecordFromSourceRecords(record);
            }
            else {
                // return this.doDeleteOneRecordFromAGOLOrPortalSource();
                return yield Promise.reject('Editing source is not ready yet.');
            }
        });
    }
    doDeleteOneRecordFromSourceRecords(record) {
        return __awaiter(this, void 0, void 0, function* () {
            this.sourceRecords = this.sourceRecords.filter(r => r.getId() !== record.getId());
            return Promise.resolve(true);
        });
    }
    doAddRecordToSourceRecords(record) {
        return __awaiter(this, void 0, void 0, function* () {
            this.sourceRecords = this.sourceRecords.concat(record);
            return yield Promise.resolve(record);
        });
    }
    doUpdateRecordsInSourceRecords(records) {
        return __awaiter(this, void 0, void 0, function* () {
            records.forEach(r => {
                const index = this.sourceRecords.findIndex(or => or.getId() === r.getId());
                if (index > -1) {
                    this.sourceRecords[index] = r;
                }
            });
            return Promise.resolve(true);
        });
    }
    afterUpdateRecords(records) {
        if (!records || records.filter(r => !!r).length === 0) {
            return;
        }
        this.updateLoadedRecords(this.getMainDataSource(), records);
        this.getMainDataSource().getAllDerivedDataSources().forEach(ds => { this.updateLoadedRecords(ds, records); });
        this.getMainDataSource().addSourceVersion();
    }
    updateLoadedRecords(ds, records) {
        const rs = records.map(r => ds.getRecordById(r.getId()));
        if (rs.filter(r => !!r).length > 0) {
            rs.forEach((r, i) => {
                if (r) {
                    r.setData(records[i].getData());
                    r.setGeometry(records[i].getRawGeometry());
                }
            });
            ds.addVersion();
        }
    }
    afterUpdateRecord(record) {
        if (!record) {
            return;
        }
        this.updateOneLoadedRecord(this.getMainDataSource(), record);
        this.getMainDataSource().getAllDerivedDataSources().forEach(ds => { this.updateOneLoadedRecord(ds, record); });
        this.getMainDataSource().addSourceVersion();
    }
    updateOneLoadedRecord(ds, record) {
        const r = ds.getRecordById(record.getId());
        if (r) {
            r.setData(record.getData());
            r.setGeometry(record.getRawGeometry());
            ds.addVersion();
        }
    }
    afterAddRecord(record) {
        if (!record) {
            return;
        }
        /**
         * It is hard to decide which page to put the new record on and how to handle it after adding filter.
         * To make the update easier, just clear loaded records here.
         */
        this.getMainDataSource().clearRecords();
        this.getMainDataSource().getAllDerivedDataSources().forEach(ds => {
            ds.clearRecords();
        });
        this.getMainDataSource().addSourceVersion();
    }
    afterDeleteRecordById(id) {
        if (!id) {
            return;
        }
        if (this.getMainDataSource().getSelectedRecordIds().includes(id)) {
            this.getMainDataSource().selectRecordsByIds(this.getMainDataSource().getSelectedRecordIds().filter(selectedId => selectedId !== id), this.getMainDataSource().getSelectedRecords().filter(r => r.getId() !== id));
        }
        this.deleteOneLoadedRecordById(this.getMainDataSource(), id);
        this.getMainDataSource().getAllDerivedDataSources().forEach(ds => { this.deleteOneLoadedRecordById(ds, id); });
        this.getMainDataSource().addSourceVersion();
    }
    deleteOneLoadedRecordById(ds, id) {
        const index = ds.getRecords().findIndex(r => (r === null || r === void 0 ? void 0 : r.getId()) === id);
        if (typeof index === 'number' && index > -1) {
            ds.getRecords().splice(index, 1);
            ds.addVersion();
        }
    }
    // protected abstract doAddRecordToAGOLOrPortalSource?(record: DataRecord): Promise<DataRecord>
    // protected abstract doDeleteOneRecordFromAGOLOrPortalSource?(record: DataRecord): Promise<boolean>
    // protected abstract doUpdateRecordsInAGOLOrPortalSource?(records: DataRecord[]): Promise<boolean>
    destroy() { }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/abstract-layer-folder-data-source.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/abstract-layer-folder-data-source.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractLayerFolderDataSource: () => (/* binding */ AbstractLayerFolderDataSource)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _abstract_set_data_source__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./abstract-set-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-set-data-source.ts");
/* harmony import */ var _item_mixin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./item-mixin */ "./jimu-core/lib/data-sources/base-classes/item-mixin.ts");
/* harmony import */ var _js_api_layer_mixin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./js-api-layer-mixin */ "./jimu-core/lib/data-sources/base-classes/js-api-layer-mixin.ts");
/* harmony import */ var _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../support/data-source-json-creator */ "./jimu-core/lib/data-sources/support/data-source-json-creator.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






/**
 * * Common operations for folder-like services, such as feature service, scene service, map service, group layer, etc, are grouped in this class.
 * please see {@link SupportedLayerServiceTypes} to find supported layer service types.
 */
class AbstractLayerFolderDataSource extends (0,_js_api_layer_mixin__WEBPACK_IMPORTED_MODULE_4__.JSAPILayerMixinImpl)((0,_item_mixin__WEBPACK_IMPORTED_MODULE_3__.ItemMixinImpl)(_abstract_set_data_source__WEBPACK_IMPORTED_MODULE_2__.AbstractSetDataSource)) {
    constructor(options) {
        var _a;
        super(options);
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
        if ((_a = this.layer) === null || _a === void 0 ? void 0 : _a.portalItem) {
            this.setItemInfo(this.layer.portalItem.sourceJSON);
        }
    }
    ready() {
        const _super = Object.create(null, {
            ready: { get: () => super.ready },
            createChildDataSourcesRecursively: { get: () => super.createChildDataSourcesRecursively }
        });
        return this.fetchDataDefinitions().then(() => _super.ready.call(this)).then(() => __awaiter(this, void 0, void 0, function* () {
            const appConfig = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig;
            if (appConfig.originExbVersion && jimu_core__WEBPACK_IMPORTED_MODULE_0__.semver.lt(appConfig.originExbVersion, '1.6.0')) {
                const childDss = yield _super.createChildDataSourcesRecursively.call(this);
                yield this.upgradeChildDssId(childDss);
            }
        }));
    }
    upgradeChildDssId(childDss) {
        return __awaiter(this, void 0, void 0, function* () {
            /**
             * Before dev1.6, the jimuChildId is generated from layer label (name of layer definition).
             * After dev1.6, the jimuChildId is generated from layer id (id of JS API layer or layer definition).
             * The following part is to update jimuChildId and id of child data sources to be compatible with the version before dev1.6.
             */
            let appConfig = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig;
            const selectionViewReadyPromises = [];
            const updateUseDataSource = (u, id, newId) => {
                if (u === null || u === void 0 ? void 0 : u.dataSourceId) {
                    u.dataSourceId = u.dataSourceId.replace(id, newId);
                }
                /**
                * Some use data sources in text widget may not have main data source id.
                * It seems to be a bug of text widget. Will fix the bug in another issue.
                */
                if (u === null || u === void 0 ? void 0 : u.mainDataSourceId) {
                    u.mainDataSourceId = u.mainDataSourceId.replace(id, newId);
                }
                return u;
            };
            const needUpdateUseDs = (u, idFromLabel) => {
                if (u === null || u === void 0 ? void 0 : u.mainDataSourceId) {
                    return u.mainDataSourceId === idFromLabel;
                }
                else if (u === null || u === void 0 ? void 0 : u.dataSourceId) {
                    return u.dataSourceId.split('-dataView_')[0] === idFromLabel;
                }
                else {
                    return false;
                }
            };
            childDss.forEach(childDs => {
                var _a, _b, _c, _d, _e, _f, _g;
                if (childDs) {
                    /**
                    * 1. Get id from layer label.
                    */
                    let idFromLabel = '';
                    let ds = childDs;
                    const idFromLabelToIdFromId = [];
                    while (ds) {
                        const isRootDs = !ds.parentDataSource;
                        // If do not have url, should be feature collection item.
                        const isSingleLayerDs = (!ds.isDataSourceSet && !ds.getDataSourceJson().url) || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isSupportedSingleArcGISLayerService(ds.getDataSourceJson().url);
                        const isChildDsOfMap = !!((_a = ds.parentDataSource) === null || _a === void 0 ? void 0 : _a.map);
                        let jimuChildIdFromLabel;
                        if (isRootDs) {
                            jimuChildIdFromLabel = ds.id;
                        }
                        else if (isSingleLayerDs && !isChildDsOfMap) {
                            /**
                            * Single layer ds used to use name of layer definition as jimuChildId, which is need to be updated (should use id of layer definition).
                            * Child ds of map uses JS API layer id as jimuChildId, which is expected.
                            */
                            const layerDefinition = ds.getLayerDefinition ? ds.getLayerDefinition() : (_c = (_b = ds).getServiceDefinition) === null || _c === void 0 ? void 0 : _c.call(_b);
                            jimuChildIdFromLabel = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils._getFixedLayerIdByLayerDefinition(layerDefinition) || ds.jimuChildId;
                        }
                        else if (!isSingleLayerDs && !isChildDsOfMap) {
                            jimuChildIdFromLabel = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(ds.getDataSourceJson().url);
                        }
                        else {
                            jimuChildIdFromLabel = ds.jimuChildId;
                        }
                        /**
                        * One group may contain same layer services (can do it in map viewer).
                        * To make data source id of the same layer services different, we add `_[repeat times]` to the end of the data source id.
                        *
                        * For example, group 1 has three same layer services (id of the layer service is 0), the data source id of the three layer services will be dataSource_1-group1-0, dataSource_1-group1-0_1 and dataSource_1-group1-0_2.
                      */
                        if (!isRootDs && !isChildDsOfMap && ds.getDataSourceJson().url && ((_g = (_f = (_e = (_d = ds.parentDataSource.layer) === null || _d === void 0 ? void 0 : _d.layers) === null || _e === void 0 ? void 0 : _e.toArray) === null || _f === void 0 ? void 0 : _f.call(_e)) === null || _g === void 0 ? void 0 : _g.filter(l => jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(l) === ds.getDataSourceJson().url).length) > 1) {
                            const chilLayersFromSameService = ds.parentDataSource.layer.layers.toArray().filter(l => jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(l) === ds.getDataSourceJson().url);
                            const repeatTimes = chilLayersFromSameService.findIndex(l => l.id === ds.jimuChildId);
                            if (repeatTimes > 0) {
                                jimuChildIdFromLabel = `${jimuChildIdFromLabel}_${repeatTimes}`;
                            }
                        }
                        idFromLabel = idFromLabel ? `${jimuChildIdFromLabel}-${idFromLabel}` : jimuChildIdFromLabel;
                        idFromLabelToIdFromId.unshift({ jimuChildIdFromLabel, jimuChildIdFromId: ds.jimuChildId || ds.id });
                        ds = ds.parentDataSource;
                    }
                    /**
                    * 2. Update app config - replace id from layer label with id from layer id.
                    */
                    // 2.1 Update widgets.
                    Object.keys(appConfig.widgets || {}).forEach(widgetId => {
                        var _a;
                        if ((_a = appConfig.widgets[widgetId].useDataSources) === null || _a === void 0 ? void 0 : _a.some(u => needUpdateUseDs(u, idFromLabel))) {
                            const widgetJson = appConfig.widgets[widgetId].asMutable({ deep: true });
                            widgetJson.useDataSources = widgetJson.useDataSources.map(u => updateUseDataSource(u, idFromLabel, childDs.id));
                            if (widgetJson.config) {
                                widgetJson.config = JSON.parse(JSON.stringify(widgetJson.config).replace(new RegExp(idFromLabel, 'g'), childDs.id));
                            }
                            appConfig = appConfig.setIn(['widgets', widgetId], widgetJson);
                        }
                    });
                    // 2.2 Update data sources.
                    Object.keys(appConfig.dataSources || {}).forEach(dsId => {
                        var _a;
                        // 2.2.1 Update output data sources.
                        if ((_a = appConfig.dataSources[dsId].originDataSources) === null || _a === void 0 ? void 0 : _a.some(u => needUpdateUseDs(u, idFromLabel))) {
                            const dsJson = appConfig.dataSources[dsId].asMutable({ deep: true });
                            dsJson.originDataSources = dsJson.originDataSources.map(u => updateUseDataSource(u, idFromLabel, childDs.id));
                            appConfig = appConfig.setIn(['dataSources', dsId], dsJson);
                        }
                        // 2.2.2 Update added data sources.
                        const pathToChildDsJson = [];
                        idFromLabelToIdFromId.forEach((id, index) => {
                            pathToChildDsJson.push(id.jimuChildIdFromLabel);
                            if (index !== idFromLabelToIdFromId.length - 1) {
                                pathToChildDsJson.push('childDataSourceJsons');
                            }
                        });
                        if (appConfig.dataSources.getIn(pathToChildDsJson)) {
                            const ids = idFromLabelToIdFromId.slice().reverse();
                            if (ids[0].jimuChildIdFromId !== ids[0].jimuChildIdFromLabel) {
                                const pathToParentDsJson = pathToChildDsJson.slice(0, pathToChildDsJson.length - 2);
                                const parentDsJson = appConfig.dataSources.getIn(pathToParentDsJson).asMutable({ deep: true });
                                parentDsJson.childDataSourceJsons[ids[0].jimuChildIdFromId] = parentDsJson.childDataSourceJsons[ids[0].jimuChildIdFromLabel];
                                parentDsJson.childDataSourceJsons[ids[0].jimuChildIdFromId].id = childDs.id;
                                delete parentDsJson.childDataSourceJsons[ids[0].jimuChildIdFromLabel];
                                appConfig = appConfig.setIn(['dataSources'].concat(pathToParentDsJson), parentDsJson);
                            }
                        }
                    });
                    // 2.3 Update message actions.
                    Object.keys(appConfig.messageConfigs || {}).forEach(messageId => {
                        var _a;
                        const hasActionUseDsWhichIdIsFromLabel = (_a = appConfig.messageConfigs[messageId].actions) === null || _a === void 0 ? void 0 : _a.some(a => { var _a, _b, _c, _d, _e; return ((_a = a.useDataSources) === null || _a === void 0 ? void 0 : _a.some(u => (u === null || u === void 0 ? void 0 : u.mainDataSourceId) === idFromLabel)) || ((_c = (_b = a.config) === null || _b === void 0 ? void 0 : _b.actionUseDataSource) === null || _c === void 0 ? void 0 : _c.mainDataSourceId) === idFromLabel || ((_e = (_d = a.config) === null || _d === void 0 ? void 0 : _d.messageUseDataSource) === null || _e === void 0 ? void 0 : _e.mainDataSourceId) === idFromLabel; });
                        if (hasActionUseDsWhichIdIsFromLabel) {
                            const messageJson = appConfig.messageConfigs[messageId].asMutable({ deep: true });
                            messageJson.actions = messageJson.actions.map(a => {
                                var _a, _b;
                                if (a.useDataSources) {
                                    a.useDataSources = a.useDataSources.map(u => updateUseDataSource(u, idFromLabel, childDs.id));
                                }
                                if ((_a = a.config) === null || _a === void 0 ? void 0 : _a.actionUseDataSource) {
                                    a.config.actionUseDataSource = updateUseDataSource(a.config.actionUseDataSource, idFromLabel, childDs.id);
                                }
                                if ((_b = a.config) === null || _b === void 0 ? void 0 : _b.messageUseDataSource) {
                                    a.config.messageUseDataSource = updateUseDataSource(a.config.messageUseDataSource, idFromLabel, childDs.id);
                                }
                                return a;
                            });
                            appConfig = appConfig.setIn(['messageConfigs', messageId], messageJson);
                        }
                    });
                    /**
                    * 3. Update data source info - merge data source info which id is from label and current data source info.
                    */
                    if (!childDs.isDataSourceSet && Object.keys((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo).some(dsId => dsId.includes(idFromLabel))) {
                        Object.keys((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo).forEach(dsId => {
                            if (dsId.includes(idFromLabel)) {
                                const prevDsId = dsId;
                                const newDsId = dsId.replace(idFromLabel, childDs.id);
                                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.updateDataSourceInfo(childDs.id, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[prevDsId].merge((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo[newDsId] || {})));
                            }
                        });
                        if (childDs.getDataView(jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID)) {
                            selectionViewReadyPromises.push(childDs.getDataView(jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.SELECTION_DATA_VIEW_ID).ready());
                        }
                    }
                }
            });
            if ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig !== appConfig) {
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.appConfigChanged(appConfig));
                const rootDs = this.getRootDataSource() || this;
                const rootDsJson = appConfig.dataSources[rootDs.id];
                if (rootDsJson) {
                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
                        // Update data source json in data source instance.
                        this.dataSourceManager.updateDataSourceByDataSourceJson(rootDs, rootDsJson);
                    });
                }
            }
            return Promise.allSettled(selectionViewReadyPromises).then();
        });
    }
    /**
     * The data can be defined in service, item data.
     */
    fetchDataDefinitions() {
        return __awaiter(this, void 0, void 0, function* () {
            const fetchServiceDefinitionPromise = this.fetchServiceDefinition().then(() => {
                var _a, _b;
                if (((_b = (_a = this.serviceDefinition) === null || _a === void 0 ? void 0 : _a.tables) === null || _b === void 0 ? void 0 : _b.length) > 0) {
                    this.serviceDefinition.tables = this.serviceDefinition.tables.map(t => (Object.assign(Object.assign({}, t), { type: _interfaces__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.Table })));
                }
            });
            const sourceDataPromises = [fetchServiceDefinitionPromise];
            if (!this.layer && !this.url && this.itemId) { // mulitple-layers feature collection item or group layer item
                sourceDataPromises.push(this.fetchItemData(), this.fetchItemInfo());
            }
            yield Promise.all(sourceDataPromises);
        });
    }
    fetchServiceDefinition() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.layer) { // from map item
                if (this.layer.loadAll) {
                    yield this.layer.loadAll();
                }
                else {
                    yield this.layer.load();
                }
                this.updateServiceDefinitionByLayer();
                return this.getServiceDefinition();
            }
            else if (this.url) { // from service url
                return this.fetchServiceDefinitionByUrl();
            }
            return Promise.resolve(null);
        });
    }
    fetchSchema() {
        return __awaiter(this, void 0, void 0, function* () {
            const dss = this.getChildDataSources();
            const label = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getOriginDataLabel(this);
            let schema = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({ childSchemas: {}, label });
            dss.forEach((ds, i) => {
                const layerSchema = ds.getFetchedSchema();
                schema = schema.setIn(['childSchemas', ds.jimuChildId], layerSchema);
            });
            return Promise.resolve(schema);
        });
    }
    getServiceDefinition() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getServiceDefinition();
        }
        return this.serviceDefinition;
    }
    getItemInfo() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getItemInfo();
        }
        return super.getItemInfo();
    }
    createChildDataSourceById(childDsId, jimuChildId, childId) {
        return __awaiter(this, void 0, void 0, function* () {
            const options = this.createChildDataSourceOptionsById(childDsId, jimuChildId, childId);
            if (!options) {
                return Promise.reject(new _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceError(childDsId, 'Do not support this type of data.'));
            }
            const childDs = yield this.dataSourceManager.createDataSource(options);
            this.updateChildDatasourcesGDBVersion([childDs]);
            return childDs;
        });
    }
    createChildDataSourceOptionsByIdFromUrl(childDsId, jimuChildId, childId) {
        if (this.url) {
            const layerInfo = this.findLayerDefinitionInfo(childId);
            if (!(layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.url)) {
                return null;
            }
            return this.createChildDataSourceOptionsByLayerDefinition(layerInfo.partailLayerDefinition, layerInfo.url, jimuChildId, childDsId, layerInfo.order);
        }
        return null;
    }
    createChildDataSourceOptionsByLayerDefinition(layerDefinition, url, jimuChildId, childDsId, order) {
        const dsJson = this.createChildDataSourceJsonByLayerDefinition(layerDefinition, url, jimuChildId, childDsId);
        if (dsJson) {
            return {
                id: childDsId,
                dataSourceJson: dsJson,
                parentDataSource: this,
                jimuChildId,
                order
            };
        }
        return null;
    }
    createChildDataSourceJsonByLayerDefinition(layerDefinition, url, jimuChildId, childDsId) {
        var _a, _b, _c, _d, _e, _f;
        if (!layerDefinition || !childDsId) {
            return null;
        }
        // _jimuChildIdFromLabel is to support data source before dev1.16, see upgradeChildDssId for more details.
        const _jimuChildIdFromLabel = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils._getFixedLayerIdByLayerDefinition(layerDefinition) || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(url);
        const schemaInConfig = ((_b = (_a = this.getDataSourceJson().schema) === null || _a === void 0 ? void 0 : _a.childSchemas) === null || _b === void 0 ? void 0 : _b[jimuChildId]) || ((_d = (_c = this.getDataSourceJson().schema) === null || _c === void 0 ? void 0 : _c.childSchemas) === null || _d === void 0 ? void 0 : _d[_jimuChildIdFromLabel]);
        const dsJsonInConfig = ((_e = this.getDataSourceJson().childDataSourceJsons) === null || _e === void 0 ? void 0 : _e[jimuChildId]) || ((_f = this.getDataSourceJson().childDataSourceJsons) === null || _f === void 0 ? void 0 : _f[_jimuChildIdFromLabel]);
        let dsJson = _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_5__.createDataSourceJsonByLayerDefinition(childDsId, layerDefinition, url, dsJsonInConfig, schemaInConfig);
        if (dsJson) {
            if (this.portalUrl) {
                dsJson = dsJson.set('portalUrl', this.portalUrl);
            }
            if (this.itemId) {
                dsJson = dsJson.set('itemId', this.itemId);
            }
        }
        return dsJson;
    }
    findLayerDefinitionInfo(childId) {
        const layerDefs = this.getPartialLayerAndTableDefinitions().concat(this.getPartialSubLayerDefinitions());
        let layerInfo;
        layerDefs.some((layerDef, i) => {
            const layerUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFullArcGISServiceUrl(this.url, true, layerDef);
            const layerSourceUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDataSourceSourceUrl(layerUrl);
            if (this.getChildIdByLayerDefinition(layerDef, layerSourceUrl) === childId) {
                layerInfo = {
                    proxyUrl: layerUrl,
                    url: layerSourceUrl,
                    partailLayerDefinition: layerDef,
                    order: i
                };
                return true;
            }
            return false;
        });
        return layerInfo;
    }
    updateServiceDefinitionByLayer() {
        var _a, _b;
        if ((_a = this.layer) === null || _a === void 0 ? void 0 : _a.sourceJSON) {
            this.serviceDefinition = this.layer.sourceJSON;
        }
        else {
            this.serviceDefinition = {
                name: (_b = this.layer) === null || _b === void 0 ? void 0 : _b.title
            };
        }
    }
    fetchServiceDefinitionByUrl() {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getServiceDefinition()) {
                return this.getServiceDefinition();
            }
            if (this.url) {
                const definition = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.ServiceManager.getInstance().fetchServiceInfo(this.url).then(res => res.definition);
                if (!definition) {
                    return null;
                }
                if (!definition.name) {
                    definition.name = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(this.getDataSourceJson().url);
                }
                // Sub layer doesn't have type.
                if ((_a = definition.subLayers) === null || _a === void 0 ? void 0 : _a.some(l => !l.type)) {
                    const allLayerDefs = ((_b = this.parentDataSource) === null || _b === void 0 ? void 0 : _b.getServiceDefinition) ? (_c = this.parentDataSource) === null || _c === void 0 ? void 0 : _c.getServiceDefinition() : (yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.ServiceManager.getInstance().fetchServiceInfo(`${jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFullArcGISServiceUrl(this.url, false)}/layers`).then(res => res.definition));
                    definition.subLayers = definition.subLayers.map(l => {
                        var _a;
                        const def = (_a = allLayerDefs === null || allLayerDefs === void 0 ? void 0 : allLayerDefs.layers) === null || _a === void 0 ? void 0 : _a.find(allDef => allDef.id === l.id);
                        return Object.assign(Object.assign({}, l), def);
                    });
                }
                this.serviceDefinition = definition;
                return this.serviceDefinition;
            }
            return Promise.reject(new _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceError(this.id, 'Failed to fetch service definition, need url.'));
        });
    }
    getPartialSubLayerDefinitions() {
        var _a;
        // The layer definition in the server definition is missing some fields, not a complete layer definition.
        return ((_a = this.getServiceDefinition()) === null || _a === void 0 ? void 0 : _a.subLayers) || [];
    }
    getPartialLayerAndTableDefinitions() {
        var _a, _b;
        // The layer definition in the server definition is missing some fields, not a complete layer definition.
        const layers = ((_a = this.getServiceDefinition()) === null || _a === void 0 ? void 0 : _a.layers) || [];
        const tables = ((_b = this.getServiceDefinition()) === null || _b === void 0 ? void 0 : _b.tables) || [];
        return layers.concat(tables);
    }
    getChildIdByLayerDefinition(layerDefinition, url) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFixedLayerIdByLayerDefinition(layerDefinition) || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(url);
    }
    getChildIdByLayer(layer) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFixedLayerIdByLayer(layer) || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(layer));
    }
    getChildIdBySubLayer(subLayer) {
        var _a, _b;
        /**
         * In most cases, sublayer ID is same with the layer definition ID, so we used to create child data source by sublayer's layer definition.
         * Now, we want to change back to use sublayer, but we found issue #14594, #16588. In the issue's sample map, the sublayer ID is different with layer definition's ID.
         * To make previous app work, we keep using sublayer's layer definition.
         */
        const fixedSubLayer = Object.assign(Object.assign({}, subLayer), { id: (_b = (_a = subLayer === null || subLayer === void 0 ? void 0 : subLayer.source) === null || _a === void 0 ? void 0 : _a.mapLayerId) !== null && _b !== void 0 ? _b : subLayer.id });
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFixedLayerIdByLayer(fixedSubLayer) || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(subLayer));
    }
    getChildIdsByUrl() {
        return this.getPartialLayerAndTableDefinitions().concat(this.getPartialSubLayerDefinitions()).map(l => this.getChildIdByLayerDefinition(l, jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFullArcGISServiceUrl(this.getDataSourceJson().url, true, l)));
    }
    getDataSourceIdByLayer(layerOrSubLayer) {
        let childId = '';
        if (layerOrSubLayer.declaredClass === 'esri.layers.support.Sublayer') {
            childId = this.getChildIdBySubLayer(layerOrSubLayer);
        }
        else {
            childId = this.getChildIdByLayer(layerOrSubLayer);
        }
        return this.getChildDataSourceId(childId);
    }
    updateChildDatasourcesGDBVersion(childDss) {
        if (this.getInfo().gdbVersion) {
            childDss.forEach(ds => {
                if (ds.type === _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.FeatureLayer) {
                    ds.changeGDBVersion(this.getInfo().gdbVersion);
                }
            });
        }
    }
    getGDBVersion() {
        return this.getInfo().gdbVersion;
    }
    changeGDBVersion(gdbVersion) {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.changeDataSourceGDBVersion(this.id, gdbVersion));
        this.updateChildDatasourcesGDBVersion(this.getAllChildDataSources());
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.jimuHistory.changeQueryObjectByDataSourceGDBVersion(this.id, gdbVersion);
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/abstract-loadable-data-source.ts":
/*!**********************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/abstract-loadable-data-source.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractLoadableDataSource: () => (/* binding */ AbstractLoadableDataSource)
/* harmony export */ });
/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abstract-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-data-source.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


/** @ignore */
class AbstractLoadableDataSource extends _abstract_data_source__WEBPACK_IMPORTED_MODULE_0__.AbstractDataSource {
    load() {
        return __awaiter(this, void 0, void 0, function* () {
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Loading);
            return yield this.doLoad().then(records => {
                this.records = records;
                this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Loaded);
                return this.records;
            });
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/abstract-queriable-data-source.ts":
/*!***********************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/abstract-queriable-data-source.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractQueriableDataSource: () => (/* binding */ AbstractQueriableDataSource)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./abstract-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-data-source.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _support_capabilities_impl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/capabilities-impl */ "./jimu-core/lib/data-sources/support/capabilities-impl.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __rest = (undefined && undefined.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};




const { DEFAULT_QUERY_PAGE_SIZE, DATA_VIEW_ID_FOR_NO_SELECTION, OUTPUT_DATA_VIEW_ID, SELECTION_DATA_VIEW_ID } = jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS;
class AbstractQueriableDataSource extends _abstract_data_source__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource {
    constructor(options) {
        super(options);
        /**
         * Data will be cached here, not this.records.
         *
         * When selectRecordById, some selected records may be put in this.records, so they are not in the pages.
         */
        this.pages = {};
        this.pagePromises = {};
        /**
         * Promises to load missing fields for every page.
         * The promises contain a specail page (its id is variable SELECTION_DATA_VIEW_ID), it is the promise to load missing fields for source records of selection view.
         */
        this.loadMissingFieldsByPagePromises = {};
        this.throttleQueryRecordsByIdWithCurrentQueryParams = jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.throttle(this.queryRecordsByIdWithCurrentQueryParams, 200);
        this.setCapabilities(new _support_capabilities_impl__WEBPACK_IMPORTED_MODULE_3__.CapabilitiesImpl({}));
        this.url = this.getDataSourceJson().url;
        this.isSqlCaseSensitive = this.getDataSourceJson().isDataInDataSourceInstance ? true : !jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isAGOLHostedService(this.getDataSourceJson().url);
        const isBelongToDsReady = options.belongToDataSource && options.belongToDataSource.getStatus() !== _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady;
        if (this.getDataSourceJson().isOutputFromWidget && !isBelongToDsReady) {
            /**
             * If is output data source, the initial data status is not ready, widget will change the status to unloaded when it is ready to do query.
             */
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady);
            this.setCountStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady);
        }
        else {
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Unloaded);
            this.setCountStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Unloaded);
        }
    }
    ready() {
        /**
         * If current data source is selection view, load selected records in data source info.
         * If there are selected record ids in URL, will set them to data source info, should load these selected records here.
         * This will make sure selected record ids in data source info and records in selection view match.
         */
        if (this.isSelectionView()) {
            const mainDsId = this.getMainDataSource().id;
            const dsInfos = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().dataSourcesInfo;
            let allSelectedRecordIds = [];
            const allSelectOptions = {};
            dsInfos && Object.keys(dsInfos).forEach(dsId => {
                var _a, _b, _c, _d;
                // Derived data view objects are not created, get derived data source info by id here.
                if (dsId === mainDsId || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isDerivedFrom(mainDsId, dsId)) {
                    if ((_b = (_a = dsInfos[dsId]) === null || _a === void 0 ? void 0 : _a.selectedIds) === null || _b === void 0 ? void 0 : _b.length) {
                        allSelectedRecordIds = allSelectedRecordIds.concat(dsInfos[dsId].selectedIds.asMutable());
                    }
                    if ((_d = (_c = dsInfos[dsId]) === null || _c === void 0 ? void 0 : _c.selectOptions) === null || _d === void 0 ? void 0 : _d.widgetId) {
                        allSelectOptions[dsId] = dsInfos[dsId].selectOptions.asMutable({ deep: true });
                    }
                }
            });
            allSelectedRecordIds = Array.from(new Set(allSelectedRecordIds));
            const querySelectedRecords = () => {
                /**
                 * If selected records are empty, no need to load.
                 */
                if (allSelectedRecordIds.length === 0 && Object.keys(allSelectOptions).length === 0) {
                    return Promise.resolve({});
                }
                const queryByIdsPromise = allSelectedRecordIds.length > 0
                    ? this.queryRecordsByIdWithCurrentQueryParams(allSelectedRecordIds, this.getMainDataSource(), { returnGeometry: true }).then(res => {
                        var _a;
                        this.getMainDataSource().selectRecordsByIds((_a = res.records) === null || _a === void 0 ? void 0 : _a.map(r => r.getId()), res.records);
                    })
                    : null;
                const queryBySelectOptionsPromises = Object.keys(allSelectOptions).map(dsId => {
                    var _a, _b, _c;
                    if ((_b = (_a = allSelectOptions[dsId]) === null || _a === void 0 ? void 0 : _a.ids) === null || _b === void 0 ? void 0 : _b.length) {
                        // When select by id, we query these ids by main data source, no need to consider data view settings.
                        return this.queryRecordsByIdWithCurrentQueryParams(allSelectOptions[dsId].ids, this.getMainDataSource(), { returnGeometry: true }).then(res => {
                            this.getMainDataSource().selectRecords(Object.assign(Object.assign({}, allSelectOptions[dsId]), { records: res.records }));
                        });
                    }
                    else if ((_c = allSelectOptions[dsId]) === null || _c === void 0 ? void 0 : _c.queryParams) {
                        // When select by query params, we need to consider data view settings.
                        const dataViewId = dsId === mainDsId ? null : dsId.replace(`${mainDsId}-`, '');
                        const ds = dataViewId ? this.dataSourceManager.createDataView(this.getMainDataSource(), dataViewId) : this.getMainDataSource();
                        return ds === null || ds === void 0 ? void 0 : ds.queryAll(Object.assign(Object.assign({}, allSelectOptions[dsId].queryParams), { returnGeometry: true })).then(res => {
                            ds.selectRecords(Object.assign(Object.assign({}, allSelectOptions[dsId]), { records: res.records }));
                        });
                    }
                    return null;
                });
                this.pendingPromiseToQuerySelectedRecordsPresetBeforeDsReady = Promise.allSettled([queryByIdsPromise, ...queryBySelectOptionsPromises].filter(p => !!p)).then(() => {
                    this.getMainDataSource().addSourceVersion();
                }).finally(() => {
                    this.pendingPromiseToQuerySelectedRecordsPresetBeforeDsReady = null;
                });
            };
            /**
             * If data is saved in data source instance, will not query selected records until the first time set source records.
             * If data is in remote, will query selected records now.
             */
            if (this.getMainDataSource().getDataSourceJson().isDataInDataSourceInstance) {
                this.getMainDataSource().setOnceSetSourceRecords(querySelectedRecords);
            }
            else {
                querySelectedRecords();
            }
            return Promise.resolve({});
        }
        else if (this.isDataView && this.dataViewId === DATA_VIEW_ID_FOR_NO_SELECTION) {
            /**
             * If current data source is no_selection view, load records.
             * We load no_selection view in framework.
             */
            return Promise.allSettled([
                this.load({ returnGeometry: true }, { widgetId: DATA_VIEW_ID_FOR_NO_SELECTION }),
                this.loadCount({}, { widgetId: DATA_VIEW_ID_FOR_NO_SELECTION })
            ]).then(() => {
                var _a, _b, _c;
                // If selected record id is empty, should use no_selection view to do query.
                if (this.getMainDataSource().getSelectedRecordIds().filter(id => !!id).length === 0) {
                    // Clear selection and let other widgets / components to know selection view is updated.
                    (_a = this.getMainDataSource().getDataView(SELECTION_DATA_VIEW_ID)) === null || _a === void 0 ? void 0 : _a.clearRecords();
                    (_c = (_b = this.getMainDataSource().getDataView(SELECTION_DATA_VIEW_ID)) === null || _b === void 0 ? void 0 : _b.getAllDerivedDataSources()) === null || _c === void 0 ? void 0 : _c.forEach(ds => {
                        ds === null || ds === void 0 ? void 0 : ds.clearRecords();
                    });
                }
            });
        }
        else {
            return Promise.resolve({});
        }
    }
    getCurrentQueryParams(options) {
        var _a, _b;
        const runtimeQuery = this.getRuntimeQueryParams(((_a = options === null || options === void 0 ? void 0 : options.exclude) === null || _a === void 0 ? void 0 : _a.dataSourceId) === this.id ? (_b = options === null || options === void 0 ? void 0 : options.exclude) === null || _b === void 0 ? void 0 : _b.widgetId : null);
        return this.getCurrentQueryParamsByQuery(runtimeQuery, options);
    }
    getRuntimeQueryParams(excludeWidgetId) {
        var _a;
        const widgetQueries = excludeWidgetId ? (_a = this.getInfo().widgetQueries) === null || _a === void 0 ? void 0 : _a.without(excludeWidgetId) : this.getInfo().widgetQueries;
        return this.getMergedWidgetQueries(widgetQueries);
    }
    getCurrentQueryParamsByQuery(runtimeQuery, options) {
        let query;
        if (this.isLocal) { // local ds has no config query
            query = this.mergeQueryParams(this.belongToDataSource.getCurrentQueryParams(options), runtimeQuery);
        }
        else if (this.isDataView) {
            query = this.mergeQueryParams(this.getConfigQueryParams(), runtimeQuery);
            /**
             * Selection view is always case-sensitive since it is a client-side layer, main data source may be case-insensitive.
             * Use current data view to get correct SQL clause.
             */
            query = this.mergeQueryParams(this.getMainDataSource().getCurrentQueryParams(Object.assign(Object.assign({}, options), { dataSourceToFormatSql: this })), query);
        }
        else {
            query = this.mergeQueryParams(this.getConfigQueryParams(), runtimeQuery);
            query = this.mergeQueryParams(this.getRemoteQueryParams(), query);
        }
        return query;
    }
    getMergedWidgetQueries(widgetQueries) {
        let widgetIds = (widgetQueries && Object.keys(widgetQueries)) || [];
        widgetIds = widgetIds.sort((a, b) => a.localeCompare(b, 'en', { numeric: true, sensitivity: 'base' }));
        return this.mergeQueryParams(...widgetIds.map(widgetId => widgetQueries[widgetId]));
    }
    getCurrentQueryId() {
        return this.lastQueryId;
    }
    getRealQueryParams(query, flag, options) {
        let realQuery;
        if (flag === 'query') {
            if (options && options.scope) {
                if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InAllData) {
                    realQuery = query;
                }
                else if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InRemoteConfigView) {
                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), query);
                }
                else if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InConfigView) {
                    realQuery = this.mergeQueryWithConfigQuery(query);
                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), realQuery);
                }
                else if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InRuntimeView) {
                    realQuery = this.mergeQueryParams(this.getCurrentQueryParams({ exclude: options.excludeQuery, dataSourceToFormatSql: options.dataSourceToFormatSql }), query);
                }
                else {
                    realQuery = query;
                }
            }
            else { // no scope, same as InRuntimeView
                realQuery = this.mergeQueryParams(this.getCurrentQueryParams({ exclude: options === null || options === void 0 ? void 0 : options.excludeQuery, dataSourceToFormatSql: options === null || options === void 0 ? void 0 : options.dataSourceToFormatSql }), query);
            }
        }
        else { // for load
            if (!options || !options.widgetId) {
                console.error('Please pass widget id for load.');
                return null;
            }
            const getQueryForLoadRuntime = () => {
                let newQuery;
                let widgetQueries = this.getInfo().widgetQueries || (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
                if (options === null || options === void 0 ? void 0 : options.excludeQuery) {
                    widgetQueries = widgetQueries.without(options.excludeQuery.widgetId);
                }
                widgetQueries = widgetQueries.set(options.widgetId, query);
                newQuery = this.getMergedWidgetQueries(widgetQueries);
                newQuery = this.getCurrentQueryParamsByQuery(newQuery, { exclude: options.excludeQuery, dataSourceToFormatSql: options.dataSourceToFormatSql });
                return newQuery;
            };
            if (options && options.scope) {
                if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InAllData) {
                    realQuery = query;
                }
                else if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InRemoteConfigView) {
                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), query);
                }
                else if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InConfigView) {
                    realQuery = this.mergeQueryWithConfigQuery(query);
                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), realQuery);
                }
                else if (options.scope === _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InRuntimeView) {
                    realQuery = getQueryForLoadRuntime();
                }
                else {
                    realQuery = query;
                }
            }
            else {
                realQuery = getQueryForLoadRuntime();
            }
        }
        return realQuery;
    }
    mergeQueryWithConfigQuery(query) {
        let newQuery;
        if (this.isLocal) {
            if (this.belongToDataSource.isDataView) {
                newQuery = this.mergeQueryParams(this.belongToDataSource.getConfigQueryParams(), query);
                newQuery = this.mergeQueryParams(this.getMainDataSource().getConfigQueryParams(), newQuery);
            }
            else {
                newQuery = this.mergeQueryParams(this.getConfigQueryParams(), query);
            }
        }
        else if (this.isDataView) {
            newQuery = this.mergeQueryParams(this.getConfigQueryParams(), query);
            newQuery = this.mergeQueryParams(this.getMainDataSource().getConfigQueryParams(), newQuery);
        }
        else {
            newQuery = this.mergeQueryParams(this.getConfigQueryParams(), query);
        }
        return newQuery;
    }
    updateQueryParams(query, widgetId) {
        var _a;
        query = this.getQueryWithoutPage(query);
        if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.isDeepEqual(query || {}, ((_a = this.getInfo().widgetQueries) === null || _a === void 0 ? void 0 : _a[widgetId]) || {})) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.updateWidgetQuery(this.id, widgetId, query));
            /**
             * We update selection info and load selection view in framework.
             *
             * If query params of selection view is changed, load selection view (selection info will be updated after load).
             * Else, Check and update selection info of data sources which are derived from the current data source.
             */
            if (this.isSelectionView()) {
                this.load({ returnGeometry: true }, { widgetId: SELECTION_DATA_VIEW_ID });
                this.loadCount({}, { widgetId: SELECTION_DATA_VIEW_ID });
            }
            else {
                this.handleSelectionOnQueryParamChanges();
            }
        }
    }
    getQueryPageSize() {
        var _a, _b, _c;
        const configuredPageSize = ((_a = this.getDataViewConfig()) === null || _a === void 0 ? void 0 : _a.pageSize) || DEFAULT_QUERY_PAGE_SIZE;
        const serviceMaxPageSize = ((_c = (_b = this.getCapabilities()) === null || _b === void 0 ? void 0 : _b.getQueryCapabilities()) === null || _c === void 0 ? void 0 : _c.maxPageSize) || Infinity;
        return Math.min(configuredPageSize, serviceMaxPageSize);
    }
    getMaxRecordCount() {
        var _a;
        return ((_a = this.getDataViewConfig()) === null || _a === void 0 ? void 0 : _a.maximum) || null;
    }
    getQueryWithoutPage(query) {
        if (!query) {
            return null;
        }
        const { pageSize, page } = query, q = __rest(query, ["pageSize", "page"]);
        return q;
    }
    checkClearLocalCache(query, lastQuery, options) {
        const queryWithoutPage = this.getQueryWithoutPage(query);
        const realQueryWithoutPage = this.getRealQueryParams(queryWithoutPage, 'load', options);
        const realQueryWithoutPageOrUsedFields = this.applyUsedFields(realQueryWithoutPage, '*');
        const lastQueryWithoutPageOrUsedFields = this.applyUsedFields(lastQuery, '*');
        const refresh = options.refresh || this.getInfo().needRefresh;
        if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.isDeepEqual(realQueryWithoutPageOrUsedFields, lastQueryWithoutPageOrUsedFields) && !refresh) {
            return false;
        }
        else {
            /**
             * If needRefresh is true, only need to clear the cache and query new results once.
             */
            if (this.getInfo().needRefresh) {
                this.setNeedRefresh(false);
            }
            return true;
        }
    }
    selectRecords(options, signal, progressCallback) {
        const _super = Object.create(null, {
            selectRecords: { get: () => super.selectRecords }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.clearPendingSelect();
            if ((options === null || options === void 0 ? void 0 : options.records) || (options === null || options === void 0 ? void 0 : options.ids)) {
                const result = yield _super.selectRecords.call(this, options);
                return Promise.resolve(Object.assign(Object.assign({}, result), { queryParams: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(options === null || options === void 0 ? void 0 : options.queryParams) }));
            }
            else if (options === null || options === void 0 ? void 0 : options.queryParams) {
                const controller = new AbortController();
                if (signal) {
                    // Abort the query process whenever the input signal is aborted.
                    signal.onabort = e => { controller.abort(); };
                }
                this.abortControllerOfPendingPromiseToQuerySelectedRecordsBySelectOptions = controller;
                return this.queryAll(Object.assign(Object.assign({}, options.queryParams), { returnGeometry: true }), this.abortControllerOfPendingPromiseToQuerySelectedRecordsBySelectOptions.signal, progressCallback).then(result => {
                    /**
                     * Select the query result if -
                     * 1. the query process is completed, or,
                     * 2. is aborted by the input signal
                     * That is to say, do not select the query result if the query process is aborted by another select.
                     */
                    if (!result.isAborted || (signal === null || signal === void 0 ? void 0 : signal.aborted)) {
                        _super.selectRecords.call(this, Object.assign(Object.assign({}, options), { records: result.records }));
                    }
                    return result;
                }).catch((err) => {
                    console.error('Failed to select by options. ', err);
                    return { records: [], queryParams: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(options.queryParams) };
                });
            }
            return Promise.resolve({ records: [], queryParams: null });
        });
    }
    selectRecordById(id, record) {
        this.clearPendingSelect();
        super.selectRecordById(id, record);
    }
    selectRecordsByIds(ids, records) {
        this.clearPendingSelect();
        super.selectRecordsByIds(ids, records);
    }
    selectRecord(index) {
        this.clearPendingSelect();
        super.selectRecord(index);
    }
    clearSelection() {
        this.clearPendingSelect();
        super.clearSelection();
    }
    clearPendingSelect() {
        var _a;
        // Abort the pending select.
        (_a = this.abortControllerOfPendingPromiseToQuerySelectedRecordsBySelectOptions) === null || _a === void 0 ? void 0 : _a.abort();
        this.abortControllerOfPendingPromiseToQuerySelectedRecordsBySelectOptions = null;
    }
    getRecordsByPage(page, pageSize) {
        const records = [];
        const pages = Object.assign({}, this.pages);
        const maxPage = Object.keys(pages).map(p => parseInt(p)).sort((a, b) => b - a)[0];
        const queryPageSize = this.getQueryPageSize();
        let start = pageSize * (page - 1);
        let end = start + pageSize - 1;
        const maxCount = this.getMaxRecordCount();
        if (maxCount !== null) {
            /**
             * If start index is more than max index, return empty array.
             */
            if (start > maxCount - 1) {
                return records;
            }
            start = Math.min(start, maxCount - 1);
            end = Math.min(end, maxCount - 1);
        }
        for (let i = 1; i <= maxPage; i++) {
            const pageStart = (i - 1) * queryPageSize;
            const pageEnd = pageStart + queryPageSize - 1;
            if (pageEnd < start || pageStart > end) {
                continue;
            }
            if (pages[i]) {
                for (let pi = 0; pi < pages[i].length; pi++) {
                    if (pageStart + pi < start || pageStart + pi > end) {
                        continue;
                    }
                    records.push(pages[i][pi]);
                }
            }
        }
        return records;
    }
    getRecordsByPageWithSelection(page, pageSize) {
        return this.concatRecordsAndSelection(this.getSelectedRecords(), this.getRecordsByPage(page, pageSize));
    }
    getPagesData() {
        return this.pages;
    }
    setPagesData(pages) {
        this.pages = pages;
    }
    clearRecordsNotAddVersion() {
        if (!this.isSelectionView() && this.getSelectedRecords().length > 0) {
            this.copySelectionToDataView([]);
        }
        this.pages = {};
        this.pagePromises = {};
        this.loadMissingFieldsByPagePromises = {};
        this.loadMissingFieldsForAllPagePromise = null;
        this.count = null;
        this.countPromise = null;
        this.byIdPromise = null;
    }
    /**
     * get continuious page records
     */
    getRecords() {
        let records = [];
        const pages = []; // continuious pages
        for (let i = 1; i <= Object.keys(this.pages).length; i++) {
            if (!this.pages[i]) {
                break;
            }
            pages.push(i);
        }
        pages.forEach(page => {
            records = records.concat(this.pages[page]);
        });
        if (this.getMaxRecordCount() !== null && this.getMaxRecordCount() < records.length) {
            return records.slice(0, this.getMaxRecordCount());
        }
        return records;
    }
    setRecords(records) {
        const pages = {};
        const pageSize = this.getQueryPageSize();
        records.forEach((r, i) => {
            const newPageNumber = Math.ceil((i + 1) / pageSize);
            if (!pages[newPageNumber]) {
                pages[newPageNumber] = [];
            }
            pages[newPageNumber][i % pageSize] = r;
        });
        this.setPagesData(pages);
        this.addVersion();
    }
    setSourceRecords(records) {
        super.setSourceRecords(records);
        if (this.canSaveSourceRecords()) {
            /**
             * If have a hook to do after the first time set source records, do it and clear the hook.
             */
            if (this.onceSetSourceRecords) {
                const onceSetSourceRecords = this.onceSetSourceRecords;
                this.setOnceSetSourceRecords(null);
                jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
                    onceSetSourceRecords();
                });
            }
        }
    }
    get count() {
        return this._count;
    }
    set count(c) {
        this._count = c;
    }
    getRealQueryPages(page, pageSize) {
        // the record index starts from 0
        const start = pageSize * (page - 1);
        let end = start + pageSize - 1;
        if (this.getMaxRecordCount() !== null) {
            end = Math.min(end, this.getMaxRecordCount() - 1);
        }
        const startPage = Math.floor(start / this.getQueryPageSize()) + 1;
        const endPage = Math.floor(end / this.getQueryPageSize()) + 1;
        const pages = [];
        for (let i = startPage; i <= endPage; i++) {
            pages.push(i);
        }
        return pages;
    }
    /**
     * the page/pageSize in query will not be used in the actual query
     */
    load(query, options = {}) {
        var _a;
        if (this.getStatus() === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady) {
            return Promise.resolve([]);
        }
        query = Object.assign({}, query);
        if (!query.page) {
            query.page = 1;
        }
        if (!query.pageSize) {
            query.pageSize = this.getQueryPageSize();
        }
        const queryPages = this.getRealQueryPages(query.page, query.pageSize);
        if (this.checkClearLocalCache(query, this.lastQueryParams, options)) {
            Object.keys(this.pages).forEach((p) => {
                if (!queryPages.includes(parseInt(p))) {
                    delete this.pages[p];
                }
            });
            this.pagePromises = {};
            this.loadMissingFieldsByPagePromises = {};
            this.loadMissingFieldsForAllPagePromise = null;
            this.count = null;
            this.countPromise = null;
        }
        const queryWithoutPage = this.getQueryWithoutPage(query);
        if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.isDeepEqual(queryWithoutPage || {}, ((_a = this.getInfo().widgetQueries) === null || _a === void 0 ? void 0 : _a[options.widgetId]) || {})) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.updateWidgetQuery(this.id, options.widgetId, queryWithoutPage));
        }
        let realQuery = this.getRealQueryParams(queryWithoutPage, 'load', options);
        const usedFields = this.getAllUsedFields({ queryParams: realQuery, excludeWidgetsDoNotUseDsToQuery: true });
        realQuery = this.applyUsedFields(realQuery, usedFields);
        this.loadMissingFields(realQuery);
        const pagePromises = queryPages.filter(page => this.pagePromises[page]).map(page => this.pagePromises[page].promise);
        if (pagePromises.length === queryPages.length) {
            return Promise.all(pagePromises).then(() => {
                return this.getRecordsByPage(query.page, query.pageSize);
            });
        }
        this.lastQueryParams = realQuery;
        this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Loading);
        this.setNeedRefresh(false);
        return Promise.all(queryPages.map(page => this.loadByPage(realQuery, query, usedFields, page))).then((results) => {
            const isUseful = results.find(r => r);
            if (!isUseful) {
                // Tell the widgets which are using the returned promise that this result is outdated.
                return null;
            }
            this.handleSelectionOnQueryParamChanges();
            this.lastRefreshTime = new Date();
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Loaded);
            if (!(window.jimuConfig.isInBuilder && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appRuntimeInfo.appMode === jimu_core__WEBPACK_IMPORTED_MODULE_0__.AppMode.Design)) {
                this.startAutoRefresh();
            }
            return this.getRecordsByPage(query.page, query.pageSize);
        }, err => {
            console.error(err);
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.LoadError);
            return [];
        });
    }
    /**
     * Check and load missing fields for loaded records.
     * If delay is true, will merge mulitple calls and send one request after time window run out.
     */
    loadMissingFields(realQuery, delay = false) {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
            const usedFields = this.getAllUsedFields({ queryParams: realQuery, excludeWidgetsDoNotUseDsToQuery: true });
            this.updateLoadOnDemandFields(usedFields);
            if (delay) {
                this.usedFieldsInTimeWindow = this.mergeUsedFields(this.usedFieldsInTimeWindow, usedFields);
                if (this.loadMissingFieldsTimer) {
                    return;
                }
                this.loadMissingFieldsTimer = setTimeout(() => {
                    this.doLoadMissingFields(realQuery, this.usedFieldsInTimeWindow);
                    clearTimeout(this.loadMissingFieldsTimer);
                    this.loadMissingFieldsTimer = null;
                    this.usedFieldsInTimeWindow = [];
                }, 500);
            }
            else {
                this.doLoadMissingFields(realQuery, usedFields);
            }
        });
    }
    doLoadMissingFields(realQuery, usedFields) {
        var _a;
        if (this.isSelectionView()) {
            const records = this.getRecords();
            const notLoadedSourceRecords = this.getSourceRecords().filter(sR => !records.some(r => r.getId() === sR.getId()));
            const allRecords = records.concat(notLoadedSourceRecords);
            const missingFields = [];
            /**
             * Selected record may be from any data views, so find missing fields from records.
             * Need to find from records since records may miss some fields while source records don't. Records are loaded from source records.
             */
            allRecords.forEach(r => {
                const missingFieldsInRecord = this.findMissingFields(usedFields, Object.keys(r.getData()));
                missingFieldsInRecord.forEach(f => {
                    if (!missingFields.includes(f)) {
                        missingFields.push(f);
                    }
                });
            });
            if (missingFields.length === 0) {
                return;
            }
            /**
             * Update promise if 1. didn't load missing fields for selection view before, or, 2. new missing fields are more than the previous missing fields.
             */
            if (!this.loadMissingFieldsByPagePromises[SELECTION_DATA_VIEW_ID] || this.missingSomeFields(missingFields, this.loadMissingFieldsByPagePromises[SELECTION_DATA_VIEW_ID].fields)) {
                const ids = records.map(r => r.getId());
                const fieldSchema = (_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields;
                const promise = this.queryRecordsByIdWithCurrentQueryParams(ids, this.getMainDataSource(), this.applyUsedFields(realQuery, missingFields)).then(res => {
                    var _a;
                    if (fieldSchema !== ((_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields)) {
                        return false;
                    }
                    const records = this.getRecords();
                    const sourceRecords = this.getSourceRecords();
                    res.records.forEach(newRecord => {
                        const prevRecord = records.find(r => r.getId() === newRecord.getId());
                        if (prevRecord) {
                            prevRecord.setData(Object.assign(Object.assign({}, prevRecord.getData()), newRecord.getData()));
                        }
                        const prevSourceRecord = sourceRecords.find(r => r.getId() === newRecord.getId());
                        if (prevSourceRecord) {
                            prevSourceRecord.setData(Object.assign(Object.assign({}, prevSourceRecord.getData()), newRecord.getData()));
                        }
                    });
                    this.addSourceVersion();
                    this.addVersion();
                    return true;
                }).catch(err => {
                    console.error('Failed to load missing fields, ', err);
                    return false;
                });
                this.loadMissingFieldsByPagePromises[SELECTION_DATA_VIEW_ID] = { promise, fields: missingFields };
            }
        }
        else {
            /**
             * If there is no such a page that is missing some fields, no need to load.
             */
            if (!Object.values(this.pagePromises).some(p => this.missingSomeFields(usedFields, p.fields))) {
                return;
            }
            const missingFieldsByPage = {};
            Object.keys(this.pagePromises).forEach(pageId => {
                const page = parseInt(pageId);
                const missingFieldsInPage = this.findMissingFields(usedFields, this.pagePromises[page].fields);
                missingFieldsByPage[page] = missingFieldsInPage;
            });
            if (!this.loadMissingFieldsForAllPagePromise || Object.keys(this.pagePromises).some(pageId => this.missingSomeFields(missingFieldsByPage[pageId], this.loadMissingFieldsForAllPagePromise.fields[pageId]))) {
                const loadMissingFieldsByPagePromises = [];
                Object.keys(this.pagePromises).forEach(pageId => {
                    const page = parseInt(pageId);
                    const missingFieldsInPage = missingFieldsByPage[page];
                    const p = this.loadMissingFieldsByPage(realQuery, missingFieldsInPage, page);
                    loadMissingFieldsByPagePromises.push(p);
                });
                const promise = Promise.all(loadMissingFieldsByPagePromises).then(results => {
                    const isUseful = results.find(r => r);
                    if (isUseful) {
                        this.addVersion();
                    }
                    return true;
                }).catch(err => {
                    console.error('Failed to load missing fields, ', err);
                    return false;
                });
                this.loadMissingFieldsForAllPagePromise = { promise, fields: missingFieldsByPage };
            }
        }
    }
    loadMissingFieldsByPage(realQuery, missingFields, page) {
        var _a;
        if (!missingFields || missingFields.length === 0 || this.pagePromises[page].fields === '*') {
            return Promise.resolve(true);
        }
        /**
         * Update promise if 1. didn't load missing fields for the page before, or, 2. new missing fields are more than the previous missing fields.
         */
        if (!this.loadMissingFieldsByPagePromises[page] || this.missingSomeFields(missingFields, this.loadMissingFieldsByPagePromises[page].fields)) {
            const realQueryWithPage = Object.assign(Object.assign({}, realQuery), { page, pageSize: this.getQueryPageSize() });
            const fieldSchema = (_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields;
            const promise = this.query(this.applyUsedFields(realQueryWithPage, missingFields), { scope: _interfaces__WEBPACK_IMPORTED_MODULE_2__.QueryScope.InAllData }).then(result => {
                var _a, _b;
                if (fieldSchema !== ((_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields)) {
                    return false;
                }
                this.pagePromises[result.queryParams.page].fields = this.pagePromises[result.queryParams.page].fields.concat(missingFields);
                (_b = result.records) === null || _b === void 0 ? void 0 : _b.forEach(newRecord => {
                    var _a, _b, _c;
                    const prevRecord = (_a = this.pages[result.queryParams.page]) === null || _a === void 0 ? void 0 : _a.find(r => r.getId() === newRecord.getId());
                    if (prevRecord) {
                        prevRecord.setData(Object.assign(Object.assign({}, prevRecord.getData()), newRecord.getData()));
                    }
                    const prevRecordInSelection = (_c = (_b = this.getSelectionDataView()) === null || _b === void 0 ? void 0 : _b.getSourceRecords()) === null || _c === void 0 ? void 0 : _c.find(r => r.getId() === newRecord.getId());
                    if (prevRecordInSelection) {
                        prevRecordInSelection.setData(Object.assign(Object.assign({}, prevRecordInSelection.getData()), newRecord.getData()));
                    }
                });
                return true;
            });
            this.loadMissingFieldsByPagePromises[page] = { promise, fields: missingFields };
        }
        return this.loadMissingFieldsByPagePromises[page].promise;
    }
    /**
     * Keep selection after data source or data view is loaded.
     */
    handleSelectionOnQueryParamChanges() {
        var _a, _b;
        /**
         * If is using no_selection view to show default status, no need to update selection info since the loaded records are not selected by users, they are from no_selection view.
         * We do not expect records of no_selection view are hightlighted.
         */
        if (this.useNoSelectionView(this.getSelectionDataView())) {
            return;
        }
        /**
         * Do not update selection info if there is a pending promise to load preset selected records (e.g. preset in URL).
         */
        if (this.getSelectionDataView().pendingPromiseToQuerySelectedRecordsPresetBeforeDsReady) {
            return;
        }
        const isNoSelectionView = this.isDataView && this.dataViewId === DATA_VIEW_ID_FOR_NO_SELECTION;
        const isSelectionView = this.isSelectionView();
        const isLocalViewOfSelectionView = this.isLocalViewOfSelectionView();
        const isNotSelectionViewOrNoSelectionView = !isNoSelectionView && !isSelectionView && !isLocalViewOfSelectionView;
        if (isNotSelectionViewOrNoSelectionView) {
            /**
             * If data is saved in data source instance, find selected records from source records (records may not load, e.g. chart output data source),
             * else, find selected records from records (selected records should already be loaded).
             */
            const records = this.getDataSourceJson().isDataInDataSourceInstance ? this.getSourceRecords() : this.getRecords();
            /**
             * 1. Update source records of selection view - copy records that satisfy all of these 3 conditions (1. loaded 2. in selected record ids of data source info 3. not in source records of selection view) to selection view.
             */
            let selectedRecordsNotInSelectionView = [];
            this.getSelectedRecordIds().forEach(id => {
                const isInSelectionView = this.getSelectionDataView().getSourceRecords().some(r => r.getId() === id);
                const r = records.find(r => (r === null || r === void 0 ? void 0 : r.getId()) === id);
                if (!isInSelectionView && r) {
                    selectedRecordsNotInSelectionView = selectedRecordsNotInSelectionView.concat(r);
                }
            });
            if (selectedRecordsNotInSelectionView.length > 0) {
                this.copySelectionToDataView(this.getSelectionDataView().getSourceRecords().concat(selectedRecordsNotInSelectionView));
            }
            /**
             * 2. Check and update selection info of data sources which are derived from the current data source.
             */
            this.updateSelectionInfoOfDerivedDssAndChangeUrl(Object.assign(Object.assign({}, (_a = this.getSelectOptionsFromInfo()) === null || _a === void 0 ? void 0 : _a.asMutable({ deep: true })), { ids: this.getSelectionDataView().getRecords().map(r => r.getId()) }), this, true);
        }
        else if (isSelectionView) {
            /**
             * 1. Check and update selection info of data sources which are derived from main data source.
             */
            this.getMainDataSource().updateSelectionInfoOfDerivedDssAndChangeUrl(Object.assign(Object.assign({}, (_b = this.getMainDataSource().getSelectOptionsFromInfo()) === null || _b === void 0 ? void 0 : _b.asMutable({ deep: true })), { ids: this.getRecords().map(r => r.getId()) }));
        }
    }
    /**
     * the resolved boolean means whether the query result is used (only the last query update records)
     * @param realQuery
     * @param page
     */
    loadByPage(realQuery, originQuery, usedFields, page) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.pagePromises[page]) {
                return yield this.pagePromises[page].promise;
            }
            /**
             * If source records miss some fields, the query may not execute successfully. For example, source records miss fields used in filter.
             * Wait until load missing fields is done.
             */
            if (this.getDataSourceJson().isDataInDataSourceInstance && this.sourceRecordsMissingFields(this.getSourceRecords(), usedFields)) {
                return Promise.resolve(false);
            }
            const realQueryWithPage = Object.assign(Object.assign({}, realQuery), { page, pageSize: this.getQueryPageSize() });
            const promise = this.doQuery((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(realQueryWithPage), (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(originQuery)).then(result => {
                const resultQueryWithoutPage = this.getQueryWithoutPage(result.queryParams);
                // Make sure the last query and the last source take effect.
                if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.isDeepEqual(resultQueryWithoutPage, this.lastQueryParams)) {
                    return false;
                }
                // If only source version is incorrect, do the query again.
                if ((typeof result.sourceVersion === 'number' && result.sourceVersion !== this.getSourceVersion())) {
                    delete this.pagePromises[page];
                    return this.loadByPage(realQuery, originQuery, usedFields, page);
                }
                this.pages[result.queryParams.page] = result.records;
                return true;
            });
            this.pagePromises[page] = { promise, fields: usedFields };
            return this.pagePromises[page].promise;
        });
    }
    sourceRecordsMissingFields(sourceRecords, usedFields) {
        if (!sourceRecords || !usedFields) {
            return false;
        }
        return sourceRecords.some(r => this.missingSomeFields(usedFields, Object.keys(r.getData())));
    }
    loadCount(query, options = {}) {
        if (this.getCountStatus() === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady) {
            return Promise.resolve(0);
        }
        if (!this.checkClearLocalCache(query, this.lastCountQueryParams, options) && this.countPromise) {
            return this.countPromise;
        }
        const realQuery = this.getRealQueryParams(this.getQueryWithoutPage(query), 'load', options);
        this.lastCountQueryParams = realQuery;
        this.setCountStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Loading);
        this.countPromise = this.doQueryCount((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(realQuery)).then(result => {
            // Make sure the last query and the last source take effect.
            if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.isDeepEqual(result.queryParams, this.lastCountQueryParams)) {
                return null;
            }
            // If only source version is incorrect, do the query again.
            if ((typeof result.sourceVersion === 'number' && result.sourceVersion !== this.getSourceVersion())) {
                delete this.countPromise;
                return this.loadCount(query, options);
            }
            if (this.getMaxRecordCount() === null) {
                this.count = result.count;
            }
            else {
                this.count = Math.min(result.count, this.getMaxRecordCount());
            }
            this.setCountStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Loaded);
            return this.count;
        }, err => {
            console.error(err);
            this.setCountStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.LoadError);
            return Promise.reject(err);
        });
        return this.countPromise;
    }
    loadById(id, refresh) {
        if (this.getStatus() === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady) {
            return Promise.resolve(null);
        }
        if (id === this.lastQueryId && !refresh && this.byIdPromise) {
            return this.byIdPromise;
        }
        this.lastQueryId = id;
        this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Loading);
        this.byIdPromise = this.doQueryById(id).then(record => {
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.Loaded);
            return record;
        }, err => {
            console.error(err);
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.LoadError);
            return null;
        });
        return this.byIdPromise;
    }
    query(query, options) {
        if (this.getStatus() === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady) {
            return Promise.resolve({
                queryParams: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(query),
                records: [],
                fields: [],
                sourceVersion: this.getSourceVersion()
            });
        }
        const realQuery = this.getRealQueryParams(query, 'query', options);
        return this.doQuery((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(realQuery), (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(query)).then(result => {
            const maxCount = this.getMaxRecordCount();
            if (maxCount === null) {
                return result;
            }
            const page = result.queryParams.page || 1;
            const pageSize = result.queryParams.pageSize;
            if (page === 1 || !pageSize) {
                if (result.records.length > maxCount) {
                    result.records = result.records.slice(0, maxCount);
                }
            }
            else {
                if (((page - 1) * pageSize) > maxCount) {
                    result.records = [];
                }
                else if ((page - 1) * pageSize + result.records.length > maxCount) {
                    result.records = result.records.slice(0, (page - 1) * pageSize + result.records.length - maxCount);
                }
            }
            return result;
        });
    }
    queryCount(query, options) {
        if (this.getCountStatus() === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady) {
            return Promise.resolve({
                queryParams: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(query),
                count: 0,
                sourceVersion: this.getSourceVersion()
            });
        }
        if (this.useNoSelectionView()) {
            const noSelectionView = this.getMainDataSource().getDataView(jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION);
            if (noSelectionView) {
                return noSelectionView.queryCount(query, options);
            }
        }
        const realQuery = this.getRealQueryParams(query, 'query', options);
        return this.doQueryCount((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(realQuery)).then(result => {
            if (this.getMaxRecordCount() === null) {
                return result;
            }
            else {
                result.count = Math.min(result.count, this.getMaxRecordCount());
                return result;
            }
        });
    }
    queryIds(query, options) {
        if (this.getCountStatus() === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady) {
            return Promise.resolve({
                queryParams: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(query),
                ids: [],
                sourceVersion: this.getSourceVersion()
            });
        }
        if (this.useNoSelectionView()) {
            const noSelectionView = this.getMainDataSource().getDataView(jimu_core__WEBPACK_IMPORTED_MODULE_0__.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION);
            if (noSelectionView) {
                return noSelectionView.queryIds(query, options);
            }
        }
        const realQuery = this.getRealQueryParams(query, 'query', options);
        return this.doQueryIds((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(realQuery)).then(result => {
            if (this.getMaxRecordCount() === null) {
                return result;
            }
            else {
                const maxCount = Math.min(result.ids.length, this.getMaxRecordCount());
                result.ids.splice(maxCount);
                return result;
            }
        });
    }
    queryAll(query, signal, progressCallback, options) {
        const q = Object.assign({}, query);
        const result = {
            queryParams: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(q).without('page').without('pageSize'),
            records: []
        };
        const setIsAborted = (result) => {
            result.isAborted = true;
            return result;
        };
        const queryByPage = (pageSize, pageCount, result, signal, progressCallback) => __awaiter(this, void 0, void 0, function* () {
            if (pageCount > 0) {
                for (let i = 1; i <= pageCount; i++) {
                    q.page = i;
                    q.pageSize = pageSize;
                    const r = yield this.query(q, options);
                    if ((r === null || r === void 0 ? void 0 : r.records) && r.records.length > 0) {
                        // Concat current page result to all result.
                        result.records.push(...r.records);
                        // Check if is aborted.
                        if (signal === null || signal === void 0 ? void 0 : signal.aborted) {
                            return setIsAborted(result);
                        }
                        // Send progress.
                        progressCallback === null || progressCallback === void 0 ? void 0 : progressCallback(i / pageCount, result);
                    }
                }
            }
            return result;
        });
        // Check if is aborted before sending any requests.
        if (signal === null || signal === void 0 ? void 0 : signal.aborted) {
            return Promise.resolve(setIsAborted(result));
        }
        // The process begins.
        progressCallback === null || progressCallback === void 0 ? void 0 : progressCallback(0, result);
        return this.queryCount(q, options).then(countResult => {
            return new Promise(resolve => {
                var _a, _b;
                if (signal) {
                    // Abort the process whenever abort method of abort controller is called.
                    signal.onabort = e => {
                        resolve(setIsAborted(result));
                    };
                }
                const totalCount = countResult.count;
                const maxCount = this.getMaxRecordCount() !== null ? Math.min(totalCount, this.getMaxRecordCount()) : totalCount;
                const pageSize = ((_b = (_a = this.getCapabilities()) === null || _a === void 0 ? void 0 : _a.getQueryCapabilities()) === null || _b === void 0 ? void 0 : _b.maxPageSize) || this.getQueryPageSize();
                const pageCount = Math.ceil(maxCount / pageSize);
                queryByPage(pageSize, pageCount, result, signal, progressCallback).then(r => { resolve(r); });
            });
        });
    }
    queryById(id) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getStatus() === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceStatus.NotReady) {
                return yield Promise.resolve(null);
            }
            return yield this.doQueryById(id);
        });
    }
    getAutoRefreshInterval() {
        const ds = this.getMainDataSource();
        let interval = ds.getDataViewConfig() && ds.getDataViewConfig().refreshInterval;
        if (interval === 0) { // 0 means do not auto refresh.
            return 0;
        }
        if (interval === null || typeof interval === 'undefined') { // means user layer/map's setting
            interval = ds.getSchema().refreshInterval;
        }
        return interval;
    }
    getLastRefreshTime() {
        return this.lastRefreshTime;
    }
    startAutoRefresh() {
        const interval = this.getAutoRefreshInterval();
        if (!interval) {
            return;
        }
        if (this.autoRefreshHandle) {
            return;
        }
        // Reset needRefresh to false.
        this.setNeedRefresh(false);
        // Start a new interval.
        this.autoRefreshHandle = setInterval(() => {
            this.setNeedRefresh(true);
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => { this.setNeedRefresh(false); });
        }, interval * 1000);
    }
    stopAutoRefresh() {
        if (this.autoRefreshHandle) {
            // Reset needRefresh to false.
            this.setNeedRefresh(false);
            // Clear interval.
            clearInterval(this.autoRefreshHandle);
            this.autoRefreshHandle = null;
        }
    }
    setNeedRefresh(needRefresh) {
        /**
         * Change data source info only when current `needRefresh` is not same as new `needRefresh`.
         */
        if (this.getInfo().needRefresh !== needRefresh) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.setDataNeedRefresh(this.id, needRefresh));
        }
    }
    setCapabilities(cap) {
        this.capabilities = cap;
    }
    getCapabilities() {
        if (this.canSaveSourceRecords()) {
            return this.capabilities;
        }
        else {
            return this.getMainDataSource().getCapabilities();
        }
    }
    getMainDataSource() {
        return super.getMainDataSource();
    }
    getDataViews() {
        return super.getDataViews();
    }
    getDataView(dataViewId) {
        return super.getDataView(dataViewId);
    }
    updateSelectionInfo(options, triggerDataSource, forceCheck) {
        var _a;
        if (!(options === null || options === void 0 ? void 0 : options.ids) && !(options === null || options === void 0 ? void 0 : options.records)) {
            return;
        }
        /**
         * Update selected record ids only when current data source listens selection or current data source is the data source which triggers selection.
         */
        const needToUpdateInfo = this.getListenSelection() || this.id === (triggerDataSource === null || triggerDataSource === void 0 ? void 0 : triggerDataSource.id);
        if (!needToUpdateInfo) {
            return;
        }
        /**
         * Main data source and output view contains all records, no need to check whether selected records match query params of them.
         * If selected records are empty, no need to check, too.
         */
        const isMainDataSource = !this.isLocal && !this.isDataView;
        const isOutputView = this.dataViewId === OUTPUT_DATA_VIEW_ID;
        const isSubset = !isMainDataSource && !isOutputView;
        const ids = ((_a = options.records) === null || _a === void 0 ? void 0 : _a.map(r => r.getId())) || options.ids;
        const needToDoCheck = (forceCheck || isSubset) && ids.length > 0;
        if (!needToDoCheck) {
            this.changeSelectedRecordIdsOfDsInfo(options);
            return;
        }
        const records = this.getRecords();
        const currentSelectedIds = this.getSelectedRecordIds();
        let idsNotInLoadedRecords = [];
        let idsInLoadedRecords = [];
        ids.forEach(id => {
            if (records.some(r => (r === null || r === void 0 ? void 0 : r.getId()) === id) || (!forceCheck && currentSelectedIds.some(selectedId => selectedId === id))) {
                idsInLoadedRecords = idsInLoadedRecords.concat(id);
            }
            else {
                idsNotInLoadedRecords = idsNotInLoadedRecords.concat(id);
            }
        });
        /**
         * If every selected record is already loaded or is in current selected ids, no need to check.
         */
        if (idsInLoadedRecords.length === ids.length) {
            this.changeSelectedRecordIdsOfDsInfo(options);
            return;
        }
        /**
         * Check whether selected records match query parmas of current data source.
         */
        this.throttleQueryRecordsByIdWithCurrentQueryParams(idsNotInLoadedRecords).then(res => {
            const prevSelectedIds = currentSelectedIds;
            const curSelectedIds = this.getSelectedRecordIds();
            const isSelectionStillTheSame = curSelectedIds.length === prevSelectedIds.length && curSelectedIds.every(curId => prevSelectedIds.some(prevId => prevId === curId));
            /**
             * If selection has been changed during the time waiting for check result back (e.g. changed by message action), no need to update selection info.
             */
            if (isSelectionStillTheSame) {
                const idsMatchQueryParamsNotInLoadedRecords = idsNotInLoadedRecords.filter(id => { var _a; return (_a = res === null || res === void 0 ? void 0 : res.records) === null || _a === void 0 ? void 0 : _a.some(r => (r === null || r === void 0 ? void 0 : r.getId()) === id); });
                this.changeSelectedRecordIdsOfDsInfo(Object.assign(Object.assign({}, options), { ids: idsInLoadedRecords.concat(idsMatchQueryParamsNotInLoadedRecords) }));
            }
        }).catch(err => {
            console.error(`Failed to check whether selected records in ${this.id}. `, err);
        });
    }
    changeSelectedRecordIdsOfDsInfo(options) {
        var _a;
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dataSourceSelectionChanged(this.id, options));
        /**
         * If is main data source, will update version of selection view.
         * This can make sure widget/component can get the newest selected records via `selectionView.getSelectedRecords()`.
         *
         * Will do it only if the current data source is the main data source since `selectionView.getSelectedRecords()` will return the intersection of 1. selected record ids of main data source info and 2. records of selection view.
         * Only main data source info and selection view records can affect the result.
         */
        if (this.getMainDataSource().id === this.id) {
            (_a = this.getSelectionDataView()) === null || _a === void 0 ? void 0 : _a.addVersion();
            /**
             * Checking whether need to use no_selection view uses the selection info, see `useNoSelectionView`.
             * After the newest selection info is set, need to do the check again.
             * If need to use no_selection view now, update source version of selection view to let widgets to refresh.
             */
            if (this.useNoSelectionView(this.getSelectionDataView())) {
                this.getSelectionDataView().addSourceVersion();
            }
        }
    }
    queryRecordsByIdWithCurrentQueryParams(ids, dataSource, queryParams) {
        return __awaiter(this, void 0, void 0, function* () {
            const objectIds = ids.map(id => +id).filter(id => !isNaN(id));
            const checkRecordsQueryParams = this.mergeQueryParams(queryParams, { objectIds });
            // In query method, will merge current query params and `checkRecordsQueryParams`.
            return dataSource ? dataSource.query(checkRecordsQueryParams) : this.query(checkRecordsQueryParams);
        });
    }
    deleteOneLoadedRecordById(ds, id) {
        var _a;
        const pages = ds.getPagesData();
        const pageId = Object.keys(pages).find(pId => { var _a; return (_a = pages[pId]) === null || _a === void 0 ? void 0 : _a.some(r => (r === null || r === void 0 ? void 0 : r.getId()) === id); });
        const index = (_a = pages[pageId]) === null || _a === void 0 ? void 0 : _a.findIndex(r => (r === null || r === void 0 ? void 0 : r.getId()) === id);
        if (typeof index === 'number' && index > -1) {
            pages[pageId].splice(index, 1);
            ds.addVersion();
        }
    }
    setOnceSetSourceRecords(func) {
        this.onceSetSourceRecords = func;
    }
    getAllUsedFields(options) {
        return super.getAllUsedFields(options);
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/abstract-set-data-source.ts":
/*!*****************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/abstract-set-data-source.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractSetDataSource: () => (/* binding */ AbstractSetDataSource)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./abstract-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-data-source.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class AbstractSetDataSource extends _abstract_data_source__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource {
    constructor() {
        super(...arguments);
        this.isDataSourceSet = true;
        this.childDataSourcesCreated = false;
        this.childDataSourcePromises = {};
    }
    ready() {
        return Promise.resolve();
    }
    childDataSourcesReady() {
        return this.createChildDataSourcesRecursively().finally(() => {
            this.childDataSourcesCreated = true;
        });
    }
    areChildDataSourcesCreated() {
        return this.childDataSourcesCreated;
    }
    // Create child data sources and wait for all descendant data sources created.
    createChildDataSourcesRecursively() {
        return this.createChildDataSources().then(childDss => Promise.allSettled(childDss.map(childDs => childDs.isDataSourceSet ? childDs.childDataSourcesReady().then(() => childDs) : childDs)).then(childDssRes => childDssRes.filter(c => c.status === 'fulfilled').map(c => c.value)));
    }
    createChildDataSources() {
        return __awaiter(this, void 0, void 0, function* () {
            const childDsIds = this.getChildDataSourceIds();
            childDsIds.forEach(childDsId => {
                if (!this.childDataSourcePromises[childDsId]) {
                    this.childDataSourcePromises[childDsId] = this.createDataSourceById(childDsId);
                }
            });
            return Promise.allSettled(Object.values(this.childDataSourcePromises)).then(childDssRes => childDssRes.filter(c => c.status === 'fulfilled').map(c => c.value));
        });
    }
    // Create a child or a descendant data source by id.
    createDataSourceById(dataSourceId) {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const neededChildDsId = this.findChildDataSourceIdByDescendantDataSourceId(dataSourceId);
                if (!neededChildDsId) {
                    return Promise.reject(new _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceError(dataSourceId, 'Can not find data source.'));
                }
                if (!this.childDataSourcePromises[neededChildDsId]) {
                    const childIds = this.getChildIds();
                    const childId = childIds.find(cId => this.getJimuChildId(cId).some(jimuCId => this.getChildDataSourceId(jimuCId) === neededChildDsId));
                    const jimuChildId = this.getJimuChildId(childId).find(jimuCId => this.getChildDataSourceId(jimuCId) === neededChildDsId);
                    this.childDataSourcePromises[neededChildDsId] = this.createChildDataSourceById(neededChildDsId, jimuChildId, childId);
                }
                const childDs = yield this.childDataSourcePromises[neededChildDsId];
                if (childDs.id === dataSourceId) {
                    return childDs;
                }
                else if (childDs.isDataSourceSet) {
                    return childDs.createDataSourceById(dataSourceId);
                }
                return Promise.reject(new _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceError(dataSourceId, 'Can not find data source.'));
            }
            catch (err) {
                return Promise.reject(new _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceError(dataSourceId, 'Failed to create the data source.'));
            }
        });
    }
    findChildDataSourceIdByDescendantDataSourceId(dataSourceId) {
        const childDsIds = this.getChildDataSourceIds();
        /**
         * The process is to find a child data source ID whose splitted ID array (by '-') has the same first N elements with the passed in data source ID.
         * Can not use string's startsWith here, since we need to match each element of the ID array, not part of the element.
         * For example,
         * 1. The child data source IDs are ds1-1 and ds1-10, the descendant data source ID is ds1-10-1, should return ds1-10.
         * 2. The child data source IDs are ds1-1 and ds1-10, the descendant data source ID is ds1-10, should return ds1-10.
         * 3. The child data source IDs are ds1-1 and ds1-10, the descendant data source ID is ds1-11-1, should return null.
         */
        const descendantDsIdArr = dataSourceId === null || dataSourceId === void 0 ? void 0 : dataSourceId.split('-');
        const neededChildDsId = childDsIds.find(childDsId => {
            const childDsIdArr = childDsId === null || childDsId === void 0 ? void 0 : childDsId.split('-');
            return childDsIdArr === null || childDsIdArr === void 0 ? void 0 : childDsIdArr.every((d, i) => descendantDsIdArr[i] === d);
        }, null);
        return neededChildDsId;
    }
    getChildDataSourceIds() {
        const childIds = this.getChildIds();
        return childIds.reduce((jimuChildIds, childId) => jimuChildIds.concat(this.getJimuChildId(childId)), []).map(jimuChildId => this.getChildDataSourceId(jimuChildId));
    }
    destroy() {
        if (!this.areChildDataSourcesCreated()) {
            this.childDataSourcesReady().then(childDss => {
                childDss.forEach(ds => {
                    if (ds) {
                        this.dataSourceManager.destroyDataSource(ds.id);
                    }
                });
            });
        }
        else {
            this.getChildDataSources().forEach(ds => {
                if (ds) {
                    this.dataSourceManager.destroyDataSource(ds.id);
                }
            });
        }
    }
    getChildDataSourceId(jimuChildId) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getChildDataSourceId(this.id, jimuChildId);
    }
    getChildDataSources() {
        const childDss = Object.keys(this.dataSourceManager.getDataSources())
            .filter(dsId => this.dataSourceManager.getDataSource(dsId).parentDataSource === this)
            .map(dsId => this.dataSourceManager.getDataSource(dsId));
        return childDss.sort((ds1, ds2) => ds1.order - ds2.order);
    }
    getAllChildDataSources() {
        const visitTree = (ds, results) => {
            const childDss = ds.isDataSourceSet && ds.getChildDataSources();
            if (childDss) {
                childDss.forEach(childDs => {
                    results.push(childDs);
                    if (childDs.isDataSourceSet) {
                        visitTree(childDs, results);
                    }
                });
            }
        };
        const allDss = [];
        visitTree(this, allDss);
        return allDss;
    }
    getChildDataSource(jimuChildId) {
        return this.dataSourceManager.getDataSource(this.getChildDataSourceId(jimuChildId));
    }
    getJimuChildId(childId) {
        const rschema = this.getReversedConfigSchema();
        if (rschema && rschema.childSchemas && rschema.childSchemas[childId]) {
            return (rschema.childSchemas[childId]).map(schema => schema.jimuChildId).asMutable();
        }
        else {
            return [childId];
        }
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/data-record.ts":
/*!****************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/data-record.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractDataRecord: () => (/* binding */ AbstractDataRecord),
/* harmony export */   SimpleDataRecordImpl: () => (/* binding */ SimpleDataRecordImpl),
/* harmony export */   SimpleDataRecordSetImpl: () => (/* binding */ SimpleDataRecordSetImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

/**
 * Include the common implementations for data record.
 */
class AbstractDataRecord {
    clone(deep) {
        const shallowClone = jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.clone(this);
        if (deep) {
            shallowClone.setData(jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.cloneDeep(this.getData()));
            return shallowClone;
        }
        else {
            return shallowClone;
        }
    }
    getFieldValue(jimuFieldName) {
        return this.getData()[jimuFieldName];
    }
    /** @ignore */
    getDateFieldValue(jimuFieldName) {
        return this.getFieldValue(jimuFieldName);
    }
    getFormattedFieldValue(jimuFieldName, intl) {
        const field = this.dataSource.getSchema().fields[jimuFieldName];
        if (field) {
            if (field.format) {
                switch (field.type) {
                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__.JimuFieldType.Date:
                        return this.formatDateField(this.getDateFieldValue(jimuFieldName), field.format.dateFormat, intl);
                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__.JimuFieldType.Number:
                        return this.formatNumberField(this.getFieldValue(jimuFieldName), field.format.places, field.format.digitSeparator, intl);
                    default:
                        return this.getFieldValue(jimuFieldName);
                }
            }
            else {
                switch (field.type) {
                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__.JimuFieldType.Date:
                        return this.getFieldValue(jimuFieldName) !== null && this.getFieldValue(jimuFieldName) !== undefined
                            ? intl.formatDate(this.getDateFieldValue(jimuFieldName))
                            : null;
                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__.JimuFieldType.Number:
                        return this.getFieldValue(jimuFieldName) !== null && this.getFieldValue(jimuFieldName) !== undefined
                            ? intl.formatNumber(this.getFieldValue(jimuFieldName))
                            : null;
                    default:
                        return this.getFieldValue(jimuFieldName);
                }
            }
        }
        else {
            return this.getFieldValue(jimuFieldName);
        }
    }
    /** @ignore */
    convertBeforeMappingDataToData(dataBeforeMapping) {
        const reversedData = {};
        const reversedSchema = this.dataSource.getReversedConfigSchema();
        Object.keys(dataBeforeMapping).forEach(fieldName => {
            const fields = reversedSchema && reversedSchema.fields && reversedSchema.fields[fieldName];
            if (fields) {
                fields.forEach(f => {
                    reversedData[f.jimuName] = dataBeforeMapping[fieldName];
                });
            }
            else {
                reversedData[fieldName] = dataBeforeMapping[fieldName];
            }
        });
        return reversedData;
    }
    /** @ignore */
    convertDataToDataBeforeMapping(data) {
        const dataBeforeMapping = {};
        const schema = this.dataSource.getSchema();
        Object.keys(data).forEach(jimuFieldName => {
            const fieldName = schema && schema.fields && schema.fields[jimuFieldName] ? schema.fields[jimuFieldName].name : jimuFieldName;
            dataBeforeMapping[fieldName] = data[jimuFieldName];
        });
        return dataBeforeMapping;
    }
    getFormattedData(intl) {
        const ret = {};
        Object.keys(this.getData()).forEach(fieldName => {
            ret[fieldName] = this.getFormattedFieldValue(fieldName, intl);
        });
        return ret;
    }
    formatDateField(value, esriDateFormat, intl) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.formatDateField(value, esriDateFormat, intl);
    }
    formatNumberField(value, places, digitSeparator, intl) {
        if (value === null || value === undefined) {
            return null;
        }
        /* eslint-disable-next-line*/
        const num = new Number(value);
        if (digitSeparator) {
            return intl.formatNumber(value, { maximumFractionDigits: places, minimumFractionDigits: places });
        }
        else {
            return num.toFixed(places);
        }
    }
    set dataSource(d) {
        this._dataSource = d;
    }
    get dataSource() {
        return this._dataSource;
    }
}
/**
 * @ignore
 */
class SimpleDataRecordImpl extends AbstractDataRecord {
    /**
     * beforeMappingData: is the data from the real data source, such as query from remote service/database.
     * data is the data used in Exb.
     *
     * The beforeMappingData uses this schema: {fieldName: value}, we'll reverse it to {jimuFieldName: value}, which is called data and will be used in exb.
     *
     */
    constructor(data, dataSource, isBeforeMappingData = true) {
        super();
        this.dataSource = dataSource;
        if (isBeforeMappingData) {
            this.data = this.convertBeforeMappingDataToData(data);
        }
        else {
            this.data = data;
        }
    }
    getData() {
        return this.data;
    }
    setData(data) {
        this.data = data;
    }
    getDataBeforeMapping() {
        return this.convertDataToDataBeforeMapping(this.data);
    }
    toJson() {
        return this.data;
    }
    getId() {
        return this.data.id;
    }
    setId() {
    }
    getGeometry() {
        return null;
    }
    getRawGeometry() {
        return null;
    }
    setGeometry(geo) {
    }
}
/**
 * @ignore
 */
class SimpleDataRecordSetImpl {
    constructor(options) {
        Object.assign(this, options);
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/index.ts":
/*!**********************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/index.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractDataRecord: () => (/* reexport safe */ _data_record__WEBPACK_IMPORTED_MODULE_5__.AbstractDataRecord),
/* harmony export */   AbstractDataSource: () => (/* reexport safe */ _abstract_data_source__WEBPACK_IMPORTED_MODULE_0__.AbstractDataSource),
/* harmony export */   AbstractLayerFolderDataSource: () => (/* reexport safe */ _abstract_layer_folder_data_source__WEBPACK_IMPORTED_MODULE_1__.AbstractLayerFolderDataSource),
/* harmony export */   AbstractLoadableDataSource: () => (/* reexport safe */ _abstract_loadable_data_source__WEBPACK_IMPORTED_MODULE_2__.AbstractLoadableDataSource),
/* harmony export */   AbstractQueriableDataSource: () => (/* reexport safe */ _abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_3__.AbstractQueriableDataSource),
/* harmony export */   AbstractSetDataSource: () => (/* reexport safe */ _abstract_set_data_source__WEBPACK_IMPORTED_MODULE_4__.AbstractSetDataSource),
/* harmony export */   ItemMixinImpl: () => (/* reexport safe */ _item_mixin__WEBPACK_IMPORTED_MODULE_6__.ItemMixinImpl),
/* harmony export */   JSAPILayerMixinImpl: () => (/* reexport safe */ _js_api_layer_mixin__WEBPACK_IMPORTED_MODULE_7__.JSAPILayerMixinImpl),
/* harmony export */   SimpleDataRecordImpl: () => (/* reexport safe */ _data_record__WEBPACK_IMPORTED_MODULE_5__.SimpleDataRecordImpl),
/* harmony export */   SimpleDataRecordSetImpl: () => (/* reexport safe */ _data_record__WEBPACK_IMPORTED_MODULE_5__.SimpleDataRecordSetImpl)
/* harmony export */ });
/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abstract-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-data-source.ts");
/* harmony import */ var _abstract_layer_folder_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./abstract-layer-folder-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-layer-folder-data-source.ts");
/* harmony import */ var _abstract_loadable_data_source__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./abstract-loadable-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-loadable-data-source.ts");
/* harmony import */ var _abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./abstract-queriable-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-queriable-data-source.ts");
/* harmony import */ var _abstract_set_data_source__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./abstract-set-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-set-data-source.ts");
/* harmony import */ var _data_record__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./data-record */ "./jimu-core/lib/data-sources/base-classes/data-record.ts");
/* harmony import */ var _item_mixin__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./item-mixin */ "./jimu-core/lib/data-sources/base-classes/item-mixin.ts");
/* harmony import */ var _js_api_layer_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./js-api-layer-mixin */ "./jimu-core/lib/data-sources/base-classes/js-api-layer-mixin.ts");










/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/item-mixin.ts":
/*!***************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/item-mixin.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ItemMixinImpl: () => (/* binding */ ItemMixinImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

const fetchItemDataPromises = {};
const fetchItemInfoPromises = {};
const ItemMixinImpl = (Base) => {
    class ItemMixinImpl extends Base {
        get itemId() {
            return this._itemId;
        }
        set itemId(itemId) {
            if (this._itemId !== itemId) {
                this._itemId = itemId;
                this.clearData();
            }
        }
        get portalUrl() {
            return this._portalUrl;
        }
        set portalUrl(portalUrl) {
            if (this._portalUrl !== portalUrl) {
                this._portalUrl = portalUrl;
                this.clearData();
            }
        }
        getItemData() {
            return this.itemData;
        }
        setItemData(itemData) {
            this.itemData = itemData;
        }
        /**
         * Classes that extend this class may get item info from other sources, e.g. JSAPI layer object.
         */
        setItemInfo(itemInfo) {
            this.itemInfo = itemInfo;
        }
        getItemInfo() {
            return this.itemInfo;
        }
        fetchItemData() {
            if (!this.portalUrl || !this.itemId) {
                return Promise.resolve(null);
            }
            if (this.itemData) {
                return Promise.resolve(this.itemData);
            }
            if (!fetchItemDataPromises[getCacheId(this.portalUrl, this.itemId)]) {
                fetchItemDataPromises[getCacheId(this.portalUrl, this.itemId)] = jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper(this.portalUrl, (session) => {
                    return jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.getItemData(this.itemId, {
                        portal: jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPortalRestUrl(this.portalUrl),
                        authentication: session
                    });
                });
            }
            return fetchItemDataPromises[getCacheId(this.portalUrl, this.itemId)].then(itemData => {
                this.itemData = itemData;
                return this.itemData;
            });
        }
        fetchItemInfo() {
            if (!this.portalUrl || !this.itemId) {
                return Promise.resolve(null);
            }
            if (this.itemInfo) {
                return Promise.resolve(this.itemInfo);
            }
            if (!fetchItemInfoPromises[getCacheId(this.portalUrl, this.itemId)]) {
                fetchItemInfoPromises[getCacheId(this.portalUrl, this.itemId)] = jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper(this.portalUrl, (session) => {
                    return jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.getItem(this.itemId, {
                        portal: jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPortalRestUrl(this.portalUrl),
                        authentication: session
                    });
                });
            }
            return fetchItemInfoPromises[getCacheId(this.portalUrl, this.itemId)].then(itemInfo => {
                this.itemInfo = itemInfo;
                return this.itemInfo;
            });
        }
        clearData() {
            this.itemData = null;
            this.itemInfo = null;
        }
    }
    return ItemMixinImpl;
};
function getCacheId(portalUrl, itemId) {
    return `${portalUrl}-${itemId}`;
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/base-classes/js-api-layer-mixin.ts":
/*!***********************************************************************!*\
  !*** ./jimu-core/lib/data-sources/base-classes/js-api-layer-mixin.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   JSAPILayerMixinImpl: () => (/* binding */ JSAPILayerMixinImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


const JSAPILayerMixinImpl = (Base) => {
    class JSAPILayerMixinImpl extends Base {
        get jimuLayerId() {
            if (this.layer && !this._jimuLayerId) {
                this._jimuLayerId = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getJimuLayerIdByJSAPILayer(this.layer);
            }
            return this._jimuLayerId;
        }
        createJSAPILayerByDataSource() {
            return __awaiter(this, void 0, void 0, function* () {
                let layer;
                try {
                    const options = this.getLayerConstructorOptions();
                    if (NonArcGISLayerClass[this.type]) { // Layers which are not from ArcGIS, such as csv layer, geojson layer and so on.
                        const Layer = yield (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModule)(NonArcGISLayerClass[this.type]);
                        layer = new Layer(options);
                    }
                    else { // Layers which are from ArcGIS, such as feature layer, map service layer, image service layer.
                        const Layer = yield (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModule)('esri/layers/Layer');
                        if (this.portalUrl && this.itemId) {
                            layer = yield Layer.fromPortalItem(options);
                        }
                        else if (this.url) {
                            layer = yield Layer.fromArcGISServerUrl(options);
                        }
                    }
                    const label = this.getDataSourceJson().label || this.getDataSourceJson().sourceLabel;
                    if (layer && layer.title !== label) {
                        layer.title = label;
                    }
                    if (layer && !this.layer && !this._cachedLayer) {
                        this._cachedLayer = layer;
                    }
                }
                catch (err) {
                    console.error('Failed to create JS API layer. ', err, this.id);
                }
                return layer;
            });
        }
        supportSpatialInfo() {
            const ds = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().getDataSource(this.id);
            if (ds === null || ds === void 0 ? void 0 : ds.isDataSourceSet) {
                /**
                 * We do not support some types of scene layer (e.g. building scene layer), but wo do support scene service.
                 * Scene service must have spatial info.
                 */
                return ds.getChildDataSources().length === 0 || ds.getChildDataSources().some(ds => { var _a; return (_a = ds === null || ds === void 0 ? void 0 : ds.supportSpatialInfo) === null || _a === void 0 ? void 0 : _a.call(ds); });
            }
            const cachedLayer = this.layer || this._cachedLayer;
            if (cachedLayer) {
                /**
                 * Some layers have `isTable` property (e.g. feature layer and csv layer), some don't.
                 * `isTable` is undefined or false means the layer has spatial info.
                 */
                return !cachedLayer.isTable;
            }
            else if (this.type === _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.SceneLayer) {
                /**
                 * Scene layer can not be table.
                 */
                return true;
            }
            else {
                return !!(ds === null || ds === void 0 ? void 0 : ds.getGeometryType());
            }
        }
        getLayerConstructorOptions() {
            var _a, _b;
            const options = {};
            if (this.url) {
                options.url = this.url;
            }
            if (this.itemId && this.portalUrl) {
                options.portalItem = {
                    id: this.itemId,
                    portal: {
                        url: this.portalUrl
                    }
                };
            }
            /**
             * If has a JS API layer, use it to avoid duplicate requests.
             * Can not use `layer.clone` directly here since some layer has clone method but will throw an error, such as csv layer which references a csv file via portal item.
             */
            const cachedLayer = this.layer || this._cachedLayer;
            if (cachedLayer === null || cachedLayer === void 0 ? void 0 : cachedLayer.sourceJSON) {
                options.sourceJSON = cachedLayer.sourceJSON;
            }
            if ((_a = cachedLayer === null || cachedLayer === void 0 ? void 0 : cachedLayer.source) === null || _a === void 0 ? void 0 : _a.clone) {
                options.source = cachedLayer.source.clone();
            }
            if ((_b = cachedLayer === null || cachedLayer === void 0 ? void 0 : cachedLayer.portalItem) === null || _b === void 0 ? void 0 : _b.clone) {
                options.portalItem = cachedLayer.portalItem.clone();
            }
            return options;
        }
    }
    return JSAPILayerMixinImpl;
};
const NonArcGISLayerClass = {
    [_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.CSV]: 'esri/layers/CSVLayer',
    [_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.GeoJSON]: 'esri/layers/GeoJSONLayer',
    [_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.KML]: 'esri/layers/KMLLayer',
    [_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.WFS]: 'esri/layers/WFSLayer',
    [_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.WMS]: 'esri/layers/WMSLayer',
    [_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.WMTS]: 'esri/layers/WMTSLayer',
    /**
     * Vector tile service is ArcGIS service, but user can add this type of data by a style json.
     * See https://developers.arcgis.com/javascript/latest/api-reference/esri-layers-VectorTileLayer.html - Creating a VectorTileLayer.
     */
    [_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.VectorTileService]: 'esri/layers/VectorTileLayer'
};


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/building-component-sublayer-data-source-impl.ts":
/*!****************************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/building-component-sublayer-data-source-impl.ts ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BuildingComponentSubLayerDataSourceImpl: () => (/* binding */ BuildingComponentSubLayerDataSourceImpl)
/* harmony export */ });
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! .. */ "./jimu-core/lib/data-sources/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jimu-core */ "jimu-core");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class BuildingComponentSubLayerDataSourceImpl extends ___WEBPACK_IMPORTED_MODULE_0__.SceneLayerDataSourceImpl {
    constructor() {
        super(...arguments);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.BuildingComponentSubLayer;
    }
    createAssociatedDataSource() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getAssociatedDataSource()) {
                return Promise.resolve(this.getAssociatedDataSource());
            }
            if (this.layer) {
                return this._createAssociatedDataSourceWithLayer().then(associatedDataSource => {
                    if (!associatedDataSource) {
                        return this._createAssociatedDataSourceWithUrl();
                    }
                    return associatedDataSource;
                });
            }
            else {
                const layerDef = yield this.fetchLayerDefinition();
                // We might create this ds from a view, so we need to compute the feature service url here
                const associatedFeatureLayerUrl = `${this.getAssociatedFeatureServerUrl()}/${layerDef.associatedLayerID}`;
                const dsId = this._getNewAssociatedDataSourceId();
                let dsJson = ___WEBPACK_IMPORTED_MODULE_0__.dataSourceJsonCreator.createDataSourceJsonByLayerDefinition(dsId, layerDef, associatedFeatureLayerUrl);
                // The building-component's associated feature layer's ID url is different from the others, set it manually
                dsJson = dsJson.set('url', associatedFeatureLayerUrl);
                dsJson = this._mergeAssociatedDataSourceJson(dsJson).setIn(['type'], _interfaces__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.FeatureLayer);
                const options = {
                    id: dsJson.id,
                    dataSourceJson: dsJson,
                    associatedDataSource: this
                };
                const featureDs = yield this.dataSourceManager.createDataSource(options);
                this.associatedDataSource = featureDs;
            }
        });
    }
    getAssociatedFeatureServerUrl() {
        const sceneServiceUrlArray = jimu_core__WEBPACK_IMPORTED_MODULE_2__.dataSourceUtils.getFullArcGISServiceUrl(this.url, false).split('/');
        sceneServiceUrlArray[sceneServiceUrlArray.length - 1] = 'FeatureServer';
        const featureServiceUrl = sceneServiceUrlArray.join('/');
        return featureServiceUrl;
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/building-group-sublayer-data-source-impl.ts":
/*!************************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/building-group-sublayer-data-source-impl.ts ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BuildingGroupSubLayerDataSourceImpl: () => (/* binding */ BuildingGroupSubLayerDataSourceImpl)
/* harmony export */ });
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! .. */ "./jimu-core/lib/data-sources/index.ts");
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jimu-core */ "jimu-core");




class BuildingGroupSubLayerDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_0__.AbstractLayerFolderDataSource {
    constructor() {
        super(...arguments);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.BuildingGroupSubLayer;
    }
    fetchServiceDefinition() {
        if (!this.serviceDefinition) {
            // Building-group layer does not have a corresponding service, use it's layerDefinition as serviceDefinition
            // Otherwise the label can not be displayed
            this.serviceDefinition = this.layerDefinition;
        }
        return Promise.resolve(this.layerDefinition || {});
    }
    createChildDataSourceOptionsById(childDsId, jimuChildId, childId) {
        const subLayerUrl = !this.layer ? this.getSubLayerUrlByChildId(childId) : '';
        const serviceInfo = {
            url: subLayerUrl,
            layerDefinition: !this.layer ? this.getSubLayerDefinitionByChildId(childId) : null
        };
        const subLayer = this.getSubLayerByChildId(childId);
        // Override the url since the naming format is different
        const dsJson = ___WEBPACK_IMPORTED_MODULE_2__.dataSourceJsonCreator.createDataSourceJson(childDsId, subLayer, { portalUrl: '' }, serviceInfo)
            .set('url', subLayerUrl);
        const dsJsonInRootDs = jimu_core__WEBPACK_IMPORTED_MODULE_3__.dataSourceUtils.getChildDsJsonFromRootDs(this, jimuChildId);
        const mergedDsJson = dsJson.merge(dsJsonInRootDs, { deep: true });
        const option = {
            id: childDsId,
            dataSourceJson: mergedDsJson,
            jimuChildId: jimuChildId,
            parentDataSource: this,
            serviceUrl: this.serviceUrl
        };
        if (this.layer) {
            option.layer = subLayer;
        }
        else if (this.serviceDefinition) {
            option.layerDefinition = this.getSubLayerDefinitionByChildId(childId);
        }
        return option;
    }
    getChildIds() {
        if (this.layer) {
            const subLayers = this.layer.sublayers;
            return subLayers.toArray().map(layer => {
                const id = this.getChildIdByLayer(layer);
                return id;
            });
        }
        else if (this.layerDefinition) {
            const childIds = this.layerDefinition.sublayers.map(def => def.id);
            return childIds;
        }
        return [];
    }
    getSubLayerByChildId(childId) {
        if (!this.layer) {
            return null;
        }
        const subLayers = this.layer.sublayers.toArray();
        for (const subLayer of subLayers) {
            const id = this.getChildIdByLayer(subLayer);
            if (id === childId) {
                return subLayer;
            }
        }
        return null;
    }
    getSubLayerDefinitionByChildId(childId) {
        if (!this.layerDefinition) {
            return null;
        }
        for (const subLayerDef of this.layerDefinition.sublayers) {
            if (subLayerDef.id.toString() === childId.toString()) {
                if (subLayerDef.layerType === 'group') {
                    subLayerDef.layerType = _interfaces__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.BuildingGroupSubLayer;
                }
                else if (subLayerDef.layerType === '3DObject') {
                    subLayerDef.layerType = _interfaces__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.BuildingComponentSubLayer;
                }
                return subLayerDef;
            }
        }
        return null;
    }
    getSubLayerUrlByChildId(childId) {
        const subLayerDef = this.getSubLayerDefinitionByChildId(childId);
        return subLayerDef.layerType === _interfaces__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.BuildingGroupSubLayer ? null : `${this.serviceUrl}/sublayers/${childId}`;
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/building-scene-layer-data-source-impl.ts":
/*!*********************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/building-scene-layer-data-source-impl.ts ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BuildingSceneLayerDataSourceImpl: () => (/* binding */ BuildingSceneLayerDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! .. */ "./jimu-core/lib/data-sources/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");




class BuildingSceneLayerDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_2__.AbstractLayerFolderDataSource {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_3__.DataSourceTypes.BuildingSceneLayer;
        if (options.layer) {
            const urlArray = options.layer.url.split('/');
            if (urlArray[urlArray.length - 1] === 'SceneServer') {
                // Compute the actual url for the building-scene layer
                this.url = `${options.layer.url}/layers/${options.layer.layerId}`;
            }
        }
    }
    createChildDataSourceOptionsById(childDsId, jimuChildId, childId) {
        const subLayerUrl = !this.layer ? this.getSubLayerUrlByChildId(childId) : '';
        const serviceInfo = {
            url: subLayerUrl,
            layerDefinition: !this.layer ? this.getSubLayerDefinitionByChildId(childId) : null
        };
        const subLayer = this.getSubLayerByChildId(childId);
        // Override the url since the naming format is different
        const dsJson = ___WEBPACK_IMPORTED_MODULE_1__.dataSourceJsonCreator.createDataSourceJson(childDsId, subLayer, { portalUrl: '' }, serviceInfo)
            .set('url', subLayerUrl);
        const dsJsonInRootDs = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getChildDsJsonFromRootDs(this, jimuChildId);
        const mergedDsJson = dsJson.merge(dsJsonInRootDs, { deep: true });
        const option = {
            id: childDsId,
            dataSourceJson: mergedDsJson,
            jimuChildId: jimuChildId,
            parentDataSource: this,
            serviceUrl: this.url
        };
        if (this.layer) {
            option.layer = subLayer;
        }
        else if (this.serviceDefinition) {
            option.layerDefinition = this.getSubLayerDefinitionByChildId(childId);
        }
        return option;
    }
    getChildIds() {
        if (this.layer) {
            const subLayers = this.layer.sublayers;
            return subLayers.toArray().map(layer => {
                const id = this.getChildIdByLayer(layer);
                return id;
            });
        }
        else if (this.serviceDefinition) {
            const subLayerDefinitions = this.serviceDefinition.sublayers;
            const ret = subLayerDefinitions.map(subLayerDef => {
                return subLayerDef.id;
            });
            return ret;
        }
        return [];
    }
    getSubLayerByChildId(childId) {
        if (!this.layer) {
            return null;
        }
        const subLayers = (this.layer).sublayers.toArray();
        for (const subLayer of subLayers) {
            const id = this.getChildIdByLayer(subLayer);
            if (id === childId) {
                return subLayer;
            }
        }
        return null;
    }
    getSubLayerDefinitionByChildId(childId) {
        // Only get subLayerDefinition from this method, because the layerType is not unique, we need to override it
        if (!this.serviceDefinition) {
            return null;
        }
        const subLayerDefinitions = this.serviceDefinition.sublayers;
        for (const subLayerDef of subLayerDefinitions) {
            if (subLayerDef.id === childId) {
                // The layerType may have been overwritten already
                if (subLayerDef.layerType === 'group') {
                    subLayerDef.layerType = _interfaces__WEBPACK_IMPORTED_MODULE_3__.SupportedJSAPILayerTypes.BuildingGroupSubLayer;
                }
                else if (subLayerDef.layerType === '3DObject') {
                    subLayerDef.layerType = _interfaces__WEBPACK_IMPORTED_MODULE_3__.SupportedJSAPILayerTypes.BuildingComponentSubLayer;
                }
                return subLayerDef;
            }
        }
        return null;
    }
    getSubLayerUrlByChildId(childId) {
        // subLayerDefinition is still available with a web-scene
        const subLayerDef = this.getSubLayerDefinitionByChildId(childId);
        const serviceUrl = this.url;
        return subLayerDef.layerType === _interfaces__WEBPACK_IMPORTED_MODULE_3__.SupportedJSAPILayerTypes.BuildingGroupSubLayer ? null : `${serviceUrl}/sublayers/${childId}`;
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/csv-data-source-impl.ts":
/*!****************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/csv-data-source-impl.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CSVDataSourceImpl: () => (/* binding */ CSVDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class CSVDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_2__.AbstractLoadableDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.CSV;
        const dsJson = this.getDataSourceJson();
        if (dsJson.data) {
            this.records = dsJson.data.asMutable().map(d => new _base_classes__WEBPACK_IMPORTED_MODULE_2__.SimpleDataRecordImpl(d, this));
            this.setStatus(_interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceStatus.Loaded);
        }
        else {
            this.url = dsJson.url;
        }
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
        if (this.url) {
            /**
             * Cache request since -
             * 1. we need to cache the request since the records are saved here, which means, the response size may be large.
             * 2. we don't know the URL schema of this type of data source, can not cache them by default.
             */
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.registerCacheableUrl(this.url);
        }
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
    doLoad() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield fetch(this.url).then((res) => __awaiter(this, void 0, void 0, function* () { return yield res.json(); })).then((data) => {
                return data.map(d => new _base_classes__WEBPACK_IMPORTED_MODULE_2__.SimpleDataRecordImpl(d, this));
            });
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/error-data-source-impl.ts":
/*!******************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/error-data-source-impl.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ErrorDataSourceImpl: () => (/* binding */ ErrorDataSourceImpl)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");


class ErrorDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource {
    constructor() {
        super(...arguments);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.Error;
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/feature-layer-data-source-impl.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/feature-layer-data-source-impl.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureLayerDataSourceImpl: () => (/* binding */ FeatureLayerDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./feature-record-impl */ "./jimu-core/lib/data-sources/implementations/feature-record-impl.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _support_feature_layer_capabilities_impl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../support/feature-layer-capabilities-impl */ "./jimu-core/lib/data-sources/support/feature-layer-capabilities-impl.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class FeatureLayerDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_2__.AbstractQueriableDataSource)) {
    constructor(options) {
        var _a;
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_3__.DataSourceTypes.FeatureLayer;
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
        this.layerId = dsJson.layerId;
        if (options.layer) {
            this.layer = options.layer;
        }
        else if (options.belongToDataSource && options.belongToDataSource.layer) {
            this.layer = options.belongToDataSource.layer;
        }
        if (this.getDataSourceJson().isDataInDataSourceInstance) {
            // Reset other sources info.
            this.url = null;
            this.itemId = null;
            this.portalUrl = null;
            this.setCapabilities(new _support_feature_layer_capabilities_impl__WEBPACK_IMPORTED_MODULE_4__.FeatureLayerCapabilitiesImpl({ layerDefinition: null, isClientSide: true }));
        }
        if ((_a = this.layer) === null || _a === void 0 ? void 0 : _a.portalItem) {
            this.setItemInfo(this.layer.portalItem.sourceJSON);
        }
        // Associated feature layer should use the same case-sensitive with its scene layer.
        if (this.getAssociatedDataSource()) {
            this.isSqlCaseSensitive = this.getAssociatedDataSource().isSqlCaseSensitive;
        }
    }
    ready() {
        return super.ready().then(() => {
            return this.replaceSubLayerWithFeatureLayer();
        });
    }
    setAssociatedDataSource(associatedDataSource) {
        this.associatedDataSource = associatedDataSource;
    }
    getAssociatedDataSource() {
        return this.associatedDataSource;
    }
    getIdField() {
        return this.getSchema().idField;
    }
    getGeometryType() {
        const layerDef = this.getLayerDefinition();
        if ((layerDef === null || layerDef === void 0 ? void 0 : layerDef.type) === _interfaces__WEBPACK_IMPORTED_MODULE_3__.SupportedLayerServiceTypes.Table) {
            return null;
        }
        else {
            return this.getDataSourceJson().geometryType || (layerDef === null || layerDef === void 0 ? void 0 : layerDef.geometryType);
        }
    }
    doQuery(realQuery, originQuery) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            this._printUseAllFieldsWarning(realQuery.outFields);
            if (!this.getCapabilities()) {
                return Promise.reject('Unable to perform query. Waiting for layer capabilities.');
            }
            if (!realQuery || !originQuery) {
                return Promise.reject('Unable to perform query. Query parameter is null.');
            }
            let result = null;
            let errorMsg = '';
            const cap = this.getCapabilities().getQueryCapabilities();
            /**
             * `originQuery` doesn't merge other queries in the current data source, to get full origin query, need to merge real query.
             */
            const originQueryWithOtherQueriesInDs = realQuery.merge(originQuery);
            if (realQuery.outStatistics) {
                const matchStatistics = realQuery.outStatistics.some(stat => stat.statisticType.includes('percentile')) ? cap.supportsStatistics && cap.supportsPercentileStatistics : cap.supportsStatistics;
                if (matchStatistics) {
                    let fixedQuery = realQuery;
                    /**
                     * The result may contain more than one records.
                     */
                    if (((_a = realQuery.groupByFieldsForStatistics) === null || _a === void 0 ? void 0 : _a.length) > 0) {
                        /**
                         * Remove pagination if service doesn't support pagination on statistics query with group by.
                         */
                        if (!cap.supportsPaginationOnStatisticsWithGroupBy) {
                            fixedQuery = fixedQuery.without('page').without('pageSize');
                        }
                        /**
                         * Remove order by if the order by fields don't match service capabilities.
                         */
                        if (((_b = fixedQuery.orderByFields) === null || _b === void 0 ? void 0 : _b.length) > 0) {
                            let matchStatOrderBy = false;
                            if (cap.supportsOrderBy) {
                                if (cap.supportsOrderByOnlyOnLayerFields) { // only support order by fields to be layer fields, can not use out statistic name as order by fields
                                    const useOutStatNameAsOrderBy = fixedQuery.orderByFields.some(oField => realQuery.outStatistics.map(stat => stat.outStatisticFieldName).some(outStatName => oField.split(' ').includes(outStatName)));
                                    matchStatOrderBy = !useOutStatNameAsOrderBy;
                                }
                                else {
                                    matchStatOrderBy = true;
                                }
                            }
                            if (!matchStatOrderBy) {
                                fixedQuery = fixedQuery.without('orderByFields');
                            }
                        }
                    }
                    else {
                        /**
                         * The result only contains one record.
                         */
                        fixedQuery = realQuery.without('page').without('pageSize').without('orderByFields');
                    }
                    result = yield this.doQueryByCapabilities(fixedQuery);
                    result = this.enhanceStatisticQueryResult(result, fixedQuery, originQueryWithOtherQueriesInDs);
                }
                else {
                    errorMsg = 'Do not support statistic query.';
                }
            }
            else {
                const matchOrderBy = ((_c = realQuery.orderByFields) === null || _c === void 0 ? void 0 : _c.length) > 0 ? cap.supportsOrderBy : true;
                const matchDistinct = realQuery.returnDistinctValues ? cap.supportsDistinct && !!realQuery.outFields : true;
                if (matchOrderBy && matchDistinct) {
                    const matchPagination = cap.supportsPagination;
                    const matchPaginationWithDistinct = realQuery.returnDistinctValues ? cap.supportsPaginationOnDistinct : true;
                    if (matchPagination && matchPaginationWithDistinct) {
                        result = yield this.doQueryByCapabilities(realQuery);
                    }
                    else {
                        if (realQuery.returnDistinctValues) {
                            result = yield this.doQueryByCapabilities(realQuery.without('page').without('pageSize'));
                            /**
                             * For distinct query which service does not support pagination, we can only query one page.
                             * To find other records, please use the `where` query parameter to narrow the results.
                             */
                            result.queryParams = realQuery.set('page', 1);
                        }
                        else {
                            result = yield this.doQueryWithoutPagination(realQuery);
                        }
                    }
                }
                else {
                    if (!matchOrderBy) {
                        errorMsg = 'Do not support orderBy.';
                    }
                    else if (!matchDistinct) {
                        if (!cap.supportsDistinct) {
                            errorMsg = 'Do not support distinct.';
                        }
                        else if (!realQuery.outFields) {
                            errorMsg = 'outFields should be specified for returnDistinctValues.';
                        }
                    }
                }
            }
            if (result) {
                return result;
            }
            else {
                return Promise.reject(`Unable to perform query. Please check your parameters. ${errorMsg}`);
            }
        });
    }
    applyUsedFields(query, usedFields) {
        var _a;
        /**
         * If no used fields or is statistic query, do not change query.
         */
        if (!usedFields || (query === null || query === void 0 ? void 0 : query.outStatistics)) {
            return query;
        }
        const q = Object.assign({}, query);
        /**
         * 1. Load used fields.
         */
        if (!q.returnDistinctValues && usedFields) {
            q.outFields = typeof usedFields === 'string' ? [usedFields] : usedFields;
        }
        /**
         * 2. Load id field.
         * Add id field automatically when loading missing fields. Missing fields may only the diff between loaded fields and used fields.
         */
        if (!q.returnDistinctValues && q.outFields && !q.outFields.includes('*')) {
            const jimuIdField = this.getIdField();
            if (jimuIdField && !q.outFields.includes(jimuIdField)) {
                q.outFields = q.outFields.concat(jimuIdField);
            }
        }
        /**
         * 3. Load type id field.
         * Add type id field automatically when loading missing fields. Missing fields may only the diff between loaded fields and used fields.
         * Please note, doesn't check returnDistinctValues here because SQL expression builder needs type id field but won't set it to outFields when query unique value.
         */
        if (q.outFields && !q.outFields.includes('*')) {
            const originTypeIdField = (_a = this.getLayerDefinition()) === null || _a === void 0 ? void 0 : _a.typeIdField;
            const jimuTypeIdField = this.findJimuFieldName(originTypeIdField);
            if (jimuTypeIdField && !q.outFields.includes(jimuTypeIdField)) {
                q.outFields = q.outFields.concat(jimuTypeIdField);
            }
        }
        return q;
    }
    getAllUsedFields(options) {
        var _a, _b;
        if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
            console.group('All used fields');
        }
        const query = options === null || options === void 0 ? void 0 : options.queryParams;
        let usedFields = ((_a = query === null || query === void 0 ? void 0 : query.outFields) === null || _a === void 0 ? void 0 : _a.includes('*')) ? '*' : ((query === null || query === void 0 ? void 0 : query.outFields) || []);
        /**
         * If do not query unique values, will merge used fields in query params and used fields in widget json.
         * If query unique values, will use used fields in query parmas directly.
         */
        if (!(query === null || query === void 0 ? void 0 : query.returnDistinctValues)) {
            const usedFieldsInQueryParams = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUsedFieldsFromFeatureLayerQueryParams(query, this, 'feature');
            if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
                console.log('Query params used fields are:', usedFieldsInQueryParams);
            }
            if (usedFieldsInQueryParams.includes('*')) {
                usedFields = '*';
            }
            else {
                const usedFieldsInConfigAndOnDemand = super.getAllUsedFields(options);
                usedFields = usedFieldsInConfigAndOnDemand === '*' ? '*' : Array.from(new Set([...usedFieldsInConfigAndOnDemand, ...usedFieldsInQueryParams]));
            }
            /**
             * Add id field.
             */
            const jimuIdField = this.getIdField();
            if (jimuIdField && usedFields !== '*' && !usedFields.includes(jimuIdField)) {
                usedFields.push(jimuIdField);
            }
        }
        /**
         * Add type id field.
         * Load type id field even if returnDistinctValues is true, it is by design.
         * Still need to get type id field values to get domain fields resolved even if widgets want to get unique values.
         */
        const originTypeIdField = (_b = this.getLayerDefinition()) === null || _b === void 0 ? void 0 : _b.typeIdField;
        const jimuTypeIdField = this.findJimuFieldName(originTypeIdField);
        if (jimuTypeIdField && usedFields !== '*' && !usedFields.includes(jimuTypeIdField)) {
            usedFields.push(jimuTypeIdField);
        }
        /**
         * If used fields are not * but include all fields in schema, change it to *.
         */
        if (usedFields !== '*' && usedFields.length === Object.keys(this.getSchema().fields).length) {
            if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
                console.warn('All used fields are * since used fields length equals schema fields length.');
            }
            usedFields = '*';
        }
        if ((options === null || options === void 0 ? void 0 : options.logLevel) === 'debug') {
            console.log('All used fields are:', usedFields);
            console.groupEnd();
        }
        return usedFields;
    }
    doQueryWithoutPagination(query) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            // Get object ids which match the query params.
            const queryByCapabilities = query.without('page').without('pageSize').set('returnIdsOnly', true);
            const objectIdsQueryResult = yield this.doQueryByCapabilities(queryByCapabilities);
            const matchedObjectIds = ((_b = (_a = objectIdsQueryResult.records) === null || _a === void 0 ? void 0 : _a.map(r => +r.getId())) === null || _b === void 0 ? void 0 : _b.filter(id => !isNaN(id))) || [];
            // Get object ids which match the page and the pageSize.
            const page = typeof query.page === 'number' ? query.page : 1;
            const pageSize = typeof query.pageSize === 'number' ? query.pageSize : this.getQueryPageSize();
            const objectIds = this.sliceByPage(matchedObjectIds, pageSize, page);
            if (objectIds.length === 0) {
                return { queryParams: query, records: [], count: 0 };
            }
            // Query records by object ids.
            const result = yield this.doQueryByCapabilities((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({ objectIds, outFields: ((_c = query.outFields) === null || _c === void 0 ? void 0 : _c.asMutable()) || ['*'], returnGeometry: query.returnGeometry }));
            result.queryParams = query;
            return result;
        });
    }
    /**
     * `queryByCapabilities` should match capabilities of the source (AGOL/portal item or a remote database) of the current data source.
     */
    doQueryByCapabilities(queryByCapabilities) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            let result = { queryParams: queryByCapabilities, records: [], sourceVersion: this.getSourceVersion() };
            /**
             * The reason of use layer.query when has layer is:
             * 1 some layer does not have url:
             *   1.1 feature collection item, records are saved in item.
             *   1.2 source records passed to current data source directly.
             * 2 features returned from layer.query() have symbol object
             */
            /**
             * If has source records, use these records to create a JS API feature layer to do query.
             */
            if (this.getDataSourceJson().isDataInDataSourceInstance) {
                if (this.getSourceRecords().length > 0) {
                    const sourceRecords = this.getSourceRecords();
                    /**
                     * If query params is empty, no need to load JS API to create layer.
                     */
                    if (this.isQueryParamsEmpty(queryByCapabilities)) {
                        result = { queryParams: queryByCapabilities, records: sourceRecords, sourceVersion: this.getSourceVersion() };
                    }
                    else {
                        result = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.createFeatureLayerByRecords(this, sourceRecords, this.getSourceVersion()).then(({ layer, sourceVersion }) => __awaiter(this, void 0, void 0, function* () {
                            const r = yield this.doQueryByLayerCapabilities(queryByCapabilities, layer);
                            return Object.assign(Object.assign({}, r), { sourceVersion });
                        }));
                    }
                }
            }
            else if (this.layer) { // If has a JS API feature layer, use the layer to do query.
                result = yield this.doQueryByLayerCapabilities(queryByCapabilities, this.layer);
            }
            else if (this.url) { // If has url, use the url (via REST API directly) to do query.
                const format = ((_c = (_b = (_a = this.getCapabilities().getQueryCapabilities().supportedQueryFormats) === null || _a === void 0 ? void 0 : _a.toLowerCase) === null || _b === void 0 ? void 0 : _b.call(_a)) === null || _c === void 0 ? void 0 : _c.includes('pbf')) ? 'pbf' : 'json';
                /**
                 * If should use pbf format -
                 *  1. if do not have layer for rest query, use url to do query, at the same time, create a layer for rest query.
                 *  2. if have layer for rest query, use the layer to do query.
                 */
                if (format === 'pbf' && this.layerForRestQuery) {
                    result = yield this.doQueryByLayerCapabilities(queryByCapabilities, this.layerForRestQuery);
                }
                else {
                    result = yield this.doQueryByUrlCapabilities(queryByCapabilities, this.url);
                }
                if (format === 'pbf' && !this.layerForRestQuery) {
                    this.createLayerForRestQuery();
                }
            }
            else { // Use item id to create a JS API feature layer to do query.
                result = yield this.createLayerByItemId().then(layer => this.doQueryByLayerCapabilities(queryByCapabilities, layer));
            }
            return result;
        });
    }
    createLayerForRestQuery() {
        /**
         * All data views and local data soruces share the same layer to do rest query.
         */
        if (this.isDataView || this.isLocal) {
            this.getMainDataSource().createLayerForRestQuery();
            return;
        }
        if (!this.layerForRestQueryPromise) {
            this.layerForRestQueryPromise = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.createJSAPILayerByDataSource(this, false);
        }
        this.layerForRestQueryPromise.then((layer) => {
            this.layerForRestQuery = layer;
            this.getAllDerivedDataSources().forEach((ds) => {
                ds.layerForRestQuery = layer;
            });
        });
    }
    isQueryParamsEmpty(queryParams) {
        if (!queryParams) {
            return true;
        }
        // We should always return geometry since spatial query needs it.
        const q = queryParams.without('page').without('pageSize').without('returnGeometry').without('returnZ').without('sqlExpression').without('outFields');
        const isEmpty = Object.keys(q).length === 0;
        if (isEmpty) {
            return true;
        }
        // remove ' ', '(' and ')'
        const trimWhere = typeof q.where === 'string' ? q.where.replace(/\s+/g, '').replace(/\(/g, '').replace(/\)/g, '') : null;
        const emptyWheres = ['', '1=1'];
        const isOnlyEmptyWhere = Object.keys(q).length === 1 && emptyWheres.some(w => w === trimWhere);
        return isOnlyEmptyWhere;
    }
    /**
     * Some statistic query params are not supported according to the feature service capability. See https://developers.arcgis.com/rest/services-reference/query-feature-service-layer-.htm.
     * We will remove these query params before sending query request. See `doQuery` method.
     * However, we can enhance the result after the query request is back.
     *
     * For example, if `supportsOrderByOnlyOnLayerFields` is true, only fields from the layer's fields array can be used with the `orderByFields` parameter,
     * the `outStatisticfieldName` from outStatistics can't be used. In the case, data source can help to sort the records and return an expected result.
     */
    enhanceStatisticQueryResult(queryResult, realQuery, originQueryWithOtherQueriesInDs) {
        var _a, _b;
        let fixedRecords = (_a = queryResult.records) === null || _a === void 0 ? void 0 : _a.slice();
        if (!fixedRecords) {
            return queryResult;
        }
        let fixedQueryParams = queryResult.queryParams;
        if (originQueryWithOtherQueriesInDs === null || originQueryWithOtherQueriesInDs === void 0 ? void 0 : originQueryWithOtherQueriesInDs.outStatistics) {
            if (originQueryWithOtherQueriesInDs.orderByFields && !(realQuery === null || realQuery === void 0 ? void 0 : realQuery.orderByFields)) {
                fixedRecords = fixedRecords.length > 1 ? this.sortRecordsByFields(fixedRecords, originQueryWithOtherQueriesInDs.orderByFields) : fixedRecords;
                fixedQueryParams = fixedQueryParams.set('orderByFields', originQueryWithOtherQueriesInDs.orderByFields);
            }
            if (typeof originQueryWithOtherQueriesInDs.pageSize === 'number' && typeof (realQuery === null || realQuery === void 0 ? void 0 : realQuery.pageSize) !== 'number') {
                const page = (_b = originQueryWithOtherQueriesInDs.page) !== null && _b !== void 0 ? _b : 1;
                fixedRecords = this.sliceByPage(fixedRecords, originQueryWithOtherQueriesInDs.pageSize, page);
                fixedQueryParams = fixedQueryParams.set('pageSize', originQueryWithOtherQueriesInDs.pageSize);
                fixedQueryParams = fixedQueryParams.set('page', originQueryWithOtherQueriesInDs.page);
            }
            const matchStatName = originQueryWithOtherQueriesInDs.outStatistics.every(stat => !(stat === null || stat === void 0 ? void 0 : stat.outStatisticFieldName) || fixedRecords.some(r => typeof r.getFieldValue(stat.outStatisticFieldName) !== 'undefined'));
            if (!matchStatName) {
                /**
                 * Some services use lower/upper case of the outStatisticFieldName as field name of the returned feature.
                 */
                originQueryWithOtherQueriesInDs.outStatistics.forEach(stat => {
                    if (stat === null || stat === void 0 ? void 0 : stat.outStatisticFieldName) {
                        const isOutStatNameLowerCase = fixedRecords.some(r => typeof r.getFieldValue(stat.outStatisticFieldName.toLowerCase()) !== 'undefined');
                        const isOutStatNameUpperCase = fixedRecords.some(r => typeof r.getFieldValue(stat.outStatisticFieldName.toUpperCase()) !== 'undefined');
                        fixedRecords.forEach(r => {
                            const realOutStatName = isOutStatNameLowerCase ? stat.outStatisticFieldName.toLowerCase() : (isOutStatNameUpperCase ? stat.outStatisticFieldName.toUpperCase() : null);
                            if (realOutStatName) {
                                r.feature.attributes[stat.outStatisticFieldName] = r.getFieldValue(realOutStatName);
                                delete r.feature.attributes[realOutStatName];
                            }
                        });
                    }
                });
            }
        }
        return Object.assign(Object.assign({}, queryResult), { records: fixedRecords, queryParams: fixedQueryParams });
    }
    sliceByPage(records, pageSize, page) {
        const start = pageSize * (page - 1); // include start
        const end = start + pageSize; // not include end
        return records.slice(start, end);
    }
    sortRecordsByFields(records, orderByFields) {
        const sortedRecords = records.filter(r => !!r).sort((r1, r2) => this.compareRecordsByFields(r1, r2, orderByFields));
        return sortedRecords;
    }
    compareRecordsByFields(r1, r2, orderByFields) {
        var _a, _b;
        let index = 0;
        // Default result is 0, which means don't change the order of r1 and r2.
        let res = 0;
        while (index < orderByFields.length) {
            const jimuFieldName = orderByFields[index].split(' ')[0];
            // Assume that order is ASC.
            let compareByValue = 0;
            // If orderby field doesn't follow 'f1 ASC' or 'f1', won't change position of r1 and r2.
            if (orderByFields[index].split(' ').length > 2) {
                compareByValue = 0;
            }
            else if (typeof r1.getFieldValue(jimuFieldName) !== typeof r2.getFieldValue(jimuFieldName)) {
                // If types of the two fields are not same, put record which type is not same with orderby field type before the other one.
                const jimuField = (_b = (_a = this.getSchema()) === null || _a === void 0 ? void 0 : _a.fields) === null || _b === void 0 ? void 0 : _b[jimuFieldName];
                // If schema has the orderby field, use its type, or, the orderby field is statistics query result field, type is number.
                const jimuTypeOfOrderByField = (jimuField === null || jimuField === void 0 ? void 0 : jimuField.type) || jimu_core__WEBPACK_IMPORTED_MODULE_0__.JimuFieldType.Number;
                // Date field's value is actually number, after format, will be string.
                // TODO: If have other types of jimu field type, need to handle them.
                const typeOfOrderByField = jimuTypeOfOrderByField === jimu_core__WEBPACK_IMPORTED_MODULE_0__.JimuFieldType.String ? 'string' : 'number';
                /* eslint-disable-next-line */
                const r1TypeIsSameWithOrderByField = typeof r1.getFieldValue(jimuFieldName) === typeOfOrderByField;
                /* eslint-disable-next-line */
                const r2TypeIsSameWIthOrderByField = typeof r2.getFieldValue(jimuFieldName) === typeOfOrderByField;
                if (r1TypeIsSameWithOrderByField && !r2TypeIsSameWIthOrderByField) {
                    // r2 should be before r1
                    compareByValue = 1;
                }
                else if (!r1TypeIsSameWithOrderByField && r2TypeIsSameWIthOrderByField) {
                    // r1 should be before r2
                    compareByValue = -1;
                }
                else {
                    // do not change position of r1 and r2
                    compareByValue = 0;
                }
            }
            else { // Types of the two fields are the same.
                const valueOfR1 = r1.getFieldValue(jimuFieldName);
                const valueOfR2 = r2.getFieldValue(jimuFieldName);
                compareByValue = this.getCompareValueResult(valueOfR1, valueOfR2);
            }
            // Default order is ascending.
            const order = orderByFields[index].split(' ')[1];
            if (order === 'DESC') {
                res = -compareByValue;
            }
            else { // Default order is 'ASC'
                res = compareByValue;
            }
            // If can not sort r1 and r2 according to the current field, will try to sort the two records by the next field.
            if (res === 0) {
                index++;
                continue;
            }
            else {
                break;
            }
        }
        return res;
    }
    /** .
     * Negative number means value of r1 should be before value of r2,
     * 0 means value of r1 is equal as value of r2,
     * positive means value of r1 should be after value of r2.
     */
    getCompareValueResult(v1, v2) {
        let res = 0;
        if (typeof v1 === 'string' && typeof v2 === 'string') {
            res = v1.localeCompare ? v1.localeCompare(v2) : 0;
        }
        else if (typeof v1 === 'number' && typeof v2 === 'number') {
            res = v1 - v2;
        }
        return res;
    }
    doQueryCount(queryParams) {
        return __awaiter(this, void 0, void 0, function* () {
            /**
             * See comments in doQuery method.
             */
            if (this.getDataSourceJson().isDataInDataSourceInstance) {
                if (this.getSourceRecords().length === 0) {
                    return yield Promise.resolve({ queryParams: queryParams, count: 0, sourceVersion: this.getSourceVersion() });
                }
                const sourceRecords = this.getSourceRecords();
                /**
                 * If query params is empty, no need to load JS API to create layer.
                 */
                if (this.isQueryParamsEmpty(queryParams)) {
                    return Promise.resolve({ queryParams: queryParams, count: sourceRecords.length, sourceVersion: this.getSourceVersion() });
                }
                return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.createFeatureLayerByRecords(this, sourceRecords, this.getSourceVersion()).then(({ layer, sourceVersion }) => __awaiter(this, void 0, void 0, function* () {
                    const result = yield this.doQueryCountByLayer(queryParams, layer);
                    return Object.assign(Object.assign({}, result), { sourceVersion });
                }));
            }
            else if (this.layer) {
                return yield this.doQueryCountByLayer(queryParams, this.layer);
            }
            else if (this.url) {
                return yield this.doQueryCountByUrl(queryParams, this.url);
            }
            else {
                return yield this.createLayerByItemId().then(layer => this.doQueryCountByLayer(queryParams, layer));
            }
        });
    }
    doQueryIds(queryParams) {
        return __awaiter(this, void 0, void 0, function* () {
            /**
             * See comments in doQuery method.
             */
            if (this.getDataSourceJson().isDataInDataSourceInstance) {
                if (this.getSourceRecords().length === 0) {
                    return Promise.resolve({ queryParams: queryParams, ids: [], sourceVersion: this.getSourceVersion() });
                }
                const sourceRecords = this.getSourceRecords();
                /**
                 * If query params is empty, no need to load JS API to create layer.
                 */
                if (this.isQueryParamsEmpty(queryParams)) {
                    return Promise.resolve({ queryParams: queryParams, ids: sourceRecords.map(r => r.getId()), sourceVersion: this.getSourceVersion() });
                }
                return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.createFeatureLayerByRecords(this, sourceRecords, this.getSourceVersion()).then(({ layer, sourceVersion }) => __awaiter(this, void 0, void 0, function* () {
                    const result = yield this.doQueryIdsByLayer(queryParams, layer);
                    return Object.assign(Object.assign({}, result), { sourceVersion });
                }));
            }
            else if (this.layer) {
                return this.doQueryIdsByLayer(queryParams, this.layer);
            }
            else if (this.url) {
                return this.doQueryIdsByUrl(queryParams, this.url);
            }
            else {
                return this.createLayerByItemId().then(layer => this.doQueryIdsByLayer(queryParams, layer));
            }
        });
    }
    doAddRecordToServerSideSource(record) {
        if (this.layer) {
            return this.addRecordByLayer(record, this.layer);
        }
        else if (this.url) {
            return this.addRecordByUrl(record, this.url);
        }
        else {
            return this.createLayerByItemId().then(layer => this.addRecordByLayer(record, layer));
        }
    }
    doDeleteOneRecordFromServerSideSource(record) {
        if (this.layer) {
            return this.deleteOneRecordByLayer(record, this.layer);
        }
        else if (this.url) {
            return this.deleteOneRecordByUrl(record, this.url);
        }
        else {
            return this.createLayerByItemId().then(layer => this.deleteOneRecordByLayer(record, layer));
        }
    }
    doUpdateRecordsInServerSideSource(records) {
        if (this.layer) {
            return this.updateRecordsByLayer(records, this.layer);
        }
        else if (this.url) {
            return this.updateRecordsByUrl(records, this.url);
        }
        else {
            return this.createLayerByItemId().then(layer => this.updateRecordsByLayer(records, layer));
        }
    }
    doQueryCountByLayer(queryParams, layer) {
        return __awaiter(this, void 0, void 0, function* () {
            const layerView = this.getLayerViewForClientSideQuery(layer);
            let count;
            let isClientQuerySuccess = false;
            if (layerView) {
                const clientQueryResult = yield layerView.clientQueryFeatureCount(queryParams);
                if (clientQueryResult === null || clientQueryResult === void 0 ? void 0 : clientQueryResult.success) {
                    isClientQuerySuccess = true;
                    count = clientQueryResult.data;
                }
            }
            if (!isClientQuerySuccess) {
                const query = yield this.changeJimuQueryToJSAPIQuery(queryParams);
                count = yield layer.queryFeatureCount(query);
            }
            return {
                queryParams: queryParams,
                count
            };
        });
    }
    doQueryCountByUrl(queryParams, url) {
        return __awaiter(this, void 0, void 0, function* () {
            const query = this.changeJimuQueryToRestAPIQuery(queryParams);
            delete query.resultRecordCount;
            delete query.resultOffset;
            if (!query.returnCountOnly) {
                query.returnCountOnly = true;
            }
            return yield this._q(query, url).then((queryResponse) => {
                return {
                    queryParams: queryParams,
                    count: queryResponse.count
                };
            });
        });
    }
    doQueryIdsByLayer(queryParams, layer) {
        return __awaiter(this, void 0, void 0, function* () {
            const query = yield this.changeJimuQueryToJSAPIQuery(queryParams);
            const layerView = this.getLayerViewForClientSideQuery(layer);
            let ids;
            let isClientQuerySuccess = false;
            if (layerView) {
                const clientQueryResult = yield layerView.clientQueryObjectIds(queryParams);
                if (clientQueryResult === null || clientQueryResult === void 0 ? void 0 : clientQueryResult.success) {
                    isClientQuerySuccess = true;
                    ids = clientQueryResult.data;
                }
            }
            if (!isClientQuerySuccess) {
                ids = yield layer.queryObjectIds(query);
            }
            // ids maybe null, null means zero ids
            if (!ids) {
                ids = [];
            }
            return {
                queryParams: queryParams,
                ids: ids.map(i => `${i}`)
            };
        });
    }
    doQueryIdsByUrl(queryParams, url) {
        return __awaiter(this, void 0, void 0, function* () {
            const query = this.changeJimuQueryToRestAPIQuery(queryParams);
            delete query.resultRecordCount;
            delete query.resultOffset;
            delete query.returnCountOnly;
            delete query.returnGeometry;
            if (!query.returnIdsOnly) {
                query.returnIdsOnly = true;
            }
            return this._q(query, url).then((queryResponse) => {
                var _a;
                return {
                    queryParams: queryParams,
                    ids: (_a = queryResponse.objectIds) === null || _a === void 0 ? void 0 : _a.map(i => `${i}`)
                };
            });
        });
    }
    doQueryById(id) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield this.doQueryByCapabilities((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({ objectIds: [parseInt(id)], returnGeometry: true, returnZ: true }))
                .then(result => result.records[0]);
        });
    }
    queryById(id) {
        const _super = Object.create(null, {
            queryById: { get: () => super.queryById }
        });
        return __awaiter(this, void 0, void 0, function* () {
            return yield _super.queryById.call(this, id);
        });
    }
    getConfigQueryParams() {
        var _a;
        const query = this.getDataViewConfig();
        if (!query) {
            return null;
        }
        const configQuery = {
            where: jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getArcGISSQL(query.where, this).sql,
            sqlExpression: (_a = query.where) === null || _a === void 0 ? void 0 : _a.asMutable({ deep: true }),
            orderByFields: this.getOrderByArray(query.orderBy)
        };
        return configQuery;
    }
    mergeQueryParams(...queries) {
        queries = queries || [];
        let mergedQueries = queries.filter(q => q).reduce((res, q) => (Object.assign(Object.assign({}, res), q)), {});
        /**
         * 1. merge time.
         */
        const timeArr = queries.map(q => q === null || q === void 0 ? void 0 : q.time).filter(w => typeof w === 'number' || Array.isArray(w));
        const time = timeArr.length > 1 ? timeArr.reduce((res, t) => (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.mergeTimeExtent(res, t)), null) : timeArr[0];
        /**
         * Some services do not support temporal query. Add time only when needed.
         */
        if (time === -1) {
            mergedQueries.where = '1=2';
            // The result will be empty, no need to merge other queries.
            return mergedQueries;
        }
        else if (typeof time === 'number' || Array.isArray(time)) {
            mergedQueries.time = time;
        }
        /**
         * 2. merge where.
         */
        const whereArr = queries.map(q => q === null || q === void 0 ? void 0 : q.where).filter(w => w);
        const where = whereArr.length > 1 ? whereArr.map(w => `(${w})`).join(' and ') : whereArr[0];
        mergedQueries = Object.assign(Object.assign({}, mergedQueries), { where: where ? `${where}` : '' });
        /**
         * 3. merge sqlExpression.
         */
        const sqlExpressionArr = queries.map(q => q === null || q === void 0 ? void 0 : q.sqlExpression).filter(s => s);
        const sqlExpression = sqlExpressionArr.length > 1
            ? sqlExpressionArr.reduce((res, s) => (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getMergedSQLExpressions([res, s], this)), null)
            : sqlExpressionArr[0];
        mergedQueries = Object.assign(Object.assign({}, mergedQueries), { sqlExpression });
        return mergedQueries;
    }
    getCurrentQueryParams(options) {
        const query = super.getCurrentQueryParams(options);
        return this.applyGDBVersionAndFix(query, options === null || options === void 0 ? void 0 : options.dataSourceToFormatSql);
    }
    getRealQueryParams(query, flag, options) {
        const rq = super.getRealQueryParams(query, flag, options);
        return this.applyGDBVersionAndFix(rq, options === null || options === void 0 ? void 0 : options.dataSourceToFormatSql);
    }
    getRemoteQueryParams() {
        if (this.getSchema().filter) {
            return { where: this.getSchema().filter };
        }
        return null;
    }
    applyGDBVersionAndFix(query, dataSourceToFormatSql) {
        if (this.getGDBVersion()) {
            query.gdbVersion = this.getGDBVersion();
        }
        let q = this.fixQueryParam((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(query));
        if (q.sqlExpression && dataSourceToFormatSql && dataSourceToFormatSql.isSqlCaseSensitive !== this.isSqlCaseSensitive) {
            q = q.set('where', jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getArcGISSQL(q.sqlExpression, dataSourceToFormatSql).sql);
        }
        return q.asMutable({ deep: true });
    }
    /**
     * Some query params have conflicts according to the feature layer query capability and we can not enhance it.
     * Will fix query object by removing these conflicts params.
     */
    fixQueryParam(q) {
        var _a, _b, _c;
        let fixedQuery = q;
        // TODO: other cases.
        if (q.outStatistics) {
            // orderByFields, page and pageSize may not be supported by service, but we can enhance it, see `doQuery` mothod.
            Object.keys(q).forEach(k => {
                if (!['outStatistics', 'where', 'gdbVersion', 'geometry', 'geometryType', 'spatialRel', 'distance', 'units', 'groupByFieldsForStatistics', 'time', 'orderByFields', 'havingClause', 'page', 'pageSize'].includes(k)) {
                    fixedQuery = fixedQuery.without(k);
                }
            });
        }
        if (q.returnDistinctValues && q.returnGeometry) {
            // returnDistinctValues can not work with returnGeometry.
            fixedQuery = fixedQuery.set('returnGeometry', false);
        }
        if (!q.returnDistinctValues && q.returnGeometry) {
            // Return z-values.
            fixedQuery = fixedQuery.set('returnZ', true);
        }
        if (!fixedQuery.outStatistics && !fixedQuery.returnDistinctValues && ((_a = fixedQuery.orderByFields) === null || _a === void 0 ? void 0 : _a.length) > 0) {
            const hasIdField = !!fixedQuery.orderByFields.find(f => f.split(' ')[0] === this.getIdField());
            if (!hasIdField) {
                fixedQuery = fixedQuery.set('orderByFields', fixedQuery.orderByFields.concat([`${this.getIdField()} ASC`]));
            }
        }
        if (fixedQuery.returnDistinctValues && ((_b = fixedQuery.outFields) === null || _b === void 0 ? void 0 : _b.length) && !((_c = fixedQuery.orderByFields) === null || _c === void 0 ? void 0 : _c.length)) {
            /**
             * When query distinct, we need to use one of the out fields to sort the query result.
             * It is a limitation of server. If we don't do it, server will use the id field to do sort and the id field is generally not in the out fields, which will result in an error.
             */
            fixedQuery = fixedQuery.set('orderByFields', [fixedQuery.outFields[0]]);
        }
        if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.areDatesInUnknownTimezone(this)) {
            fixedQuery = fixedQuery.set('timeReferenceUnknownClient', true);
        }
        return fixedQuery;
    }
    addRecordByLayer(record, layer) {
        return __awaiter(this, void 0, void 0, function* () {
            const feature = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.changeToJSAPIGraphic(record.feature);
            const f = feature.clone();
            return layer.applyEdits({
                addFeatures: [f]
            }).then(response => {
                var _a, _b;
                const objectId = (_a = response.addFeatureResults[0]) === null || _a === void 0 ? void 0 : _a.objectId;
                if (typeof objectId !== 'number' || ((_b = response.addFeatureResults[0]) === null || _b === void 0 ? void 0 : _b.error)) {
                    return Promise.reject('Adding record failed.');
                }
                const idFeild = this.getIdField();
                f.attributes[idFeild] = objectId;
                // return a new record with a new value of id field
                return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl(f, this);
            });
        });
    }
    addRecordByUrl(record, url) {
        return __awaiter(this, void 0, void 0, function* () {
            const feature = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.changeToRestAPIFeature(record.feature);
            const f = Object.assign({}, feature);
            const options = {
                url,
                features: [f]
            };
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper(url, (session) => __awaiter(this, void 0, void 0, function* () {
                options.authentication = session;
                return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restFeatureLayer.addFeatures(options)
                    .then(response => {
                    var _a, _b;
                    const objectId = (_a = response.addResults[0]) === null || _a === void 0 ? void 0 : _a.objectId;
                    if (typeof objectId !== 'number' || !((_b = response.addResults[0]) === null || _b === void 0 ? void 0 : _b.success)) {
                        return Promise.reject('Adding record failed.');
                    }
                    const idFeild = this.getIdField();
                    f.attributes[idFeild] = objectId;
                    // return a new record with a new value of id field
                    return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl(f, this);
                });
            }), 1);
            // TODO: retry if request was unauthenticated
            // once we are sending tokens above
            // .catch(sessionManager.handleAuthError.bind(sessionManager))
        });
    }
    updateRecordsByLayer(records, layer) {
        return __awaiter(this, void 0, void 0, function* () {
            const features = yield Promise.all(records.map((r) => __awaiter(this, void 0, void 0, function* () { return (yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.changeToJSAPIGraphic(r.feature).then(g => g.clone())); })));
            return layer.applyEdits({
                updateFeatures: features
                // TODO: if only update parts of the records?
            }).then(response => response.updateFeatureResults.filter(r => !r.error).length > 0);
        });
    }
    updateRecordsByUrl(records, url) {
        return __awaiter(this, void 0, void 0, function* () {
            const features = records.map(r => (Object.assign({}, jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.changeToRestAPIFeature(r.feature))));
            const options = {
                url,
                features: features
            };
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper(url, (session) => __awaiter(this, void 0, void 0, function* () {
                options.authentication = session;
                return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restFeatureLayer.updateFeatures(options)
                    // TODO: if only update parts of the records?
                    .then(response => response.updateResults.filter(r => r.success).length > 0);
            }), 1);
        });
    }
    deleteOneRecordByLayer(record, layer) {
        return __awaiter(this, void 0, void 0, function* () {
            const feature = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.changeToJSAPIGraphic(record.feature);
            const f = feature.clone();
            return layer.applyEdits({
                deleteFeatures: [f]
            }).then(response => response.deleteFeatureResults.filter(r => !r.error).length > 0);
        });
    }
    deleteOneRecordByUrl(record, url) {
        return __awaiter(this, void 0, void 0, function* () {
            const f = Object.assign({}, jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.changeToRestAPIFeature(record.feature));
            const idField = this.getIdField();
            const objectId = f.attributes[idField];
            const options = {
                url,
                objectIds: [objectId]
            };
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper(url, (session) => __awaiter(this, void 0, void 0, function* () {
                options.authentication = session;
                return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restFeatureLayer.deleteFeatures(options)
                    .then(response => response.deleteResults.filter(r => r.success).length > 0);
            }), 1);
        });
    }
    fetchSchema() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getDataSourceJson().isStatistic) {
                return Promise.resolve((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({}));
            }
            let schema;
            if (this.layer) { // from map
                schema = yield this.fetchSchemaWithLayer();
            }
            else { // from a feature service item or feature service url or from a feature collection item
                schema = yield this.fetchSchemaWithoutLayer();
            }
            if (!(schema === null || schema === void 0 ? void 0 : schema.fields)) {
                return Promise.reject(new _interfaces__WEBPACK_IMPORTED_MODULE_3__.DataSourceError(this.id, 'No fields.'));
            }
            return schema;
        });
    }
    createLayerByItemId() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.createFeatureLayerPromise) {
                if (!this.itemId) {
                    this.createFeatureLayerPromise = Promise.reject('No item id.');
                }
                else {
                    this.createFeatureLayerPromise = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModules)(['esri/layers/Layer', 'esri/portal/PortalItem']).then((modules) => __awaiter(this, void 0, void 0, function* () {
                        const Layer = modules[0];
                        const PortalItem = modules[1];
                        return yield Layer.fromPortalItem({ portalItem: new PortalItem({ id: this.itemId, portal: { url: this.portalUrl } }) });
                    })).then((layer) => __awaiter(this, void 0, void 0, function* () {
                        if ((layer === null || layer === void 0 ? void 0 : layer.type) === _interfaces__WEBPACK_IMPORTED_MODULE_3__.SupportedJSAPILayerTypes.FeatureLayer) {
                            return yield Promise.resolve(layer);
                        }
                        else if ((layer === null || layer === void 0 ? void 0 : layer.type) === _interfaces__WEBPACK_IMPORTED_MODULE_3__.SupportedJSAPILayerTypes.GroupLayer) {
                            return yield layer.loadAll().then((layer) => __awaiter(this, void 0, void 0, function* () {
                                const feaureLayer = (layer).layers.toArray().find(
                                // feature layer created from a multiple-layer feature collection item may do not have layerId,
                                // so title to find the feature layer
                                (l) => `${l.layerId}` === this.layerId || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.fixLayerId(l.title) === jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.fixLayerId(this.getMainDataSource().getDataSourceJson().sourceLabel));
                                if ((feaureLayer === null || feaureLayer === void 0 ? void 0 : feaureLayer.type) === _interfaces__WEBPACK_IMPORTED_MODULE_3__.SupportedJSAPILayerTypes.FeatureLayer) {
                                    return Promise.resolve(feaureLayer);
                                }
                                return Promise.reject('Feaure layer data source error: failed to create feature layer with specific layer id.');
                            }));
                        }
                    }));
                }
            }
            return this.createFeatureLayerPromise;
        });
    }
    fetchSchemaWithoutLayer() {
        return __awaiter(this, void 0, void 0, function* () {
            const serviceInfoPromise = this.url ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.ServiceManager.getInstance().fetchServiceInfo(this.url) : Promise.resolve(null);
            return yield serviceInfoPromise.then((serviceInfo) => {
                if (this.itemId) {
                    return Promise.all([this.fetchItemData(), this.fetchItemInfo()]).then(([itemData, itemInfo]) => {
                        var _a;
                        const layerInfo = itemData && itemData.layers && itemData.layers[this.layerId];
                        const serviceDefinition = (serviceInfo === null || serviceInfo === void 0 ? void 0 : serviceInfo.definition) ? this.getUpdatedLayerDefinition(layerInfo, serviceInfo.definition) : layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.layerDefinition;
                        if (!this.parentDataSource && serviceDefinition) { // item id is root layer's item id, so use item title as label only when current ds doesn't have parent ds
                            // use item title as data source schema's label
                            serviceDefinition.name = (itemInfo === null || itemInfo === void 0 ? void 0 : itemInfo.title) || serviceDefinition.name;
                        }
                        return {
                            serviceDefinition,
                            fieldInfos: layerInfo && layerInfo.popupInfo && layerInfo.popupInfo.fieldInfos,
                            filter: ((_a = layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.layerDefinition) === null || _a === void 0 ? void 0 : _a.definitionExpression) ? `(${layerInfo.layerDefinition.definitionExpression})` : null,
                            refreshInterval: (layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.refreshInterval) * 60 // change to second
                        };
                    });
                }
                else {
                    return {
                        serviceDefinition: serviceInfo === null || serviceInfo === void 0 ? void 0 : serviceInfo.definition,
                        fieldInfos: null,
                        filter: null,
                        refreshInterval: null
                    };
                }
            }).then(({ serviceDefinition, fieldInfos, filter, refreshInterval }) => {
                var _a, _b, _c, _d;
                const schema = {
                    fields: {},
                    /**
                     * We should save idField in schema, instead of finding it in layer defintion.
                     * The reason is:
                     *   - output data source may use original data source's schema,
                     *   - output data source doesn't have layer definition and should find idField from its schema.
                     */
                    idField: (serviceDefinition === null || serviceDefinition === void 0 ? void 0 : serviceDefinition.idField) || ((_b = (_a = serviceDefinition === null || serviceDefinition === void 0 ? void 0 : serviceDefinition.fields) === null || _a === void 0 ? void 0 : _a.find(f => f.type === 'esriFieldTypeOID')) === null || _b === void 0 ? void 0 : _b.name) || 'OBJECTID',
                    filter,
                    refreshInterval,
                    label: ((_c = this.layer) === null || _c === void 0 ? void 0 : _c.title) || (serviceDefinition === null || serviceDefinition === void 0 ? void 0 : serviceDefinition.name)
                };
                this.setLayerDefinitionAndQueryCapabilities(serviceDefinition);
                (_d = serviceDefinition === null || serviceDefinition === void 0 ? void 0 : serviceDefinition.fields) === null || _d === void 0 ? void 0 : _d.forEach(f => {
                    const fieldInfo = fieldInfos && fieldInfos.find(fi => fi.fieldName === f.name);
                    const jimuField = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.convertFieldToJimuField(f, fieldInfo);
                    if (jimuField) {
                        schema.fields[f.name] = jimuField;
                    }
                });
                return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(schema);
            });
        });
    }
    fetchSchemaWithLayer() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.layer.load().then(() => {
                var _a, _b;
                if (!this.layer.fields) {
                    return null;
                }
                /**
                 * If not scene layer's associated feature layer data source, we do not support multipatch or mesh.
                 */
                if (!this.getAssociatedDataSource() && (this.layer.geometryType === 'multipatch' || this.layer.geometryType === 'mesh')) {
                    return null;
                }
                this.updateLayerDefinitionByLayer();
                const schema = {
                    fields: {},
                    /**
                     * We should save idField in schema, instead of finding it in layer defintion.
                     * The reason is:
                     *   - output data source may use original data source's schema,
                     *   - output data source doesn't have layer definition and should find idField from its schema.
                     */
                    idField: this.layer.objectIdField || ((_b = (_a = this.layer.fields) === null || _a === void 0 ? void 0 : _a.find(f => f.type === 'oid')) === null || _b === void 0 ? void 0 : _b.name) || 'OBJECTID',
                    filter: this.layer.definitionExpression ? `(${this.layer.definitionExpression})` : null,
                    refreshInterval: this.layer.refreshInterval * 60,
                    label: this.layer.title
                };
                this.layer.fields.forEach(field => {
                    const fieldInfo = this.layer.popupTemplate && this.layer.popupTemplate.fieldInfos && this.layer.popupTemplate.fieldInfos.find(f => f.fieldName === field.name);
                    const jimuField = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.convertFieldToJimuField(field.toJSON(), fieldInfo === null || fieldInfo === void 0 ? void 0 : fieldInfo.toJSON());
                    if (jimuField) {
                        schema.fields[field.name] = jimuField;
                    }
                });
                return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(schema);
            });
        });
    }
    updateLayerDefinitionByLayer() {
        let layerDef = this.layer.sourceJSON;
        const renderer = this.layer.renderer;
        if (renderer && renderer.toJSON()) {
            const rendererJSON = renderer.toJSON();
            if (rendererJSON.type === 'uniqueValue') {
                let types = this.layer.sourceJSON.types;
                if (rendererJSON.field1 !== this.layer.sourceJSON.typeIdField) {
                    types = [];
                    rendererJSON.uniqueValueInfos.forEach(item => {
                        types.push({ id: item.value, name: item.label, domain: {} });
                    });
                }
                layerDef = Object.assign({ name: this.layer.title }, layerDef, {
                    drawingInfo: { renderer: rendererJSON },
                    typeIdField: rendererJSON.field1,
                    types: types
                });
            }
        }
        this.setLayerDefinitionAndQueryCapabilities(layerDef);
    }
    getLayerDefinition() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLayerDefinition(this);
    }
    setLayerDefinition(layerDef) {
        this.layerDefinition = layerDef;
    }
    getPopupInfo() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getPopupInfo(this);
    }
    setPopupInfo(popupInfo) {
        this.popupInfo = popupInfo;
    }
    getItemInfo() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getItemInfo();
        }
        return super.getItemInfo();
    }
    getCharts() {
        var _a, _b;
        const mainDs = this.getMainDataSource();
        /**
         * If the layer contains charts (from layer item) but didn't open the charts in map viewer,
         * - the charts won't be saved to map item data.
         * - the JSAPI layer object contains charts (loaded by JSAPI).
         */
        if (mainDs === null || mainDs === void 0 ? void 0 : mainDs.layer) {
            return mainDs.layer.charts;
        }
        else if (mainDs === null || mainDs === void 0 ? void 0 : mainDs.getItemData()) {
            const layerInfo = (_b = (_a = mainDs.getItemData()) === null || _a === void 0 ? void 0 : _a.layers) === null || _b === void 0 ? void 0 : _b.find(l => `${l.id}` === this.layerId);
            return (layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.charts);
        }
        return [];
    }
    setLayerDefinitionAndQueryCapabilities(layerDef) {
        this.setLayerDefinition(layerDef);
        const isFeatureCollection = !this.url && !!this.itemId;
        this.setCapabilities(new _support_feature_layer_capabilities_impl__WEBPACK_IMPORTED_MODULE_4__.FeatureLayerCapabilitiesImpl({ layerDefinition: layerDef, isClientSide: this.getDataSourceJson().isDataInDataSourceInstance || isFeatureCollection }));
    }
    getCapabilities() {
        return super.getCapabilities();
    }
    buildRecord(feature) {
        return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl(feature, this);
    }
    getFieldCodedValueList(jimuFieldName, record) {
        let fieldName = '';
        const fields = this.getSchema().fields;
        Object.keys(fields).some(name => {
            if (name === jimuFieldName) {
                fieldName = fields[name].name;
                return true;
            }
            else {
                return false;
            }
        });
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getCodedValueListForCodedValueOrSubtypeField(this.getLayerDefinition(), fieldName, record);
    }
    getGDBVersion() {
        return this.getInfo().gdbVersion;
    }
    changeGDBVersion(gdbVersion) {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.changeDataSourceGDBVersion(this.id, gdbVersion));
        if (this.layer) {
            this.layer.gdbVersion = gdbVersion;
        }
    }
    // update serviceInfo from layerInfo for layer item
    getUpdatedLayerDefinition(layerInfo, serviceDefinition) {
        let updatedDefinition = serviceDefinition;
        if (layerInfo && layerInfo.layerDefinition) {
            let updatedOptions;
            const drawingInfo = layerInfo.layerDefinition.drawingInfo;
            if (drawingInfo) {
                if (drawingInfo.renderer && drawingInfo.renderer.type === 'uniqueValue') {
                    // update types(id, name) from drawingInfo(value,label)
                    let types = serviceDefinition.types;
                    if (drawingInfo.renderer.field1 !== serviceDefinition.typeIdField) {
                        types = [];
                        drawingInfo.renderer.uniqueValueInfos.forEach(item => {
                            types.push({ id: item.value, name: item.label, domain: {} });
                        });
                    }
                    updatedOptions = {
                        defaultVisibility: layerInfo.layerDefinition.defaultVisibility,
                        drawingInfo: layerInfo.layerDefinition.drawingInfo,
                        typeIdField: drawingInfo.renderer.field1,
                        types: types
                    };
                }
            }
            else if (layerInfo.layerDefinition.defaultVisibility !== serviceDefinition.defaultVisibility) {
                updatedOptions = { defaultVisibility: layerInfo.layerDefinition.defaultVisibility };
            }
            updatedDefinition = Object.assign({}, updatedDefinition, updatedOptions);
        }
        return updatedDefinition;
    }
    getOrderByArray(orderBys) {
        var _a;
        return (_a = orderBys === null || orderBys === void 0 ? void 0 : orderBys.map(orderBy => {
            return orderBy.jimuFieldName + ' ' + orderBy.order;
        }).asMutable()) !== null && _a !== void 0 ? _a : [];
    }
    /**
     * Convert IMFeatureLayerQueryParams to IQueryFeaturesOptions, to query features by service url.
     */
    changeJimuQueryToRestAPIQuery(queryParams) {
        var _a, _b;
        if (!queryParams) {
            return null;
        }
        const q = queryParams.asMutable({ deep: true });
        if (typeof q.pageSize === 'number') {
            const page = (_a = q.page) !== null && _a !== void 0 ? _a : 1;
            q.resultOffset = (page - 1) * q.pageSize;
            q.resultRecordCount = q.pageSize;
            /**
             * We don't change query page size in base class, because in general case, developers expect the page size is fixed.
             */
            if (this.getMaxRecordCount() !== null) {
                if (page === 1) { // first page
                    q.resultRecordCount = Math.min(this.getMaxRecordCount(), q.pageSize);
                }
                else if (page * q.pageSize > this.getMaxRecordCount()) { // last page
                    q.resultRecordCount = this.getMaxRecordCount() - (page - 1) * q.pageSize;
                }
            }
            delete q.page;
            delete q.pageSize;
        }
        if (Array.isArray(q.orderByFields)) {
            q.orderByFields = q.orderByFields.join(',');
        }
        if (Array.isArray(q.groupByFieldsForStatistics)) {
            q.groupByFieldsForStatistics = q.groupByFieldsForStatistics.join(',');
        }
        if (Array.isArray(q.time)) {
            q.time = q.time.join(',');
        }
        if ((_b = q.outStatistics) === null || _b === void 0 ? void 0 : _b.some(stat => { var _a; return (_a = stat.statisticParameters) === null || _a === void 0 ? void 0 : _a.orderBy; })) {
            q.outStatistics = q.outStatistics.map(stat => {
                var _a;
                if ((_a = stat.statisticParameters) === null || _a === void 0 ? void 0 : _a.orderBy) {
                    stat.statisticParameters.orderBy = stat.statisticParameters.orderBy.toUpperCase();
                }
                return stat;
            });
        }
        return q;
    }
    /**
     * Convert IMFeatureLayerQueryParams to __esri.Query | __esri.QueryProperties, to query features by layer (instance of ArcGIS Maps SDK for JavaScript FeatureLayer class).
     */
    changeJimuQueryToJSAPIQuery(queryParams) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.changeJimuFeatureLayerQueryToJSAPILayerQuery(this, queryParams);
        });
    }
    doQueryByUrlCapabilities(queryParams, url) {
        const query = this.changeJimuQueryToRestAPIQuery(queryParams);
        if (query.returnCountOnly) {
            console.error('To query count, please use queryCount.');
            return Promise.reject('To query count, please use queryCount.');
        }
        return this._q(query, url).then((queryResponse) => {
            var _a;
            const fields = Object.keys(this.getSchema().fields).filter(jimuFieldName => {
                return queryResponse.fields && queryResponse.fields.find(field => field.name === this.getSchema().fields[jimuFieldName].name);
            });
            const queryResult = {
                queryParams: queryParams,
                fields: fields,
                records: (queryResponse.features
                    ? queryResponse.features.map(feature => new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl(feature, this))
                    : (_a = queryResponse.objectIds) === null || _a === void 0 ? void 0 : _a.map(id => new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl({ attributes: { [this.getIdField()]: id } }, this))) || []
            };
            return queryResult;
        });
    }
    doQueryByLayerCapabilities(queryParams, layer) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const query = yield this.changeJimuQueryToJSAPIQuery(queryParams);
            const layerView = this.getLayerViewForClientSideQuery(layer);
            if (queryParams.returnIdsOnly) {
                delete query.returnIdsOnly;
                let objectIds;
                let isClientQuerySuccess = false;
                if (layerView) {
                    const clientQueryResult = yield layerView.clientQueryObjectIds(queryParams);
                    if (clientQueryResult === null || clientQueryResult === void 0 ? void 0 : clientQueryResult.success) {
                        isClientQuerySuccess = true;
                        objectIds = clientQueryResult.data;
                    }
                }
                if (!isClientQuerySuccess) {
                    objectIds = yield layer.queryObjectIds(query);
                }
                const records = objectIds === null || objectIds === void 0 ? void 0 : objectIds.map(id => new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl({ attributes: { [this.getIdField()]: id } }, this));
                const fields = [this.getIdField()];
                return {
                    queryParams: queryParams,
                    records,
                    fields
                };
            }
            else {
                let featureSet;
                let isClientQuerySuccess = false;
                let hasFullGeometries = true;
                if (layerView) {
                    let clientQueryParams = queryParams;
                    // Server-side query uses id field to sort records by default. To get the correct page from client-side query, use the same rule.
                    if (!((_a = clientQueryParams.orderByFields) === null || _a === void 0 ? void 0 : _a.length)) {
                        clientQueryParams = clientQueryParams.set('orderByFields', [this.getIdField()]);
                    }
                    const clientQueryResult = yield layerView.clientQueryFeatures(clientQueryParams);
                    if (clientQueryResult === null || clientQueryResult === void 0 ? void 0 : clientQueryResult.success) {
                        isClientQuerySuccess = true;
                        featureSet = clientQueryResult.data;
                        hasFullGeometries = clientQueryResult.hasFullGeometries;
                    }
                }
                if (!isClientQuerySuccess) {
                    featureSet = yield layer.queryFeatures(query);
                }
                const records = featureSet.features.map(f => new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl(f, this, { hasFullGeometries }));
                const fields = Object.keys(this.getSchema().fields).filter(jimuFieldName => {
                    return featureSet.fields && featureSet.fields.find(field => field.name === this.getSchema().fields[jimuFieldName].name);
                });
                return {
                    queryParams: queryParams,
                    records,
                    fields
                };
            }
        });
    }
    getLayerViewForClientSideQuery(useLayer) {
        var _a, _b;
        // If root data source doesn't have map or the layer use to query is not a map layer (e.g. selection view use a client-side layer to do query), there must be no corresponding layer view.
        if (!((_a = this.getRootDataSource()) === null || _a === void 0 ? void 0 : _a.map) || useLayer !== this.layer) {
            return null;
        }
        const JimuArcgis = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.getModuleSync('jimu-arcgis');
        const mapViewManager = (_b = JimuArcgis === null || JimuArcgis === void 0 ? void 0 : JimuArcgis.MapViewManager) === null || _b === void 0 ? void 0 : _b.getInstance();
        return mapViewManager === null || mapViewManager === void 0 ? void 0 : mapViewManager.getJimuLayerViewForClientQuery(this.getMainDataSource());
    }
    _q(queryParams, url) {
        return __awaiter(this, void 0, void 0, function* () {
            const queryString = Object.keys(queryParams || {}).reduce((previous, current) => {
                if (typeof queryParams[current] !== 'object') {
                    return `${previous}&${current}=${queryParams[current]}`;
                }
                else {
                    return `${previous}&${current}=${JSON.stringify(queryParams[current])}`;
                }
            }, '');
            const rawUrl = `${url}?${queryString}`;
            const rawUrlLength = rawUrl.length;
            const usePost = rawUrlLength > 1500; // default max url length of JS API is 2000
            const options = Object.assign({ url, httpMethod: usePost ? 'POST' : 'GET' }, queryParams);
            // timeReferenceUnknownClient will be removed by esri.restFeatureLayer.queryFeatures, put it into params.
            if (options.timeReferenceUnknownClient) {
                options.params = {
                    where: options.where || '1=1', // set default query parameters
                    outFields: options.outFields || '*', // set default query parameters
                    timeReferenceUnknownClient: true
                };
            }
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper(url, (session) => __awaiter(this, void 0, void 0, function* () {
                options.authentication = session;
                return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restFeatureLayer.queryFeatures(options);
            }), 1);
        });
    }
    getTimezone() {
        var _a, _b, _c;
        if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.areDatesInUnknownTimezone(this)) {
            return 'unknown';
        }
        else {
            const timezoneInAppConfig = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig.attributes) === null || _a === void 0 ? void 0 : _a.timezone;
            if (!timezoneInAppConfig || timezoneInAppConfig.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.TimezoneType.Device) { // default timezone in app config is device
                return 'device';
            }
            else if (timezoneInAppConfig.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.TimezoneType.Specific) {
                return timezoneInAppConfig.value;
            }
            else if (timezoneInAppConfig.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.TimezoneType.Data) {
                const canConfigInMapViewer = !!((_b = this.getRootDataSource()) === null || _b === void 0 ? void 0 : _b.map);
                if (canConfigInMapViewer) {
                    const rootDsTimezone = (_c = this.getRootDataSource().map.resourceInfo) === null || _c === void 0 ? void 0 : _c.timeZone;
                    if (!rootDsTimezone || rootDsTimezone === 'system') { // device, default timezone in map viewer
                        return 'device';
                    }
                    else if (rootDsTimezone === 'unknown') { // data
                        return this.getLayerTimezone();
                    }
                    else if (typeof rootDsTimezone === 'string') { // specific
                        return rootDsTimezone;
                    }
                }
                else {
                    return this.getLayerTimezone();
                }
            }
        }
        return null;
    }
    getLayerTimezone() {
        var _a, _b;
        return ((_b = (_a = this.getLayerDefinition()) === null || _a === void 0 ? void 0 : _a.dateFieldsTimeReference) === null || _b === void 0 ? void 0 : _b.timeZone) || null;
    }
    allowToExportData() {
        var _a, _b;
        /**
         * If is data view or local data source, use main data source's export setting.
         */
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().allowToExportData();
        }
        /**
         * If is output data source, use its original data source's export setting.
         */
        if (this.getDataSourceJson().isOutputFromWidget && ((_a = this.getDataSourceJson().originDataSources) === null || _a === void 0 ? void 0 : _a.length) === 1) {
            const originDsId = (_b = this.getDataSourceJson().originDataSources[0]) === null || _b === void 0 ? void 0 : _b.dataSourceId;
            const originDs = originDsId && this.dataSourceManager.getDataSource(originDsId);
            if (originDs) {
                return originDs.allowToExportData();
            }
            else {
                console.error('Origin data source is not created, allow to export data by default. Output data source id is ', this.id);
                return Promise.resolve(true);
            }
        }
        const allowInDataSource = !this.getDataSourceJson().disableExport;
        if (allowInDataSource) {
            return this.allowToExportDataInRemote();
        }
        else {
            // No need to check remote if doesn't allow to export data in data source setting.
            return Promise.resolve(false);
        }
    }
    allowToExportDataInRemote() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.allowExportRemoteCheckPromise) {
                this.allowExportRemoteCheckPromise = jimu_core__WEBPACK_IMPORTED_MODULE_0__.proxyUtils.isDataSourceSubscriberOrPremium(this.getDataSourceJson()).then(isSubscriberOrPremium => {
                    // Do not allow to export subscriber data or premium data.
                    if (isSubscriberOrPremium) {
                        return false;
                    }
                    else if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isAGOLHostedService(this.getDataSourceJson().url)) { // If service is not hosted, allow to export in remote.
                        return true;
                    }
                    else {
                        return this.allowToExportDataInItem();
                    }
                });
            }
            return this.allowExportRemoteCheckPromise;
        });
    }
    allowToExportDataInItem() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                // If current data source doesn't come from an item, allow to export data.
                if (!this.itemId) {
                    return true;
                }
                const user = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().user;
                if (!user) {
                    return this.getWhetherAllowToExportInItemSetting();
                }
                let itemInfo = this.getItemInfo();
                itemInfo = (itemInfo === null || itemInfo === void 0 ? void 0 : itemInfo.contentOrigin)
                    ? itemInfo
                    : yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl, (session) => {
                        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.getItem(this.itemId, {
                            portal: jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPortalRestUrl((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl),
                            authentication: session
                        });
                    }).catch(err => {
                        console.warn('Failed to get item info via app portal url. ', err);
                        return itemInfo;
                    });
                const isInSameOrg = (itemInfo === null || itemInfo === void 0 ? void 0 : itemInfo.contentOrigin) === 'self';
                if (isInSameOrg) {
                    const isAdminUser = user.role === 'org_admin';
                    // If user and item are in the same org and user is admin, allow to export data.
                    if (isAdminUser) {
                        return true;
                    }
                    else {
                        const isOwnedByCurrentUser = user && (itemInfo === null || itemInfo === void 0 ? void 0 : itemInfo.owner) === user.username;
                        // If the item is owned by current login user, allow to export data.
                        if (isOwnedByCurrentUser) {
                            return true;
                        }
                        else {
                            return this.getWhetherAllowToExportInItemSetting();
                        }
                    }
                }
                else {
                    return this.getWhetherAllowToExportInItemSetting();
                }
            }
            catch (error) {
                console.log(`Failed to get whether data source ${this.id} allows to export data, `, error);
                return true;
            }
        });
    }
    /**
     * Check export setting in portal/AGOL (item setting page).
     */
    getWhetherAllowToExportInItemSetting() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            if (this.url) {
                const layerDef = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.requestWrapper(this.url, (session) => __awaiter(this, void 0, void 0, function* () {
                    return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.request(this.url, { authentication: session, httpMethod: 'GET' });
                }), 1);
                return !!((_a = layerDef === null || layerDef === void 0 ? void 0 : layerDef.capabilities) === null || _a === void 0 ? void 0 : _a.includes('Extract'));
            }
            return true;
        });
    }
    supportSymbol() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.supportSymbol(this);
    }
    supportAttachment() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.supportAttachment(this);
    }
    supportTime() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.supportTime(this);
    }
    getTimeInfo() {
        var _a, _b, _c, _d;
        if (this.layer) {
            /**
             * JS API feature layer has `timeOffset` property, but it is null even if the service has time offset in layer definition.
             * So we deep merge `timeInfo` of JS API layer and `timeInfo` of layer definition here to get `timeOffset`.
             */
            if (((_a = this.getLayerDefinition()) === null || _a === void 0 ? void 0 : _a.timeInfo) && this.layer.timeInfo) {
                return jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.merge(this.getLayerDefinition().timeInfo, this.layer.timeInfo.toJSON());
            }
            else {
                return ((_b = this.layer.timeInfo) === null || _b === void 0 ? void 0 : _b.toJSON()) || ((_c = this.getLayerDefinition()) === null || _c === void 0 ? void 0 : _c.timeInfo);
            }
        }
        else {
            return (_d = this.getLayerDefinition()) === null || _d === void 0 ? void 0 : _d.timeInfo;
        }
    }
    createJSAPILayerByDataSource() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.createJSAPILayerByDataSource(this);
    }
    createRestAPILayerByDataSource() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.createRestAPILayerByDataSource(this);
    }
    updateSourceByFeatures(features, fields, objectIdField, others) {
        return __awaiter(this, void 0, void 0, function* () {
            const FeatureLayer = yield (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModule)('esri/layers/FeatureLayer');
            this._layer = new FeatureLayer(Object.assign(Object.assign({}, others), { objectIdField,
                fields, source: features }));
            // Clear loaded records.
            this.clearRecordsNotAddVersion();
            // Add source version to let widgets to update.
            this.addSourceVersion();
        });
    }
    getDataViews() {
        return super.getDataViews();
    }
    getDataView(dataViewId) {
        return super.getDataView(dataViewId);
    }
    getMainDataSource() {
        return super.getMainDataSource();
    }
    // @ts-expect-error - TS2611 error, seems to be solved in v4.8.0, https://github.com/microsoft/TypeScript/issues/41347 .
    get layer() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getJSAPILayer(this);
    }
    set layer(l) {
        this._layer = l;
    }
    get restLayer() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getRestAPILayer(this);
    }
    set restLayer(l) {
        this._restLayer = l;
    }
    afterUpdateRecords(records) {
        this.clearRecordsNotAddVersionForDerivedDssWhichQueryStat();
        super.afterUpdateRecords(records);
    }
    afterUpdateRecord(record) {
        this.clearRecordsNotAddVersionForDerivedDssWhichQueryStat();
        super.afterUpdateRecord(record);
    }
    afterAddRecord(record) {
        this.clearRecordsNotAddVersionForDerivedDssWhichQueryStat();
        super.afterAddRecord(record);
    }
    afterDeleteRecordById(id) {
        this.clearRecordsNotAddVersionForDerivedDssWhichQueryStat();
        super.afterDeleteRecordById(id);
    }
    clearRecordsNotAddVersionForDerivedDssWhichQueryStat() {
        this.getMainDataSource().getAllDerivedDataSources().concat(this.getMainDataSource()).forEach((ds) => {
            var _a;
            // If query statistics, we can not update the loaded records, will clear them.
            if ((_a = ds.getCurrentQueryParams()) === null || _a === void 0 ? void 0 : _a.outStatistics) {
                ds.clearRecordsNotAddVersion();
            }
        });
    }
    replaceSubLayerWithFeatureLayer() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const needToCreateLayer = ((_a = this.layer) === null || _a === void 0 ? void 0 : _a.declaredClass) === 'esri.layers.support.Sublayer';
            /**
             * Actually only sublayers of map service layer will need to create a new layer
             * since sublayer is not a real layer.
             * And in these sublayers, we only support feature layer.
             * So we only need to create feature layer.
             */
            if (needToCreateLayer && this.layer.url) {
                const FeatureLayer = yield (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModule)('esri/layers/FeatureLayer');
                const definitionExpression = this.layer.definitionExpression || null;
                this.layer = new FeatureLayer({
                    id: this.layer.id,
                    title: this.layer.title,
                    url: jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(this.layer),
                    renderer: this.layer.renderer,
                    popupTemplate: this.layer.popupTemplate,
                    sourceJSON: this.layer.sourceJSON,
                    parent: this.layer.parent,
                    definitionExpression
                });
                /**
                 * Child data sources will be ready before root data source.
                 * Clear child data sources cache here to let widgets using these child data sources update.
                 */
                this.getAllDerivedDataSources().forEach(ds => {
                    ds.clearRecords();
                    ds.layer = this.layer;
                });
                yield this.layer.load();
            }
            return Promise.resolve(this);
        });
    }
    _printUseAllFieldsWarning(outFields) {
        if (outFields === null || outFields === void 0 ? void 0 : outFields.includes('*')) {
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
                /**
                 * Use defer to make the warning clear.
                 * Otherwise the chrome (with react extension open) will also show the relevant stack after launching the app.
                 */
                console.warn(`Using * as out fields to do query. Data source id is: ${this.id}`);
            });
        }
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/feature-record-impl.ts":
/*!***************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/feature-record-impl.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureDataRecordImpl: () => (/* binding */ FeatureDataRecordImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


// Data source id used in proxy to load missing fields.
const DATA_SOURCE_ID_FOR_RECORD = 'data_source_id_for_record';
// Whether data of a recrod is a proxy.
const IS_RECORD_DATA_A_PROXY = 'is_record_data_a_proxy';
class FeatureDataRecordImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataRecord {
    constructor(feature, dataSource, options) {
        super();
        this._id = null;
        this.dataSource = dataSource;
        if (feature.attributes[dataSource.getIdField()] == null) {
            // That put the default id to feature.attributes will cause other issues. E.g. for cluster features, they should not have object id.
            this._id = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.uuidv1)();
        }
        // eslint-disable-next-line @typescript-eslint/no-unnecessary-boolean-literal-compare
        if ((options === null || options === void 0 ? void 0 : options.isBeforeMappingData) !== false) {
            feature.attributes = this.convertBeforeMappingDataToData(feature.attributes);
            this.feature = feature;
        }
        else {
            this.feature = feature;
        }
        // eslint-disable-next-line @typescript-eslint/no-unnecessary-boolean-literal-compare
        this.hasFullGeometries = (options === null || options === void 0 ? void 0 : options.hasFullGeometries) !== false;
        this.setProxyForData();
        this.fillGeometry();
    }
    setProxyForData() {
        var _a;
        if (!((_a = this.feature) === null || _a === void 0 ? void 0 : _a.attributes) || !this.dataSource) {
            return;
        }
        // If proxy is set and data source is not changed, no need to do it again.
        if (this.feature.attributes[IS_RECORD_DATA_A_PROXY] && this.feature.attributes[DATA_SOURCE_ID_FOR_RECORD] === this.dataSource.id) {
            return;
        }
        const dataSource = this.dataSource;
        this.feature.attributes = new Proxy(this.feature.attributes[IS_RECORD_DATA_A_PROXY] ? Object.assign({}, this.feature.attributes) : this.feature.attributes, {
            get(target, prop) {
                var _a;
                let value;
                if (prop in target) {
                    value = target[prop];
                }
                else if (typeof prop === 'string' && ((_a = dataSource.getSchema()) === null || _a === void 0 ? void 0 : _a.fields) && prop in dataSource.getSchema().fields) {
                    dataSource.loadMissingFields(Object.assign(Object.assign({}, dataSource.getCurrentQueryParams()), { outFields: [prop] }), true);
                }
                else if (prop === DATA_SOURCE_ID_FOR_RECORD) {
                    value = dataSource.id;
                }
                else if (prop === IS_RECORD_DATA_A_PROXY) {
                    value = true;
                }
                return value;
            }
        });
    }
    set dataSource(d) {
        this._dataSource = d;
        this.setProxyForData();
    }
    get dataSource() {
        return this._dataSource;
    }
    fillGeometry() {
        var _a, _b;
        if (!this.feature.geometry) {
            return;
        }
        const ds = this.dataSource;
        if (!this.feature.geometry.spatialReference) {
            this.feature.geometry.spatialReference = (_b = (_a = ds.getLayerDefinition()) === null || _a === void 0 ? void 0 : _a.extent) === null || _b === void 0 ? void 0 : _b.spatialReference;
        }
        // (this.feature.geometry as IHasZM).hasM = ds.getLayerDefinition()?.hasM;
        // (this.feature.geometry as IHasZM).hasZ = ds.getLayerDefinition()?.hasZ;
    }
    queryAttachments(attachmentTypes) {
        return __awaiter(this, void 0, void 0, function* () {
            let featureLayerUrl = null;
            const featureLayerDs = this.dataSource;
            featureLayerUrl = featureLayerDs && featureLayerDs.getMainDataSource().url;
            if (!featureLayerUrl) {
                return yield Promise.resolve([]);
            }
            const attachmentQuery = {
                attachmentTypes: attachmentTypes,
                url: featureLayerUrl,
                featureId: this.getId()
            };
            if (!this._queryAllAttachmentsPromise) {
                this._queryAllAttachmentsPromise = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.queryAllAttachments(attachmentQuery);
            }
            return yield this._queryAllAttachmentsPromise.then((attachmentInfos) => __awaiter(this, void 0, void 0, function* () {
                this.attachmentInfos = attachmentInfos;
                return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.filterAttachments(attachmentInfos, attachmentQuery);
            }));
        });
    }
    fetchSymbolPreviewHTML() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this._isGraphicFeature()) {
                return yield Promise.resolve(null);
            }
            if (this._getSymbolPreviewHTMLPromise) {
                return yield this._getSymbolPreviewHTMLPromise;
            }
            this._getSymbolPreviewHTMLPromise = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModules)([
                'esri/symbols/support/symbolUtils'
            ]).then((modules) => __awaiter(this, void 0, void 0, function* () {
                let symbolUtils = null;
                [symbolUtils] = modules;
                return yield symbolUtils.getDisplayedSymbol(this.feature).then((symbol) => __awaiter(this, void 0, void 0, function* () {
                    const nodeHtml = document.createElement('div');
                    nodeHtml.className = 'w-100 h-100 d-flex justify-content-center align-items-center';
                    return yield symbolUtils.renderPreviewHTML(symbol, {
                        node: nodeHtml
                    });
                }));
            }));
            return yield this._getSymbolPreviewHTMLPromise;
        });
    }
    getData() {
        return this.feature.attributes;
    }
    setData(data) {
        this.feature.attributes = data;
        this.setProxyForData();
    }
    clone(deep) {
        const shallowClone = jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.clone(this);
        if (deep) {
            if (this.feature.declaredClass === 'esri.Graphic') {
                shallowClone.feature = this.feature.clone();
            }
            else {
                shallowClone.feature = jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.cloneDeep(this.feature);
            }
            return shallowClone;
        }
        else {
            return shallowClone;
        }
    }
    /*
     * Displayed date label should honor timezone
     * Three cases: unknown timezone, specific timezone, or device (local, by default).
     */
    getDateFieldValue(jimuFieldName) {
        let value = this.getFieldValue(jimuFieldName);
        const timezone = this.dataSource.getTimezone();
        if (timezone === 'unknown') {
            value = value - jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLocalTimeOffset();
        }
        else if (timezone !== 'device' && timezone !== null) {
            const tzOffset = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getAppSettingTimeZoneOffset(timezone);
            value = value - jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLocalTimeOffset() + tzOffset;
        }
        return value;
    }
    getFormattedFieldValue(jimuFieldName, intl) {
        const ds = this.dataSource;
        const layerDefinition = ds && ds.getLayerDefinition && ds.getLayerDefinition();
        if (!layerDefinition) {
            return super.getFormattedFieldValue(jimuFieldName, intl);
        }
        const valueObj = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDisplayValueForCodedValueOrSubtype(layerDefinition, jimuFieldName, this.getData());
        return valueObj.isCodedValueOrSubtype ? valueObj.displayValue : super.getFormattedFieldValue(jimuFieldName, intl);
    }
    getDataBeforeMapping() {
        return this.convertDataToDataBeforeMapping(this.getData());
    }
    getOriginData() {
        const cloneFeature = Object.assign({}, this.feature);
        cloneFeature.attributes = this.convertDataToDataBeforeMapping(this.getData());
        return cloneFeature;
    }
    toJson() {
        const featureJson = this.feature;
        return featureJson;
    }
    getId() {
        return this.feature.attributes[this.dataSource.getIdField()] != null ? this.feature.attributes[this.dataSource.getIdField()] + '' : this._id;
    }
    setId(id) {
        // TODO
    }
    getGeometry() {
        var _a;
        if (this.feature.declaredClass === 'esri.Graphic') {
            return (_a = this.feature.geometry) === null || _a === void 0 ? void 0 : _a.toJSON();
        }
        return this.feature.geometry;
    }
    getRawGeometry() {
        // __esri.Geometry's toJSON will cause the loss of some lines. Use this method to get the original geometry.
        return this.feature.geometry;
    }
    setGeometry(geo) {
        var _a, _b, _c;
        if (((_a = this.feature) === null || _a === void 0 ? void 0 : _a.declaredClass) === 'esri.Graphic') {
            const Geometry = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.getModuleSync('esri/geometry/Geometry');
            // If feature is typeof Graphic, JS API module Geometry should already be loaded.
            this.feature.geometry = ((_b = geo === null || geo === void 0 ? void 0 : geo.declaredClass) === null || _b === void 0 ? void 0 : _b.includes('esri.geometry')) ? geo : ((Geometry === null || Geometry === void 0 ? void 0 : Geometry.fromJSON(geo)) || geo);
        }
        else {
            this.feature.geometry = ((_c = geo === null || geo === void 0 ? void 0 : geo.declaredClass) === null || _c === void 0 ? void 0 : _c.includes('esri.geometry')) ? geo.toJSON() : geo;
        }
    }
    setFeature(feature) {
        this.feature = feature;
        this.fillGeometry();
    }
    getFeature() {
        return this.feature;
    }
    /**
     * @ignore
     * Returns whether `feature` is type of `__esri.Graphic`, some methods only work with `__esri.Graphic`.
     */
    _isGraphicFeature() {
        var _a;
        return !!((_a = this === null || this === void 0 ? void 0 : this.feature) === null || _a === void 0 ? void 0 : _a.layer);
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/feature-service-data-source-impl.ts":
/*!****************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/feature-service-data-source-impl.ts ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureServiceDataSourceImpl: () => (/* binding */ FeatureServiceDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Data source from a feature service, which may contain multiple child data sources.
 */
class FeatureServiceDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_2__.AbstractLayerFolderDataSource {
    constructor() {
        super(...arguments);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.FeatureService;
    }
    getChildIds() {
        return this.getChildIdsByUrl();
    }
    createChildDataSourceOptionsById(childDsId, jimuChildId, childId) {
        return this.createChildDataSourceOptionsByIdFromUrl(childDsId, jimuChildId, childId);
    }
    /**
     * If use Layer.fromArcGISServerUrl/Layer.fromPortalItem to create JS API layer for feature service, will return a feature layer if the feature service only contains one layer/table.
     * It causes the feature service data source returns a feature layer as its JS API layer, which is not expected.
     * So we overide the method to make sure feature service data source always returns a group layer.
    */
    createJSAPILayerByDataSource() {
        const _super = Object.create(null, {
            createJSAPILayerByDataSource: { get: () => super.createJSAPILayerByDataSource }
        });
        var _a, _b, _c, _d, _e, _f, _g;
        return __awaiter(this, void 0, void 0, function* () {
            let layer;
            try {
                if (!this.areChildDataSourcesCreated()) {
                    yield this.childDataSourcesReady();
                }
                const hasSingleLayer = ((_b = (_a = this.getItemInfo()) === null || _a === void 0 ? void 0 : _a.typeKeywords) === null || _b === void 0 ? void 0 : _b.includes('Singlelayer')) || ((_d = (_c = this.getServiceDefinition()) === null || _c === void 0 ? void 0 : _c.layers) === null || _d === void 0 ? void 0 : _d.length) === 1;
                if (hasSingleLayer) { // the original item/service only contains one layer
                    const childDss = this.getChildDataSources();
                    if (childDss.length === 0) { // failed to create child data sources for some reason
                        const [Layer, GroupLayer] = yield (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModules)(['esri/layers/Layer', 'esri/layers/GroupLayer']);
                        const childLayer = yield Layer.fromArcGISServerUrl({ url: `${this.url}/${((_g = (_f = (_e = this.getServiceDefinition()) === null || _e === void 0 ? void 0 : _e.layers) === null || _f === void 0 ? void 0 : _f[0]) === null || _g === void 0 ? void 0 : _g.id) || 0}` });
                        layer = new GroupLayer({
                            layers: childLayer.isTable ? [] : [childLayer],
                            tables: childLayer.isTable ? [childLayer] : [],
                            title: this.getLabel()
                        });
                    }
                    else { // only has one child data source
                        const loadJSAPIGroupLayerPromise = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModule)('esri/layers/GroupLayer');
                        const createJSAPILayerForChildDsPromise = childDss[0].layer ? Promise.resolve(childDss[0].layer) : childDss[0].createJSAPILayerByDataSource();
                        const [GroupLayer, childLayer] = yield Promise.all([loadJSAPIGroupLayerPromise, createJSAPILayerForChildDsPromise]);
                        layer = new GroupLayer({
                            layers: childLayer.isTable ? [] : [childLayer],
                            tables: childLayer.isTable ? [childLayer] : [],
                            title: this.getLabel()
                        });
                    }
                }
                else { // the original item/service contains multiple layers
                    layer = (yield _super.createJSAPILayerByDataSource.call(this));
                }
            }
            catch (err) {
                console.error('Failed to create JS API layer. ', err, this.id);
            }
            return (layer === null || layer === void 0 ? void 0 : layer.type) === 'group' ? layer : null;
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/geojson-data-source-impl.ts":
/*!********************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/geojson-data-source-impl.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GeoJSONDataSourceImpl: () => (/* binding */ GeoJSONDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class GeoJSONDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_2__.AbstractDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.GeoJSON;
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
        if (this.url) {
            /**
             * Cache request since -
             * 1. we need to cache the request since the records are saved here, which means, the response size may be large.
             * 2. we don't know the URL schema of this type of data source, can not cache them by default.
             */
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.registerCacheableUrl(this.url);
        }
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/group-layer-data-source-impl.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/group-layer-data-source-impl.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GroupLayerDataSourceImpl: () => (/* binding */ GroupLayerDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/data-source-json-creator */ "./jimu-core/lib/data-sources/support/data-source-json-creator.ts");




/**
 * Data source from group layer in a map service, or group in map viewer/scene viewer, or feature collection item which contains multiple layers.
 * Group layer data source may contain multiple child data sources.
 */
class GroupLayerDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractLayerFolderDataSource {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceTypes.GroupLayer;
        this.setItemData(options.itemData);
    }
    getChildIds() {
        if (this.layer) {
            return this.getChildIdsByLayer();
        }
        else if (this.url) {
            return this.getChildIdsByUrl();
        }
        else if (this.itemId || this.getItemData()) {
            return this.getChildIdsByItem();
        }
        return [];
    }
    createChildDataSourceOptionsById(childDsId, jimuChildId, childId) {
        if (this.layer) {
            return this.createChildDataSourceOptionsByIdFromLayer(childDsId, jimuChildId, childId);
        }
        else if (this.url) {
            return this.createChildDataSourceOptionsByIdFromUrl(childDsId, jimuChildId, childId);
        }
        else if (this.itemId || this.getItemData()) {
            return this.createChildDataSourceOptionsByIdFromItem(childDsId, jimuChildId, childId);
        }
        return null;
    }
    getChildIdsByLayer() {
        return this.isJSAPIGroupLayer(this.layer) ? this.getChildIdsByJSAPIGroupLayer() : this.getChildIdsByJSAPISubLayer();
    }
    getChildIdsByItem() {
        return this.isFeatureCollectionItem(this.getItemInfo()) ? this.getChildIdsByFeatureCollectionItem() : this.getChildIdsByGroupLayerItem();
    }
    createChildDataSourceOptionsByIdFromLayer(childDsId, jimuChildId, childId) {
        if (this.layer) {
            const isJSAPIGroupLayer = this.isJSAPIGroupLayer(this.layer);
            const layerInfo = isJSAPIGroupLayer ? this.findLayerInfoOfJSAPIGroupLayer(childId) : this.findLayerInfoOfJSAPISubLayer(childId);
            if (!(layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.layer)) {
                return null;
            }
            if (isJSAPIGroupLayer) {
                return this.createChildDataSourceOptionsByLayer(layerInfo.layer, layerInfo.url, jimuChildId, childDsId, layerInfo.order);
            }
            else {
                /**
                 * __esri.Sublayer doesn't indicate its type (group layer or feature layer or raster layer or other types). Its type always is 'sublayer'.
                 * So we use layer definition to create child data sources.
                 */
                const dsOptions = this.createChildDataSourceOptionsByLayerDefinition(layerInfo.layer.sourceJSON, layerInfo.url, jimuChildId, childDsId, layerInfo.order);
                if (layerInfo.layer.title && dsOptions.dataSourceJson) {
                    dsOptions.dataSourceJson = dsOptions.dataSourceJson.set('sourceLabel', layerInfo.layer.title);
                }
                return dsOptions ? Object.assign(Object.assign({}, dsOptions), { layer: layerInfo.layer }) : null;
            }
        }
        return null;
    }
    createChildDataSourceOptionsByIdFromItem(childDsId, jimuChildId, childId) {
        const isFeatureCollection = this.isFeatureCollectionItem(this.getItemInfo());
        let dsOptions;
        if (isFeatureCollection) {
            const layerInfo = this.findLayerInfoOfFeatureCollectionItem(childId);
            if (!(layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.layerDefinition)) {
                return null;
            }
            dsOptions = this.createChildDataSourceOptionsByLayerDefinition(layerInfo.layerDefinition, null, jimuChildId, childDsId, layerInfo.order);
            if (dsOptions && !dsOptions.dataSourceJson.layerId) {
                // If is multiple-layers feature collection item, the layer definition may don't contain layer id, need to pass in it.
                dsOptions.dataSourceJson = dsOptions.dataSourceJson.set('layerId', `${layerInfo.order}`);
            }
        }
        else {
            const layerInfo = this.findLayerInfoOfGroupLayerItem(childId);
            if (!(layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.layerItem)) {
                return null;
            }
            dsOptions = this.createChildDataSourceOptionsByLayerItem(layerInfo.layerItem, layerInfo.portalUrl, jimuChildId, childDsId, layerInfo.order);
        }
        return dsOptions;
    }
    createChildDataSourceOptionsByLayerItem(item, portalUrl, jimuChildId, childDsId, order) {
        const dsJson = this.createChildDataSourceJsonByLayerItem(item, portalUrl, jimuChildId, childDsId);
        if (dsJson) {
            return {
                id: childDsId,
                dataSourceJson: dsJson,
                parentDataSource: this,
                jimuChildId,
                order,
                itemData: item
            };
        }
        return null;
    }
    createChildDataSourceJsonByLayerItem(itemData, portalUrl, jimuChildId, childDsId) {
        var _a, _b, _c;
        if (!itemData || !childDsId) {
            return null;
        }
        const schemaInConfig = (_b = (_a = this.getDataSourceJson().schema) === null || _a === void 0 ? void 0 : _a.childSchemas) === null || _b === void 0 ? void 0 : _b[jimuChildId];
        const dsJsonInConfig = (_c = this.getDataSourceJson().childDataSourceJsons) === null || _c === void 0 ? void 0 : _c[jimuChildId];
        return _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_3__.createDataSourceJsonByItemData(childDsId, itemData, portalUrl, dsJsonInConfig, schemaInConfig);
    }
    createChildDataSourceOptionsByLayer(layer, url, jimuChildId, childDsId, order) {
        const dsJson = this.createChildDataSourceJsonByLayer(layer, url, jimuChildId, childDsId);
        if (dsJson) {
            return {
                id: childDsId,
                dataSourceJson: dsJson,
                parentDataSource: this,
                jimuChildId,
                order,
                layer
            };
        }
        return null;
    }
    createChildDataSourceJsonByLayer(layer, url, jimuChildId, childDsId) {
        var _a, _b, _c, _d, _e, _f;
        if (!layer || !childDsId) {
            return null;
        }
        const layerDefinition = layer.sourceJSON;
        // _jimuChildIdFromLabel is to support data source before dev1.16, see upgradeChildDssId for more details.
        const _jimuChildIdFromLabel = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils._getFixedLayerIdByLayerDefinition(layerDefinition) || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(url);
        const schemaInConfig = ((_b = (_a = this.getDataSourceJson().schema) === null || _a === void 0 ? void 0 : _a.childSchemas) === null || _b === void 0 ? void 0 : _b[jimuChildId]) || ((_d = (_c = this.getDataSourceJson().schema) === null || _c === void 0 ? void 0 : _c.childSchemas) === null || _d === void 0 ? void 0 : _d[_jimuChildIdFromLabel]);
        const dsJsonInConfig = ((_e = this.getDataSourceJson().childDataSourceJsons) === null || _e === void 0 ? void 0 : _e[jimuChildId]) || ((_f = this.getDataSourceJson().childDataSourceJsons) === null || _f === void 0 ? void 0 : _f[_jimuChildIdFromLabel]);
        return _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_3__.createDataSourceJsonByJSAPILayer(childDsId, layer, dsJsonInConfig, schemaInConfig);
    }
    findLayerInfoOfJSAPIGroupLayer(childId) {
        const layers = this.getJSAPILayersAndTables();
        let layerInfo;
        layers.some((l, i) => {
            const layerUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(l);
            const layerSourceUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDataSourceSourceUrl(layerUrl);
            if (this.getChildIdByLayer(l) === childId) {
                layerInfo = {
                    layer: l,
                    url: layerSourceUrl,
                    order: i
                };
                return true;
            }
            return false;
        });
        return layerInfo;
    }
    findLayerInfoOfJSAPISubLayer(childId) {
        const layers = this.getJSAPISubLayers();
        let layerInfo;
        layers.some((l, i) => {
            const layerUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(l);
            const layerSourceUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDataSourceSourceUrl(layerUrl);
            if (this.getChildIdBySubLayer(l) === childId) {
                layerInfo = {
                    layer: l,
                    url: layerSourceUrl,
                    order: i
                };
                return true;
            }
            return false;
        });
        return layerInfo;
    }
    findLayerInfoOfGroupLayerItem(childId) {
        const layers = this.getLayersOfGroupLayerItem();
        let layerInfo;
        layers.some((l, i) => {
            if (this.getChildIdByLayerItem(l) === childId) {
                layerInfo = {
                    layerItem: l,
                    order: i,
                    portalUrl: this.portalUrl
                };
                return true;
            }
            return false;
        });
        return layerInfo;
    }
    findLayerInfoOfFeatureCollectionItem(childId) {
        const layers = this.getLayersOfFeatureCollectionItem();
        let layerInfo;
        layers.some((l, i) => {
            if (this.getChildIdByLayerDefinition(l, null) === childId) {
                layerInfo = {
                    layerDefinition: l,
                    order: i
                };
                return true;
            }
            return false;
        });
        return layerInfo;
    }
    getJSAPISubLayers() {
        var _a, _b;
        return ((_b = (_a = this.layer.sublayers) === null || _a === void 0 ? void 0 : _a.toArray()) === null || _b === void 0 ? void 0 : _b.reverse()) || [];
    }
    getJSAPILayersAndTables() {
        var _a, _b, _c, _d;
        const layers = ((_b = (_a = this.layer.layers) === null || _a === void 0 ? void 0 : _a.toArray()) === null || _b === void 0 ? void 0 : _b.reverse()) || [];
        const tables = ((_d = (_c = this.layer.tables) === null || _c === void 0 ? void 0 : _c.toArray()) === null || _d === void 0 ? void 0 : _d.reverse()) || [];
        return layers.concat(tables);
    }
    getLayersOfFeatureCollectionItem() {
        var _a, _b;
        return ((_b = (_a = this.getItemData()) === null || _a === void 0 ? void 0 : _a.layers) === null || _b === void 0 ? void 0 : _b.map(l => l.layerDefinition)) || [];
    }
    getLayersOfGroupLayerItem() {
        var _a;
        return ((_a = this.getItemData()) === null || _a === void 0 ? void 0 : _a.layers) || [];
    }
    getChildIdsByJSAPISubLayer() {
        return this.getJSAPISubLayers().map(l => this.getChildIdBySubLayer(l));
    }
    getChildIdsByJSAPIGroupLayer() {
        return this.getJSAPILayersAndTables().map(l => this.getChildIdByLayer(l));
    }
    getChildIdsByFeatureCollectionItem() {
        return this.getLayersOfFeatureCollectionItem().map(l => this.getChildIdByLayerDefinition(l, null));
    }
    getChildIdsByGroupLayerItem() {
        return this.getLayersOfGroupLayerItem().map(l => this.getChildIdByLayerItem(l));
    }
    getChildIdByLayerItem(item) {
        // Didn't create a new util to get child id by layer item data, since the logic is simliar.
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFixedLayerIdByLayerDefinition(item);
    }
    isJSAPIGroupLayer(layer) {
        return (layer === null || layer === void 0 ? void 0 : layer.type) === _interfaces__WEBPACK_IMPORTED_MODULE_2__.SupportedJSAPILayerTypes.GroupLayer;
    }
    isFeatureCollectionItem(item) {
        return (item === null || item === void 0 ? void 0 : item.type) === _interfaces__WEBPACK_IMPORTED_MODULE_2__.SupportedItemTypes.FeatureCollection;
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/image-service-data-source-impl.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/image-service-data-source-impl.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ImageServiceDataSourceImpl: () => (/* binding */ ImageServiceDataSourceImpl)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class ImageServiceDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.ImageService;
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/kml-data-source-impl.ts":
/*!****************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/kml-data-source-impl.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   KMLDataSourceImpl: () => (/* binding */ KMLDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class KMLDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_2__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_2__.AbstractDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_1__.DataSourceTypes.KML;
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
        if (this.url || (this.portalUrl && this.itemId)) {
            /**
             * KML layer will use the utility service to analyze the url/portal item data.
             *
             * Cache request since -
             * 1. we need to cache the request since the records are saved here, which means, the response size may be large.
             * 2. we don't know the URL schema of this type of data source, can not cache them by default.
             */
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.requestUtils.registerCacheableUrl((url, query) => {
                if (url !== 'https://utility.arcgis.com/sharing/kml') {
                    return false;
                }
                const sourceUrl = query === null || query === void 0 ? void 0 : query.url;
                return sourceUrl.includes(this.url) || sourceUrl.includes(`${this.portalUrl}/sharing/rest/content/items/${this.itemId}`);
            });
        }
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/map-service-data-source-impl.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/map-service-data-source-impl.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MapServiceDataSourceImpl: () => (/* binding */ MapServiceDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");



/**
 * Data source from a map service, which may contain multiple child data sources.
 */
class MapServiceDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractLayerFolderDataSource {
    constructor() {
        super(...arguments);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceTypes.MapService;
    }
    getChildIds() {
        if (this.layer) {
            return this.getChildIdsByLayer();
        }
        else {
            return this.getChildIdsByUrl();
        }
    }
    createChildDataSourceOptionsById(childDsId, jimuChildId, childId) {
        if (this.layer) {
            return this.createChildDataSourceOptionsByIdFromLayer(childDsId, jimuChildId, childId);
        }
        else if (this.url) {
            return this.createChildDataSourceOptionsByIdFromUrl(childDsId, jimuChildId, childId);
        }
        return null;
    }
    supportTime() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.supportTime(this);
    }
    getTimeInfo() {
        var _a, _b;
        if (this.layer) {
            return (_a = this.layer.timeInfo) === null || _a === void 0 ? void 0 : _a.toJSON();
        }
        else {
            return (_b = this.getServiceDefinition()) === null || _b === void 0 ? void 0 : _b.timeInfo;
        }
    }
    getTimeExtent() {
        const widgetQueries = this.getInfo().widgetQueries || {};
        const timeArr = Object.values(widgetQueries).map((q) => q === null || q === void 0 ? void 0 : q.time).filter(w => typeof w === 'number' || Array.isArray(w));
        const time = timeArr.length > 1 ? timeArr.reduce((res, t) => (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.mergeTimeExtent(res, t)), null) : timeArr[0];
        return time;
    }
    changeTimeExtent(time, widgetId) {
        var _a, _b;
        if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.isDeepEqual(time, (_b = (_a = this.getInfo().widgetQueries) === null || _a === void 0 ? void 0 : _a[widgetId]) === null || _b === void 0 ? void 0 : _b.time)) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.updateWidgetQuery(this.id, widgetId, { time }));
            this.getAllChildDataSources().forEach(cDs => {
                if (cDs.type === _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceTypes.FeatureLayer) {
                    cDs.updateQueryParams({ time }, widgetId);
                }
            });
        }
    }
    changeGDBVersion(gdbVersion) {
        super.changeGDBVersion(gdbVersion);
        if (this.layer && this.layer.type === 'map-image') {
            this.layer.gdbVersion = gdbVersion;
        }
    }
    createChildDataSourceOptionsByIdFromLayer(childDsId, jimuChildId, childId) {
        if (this.layer) {
            const layerInfo = this.findSubLayerInfo(childId);
            if (!(layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.subLayer)) {
                return null;
            }
            const dsOptions = this.createChildDataSourceOptionsByLayerDefinition(layerInfo.subLayer.sourceJSON, layerInfo.url, jimuChildId, childDsId, layerInfo.order);
            if (layerInfo.subLayer.title && dsOptions.dataSourceJson) {
                dsOptions.dataSourceJson = dsOptions.dataSourceJson.set('sourceLabel', layerInfo.subLayer.title);
            }
            return dsOptions ? Object.assign(Object.assign({}, dsOptions), { layer: layerInfo.subLayer }) : null;
        }
        return null;
    }
    findSubLayerInfo(childId) {
        const subLayers = this.getSubLayers();
        let subLayerInfo;
        subLayers.some((subLayer, i) => {
            const layerUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(subLayer);
            const layerSourceUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDataSourceSourceUrl(layerUrl);
            if (this.getChildIdBySubLayer(subLayer) === childId) {
                subLayerInfo = {
                    subLayer: subLayer,
                    url: layerSourceUrl,
                    order: i
                };
                return true;
            }
            return false;
        });
        return subLayerInfo;
    }
    getSubLayers() {
        var _a, _b;
        return ((_b = (_a = this.layer.sublayers) === null || _a === void 0 ? void 0 : _a.toArray()) === null || _b === void 0 ? void 0 : _b.reverse()) || [];
    }
    getChildIdsByLayer() {
        var _a, _b;
        return (((_b = (_a = this.layer) === null || _a === void 0 ? void 0 : _a.sublayers) === null || _b === void 0 ? void 0 : _b.toArray()) || []).map(l => this.getChildIdBySubLayer(l));
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/scene-layer-data-source-impl.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/scene-layer-data-source-impl.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SceneLayerDataSourceImpl: () => (/* binding */ SceneLayerDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_classes_abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes/abstract-queriable-data-source */ "./jimu-core/lib/data-sources/base-classes/abstract-queriable-data-source.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _feature_record_impl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./feature-record-impl */ "./jimu-core/lib/data-sources/implementations/feature-record-impl.ts");
/* harmony import */ var _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../support/data-source-json-creator */ "./jimu-core/lib/data-sources/support/data-source-json-creator.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






const ASSOCIATED_DATA_SOURCE_ID = 'associated_data_source';
class SceneLayerDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_3__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_3__.ItemMixinImpl)(_base_classes_abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_1__.AbstractQueriableDataSource)) {
    constructor(options) {
        var _a, _b, _c;
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceTypes.SceneLayer;
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
        this.layerId = dsJson.layerId;
        if (options.layer) {
            this.layer = options.layer;
        }
        if (options.belongToDataSource && options.belongToDataSource.layer) {
            this.layer = options.belongToDataSource.layer;
        }
        if (this.isLocal) {
            const associatedDataSourceBelongToDataSource = (_a = options.belongToDataSource) === null || _a === void 0 ? void 0 : _a.getAssociatedDataSource();
            if (associatedDataSourceBelongToDataSource) {
                jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().createLocalDataSource(associatedDataSourceBelongToDataSource, this.localId);
            }
        }
        else if (this.isDataView) {
            const associatedDataSourceBelongToDataSource = (_b = options.belongToDataSource) === null || _b === void 0 ? void 0 : _b.getAssociatedDataSource();
            if (associatedDataSourceBelongToDataSource) {
                jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().createDataView(associatedDataSourceBelongToDataSource, this.dataViewId);
            }
        }
        if (this.getAssociatedDataSource()) {
            // Keep data view and local scene layer data source's info is same as associated data source's info.
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.observeStore)(this.onInfoChange.bind(this), ['dataSourcesInfo', this.getAssociatedDataSource().id]);
            // Set data view and local associated feature layer data source's associated data source to scene layer data source.
            this.getAssociatedDataSource().setAssociatedDataSource(this);
        }
        if ((_c = this.layer) === null || _c === void 0 ? void 0 : _c.portalItem) {
            this.setItemInfo(this.layer.portalItem.sourceJSON);
        }
    }
    ready() {
        const _super = Object.create(null, {
            ready: { get: () => super.ready }
        });
        return __awaiter(this, void 0, void 0, function* () {
            yield Promise.all([
                this.fetchLayerDefinition(),
                this.createAssociatedDataSource()
            ]).then(() => {
                if (!this.getAssociatedDataSource()) {
                    return Promise.reject('Need associated feature layer.');
                }
                return _super.ready.call(this);
            }).then(() => {
                var _a, _b;
                // Keep main scene layer data source's info is same as associated data source's info.
                if (this.getAssociatedDataSource()) {
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.observeStore)(this.onInfoChange.bind(this), ['dataSourcesInfo', this.getAssociatedDataSource().id]);
                }
                // Sync popupTemplate to associated feature layer.
                if (((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.layer) && ((_b = this.layer) === null || _b === void 0 ? void 0 : _b.popupTemplate)) {
                    this.getAssociatedDataSource().layer.popupTemplate = this.layer.popupTemplate;
                }
            });
        });
    }
    // Need to keep the scene layer data source's info is same as the associated data source's (feature layer data source) info, except for `instanceStatus`.
    onInfoChange() {
        if (this.getAssociatedDataSource() && !jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.isDeepEqual(this.getInfo().without('instanceStatus'), this.getAssociatedDataSource().getInfo().without('instanceStatus'))) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.updateDataSourceInfo(this.id, this.getAssociatedDataSource().getInfo().without('instanceStatus').set('instanceStatus', this.getInfo().instanceStatus)));
        }
    }
    createAssociatedDataSource() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.getAssociatedDataSource()) {
                return yield Promise.resolve(this.getAssociatedDataSource());
            }
            if (this.layer) {
                return yield this._createAssociatedDataSourceWithLayer().then(associatedDataSource => {
                    if (!associatedDataSource) {
                        return this._createAssociatedDataSourceWithUrl();
                    }
                    return associatedDataSource;
                });
            }
            else {
                return this._createAssociatedDataSourceWithUrl();
            }
        });
    }
    _createAssociatedDataSourceWithLayer() {
        return __awaiter(this, void 0, void 0, function* () {
            const dsId = this._getNewAssociatedDataSourceId();
            return yield this.layer.load().then(() => __awaiter(this, void 0, void 0, function* () {
                const associatedFeatureLayer = this.layer.associatedLayer;
                if (!associatedFeatureLayer) {
                    return null;
                }
                if (this.layer.definitionExpression) {
                    associatedFeatureLayer.definitionExpression = this.layer.definitionExpression;
                }
                let dsJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
                    id: dsId,
                    type: _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceTypes.FeatureLayer,
                    url: jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(associatedFeatureLayer)
                });
                dsJson = this._mergeAssociatedDataSourceJson(dsJson);
                const options = {
                    id: dsId,
                    dataSourceJson: dsJson,
                    layer: associatedFeatureLayer,
                    associatedDataSource: this
                };
                return yield this.dataSourceManager.createDataSource(options);
            })).then(ds => {
                this.associatedDataSource = ds;
                return this.associatedDataSource;
            });
        });
    }
    _createAssociatedDataSourceWithUrl() {
        return __awaiter(this, void 0, void 0, function* () {
            const dsId = this._getNewAssociatedDataSourceId();
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.fetchAssociatedFeatureLayerDefinition(this.url, this.layerId, this.itemId, this.portalUrl)
                .then(res => {
                if (!res) {
                    return Promise.reject('Can not find associated feature layer');
                }
                let dsJson = _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_5__.createDataSourceJsonByLayerDefinition(dsId, res.def, res.url);
                dsJson = this._mergeAssociatedDataSourceJson(dsJson);
                return dsJson;
            }).then((dsJson) => __awaiter(this, void 0, void 0, function* () {
                const options = {
                    id: dsJson.id,
                    dataSourceJson: dsJson,
                    associatedDataSource: this
                };
                return yield this.dataSourceManager.createDataSource(options);
            })).then(ds => {
                this.associatedDataSource = ds;
                return this.associatedDataSource;
            });
        });
    }
    _getNewAssociatedDataSourceId() {
        return `${this.getDataSourceJson().id}-${ASSOCIATED_DATA_SOURCE_ID}`;
    }
    getTimezone() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getTimezone();
    }
    fetchLayerDefinition() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const url = this.url;
                if (this.layer) {
                    yield this.layer.load();
                    this.layerDefinition = {
                        id: this.layer.layerId,
                        fields: (_a = this.layer.fields) === null || _a === void 0 ? void 0 : _a.map(f => f === null || f === void 0 ? void 0 : f.toJSON())
                    };
                }
                else if (this.url) {
                    const layerDef = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.ServiceManager.getInstance().fetchServiceInfo(url).then(res => res.definition)
                        .then(definition => {
                        if (!definition) {
                            return null;
                        }
                        return definition;
                    });
                    this.layerDefinition = layerDef;
                }
                return Promise.resolve(this.layerDefinition);
            }
            catch (err) {
                return Promise.resolve(null);
            }
        });
    }
    getLayerDefinition() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLayerDefinition(this);
    }
    setLayerDefinition(layerDef) {
        this.layerDefinition = layerDef;
    }
    getPopupInfo() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getPopupInfo(this);
    }
    setPopupInfo(popupInfo) {
        this.popupInfo = popupInfo;
    }
    getCapabilities() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getCapabilities();
    }
    // @ts-expect-error - TS2611 error, seems to be solved in v4.8.0, https://github.com/microsoft/TypeScript/issues/41347 .
    get layer() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getJSAPILayer(this);
    }
    set layer(l) {
        this._layer = l;
    }
    getItemInfo() {
        if (this.isDataView || this.isLocal) {
            return this.getMainDataSource().getItemInfo();
        }
        return super.getItemInfo();
    }
    fetchSchema() {
        return __awaiter(this, void 0, void 0, function* () {
            const label = yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getOriginDataLabel(this);
            const sceneLayerSchema = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({ label });
            const associatedLayerSchema = yield (this.getAssociatedDataSource() ? this.getAssociatedDataSource().fetchSchema() : Promise.resolve(null));
            return associatedLayerSchema ? associatedLayerSchema.merge(sceneLayerSchema) : sceneLayerSchema;
        });
    }
    setDataSourceJson(dsJson) {
        super.setDataSourceJson(dsJson);
        if (this.getAssociatedDataSource()) {
            const aDsJson = this._mergeAssociatedDataSourceJson(this.getAssociatedDataSource().getDataSourceJson());
            this.getAssociatedDataSource().setDataSourceJson(aDsJson);
        }
    }
    getFetchedSchema() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getFetchedSchema();
    }
    setFetchedSchema(fetchedSchema) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setFetchedSchema(fetchedSchema);
    }
    getReversedConfigSchema() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getReversedConfigSchema();
    }
    getSelectedFields() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSelectedFields();
    }
    setSelectedFields(jimuNames) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setSelectedFields(jimuNames);
    }
    getIdField() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getIdField();
    }
    queryById(id) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            return yield ((_b = (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.queryById(id)) !== null && _b !== void 0 ? _b : Promise.reject(Error('No Associated DataSource.')));
        });
    }
    addRecord(record) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            return yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.addRecord(record));
        });
    }
    updateRecord(record) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            return yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.updateRecord(record));
        });
    }
    updateRecords(records) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            return yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.updateRecords(records));
        });
    }
    deleteRecord(index) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            return yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.deleteRecord(index));
        });
    }
    deleteRecordById(id) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            return yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.deleteRecordById(id));
        });
    }
    doQuery(realQuery, originQuery) {
        if (this.getAssociatedDataSource()) {
            return this.getAssociatedDataSource().doQuery(realQuery, originQuery).then(res => {
                res.records = res.records.map(r => this.fixRecordDataSource(r));
                return res;
            });
        }
        else {
            return Promise.reject(Error('No Associated DataSource.'));
        }
    }
    doQueryById(id) {
        if (this.getAssociatedDataSource()) {
            return this.getAssociatedDataSource().doQueryById(id).then(record => this.fixRecordDataSource(record));
        }
        else {
            return Promise.reject(Error('No Associated DataSource.'));
        }
    }
    doQueryIds(queryParams) {
        if (this.getAssociatedDataSource()) {
            return this.getAssociatedDataSource().doQueryIds(queryParams).then(res => {
                res.records = res.records.map(r => this.fixRecordDataSource(r));
                return res;
            });
        }
        else {
            return Promise.reject(Error('No Associated DataSource.'));
        }
    }
    doQueryCount(queryProperties) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            return yield ((_b = (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.doQueryCount(queryProperties)) !== null && _b !== void 0 ? _b : Promise.reject(Error('No Associated DataSource.')));
        });
    }
    getConfigQueryParams() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getConfigQueryParams();
    }
    getRemoteQueryParams() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRemoteQueryParams();
    }
    getCurrentQueryParams(options) {
        var _a;
        (options === null || options === void 0 ? void 0 : options.exclude) && this.fixExcludeQuery(options.exclude);
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getCurrentQueryParams(options);
    }
    getRuntimeQueryParamsgetRuntimeQueryParams(excludeWidgetId) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRuntimeQueryParams(excludeWidgetId);
    }
    getCurrentQueryId() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getCurrentQueryId();
    }
    mergeQueryParams(...queries) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.mergeQueryParams(...queries);
    }
    buildRecord(feature) {
        return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_4__.FeatureDataRecordImpl(feature, this);
    }
    getFieldCodedValueList(jimuFieldName, record) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getFieldCodedValueList(jimuFieldName, record);
    }
    getRealQueryParams(query, flag, options) {
        var _a;
        options && this.fixQueryOptions(options);
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRealQueryParams(query, flag, options);
    }
    getAllUsedFields(options) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getAllUsedFields(options);
    }
    applyUsedFields(query, usedFields) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.applyUsedFields(query, usedFields);
    }
    updateQueryParams(query, widgetId) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.updateQueryParams(query, widgetId);
    }
    getGDBVersion() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getGDBVersion();
    }
    getQueryPageSize() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getQueryPageSize();
    }
    getMaxRecordCount() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getMaxRecordCount();
    }
    getRecordsByPage(page, pageSize) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecordsByPage(page, pageSize);
    }
    getPagesData() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getPagesData();
    }
    setPagesData(pages) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setPagesData(pages);
    }
    getRealQueryPages(page, pageSize) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRealQueryPages(page, pageSize);
    }
    load(query, options = {}) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            options && this.fixQueryOptions(options);
            return (_b = yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.load(query, options))) !== null && _b !== void 0 ? _b : Promise.reject(Error('No Associated DataSource.'));
        });
    }
    loadCount(query, options = {}) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            options && this.fixQueryOptions(options);
            return (_b = yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.loadCount(query, options))) !== null && _b !== void 0 ? _b : Promise.reject(Error('No Associated DataSource.'));
        });
    }
    query(query, options) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            options && this.fixQueryOptions(options);
            return (_b = yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.query(query, options))) !== null && _b !== void 0 ? _b : Promise.reject(Error('No Associated DataSource.'));
        });
    }
    queryCount(query, options) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            options && this.fixQueryOptions(options);
            return (_b = yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.queryCount(query, options))) !== null && _b !== void 0 ? _b : Promise.reject(Error('No Associated DataSource.'));
        });
    }
    loadById(id, refresh) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            return (_b = yield ((_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.loadById(id, refresh))) !== null && _b !== void 0 ? _b : Promise.reject(Error('No Associated DataSource.'));
        });
    }
    changeGDBVersion(gdbVersion) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.changeGDBVersion(gdbVersion);
    }
    getAssociatedDataSource() {
        if (!this.isDataView && !this.isLocal) {
            return this.associatedDataSource;
        }
        const realAssoDsId = this._getRealAssociatedDataSourceId();
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().getDataSource(realAssoDsId);
    }
    getAssociatedDataSourceById(dsId) {
        return this.dataSourceManager.getDataSource(dsId).getAssociatedDataSource();
    }
    fixQueryOptions(options) {
        if (!options) {
            return;
        }
        if (options.excludeQuery) {
            this.fixExcludeQuery(options.excludeQuery);
        }
    }
    fixExcludeQuery(excludeQuery) {
        if ((excludeQuery === null || excludeQuery === void 0 ? void 0 : excludeQuery.dataSourceId) && this.getAssociatedDataSourceById(excludeQuery.dataSourceId)) {
            excludeQuery.dataSourceId = this.getAssociatedDataSourceById(excludeQuery.dataSourceId).id;
        }
    }
    _getRealAssociatedDataSourceId() {
        var _a;
        let realAssoDsId;
        const belongToAssoDs = (_a = this.belongToDataSource) === null || _a === void 0 ? void 0 : _a.getAssociatedDataSource();
        if (this.isLocal) {
            realAssoDsId = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().getLocalDataSourceId(belongToAssoDs === null || belongToAssoDs === void 0 ? void 0 : belongToAssoDs.id, this.localId);
        }
        else if (this.isDataView) {
            realAssoDsId = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().getDataViewDataSourceId(belongToAssoDs === null || belongToAssoDs === void 0 ? void 0 : belongToAssoDs.id, this.dataViewId);
        }
        else {
            realAssoDsId = this.associatedDataSource.id;
        }
        return realAssoDsId;
    }
    clearRecords() {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.clearRecords();
    }
    setRecords(records) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setRecords(records);
    }
    getRecords() {
        var _a, _b;
        return (_b = (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecords()) === null || _b === void 0 ? void 0 : _b.map(r => this.fixRecordDataSource(r));
    }
    setSourceRecords(records) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setSourceRecords(records);
    }
    getSourceRecords() {
        var _a, _b;
        return (_b = (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSourceRecords()) === null || _b === void 0 ? void 0 : _b.map(r => this.fixRecordDataSource(r));
    }
    fixRecordDataSource(r) {
        if (!r) {
            return null;
        }
        /**
         * Scene layer data source uses associated feature layer data source to do query.
         * If the feature record belongs to an associated feature layer data source, actually, it should belong to the scene layer data source.
         */
        const record = r.clone();
        record.dataSource = this;
        return record;
    }
    getSelectedRecords() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSelectedRecords();
    }
    nextRecord() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.nextRecord();
    }
    prevRecord() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.prevRecord();
    }
    getRecord(index) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecord(index);
    }
    getRecordById(id) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecordById(id);
    }
    clearRecordsNotAddVersion() {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.clearRecordsNotAddVersion();
    }
    clearSelection() {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.clearSelection();
    }
    addVersion() {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.addVersion();
    }
    selectRecord(index) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecord(index);
    }
    selectRecords(options, signal, progressCallback) {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecords(options);
    }
    selectRecordById(id, record) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecordById(id, record);
    }
    selectRecordsByIds(ids, records) {
        var _a;
        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecordsByIds(ids, records);
    }
    destroy() {
        const associatedDataSource = this.getAssociatedDataSource();
        if (associatedDataSource) {
            this.dataSourceManager.destroyDataSource(associatedDataSource.id);
        }
    }
    supportSymbol() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.supportSymbol(this);
    }
    supportAttachment() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.supportAttachment(this);
    }
    createJSAPILayerByDataSource() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.createJSAPILayerByDataSource(this);
        });
    }
    getDataViews() {
        return super.getDataViews();
    }
    getDataView(dataViewId) {
        return super.getDataView(dataViewId);
    }
    getMainDataSource() {
        return super.getMainDataSource();
    }
    _mergeAssociatedDataSourceJson(associatedDataSourceJson) {
        return associatedDataSourceJson === null || associatedDataSourceJson === void 0 ? void 0 : associatedDataSourceJson.set('query', this.getDataSourceJson().query).set('dataViews', this.getDataSourceJson().dataViews).set('schema', this.getDataSourceJson().schema);
    }
    get count() {
        var _a;
        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.count;
    }
    set count(count) {
        if (this.getAssociatedDataSource()) {
            this.getAssociatedDataSource().count = count;
        }
    }
    allowToExportData() {
        return __awaiter(this, void 0, void 0, function* () {
            const allowInDataSource = !this.getDataSourceJson().disableExport;
            return yield Promise.resolve(allowInDataSource);
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/scene-service-data-source-impl.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/scene-service-data-source-impl.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SceneServiceDataSourceImpl: () => (/* binding */ SceneServiceDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Data source from a scene service, which may contain multiple child data sources.
 */
class SceneServiceDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractLayerFolderDataSource {
    constructor() {
        super(...arguments);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceTypes.SceneService;
    }
    getChildIds() {
        return this.getChildIdsByUrl();
    }
    createChildDataSourceOptionsById(childDsId, jimuChildId, childId) {
        return this.createChildDataSourceOptionsByIdFromUrl(childDsId, jimuChildId, childId);
    }
    /**
     * If use Layer.fromArcGISServerUrl/Layer.fromPortalItem to create JS API layer for feature service, will return a feature layer if the feature service only contains one layer/table.
     * It causes the feature service data source returns a feature layer as its JS API layer, which is not expected.
     * So we overide the method to make sure feature service data source always returns a group layer.
    */
    createJSAPILayerByDataSource() {
        const _super = Object.create(null, {
            createJSAPILayerByDataSource: { get: () => super.createJSAPILayerByDataSource }
        });
        var _a, _b, _c, _d, _e, _f, _g;
        return __awaiter(this, void 0, void 0, function* () {
            let layer;
            try {
                if (!this.areChildDataSourcesCreated()) {
                    yield this.childDataSourcesReady();
                }
                const hasSingleLayer = ((_b = (_a = this.getItemInfo()) === null || _a === void 0 ? void 0 : _a.typeKeywords) === null || _b === void 0 ? void 0 : _b.includes('Singlelayer')) || ((_d = (_c = this.getServiceDefinition()) === null || _c === void 0 ? void 0 : _c.layers) === null || _d === void 0 ? void 0 : _d.length) === 1;
                if (hasSingleLayer) { // the original item/service only contains one layer
                    const childDss = this.getChildDataSources();
                    if (childDss.length === 0) { // failed to create child data sources for some reason
                        const [Layer, GroupLayer] = yield (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModules)(['esri/layers/Layer', 'esri/layers/GroupLayer']);
                        const childLayer = yield Layer.fromArcGISServerUrl({ url: `${this.url}/layers/${((_g = (_f = (_e = this.getServiceDefinition()) === null || _e === void 0 ? void 0 : _e.layers) === null || _f === void 0 ? void 0 : _f[0]) === null || _g === void 0 ? void 0 : _g.id) || 0}` });
                        layer = new GroupLayer({
                            layers: [childLayer],
                            title: this.getLabel()
                        });
                    }
                    else { // only has one child data source
                        const loadJSAPIGroupLayerPromise = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.loadArcGISJSAPIModule)('esri/layers/GroupLayer');
                        const createJSAPILayerForChildDsPromise = childDss[0].layer ? Promise.resolve(childDss[0].layer) : childDss[0].createJSAPILayerByDataSource();
                        const [GroupLayer, childLayer] = yield Promise.all([loadJSAPIGroupLayerPromise, createJSAPILayerForChildDsPromise]);
                        layer = new GroupLayer({
                            layers: [childLayer],
                            title: this.getLabel()
                        });
                    }
                }
                else { // the original item/service contains multiple layers
                    layer = (yield _super.createJSAPILayerByDataSource.call(this));
                }
            }
            catch (err) {
                console.error('Failed to create JS API layer. ', err, this.id);
            }
            return (layer === null || layer === void 0 ? void 0 : layer.type) === 'group' ? layer : null;
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/simple-local-data-source-impl.ts":
/*!*************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/simple-local-data-source-impl.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimpleLocalDataSourceImpl: () => (/* binding */ SimpleLocalDataSourceImpl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * @ignore
 */
class SimpleLocalDataSourceImpl extends _base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource {
    constructor() {
        super(...arguments);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_2__.DataSourceTypes.SimpleLocal;
    }
    updateRecoreds(records) {
        this.records = records;
        this.addVersion();
    }
    addRecord(record) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!record.getId()) {
                record.setId((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.uuidv1)());
            }
            this.records.push(record);
            this.addVersion();
            return yield Promise.resolve(record);
        });
    }
    updateRecord(record) {
        return __awaiter(this, void 0, void 0, function* () {
            const i = this.records.findIndex(r => r.getId() === record.getId());
            this.records.splice(i, 1, record);
            this.addVersion();
            return Promise.resolve(true);
        });
    }
    deleteRecord(index) {
        return __awaiter(this, void 0, void 0, function* () {
            this.records.splice(index, 1);
            this.addVersion();
            return yield Promise.resolve(true);
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/vector-tile-service-data-source-impl.ts":
/*!********************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/vector-tile-service-data-source-impl.ts ***!
  \********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   VectorTileServiceDataSourceImpl: () => (/* binding */ VectorTileServiceDataSourceImpl)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class VectorTileServiceDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.VectorTileService;
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/wfs-data-source-impl.ts":
/*!****************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/wfs-data-source-impl.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WFSDataSourceImpl: () => (/* binding */ WFSDataSourceImpl)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class WFSDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.WFS;
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/wms-data-source-impl.ts":
/*!****************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/wms-data-source-impl.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WMSDataSourceImpl: () => (/* binding */ WMSDataSourceImpl)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class WMSDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.WMS;
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/wmts-data-source-impl.ts":
/*!*****************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/wmts-data-source-impl.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WMTSDataSourceImpl: () => (/* binding */ WMTSDataSourceImpl)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class WMTSDataSourceImpl extends (0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.JSAPILayerMixinImpl)((0,_base_classes__WEBPACK_IMPORTED_MODULE_1__.ItemMixinImpl)(_base_classes__WEBPACK_IMPORTED_MODULE_1__.AbstractDataSource)) {
    constructor(options) {
        super(options);
        this.type = _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.WMTS;
        if (options.layer) {
            this.layer = options.layer;
        }
        const dsJson = this.getDataSourceJson();
        this.portalUrl = dsJson.portalUrl;
        this.itemId = dsJson.itemId;
    }
    ready() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.layer) {
                this.layer = (yield this.createJSAPILayerByDataSource());
            }
            yield this.layer.load();
            return Promise.resolve();
        });
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/index.ts":
/*!*********************************************!*\
  !*** ./jimu-core/lib/data-sources/index.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractDataRecord: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.AbstractDataRecord),
/* harmony export */   AbstractDataSource: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.AbstractDataSource),
/* harmony export */   AbstractLayerFolderDataSource: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.AbstractLayerFolderDataSource),
/* harmony export */   AbstractLoadableDataSource: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.AbstractLoadableDataSource),
/* harmony export */   AbstractQueriableDataSource: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.AbstractQueriableDataSource),
/* harmony export */   AbstractSetDataSource: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.AbstractSetDataSource),
/* harmony export */   AllDataSourceTypes: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.AllDataSourceTypes),
/* harmony export */   ArcGISDataSourceTypes: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.ArcGISDataSourceTypes),
/* harmony export */   CSVDataSourceImpl: () => (/* reexport safe */ _implementations_csv_data_source_impl__WEBPACK_IMPORTED_MODULE_2__.CSVDataSourceImpl),
/* harmony export */   DataSourceError: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceError),
/* harmony export */   DataSourceSelectionMode: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceSelectionMode),
/* harmony export */   DataSourceStatus: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceStatus),
/* harmony export */   DataSourceTypes: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes),
/* harmony export */   FeatureDataRecordImpl: () => (/* reexport safe */ _implementations_feature_record_impl__WEBPACK_IMPORTED_MODULE_1__.FeatureDataRecordImpl),
/* harmony export */   FeatureLayerDataSourceImpl: () => (/* reexport safe */ _implementations_feature_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_3__.FeatureLayerDataSourceImpl),
/* harmony export */   FeatureServiceDataSourceImpl: () => (/* reexport safe */ _implementations_feature_service_data_source_impl__WEBPACK_IMPORTED_MODULE_4__.FeatureServiceDataSourceImpl),
/* harmony export */   GroupLayerDataSourceImpl: () => (/* reexport safe */ _implementations_group_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_5__.GroupLayerDataSourceImpl),
/* harmony export */   ItemMixinImpl: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.ItemMixinImpl),
/* harmony export */   JSAPILayerMixinImpl: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.JSAPILayerMixinImpl),
/* harmony export */   JimuCoreDataSourceFactory: () => (/* binding */ JimuCoreDataSourceFactory),
/* harmony export */   MapServiceDataSourceImpl: () => (/* reexport safe */ _implementations_map_service_data_source_impl__WEBPACK_IMPORTED_MODULE_6__.MapServiceDataSourceImpl),
/* harmony export */   QueryScope: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.QueryScope),
/* harmony export */   SceneLayerDataSourceImpl: () => (/* reexport safe */ _implementations_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_9__.SceneLayerDataSourceImpl),
/* harmony export */   SceneServiceDataSourceImpl: () => (/* reexport safe */ _implementations_scene_service_data_source_impl__WEBPACK_IMPORTED_MODULE_8__.SceneServiceDataSourceImpl),
/* harmony export */   SimpleDataRecordImpl: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.SimpleDataRecordImpl),
/* harmony export */   SimpleDataRecordSetImpl: () => (/* reexport safe */ _base_classes__WEBPACK_IMPORTED_MODULE_22__.SimpleDataRecordSetImpl),
/* harmony export */   SimpleLocalDataSourceImpl: () => (/* reexport safe */ _implementations_simple_local_data_source_impl__WEBPACK_IMPORTED_MODULE_7__.SimpleLocalDataSourceImpl),
/* harmony export */   SupportedItemTypes: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.SupportedItemTypes),
/* harmony export */   SupportedJSAPILayerTypes: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.SupportedJSAPILayerTypes),
/* harmony export */   SupportedLayerServiceTypes: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.SupportedLayerServiceTypes),
/* harmony export */   SupportedLayerTypesInWebMapSpec: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.SupportedLayerTypesInWebMapSpec),
/* harmony export */   SupportedServerTypes: () => (/* reexport safe */ _interfaces__WEBPACK_IMPORTED_MODULE_0__.SupportedServerTypes),
/* harmony export */   dataSourceJsonCreator: () => (/* reexport module object */ _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_21__)
/* harmony export */ });
/* harmony import */ var _interfaces__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./interfaces */ "./jimu-core/lib/data-sources/interfaces/index.ts");
/* harmony import */ var _implementations_feature_record_impl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./implementations/feature-record-impl */ "./jimu-core/lib/data-sources/implementations/feature-record-impl.ts");
/* harmony import */ var _implementations_csv_data_source_impl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./implementations/csv-data-source-impl */ "./jimu-core/lib/data-sources/implementations/csv-data-source-impl.ts");
/* harmony import */ var _implementations_feature_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./implementations/feature-layer-data-source-impl */ "./jimu-core/lib/data-sources/implementations/feature-layer-data-source-impl.ts");
/* harmony import */ var _implementations_feature_service_data_source_impl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./implementations/feature-service-data-source-impl */ "./jimu-core/lib/data-sources/implementations/feature-service-data-source-impl.ts");
/* harmony import */ var _implementations_group_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./implementations/group-layer-data-source-impl */ "./jimu-core/lib/data-sources/implementations/group-layer-data-source-impl.ts");
/* harmony import */ var _implementations_map_service_data_source_impl__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./implementations/map-service-data-source-impl */ "./jimu-core/lib/data-sources/implementations/map-service-data-source-impl.ts");
/* harmony import */ var _implementations_simple_local_data_source_impl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./implementations/simple-local-data-source-impl */ "./jimu-core/lib/data-sources/implementations/simple-local-data-source-impl.ts");
/* harmony import */ var _implementations_scene_service_data_source_impl__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./implementations/scene-service-data-source-impl */ "./jimu-core/lib/data-sources/implementations/scene-service-data-source-impl.ts");
/* harmony import */ var _implementations_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./implementations/scene-layer-data-source-impl */ "./jimu-core/lib/data-sources/implementations/scene-layer-data-source-impl.ts");
/* harmony import */ var _implementations_image_service_data_source_impl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./implementations/image-service-data-source-impl */ "./jimu-core/lib/data-sources/implementations/image-service-data-source-impl.ts");
/* harmony import */ var _implementations_vector_tile_service_data_source_impl__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./implementations/vector-tile-service-data-source-impl */ "./jimu-core/lib/data-sources/implementations/vector-tile-service-data-source-impl.ts");
/* harmony import */ var _implementations_geojson_data_source_impl__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./implementations/geojson-data-source-impl */ "./jimu-core/lib/data-sources/implementations/geojson-data-source-impl.ts");
/* harmony import */ var _implementations_kml_data_source_impl__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./implementations/kml-data-source-impl */ "./jimu-core/lib/data-sources/implementations/kml-data-source-impl.ts");
/* harmony import */ var _implementations_wfs_data_source_impl__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./implementations/wfs-data-source-impl */ "./jimu-core/lib/data-sources/implementations/wfs-data-source-impl.ts");
/* harmony import */ var _implementations_wms_data_source_impl__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./implementations/wms-data-source-impl */ "./jimu-core/lib/data-sources/implementations/wms-data-source-impl.ts");
/* harmony import */ var _implementations_wmts_data_source_impl__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./implementations/wmts-data-source-impl */ "./jimu-core/lib/data-sources/implementations/wmts-data-source-impl.ts");
/* harmony import */ var _implementations_error_data_source_impl__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./implementations/error-data-source-impl */ "./jimu-core/lib/data-sources/implementations/error-data-source-impl.ts");
/* harmony import */ var _implementations_building_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./implementations/building-scene-layer-data-source-impl */ "./jimu-core/lib/data-sources/implementations/building-scene-layer-data-source-impl.ts");
/* harmony import */ var _implementations_building_component_sublayer_data_source_impl__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./implementations/building-component-sublayer-data-source-impl */ "./jimu-core/lib/data-sources/implementations/building-component-sublayer-data-source-impl.ts");
/* harmony import */ var _implementations_building_group_sublayer_data_source_impl__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./implementations/building-group-sublayer-data-source-impl */ "./jimu-core/lib/data-sources/implementations/building-group-sublayer-data-source-impl.ts");
/* harmony import */ var _support_data_source_json_creator__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./support/data-source-json-creator */ "./jimu-core/lib/data-sources/support/data-source-json-creator.ts");
/* harmony import */ var _base_classes__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./base-classes */ "./jimu-core/lib/data-sources/base-classes/index.ts");






















class JimuCoreDataSourceFactory {
    createDataSource(options) {
        var _a;
        const dsJson = (_a = options.dataSourceJson) !== null && _a !== void 0 ? _a : options.belongToDataSource.getMainDataSource().getDataSourceJson();
        const dsType = (options.dataViewId && dsJson.dataViews && dsJson.dataViews[options.dataViewId] ? dsJson.dataViews[options.dataViewId].type || dsJson.type : dsJson.type);
        switch (dsType) {
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.Error:
                return new _implementations_error_data_source_impl__WEBPACK_IMPORTED_MODULE_17__.ErrorDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.CSV:
                return new _implementations_csv_data_source_impl__WEBPACK_IMPORTED_MODULE_2__.CSVDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.FeatureLayer:
                return new _implementations_feature_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_3__.FeatureLayerDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.FeatureService:
                return new _implementations_feature_service_data_source_impl__WEBPACK_IMPORTED_MODULE_4__.FeatureServiceDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.GroupLayer:
                return new _implementations_group_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_5__.GroupLayerDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.MapService:
                return new _implementations_map_service_data_source_impl__WEBPACK_IMPORTED_MODULE_6__.MapServiceDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.SceneService:
                return new _implementations_scene_service_data_source_impl__WEBPACK_IMPORTED_MODULE_8__.SceneServiceDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.ImageService:
                return new _implementations_image_service_data_source_impl__WEBPACK_IMPORTED_MODULE_10__.ImageServiceDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.VectorTileService:
                return new _implementations_vector_tile_service_data_source_impl__WEBPACK_IMPORTED_MODULE_11__.VectorTileServiceDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.GeoJSON:
                return new _implementations_geojson_data_source_impl__WEBPACK_IMPORTED_MODULE_12__.GeoJSONDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.KML:
                return new _implementations_kml_data_source_impl__WEBPACK_IMPORTED_MODULE_13__.KMLDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.WFS:
                return new _implementations_wfs_data_source_impl__WEBPACK_IMPORTED_MODULE_14__.WFSDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.WMS:
                return new _implementations_wms_data_source_impl__WEBPACK_IMPORTED_MODULE_15__.WMSDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.WMTS:
                return new _implementations_wmts_data_source_impl__WEBPACK_IMPORTED_MODULE_16__.WMTSDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.SceneLayer:
                return new _implementations_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_9__.SceneLayerDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.SimpleLocal:
                return new _implementations_simple_local_data_source_impl__WEBPACK_IMPORTED_MODULE_7__.SimpleLocalDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.BuildingSceneLayer:
                return new _implementations_building_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_18__.BuildingSceneLayerDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.BuildingComponentSubLayer:
                return new _implementations_building_component_sublayer_data_source_impl__WEBPACK_IMPORTED_MODULE_19__.BuildingComponentSubLayerDataSourceImpl(options);
            case _interfaces__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes.BuildingGroupSubLayer:
                return new _implementations_building_group_sublayer_data_source_impl__WEBPACK_IMPORTED_MODULE_20__.BuildingGroupSubLayerDataSourceImpl(options);
            default:
                const exhaustiveCheck = dsType;
                throw new Error(`Unhandled case: ${exhaustiveCheck}`);
        }
    }
}





/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/common-data-source-interface.ts":
/*!*******************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/common-data-source-interface.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AllDataSourceTypes: () => (/* binding */ AllDataSourceTypes),
/* harmony export */   ArcGISDataSourceTypes: () => (/* binding */ ArcGISDataSourceTypes),
/* harmony export */   DataSourceError: () => (/* binding */ DataSourceError),
/* harmony export */   DataSourceSelectionMode: () => (/* binding */ DataSourceSelectionMode),
/* harmony export */   DataSourceStatus: () => (/* binding */ DataSourceStatus),
/* harmony export */   DataSourceTypes: () => (/* binding */ DataSourceTypes),
/* harmony export */   QueryScope: () => (/* binding */ QueryScope),
/* harmony export */   SupportedItemTypes: () => (/* binding */ SupportedItemTypes),
/* harmony export */   SupportedJSAPILayerTypes: () => (/* binding */ SupportedJSAPILayerTypes),
/* harmony export */   SupportedLayerServiceTypes: () => (/* binding */ SupportedLayerServiceTypes),
/* harmony export */   SupportedLayerTypesInWebMapSpec: () => (/* binding */ SupportedLayerTypesInWebMapSpec),
/* harmony export */   SupportedServerTypes: () => (/* binding */ SupportedServerTypes)
/* harmony export */ });
/**
 * All data source status is here, including data source instance status and data status (for QueriableDataSource).
 * * Instance status includes: NotCreated, Created, CreateError. <br/>
 *    When a data source is requested to be created, it is set to `NotCreated` at first.
 *    If a data source has never been used, there is no data source status.
 * * Data status includes: NotReady, Unloaded, Loading, Loaded, LoadError. <br/>
 *    When a QueriableDataSource is created, it is set as `NotReady` or `Unloaded` at first.
 *    If the data source is generated by widgets, the initial status will be `NotReady`, otherwise the initial status will be `Unloaded`.
 *    When widgets are ready to generate data, that is to say, the data source is ready to do query, widgets will change the status from `NotReady` to `Unloaded`.
 *    When widgets are not ready to generate data, widgets will change the status back to `NotReady`,
 *    then framework will help to clear source records, records and cache in data source instance.
 *    If `load()` is invoked, it will be set as `Loading`. If data is returned, it will be set as `Loaded`.
 *    If an error occurs, it will be set as `LoadError`.
 */
var DataSourceStatus;
(function (DataSourceStatus) {
    // Instance status.
    DataSourceStatus["NotCreated"] = "NOT_CREATED";
    DataSourceStatus["Created"] = "CREATED";
    DataSourceStatus["CreateError"] = "CREATE_ERROR";
    // Data status.
    /**
     * NotReady is for widget output data source only.
     * When output data source instance is created, the data is not ready for use.
     * Widget should dispatch an action (DataSourceStatusChanged) to make the data source ready for use.
     * If a data source status is not ready, the query should return an empty result.
     */
    DataSourceStatus["NotReady"] = "NOT_READY";
    DataSourceStatus["Unloaded"] = "UNLOADED";
    DataSourceStatus["Loading"] = "LOADING";
    DataSourceStatus["Loaded"] = "LOADED";
    DataSourceStatus["LoadError"] = "LOAD_ERROR";
    // Save status.
    /** @ignore */
    DataSourceStatus["Saving"] = "SAVING";
    /** @ignore */
    DataSourceStatus["Saved"] = "SAVED";
    /** @ignore */
    DataSourceStatus["SaveError"] = "SAVE_ERROR";
    // For remote push(stream) data sources.
    /** @ignore */
    DataSourceStatus["Closed"] = "CLOSED";
    /** @ignore */
    DataSourceStatus["Connecting"] = "CONNECTING";
    /** @ignore */
    DataSourceStatus["Connected"] = "CONNECTED";
    /** @ignore */
    DataSourceStatus["Closing"] = "CLOSING";
    // For client DS, we don't define status.
})(DataSourceStatus || (DataSourceStatus = {}));
/**
 * The data source types that `jimu-core` supports.
 */
var DataSourceTypes;
(function (DataSourceTypes) {
    DataSourceTypes["Error"] = "ERROR";
    /** @ignore */
    DataSourceTypes["SimpleLocal"] = "SIMPLE_LOCAL";
    /**
     * CSV data source is from a CSV file (.csv, .txt).
     * @ignore
     */
    DataSourceTypes["CSV"] = "CSV";
    /**
     * FeatureLayer data source is a `QueriableDataSource`, which is used to query ArcGIS feature service.
     * See {@link FeatureLayerDataSource}
     */
    DataSourceTypes["FeatureLayer"] = "FEATURE_LAYER";
    /**
     * See {@link SceneLayerDataSource}
     */
    DataSourceTypes["SceneLayer"] = "SCENE_LAYER";
    /**
     * GroupLayer data source is a data source set that may have child data sources. It is from group layer in a map service or a webmap/webscene.
     */
    DataSourceTypes["GroupLayer"] = "GROUP_LAYER";
    /**
     * FeatureService data source is a data source set that may have child data sources. It is from the feature service.
     */
    DataSourceTypes["FeatureService"] = "FEATURE_SERVICE";
    /**
     * MapService data source is a data source set that may have child data sources. It is from the map service.
     */
    DataSourceTypes["MapService"] = "MAP_SERVICE";
    /**
     * SceneService data source is a data source set that may have child data sources. It is from the scene service.
     */
    DataSourceTypes["SceneService"] = "SCENE_SERVICE";
    /**
     * ImageService data source is from the image service.
     * @ignore
     */
    DataSourceTypes["ImageService"] = "IMAGE_SERVICE";
    /**
     * VectorTileService data source is from the vector tile service.
     * @ignore
     */
    DataSourceTypes["VectorTileService"] = "VECTOR_TILE_SERVICE";
    /**
     * GeoJSONLayer data source is from a [GeoJSON](https://geojson.org/) file.
     * @ignore
     */
    DataSourceTypes["GeoJSON"] = "GEO_JSON";
    /**
     * KMLLayer data source is from a KML file (.kml, .kmz).
     * @ignore
     */
    DataSourceTypes["KML"] = "KML";
    /**
     * WFSLayer data source is from an OGC Web Feature Service (WFS).
     * @ignore
     */
    DataSourceTypes["WFS"] = "WFS";
    /**
     * WMSLayer data source is from an OGC Web Map Services (WMS).
     * @ignore
     */
    DataSourceTypes["WMS"] = "WMS";
    /**
     * @ignore
     * WMTSLayer data source is from an OGC Web Map Tile Services (WMTS).
     */
    DataSourceTypes["WMTS"] = "WMTS";
    DataSourceTypes["BuildingSceneLayer"] = "building-scene";
    DataSourceTypes["BuildingGroupSubLayer"] = "building-group";
    DataSourceTypes["BuildingComponentSubLayer"] = "building-component";
})(DataSourceTypes || (DataSourceTypes = {}));
/**
 * @ignore
 */
var ArcGISDataSourceTypes;
(function (ArcGISDataSourceTypes) {
    ArcGISDataSourceTypes["Map"] = "MAP";
    ArcGISDataSourceTypes["WebMap"] = "WEB_MAP";
    ArcGISDataSourceTypes["WebScene"] = "WEB_SCENE";
})(ArcGISDataSourceTypes || (ArcGISDataSourceTypes = {}));
/**
 * @ignore
 * All data source types, including types from jimu-core and jimu-arcgis.
 * The variable is only used as `value`, e.g. const types = [AllDataSourceTypes.WebMap].
 */
const AllDataSourceTypes = Object.assign(Object.assign({}, DataSourceTypes), ArcGISDataSourceTypes);
/**
 * For now, we only support some layer service types.
 * This type is used by adding data source by URL.
 */
var SupportedLayerServiceTypes;
(function (SupportedLayerServiceTypes) {
    // single layer service under map service or feature service
    SupportedLayerServiceTypes["FeatureLayer"] = "Feature Layer";
    SupportedLayerServiceTypes["Table"] = "Table";
    SupportedLayerServiceTypes["GroupLayer"] = "Group Layer";
    // single layer service under scene service
    SupportedLayerServiceTypes["SceneLayerPoint"] = "Point";
    SupportedLayerServiceTypes["SceneLayer3DObject"] = "3DObject";
    SupportedLayerServiceTypes["BuildingSceneLayer"] = "Building";
    SupportedLayerServiceTypes["BuildingGroupSubLayer"] = "building-group";
    SupportedLayerServiceTypes["BuildingComponentSubLayer"] = "building-component";
})(SupportedLayerServiceTypes || (SupportedLayerServiceTypes = {}));
/**
 * For now, we only support some service types.
 * This type is used by adding data source by URL.
 */
var SupportedServerTypes;
(function (SupportedServerTypes) {
    // [Feature Service](https://developers.arcgis.com/rest/services-reference/feature-service.htm)
    SupportedServerTypes["FeatureService"] = "FeatureServer";
    // [Map Service](https://developers.arcgis.com/rest/services-reference/hosted-map-service.htm)
    SupportedServerTypes["MapService"] = "MapServer";
    // [Scene Service](https://developers.arcgis.com/rest/services-reference/scene-service.htm)
    SupportedServerTypes["SceneService"] = "SceneServer";
    // [Image Service](https://developers.arcgis.com/rest/services-reference/image-service.htm)
    SupportedServerTypes["ImageService"] = "ImageServer";
    // [Vector Tile Service](https://developers.arcgis.com/rest/services-reference/vector-tile-service.htm)
    SupportedServerTypes["VectorTileService"] = "VectorTileServer";
})(SupportedServerTypes || (SupportedServerTypes = {}));
/**
 * For now, we only support some portal item types.
 * This type is used by adding data source by items.
 * Please see [Items and item types](https://developers.arcgis.com/rest/users-groups-and-items/items-and-item-types.htm).
 */
var SupportedItemTypes;
(function (SupportedItemTypes) {
    SupportedItemTypes["WebMap"] = "Web Map";
    SupportedItemTypes["WebScene"] = "Web Scene";
    SupportedItemTypes["FeatureService"] = "Feature Service";
    SupportedItemTypes["MapService"] = "Map Service";
    SupportedItemTypes["SceneService"] = "Scene Service";
    SupportedItemTypes["ImageService"] = "Image Service";
    SupportedItemTypes["VectorTileService"] = "Vector Tile Service";
    SupportedItemTypes["FeatureCollection"] = "Feature Collection";
    SupportedItemTypes["GroupLayer"] = "Group Layer";
    SupportedItemTypes["CSV"] = "CSV";
    SupportedItemTypes["GeoJSON"] = "GeoJson";
    SupportedItemTypes["KML"] = "KML";
    SupportedItemTypes["WFS"] = "WFS";
    SupportedItemTypes["WMS"] = "WMS";
    SupportedItemTypes["WMTS"] = "WMTS";
    SupportedItemTypes["GeometryService"] = "Geometry Service";
    SupportedItemTypes["GeocodingService"] = "Geocoding Service";
    SupportedItemTypes["GeoprocessingService"] = "Geoprocessing Service";
    SupportedItemTypes["NetworkAnalysisService"] = "Network Analysis Service";
    SupportedItemTypes["GeoenrichmentService"] = "Geoenrichment service";
})(SupportedItemTypes || (SupportedItemTypes = {}));
/**
 * For now, we only support some types of ArcGIS Maps SDK for JavaScript layer.
 * This type is used by adding data source by ArcGIS Maps SDK for JavaScript layer.
 * Please see [Layer](https://developers.arcgis.com/javascript/latest/api-reference/esri-layers-Layer.html).
 */
var SupportedJSAPILayerTypes;
(function (SupportedJSAPILayerTypes) {
    SupportedJSAPILayerTypes["FeatureLayer"] = "feature";
    SupportedJSAPILayerTypes["MapImageLayer"] = "map-image";
    SupportedJSAPILayerTypes["TileLayer"] = "tile";
    SupportedJSAPILayerTypes["GroupLayer"] = "group";
    SupportedJSAPILayerTypes["SceneLayer"] = "scene";
    SupportedJSAPILayerTypes["ImageryLayer"] = "imagery";
    SupportedJSAPILayerTypes["ImageryTileLayer"] = "imagery-tile";
    SupportedJSAPILayerTypes["VectorTileLayer"] = "vector-tile";
    SupportedJSAPILayerTypes["KMLLayer"] = "kml";
    SupportedJSAPILayerTypes["CSVLayer"] = "csv";
    SupportedJSAPILayerTypes["GeoJSONLayer"] = "geojson";
    SupportedJSAPILayerTypes["WFSLayer"] = "wfs";
    SupportedJSAPILayerTypes["WMSLayer"] = "wms";
    SupportedJSAPILayerTypes["WMTSLayer"] = "wmts";
    SupportedJSAPILayerTypes["BuildingSceneLayer"] = "building-scene";
    SupportedJSAPILayerTypes["BuildingComponentSubLayer"] = "building-component";
    SupportedJSAPILayerTypes["BuildingGroupSubLayer"] = "building-group";
})(SupportedJSAPILayerTypes || (SupportedJSAPILayerTypes = {}));
/**
 * For now, we only support some types of layers.
 * This type is used by adding data source by item data. For example, add data from group layer item, to create child data sources, we need to parse group layer item data.
 * Please see https://developers.arcgis.com/web-map-specification/objects/operationalLayers/ and https://developers.arcgis.com/web-scene-specification/objects/operationalLayers/.
 */
var SupportedLayerTypesInWebMapSpec;
(function (SupportedLayerTypesInWebMapSpec) {
    SupportedLayerTypesInWebMapSpec["FeatureLayer"] = "ArcGISFeatureLayer";
    SupportedLayerTypesInWebMapSpec["SceneLayer"] = "ArcGISSceneServiceLayer";
    SupportedLayerTypesInWebMapSpec["GroupLayer"] = "GroupLayer";
    SupportedLayerTypesInWebMapSpec["MapService"] = "ArcGISMapServiceLayer";
    SupportedLayerTypesInWebMapSpec["TiledMapService"] = "ArcGISTiledMapServiceLayer";
    SupportedLayerTypesInWebMapSpec["VectorTileService"] = "VectorTileLayer";
    SupportedLayerTypesInWebMapSpec["ImageService"] = "ArcGISImageServiceLayer";
    SupportedLayerTypesInWebMapSpec["TiledImageService"] = "ArcGISTiledImageServiceLayer";
    SupportedLayerTypesInWebMapSpec["CSV"] = "CSV";
    SupportedLayerTypesInWebMapSpec["GeoJSON"] = "GeoJSON";
    SupportedLayerTypesInWebMapSpec["KML"] = "KML";
    SupportedLayerTypesInWebMapSpec["WFS"] = "WFS";
    SupportedLayerTypesInWebMapSpec["WMS"] = "WMS";
})(SupportedLayerTypesInWebMapSpec || (SupportedLayerTypesInWebMapSpec = {}));
/**
 * @ignore
 */
class DataSourceError extends Error {
    constructor(id, message) {
        super(`data source id: ${id}, ${message}`);
        this.dataSourceId = id;
    }
}
/**
 * Query scope defines which data is returned when the query is executed in addition to the query parameters.
 */
var QueryScope;
(function (QueryScope) {
    /** Use the query parameters directly to query. */
    QueryScope["InAllData"] = "IN_ALL_DATA";
    /** Use the query parameters and the filters configured in exb to query. */
    QueryScope["InRemoteConfigView"] = "IN_REMOTE_CONFIG_VIEW";
    /** Use the query parameters and the configured filters in data source and filters configured in exb to query. */
    QueryScope["InConfigView"] = "IN_CONFIG_VIEW";
    /** Use all of the appliyed query parameters to query. */
    QueryScope["InRuntimeView"] = "IN_RUNTIME_VIEW";
})(QueryScope || (QueryScope = {}));
// #endregion Data source mixins
var DataSourceSelectionMode;
(function (DataSourceSelectionMode) {
    DataSourceSelectionMode["New"] = "New";
    DataSourceSelectionMode["AddToCurrent"] = "AddToCurrent";
    DataSourceSelectionMode["RemoveFromCurrent"] = "RemoveFromCurrent";
    DataSourceSelectionMode["SelectFromCurrent"] = "SelectFromCurrent";
})(DataSourceSelectionMode || (DataSourceSelectionMode = {}));


/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/feature-layer-data-source-interface.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/feature-layer-data-source-interface.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/feature-service-data-source-interface.ts":
/*!****************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/feature-service-data-source-interface.ts ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/group-layer-data-source-interface.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/group-layer-data-source-interface.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/index.ts":
/*!********************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/index.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AllDataSourceTypes: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.AllDataSourceTypes),
/* harmony export */   ArcGISDataSourceTypes: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.ArcGISDataSourceTypes),
/* harmony export */   DataSourceError: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.DataSourceError),
/* harmony export */   DataSourceSelectionMode: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.DataSourceSelectionMode),
/* harmony export */   DataSourceStatus: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.DataSourceStatus),
/* harmony export */   DataSourceTypes: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes),
/* harmony export */   QueryScope: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.QueryScope),
/* harmony export */   SupportedItemTypes: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.SupportedItemTypes),
/* harmony export */   SupportedJSAPILayerTypes: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.SupportedJSAPILayerTypes),
/* harmony export */   SupportedLayerServiceTypes: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.SupportedLayerServiceTypes),
/* harmony export */   SupportedLayerTypesInWebMapSpec: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.SupportedLayerTypesInWebMapSpec),
/* harmony export */   SupportedServerTypes: () => (/* reexport safe */ _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__.SupportedServerTypes)
/* harmony export */ });
/* harmony import */ var _common_data_source_interface__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/common-data-source-interface.ts");
/* harmony import */ var _feature_layer_data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./feature-layer-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/feature-layer-data-source-interface.ts");
/* harmony import */ var _scene_layer_data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./scene-layer-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/scene-layer-data-source-interface.ts");
/* harmony import */ var _group_layer_data_source_interface__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./group-layer-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/group-layer-data-source-interface.ts");
/* harmony import */ var _feature_service_data_source_interface__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./feature-service-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/feature-service-data-source-interface.ts");
/* harmony import */ var _scene_service_data_source_interface__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./scene-service-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/scene-service-data-source-interface.ts");
/* harmony import */ var _map_service_data_source_interface__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./map-service-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/map-service-data-source-interface.ts");









/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/map-service-data-source-interface.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/map-service-data-source-interface.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/scene-layer-data-source-interface.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/scene-layer-data-source-interface.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./jimu-core/lib/data-sources/interfaces/scene-service-data-source-interface.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/interfaces/scene-service-data-source-interface.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./jimu-core/lib/data-sources/support/capabilities-impl.ts":
/*!*****************************************************************!*\
  !*** ./jimu-core/lib/data-sources/support/capabilities-impl.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CapabilitiesImpl: () => (/* binding */ CapabilitiesImpl)
/* harmony export */ });
class CapabilitiesImpl {
    constructor(options) {
        Object.assign(this, options);
    }
    getQueryCapabilities() {
        return {
            maxPageSize: null
        };
    }
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/support/data-source-json-creator.ts":
/*!************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/support/data-source-json-creator.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   createDataSourceJson: () => (/* binding */ createDataSourceJson),
/* harmony export */   createDataSourceJsonByItemData: () => (/* binding */ createDataSourceJsonByItemData),
/* harmony export */   createDataSourceJsonByItemInfo: () => (/* binding */ createDataSourceJsonByItemInfo),
/* harmony export */   createDataSourceJsonByJSAPILayer: () => (/* binding */ createDataSourceJsonByJSAPILayer),
/* harmony export */   createDataSourceJsonByLayerDefinition: () => (/* binding */ createDataSourceJsonByLayerDefinition),
/* harmony export */   getDataSourceTypeFromArcGISWholeServiceUrl: () => (/* binding */ getDataSourceTypeFromArcGISWholeServiceUrl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../interfaces/common-data-source-interface */ "./jimu-core/lib/data-sources/interfaces/common-data-source-interface.ts");


function createDataSourceJson(dsId, layer, itemInfo, serviceInfo, dsJsonInConfig, schemaInConfig) {
    if (layer) {
        return createDataSourceJsonByJSAPILayer(dsId, layer, dsJsonInConfig, schemaInConfig);
    }
    else {
        let dsJsonFromItem;
        let dsJsonFromService;
        if (itemInfo.data) {
            dsJsonFromItem = createDataSourceJsonByItemData(dsId, itemInfo.data, itemInfo.portalUrl, dsJsonInConfig, schemaInConfig);
        }
        else if (itemInfo.item) {
            dsJsonFromItem = createDataSourceJsonByItemInfo(dsId, itemInfo.item, itemInfo.portalUrl, dsJsonInConfig, schemaInConfig);
        }
        if (serviceInfo) {
            dsJsonFromService = createDataSourceJsonByLayerDefinition(dsId, serviceInfo.layerDefinition, serviceInfo.url, dsJsonInConfig, schemaInConfig);
        }
        return dsJsonFromItem && dsJsonFromService ? dsJsonFromService.merge(dsJsonFromItem) : dsJsonFromItem || dsJsonFromService;
    }
}
function createDataSourceJsonByJSAPILayer(dsId, layer, dsJsonInConfig, schemaInConfig) {
    var _a, _b, _c, _d;
    if (!dsId || !layer) {
        return null;
    }
    let dsType;
    let layerId;
    let geometryType;
    // layer should be loaded.
    const layerType = layer.type;
    switch (layerType) {
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.GroupLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.GroupLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.FeatureLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.FeatureLayer;
            layerId = `${layer.layerId}`;
            geometryType = (_a = layer.sourceJSON) === null || _a === void 0 ? void 0 : _a.geometryType;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.SceneLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.SceneLayer;
            layerId = `${layer.layerId}`;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.MapImageLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.TileLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.MapService;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.BuildingSceneLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.BuildingSceneLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.BuildingGroupSubLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.BuildingGroupSubLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.BuildingComponentSubLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.BuildingComponentSubLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.ImageryLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.ImageryTileLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.VectorTileLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.KMLLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.CSVLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.GeoJSONLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.WFSLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.WMSLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedJSAPILayerTypes.WMTSLayer:
            break;
        default:
            const exhaustiveCheck = layerType;
            throw new Error(`Unhandled case: ${exhaustiveCheck}`);
    }
    let dsJson;
    if (dsType) {
        dsJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
            id: dsId,
            type: dsType,
            sourceLabel: layer.title || ((_b = layer.sourceJSON) === null || _b === void 0 ? void 0 : _b.name)
        });
        dsJson = layer.url ? dsJson.set('url', jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDataSourceSourceUrl(jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(layer))) : dsJson;
        dsJson = ((_c = layer.portalItem) === null || _c === void 0 ? void 0 : _c.id) ? dsJson.set('portalUrl', (_d = layer.portalItem.portal) === null || _d === void 0 ? void 0 : _d.url).set('itemId', layer.portalItem.id) : dsJson;
        dsJson = /^\d+$/.test(layerId) ? dsJson.set('layerId', layerId) : dsJson;
        dsJson = geometryType ? dsJson.set('geometryType', geometryType) : dsJson;
        dsJson = dsJsonInConfig ? dsJson.merge(dsJsonInConfig.without('id'), { deep: true }) : dsJson;
        dsJson = schemaInConfig ? dsJson.set('schema', schemaInConfig) : dsJson;
    }
    return dsJson;
}
/**
 * Generally, we only use this method to get raw data source json to get data source type and label.
 * Item info misses some information such as geometry type.
 */
function createDataSourceJsonByItemInfo(dsId, item, portalUrl, dsJsonInConfig, schemaInConfig) {
    var _a, _b, _c, _d, _e;
    if (!dsId || !item) {
        return null;
    }
    let dsType;
    let layerId;
    let url;
    const itemType = item.type;
    switch (itemType) {
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.WebMap:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.WebScene:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.CSV:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.GeoJSON:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.KML:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.WFS:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.WMS:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.WMTS:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.GroupLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes[findKey(_interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes, itemType)];
            url = (_a = item.url) === null || _a === void 0 ? void 0 : _a.replace(/^http:/, 'https:').replace(/\/$/, '');
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.FeatureCollection:
            if ((_b = item.typeKeywords) === null || _b === void 0 ? void 0 : _b.includes('Singlelayer')) {
                dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.FeatureLayer;
                layerId = '0';
            }
            else {
                dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.GroupLayer;
            }
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.FeatureService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.MapService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.SceneService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.ImageService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.VectorTileService:
            if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isSupportedWholeArcGISService(item.url)) {
                dsType = getDataSourceTypeFromArcGISWholeServiceUrl(item.url);
            }
            else if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isSupportedSingleArcGISLayerService(item.url)) {
                const serviceUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFullArcGISServiceUrl(item.url, false);
                const serviceDsType = getDataSourceTypeFromArcGISWholeServiceUrl(serviceUrl);
                if (serviceDsType === _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.FeatureService || serviceDsType === _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.MapService) {
                    dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.FeatureLayer;
                }
                else if (serviceDsType === _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.SceneService) {
                    dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.SceneLayer;
                }
                layerId = dsType && ((_c = item.url) === null || _c === void 0 ? void 0 : _c.replace(/\/$/, '').split('/').reverse()[0]);
            }
            // url of vector tile service may be a style json or a vector tile service, should not replace url queries (string after '?').
            url = dsType === _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.VectorTileService ? (_d = item.url) === null || _d === void 0 ? void 0 : _d.replace(/^http:/, 'https:').replace(/\/$/, '') : (_e = item.url) === null || _e === void 0 ? void 0 : _e.split('?')[0].replace(/^http:/, 'https:').replace(/\/$/, '');
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.GeocodingService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.GeoenrichmentService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.GeometryService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.GeoprocessingService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedItemTypes.NetworkAnalysisService:
            break;
        default:
            const exhaustiveCheck = itemType;
            throw new Error(`Unhandled case: ${exhaustiveCheck}`);
    }
    let dsJson;
    if (dsType) {
        dsJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
            id: dsId,
            type: dsType,
            sourceLabel: item.title
        });
        dsJson = dsJson.set('itemId', item.id);
        dsJson = dsJson.set('portalUrl', portalUrl);
        dsJson = /^\d+$/.test(layerId) ? dsJson.set('layerId', layerId) : dsJson;
        dsJson = url ? dsJson.set('url', url) : dsJson;
        dsJson = dsJsonInConfig ? dsJson.merge(dsJsonInConfig.without('id'), { deep: true }) : dsJson;
        dsJson = schemaInConfig ? dsJson.set('schema', schemaInConfig) : dsJson;
    }
    return dsJson;
}
function createDataSourceJsonByItemData(dsId, itemData, portalUrl, dsJsonInConfig, schemaInConfig) {
    var _a;
    if (!dsId || !itemData) {
        return null;
    }
    let dsType;
    let layerId;
    // General item data doesn't have a specific interface, but the layers we supported does, we assume the item data is the type which we support.
    const data = itemData;
    const itemType = data.layerType;
    switch (itemType) {
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.FeatureLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.SceneLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes[findKey(_interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec, itemType)];
            layerId = (_a = data.url) === null || _a === void 0 ? void 0 : _a.replace(/\/$/, '').split('/').reverse()[0];
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.GroupLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.MapService:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes[findKey(_interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec, itemType)];
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.TiledMapService:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.MapService;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.VectorTileService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.ImageService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.TiledImageService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.CSV:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.GeoJSON:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.KML:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.WFS:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerTypesInWebMapSpec.WMS:
            break;
        default:
            const exhaustiveCheck = itemType;
            throw new Error(`Unhandled case: ${exhaustiveCheck}`);
    }
    let dsJson;
    if (dsType) {
        dsJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
            id: dsId,
            type: dsType,
            sourceLabel: data.title
        });
        dsJson = dsJson.set('itemId', data.itemId);
        dsJson = dsJson.set('portalUrl', portalUrl);
        dsJson = /^\d+$/.test(layerId) ? dsJson.set('layerId', layerId) : dsJson;
        dsJson = data.url ? dsJson.set('url', data.url.replace(/^http:/, 'https:').replace(/\/$/, '')) : dsJson;
        dsJson = dsJsonInConfig ? dsJson.merge(dsJsonInConfig.without('id'), { deep: true }) : dsJson;
        dsJson = schemaInConfig ? dsJson.set('schema', schemaInConfig) : dsJson;
    }
    return dsJson;
}
function createDataSourceJsonByLayerDefinition(dsId, layerDefinition, url, dsJsonInConfig, schemaInConfig) {
    if (!dsId || !layerDefinition) {
        return null;
    }
    const layerUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFullArcGISServiceUrl(url, true, layerDefinition);
    const layerSourceUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getDataSourceSourceUrl(layerUrl);
    let dsJson;
    if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isSupportedWholeArcGISService(layerSourceUrl)) {
        dsJson = createDataSourceJsonByWholeServiceDefinition(dsId, layerSourceUrl, layerDefinition);
    }
    else if (!layerSourceUrl || jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isSupportedSingleArcGISLayerService(layerSourceUrl)) { // Feature collection item does not have url but has layer defnition (via item data).
        dsJson = createDataSourceJsonBySingleLayerDefinition(dsId, layerSourceUrl, layerDefinition);
    }
    dsJson = dsJsonInConfig && dsJson ? dsJson.merge(dsJsonInConfig.without('id'), { deep: true }) : dsJson;
    dsJson = schemaInConfig && dsJson ? dsJson.set('schema', schemaInConfig) : dsJson;
    return dsJson;
}
function getDataSourceTypeFromArcGISWholeServiceUrl(url) {
    if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.isSupportedWholeArcGISService(url)) {
        return null;
    }
    const urlArray = url.split('?')[0].split('/');
    const serviceType = Object.values(_interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedServerTypes).find(s => urlArray.some(u => s.toLowerCase() === u.toLowerCase()));
    let dsType;
    switch (serviceType) {
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedServerTypes.FeatureService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedServerTypes.MapService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedServerTypes.SceneService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedServerTypes.ImageService:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedServerTypes.VectorTileService:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes[findKey(_interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedServerTypes, serviceType)];
            break;
        default:
            const exhaustiveCheck = serviceType;
            throw new Error(`Unhandled case: ${exhaustiveCheck}`);
    }
    return dsType;
}
function createDataSourceJsonByWholeServiceDefinition(dsId, url, serviceDefinition) {
    if (!dsId || !url || !serviceDefinition) {
        return null;
    }
    const type = getDataSourceTypeFromArcGISWholeServiceUrl(url);
    if (!type) {
        return null;
    }
    const dsJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
        id: dsId,
        type,
        url: jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFullArcGISServiceUrl(url, false),
        sourceLabel: jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getLabelFromArcGISServiceUrl(url)
    });
    return dsJson;
}
function createDataSourceJsonBySingleLayerDefinition(dsId, url, layerDefinition) {
    if (!dsId || !layerDefinition) {
        return null;
    }
    let dsType;
    const layerType = (layerDefinition.type || layerDefinition.layerType);
    switch (layerType) {
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.GroupLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.GroupLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.FeatureLayer:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.Table:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.FeatureLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.SceneLayer3DObject:
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.SceneLayerPoint:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.SceneLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.BuildingSceneLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.BuildingSceneLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.BuildingGroupSubLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.BuildingGroupSubLayer;
            break;
        case _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.SupportedLayerServiceTypes.BuildingComponentSubLayer:
            dsType = _interfaces_common_data_source_interface__WEBPACK_IMPORTED_MODULE_1__.AllDataSourceTypes.BuildingComponentSubLayer;
            break;
        default:
            const exhaustiveCheck = layerType;
            throw new Error(`Unhandled case: ${exhaustiveCheck}`);
    }
    let dsJson;
    if (dsType) {
        dsJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
            id: dsId,
            type: dsType,
            sourceLabel: layerDefinition.name
        });
        dsJson = url ? dsJson.set('url', jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getFullArcGISServiceUrl(url, true, layerDefinition)) : dsJson;
        dsJson = /^\d+$/.test(`${layerDefinition.id}`) ? dsJson.set('layerId', `${layerDefinition.id}`) : dsJson;
        dsJson = layerDefinition.geometryType ? dsJson.set('geometryType', layerDefinition.geometryType) : dsJson;
    }
    return dsJson;
}
function findKey(obj, value) {
    var _a;
    return (_a = Object.entries(obj).find(([k, v]) => v === value)) === null || _a === void 0 ? void 0 : _a[0];
}


/***/ }),

/***/ "./jimu-core/lib/data-sources/support/feature-layer-capabilities-impl.ts":
/*!*******************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/support/feature-layer-capabilities-impl.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FeatureLayerCapabilitiesImpl: () => (/* binding */ FeatureLayerCapabilitiesImpl)
/* harmony export */ });
/* harmony import */ var _capabilities_impl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./capabilities-impl */ "./jimu-core/lib/data-sources/support/capabilities-impl.ts");

const QueryCapabilitiesOfClientSideFeatureLayer = {
    maxPageSize: 1000,
    supportsStatistics: true,
    supportsPagination: true,
    supportsOrderBy: true,
    supportsDistinct: true,
    /**
     * Support pagination with distinct.
     */
    supportsPaginationOnDistinct: true,
    /**
     * Do not support pagination with statistic with group by.
     * Will ignore the pagination and always return all results.
     */
    supportsPaginationOnStatisticsWithGroupBy: false,
    supportsPaginationOnAggregatedQueries: true,
    supportsOrderByOnlyOnLayerFields: true,
    supportsPercentileStatistics: true,
    supportedQueryFormats: 'JSON, geoJSON'
};
class FeatureLayerCapabilitiesImpl extends _capabilities_impl__WEBPACK_IMPORTED_MODULE_0__.CapabilitiesImpl {
    getQueryCapabilities() {
        var _a, _b, _c, _d, _e, _f, _g, _h;
        if (this.isClientSide || !this.layerDefinition) {
            return QueryCapabilitiesOfClientSideFeatureLayer;
        }
        else {
            return {
                maxPageSize: this.layerDefinition.maxRecordCount,
                supportsStatistics: !!((_a = this.layerDefinition.advancedQueryCapabilities) === null || _a === void 0 ? void 0 : _a.supportsStatistics),
                supportsPagination: !!((_b = this.layerDefinition.advancedQueryCapabilities) === null || _b === void 0 ? void 0 : _b.supportsPagination),
                supportsOrderBy: !!((_c = this.layerDefinition.advancedQueryCapabilities) === null || _c === void 0 ? void 0 : _c.supportsOrderBy),
                supportsDistinct: !!((_d = this.layerDefinition.advancedQueryCapabilities) === null || _d === void 0 ? void 0 : _d.supportsDistinct),
                /**
                 * undefined will be regarded as true since some services do not have this capability but support to use pagination with distinct.
                 */
                // eslint-disable-next-line
                supportsPaginationOnDistinct: ((_e = this.layerDefinition.advancedQueryCapabilities) === null || _e === void 0 ? void 0 : _e.supportsPaginationOnAggregatedQueries) !== false,
                supportsPaginationOnStatisticsWithGroupBy: !!((_f = this.layerDefinition.advancedQueryCapabilities) === null || _f === void 0 ? void 0 : _f.supportsPaginationOnAggregatedQueries),
                supportsOrderByOnlyOnLayerFields: !!((_g = this.layerDefinition.advancedQueryCapabilities) === null || _g === void 0 ? void 0 : _g.supportsOrderByOnlyOnLayerFields),
                supportsPercentileStatistics: !!((_h = this.layerDefinition.advancedQueryCapabilities) === null || _h === void 0 ? void 0 : _h.supportsPercentileStatistics),
                supportedQueryFormats: this.layerDefinition.supportedQueryFormats
            };
        }
    }
}


/***/ }),

/***/ "jimu-core":
/*!****************************!*\
  !*** external "jimu-core" ***!
  \****************************/
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_core__;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************************!*\
  !*** ./jimu-core/data-source.ts ***!
  \**********************************/
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbstractDataRecord: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.AbstractDataRecord),
/* harmony export */   AbstractDataSource: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.AbstractDataSource),
/* harmony export */   AbstractLayerFolderDataSource: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.AbstractLayerFolderDataSource),
/* harmony export */   AbstractLoadableDataSource: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.AbstractLoadableDataSource),
/* harmony export */   AbstractQueriableDataSource: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.AbstractQueriableDataSource),
/* harmony export */   AbstractSetDataSource: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.AbstractSetDataSource),
/* harmony export */   AllDataSourceTypes: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.AllDataSourceTypes),
/* harmony export */   ArcGISDataSourceTypes: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.ArcGISDataSourceTypes),
/* harmony export */   CSVDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.CSVDataSourceImpl),
/* harmony export */   DataSourceError: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.DataSourceError),
/* harmony export */   DataSourceSelectionMode: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.DataSourceSelectionMode),
/* harmony export */   DataSourceStatus: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.DataSourceStatus),
/* harmony export */   DataSourceTypes: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.DataSourceTypes),
/* harmony export */   FeatureDataRecordImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.FeatureDataRecordImpl),
/* harmony export */   FeatureLayerDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.FeatureLayerDataSourceImpl),
/* harmony export */   FeatureServiceDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.FeatureServiceDataSourceImpl),
/* harmony export */   GroupLayerDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.GroupLayerDataSourceImpl),
/* harmony export */   ItemMixinImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.ItemMixinImpl),
/* harmony export */   JSAPILayerMixinImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.JSAPILayerMixinImpl),
/* harmony export */   JimuCoreDataSourceFactory: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.JimuCoreDataSourceFactory),
/* harmony export */   MapServiceDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.MapServiceDataSourceImpl),
/* harmony export */   QueryScope: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.QueryScope),
/* harmony export */   SceneLayerDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SceneLayerDataSourceImpl),
/* harmony export */   SceneServiceDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SceneServiceDataSourceImpl),
/* harmony export */   SimpleDataRecordImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SimpleDataRecordImpl),
/* harmony export */   SimpleDataRecordSetImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SimpleDataRecordSetImpl),
/* harmony export */   SimpleLocalDataSourceImpl: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SimpleLocalDataSourceImpl),
/* harmony export */   SupportedItemTypes: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SupportedItemTypes),
/* harmony export */   SupportedJSAPILayerTypes: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SupportedJSAPILayerTypes),
/* harmony export */   SupportedLayerServiceTypes: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SupportedLayerServiceTypes),
/* harmony export */   SupportedLayerTypesInWebMapSpec: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SupportedLayerTypesInWebMapSpec),
/* harmony export */   SupportedServerTypes: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.SupportedServerTypes),
/* harmony export */   dataSourceJsonCreator: () => (/* reexport safe */ _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.dataSourceJsonCreator),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./lib/data-sources */ "./jimu-core/lib/data-sources/index.ts");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_lib_data_sources__WEBPACK_IMPORTED_MODULE_0__.JimuCoreDataSourceFactory);


})();

/******/ 	return __webpack_exports__;
/******/ })()

			);
		}
	};
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUF1RCxpQkFBaUI7V0FDeEU7V0FDQSxnREFBZ0QsYUFBYTtXQUM3RDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDTjhEO0FBRTlELGlFQUFlLHdFQUF5QjtBQUVOIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2Jhc2UtY2xhc3Nlcy9hYnN0cmFjdC1kYXRhLXNvdXJjZS50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvYmFzZS1jbGFzc2VzL2Fic3RyYWN0LWxheWVyLWZvbGRlci1kYXRhLXNvdXJjZS50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvYmFzZS1jbGFzc2VzL2Fic3RyYWN0LWxvYWRhYmxlLWRhdGEtc291cmNlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9iYXNlLWNsYXNzZXMvYWJzdHJhY3QtcXVlcmlhYmxlLWRhdGEtc291cmNlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9iYXNlLWNsYXNzZXMvYWJzdHJhY3Qtc2V0LWRhdGEtc291cmNlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9iYXNlLWNsYXNzZXMvZGF0YS1yZWNvcmQudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2Jhc2UtY2xhc3Nlcy9pbmRleC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvYmFzZS1jbGFzc2VzL2l0ZW0tbWl4aW4udHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2Jhc2UtY2xhc3Nlcy9qcy1hcGktbGF5ZXItbWl4aW4udHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9idWlsZGluZy1jb21wb25lbnQtc3VibGF5ZXItZGF0YS1zb3VyY2UtaW1wbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL2J1aWxkaW5nLWdyb3VwLXN1YmxheWVyLWRhdGEtc291cmNlLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9idWlsZGluZy1zY2VuZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvY3N2LWRhdGEtc291cmNlLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9lcnJvci1kYXRhLXNvdXJjZS1pbXBsLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1yZWNvcmQtaW1wbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL2ZlYXR1cmUtc2VydmljZS1kYXRhLXNvdXJjZS1pbXBsLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZ2VvanNvbi1kYXRhLXNvdXJjZS1pbXBsLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZ3JvdXAtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL2ltYWdlLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL2ttbC1kYXRhLXNvdXJjZS1pbXBsLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvbWFwLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL3NjZW5lLWxheWVyLWRhdGEtc291cmNlLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9zY2VuZS1zZXJ2aWNlLWRhdGEtc291cmNlLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9zaW1wbGUtbG9jYWwtZGF0YS1zb3VyY2UtaW1wbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL3ZlY3Rvci10aWxlLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL3dmcy1kYXRhLXNvdXJjZS1pbXBsLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvd21zLWRhdGEtc291cmNlLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy93bXRzLWRhdGEtc291cmNlLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2luZGV4LnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbnRlcmZhY2VzL2NvbW1vbi1kYXRhLXNvdXJjZS1pbnRlcmZhY2UudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ludGVyZmFjZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL3N1cHBvcnQvY2FwYWJpbGl0aWVzLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL3N1cHBvcnQvZGF0YS1zb3VyY2UtanNvbi1jcmVhdG9yLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9zdXBwb3J0L2ZlYXR1cmUtbGF5ZXItY2FwYWJpbGl0aWVzLWltcGwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC9leHRlcm5hbCBzeXN0ZW0gXCJqaW11LWNvcmVcIiIsIndlYnBhY2s6Ly9leGItY2xpZW50L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2V4Yi1jbGllbnQvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2V4Yi1jbGllbnQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9leGItY2xpZW50L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9kYXRhLXNvdXJjZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICB0eXBlIERhdGFTb3VyY2VNYW5hZ2VyLCBnZXRBcHBTdG9yZSwgVXJsTWFuYWdlciwgdHlwZSBJTURhdGFTb3VyY2VKc29uLCB0eXBlIElNRGF0YVNvdXJjZVNjaGVtYSwgdHlwZSBJTVJldmVyc2VkRGF0YVNvdXJjZVNjaGVtYSwgdHlwZSBSZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEsIHR5cGUgSU1EYXRhU291cmNlSW5mbywgSW1tdXRhYmxlLFxuICBhcHBBY3Rpb25zLCBkYXRhU291cmNlVXRpbHMsIHR5cGUgRGF0YVNvdXJjZUpzb24sIENPTlNUQU5UUywgdHlwZSBJbW11dGFibGVBcnJheSwgbG9kYXNoLCB0eXBlIElNV2lkZ2V0SnNvbiwgdHlwZSBJTU1lc3NhZ2VBY3Rpb25Kc29uLCBpMThuLCB0eXBlIElNRGF0YVZpZXdKc29uLCB0eXBlIEltbXV0YWJsZU9iamVjdFxufSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIEdlb21ldHJ5VHlwZSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXR5cGVzJ1xuaW1wb3J0IHsgdHlwZSBEYXRhU291cmNlLCB0eXBlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIHR5cGUgRGF0YVJlY29yZCwgRGF0YVNvdXJjZVN0YXR1cywgdHlwZSBTZWxlY3RPcHRpb25zLCB0eXBlIFF1ZXJ5UmVzdWx0LCB0eXBlIFVzZWRGaWVsZHNPcHRpb25zIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IFNpbXBsZURhdGFSZWNvcmRJbXBsIH0gZnJvbSAnLi9kYXRhLXJlY29yZCdcblxuLyoqXG4gKiBJbmNsdWRlIHRoZSBjb21tb24gaW1wbGVtZW50YXRpb25zIGZvciBkYXRhc291cmNlLlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3REYXRhU291cmNlIGltcGxlbWVudHMgRGF0YVNvdXJjZSB7XG4gIGlkOiBzdHJpbmdcbiAgdHlwZTogc3RyaW5nXG4gIGRhdGFTb3VyY2VNYW5hZ2VyOiBEYXRhU291cmNlTWFuYWdlclxuICBpc0RhdGFTb3VyY2VTZXQ6IGJvb2xlYW4gPSBmYWxzZVxuICBwYXJlbnREYXRhU291cmNlOiBEYXRhU291cmNlXG4gIGppbXVDaGlsZElkOiBzdHJpbmdcbiAgb3JkZXI6IG51bWJlclxuXG4gIGRhdGFWaWV3SWQ6IHN0cmluZ1xuICBsb2NhbElkOiBzdHJpbmdcbiAgaXNEYXRhVmlldzogYm9vbGVhblxuICBiZWxvbmdUb0RhdGFTb3VyY2U6IERhdGFTb3VyY2VcbiAgaXNMb2NhbDogYm9vbGVhblxuXG4gIHByaXZhdGUgZmV0Y2hlZFNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hXG4gIHByaXZhdGUgc2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWFcbiAgcHJpdmF0ZSByZXZlcnNlU2NoZW1hOiBJTVJldmVyc2VkRGF0YVNvdXJjZVNjaGVtYVxuXG4gIHByaXZhdGUgZGF0YVNvdXJjZUpzb246IElNRGF0YVNvdXJjZUpzb25cbiAgcHJpdmF0ZSByZWFkb25seSBvcmlnaW5EYXRhU291cmNlSnNvbjogSU1EYXRhU291cmNlSnNvbiAvLyBkYXRhIHNvdXJjZSBqc29uIHBhc3NlZCBpbiBjb25zdHJ1Y3RvciB3aGVuIHRoZSBkYXRhIHNvdXJjZSBpcyBjcmVhdGluZy5cblxuICBwcml2YXRlIF91cmw6IHN0cmluZ1xuICAvKipcbiAgICogamltdU5hbWUgb2Ygc2VsZWN0ZWQgZmllbGRzLCB0aGUgZmllbGRzIGFyZSBjb25maWd1cmVkIGluIHRoZSB3aWRnZXRzIHdoaWNoIGdlbmVyYXRlIG91dHB1dCBkYXRhIHNvdXJjZXMuXG4gICAqL1xuICBwcml2YXRlIHNlbGVjdGVkRmllbGRzOiBzdHJpbmdbXVxuICAvKipcbiAgICogV2hldGhlciBsaXN0ZW4gc2VsZWN0ZWQgcmVjb3JkcyBjaGFuZ2VzIGZyb20gb3RoZXIgZGF0YSBzb3VyY2VzIHdoaWNoIGFyZSBkZXJpdmVkIGZyb20gdGhlIHNhbWUgbWFpbiBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHByaXZhdGUgbGlzdGVuU2VsZWN0aW9uOiBib29sZWFuXG4gIC8qKlxuICAgKiBGaWVsZHMgbG9hZCBvbiBkZW1hbmQuIEZvciBleGFtcGxlLCBvdXQgZmllbGRzIGluIHF1ZXJ5IHBhcmFtcy5cbiAgICogSXQgbWF5IGJlIGNhdXNlZCBieSBzb21lIHdpZGdldHMgdXNlIGZpZWxkcyBidXQgbm90IHNhdmUgdGhlbSB0byB0aGUgdXNlIGRhdGEgc291cmNlIG9mIHdpZGdldCBjb25maWcuXG4gICAqL1xuICBwcm90ZWN0ZWQgbG9hZE9uRGVtYW5kRmllbGRzOiBzdHJpbmdbXSB8ICcqJ1xuXG4gIHByb3RlY3RlZCByZWNvcmRzOiBEYXRhUmVjb3JkW10gPSBbXVxuICBwcm90ZWN0ZWQgc291cmNlUmVjb3Jkcz86IERhdGFSZWNvcmRbXVxuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zOiBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgdGhpcy5kYXRhU291cmNlTWFuYWdlciA9IG9wdGlvbnMuZGF0YVNvdXJjZU1hbmFnZXJcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpXG4gICAgdGhpcy5vcmlnaW5EYXRhU291cmNlSnNvbiA9IG9wdGlvbnMuZGF0YVNvdXJjZUpzb25cblxuICAgIGlmIChvcHRpb25zLmRhdGFTb3VyY2VKc29uKSB7IC8vIG1haW4gZGF0YSBzb3VyY2VcbiAgICAgIHRoaXMuaXNEYXRhVmlldyA9IGZhbHNlXG4gICAgICB0aGlzLmlzTG9jYWwgPSBmYWxzZVxuICAgICAgaWYgKG9wdGlvbnMuZGF0YVNvdXJjZUpzb24udXJsKSB7XG4gICAgICAgIHRoaXMudXJsID0gb3B0aW9ucy5kYXRhU291cmNlSnNvbi51cmxcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFvcHRpb25zLmJlbG9uZ1RvRGF0YVNvdXJjZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdiYWQgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucy4nKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMubG9jYWxJZCkge1xuICAgICAgICB0aGlzLmlzTG9jYWwgPSB0cnVlXG4gICAgICAgIHRoaXMuaXNEYXRhVmlldyA9IGZhbHNlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmlzTG9jYWwgPSBmYWxzZVxuICAgICAgICB0aGlzLmlzRGF0YVZpZXcgPSB0cnVlXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSkgeyAvLyBVc2Ugc291cmNlIHJlY29yZHMgYXMgc291cmNlLlxuICAgICAgdGhpcy5zb3VyY2VSZWNvcmRzID0gb3B0aW9ucy5zb3VyY2VSZWNvcmRzXG4gICAgICAvLyBSZXNldCBvdGhlciBzb3VyY2VzIGluZm8uXG4gICAgICB0aGlzLnVybCA9IG51bGxcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0xvY2FsKSB7XG4gICAgICB0aGlzLmxpc3RlblNlbGVjdGlvbiA9IGZhbHNlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGlzdGVuU2VsZWN0aW9uID0gdHJ1ZVxuICAgIH1cbiAgfVxuXG4gIHJlYWR5ICgpOiBQcm9taXNlPHZvaWQgfCBhbnk+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcbiAgfVxuXG4gIGdldCB1cmwgKCk6IHN0cmluZyB7XG4gICAgaWYgKCFkYXRhU291cmNlVXRpbHMuZ2V0V2hldGhlclVzZVByb3h5KCkpIHtcbiAgICAgIHJldHVybiB0aGlzLl91cmxcbiAgICB9XG4gICAgY29uc3QgcHJveHlVcmw6IHN0cmluZyA9IGRhdGFTb3VyY2VVdGlscy5nZXREYXRhU291cmNlUHJveHlVcmwodGhpcy5fdXJsKVxuICAgIHJldHVybiBwcm94eVVybCB8fCB0aGlzLl91cmxcbiAgfVxuXG4gIHNldCB1cmwgKHU6IHN0cmluZykge1xuICAgIHRoaXMuX3VybCA9IHVcbiAgfVxuXG4gIGlzSW5BcHBDb25maWcgKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhIWdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBDb25maWcuZGF0YVNvdXJjZXM/Llt0aGlzLmdldFJvb3REYXRhU291cmNlKCk/LmlkIHx8IHRoaXMuaWRdXG4gIH1cblxuICBnZXRMYWJlbCAoKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gdGhpcy5iZWxvbmdUb0RhdGFTb3VyY2UuZ2V0TGFiZWwoKVxuICAgIH1cblxuICAgIGlmICh0aGlzLmlzRGF0YVZpZXcpIHtcbiAgICAgIGlmICh0aGlzLmRhdGFWaWV3SWQgPT09IENPTlNUQU5UUy5PVVRQVVRfREFUQV9WSUVXX0lEICYmIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc091dHB1dEZyb21XaWRnZXQpIHtcbiAgICAgICAgcmV0dXJuIGkxOG4uZ2V0SW50bCgpLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ291dHB1dFZpZXcnIH0sIHsgZGF0YVNvdXJjZUxhYmVsOiB0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZS5nZXRMYWJlbCgpIH0pXG4gICAgICB9XG4gICAgICBjb25zdCBtYWluRHNKc29uID0gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFTb3VyY2VKc29uKClcbiAgICAgIGNvbnN0IGRhdGFWaWV3SnNvbiA9IG1haW5Ec0pzb24/LmRhdGFWaWV3cyAmJiBtYWluRHNKc29uLmRhdGFWaWV3c1t0aGlzLmRhdGFWaWV3SWRdXG4gICAgICByZXR1cm4gZGF0YVZpZXdKc29uPy5sYWJlbCB8fCB0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZS5nZXRMYWJlbCgpXG4gICAgfVxuXG4gICAgY29uc3QgbWFpbkRhdGFTb3VyY2VMYWJlbCA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5sYWJlbCB8fCB0aGlzLmdldFNjaGVtYSgpLmxhYmVsXG4gICAgcmV0dXJuIG1haW5EYXRhU291cmNlTGFiZWxcbiAgfVxuXG4gIGdldERhdGFTb3VyY2VKc29uICgpOiBJTURhdGFTb3VyY2VKc29uIHtcbiAgICBpZiAodGhpcy5pc0RhdGFWaWV3IHx8IHRoaXMuaXNMb2NhbCkge1xuICAgICAgbGV0IGRzSnNvbiA9IHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXREYXRhU291cmNlSnNvbigpXG4gICAgICBpZiAodGhpcy5kYXRhVmlld0lkID09PSBDT05TVEFOVFMuU0VMRUNUSU9OX0RBVEFfVklFV19JRCkge1xuICAgICAgICBkc0pzb24gPSBkc0pzb24uc2V0KCdpc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZScsIHRydWUpXG4gICAgICB9XG4gICAgICByZXR1cm4gZHNKc29uXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmRhdGFTb3VyY2VKc29uXG4gIH1cblxuICBzZXREYXRhU291cmNlSnNvbiAoZHNKc29uOiBJTURhdGFTb3VyY2VKc29uKSB7XG4gICAgaWYgKCFkc0pzb24pIHtcbiAgICAgIHRoaXMuZGF0YVNvdXJjZUpzb24gPSB0aGlzLm9yaWdpbkRhdGFTb3VyY2VKc29uIC8vIHJlc2V0IGRhdGEgc291cmNlIGpzb25cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGFTb3VyY2VKc29uKSB7XG4gICAgICB0aGlzLmRhdGFTb3VyY2VKc29uID0gdGhpcy50cmF2ZXJzZVRvTWVyZ2VEYXRhU291cmNlSnNvbih0aGlzLmRhdGFTb3VyY2VKc29uLCBkc0pzb24pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGF0YVNvdXJjZUpzb24gPSBkc0pzb25cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHRyYXZlcnNlVG9NZXJnZURhdGFTb3VyY2VKc29uIChiYXNlRHNKc29uOiBJTURhdGFTb3VyY2VKc29uLCBuZXdEc0pzb246IElNRGF0YVNvdXJjZUpzb24pOiBJTURhdGFTb3VyY2VKc29uIHtcbiAgICBpZiAoIWJhc2VEc0pzb24gJiYgIW5ld0RzSnNvbikge1xuICAgICAgY29uc29sZS5lcnJvcignQ2FuIG5vdCBtZXJnZSBkYXRhIHNvdXJjZSBqc29uIHNpbmNlIGRvIG5vdCBoYXZlIGJhc2UgZGF0YSBzb3VyY2UganNvbiBvciBuZXcgZGF0YSBzb3VyY2UganNvbi4nKVxuICAgICAgcmV0dXJuIEltbXV0YWJsZSh7fSkgYXMgSU1EYXRhU291cmNlSnNvblxuICAgIH0gZWxzZSBpZiAoIWJhc2VEc0pzb24pIHtcbiAgICAgIHJldHVybiBuZXdEc0pzb25cbiAgICB9IGVsc2UgaWYgKCFuZXdEc0pzb24pIHtcbiAgICAgIHJldHVybiBiYXNlRHNKc29uXG4gICAgfVxuICAgIGNvbnN0IGN1cnJlbnREcyA9IHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVNvdXJjZShiYXNlRHNKc29uLmlkKVxuICAgIGlmICghY3VycmVudERzKSB7XG4gICAgICByZXR1cm4gYmFzZURzSnNvblxuICAgIH1cblxuICAgIGxldCBtZXJnZWREc0pzb24gPSBiYXNlRHNKc29uLm1lcmdlKG5ld0RzSnNvbi5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pKVxuXG4gICAgLyoqXG4gICAgICogVGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzIGFyZSBlZGl0YWJsZSBwcm9wZXJ0aWVzIGluIGRhdGEgc291cmNlIGpzb24uXG4gICAgICogT3RoZXIgcHJvcGVydGllcyBpbiBkYXRhIHNvdXJjZSBqc29uIGFyZSBub3QgYWxsb3dlZCB0byBiZSBjaGFuZ2VkLiBDaGFuZ2luZyB0aGVtIG1heSBicmVhayBkYXRhIHNvdXJjZS5cbiAgICAgKi9cbiAgICBjb25zdCBlZGl0YWJsZVByb3BlcnRpZXNJbkRzSnNvbjogQXJyYXk8UGFydGlhbDxrZXlvZiBEYXRhU291cmNlSnNvbj4+ID0gWydsYWJlbCcsICdpc0hpZGRlbicsICd1c2VGaWVsZHMnLCAncXVlcnknLCAnZGF0YVZpZXdzJywgJ2NoaWxkRGF0YVNvdXJjZUpzb25zJywgJ3NjaGVtYScsICd1cmwnLCAnaXRlbUlkJywgJ3BvcnRhbFVybCddXG4gICAgZWRpdGFibGVQcm9wZXJ0aWVzSW5Ec0pzb24uZm9yRWFjaChrZXkgPT4ge1xuICAgICAgLy8gSWYgb25lIGVkaXRhYmxlIHByb3BlcnR5IGlzIGRlbGV0ZWQgaW4gbmV3IGRhdGEgc291cmNlIGpzb24sIHNob3VsZCBkZWxldGUgaXQgZnJvbSB0aGUgbWVyZ2VkIGRhdGEgc291cmNlIGpzb24uXG4gICAgICBpZiAoIW5ld0RzSnNvbltrZXldKSB7XG4gICAgICAgIG1lcmdlZERzSnNvbiA9IG1lcmdlZERzSnNvbi53aXRob3V0KGtleSlcbiAgICAgIH1cblxuICAgICAgLy8gSWYgc2NoZW1hIGlzIHVwZGF0ZWQgaW4gbmV3IGRhdGEgc291cmNlIGpzb24sIHVzZSB0aGUgbmV3IHNjaGVtYS5cbiAgICAgIGlmIChuZXdEc0pzb25ba2V5XSAmJiBrZXkgPT09ICdzY2hlbWEnKSB7XG4gICAgICAgIG1lcmdlZERzSnNvbiA9IG1lcmdlZERzSnNvbi5zZXQoJ3NjaGVtYScsIG5ld0RzSnNvbi5zY2hlbWEpXG4gICAgICB9XG5cbiAgICAgIC8vIElmIEFHT0wvcG9ydGFsIGluZm8gaXMgdXBkYXRlZCBpbiBuZXcgZGF0YSBzb3VyY2UganNvbiwgdXBkYXRlIHRoZSBhY2Nyb2RpbmdseSBpbmZvIGluIHRoZSBjdXJyZW50IGRhdGEgc291cmNlLlxuICAgICAgaWYgKG5ld0RzSnNvbltrZXldICYmIChrZXkgPT09ICd1cmwnIHx8IGtleSA9PT0gJ3BvcnRhbFVybCcgfHwga2V5ID09PSAnaXRlbUlkJykpIHtcbiAgICAgICAgbWVyZ2VkRHNKc29uID0gbWVyZ2VkRHNKc29uLnNldChrZXksIG5ld0RzSnNvbltrZXldKVxuICAgICAgICBjdXJyZW50RHNba2V5XSA9IG5ld0RzSnNvbltrZXldXG4gICAgICAgIGlmIChjdXJyZW50RHMuY2FuU2F2ZVNvdXJjZVJlY29yZHMoKSkge1xuICAgICAgICAgIGN1cnJlbnREcy5nZXRBbGxEZXJpdmVkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKGRzID0+IHtcbiAgICAgICAgICAgIGRzW2tleV0gPSBuZXdEc0pzb25ba2V5XVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gSWYgdGhlcmUgYXJlIHNvbWUgZmllbGRzIHVzZWQgaW4gcHJldmlvdXMgZGF0YSBzb3VyY2UganNvbiwgc2hvdWxkIGNvcHkgdGhlbSB0byB0aGUgbWVyZ2VkIGRhdGEgc291cmNlIGpzb24uXG4gICAgICBpZiAoYmFzZURzSnNvbltrZXldICYmIGtleSA9PT0gJ3VzZUZpZWxkcycpIHtcbiAgICAgICAgLy8gSWYgc2NoZW1hIGlzIHVwZGF0ZWQsIG9ubHkgY29weSBjb25zaXN0YW50IGZpZWxkcyB0byB0aGUgbWVyZ2VkIGRhdGEgc291cmNlIGpzb24uXG4gICAgICAgIGlmIChuZXdEc0pzb24uc2NoZW1hKSB7XG4gICAgICAgICAgbWVyZ2VkRHNKc29uID0gbWVyZ2VkRHNKc29uLnNldCgndXNlRmllbGRzJywgYmFzZURzSnNvbi51c2VGaWVsZHMuZmlsdGVyKGppbXVOYW1lID0+ICEhbmV3RHNKc29uLnNjaGVtYS5maWVsZHM/LltqaW11TmFtZV0pKVxuICAgICAgICB9IGVsc2UgeyAvLyBJZiBzY2hlbWEga2VlcHMgdGhlIHNhbWUsIGNvcHkgYWxsIGZpZWxkcyB0byB0aGUgbWVyZ2VkIGRhdGEgc291cmNlIGpzb24uXG4gICAgICAgICAgbWVyZ2VkRHNKc29uID0gbWVyZ2VkRHNKc29uLnNldCgndXNlRmllbGRzJywgYmFzZURzSnNvbi51c2VGaWVsZHMpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgaWYgKG1lcmdlZERzSnNvbi5jaGlsZERhdGFTb3VyY2VKc29ucykge1xuICAgICAgT2JqZWN0LmtleXMobWVyZ2VkRHNKc29uLmNoaWxkRGF0YVNvdXJjZUpzb25zKS5mb3JFYWNoKGppbXVDaGlsZElkID0+IHtcbiAgICAgICAgY29uc3QgbWVyZ2VkQ2hpbGREc0pzb24gPSAoY3VycmVudERzIGFzIHRoaXMpLnRyYXZlcnNlVG9NZXJnZURhdGFTb3VyY2VKc29uKGJhc2VEc0pzb24/LmNoaWxkRGF0YVNvdXJjZUpzb25zPy5bamltdUNoaWxkSWRdLCBuZXdEc0pzb24uY2hpbGREYXRhU291cmNlSnNvbnNbamltdUNoaWxkSWRdKVxuICAgICAgICBtZXJnZWREc0pzb24gPSBtZXJnZWREc0pzb24uc2V0SW4oWydjaGlsZERhdGFTb3VyY2VKc29ucycsIGppbXVDaGlsZElkXSwgbWVyZ2VkQ2hpbGREc0pzb24pXG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiBtZXJnZWREc0pzb25cbiAgfVxuXG4gIGdldFNjaGVtYSAoKTogSU1EYXRhU291cmNlU2NoZW1hIHtcbiAgICAvLyBkYXRhIHZpZXcgZG9lcyBub3QgaGF2ZSBzY2hlbWFcbiAgICBpZiAodGhpcy5pc0RhdGFWaWV3IHx8IHRoaXMuaXNMb2NhbCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRTY2hlbWEoKVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zY2hlbWEgfHwge30gYXMgYW55XG4gIH1cblxuICBnZXRTZWxlY3RlZEZpZWxkcyAoKTogc3RyaW5nW10ge1xuICAgIGxldCBvdXRGaWVsZHM6IEltbXV0YWJsZUFycmF5PHN0cmluZz5cbiAgICBpZiAodGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gdGhpcy5iZWxvbmdUb0RhdGFTb3VyY2UuZ2V0U2VsZWN0ZWRGaWVsZHMoKVxuICAgIH1cblxuICAgIGlmICh0aGlzLmlzU2VsZWN0aW9uVmlldygpIHx8IHRoaXMuZGF0YVZpZXdJZCA9PT0gQ09OU1RBTlRTLk9VVFBVVF9EQVRBX1ZJRVdfSUQpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0U2VsZWN0ZWRGaWVsZHMoKVxuICAgIH1cblxuICAgIGNvbnN0IGFsbEZpZWxkcyA9IHRoaXMuZ2V0U2NoZW1hKCk/LmZpZWxkcyA/IE9iamVjdC5rZXlzKHRoaXMuZ2V0U2NoZW1hKCkuZmllbGRzKSA6IFtdXG4gICAgaWYgKHRoaXMuaXNEYXRhVmlldykge1xuICAgICAgb3V0RmllbGRzID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmRhdGFWaWV3cz8uW3RoaXMuZGF0YVZpZXdJZF0/Lm91dEZpZWxkc1xuICAgIH0gZWxzZSB7XG4gICAgICBvdXRGaWVsZHMgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkucXVlcnk/Lm91dEZpZWxkc1xuICAgIH1cbiAgICBpZiAoIW91dEZpZWxkcyAmJiAhdGhpcy5zZWxlY3RlZEZpZWxkcykge1xuICAgICAgcmV0dXJuIGFsbEZpZWxkc1xuICAgIH1cblxuICAgIGxldCByZWFsU2VsZWN0ZWRGaWVsZHMgPSBhbGxGaWVsZHNcbiAgICBpZiAob3V0RmllbGRzKSB7XG4gICAgICByZWFsU2VsZWN0ZWRGaWVsZHMgPSByZWFsU2VsZWN0ZWRGaWVsZHMuZmlsdGVyKGZOYW1lID0+IG91dEZpZWxkcy5pbmNsdWRlcyhmTmFtZSkpXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRGaWVsZHMpIHtcbiAgICAgIHJlYWxTZWxlY3RlZEZpZWxkcyA9IHJlYWxTZWxlY3RlZEZpZWxkcy5maWx0ZXIoZk5hbWUgPT4gdGhpcy5zZWxlY3RlZEZpZWxkcy5pbmNsdWRlcyhmTmFtZSkpXG4gICAgfVxuXG4gICAgLy8gZmllbGRzIG11c3QgaW4gb3V0RmllbGRzLCBhdCB0aGUgc2FtZSB0aW1lLCBpbiBzZWxlY3RlZEZpZWxkc1xuICAgIHJldHVybiByZWFsU2VsZWN0ZWRGaWVsZHNcbiAgfVxuXG4gIC8vIFJldHVybiB1c2VkIGZpbGxlZHMgc2F2ZWQgaW4gY29uZmlnIGFuZCBmaWVsZHMgbG9hZCBvbiBkZW1hbmQuXG4gIGdldEFsbFVzZWRGaWVsZHMgKG9wdGlvbnM/OiBVc2VkRmllbGRzT3B0aW9ucyk6IHN0cmluZ1tdIHwgJyonIHtcbiAgICBsZXQgdXNlZEZpZWxkczogc3RyaW5nW10gfCAnKidcbiAgICBpZiAodGhpcy5nZXRMb2FkT25EZW1hbmRVc2VkRmllbGRzKCkgPT09ICcqJykge1xuICAgICAgdXNlZEZpZWxkcyA9IHRoaXMuZ2V0TG9hZE9uRGVtYW5kVXNlZEZpZWxkcyhvcHRpb25zKVxuICAgIH0gZWxzZSB7XG4gICAgICB1c2VkRmllbGRzID0gdGhpcy5tZXJnZVVzZWRGaWVsZHModGhpcy5nZXRMb2FkT25EZW1hbmRVc2VkRmllbGRzKG9wdGlvbnMpLCB0aGlzLmdldENvbmZpZ1VzZWRGaWVsZHMob3B0aW9ucykpXG4gICAgfVxuICAgIGlmIChvcHRpb25zPy5sb2dMZXZlbCA9PT0gJ2RlYnVnJyAmJiB1c2VkRmllbGRzID09PSAnKicpIHtcbiAgICAgIGNvbnNvbGUud2FybignQWxsIHVzZWQgZmllbGRzIGFyZSAqIHNpbmNlIHVzZWQgZmllbGRzIGxlbmd0aCBlcXVhbHMgc2NoZW1hIGZpZWxkcyBsZW5ndGguJylcbiAgICB9XG4gICAgcmV0dXJuIHVzZWRGaWVsZHNcbiAgfVxuXG4gIF9wcmludFVzZWRGaWVsZHNEZXRhaWwgKG9wdGlvbnM/OiBVc2VkRmllbGRzT3B0aW9ucykge1xuICAgIHRoaXMuZ2V0QWxsVXNlZEZpZWxkcyh7IGxvZ0xldmVsOiAnZGVidWcnLCBleGNsdWRlV2lkZ2V0c0RvTm90VXNlRHNUb1F1ZXJ5OiB0cnVlLCAuLi5vcHRpb25zIH0pXG4gIH1cblxuICAvLyBSZXR1cm4gdXNlZCBmaWVsZHMgbG9hZCBvbiBkZW1hbmQuXG4gIGdldExvYWRPbkRlbWFuZFVzZWRGaWVsZHMgKG9wdGlvbnM/OiBVc2VkRmllbGRzT3B0aW9ucyk6IHN0cmluZ1tdIHwgJyonIHtcbiAgICBpZiAob3B0aW9ucz8ubG9nTGV2ZWwgPT09ICdkZWJ1ZycpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdMb2FkIG9uIGRlbWFuZCBmaWVsZHMgYXJlOicsIHRoaXMubG9hZE9uRGVtYW5kRmllbGRzKVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5sb2FkT25EZW1hbmRGaWVsZHNcbiAgfVxuXG4gIC8vIFJldHVybiB1c2VkIGZpZWxkcyBzYXZlZCBpbiBjb25maWcuXG4gIGdldENvbmZpZ1VzZWRGaWVsZHMgKG9wdGlvbnM/OiBVc2VkRmllbGRzT3B0aW9ucyk6IHN0cmluZ1tdIHwgJyonIHtcbiAgICAvKipcbiAgICAgKiBXaWRnZXRzIGRvbid0IHNhdmUgdXNlZCBmaWVsZHMgb2YgbG9jYWwgZGF0YSBzb3VyY2UuIFdpZGdldHMgY2FuIHVzZSBxdWVyeSBwYXJhbXMgdG8gaW5kaWNhdGUgd2hpY2ggZmllbGRzIHNob3VsZCBiZSBsb2FkZWQuXG4gICAgICpcbiAgICAgKiBUT0RPOiB3aWRnZXQgZG9lc24ndCBzYXZlIHVzZWQgZmllbGRzIG9mIGxvY2FsIGRhdGEgc291cmNlLCB3aGljaCB3aWxsIGNhdXNlIHRoYXQgbG9jYWwgZGF0YSBzb3VyY2VzIG1heSBub3Qgd29yayBhZnRlciBkYXRhIG1hcHBpbmcuXG4gICAgICovXG4gICAgaWYgKHRoaXMuaXNMb2NhbCkge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuXG4gICAgLy8gVXNlZCBmaWVsZHMgb2Ygbm9fc2VsZWN0aW9uIHZpZXcgc2hvdWxkIGJlIHRoZSBzYW1lIGFzIHNlbGVjdGlvbiB2aWV3LlxuICAgIGlmICh0aGlzLmRhdGFWaWV3SWQgPT09IENPTlNUQU5UUy5EQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTikge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXREYXRhVmlldyhDT05TVEFOVFMuU0VMRUNUSU9OX0RBVEFfVklFV19JRCk/LmdldEFsbFVzZWRGaWVsZHMoKVxuICAgIH1cblxuICAgIGlmIChvcHRpb25zPy5sb2dMZXZlbCA9PT0gJ2RlYnVnJykge1xuICAgICAgY29uc29sZS5ncm91cCgnQ29uZmlnIHVzZWQgZmllbGRzJylcbiAgICB9XG5cbiAgICBjb25zdCB3aWRnZXRzID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbmZpZz8ud2lkZ2V0c1xuICAgIGNvbnN0IG1lc3NhZ2VzID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbmZpZz8ubWVzc2FnZUNvbmZpZ3NcbiAgICBsZXQgYWN0aW9uc0FycjogSU1NZXNzYWdlQWN0aW9uSnNvbltdID0gW11cbiAgICBtZXNzYWdlcyAmJiBPYmplY3QudmFsdWVzKG1lc3NhZ2VzKS5mb3JFYWNoKG0gPT4ge1xuICAgICAgaWYgKG0uYWN0aW9ucykge1xuICAgICAgICBhY3Rpb25zQXJyID0gYWN0aW9uc0Fyci5jb25jYXQobS5hY3Rpb25zLmFzTXV0YWJsZT8uKCkpXG4gICAgICB9XG4gICAgfSlcbiAgICBjb25zdCB3aWRnZXRzQXJyOiBJTVdpZGdldEpzb25bXSA9IHdpZGdldHMgPyBPYmplY3QudmFsdWVzKHdpZGdldHMpIDogW11cbiAgICBjb25zdCBqc29uc1dpdGhVc2VEc3M6IEFycmF5PElNTWVzc2FnZUFjdGlvbkpzb24gfCBJTVdpZGdldEpzb24+ID0gd2lkZ2V0c0Fyci5jb25jYXQoYWN0aW9uc0FyciBhcyBhbnkpXG4gICAgY29uc3QgdXNlZEZpZWxkczogc3RyaW5nW10gPSBbXVxuICAgIGpzb25zV2l0aFVzZURzcy5ldmVyeSh3ID0+IHtcbiAgICAgIC8vIFdoZXRoZXIgc2hvdWxkIGV4Y2x1ZGUgdGhlIHdpZGdldCBiYXNlZCBvbiBvcHRpb25zIGFuZCB3aWRnZXQgcHJvcGVydGllcy5cbiAgICAgIGNvbnN0IGV4Y2x1ZGVUaGVXaWRnZXRGb3JDdXJyZW50RHMgPSBvcHRpb25zPy5leGNsdWRlV2lkZ2V0c0RvTm90VXNlRHNUb1F1ZXJ5ICYmICh3IGFzIElNV2lkZ2V0SnNvbikubWFuaWZlc3Q/LnByb3BlcnRpZXM/Lm5vdEF1dG9Mb2FkVXNlZEZpZWxkc0RhdGFcbiAgICAgIHcudXNlRGF0YVNvdXJjZXMgJiYgdy51c2VEYXRhU291cmNlcy5ldmVyeSh1ID0+IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNraXAgdGhlIHVzZSBkYXRhIHNvdXJjZSBpZiBpdCBpcyBub3Qgc2VsZWN0aW9uIHZpZXcgb2YgdGhlIGN1cnJlbnQgZGF0YSBzb3VyY2UgYW5kIHNob3VsZCBleGNsdWRlIHRoZSB3aWRnZXQuXG4gICAgICAgICAqIFRoZSByZWFzb24gd2h5IHdvbid0IHNraXAgdGhlIHVzZSBkYXRhIHNvdXJjZSBpZiBpdCBpcyBzZWxlY3Rpb24gdmlldyBpcyB0aGF0IHNlbGVjdGlvbiB2aWV3IHVzZXMgY2xpZW50LXNpZGUgcXVlcnksIGl0IG5lZWRzIGl0cyBtYWluIGRhdGEgc291cmNlL2RhdGEgdmlld3MgdG8gbG9hZCBpdHMgdXNlZCBmaWVsZHMgZnJvbSByZW1vdGUgZGF0YWJhc2UuXG4gICAgICAgICAqL1xuICAgICAgICBpZiAodT8uZGF0YVNvdXJjZUlkICE9PSB0aGlzLmdldFNlbGVjdGlvbkRhdGFWaWV3KCk/LmlkICYmIGV4Y2x1ZGVUaGVXaWRnZXRGb3JDdXJyZW50RHMpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZXNlIHVzZWQgZmllbGRzIHNob3VsZCBiZSBsb2FkZWQ6XG4gICAgICAgICAqIDEuIHVzZWQgZmllbGRzIG9mIGN1cnJlbnQgZGF0YSBzb3VyY2Ugc2hvdWxkIGJlIGxvYWRlZCxcbiAgICAgICAgICogMi4gdXNlZCBmaWVsZHMgb2YgY3VycmVudCBkYXRhIHNvdXJjZSdzIHNlbGVjdGlvbiB2aWV3IHNob3VsZCBiZSBsb2FkZWQsXG4gICAgICAgICAqIDMuIGlmIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgc2VsZWN0aW9uIHZpZXcsIHVzZWQgZmllbGRzIG9mIGFsbCBkYXRhIHNvdXJjZXMgd2hpY2ggYXJlIGRlcml2ZWQgZnJvbSB0aGUgc2FtZSBtYWluIGRhdGEgc291cmNlIHNob3VsZCBiZSBsb2FkZWQsXG4gICAgICAgICAqIDQuIGlmIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgb3V0cHV0IGRhdGEgc291cmNlIGFuZCBzY2hlbWEgaXMgc2FtZSBhcyBpdHMgb3JpZ2luIGRhdGEgc291cmNlLCB1c2VkIGZpZWxkcyBvZiBpdHMgb3JpZ2luIGRhdGEgc291cmNlIHNob3VsZCBiZSBsb2FkZWQsXG4gICAgICAgICAqIDUuIGlmIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgdGhlIGFzc29jaWF0ZWQgZGF0YSBzb3VyY2Ugb2YgZGF0YSBzb3VyY2UgQSAsIHVzZSBmaWVsZHMgb2YgZGF0YSBzb3VyY2UgQSBzaG91bGQgYmUgbG9hZGVkLlxuICAgICAgICAgKlxuICAgICAgICAgKiAyIGlzIHRvIHJlZHVjZSByZXF1ZXN0cywgbG9hZCBtb3JlIGZpZWxkcyBmb3Igc2VsZWN0aW9uIHZpZXcgdG8gdXNlLlxuICAgICAgICAgKiAzIGlzIGZvciBleHByZXNzaW9uLCB3aWRnZXQgY2FuIHNlbGVjdCBhIGRhdGEgdmlldyAvIG1haW4gZGF0YSwgYnV0IHVzZSBpdHMgc2VsZWN0aW9uIHZpZXcgdG8gY3JlYXRlIGV4cHJlc3Npb24uXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCB1c2VDdXJyZW50RGF0YVNvdXJjZSA9IHU/LmRhdGFTb3VyY2VJZCA9PT0gdGhpcy5pZFxuICAgICAgICBjb25zdCB1c2VTZWxlY3Rpb25WaWV3T2ZDdXJyZW50RGF0YVNvdXJjZSA9IHU/LmRhdGFTb3VyY2VJZCA9PT0gdGhpcy5nZXRTZWxlY3Rpb25EYXRhVmlldygpPy5pZFxuICAgICAgICBjb25zdCB1c2VPdGhlclZpZXdzRGVyaXZlZEZyb21TYW1lTWFpbkRzV2l0aFNlbGVjdGlvblZpZXcgPSB0aGlzLmlzU2VsZWN0aW9uVmlldygpICYmIHU/Lm1haW5EYXRhU291cmNlSWQgPT09IHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5pZFxuICAgICAgICBjb25zdCB1c2VPcmlnaW5EYXRhU291cmNlID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmlzT3V0cHV0RnJvbVdpZGdldCAmJiAhdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnNjaGVtYSAmJiB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkub3JpZ2luRGF0YVNvdXJjZXM/Lmxlbmd0aCA9PT0gMSAmJiB1Py5kYXRhU291cmNlSWQgPT09IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5vcmlnaW5EYXRhU291cmNlc1swXS5kYXRhU291cmNlSWRcbiAgICAgICAgY29uc3QgdXNlQXNzb2NpYXRlZERhdGFTb3VyY2UgPSB1Py5kYXRhU291cmNlSWQgPT09ICh0aGlzIGFzIGFueSkuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2U/LigpPy5pZFxuICAgICAgICBpZiAodXNlQ3VycmVudERhdGFTb3VyY2UgfHwgdXNlU2VsZWN0aW9uVmlld09mQ3VycmVudERhdGFTb3VyY2UgfHwgdXNlT3RoZXJWaWV3c0Rlcml2ZWRGcm9tU2FtZU1haW5Ec1dpdGhTZWxlY3Rpb25WaWV3IHx8IHVzZU9yaWdpbkRhdGFTb3VyY2UgfHwgdXNlQXNzb2NpYXRlZERhdGFTb3VyY2UpIHtcbiAgICAgICAgICAvLyAxLiBVc2UgZmllbGRzIGRpcmVjdGx5LlxuICAgICAgICAgIGlmICh1LmZpZWxkcykge1xuICAgICAgICAgICAgdXNlZEZpZWxkcy5wdXNoKC4uLnUuZmllbGRzKVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyAyLiBVc2UgZmllbGRzIGNvbmZpZ3VyZWQgaW4gcG9wdXAuXG4gICAgICAgICAgaWYgKHUudXNlRmllbGRzSW5Qb3B1cEluZm8pIHtcbiAgICAgICAgICAgIGNvbnN0IHBvcHVwSW5mb0ZpZWxkczogc3RyaW5nW10gPSAodGhpcyBhcyBhbnkpLmdldFBvcHVwSW5mbz8uKCk/LmZpZWxkSW5mb3M/Lm1hcChmaWVsZEluZm8gPT4gdGhpcy5maW5kSmltdUZpZWxkTmFtZShmaWVsZEluZm8uZmllbGROYW1lKSk/LmZpbHRlcihmID0+ICEhZikgfHwgW11cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSWYgdGhlIGRhdGEgc291cmNlIGRvZXNuJ3QgaGF2ZSBwb3B1cCBpbmZvIGJ1dCB3aWRnZXRzIGRlY2xhcmVkIHRvIHVzZSBwb3B1cCBpbmZvLCB3aWxsIHRyZWF0IGFsbCBmaWVsZHMgYXMgdXNlZCBmaWVsZHMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChwb3B1cEluZm9GaWVsZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICB1c2VkRmllbGRzLnB1c2goLi4ucG9wdXBJbmZvRmllbGRzKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKG9wdGlvbnM/LmxvZ0xldmVsID09PSAnZGVidWcnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb25maWcgdXNlZCBmaWVsZHMgYXJlICogc2luY2Ugd2lkZ2V0IHVzZXMgcG9wdXAgaW5mbyBmaWVsZHMsIGJ1dCBjYW4gbm90IGZpbmQgdGhlbS4nLCAodyBhcyBJTVdpZGdldEpzb24pLmlkIHx8ICh3IGFzIElNTWVzc2FnZUFjdGlvbkpzb24pLmFjdGlvbklkKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHVzZWRGaWVsZHMucHVzaCgnKicpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIDMuIFVzZSBmaWVsZHMgaW4gc3ltYm9sLlxuICAgICAgICAgIGlmICh1LnVzZUZpZWxkc0luU3ltYm9sKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucz8ubG9nTGV2ZWwgPT09ICdkZWJ1ZycpIHtcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb25maWcgdXNlZCBmaWVsZHMgYXJlICogc2luY2Ugd2lkZ2V0IHVzZXMgc3ltYm9sIGZpZWxkcy4nLCAodyBhcyBJTVdpZGdldEpzb24pLmlkIHx8ICh3IGFzIElNTWVzc2FnZUFjdGlvbkpzb24pLmFjdGlvbklkKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gV2UgZG8gbm90IGNhbGN1bGF0ZSB3aGljaCBmaWVsZHMgYXJlIGluIHN5bWJvbCwganVzdCBhZGQgYWxsIGZpZWxkcyBzaW1wbHkuXG4gICAgICAgICAgICB1c2VkRmllbGRzLnB1c2goJyonKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBCcmVhayB0aGUgbG9vcCBpZiB1c2VkIGZpZWxkcyBjb250YWluICcqJ1xuICAgICAgICByZXR1cm4gIXVzZWRGaWVsZHMuaW5jbHVkZXMoJyonKVxuICAgICAgfSlcblxuICAgICAgaWYgKG9wdGlvbnM/LmxvZ0xldmVsID09PSAnZGVidWcnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBY2N1bXVsYXRlZCBjb25maWcgdXNlZCBmaWVsZHMgYXJlOicsIHVzZWRGaWVsZHMsICh3IGFzIElNV2lkZ2V0SnNvbikuaWQgfHwgKHcgYXMgSU1NZXNzYWdlQWN0aW9uSnNvbikuYWN0aW9uSWQpXG4gICAgICB9XG5cbiAgICAgIC8vIEJyZWFrIHRoZSBsb29wIGlmIHVzZWQgZmllbGRzIGNvbnRhaW4gJyonXG4gICAgICByZXR1cm4gIXVzZWRGaWVsZHMuaW5jbHVkZXMoJyonKVxuICAgIH0pXG5cbiAgICBsZXQgY29uZmlnVXNlZEZpZWxkczogJyonIHwgc3RyaW5nW10gPSB1c2VkRmllbGRzLmluY2x1ZGVzKCcqJykgPyAnKicgOiBBcnJheS5mcm9tKG5ldyBTZXQodXNlZEZpZWxkcykpXG4gICAgaWYgKGNvbmZpZ1VzZWRGaWVsZHMgIT09ICcqJykge1xuICAgICAgY29uZmlnVXNlZEZpZWxkcyA9IGNvbmZpZ1VzZWRGaWVsZHMuZmlsdGVyKGYgPT4gISF0aGlzLmdldFNjaGVtYSgpPy5maWVsZHM/LltmXSlcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucz8ubG9nTGV2ZWwgPT09ICdkZWJ1ZycpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdGaW5hbCBjb25maWcgdXNlZCBmaWVsZHMgYXJlOicsIHVzZWRGaWVsZHMpXG4gICAgICBjb25zb2xlLmdyb3VwRW5kKClcbiAgICB9XG5cbiAgICByZXR1cm4gY29uZmlnVXNlZEZpZWxkc1xuICB9XG5cbiAgcHJvdGVjdGVkIHVwZGF0ZUxvYWRPbkRlbWFuZEZpZWxkcyAodXNlZEZpZWxkczogc3RyaW5nW10gfCAnKicpOiBzdHJpbmdbXSB8ICcqJyB7XG4gICAgaWYgKCF1c2VkRmllbGRzKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5sb2FkT25EZW1hbmRGaWVsZHMgPSB0aGlzLm1lcmdlVXNlZEZpZWxkcyh0aGlzLmxvYWRPbkRlbWFuZEZpZWxkcywgdGhpcy5maW5kTWlzc2luZ0ZpZWxkcyh1c2VkRmllbGRzLCB0aGlzLmdldENvbmZpZ1VzZWRGaWVsZHMoKSkpXG4gICAgaWYgKHRoaXMubG9hZE9uRGVtYW5kRmllbGRzICE9PSAnKicpIHtcbiAgICAgIHRoaXMubG9hZE9uRGVtYW5kRmllbGRzID0gdGhpcy5sb2FkT25EZW1hbmRGaWVsZHMuZmlsdGVyKGYgPT4gISF0aGlzLmdldFNjaGVtYSgpPy5maWVsZHM/LltmXSlcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgbWVyZ2VVc2VkRmllbGRzIChiYXNlVXNlZEZpZWxkczogc3RyaW5nW10gfCAnKicsIG5ld1VzZWRGaWVsZHM6IHN0cmluZ1tdIHwgJyonKTogc3RyaW5nW10gfCAnKicge1xuICAgIGlmIChiYXNlVXNlZEZpZWxkcyA9PT0gJyonIHx8IG5ld1VzZWRGaWVsZHMgPT09ICcqJykge1xuICAgICAgcmV0dXJuICcqJ1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShiYXNlVXNlZEZpZWxkcykgJiYgQXJyYXkuaXNBcnJheShuZXdVc2VkRmllbGRzKSkge1xuICAgICAgbGV0IHJlczogc3RyaW5nW10gfCAnKicgPSBBcnJheS5mcm9tKG5ldyBTZXQoKGJhc2VVc2VkRmllbGRzKS5jb25jYXQobmV3VXNlZEZpZWxkcykpKS5maWx0ZXIoZiA9PiAhIWYpXG4gICAgICBpZiAocmVzLmxlbmd0aCA9PT0gT2JqZWN0LmtleXModGhpcy5nZXRTY2hlbWEoKS5maWVsZHMpLmxlbmd0aCkge1xuICAgICAgICByZXMgPSAnKidcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXNcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGJhc2VVc2VkRmllbGRzIHx8IG5ld1VzZWRGaWVsZHMgfHwgW11cbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgbWlzc2luZ1NvbWVGaWVsZHMgKHVzZWRGaWVsZHM6IHN0cmluZ1tdIHwgJyonLCBjdXJyZW50RmllbGRzOiBzdHJpbmdbXSB8ICcqJyk6IGJvb2xlYW4ge1xuICAgIGlmIChjdXJyZW50RmllbGRzID09PSAnKicpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5maW5kTWlzc2luZ0ZpZWxkcyh1c2VkRmllbGRzLCBjdXJyZW50RmllbGRzKS5sZW5ndGggPiAwXG4gIH1cblxuICAvKipcbiAgICogQ29tcGFyZSB1c2VkRmllbGRzIHdpdGggY3VycmVudEZpZWxkcywgZmluZCBvdXQgdGhlIGZpZWxkcyB3aGljaCBhcmUgaW4gdXNlZEZpZWxkcyBidXQgYXJlIG5vdCBpbiBjdXJyZW50RmllbGRzLlxuICAgKi9cbiAgcHJvdGVjdGVkIGZpbmRNaXNzaW5nRmllbGRzICh1c2VkRmllbGRzOiBzdHJpbmdbXSB8ICcqJywgY3VycmVudEZpZWxkczogc3RyaW5nW10gfCAnKicpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRGaWVsZHMgPSB0aGlzLmdldFNlbGVjdGVkRmllbGRzKClcbiAgICBjb25zdCBmMSA9IHVzZWRGaWVsZHMgPT09ICcqJyA/IHNlbGVjdGVkRmllbGRzIDogdXNlZEZpZWxkc1xuICAgIGNvbnN0IGYyID0gY3VycmVudEZpZWxkcyA9PT0gJyonID8gc2VsZWN0ZWRGaWVsZHMgOiBjdXJyZW50RmllbGRzXG4gICAgY29uc3QgbWlzc2luZ0ZpZWxkczogc3RyaW5nW10gPSBbXVxuICAgIGYxPy5mb3JFYWNoKGYgPT4ge1xuICAgICAgaWYgKCFmMj8uaW5jbHVkZXMoZikpIHtcbiAgICAgICAgbWlzc2luZ0ZpZWxkcy5wdXNoKGYpXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gbWlzc2luZ0ZpZWxkc1xuICB9XG5cbiAgZmluZEppbXVGaWVsZE5hbWUgKG9yaWdpbkZpZWxkTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBzY2hlbWEgPSB0aGlzLmdldFNjaGVtYSgpXG4gICAgbGV0IGppbXVGaWVsZE5hbWU6IHN0cmluZyA9IG51bGxcbiAgICBpZiAoc2NoZW1hPy5maWVsZHMpIHtcbiAgICAgIGppbXVGaWVsZE5hbWUgPSBPYmplY3Qua2V5cyhzY2hlbWEuZmllbGRzKS5maW5kKGppbXVGaWVsZE5hbWUgPT4gc2NoZW1hLmZpZWxkc1tqaW11RmllbGROYW1lXS5uYW1lID09PSBvcmlnaW5GaWVsZE5hbWUpXG4gICAgfVxuICAgIHJldHVybiBqaW11RmllbGROYW1lXG4gIH1cblxuICBzZXRTZWxlY3RlZEZpZWxkcyAoamltdU5hbWVzOiBzdHJpbmdbXSkge1xuICAgIHRoaXMuc2VsZWN0ZWRGaWVsZHMgPSBqaW11TmFtZXNcbiAgfVxuXG4gIHNldFNjaGVtYSAoc2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEpIHtcbiAgICB0aGlzLnNjaGVtYSA9IHNjaGVtYVxuICB9XG5cbiAgYXN5bmMgZmV0Y2hTY2hlbWEgKCk6IFByb21pc2U8SU1EYXRhU291cmNlU2NoZW1hPiB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShJbW11dGFibGUoe30pKVxuICB9XG5cbiAgZ2V0RmV0Y2hlZFNjaGVtYSAoKTogSU1EYXRhU291cmNlU2NoZW1hIHtcbiAgICBpZiAodGhpcy5pc0RhdGFWaWV3IHx8IHRoaXMuaXNMb2NhbCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRGZXRjaGVkU2NoZW1hKClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2hlZFNjaGVtYVxuICB9XG5cbiAgc2V0RmV0Y2hlZFNjaGVtYSAoZmV0Y2hlZFNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hKSB7XG4gICAgdGhpcy5mZXRjaGVkU2NoZW1hID0gZmV0Y2hlZFNjaGVtYVxuICB9XG5cbiAgZ2V0R2VvbWV0cnlUeXBlICgpOiBHZW9tZXRyeVR5cGUge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBnZXRSZXZlcnNlZENvbmZpZ1NjaGVtYSAoKTogSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEge1xuICAgIGlmICh0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldFJldmVyc2VkQ29uZmlnU2NoZW1hKClcbiAgICB9XG4gICAgaWYgKHRoaXMucmV2ZXJzZVNjaGVtYSkge1xuICAgICAgcmV0dXJuIHRoaXMucmV2ZXJzZVNjaGVtYVxuICAgIH1cbiAgICBpZiAodGhpcy5pc0RhdGFTb3VyY2VTZXQpIHtcbiAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWFcbiAgICAgIGNvbnN0IHJTY2hlbWEgPSB7IGNoaWxkU2NoZW1hczoge30gYXMgYW55IH1cbiAgICAgIGlmICghc2NoZW1hKSB7XG4gICAgICAgIHJldHVybiBJbW11dGFibGUoe30pXG4gICAgICB9XG4gICAgICBpZiAoIXNjaGVtYS5jaGlsZFNjaGVtYXMpIHtcbiAgICAgICAgcmV0dXJuIEltbXV0YWJsZSh7XG4gICAgICAgICAgbGFiZWw6IHNjaGVtYS5sYWJlbCxcbiAgICAgICAgICBjaGlsZElkOiBzY2hlbWEuY2hpbGRJZCxcbiAgICAgICAgICBqaW11Q2hpbGRJZDogc2NoZW1hLmppbXVDaGlsZElkXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBPYmplY3Qua2V5cyhzY2hlbWEuY2hpbGRTY2hlbWFzKS5mb3JFYWNoKGppbXVDaGlsZElkID0+IHtcbiAgICAgICAgY29uc3QgYWN0dWFsQ2hpbGRJZCA9IHNjaGVtYS5jaGlsZFNjaGVtYXNbamltdUNoaWxkSWRdLmNoaWxkSWRcbiAgICAgICAgaWYgKHJTY2hlbWEuY2hpbGRTY2hlbWFzW2FjdHVhbENoaWxkSWRdKSB7XG4gICAgICAgICAgclNjaGVtYS5jaGlsZFNjaGVtYXNbYWN0dWFsQ2hpbGRJZF0ucHVzaCh0aGlzLmdldE9uZVJldmVyc2VkQ29uZmlnU2NoZW1hKHNjaGVtYS5jaGlsZFNjaGVtYXNbamltdUNoaWxkSWRdKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByU2NoZW1hLmNoaWxkU2NoZW1hc1thY3R1YWxDaGlsZElkXSA9IFt0aGlzLmdldE9uZVJldmVyc2VkQ29uZmlnU2NoZW1hKHNjaGVtYS5jaGlsZFNjaGVtYXNbamltdUNoaWxkSWRdKV1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHRoaXMucmV2ZXJzZVNjaGVtYSA9IEltbXV0YWJsZShyU2NoZW1hKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJldmVyc2VTY2hlbWEgPSB0aGlzLmdldE9uZVJldmVyc2VkQ29uZmlnU2NoZW1hKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWEpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLnJldmVyc2VTY2hlbWFcbiAgfVxuXG4gIHNldFJlY29yZHMgKHJlY29yZHM6IERhdGFSZWNvcmRbXSkge1xuICAgIHRoaXMucmVjb3JkcyA9IHJlY29yZHNcbiAgICB0aGlzLmFkZFZlcnNpb24oKVxuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBzY2hlbWFcbiAgICovXG4gIHByaXZhdGUgZ2V0T25lUmV2ZXJzZWRDb25maWdTY2hlbWEgKHNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hKTogSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEge1xuICAgIGNvbnN0IHJldmVyc2VkU2NoZW1hOiBSZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEgPSB7fVxuICAgIGlmICghc2NoZW1hKSB7XG4gICAgICByZXR1cm4gSW1tdXRhYmxlKHJldmVyc2VkU2NoZW1hKVxuICAgIH1cbiAgICByZXZlcnNlZFNjaGVtYS5maWVsZHMgPSB7fSBhcyBhbnlcbiAgICBPYmplY3Qua2V5cyhzY2hlbWEuZmllbGRzKS5mb3JFYWNoKGppbXVOYW1lID0+IHtcbiAgICAgIGNvbnN0IGZpZWxkID0gc2NoZW1hLmZpZWxkc1tqaW11TmFtZV0uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KVxuICAgICAgaWYgKHJldmVyc2VkU2NoZW1hLmZpZWxkc1tmaWVsZC5uYW1lXSkge1xuICAgICAgICAocmV2ZXJzZWRTY2hlbWEuZmllbGRzW2ZpZWxkLm5hbWVdKS5wdXNoKGZpZWxkKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgKHJldmVyc2VkU2NoZW1hLmZpZWxkc1tmaWVsZC5uYW1lXSkgPSBbZmllbGRdXG4gICAgICB9XG4gICAgfSlcblxuICAgIHNjaGVtYS5jaGlsZElkICYmIChyZXZlcnNlZFNjaGVtYS5jaGlsZElkID0gc2NoZW1hLmNoaWxkSWQpXG4gICAgc2NoZW1hLmppbXVDaGlsZElkICYmIChyZXZlcnNlZFNjaGVtYS5qaW11Q2hpbGRJZCA9IHNjaGVtYS5qaW11Q2hpbGRJZClcbiAgICByZXR1cm4gSW1tdXRhYmxlKHJldmVyc2VkU2NoZW1hKVxuICB9XG5cbiAgZ2V0U3RhdHVzICgpOiBEYXRhU291cmNlU3RhdHVzIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXSAmJiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW3RoaXMuaWRdLnN0YXR1c1xuICB9XG5cbiAgc2V0U3RhdHVzIChzdGF0dXM6IERhdGFTb3VyY2VTdGF0dXMpIHtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZVN0YXR1c0NoYW5nZWQodGhpcy5pZCwgc3RhdHVzKSlcbiAgfVxuXG4gIGdldENvdW50U3RhdHVzICgpOiBEYXRhU291cmNlU3RhdHVzIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXSAmJiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW3RoaXMuaWRdLmNvdW50U3RhdHVzXG4gIH1cblxuICBzZXRDb3VudFN0YXR1cyAoc3RhdHVzOiBEYXRhU291cmNlU3RhdHVzKSB7XG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmRhdGFTb3VyY2VDb3VudFN0YXR1c0NoYW5nZWQodGhpcy5pZCwgc3RhdHVzKSlcbiAgfVxuXG4gIGdldFZlcnNpb24gKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bdGhpcy5pZF0/LnZlcnNpb25cbiAgfVxuXG4gIGFkZFZlcnNpb24gKCkge1xuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlVmVyc2lvbkFkZGVkKHRoaXMuaWQpKVxuICB9XG5cbiAgZ2V0U291cmNlVmVyc2lvbiAoKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5jYW5TYXZlU291cmNlUmVjb3JkcygpKSB7XG4gICAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXT8uc291cmNlVmVyc2lvblxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldFNvdXJjZVZlcnNpb24oKVxuICAgIH1cbiAgfVxuXG4gIGFkZFNvdXJjZVZlcnNpb24gKCkge1xuICAgIGlmICh0aGlzLmNhblNhdmVTb3VyY2VSZWNvcmRzKCkpIHtcbiAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlU291cmNlVmVyc2lvbkFkZGVkKHRoaXMuaWQpKVxuICAgIH1cbiAgfVxuXG4gIGdldFNlbGVjdGVkUmVjb3JkSWRzRnJvbUluZm8gKCk6IEltbXV0YWJsZUFycmF5PHN0cmluZz4ge1xuICAgIHJldHVybiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvPy5bdGhpcy5pZF0/LnNlbGVjdGVkSWRzIHx8IEltbXV0YWJsZShbXSlcbiAgfVxuXG4gIGdldFNlbGVjdE9wdGlvbnNGcm9tSW5mbyAoKTogSW1tdXRhYmxlT2JqZWN0PFNlbGVjdE9wdGlvbnM+IHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mbz8uW3RoaXMuaWRdPy5zZWxlY3RPcHRpb25zXG4gIH1cblxuICB1cGRhdGVTZWxlY3Rpb25JbmZvIChvcHRpb25zOiBTZWxlY3RPcHRpb25zLCB0cmlnZ2VyRGF0YVNvdXJjZTogRGF0YVNvdXJjZSkge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHNlbGVjdGVkIHJlY29yZCBpZHMgb25seSB3aGVuIGN1cnJlbnQgZGF0YSBzb3VyY2UgbGlzdGVucyBzZWxlY3Rpb24gb3IgY3VycmVudCBkYXRhIHNvdXJjZSBpcyB0aGUgZGF0YSBzb3VyY2Ugd2hpY2ggdHJpZ2dlcnMgc2VsZWN0aW9uLlxuICAgICAqL1xuICAgIGlmICh0aGlzLmdldExpc3RlblNlbGVjdGlvbigpIHx8IHRoaXMuaWQgPT09IHRyaWdnZXJEYXRhU291cmNlPy5pZCkge1xuICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmRhdGFTb3VyY2VTZWxlY3Rpb25DaGFuZ2VkKHRoaXMuaWQsIG9wdGlvbnMpKVxuICAgIH1cbiAgfVxuXG4gIGJ1aWxkUmVjb3JkIChkYXRhOiBhbnkpOiBEYXRhUmVjb3JkIHtcbiAgICByZXR1cm4gbmV3IFNpbXBsZURhdGFSZWNvcmRJbXBsKGRhdGEsIHRoaXMpXG4gIH1cblxuICBnZXRSZWNvcmRzICgpOiBEYXRhUmVjb3JkW10ge1xuICAgIHJldHVybiB0aGlzLnJlY29yZHNcbiAgfVxuXG4gIGdldFJlY29yZHNXaXRoU2VsZWN0aW9uICgpOiBEYXRhUmVjb3JkW10ge1xuICAgIHJldHVybiB0aGlzLmNvbmNhdFJlY29yZHNBbmRTZWxlY3Rpb24odGhpcy5nZXRTZWxlY3RlZFJlY29yZHMoKSwgdGhpcy5nZXRSZWNvcmRzKCkpXG4gIH1cblxuICAvKipcbiAgICogSWYgdGhlIHNlbGVjdGVkIHJlY29yZHMgaGF2ZSBub3QgYmVlbiBsb2FkZWQsIHRoZXkgd2lsbCBiZSBmaWxsZWQgdG8gdGhlIHN0YXJ0IG9mIHRoZSByZWNvcmRzIGFycmF5LlxuICAgKiBUaGVzZSBzZWxlY3RlZCByZWNvcmRzIHNob3VsZCBtYXRjaCBxdWVyeSBwYXJhbXMgb2YgY3VycmVudCBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHByb3RlY3RlZCBjb25jYXRSZWNvcmRzQW5kU2VsZWN0aW9uIChzZWxlY3RSZWNvcmRzOiBEYXRhUmVjb3JkW10sIHJlY29yZHM6IERhdGFSZWNvcmRbXSk6IERhdGFSZWNvcmRbXSB7XG4gICAgY29uc3QgbmV3UmVjb3JkcyA9IHJlY29yZHMgfHwgW11cbiAgICBzZWxlY3RSZWNvcmRzPy5yZXZlcnNlKCk/LmZvckVhY2goc2VsZWN0ZWRSZWNvcmQgPT4ge1xuICAgICAgY29uc3QgaXNTZWxlY3RlZFJlY29yZExvYWRlZCA9IHJlY29yZHM/LnNvbWUociA9PiByPy5nZXRJZCgpID09PSBzZWxlY3RlZFJlY29yZD8uZ2V0SWQoKSlcblxuICAgICAgaWYgKCFpc1NlbGVjdGVkUmVjb3JkTG9hZGVkKSB7XG4gICAgICAgIG5ld1JlY29yZHMudW5zaGlmdChzZWxlY3RlZFJlY29yZClcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBuZXdSZWNvcmRzXG4gIH1cblxuICBjbGVhclNvdXJjZVJlY29yZHNOb3RBZGRWZXJzaW9uICgpIHtcbiAgICB0aGlzLmNsZWFyUmVjb3Jkc05vdEFkZFZlcnNpb24oKVxuICAgIHRoaXMuc291cmNlUmVjb3JkcyA9IFtdXG4gIH1cblxuICBjbGVhclNvdXJjZVJlY29yZHMgKCkge1xuICAgIHRoaXMuY2xlYXJTb3VyY2VSZWNvcmRzTm90QWRkVmVyc2lvbigpXG4gICAgdGhpcy5hZGRTb3VyY2VWZXJzaW9uKClcbiAgICB0aGlzLmFkZFZlcnNpb24oKVxuICB9XG5cbiAgc2V0U291cmNlUmVjb3JkcyAocmVjb3JkczogRGF0YVJlY29yZFtdKSB7XG4gICAgaWYgKHRoaXMuY2FuU2F2ZVNvdXJjZVJlY29yZHMoKSkge1xuICAgICAgLy8gQ2xlYXIgbG9hZGVkIHJlY29yZHMgYW5kIHNlbGVjdGVkIHJlY29yZHMgaW4gY3VycmVudCBkYXRhIHNvdXJjZSwgd2lsbCBhZGQgdmVyc2lvbiBpbiB0aGUgZW5kLlxuICAgICAgdGhpcy5jbGVhclJlY29yZHNOb3RBZGRWZXJzaW9uKClcblxuICAgICAgLy8gU2VsZWN0ZWQgcmVjb3JkIGlkcyBvZiBzZWxlY3Rpb24gdmlldyBpcyBhbHdheXMgZW1wdHkgYXJyYXksIG5vIG5lZWQgdG8gcmVzZXQgaXQuXG4gICAgICBjb25zdCByZXNldFNlbGVjdGlvbkluZm8gPSAhdGhpcy5pc1NlbGVjdGlvblZpZXcoKVxuICAgICAgaWYgKHJlc2V0U2VsZWN0aW9uSW5mbykge1xuICAgICAgICBsb2Rhc2guZGVmZXIoKCkgPT4ge1xuICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uSW5mbyh7IHdpZGdldElkOiBudWxsLCBpZHM6IFtdIH0sIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSlcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgdGhpcy5zb3VyY2VSZWNvcmRzID0gcmVjb3Jkcy5maWx0ZXIociA9PiAhIXIpLm1hcChyID0+IHtcbiAgICAgICAgci5kYXRhU291cmNlID0gdGhpc1xuICAgICAgICByZXR1cm4gclxuICAgICAgfSlcblxuICAgICAgLy8gQ2xlYXIgbG9hZGVkIHJlY29yZHMgYW5kIHNlbGVjdGVkIHJlY29yZHMgaW4gZGVyaXZlZCBkYXRhIHNvdXJjZXMuXG4gICAgICB0aGlzLmdldEFsbERlcml2ZWREYXRhU291cmNlcygpLmZvckVhY2goZHMgPT4ge1xuICAgICAgICBkcy5jbGVhclJlY29yZHMoKVxuICAgICAgICBpZiAocmVzZXRTZWxlY3Rpb25JbmZvKSB7XG4gICAgICAgICAgbG9kYXNoLmRlZmVyKCgpID0+IHtcbiAgICAgICAgICAgIGRzLnVwZGF0ZVNlbGVjdGlvbkluZm8oeyB3aWRnZXRJZDogbnVsbCwgaWRzOiBbXSB9LCBkcy5nZXRNYWluRGF0YVNvdXJjZSgpKVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHRoaXMuYWRkU291cmNlVmVyc2lvbigpXG4gICAgICB0aGlzLmFkZFZlcnNpb24oKVxuICAgIH1cbiAgfVxuXG4gIGdldFNvdXJjZVJlY29yZHMgKCk6IERhdGFSZWNvcmRbXSB7XG4gICAgaWYgKCF0aGlzLmNhblNhdmVTb3VyY2VSZWNvcmRzKCkpIHtcbiAgICAgIGlmICh0aGlzLmlzTG9jYWxWaWV3T2ZTZWxlY3Rpb25WaWV3KCkpIHsgLy8gSWYgaXMgbG9jYWwgdmlldyBvZiBhIHNlbGVjdGlvbiB2aWV3LCBzaG91bGQgdXNlIHNlbGVjdGlvbiB2aWV3J3Mgc291cmNlLlxuICAgICAgICByZXR1cm4gdGhpcy5iZWxvbmdUb0RhdGFTb3VyY2UuZ2V0U291cmNlUmVjb3JkcygpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldFNvdXJjZVJlY29yZHMoKVxuICAgICAgfVxuICAgIH1cbiAgICBsZXQgc291cmNlUmVjb3JkcyA9IHRoaXMuc291cmNlUmVjb3JkcyB8fCBbXVxuICAgIGlmICh0aGlzLnVzZU5vU2VsZWN0aW9uVmlldyh0aGlzKSkge1xuICAgICAgY29uc3Qgbm9TZWxlY3Rpb25WaWV3ID0gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFWaWV3KENPTlNUQU5UUy5EQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTilcbiAgICAgIGlmIChub1NlbGVjdGlvblZpZXcpIHtcbiAgICAgICAgLy8gQ2hhbmdlIGRhdGEgc291cmNlIG9mIHJlY29yZCB0byBjdXJyZW50IGRhdGEgc291cmNlLlxuICAgICAgICBzb3VyY2VSZWNvcmRzID0gbm9TZWxlY3Rpb25WaWV3LmdldFJlY29yZHMoKT8ubWFwKHIgPT4ge1xuICAgICAgICAgIHIuZGF0YVNvdXJjZSA9IHRoaXNcbiAgICAgICAgICByZXR1cm4gclxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc291cmNlUmVjb3Jkc1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB3aGV0aGVyIGEgZGF0YSBzb3VyY2Ugc2hvdWxkIHVzZSByZWNvcmRzIG9mIG5vX3NlbGVjdGlvbiB2aWV3IGFzIGl0cyBvd24gc291cmNlIHJlY29yZHMuXG4gICAqICAtIHRoZSBkYXRhIHNvdXJjZSBtdXN0IGJlIHNlbGVjdGlvbiB2aWV3LCBub19zZWxlY3Rpb24gdmlldyBpcyBkZXNpZ25lZCBhcyB0aGUgZGVmYXVsdCB2YWx1ZSBvZiBzZWxlY3Rpb24gdmlldy5cbiAgICogIC0gdGhlIGRhdGEgc291cmNlIG11c3QgaGF2ZSBubyBzb3VyY2UgcmVjb3JkcywgaWYgaXQgaGFzIHNvdXJjZSByZWNvcmRzLCBzaG91bGQgdXNlIHRoZXNlIHNvdXJjZSByZWNvcmRzLlxuICAgKi9cbiAgdXNlTm9TZWxlY3Rpb25WaWV3IChkYXRhU291cmNlOiBEYXRhU291cmNlID0gdGhpcyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHNvdXJjZVJlY29yZHMgPSAoZGF0YVNvdXJjZSBhcyBhbnkpLnNvdXJjZVJlY29yZHMgfHwgW11cbiAgICByZXR1cm4gZGF0YVNvdXJjZS5pc0RhdGFWaWV3ICYmIGRhdGFTb3VyY2UuZGF0YVZpZXdJZCA9PT0gQ09OU1RBTlRTLlNFTEVDVElPTl9EQVRBX1ZJRVdfSUQgJiYgc291cmNlUmVjb3Jkcy5sZW5ndGggPT09IDAgJiYgZGF0YVNvdXJjZS5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFWaWV3KENPTlNUQU5UUy5EQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTikgJiYgZGF0YVNvdXJjZS5nZXRNYWluRGF0YVNvdXJjZSgpLmdldFNlbGVjdGVkUmVjb3JkSWRzKCkuZmlsdGVyKGlkID0+ICEhaWQpLmxlbmd0aCA9PT0gMFxuICB9XG5cbiAgY2FuU2F2ZVNvdXJjZVJlY29yZHMgKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGlzTWFpbkRhdGFTb3VyY2UgPSAhdGhpcy5pc0RhdGFWaWV3ICYmICF0aGlzLmlzTG9jYWxcbiAgICByZXR1cm4gaXNNYWluRGF0YVNvdXJjZSB8fCB0aGlzLmlzU2VsZWN0aW9uVmlldygpXG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0U2VsZWN0aW9uRGF0YVZpZXcgKCk6IERhdGFTb3VyY2Uge1xuICAgIGNvbnN0IG1haW5Ec0lkID0gKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpID8gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmlkIDogdGhpcy5pZFxuICAgIGNvbnN0IHNlbGVjdGlvbkR2ID0gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhVmlld0RhdGFTb3VyY2UobWFpbkRzSWQsIENPTlNUQU5UUy5TRUxFQ1RJT05fREFUQV9WSUVXX0lEKVxuICAgIHJldHVybiBzZWxlY3Rpb25EdlxuICB9XG5cbiAgZ2V0U2VsZWN0ZWRSZWNvcmRzICgpOiBEYXRhUmVjb3JkW10ge1xuICAgIGNvbnN0IHNlbGVjdGlvbkR2ID0gdGhpcy5nZXRTZWxlY3Rpb25EYXRhVmlldygpXG4gICAgLyoqXG4gICAgICogV2hlbiBnZXR0aW5nIHNlbGVjdGVkIHJlY29yZHMsIHdlIHNob3VsZCByZXR1cm4gcmVhbCBzZWxlY3Rpb24sIHNob3VsZG4ndCBjb25zaWRlciBub19zZWxlY3Rpb24gdmlldy5cbiAgICAgKiBOb19zZWxlY3Rpb24gdmlldyBpcyBvbmx5IHVzZWQgd2hlbiB3aWRnZXQgdXNpbmcgc2VsZWN0ZWQgZmVhdHVyZXMgYXMgaXRzIGRhdGEgc291cmNlLlxuICAgICAqL1xuICAgIGNvbnN0IGFsbFNlbGVjdGVkUmVjb3JkcyA9IHNlbGVjdGlvbkR2ID8gc2VsZWN0aW9uRHYuZ2V0UmVjb3JkcygpIDogW11cbiAgICBjb25zdCBzZWxlY3RlZFJlY29yZElkc0luQ3VycmVudERzID0gdGhpcy5nZXRTZWxlY3RlZFJlY29yZElkcygpXG4gICAgcmV0dXJuIGFsbFNlbGVjdGVkUmVjb3Jkcy5maWx0ZXIociA9PiBzZWxlY3RlZFJlY29yZElkc0luQ3VycmVudERzLmluY2x1ZGVzKHIuZ2V0SWQoKSkpXG5cbiAgICAvLyBjb25zdCBkc0luZm8gPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW3RoaXMuaWRdO1xuICAgIC8vIGlmIChkc0luZm8uc2VsZWN0ZWRJbmRleGVzKSB7IC8vIHNlbGVjdCBieSBpbmRleCwgZ2V0IHJlY29yZHMgZnJvbSBtYWluIGRzLlxuICAgIC8vICAgLy93ZSB1c2UgLmFzTXV0YWJsZSgpIGhlcmUsIGJlY2F1c2UgdGhlIC5tYXAoKSBpbiBTZWFtbGVzc0ltbXV0YWJsZSB3aWxsIHJlbW92ZSBtdXRhYmxlIHByb3BlcnRpZXMuXG4gICAgLy8gICByZXR1cm4gZHNJbmZvLnNlbGVjdGVkSW5kZXhlcy5hc011dGFibGUoKS5tYXAoaW5kZXggPT4gdGhpcy5nZXRSZWNvcmRzKClbaW5kZXhdKS5maWx0ZXIociA9PiByKTtcbiAgICAvLyB9IGVsc2UgaWYgKGRzSW5mby5zZWxlY3RlZElkcykgeyAvLyBzZWxlY3QgYnkgaWQsIGdldCByZWNvcmRzIGZyb20gc2VsZWN0aW9uIGR2XG4gICAgLy8gICByZXR1cm4gZHNJbmZvLnNlbGVjdGVkSWRzLmFzTXV0YWJsZSgpLm1hcChpZCA9PiB0aGlzLmdldFJlY29yZEJ5SWQoaWQpKS5maWx0ZXIociA9PiByKTtcbiAgICAvLyB9IGVsc2Uge1xuICAgIC8vICAgcmV0dXJuIFtdO1xuICAgIC8vIH1cbiAgfVxuXG4gIGdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcyAoKTogbnVtYmVyW10ge1xuICAgIGlmICghZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXSkge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuXG4gICAgY29uc3QgZHNJZCA9ICh0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKSA/IHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5pZCA6IHRoaXMuaWRcblxuICAgIGlmIChnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW2RzSWRdLnNlbGVjdGVkSWRzKSB7XG4gICAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1tkc0lkXS5zZWxlY3RlZElkcy5hc011dGFibGUoKS5tYXAoaWQgPT4ge1xuICAgICAgICAvLyB3ZSBkb24ndCBjYXJlIHRoZSB0eXBlIGhlcmVcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVjb3JkcygpLmZpbmRJbmRleChyZWNvcmQgPT4gcmVjb3JkLmdldElkKCkgPT09IGlkKVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgZ2V0U2VsZWN0ZWRSZWNvcmRJZHMgKCk6IHN0cmluZ1tdIHtcbiAgICAvKipcbiAgICAgKiBTZWxlY3Rpb24gdmlldyBzaG91bGQgY29udGFpbnMgYWxsIHNlbGVjdGVkIHJlY29yZHMsIGluY2x1ZGluZyByZWNvcmRzIHNlbGVjdGVkIGluIG1haW4gZGF0YSBzb3VyY2UgYW5kIHJlY29yZHMgc2VsZWN0ZWQgaW4gZGF0YSB2aWV3cy5cbiAgICAgKlxuICAgICAqIFNlbGVjdGVkIHJlY29yZHMgb2YgbWFpbiBkYXRhIHNvdXJjZSBhbHNvIHNob3VsZCBjb250YWluIGFsbCBzZWxlY3RlZCByZWNvcmRzLlxuICAgICAqIFRoZSByZWFzb24gaXMgdGhhdCByZWNvcmRzIHNlbGVjdGVkIGluIGRhdGEgdmlldyBzaG91bGQgYmUgY29waWVkIHRvIG1haW4gZGF0YSBzb3VyY2Ugc2luY2UgZGF0YSB2aWV3IGlzIGEgc3Vic2V0IG9mIG1haW4gZGF0YSBzb3VyY2UuXG4gICAgICovXG4gICAgaWYgKHRoaXMuaXNTZWxlY3Rpb25WaWV3KCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0U2VsZWN0ZWRSZWNvcmRJZHNGcm9tSW5mbygpLmFzTXV0YWJsZSgpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFNlbGVjdGVkUmVjb3JkSWRzRnJvbUluZm8oKS5hc011dGFibGUoKVxuICAgIH1cbiAgfVxuXG4gIG5leHRSZWNvcmQgKCk6IERhdGFSZWNvcmQge1xuICAgIGlmICh0aGlzLmdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcygpLmxlbmd0aCA+IDEpIHtcbiAgICAgIGNvbnNvbGUud2FybignbWV0aG9kIFwibmV4dFJlY29yZFwiIG9ubHkgd29ya3Mgd2hlbiBzaW5nbGUgcmVjb3JkIGlzIHNlbGVjdGVkJylcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRJbmRleGVzKCkuaW5kZXhPZih0aGlzLmdldFJlY29yZHMoKS5sZW5ndGggLSAxKSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ1JlYWNoIHRoZSBlbmQgb2YgZGF0YS4nKVxuICAgIH1cblxuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlU2VsZWN0ZWRJbmRleGVzQ2hhbmdlZCh0aGlzLmlkLCBbdGhpcy5nZXRTZWxlY3RlZFJlY29yZEluZGV4ZXMoKVswXSsrXSkpXG4gICAgcmV0dXJuIHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRzKClbMF1cbiAgfVxuXG4gIHByZXZSZWNvcmQgKCk6IERhdGFSZWNvcmQge1xuICAgIGlmICh0aGlzLmdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcygpLmxlbmd0aCA+IDEpIHtcbiAgICAgIGNvbnNvbGUud2FybignbWV0aG9kIFwicHJldlJlY29yZFwiIG9ubHkgd29ya3Mgd2hlbiBzaW5nbGUgcmVjb3JkIGlzIHNlbGVjdGVkJylcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRJbmRleGVzKCkuaW5kZXhPZigwKSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ1JlYWNoIHRoZSBzdGFydCBvZiBkYXRhLicpXG4gICAgfVxuXG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmRhdGFTb3VyY2VTZWxlY3RlZEluZGV4ZXNDaGFuZ2VkKHRoaXMuaWQsIFt0aGlzLmdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcygpWzBdLS1dKSlcbiAgICByZXR1cm4gdGhpcy5nZXRTZWxlY3RlZFJlY29yZHMoKVswXVxuICB9XG5cbiAgZ2V0UmVjb3JkIChpbmRleDogbnVtYmVyKTogRGF0YVJlY29yZCB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UmVjb3JkcygpW2luZGV4XVxuICB9XG5cbiAgZ2V0U291cmNlUmVjb3JkIChpbmRleDogbnVtYmVyKTogRGF0YVJlY29yZCB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U291cmNlUmVjb3JkcygpW2luZGV4XVxuICB9XG5cbiAgZ2V0UmVjb3JkQnlJZCAoaWQ6IHN0cmluZyk6IERhdGFSZWNvcmQge1xuICAgIHJldHVybiB0aGlzLmdldFJlY29yZHMoKS5maWx0ZXIocmVjb3JkID0+IHJlY29yZCAmJiByZWNvcmQuZ2V0SWQoKSA9PT0gaWQpWzBdXG4gIH1cblxuICBnZXRTb3VyY2VSZWNvcmRCeUlkIChpZDogc3RyaW5nKTogRGF0YVJlY29yZCB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0U291cmNlUmVjb3JkcygpLmZpbHRlcihyZWNvcmQgPT4gcmVjb3JkICYmIHJlY29yZC5nZXRJZCgpID09PSBpZClbMF1cbiAgfVxuXG4gIGNsZWFyU2VsZWN0aW9uICgpIHtcbiAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KFtdKVxuICAgIC8qKlxuICAgICAqIE5lZWQgdG8gdXBkYXRlIHJlY29yZHMgb2Ygc2VsZWN0aW9uIHZpZXcsIHRoZW4gdXBkYXRlIGRhdGEgc291cmNlIGluZm8sXG4gICAgICogd2hpY2ggY2FuIGF2b2lkIHRoYXQgcmVjb3JkcyBvZiBzZWxlY3Rpb24gdmlldyBoYXZlbid0IGJlZW4gdXBkYXRlZCB3aGVuIHdpZGdldHMgZGV0ZWN0IGRhdGEgc291cmNlIGluZm8gY2hhbmdlIGV2ZW50LlxuICAgICAqL1xuICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uSW5mb09mRGVyaXZlZERzc0FuZENoYW5nZVVybCh7IHdpZGdldElkOiBudWxsLCBpZHM6IFtdIH0pXG4gIH1cblxuICB1cGRhdGVTZWxlY3Rpb25JbmZvT2ZEZXJpdmVkRHNzQW5kQ2hhbmdlVXJsIChvcHRpb25zOiBTZWxlY3RPcHRpb25zLCBkZXJpdmVkRnJvbURhdGFTb3VyY2U/OiBEYXRhU291cmNlLCBmb3JjZUNoZWNrPzogYm9vbGVhbikge1xuICAgIGNvbnN0IG1haW5EcyA9IHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKVxuICAgIGNvbnN0IHVwZGF0ZUJ5RHMgPSBkZXJpdmVkRnJvbURhdGFTb3VyY2UgfHwgbWFpbkRzXG5cbiAgICB1cGRhdGVCeURzLmdldEFsbERlcml2ZWREYXRhU291cmNlcygpLmZvckVhY2goZHMgPT4ge1xuICAgICAgLyoqXG4gICAgICAgKiBEYXRhIHNvdXJjZSBpbmZvIG9mIHNlbGVjdGlvbiB2aWV3IGFuZCBub19zZWxlY3Rpb24gdmlldyBkb24ndCBzYXZlIHNlbGVjdGVkIHJlY29yZCBpZHMuXG4gICAgICAgKiBTZWxlY3Rpb24gdmlldydzIHJlY29yZHMgYW5kIHNlbGVjdGVkIHJlY29yZHMgc2hvdWxkIGJlIHNhbWUgYXMgbWFpbiBkYXRhIHNvdXJjZSdzIHNlbGVjdGVkIHJlY29yZHMuXG4gICAgICAgKi9cbiAgICAgIGlmIChkcy5pZCA9PT0gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhVmlld0RhdGFTb3VyY2VJZChtYWluRHMuaWQsIENPTlNUQU5UUy5TRUxFQ1RJT05fREFUQV9WSUVXX0lEKSB8fFxuICAgICAgICBkcy5pZCA9PT0gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhVmlld0RhdGFTb3VyY2VJZChtYWluRHMuaWQsIENPTlNUQU5UUy5EQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTikpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGRzLnVwZGF0ZVNlbGVjdGlvbkluZm8ob3B0aW9ucywgdGhpcywgZm9yY2VDaGVjaylcbiAgICB9KVxuXG4gICAgdXBkYXRlQnlEcy51cGRhdGVTZWxlY3Rpb25JbmZvKG9wdGlvbnMsIHRoaXMsIGZvcmNlQ2hlY2spXG5cbiAgICBpZiAodXBkYXRlQnlEcy5pZCA9PT0gbWFpbkRzLmlkKSB7XG4gICAgICBVcmxNYW5hZ2VyLmdldEluc3RhbmNlKCkuY2hhbmdlSGFzaE9iamVjdEJ5RGF0YVNvdXJjZVNlbGVjdGlvbihtYWluRHMuaWQsIG9wdGlvbnMpXG4gICAgfVxuICB9XG5cbiAgc2VsZWN0UmVjb3JkIChpbmRleDogbnVtYmVyKSB7XG4gICAgY29uc3QgcmVjb3JkID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmlzRGF0YUluRGF0YVNvdXJjZUluc3RhbmNlID8gdGhpcy5nZXRTb3VyY2VSZWNvcmQoaW5kZXgpIDogdGhpcy5nZXRSZWNvcmQoaW5kZXgpXG4gICAgaWYgKHJlY29yZCkge1xuICAgICAgdGhpcy5jb3B5U2VsZWN0aW9uVG9EYXRhVmlldyhbcmVjb3JkXSlcbiAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uSW5mb09mRGVyaXZlZERzc0FuZENoYW5nZVVybCh7IHdpZGdldElkOiBudWxsLCBpZHM6IFtyZWNvcmQuZ2V0SWQoKV0gfSlcbiAgICB9XG4gIH1cblxuICBzZWxlY3RSZWNvcmRzIChvcHRpb25zOiBTZWxlY3RPcHRpb25zKTogUHJvbWlzZTxQaWNrPFF1ZXJ5UmVzdWx0LCAncmVjb3Jkcyc+PiB7XG4gICAgbGV0IHNlbGVjdFJlY29yZHM6IERhdGFSZWNvcmRbXSA9IFtdXG4gICAgaWYgKG9wdGlvbnM/LnJlY29yZHMpIHtcbiAgICAgIHNlbGVjdFJlY29yZHMgPSBvcHRpb25zLnJlY29yZHNcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnM/Lmlkcykge1xuICAgICAgY29uc3QgYWxsUmVjb3JkcyA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSA/IHRoaXMuZ2V0U291cmNlUmVjb3JkcygpIDogdGhpcy5nZXRSZWNvcmRzKClcbiAgICAgIHNlbGVjdFJlY29yZHMgPSBvcHRpb25zLmlkcy5tYXAoaWQgPT4gYWxsUmVjb3Jkcy5maW5kKHIgPT4gcj8uZ2V0SWQoKSA9PT0gaWQpKVxuICAgIH1cbiAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KHNlbGVjdFJlY29yZHMpXG4gICAgdGhpcy51cGRhdGVTZWxlY3Rpb25JbmZvT2ZEZXJpdmVkRHNzQW5kQ2hhbmdlVXJsKG9wdGlvbnMpXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7IHJlY29yZHM6IHNlbGVjdFJlY29yZHMgfSlcbiAgfVxuXG4gIHNlbGVjdFJlY29yZEJ5SWQgKGlkOiBzdHJpbmcsIHJlY29yZD86IERhdGFSZWNvcmQpIHtcbiAgICBpZiAodGhpcy5nZXRTZWxlY3RlZFJlY29yZElkcygpLmZpbmQoX2lkID0+IF9pZCA9PT0gaWQpKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBsZXQgc2VsZWN0UmVjb3JkXG4gICAgaWYgKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSkge1xuICAgICAgc2VsZWN0UmVjb3JkID0gcmVjb3JkIHx8IChpZCAmJiB0aGlzLmdldFNvdXJjZVJlY29yZEJ5SWQoaWQpKVxuICAgIH0gZWxzZSB7XG4gICAgICBzZWxlY3RSZWNvcmQgPSByZWNvcmQgfHwgKGlkICYmIHRoaXMuZ2V0UmVjb3JkQnlJZChpZCkpXG4gICAgfVxuXG4gICAgaWYgKCFzZWxlY3RSZWNvcmQpIHtcbiAgICAgIHRoaXMuY29weVNlbGVjdGlvblRvRGF0YVZpZXcoW10pXG4gICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbkluZm9PZkRlcml2ZWREc3NBbmRDaGFuZ2VVcmwoeyB3aWRnZXRJZDogbnVsbCwgaWRzOiBbXSB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KFtzZWxlY3RSZWNvcmRdKVxuICAgICAgdGhpcy51cGRhdGVTZWxlY3Rpb25JbmZvT2ZEZXJpdmVkRHNzQW5kQ2hhbmdlVXJsKHsgd2lkZ2V0SWQ6IG51bGwsIGlkczogW2lkXSB9KVxuICAgIH1cbiAgfVxuXG4gIHNlbGVjdFJlY29yZHNCeUlkcyAoaWRzOiBzdHJpbmdbXSwgcmVjb3Jkcz86IERhdGFSZWNvcmRbXSkge1xuICAgIGNvbnN0IGFsbFJlY29yZHMgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuaXNEYXRhSW5EYXRhU291cmNlSW5zdGFuY2UgPyB0aGlzLmdldFNvdXJjZVJlY29yZHMoKSA6IHRoaXMuZ2V0UmVjb3JkcygpXG4gICAgY29uc3Qgc2VsZWN0UmVjb3JkcyA9IHJlY29yZHMgfHwgaWRzLm1hcChpZCA9PiBhbGxSZWNvcmRzLmZpbmQociA9PiByPy5nZXRJZCgpID09PSBpZCkpXG5cbiAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KHNlbGVjdFJlY29yZHMpXG4gICAgdGhpcy51cGRhdGVTZWxlY3Rpb25JbmZvT2ZEZXJpdmVkRHNzQW5kQ2hhbmdlVXJsKHsgd2lkZ2V0SWQ6IG51bGwsIGlkcyB9KVxuICB9XG5cbiAgcHJvdGVjdGVkIGNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3IChzZWxlY3Rpb246IERhdGFSZWNvcmRbXSkge1xuICAgIGNvbnN0IHNlbGVjdGlvbkR2ID0gdGhpcy5nZXRTZWxlY3Rpb25EYXRhVmlldygpXG5cbiAgICBpZiAoIXNlbGVjdGlvbkR2KSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBzZWxlY3Rpb25Edi5zZXRTb3VyY2VSZWNvcmRzKHNlbGVjdGlvbi5maWx0ZXIociA9PiAhIXIpKVxuICAgIHNlbGVjdGlvbkR2LnNldFJlY29yZHMoc2VsZWN0aW9uLmZpbHRlcihyID0+ICEhcikpXG4gIH1cblxuICBnZXRJbmZvICgpOiBJTURhdGFTb3VyY2VJbmZvIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXSB8fCBJbW11dGFibGUoe30pIGFzIElNRGF0YVNvdXJjZUluZm9cbiAgfVxuXG4gIGNsZWFyUmVjb3JkcyAoKSB7XG4gICAgdGhpcy5jbGVhclJlY29yZHNOb3RBZGRWZXJzaW9uKClcbiAgICB0aGlzLmFkZFZlcnNpb24oKVxuICB9XG5cbiAgY2xlYXJSZWNvcmRzTm90QWRkVmVyc2lvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzU2VsZWN0aW9uVmlldygpICYmIHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRzKCkubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5jb3B5U2VsZWN0aW9uVG9EYXRhVmlldyhbXSlcbiAgICB9XG4gICAgdGhpcy5yZWNvcmRzID0gW11cbiAgfVxuXG4gIGdldElkRmllbGQgKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICh0aGlzLmdldFNjaGVtYSgpICYmIHRoaXMuZ2V0U2NoZW1hKCkuaWRGaWVsZCkgfHwgJ2lkJ1xuICB9XG5cbiAgZ2V0Um9vdERhdGFTb3VyY2UgKCk6IERhdGFTb3VyY2Uge1xuICAgIGlmICh0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldFJvb3REYXRhU291cmNlKClcbiAgICB9XG4gICAgbGV0IHJvb3REcyA9IHRoaXMucGFyZW50RGF0YVNvdXJjZVxuICAgIHdoaWxlIChyb290RHMgJiYgcm9vdERzLnBhcmVudERhdGFTb3VyY2UpIHtcbiAgICAgIHJvb3REcyA9IHJvb3REcy5wYXJlbnREYXRhU291cmNlXG4gICAgfVxuICAgIHJldHVybiByb290RHNcbiAgfVxuXG4gIGdldE9yaWdpbkRhdGFTb3VyY2VzICgpOiBEYXRhU291cmNlW10ge1xuICAgIGlmICh0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldE9yaWdpbkRhdGFTb3VyY2VzKClcbiAgICB9XG4gICAgaWYgKCF0aGlzLmdldERhdGFTb3VyY2VKc29uKCkub3JpZ2luRGF0YVNvdXJjZXMgfHwgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLm9yaWdpbkRhdGFTb3VyY2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5vcmlnaW5EYXRhU291cmNlcy5hc011dGFibGUoKS5tYXAodXNlRHMgPT4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhU291cmNlKHVzZURzLmRhdGFTb3VyY2VJZCkpXG4gIH1cblxuICBnZXRNYWluRGF0YVNvdXJjZSAoKTogRGF0YVNvdXJjZSB7XG4gICAgaWYgKHRoaXMuYmVsb25nVG9EYXRhU291cmNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5iZWxvbmdUb0RhdGFTb3VyY2UuYmVsb25nVG9EYXRhU291cmNlID8/IHRoaXMuYmVsb25nVG9EYXRhU291cmNlXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICB9XG5cbiAgZ2V0RGF0YVZpZXdzICgpOiBEYXRhU291cmNlW10ge1xuICAgIGlmICh0aGlzLmdldE1haW5EYXRhU291cmNlKCkgIT09IHRoaXMpIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhU291cmNlc0FzQXJyYXkoKS5maWx0ZXIoZHMgPT4gZHMuYmVsb25nVG9EYXRhU291cmNlID09PSB0aGlzICYmIGRzLmlzRGF0YVZpZXcpXG4gICAgfVxuICB9XG5cbiAgZ2V0RGF0YVZpZXcgKGRhdGFWaWV3SWQ6IHN0cmluZyk6IERhdGFTb3VyY2Uge1xuICAgIHJldHVybiB0aGlzLmdldERhdGFWaWV3cygpLmZpbmQoZHYgPT4gZHYuZGF0YVZpZXdJZCA9PT0gZGF0YVZpZXdJZClcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgZGF0YSBzb3VyY2UncyBxdWVyeSBpcyBhIGRhdGEgdmlldyBjb25maWcgYXMgd2VsbC5cbiAgICovXG4gIGdldERhdGFWaWV3Q29uZmlnICgpOiBJTURhdGFWaWV3SnNvbiB7XG4gICAgaWYgKHRoaXMuaXNMb2NhbCkge1xuICAgICAgcmV0dXJuIHRoaXMuYmVsb25nVG9EYXRhU291cmNlLmdldERhdGFWaWV3Q29uZmlnKClcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNEYXRhVmlldykge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5kYXRhVmlld3MgJiYgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmRhdGFWaWV3c1t0aGlzLmRhdGFWaWV3SWRdXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkucXVlcnlcbiAgICB9XG4gIH1cblxuICBnZXRMb2NhbERhdGFTb3VyY2VzICgpOiBEYXRhU291cmNlW10ge1xuICAgIGlmICh0aGlzLmlzTG9jYWwpIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhU291cmNlc0FzQXJyYXkoKS5maWx0ZXIoZHMgPT4gZHMuYmVsb25nVG9EYXRhU291cmNlID09PSB0aGlzICYmIGRzLmlzTG9jYWwpXG4gICAgfVxuICB9XG5cbiAgZ2V0TG9jYWxEYXRhU291cmNlIChsb2NhbElkOiBzdHJpbmcpOiBEYXRhU291cmNlIHtcbiAgICByZXR1cm4gdGhpcy5nZXRMb2NhbERhdGFTb3VyY2VzKCkuZmluZChkdiA9PiBkdi5sb2NhbElkID09PSBsb2NhbElkKVxuICB9XG5cbiAgZ2V0QWxsRGVyaXZlZERhdGFTb3VyY2VzICgpOiBEYXRhU291cmNlW10ge1xuICAgIGxldCBkc3MgPSBbXVxuICAgIGNvbnN0IGR2cyA9IHRoaXMuZ2V0RGF0YVZpZXdzKClcbiAgICBjb25zdCBsb2NhbHMgPSB0aGlzLmdldExvY2FsRGF0YVNvdXJjZXMoKVxuXG4gICAgZHNzID0gZHZzLmNvbmNhdChsb2NhbHMpXG4gICAgZHZzLmZvckVhY2goZHYgPT4ge1xuICAgICAgZHNzID0gZHNzLmNvbmNhdChkdi5nZXRMb2NhbERhdGFTb3VyY2VzKCkpXG4gICAgfSlcblxuICAgIHJldHVybiBkc3NcbiAgfVxuXG4gIGdldFNhdmVTdGF0dXMgKCk6IERhdGFTb3VyY2VTdGF0dXMge1xuICAgIHJldHVybiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW3RoaXMuaWRdPy5zYXZlU3RhdHVzXG4gIH1cblxuICBzZXRTYXZlU3RhdHVzIChzdGF0dXM6IERhdGFTb3VyY2VTdGF0dXMpIHtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZVNhdmVTdGF0dXNDaGFuZ2VkKHRoaXMuaWQsIHN0YXR1cykpXG4gIH1cblxuICBzZXRMaXN0ZW5TZWxlY3Rpb24gKGxpc3RlbjogYm9vbGVhbikge1xuICAgIHRoaXMubGlzdGVuU2VsZWN0aW9uID0gbGlzdGVuXG4gIH1cblxuICBnZXRMaXN0ZW5TZWxlY3Rpb24gKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmxpc3RlblNlbGVjdGlvblxuICB9XG5cbiAgcHJvdGVjdGVkIGlzU2VsZWN0aW9uVmlldyAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNEYXRhVmlldyAmJiB0aGlzLmRhdGFWaWV3SWQgPT09IENPTlNUQU5UUy5TRUxFQ1RJT05fREFUQV9WSUVXX0lEXG4gIH1cblxuICBwcm90ZWN0ZWQgaXNMb2NhbFZpZXdPZlNlbGVjdGlvblZpZXcgKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmlzTG9jYWwgJiYgdGhpcy5kYXRhVmlld0lkID09PSBDT05TVEFOVFMuU0VMRUNUSU9OX0RBVEFfVklFV19JRFxuICB9XG5cbiAgYXN5bmMgYWRkUmVjb3JkIChyZWNvcmQ6IERhdGFSZWNvcmQpOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICBpZiAoIXJlY29yZCkge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KCdObyByZWNvcmQgcGFzc2VkIGluLicpXG4gICAgfVxuICAgIHRoaXMuc2V0U2F2ZVN0YXR1cyhEYXRhU291cmNlU3RhdHVzLlNhdmluZylcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5kb0FkZFJlY29yZChyZWNvcmQpLnRoZW4ocmVjb3JkID0+IHtcbiAgICAgIHRoaXMuc2V0U2F2ZVN0YXR1cyhEYXRhU291cmNlU3RhdHVzLlNhdmVkKVxuICAgICAgcmV0dXJuIHJlY29yZFxuICAgIH0sIGFzeW5jIGVycm9yID0+IHtcbiAgICAgIHRoaXMuc2V0U2F2ZVN0YXR1cyhEYXRhU291cmNlU3RhdHVzLlNhdmVFcnJvcilcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnJvcilcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBkb0FkZFJlY29yZCAocmVjb3JkOiBEYXRhUmVjb3JkKTogUHJvbWlzZTxEYXRhUmVjb3JkPiB7XG4gICAgaWYgKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9BZGRSZWNvcmRUb1NvdXJjZVJlY29yZHMocmVjb3JkKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZXR1cm4gdGhpcy5kb0FkZFJlY29yZFRvQUdPTE9yUG9ydGFsU291cmNlKCk7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoJ0VkaXRpbmcgc291cmNlIGlzIG5vdCByZWFkeSB5ZXQuJylcbiAgICB9XG4gIH1cblxuICBhc3luYyB1cGRhdGVSZWNvcmQgKHJlY29yZDogRGF0YVJlY29yZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnVwZGF0ZVJlY29yZHMoW3JlY29yZF0pXG4gIH1cblxuICBhc3luYyB1cGRhdGVSZWNvcmRzIChyZWNvcmRzOiBEYXRhUmVjb3JkW10pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAoIXJlY29yZHMgfHwgcmVjb3Jkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgnTm8gcmVjb3JkcyBwYXNzZWQgaW4uJylcbiAgICB9XG4gICAgdGhpcy5zZXRTYXZlU3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuU2F2aW5nKVxuICAgIHJldHVybiBhd2FpdCB0aGlzLmRvVXBkYXRlUmVjb3JkcyhyZWNvcmRzKS50aGVuKGlzRG9uZSA9PiB7XG4gICAgICB0aGlzLnNldFNhdmVTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5TYXZlZClcbiAgICAgIHJldHVybiBpc0RvbmVcbiAgICB9LCBhc3luYyBlcnJvciA9PiB7XG4gICAgICB0aGlzLnNldFNhdmVTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5TYXZlRXJyb3IpXG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoZXJyb3IpXG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZG9VcGRhdGVSZWNvcmRzIChyZWNvcmRzOiBEYXRhUmVjb3JkW10pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAodGhpcy5nZXREYXRhU291cmNlSnNvbigpLmlzRGF0YUluRGF0YVNvdXJjZUluc3RhbmNlKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb1VwZGF0ZVJlY29yZHNJblNvdXJjZVJlY29yZHMocmVjb3JkcylcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gcmV0dXJuIHRoaXMuZG9VcGRhdGVSZWNvcmRzSW5BR09MT3JQb3J0YWxTb3VyY2UoKTtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgnRWRpdGluZyBzb3VyY2UgaXMgbm90IHJlYWR5IHlldC4nKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVJlY29yZCAoaW5kZXg6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHJlY29yZCA9IHRoaXMuZ2V0UmVjb3JkcygpW2luZGV4XVxuICAgIHJldHVybiBhd2FpdCB0aGlzLmRlbGV0ZU9uZVJlY29yZChyZWNvcmQpXG4gIH1cblxuICBhc3luYyBkZWxldGVSZWNvcmRCeUlkIChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgcmVjb3JkID0gdGhpcy5nZXRSZWNvcmRCeUlkKGlkKVxuICAgIHJldHVybiBhd2FpdCB0aGlzLmRlbGV0ZU9uZVJlY29yZChyZWNvcmQpXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRlbGV0ZU9uZVJlY29yZCAocmVjb3JkOiBEYXRhUmVjb3JkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCFyZWNvcmQpIHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgnTm8gcmVjb3JkIHBhc3NlZCBpbi4nKVxuICAgIH1cbiAgICB0aGlzLnNldFNhdmVTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5TYXZpbmcpXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9EZWxldGVPbmVSZWNvcmQocmVjb3JkKS50aGVuKGlzRG9uZSA9PiB7XG4gICAgICB0aGlzLnNldFNhdmVTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5TYXZlZClcbiAgICAgIHJldHVybiBpc0RvbmVcbiAgICB9LCBhc3luYyBlcnJvciA9PiB7XG4gICAgICB0aGlzLnNldFNhdmVTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5TYXZlRXJyb3IpXG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoZXJyb3IpXG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZG9EZWxldGVPbmVSZWNvcmQgKHJlY29yZDogRGF0YVJlY29yZCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICh0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuaXNEYXRhSW5EYXRhU291cmNlSW5zdGFuY2UpIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRvRGVsZXRlT25lUmVjb3JkRnJvbVNvdXJjZVJlY29yZHMocmVjb3JkKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZXR1cm4gdGhpcy5kb0RlbGV0ZU9uZVJlY29yZEZyb21BR09MT3JQb3J0YWxTb3VyY2UoKTtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgnRWRpdGluZyBzb3VyY2UgaXMgbm90IHJlYWR5IHlldC4nKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZG9EZWxldGVPbmVSZWNvcmRGcm9tU291cmNlUmVjb3JkcyAocmVjb3JkOiBEYXRhUmVjb3JkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdGhpcy5zb3VyY2VSZWNvcmRzID0gdGhpcy5zb3VyY2VSZWNvcmRzLmZpbHRlcihyID0+IHIuZ2V0SWQoKSAhPT0gcmVjb3JkLmdldElkKCkpXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0cnVlKVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBkb0FkZFJlY29yZFRvU291cmNlUmVjb3JkcyAocmVjb3JkOiBEYXRhUmVjb3JkKTogUHJvbWlzZTxEYXRhUmVjb3JkPiB7XG4gICAgdGhpcy5zb3VyY2VSZWNvcmRzID0gdGhpcy5zb3VyY2VSZWNvcmRzLmNvbmNhdChyZWNvcmQpXG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShyZWNvcmQpXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRvVXBkYXRlUmVjb3Jkc0luU291cmNlUmVjb3JkcyAocmVjb3JkczogRGF0YVJlY29yZFtdKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmVjb3Jkcy5mb3JFYWNoKHIgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnNvdXJjZVJlY29yZHMuZmluZEluZGV4KG9yID0+IG9yLmdldElkKCkgPT09IHIuZ2V0SWQoKSlcbiAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgIHRoaXMuc291cmNlUmVjb3Jkc1tpbmRleF0gPSByXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpXG4gIH1cblxuICBhZnRlclVwZGF0ZVJlY29yZHMgKHJlY29yZHM6IERhdGFSZWNvcmRbXSkge1xuICAgIGlmICghcmVjb3JkcyB8fCByZWNvcmRzLmZpbHRlcihyID0+ICEhcikubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZUxvYWRlZFJlY29yZHModGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLCByZWNvcmRzKVxuICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRBbGxEZXJpdmVkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKGRzID0+IHsgdGhpcy51cGRhdGVMb2FkZWRSZWNvcmRzKGRzLCByZWNvcmRzKSB9KVxuXG4gICAgdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmFkZFNvdXJjZVZlcnNpb24oKVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVMb2FkZWRSZWNvcmRzIChkczogRGF0YVNvdXJjZSwgcmVjb3JkczogRGF0YVJlY29yZFtdKSB7XG4gICAgY29uc3QgcnMgPSByZWNvcmRzLm1hcChyID0+IGRzLmdldFJlY29yZEJ5SWQoci5nZXRJZCgpKSlcbiAgICBpZiAocnMuZmlsdGVyKHIgPT4gISFyKS5sZW5ndGggPiAwKSB7XG4gICAgICBycy5mb3JFYWNoKChyLCBpKSA9PiB7XG4gICAgICAgIGlmIChyKSB7XG4gICAgICAgICAgci5zZXREYXRhKHJlY29yZHNbaV0uZ2V0RGF0YSgpKVxuICAgICAgICAgIHIuc2V0R2VvbWV0cnkocmVjb3Jkc1tpXS5nZXRSYXdHZW9tZXRyeSgpKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgZHMuYWRkVmVyc2lvbigpXG4gICAgfVxuICB9XG5cbiAgYWZ0ZXJVcGRhdGVSZWNvcmQgKHJlY29yZDogRGF0YVJlY29yZCkge1xuICAgIGlmICghcmVjb3JkKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZU9uZUxvYWRlZFJlY29yZCh0aGlzLmdldE1haW5EYXRhU291cmNlKCksIHJlY29yZClcbiAgICB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0QWxsRGVyaXZlZERhdGFTb3VyY2VzKCkuZm9yRWFjaChkcyA9PiB7IHRoaXMudXBkYXRlT25lTG9hZGVkUmVjb3JkKGRzLCByZWNvcmQpIH0pXG5cbiAgICB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuYWRkU291cmNlVmVyc2lvbigpXG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZU9uZUxvYWRlZFJlY29yZCAoZHM6IERhdGFTb3VyY2UsIHJlY29yZDogRGF0YVJlY29yZCkge1xuICAgIGNvbnN0IHIgPSBkcy5nZXRSZWNvcmRCeUlkKHJlY29yZC5nZXRJZCgpKVxuICAgIGlmIChyKSB7XG4gICAgICByLnNldERhdGEocmVjb3JkLmdldERhdGEoKSlcbiAgICAgIHIuc2V0R2VvbWV0cnkocmVjb3JkLmdldFJhd0dlb21ldHJ5KCkpXG4gICAgICBkcy5hZGRWZXJzaW9uKClcbiAgICB9XG4gIH1cblxuICBhZnRlckFkZFJlY29yZCAocmVjb3JkOiBEYXRhUmVjb3JkKSB7XG4gICAgaWYgKCFyZWNvcmQpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEl0IGlzIGhhcmQgdG8gZGVjaWRlIHdoaWNoIHBhZ2UgdG8gcHV0IHRoZSBuZXcgcmVjb3JkIG9uIGFuZCBob3cgdG8gaGFuZGxlIGl0IGFmdGVyIGFkZGluZyBmaWx0ZXIuXG4gICAgICogVG8gbWFrZSB0aGUgdXBkYXRlIGVhc2llciwganVzdCBjbGVhciBsb2FkZWQgcmVjb3JkcyBoZXJlLlxuICAgICAqL1xuICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5jbGVhclJlY29yZHMoKVxuICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRBbGxEZXJpdmVkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKGRzID0+IHtcbiAgICAgIGRzLmNsZWFyUmVjb3JkcygpXG4gICAgfSlcblxuICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5hZGRTb3VyY2VWZXJzaW9uKClcbiAgfVxuXG4gIGFmdGVyRGVsZXRlUmVjb3JkQnlJZCAoaWQ6IHN0cmluZykge1xuICAgIGlmICghaWQpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmICh0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0U2VsZWN0ZWRSZWNvcmRJZHMoKS5pbmNsdWRlcyhpZCkpIHtcbiAgICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5zZWxlY3RSZWNvcmRzQnlJZHMoXG4gICAgICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRTZWxlY3RlZFJlY29yZElkcygpLmZpbHRlcihzZWxlY3RlZElkID0+IHNlbGVjdGVkSWQgIT09IGlkKSxcbiAgICAgICAgdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldFNlbGVjdGVkUmVjb3JkcygpLmZpbHRlcihyID0+IHIuZ2V0SWQoKSAhPT0gaWQpXG4gICAgICApXG4gICAgfVxuXG4gICAgdGhpcy5kZWxldGVPbmVMb2FkZWRSZWNvcmRCeUlkKHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSwgaWQpXG4gICAgdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldEFsbERlcml2ZWREYXRhU291cmNlcygpLmZvckVhY2goZHMgPT4geyB0aGlzLmRlbGV0ZU9uZUxvYWRlZFJlY29yZEJ5SWQoZHMsIGlkKSB9KVxuXG4gICAgdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmFkZFNvdXJjZVZlcnNpb24oKVxuICB9XG5cbiAgcHJvdGVjdGVkIGRlbGV0ZU9uZUxvYWRlZFJlY29yZEJ5SWQgKGRzOiBEYXRhU291cmNlLCBpZDogc3RyaW5nKSB7XG4gICAgY29uc3QgaW5kZXggPSBkcy5nZXRSZWNvcmRzKCkuZmluZEluZGV4KHIgPT4gcj8uZ2V0SWQoKSA9PT0gaWQpXG4gICAgaWYgKHR5cGVvZiBpbmRleCA9PT0gJ251bWJlcicgJiYgaW5kZXggPiAtMSkge1xuICAgICAgZHMuZ2V0UmVjb3JkcygpLnNwbGljZShpbmRleCwgMSlcbiAgICAgIGRzLmFkZFZlcnNpb24oKVxuICAgIH1cbiAgfVxuXG4gIC8vIHByb3RlY3RlZCBhYnN0cmFjdCBkb0FkZFJlY29yZFRvQUdPTE9yUG9ydGFsU291cmNlPyhyZWNvcmQ6IERhdGFSZWNvcmQpOiBQcm9taXNlPERhdGFSZWNvcmQ+XG4gIC8vIHByb3RlY3RlZCBhYnN0cmFjdCBkb0RlbGV0ZU9uZVJlY29yZEZyb21BR09MT3JQb3J0YWxTb3VyY2U/KHJlY29yZDogRGF0YVJlY29yZCk6IFByb21pc2U8Ym9vbGVhbj5cbiAgLy8gcHJvdGVjdGVkIGFic3RyYWN0IGRvVXBkYXRlUmVjb3Jkc0luQUdPTE9yUG9ydGFsU291cmNlPyhyZWNvcmRzOiBEYXRhUmVjb3JkW10pOiBQcm9taXNlPGJvb2xlYW4+XG5cbiAgZGVzdHJveSAoKSB7IH1cbn1cbiIsImltcG9ydCB7IHR5cGUgSUl0ZW0gfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcydcbmltcG9ydCB7IHR5cGUgSU1EYXRhU291cmNlSnNvbiwgdHlwZSBJTURhdGFTb3VyY2VTY2hlbWEsIEltbXV0YWJsZSwgdHlwZSBTZXJ2aWNlRGVmaW5pdGlvbiwgZGF0YVNvdXJjZVV0aWxzLCBTZXJ2aWNlTWFuYWdlciwgZ2V0QXBwU3RvcmUsIGFwcEFjdGlvbnMsIHR5cGUgVXNlRGF0YVNvdXJjZSwgbG9kYXNoLCBDT05TVEFOVFMsIGppbXVIaXN0b3J5LCBzZW12ZXIgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIEFic3RyYWN0QXJjR0lTTGF5ZXJGb2xkZXJEYXRhU291cmNlLCB0eXBlIEFyY0dJU0ZvbGRlckxheWVyLCB0eXBlIERhdGFTb3VyY2UsIHR5cGUgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucywgRGF0YVNvdXJjZVR5cGVzLCB0eXBlIEZlYXR1cmVMYXllckRhdGFTb3VyY2UsIERhdGFTb3VyY2VFcnJvciwgU3VwcG9ydGVkTGF5ZXJTZXJ2aWNlVHlwZXMgfSBmcm9tICcuLi9pbnRlcmZhY2VzJ1xuaW1wb3J0IHsgdHlwZSBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbCB9IGZyb20gJy4uL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLWxheWVyLWRhdGEtc291cmNlLWltcGwnXG5pbXBvcnQgeyB0eXBlIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCB9IGZyb20gJy4uL2ltcGxlbWVudGF0aW9ucy9zY2VuZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgQWJzdHJhY3RTZXREYXRhU291cmNlIH0gZnJvbSAnLi9hYnN0cmFjdC1zZXQtZGF0YS1zb3VyY2UnXG5pbXBvcnQgeyBJdGVtTWl4aW5JbXBsIH0gZnJvbSAnLi9pdGVtLW1peGluJ1xuaW1wb3J0IHsgSlNBUElMYXllck1peGluSW1wbCB9IGZyb20gJy4vanMtYXBpLWxheWVyLW1peGluJ1xuaW1wb3J0ICogYXMgZGF0YVNvdXJjZUpzb25DcmVhdG9yIGZyb20gJy4uL3N1cHBvcnQvZGF0YS1zb3VyY2UtanNvbi1jcmVhdG9yJ1xuXG5leHBvcnQgaW50ZXJmYWNlIExheWVyRm9sZGVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBsYXllcj86IEFyY0dJU0ZvbGRlckxheWVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgZXh0ZW5kcyBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgbGF5ZXI/OiBfX2VzcmkuTGF5ZXIgfCBfX2VzcmkuU3VibGF5ZXJcbn1cblxuLyoqXG4gKiAqIENvbW1vbiBvcGVyYXRpb25zIGZvciBmb2xkZXItbGlrZSBzZXJ2aWNlcywgc3VjaCBhcyBmZWF0dXJlIHNlcnZpY2UsIHNjZW5lIHNlcnZpY2UsIG1hcCBzZXJ2aWNlLCBncm91cCBsYXllciwgZXRjLCBhcmUgZ3JvdXBlZCBpbiB0aGlzIGNsYXNzLlxuICogcGxlYXNlIHNlZSB7QGxpbmsgU3VwcG9ydGVkTGF5ZXJTZXJ2aWNlVHlwZXN9IHRvIGZpbmQgc3VwcG9ydGVkIGxheWVyIHNlcnZpY2UgdHlwZXMuXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSBleHRlbmRzIEpTQVBJTGF5ZXJNaXhpbkltcGwoSXRlbU1peGluSW1wbChBYnN0cmFjdFNldERhdGFTb3VyY2UpKSBpbXBsZW1lbnRzIEFic3RyYWN0QXJjR0lTTGF5ZXJGb2xkZXJEYXRhU291cmNlIHtcbiAgcHJvdGVjdGVkIHNlcnZpY2VEZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvblxuICBsYXllcj86IEFyY0dJU0ZvbGRlckxheWVyXG5cbiAgY29uc3RydWN0b3IgKG9wdGlvbnM6IExheWVyRm9sZGVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpXG4gICAgaWYgKG9wdGlvbnMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIgPSBvcHRpb25zLmxheWVyXG4gICAgfVxuICAgIGNvbnN0IGRzSnNvbiA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKVxuICAgIHRoaXMucG9ydGFsVXJsID0gZHNKc29uLnBvcnRhbFVybFxuICAgIHRoaXMuaXRlbUlkID0gZHNKc29uLml0ZW1JZFxuICAgIGlmICgodGhpcy5sYXllciBhcyBhbnkpPy5wb3J0YWxJdGVtKSB7XG4gICAgICB0aGlzLnNldEl0ZW1JbmZvKCh0aGlzLmxheWVyIGFzIGFueSkucG9ydGFsSXRlbS5zb3VyY2VKU09OIGFzIElJdGVtKVxuICAgIH1cbiAgfVxuXG4gIHJlYWR5ICgpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaERhdGFEZWZpbml0aW9ucygpLnRoZW4oKCkgPT4gc3VwZXIucmVhZHkoKSkudGhlbihhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcHBDb25maWcgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwQ29uZmlnXG5cbiAgICAgIGlmIChhcHBDb25maWcub3JpZ2luRXhiVmVyc2lvbiAmJiBzZW12ZXIubHQoYXBwQ29uZmlnLm9yaWdpbkV4YlZlcnNpb24sICcxLjYuMCcpKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkRHNzID0gYXdhaXQgc3VwZXIuY3JlYXRlQ2hpbGREYXRhU291cmNlc1JlY3Vyc2l2ZWx5KClcbiAgICAgICAgYXdhaXQgdGhpcy51cGdyYWRlQ2hpbGREc3NJZChjaGlsZERzcylcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgYWJzdHJhY3QgY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5SWQgKGNoaWxkRHNJZDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZElkOiBzdHJpbmcpOiBMYXllckZvbGRlckNoaWxkRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9uc1xuXG4gIHByaXZhdGUgYXN5bmMgdXBncmFkZUNoaWxkRHNzSWQgKGNoaWxkRHNzOiBEYXRhU291cmNlW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvKipcbiAgICAgKiBCZWZvcmUgZGV2MS42LCB0aGUgamltdUNoaWxkSWQgaXMgZ2VuZXJhdGVkIGZyb20gbGF5ZXIgbGFiZWwgKG5hbWUgb2YgbGF5ZXIgZGVmaW5pdGlvbikuXG4gICAgICogQWZ0ZXIgZGV2MS42LCB0aGUgamltdUNoaWxkSWQgaXMgZ2VuZXJhdGVkIGZyb20gbGF5ZXIgaWQgKGlkIG9mIEpTIEFQSSBsYXllciBvciBsYXllciBkZWZpbml0aW9uKS5cbiAgICAgKiBUaGUgZm9sbG93aW5nIHBhcnQgaXMgdG8gdXBkYXRlIGppbXVDaGlsZElkIGFuZCBpZCBvZiBjaGlsZCBkYXRhIHNvdXJjZXMgdG8gYmUgY29tcGF0aWJsZSB3aXRoIHRoZSB2ZXJzaW9uIGJlZm9yZSBkZXYxLjYuXG4gICAgICovXG5cbiAgICBsZXQgYXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbmZpZ1xuICAgIGNvbnN0IHNlbGVjdGlvblZpZXdSZWFkeVByb21pc2VzOiBBcnJheTxQcm9taXNlPGFueT4+ID0gW11cblxuICAgIGNvbnN0IHVwZGF0ZVVzZURhdGFTb3VyY2UgPSAodTogVXNlRGF0YVNvdXJjZSwgaWQ6IHN0cmluZywgbmV3SWQ6IHN0cmluZyk6IFVzZURhdGFTb3VyY2UgPT4ge1xuICAgICAgaWYgKHU/LmRhdGFTb3VyY2VJZCkge1xuICAgICAgICB1LmRhdGFTb3VyY2VJZCA9IHUuZGF0YVNvdXJjZUlkLnJlcGxhY2UoaWQsIG5ld0lkKVxuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAqIFNvbWUgdXNlIGRhdGEgc291cmNlcyBpbiB0ZXh0IHdpZGdldCBtYXkgbm90IGhhdmUgbWFpbiBkYXRhIHNvdXJjZSBpZC5cbiAgICAgICogSXQgc2VlbXMgdG8gYmUgYSBidWcgb2YgdGV4dCB3aWRnZXQuIFdpbGwgZml4IHRoZSBidWcgaW4gYW5vdGhlciBpc3N1ZS5cbiAgICAgICovXG4gICAgICBpZiAodT8ubWFpbkRhdGFTb3VyY2VJZCkge1xuICAgICAgICB1Lm1haW5EYXRhU291cmNlSWQgPSB1Lm1haW5EYXRhU291cmNlSWQucmVwbGFjZShpZCwgbmV3SWQpXG4gICAgICB9XG4gICAgICByZXR1cm4gdVxuICAgIH1cblxuICAgIGNvbnN0IG5lZWRVcGRhdGVVc2VEcyA9ICh1OiBVc2VEYXRhU291cmNlLCBpZEZyb21MYWJlbDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gICAgICBpZiAodT8ubWFpbkRhdGFTb3VyY2VJZCkge1xuICAgICAgICByZXR1cm4gdS5tYWluRGF0YVNvdXJjZUlkID09PSBpZEZyb21MYWJlbFxuICAgICAgfSBlbHNlIGlmICh1Py5kYXRhU291cmNlSWQpIHtcbiAgICAgICAgcmV0dXJuIHUuZGF0YVNvdXJjZUlkLnNwbGl0KCctZGF0YVZpZXdfJylbMF0gPT09IGlkRnJvbUxhYmVsXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjaGlsZERzcy5mb3JFYWNoKGNoaWxkRHMgPT4ge1xuICAgICAgaWYgKGNoaWxkRHMpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICogMS4gR2V0IGlkIGZyb20gbGF5ZXIgbGFiZWwuXG4gICAgICAgICovXG4gICAgICAgIGxldCBpZEZyb21MYWJlbCA9ICcnXG4gICAgICAgIGxldCBkcyA9IGNoaWxkRHNcbiAgICAgICAgY29uc3QgaWRGcm9tTGFiZWxUb0lkRnJvbUlkOiBBcnJheTx7IGppbXVDaGlsZElkRnJvbUxhYmVsOiBzdHJpbmcsIGppbXVDaGlsZElkRnJvbUlkOiBzdHJpbmcgfT4gPSBbXVxuICAgICAgICB3aGlsZSAoZHMpIHtcbiAgICAgICAgICBjb25zdCBpc1Jvb3REcyA9ICFkcy5wYXJlbnREYXRhU291cmNlXG4gICAgICAgICAgLy8gSWYgZG8gbm90IGhhdmUgdXJsLCBzaG91bGQgYmUgZmVhdHVyZSBjb2xsZWN0aW9uIGl0ZW0uXG4gICAgICAgICAgY29uc3QgaXNTaW5nbGVMYXllckRzID0gKCFkcy5pc0RhdGFTb3VyY2VTZXQgJiYgIWRzLmdldERhdGFTb3VyY2VKc29uKCkudXJsKSB8fCBkYXRhU291cmNlVXRpbHMuaXNTdXBwb3J0ZWRTaW5nbGVBcmNHSVNMYXllclNlcnZpY2UoZHMuZ2V0RGF0YVNvdXJjZUpzb24oKS51cmwpXG4gICAgICAgICAgY29uc3QgaXNDaGlsZERzT2ZNYXAgPSAhIShkcy5wYXJlbnREYXRhU291cmNlIGFzIGFueSk/Lm1hcFxuICAgICAgICAgIGxldCBqaW11Q2hpbGRJZEZyb21MYWJlbFxuICAgICAgICAgIGlmIChpc1Jvb3REcykge1xuICAgICAgICAgICAgamltdUNoaWxkSWRGcm9tTGFiZWwgPSBkcy5pZFxuICAgICAgICAgIH0gZWxzZSBpZiAoaXNTaW5nbGVMYXllckRzICYmICFpc0NoaWxkRHNPZk1hcCkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAqIFNpbmdsZSBsYXllciBkcyB1c2VkIHRvIHVzZSBuYW1lIG9mIGxheWVyIGRlZmluaXRpb24gYXMgamltdUNoaWxkSWQsIHdoaWNoIGlzIG5lZWQgdG8gYmUgdXBkYXRlZCAoc2hvdWxkIHVzZSBpZCBvZiBsYXllciBkZWZpbml0aW9uKS5cbiAgICAgICAgICAgICogQ2hpbGQgZHMgb2YgbWFwIHVzZXMgSlMgQVBJIGxheWVyIGlkIGFzIGppbXVDaGlsZElkLCB3aGljaCBpcyBleHBlY3RlZC5cbiAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb25zdCBsYXllckRlZmluaXRpb24gPSAoZHMgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSkuZ2V0TGF5ZXJEZWZpbml0aW9uID8gKGRzIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2UpLmdldExheWVyRGVmaW5pdGlvbigpIDogKGRzIGFzIEFic3RyYWN0TGF5ZXJGb2xkZXJEYXRhU291cmNlKS5nZXRTZXJ2aWNlRGVmaW5pdGlvbj8uKClcbiAgICAgICAgICAgIGppbXVDaGlsZElkRnJvbUxhYmVsID0gZGF0YVNvdXJjZVV0aWxzLl9nZXRGaXhlZExheWVySWRCeUxheWVyRGVmaW5pdGlvbihsYXllckRlZmluaXRpb24pIHx8IGRzLmppbXVDaGlsZElkXG4gICAgICAgICAgfSBlbHNlIGlmICghaXNTaW5nbGVMYXllckRzICYmICFpc0NoaWxkRHNPZk1hcCkge1xuICAgICAgICAgICAgamltdUNoaWxkSWRGcm9tTGFiZWwgPSBkYXRhU291cmNlVXRpbHMuZ2V0TGFiZWxGcm9tQXJjR0lTU2VydmljZVVybChkcy5nZXREYXRhU291cmNlSnNvbigpLnVybClcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgamltdUNoaWxkSWRGcm9tTGFiZWwgPSBkcy5qaW11Q2hpbGRJZFxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICogT25lIGdyb3VwIG1heSBjb250YWluIHNhbWUgbGF5ZXIgc2VydmljZXMgKGNhbiBkbyBpdCBpbiBtYXAgdmlld2VyKS5cbiAgICAgICAgICAqIFRvIG1ha2UgZGF0YSBzb3VyY2UgaWQgb2YgdGhlIHNhbWUgbGF5ZXIgc2VydmljZXMgZGlmZmVyZW50LCB3ZSBhZGQgYF9bcmVwZWF0IHRpbWVzXWAgdG8gdGhlIGVuZCBvZiB0aGUgZGF0YSBzb3VyY2UgaWQuXG4gICAgICAgICAgKlxuICAgICAgICAgICogRm9yIGV4YW1wbGUsIGdyb3VwIDEgaGFzIHRocmVlIHNhbWUgbGF5ZXIgc2VydmljZXMgKGlkIG9mIHRoZSBsYXllciBzZXJ2aWNlIGlzIDApLCB0aGUgZGF0YSBzb3VyY2UgaWQgb2YgdGhlIHRocmVlIGxheWVyIHNlcnZpY2VzIHdpbGwgYmUgZGF0YVNvdXJjZV8xLWdyb3VwMS0wLCBkYXRhU291cmNlXzEtZ3JvdXAxLTBfMSBhbmQgZGF0YVNvdXJjZV8xLWdyb3VwMS0wXzIuXG4gICAgICAgICovXG4gICAgICAgICAgaWYgKCFpc1Jvb3REcyAmJiAhaXNDaGlsZERzT2ZNYXAgJiYgZHMuZ2V0RGF0YVNvdXJjZUpzb24oKS51cmwgJiYgKChkcy5wYXJlbnREYXRhU291cmNlIGFzIGFueSkubGF5ZXIgYXMgX19lc3JpLkdyb3VwTGF5ZXIpPy5sYXllcnM/LnRvQXJyYXk/LigpPy5maWx0ZXIobCA9PiBkYXRhU291cmNlVXRpbHMuZ2V0VXJsQnlMYXllcihsKSA9PT0gZHMuZ2V0RGF0YVNvdXJjZUpzb24oKS51cmwpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNoaWxMYXllcnNGcm9tU2FtZVNlcnZpY2UgPSAoKGRzLnBhcmVudERhdGFTb3VyY2UgYXMgYW55KS5sYXllciBhcyBfX2VzcmkuR3JvdXBMYXllcikubGF5ZXJzLnRvQXJyYXkoKS5maWx0ZXIobCA9PiBkYXRhU291cmNlVXRpbHMuZ2V0VXJsQnlMYXllcihsKSA9PT0gZHMuZ2V0RGF0YVNvdXJjZUpzb24oKS51cmwpXG4gICAgICAgICAgICBjb25zdCByZXBlYXRUaW1lcyA9IGNoaWxMYXllcnNGcm9tU2FtZVNlcnZpY2UuZmluZEluZGV4KGwgPT4gbC5pZCA9PT0gZHMuamltdUNoaWxkSWQpXG4gICAgICAgICAgICBpZiAocmVwZWF0VGltZXMgPiAwKSB7XG4gICAgICAgICAgICAgIGppbXVDaGlsZElkRnJvbUxhYmVsID0gYCR7amltdUNoaWxkSWRGcm9tTGFiZWx9XyR7cmVwZWF0VGltZXN9YFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlkRnJvbUxhYmVsID0gaWRGcm9tTGFiZWwgPyBgJHtqaW11Q2hpbGRJZEZyb21MYWJlbH0tJHtpZEZyb21MYWJlbH1gIDogamltdUNoaWxkSWRGcm9tTGFiZWxcbiAgICAgICAgICBpZEZyb21MYWJlbFRvSWRGcm9tSWQudW5zaGlmdCh7IGppbXVDaGlsZElkRnJvbUxhYmVsLCBqaW11Q2hpbGRJZEZyb21JZDogZHMuamltdUNoaWxkSWQgfHwgZHMuaWQgfSlcbiAgICAgICAgICBkcyA9IGRzLnBhcmVudERhdGFTb3VyY2VcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAqIDIuIFVwZGF0ZSBhcHAgY29uZmlnIC0gcmVwbGFjZSBpZCBmcm9tIGxheWVyIGxhYmVsIHdpdGggaWQgZnJvbSBsYXllciBpZC5cbiAgICAgICAgKi9cbiAgICAgICAgLy8gMi4xIFVwZGF0ZSB3aWRnZXRzLlxuICAgICAgICBPYmplY3Qua2V5cyhhcHBDb25maWcud2lkZ2V0cyB8fCB7fSkuZm9yRWFjaCh3aWRnZXRJZCA9PiB7XG4gICAgICAgICAgaWYgKGFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXS51c2VEYXRhU291cmNlcz8uc29tZSh1ID0+IG5lZWRVcGRhdGVVc2VEcyh1LCBpZEZyb21MYWJlbCkpKSB7XG4gICAgICAgICAgICBjb25zdCB3aWRnZXRKc29uID0gYXBwQ29uZmlnLndpZGdldHNbd2lkZ2V0SWRdLmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSlcbiAgICAgICAgICAgIHdpZGdldEpzb24udXNlRGF0YVNvdXJjZXMgPSB3aWRnZXRKc29uLnVzZURhdGFTb3VyY2VzLm1hcCh1ID0+IHVwZGF0ZVVzZURhdGFTb3VyY2UodSwgaWRGcm9tTGFiZWwsIGNoaWxkRHMuaWQpKVxuICAgICAgICAgICAgaWYgKHdpZGdldEpzb24uY29uZmlnKSB7XG4gICAgICAgICAgICAgIHdpZGdldEpzb24uY29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh3aWRnZXRKc29uLmNvbmZpZykucmVwbGFjZShuZXcgUmVnRXhwKGlkRnJvbUxhYmVsLCAnZycpLCBjaGlsZERzLmlkKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZF0sIHdpZGdldEpzb24pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIDIuMiBVcGRhdGUgZGF0YSBzb3VyY2VzLlxuICAgICAgICBPYmplY3Qua2V5cyhhcHBDb25maWcuZGF0YVNvdXJjZXMgfHwge30pLmZvckVhY2goZHNJZCA9PiB7XG4gICAgICAgICAgLy8gMi4yLjEgVXBkYXRlIG91dHB1dCBkYXRhIHNvdXJjZXMuXG4gICAgICAgICAgaWYgKGFwcENvbmZpZy5kYXRhU291cmNlc1tkc0lkXS5vcmlnaW5EYXRhU291cmNlcz8uc29tZSh1ID0+IG5lZWRVcGRhdGVVc2VEcyh1LCBpZEZyb21MYWJlbCkpKSB7XG4gICAgICAgICAgICBjb25zdCBkc0pzb24gPSBhcHBDb25maWcuZGF0YVNvdXJjZXNbZHNJZF0uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KVxuICAgICAgICAgICAgZHNKc29uLm9yaWdpbkRhdGFTb3VyY2VzID0gZHNKc29uLm9yaWdpbkRhdGFTb3VyY2VzLm1hcCh1ID0+IHVwZGF0ZVVzZURhdGFTb3VyY2UodSwgaWRGcm9tTGFiZWwsIGNoaWxkRHMuaWQpKVxuICAgICAgICAgICAgYXBwQ29uZmlnID0gYXBwQ29uZmlnLnNldEluKFsnZGF0YVNvdXJjZXMnLCBkc0lkXSwgZHNKc29uKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIDIuMi4yIFVwZGF0ZSBhZGRlZCBkYXRhIHNvdXJjZXMuXG4gICAgICAgICAgY29uc3QgcGF0aFRvQ2hpbGREc0pzb24gPSBbXVxuICAgICAgICAgIGlkRnJvbUxhYmVsVG9JZEZyb21JZC5mb3JFYWNoKChpZCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHBhdGhUb0NoaWxkRHNKc29uLnB1c2goaWQuamltdUNoaWxkSWRGcm9tTGFiZWwpXG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IGlkRnJvbUxhYmVsVG9JZEZyb21JZC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgIHBhdGhUb0NoaWxkRHNKc29uLnB1c2goJ2NoaWxkRGF0YVNvdXJjZUpzb25zJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICAgIGlmIChhcHBDb25maWcuZGF0YVNvdXJjZXMuZ2V0SW4ocGF0aFRvQ2hpbGREc0pzb24pKSB7XG4gICAgICAgICAgICBjb25zdCBpZHMgPSBpZEZyb21MYWJlbFRvSWRGcm9tSWQuc2xpY2UoKS5yZXZlcnNlKClcbiAgICAgICAgICAgIGlmIChpZHNbMF0uamltdUNoaWxkSWRGcm9tSWQgIT09IGlkc1swXS5qaW11Q2hpbGRJZEZyb21MYWJlbCkge1xuICAgICAgICAgICAgICBjb25zdCBwYXRoVG9QYXJlbnREc0pzb24gPSBwYXRoVG9DaGlsZERzSnNvbi5zbGljZSgwLCBwYXRoVG9DaGlsZERzSnNvbi5sZW5ndGggLSAyKVxuICAgICAgICAgICAgICBjb25zdCBwYXJlbnREc0pzb24gPSBhcHBDb25maWcuZGF0YVNvdXJjZXMuZ2V0SW4ocGF0aFRvUGFyZW50RHNKc29uKS5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pXG4gICAgICAgICAgICAgIHBhcmVudERzSnNvbi5jaGlsZERhdGFTb3VyY2VKc29uc1tpZHNbMF0uamltdUNoaWxkSWRGcm9tSWRdID0gcGFyZW50RHNKc29uLmNoaWxkRGF0YVNvdXJjZUpzb25zW2lkc1swXS5qaW11Q2hpbGRJZEZyb21MYWJlbF1cbiAgICAgICAgICAgICAgcGFyZW50RHNKc29uLmNoaWxkRGF0YVNvdXJjZUpzb25zW2lkc1swXS5qaW11Q2hpbGRJZEZyb21JZF0uaWQgPSBjaGlsZERzLmlkXG4gICAgICAgICAgICAgIGRlbGV0ZSBwYXJlbnREc0pzb24uY2hpbGREYXRhU291cmNlSnNvbnNbaWRzWzBdLmppbXVDaGlsZElkRnJvbUxhYmVsXVxuXG4gICAgICAgICAgICAgIGFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ2RhdGFTb3VyY2VzJ10uY29uY2F0KHBhdGhUb1BhcmVudERzSnNvbiksIHBhcmVudERzSnNvbilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gMi4zIFVwZGF0ZSBtZXNzYWdlIGFjdGlvbnMuXG4gICAgICAgIE9iamVjdC5rZXlzKGFwcENvbmZpZy5tZXNzYWdlQ29uZmlncyB8fCB7fSkuZm9yRWFjaChtZXNzYWdlSWQgPT4ge1xuICAgICAgICAgIGNvbnN0IGhhc0FjdGlvblVzZURzV2hpY2hJZElzRnJvbUxhYmVsID0gYXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzW21lc3NhZ2VJZF0uYWN0aW9ucz8uc29tZShhID0+IGEudXNlRGF0YVNvdXJjZXM/LnNvbWUodSA9PiB1Py5tYWluRGF0YVNvdXJjZUlkID09PSBpZEZyb21MYWJlbCkgfHwgYS5jb25maWc/LmFjdGlvblVzZURhdGFTb3VyY2U/Lm1haW5EYXRhU291cmNlSWQgPT09IGlkRnJvbUxhYmVsIHx8IGEuY29uZmlnPy5tZXNzYWdlVXNlRGF0YVNvdXJjZT8ubWFpbkRhdGFTb3VyY2VJZCA9PT0gaWRGcm9tTGFiZWwpXG4gICAgICAgICAgaWYgKGhhc0FjdGlvblVzZURzV2hpY2hJZElzRnJvbUxhYmVsKSB7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlSnNvbiA9IGFwcENvbmZpZy5tZXNzYWdlQ29uZmlnc1ttZXNzYWdlSWRdLmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSlcbiAgICAgICAgICAgIG1lc3NhZ2VKc29uLmFjdGlvbnMgPSBtZXNzYWdlSnNvbi5hY3Rpb25zLm1hcChhID0+IHtcbiAgICAgICAgICAgICAgaWYgKGEudXNlRGF0YVNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICBhLnVzZURhdGFTb3VyY2VzID0gYS51c2VEYXRhU291cmNlcy5tYXAodSA9PiB1cGRhdGVVc2VEYXRhU291cmNlKHUsIGlkRnJvbUxhYmVsLCBjaGlsZERzLmlkKSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoYS5jb25maWc/LmFjdGlvblVzZURhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBhLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlID0gdXBkYXRlVXNlRGF0YVNvdXJjZShhLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlLCBpZEZyb21MYWJlbCwgY2hpbGREcy5pZClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoYS5jb25maWc/Lm1lc3NhZ2VVc2VEYXRhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgYS5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2UgPSB1cGRhdGVVc2VEYXRhU291cmNlKGEuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLCBpZEZyb21MYWJlbCwgY2hpbGREcy5pZClcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gYVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ21lc3NhZ2VDb25maWdzJywgbWVzc2FnZUlkXSwgbWVzc2FnZUpzb24pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIC8qKlxuICAgICAgICAqIDMuIFVwZGF0ZSBkYXRhIHNvdXJjZSBpbmZvIC0gbWVyZ2UgZGF0YSBzb3VyY2UgaW5mbyB3aGljaCBpZCBpcyBmcm9tIGxhYmVsIGFuZCBjdXJyZW50IGRhdGEgc291cmNlIGluZm8uXG4gICAgICAgICovXG4gICAgICAgIGlmICghY2hpbGREcy5pc0RhdGFTb3VyY2VTZXQgJiYgT2JqZWN0LmtleXMoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mbykuc29tZShkc0lkID0+IGRzSWQuaW5jbHVkZXMoaWRGcm9tTGFiZWwpKSkge1xuICAgICAgICAgIE9iamVjdC5rZXlzKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm8pLmZvckVhY2goZHNJZCA9PiB7XG4gICAgICAgICAgICBpZiAoZHNJZC5pbmNsdWRlcyhpZEZyb21MYWJlbCkpIHtcbiAgICAgICAgICAgICAgY29uc3QgcHJldkRzSWQgPSBkc0lkXG4gICAgICAgICAgICAgIGNvbnN0IG5ld0RzSWQgPSBkc0lkLnJlcGxhY2UoaWRGcm9tTGFiZWwsIGNoaWxkRHMuaWQpXG4gICAgICAgICAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy51cGRhdGVEYXRhU291cmNlSW5mbyhjaGlsZERzLmlkLCBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW3ByZXZEc0lkXS5tZXJnZShnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW25ld0RzSWRdIHx8IHt9KSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICBpZiAoY2hpbGREcy5nZXREYXRhVmlldyhDT05TVEFOVFMuU0VMRUNUSU9OX0RBVEFfVklFV19JRCkpIHtcbiAgICAgICAgICAgIHNlbGVjdGlvblZpZXdSZWFkeVByb21pc2VzLnB1c2goY2hpbGREcy5nZXREYXRhVmlldyhDT05TVEFOVFMuU0VMRUNUSU9OX0RBVEFfVklFV19JRCkucmVhZHkoKSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgaWYgKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBDb25maWcgIT09IGFwcENvbmZpZykge1xuICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmFwcENvbmZpZ0NoYW5nZWQoYXBwQ29uZmlnKSlcbiAgICAgIGNvbnN0IHJvb3REcyA9IHRoaXMuZ2V0Um9vdERhdGFTb3VyY2UoKSB8fCB0aGlzXG4gICAgICBjb25zdCByb290RHNKc29uID0gYXBwQ29uZmlnLmRhdGFTb3VyY2VzW3Jvb3REcy5pZF1cbiAgICAgIGlmIChyb290RHNKc29uKSB7XG4gICAgICAgIGxvZGFzaC5kZWZlcigoKSA9PiB7XG4gICAgICAgICAgLy8gVXBkYXRlIGRhdGEgc291cmNlIGpzb24gaW4gZGF0YSBzb3VyY2UgaW5zdGFuY2UuXG4gICAgICAgICAgdGhpcy5kYXRhU291cmNlTWFuYWdlci51cGRhdGVEYXRhU291cmNlQnlEYXRhU291cmNlSnNvbihyb290RHMsIHJvb3REc0pzb24pXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZChzZWxlY3Rpb25WaWV3UmVhZHlQcm9taXNlcykudGhlbigpXG4gIH1cblxuICAvKipcbiAgICogVGhlIGRhdGEgY2FuIGJlIGRlZmluZWQgaW4gc2VydmljZSwgaXRlbSBkYXRhLlxuICAgKi9cbiAgYXN5bmMgZmV0Y2hEYXRhRGVmaW5pdGlvbnMgKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGZldGNoU2VydmljZURlZmluaXRpb25Qcm9taXNlID0gdGhpcy5mZXRjaFNlcnZpY2VEZWZpbml0aW9uKCkudGhlbigoKSA9PiB7XG4gICAgICBpZiAodGhpcy5zZXJ2aWNlRGVmaW5pdGlvbj8udGFibGVzPy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuc2VydmljZURlZmluaXRpb24udGFibGVzID0gdGhpcy5zZXJ2aWNlRGVmaW5pdGlvbi50YWJsZXMubWFwKHQgPT4gKHsgLi4udCwgdHlwZTogU3VwcG9ydGVkTGF5ZXJTZXJ2aWNlVHlwZXMuVGFibGUgfSkpXG4gICAgICB9XG4gICAgfSlcbiAgICBjb25zdCBzb3VyY2VEYXRhUHJvbWlzZXM6IEFycmF5PFByb21pc2U8YW55Pj4gPSBbZmV0Y2hTZXJ2aWNlRGVmaW5pdGlvblByb21pc2VdXG4gICAgaWYgKCF0aGlzLmxheWVyICYmICF0aGlzLnVybCAmJiB0aGlzLml0ZW1JZCkgeyAvLyBtdWxpdHBsZS1sYXllcnMgZmVhdHVyZSBjb2xsZWN0aW9uIGl0ZW0gb3IgZ3JvdXAgbGF5ZXIgaXRlbVxuICAgICAgc291cmNlRGF0YVByb21pc2VzLnB1c2godGhpcy5mZXRjaEl0ZW1EYXRhKCksIHRoaXMuZmV0Y2hJdGVtSW5mbygpKVxuICAgIH1cbiAgICBhd2FpdCBQcm9taXNlLmFsbChzb3VyY2VEYXRhUHJvbWlzZXMpXG4gIH1cblxuICBhc3luYyBmZXRjaFNlcnZpY2VEZWZpbml0aW9uICgpOiBQcm9taXNlPFNlcnZpY2VEZWZpbml0aW9uPiB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHsgLy8gZnJvbSBtYXAgaXRlbVxuICAgICAgaWYgKCh0aGlzLmxheWVyIGFzIGFueSkubG9hZEFsbCkge1xuICAgICAgICBhd2FpdCAodGhpcy5sYXllciBhcyBhbnkpLmxvYWRBbGwoKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sYXllci5sb2FkKClcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlU2VydmljZURlZmluaXRpb25CeUxheWVyKClcbiAgICAgIHJldHVybiB0aGlzLmdldFNlcnZpY2VEZWZpbml0aW9uKClcbiAgICB9IGVsc2UgaWYgKHRoaXMudXJsKSB7IC8vIGZyb20gc2VydmljZSB1cmxcbiAgICAgIHJldHVybiB0aGlzLmZldGNoU2VydmljZURlZmluaXRpb25CeVVybCgpXG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbClcbiAgfVxuXG4gIGFzeW5jIGZldGNoU2NoZW1hICgpOiBQcm9taXNlPElNRGF0YVNvdXJjZVNjaGVtYT4ge1xuICAgIGNvbnN0IGRzcyA9IHRoaXMuZ2V0Q2hpbGREYXRhU291cmNlcygpXG5cbiAgICBjb25zdCBsYWJlbCA9IGF3YWl0IGRhdGFTb3VyY2VVdGlscy5nZXRPcmlnaW5EYXRhTGFiZWwodGhpcylcbiAgICBsZXQgc2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEgPSBJbW11dGFibGUoeyBjaGlsZFNjaGVtYXM6IHt9LCBsYWJlbCB9KSBhcyBJTURhdGFTb3VyY2VTY2hlbWFcbiAgICBkc3MuZm9yRWFjaCgoZHM6IFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCB8IEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsIHwgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UsIGkpID0+IHtcbiAgICAgIGNvbnN0IGxheWVyU2NoZW1hID0gZHMuZ2V0RmV0Y2hlZFNjaGVtYSgpXG4gICAgICBzY2hlbWEgPSBzY2hlbWEuc2V0SW4oWydjaGlsZFNjaGVtYXMnLCBkcy5qaW11Q2hpbGRJZF0sIGxheWVyU2NoZW1hKVxuICAgIH0pXG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHNjaGVtYSlcbiAgfVxuXG4gIGdldFNlcnZpY2VEZWZpbml0aW9uICgpOiBTZXJ2aWNlRGVmaW5pdGlvbiB7XG4gICAgaWYgKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpIHtcbiAgICAgIHJldHVybiAodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpIGFzIEFic3RyYWN0TGF5ZXJGb2xkZXJEYXRhU291cmNlKS5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNlcnZpY2VEZWZpbml0aW9uXG4gIH1cblxuICBnZXRJdGVtSW5mbyAoKTogSUl0ZW0ge1xuICAgIGlmICh0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gKHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSBhcyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSkuZ2V0SXRlbUluZm8oKVxuICAgIH1cbiAgICByZXR1cm4gc3VwZXIuZ2V0SXRlbUluZm8oKVxuICB9XG5cbiAgcHJvdGVjdGVkIGFzeW5jIGNyZWF0ZUNoaWxkRGF0YVNvdXJjZUJ5SWQgKGNoaWxkRHNJZDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZElkOiBzdHJpbmcpOiBQcm9taXNlPERhdGFTb3VyY2U+IHtcbiAgICBjb25zdCBvcHRpb25zID0gdGhpcy5jcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlJZChjaGlsZERzSWQsIGppbXVDaGlsZElkLCBjaGlsZElkKVxuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBEYXRhU291cmNlRXJyb3IoY2hpbGREc0lkLCAnRG8gbm90IHN1cHBvcnQgdGhpcyB0eXBlIG9mIGRhdGEuJykpXG4gICAgfVxuICAgIGNvbnN0IGNoaWxkRHMgPSBhd2FpdCB0aGlzLmRhdGFTb3VyY2VNYW5hZ2VyLmNyZWF0ZURhdGFTb3VyY2Uob3B0aW9ucylcbiAgICB0aGlzLnVwZGF0ZUNoaWxkRGF0YXNvdXJjZXNHREJWZXJzaW9uKFtjaGlsZERzXSlcbiAgICByZXR1cm4gY2hpbGREc1xuICB9XG5cbiAgcHJvdGVjdGVkIGNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkRnJvbVVybCAoY2hpbGREc0lkOiBzdHJpbmcsIGppbXVDaGlsZElkOiBzdHJpbmcsIGNoaWxkSWQ6IHN0cmluZyk6IExheWVyRm9sZGVyQ2hpbGREYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgICBpZiAodGhpcy51cmwpIHtcbiAgICAgIGNvbnN0IGxheWVySW5mbyA9IHRoaXMuZmluZExheWVyRGVmaW5pdGlvbkluZm8oY2hpbGRJZClcbiAgICAgIGlmICghbGF5ZXJJbmZvPy51cmwpIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5TGF5ZXJEZWZpbml0aW9uKGxheWVySW5mby5wYXJ0YWlsTGF5ZXJEZWZpbml0aW9uLCBsYXllckluZm8udXJsLCBqaW11Q2hpbGRJZCwgY2hpbGREc0lkLCBsYXllckluZm8ub3JkZXIpXG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHByb3RlY3RlZCBjcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlMYXllckRlZmluaXRpb24gKGxheWVyRGVmaW5pdGlvbjogU2VydmljZURlZmluaXRpb24sIHVybDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZERzSWQ6IHN0cmluZywgb3JkZXI6IG51bWJlcik6IE9taXQ8TGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsICdsYXllcic+IHtcbiAgICBjb25zdCBkc0pzb24gPSB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZUpzb25CeUxheWVyRGVmaW5pdGlvbihsYXllckRlZmluaXRpb24sIHVybCwgamltdUNoaWxkSWQsIGNoaWxkRHNJZClcbiAgICBpZiAoZHNKc29uKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogY2hpbGREc0lkLFxuICAgICAgICBkYXRhU291cmNlSnNvbjogZHNKc29uLFxuICAgICAgICBwYXJlbnREYXRhU291cmNlOiB0aGlzLFxuICAgICAgICBqaW11Q2hpbGRJZCxcbiAgICAgICAgb3JkZXJcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ2hpbGREYXRhU291cmNlSnNvbkJ5TGF5ZXJEZWZpbml0aW9uIChsYXllckRlZmluaXRpb246IFNlcnZpY2VEZWZpbml0aW9uLCB1cmw6IHN0cmluZywgamltdUNoaWxkSWQ6IHN0cmluZywgY2hpbGREc0lkOiBzdHJpbmcpOiBJTURhdGFTb3VyY2VKc29uIHtcbiAgICBpZiAoIWxheWVyRGVmaW5pdGlvbiB8fCAhY2hpbGREc0lkKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIC8vIF9qaW11Q2hpbGRJZEZyb21MYWJlbCBpcyB0byBzdXBwb3J0IGRhdGEgc291cmNlIGJlZm9yZSBkZXYxLjE2LCBzZWUgdXBncmFkZUNoaWxkRHNzSWQgZm9yIG1vcmUgZGV0YWlscy5cbiAgICBjb25zdCBfamltdUNoaWxkSWRGcm9tTGFiZWwgPSBkYXRhU291cmNlVXRpbHMuX2dldEZpeGVkTGF5ZXJJZEJ5TGF5ZXJEZWZpbml0aW9uKGxheWVyRGVmaW5pdGlvbikgfHwgZGF0YVNvdXJjZVV0aWxzLmdldExhYmVsRnJvbUFyY0dJU1NlcnZpY2VVcmwodXJsKVxuICAgIGNvbnN0IHNjaGVtYUluQ29uZmlnID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnNjaGVtYT8uY2hpbGRTY2hlbWFzPy5bamltdUNoaWxkSWRdIHx8IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWE/LmNoaWxkU2NoZW1hcz8uW19qaW11Q2hpbGRJZEZyb21MYWJlbF1cbiAgICBjb25zdCBkc0pzb25JbkNvbmZpZyA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5jaGlsZERhdGFTb3VyY2VKc29ucz8uW2ppbXVDaGlsZElkXSB8fCB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuY2hpbGREYXRhU291cmNlSnNvbnM/LltfamltdUNoaWxkSWRGcm9tTGFiZWxdXG5cbiAgICBsZXQgZHNKc29uOiBJTURhdGFTb3VyY2VKc29uID0gZGF0YVNvdXJjZUpzb25DcmVhdG9yLmNyZWF0ZURhdGFTb3VyY2VKc29uQnlMYXllckRlZmluaXRpb24oY2hpbGREc0lkLCBsYXllckRlZmluaXRpb24sIHVybCwgZHNKc29uSW5Db25maWcsIHNjaGVtYUluQ29uZmlnKVxuXG4gICAgaWYgKGRzSnNvbikge1xuICAgICAgaWYgKHRoaXMucG9ydGFsVXJsKSB7XG4gICAgICAgIGRzSnNvbiA9IGRzSnNvbi5zZXQoJ3BvcnRhbFVybCcsIHRoaXMucG9ydGFsVXJsKVxuICAgICAgfVxuICAgICAgaWYgKHRoaXMuaXRlbUlkKSB7XG4gICAgICAgIGRzSnNvbiA9IGRzSnNvbi5zZXQoJ2l0ZW1JZCcsIHRoaXMuaXRlbUlkKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBkc0pzb25cbiAgfVxuXG4gIHByb3RlY3RlZCBmaW5kTGF5ZXJEZWZpbml0aW9uSW5mbyAoY2hpbGRJZDogc3RyaW5nKTogeyBwcm94eVVybDogc3RyaW5nLCB1cmw6IHN0cmluZywgb3JkZXI6IG51bWJlciwgcGFydGFpbExheWVyRGVmaW5pdGlvbjogUGFydGlhbDxTZXJ2aWNlRGVmaW5pdGlvbj4gfSB7XG4gICAgY29uc3QgbGF5ZXJEZWZzID0gdGhpcy5nZXRQYXJ0aWFsTGF5ZXJBbmRUYWJsZURlZmluaXRpb25zKCkuY29uY2F0KHRoaXMuZ2V0UGFydGlhbFN1YkxheWVyRGVmaW5pdGlvbnMoKSlcbiAgICBsZXQgbGF5ZXJJbmZvOiB7IHByb3h5VXJsOiBzdHJpbmcsIHVybDogc3RyaW5nLCBvcmRlcjogbnVtYmVyLCBwYXJ0YWlsTGF5ZXJEZWZpbml0aW9uOiBQYXJ0aWFsPFNlcnZpY2VEZWZpbml0aW9uPiB9XG4gICAgbGF5ZXJEZWZzLnNvbWUoKGxheWVyRGVmLCBpKSA9PiB7XG4gICAgICBjb25zdCBsYXllclVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXRGdWxsQXJjR0lTU2VydmljZVVybCh0aGlzLnVybCwgdHJ1ZSwgbGF5ZXJEZWYpXG4gICAgICBjb25zdCBsYXllclNvdXJjZVVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXREYXRhU291cmNlU291cmNlVXJsKGxheWVyVXJsKVxuICAgICAgaWYgKHRoaXMuZ2V0Q2hpbGRJZEJ5TGF5ZXJEZWZpbml0aW9uKGxheWVyRGVmLCBsYXllclNvdXJjZVVybCkgPT09IGNoaWxkSWQpIHtcbiAgICAgICAgbGF5ZXJJbmZvID0ge1xuICAgICAgICAgIHByb3h5VXJsOiBsYXllclVybCxcbiAgICAgICAgICB1cmw6IGxheWVyU291cmNlVXJsLFxuICAgICAgICAgIHBhcnRhaWxMYXllckRlZmluaXRpb246IGxheWVyRGVmLFxuICAgICAgICAgIG9yZGVyOiBpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0pXG5cbiAgICByZXR1cm4gbGF5ZXJJbmZvXG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVNlcnZpY2VEZWZpbml0aW9uQnlMYXllciAoKSB7XG4gICAgaWYgKCh0aGlzLmxheWVyIGFzIGFueSk/LnNvdXJjZUpTT04pIHtcbiAgICAgIHRoaXMuc2VydmljZURlZmluaXRpb24gPSAodGhpcy5sYXllciBhcyBhbnkpLnNvdXJjZUpTT05cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXJ2aWNlRGVmaW5pdGlvbiA9IHtcbiAgICAgICAgbmFtZTogdGhpcy5sYXllcj8udGl0bGVcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGZldGNoU2VydmljZURlZmluaXRpb25CeVVybCAoKTogUHJvbWlzZTxTZXJ2aWNlRGVmaW5pdGlvbj4ge1xuICAgIGlmICh0aGlzLmdldFNlcnZpY2VEZWZpbml0aW9uKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFNlcnZpY2VEZWZpbml0aW9uKClcbiAgICB9XG5cbiAgICBpZiAodGhpcy51cmwpIHtcbiAgICAgIGNvbnN0IGRlZmluaXRpb24gPSBhd2FpdCBTZXJ2aWNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmZldGNoU2VydmljZUluZm8odGhpcy51cmwpLnRoZW4ocmVzID0+IHJlcy5kZWZpbml0aW9uKVxuXG4gICAgICBpZiAoIWRlZmluaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgaWYgKCFkZWZpbml0aW9uLm5hbWUpIHtcbiAgICAgICAgZGVmaW5pdGlvbi5uYW1lID0gZGF0YVNvdXJjZVV0aWxzLmdldExhYmVsRnJvbUFyY0dJU1NlcnZpY2VVcmwodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnVybClcbiAgICAgIH1cblxuICAgICAgLy8gU3ViIGxheWVyIGRvZXNuJ3QgaGF2ZSB0eXBlLlxuICAgICAgaWYgKGRlZmluaXRpb24uc3ViTGF5ZXJzPy5zb21lKGwgPT4gIWwudHlwZSkpIHtcbiAgICAgICAgY29uc3QgYWxsTGF5ZXJEZWZzID0gKHRoaXMucGFyZW50RGF0YVNvdXJjZSBhcyBBYnN0cmFjdEFyY0dJU0xheWVyRm9sZGVyRGF0YVNvdXJjZSk/LmdldFNlcnZpY2VEZWZpbml0aW9uID8gKHRoaXMucGFyZW50RGF0YVNvdXJjZSBhcyBBYnN0cmFjdEFyY0dJU0xheWVyRm9sZGVyRGF0YVNvdXJjZSk/LmdldFNlcnZpY2VEZWZpbml0aW9uKCkgOiAoYXdhaXQgU2VydmljZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5mZXRjaFNlcnZpY2VJbmZvKGAke2RhdGFTb3VyY2VVdGlscy5nZXRGdWxsQXJjR0lTU2VydmljZVVybCh0aGlzLnVybCwgZmFsc2UpfS9sYXllcnNgKS50aGVuKHJlcyA9PiByZXMuZGVmaW5pdGlvbikpXG4gICAgICAgIGRlZmluaXRpb24uc3ViTGF5ZXJzID0gZGVmaW5pdGlvbi5zdWJMYXllcnMubWFwKGwgPT4ge1xuICAgICAgICAgIGNvbnN0IGRlZiA9IGFsbExheWVyRGVmcz8ubGF5ZXJzPy5maW5kKGFsbERlZiA9PiBhbGxEZWYuaWQgPT09IGwuaWQpXG4gICAgICAgICAgcmV0dXJuIHsgLi4ubCwgLi4uZGVmIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIHRoaXMuc2VydmljZURlZmluaXRpb24gPSBkZWZpbml0aW9uXG4gICAgICByZXR1cm4gdGhpcy5zZXJ2aWNlRGVmaW5pdGlvblxuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRGF0YVNvdXJjZUVycm9yKHRoaXMuaWQsICdGYWlsZWQgdG8gZmV0Y2ggc2VydmljZSBkZWZpbml0aW9uLCBuZWVkIHVybC4nKSlcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UGFydGlhbFN1YkxheWVyRGVmaW5pdGlvbnMgKCk6IEFycmF5PFBhcnRpYWw8U2VydmljZURlZmluaXRpb24+PiB7XG4gICAgLy8gVGhlIGxheWVyIGRlZmluaXRpb24gaW4gdGhlIHNlcnZlciBkZWZpbml0aW9uIGlzIG1pc3Npbmcgc29tZSBmaWVsZHMsIG5vdCBhIGNvbXBsZXRlIGxheWVyIGRlZmluaXRpb24uXG4gICAgcmV0dXJuIHRoaXMuZ2V0U2VydmljZURlZmluaXRpb24oKT8uc3ViTGF5ZXJzIHx8IFtdXG4gIH1cblxuICBwcml2YXRlIGdldFBhcnRpYWxMYXllckFuZFRhYmxlRGVmaW5pdGlvbnMgKCk6IEFycmF5PFBhcnRpYWw8U2VydmljZURlZmluaXRpb24+PiB7XG4gICAgLy8gVGhlIGxheWVyIGRlZmluaXRpb24gaW4gdGhlIHNlcnZlciBkZWZpbml0aW9uIGlzIG1pc3Npbmcgc29tZSBmaWVsZHMsIG5vdCBhIGNvbXBsZXRlIGxheWVyIGRlZmluaXRpb24uXG4gICAgY29uc3QgbGF5ZXJzID0gdGhpcy5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpPy5sYXllcnMgfHwgW11cbiAgICBjb25zdCB0YWJsZXMgPSB0aGlzLmdldFNlcnZpY2VEZWZpbml0aW9uKCk/LnRhYmxlcyB8fCBbXVxuICAgIHJldHVybiBsYXllcnMuY29uY2F0KHRhYmxlcylcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXRDaGlsZElkQnlMYXllckRlZmluaXRpb24gKGxheWVyRGVmaW5pdGlvbjogU2VydmljZURlZmluaXRpb24sIHVybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZGF0YVNvdXJjZVV0aWxzLmdldEZpeGVkTGF5ZXJJZEJ5TGF5ZXJEZWZpbml0aW9uKGxheWVyRGVmaW5pdGlvbikgfHwgZGF0YVNvdXJjZVV0aWxzLmdldExhYmVsRnJvbUFyY0dJU1NlcnZpY2VVcmwodXJsKVxuICB9XG5cbiAgcHJvdGVjdGVkIGdldENoaWxkSWRCeUxheWVyIChsYXllcjogX19lc3JpLkxheWVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZGF0YVNvdXJjZVV0aWxzLmdldEZpeGVkTGF5ZXJJZEJ5TGF5ZXIobGF5ZXIpIHx8IGRhdGFTb3VyY2VVdGlscy5nZXRMYWJlbEZyb21BcmNHSVNTZXJ2aWNlVXJsKGRhdGFTb3VyY2VVdGlscy5nZXRVcmxCeUxheWVyKGxheWVyKSlcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXRDaGlsZElkQnlTdWJMYXllciAoc3ViTGF5ZXI6IF9fZXNyaS5TdWJsYXllcik6IHN0cmluZyB7XG4gICAgLyoqXG4gICAgICogSW4gbW9zdCBjYXNlcywgc3VibGF5ZXIgSUQgaXMgc2FtZSB3aXRoIHRoZSBsYXllciBkZWZpbml0aW9uIElELCBzbyB3ZSB1c2VkIHRvIGNyZWF0ZSBjaGlsZCBkYXRhIHNvdXJjZSBieSBzdWJsYXllcidzIGxheWVyIGRlZmluaXRpb24uXG4gICAgICogTm93LCB3ZSB3YW50IHRvIGNoYW5nZSBiYWNrIHRvIHVzZSBzdWJsYXllciwgYnV0IHdlIGZvdW5kIGlzc3VlICMxNDU5NCwgIzE2NTg4LiBJbiB0aGUgaXNzdWUncyBzYW1wbGUgbWFwLCB0aGUgc3VibGF5ZXIgSUQgaXMgZGlmZmVyZW50IHdpdGggbGF5ZXIgZGVmaW5pdGlvbidzIElELlxuICAgICAqIFRvIG1ha2UgcHJldmlvdXMgYXBwIHdvcmssIHdlIGtlZXAgdXNpbmcgc3VibGF5ZXIncyBsYXllciBkZWZpbml0aW9uLlxuICAgICAqL1xuICAgIGNvbnN0IGZpeGVkU3ViTGF5ZXIgPSB7IC4uLnN1YkxheWVyLCBpZDogKHN1YkxheWVyPy5zb3VyY2UgYXMgYW55KT8ubWFwTGF5ZXJJZCA/PyBzdWJMYXllci5pZCB9IGFzIF9fZXNyaS5TdWJsYXllclxuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuZ2V0Rml4ZWRMYXllcklkQnlMYXllcihmaXhlZFN1YkxheWVyKSB8fCBkYXRhU291cmNlVXRpbHMuZ2V0TGFiZWxGcm9tQXJjR0lTU2VydmljZVVybChkYXRhU291cmNlVXRpbHMuZ2V0VXJsQnlMYXllcihzdWJMYXllcikpXG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0Q2hpbGRJZHNCeVVybCAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0aGlzLmdldFBhcnRpYWxMYXllckFuZFRhYmxlRGVmaW5pdGlvbnMoKS5jb25jYXQodGhpcy5nZXRQYXJ0aWFsU3ViTGF5ZXJEZWZpbml0aW9ucygpKS5tYXAobCA9PiB0aGlzLmdldENoaWxkSWRCeUxheWVyRGVmaW5pdGlvbihsLCBkYXRhU291cmNlVXRpbHMuZ2V0RnVsbEFyY0dJU1NlcnZpY2VVcmwodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnVybCwgdHJ1ZSwgbCkpKVxuICB9XG5cbiAgZ2V0RGF0YVNvdXJjZUlkQnlMYXllciAobGF5ZXJPclN1YkxheWVyOiBfX2VzcmkuTGF5ZXIgfCBfX2VzcmkuU3VibGF5ZXIpOiBzdHJpbmcge1xuICAgIGxldCBjaGlsZElkID0gJydcblxuICAgIGlmIChsYXllck9yU3ViTGF5ZXIuZGVjbGFyZWRDbGFzcyA9PT0gJ2VzcmkubGF5ZXJzLnN1cHBvcnQuU3VibGF5ZXInKSB7XG4gICAgICBjaGlsZElkID0gdGhpcy5nZXRDaGlsZElkQnlTdWJMYXllcihsYXllck9yU3ViTGF5ZXIgYXMgX19lc3JpLlN1YmxheWVyKVxuICAgIH0gZWxzZSB7XG4gICAgICBjaGlsZElkID0gdGhpcy5nZXRDaGlsZElkQnlMYXllcihsYXllck9yU3ViTGF5ZXIgYXMgX19lc3JpLkxheWVyKVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmdldENoaWxkRGF0YVNvdXJjZUlkKGNoaWxkSWQpXG4gIH1cblxuICBwcm90ZWN0ZWQgdXBkYXRlQ2hpbGREYXRhc291cmNlc0dEQlZlcnNpb24gKGNoaWxkRHNzOiBEYXRhU291cmNlW10pIHtcbiAgICBpZiAodGhpcy5nZXRJbmZvKCkuZ2RiVmVyc2lvbikge1xuICAgICAgY2hpbGREc3MuZm9yRWFjaChkcyA9PiB7XG4gICAgICAgIGlmIChkcy50eXBlID09PSBEYXRhU291cmNlVHlwZXMuRmVhdHVyZUxheWVyKSB7XG4gICAgICAgICAgKGRzIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2UpLmNoYW5nZUdEQlZlcnNpb24odGhpcy5nZXRJbmZvKCkuZ2RiVmVyc2lvbilcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBnZXRHREJWZXJzaW9uICgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmdldEluZm8oKS5nZGJWZXJzaW9uXG4gIH1cblxuICBjaGFuZ2VHREJWZXJzaW9uIChnZGJWZXJzaW9uOiBzdHJpbmcpIHtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuY2hhbmdlRGF0YVNvdXJjZUdEQlZlcnNpb24odGhpcy5pZCwgZ2RiVmVyc2lvbikpXG4gICAgdGhpcy51cGRhdGVDaGlsZERhdGFzb3VyY2VzR0RCVmVyc2lvbih0aGlzLmdldEFsbENoaWxkRGF0YVNvdXJjZXMoKSlcbiAgICBqaW11SGlzdG9yeS5jaGFuZ2VRdWVyeU9iamVjdEJ5RGF0YVNvdXJjZUdEQlZlcnNpb24odGhpcy5pZCwgZ2RiVmVyc2lvbilcbiAgfVxufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3REYXRhU291cmNlIH0gZnJvbSAnLi9hYnN0cmFjdC1kYXRhLXNvdXJjZSdcbmltcG9ydCB7IHR5cGUgTG9hZGFibGVEYXRhU291cmNlLCB0eXBlIERhdGFSZWNvcmQsIERhdGFTb3VyY2VTdGF0dXMgfSBmcm9tICcuLi9pbnRlcmZhY2VzJ1xuXG4vKiogQGlnbm9yZSAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0TG9hZGFibGVEYXRhU291cmNlIGV4dGVuZHMgQWJzdHJhY3REYXRhU291cmNlIGltcGxlbWVudHMgTG9hZGFibGVEYXRhU291cmNlIHtcbiAgYXN5bmMgbG9hZCAoKTogUHJvbWlzZTxEYXRhUmVjb3JkW10+IHtcbiAgICB0aGlzLnNldFN0YXR1cyhEYXRhU291cmNlU3RhdHVzLkxvYWRpbmcpXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9Mb2FkKCkudGhlbihyZWNvcmRzID0+IHtcbiAgICAgIHRoaXMucmVjb3JkcyA9IHJlY29yZHNcbiAgICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZGVkKVxuICAgICAgcmV0dXJuIHRoaXMucmVjb3Jkc1xuICAgIH0pXG4gIH1cblxuICBhYnN0cmFjdCBkb0xvYWQgKCk6IFByb21pc2U8RGF0YVJlY29yZFtdPlxufVxuIiwiaW1wb3J0IHsgZ2V0QXBwU3RvcmUsIHV0aWxzLCBhcHBBY3Rpb25zLCBJbW11dGFibGUsIEFwcE1vZGUsIENPTlNUQU5UUywgZGF0YVNvdXJjZVV0aWxzLCBsb2Rhc2ggfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBBYnN0cmFjdERhdGFTb3VyY2UgfSBmcm9tICcuL2Fic3RyYWN0LWRhdGEtc291cmNlJ1xuaW1wb3J0IHsgdHlwZSBRdWVyaWFibGVEYXRhU291cmNlLCB0eXBlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VTdGF0dXMsIHR5cGUgUXVlcnlPcHRpb25zLCBRdWVyeVNjb3BlLCB0eXBlIFF1ZXJ5UmVzdWx0LCB0eXBlIERhdGFSZWNvcmQsIHR5cGUgUXVlcnlQYXJhbXMsIHR5cGUgSU1RdWVyeVBhcmFtcywgdHlwZSBHZXRDdXJyZW50UXVlcnlQYXJhbXNPcHRpb25zLCB0eXBlIFF1ZXJpYWJsZVNlbGVjdE9wdGlvbnMsIHR5cGUgUXVlcnlQcm9ncmVzc0NhbGxiYWNrLCB0eXBlIENhcGFiaWxpdGllcywgdHlwZSBRdWVyaWFibGVVc2VkRmllbGRzT3B0aW9ucyB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyBDYXBhYmlsaXRpZXNJbXBsIH0gZnJvbSAnLi4vc3VwcG9ydC9jYXBhYmlsaXRpZXMtaW1wbCdcblxuY29uc3QgeyBERUZBVUxUX1FVRVJZX1BBR0VfU0laRSwgREFUQV9WSUVXX0lEX0ZPUl9OT19TRUxFQ1RJT04sIE9VVFBVVF9EQVRBX1ZJRVdfSUQsIFNFTEVDVElPTl9EQVRBX1ZJRVdfSUQgfSA9IENPTlNUQU5UU1xuXG5pbnRlcmZhY2UgUGFnZVByb21pc2UgeyBwcm9taXNlOiBQcm9taXNlPGJvb2xlYW4+LCBmaWVsZHM6IHN0cmluZ1tdIHwgJyonIH1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSBleHRlbmRzIEFic3RyYWN0RGF0YVNvdXJjZSBpbXBsZW1lbnRzIFF1ZXJpYWJsZURhdGFTb3VyY2Uge1xuICBsYXN0VXBkYXRlVGltZTogRGF0ZVxuICBpc1NxbENhc2VTZW5zaXRpdmU6IGJvb2xlYW5cblxuICBwcml2YXRlIGxhc3RRdWVyeUlkOiBzdHJpbmdcbiAgcHJpdmF0ZSBsYXN0UXVlcnlQYXJhbXM6IFF1ZXJ5UGFyYW1zXG4gIHByaXZhdGUgbGFzdENvdW50UXVlcnlQYXJhbXM6IFF1ZXJ5UGFyYW1zXG4gIHByaXZhdGUgbGFzdFJlZnJlc2hUaW1lOiBEYXRlXG5cbiAgLyoqXG4gICAqIERhdGEgd2lsbCBiZSBjYWNoZWQgaGVyZSwgbm90IHRoaXMucmVjb3Jkcy5cbiAgICpcbiAgICogV2hlbiBzZWxlY3RSZWNvcmRCeUlkLCBzb21lIHNlbGVjdGVkIHJlY29yZHMgbWF5IGJlIHB1dCBpbiB0aGlzLnJlY29yZHMsIHNvIHRoZXkgYXJlIG5vdCBpbiB0aGUgcGFnZXMuXG4gICAqL1xuICBwcml2YXRlIHBhZ2VzOiB7IFtwYWdlSWQ6IG51bWJlcl06IERhdGFSZWNvcmRbXSB9ID0ge31cblxuICBwcml2YXRlIHBhZ2VQcm9taXNlczogeyBbcGFnZUlkOiBudW1iZXJdOiBQYWdlUHJvbWlzZSB9ID0ge31cbiAgLyoqXG4gICAqIFByb21pc2VzIHRvIGxvYWQgbWlzc2luZyBmaWVsZHMgZm9yIGV2ZXJ5IHBhZ2UuXG4gICAqIFRoZSBwcm9taXNlcyBjb250YWluIGEgc3BlY2FpbCBwYWdlIChpdHMgaWQgaXMgdmFyaWFibGUgU0VMRUNUSU9OX0RBVEFfVklFV19JRCksIGl0IGlzIHRoZSBwcm9taXNlIHRvIGxvYWQgbWlzc2luZyBmaWVsZHMgZm9yIHNvdXJjZSByZWNvcmRzIG9mIHNlbGVjdGlvbiB2aWV3LlxuICAgKi9cbiAgcHJpdmF0ZSBsb2FkTWlzc2luZ0ZpZWxkc0J5UGFnZVByb21pc2VzOiB7IFtwYWdlSWQ6IG51bWJlcl06IFBhZ2VQcm9taXNlLCBbU0VMRUNUSU9OX0RBVEFfVklFV19JRF0/OiBQYWdlUHJvbWlzZSB9ID0ge31cbiAgLyoqXG4gICAqIFByb21pc2UgdG8gbG9hZCBtaXNzaW5nIGZpZWxkcyBmb3IgYWxsIHBhZ2VzLlxuICAgKi9cbiAgcHJpdmF0ZSBsb2FkTWlzc2luZ0ZpZWxkc0ZvckFsbFBhZ2VQcm9taXNlOiB7IHByb21pc2U6IFByb21pc2U8Ym9vbGVhbj4sIGZpZWxkczogeyBbcGFnZUlkOiBudW1iZXJdOiBzdHJpbmdbXSB8ICcqJyB9IH1cbiAgLyoqXG4gICAqIElmIGRlbGF5IGFuZCBtZXJnZSBtdWx0aXBsZSBjYWxscyBvZiBsb2FkIG1pc3NpbmcgZmllbGRzLCB3aWxsIHNhdmUgdXNlZCBmaWVsZHMgb2YgdGhlc2UgY2FsbHMgaGVyZSBhbmQgdGhlbiBzZW5kIG9uZSByZXF1ZXN0LlxuICAgKi9cbiAgcHJpdmF0ZSB1c2VkRmllbGRzSW5UaW1lV2luZG93OiBzdHJpbmdbXSB8ICcqJ1xuICAvKipcbiAgICogSWYgZGVsYXkgYW5kIG1lcmdlIG11bHRpcGxlIGNhbGxzIG9mIGxvYWQgbWlzc2luZyBmaWVsZHMsIHdpbGwgc2F2ZSB0aW1lciBoZXJlLlxuICAgKi9cbiAgcHJpdmF0ZSBsb2FkTWlzc2luZ0ZpZWxkc1RpbWVyOiBOb2RlSlMuVGltZW91dFxuICBwcml2YXRlIGNhcGFiaWxpdGllczogQ2FwYWJpbGl0aWVzXG4gIHByaXZhdGUgY291bnRQcm9taXNlXG4gIHByaXZhdGUgYnlJZFByb21pc2VcblxuICBwcml2YXRlIGF1dG9SZWZyZXNoSGFuZGxlXG4gIHByaXZhdGUgX2NvdW50XG4gIC8qKlxuICAgKiBXaWxsIGNhbGwgdGhpcyBmdW5jdGlvbiBhZnRlciB0aGUgZmlyc3QgdGltZSB3aWRnZXQvY29tcG9uZW50cyBjYWxsIGBzZXRTb3VyY2VSZWNvcmRzYC5cbiAgICovXG4gIHByaXZhdGUgb25jZVNldFNvdXJjZVJlY29yZHM6ICgpID0+IHZvaWRcblxuICBwcml2YXRlIHJlYWRvbmx5IHRocm90dGxlUXVlcnlSZWNvcmRzQnlJZFdpdGhDdXJyZW50UXVlcnlQYXJhbXMgPSBsb2Rhc2gudGhyb3R0bGUodGhpcy5xdWVyeVJlY29yZHNCeUlkV2l0aEN1cnJlbnRRdWVyeVBhcmFtcywgMjAwKVxuICAvKipcbiAgICogUGVuZGluZyBwcm9taXNlIHdoaWNoIGlzIHVzZWQgdG8gcXVlcnkgc2VsZWN0ZWQgcmVjb3JkcyBwcmVzZXQgYmVmb3JlIGRhdGEgc291cmNlIGlzIHJlYWR5LlxuICAgKiBFLmcuIHNlbGVjdGVkIHJlY29yZCBpZCBpbiBVUkwuXG4gICAqL1xuICBwcml2YXRlIHBlbmRpbmdQcm9taXNlVG9RdWVyeVNlbGVjdGVkUmVjb3Jkc1ByZXNldEJlZm9yZURzUmVhZHk6IFByb21pc2U8dm9pZD5cbiAgcHJpdmF0ZSBhYm9ydENvbnRyb2xsZXJPZlBlbmRpbmdQcm9taXNlVG9RdWVyeVNlbGVjdGVkUmVjb3Jkc0J5U2VsZWN0T3B0aW9uczogQWJvcnRDb250cm9sbGVyXG5cbiAgY29uc3RydWN0b3IgKG9wdGlvbnM6IERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKVxuXG4gICAgdGhpcy5zZXRDYXBhYmlsaXRpZXMobmV3IENhcGFiaWxpdGllc0ltcGwoe30pKVxuXG4gICAgdGhpcy51cmwgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkudXJsXG5cbiAgICB0aGlzLmlzU3FsQ2FzZVNlbnNpdGl2ZSA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSA/IHRydWUgOiAhZGF0YVNvdXJjZVV0aWxzLmlzQUdPTEhvc3RlZFNlcnZpY2UodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnVybClcblxuICAgIGNvbnN0IGlzQmVsb25nVG9Ec1JlYWR5ID0gb3B0aW9ucy5iZWxvbmdUb0RhdGFTb3VyY2UgJiYgb3B0aW9ucy5iZWxvbmdUb0RhdGFTb3VyY2UuZ2V0U3RhdHVzKCkgIT09IERhdGFTb3VyY2VTdGF0dXMuTm90UmVhZHlcbiAgICBpZiAodGhpcy5nZXREYXRhU291cmNlSnNvbigpLmlzT3V0cHV0RnJvbVdpZGdldCAmJiAhaXNCZWxvbmdUb0RzUmVhZHkpIHtcbiAgICAgIC8qKlxuICAgICAgICogSWYgaXMgb3V0cHV0IGRhdGEgc291cmNlLCB0aGUgaW5pdGlhbCBkYXRhIHN0YXR1cyBpcyBub3QgcmVhZHksIHdpZGdldCB3aWxsIGNoYW5nZSB0aGUgc3RhdHVzIHRvIHVubG9hZGVkIHdoZW4gaXQgaXMgcmVhZHkgdG8gZG8gcXVlcnkuXG4gICAgICAgKi9cbiAgICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTm90UmVhZHkpXG4gICAgICB0aGlzLnNldENvdW50U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTm90UmVhZHkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuVW5sb2FkZWQpXG4gICAgICB0aGlzLnNldENvdW50U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuVW5sb2FkZWQpXG4gICAgfVxuICB9XG5cbiAgcmVhZHkgKCk6IFByb21pc2U8YW55PiB7XG4gICAgLyoqXG4gICAgICogSWYgY3VycmVudCBkYXRhIHNvdXJjZSBpcyBzZWxlY3Rpb24gdmlldywgbG9hZCBzZWxlY3RlZCByZWNvcmRzIGluIGRhdGEgc291cmNlIGluZm8uXG4gICAgICogSWYgdGhlcmUgYXJlIHNlbGVjdGVkIHJlY29yZCBpZHMgaW4gVVJMLCB3aWxsIHNldCB0aGVtIHRvIGRhdGEgc291cmNlIGluZm8sIHNob3VsZCBsb2FkIHRoZXNlIHNlbGVjdGVkIHJlY29yZHMgaGVyZS5cbiAgICAgKiBUaGlzIHdpbGwgbWFrZSBzdXJlIHNlbGVjdGVkIHJlY29yZCBpZHMgaW4gZGF0YSBzb3VyY2UgaW5mbyBhbmQgcmVjb3JkcyBpbiBzZWxlY3Rpb24gdmlldyBtYXRjaC5cbiAgICAgKi9cbiAgICBpZiAodGhpcy5pc1NlbGVjdGlvblZpZXcoKSkge1xuICAgICAgY29uc3QgbWFpbkRzSWQgPSB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuaWRcbiAgICAgIGNvbnN0IGRzSW5mb3MgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvXG5cbiAgICAgIGxldCBhbGxTZWxlY3RlZFJlY29yZElkcyA9IFtdXG4gICAgICBjb25zdCBhbGxTZWxlY3RPcHRpb25zOiB7IFtkc0lkOiBzdHJpbmddOiBRdWVyaWFibGVTZWxlY3RPcHRpb25zIH0gPSB7fVxuICAgICAgZHNJbmZvcyAmJiBPYmplY3Qua2V5cyhkc0luZm9zKS5mb3JFYWNoKGRzSWQgPT4ge1xuICAgICAgICAvLyBEZXJpdmVkIGRhdGEgdmlldyBvYmplY3RzIGFyZSBub3QgY3JlYXRlZCwgZ2V0IGRlcml2ZWQgZGF0YSBzb3VyY2UgaW5mbyBieSBpZCBoZXJlLlxuICAgICAgICBpZiAoZHNJZCA9PT0gbWFpbkRzSWQgfHwgZGF0YVNvdXJjZVV0aWxzLmlzRGVyaXZlZEZyb20obWFpbkRzSWQsIGRzSWQpKSB7XG4gICAgICAgICAgaWYgKGRzSW5mb3NbZHNJZF0/LnNlbGVjdGVkSWRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGFsbFNlbGVjdGVkUmVjb3JkSWRzID0gYWxsU2VsZWN0ZWRSZWNvcmRJZHMuY29uY2F0KGRzSW5mb3NbZHNJZF0uc2VsZWN0ZWRJZHMuYXNNdXRhYmxlKCkpXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChkc0luZm9zW2RzSWRdPy5zZWxlY3RPcHRpb25zPy53aWRnZXRJZCkge1xuICAgICAgICAgICAgYWxsU2VsZWN0T3B0aW9uc1tkc0lkXSA9IGRzSW5mb3NbZHNJZF0uc2VsZWN0T3B0aW9ucy5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgYWxsU2VsZWN0ZWRSZWNvcmRJZHMgPSBBcnJheS5mcm9tKG5ldyBTZXQoYWxsU2VsZWN0ZWRSZWNvcmRJZHMpKVxuXG4gICAgICBjb25zdCBxdWVyeVNlbGVjdGVkUmVjb3JkcyA9ICgpID0+IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIHNlbGVjdGVkIHJlY29yZHMgYXJlIGVtcHR5LCBubyBuZWVkIHRvIGxvYWQuXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoYWxsU2VsZWN0ZWRSZWNvcmRJZHMubGVuZ3RoID09PSAwICYmIE9iamVjdC5rZXlzKGFsbFNlbGVjdE9wdGlvbnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe30pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBxdWVyeUJ5SWRzUHJvbWlzZSA9IGFsbFNlbGVjdGVkUmVjb3JkSWRzLmxlbmd0aCA+IDBcbiAgICAgICAgICA/IHRoaXMucXVlcnlSZWNvcmRzQnlJZFdpdGhDdXJyZW50UXVlcnlQYXJhbXMoYWxsU2VsZWN0ZWRSZWNvcmRJZHMsIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSwgeyByZXR1cm5HZW9tZXRyeTogdHJ1ZSB9IGFzIFF1ZXJ5UGFyYW1zKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuc2VsZWN0UmVjb3Jkc0J5SWRzKHJlcy5yZWNvcmRzPy5tYXAociA9PiByLmdldElkKCkpLCByZXMucmVjb3JkcylcbiAgICAgICAgICB9KVxuICAgICAgICAgIDogbnVsbFxuICAgICAgICBjb25zdCBxdWVyeUJ5U2VsZWN0T3B0aW9uc1Byb21pc2VzID0gT2JqZWN0LmtleXMoYWxsU2VsZWN0T3B0aW9ucykubWFwKGRzSWQgPT4ge1xuICAgICAgICAgIGlmIChhbGxTZWxlY3RPcHRpb25zW2RzSWRdPy5pZHM/Lmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gV2hlbiBzZWxlY3QgYnkgaWQsIHdlIHF1ZXJ5IHRoZXNlIGlkcyBieSBtYWluIGRhdGEgc291cmNlLCBubyBuZWVkIHRvIGNvbnNpZGVyIGRhdGEgdmlldyBzZXR0aW5ncy5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5UmVjb3Jkc0J5SWRXaXRoQ3VycmVudFF1ZXJ5UGFyYW1zKGFsbFNlbGVjdE9wdGlvbnNbZHNJZF0uaWRzLCB0aGlzLmdldE1haW5EYXRhU291cmNlKCksIHsgcmV0dXJuR2VvbWV0cnk6IHRydWUgfSBhcyBRdWVyeVBhcmFtcykudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuc2VsZWN0UmVjb3Jkcyh7IC4uLmFsbFNlbGVjdE9wdGlvbnNbZHNJZF0sIHJlY29yZHM6IHJlcy5yZWNvcmRzIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0gZWxzZSBpZiAoYWxsU2VsZWN0T3B0aW9uc1tkc0lkXT8ucXVlcnlQYXJhbXMpIHtcbiAgICAgICAgICAgIC8vIFdoZW4gc2VsZWN0IGJ5IHF1ZXJ5IHBhcmFtcywgd2UgbmVlZCB0byBjb25zaWRlciBkYXRhIHZpZXcgc2V0dGluZ3MuXG4gICAgICAgICAgICBjb25zdCBkYXRhVmlld0lkID0gZHNJZCA9PT0gbWFpbkRzSWQgPyBudWxsIDogZHNJZC5yZXBsYWNlKGAke21haW5Ec0lkfS1gLCAnJylcbiAgICAgICAgICAgIGNvbnN0IGRzID0gZGF0YVZpZXdJZCA/IHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuY3JlYXRlRGF0YVZpZXcodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLCBkYXRhVmlld0lkKSBhcyBRdWVyaWFibGVEYXRhU291cmNlIDogdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpXG4gICAgICAgICAgICByZXR1cm4gZHM/LnF1ZXJ5QWxsKHsgLi4uYWxsU2VsZWN0T3B0aW9uc1tkc0lkXS5xdWVyeVBhcmFtcywgcmV0dXJuR2VvbWV0cnk6IHRydWUgfSBhcyBRdWVyeVBhcmFtcykudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICBkcy5zZWxlY3RSZWNvcmRzKHsgLi4uYWxsU2VsZWN0T3B0aW9uc1tkc0lkXSwgcmVjb3JkczogcmVzLnJlY29yZHMgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMucGVuZGluZ1Byb21pc2VUb1F1ZXJ5U2VsZWN0ZWRSZWNvcmRzUHJlc2V0QmVmb3JlRHNSZWFkeSA9IFByb21pc2UuYWxsU2V0dGxlZChbcXVlcnlCeUlkc1Byb21pc2UsIC4uLnF1ZXJ5QnlTZWxlY3RPcHRpb25zUHJvbWlzZXNdLmZpbHRlcihwID0+ICEhcCkpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5hZGRTb3VyY2VWZXJzaW9uKClcbiAgICAgICAgfSkuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5wZW5kaW5nUHJvbWlzZVRvUXVlcnlTZWxlY3RlZFJlY29yZHNQcmVzZXRCZWZvcmVEc1JlYWR5ID0gbnVsbFxuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIElmIGRhdGEgaXMgc2F2ZWQgaW4gZGF0YSBzb3VyY2UgaW5zdGFuY2UsIHdpbGwgbm90IHF1ZXJ5IHNlbGVjdGVkIHJlY29yZHMgdW50aWwgdGhlIGZpcnN0IHRpbWUgc2V0IHNvdXJjZSByZWNvcmRzLlxuICAgICAgICogSWYgZGF0YSBpcyBpbiByZW1vdGUsIHdpbGwgcXVlcnkgc2VsZWN0ZWQgcmVjb3JkcyBub3cuXG4gICAgICAgKi9cbiAgICAgIGlmICh0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSkge1xuICAgICAgICAodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpIGFzIEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSkuc2V0T25jZVNldFNvdXJjZVJlY29yZHMocXVlcnlTZWxlY3RlZFJlY29yZHMpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBxdWVyeVNlbGVjdGVkUmVjb3JkcygpXG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHt9KVxuICAgIH0gZWxzZSBpZiAodGhpcy5pc0RhdGFWaWV3ICYmIHRoaXMuZGF0YVZpZXdJZCA9PT0gREFUQV9WSUVXX0lEX0ZPUl9OT19TRUxFQ1RJT04pIHtcbiAgICAgIC8qKlxuICAgICAgICogSWYgY3VycmVudCBkYXRhIHNvdXJjZSBpcyBub19zZWxlY3Rpb24gdmlldywgbG9hZCByZWNvcmRzLlxuICAgICAgICogV2UgbG9hZCBub19zZWxlY3Rpb24gdmlldyBpbiBmcmFtZXdvcmsuXG4gICAgICAgKi9cbiAgICAgIHJldHVybiBQcm9taXNlLmFsbFNldHRsZWQoW1xuICAgICAgICB0aGlzLmxvYWQoeyByZXR1cm5HZW9tZXRyeTogdHJ1ZSB9IGFzIFF1ZXJ5UGFyYW1zLCB7IHdpZGdldElkOiBEQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTiB9KSxcbiAgICAgICAgdGhpcy5sb2FkQ291bnQoe30sIHsgd2lkZ2V0SWQ6IERBVEFfVklFV19JRF9GT1JfTk9fU0VMRUNUSU9OIH0pXG4gICAgICBdKS50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gSWYgc2VsZWN0ZWQgcmVjb3JkIGlkIGlzIGVtcHR5LCBzaG91bGQgdXNlIG5vX3NlbGVjdGlvbiB2aWV3IHRvIGRvIHF1ZXJ5LlxuICAgICAgICBpZiAodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldFNlbGVjdGVkUmVjb3JkSWRzKCkuZmlsdGVyKGlkID0+ICEhaWQpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIC8vIENsZWFyIHNlbGVjdGlvbiBhbmQgbGV0IG90aGVyIHdpZGdldHMgLyBjb21wb25lbnRzIHRvIGtub3cgc2VsZWN0aW9uIHZpZXcgaXMgdXBkYXRlZC5cbiAgICAgICAgICB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0RGF0YVZpZXcoU0VMRUNUSU9OX0RBVEFfVklFV19JRCk/LmNsZWFyUmVjb3JkcygpXG4gICAgICAgICAgdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFWaWV3KFNFTEVDVElPTl9EQVRBX1ZJRVdfSUQpPy5nZXRBbGxEZXJpdmVkRGF0YVNvdXJjZXMoKT8uZm9yRWFjaChkcyA9PiB7XG4gICAgICAgICAgICBkcz8uY2xlYXJSZWNvcmRzKClcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHt9KVxuICAgIH1cbiAgfVxuXG4gIGdldEN1cnJlbnRRdWVyeVBhcmFtcyAob3B0aW9ucz86IEdldEN1cnJlbnRRdWVyeVBhcmFtc09wdGlvbnMpIHtcbiAgICBjb25zdCBydW50aW1lUXVlcnkgPSB0aGlzLmdldFJ1bnRpbWVRdWVyeVBhcmFtcyhvcHRpb25zPy5leGNsdWRlPy5kYXRhU291cmNlSWQgPT09IHRoaXMuaWQgPyBvcHRpb25zPy5leGNsdWRlPy53aWRnZXRJZCA6IG51bGwpXG4gICAgcmV0dXJuIHRoaXMuZ2V0Q3VycmVudFF1ZXJ5UGFyYW1zQnlRdWVyeShydW50aW1lUXVlcnksIG9wdGlvbnMpXG4gIH1cblxuICBnZXRSdW50aW1lUXVlcnlQYXJhbXMgKGV4Y2x1ZGVXaWRnZXRJZD86IHN0cmluZykge1xuICAgIGNvbnN0IHdpZGdldFF1ZXJpZXMgPSBleGNsdWRlV2lkZ2V0SWQgPyB0aGlzLmdldEluZm8oKS53aWRnZXRRdWVyaWVzPy53aXRob3V0KGV4Y2x1ZGVXaWRnZXRJZCkgOiB0aGlzLmdldEluZm8oKS53aWRnZXRRdWVyaWVzXG4gICAgcmV0dXJuIHRoaXMuZ2V0TWVyZ2VkV2lkZ2V0UXVlcmllcyh3aWRnZXRRdWVyaWVzKVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDdXJyZW50UXVlcnlQYXJhbXNCeVF1ZXJ5IChydW50aW1lUXVlcnk6IFF1ZXJ5UGFyYW1zLCBvcHRpb25zPzogR2V0Q3VycmVudFF1ZXJ5UGFyYW1zT3B0aW9ucykge1xuICAgIGxldCBxdWVyeVxuICAgIGlmICh0aGlzLmlzTG9jYWwpIHsgLy8gbG9jYWwgZHMgaGFzIG5vIGNvbmZpZyBxdWVyeVxuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXMoKHRoaXMuYmVsb25nVG9EYXRhU291cmNlIGFzIFF1ZXJpYWJsZURhdGFTb3VyY2UpLmdldEN1cnJlbnRRdWVyeVBhcmFtcyhvcHRpb25zKSwgcnVudGltZVF1ZXJ5KVxuICAgIH0gZWxzZSBpZiAodGhpcy5pc0RhdGFWaWV3KSB7XG4gICAgICBxdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldENvbmZpZ1F1ZXJ5UGFyYW1zKCksIHJ1bnRpbWVRdWVyeSlcbiAgICAgIC8qKlxuICAgICAgICogU2VsZWN0aW9uIHZpZXcgaXMgYWx3YXlzIGNhc2Utc2Vuc2l0aXZlIHNpbmNlIGl0IGlzIGEgY2xpZW50LXNpZGUgbGF5ZXIsIG1haW4gZGF0YSBzb3VyY2UgbWF5IGJlIGNhc2UtaW5zZW5zaXRpdmUuXG4gICAgICAgKiBVc2UgY3VycmVudCBkYXRhIHZpZXcgdG8gZ2V0IGNvcnJlY3QgU1FMIGNsYXVzZS5cbiAgICAgICAqL1xuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldEN1cnJlbnRRdWVyeVBhcmFtcyh7IC4uLm9wdGlvbnMsIGRhdGFTb3VyY2VUb0Zvcm1hdFNxbDogdGhpcyB9KSwgcXVlcnkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHF1ZXJ5ID0gdGhpcy5tZXJnZVF1ZXJ5UGFyYW1zKHRoaXMuZ2V0Q29uZmlnUXVlcnlQYXJhbXMoKSwgcnVudGltZVF1ZXJ5KVxuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRSZW1vdGVRdWVyeVBhcmFtcygpLCBxdWVyeSlcbiAgICB9XG4gICAgcmV0dXJuIHF1ZXJ5XG4gIH1cblxuICBwcml2YXRlIGdldE1lcmdlZFdpZGdldFF1ZXJpZXMgKHdpZGdldFF1ZXJpZXM6IHsgW3dpZGdldElkOiBzdHJpbmddOiBRdWVyeVBhcmFtcyB9KTogUXVlcnlQYXJhbXMge1xuICAgIGxldCB3aWRnZXRJZHMgPSAod2lkZ2V0UXVlcmllcyAmJiBPYmplY3Qua2V5cyh3aWRnZXRRdWVyaWVzKSkgfHwgW11cbiAgICB3aWRnZXRJZHMgPSB3aWRnZXRJZHMuc29ydCgoYSwgYikgPT4gYS5sb2NhbGVDb21wYXJlKGIsICdlbicsIHsgbnVtZXJpYzogdHJ1ZSwgc2Vuc2l0aXZpdHk6ICdiYXNlJyB9KSlcblxuICAgIHJldHVybiB0aGlzLm1lcmdlUXVlcnlQYXJhbXMoLi4ud2lkZ2V0SWRzLm1hcCh3aWRnZXRJZCA9PiB3aWRnZXRRdWVyaWVzW3dpZGdldElkXSkpXG4gIH1cblxuICBnZXRDdXJyZW50UXVlcnlJZCAoKSB7XG4gICAgcmV0dXJuIHRoaXMubGFzdFF1ZXJ5SWRcbiAgfVxuXG4gIGdldFJlYWxRdWVyeVBhcmFtcyAocXVlcnk6IFF1ZXJ5UGFyYW1zLCBmbGFnOiAncXVlcnknIHwgJ2xvYWQnLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKTogUXVlcnlQYXJhbXMge1xuICAgIGxldCByZWFsUXVlcnlcbiAgICBpZiAoZmxhZyA9PT0gJ3F1ZXJ5Jykge1xuICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5zY29wZSkge1xuICAgICAgICBpZiAob3B0aW9ucy5zY29wZSA9PT0gUXVlcnlTY29wZS5JbkFsbERhdGEpIHtcbiAgICAgICAgICByZWFsUXVlcnkgPSBxdWVyeVxuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5SZW1vdGVDb25maWdWaWV3KSB7XG4gICAgICAgICAgcmVhbFF1ZXJ5ID0gdGhpcy5tZXJnZVF1ZXJ5UGFyYW1zKHRoaXMuZ2V0UmVtb3RlUXVlcnlQYXJhbXMoKSwgcXVlcnkpXG4gICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5zY29wZSA9PT0gUXVlcnlTY29wZS5JbkNvbmZpZ1ZpZXcpIHtcbiAgICAgICAgICByZWFsUXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlXaXRoQ29uZmlnUXVlcnkocXVlcnkpXG4gICAgICAgICAgcmVhbFF1ZXJ5ID0gdGhpcy5tZXJnZVF1ZXJ5UGFyYW1zKHRoaXMuZ2V0UmVtb3RlUXVlcnlQYXJhbXMoKSwgcmVhbFF1ZXJ5KVxuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5SdW50aW1lVmlldykge1xuICAgICAgICAgIHJlYWxRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldEN1cnJlbnRRdWVyeVBhcmFtcyh7IGV4Y2x1ZGU6IG9wdGlvbnMuZXhjbHVkZVF1ZXJ5LCBkYXRhU291cmNlVG9Gb3JtYXRTcWw6IG9wdGlvbnMuZGF0YVNvdXJjZVRvRm9ybWF0U3FsIH0pLCBxdWVyeSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWFsUXVlcnkgPSBxdWVyeVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgeyAvLyBubyBzY29wZSwgc2FtZSBhcyBJblJ1bnRpbWVWaWV3XG4gICAgICAgIHJlYWxRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldEN1cnJlbnRRdWVyeVBhcmFtcyh7IGV4Y2x1ZGU6IG9wdGlvbnM/LmV4Y2x1ZGVRdWVyeSwgZGF0YVNvdXJjZVRvRm9ybWF0U3FsOiBvcHRpb25zPy5kYXRhU291cmNlVG9Gb3JtYXRTcWwgfSksIHF1ZXJ5KVxuICAgICAgfVxuICAgIH0gZWxzZSB7IC8vIGZvciBsb2FkXG4gICAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMud2lkZ2V0SWQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignUGxlYXNlIHBhc3Mgd2lkZ2V0IGlkIGZvciBsb2FkLicpXG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGdldFF1ZXJ5Rm9yTG9hZFJ1bnRpbWUgPSAoKSA9PiB7XG4gICAgICAgIGxldCBuZXdRdWVyeVxuICAgICAgICBsZXQgd2lkZ2V0UXVlcmllcyA9IHRoaXMuZ2V0SW5mbygpLndpZGdldFF1ZXJpZXMgfHwgSW1tdXRhYmxlKHt9IGFzIGFueSlcbiAgICAgICAgaWYgKG9wdGlvbnM/LmV4Y2x1ZGVRdWVyeSkge1xuICAgICAgICAgIHdpZGdldFF1ZXJpZXMgPSB3aWRnZXRRdWVyaWVzLndpdGhvdXQob3B0aW9ucy5leGNsdWRlUXVlcnkud2lkZ2V0SWQpXG4gICAgICAgIH1cblxuICAgICAgICB3aWRnZXRRdWVyaWVzID0gd2lkZ2V0UXVlcmllcy5zZXQob3B0aW9ucy53aWRnZXRJZCwgcXVlcnkpXG5cbiAgICAgICAgbmV3UXVlcnkgPSB0aGlzLmdldE1lcmdlZFdpZGdldFF1ZXJpZXMod2lkZ2V0UXVlcmllcylcbiAgICAgICAgbmV3UXVlcnkgPSB0aGlzLmdldEN1cnJlbnRRdWVyeVBhcmFtc0J5UXVlcnkobmV3UXVlcnksIHsgZXhjbHVkZTogb3B0aW9ucy5leGNsdWRlUXVlcnksIGRhdGFTb3VyY2VUb0Zvcm1hdFNxbDogb3B0aW9ucy5kYXRhU291cmNlVG9Gb3JtYXRTcWwgfSlcbiAgICAgICAgcmV0dXJuIG5ld1F1ZXJ5XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuc2NvcGUpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5BbGxEYXRhKSB7XG4gICAgICAgICAgcmVhbFF1ZXJ5ID0gcXVlcnlcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLnNjb3BlID09PSBRdWVyeVNjb3BlLkluUmVtb3RlQ29uZmlnVmlldykge1xuICAgICAgICAgIHJlYWxRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldFJlbW90ZVF1ZXJ5UGFyYW1zKCksIHF1ZXJ5KVxuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5Db25maWdWaWV3KSB7XG4gICAgICAgICAgcmVhbFF1ZXJ5ID0gdGhpcy5tZXJnZVF1ZXJ5V2l0aENvbmZpZ1F1ZXJ5KHF1ZXJ5KVxuICAgICAgICAgIHJlYWxRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldFJlbW90ZVF1ZXJ5UGFyYW1zKCksIHJlYWxRdWVyeSlcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLnNjb3BlID09PSBRdWVyeVNjb3BlLkluUnVudGltZVZpZXcpIHtcbiAgICAgICAgICByZWFsUXVlcnkgPSBnZXRRdWVyeUZvckxvYWRSdW50aW1lKClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWFsUXVlcnkgPSBxdWVyeVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWFsUXVlcnkgPSBnZXRRdWVyeUZvckxvYWRSdW50aW1lKClcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVhbFF1ZXJ5XG4gIH1cblxuICBwcml2YXRlIG1lcmdlUXVlcnlXaXRoQ29uZmlnUXVlcnkgKHF1ZXJ5OiBRdWVyeVBhcmFtcykge1xuICAgIGxldCBuZXdRdWVyeVxuICAgIGlmICh0aGlzLmlzTG9jYWwpIHtcbiAgICAgIGlmICh0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZS5pc0RhdGFWaWV3KSB7XG4gICAgICAgIG5ld1F1ZXJ5ID0gdGhpcy5tZXJnZVF1ZXJ5UGFyYW1zKCh0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZSBhcyBRdWVyaWFibGVEYXRhU291cmNlKS5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBxdWVyeSlcbiAgICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldENvbmZpZ1F1ZXJ5UGFyYW1zKCksIG5ld1F1ZXJ5KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBxdWVyeSlcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNEYXRhVmlldykge1xuICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBxdWVyeSlcbiAgICAgIG5ld1F1ZXJ5ID0gdGhpcy5tZXJnZVF1ZXJ5UGFyYW1zKHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBuZXdRdWVyeSlcbiAgICB9IGVsc2Uge1xuICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBxdWVyeSlcbiAgICB9XG4gICAgcmV0dXJuIG5ld1F1ZXJ5XG4gIH1cblxuICB1cGRhdGVRdWVyeVBhcmFtcyAocXVlcnk6IFF1ZXJ5UGFyYW1zLCB3aWRnZXRJZDogc3RyaW5nKSB7XG4gICAgcXVlcnkgPSB0aGlzLmdldFF1ZXJ5V2l0aG91dFBhZ2UocXVlcnkpXG4gICAgaWYgKCF1dGlscy5pc0RlZXBFcXVhbChxdWVyeSB8fCB7fSwgdGhpcy5nZXRJbmZvKCkud2lkZ2V0UXVlcmllcz8uW3dpZGdldElkXSB8fCB7fSkpIHtcbiAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy51cGRhdGVXaWRnZXRRdWVyeSh0aGlzLmlkLCB3aWRnZXRJZCwgcXVlcnkpKVxuICAgICAgLyoqXG4gICAgICAgKiBXZSB1cGRhdGUgc2VsZWN0aW9uIGluZm8gYW5kIGxvYWQgc2VsZWN0aW9uIHZpZXcgaW4gZnJhbWV3b3JrLlxuICAgICAgICpcbiAgICAgICAqIElmIHF1ZXJ5IHBhcmFtcyBvZiBzZWxlY3Rpb24gdmlldyBpcyBjaGFuZ2VkLCBsb2FkIHNlbGVjdGlvbiB2aWV3IChzZWxlY3Rpb24gaW5mbyB3aWxsIGJlIHVwZGF0ZWQgYWZ0ZXIgbG9hZCkuXG4gICAgICAgKiBFbHNlLCBDaGVjayBhbmQgdXBkYXRlIHNlbGVjdGlvbiBpbmZvIG9mIGRhdGEgc291cmNlcyB3aGljaCBhcmUgZGVyaXZlZCBmcm9tIHRoZSBjdXJyZW50IGRhdGEgc291cmNlLlxuICAgICAgICovXG4gICAgICBpZiAodGhpcy5pc1NlbGVjdGlvblZpZXcoKSkge1xuICAgICAgICB0aGlzLmxvYWQoeyByZXR1cm5HZW9tZXRyeTogdHJ1ZSB9IGFzIFF1ZXJ5UGFyYW1zLCB7IHdpZGdldElkOiBTRUxFQ1RJT05fREFUQV9WSUVXX0lEIH0pXG4gICAgICAgIHRoaXMubG9hZENvdW50KHt9LCB7IHdpZGdldElkOiBTRUxFQ1RJT05fREFUQV9WSUVXX0lEIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhhbmRsZVNlbGVjdGlvbk9uUXVlcnlQYXJhbUNoYW5nZXMoKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldFF1ZXJ5UGFnZVNpemUgKCk6IG51bWJlciB7XG4gICAgY29uc3QgY29uZmlndXJlZFBhZ2VTaXplID0gdGhpcy5nZXREYXRhVmlld0NvbmZpZygpPy5wYWdlU2l6ZSB8fCBERUZBVUxUX1FVRVJZX1BBR0VfU0laRVxuICAgIGNvbnN0IHNlcnZpY2VNYXhQYWdlU2l6ZSA9IHRoaXMuZ2V0Q2FwYWJpbGl0aWVzKCk/LmdldFF1ZXJ5Q2FwYWJpbGl0aWVzKCk/Lm1heFBhZ2VTaXplIHx8IEluZmluaXR5XG4gICAgcmV0dXJuIE1hdGgubWluKGNvbmZpZ3VyZWRQYWdlU2l6ZSwgc2VydmljZU1heFBhZ2VTaXplKVxuICB9XG5cbiAgZ2V0TWF4UmVjb3JkQ291bnQgKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RGF0YVZpZXdDb25maWcoKT8ubWF4aW11bSB8fCBudWxsXG4gIH1cblxuICBwcml2YXRlIGdldFF1ZXJ5V2l0aG91dFBhZ2UgKHF1ZXJ5OiBRdWVyeVBhcmFtcyk6IFF1ZXJ5UGFyYW1zIHtcbiAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICBjb25zdCB7IHBhZ2VTaXplLCBwYWdlLCAuLi5xIH0gPSBxdWVyeVxuICAgIHJldHVybiBxXG4gIH1cblxuICBwcml2YXRlIGNoZWNrQ2xlYXJMb2NhbENhY2hlIChxdWVyeTogUXVlcnlQYXJhbXMsIGxhc3RRdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBib29sZWFuIHtcbiAgICBjb25zdCBxdWVyeVdpdGhvdXRQYWdlID0gdGhpcy5nZXRRdWVyeVdpdGhvdXRQYWdlKHF1ZXJ5KVxuICAgIGNvbnN0IHJlYWxRdWVyeVdpdGhvdXRQYWdlID0gdGhpcy5nZXRSZWFsUXVlcnlQYXJhbXMocXVlcnlXaXRob3V0UGFnZSwgJ2xvYWQnLCBvcHRpb25zKVxuICAgIGNvbnN0IHJlYWxRdWVyeVdpdGhvdXRQYWdlT3JVc2VkRmllbGRzID0gdGhpcy5hcHBseVVzZWRGaWVsZHMocmVhbFF1ZXJ5V2l0aG91dFBhZ2UsICcqJylcbiAgICBjb25zdCBsYXN0UXVlcnlXaXRob3V0UGFnZU9yVXNlZEZpZWxkcyA9IHRoaXMuYXBwbHlVc2VkRmllbGRzKGxhc3RRdWVyeSwgJyonKVxuXG4gICAgY29uc3QgcmVmcmVzaCA9IG9wdGlvbnMucmVmcmVzaCB8fCB0aGlzLmdldEluZm8oKS5uZWVkUmVmcmVzaFxuICAgIGlmICh1dGlscy5pc0RlZXBFcXVhbChyZWFsUXVlcnlXaXRob3V0UGFnZU9yVXNlZEZpZWxkcywgbGFzdFF1ZXJ5V2l0aG91dFBhZ2VPclVzZWRGaWVsZHMpICYmICFyZWZyZXNoKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgLyoqXG4gICAgICAgKiBJZiBuZWVkUmVmcmVzaCBpcyB0cnVlLCBvbmx5IG5lZWQgdG8gY2xlYXIgdGhlIGNhY2hlIGFuZCBxdWVyeSBuZXcgcmVzdWx0cyBvbmNlLlxuICAgICAgICovXG4gICAgICBpZiAodGhpcy5nZXRJbmZvKCkubmVlZFJlZnJlc2gpIHtcbiAgICAgICAgdGhpcy5zZXROZWVkUmVmcmVzaChmYWxzZSlcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc2VsZWN0UmVjb3JkcyAob3B0aW9uczogUXVlcmlhYmxlU2VsZWN0T3B0aW9ucywgc2lnbmFsPzogQWJvcnRTaWduYWwsIHByb2dyZXNzQ2FsbGJhY2s/OiBRdWVyeVByb2dyZXNzQ2FsbGJhY2spOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgdGhpcy5jbGVhclBlbmRpbmdTZWxlY3QoKVxuXG4gICAgaWYgKG9wdGlvbnM/LnJlY29yZHMgfHwgb3B0aW9ucz8uaWRzKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzdXBlci5zZWxlY3RSZWNvcmRzKG9wdGlvbnMpXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsgLi4ucmVzdWx0LCBxdWVyeVBhcmFtczogSW1tdXRhYmxlKG9wdGlvbnM/LnF1ZXJ5UGFyYW1zKSB9KVxuICAgIH0gZWxzZSBpZiAob3B0aW9ucz8ucXVlcnlQYXJhbXMpIHtcbiAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKClcbiAgICAgIGlmIChzaWduYWwpIHtcbiAgICAgICAgLy8gQWJvcnQgdGhlIHF1ZXJ5IHByb2Nlc3Mgd2hlbmV2ZXIgdGhlIGlucHV0IHNpZ25hbCBpcyBhYm9ydGVkLlxuICAgICAgICBzaWduYWwub25hYm9ydCA9IGUgPT4geyBjb250cm9sbGVyLmFib3J0KCkgfVxuICAgICAgfVxuICAgICAgdGhpcy5hYm9ydENvbnRyb2xsZXJPZlBlbmRpbmdQcm9taXNlVG9RdWVyeVNlbGVjdGVkUmVjb3Jkc0J5U2VsZWN0T3B0aW9ucyA9IGNvbnRyb2xsZXJcblxuICAgICAgcmV0dXJuIHRoaXMucXVlcnlBbGwoeyAuLi5vcHRpb25zLnF1ZXJ5UGFyYW1zLCByZXR1cm5HZW9tZXRyeTogdHJ1ZSB9IGFzIFF1ZXJ5UGFyYW1zLCB0aGlzLmFib3J0Q29udHJvbGxlck9mUGVuZGluZ1Byb21pc2VUb1F1ZXJ5U2VsZWN0ZWRSZWNvcmRzQnlTZWxlY3RPcHRpb25zLnNpZ25hbCwgcHJvZ3Jlc3NDYWxsYmFjaykudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAvKipcbiAgICAgICAgICogU2VsZWN0IHRoZSBxdWVyeSByZXN1bHQgaWYgLVxuICAgICAgICAgKiAxLiB0aGUgcXVlcnkgcHJvY2VzcyBpcyBjb21wbGV0ZWQsIG9yLFxuICAgICAgICAgKiAyLiBpcyBhYm9ydGVkIGJ5IHRoZSBpbnB1dCBzaWduYWxcbiAgICAgICAgICogVGhhdCBpcyB0byBzYXksIGRvIG5vdCBzZWxlY3QgdGhlIHF1ZXJ5IHJlc3VsdCBpZiB0aGUgcXVlcnkgcHJvY2VzcyBpcyBhYm9ydGVkIGJ5IGFub3RoZXIgc2VsZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCFyZXN1bHQuaXNBYm9ydGVkIHx8IHNpZ25hbD8uYWJvcnRlZCkge1xuICAgICAgICAgIHN1cGVyLnNlbGVjdFJlY29yZHMoeyAuLi5vcHRpb25zLCByZWNvcmRzOiByZXN1bHQucmVjb3JkcyB9KVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNlbGVjdCBieSBvcHRpb25zLiAnLCBlcnIpXG4gICAgICAgIHJldHVybiB7IHJlY29yZHM6IFtdLCBxdWVyeVBhcmFtczogSW1tdXRhYmxlKG9wdGlvbnMucXVlcnlQYXJhbXMpIH1cbiAgICAgIH0pXG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyByZWNvcmRzOiBbXSwgcXVlcnlQYXJhbXM6IG51bGwgfSlcbiAgfVxuXG4gIHNlbGVjdFJlY29yZEJ5SWQgKGlkOiBzdHJpbmcsIHJlY29yZD86IERhdGFSZWNvcmQpIHtcbiAgICB0aGlzLmNsZWFyUGVuZGluZ1NlbGVjdCgpXG4gICAgc3VwZXIuc2VsZWN0UmVjb3JkQnlJZChpZCwgcmVjb3JkKVxuICB9XG5cbiAgc2VsZWN0UmVjb3Jkc0J5SWRzIChpZHM6IHN0cmluZ1tdLCByZWNvcmRzPzogRGF0YVJlY29yZFtdKSB7XG4gICAgdGhpcy5jbGVhclBlbmRpbmdTZWxlY3QoKVxuICAgIHN1cGVyLnNlbGVjdFJlY29yZHNCeUlkcyhpZHMsIHJlY29yZHMpXG4gIH1cblxuICBzZWxlY3RSZWNvcmQgKGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmNsZWFyUGVuZGluZ1NlbGVjdCgpXG4gICAgc3VwZXIuc2VsZWN0UmVjb3JkKGluZGV4KVxuICB9XG5cbiAgY2xlYXJTZWxlY3Rpb24gKCkge1xuICAgIHRoaXMuY2xlYXJQZW5kaW5nU2VsZWN0KClcbiAgICBzdXBlci5jbGVhclNlbGVjdGlvbigpXG4gIH1cblxuICBwcml2YXRlIGNsZWFyUGVuZGluZ1NlbGVjdCAoKSB7XG4gICAgLy8gQWJvcnQgdGhlIHBlbmRpbmcgc2VsZWN0LlxuICAgIHRoaXMuYWJvcnRDb250cm9sbGVyT2ZQZW5kaW5nUHJvbWlzZVRvUXVlcnlTZWxlY3RlZFJlY29yZHNCeVNlbGVjdE9wdGlvbnM/LmFib3J0KClcbiAgICB0aGlzLmFib3J0Q29udHJvbGxlck9mUGVuZGluZ1Byb21pc2VUb1F1ZXJ5U2VsZWN0ZWRSZWNvcmRzQnlTZWxlY3RPcHRpb25zID0gbnVsbFxuICB9XG5cbiAgZ2V0UmVjb3Jkc0J5UGFnZSAocGFnZTogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyKTogRGF0YVJlY29yZFtdIHtcbiAgICBjb25zdCByZWNvcmRzID0gW11cbiAgICBjb25zdCBwYWdlcyA9IHsgLi4udGhpcy5wYWdlcyB9XG4gICAgY29uc3QgbWF4UGFnZSA9IE9iamVjdC5rZXlzKHBhZ2VzKS5tYXAocCA9PiBwYXJzZUludChwKSkuc29ydCgoYSwgYikgPT4gYiAtIGEpWzBdXG4gICAgY29uc3QgcXVlcnlQYWdlU2l6ZSA9IHRoaXMuZ2V0UXVlcnlQYWdlU2l6ZSgpXG5cbiAgICBsZXQgc3RhcnQgPSBwYWdlU2l6ZSAqIChwYWdlIC0gMSlcbiAgICBsZXQgZW5kID0gc3RhcnQgKyBwYWdlU2l6ZSAtIDFcblxuICAgIGNvbnN0IG1heENvdW50ID0gdGhpcy5nZXRNYXhSZWNvcmRDb3VudCgpXG4gICAgaWYgKG1heENvdW50ICE9PSBudWxsKSB7XG4gICAgICAvKipcbiAgICAgICAqIElmIHN0YXJ0IGluZGV4IGlzIG1vcmUgdGhhbiBtYXggaW5kZXgsIHJldHVybiBlbXB0eSBhcnJheS5cbiAgICAgICAqL1xuICAgICAgaWYgKHN0YXJ0ID4gbWF4Q291bnQgLSAxKSB7XG4gICAgICAgIHJldHVybiByZWNvcmRzXG4gICAgICB9XG4gICAgICBzdGFydCA9IE1hdGgubWluKHN0YXJ0LCBtYXhDb3VudCAtIDEpXG4gICAgICBlbmQgPSBNYXRoLm1pbihlbmQsIG1heENvdW50IC0gMSlcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBtYXhQYWdlOyBpKyspIHtcbiAgICAgIGNvbnN0IHBhZ2VTdGFydCA9IChpIC0gMSkgKiBxdWVyeVBhZ2VTaXplXG4gICAgICBjb25zdCBwYWdlRW5kID0gcGFnZVN0YXJ0ICsgcXVlcnlQYWdlU2l6ZSAtIDFcbiAgICAgIGlmIChwYWdlRW5kIDwgc3RhcnQgfHwgcGFnZVN0YXJ0ID4gZW5kKSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIGlmIChwYWdlc1tpXSkge1xuICAgICAgICBmb3IgKGxldCBwaSA9IDA7IHBpIDwgcGFnZXNbaV0ubGVuZ3RoOyBwaSsrKSB7XG4gICAgICAgICAgaWYgKHBhZ2VTdGFydCArIHBpIDwgc3RhcnQgfHwgcGFnZVN0YXJ0ICsgcGkgPiBlbmQpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgICAgfVxuICAgICAgICAgIHJlY29yZHMucHVzaChwYWdlc1tpXVtwaV0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVjb3Jkc1xuICB9XG5cbiAgZ2V0UmVjb3Jkc0J5UGFnZVdpdGhTZWxlY3Rpb24gKHBhZ2U6IG51bWJlciwgcGFnZVNpemU6IG51bWJlcik6IERhdGFSZWNvcmRbXSB7XG4gICAgcmV0dXJuIHRoaXMuY29uY2F0UmVjb3Jkc0FuZFNlbGVjdGlvbih0aGlzLmdldFNlbGVjdGVkUmVjb3JkcygpLCB0aGlzLmdldFJlY29yZHNCeVBhZ2UocGFnZSwgcGFnZVNpemUpKVxuICB9XG5cbiAgZ2V0UGFnZXNEYXRhICgpOiB7IFtwYWdlOiBudW1iZXJdOiBEYXRhUmVjb3JkW10gfSB7XG4gICAgcmV0dXJuIHRoaXMucGFnZXNcbiAgfVxuXG4gIHNldFBhZ2VzRGF0YSAocGFnZXM6IHsgW3BhZ2U6IG51bWJlcl06IERhdGFSZWNvcmRbXSB9KSB7XG4gICAgdGhpcy5wYWdlcyA9IHBhZ2VzXG4gIH1cblxuICBjbGVhclJlY29yZHNOb3RBZGRWZXJzaW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNTZWxlY3Rpb25WaWV3KCkgJiYgdGhpcy5nZXRTZWxlY3RlZFJlY29yZHMoKS5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KFtdKVxuICAgIH1cbiAgICB0aGlzLnBhZ2VzID0ge31cbiAgICB0aGlzLnBhZ2VQcm9taXNlcyA9IHt9XG4gICAgdGhpcy5sb2FkTWlzc2luZ0ZpZWxkc0J5UGFnZVByb21pc2VzID0ge31cbiAgICB0aGlzLmxvYWRNaXNzaW5nRmllbGRzRm9yQWxsUGFnZVByb21pc2UgPSBudWxsXG4gICAgdGhpcy5jb3VudCA9IG51bGxcbiAgICB0aGlzLmNvdW50UHJvbWlzZSA9IG51bGxcbiAgICB0aGlzLmJ5SWRQcm9taXNlID0gbnVsbFxuICB9XG5cbiAgLyoqXG4gICAqIGdldCBjb250aW51aW91cyBwYWdlIHJlY29yZHNcbiAgICovXG4gIGdldFJlY29yZHMgKCk6IERhdGFSZWNvcmRbXSB7XG4gICAgbGV0IHJlY29yZHMgPSBbXVxuICAgIGNvbnN0IHBhZ2VzID0gW10gLy8gY29udGludWlvdXMgcGFnZXNcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBPYmplY3Qua2V5cyh0aGlzLnBhZ2VzKS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCF0aGlzLnBhZ2VzW2ldKSB7XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBwYWdlcy5wdXNoKGkpXG4gICAgfVxuICAgIHBhZ2VzLmZvckVhY2gocGFnZSA9PiB7XG4gICAgICByZWNvcmRzID0gcmVjb3Jkcy5jb25jYXQodGhpcy5wYWdlc1twYWdlXSlcbiAgICB9KVxuICAgIGlmICh0aGlzLmdldE1heFJlY29yZENvdW50KCkgIT09IG51bGwgJiYgdGhpcy5nZXRNYXhSZWNvcmRDb3VudCgpIDwgcmVjb3Jkcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiByZWNvcmRzLnNsaWNlKDAsIHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSlcbiAgICB9XG4gICAgcmV0dXJuIHJlY29yZHNcbiAgfVxuXG4gIHNldFJlY29yZHMgKHJlY29yZHM6IERhdGFSZWNvcmRbXSkge1xuICAgIGNvbnN0IHBhZ2VzID0ge31cbiAgICBjb25zdCBwYWdlU2l6ZSA9IHRoaXMuZ2V0UXVlcnlQYWdlU2l6ZSgpXG5cbiAgICByZWNvcmRzLmZvckVhY2goKHIsIGkpID0+IHtcbiAgICAgIGNvbnN0IG5ld1BhZ2VOdW1iZXIgPSBNYXRoLmNlaWwoKGkgKyAxKSAvIHBhZ2VTaXplKVxuICAgICAgaWYgKCFwYWdlc1tuZXdQYWdlTnVtYmVyXSkge1xuICAgICAgICBwYWdlc1tuZXdQYWdlTnVtYmVyXSA9IFtdXG4gICAgICB9XG4gICAgICBwYWdlc1tuZXdQYWdlTnVtYmVyXVtpICUgcGFnZVNpemVdID0gclxuICAgIH0pXG5cbiAgICB0aGlzLnNldFBhZ2VzRGF0YShwYWdlcylcbiAgICB0aGlzLmFkZFZlcnNpb24oKVxuICB9XG5cbiAgc2V0U291cmNlUmVjb3JkcyAocmVjb3JkczogRGF0YVJlY29yZFtdKSB7XG4gICAgc3VwZXIuc2V0U291cmNlUmVjb3JkcyhyZWNvcmRzKVxuICAgIGlmICh0aGlzLmNhblNhdmVTb3VyY2VSZWNvcmRzKCkpIHtcbiAgICAgIC8qKlxuICAgICAgICogSWYgaGF2ZSBhIGhvb2sgdG8gZG8gYWZ0ZXIgdGhlIGZpcnN0IHRpbWUgc2V0IHNvdXJjZSByZWNvcmRzLCBkbyBpdCBhbmQgY2xlYXIgdGhlIGhvb2suXG4gICAgICAgKi9cbiAgICAgIGlmICh0aGlzLm9uY2VTZXRTb3VyY2VSZWNvcmRzKSB7XG4gICAgICAgIGNvbnN0IG9uY2VTZXRTb3VyY2VSZWNvcmRzID0gdGhpcy5vbmNlU2V0U291cmNlUmVjb3Jkc1xuICAgICAgICB0aGlzLnNldE9uY2VTZXRTb3VyY2VSZWNvcmRzKG51bGwpXG4gICAgICAgIGxvZGFzaC5kZWZlcigoKSA9PiB7XG4gICAgICAgICAgb25jZVNldFNvdXJjZVJlY29yZHMoKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldCBjb3VudCAoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fY291bnRcbiAgfVxuXG4gIHNldCBjb3VudCAoYzogbnVtYmVyKSB7XG4gICAgdGhpcy5fY291bnQgPSBjXG4gIH1cblxuICBnZXRSZWFsUXVlcnlQYWdlcyAocGFnZTogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyKTogbnVtYmVyW10ge1xuICAgIC8vIHRoZSByZWNvcmQgaW5kZXggc3RhcnRzIGZyb20gMFxuICAgIGNvbnN0IHN0YXJ0ID0gcGFnZVNpemUgKiAocGFnZSAtIDEpXG4gICAgbGV0IGVuZCA9IHN0YXJ0ICsgcGFnZVNpemUgLSAxXG4gICAgaWYgKHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSAhPT0gbnVsbCkge1xuICAgICAgZW5kID0gTWF0aC5taW4oZW5kLCB0aGlzLmdldE1heFJlY29yZENvdW50KCkgLSAxKVxuICAgIH1cbiAgICBjb25zdCBzdGFydFBhZ2UgPSBNYXRoLmZsb29yKHN0YXJ0IC8gdGhpcy5nZXRRdWVyeVBhZ2VTaXplKCkpICsgMVxuICAgIGNvbnN0IGVuZFBhZ2UgPSBNYXRoLmZsb29yKGVuZCAvIHRoaXMuZ2V0UXVlcnlQYWdlU2l6ZSgpKSArIDFcbiAgICBjb25zdCBwYWdlcyA9IFtdXG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0UGFnZTsgaSA8PSBlbmRQYWdlOyBpKyspIHtcbiAgICAgIHBhZ2VzLnB1c2goaSlcbiAgICB9XG4gICAgcmV0dXJuIHBhZ2VzXG4gIH1cblxuICAvKipcbiAgICogdGhlIHBhZ2UvcGFnZVNpemUgaW4gcXVlcnkgd2lsbCBub3QgYmUgdXNlZCBpbiB0aGUgYWN0dWFsIHF1ZXJ5XG4gICAqL1xuICBsb2FkIChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM6IFF1ZXJ5T3B0aW9ucyA9IHt9KTogUHJvbWlzZTxEYXRhUmVjb3JkW10+IHtcbiAgICBpZiAodGhpcy5nZXRTdGF0dXMoKSA9PT0gRGF0YVNvdXJjZVN0YXR1cy5Ob3RSZWFkeSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbXSlcbiAgICB9XG5cbiAgICBxdWVyeSA9IHsgLi4ucXVlcnkgfVxuICAgIGlmICghcXVlcnkucGFnZSkge1xuICAgICAgcXVlcnkucGFnZSA9IDFcbiAgICB9XG4gICAgaWYgKCFxdWVyeS5wYWdlU2l6ZSkge1xuICAgICAgcXVlcnkucGFnZVNpemUgPSB0aGlzLmdldFF1ZXJ5UGFnZVNpemUoKVxuICAgIH1cblxuICAgIGNvbnN0IHF1ZXJ5UGFnZXMgPSB0aGlzLmdldFJlYWxRdWVyeVBhZ2VzKHF1ZXJ5LnBhZ2UsIHF1ZXJ5LnBhZ2VTaXplKVxuICAgIGlmICh0aGlzLmNoZWNrQ2xlYXJMb2NhbENhY2hlKHF1ZXJ5LCB0aGlzLmxhc3RRdWVyeVBhcmFtcywgb3B0aW9ucykpIHtcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMucGFnZXMpLmZvckVhY2goKHApID0+IHtcbiAgICAgICAgaWYgKCFxdWVyeVBhZ2VzLmluY2x1ZGVzKHBhcnNlSW50KHApKSkge1xuICAgICAgICAgIGRlbGV0ZSB0aGlzLnBhZ2VzW3BdXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICB0aGlzLnBhZ2VQcm9taXNlcyA9IHt9XG4gICAgICB0aGlzLmxvYWRNaXNzaW5nRmllbGRzQnlQYWdlUHJvbWlzZXMgPSB7fVxuICAgICAgdGhpcy5sb2FkTWlzc2luZ0ZpZWxkc0ZvckFsbFBhZ2VQcm9taXNlID0gbnVsbFxuICAgICAgdGhpcy5jb3VudCA9IG51bGxcbiAgICAgIHRoaXMuY291bnRQcm9taXNlID0gbnVsbFxuICAgIH1cblxuICAgIGNvbnN0IHF1ZXJ5V2l0aG91dFBhZ2UgPSB0aGlzLmdldFF1ZXJ5V2l0aG91dFBhZ2UocXVlcnkpXG4gICAgaWYgKCF1dGlscy5pc0RlZXBFcXVhbChxdWVyeVdpdGhvdXRQYWdlIHx8IHt9LCB0aGlzLmdldEluZm8oKS53aWRnZXRRdWVyaWVzPy5bb3B0aW9ucy53aWRnZXRJZF0gfHwge30pKSB7XG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMudXBkYXRlV2lkZ2V0UXVlcnkodGhpcy5pZCwgb3B0aW9ucy53aWRnZXRJZCwgcXVlcnlXaXRob3V0UGFnZSkpXG4gICAgfVxuXG4gICAgbGV0IHJlYWxRdWVyeSA9IHRoaXMuZ2V0UmVhbFF1ZXJ5UGFyYW1zKHF1ZXJ5V2l0aG91dFBhZ2UsICdsb2FkJywgb3B0aW9ucylcbiAgICBjb25zdCB1c2VkRmllbGRzID0gdGhpcy5nZXRBbGxVc2VkRmllbGRzKHsgcXVlcnlQYXJhbXM6IHJlYWxRdWVyeSwgZXhjbHVkZVdpZGdldHNEb05vdFVzZURzVG9RdWVyeTogdHJ1ZSB9KVxuICAgIHJlYWxRdWVyeSA9IHRoaXMuYXBwbHlVc2VkRmllbGRzKHJlYWxRdWVyeSwgdXNlZEZpZWxkcylcblxuICAgIHRoaXMubG9hZE1pc3NpbmdGaWVsZHMocmVhbFF1ZXJ5KVxuXG4gICAgY29uc3QgcGFnZVByb21pc2VzOiBBcnJheTxQcm9taXNlPGJvb2xlYW4+PiA9IHF1ZXJ5UGFnZXMuZmlsdGVyKHBhZ2UgPT4gdGhpcy5wYWdlUHJvbWlzZXNbcGFnZV0pLm1hcChwYWdlID0+IHRoaXMucGFnZVByb21pc2VzW3BhZ2VdLnByb21pc2UpXG4gICAgaWYgKHBhZ2VQcm9taXNlcy5sZW5ndGggPT09IHF1ZXJ5UGFnZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwocGFnZVByb21pc2VzKS50aGVuKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVjb3Jkc0J5UGFnZShxdWVyeS5wYWdlLCBxdWVyeS5wYWdlU2l6ZSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5sYXN0UXVlcnlQYXJhbXMgPSByZWFsUXVlcnlcblxuICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZGluZylcbiAgICB0aGlzLnNldE5lZWRSZWZyZXNoKGZhbHNlKVxuICAgIHJldHVybiBQcm9taXNlLmFsbChxdWVyeVBhZ2VzLm1hcChwYWdlID0+IHRoaXMubG9hZEJ5UGFnZShyZWFsUXVlcnksIHF1ZXJ5LCB1c2VkRmllbGRzLCBwYWdlKSkpLnRoZW4oKHJlc3VsdHMpID0+IHtcbiAgICAgIGNvbnN0IGlzVXNlZnVsID0gcmVzdWx0cy5maW5kKHIgPT4gcilcbiAgICAgIGlmICghaXNVc2VmdWwpIHtcbiAgICAgICAgLy8gVGVsbCB0aGUgd2lkZ2V0cyB3aGljaCBhcmUgdXNpbmcgdGhlIHJldHVybmVkIHByb21pc2UgdGhhdCB0aGlzIHJlc3VsdCBpcyBvdXRkYXRlZC5cbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgdGhpcy5oYW5kbGVTZWxlY3Rpb25PblF1ZXJ5UGFyYW1DaGFuZ2VzKClcblxuICAgICAgdGhpcy5sYXN0UmVmcmVzaFRpbWUgPSBuZXcgRGF0ZSgpXG5cbiAgICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZGVkKVxuXG4gICAgICBpZiAoISh3aW5kb3cuamltdUNvbmZpZy5pc0luQnVpbGRlciAmJiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwUnVudGltZUluZm8uYXBwTW9kZSA9PT0gQXBwTW9kZS5EZXNpZ24pKSB7XG4gICAgICAgIHRoaXMuc3RhcnRBdXRvUmVmcmVzaCgpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmdldFJlY29yZHNCeVBhZ2UocXVlcnkucGFnZSwgcXVlcnkucGFnZVNpemUpXG4gICAgfSwgZXJyID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgICAgdGhpcy5zZXRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkRXJyb3IpXG4gICAgICByZXR1cm4gW11cbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGFuZCBsb2FkIG1pc3NpbmcgZmllbGRzIGZvciBsb2FkZWQgcmVjb3Jkcy5cbiAgICogSWYgZGVsYXkgaXMgdHJ1ZSwgd2lsbCBtZXJnZSBtdWxpdHBsZSBjYWxscyBhbmQgc2VuZCBvbmUgcmVxdWVzdCBhZnRlciB0aW1lIHdpbmRvdyBydW4gb3V0LlxuICAgKi9cbiAgbG9hZE1pc3NpbmdGaWVsZHMgKHJlYWxRdWVyeTogUXVlcnlQYXJhbXMsIGRlbGF5ID0gZmFsc2UpIHtcbiAgICBsb2Rhc2guZGVmZXIoKCkgPT4ge1xuICAgICAgY29uc3QgdXNlZEZpZWxkcyA9IHRoaXMuZ2V0QWxsVXNlZEZpZWxkcyh7IHF1ZXJ5UGFyYW1zOiByZWFsUXVlcnksIGV4Y2x1ZGVXaWRnZXRzRG9Ob3RVc2VEc1RvUXVlcnk6IHRydWUgfSlcbiAgICAgIHRoaXMudXBkYXRlTG9hZE9uRGVtYW5kRmllbGRzKHVzZWRGaWVsZHMpXG4gICAgICBpZiAoZGVsYXkpIHtcbiAgICAgICAgdGhpcy51c2VkRmllbGRzSW5UaW1lV2luZG93ID0gdGhpcy5tZXJnZVVzZWRGaWVsZHModGhpcy51c2VkRmllbGRzSW5UaW1lV2luZG93LCB1c2VkRmllbGRzKVxuICAgICAgICBpZiAodGhpcy5sb2FkTWlzc2luZ0ZpZWxkc1RpbWVyKSB7XG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sb2FkTWlzc2luZ0ZpZWxkc1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5kb0xvYWRNaXNzaW5nRmllbGRzKHJlYWxRdWVyeSwgdGhpcy51c2VkRmllbGRzSW5UaW1lV2luZG93KVxuICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmxvYWRNaXNzaW5nRmllbGRzVGltZXIpXG4gICAgICAgICAgdGhpcy5sb2FkTWlzc2luZ0ZpZWxkc1RpbWVyID0gbnVsbFxuICAgICAgICAgIHRoaXMudXNlZEZpZWxkc0luVGltZVdpbmRvdyA9IFtdXG4gICAgICAgIH0sIDUwMClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZG9Mb2FkTWlzc2luZ0ZpZWxkcyhyZWFsUXVlcnksIHVzZWRGaWVsZHMpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgZG9Mb2FkTWlzc2luZ0ZpZWxkcyAocmVhbFF1ZXJ5OiBRdWVyeVBhcmFtcywgdXNlZEZpZWxkczogc3RyaW5nW10gfCAnKicpIHtcbiAgICBpZiAodGhpcy5pc1NlbGVjdGlvblZpZXcoKSkge1xuICAgICAgY29uc3QgcmVjb3JkcyA9IHRoaXMuZ2V0UmVjb3JkcygpXG4gICAgICBjb25zdCBub3RMb2FkZWRTb3VyY2VSZWNvcmRzID0gdGhpcy5nZXRTb3VyY2VSZWNvcmRzKCkuZmlsdGVyKHNSID0+ICFyZWNvcmRzLnNvbWUociA9PiByLmdldElkKCkgPT09IHNSLmdldElkKCkpKVxuICAgICAgY29uc3QgYWxsUmVjb3JkcyA9IHJlY29yZHMuY29uY2F0KG5vdExvYWRlZFNvdXJjZVJlY29yZHMpXG4gICAgICBjb25zdCBtaXNzaW5nRmllbGRzOiBzdHJpbmdbXSA9IFtdXG4gICAgICAvKipcbiAgICAgICAqIFNlbGVjdGVkIHJlY29yZCBtYXkgYmUgZnJvbSBhbnkgZGF0YSB2aWV3cywgc28gZmluZCBtaXNzaW5nIGZpZWxkcyBmcm9tIHJlY29yZHMuXG4gICAgICAgKiBOZWVkIHRvIGZpbmQgZnJvbSByZWNvcmRzIHNpbmNlIHJlY29yZHMgbWF5IG1pc3Mgc29tZSBmaWVsZHMgd2hpbGUgc291cmNlIHJlY29yZHMgZG9uJ3QuIFJlY29yZHMgYXJlIGxvYWRlZCBmcm9tIHNvdXJjZSByZWNvcmRzLlxuICAgICAgICovXG4gICAgICBhbGxSZWNvcmRzLmZvckVhY2gociA9PiB7XG4gICAgICAgIGNvbnN0IG1pc3NpbmdGaWVsZHNJblJlY29yZCA9IHRoaXMuZmluZE1pc3NpbmdGaWVsZHModXNlZEZpZWxkcywgT2JqZWN0LmtleXMoci5nZXREYXRhKCkpKVxuICAgICAgICBtaXNzaW5nRmllbGRzSW5SZWNvcmQuZm9yRWFjaChmID0+IHtcbiAgICAgICAgICBpZiAoIW1pc3NpbmdGaWVsZHMuaW5jbHVkZXMoZikpIHtcbiAgICAgICAgICAgIG1pc3NpbmdGaWVsZHMucHVzaChmKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgICBpZiAobWlzc2luZ0ZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqIFVwZGF0ZSBwcm9taXNlIGlmIDEuIGRpZG4ndCBsb2FkIG1pc3NpbmcgZmllbGRzIGZvciBzZWxlY3Rpb24gdmlldyBiZWZvcmUsIG9yLCAyLiBuZXcgbWlzc2luZyBmaWVsZHMgYXJlIG1vcmUgdGhhbiB0aGUgcHJldmlvdXMgbWlzc2luZyBmaWVsZHMuXG4gICAgICAgKi9cbiAgICAgIGlmICghdGhpcy5sb2FkTWlzc2luZ0ZpZWxkc0J5UGFnZVByb21pc2VzW1NFTEVDVElPTl9EQVRBX1ZJRVdfSURdIHx8IHRoaXMubWlzc2luZ1NvbWVGaWVsZHMobWlzc2luZ0ZpZWxkcywgdGhpcy5sb2FkTWlzc2luZ0ZpZWxkc0J5UGFnZVByb21pc2VzW1NFTEVDVElPTl9EQVRBX1ZJRVdfSURdLmZpZWxkcykpIHtcbiAgICAgICAgY29uc3QgaWRzID0gcmVjb3Jkcy5tYXAociA9PiByLmdldElkKCkpXG4gICAgICAgIGNvbnN0IGZpZWxkU2NoZW1hID0gdGhpcy5nZXRTY2hlbWEoKT8uZmllbGRzXG4gICAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzLnF1ZXJ5UmVjb3Jkc0J5SWRXaXRoQ3VycmVudFF1ZXJ5UGFyYW1zKGlkcywgdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLCB0aGlzLmFwcGx5VXNlZEZpZWxkcyhyZWFsUXVlcnksIG1pc3NpbmdGaWVsZHMpKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgaWYgKGZpZWxkU2NoZW1hICE9PSB0aGlzLmdldFNjaGVtYSgpPy5maWVsZHMpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCByZWNvcmRzID0gdGhpcy5nZXRSZWNvcmRzKClcbiAgICAgICAgICBjb25zdCBzb3VyY2VSZWNvcmRzID0gdGhpcy5nZXRTb3VyY2VSZWNvcmRzKClcbiAgICAgICAgICByZXMucmVjb3Jkcy5mb3JFYWNoKG5ld1JlY29yZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBwcmV2UmVjb3JkID0gcmVjb3Jkcy5maW5kKHIgPT4gci5nZXRJZCgpID09PSBuZXdSZWNvcmQuZ2V0SWQoKSlcbiAgICAgICAgICAgIGlmIChwcmV2UmVjb3JkKSB7XG4gICAgICAgICAgICAgIHByZXZSZWNvcmQuc2V0RGF0YSh7IC4uLnByZXZSZWNvcmQuZ2V0RGF0YSgpLCAuLi5uZXdSZWNvcmQuZ2V0RGF0YSgpIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwcmV2U291cmNlUmVjb3JkID0gc291cmNlUmVjb3Jkcy5maW5kKHIgPT4gci5nZXRJZCgpID09PSBuZXdSZWNvcmQuZ2V0SWQoKSlcbiAgICAgICAgICAgIGlmIChwcmV2U291cmNlUmVjb3JkKSB7XG4gICAgICAgICAgICAgIHByZXZTb3VyY2VSZWNvcmQuc2V0RGF0YSh7IC4uLnByZXZTb3VyY2VSZWNvcmQuZ2V0RGF0YSgpLCAuLi5uZXdSZWNvcmQuZ2V0RGF0YSgpIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICB0aGlzLmFkZFNvdXJjZVZlcnNpb24oKVxuICAgICAgICAgIHRoaXMuYWRkVmVyc2lvbigpXG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBtaXNzaW5nIGZpZWxkcywgJywgZXJyKVxuICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgICB0aGlzLmxvYWRNaXNzaW5nRmllbGRzQnlQYWdlUHJvbWlzZXNbU0VMRUNUSU9OX0RBVEFfVklFV19JRF0gPSB7IHByb21pc2UsIGZpZWxkczogbWlzc2luZ0ZpZWxkcyB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8qKlxuICAgICAgICogSWYgdGhlcmUgaXMgbm8gc3VjaCBhIHBhZ2UgdGhhdCBpcyBtaXNzaW5nIHNvbWUgZmllbGRzLCBubyBuZWVkIHRvIGxvYWQuXG4gICAgICAgKi9cbiAgICAgIGlmICghT2JqZWN0LnZhbHVlcyh0aGlzLnBhZ2VQcm9taXNlcykuc29tZShwID0+IHRoaXMubWlzc2luZ1NvbWVGaWVsZHModXNlZEZpZWxkcywgcC5maWVsZHMpKSkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgY29uc3QgbWlzc2luZ0ZpZWxkc0J5UGFnZTogeyBbcGFnZTogbnVtYmVyXTogc3RyaW5nW10gfSA9IHt9XG4gICAgICBPYmplY3Qua2V5cyh0aGlzLnBhZ2VQcm9taXNlcykuZm9yRWFjaChwYWdlSWQgPT4ge1xuICAgICAgICBjb25zdCBwYWdlID0gcGFyc2VJbnQocGFnZUlkKVxuICAgICAgICBjb25zdCBtaXNzaW5nRmllbGRzSW5QYWdlID0gdGhpcy5maW5kTWlzc2luZ0ZpZWxkcyh1c2VkRmllbGRzLCB0aGlzLnBhZ2VQcm9taXNlc1twYWdlXS5maWVsZHMpXG4gICAgICAgIG1pc3NpbmdGaWVsZHNCeVBhZ2VbcGFnZV0gPSBtaXNzaW5nRmllbGRzSW5QYWdlXG4gICAgICB9KVxuICAgICAgaWYgKCF0aGlzLmxvYWRNaXNzaW5nRmllbGRzRm9yQWxsUGFnZVByb21pc2UgfHwgT2JqZWN0LmtleXModGhpcy5wYWdlUHJvbWlzZXMpLnNvbWUocGFnZUlkID0+IHRoaXMubWlzc2luZ1NvbWVGaWVsZHMobWlzc2luZ0ZpZWxkc0J5UGFnZVtwYWdlSWRdLCB0aGlzLmxvYWRNaXNzaW5nRmllbGRzRm9yQWxsUGFnZVByb21pc2UuZmllbGRzW3BhZ2VJZF0pKSkge1xuICAgICAgICBjb25zdCBsb2FkTWlzc2luZ0ZpZWxkc0J5UGFnZVByb21pc2VzOiBBcnJheTxQcm9taXNlPGJvb2xlYW4+PiA9IFtdXG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMucGFnZVByb21pc2VzKS5mb3JFYWNoKHBhZ2VJZCA9PiB7XG4gICAgICAgICAgY29uc3QgcGFnZSA9IHBhcnNlSW50KHBhZ2VJZClcbiAgICAgICAgICBjb25zdCBtaXNzaW5nRmllbGRzSW5QYWdlID0gbWlzc2luZ0ZpZWxkc0J5UGFnZVtwYWdlXVxuICAgICAgICAgIGNvbnN0IHAgPSB0aGlzLmxvYWRNaXNzaW5nRmllbGRzQnlQYWdlKHJlYWxRdWVyeSwgbWlzc2luZ0ZpZWxkc0luUGFnZSwgcGFnZSlcbiAgICAgICAgICBsb2FkTWlzc2luZ0ZpZWxkc0J5UGFnZVByb21pc2VzLnB1c2gocClcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IFByb21pc2UuYWxsKGxvYWRNaXNzaW5nRmllbGRzQnlQYWdlUHJvbWlzZXMpLnRoZW4ocmVzdWx0cyA9PiB7XG4gICAgICAgICAgY29uc3QgaXNVc2VmdWwgPSByZXN1bHRzLmZpbmQociA9PiByKVxuICAgICAgICAgIGlmIChpc1VzZWZ1bCkge1xuICAgICAgICAgICAgdGhpcy5hZGRWZXJzaW9uKClcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBtaXNzaW5nIGZpZWxkcywgJywgZXJyKVxuICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgICB0aGlzLmxvYWRNaXNzaW5nRmllbGRzRm9yQWxsUGFnZVByb21pc2UgPSB7IHByb21pc2UsIGZpZWxkczogbWlzc2luZ0ZpZWxkc0J5UGFnZSB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBsb2FkTWlzc2luZ0ZpZWxkc0J5UGFnZSAocmVhbFF1ZXJ5OiBRdWVyeVBhcmFtcywgbWlzc2luZ0ZpZWxkczogc3RyaW5nW10sIHBhZ2U6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICghbWlzc2luZ0ZpZWxkcyB8fCBtaXNzaW5nRmllbGRzLmxlbmd0aCA9PT0gMCB8fCB0aGlzLnBhZ2VQcm9taXNlc1twYWdlXS5maWVsZHMgPT09ICcqJykge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0cnVlKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBwcm9taXNlIGlmIDEuIGRpZG4ndCBsb2FkIG1pc3NpbmcgZmllbGRzIGZvciB0aGUgcGFnZSBiZWZvcmUsIG9yLCAyLiBuZXcgbWlzc2luZyBmaWVsZHMgYXJlIG1vcmUgdGhhbiB0aGUgcHJldmlvdXMgbWlzc2luZyBmaWVsZHMuXG4gICAgICovXG4gICAgaWYgKCF0aGlzLmxvYWRNaXNzaW5nRmllbGRzQnlQYWdlUHJvbWlzZXNbcGFnZV0gfHwgdGhpcy5taXNzaW5nU29tZUZpZWxkcyhtaXNzaW5nRmllbGRzLCB0aGlzLmxvYWRNaXNzaW5nRmllbGRzQnlQYWdlUHJvbWlzZXNbcGFnZV0uZmllbGRzKSkge1xuICAgICAgY29uc3QgcmVhbFF1ZXJ5V2l0aFBhZ2UgPSB7IC4uLnJlYWxRdWVyeSwgLi4ueyBwYWdlLCBwYWdlU2l6ZTogdGhpcy5nZXRRdWVyeVBhZ2VTaXplKCkgfSB9XG4gICAgICBjb25zdCBmaWVsZFNjaGVtYSA9IHRoaXMuZ2V0U2NoZW1hKCk/LmZpZWxkc1xuICAgICAgY29uc3QgcHJvbWlzZSA9IHRoaXMucXVlcnkodGhpcy5hcHBseVVzZWRGaWVsZHMocmVhbFF1ZXJ5V2l0aFBhZ2UsIG1pc3NpbmdGaWVsZHMpLCB7IHNjb3BlOiBRdWVyeVNjb3BlLkluQWxsRGF0YSB9KS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgIGlmIChmaWVsZFNjaGVtYSAhPT0gdGhpcy5nZXRTY2hlbWEoKT8uZmllbGRzKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYWdlUHJvbWlzZXNbcmVzdWx0LnF1ZXJ5UGFyYW1zLnBhZ2VdLmZpZWxkcyA9ICh0aGlzLnBhZ2VQcm9taXNlc1tyZXN1bHQucXVlcnlQYXJhbXMucGFnZV0uZmllbGRzIGFzIHN0cmluZ1tdKS5jb25jYXQobWlzc2luZ0ZpZWxkcylcbiAgICAgICAgcmVzdWx0LnJlY29yZHM/LmZvckVhY2gobmV3UmVjb3JkID0+IHtcbiAgICAgICAgICBjb25zdCBwcmV2UmVjb3JkID0gdGhpcy5wYWdlc1tyZXN1bHQucXVlcnlQYXJhbXMucGFnZV0/LmZpbmQociA9PiByLmdldElkKCkgPT09IG5ld1JlY29yZC5nZXRJZCgpKVxuICAgICAgICAgIGlmIChwcmV2UmVjb3JkKSB7XG4gICAgICAgICAgICBwcmV2UmVjb3JkLnNldERhdGEoeyAuLi5wcmV2UmVjb3JkLmdldERhdGEoKSwgLi4ubmV3UmVjb3JkLmdldERhdGEoKSB9KVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBwcmV2UmVjb3JkSW5TZWxlY3Rpb24gPSB0aGlzLmdldFNlbGVjdGlvbkRhdGFWaWV3KCk/LmdldFNvdXJjZVJlY29yZHMoKT8uZmluZChyID0+IHIuZ2V0SWQoKSA9PT0gbmV3UmVjb3JkLmdldElkKCkpXG4gICAgICAgICAgaWYgKHByZXZSZWNvcmRJblNlbGVjdGlvbikge1xuICAgICAgICAgICAgcHJldlJlY29yZEluU2VsZWN0aW9uLnNldERhdGEoeyAuLi5wcmV2UmVjb3JkSW5TZWxlY3Rpb24uZ2V0RGF0YSgpLCAuLi5uZXdSZWNvcmQuZ2V0RGF0YSgpIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSlcbiAgICAgIHRoaXMubG9hZE1pc3NpbmdGaWVsZHNCeVBhZ2VQcm9taXNlc1twYWdlXSA9IHsgcHJvbWlzZSwgZmllbGRzOiBtaXNzaW5nRmllbGRzIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMubG9hZE1pc3NpbmdGaWVsZHNCeVBhZ2VQcm9taXNlc1twYWdlXS5wcm9taXNlXG4gIH1cblxuICAvKipcbiAgICogS2VlcCBzZWxlY3Rpb24gYWZ0ZXIgZGF0YSBzb3VyY2Ugb3IgZGF0YSB2aWV3IGlzIGxvYWRlZC5cbiAgICovXG4gIHByaXZhdGUgaGFuZGxlU2VsZWN0aW9uT25RdWVyeVBhcmFtQ2hhbmdlcyAoKSB7XG4gICAgLyoqXG4gICAgICogSWYgaXMgdXNpbmcgbm9fc2VsZWN0aW9uIHZpZXcgdG8gc2hvdyBkZWZhdWx0IHN0YXR1cywgbm8gbmVlZCB0byB1cGRhdGUgc2VsZWN0aW9uIGluZm8gc2luY2UgdGhlIGxvYWRlZCByZWNvcmRzIGFyZSBub3Qgc2VsZWN0ZWQgYnkgdXNlcnMsIHRoZXkgYXJlIGZyb20gbm9fc2VsZWN0aW9uIHZpZXcuXG4gICAgICogV2UgZG8gbm90IGV4cGVjdCByZWNvcmRzIG9mIG5vX3NlbGVjdGlvbiB2aWV3IGFyZSBoaWdodGxpZ2h0ZWQuXG4gICAgICovXG4gICAgaWYgKHRoaXMudXNlTm9TZWxlY3Rpb25WaWV3KHRoaXMuZ2V0U2VsZWN0aW9uRGF0YVZpZXcoKSkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERvIG5vdCB1cGRhdGUgc2VsZWN0aW9uIGluZm8gaWYgdGhlcmUgaXMgYSBwZW5kaW5nIHByb21pc2UgdG8gbG9hZCBwcmVzZXQgc2VsZWN0ZWQgcmVjb3JkcyAoZS5nLiBwcmVzZXQgaW4gVVJMKS5cbiAgICAgKi9cbiAgICBpZiAoKHRoaXMuZ2V0U2VsZWN0aW9uRGF0YVZpZXcoKSBhcyBhbnkpLnBlbmRpbmdQcm9taXNlVG9RdWVyeVNlbGVjdGVkUmVjb3Jkc1ByZXNldEJlZm9yZURzUmVhZHkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IGlzTm9TZWxlY3Rpb25WaWV3ID0gdGhpcy5pc0RhdGFWaWV3ICYmIHRoaXMuZGF0YVZpZXdJZCA9PT0gREFUQV9WSUVXX0lEX0ZPUl9OT19TRUxFQ1RJT05cbiAgICBjb25zdCBpc1NlbGVjdGlvblZpZXcgPSB0aGlzLmlzU2VsZWN0aW9uVmlldygpXG4gICAgY29uc3QgaXNMb2NhbFZpZXdPZlNlbGVjdGlvblZpZXcgPSB0aGlzLmlzTG9jYWxWaWV3T2ZTZWxlY3Rpb25WaWV3KClcbiAgICBjb25zdCBpc05vdFNlbGVjdGlvblZpZXdPck5vU2VsZWN0aW9uVmlldyA9ICFpc05vU2VsZWN0aW9uVmlldyAmJiAhaXNTZWxlY3Rpb25WaWV3ICYmICFpc0xvY2FsVmlld09mU2VsZWN0aW9uVmlld1xuICAgIGlmIChpc05vdFNlbGVjdGlvblZpZXdPck5vU2VsZWN0aW9uVmlldykge1xuICAgICAgLyoqXG4gICAgICAgKiBJZiBkYXRhIGlzIHNhdmVkIGluIGRhdGEgc291cmNlIGluc3RhbmNlLCBmaW5kIHNlbGVjdGVkIHJlY29yZHMgZnJvbSBzb3VyY2UgcmVjb3JkcyAocmVjb3JkcyBtYXkgbm90IGxvYWQsIGUuZy4gY2hhcnQgb3V0cHV0IGRhdGEgc291cmNlKSxcbiAgICAgICAqIGVsc2UsIGZpbmQgc2VsZWN0ZWQgcmVjb3JkcyBmcm9tIHJlY29yZHMgKHNlbGVjdGVkIHJlY29yZHMgc2hvdWxkIGFscmVhZHkgYmUgbG9hZGVkKS5cbiAgICAgICAqL1xuICAgICAgY29uc3QgcmVjb3JkcyA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSA/IHRoaXMuZ2V0U291cmNlUmVjb3JkcygpIDogdGhpcy5nZXRSZWNvcmRzKClcblxuICAgICAgLyoqXG4gICAgICAgKiAxLiBVcGRhdGUgc291cmNlIHJlY29yZHMgb2Ygc2VsZWN0aW9uIHZpZXcgLSBjb3B5IHJlY29yZHMgdGhhdCBzYXRpc2Z5IGFsbCBvZiB0aGVzZSAzIGNvbmRpdGlvbnMgKDEuIGxvYWRlZCAyLiBpbiBzZWxlY3RlZCByZWNvcmQgaWRzIG9mIGRhdGEgc291cmNlIGluZm8gMy4gbm90IGluIHNvdXJjZSByZWNvcmRzIG9mIHNlbGVjdGlvbiB2aWV3KSB0byBzZWxlY3Rpb24gdmlldy5cbiAgICAgICAqL1xuICAgICAgbGV0IHNlbGVjdGVkUmVjb3Jkc05vdEluU2VsZWN0aW9uVmlldyA9IFtdXG4gICAgICB0aGlzLmdldFNlbGVjdGVkUmVjb3JkSWRzKCkuZm9yRWFjaChpZCA9PiB7XG4gICAgICAgIGNvbnN0IGlzSW5TZWxlY3Rpb25WaWV3ID0gdGhpcy5nZXRTZWxlY3Rpb25EYXRhVmlldygpLmdldFNvdXJjZVJlY29yZHMoKS5zb21lKHIgPT4gci5nZXRJZCgpID09PSBpZClcbiAgICAgICAgY29uc3QgciA9IHJlY29yZHMuZmluZChyID0+IHI/LmdldElkKCkgPT09IGlkKVxuICAgICAgICBpZiAoIWlzSW5TZWxlY3Rpb25WaWV3ICYmIHIpIHtcbiAgICAgICAgICBzZWxlY3RlZFJlY29yZHNOb3RJblNlbGVjdGlvblZpZXcgPSBzZWxlY3RlZFJlY29yZHNOb3RJblNlbGVjdGlvblZpZXcuY29uY2F0KHIpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBpZiAoc2VsZWN0ZWRSZWNvcmRzTm90SW5TZWxlY3Rpb25WaWV3Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5jb3B5U2VsZWN0aW9uVG9EYXRhVmlldyh0aGlzLmdldFNlbGVjdGlvbkRhdGFWaWV3KCkuZ2V0U291cmNlUmVjb3JkcygpLmNvbmNhdChzZWxlY3RlZFJlY29yZHNOb3RJblNlbGVjdGlvblZpZXcpKVxuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIDIuIENoZWNrIGFuZCB1cGRhdGUgc2VsZWN0aW9uIGluZm8gb2YgZGF0YSBzb3VyY2VzIHdoaWNoIGFyZSBkZXJpdmVkIGZyb20gdGhlIGN1cnJlbnQgZGF0YSBzb3VyY2UuXG4gICAgICAgKi9cbiAgICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uSW5mb09mRGVyaXZlZERzc0FuZENoYW5nZVVybCh7IC4uLnRoaXMuZ2V0U2VsZWN0T3B0aW9uc0Zyb21JbmZvKCk/LmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSksIGlkczogdGhpcy5nZXRTZWxlY3Rpb25EYXRhVmlldygpLmdldFJlY29yZHMoKS5tYXAociA9PiByLmdldElkKCkpIH0sIHRoaXMsIHRydWUpXG4gICAgfSBlbHNlIGlmIChpc1NlbGVjdGlvblZpZXcpIHtcbiAgICAgIC8qKlxuICAgICAgICogMS4gQ2hlY2sgYW5kIHVwZGF0ZSBzZWxlY3Rpb24gaW5mbyBvZiBkYXRhIHNvdXJjZXMgd2hpY2ggYXJlIGRlcml2ZWQgZnJvbSBtYWluIGRhdGEgc291cmNlLlxuICAgICAgICovXG4gICAgICAodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpIGFzIEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSkudXBkYXRlU2VsZWN0aW9uSW5mb09mRGVyaXZlZERzc0FuZENoYW5nZVVybCh7IC4uLnRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRTZWxlY3RPcHRpb25zRnJvbUluZm8oKT8uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KSwgaWRzOiB0aGlzLmdldFJlY29yZHMoKS5tYXAociA9PiByLmdldElkKCkpIH0pXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIHRoZSByZXNvbHZlZCBib29sZWFuIG1lYW5zIHdoZXRoZXIgdGhlIHF1ZXJ5IHJlc3VsdCBpcyB1c2VkIChvbmx5IHRoZSBsYXN0IHF1ZXJ5IHVwZGF0ZSByZWNvcmRzKVxuICAgKiBAcGFyYW0gcmVhbFF1ZXJ5XG4gICAqIEBwYXJhbSBwYWdlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGxvYWRCeVBhZ2UgKHJlYWxRdWVyeTogUXVlcnlQYXJhbXMsIG9yaWdpblF1ZXJ5OiBRdWVyeVBhcmFtcywgdXNlZEZpZWxkczogc3RyaW5nW10gfCAnKicsIHBhZ2U6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICh0aGlzLnBhZ2VQcm9taXNlc1twYWdlXSkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucGFnZVByb21pc2VzW3BhZ2VdLnByb21pc2VcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJZiBzb3VyY2UgcmVjb3JkcyBtaXNzIHNvbWUgZmllbGRzLCB0aGUgcXVlcnkgbWF5IG5vdCBleGVjdXRlIHN1Y2Nlc3NmdWxseS4gRm9yIGV4YW1wbGUsIHNvdXJjZSByZWNvcmRzIG1pc3MgZmllbGRzIHVzZWQgaW4gZmlsdGVyLlxuICAgICAqIFdhaXQgdW50aWwgbG9hZCBtaXNzaW5nIGZpZWxkcyBpcyBkb25lLlxuICAgICAqL1xuICAgIGlmICh0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuaXNEYXRhSW5EYXRhU291cmNlSW5zdGFuY2UgJiYgdGhpcy5zb3VyY2VSZWNvcmRzTWlzc2luZ0ZpZWxkcyh0aGlzLmdldFNvdXJjZVJlY29yZHMoKSwgdXNlZEZpZWxkcykpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmFsc2UpXG4gICAgfVxuXG4gICAgY29uc3QgcmVhbFF1ZXJ5V2l0aFBhZ2UgPSB7IC4uLnJlYWxRdWVyeSwgLi4ueyBwYWdlLCBwYWdlU2l6ZTogdGhpcy5nZXRRdWVyeVBhZ2VTaXplKCkgfSB9XG4gICAgY29uc3QgcHJvbWlzZSA9IHRoaXMuZG9RdWVyeShJbW11dGFibGUocmVhbFF1ZXJ5V2l0aFBhZ2UpLCBJbW11dGFibGUob3JpZ2luUXVlcnkpKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICBjb25zdCByZXN1bHRRdWVyeVdpdGhvdXRQYWdlID0gdGhpcy5nZXRRdWVyeVdpdGhvdXRQYWdlKHJlc3VsdC5xdWVyeVBhcmFtcylcbiAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgbGFzdCBxdWVyeSBhbmQgdGhlIGxhc3Qgc291cmNlIHRha2UgZWZmZWN0LlxuICAgICAgaWYgKCF1dGlscy5pc0RlZXBFcXVhbChyZXN1bHRRdWVyeVdpdGhvdXRQYWdlLCB0aGlzLmxhc3RRdWVyeVBhcmFtcykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgICAvLyBJZiBvbmx5IHNvdXJjZSB2ZXJzaW9uIGlzIGluY29ycmVjdCwgZG8gdGhlIHF1ZXJ5IGFnYWluLlxuICAgICAgaWYgKCh0eXBlb2YgcmVzdWx0LnNvdXJjZVZlcnNpb24gPT09ICdudW1iZXInICYmIHJlc3VsdC5zb3VyY2VWZXJzaW9uICE9PSB0aGlzLmdldFNvdXJjZVZlcnNpb24oKSkpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMucGFnZVByb21pc2VzW3BhZ2VdXG4gICAgICAgIHJldHVybiB0aGlzLmxvYWRCeVBhZ2UocmVhbFF1ZXJ5LCBvcmlnaW5RdWVyeSwgdXNlZEZpZWxkcywgcGFnZSlcbiAgICAgIH1cbiAgICAgIHRoaXMucGFnZXNbcmVzdWx0LnF1ZXJ5UGFyYW1zLnBhZ2VdID0gcmVzdWx0LnJlY29yZHNcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSlcblxuICAgIHRoaXMucGFnZVByb21pc2VzW3BhZ2VdID0geyBwcm9taXNlLCBmaWVsZHM6IHVzZWRGaWVsZHMgfVxuXG4gICAgcmV0dXJuIHRoaXMucGFnZVByb21pc2VzW3BhZ2VdLnByb21pc2VcbiAgfVxuXG4gIHByaXZhdGUgc291cmNlUmVjb3Jkc01pc3NpbmdGaWVsZHMgKHNvdXJjZVJlY29yZHM6IERhdGFSZWNvcmRbXSwgdXNlZEZpZWxkczogJyonIHwgc3RyaW5nW10pOiBib29sZWFuIHtcbiAgICBpZiAoIXNvdXJjZVJlY29yZHMgfHwgIXVzZWRGaWVsZHMpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gc291cmNlUmVjb3Jkcy5zb21lKHIgPT4gdGhpcy5taXNzaW5nU29tZUZpZWxkcyh1c2VkRmllbGRzLCBPYmplY3Qua2V5cyhyLmdldERhdGEoKSkpKVxuICB9XG5cbiAgbG9hZENvdW50IChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM6IFF1ZXJ5T3B0aW9ucyA9IHt9KTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBpZiAodGhpcy5nZXRDb3VudFN0YXR1cygpID09PSBEYXRhU291cmNlU3RhdHVzLk5vdFJlYWR5KSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKDApXG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmNoZWNrQ2xlYXJMb2NhbENhY2hlKHF1ZXJ5LCB0aGlzLmxhc3RDb3VudFF1ZXJ5UGFyYW1zLCBvcHRpb25zKSAmJiB0aGlzLmNvdW50UHJvbWlzZSkge1xuICAgICAgcmV0dXJuIHRoaXMuY291bnRQcm9taXNlXG4gICAgfVxuXG4gICAgY29uc3QgcmVhbFF1ZXJ5ID0gdGhpcy5nZXRSZWFsUXVlcnlQYXJhbXModGhpcy5nZXRRdWVyeVdpdGhvdXRQYWdlKHF1ZXJ5KSwgJ2xvYWQnLCBvcHRpb25zKVxuXG4gICAgdGhpcy5sYXN0Q291bnRRdWVyeVBhcmFtcyA9IHJlYWxRdWVyeVxuXG4gICAgdGhpcy5zZXRDb3VudFN0YXR1cyhEYXRhU291cmNlU3RhdHVzLkxvYWRpbmcpXG4gICAgdGhpcy5jb3VudFByb21pc2UgPSB0aGlzLmRvUXVlcnlDb3VudChJbW11dGFibGUocmVhbFF1ZXJ5KSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgLy8gTWFrZSBzdXJlIHRoZSBsYXN0IHF1ZXJ5IGFuZCB0aGUgbGFzdCBzb3VyY2UgdGFrZSBlZmZlY3QuXG4gICAgICBpZiAoIXV0aWxzLmlzRGVlcEVxdWFsKHJlc3VsdC5xdWVyeVBhcmFtcywgdGhpcy5sYXN0Q291bnRRdWVyeVBhcmFtcykpIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICAgIC8vIElmIG9ubHkgc291cmNlIHZlcnNpb24gaXMgaW5jb3JyZWN0LCBkbyB0aGUgcXVlcnkgYWdhaW4uXG4gICAgICBpZiAoKHR5cGVvZiByZXN1bHQuc291cmNlVmVyc2lvbiA9PT0gJ251bWJlcicgJiYgcmVzdWx0LnNvdXJjZVZlcnNpb24gIT09IHRoaXMuZ2V0U291cmNlVmVyc2lvbigpKSkge1xuICAgICAgICBkZWxldGUgdGhpcy5jb3VudFByb21pc2VcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZENvdW50KHF1ZXJ5LCBvcHRpb25zKVxuICAgICAgfVxuICAgICAgaWYgKHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLmNvdW50ID0gcmVzdWx0LmNvdW50XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNvdW50ID0gTWF0aC5taW4ocmVzdWx0LmNvdW50LCB0aGlzLmdldE1heFJlY29yZENvdW50KCkpXG4gICAgICB9XG5cbiAgICAgIHRoaXMuc2V0Q291bnRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkZWQpXG4gICAgICByZXR1cm4gdGhpcy5jb3VudFxuICAgIH0sIGVyciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycilcbiAgICAgIHRoaXMuc2V0Q291bnRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkRXJyb3IpXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKVxuICAgIH0pXG4gICAgcmV0dXJuIHRoaXMuY291bnRQcm9taXNlXG4gIH1cblxuICBsb2FkQnlJZCAoaWQ6IHN0cmluZywgcmVmcmVzaD86IGJvb2xlYW4pOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICBpZiAodGhpcy5nZXRTdGF0dXMoKSA9PT0gRGF0YVNvdXJjZVN0YXR1cy5Ob3RSZWFkeSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKVxuICAgIH1cblxuICAgIGlmIChpZCA9PT0gdGhpcy5sYXN0UXVlcnlJZCAmJiAhcmVmcmVzaCAmJiB0aGlzLmJ5SWRQcm9taXNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5ieUlkUHJvbWlzZVxuICAgIH1cblxuICAgIHRoaXMubGFzdFF1ZXJ5SWQgPSBpZFxuXG4gICAgdGhpcy5zZXRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkaW5nKVxuICAgIHRoaXMuYnlJZFByb21pc2UgPSB0aGlzLmRvUXVlcnlCeUlkKGlkKS50aGVuKHJlY29yZCA9PiB7XG4gICAgICB0aGlzLnNldFN0YXR1cyhEYXRhU291cmNlU3RhdHVzLkxvYWRlZClcbiAgICAgIHJldHVybiByZWNvcmRcbiAgICB9LCBlcnIgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgICB0aGlzLnNldFN0YXR1cyhEYXRhU291cmNlU3RhdHVzLkxvYWRFcnJvcilcbiAgICAgIHJldHVybiBudWxsXG4gICAgfSlcbiAgICByZXR1cm4gdGhpcy5ieUlkUHJvbWlzZVxuICB9XG5cbiAgcXVlcnkgKHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICBpZiAodGhpcy5nZXRTdGF0dXMoKSA9PT0gRGF0YVNvdXJjZVN0YXR1cy5Ob3RSZWFkeSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIHF1ZXJ5UGFyYW1zOiBJbW11dGFibGUocXVlcnkpLFxuICAgICAgICByZWNvcmRzOiBbXSxcbiAgICAgICAgZmllbGRzOiBbXSxcbiAgICAgICAgc291cmNlVmVyc2lvbjogdGhpcy5nZXRTb3VyY2VWZXJzaW9uKClcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgY29uc3QgcmVhbFF1ZXJ5ID0gdGhpcy5nZXRSZWFsUXVlcnlQYXJhbXMocXVlcnksICdxdWVyeScsIG9wdGlvbnMpXG4gICAgcmV0dXJuIHRoaXMuZG9RdWVyeShJbW11dGFibGUocmVhbFF1ZXJ5KSwgSW1tdXRhYmxlKHF1ZXJ5KSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgY29uc3QgbWF4Q291bnQgPSB0aGlzLmdldE1heFJlY29yZENvdW50KClcbiAgICAgIGlmIChtYXhDb3VudCA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBhZ2UgPSByZXN1bHQucXVlcnlQYXJhbXMucGFnZSB8fCAxXG4gICAgICBjb25zdCBwYWdlU2l6ZSA9IHJlc3VsdC5xdWVyeVBhcmFtcy5wYWdlU2l6ZVxuXG4gICAgICBpZiAocGFnZSA9PT0gMSB8fCAhcGFnZVNpemUpIHtcbiAgICAgICAgaWYgKHJlc3VsdC5yZWNvcmRzLmxlbmd0aCA+IG1heENvdW50KSB7XG4gICAgICAgICAgcmVzdWx0LnJlY29yZHMgPSByZXN1bHQucmVjb3Jkcy5zbGljZSgwLCBtYXhDb3VudClcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCgocGFnZSAtIDEpICogcGFnZVNpemUpID4gbWF4Q291bnQpIHtcbiAgICAgICAgICByZXN1bHQucmVjb3JkcyA9IFtdXG4gICAgICAgIH0gZWxzZSBpZiAoKHBhZ2UgLSAxKSAqIHBhZ2VTaXplICsgcmVzdWx0LnJlY29yZHMubGVuZ3RoID4gbWF4Q291bnQpIHtcbiAgICAgICAgICByZXN1bHQucmVjb3JkcyA9IHJlc3VsdC5yZWNvcmRzLnNsaWNlKDAsIChwYWdlIC0gMSkgKiBwYWdlU2l6ZSArIHJlc3VsdC5yZWNvcmRzLmxlbmd0aCAtIG1heENvdW50KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0XG4gICAgfSlcbiAgfVxuXG4gIHF1ZXJ5Q291bnQgKHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICBpZiAodGhpcy5nZXRDb3VudFN0YXR1cygpID09PSBEYXRhU291cmNlU3RhdHVzLk5vdFJlYWR5KSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgcXVlcnlQYXJhbXM6IEltbXV0YWJsZShxdWVyeSksXG4gICAgICAgIGNvdW50OiAwLFxuICAgICAgICBzb3VyY2VWZXJzaW9uOiB0aGlzLmdldFNvdXJjZVZlcnNpb24oKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBpZiAodGhpcy51c2VOb1NlbGVjdGlvblZpZXcoKSkge1xuICAgICAgY29uc3Qgbm9TZWxlY3Rpb25WaWV3ID0gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFWaWV3KENPTlNUQU5UUy5EQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTilcbiAgICAgIGlmIChub1NlbGVjdGlvblZpZXcpIHtcbiAgICAgICAgcmV0dXJuIG5vU2VsZWN0aW9uVmlldy5xdWVyeUNvdW50KHF1ZXJ5LCBvcHRpb25zKVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHJlYWxRdWVyeSA9IHRoaXMuZ2V0UmVhbFF1ZXJ5UGFyYW1zKHF1ZXJ5LCAncXVlcnknLCBvcHRpb25zKVxuXG4gICAgcmV0dXJuIHRoaXMuZG9RdWVyeUNvdW50KEltbXV0YWJsZShyZWFsUXVlcnkpKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICBpZiAodGhpcy5nZXRNYXhSZWNvcmRDb3VudCgpID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdC5jb3VudCA9IE1hdGgubWluKHJlc3VsdC5jb3VudCwgdGhpcy5nZXRNYXhSZWNvcmRDb3VudCgpKVxuICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHF1ZXJ5SWRzIChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgaWYgKHRoaXMuZ2V0Q291bnRTdGF0dXMoKSA9PT0gRGF0YVNvdXJjZVN0YXR1cy5Ob3RSZWFkeSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIHF1ZXJ5UGFyYW1zOiBJbW11dGFibGUocXVlcnkpLFxuICAgICAgICBpZHM6IFtdLFxuICAgICAgICBzb3VyY2VWZXJzaW9uOiB0aGlzLmdldFNvdXJjZVZlcnNpb24oKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBpZiAodGhpcy51c2VOb1NlbGVjdGlvblZpZXcoKSkge1xuICAgICAgY29uc3Qgbm9TZWxlY3Rpb25WaWV3ID0gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFWaWV3KENPTlNUQU5UUy5EQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTilcbiAgICAgIGlmIChub1NlbGVjdGlvblZpZXcpIHtcbiAgICAgICAgcmV0dXJuIG5vU2VsZWN0aW9uVmlldy5xdWVyeUlkcyhxdWVyeSwgb3B0aW9ucylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZWFsUXVlcnkgPSB0aGlzLmdldFJlYWxRdWVyeVBhcmFtcyhxdWVyeSwgJ3F1ZXJ5Jywgb3B0aW9ucylcblxuICAgIHJldHVybiB0aGlzLmRvUXVlcnlJZHMoSW1tdXRhYmxlKHJlYWxRdWVyeSkpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgIGlmICh0aGlzLmdldE1heFJlY29yZENvdW50KCkgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbWF4Q291bnQgPSBNYXRoLm1pbihyZXN1bHQuaWRzLmxlbmd0aCwgdGhpcy5nZXRNYXhSZWNvcmRDb3VudCgpKVxuICAgICAgICByZXN1bHQuaWRzLnNwbGljZShtYXhDb3VudClcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBxdWVyeUFsbCAocXVlcnk6IFF1ZXJ5UGFyYW1zLCBzaWduYWw/OiBBYm9ydFNpZ25hbCwgcHJvZ3Jlc3NDYWxsYmFjaz86IFF1ZXJ5UHJvZ3Jlc3NDYWxsYmFjaywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICBjb25zdCBxID0geyAuLi5xdWVyeSB9XG4gICAgY29uc3QgcmVzdWx0OiBRdWVyeVJlc3VsdCA9IHtcbiAgICAgIHF1ZXJ5UGFyYW1zOiBJbW11dGFibGUocSkud2l0aG91dCgncGFnZScpLndpdGhvdXQoJ3BhZ2VTaXplJyksXG4gICAgICByZWNvcmRzOiBbXVxuICAgIH1cblxuICAgIGNvbnN0IHNldElzQWJvcnRlZCA9IChyZXN1bHQ6IFF1ZXJ5UmVzdWx0KTogUXVlcnlSZXN1bHQgPT4ge1xuICAgICAgcmVzdWx0LmlzQWJvcnRlZCA9IHRydWVcbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9XG5cbiAgICBjb25zdCBxdWVyeUJ5UGFnZSA9IGFzeW5jIChwYWdlU2l6ZTogbnVtYmVyLCBwYWdlQ291bnQ6IG51bWJlciwgcmVzdWx0OiBRdWVyeVJlc3VsdCwgc2lnbmFsPzogQWJvcnRTaWduYWwsIHByb2dyZXNzQ2FsbGJhY2s/OiBRdWVyeVByb2dyZXNzQ2FsbGJhY2spOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiA9PiB7XG4gICAgICBpZiAocGFnZUNvdW50ID4gMCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBwYWdlQ291bnQ7IGkrKykge1xuICAgICAgICAgIHEucGFnZSA9IGlcbiAgICAgICAgICBxLnBhZ2VTaXplID0gcGFnZVNpemVcblxuICAgICAgICAgIGNvbnN0IHIgPSBhd2FpdCB0aGlzLnF1ZXJ5KHEsIG9wdGlvbnMpXG5cbiAgICAgICAgICBpZiAocj8ucmVjb3JkcyAmJiByLnJlY29yZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gQ29uY2F0IGN1cnJlbnQgcGFnZSByZXN1bHQgdG8gYWxsIHJlc3VsdC5cbiAgICAgICAgICAgIHJlc3VsdC5yZWNvcmRzLnB1c2goLi4uci5yZWNvcmRzKVxuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBpcyBhYm9ydGVkLlxuICAgICAgICAgICAgaWYgKHNpZ25hbD8uYWJvcnRlZCkge1xuICAgICAgICAgICAgICByZXR1cm4gc2V0SXNBYm9ydGVkKHJlc3VsdClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2VuZCBwcm9ncmVzcy5cbiAgICAgICAgICAgIHByb2dyZXNzQ2FsbGJhY2s/LihpIC8gcGFnZUNvdW50LCByZXN1bHQpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBpcyBhYm9ydGVkIGJlZm9yZSBzZW5kaW5nIGFueSByZXF1ZXN0cy5cbiAgICBpZiAoc2lnbmFsPy5hYm9ydGVkKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHNldElzQWJvcnRlZChyZXN1bHQpKVxuICAgIH1cblxuICAgIC8vIFRoZSBwcm9jZXNzIGJlZ2lucy5cbiAgICBwcm9ncmVzc0NhbGxiYWNrPy4oMCwgcmVzdWx0KVxuXG4gICAgcmV0dXJuIHRoaXMucXVlcnlDb3VudChxLCBvcHRpb25zKS50aGVuKGNvdW50UmVzdWx0ID0+IHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgaWYgKHNpZ25hbCkge1xuICAgICAgICAgIC8vIEFib3J0IHRoZSBwcm9jZXNzIHdoZW5ldmVyIGFib3J0IG1ldGhvZCBvZiBhYm9ydCBjb250cm9sbGVyIGlzIGNhbGxlZC5cbiAgICAgICAgICBzaWduYWwub25hYm9ydCA9IGUgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZShzZXRJc0Fib3J0ZWQocmVzdWx0KSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0b3RhbENvdW50ID0gY291bnRSZXN1bHQuY291bnRcbiAgICAgICAgY29uc3QgbWF4Q291bnQgPSB0aGlzLmdldE1heFJlY29yZENvdW50KCkgIT09IG51bGwgPyBNYXRoLm1pbih0b3RhbENvdW50LCB0aGlzLmdldE1heFJlY29yZENvdW50KCkpIDogdG90YWxDb3VudFxuICAgICAgICBjb25zdCBwYWdlU2l6ZSA9IHRoaXMuZ2V0Q2FwYWJpbGl0aWVzKCk/LmdldFF1ZXJ5Q2FwYWJpbGl0aWVzKCk/Lm1heFBhZ2VTaXplIHx8IHRoaXMuZ2V0UXVlcnlQYWdlU2l6ZSgpXG4gICAgICAgIGNvbnN0IHBhZ2VDb3VudCA9IE1hdGguY2VpbChtYXhDb3VudCAvIHBhZ2VTaXplKVxuXG4gICAgICAgIHF1ZXJ5QnlQYWdlKHBhZ2VTaXplLCBwYWdlQ291bnQsIHJlc3VsdCwgc2lnbmFsLCBwcm9ncmVzc0NhbGxiYWNrKS50aGVuKHIgPT4geyByZXNvbHZlKHIpIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBhc3luYyBxdWVyeUJ5SWQgKGlkOiBzdHJpbmcpOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICBpZiAodGhpcy5nZXRTdGF0dXMoKSA9PT0gRGF0YVNvdXJjZVN0YXR1cy5Ob3RSZWFkeSkge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShudWxsKVxuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgdGhpcy5kb1F1ZXJ5QnlJZChpZClcbiAgfVxuXG4gIGdldEF1dG9SZWZyZXNoSW50ZXJ2YWwgKCk6IG51bWJlciB7XG4gICAgY29uc3QgZHM6IEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSA9IHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSBhcyBBYnN0cmFjdFF1ZXJpYWJsZURhdGFTb3VyY2VcbiAgICBsZXQgaW50ZXJ2YWwgPSBkcy5nZXREYXRhVmlld0NvbmZpZygpICYmIGRzLmdldERhdGFWaWV3Q29uZmlnKCkucmVmcmVzaEludGVydmFsXG4gICAgaWYgKGludGVydmFsID09PSAwKSB7IC8vIDAgbWVhbnMgZG8gbm90IGF1dG8gcmVmcmVzaC5cbiAgICAgIHJldHVybiAwXG4gICAgfVxuICAgIGlmIChpbnRlcnZhbCA9PT0gbnVsbCB8fCB0eXBlb2YgaW50ZXJ2YWwgPT09ICd1bmRlZmluZWQnKSB7IC8vIG1lYW5zIHVzZXIgbGF5ZXIvbWFwJ3Mgc2V0dGluZ1xuICAgICAgaW50ZXJ2YWwgPSBkcy5nZXRTY2hlbWEoKS5yZWZyZXNoSW50ZXJ2YWxcbiAgICB9XG4gICAgcmV0dXJuIGludGVydmFsXG4gIH1cblxuICBnZXRMYXN0UmVmcmVzaFRpbWUgKCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLmxhc3RSZWZyZXNoVGltZVxuICB9XG5cbiAgc3RhcnRBdXRvUmVmcmVzaCAoKSB7XG4gICAgY29uc3QgaW50ZXJ2YWwgPSB0aGlzLmdldEF1dG9SZWZyZXNoSW50ZXJ2YWwoKVxuXG4gICAgaWYgKCFpbnRlcnZhbCkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYXV0b1JlZnJlc2hIYW5kbGUpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIFJlc2V0IG5lZWRSZWZyZXNoIHRvIGZhbHNlLlxuICAgIHRoaXMuc2V0TmVlZFJlZnJlc2goZmFsc2UpXG4gICAgLy8gU3RhcnQgYSBuZXcgaW50ZXJ2YWwuXG4gICAgdGhpcy5hdXRvUmVmcmVzaEhhbmRsZSA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMuc2V0TmVlZFJlZnJlc2godHJ1ZSlcbiAgICAgIGxvZGFzaC5kZWZlcigoKSA9PiB7IHRoaXMuc2V0TmVlZFJlZnJlc2goZmFsc2UpIH0pXG4gICAgfSwgaW50ZXJ2YWwgKiAxMDAwKVxuICB9XG5cbiAgc3RvcEF1dG9SZWZyZXNoICgpIHtcbiAgICBpZiAodGhpcy5hdXRvUmVmcmVzaEhhbmRsZSkge1xuICAgICAgLy8gUmVzZXQgbmVlZFJlZnJlc2ggdG8gZmFsc2UuXG4gICAgICB0aGlzLnNldE5lZWRSZWZyZXNoKGZhbHNlKVxuICAgICAgLy8gQ2xlYXIgaW50ZXJ2YWwuXG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYXV0b1JlZnJlc2hIYW5kbGUpXG4gICAgICB0aGlzLmF1dG9SZWZyZXNoSGFuZGxlID0gbnVsbFxuICAgIH1cbiAgfVxuXG4gIHNldE5lZWRSZWZyZXNoIChuZWVkUmVmcmVzaDogYm9vbGVhbikge1xuICAgIC8qKlxuICAgICAqIENoYW5nZSBkYXRhIHNvdXJjZSBpbmZvIG9ubHkgd2hlbiBjdXJyZW50IGBuZWVkUmVmcmVzaGAgaXMgbm90IHNhbWUgYXMgbmV3IGBuZWVkUmVmcmVzaGAuXG4gICAgICovXG4gICAgaWYgKHRoaXMuZ2V0SW5mbygpLm5lZWRSZWZyZXNoICE9PSBuZWVkUmVmcmVzaCkge1xuICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLnNldERhdGFOZWVkUmVmcmVzaCh0aGlzLmlkLCBuZWVkUmVmcmVzaCkpXG4gICAgfVxuICB9XG5cbiAgc2V0Q2FwYWJpbGl0aWVzIChjYXA6IENhcGFiaWxpdGllcykge1xuICAgIHRoaXMuY2FwYWJpbGl0aWVzID0gY2FwXG4gIH1cblxuICBnZXRDYXBhYmlsaXRpZXMgKCk6IENhcGFiaWxpdGllcyB7XG4gICAgaWYgKHRoaXMuY2FuU2F2ZVNvdXJjZVJlY29yZHMoKSkge1xuICAgICAgcmV0dXJuIHRoaXMuY2FwYWJpbGl0aWVzXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0Q2FwYWJpbGl0aWVzKClcbiAgICB9XG4gIH1cblxuICBnZXRNYWluRGF0YVNvdXJjZSAoKTogUXVlcmlhYmxlRGF0YVNvdXJjZSB7XG4gICAgcmV0dXJuIHN1cGVyLmdldE1haW5EYXRhU291cmNlKCkgYXMgUXVlcmlhYmxlRGF0YVNvdXJjZVxuICB9XG5cbiAgZ2V0RGF0YVZpZXdzICgpOiBRdWVyaWFibGVEYXRhU291cmNlW10ge1xuICAgIHJldHVybiBzdXBlci5nZXREYXRhVmlld3MoKSBhcyBRdWVyaWFibGVEYXRhU291cmNlW11cbiAgfVxuXG4gIGdldERhdGFWaWV3IChkYXRhVmlld0lkOiBzdHJpbmcpOiBRdWVyaWFibGVEYXRhU291cmNlIHtcbiAgICByZXR1cm4gc3VwZXIuZ2V0RGF0YVZpZXcoZGF0YVZpZXdJZCkgYXMgUXVlcmlhYmxlRGF0YVNvdXJjZVxuICB9XG5cbiAgdXBkYXRlU2VsZWN0aW9uSW5mbyAob3B0aW9uczogUXVlcmlhYmxlU2VsZWN0T3B0aW9ucywgdHJpZ2dlckRhdGFTb3VyY2U6IFF1ZXJpYWJsZURhdGFTb3VyY2UsIGZvcmNlQ2hlY2s/OiBib29sZWFuKSB7XG4gICAgaWYgKCFvcHRpb25zPy5pZHMgJiYgIW9wdGlvbnM/LnJlY29yZHMpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBzZWxlY3RlZCByZWNvcmQgaWRzIG9ubHkgd2hlbiBjdXJyZW50IGRhdGEgc291cmNlIGxpc3RlbnMgc2VsZWN0aW9uIG9yIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgdGhlIGRhdGEgc291cmNlIHdoaWNoIHRyaWdnZXJzIHNlbGVjdGlvbi5cbiAgICAgKi9cbiAgICBjb25zdCBuZWVkVG9VcGRhdGVJbmZvID0gdGhpcy5nZXRMaXN0ZW5TZWxlY3Rpb24oKSB8fCB0aGlzLmlkID09PSB0cmlnZ2VyRGF0YVNvdXJjZT8uaWRcbiAgICBpZiAoIW5lZWRUb1VwZGF0ZUluZm8pIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1haW4gZGF0YSBzb3VyY2UgYW5kIG91dHB1dCB2aWV3IGNvbnRhaW5zIGFsbCByZWNvcmRzLCBubyBuZWVkIHRvIGNoZWNrIHdoZXRoZXIgc2VsZWN0ZWQgcmVjb3JkcyBtYXRjaCBxdWVyeSBwYXJhbXMgb2YgdGhlbS5cbiAgICAgKiBJZiBzZWxlY3RlZCByZWNvcmRzIGFyZSBlbXB0eSwgbm8gbmVlZCB0byBjaGVjaywgdG9vLlxuICAgICAqL1xuICAgIGNvbnN0IGlzTWFpbkRhdGFTb3VyY2UgPSAhdGhpcy5pc0xvY2FsICYmICF0aGlzLmlzRGF0YVZpZXdcbiAgICBjb25zdCBpc091dHB1dFZpZXcgPSB0aGlzLmRhdGFWaWV3SWQgPT09IE9VVFBVVF9EQVRBX1ZJRVdfSURcbiAgICBjb25zdCBpc1N1YnNldCA9ICFpc01haW5EYXRhU291cmNlICYmICFpc091dHB1dFZpZXdcbiAgICBjb25zdCBpZHMgPSBvcHRpb25zLnJlY29yZHM/Lm1hcChyID0+IHIuZ2V0SWQoKSkgfHwgb3B0aW9ucy5pZHNcbiAgICBjb25zdCBuZWVkVG9Eb0NoZWNrID0gKGZvcmNlQ2hlY2sgfHwgaXNTdWJzZXQpICYmIGlkcy5sZW5ndGggPiAwXG4gICAgaWYgKCFuZWVkVG9Eb0NoZWNrKSB7XG4gICAgICB0aGlzLmNoYW5nZVNlbGVjdGVkUmVjb3JkSWRzT2ZEc0luZm8ob3B0aW9ucylcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHJlY29yZHMgPSB0aGlzLmdldFJlY29yZHMoKVxuICAgIGNvbnN0IGN1cnJlbnRTZWxlY3RlZElkcyA9IHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRJZHMoKVxuICAgIGxldCBpZHNOb3RJbkxvYWRlZFJlY29yZHMgPSBbXVxuICAgIGxldCBpZHNJbkxvYWRlZFJlY29yZHMgPSBbXVxuICAgIGlkcy5mb3JFYWNoKGlkID0+IHtcbiAgICAgIGlmIChyZWNvcmRzLnNvbWUociA9PiByPy5nZXRJZCgpID09PSBpZCkgfHwgKCFmb3JjZUNoZWNrICYmIGN1cnJlbnRTZWxlY3RlZElkcy5zb21lKHNlbGVjdGVkSWQgPT4gc2VsZWN0ZWRJZCA9PT0gaWQpKSkge1xuICAgICAgICBpZHNJbkxvYWRlZFJlY29yZHMgPSBpZHNJbkxvYWRlZFJlY29yZHMuY29uY2F0KGlkKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWRzTm90SW5Mb2FkZWRSZWNvcmRzID0gaWRzTm90SW5Mb2FkZWRSZWNvcmRzLmNvbmNhdChpZClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLyoqXG4gICAgICogSWYgZXZlcnkgc2VsZWN0ZWQgcmVjb3JkIGlzIGFscmVhZHkgbG9hZGVkIG9yIGlzIGluIGN1cnJlbnQgc2VsZWN0ZWQgaWRzLCBubyBuZWVkIHRvIGNoZWNrLlxuICAgICAqL1xuICAgIGlmIChpZHNJbkxvYWRlZFJlY29yZHMubGVuZ3RoID09PSBpZHMubGVuZ3RoKSB7XG4gICAgICB0aGlzLmNoYW5nZVNlbGVjdGVkUmVjb3JkSWRzT2ZEc0luZm8ob3B0aW9ucylcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIHdoZXRoZXIgc2VsZWN0ZWQgcmVjb3JkcyBtYXRjaCBxdWVyeSBwYXJtYXMgb2YgY3VycmVudCBkYXRhIHNvdXJjZS5cbiAgICAgKi9cbiAgICB0aGlzLnRocm90dGxlUXVlcnlSZWNvcmRzQnlJZFdpdGhDdXJyZW50UXVlcnlQYXJhbXMoaWRzTm90SW5Mb2FkZWRSZWNvcmRzKS50aGVuKHJlcyA9PiB7XG4gICAgICBjb25zdCBwcmV2U2VsZWN0ZWRJZHMgPSBjdXJyZW50U2VsZWN0ZWRJZHNcbiAgICAgIGNvbnN0IGN1clNlbGVjdGVkSWRzID0gdGhpcy5nZXRTZWxlY3RlZFJlY29yZElkcygpXG4gICAgICBjb25zdCBpc1NlbGVjdGlvblN0aWxsVGhlU2FtZSA9IGN1clNlbGVjdGVkSWRzLmxlbmd0aCA9PT0gcHJldlNlbGVjdGVkSWRzLmxlbmd0aCAmJiBjdXJTZWxlY3RlZElkcy5ldmVyeShjdXJJZCA9PiBwcmV2U2VsZWN0ZWRJZHMuc29tZShwcmV2SWQgPT4gcHJldklkID09PSBjdXJJZCkpXG4gICAgICAvKipcbiAgICAgICAqIElmIHNlbGVjdGlvbiBoYXMgYmVlbiBjaGFuZ2VkIGR1cmluZyB0aGUgdGltZSB3YWl0aW5nIGZvciBjaGVjayByZXN1bHQgYmFjayAoZS5nLiBjaGFuZ2VkIGJ5IG1lc3NhZ2UgYWN0aW9uKSwgbm8gbmVlZCB0byB1cGRhdGUgc2VsZWN0aW9uIGluZm8uXG4gICAgICAgKi9cbiAgICAgIGlmIChpc1NlbGVjdGlvblN0aWxsVGhlU2FtZSkge1xuICAgICAgICBjb25zdCBpZHNNYXRjaFF1ZXJ5UGFyYW1zTm90SW5Mb2FkZWRSZWNvcmRzOiBzdHJpbmdbXSA9IGlkc05vdEluTG9hZGVkUmVjb3Jkcy5maWx0ZXIoaWQgPT4gcmVzPy5yZWNvcmRzPy5zb21lKHIgPT4gcj8uZ2V0SWQoKSA9PT0gaWQpKVxuICAgICAgICB0aGlzLmNoYW5nZVNlbGVjdGVkUmVjb3JkSWRzT2ZEc0luZm8oeyAuLi5vcHRpb25zLCBpZHM6IGlkc0luTG9hZGVkUmVjb3Jkcy5jb25jYXQoaWRzTWF0Y2hRdWVyeVBhcmFtc05vdEluTG9hZGVkUmVjb3JkcykgfSlcbiAgICAgIH1cbiAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGNoZWNrIHdoZXRoZXIgc2VsZWN0ZWQgcmVjb3JkcyBpbiAke3RoaXMuaWR9LiBgLCBlcnIpXG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgY2hhbmdlU2VsZWN0ZWRSZWNvcmRJZHNPZkRzSW5mbyAob3B0aW9uczogUXVlcmlhYmxlU2VsZWN0T3B0aW9ucykge1xuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlU2VsZWN0aW9uQ2hhbmdlZCh0aGlzLmlkLCBvcHRpb25zKSlcbiAgICAvKipcbiAgICAgKiBJZiBpcyBtYWluIGRhdGEgc291cmNlLCB3aWxsIHVwZGF0ZSB2ZXJzaW9uIG9mIHNlbGVjdGlvbiB2aWV3LlxuICAgICAqIFRoaXMgY2FuIG1ha2Ugc3VyZSB3aWRnZXQvY29tcG9uZW50IGNhbiBnZXQgdGhlIG5ld2VzdCBzZWxlY3RlZCByZWNvcmRzIHZpYSBgc2VsZWN0aW9uVmlldy5nZXRTZWxlY3RlZFJlY29yZHMoKWAuXG4gICAgICpcbiAgICAgKiBXaWxsIGRvIGl0IG9ubHkgaWYgdGhlIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgdGhlIG1haW4gZGF0YSBzb3VyY2Ugc2luY2UgYHNlbGVjdGlvblZpZXcuZ2V0U2VsZWN0ZWRSZWNvcmRzKClgIHdpbGwgcmV0dXJuIHRoZSBpbnRlcnNlY3Rpb24gb2YgMS4gc2VsZWN0ZWQgcmVjb3JkIGlkcyBvZiBtYWluIGRhdGEgc291cmNlIGluZm8gYW5kIDIuIHJlY29yZHMgb2Ygc2VsZWN0aW9uIHZpZXcuXG4gICAgICogT25seSBtYWluIGRhdGEgc291cmNlIGluZm8gYW5kIHNlbGVjdGlvbiB2aWV3IHJlY29yZHMgY2FuIGFmZmVjdCB0aGUgcmVzdWx0LlxuICAgICAqL1xuICAgIGlmICh0aGlzLmdldE1haW5EYXRhU291cmNlKCkuaWQgPT09IHRoaXMuaWQpIHtcbiAgICAgIHRoaXMuZ2V0U2VsZWN0aW9uRGF0YVZpZXcoKT8uYWRkVmVyc2lvbigpXG4gICAgICAvKipcbiAgICAgICAqIENoZWNraW5nIHdoZXRoZXIgbmVlZCB0byB1c2Ugbm9fc2VsZWN0aW9uIHZpZXcgdXNlcyB0aGUgc2VsZWN0aW9uIGluZm8sIHNlZSBgdXNlTm9TZWxlY3Rpb25WaWV3YC5cbiAgICAgICAqIEFmdGVyIHRoZSBuZXdlc3Qgc2VsZWN0aW9uIGluZm8gaXMgc2V0LCBuZWVkIHRvIGRvIHRoZSBjaGVjayBhZ2Fpbi5cbiAgICAgICAqIElmIG5lZWQgdG8gdXNlIG5vX3NlbGVjdGlvbiB2aWV3IG5vdywgdXBkYXRlIHNvdXJjZSB2ZXJzaW9uIG9mIHNlbGVjdGlvbiB2aWV3IHRvIGxldCB3aWRnZXRzIHRvIHJlZnJlc2guXG4gICAgICAgKi9cbiAgICAgIGlmICh0aGlzLnVzZU5vU2VsZWN0aW9uVmlldyh0aGlzLmdldFNlbGVjdGlvbkRhdGFWaWV3KCkpKSB7XG4gICAgICAgIHRoaXMuZ2V0U2VsZWN0aW9uRGF0YVZpZXcoKS5hZGRTb3VyY2VWZXJzaW9uKClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHF1ZXJ5UmVjb3Jkc0J5SWRXaXRoQ3VycmVudFF1ZXJ5UGFyYW1zIChpZHM6IHN0cmluZ1tdLCBkYXRhU291cmNlPzogUXVlcmlhYmxlRGF0YVNvdXJjZSwgcXVlcnlQYXJhbXM/OiBRdWVyeVBhcmFtcyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICBjb25zdCBvYmplY3RJZHMgPSBpZHMubWFwKGlkID0+ICtpZCkuZmlsdGVyKGlkID0+ICFpc05hTihpZCkpXG4gICAgY29uc3QgY2hlY2tSZWNvcmRzUXVlcnlQYXJhbXMgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXMocXVlcnlQYXJhbXMsIHsgb2JqZWN0SWRzIH0gYXMgUXVlcnlQYXJhbXMpXG5cbiAgICAvLyBJbiBxdWVyeSBtZXRob2QsIHdpbGwgbWVyZ2UgY3VycmVudCBxdWVyeSBwYXJhbXMgYW5kIGBjaGVja1JlY29yZHNRdWVyeVBhcmFtc2AuXG4gICAgcmV0dXJuIGRhdGFTb3VyY2UgPyBkYXRhU291cmNlLnF1ZXJ5KGNoZWNrUmVjb3Jkc1F1ZXJ5UGFyYW1zKSA6IHRoaXMucXVlcnkoY2hlY2tSZWNvcmRzUXVlcnlQYXJhbXMpXG4gIH1cblxuICBwcm90ZWN0ZWQgZGVsZXRlT25lTG9hZGVkUmVjb3JkQnlJZCAoZHM6IFF1ZXJpYWJsZURhdGFTb3VyY2UsIGlkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBwYWdlcyA9IGRzLmdldFBhZ2VzRGF0YSgpXG4gICAgY29uc3QgcGFnZUlkID0gT2JqZWN0LmtleXMocGFnZXMpLmZpbmQocElkID0+IHBhZ2VzW3BJZF0/LnNvbWUociA9PiByPy5nZXRJZCgpID09PSBpZCkpXG4gICAgY29uc3QgaW5kZXggPSBwYWdlc1twYWdlSWRdPy5maW5kSW5kZXgociA9PiByPy5nZXRJZCgpID09PSBpZClcbiAgICBpZiAodHlwZW9mIGluZGV4ID09PSAnbnVtYmVyJyAmJiBpbmRleCA+IC0xKSB7XG4gICAgICBwYWdlc1twYWdlSWRdLnNwbGljZShpbmRleCwgMSlcbiAgICAgIGRzLmFkZFZlcnNpb24oKVxuICAgIH1cbiAgfVxuXG4gIHNldE9uY2VTZXRTb3VyY2VSZWNvcmRzIChmdW5jOiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5vbmNlU2V0U291cmNlUmVjb3JkcyA9IGZ1bmNcbiAgfVxuXG4gIGdldEFsbFVzZWRGaWVsZHMgKG9wdGlvbnM6IFF1ZXJpYWJsZVVzZWRGaWVsZHNPcHRpb25zKTogc3RyaW5nW10gfCAnKicge1xuICAgIHJldHVybiBzdXBlci5nZXRBbGxVc2VkRmllbGRzKG9wdGlvbnMpXG4gIH1cblxuICBhYnN0cmFjdCBnZXRDb25maWdRdWVyeVBhcmFtcyAoKTogUXVlcnlQYXJhbXNcbiAgYWJzdHJhY3QgZ2V0UmVtb3RlUXVlcnlQYXJhbXMgKCk6IFF1ZXJ5UGFyYW1zXG4gIGFic3RyYWN0IG1lcmdlUXVlcnlQYXJhbXMgKC4uLnF1ZXJpZXM6IFF1ZXJ5UGFyYW1zW10pOiBRdWVyeVBhcmFtc1xuICBhYnN0cmFjdCBhbGxvd1RvRXhwb3J0RGF0YSAoKTogUHJvbWlzZTxib29sZWFuPlxuICAvKipcbiAgICogQXBwbHkgdXNlZCBmaWVsZHMgdG8gcXVlcnkgcGFyYW1zIHRvIG9ubHkgbG9hZCB0aGUgZmllbGRzIHdoaWNoIGFyZSB1c2VkIGJ5IHdpZGdldHMvY29tcG9uZW50cy5cbiAgICovXG4gIGFic3RyYWN0IGFwcGx5VXNlZEZpZWxkcyAocXVlcnk6IFF1ZXJ5UGFyYW1zLCB1c2VkRmllbGRzOiBzdHJpbmdbXSB8ICcqJyk6IFF1ZXJ5UGFyYW1zXG5cbiAgLyoqXG4gICAqIE9yaWdpbiBxdWVyeSBpcyB0aGUgcXVlcnkgcGFyYW1zIHdoaWNoIGlzIHBhc3NlZCB0byBgcXVlcnlgIC8gYGxvYWRgIG1ldGhvZC5cbiAgICogUmVhbCBxdWVyeSBpcyB0aGUgcmVzdWx0IG9mIG1lcmdpbmcgb3JpZ2luIHF1ZXJ5IGFuZCBvdGhlciBjb25maWd1cmVkIHF1ZXJpZXMuXG4gICAqIEluIHRoZSBtZXJnaW5nIHByb2Nlc3MsIHNvbWUgcXVlcnkgcGFyYW1zIG1heSBiZSByZW1vdmVkIGR1ZSB0byB0aGUgc2VydmljZSBjYXBhYmlsaXR5LlxuICAgKlxuICAgKiBVc2UgcmVhbCBxdWVyeSB0byBzZW5kIHRoZSBxdWVyeSByZXF1ZXN0LCB1c2Ugb3JpZ2luIHF1ZXJ5IHRvIGdldCB0aGUgcmVtb3ZlZCBxdWVyeSBwYXJhbXMgYW5kIGVuaGFuY2UgdGhlIHF1ZXJ5IHJlc3VsdC5cbiAgICovXG4gIHByb3RlY3RlZCBhYnN0cmFjdCBkb1F1ZXJ5IChyZWFsUXVlcnk6IElNUXVlcnlQYXJhbXMsIG9yaWdpblF1ZXJ5OiBJTVF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD5cbiAgcHJvdGVjdGVkIGFic3RyYWN0IGRvUXVlcnlDb3VudCAocmVhbFF1ZXJ5OiBJTVF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD5cbiAgcHJvdGVjdGVkIGFic3RyYWN0IGRvUXVlcnlJZHMgKHJlYWxRdWVyeTogSU1RdWVyeVBhcmFtcyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+XG4gIHByb3RlY3RlZCBhYnN0cmFjdCBkb1F1ZXJ5QnlJZCAoaWQ6IHN0cmluZyk6IFByb21pc2U8RGF0YVJlY29yZD5cbn1cbiIsImltcG9ydCB7IGRhdGFTb3VyY2VVdGlscyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IEFic3RyYWN0RGF0YVNvdXJjZSB9IGZyb20gJy4vYWJzdHJhY3QtZGF0YS1zb3VyY2UnXG5pbXBvcnQgeyB0eXBlIERhdGFTb3VyY2UsIERhdGFTb3VyY2VFcnJvciB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFNldERhdGFTb3VyY2UgZXh0ZW5kcyBBYnN0cmFjdERhdGFTb3VyY2UgaW1wbGVtZW50cyBEYXRhU291cmNlIHtcbiAgaXNEYXRhU291cmNlU2V0OiBib29sZWFuID0gdHJ1ZVxuICBwcm90ZWN0ZWQgY2hpbGREYXRhU291cmNlc0NyZWF0ZWQ6IGJvb2xlYW4gPSBmYWxzZVxuICBwcm90ZWN0ZWQgY2hpbGREYXRhU291cmNlUHJvbWlzZXM6IHsgW2NoaWxkRHNJZDogc3RyaW5nXTogUHJvbWlzZTxEYXRhU291cmNlPiB9ID0ge31cblxuICAvKipcbiAgICogQ3JlYXRlIGEgY2hpbGQgZGF0YSBzb3VyY2UgYnkgaXRzIElELlxuICAgKiBAcGFyYW0gY2hpbGREc0lkIHRoZSBkYXRhIHNvdXJjZSBpZCwgdXNlZCBpbiBkYXRhIHNvdXJjZSBjb25zdHJ1Y3RvciBvcHRpb25zLlxuICAgKiBAcGFyYW0gamltdUNoaWxkSWQgdGhlIGppbXUgY2hpbGQgaWQsIHVzZWQgaW4gZGF0YSBzb3VyY2UgY29uc3RydWN0b3Igb3B0aW9ucy5cbiAgICogQHBhcmFtIGNoaWxkSWQgdGhlIHNob3J0IElEIGZvciBjaGlsZCBkYXRhIHNvdXJjZSwgZ2VuZXJhdGVkIGJ5IGltcGxlbWVudCBjbGFzc2VzLCBzZWUgYGdldENoaWxkSWRzYCBtZXRob2QuXG4gICAqL1xuICBwcm90ZWN0ZWQgYWJzdHJhY3QgY3JlYXRlQ2hpbGREYXRhU291cmNlQnlJZCAoY2hpbGREc0lkOiBzdHJpbmcsIGppbXVDaGlsZElkOiBzdHJpbmcsIGNoaWxkSWQ6IHN0cmluZyk6IFByb21pc2U8RGF0YVNvdXJjZT5cbiAgLyoqXG4gICAqIEdldCBhbGwgY2hpbGQgZGF0YSBzb3VyY2VzJyBjaGlsZCBpZC5cbiAgICogVGhlIGNoaWxkIGlkIGlzIGdlbmVyYXRlZCBmcm9tIG9yaWdpbmFsIGRhdGEgKEFHT0wvcG9ydGFsIGl0ZW0gb3IgYSByZW1vdGUgZGF0YWJhc2UpLlxuICAgKiBUaGUgY2hpbGQgaWQgY2FuIGJlIHRoZSBKUyBBUEkgbGF5ZXIgSUQgb3IgbGF5ZXIgc2VydmljZSBJRCwgd2l0aG91dCBzcGFjZXMuXG4gICAqL1xuICBwcm90ZWN0ZWQgYWJzdHJhY3QgZ2V0Q2hpbGRJZHMgKCk6IHN0cmluZ1tdXG5cbiAgcmVhZHkgKCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxuICB9XG5cbiAgY2hpbGREYXRhU291cmNlc1JlYWR5ICgpOiBQcm9taXNlPERhdGFTb3VyY2VbXT4ge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZXNSZWN1cnNpdmVseSgpLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgdGhpcy5jaGlsZERhdGFTb3VyY2VzQ3JlYXRlZCA9IHRydWVcbiAgICB9KVxuICB9XG5cbiAgYXJlQ2hpbGREYXRhU291cmNlc0NyZWF0ZWQgKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmNoaWxkRGF0YVNvdXJjZXNDcmVhdGVkXG4gIH1cblxuICAvLyBDcmVhdGUgY2hpbGQgZGF0YSBzb3VyY2VzIGFuZCB3YWl0IGZvciBhbGwgZGVzY2VuZGFudCBkYXRhIHNvdXJjZXMgY3JlYXRlZC5cbiAgY3JlYXRlQ2hpbGREYXRhU291cmNlc1JlY3Vyc2l2ZWx5ICgpOiBQcm9taXNlPERhdGFTb3VyY2VbXT4ge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZXMoKS50aGVuKGNoaWxkRHNzID0+IFByb21pc2UuYWxsU2V0dGxlZChjaGlsZERzcy5tYXAoY2hpbGREcyA9PiBjaGlsZERzLmlzRGF0YVNvdXJjZVNldCA/IGNoaWxkRHMuY2hpbGREYXRhU291cmNlc1JlYWR5KCkudGhlbigoKSA9PiBjaGlsZERzKSA6IGNoaWxkRHMpKS50aGVuKGNoaWxkRHNzUmVzID0+IGNoaWxkRHNzUmVzLmZpbHRlcihjID0+IGMuc3RhdHVzID09PSAnZnVsZmlsbGVkJykubWFwKGMgPT4gKGMgYXMgUHJvbWlzZUZ1bGZpbGxlZFJlc3VsdDxEYXRhU291cmNlPikudmFsdWUpKSlcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUNoaWxkRGF0YVNvdXJjZXMgKCk6IFByb21pc2U8RGF0YVNvdXJjZVtdPiB7XG4gICAgY29uc3QgY2hpbGREc0lkcyA9IHRoaXMuZ2V0Q2hpbGREYXRhU291cmNlSWRzKClcblxuICAgIGNoaWxkRHNJZHMuZm9yRWFjaChjaGlsZERzSWQgPT4ge1xuICAgICAgaWYgKCF0aGlzLmNoaWxkRGF0YVNvdXJjZVByb21pc2VzW2NoaWxkRHNJZF0pIHtcbiAgICAgICAgdGhpcy5jaGlsZERhdGFTb3VyY2VQcm9taXNlc1tjaGlsZERzSWRdID0gdGhpcy5jcmVhdGVEYXRhU291cmNlQnlJZChjaGlsZERzSWQpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBQcm9taXNlLmFsbFNldHRsZWQoT2JqZWN0LnZhbHVlcyh0aGlzLmNoaWxkRGF0YVNvdXJjZVByb21pc2VzKSkudGhlbihjaGlsZERzc1JlcyA9PiBjaGlsZERzc1Jlcy5maWx0ZXIoYyA9PiBjLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcpLm1hcChjID0+IChjIGFzIFByb21pc2VGdWxmaWxsZWRSZXN1bHQ8RGF0YVNvdXJjZT4pLnZhbHVlKSlcbiAgfVxuXG4gIC8vIENyZWF0ZSBhIGNoaWxkIG9yIGEgZGVzY2VuZGFudCBkYXRhIHNvdXJjZSBieSBpZC5cbiAgYXN5bmMgY3JlYXRlRGF0YVNvdXJjZUJ5SWQgKGRhdGFTb3VyY2VJZDogc3RyaW5nKTogUHJvbWlzZTxEYXRhU291cmNlPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG5lZWRlZENoaWxkRHNJZCA9IHRoaXMuZmluZENoaWxkRGF0YVNvdXJjZUlkQnlEZXNjZW5kYW50RGF0YVNvdXJjZUlkKGRhdGFTb3VyY2VJZClcbiAgICAgIGlmICghbmVlZGVkQ2hpbGREc0lkKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRGF0YVNvdXJjZUVycm9yKGRhdGFTb3VyY2VJZCwgJ0NhbiBub3QgZmluZCBkYXRhIHNvdXJjZS4nKSlcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLmNoaWxkRGF0YVNvdXJjZVByb21pc2VzW25lZWRlZENoaWxkRHNJZF0pIHtcbiAgICAgICAgY29uc3QgY2hpbGRJZHMgPSB0aGlzLmdldENoaWxkSWRzKClcbiAgICAgICAgY29uc3QgY2hpbGRJZCA9IGNoaWxkSWRzLmZpbmQoY0lkID0+IHRoaXMuZ2V0SmltdUNoaWxkSWQoY0lkKS5zb21lKGppbXVDSWQgPT4gdGhpcy5nZXRDaGlsZERhdGFTb3VyY2VJZChqaW11Q0lkKSA9PT0gbmVlZGVkQ2hpbGREc0lkKSlcbiAgICAgICAgY29uc3QgamltdUNoaWxkSWQgPSB0aGlzLmdldEppbXVDaGlsZElkKGNoaWxkSWQpLmZpbmQoamltdUNJZCA9PiB0aGlzLmdldENoaWxkRGF0YVNvdXJjZUlkKGppbXVDSWQpID09PSBuZWVkZWRDaGlsZERzSWQpXG4gICAgICAgIHRoaXMuY2hpbGREYXRhU291cmNlUHJvbWlzZXNbbmVlZGVkQ2hpbGREc0lkXSA9IHRoaXMuY3JlYXRlQ2hpbGREYXRhU291cmNlQnlJZChuZWVkZWRDaGlsZERzSWQsIGppbXVDaGlsZElkLCBjaGlsZElkKVxuICAgICAgfVxuXG4gICAgICBjb25zdCBjaGlsZERzID0gYXdhaXQgdGhpcy5jaGlsZERhdGFTb3VyY2VQcm9taXNlc1tuZWVkZWRDaGlsZERzSWRdXG4gICAgICBpZiAoY2hpbGREcy5pZCA9PT0gZGF0YVNvdXJjZUlkKSB7XG4gICAgICAgIHJldHVybiBjaGlsZERzXG4gICAgICB9IGVsc2UgaWYgKGNoaWxkRHMuaXNEYXRhU291cmNlU2V0KSB7XG4gICAgICAgIHJldHVybiBjaGlsZERzLmNyZWF0ZURhdGFTb3VyY2VCeUlkKGRhdGFTb3VyY2VJZClcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRGF0YVNvdXJjZUVycm9yKGRhdGFTb3VyY2VJZCwgJ0NhbiBub3QgZmluZCBkYXRhIHNvdXJjZS4nKSlcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRGF0YVNvdXJjZUVycm9yKGRhdGFTb3VyY2VJZCwgJ0ZhaWxlZCB0byBjcmVhdGUgdGhlIGRhdGEgc291cmNlLicpKVxuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBmaW5kQ2hpbGREYXRhU291cmNlSWRCeURlc2NlbmRhbnREYXRhU291cmNlSWQgKGRhdGFTb3VyY2VJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBjaGlsZERzSWRzID0gdGhpcy5nZXRDaGlsZERhdGFTb3VyY2VJZHMoKVxuICAgIC8qKlxuICAgICAqIFRoZSBwcm9jZXNzIGlzIHRvIGZpbmQgYSBjaGlsZCBkYXRhIHNvdXJjZSBJRCB3aG9zZSBzcGxpdHRlZCBJRCBhcnJheSAoYnkgJy0nKSBoYXMgdGhlIHNhbWUgZmlyc3QgTiBlbGVtZW50cyB3aXRoIHRoZSBwYXNzZWQgaW4gZGF0YSBzb3VyY2UgSUQuXG4gICAgICogQ2FuIG5vdCB1c2Ugc3RyaW5nJ3Mgc3RhcnRzV2l0aCBoZXJlLCBzaW5jZSB3ZSBuZWVkIHRvIG1hdGNoIGVhY2ggZWxlbWVudCBvZiB0aGUgSUQgYXJyYXksIG5vdCBwYXJ0IG9mIHRoZSBlbGVtZW50LlxuICAgICAqIEZvciBleGFtcGxlLFxuICAgICAqIDEuIFRoZSBjaGlsZCBkYXRhIHNvdXJjZSBJRHMgYXJlIGRzMS0xIGFuZCBkczEtMTAsIHRoZSBkZXNjZW5kYW50IGRhdGEgc291cmNlIElEIGlzIGRzMS0xMC0xLCBzaG91bGQgcmV0dXJuIGRzMS0xMC5cbiAgICAgKiAyLiBUaGUgY2hpbGQgZGF0YSBzb3VyY2UgSURzIGFyZSBkczEtMSBhbmQgZHMxLTEwLCB0aGUgZGVzY2VuZGFudCBkYXRhIHNvdXJjZSBJRCBpcyBkczEtMTAsIHNob3VsZCByZXR1cm4gZHMxLTEwLlxuICAgICAqIDMuIFRoZSBjaGlsZCBkYXRhIHNvdXJjZSBJRHMgYXJlIGRzMS0xIGFuZCBkczEtMTAsIHRoZSBkZXNjZW5kYW50IGRhdGEgc291cmNlIElEIGlzIGRzMS0xMS0xLCBzaG91bGQgcmV0dXJuIG51bGwuXG4gICAgICovXG4gICAgY29uc3QgZGVzY2VuZGFudERzSWRBcnIgPSBkYXRhU291cmNlSWQ/LnNwbGl0KCctJylcbiAgICBjb25zdCBuZWVkZWRDaGlsZERzSWQgPSBjaGlsZERzSWRzLmZpbmQoY2hpbGREc0lkID0+IHtcbiAgICAgIGNvbnN0IGNoaWxkRHNJZEFyciA9IGNoaWxkRHNJZD8uc3BsaXQoJy0nKVxuICAgICAgcmV0dXJuIGNoaWxkRHNJZEFycj8uZXZlcnkoKGQsIGkpID0+IGRlc2NlbmRhbnREc0lkQXJyW2ldID09PSBkKVxuICAgIH0sIG51bGwpXG4gICAgcmV0dXJuIG5lZWRlZENoaWxkRHNJZFxuICB9XG5cbiAgZ2V0Q2hpbGREYXRhU291cmNlSWRzICgpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgY2hpbGRJZHMgPSB0aGlzLmdldENoaWxkSWRzKClcbiAgICByZXR1cm4gY2hpbGRJZHMucmVkdWNlKChqaW11Q2hpbGRJZHM6IHN0cmluZ1tdLCBjaGlsZElkKSA9PiBqaW11Q2hpbGRJZHMuY29uY2F0KHRoaXMuZ2V0SmltdUNoaWxkSWQoY2hpbGRJZCkpLCBbXSkubWFwKGppbXVDaGlsZElkID0+IHRoaXMuZ2V0Q2hpbGREYXRhU291cmNlSWQoamltdUNoaWxkSWQpKVxuICB9XG5cbiAgZGVzdHJveSAoKSB7XG4gICAgaWYgKCF0aGlzLmFyZUNoaWxkRGF0YVNvdXJjZXNDcmVhdGVkKCkpIHtcbiAgICAgIHRoaXMuY2hpbGREYXRhU291cmNlc1JlYWR5KCkudGhlbihjaGlsZERzcyA9PiB7XG4gICAgICAgIGNoaWxkRHNzLmZvckVhY2goZHMgPT4ge1xuICAgICAgICAgIGlmIChkcykge1xuICAgICAgICAgICAgdGhpcy5kYXRhU291cmNlTWFuYWdlci5kZXN0cm95RGF0YVNvdXJjZShkcy5pZClcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdldENoaWxkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKGRzID0+IHtcbiAgICAgICAgaWYgKGRzKSB7XG4gICAgICAgICAgdGhpcy5kYXRhU291cmNlTWFuYWdlci5kZXN0cm95RGF0YVNvdXJjZShkcy5pZClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBnZXRDaGlsZERhdGFTb3VyY2VJZCAoamltdUNoaWxkSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5nZXRDaGlsZERhdGFTb3VyY2VJZCh0aGlzLmlkLCBqaW11Q2hpbGRJZClcbiAgfVxuXG4gIGdldENoaWxkRGF0YVNvdXJjZXMgKCk6IERhdGFTb3VyY2VbXSB7XG4gICAgY29uc3QgY2hpbGREc3MgPSBPYmplY3Qua2V5cyh0aGlzLmRhdGFTb3VyY2VNYW5hZ2VyLmdldERhdGFTb3VyY2VzKCkpXG4gICAgICAuZmlsdGVyKGRzSWQgPT4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhU291cmNlKGRzSWQpLnBhcmVudERhdGFTb3VyY2UgPT09IHRoaXMpXG4gICAgICAubWFwKGRzSWQgPT4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhU291cmNlKGRzSWQpKVxuICAgIHJldHVybiBjaGlsZERzcy5zb3J0KChkczEsIGRzMikgPT4gZHMxLm9yZGVyIC0gZHMyLm9yZGVyKVxuICB9XG5cbiAgZ2V0QWxsQ2hpbGREYXRhU291cmNlcyAoKTogRGF0YVNvdXJjZVtdIHtcbiAgICBjb25zdCB2aXNpdFRyZWUgPSAoZHM6IERhdGFTb3VyY2UsIHJlc3VsdHM6IERhdGFTb3VyY2VbXSkgPT4ge1xuICAgICAgY29uc3QgY2hpbGREc3MgPSBkcy5pc0RhdGFTb3VyY2VTZXQgJiYgZHMuZ2V0Q2hpbGREYXRhU291cmNlcygpXG4gICAgICBpZiAoY2hpbGREc3MpIHtcbiAgICAgICAgY2hpbGREc3MuZm9yRWFjaChjaGlsZERzID0+IHtcbiAgICAgICAgICByZXN1bHRzLnB1c2goY2hpbGREcylcbiAgICAgICAgICBpZiAoY2hpbGREcy5pc0RhdGFTb3VyY2VTZXQpIHtcbiAgICAgICAgICAgIHZpc2l0VHJlZShjaGlsZERzLCByZXN1bHRzKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBhbGxEc3MgPSBbXVxuICAgIHZpc2l0VHJlZSh0aGlzLCBhbGxEc3MpXG4gICAgcmV0dXJuIGFsbERzc1xuICB9XG5cbiAgZ2V0Q2hpbGREYXRhU291cmNlIChqaW11Q2hpbGRJZDogc3RyaW5nKTogRGF0YVNvdXJjZSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVNvdXJjZSh0aGlzLmdldENoaWxkRGF0YVNvdXJjZUlkKGppbXVDaGlsZElkKSlcbiAgfVxuXG4gIGdldEppbXVDaGlsZElkIChjaGlsZElkOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcnNjaGVtYSA9IHRoaXMuZ2V0UmV2ZXJzZWRDb25maWdTY2hlbWEoKVxuICAgIGlmIChyc2NoZW1hICYmIHJzY2hlbWEuY2hpbGRTY2hlbWFzICYmIHJzY2hlbWEuY2hpbGRTY2hlbWFzW2NoaWxkSWRdKSB7XG4gICAgICByZXR1cm4gKHJzY2hlbWEuY2hpbGRTY2hlbWFzW2NoaWxkSWRdKS5tYXAoc2NoZW1hID0+IHNjaGVtYS5qaW11Q2hpbGRJZCkuYXNNdXRhYmxlKClcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtjaGlsZElkXVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJR2VvbWV0cnkgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcydcbmltcG9ydCB7IHR5cGUgSU1EYXRhU291cmNlU2NoZW1hLCB0eXBlIElNUmV2ZXJzZWREYXRhU291cmNlU2NoZW1hLCB0eXBlIEludGxTaGFwZSwgSmltdUZpZWxkVHlwZSwgdHlwZSBFc3JpRGF0ZUZvcm1hdHMsIGxvZGFzaCwgZGF0YVNvdXJjZVV0aWxzIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBEYXRhU291cmNlLCB0eXBlIERhdGFSZWNvcmRTZXQsIHR5cGUgRGF0YVJlY29yZCB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5cbi8qKlxuICogSW5jbHVkZSB0aGUgY29tbW9uIGltcGxlbWVudGF0aW9ucyBmb3IgZGF0YSByZWNvcmQuXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdERhdGFSZWNvcmQgaW1wbGVtZW50cyBEYXRhUmVjb3JkIHtcbiAgcHJvdGVjdGVkIF9kYXRhU291cmNlOiBEYXRhU291cmNlXG5cbiAgYWJzdHJhY3QgZ2V0RGF0YSAoKTogYW55XG4gIGFic3RyYWN0IHNldERhdGEgKGRhdGEpOiB2b2lkXG4gIC8qKiBAaWdub3JlICovXG4gIGFic3RyYWN0IGdldERhdGFCZWZvcmVNYXBwaW5nICgpOiBhbnlcbiAgYWJzdHJhY3QgdG9Kc29uICgpOiBhbnlcblxuICBhYnN0cmFjdCBnZXRJZCAoKTogc3RyaW5nXG4gIGFic3RyYWN0IHNldElkIChpZDogc3RyaW5nKTogdm9pZFxuXG4gIGFic3RyYWN0IGdldEdlb21ldHJ5ICgpOiBJR2VvbWV0cnlcbiAgYWJzdHJhY3QgZ2V0UmF3R2VvbWV0cnkgKCk6IGFueVxuICBhYnN0cmFjdCBzZXRHZW9tZXRyeSAoZ2VvOiBJR2VvbWV0cnkpOiB2b2lkXG5cbiAgY2xvbmUgKGRlZXA/OiBib29sZWFuKTogRGF0YVJlY29yZCB7XG4gICAgY29uc3Qgc2hhbGxvd0Nsb25lID0gbG9kYXNoLmNsb25lKHRoaXMpXG4gICAgaWYgKGRlZXApIHtcbiAgICAgIHNoYWxsb3dDbG9uZS5zZXREYXRhKGxvZGFzaC5jbG9uZURlZXAodGhpcy5nZXREYXRhKCkpKVxuICAgICAgcmV0dXJuIHNoYWxsb3dDbG9uZVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc2hhbGxvd0Nsb25lXG4gICAgfVxuICB9XG5cbiAgZ2V0RmllbGRWYWx1ZSAoamltdUZpZWxkTmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RGF0YSgpW2ppbXVGaWVsZE5hbWVdXG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBnZXREYXRlRmllbGRWYWx1ZSAoamltdUZpZWxkTmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKVxuICB9XG5cbiAgZ2V0Rm9ybWF0dGVkRmllbGRWYWx1ZSAoamltdUZpZWxkTmFtZTogc3RyaW5nLCBpbnRsOiBJbnRsU2hhcGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IGZpZWxkID0gdGhpcy5kYXRhU291cmNlLmdldFNjaGVtYSgpLmZpZWxkc1tqaW11RmllbGROYW1lXVxuICAgIGlmIChmaWVsZCkge1xuICAgICAgaWYgKGZpZWxkLmZvcm1hdCkge1xuICAgICAgICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICAgICAgICBjYXNlIEppbXVGaWVsZFR5cGUuRGF0ZTpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdERhdGVGaWVsZCh0aGlzLmdldERhdGVGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpLCBmaWVsZC5mb3JtYXQuZGF0ZUZvcm1hdCwgaW50bClcbiAgICAgICAgICBjYXNlIEppbXVGaWVsZFR5cGUuTnVtYmVyOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0TnVtYmVyRmllbGQodGhpcy5nZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpLCBmaWVsZC5mb3JtYXQucGxhY2VzLCBmaWVsZC5mb3JtYXQuZGlnaXRTZXBhcmF0b3IsIGludGwpXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSlcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3dpdGNoIChmaWVsZC50eXBlKSB7XG4gICAgICAgICAgY2FzZSBKaW11RmllbGRUeXBlLkRhdGU6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpICE9PSBudWxsICYmIHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgID8gaW50bC5mb3JtYXREYXRlKHRoaXMuZ2V0RGF0ZUZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSkpXG4gICAgICAgICAgICAgIDogbnVsbFxuICAgICAgICAgIGNhc2UgSmltdUZpZWxkVHlwZS5OdW1iZXI6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpICE9PSBudWxsICYmIHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgID8gaW50bC5mb3JtYXROdW1iZXIodGhpcy5nZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpKVxuICAgICAgICAgICAgICA6IG51bGxcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSlcbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBjb252ZXJ0QmVmb3JlTWFwcGluZ0RhdGFUb0RhdGEgKGRhdGFCZWZvcmVNYXBwaW5nKSB7XG4gICAgY29uc3QgcmV2ZXJzZWREYXRhID0ge31cbiAgICBjb25zdCByZXZlcnNlZFNjaGVtYTogSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEgPSB0aGlzLmRhdGFTb3VyY2UuZ2V0UmV2ZXJzZWRDb25maWdTY2hlbWEoKVxuICAgIE9iamVjdC5rZXlzKGRhdGFCZWZvcmVNYXBwaW5nKS5mb3JFYWNoKGZpZWxkTmFtZSA9PiB7XG4gICAgICBjb25zdCBmaWVsZHMgPSByZXZlcnNlZFNjaGVtYSAmJiByZXZlcnNlZFNjaGVtYS5maWVsZHMgJiYgcmV2ZXJzZWRTY2hlbWEuZmllbGRzW2ZpZWxkTmFtZV1cbiAgICAgIGlmIChmaWVsZHMpIHtcbiAgICAgICAgZmllbGRzLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgcmV2ZXJzZWREYXRhW2YuamltdU5hbWVdID0gZGF0YUJlZm9yZU1hcHBpbmdbZmllbGROYW1lXVxuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV2ZXJzZWREYXRhW2ZpZWxkTmFtZV0gPSBkYXRhQmVmb3JlTWFwcGluZ1tmaWVsZE5hbWVdXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gcmV2ZXJzZWREYXRhXG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBjb252ZXJ0RGF0YVRvRGF0YUJlZm9yZU1hcHBpbmcgKGRhdGEpIHtcbiAgICBjb25zdCBkYXRhQmVmb3JlTWFwcGluZyA9IHt9XG4gICAgY29uc3Qgc2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEgPSB0aGlzLmRhdGFTb3VyY2UuZ2V0U2NoZW1hKClcbiAgICBPYmplY3Qua2V5cyhkYXRhKS5mb3JFYWNoKGppbXVGaWVsZE5hbWUgPT4ge1xuICAgICAgY29uc3QgZmllbGROYW1lID0gc2NoZW1hICYmIHNjaGVtYS5maWVsZHMgJiYgc2NoZW1hLmZpZWxkc1tqaW11RmllbGROYW1lXSA/IHNjaGVtYS5maWVsZHNbamltdUZpZWxkTmFtZV0ubmFtZSA6IGppbXVGaWVsZE5hbWVcbiAgICAgIGRhdGFCZWZvcmVNYXBwaW5nW2ZpZWxkTmFtZV0gPSBkYXRhW2ppbXVGaWVsZE5hbWVdXG4gICAgfSlcbiAgICByZXR1cm4gZGF0YUJlZm9yZU1hcHBpbmdcbiAgfVxuXG4gIGdldEZvcm1hdHRlZERhdGEgKGludGw6IEludGxTaGFwZSkge1xuICAgIGNvbnN0IHJldCA9IHt9XG4gICAgT2JqZWN0LmtleXModGhpcy5nZXREYXRhKCkpLmZvckVhY2goZmllbGROYW1lID0+IHtcbiAgICAgIHJldFtmaWVsZE5hbWVdID0gdGhpcy5nZXRGb3JtYXR0ZWRGaWVsZFZhbHVlKGZpZWxkTmFtZSwgaW50bClcbiAgICB9KVxuICAgIHJldHVybiByZXRcbiAgfVxuXG4gIGZvcm1hdERhdGVGaWVsZCAodmFsdWUsIGVzcmlEYXRlRm9ybWF0OiBFc3JpRGF0ZUZvcm1hdHMsIGludGw6IEludGxTaGFwZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5mb3JtYXREYXRlRmllbGQodmFsdWUsIGVzcmlEYXRlRm9ybWF0LCBpbnRsKVxuICB9XG5cbiAgZm9ybWF0TnVtYmVyRmllbGQgKHZhbHVlOiBudW1iZXIsIHBsYWNlczogbnVtYmVyLCBkaWdpdFNlcGFyYXRvcjogYm9vbGVhbiwgaW50bDogSW50bFNoYXBlKTogc3RyaW5nIHtcbiAgICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUqL1xuICAgIGNvbnN0IG51bSA9IG5ldyBOdW1iZXIodmFsdWUpXG4gICAgaWYgKGRpZ2l0U2VwYXJhdG9yKSB7XG4gICAgICByZXR1cm4gaW50bC5mb3JtYXROdW1iZXIodmFsdWUsIHsgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiBwbGFjZXMsIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogcGxhY2VzIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudW0udG9GaXhlZChwbGFjZXMpXG4gICAgfVxuICB9XG5cbiAgc2V0IGRhdGFTb3VyY2UgKGQ6IERhdGFTb3VyY2UpIHtcbiAgICB0aGlzLl9kYXRhU291cmNlID0gZFxuICB9XG5cbiAgZ2V0IGRhdGFTb3VyY2UgKCk6IERhdGFTb3VyY2Uge1xuICAgIHJldHVybiB0aGlzLl9kYXRhU291cmNlXG4gIH1cbn1cblxuLyoqXG4gKiBAaWdub3JlXG4gKi9cbmV4cG9ydCBjbGFzcyBTaW1wbGVEYXRhUmVjb3JkSW1wbCBleHRlbmRzIEFic3RyYWN0RGF0YVJlY29yZCB7XG4gIHByaXZhdGUgZGF0YTogYW55XG5cbiAgLyoqXG4gICAqIGJlZm9yZU1hcHBpbmdEYXRhOiBpcyB0aGUgZGF0YSBmcm9tIHRoZSByZWFsIGRhdGEgc291cmNlLCBzdWNoIGFzIHF1ZXJ5IGZyb20gcmVtb3RlIHNlcnZpY2UvZGF0YWJhc2UuXG4gICAqIGRhdGEgaXMgdGhlIGRhdGEgdXNlZCBpbiBFeGIuXG4gICAqXG4gICAqIFRoZSBiZWZvcmVNYXBwaW5nRGF0YSB1c2VzIHRoaXMgc2NoZW1hOiB7ZmllbGROYW1lOiB2YWx1ZX0sIHdlJ2xsIHJldmVyc2UgaXQgdG8ge2ppbXVGaWVsZE5hbWU6IHZhbHVlfSwgd2hpY2ggaXMgY2FsbGVkIGRhdGEgYW5kIHdpbGwgYmUgdXNlZCBpbiBleGIuXG4gICAqXG4gICAqL1xuICBjb25zdHJ1Y3RvciAoZGF0YTogYW55LCBkYXRhU291cmNlOiBEYXRhU291cmNlLCBpc0JlZm9yZU1hcHBpbmdEYXRhID0gdHJ1ZSkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlXG5cbiAgICBpZiAoaXNCZWZvcmVNYXBwaW5nRGF0YSkge1xuICAgICAgdGhpcy5kYXRhID0gdGhpcy5jb252ZXJ0QmVmb3JlTWFwcGluZ0RhdGFUb0RhdGEoZGF0YSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kYXRhID0gZGF0YVxuICAgIH1cbiAgfVxuXG4gIGdldERhdGEgKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGFcbiAgfVxuXG4gIHNldERhdGEgKGRhdGEpIHtcbiAgICB0aGlzLmRhdGEgPSBkYXRhXG4gIH1cblxuICBnZXREYXRhQmVmb3JlTWFwcGluZyAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udmVydERhdGFUb0RhdGFCZWZvcmVNYXBwaW5nKHRoaXMuZGF0YSlcbiAgfVxuXG4gIHRvSnNvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVxuICB9XG5cbiAgZ2V0SWQgKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGEuaWRcbiAgfVxuXG4gIHNldElkICgpIHtcblxuICB9XG5cbiAgZ2V0R2VvbWV0cnkgKCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBnZXRSYXdHZW9tZXRyeSAoKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHNldEdlb21ldHJ5IChnZW86IElHZW9tZXRyeSkge1xuXG4gIH1cbn1cblxuLyoqXG4gKiBAaWdub3JlXG4gKi9cbmV4cG9ydCBjbGFzcyBTaW1wbGVEYXRhUmVjb3JkU2V0SW1wbCBpbXBsZW1lbnRzIERhdGFSZWNvcmRTZXQge1xuICByZWNvcmRzOiBEYXRhUmVjb3JkW11cbiAgZmllbGRzPzogc3RyaW5nW11cbiAgZGF0YVNvdXJjZTogRGF0YVNvdXJjZVxuICBuYW1lOiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAob3B0aW9uczogRGF0YVJlY29yZFNldCkge1xuICAgIE9iamVjdC5hc3NpZ24odGhpcywgb3B0aW9ucylcbiAgfVxufVxuIiwiZXhwb3J0ICogZnJvbSAnLi9hYnN0cmFjdC1kYXRhLXNvdXJjZSdcbmV4cG9ydCAqIGZyb20gJy4vYWJzdHJhY3QtbGF5ZXItZm9sZGVyLWRhdGEtc291cmNlJ1xuZXhwb3J0ICogZnJvbSAnLi9hYnN0cmFjdC1sb2FkYWJsZS1kYXRhLXNvdXJjZSdcbmV4cG9ydCAqIGZyb20gJy4vYWJzdHJhY3QtcXVlcmlhYmxlLWRhdGEtc291cmNlJ1xuZXhwb3J0ICogZnJvbSAnLi9hYnN0cmFjdC1zZXQtZGF0YS1zb3VyY2UnXG5leHBvcnQgKiBmcm9tICcuL2RhdGEtcmVjb3JkJ1xuZXhwb3J0ICogZnJvbSAnLi9pdGVtLW1peGluJ1xuZXhwb3J0ICogZnJvbSAnLi9qcy1hcGktbGF5ZXItbWl4aW4nXG4iLCJpbXBvcnQgeyB0eXBlIElJdGVtIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnXG5pbXBvcnQgeyBlc3JpLCBwb3J0YWxVcmxVdGlscywgcmVxdWVzdFV0aWxzIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBEYXRhU291cmNlLCB0eXBlIEl0ZW1NaXhpbiB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5cbnR5cGUgTm9uQWJzdHJhY3RDb25zdHJ1Y3RvcjxUID0gb2JqZWN0PiA9IG5ldyAoLi4uYXJnczogYW55W10pID0+IFRcbnR5cGUgQWJzdHJhY3RDb25zdHJ1Y3RvcjxUID0gb2JqZWN0PiA9IGFic3RyYWN0IG5ldyAoLi4uYXJnczogYW55W10pID0+IFRcbnR5cGUgQ29uc3RydWN0b3I8VCA9IG9iamVjdD4gPSBOb25BYnN0cmFjdENvbnN0cnVjdG9yPFQ+IHwgQWJzdHJhY3RDb25zdHJ1Y3RvcjxUPlxuXG5jb25zdCBmZXRjaEl0ZW1EYXRhUHJvbWlzZXM6IHsgW2NhY2hlSWQ6IHN0cmluZ106IFByb21pc2U8YW55PiB9ID0ge31cbmNvbnN0IGZldGNoSXRlbUluZm9Qcm9taXNlczogeyBbY2FjaGVJZDogc3RyaW5nXTogUHJvbWlzZTxJSXRlbT4gfSA9IHt9XG5cbmV4cG9ydCBjb25zdCBJdGVtTWl4aW5JbXBsID0gPFRCYXNlIGV4dGVuZHMgQ29uc3RydWN0b3I8RGF0YVNvdXJjZT4+KEJhc2U6IFRCYXNlKSA9PiB7XG4gIGNsYXNzIEl0ZW1NaXhpbkltcGwgZXh0ZW5kcyBCYXNlIGltcGxlbWVudHMgSXRlbU1peGluIHtcbiAgICBwcml2YXRlIF9pdGVtSWQ6IHN0cmluZ1xuICAgIHByaXZhdGUgX3BvcnRhbFVybDogc3RyaW5nXG4gICAgcHJpdmF0ZSBpdGVtRGF0YTogYW55XG4gICAgcHJpdmF0ZSBpdGVtSW5mbzogSUl0ZW1cblxuICAgIGdldCBpdGVtSWQgKCk6IHN0cmluZyB7XG4gICAgICByZXR1cm4gdGhpcy5faXRlbUlkXG4gICAgfVxuXG4gICAgc2V0IGl0ZW1JZCAoaXRlbUlkOiBzdHJpbmcpIHtcbiAgICAgIGlmICh0aGlzLl9pdGVtSWQgIT09IGl0ZW1JZCkge1xuICAgICAgICB0aGlzLl9pdGVtSWQgPSBpdGVtSWRcbiAgICAgICAgdGhpcy5jbGVhckRhdGEoKVxuICAgICAgfVxuICAgIH1cblxuICAgIGdldCBwb3J0YWxVcmwgKCk6IHN0cmluZyB7XG4gICAgICByZXR1cm4gdGhpcy5fcG9ydGFsVXJsXG4gICAgfVxuXG4gICAgc2V0IHBvcnRhbFVybCAocG9ydGFsVXJsOiBzdHJpbmcpIHtcbiAgICAgIGlmICh0aGlzLl9wb3J0YWxVcmwgIT09IHBvcnRhbFVybCkge1xuICAgICAgICB0aGlzLl9wb3J0YWxVcmwgPSBwb3J0YWxVcmxcbiAgICAgICAgdGhpcy5jbGVhckRhdGEoKVxuICAgICAgfVxuICAgIH1cblxuICAgIGdldEl0ZW1EYXRhICgpIHtcbiAgICAgIHJldHVybiB0aGlzLml0ZW1EYXRhXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHNldEl0ZW1EYXRhIChpdGVtRGF0YSkge1xuICAgICAgdGhpcy5pdGVtRGF0YSA9IGl0ZW1EYXRhXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xhc3NlcyB0aGF0IGV4dGVuZCB0aGlzIGNsYXNzIG1heSBnZXQgaXRlbSBpbmZvIGZyb20gb3RoZXIgc291cmNlcywgZS5nLiBKU0FQSSBsYXllciBvYmplY3QuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHNldEl0ZW1JbmZvIChpdGVtSW5mbykge1xuICAgICAgdGhpcy5pdGVtSW5mbyA9IGl0ZW1JbmZvXG4gICAgfVxuXG4gICAgZ2V0SXRlbUluZm8gKCk6IElJdGVtIHtcbiAgICAgIHJldHVybiB0aGlzLml0ZW1JbmZvXG4gICAgfVxuXG4gICAgZmV0Y2hJdGVtRGF0YSAoKTogUHJvbWlzZTxhbnk+IHtcbiAgICAgIGlmICghdGhpcy5wb3J0YWxVcmwgfHwgIXRoaXMuaXRlbUlkKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbClcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLml0ZW1EYXRhKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5pdGVtRGF0YSlcbiAgICAgIH1cbiAgICAgIGlmICghZmV0Y2hJdGVtRGF0YVByb21pc2VzW2dldENhY2hlSWQodGhpcy5wb3J0YWxVcmwsIHRoaXMuaXRlbUlkKV0pIHtcbiAgICAgICAgZmV0Y2hJdGVtRGF0YVByb21pc2VzW2dldENhY2hlSWQodGhpcy5wb3J0YWxVcmwsIHRoaXMuaXRlbUlkKV0gPSByZXF1ZXN0VXRpbHMucmVxdWVzdFdyYXBwZXIodGhpcy5wb3J0YWxVcmwsIChzZXNzaW9uKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGVzcmkucmVzdFBvcnRhbC5nZXRJdGVtRGF0YSh0aGlzLml0ZW1JZCwge1xuICAgICAgICAgICAgcG9ydGFsOiBwb3J0YWxVcmxVdGlscy5nZXRQb3J0YWxSZXN0VXJsKHRoaXMucG9ydGFsVXJsKSxcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0aW9uOiBzZXNzaW9uXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBmZXRjaEl0ZW1EYXRhUHJvbWlzZXNbZ2V0Q2FjaGVJZCh0aGlzLnBvcnRhbFVybCwgdGhpcy5pdGVtSWQpXS50aGVuKGl0ZW1EYXRhID0+IHtcbiAgICAgICAgdGhpcy5pdGVtRGF0YSA9IGl0ZW1EYXRhXG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1EYXRhXG4gICAgICB9KVxuICAgIH1cblxuICAgIGZldGNoSXRlbUluZm8gKCk6IFByb21pc2U8SUl0ZW0+IHtcbiAgICAgIGlmICghdGhpcy5wb3J0YWxVcmwgfHwgIXRoaXMuaXRlbUlkKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbClcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLml0ZW1JbmZvKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5pdGVtSW5mbylcbiAgICAgIH1cbiAgICAgIGlmICghZmV0Y2hJdGVtSW5mb1Byb21pc2VzW2dldENhY2hlSWQodGhpcy5wb3J0YWxVcmwsIHRoaXMuaXRlbUlkKV0pIHtcbiAgICAgICAgZmV0Y2hJdGVtSW5mb1Byb21pc2VzW2dldENhY2hlSWQodGhpcy5wb3J0YWxVcmwsIHRoaXMuaXRlbUlkKV0gPSByZXF1ZXN0VXRpbHMucmVxdWVzdFdyYXBwZXIodGhpcy5wb3J0YWxVcmwsIChzZXNzaW9uKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGVzcmkucmVzdFBvcnRhbC5nZXRJdGVtKHRoaXMuaXRlbUlkLCB7XG4gICAgICAgICAgICBwb3J0YWw6IHBvcnRhbFVybFV0aWxzLmdldFBvcnRhbFJlc3RVcmwodGhpcy5wb3J0YWxVcmwpLFxuICAgICAgICAgICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZldGNoSXRlbUluZm9Qcm9taXNlc1tnZXRDYWNoZUlkKHRoaXMucG9ydGFsVXJsLCB0aGlzLml0ZW1JZCldLnRoZW4oaXRlbUluZm8gPT4ge1xuICAgICAgICB0aGlzLml0ZW1JbmZvID0gaXRlbUluZm9cbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbUluZm9cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGVhckRhdGEgKCkge1xuICAgICAgdGhpcy5pdGVtRGF0YSA9IG51bGxcbiAgICAgIHRoaXMuaXRlbUluZm8gPSBudWxsXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIEl0ZW1NaXhpbkltcGxcbn1cblxuZnVuY3Rpb24gZ2V0Q2FjaGVJZCAocG9ydGFsVXJsOiBzdHJpbmcsIGl0ZW1JZDogc3RyaW5nKSB7XG4gIHJldHVybiBgJHtwb3J0YWxVcmx9LSR7aXRlbUlkfWBcbn1cbiIsImltcG9ydCB7IGxvYWRBcmNHSVNKU0FQSU1vZHVsZSwgZGF0YVNvdXJjZVV0aWxzLCBEYXRhU291cmNlTWFuYWdlciwgdHlwZSBJTURhdGFTb3VyY2VKc29uIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBEYXRhU291cmNlLCBEYXRhU291cmNlVHlwZXMsIHR5cGUgSlNBUElMYXllck1peGluLCB0eXBlIEFyY0dJU1N1YkxheWVyIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcblxudHlwZSBOb25BYnN0cmFjdENvbnN0cnVjdG9yPFQgPSBvYmplY3Q+ID0gbmV3ICguLi5hcmdzOiBhbnlbXSkgPT4gVFxudHlwZSBBYnN0cmFjdENvbnN0cnVjdG9yPFQgPSBvYmplY3Q+ID0gYWJzdHJhY3QgbmV3ICguLi5hcmdzOiBhbnlbXSkgPT4gVFxudHlwZSBDb25zdHJ1Y3RvcjxUID0gb2JqZWN0PiA9IE5vbkFic3RyYWN0Q29uc3RydWN0b3I8VD4gfCBBYnN0cmFjdENvbnN0cnVjdG9yPFQ+XG5cbmV4cG9ydCBjb25zdCBKU0FQSUxheWVyTWl4aW5JbXBsID0gPFRCYXNlIGV4dGVuZHMgQ29uc3RydWN0b3I8RGF0YVNvdXJjZT4+KEJhc2U6IFRCYXNlKSA9PiB7XG4gIGNsYXNzIEpTQVBJTGF5ZXJNaXhpbkltcGwgZXh0ZW5kcyBCYXNlIGltcGxlbWVudHMgSlNBUElMYXllck1peGluIHtcbiAgICBpZDogc3RyaW5nXG4gICAgdHlwZTogRGF0YVNvdXJjZVR5cGVzXG4gICAgZ2V0RGF0YVNvdXJjZUpzb246ICgpID0+IElNRGF0YVNvdXJjZUpzb25cbiAgICBsYXllcj86IF9fZXNyaS5MYXllciB8IEFyY0dJU1N1YkxheWVyXG4gICAgdXJsPzogc3RyaW5nXG4gICAgaXRlbUlkPzogc3RyaW5nXG4gICAgcG9ydGFsVXJsPzogc3RyaW5nXG5cbiAgICAvLyBjYWNoZWRMYXllciBpcyB0byBjYWNoZSBzb21lIHJlc291cmNlcyB3aGVuIGNyZWF0aW5nIGEgbmV3IEpTIEFQSSBsYXllci5cbiAgICBwcml2YXRlIF9jYWNoZWRMYXllcj86IF9fZXNyaS5MYXllclxuICAgIHByaXZhdGUgX2ppbXVMYXllcklkPzogc3RyaW5nXG5cbiAgICBnZXQgamltdUxheWVySWQgKCk6IHN0cmluZyB7XG4gICAgICBpZiAodGhpcy5sYXllciAmJiAhdGhpcy5famltdUxheWVySWQpIHtcbiAgICAgICAgdGhpcy5famltdUxheWVySWQgPSBkYXRhU291cmNlVXRpbHMuZ2V0SmltdUxheWVySWRCeUpTQVBJTGF5ZXIodGhpcy5sYXllcilcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl9qaW11TGF5ZXJJZFxuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUpTQVBJTGF5ZXJCeURhdGFTb3VyY2UgKCk6IFByb21pc2U8X19lc3JpLkxheWVyPiB7XG4gICAgICBsZXQgbGF5ZXI6IF9fZXNyaS5MYXllclxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgb3B0aW9uczogeyB1cmw/OiBzdHJpbmcsIHBvcnRhbEl0ZW0/OiBfX2VzcmkuUG9ydGFsSXRlbVByb3BlcnRpZXMsIHNvdXJjZUpTT04/OiBhbnksIHNvdXJjZT86IGFueSB9ID0gdGhpcy5nZXRMYXllckNvbnN0cnVjdG9yT3B0aW9ucygpXG4gICAgICAgIGlmIChOb25BcmNHSVNMYXllckNsYXNzW3RoaXMudHlwZV0pIHsgLy8gTGF5ZXJzIHdoaWNoIGFyZSBub3QgZnJvbSBBcmNHSVMsIHN1Y2ggYXMgY3N2IGxheWVyLCBnZW9qc29uIGxheWVyIGFuZCBzbyBvbi5cbiAgICAgICAgICBjb25zdCBMYXllciA9IGF3YWl0IGxvYWRBcmNHSVNKU0FQSU1vZHVsZShOb25BcmNHSVNMYXllckNsYXNzW3RoaXMudHlwZV0pXG4gICAgICAgICAgbGF5ZXIgPSBuZXcgTGF5ZXIob3B0aW9ucylcbiAgICAgICAgfSBlbHNlIHsgLy8gTGF5ZXJzIHdoaWNoIGFyZSBmcm9tIEFyY0dJUywgc3VjaCBhcyBmZWF0dXJlIGxheWVyLCBtYXAgc2VydmljZSBsYXllciwgaW1hZ2Ugc2VydmljZSBsYXllci5cbiAgICAgICAgICBjb25zdCBMYXllcjogdHlwZW9mIF9fZXNyaS5MYXllciA9IGF3YWl0IGxvYWRBcmNHSVNKU0FQSU1vZHVsZSgnZXNyaS9sYXllcnMvTGF5ZXInKVxuICAgICAgICAgIGlmICh0aGlzLnBvcnRhbFVybCAmJiB0aGlzLml0ZW1JZCkge1xuICAgICAgICAgICAgbGF5ZXIgPSBhd2FpdCBMYXllci5mcm9tUG9ydGFsSXRlbShvcHRpb25zIGFzIF9fZXNyaS5MYXllckZyb21Qb3J0YWxJdGVtUGFyYW1zKVxuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy51cmwpIHtcbiAgICAgICAgICAgIGxheWVyID0gYXdhaXQgTGF5ZXIuZnJvbUFyY0dJU1NlcnZlclVybChvcHRpb25zIGFzIF9fZXNyaS5MYXllckZyb21BcmNHSVNTZXJ2ZXJVcmxQYXJhbXMpXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGFiZWwgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkubGFiZWwgfHwgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnNvdXJjZUxhYmVsXG4gICAgICAgIGlmIChsYXllciAmJiBsYXllci50aXRsZSAhPT0gbGFiZWwpIHtcbiAgICAgICAgICBsYXllci50aXRsZSA9IGxhYmVsXG4gICAgICAgIH1cblxuICAgICAgICBpZiAobGF5ZXIgJiYgIXRoaXMubGF5ZXIgJiYgIXRoaXMuX2NhY2hlZExheWVyKSB7XG4gICAgICAgICAgdGhpcy5fY2FjaGVkTGF5ZXIgPSBsYXllclxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBKUyBBUEkgbGF5ZXIuICcsIGVyciwgdGhpcy5pZClcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGxheWVyXG4gICAgfVxuXG4gICAgc3VwcG9ydFNwYXRpYWxJbmZvICgpOiBib29sZWFuIHtcbiAgICAgIGNvbnN0IGRzID0gRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXREYXRhU291cmNlKHRoaXMuaWQpXG4gICAgICBpZiAoZHM/LmlzRGF0YVNvdXJjZVNldCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogV2UgZG8gbm90IHN1cHBvcnQgc29tZSB0eXBlcyBvZiBzY2VuZSBsYXllciAoZS5nLiBidWlsZGluZyBzY2VuZSBsYXllciksIGJ1dCB3byBkbyBzdXBwb3J0IHNjZW5lIHNlcnZpY2UuXG4gICAgICAgICAqIFNjZW5lIHNlcnZpY2UgbXVzdCBoYXZlIHNwYXRpYWwgaW5mby5cbiAgICAgICAgICovXG4gICAgICAgIHJldHVybiBkcy5nZXRDaGlsZERhdGFTb3VyY2VzKCkubGVuZ3RoID09PSAwIHx8IGRzLmdldENoaWxkRGF0YVNvdXJjZXMoKS5zb21lKGRzID0+IChkcyBhcyB1bmtub3duIGFzIEpTQVBJTGF5ZXJNaXhpbik/LnN1cHBvcnRTcGF0aWFsSW5mbz8uKCkpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNhY2hlZExheWVyID0gdGhpcy5sYXllciB8fCB0aGlzLl9jYWNoZWRMYXllclxuICAgICAgaWYgKGNhY2hlZExheWVyKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTb21lIGxheWVycyBoYXZlIGBpc1RhYmxlYCBwcm9wZXJ0eSAoZS5nLiBmZWF0dXJlIGxheWVyIGFuZCBjc3YgbGF5ZXIpLCBzb21lIGRvbid0LlxuICAgICAgICAgKiBgaXNUYWJsZWAgaXMgdW5kZWZpbmVkIG9yIGZhbHNlIG1lYW5zIHRoZSBsYXllciBoYXMgc3BhdGlhbCBpbmZvLlxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuICEoY2FjaGVkTGF5ZXIgYXMgYW55KS5pc1RhYmxlXG4gICAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gRGF0YVNvdXJjZVR5cGVzLlNjZW5lTGF5ZXIpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNjZW5lIGxheWVyIGNhbiBub3QgYmUgdGFibGUuXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICEhZHM/LmdldEdlb21ldHJ5VHlwZSgpXG4gICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRMYXllckNvbnN0cnVjdG9yT3B0aW9ucyAoKSB7XG4gICAgICBjb25zdCBvcHRpb25zOiB7IHVybD86IHN0cmluZywgcG9ydGFsSXRlbT86IF9fZXNyaS5Qb3J0YWxJdGVtUHJvcGVydGllcywgc291cmNlSlNPTj86IGFueSwgc291cmNlPzogYW55IH0gPSB7fVxuICAgICAgaWYgKHRoaXMudXJsKSB7XG4gICAgICAgIG9wdGlvbnMudXJsID0gdGhpcy51cmxcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLml0ZW1JZCAmJiB0aGlzLnBvcnRhbFVybCkge1xuICAgICAgICBvcHRpb25zLnBvcnRhbEl0ZW0gPSB7XG4gICAgICAgICAgaWQ6IHRoaXMuaXRlbUlkLFxuICAgICAgICAgIHBvcnRhbDoge1xuICAgICAgICAgICAgdXJsOiB0aGlzLnBvcnRhbFVybFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIElmIGhhcyBhIEpTIEFQSSBsYXllciwgdXNlIGl0IHRvIGF2b2lkIGR1cGxpY2F0ZSByZXF1ZXN0cy5cbiAgICAgICAqIENhbiBub3QgdXNlIGBsYXllci5jbG9uZWAgZGlyZWN0bHkgaGVyZSBzaW5jZSBzb21lIGxheWVyIGhhcyBjbG9uZSBtZXRob2QgYnV0IHdpbGwgdGhyb3cgYW4gZXJyb3IsIHN1Y2ggYXMgY3N2IGxheWVyIHdoaWNoIHJlZmVyZW5jZXMgYSBjc3YgZmlsZSB2aWEgcG9ydGFsIGl0ZW0uXG4gICAgICAgKi9cbiAgICAgIGNvbnN0IGNhY2hlZExheWVyID0gdGhpcy5sYXllciB8fCB0aGlzLl9jYWNoZWRMYXllclxuICAgICAgaWYgKChjYWNoZWRMYXllciBhcyBhbnkpPy5zb3VyY2VKU09OKSB7XG4gICAgICAgIG9wdGlvbnMuc291cmNlSlNPTiA9IChjYWNoZWRMYXllciBhcyBhbnkpLnNvdXJjZUpTT05cbiAgICAgIH1cbiAgICAgIGlmICgoY2FjaGVkTGF5ZXIgYXMgYW55KT8uc291cmNlPy5jbG9uZSkge1xuICAgICAgICBvcHRpb25zLnNvdXJjZSA9IChjYWNoZWRMYXllciBhcyBhbnkpLnNvdXJjZS5jbG9uZSgpXG4gICAgICB9XG4gICAgICBpZiAoKGNhY2hlZExheWVyIGFzIGFueSk/LnBvcnRhbEl0ZW0/LmNsb25lKSB7XG4gICAgICAgIG9wdGlvbnMucG9ydGFsSXRlbSA9IChjYWNoZWRMYXllciBhcyBhbnkpLnBvcnRhbEl0ZW0uY2xvbmUoKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3B0aW9uc1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBKU0FQSUxheWVyTWl4aW5JbXBsXG59XG5cbmNvbnN0IE5vbkFyY0dJU0xheWVyQ2xhc3MgPSB7XG4gIFtEYXRhU291cmNlVHlwZXMuQ1NWXTogJ2VzcmkvbGF5ZXJzL0NTVkxheWVyJyxcbiAgW0RhdGFTb3VyY2VUeXBlcy5HZW9KU09OXTogJ2VzcmkvbGF5ZXJzL0dlb0pTT05MYXllcicsXG4gIFtEYXRhU291cmNlVHlwZXMuS01MXTogJ2VzcmkvbGF5ZXJzL0tNTExheWVyJyxcbiAgW0RhdGFTb3VyY2VUeXBlcy5XRlNdOiAnZXNyaS9sYXllcnMvV0ZTTGF5ZXInLFxuICBbRGF0YVNvdXJjZVR5cGVzLldNU106ICdlc3JpL2xheWVycy9XTVNMYXllcicsXG4gIFtEYXRhU291cmNlVHlwZXMuV01UU106ICdlc3JpL2xheWVycy9XTVRTTGF5ZXInLFxuICAvKipcbiAgICogVmVjdG9yIHRpbGUgc2VydmljZSBpcyBBcmNHSVMgc2VydmljZSwgYnV0IHVzZXIgY2FuIGFkZCB0aGlzIHR5cGUgb2YgZGF0YSBieSBhIHN0eWxlIGpzb24uXG4gICAqIFNlZSBodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9qYXZhc2NyaXB0L2xhdGVzdC9hcGktcmVmZXJlbmNlL2VzcmktbGF5ZXJzLVZlY3RvclRpbGVMYXllci5odG1sIC0gQ3JlYXRpbmcgYSBWZWN0b3JUaWxlTGF5ZXIuXG4gICAqL1xuICBbRGF0YVNvdXJjZVR5cGVzLlZlY3RvclRpbGVTZXJ2aWNlXTogJ2VzcmkvbGF5ZXJzL1ZlY3RvclRpbGVMYXllcidcbn1cbiIsImltcG9ydCB7IGRhdGFTb3VyY2VKc29uQ3JlYXRvciwgdHlwZSBGZWF0dXJlTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCB0eXBlIEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsLCBTY2VuZUxheWVyRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuLidcbmltcG9ydCB7IEFsbERhdGFTb3VyY2VUeXBlcywgRGF0YVNvdXJjZVR5cGVzIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IGRhdGFTb3VyY2VVdGlscyB9IGZyb20gJ2ppbXUtY29yZSdcblxuZXhwb3J0IGNsYXNzIEJ1aWxkaW5nQ29tcG9uZW50U3ViTGF5ZXJEYXRhU291cmNlSW1wbCBleHRlbmRzIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCB7XG4gIHR5cGU6IGFueSA9IERhdGFTb3VyY2VUeXBlcy5CdWlsZGluZ0NvbXBvbmVudFN1YkxheWVyXG5cbiAgYXN5bmMgY3JlYXRlQXNzb2NpYXRlZERhdGFTb3VyY2UgKCk6IFByb21pc2U8RmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGw+IHtcbiAgICBpZiAodGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSlcbiAgICB9XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZVdpdGhMYXllcigpLnRoZW4oYXNzb2NpYXRlZERhdGFTb3VyY2UgPT4ge1xuICAgICAgICBpZiAoIWFzc29jaWF0ZWREYXRhU291cmNlKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUFzc29jaWF0ZWREYXRhU291cmNlV2l0aFVybCgpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFzc29jaWF0ZWREYXRhU291cmNlXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsYXllckRlZiA9IGF3YWl0IHRoaXMuZmV0Y2hMYXllckRlZmluaXRpb24oKSBhcyBhbnlcbiAgICAgIC8vIFdlIG1pZ2h0IGNyZWF0ZSB0aGlzIGRzIGZyb20gYSB2aWV3LCBzbyB3ZSBuZWVkIHRvIGNvbXB1dGUgdGhlIGZlYXR1cmUgc2VydmljZSB1cmwgaGVyZVxuICAgICAgY29uc3QgYXNzb2NpYXRlZEZlYXR1cmVMYXllclVybCA9IGAke3RoaXMuZ2V0QXNzb2NpYXRlZEZlYXR1cmVTZXJ2ZXJVcmwoKX0vJHtsYXllckRlZi5hc3NvY2lhdGVkTGF5ZXJJRH1gXG4gICAgICBjb25zdCBkc0lkID0gdGhpcy5fZ2V0TmV3QXNzb2NpYXRlZERhdGFTb3VyY2VJZCgpXG4gICAgICBsZXQgZHNKc29uID0gZGF0YVNvdXJjZUpzb25DcmVhdG9yLmNyZWF0ZURhdGFTb3VyY2VKc29uQnlMYXllckRlZmluaXRpb24oZHNJZCwgbGF5ZXJEZWYsIGFzc29jaWF0ZWRGZWF0dXJlTGF5ZXJVcmwpXG4gICAgICAvLyBUaGUgYnVpbGRpbmctY29tcG9uZW50J3MgYXNzb2NpYXRlZCBmZWF0dXJlIGxheWVyJ3MgSUQgdXJsIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBvdGhlcnMsIHNldCBpdCBtYW51YWxseVxuICAgICAgZHNKc29uID0gZHNKc29uLnNldCgndXJsJywgYXNzb2NpYXRlZEZlYXR1cmVMYXllclVybClcbiAgICAgIGRzSnNvbiA9IHRoaXMuX21lcmdlQXNzb2NpYXRlZERhdGFTb3VyY2VKc29uKGRzSnNvbikuc2V0SW4oWyd0eXBlJ10sIEFsbERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlTGF5ZXIpXG5cbiAgICAgIGNvbnN0IG9wdGlvbnM6IEZlYXR1cmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7XG4gICAgICAgIGlkOiBkc0pzb24uaWQsXG4gICAgICAgIGRhdGFTb3VyY2VKc29uOiBkc0pzb24sXG4gICAgICAgIGFzc29jaWF0ZWREYXRhU291cmNlOiB0aGlzXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZlYXR1cmVEcyA9IGF3YWl0IHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuY3JlYXRlRGF0YVNvdXJjZShvcHRpb25zKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbFxuICAgICAgdGhpcy5hc3NvY2lhdGVkRGF0YVNvdXJjZSA9IGZlYXR1cmVEc1xuICAgIH1cbiAgfVxuXG4gIGdldEFzc29jaWF0ZWRGZWF0dXJlU2VydmVyVXJsICgpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNjZW5lU2VydmljZVVybEFycmF5ID0gZGF0YVNvdXJjZVV0aWxzLmdldEZ1bGxBcmNHSVNTZXJ2aWNlVXJsKHRoaXMudXJsLCBmYWxzZSkuc3BsaXQoJy8nKVxuICAgIHNjZW5lU2VydmljZVVybEFycmF5W3NjZW5lU2VydmljZVVybEFycmF5Lmxlbmd0aCAtIDFdID0gJ0ZlYXR1cmVTZXJ2ZXInXG4gICAgY29uc3QgZmVhdHVyZVNlcnZpY2VVcmwgPSBzY2VuZVNlcnZpY2VVcmxBcnJheS5qb2luKCcvJylcbiAgICByZXR1cm4gZmVhdHVyZVNlcnZpY2VVcmxcbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBTZXJ2aWNlRGVmaW5pdGlvbiB9IGZyb20gJ2ppbXUtY29yZS9saWIvdHlwZXMvc2VydmljZS1kZWZpbml0aW9uJ1xuaW1wb3J0IHsgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UsIHR5cGUgTGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5pbXBvcnQgeyBEYXRhU291cmNlVHlwZXMsIFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcyB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyB0eXBlIEJ1aWxkaW5nU3ViTGF5ZXJEYXRhU291cmNlT3B0aW9ucyB9IGZyb20gJy4vYnVpbGRpbmctc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IGRhdGFTb3VyY2VKc29uQ3JlYXRvciB9IGZyb20gJy4uJ1xuaW1wb3J0IHsgZGF0YVNvdXJjZVV0aWxzIH0gZnJvbSAnamltdS1jb3JlJ1xuXG5leHBvcnQgY2xhc3MgQnVpbGRpbmdHcm91cFN1YkxheWVyRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5CdWlsZGluZ0dyb3VwU3ViTGF5ZXIgPSBEYXRhU291cmNlVHlwZXMuQnVpbGRpbmdHcm91cFN1YkxheWVyXG4gIHNlcnZpY2VVcmw6IHN0cmluZ1xuICBsYXllckRlZmluaXRpb246IGFueVxuXG4gIGZldGNoU2VydmljZURlZmluaXRpb24gKCk6IFByb21pc2U8U2VydmljZURlZmluaXRpb24+IHtcbiAgICBpZiAoIXRoaXMuc2VydmljZURlZmluaXRpb24pIHtcbiAgICAgIC8vIEJ1aWxkaW5nLWdyb3VwIGxheWVyIGRvZXMgbm90IGhhdmUgYSBjb3JyZXNwb25kaW5nIHNlcnZpY2UsIHVzZSBpdCdzIGxheWVyRGVmaW5pdGlvbiBhcyBzZXJ2aWNlRGVmaW5pdGlvblxuICAgICAgLy8gT3RoZXJ3aXNlIHRoZSBsYWJlbCBjYW4gbm90IGJlIGRpc3BsYXllZFxuICAgICAgdGhpcy5zZXJ2aWNlRGVmaW5pdGlvbiA9IHRoaXMubGF5ZXJEZWZpbml0aW9uXG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5sYXllckRlZmluaXRpb24gfHwge30pXG4gIH1cblxuICBjcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlJZCAoY2hpbGREc0lkOiBzdHJpbmcsIGppbXVDaGlsZElkOiBzdHJpbmcsIGNoaWxkSWQ6IHN0cmluZyk6IExheWVyRm9sZGVyQ2hpbGREYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgICBjb25zdCBzdWJMYXllclVybCA9ICF0aGlzLmxheWVyID8gdGhpcy5nZXRTdWJMYXllclVybEJ5Q2hpbGRJZChjaGlsZElkKSA6ICcnXG4gICAgY29uc3Qgc2VydmljZUluZm8gPSB7XG4gICAgICB1cmw6IHN1YkxheWVyVXJsLFxuICAgICAgbGF5ZXJEZWZpbml0aW9uOiAhdGhpcy5sYXllciA/IHRoaXMuZ2V0U3ViTGF5ZXJEZWZpbml0aW9uQnlDaGlsZElkKGNoaWxkSWQpIDogbnVsbFxuICAgIH1cbiAgICBjb25zdCBzdWJMYXllciA9IHRoaXMuZ2V0U3ViTGF5ZXJCeUNoaWxkSWQoY2hpbGRJZCkgYXMgYW55XG4gICAgLy8gT3ZlcnJpZGUgdGhlIHVybCBzaW5jZSB0aGUgbmFtaW5nIGZvcm1hdCBpcyBkaWZmZXJlbnRcbiAgICBjb25zdCBkc0pzb24gPSBkYXRhU291cmNlSnNvbkNyZWF0b3IuY3JlYXRlRGF0YVNvdXJjZUpzb24oY2hpbGREc0lkLCBzdWJMYXllciwgeyBwb3J0YWxVcmw6ICcnIH0sIHNlcnZpY2VJbmZvKVxuICAgICAgLnNldCgndXJsJywgc3ViTGF5ZXJVcmwpXG5cbiAgICBjb25zdCBkc0pzb25JblJvb3REcyA9IGRhdGFTb3VyY2VVdGlscy5nZXRDaGlsZERzSnNvbkZyb21Sb290RHModGhpcywgamltdUNoaWxkSWQpXG4gICAgY29uc3QgbWVyZ2VkRHNKc29uID0gZHNKc29uLm1lcmdlKGRzSnNvbkluUm9vdERzLCB7IGRlZXA6IHRydWUgfSlcblxuICAgIGNvbnN0IG9wdGlvbjogQnVpbGRpbmdTdWJMYXllckRhdGFTb3VyY2VPcHRpb25zID0ge1xuICAgICAgaWQ6IGNoaWxkRHNJZCxcbiAgICAgIGRhdGFTb3VyY2VKc29uOiBtZXJnZWREc0pzb24sXG4gICAgICBqaW11Q2hpbGRJZDogamltdUNoaWxkSWQsXG4gICAgICBwYXJlbnREYXRhU291cmNlOiB0aGlzLFxuICAgICAgc2VydmljZVVybDogdGhpcy5zZXJ2aWNlVXJsXG4gICAgfVxuXG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIG9wdGlvbi5sYXllciA9IHN1YkxheWVyXG4gICAgfSBlbHNlIGlmICh0aGlzLnNlcnZpY2VEZWZpbml0aW9uKSB7XG4gICAgICBvcHRpb24ubGF5ZXJEZWZpbml0aW9uID0gdGhpcy5nZXRTdWJMYXllckRlZmluaXRpb25CeUNoaWxkSWQoY2hpbGRJZClcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvblxuICB9XG5cbiAgZ2V0Q2hpbGRJZHMgKCk6IHN0cmluZ1tdIHtcbiAgICBpZiAodGhpcy5sYXllcikge1xuICAgICAgY29uc3Qgc3ViTGF5ZXJzID0gKHRoaXMubGF5ZXIgYXMgdW5rbm93biBhcyBfX2VzcmkuQnVpbGRpbmdHcm91cFN1YmxheWVyKS5zdWJsYXllcnNcbiAgICAgIHJldHVybiBzdWJMYXllcnMudG9BcnJheSgpLm1hcChsYXllciA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRDaGlsZElkQnlMYXllcihsYXllciBhcyB1bmtub3duIGFzIF9fZXNyaS5MYXllcilcbiAgICAgICAgcmV0dXJuIGlkXG4gICAgICB9KVxuICAgIH0gZWxzZSBpZiAodGhpcy5sYXllckRlZmluaXRpb24pIHtcbiAgICAgIGNvbnN0IGNoaWxkSWRzID0gdGhpcy5sYXllckRlZmluaXRpb24uc3VibGF5ZXJzLm1hcChkZWYgPT4gZGVmLmlkKVxuICAgICAgcmV0dXJuIGNoaWxkSWRzXG4gICAgfVxuICAgIHJldHVybiBbXVxuICB9XG5cbiAgZ2V0U3ViTGF5ZXJCeUNoaWxkSWQgKGNoaWxkSWQ6IHN0cmluZyk6IF9fZXNyaS5CdWlsZGluZ0NvbXBvbmVudFN1YmxheWVyIHwgX19lc3JpLkJ1aWxkaW5nR3JvdXBTdWJsYXllciB7XG4gICAgaWYgKCF0aGlzLmxheWVyKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICBjb25zdCBzdWJMYXllcnMgPSAodGhpcy5sYXllciBhcyBfX2VzcmkuQnVpbGRpbmdTY2VuZUxheWVyKS5zdWJsYXllcnMudG9BcnJheSgpXG4gICAgZm9yIChjb25zdCBzdWJMYXllciBvZiBzdWJMYXllcnMpIHtcbiAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRDaGlsZElkQnlMYXllcihzdWJMYXllciBhcyB1bmtub3duIGFzIF9fZXNyaS5MYXllcilcbiAgICAgIGlmIChpZCA9PT0gY2hpbGRJZCkge1xuICAgICAgICByZXR1cm4gc3ViTGF5ZXJcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGdldFN1YkxheWVyRGVmaW5pdGlvbkJ5Q2hpbGRJZCAoY2hpbGRJZDogc3RyaW5nKSB7XG4gICAgaWYgKCF0aGlzLmxheWVyRGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gICAgZm9yIChjb25zdCBzdWJMYXllckRlZiBvZiB0aGlzLmxheWVyRGVmaW5pdGlvbi5zdWJsYXllcnMpIHtcbiAgICAgIGlmIChzdWJMYXllckRlZi5pZC50b1N0cmluZygpID09PSBjaGlsZElkLnRvU3RyaW5nKCkpIHtcbiAgICAgICAgaWYgKHN1YkxheWVyRGVmLmxheWVyVHlwZSA9PT0gJ2dyb3VwJykge1xuICAgICAgICAgIHN1YkxheWVyRGVmLmxheWVyVHlwZSA9IFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcy5CdWlsZGluZ0dyb3VwU3ViTGF5ZXJcbiAgICAgICAgfSBlbHNlIGlmIChzdWJMYXllckRlZi5sYXllclR5cGUgPT09ICczRE9iamVjdCcpIHtcbiAgICAgICAgICBzdWJMYXllckRlZi5sYXllclR5cGUgPSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuQnVpbGRpbmdDb21wb25lbnRTdWJMYXllclxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdWJMYXllckRlZlxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgZ2V0U3ViTGF5ZXJVcmxCeUNoaWxkSWQgKGNoaWxkSWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHN1YkxheWVyRGVmID0gdGhpcy5nZXRTdWJMYXllckRlZmluaXRpb25CeUNoaWxkSWQoY2hpbGRJZClcbiAgICByZXR1cm4gc3ViTGF5ZXJEZWYubGF5ZXJUeXBlID09PSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuQnVpbGRpbmdHcm91cFN1YkxheWVyID8gbnVsbCA6IGAke3RoaXMuc2VydmljZVVybH0vc3VibGF5ZXJzLyR7Y2hpbGRJZH1gXG4gIH1cbn1cbiIsImltcG9ydCB7IGRhdGFTb3VyY2VVdGlscyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IGRhdGFTb3VyY2VKc29uQ3JlYXRvciB9IGZyb20gJy4uJ1xuaW1wb3J0IHsgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UsIHR5cGUgTGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5pbXBvcnQgeyB0eXBlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VUeXBlcywgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IHR5cGUgQnVpbGRpbmdTY2VuZUxheWVyRGF0YVNvdXJjZUludGVyZmFjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvYnVpbGRpbmctc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW50ZXJmYWNlJ1xuXG50eXBlIFN1YkxheWVyID0gX19lc3JpLkJ1aWxkaW5nQ29tcG9uZW50U3VibGF5ZXIgfCBfX2VzcmkuQnVpbGRpbmdHcm91cFN1YmxheWVyXG5cbmV4cG9ydCBpbnRlcmZhY2UgQnVpbGRpbmdTdWJMYXllckRhdGFTb3VyY2VPcHRpb25zIGV4dGVuZHMgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIHNlcnZpY2VVcmw/OiBzdHJpbmdcbiAgbGF5ZXJEZWZpbml0aW9uPzogYW55XG4gIGxheWVyPzogYW55XG59XG5cbmV4cG9ydCBjbGFzcyBCdWlsZGluZ1NjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCBleHRlbmRzIEFic3RyYWN0TGF5ZXJGb2xkZXJEYXRhU291cmNlIGltcGxlbWVudHMgQnVpbGRpbmdTY2VuZUxheWVyRGF0YVNvdXJjZUludGVyZmFjZSB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5CdWlsZGluZ1NjZW5lTGF5ZXIgPSBEYXRhU291cmNlVHlwZXMuQnVpbGRpbmdTY2VuZUxheWVyXG4gIGxheWVyPzogX19lc3JpLkJ1aWxkaW5nU2NlbmVMYXllclxuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcbiAgICBpZiAob3B0aW9ucy5sYXllcikge1xuICAgICAgY29uc3QgdXJsQXJyYXk6IHN0cmluZ1tdID0gb3B0aW9ucy5sYXllci51cmwuc3BsaXQoJy8nKVxuICAgICAgaWYgKHVybEFycmF5W3VybEFycmF5Lmxlbmd0aCAtIDFdID09PSAnU2NlbmVTZXJ2ZXInKSB7XG4gICAgICAgIC8vIENvbXB1dGUgdGhlIGFjdHVhbCB1cmwgZm9yIHRoZSBidWlsZGluZy1zY2VuZSBsYXllclxuICAgICAgICB0aGlzLnVybCA9IGAke29wdGlvbnMubGF5ZXIudXJsfS9sYXllcnMvJHtvcHRpb25zLmxheWVyLmxheWVySWR9YFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkIChjaGlsZERzSWQ6IHN0cmluZywgamltdUNoaWxkSWQ6IHN0cmluZywgY2hpbGRJZDogc3RyaW5nKTogTGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICAgIGNvbnN0IHN1YkxheWVyVXJsID0gIXRoaXMubGF5ZXIgPyB0aGlzLmdldFN1YkxheWVyVXJsQnlDaGlsZElkKGNoaWxkSWQpIDogJydcbiAgICBjb25zdCBzZXJ2aWNlSW5mbyA9IHtcbiAgICAgIHVybDogc3ViTGF5ZXJVcmwsXG4gICAgICBsYXllckRlZmluaXRpb246ICF0aGlzLmxheWVyID8gdGhpcy5nZXRTdWJMYXllckRlZmluaXRpb25CeUNoaWxkSWQoY2hpbGRJZCkgOiBudWxsXG4gICAgfVxuICAgIGNvbnN0IHN1YkxheWVyID0gdGhpcy5nZXRTdWJMYXllckJ5Q2hpbGRJZChjaGlsZElkKSBhcyBhbnlcbiAgICAvLyBPdmVycmlkZSB0aGUgdXJsIHNpbmNlIHRoZSBuYW1pbmcgZm9ybWF0IGlzIGRpZmZlcmVudFxuICAgIGNvbnN0IGRzSnNvbiA9IGRhdGFTb3VyY2VKc29uQ3JlYXRvci5jcmVhdGVEYXRhU291cmNlSnNvbihjaGlsZERzSWQsIHN1YkxheWVyLCB7IHBvcnRhbFVybDogJycgfSwgc2VydmljZUluZm8pXG4gICAgICAuc2V0KCd1cmwnLCBzdWJMYXllclVybClcblxuICAgIGNvbnN0IGRzSnNvbkluUm9vdERzID0gZGF0YVNvdXJjZVV0aWxzLmdldENoaWxkRHNKc29uRnJvbVJvb3REcyh0aGlzLCBqaW11Q2hpbGRJZClcbiAgICBjb25zdCBtZXJnZWREc0pzb24gPSBkc0pzb24ubWVyZ2UoZHNKc29uSW5Sb290RHMsIHsgZGVlcDogdHJ1ZSB9KVxuXG4gICAgY29uc3Qgb3B0aW9uOiBCdWlsZGluZ1N1YkxheWVyRGF0YVNvdXJjZU9wdGlvbnMgPSB7XG4gICAgICBpZDogY2hpbGREc0lkLFxuICAgICAgZGF0YVNvdXJjZUpzb246IG1lcmdlZERzSnNvbixcbiAgICAgIGppbXVDaGlsZElkOiBqaW11Q2hpbGRJZCxcbiAgICAgIHBhcmVudERhdGFTb3VyY2U6IHRoaXMsXG4gICAgICBzZXJ2aWNlVXJsOiB0aGlzLnVybFxuICAgIH1cblxuICAgIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICBvcHRpb24ubGF5ZXIgPSBzdWJMYXllclxuICAgIH0gZWxzZSBpZiAodGhpcy5zZXJ2aWNlRGVmaW5pdGlvbikge1xuICAgICAgb3B0aW9uLmxheWVyRGVmaW5pdGlvbiA9IHRoaXMuZ2V0U3ViTGF5ZXJEZWZpbml0aW9uQnlDaGlsZElkKGNoaWxkSWQpXG4gICAgfVxuICAgIHJldHVybiBvcHRpb25cbiAgfVxuXG4gIGdldENoaWxkSWRzICgpOiBzdHJpbmdbXSB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIGNvbnN0IHN1YkxheWVycyA9IHRoaXMubGF5ZXIuc3VibGF5ZXJzXG4gICAgICByZXR1cm4gc3ViTGF5ZXJzLnRvQXJyYXkoKS5tYXAobGF5ZXIgPT4ge1xuICAgICAgICBjb25zdCBpZCA9IHRoaXMuZ2V0Q2hpbGRJZEJ5TGF5ZXIobGF5ZXIgYXMgdW5rbm93biBhcyBfX2VzcmkuTGF5ZXIpXG4gICAgICAgIHJldHVybiBpZFxuICAgICAgfSlcbiAgICB9IGVsc2UgaWYgKHRoaXMuc2VydmljZURlZmluaXRpb24pIHtcbiAgICAgIGNvbnN0IHN1YkxheWVyRGVmaW5pdGlvbnMgPSAodGhpcy5zZXJ2aWNlRGVmaW5pdGlvbiBhcyBhbnkpLnN1YmxheWVyc1xuICAgICAgY29uc3QgcmV0ID0gc3ViTGF5ZXJEZWZpbml0aW9ucy5tYXAoc3ViTGF5ZXJEZWYgPT4ge1xuICAgICAgICByZXR1cm4gc3ViTGF5ZXJEZWYuaWRcbiAgICAgIH0pXG4gICAgICByZXR1cm4gcmV0XG4gICAgfVxuICAgIHJldHVybiBbXVxuICB9XG5cbiAgZ2V0U3ViTGF5ZXJCeUNoaWxkSWQgKGNoaWxkSWQ6IHN0cmluZyk6IFN1YkxheWVyIHtcbiAgICBpZiAoIXRoaXMubGF5ZXIpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIGNvbnN0IHN1YkxheWVycyA9ICh0aGlzLmxheWVyKS5zdWJsYXllcnMudG9BcnJheSgpXG4gICAgZm9yIChjb25zdCBzdWJMYXllciBvZiBzdWJMYXllcnMpIHtcbiAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRDaGlsZElkQnlMYXllcihzdWJMYXllciBhcyB1bmtub3duIGFzIF9fZXNyaS5MYXllcilcbiAgICAgIGlmIChpZCA9PT0gY2hpbGRJZCkge1xuICAgICAgICByZXR1cm4gc3ViTGF5ZXJcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGdldFN1YkxheWVyRGVmaW5pdGlvbkJ5Q2hpbGRJZCAoY2hpbGRJZDogc3RyaW5nKSB7XG4gICAgLy8gT25seSBnZXQgc3ViTGF5ZXJEZWZpbml0aW9uIGZyb20gdGhpcyBtZXRob2QsIGJlY2F1c2UgdGhlIGxheWVyVHlwZSBpcyBub3QgdW5pcXVlLCB3ZSBuZWVkIHRvIG92ZXJyaWRlIGl0XG4gICAgaWYgKCF0aGlzLnNlcnZpY2VEZWZpbml0aW9uKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICBjb25zdCBzdWJMYXllckRlZmluaXRpb25zID0gKHRoaXMuc2VydmljZURlZmluaXRpb24gYXMgYW55KS5zdWJsYXllcnNcbiAgICBmb3IgKGNvbnN0IHN1YkxheWVyRGVmIG9mIHN1YkxheWVyRGVmaW5pdGlvbnMpIHtcbiAgICAgIGlmIChzdWJMYXllckRlZi5pZCA9PT0gY2hpbGRJZCkge1xuICAgICAgICAvLyBUaGUgbGF5ZXJUeXBlIG1heSBoYXZlIGJlZW4gb3ZlcndyaXR0ZW4gYWxyZWFkeVxuICAgICAgICBpZiAoc3ViTGF5ZXJEZWYubGF5ZXJUeXBlID09PSAnZ3JvdXAnKSB7XG4gICAgICAgICAgc3ViTGF5ZXJEZWYubGF5ZXJUeXBlID0gU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLkJ1aWxkaW5nR3JvdXBTdWJMYXllclxuICAgICAgICB9IGVsc2UgaWYgKHN1YkxheWVyRGVmLmxheWVyVHlwZSA9PT0gJzNET2JqZWN0Jykge1xuICAgICAgICAgIHN1YkxheWVyRGVmLmxheWVyVHlwZSA9IFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcy5CdWlsZGluZ0NvbXBvbmVudFN1YkxheWVyXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1YkxheWVyRGVmXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBnZXRTdWJMYXllclVybEJ5Q2hpbGRJZCAoY2hpbGRJZDogc3RyaW5nKSB7XG4gICAgLy8gc3ViTGF5ZXJEZWZpbml0aW9uIGlzIHN0aWxsIGF2YWlsYWJsZSB3aXRoIGEgd2ViLXNjZW5lXG4gICAgY29uc3Qgc3ViTGF5ZXJEZWYgPSB0aGlzLmdldFN1YkxheWVyRGVmaW5pdGlvbkJ5Q2hpbGRJZChjaGlsZElkKVxuICAgIGNvbnN0IHNlcnZpY2VVcmwgPSB0aGlzLnVybFxuICAgIHJldHVybiBzdWJMYXllckRlZi5sYXllclR5cGUgPT09IFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcy5CdWlsZGluZ0dyb3VwU3ViTGF5ZXIgPyBudWxsIDogYCR7c2VydmljZVVybH0vc3VibGF5ZXJzLyR7Y2hpbGRJZH1gXG4gIH1cbn1cbiIsImltcG9ydCB7IHJlcXVlc3RVdGlscyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IERhdGFTb3VyY2VUeXBlcywgdHlwZSBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCBEYXRhU291cmNlU3RhdHVzLCB0eXBlIERhdGFSZWNvcmQsIHR5cGUgQ1NWRGF0YVNvdXJjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyBBYnN0cmFjdExvYWRhYmxlRGF0YVNvdXJjZSwgSXRlbU1peGluSW1wbCwgSlNBUElMYXllck1peGluSW1wbCwgU2ltcGxlRGF0YVJlY29yZEltcGwgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ1NWRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBsYXllcj86IF9fZXNyaS5DU1ZMYXllclxufVxuXG5leHBvcnQgY2xhc3MgQ1NWRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBKU0FQSUxheWVyTWl4aW5JbXBsKEl0ZW1NaXhpbkltcGwoQWJzdHJhY3RMb2FkYWJsZURhdGFTb3VyY2UpKSBpbXBsZW1lbnRzIENTVkRhdGFTb3VyY2Uge1xuICBsYXllcj86IF9fZXNyaS5DU1ZMYXllclxuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuQ1NWID0gRGF0YVNvdXJjZVR5cGVzLkNTVlxuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zOiBDU1ZEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcblxuICAgIGNvbnN0IGRzSnNvbiA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKVxuXG4gICAgaWYgKGRzSnNvbi5kYXRhKSB7XG4gICAgICB0aGlzLnJlY29yZHMgPSBkc0pzb24uZGF0YS5hc011dGFibGUoKS5tYXAoZCA9PiBuZXcgU2ltcGxlRGF0YVJlY29yZEltcGwoZCwgdGhpcykpXG4gICAgICB0aGlzLnNldFN0YXR1cyhEYXRhU291cmNlU3RhdHVzLkxvYWRlZClcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy51cmwgPSBkc0pzb24udXJsXG4gICAgfVxuXG4gICAgdGhpcy5wb3J0YWxVcmwgPSBkc0pzb24ucG9ydGFsVXJsXG4gICAgdGhpcy5pdGVtSWQgPSBkc0pzb24uaXRlbUlkXG5cbiAgICBpZiAodGhpcy51cmwpIHtcbiAgICAgIC8qKlxuICAgICAgICogQ2FjaGUgcmVxdWVzdCBzaW5jZSAtXG4gICAgICAgKiAxLiB3ZSBuZWVkIHRvIGNhY2hlIHRoZSByZXF1ZXN0IHNpbmNlIHRoZSByZWNvcmRzIGFyZSBzYXZlZCBoZXJlLCB3aGljaCBtZWFucywgdGhlIHJlc3BvbnNlIHNpemUgbWF5IGJlIGxhcmdlLlxuICAgICAgICogMi4gd2UgZG9uJ3Qga25vdyB0aGUgVVJMIHNjaGVtYSBvZiB0aGlzIHR5cGUgb2YgZGF0YSBzb3VyY2UsIGNhbiBub3QgY2FjaGUgdGhlbSBieSBkZWZhdWx0LlxuICAgICAgICovXG4gICAgICByZXF1ZXN0VXRpbHMucmVnaXN0ZXJDYWNoZWFibGVVcmwodGhpcy51cmwpXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVhZHkgKCkge1xuICAgIGlmICghdGhpcy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IGF3YWl0IHRoaXMuY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpIGFzIF9fZXNyaS5DU1ZMYXllclxuICAgIH1cbiAgICBhd2FpdCB0aGlzLmxheWVyLmxvYWQoKVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxuICB9XG5cbiAgYXN5bmMgZG9Mb2FkICgpOiBQcm9taXNlPERhdGFSZWNvcmRbXT4ge1xuICAgIHJldHVybiBhd2FpdCBmZXRjaCh0aGlzLnVybCkudGhlbihhc3luYyByZXMgPT4gYXdhaXQgcmVzLmpzb24oKSkudGhlbigoZGF0YTogYW55W10pID0+IHtcbiAgICAgIHJldHVybiBkYXRhLm1hcChkID0+IG5ldyBTaW1wbGVEYXRhUmVjb3JkSW1wbChkLCB0aGlzKSlcbiAgICB9KVxuICB9XG59XG4iLCJpbXBvcnQgeyBEYXRhU291cmNlVHlwZXMsIHR5cGUgRGF0YVNvdXJjZSwgdHlwZSBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCB0eXBlIERhdGFTb3VyY2VFcnJvciB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyBBYnN0cmFjdERhdGFTb3VyY2UgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgRXJyb3JEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIGV4dGVuZHMgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIGVycm9yOiBEYXRhU291cmNlRXJyb3Jcbn1cblxuZXhwb3J0IGNsYXNzIEVycm9yRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBBYnN0cmFjdERhdGFTb3VyY2UgaW1wbGVtZW50cyBEYXRhU291cmNlIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkVycm9yID0gRGF0YVNvdXJjZVR5cGVzLkVycm9yXG4gIGVycm9yOiBEYXRhU291cmNlRXJyb3Jcbn1cbiIsImltcG9ydCB7XG4gIGVzcmksIEltbXV0YWJsZSwgdHlwZSBEYXRhU291cmNlU2NoZW1hLCBTZXJ2aWNlTWFuYWdlciwgdHlwZSBTZXJ2aWNlSW5mbywgcmVxdWVzdFV0aWxzLCB0eXBlIE9yZGVyQnlPcHRpb24sIGRhdGFTb3VyY2VVdGlscywgdHlwZSBJTURhdGFTb3VyY2VTY2hlbWEsIGdldEFwcFN0b3JlLFxuICBhcHBBY3Rpb25zLCBsb2FkQXJjR0lTSlNBUElNb2R1bGVzLCB0eXBlIEltbXV0YWJsZUFycmF5LCBKaW11RmllbGRUeXBlLCBwcm94eVV0aWxzLCBwb3J0YWxVcmxVdGlscywgbG9kYXNoLCBsb2FkQXJjR0lTSlNBUElNb2R1bGUsIG1vZHVsZUxvYWRlciwgVGltZXpvbmVUeXBlXG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgR2VvbWV0cnlUeXBlLCB0eXBlIElQb3B1cEluZm8sIHR5cGUgSUl0ZW0sIHR5cGUgSUZpZWxkSW5mbywgdHlwZSBJRmllbGQsIHR5cGUgSUZlYXR1cmUsIHR5cGUgSUZlYXR1cmVMYXllciwgdHlwZSBJTGF5ZXJEZWZpbml0aW9uIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnXG5pbXBvcnQgeyB0eXBlIElRdWVyeUZlYXR1cmVzT3B0aW9ucywgdHlwZSBJUXVlcnlGZWF0dXJlc1Jlc3BvbnNlLCB0eXBlIElBZGRGZWF0dXJlc09wdGlvbnMsIHR5cGUgSVVwZGF0ZUZlYXR1cmVzT3B0aW9ucywgdHlwZSBJRGVsZXRlRmVhdHVyZXNPcHRpb25zIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtZmVhdHVyZS1sYXllcidcbmltcG9ydCB7IEZlYXR1cmVEYXRhUmVjb3JkSW1wbCB9IGZyb20gJy4vZmVhdHVyZS1yZWNvcmQtaW1wbCdcbmltcG9ydCB7IEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSwgSXRlbU1peGluSW1wbCwgSlNBUElMYXllck1peGluSW1wbCB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcbmltcG9ydCB7XG4gIHR5cGUgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucywgRGF0YVNvdXJjZVR5cGVzLCB0eXBlIFF1ZXJ5UmVzdWx0LCB0eXBlIENvZGVkVmFsdWUsIHR5cGUgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSwgdHlwZSBGZWF0dXJlRGF0YVJlY29yZCwgdHlwZSBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zLCB0eXBlIEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zLFxuICB0eXBlIFF1ZXJ5T3B0aW9ucywgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLCB0eXBlIFNjZW5lTGF5ZXJEYXRhU291cmNlLCBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcywgdHlwZSBUaW1lSW5mbywgdHlwZSBHZXRDdXJyZW50UXVlcnlQYXJhbXNPcHRpb25zLCB0eXBlIFF1ZXJpYWJsZURhdGFTb3VyY2UsIHR5cGUgRmVhdHVyZUxheWVyQ2FwYWJpbGl0aWVzLCBEYXRhU291cmNlRXJyb3IsIHR5cGUgRmVhdHVyZUxheWVyVXNlZEZpZWxkc09wdGlvbnNcbn0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IEZlYXR1cmVMYXllckNhcGFiaWxpdGllc0ltcGwgfSBmcm9tICcuLi9zdXBwb3J0L2ZlYXR1cmUtbGF5ZXItY2FwYWJpbGl0aWVzLWltcGwnXG5pbXBvcnQgeyB0eXBlIFdlYk1hcFdlYkNoYXJ0IH0gZnJvbSAnQGFyY2dpcy9jaGFydHMtc3BlYydcbi8vIE9ubHkgdXNlZCBhcyB0eXBlLlxuaW1wb3J0IHR5cGUgeyBKaW11RmVhdHVyZUxheWVyVmlldywgTWFwVmlld01hbmFnZXIgfSBmcm9tICdqaW11LWFyY2dpcydcblxuZXhwb3J0IGludGVyZmFjZSBGZWF0dXJlTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIGV4dGVuZHMgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBJZiB0aGUgZmVhdHVyZSBsYXllciBkYXRhIHNvdXJjZSBpcyB1c2VkIGJ5IGEgc2NlbmUgbGF5ZXIgZGF0YSBzb3VyY2UgdG8gZG8gcXVlcnksXG4gICAqIHdpbGwgc2F2ZSB0aGUgc2NlbmUgbGF5ZXIgZGF0YSBzb3VyY2UgdG8gbWFrZSBpdCBlYXN5IHRvIGZpbmQgaXQuXG4gICAqL1xuICBhc3NvY2lhdGVkRGF0YVNvdXJjZT86IFNjZW5lTGF5ZXJEYXRhU291cmNlXG4gIC8qKlxuICAgKiBJZiB0aGUgZmVhdHVyZSBsYXllciBkYXRhIHNvdXJjZSBpcyBjcmVhdGVkIGZyb20gYSBKUyBBUEkgZmVhdHVyZSBsYXllcixcbiAgICogd2lsbCB1c2UgZGF0YSBpbiB0aGUgbGF5ZXIgYXMgc291cmNlIG9mIGN1cnJlbnQgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBsYXllcj86IF9fZXNyaS5GZWF0dXJlTGF5ZXJcbiAgLyoqXG4gICAqIElmIHRoZSBmZWF0dXJlIGxheWVyIGRhdGEgc291cmNlIGlzIGNyZWF0ZWQgZnJvbSBhbiBhcnJheSBkaXJlY3RseSxcbiAgICogd2lsbCBzYXZlIHRoZSBhcnJheSB0byBgc291cmNlUmVjb3Jkc2AgYW5kIHVzZSBpdCBhcyBzb3VyY2Ugb2YgY3VycmVudCBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHNvdXJjZVJlY29yZHM/OiBGZWF0dXJlRGF0YVJlY29yZFtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9uc1dpdGhKU0FQSUxheWVyIGV4dGVuZHMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIGxheWVyPzogX19lc3JpLkZlYXR1cmVMYXllclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnNXaXRoUmVjb3JkcyBleHRlbmRzIEZlYXR1cmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBzb3VyY2VSZWNvcmRzPzogRmVhdHVyZURhdGFSZWNvcmRbXVxufVxuXG5leHBvcnQgY2xhc3MgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBKU0FQSUxheWVyTWl4aW5JbXBsKEl0ZW1NaXhpbkltcGwoQWJzdHJhY3RRdWVyaWFibGVEYXRhU291cmNlKSkgaW1wbGVtZW50cyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlIHtcbiAgbGF5ZXJJZD86IHN0cmluZ1xuXG4gIHByb3RlY3RlZCBfbGF5ZXI/OiBfX2VzcmkuRmVhdHVyZUxheWVyXG4gIHByaXZhdGUgX3Jlc3RMYXllcj86IElGZWF0dXJlTGF5ZXJcbiAgLyoqXG4gICAqIFVzZSB0aGUgSlMgQVBJIGZlYXR1cmUgbGF5ZXIgdG8gc3VwcG9ydCBwYmYgZm9ybWF0IGZvciBkYXRhIHNvdXJjZXMgd2hpY2ggZG8gbm90IGNvbnRhaW4gbGF5ZXIgd2hlbiBjcmVhdGVkLCBlLmcuIGRhdGEgc291cmNlIGZyb20gYSBzZXJ2aWNlIHVybC5cbiAgICovXG4gIGxheWVyRm9yUmVzdFF1ZXJ5PzogX19lc3JpLkZlYXR1cmVMYXllclxuICBwcml2YXRlIGxheWVyRm9yUmVzdFF1ZXJ5UHJvbWlzZT86IFByb21pc2U8X19lc3JpLkZlYXR1cmVMYXllcj5cbiAgcHJvdGVjdGVkIHNvdXJjZVJlY29yZHM/OiBGZWF0dXJlRGF0YVJlY29yZFtdXG4gIHByaXZhdGUgYXNzb2NpYXRlZERhdGFTb3VyY2U/OiBTY2VuZUxheWVyRGF0YVNvdXJjZVxuICBwcml2YXRlIGxheWVyRGVmaW5pdGlvbj86IElMYXllckRlZmluaXRpb25cbiAgcHJpdmF0ZSBwb3B1cEluZm8/OiBJUG9wdXBJbmZvXG4gIHByaXZhdGUgYWxsb3dFeHBvcnRSZW1vdGVDaGVja1Byb21pc2U6IFByb21pc2U8Ym9vbGVhbj5cblxuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuRmVhdHVyZUxheWVyID0gRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllclxuXG4gIGNyZWF0ZUZlYXR1cmVMYXllclByb21pc2U6IFByb21pc2U8X19lc3JpLkZlYXR1cmVMYXllcj5cblxuICBjb25zdHJ1Y3RvciAob3B0aW9uczogRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9uc1dpdGhKU0FQSUxheWVyKVxuICBjb25zdHJ1Y3RvciAob3B0aW9uczogRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9uc1dpdGhSZWNvcmRzKVxuICBjb25zdHJ1Y3RvciAob3B0aW9uczogRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpXG4gICAgY29uc3QgZHNKc29uID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpXG4gICAgdGhpcy5wb3J0YWxVcmwgPSBkc0pzb24ucG9ydGFsVXJsXG4gICAgdGhpcy5pdGVtSWQgPSBkc0pzb24uaXRlbUlkXG4gICAgdGhpcy5sYXllcklkID0gZHNKc29uLmxheWVySWRcblxuICAgIGlmIChvcHRpb25zLmxheWVyKSB7XG4gICAgICB0aGlzLmxheWVyID0gb3B0aW9ucy5sYXllclxuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5iZWxvbmdUb0RhdGFTb3VyY2UgJiYgKG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2UpLmxheWVyKSB7XG4gICAgICB0aGlzLmxheWVyID0gKG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2UpLmxheWVyXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSkge1xuICAgICAgLy8gUmVzZXQgb3RoZXIgc291cmNlcyBpbmZvLlxuICAgICAgdGhpcy51cmwgPSBudWxsXG4gICAgICB0aGlzLml0ZW1JZCA9IG51bGxcbiAgICAgIHRoaXMucG9ydGFsVXJsID0gbnVsbFxuICAgICAgdGhpcy5zZXRDYXBhYmlsaXRpZXMobmV3IEZlYXR1cmVMYXllckNhcGFiaWxpdGllc0ltcGwoeyBsYXllckRlZmluaXRpb246IG51bGwsIGlzQ2xpZW50U2lkZTogdHJ1ZSB9KSlcbiAgICB9XG5cbiAgICBpZiAodGhpcy5sYXllcj8ucG9ydGFsSXRlbSkge1xuICAgICAgdGhpcy5zZXRJdGVtSW5mbyh0aGlzLmxheWVyLnBvcnRhbEl0ZW0uc291cmNlSlNPTiBhcyBJSXRlbSlcbiAgICB9XG5cbiAgICAvLyBBc3NvY2lhdGVkIGZlYXR1cmUgbGF5ZXIgc2hvdWxkIHVzZSB0aGUgc2FtZSBjYXNlLXNlbnNpdGl2ZSB3aXRoIGl0cyBzY2VuZSBsYXllci5cbiAgICBpZiAodGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpKSB7XG4gICAgICB0aGlzLmlzU3FsQ2FzZVNlbnNpdGl2ZSA9IHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKS5pc1NxbENhc2VTZW5zaXRpdmVcbiAgICB9XG4gIH1cblxuICByZWFkeSAoKSB7XG4gICAgcmV0dXJuIHN1cGVyLnJlYWR5KCkudGhlbigoKSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5yZXBsYWNlU3ViTGF5ZXJXaXRoRmVhdHVyZUxheWVyKClcbiAgICB9KVxuICB9XG5cbiAgc2V0QXNzb2NpYXRlZERhdGFTb3VyY2UgKGFzc29jaWF0ZWREYXRhU291cmNlOiBTY2VuZUxheWVyRGF0YVNvdXJjZSkge1xuICAgIHRoaXMuYXNzb2NpYXRlZERhdGFTb3VyY2UgPSBhc3NvY2lhdGVkRGF0YVNvdXJjZVxuICB9XG5cbiAgZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UgKCk6IFNjZW5lTGF5ZXJEYXRhU291cmNlIHtcbiAgICByZXR1cm4gdGhpcy5hc3NvY2lhdGVkRGF0YVNvdXJjZVxuICB9XG5cbiAgZ2V0SWRGaWVsZCAoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTY2hlbWEoKS5pZEZpZWxkXG4gIH1cblxuICBnZXRHZW9tZXRyeVR5cGUgKCk6IEdlb21ldHJ5VHlwZSB7XG4gICAgY29uc3QgbGF5ZXJEZWYgPSB0aGlzLmdldExheWVyRGVmaW5pdGlvbigpXG4gICAgaWYgKGxheWVyRGVmPy50eXBlID09PSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5UYWJsZSkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5nZW9tZXRyeVR5cGUgfHwgbGF5ZXJEZWY/Lmdlb21ldHJ5VHlwZVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRvUXVlcnkgKHJlYWxRdWVyeTogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgb3JpZ2luUXVlcnk6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgdGhpcy5fcHJpbnRVc2VBbGxGaWVsZHNXYXJuaW5nKHJlYWxRdWVyeS5vdXRGaWVsZHMpXG5cbiAgICBpZiAoIXRoaXMuZ2V0Q2FwYWJpbGl0aWVzKCkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnVW5hYmxlIHRvIHBlcmZvcm0gcXVlcnkuIFdhaXRpbmcgZm9yIGxheWVyIGNhcGFiaWxpdGllcy4nKVxuICAgIH1cblxuICAgIGlmICghcmVhbFF1ZXJ5IHx8ICFvcmlnaW5RdWVyeSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdVbmFibGUgdG8gcGVyZm9ybSBxdWVyeS4gUXVlcnkgcGFyYW1ldGVyIGlzIG51bGwuJylcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0OiBRdWVyeVJlc3VsdCA9IG51bGxcbiAgICBsZXQgZXJyb3JNc2cgPSAnJ1xuICAgIGNvbnN0IGNhcCA9IHRoaXMuZ2V0Q2FwYWJpbGl0aWVzKCkuZ2V0UXVlcnlDYXBhYmlsaXRpZXMoKVxuICAgIC8qKlxuICAgICAqIGBvcmlnaW5RdWVyeWAgZG9lc24ndCBtZXJnZSBvdGhlciBxdWVyaWVzIGluIHRoZSBjdXJyZW50IGRhdGEgc291cmNlLCB0byBnZXQgZnVsbCBvcmlnaW4gcXVlcnksIG5lZWQgdG8gbWVyZ2UgcmVhbCBxdWVyeS5cbiAgICAgKi9cbiAgICBjb25zdCBvcmlnaW5RdWVyeVdpdGhPdGhlclF1ZXJpZXNJbkRzID0gcmVhbFF1ZXJ5Lm1lcmdlKG9yaWdpblF1ZXJ5KVxuICAgIGlmIChyZWFsUXVlcnkub3V0U3RhdGlzdGljcykge1xuICAgICAgY29uc3QgbWF0Y2hTdGF0aXN0aWNzID0gcmVhbFF1ZXJ5Lm91dFN0YXRpc3RpY3Muc29tZShzdGF0ID0+IHN0YXQuc3RhdGlzdGljVHlwZS5pbmNsdWRlcygncGVyY2VudGlsZScpKSA/IGNhcC5zdXBwb3J0c1N0YXRpc3RpY3MgJiYgY2FwLnN1cHBvcnRzUGVyY2VudGlsZVN0YXRpc3RpY3MgOiBjYXAuc3VwcG9ydHNTdGF0aXN0aWNzXG4gICAgICBpZiAobWF0Y2hTdGF0aXN0aWNzKSB7XG4gICAgICAgIGxldCBmaXhlZFF1ZXJ5ID0gcmVhbFF1ZXJ5XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmVzdWx0IG1heSBjb250YWluIG1vcmUgdGhhbiBvbmUgcmVjb3Jkcy5cbiAgICAgICAgICovXG4gICAgICAgIGlmIChyZWFsUXVlcnkuZ3JvdXBCeUZpZWxkc0ZvclN0YXRpc3RpY3M/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBSZW1vdmUgcGFnaW5hdGlvbiBpZiBzZXJ2aWNlIGRvZXNuJ3Qgc3VwcG9ydCBwYWdpbmF0aW9uIG9uIHN0YXRpc3RpY3MgcXVlcnkgd2l0aCBncm91cCBieS5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBpZiAoIWNhcC5zdXBwb3J0c1BhZ2luYXRpb25PblN0YXRpc3RpY3NXaXRoR3JvdXBCeSkge1xuICAgICAgICAgICAgZml4ZWRRdWVyeSA9IGZpeGVkUXVlcnkud2l0aG91dCgncGFnZScpLndpdGhvdXQoJ3BhZ2VTaXplJylcbiAgICAgICAgICB9XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogUmVtb3ZlIG9yZGVyIGJ5IGlmIHRoZSBvcmRlciBieSBmaWVsZHMgZG9uJ3QgbWF0Y2ggc2VydmljZSBjYXBhYmlsaXRpZXMuXG4gICAgICAgICAgICovXG4gICAgICAgICAgaWYgKGZpeGVkUXVlcnkub3JkZXJCeUZpZWxkcz8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGV0IG1hdGNoU3RhdE9yZGVyQnkgPSBmYWxzZVxuICAgICAgICAgICAgaWYgKGNhcC5zdXBwb3J0c09yZGVyQnkpIHtcbiAgICAgICAgICAgICAgaWYgKGNhcC5zdXBwb3J0c09yZGVyQnlPbmx5T25MYXllckZpZWxkcykgeyAvLyBvbmx5IHN1cHBvcnQgb3JkZXIgYnkgZmllbGRzIHRvIGJlIGxheWVyIGZpZWxkcywgY2FuIG5vdCB1c2Ugb3V0IHN0YXRpc3RpYyBuYW1lIGFzIG9yZGVyIGJ5IGZpZWxkc1xuICAgICAgICAgICAgICAgIGNvbnN0IHVzZU91dFN0YXROYW1lQXNPcmRlckJ5ID0gZml4ZWRRdWVyeS5vcmRlckJ5RmllbGRzLnNvbWUob0ZpZWxkID0+IHJlYWxRdWVyeS5vdXRTdGF0aXN0aWNzLm1hcChzdGF0ID0+IHN0YXQub3V0U3RhdGlzdGljRmllbGROYW1lKS5zb21lKG91dFN0YXROYW1lID0+IG9GaWVsZC5zcGxpdCgnICcpLmluY2x1ZGVzKG91dFN0YXROYW1lKSkpXG4gICAgICAgICAgICAgICAgbWF0Y2hTdGF0T3JkZXJCeSA9ICF1c2VPdXRTdGF0TmFtZUFzT3JkZXJCeVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1hdGNoU3RhdE9yZGVyQnkgPSB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbWF0Y2hTdGF0T3JkZXJCeSkge1xuICAgICAgICAgICAgICBmaXhlZFF1ZXJ5ID0gZml4ZWRRdWVyeS53aXRob3V0KCdvcmRlckJ5RmllbGRzJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogVGhlIHJlc3VsdCBvbmx5IGNvbnRhaW5zIG9uZSByZWNvcmQuXG4gICAgICAgICAgICovXG4gICAgICAgICAgZml4ZWRRdWVyeSA9IHJlYWxRdWVyeS53aXRob3V0KCdwYWdlJykud2l0aG91dCgncGFnZVNpemUnKS53aXRob3V0KCdvcmRlckJ5RmllbGRzJylcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZG9RdWVyeUJ5Q2FwYWJpbGl0aWVzKGZpeGVkUXVlcnkpXG4gICAgICAgIHJlc3VsdCA9IHRoaXMuZW5oYW5jZVN0YXRpc3RpY1F1ZXJ5UmVzdWx0KHJlc3VsdCwgZml4ZWRRdWVyeSwgb3JpZ2luUXVlcnlXaXRoT3RoZXJRdWVyaWVzSW5EcylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVycm9yTXNnID0gJ0RvIG5vdCBzdXBwb3J0IHN0YXRpc3RpYyBxdWVyeS4nXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG1hdGNoT3JkZXJCeSA9IHJlYWxRdWVyeS5vcmRlckJ5RmllbGRzPy5sZW5ndGggPiAwID8gY2FwLnN1cHBvcnRzT3JkZXJCeSA6IHRydWVcbiAgICAgIGNvbnN0IG1hdGNoRGlzdGluY3QgPSByZWFsUXVlcnkucmV0dXJuRGlzdGluY3RWYWx1ZXMgPyBjYXAuc3VwcG9ydHNEaXN0aW5jdCAmJiAhIXJlYWxRdWVyeS5vdXRGaWVsZHMgOiB0cnVlXG4gICAgICBpZiAobWF0Y2hPcmRlckJ5ICYmIG1hdGNoRGlzdGluY3QpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hQYWdpbmF0aW9uID0gY2FwLnN1cHBvcnRzUGFnaW5hdGlvblxuICAgICAgICBjb25zdCBtYXRjaFBhZ2luYXRpb25XaXRoRGlzdGluY3QgPSByZWFsUXVlcnkucmV0dXJuRGlzdGluY3RWYWx1ZXMgPyBjYXAuc3VwcG9ydHNQYWdpbmF0aW9uT25EaXN0aW5jdCA6IHRydWVcbiAgICAgICAgaWYgKG1hdGNoUGFnaW5hdGlvbiAmJiBtYXRjaFBhZ2luYXRpb25XaXRoRGlzdGluY3QpIHtcbiAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmRvUXVlcnlCeUNhcGFiaWxpdGllcyhyZWFsUXVlcnkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlYWxRdWVyeS5yZXR1cm5EaXN0aW5jdFZhbHVlcykge1xuICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5kb1F1ZXJ5QnlDYXBhYmlsaXRpZXMocmVhbFF1ZXJ5LndpdGhvdXQoJ3BhZ2UnKS53aXRob3V0KCdwYWdlU2l6ZScpKVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBGb3IgZGlzdGluY3QgcXVlcnkgd2hpY2ggc2VydmljZSBkb2VzIG5vdCBzdXBwb3J0IHBhZ2luYXRpb24sIHdlIGNhbiBvbmx5IHF1ZXJ5IG9uZSBwYWdlLlxuICAgICAgICAgICAgICogVG8gZmluZCBvdGhlciByZWNvcmRzLCBwbGVhc2UgdXNlIHRoZSBgd2hlcmVgIHF1ZXJ5IHBhcmFtZXRlciB0byBuYXJyb3cgdGhlIHJlc3VsdHMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHJlc3VsdC5xdWVyeVBhcmFtcyA9IHJlYWxRdWVyeS5zZXQoJ3BhZ2UnLCAxKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmRvUXVlcnlXaXRob3V0UGFnaW5hdGlvbihyZWFsUXVlcnkpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIW1hdGNoT3JkZXJCeSkge1xuICAgICAgICAgIGVycm9yTXNnID0gJ0RvIG5vdCBzdXBwb3J0IG9yZGVyQnkuJ1xuICAgICAgICB9IGVsc2UgaWYgKCFtYXRjaERpc3RpbmN0KSB7XG4gICAgICAgICAgaWYgKCFjYXAuc3VwcG9ydHNEaXN0aW5jdCkge1xuICAgICAgICAgICAgZXJyb3JNc2cgPSAnRG8gbm90IHN1cHBvcnQgZGlzdGluY3QuJ1xuICAgICAgICAgIH0gZWxzZSBpZiAoIXJlYWxRdWVyeS5vdXRGaWVsZHMpIHtcbiAgICAgICAgICAgIGVycm9yTXNnID0gJ291dEZpZWxkcyBzaG91bGQgYmUgc3BlY2lmaWVkIGZvciByZXR1cm5EaXN0aW5jdFZhbHVlcy4nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYFVuYWJsZSB0byBwZXJmb3JtIHF1ZXJ5LiBQbGVhc2UgY2hlY2sgeW91ciBwYXJhbWV0ZXJzLiAke2Vycm9yTXNnfWApXG4gICAgfVxuICB9XG5cbiAgYXBwbHlVc2VkRmllbGRzIChxdWVyeTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMsIHVzZWRGaWVsZHM6IHN0cmluZ1tdIHwgJyonKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMge1xuICAgIC8qKlxuICAgICAqIElmIG5vIHVzZWQgZmllbGRzIG9yIGlzIHN0YXRpc3RpYyBxdWVyeSwgZG8gbm90IGNoYW5nZSBxdWVyeS5cbiAgICAgKi9cbiAgICBpZiAoIXVzZWRGaWVsZHMgfHwgcXVlcnk/Lm91dFN0YXRpc3RpY3MpIHtcbiAgICAgIHJldHVybiBxdWVyeVxuICAgIH1cblxuICAgIGNvbnN0IHEgPSB7IC4uLnF1ZXJ5IH1cbiAgICAvKipcbiAgICAgKiAxLiBMb2FkIHVzZWQgZmllbGRzLlxuICAgICAqL1xuICAgIGlmICghcS5yZXR1cm5EaXN0aW5jdFZhbHVlcyAmJiB1c2VkRmllbGRzKSB7XG4gICAgICBxLm91dEZpZWxkcyA9IHR5cGVvZiB1c2VkRmllbGRzID09PSAnc3RyaW5nJyA/IFt1c2VkRmllbGRzXSA6IHVzZWRGaWVsZHNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAyLiBMb2FkIGlkIGZpZWxkLlxuICAgICAqIEFkZCBpZCBmaWVsZCBhdXRvbWF0aWNhbGx5IHdoZW4gbG9hZGluZyBtaXNzaW5nIGZpZWxkcy4gTWlzc2luZyBmaWVsZHMgbWF5IG9ubHkgdGhlIGRpZmYgYmV0d2VlbiBsb2FkZWQgZmllbGRzIGFuZCB1c2VkIGZpZWxkcy5cbiAgICAgKi9cbiAgICBpZiAoIXEucmV0dXJuRGlzdGluY3RWYWx1ZXMgJiYgcS5vdXRGaWVsZHMgJiYgIXEub3V0RmllbGRzLmluY2x1ZGVzKCcqJykpIHtcbiAgICAgIGNvbnN0IGppbXVJZEZpZWxkID0gdGhpcy5nZXRJZEZpZWxkKClcbiAgICAgIGlmIChqaW11SWRGaWVsZCAmJiAhcS5vdXRGaWVsZHMuaW5jbHVkZXMoamltdUlkRmllbGQpKSB7XG4gICAgICAgIHEub3V0RmllbGRzID0gcS5vdXRGaWVsZHMuY29uY2F0KGppbXVJZEZpZWxkKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDMuIExvYWQgdHlwZSBpZCBmaWVsZC5cbiAgICAgKiBBZGQgdHlwZSBpZCBmaWVsZCBhdXRvbWF0aWNhbGx5IHdoZW4gbG9hZGluZyBtaXNzaW5nIGZpZWxkcy4gTWlzc2luZyBmaWVsZHMgbWF5IG9ubHkgdGhlIGRpZmYgYmV0d2VlbiBsb2FkZWQgZmllbGRzIGFuZCB1c2VkIGZpZWxkcy5cbiAgICAgKiBQbGVhc2Ugbm90ZSwgZG9lc24ndCBjaGVjayByZXR1cm5EaXN0aW5jdFZhbHVlcyBoZXJlIGJlY2F1c2UgU1FMIGV4cHJlc3Npb24gYnVpbGRlciBuZWVkcyB0eXBlIGlkIGZpZWxkIGJ1dCB3b24ndCBzZXQgaXQgdG8gb3V0RmllbGRzIHdoZW4gcXVlcnkgdW5pcXVlIHZhbHVlLlxuICAgICAqL1xuICAgIGlmIChxLm91dEZpZWxkcyAmJiAhcS5vdXRGaWVsZHMuaW5jbHVkZXMoJyonKSkge1xuICAgICAgY29uc3Qgb3JpZ2luVHlwZUlkRmllbGQgPSB0aGlzLmdldExheWVyRGVmaW5pdGlvbigpPy50eXBlSWRGaWVsZFxuICAgICAgY29uc3QgamltdVR5cGVJZEZpZWxkID0gdGhpcy5maW5kSmltdUZpZWxkTmFtZShvcmlnaW5UeXBlSWRGaWVsZClcbiAgICAgIGlmIChqaW11VHlwZUlkRmllbGQgJiYgIXEub3V0RmllbGRzLmluY2x1ZGVzKGppbXVUeXBlSWRGaWVsZCkpIHtcbiAgICAgICAgcS5vdXRGaWVsZHMgPSBxLm91dEZpZWxkcy5jb25jYXQoamltdVR5cGVJZEZpZWxkKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBxXG4gIH1cblxuICBnZXRBbGxVc2VkRmllbGRzIChvcHRpb25zPzogRmVhdHVyZUxheWVyVXNlZEZpZWxkc09wdGlvbnMpOiBzdHJpbmdbXSB8ICcqJyB7XG4gICAgaWYgKG9wdGlvbnM/LmxvZ0xldmVsID09PSAnZGVidWcnKSB7XG4gICAgICBjb25zb2xlLmdyb3VwKCdBbGwgdXNlZCBmaWVsZHMnKVxuICAgIH1cblxuICAgIGNvbnN0IHF1ZXJ5ID0gb3B0aW9ucz8ucXVlcnlQYXJhbXNcbiAgICBsZXQgdXNlZEZpZWxkczogc3RyaW5nW10gfCAnKicgPSBxdWVyeT8ub3V0RmllbGRzPy5pbmNsdWRlcygnKicpID8gJyonIDogKHF1ZXJ5Py5vdXRGaWVsZHMgfHwgW10pXG5cbiAgICAvKipcbiAgICAgKiBJZiBkbyBub3QgcXVlcnkgdW5pcXVlIHZhbHVlcywgd2lsbCBtZXJnZSB1c2VkIGZpZWxkcyBpbiBxdWVyeSBwYXJhbXMgYW5kIHVzZWQgZmllbGRzIGluIHdpZGdldCBqc29uLlxuICAgICAqIElmIHF1ZXJ5IHVuaXF1ZSB2YWx1ZXMsIHdpbGwgdXNlIHVzZWQgZmllbGRzIGluIHF1ZXJ5IHBhcm1hcyBkaXJlY3RseS5cbiAgICAgKi9cbiAgICBpZiAoIXF1ZXJ5Py5yZXR1cm5EaXN0aW5jdFZhbHVlcykge1xuICAgICAgY29uc3QgdXNlZEZpZWxkc0luUXVlcnlQYXJhbXMgPSBkYXRhU291cmNlVXRpbHMuZ2V0VXNlZEZpZWxkc0Zyb21GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyhxdWVyeSwgdGhpcywgJ2ZlYXR1cmUnKVxuXG4gICAgICBpZiAob3B0aW9ucz8ubG9nTGV2ZWwgPT09ICdkZWJ1ZycpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1F1ZXJ5IHBhcmFtcyB1c2VkIGZpZWxkcyBhcmU6JywgdXNlZEZpZWxkc0luUXVlcnlQYXJhbXMpXG4gICAgICB9XG5cbiAgICAgIGlmICh1c2VkRmllbGRzSW5RdWVyeVBhcmFtcy5pbmNsdWRlcygnKicpKSB7XG4gICAgICAgIHVzZWRGaWVsZHMgPSAnKidcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHVzZWRGaWVsZHNJbkNvbmZpZ0FuZE9uRGVtYW5kID0gc3VwZXIuZ2V0QWxsVXNlZEZpZWxkcyhvcHRpb25zKVxuICAgICAgICB1c2VkRmllbGRzID0gdXNlZEZpZWxkc0luQ29uZmlnQW5kT25EZW1hbmQgPT09ICcqJyA/ICcqJyA6IEFycmF5LmZyb20obmV3IFNldChbLi4udXNlZEZpZWxkc0luQ29uZmlnQW5kT25EZW1hbmQsIC4uLnVzZWRGaWVsZHNJblF1ZXJ5UGFyYW1zXSkpXG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogQWRkIGlkIGZpZWxkLlxuICAgICAgICovXG4gICAgICBjb25zdCBqaW11SWRGaWVsZCA9IHRoaXMuZ2V0SWRGaWVsZCgpXG4gICAgICBpZiAoamltdUlkRmllbGQgJiYgdXNlZEZpZWxkcyAhPT0gJyonICYmICF1c2VkRmllbGRzLmluY2x1ZGVzKGppbXVJZEZpZWxkKSkge1xuICAgICAgICB1c2VkRmllbGRzLnB1c2goamltdUlkRmllbGQpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHR5cGUgaWQgZmllbGQuXG4gICAgICogTG9hZCB0eXBlIGlkIGZpZWxkIGV2ZW4gaWYgcmV0dXJuRGlzdGluY3RWYWx1ZXMgaXMgdHJ1ZSwgaXQgaXMgYnkgZGVzaWduLlxuICAgICAqIFN0aWxsIG5lZWQgdG8gZ2V0IHR5cGUgaWQgZmllbGQgdmFsdWVzIHRvIGdldCBkb21haW4gZmllbGRzIHJlc29sdmVkIGV2ZW4gaWYgd2lkZ2V0cyB3YW50IHRvIGdldCB1bmlxdWUgdmFsdWVzLlxuICAgICAqL1xuICAgIGNvbnN0IG9yaWdpblR5cGVJZEZpZWxkID0gdGhpcy5nZXRMYXllckRlZmluaXRpb24oKT8udHlwZUlkRmllbGRcbiAgICBjb25zdCBqaW11VHlwZUlkRmllbGQgPSB0aGlzLmZpbmRKaW11RmllbGROYW1lKG9yaWdpblR5cGVJZEZpZWxkKVxuICAgIGlmIChqaW11VHlwZUlkRmllbGQgJiYgdXNlZEZpZWxkcyAhPT0gJyonICYmICF1c2VkRmllbGRzLmluY2x1ZGVzKGppbXVUeXBlSWRGaWVsZCkpIHtcbiAgICAgIHVzZWRGaWVsZHMucHVzaChqaW11VHlwZUlkRmllbGQpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgdXNlZCBmaWVsZHMgYXJlIG5vdCAqIGJ1dCBpbmNsdWRlIGFsbCBmaWVsZHMgaW4gc2NoZW1hLCBjaGFuZ2UgaXQgdG8gKi5cbiAgICAgKi9cbiAgICBpZiAodXNlZEZpZWxkcyAhPT0gJyonICYmIHVzZWRGaWVsZHMubGVuZ3RoID09PSBPYmplY3Qua2V5cyh0aGlzLmdldFNjaGVtYSgpLmZpZWxkcykubGVuZ3RoKSB7XG4gICAgICBpZiAob3B0aW9ucz8ubG9nTGV2ZWwgPT09ICdkZWJ1ZycpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdBbGwgdXNlZCBmaWVsZHMgYXJlICogc2luY2UgdXNlZCBmaWVsZHMgbGVuZ3RoIGVxdWFscyBzY2hlbWEgZmllbGRzIGxlbmd0aC4nKVxuICAgICAgfVxuICAgICAgdXNlZEZpZWxkcyA9ICcqJ1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zPy5sb2dMZXZlbCA9PT0gJ2RlYnVnJykge1xuICAgICAgY29uc29sZS5sb2coJ0FsbCB1c2VkIGZpZWxkcyBhcmU6JywgdXNlZEZpZWxkcylcbiAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKVxuICAgIH1cblxuICAgIHJldHVybiB1c2VkRmllbGRzXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRvUXVlcnlXaXRob3V0UGFnaW5hdGlvbiAocXVlcnk6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgLy8gR2V0IG9iamVjdCBpZHMgd2hpY2ggbWF0Y2ggdGhlIHF1ZXJ5IHBhcmFtcy5cbiAgICBjb25zdCBxdWVyeUJ5Q2FwYWJpbGl0aWVzID0gcXVlcnkud2l0aG91dCgncGFnZScpLndpdGhvdXQoJ3BhZ2VTaXplJykuc2V0KCdyZXR1cm5JZHNPbmx5JywgdHJ1ZSlcbiAgICBjb25zdCBvYmplY3RJZHNRdWVyeVJlc3VsdCA9IGF3YWl0IHRoaXMuZG9RdWVyeUJ5Q2FwYWJpbGl0aWVzKHF1ZXJ5QnlDYXBhYmlsaXRpZXMpXG4gICAgY29uc3QgbWF0Y2hlZE9iamVjdElkcyA9IG9iamVjdElkc1F1ZXJ5UmVzdWx0LnJlY29yZHM/Lm1hcChyID0+ICtyLmdldElkKCkpPy5maWx0ZXIoaWQgPT4gIWlzTmFOKGlkKSkgfHwgW11cblxuICAgIC8vIEdldCBvYmplY3QgaWRzIHdoaWNoIG1hdGNoIHRoZSBwYWdlIGFuZCB0aGUgcGFnZVNpemUuXG4gICAgY29uc3QgcGFnZSA9IHR5cGVvZiBxdWVyeS5wYWdlID09PSAnbnVtYmVyJyA/IHF1ZXJ5LnBhZ2UgOiAxXG4gICAgY29uc3QgcGFnZVNpemUgPSB0eXBlb2YgcXVlcnkucGFnZVNpemUgPT09ICdudW1iZXInID8gcXVlcnkucGFnZVNpemUgOiB0aGlzLmdldFF1ZXJ5UGFnZVNpemUoKVxuICAgIGNvbnN0IG9iamVjdElkcyA9IHRoaXMuc2xpY2VCeVBhZ2UobWF0Y2hlZE9iamVjdElkcywgcGFnZVNpemUsIHBhZ2UpXG5cbiAgICBpZiAob2JqZWN0SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHsgcXVlcnlQYXJhbXM6IHF1ZXJ5LCByZWNvcmRzOiBbXSwgY291bnQ6IDAgfVxuICAgIH1cbiAgICAvLyBRdWVyeSByZWNvcmRzIGJ5IG9iamVjdCBpZHMuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5kb1F1ZXJ5QnlDYXBhYmlsaXRpZXMoSW1tdXRhYmxlKHsgb2JqZWN0SWRzLCBvdXRGaWVsZHM6IHF1ZXJ5Lm91dEZpZWxkcz8uYXNNdXRhYmxlKCkgfHwgWycqJ10sIHJldHVybkdlb21ldHJ5OiBxdWVyeS5yZXR1cm5HZW9tZXRyeSB9KSlcbiAgICByZXN1bHQucXVlcnlQYXJhbXMgPSBxdWVyeVxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIC8qKlxuICAgKiBgcXVlcnlCeUNhcGFiaWxpdGllc2Agc2hvdWxkIG1hdGNoIGNhcGFiaWxpdGllcyBvZiB0aGUgc291cmNlIChBR09ML3BvcnRhbCBpdGVtIG9yIGEgcmVtb3RlIGRhdGFiYXNlKSBvZiB0aGUgY3VycmVudCBkYXRhIHNvdXJjZS5cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZG9RdWVyeUJ5Q2FwYWJpbGl0aWVzIChxdWVyeUJ5Q2FwYWJpbGl0aWVzOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIGxldCByZXN1bHQ6IFF1ZXJ5UmVzdWx0ID0geyBxdWVyeVBhcmFtczogcXVlcnlCeUNhcGFiaWxpdGllcywgcmVjb3JkczogW10sIHNvdXJjZVZlcnNpb246IHRoaXMuZ2V0U291cmNlVmVyc2lvbigpIH1cbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIG9mIHVzZSBsYXllci5xdWVyeSB3aGVuIGhhcyBsYXllciBpczpcbiAgICAgKiAxIHNvbWUgbGF5ZXIgZG9lcyBub3QgaGF2ZSB1cmw6XG4gICAgICogICAxLjEgZmVhdHVyZSBjb2xsZWN0aW9uIGl0ZW0sIHJlY29yZHMgYXJlIHNhdmVkIGluIGl0ZW0uXG4gICAgICogICAxLjIgc291cmNlIHJlY29yZHMgcGFzc2VkIHRvIGN1cnJlbnQgZGF0YSBzb3VyY2UgZGlyZWN0bHkuXG4gICAgICogMiBmZWF0dXJlcyByZXR1cm5lZCBmcm9tIGxheWVyLnF1ZXJ5KCkgaGF2ZSBzeW1ib2wgb2JqZWN0XG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBJZiBoYXMgc291cmNlIHJlY29yZHMsIHVzZSB0aGVzZSByZWNvcmRzIHRvIGNyZWF0ZSBhIEpTIEFQSSBmZWF0dXJlIGxheWVyIHRvIGRvIHF1ZXJ5LlxuICAgICAqL1xuICAgIGlmICh0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuaXNEYXRhSW5EYXRhU291cmNlSW5zdGFuY2UpIHtcbiAgICAgIGlmICh0aGlzLmdldFNvdXJjZVJlY29yZHMoKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IHNvdXJjZVJlY29yZHMgPSB0aGlzLmdldFNvdXJjZVJlY29yZHMoKSBhcyBGZWF0dXJlRGF0YVJlY29yZFtdXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBxdWVyeSBwYXJhbXMgaXMgZW1wdHksIG5vIG5lZWQgdG8gbG9hZCBKUyBBUEkgdG8gY3JlYXRlIGxheWVyLlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHRoaXMuaXNRdWVyeVBhcmFtc0VtcHR5KHF1ZXJ5QnlDYXBhYmlsaXRpZXMpKSB7XG4gICAgICAgICAgcmVzdWx0ID0geyBxdWVyeVBhcmFtczogcXVlcnlCeUNhcGFiaWxpdGllcywgcmVjb3Jkczogc291cmNlUmVjb3Jkcywgc291cmNlVmVyc2lvbjogdGhpcy5nZXRTb3VyY2VWZXJzaW9uKCkgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IGRhdGFTb3VyY2VVdGlscy5jcmVhdGVGZWF0dXJlTGF5ZXJCeVJlY29yZHModGhpcywgc291cmNlUmVjb3JkcywgdGhpcy5nZXRTb3VyY2VWZXJzaW9uKCkpLnRoZW4oYXN5bmMgKHsgbGF5ZXIsIHNvdXJjZVZlcnNpb24gfSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IGF3YWl0IHRoaXMuZG9RdWVyeUJ5TGF5ZXJDYXBhYmlsaXRpZXMocXVlcnlCeUNhcGFiaWxpdGllcywgbGF5ZXIpXG4gICAgICAgICAgICByZXR1cm4geyAuLi5yLCBzb3VyY2VWZXJzaW9uIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLmxheWVyKSB7IC8vIElmIGhhcyBhIEpTIEFQSSBmZWF0dXJlIGxheWVyLCB1c2UgdGhlIGxheWVyIHRvIGRvIHF1ZXJ5LlxuICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5kb1F1ZXJ5QnlMYXllckNhcGFiaWxpdGllcyhxdWVyeUJ5Q2FwYWJpbGl0aWVzLCB0aGlzLmxheWVyKVxuICAgIH0gZWxzZSBpZiAodGhpcy51cmwpIHsgLy8gSWYgaGFzIHVybCwgdXNlIHRoZSB1cmwgKHZpYSBSRVNUIEFQSSBkaXJlY3RseSkgdG8gZG8gcXVlcnkuXG4gICAgICBjb25zdCBmb3JtYXQgPSB0aGlzLmdldENhcGFiaWxpdGllcygpLmdldFF1ZXJ5Q2FwYWJpbGl0aWVzKCkuc3VwcG9ydGVkUXVlcnlGb3JtYXRzPy50b0xvd2VyQ2FzZT8uKCk/LmluY2x1ZGVzKCdwYmYnKSA/ICdwYmYnIDogJ2pzb24nXG4gICAgICAvKipcbiAgICAgICAqIElmIHNob3VsZCB1c2UgcGJmIGZvcm1hdCAtXG4gICAgICAgKiAgMS4gaWYgZG8gbm90IGhhdmUgbGF5ZXIgZm9yIHJlc3QgcXVlcnksIHVzZSB1cmwgdG8gZG8gcXVlcnksIGF0IHRoZSBzYW1lIHRpbWUsIGNyZWF0ZSBhIGxheWVyIGZvciByZXN0IHF1ZXJ5LlxuICAgICAgICogIDIuIGlmIGhhdmUgbGF5ZXIgZm9yIHJlc3QgcXVlcnksIHVzZSB0aGUgbGF5ZXIgdG8gZG8gcXVlcnkuXG4gICAgICAgKi9cbiAgICAgIGlmIChmb3JtYXQgPT09ICdwYmYnICYmIHRoaXMubGF5ZXJGb3JSZXN0UXVlcnkpIHtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5kb1F1ZXJ5QnlMYXllckNhcGFiaWxpdGllcyhxdWVyeUJ5Q2FwYWJpbGl0aWVzLCB0aGlzLmxheWVyRm9yUmVzdFF1ZXJ5KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5kb1F1ZXJ5QnlVcmxDYXBhYmlsaXRpZXMocXVlcnlCeUNhcGFiaWxpdGllcywgdGhpcy51cmwpXG4gICAgICB9XG4gICAgICBpZiAoZm9ybWF0ID09PSAncGJmJyAmJiAhdGhpcy5sYXllckZvclJlc3RRdWVyeSkge1xuICAgICAgICB0aGlzLmNyZWF0ZUxheWVyRm9yUmVzdFF1ZXJ5KClcbiAgICAgIH1cbiAgICB9IGVsc2UgeyAvLyBVc2UgaXRlbSBpZCB0byBjcmVhdGUgYSBKUyBBUEkgZmVhdHVyZSBsYXllciB0byBkbyBxdWVyeS5cbiAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuY3JlYXRlTGF5ZXJCeUl0ZW1JZCgpLnRoZW4obGF5ZXIgPT4gdGhpcy5kb1F1ZXJ5QnlMYXllckNhcGFiaWxpdGllcyhxdWVyeUJ5Q2FwYWJpbGl0aWVzLCBsYXllcikpXG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgY3JlYXRlTGF5ZXJGb3JSZXN0UXVlcnkgKCkge1xuICAgIC8qKlxuICAgICAqIEFsbCBkYXRhIHZpZXdzIGFuZCBsb2NhbCBkYXRhIHNvcnVjZXMgc2hhcmUgdGhlIHNhbWUgbGF5ZXIgdG8gZG8gcmVzdCBxdWVyeS5cbiAgICAgKi9cbiAgICBpZiAodGhpcy5pc0RhdGFWaWV3IHx8IHRoaXMuaXNMb2NhbCkge1xuICAgICAgKHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbCkuY3JlYXRlTGF5ZXJGb3JSZXN0UXVlcnkoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmICghdGhpcy5sYXllckZvclJlc3RRdWVyeVByb21pc2UpIHtcbiAgICAgIHRoaXMubGF5ZXJGb3JSZXN0UXVlcnlQcm9taXNlID0gZGF0YVNvdXJjZVV0aWxzLmNyZWF0ZUpTQVBJTGF5ZXJCeURhdGFTb3VyY2UodGhpcywgZmFsc2UpIGFzIFByb21pc2U8X19lc3JpLkZlYXR1cmVMYXllcj5cbiAgICB9XG4gICAgdGhpcy5sYXllckZvclJlc3RRdWVyeVByb21pc2UudGhlbigobGF5ZXI6IF9fZXNyaS5GZWF0dXJlTGF5ZXIpID0+IHtcbiAgICAgIHRoaXMubGF5ZXJGb3JSZXN0UXVlcnkgPSBsYXllclxuICAgICAgdGhpcy5nZXRBbGxEZXJpdmVkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKChkczogRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGwpID0+IHtcbiAgICAgICAgZHMubGF5ZXJGb3JSZXN0UXVlcnkgPSBsYXllclxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBpc1F1ZXJ5UGFyYW1zRW1wdHkgKHF1ZXJ5UGFyYW1zOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogYm9vbGVhbiB7XG4gICAgaWYgKCFxdWVyeVBhcmFtcykge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICAvLyBXZSBzaG91bGQgYWx3YXlzIHJldHVybiBnZW9tZXRyeSBzaW5jZSBzcGF0aWFsIHF1ZXJ5IG5lZWRzIGl0LlxuICAgIGNvbnN0IHEgPSBxdWVyeVBhcmFtcy53aXRob3V0KCdwYWdlJykud2l0aG91dCgncGFnZVNpemUnKS53aXRob3V0KCdyZXR1cm5HZW9tZXRyeScpLndpdGhvdXQoJ3JldHVyblonKS53aXRob3V0KCdzcWxFeHByZXNzaW9uJykud2l0aG91dCgnb3V0RmllbGRzJylcblxuICAgIGNvbnN0IGlzRW1wdHkgPSBPYmplY3Qua2V5cyhxKS5sZW5ndGggPT09IDBcbiAgICBpZiAoaXNFbXB0eSkge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICAvLyByZW1vdmUgJyAnLCAnKCcgYW5kICcpJ1xuICAgIGNvbnN0IHRyaW1XaGVyZSA9IHR5cGVvZiBxLndoZXJlID09PSAnc3RyaW5nJyA/IHEud2hlcmUucmVwbGFjZSgvXFxzKy9nLCAnJykucmVwbGFjZSgvXFwoL2csICcnKS5yZXBsYWNlKC9cXCkvZywgJycpIDogbnVsbFxuICAgIGNvbnN0IGVtcHR5V2hlcmVzID0gWycnLCAnMT0xJ11cbiAgICBjb25zdCBpc09ubHlFbXB0eVdoZXJlID0gT2JqZWN0LmtleXMocSkubGVuZ3RoID09PSAxICYmIGVtcHR5V2hlcmVzLnNvbWUodyA9PiB3ID09PSB0cmltV2hlcmUpXG4gICAgcmV0dXJuIGlzT25seUVtcHR5V2hlcmVcbiAgfVxuXG4gIC8qKlxuICAgKiBTb21lIHN0YXRpc3RpYyBxdWVyeSBwYXJhbXMgYXJlIG5vdCBzdXBwb3J0ZWQgYWNjb3JkaW5nIHRvIHRoZSBmZWF0dXJlIHNlcnZpY2UgY2FwYWJpbGl0eS4gU2VlIGh0dHBzOi8vZGV2ZWxvcGVycy5hcmNnaXMuY29tL3Jlc3Qvc2VydmljZXMtcmVmZXJlbmNlL3F1ZXJ5LWZlYXR1cmUtc2VydmljZS1sYXllci0uaHRtLlxuICAgKiBXZSB3aWxsIHJlbW92ZSB0aGVzZSBxdWVyeSBwYXJhbXMgYmVmb3JlIHNlbmRpbmcgcXVlcnkgcmVxdWVzdC4gU2VlIGBkb1F1ZXJ5YCBtZXRob2QuXG4gICAqIEhvd2V2ZXIsIHdlIGNhbiBlbmhhbmNlIHRoZSByZXN1bHQgYWZ0ZXIgdGhlIHF1ZXJ5IHJlcXVlc3QgaXMgYmFjay5cbiAgICpcbiAgICogRm9yIGV4YW1wbGUsIGlmIGBzdXBwb3J0c09yZGVyQnlPbmx5T25MYXllckZpZWxkc2AgaXMgdHJ1ZSwgb25seSBmaWVsZHMgZnJvbSB0aGUgbGF5ZXIncyBmaWVsZHMgYXJyYXkgY2FuIGJlIHVzZWQgd2l0aCB0aGUgYG9yZGVyQnlGaWVsZHNgIHBhcmFtZXRlcixcbiAgICogdGhlIGBvdXRTdGF0aXN0aWNmaWVsZE5hbWVgIGZyb20gb3V0U3RhdGlzdGljcyBjYW4ndCBiZSB1c2VkLiBJbiB0aGUgY2FzZSwgZGF0YSBzb3VyY2UgY2FuIGhlbHAgdG8gc29ydCB0aGUgcmVjb3JkcyBhbmQgcmV0dXJuIGFuIGV4cGVjdGVkIHJlc3VsdC5cbiAgICovXG4gIHByaXZhdGUgZW5oYW5jZVN0YXRpc3RpY1F1ZXJ5UmVzdWx0IChxdWVyeVJlc3VsdDogUXVlcnlSZXN1bHQsIHJlYWxRdWVyeTogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgb3JpZ2luUXVlcnlXaXRoT3RoZXJRdWVyaWVzSW5EczogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk6IFF1ZXJ5UmVzdWx0IHtcbiAgICBsZXQgZml4ZWRSZWNvcmRzID0gcXVlcnlSZXN1bHQucmVjb3Jkcz8uc2xpY2UoKSBhcyBGZWF0dXJlRGF0YVJlY29yZFtdXG4gICAgaWYgKCFmaXhlZFJlY29yZHMpIHtcbiAgICAgIHJldHVybiBxdWVyeVJlc3VsdFxuICAgIH1cblxuICAgIGxldCBmaXhlZFF1ZXJ5UGFyYW1zID0gcXVlcnlSZXN1bHQucXVlcnlQYXJhbXMgYXMgSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtc1xuICAgIGlmIChvcmlnaW5RdWVyeVdpdGhPdGhlclF1ZXJpZXNJbkRzPy5vdXRTdGF0aXN0aWNzKSB7XG4gICAgICBpZiAob3JpZ2luUXVlcnlXaXRoT3RoZXJRdWVyaWVzSW5Ecy5vcmRlckJ5RmllbGRzICYmICFyZWFsUXVlcnk/Lm9yZGVyQnlGaWVsZHMpIHtcbiAgICAgICAgZml4ZWRSZWNvcmRzID0gZml4ZWRSZWNvcmRzLmxlbmd0aCA+IDEgPyB0aGlzLnNvcnRSZWNvcmRzQnlGaWVsZHMoZml4ZWRSZWNvcmRzLCBvcmlnaW5RdWVyeVdpdGhPdGhlclF1ZXJpZXNJbkRzLm9yZGVyQnlGaWVsZHMpIDogZml4ZWRSZWNvcmRzXG4gICAgICAgIGZpeGVkUXVlcnlQYXJhbXMgPSBmaXhlZFF1ZXJ5UGFyYW1zLnNldCgnb3JkZXJCeUZpZWxkcycsIG9yaWdpblF1ZXJ5V2l0aE90aGVyUXVlcmllc0luRHMub3JkZXJCeUZpZWxkcylcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2Ygb3JpZ2luUXVlcnlXaXRoT3RoZXJRdWVyaWVzSW5Ecy5wYWdlU2l6ZSA9PT0gJ251bWJlcicgJiYgdHlwZW9mIHJlYWxRdWVyeT8ucGFnZVNpemUgIT09ICdudW1iZXInKSB7XG4gICAgICAgIGNvbnN0IHBhZ2UgPSBvcmlnaW5RdWVyeVdpdGhPdGhlclF1ZXJpZXNJbkRzLnBhZ2UgPz8gMVxuICAgICAgICBmaXhlZFJlY29yZHMgPSB0aGlzLnNsaWNlQnlQYWdlKGZpeGVkUmVjb3Jkcywgb3JpZ2luUXVlcnlXaXRoT3RoZXJRdWVyaWVzSW5Ecy5wYWdlU2l6ZSwgcGFnZSlcbiAgICAgICAgZml4ZWRRdWVyeVBhcmFtcyA9IGZpeGVkUXVlcnlQYXJhbXMuc2V0KCdwYWdlU2l6ZScsIG9yaWdpblF1ZXJ5V2l0aE90aGVyUXVlcmllc0luRHMucGFnZVNpemUpXG4gICAgICAgIGZpeGVkUXVlcnlQYXJhbXMgPSBmaXhlZFF1ZXJ5UGFyYW1zLnNldCgncGFnZScsIG9yaWdpblF1ZXJ5V2l0aE90aGVyUXVlcmllc0luRHMucGFnZSlcbiAgICAgIH1cbiAgICAgIGNvbnN0IG1hdGNoU3RhdE5hbWUgPSBvcmlnaW5RdWVyeVdpdGhPdGhlclF1ZXJpZXNJbkRzLm91dFN0YXRpc3RpY3MuZXZlcnkoc3RhdCA9PiAhc3RhdD8ub3V0U3RhdGlzdGljRmllbGROYW1lIHx8IGZpeGVkUmVjb3Jkcy5zb21lKHIgPT4gdHlwZW9mIHIuZ2V0RmllbGRWYWx1ZShzdGF0Lm91dFN0YXRpc3RpY0ZpZWxkTmFtZSkgIT09ICd1bmRlZmluZWQnKSlcbiAgICAgIGlmICghbWF0Y2hTdGF0TmFtZSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogU29tZSBzZXJ2aWNlcyB1c2UgbG93ZXIvdXBwZXIgY2FzZSBvZiB0aGUgb3V0U3RhdGlzdGljRmllbGROYW1lIGFzIGZpZWxkIG5hbWUgb2YgdGhlIHJldHVybmVkIGZlYXR1cmUuXG4gICAgICAgICAqL1xuICAgICAgICBvcmlnaW5RdWVyeVdpdGhPdGhlclF1ZXJpZXNJbkRzLm91dFN0YXRpc3RpY3MuZm9yRWFjaChzdGF0ID0+IHtcbiAgICAgICAgICBpZiAoc3RhdD8ub3V0U3RhdGlzdGljRmllbGROYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBpc091dFN0YXROYW1lTG93ZXJDYXNlID0gZml4ZWRSZWNvcmRzLnNvbWUociA9PiB0eXBlb2Ygci5nZXRGaWVsZFZhbHVlKHN0YXQub3V0U3RhdGlzdGljRmllbGROYW1lLnRvTG93ZXJDYXNlKCkpICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgIGNvbnN0IGlzT3V0U3RhdE5hbWVVcHBlckNhc2UgPSBmaXhlZFJlY29yZHMuc29tZShyID0+IHR5cGVvZiByLmdldEZpZWxkVmFsdWUoc3RhdC5vdXRTdGF0aXN0aWNGaWVsZE5hbWUudG9VcHBlckNhc2UoKSkgIT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAgZml4ZWRSZWNvcmRzLmZvckVhY2gociA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHJlYWxPdXRTdGF0TmFtZSA9IGlzT3V0U3RhdE5hbWVMb3dlckNhc2UgPyBzdGF0Lm91dFN0YXRpc3RpY0ZpZWxkTmFtZS50b0xvd2VyQ2FzZSgpIDogKGlzT3V0U3RhdE5hbWVVcHBlckNhc2UgPyBzdGF0Lm91dFN0YXRpc3RpY0ZpZWxkTmFtZS50b1VwcGVyQ2FzZSgpIDogbnVsbClcbiAgICAgICAgICAgICAgaWYgKHJlYWxPdXRTdGF0TmFtZSkge1xuICAgICAgICAgICAgICAgIHIuZmVhdHVyZS5hdHRyaWJ1dGVzW3N0YXQub3V0U3RhdGlzdGljRmllbGROYW1lXSA9IHIuZ2V0RmllbGRWYWx1ZShyZWFsT3V0U3RhdE5hbWUpXG4gICAgICAgICAgICAgICAgZGVsZXRlIHIuZmVhdHVyZS5hdHRyaWJ1dGVzW3JlYWxPdXRTdGF0TmFtZV1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgLi4ucXVlcnlSZXN1bHQsIHJlY29yZHM6IGZpeGVkUmVjb3JkcywgcXVlcnlQYXJhbXM6IGZpeGVkUXVlcnlQYXJhbXMgfVxuICB9XG5cbiAgcHJpdmF0ZSBzbGljZUJ5UGFnZSA8VD4ocmVjb3JkczogVFtdLCBwYWdlU2l6ZTogbnVtYmVyLCBwYWdlOiBudW1iZXIpOiBUW10ge1xuICAgIGNvbnN0IHN0YXJ0ID0gcGFnZVNpemUgKiAocGFnZSAtIDEpIC8vIGluY2x1ZGUgc3RhcnRcbiAgICBjb25zdCBlbmQgPSBzdGFydCArIHBhZ2VTaXplIC8vIG5vdCBpbmNsdWRlIGVuZFxuICAgIHJldHVybiByZWNvcmRzLnNsaWNlKHN0YXJ0LCBlbmQpXG4gIH1cblxuICBwcml2YXRlIHNvcnRSZWNvcmRzQnlGaWVsZHMgKHJlY29yZHM6IEZlYXR1cmVEYXRhUmVjb3JkW10sIG9yZGVyQnlGaWVsZHM6IEltbXV0YWJsZUFycmF5PHN0cmluZz4pOiBGZWF0dXJlRGF0YVJlY29yZFtdIHtcbiAgICBjb25zdCBzb3J0ZWRSZWNvcmRzID0gcmVjb3Jkcy5maWx0ZXIociA9PiAhIXIpLnNvcnQoKHIxLCByMikgPT4gdGhpcy5jb21wYXJlUmVjb3Jkc0J5RmllbGRzKHIxLCByMiwgb3JkZXJCeUZpZWxkcykpXG5cbiAgICByZXR1cm4gc29ydGVkUmVjb3Jkc1xuICB9XG5cbiAgcHJpdmF0ZSBjb21wYXJlUmVjb3Jkc0J5RmllbGRzIChyMTogRmVhdHVyZURhdGFSZWNvcmQsIHIyOiBGZWF0dXJlRGF0YVJlY29yZCwgb3JkZXJCeUZpZWxkczogSW1tdXRhYmxlQXJyYXk8c3RyaW5nPik6IG51bWJlciB7XG4gICAgbGV0IGluZGV4ID0gMFxuICAgIC8vIERlZmF1bHQgcmVzdWx0IGlzIDAsIHdoaWNoIG1lYW5zIGRvbid0IGNoYW5nZSB0aGUgb3JkZXIgb2YgcjEgYW5kIHIyLlxuICAgIGxldCByZXMgPSAwXG4gICAgd2hpbGUgKGluZGV4IDwgb3JkZXJCeUZpZWxkcy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGppbXVGaWVsZE5hbWUgPSBvcmRlckJ5RmllbGRzW2luZGV4XS5zcGxpdCgnICcpWzBdXG4gICAgICAvLyBBc3N1bWUgdGhhdCBvcmRlciBpcyBBU0MuXG4gICAgICBsZXQgY29tcGFyZUJ5VmFsdWUgPSAwXG4gICAgICAvLyBJZiBvcmRlcmJ5IGZpZWxkIGRvZXNuJ3QgZm9sbG93ICdmMSBBU0MnIG9yICdmMScsIHdvbid0IGNoYW5nZSBwb3NpdGlvbiBvZiByMSBhbmQgcjIuXG4gICAgICBpZiAob3JkZXJCeUZpZWxkc1tpbmRleF0uc3BsaXQoJyAnKS5sZW5ndGggPiAyKSB7XG4gICAgICAgIGNvbXBhcmVCeVZhbHVlID0gMFxuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcjEuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKSAhPT0gdHlwZW9mIHIyLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSkpIHtcbiAgICAgICAgLy8gSWYgdHlwZXMgb2YgdGhlIHR3byBmaWVsZHMgYXJlIG5vdCBzYW1lLCBwdXQgcmVjb3JkIHdoaWNoIHR5cGUgaXMgbm90IHNhbWUgd2l0aCBvcmRlcmJ5IGZpZWxkIHR5cGUgYmVmb3JlIHRoZSBvdGhlciBvbmUuXG4gICAgICAgIGNvbnN0IGppbXVGaWVsZCA9IHRoaXMuZ2V0U2NoZW1hKCk/LmZpZWxkcz8uW2ppbXVGaWVsZE5hbWVdXG4gICAgICAgIC8vIElmIHNjaGVtYSBoYXMgdGhlIG9yZGVyYnkgZmllbGQsIHVzZSBpdHMgdHlwZSwgb3IsIHRoZSBvcmRlcmJ5IGZpZWxkIGlzIHN0YXRpc3RpY3MgcXVlcnkgcmVzdWx0IGZpZWxkLCB0eXBlIGlzIG51bWJlci5cbiAgICAgICAgY29uc3QgamltdVR5cGVPZk9yZGVyQnlGaWVsZCA9IGppbXVGaWVsZD8udHlwZSB8fCBKaW11RmllbGRUeXBlLk51bWJlclxuICAgICAgICAvLyBEYXRlIGZpZWxkJ3MgdmFsdWUgaXMgYWN0dWFsbHkgbnVtYmVyLCBhZnRlciBmb3JtYXQsIHdpbGwgYmUgc3RyaW5nLlxuICAgICAgICAvLyBUT0RPOiBJZiBoYXZlIG90aGVyIHR5cGVzIG9mIGppbXUgZmllbGQgdHlwZSwgbmVlZCB0byBoYW5kbGUgdGhlbS5cbiAgICAgICAgY29uc3QgdHlwZU9mT3JkZXJCeUZpZWxkID0gamltdVR5cGVPZk9yZGVyQnlGaWVsZCA9PT0gSmltdUZpZWxkVHlwZS5TdHJpbmcgPyAnc3RyaW5nJyA6ICdudW1iZXInXG4gICAgICAgIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSAqL1xuICAgICAgICBjb25zdCByMVR5cGVJc1NhbWVXaXRoT3JkZXJCeUZpZWxkID0gdHlwZW9mIHIxLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSkgPT09IHR5cGVPZk9yZGVyQnlGaWVsZFxuICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgKi9cbiAgICAgICAgY29uc3QgcjJUeXBlSXNTYW1lV0l0aE9yZGVyQnlGaWVsZCA9IHR5cGVvZiByMi5nZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpID09PSB0eXBlT2ZPcmRlckJ5RmllbGRcbiAgICAgICAgaWYgKHIxVHlwZUlzU2FtZVdpdGhPcmRlckJ5RmllbGQgJiYgIXIyVHlwZUlzU2FtZVdJdGhPcmRlckJ5RmllbGQpIHtcbiAgICAgICAgICAvLyByMiBzaG91bGQgYmUgYmVmb3JlIHIxXG4gICAgICAgICAgY29tcGFyZUJ5VmFsdWUgPSAxXG4gICAgICAgIH0gZWxzZSBpZiAoIXIxVHlwZUlzU2FtZVdpdGhPcmRlckJ5RmllbGQgJiYgcjJUeXBlSXNTYW1lV0l0aE9yZGVyQnlGaWVsZCkge1xuICAgICAgICAgIC8vIHIxIHNob3VsZCBiZSBiZWZvcmUgcjJcbiAgICAgICAgICBjb21wYXJlQnlWYWx1ZSA9IC0xXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gZG8gbm90IGNoYW5nZSBwb3NpdGlvbiBvZiByMSBhbmQgcjJcbiAgICAgICAgICBjb21wYXJlQnlWYWx1ZSA9IDBcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHsgLy8gVHlwZXMgb2YgdGhlIHR3byBmaWVsZHMgYXJlIHRoZSBzYW1lLlxuICAgICAgICBjb25zdCB2YWx1ZU9mUjEgPSByMS5nZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpXG4gICAgICAgIGNvbnN0IHZhbHVlT2ZSMiA9IHIyLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSlcbiAgICAgICAgY29tcGFyZUJ5VmFsdWUgPSB0aGlzLmdldENvbXBhcmVWYWx1ZVJlc3VsdCh2YWx1ZU9mUjEsIHZhbHVlT2ZSMilcbiAgICAgIH1cblxuICAgICAgLy8gRGVmYXVsdCBvcmRlciBpcyBhc2NlbmRpbmcuXG4gICAgICBjb25zdCBvcmRlciA9IG9yZGVyQnlGaWVsZHNbaW5kZXhdLnNwbGl0KCcgJylbMV1cbiAgICAgIGlmIChvcmRlciA9PT0gJ0RFU0MnKSB7XG4gICAgICAgIHJlcyA9IC1jb21wYXJlQnlWYWx1ZVxuICAgICAgfSBlbHNlIHsgLy8gRGVmYXVsdCBvcmRlciBpcyAnQVNDJ1xuICAgICAgICByZXMgPSBjb21wYXJlQnlWYWx1ZVxuICAgICAgfVxuXG4gICAgICAvLyBJZiBjYW4gbm90IHNvcnQgcjEgYW5kIHIyIGFjY29yZGluZyB0byB0aGUgY3VycmVudCBmaWVsZCwgd2lsbCB0cnkgdG8gc29ydCB0aGUgdHdvIHJlY29yZHMgYnkgdGhlIG5leHQgZmllbGQuXG4gICAgICBpZiAocmVzID09PSAwKSB7XG4gICAgICAgIGluZGV4KytcbiAgICAgICAgY29udGludWVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc1xuICB9XG5cbiAgLyoqIC5cbiAgICogTmVnYXRpdmUgbnVtYmVyIG1lYW5zIHZhbHVlIG9mIHIxIHNob3VsZCBiZSBiZWZvcmUgdmFsdWUgb2YgcjIsXG4gICAqIDAgbWVhbnMgdmFsdWUgb2YgcjEgaXMgZXF1YWwgYXMgdmFsdWUgb2YgcjIsXG4gICAqIHBvc2l0aXZlIG1lYW5zIHZhbHVlIG9mIHIxIHNob3VsZCBiZSBhZnRlciB2YWx1ZSBvZiByMi5cbiAgICovXG4gIHByaXZhdGUgZ2V0Q29tcGFyZVZhbHVlUmVzdWx0ICh2MSwgdjIpOiBudW1iZXIge1xuICAgIGxldCByZXM6IG51bWJlciA9IDBcbiAgICBpZiAodHlwZW9mIHYxID09PSAnc3RyaW5nJyAmJiB0eXBlb2YgdjIgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXMgPSB2MS5sb2NhbGVDb21wYXJlID8gdjEubG9jYWxlQ29tcGFyZSh2MikgOiAwXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdjEgPT09ICdudW1iZXInICYmIHR5cGVvZiB2MiA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJlcyA9IHYxIC0gdjJcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzXG4gIH1cblxuICBhc3luYyBkb1F1ZXJ5Q291bnQgKHF1ZXJ5UGFyYW1zOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIC8qKlxuICAgICAqIFNlZSBjb21tZW50cyBpbiBkb1F1ZXJ5IG1ldGhvZC5cbiAgICAgKi9cbiAgICBpZiAodGhpcy5nZXREYXRhU291cmNlSnNvbigpLmlzRGF0YUluRGF0YVNvdXJjZUluc3RhbmNlKSB7XG4gICAgICBpZiAodGhpcy5nZXRTb3VyY2VSZWNvcmRzKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoeyBxdWVyeVBhcmFtczogcXVlcnlQYXJhbXMsIGNvdW50OiAwLCBzb3VyY2VWZXJzaW9uOiB0aGlzLmdldFNvdXJjZVZlcnNpb24oKSB9KVxuICAgICAgfVxuICAgICAgY29uc3Qgc291cmNlUmVjb3JkcyA9IHRoaXMuZ2V0U291cmNlUmVjb3JkcygpIGFzIEZlYXR1cmVEYXRhUmVjb3JkW11cbiAgICAgIC8qKlxuICAgICAgICogSWYgcXVlcnkgcGFyYW1zIGlzIGVtcHR5LCBubyBuZWVkIHRvIGxvYWQgSlMgQVBJIHRvIGNyZWF0ZSBsYXllci5cbiAgICAgICAqL1xuICAgICAgaWYgKHRoaXMuaXNRdWVyeVBhcmFtc0VtcHR5KHF1ZXJ5UGFyYW1zKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsgcXVlcnlQYXJhbXM6IHF1ZXJ5UGFyYW1zLCBjb3VudDogc291cmNlUmVjb3Jkcy5sZW5ndGgsIHNvdXJjZVZlcnNpb246IHRoaXMuZ2V0U291cmNlVmVyc2lvbigpIH0pXG4gICAgICB9XG4gICAgICByZXR1cm4gYXdhaXQgZGF0YVNvdXJjZVV0aWxzLmNyZWF0ZUZlYXR1cmVMYXllckJ5UmVjb3Jkcyh0aGlzLCBzb3VyY2VSZWNvcmRzLCB0aGlzLmdldFNvdXJjZVZlcnNpb24oKSkudGhlbihhc3luYyAoeyBsYXllciwgc291cmNlVmVyc2lvbiB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZG9RdWVyeUNvdW50QnlMYXllcihxdWVyeVBhcmFtcywgbGF5ZXIpXG4gICAgICAgIHJldHVybiB7IC4uLnJlc3VsdCwgc291cmNlVmVyc2lvbiB9XG4gICAgICB9KVxuICAgIH0gZWxzZSBpZiAodGhpcy5sYXllcikge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZG9RdWVyeUNvdW50QnlMYXllcihxdWVyeVBhcmFtcywgdGhpcy5sYXllcilcbiAgICB9IGVsc2UgaWYgKHRoaXMudXJsKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5kb1F1ZXJ5Q291bnRCeVVybChxdWVyeVBhcmFtcywgdGhpcy51cmwpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNyZWF0ZUxheWVyQnlJdGVtSWQoKS50aGVuKGxheWVyID0+IHRoaXMuZG9RdWVyeUNvdW50QnlMYXllcihxdWVyeVBhcmFtcywgbGF5ZXIpKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRvUXVlcnlJZHMgKHF1ZXJ5UGFyYW1zOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIC8qKlxuICAgICAqIFNlZSBjb21tZW50cyBpbiBkb1F1ZXJ5IG1ldGhvZC5cbiAgICAgKi9cbiAgICBpZiAodGhpcy5nZXREYXRhU291cmNlSnNvbigpLmlzRGF0YUluRGF0YVNvdXJjZUluc3RhbmNlKSB7XG4gICAgICBpZiAodGhpcy5nZXRTb3VyY2VSZWNvcmRzKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyBxdWVyeVBhcmFtczogcXVlcnlQYXJhbXMsIGlkczogW10sIHNvdXJjZVZlcnNpb246IHRoaXMuZ2V0U291cmNlVmVyc2lvbigpIH0pXG4gICAgICB9XG4gICAgICBjb25zdCBzb3VyY2VSZWNvcmRzID0gdGhpcy5nZXRTb3VyY2VSZWNvcmRzKCkgYXMgRmVhdHVyZURhdGFSZWNvcmRbXVxuICAgICAgLyoqXG4gICAgICAgKiBJZiBxdWVyeSBwYXJhbXMgaXMgZW1wdHksIG5vIG5lZWQgdG8gbG9hZCBKUyBBUEkgdG8gY3JlYXRlIGxheWVyLlxuICAgICAgICovXG4gICAgICBpZiAodGhpcy5pc1F1ZXJ5UGFyYW1zRW1wdHkocXVlcnlQYXJhbXMpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyBxdWVyeVBhcmFtczogcXVlcnlQYXJhbXMsIGlkczogc291cmNlUmVjb3Jkcy5tYXAociA9PiByLmdldElkKCkpLCBzb3VyY2VWZXJzaW9uOiB0aGlzLmdldFNvdXJjZVZlcnNpb24oKSB9KVxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5jcmVhdGVGZWF0dXJlTGF5ZXJCeVJlY29yZHModGhpcywgc291cmNlUmVjb3JkcywgdGhpcy5nZXRTb3VyY2VWZXJzaW9uKCkpLnRoZW4oYXN5bmMgKHsgbGF5ZXIsIHNvdXJjZVZlcnNpb24gfSkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmRvUXVlcnlJZHNCeUxheWVyKHF1ZXJ5UGFyYW1zLCBsYXllcilcbiAgICAgICAgcmV0dXJuIHsgLi4ucmVzdWx0LCBzb3VyY2VWZXJzaW9uIH1cbiAgICAgIH0pXG4gICAgfSBlbHNlIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5kb1F1ZXJ5SWRzQnlMYXllcihxdWVyeVBhcmFtcywgdGhpcy5sYXllcilcbiAgICB9IGVsc2UgaWYgKHRoaXMudXJsKSB7XG4gICAgICByZXR1cm4gdGhpcy5kb1F1ZXJ5SWRzQnlVcmwocXVlcnlQYXJhbXMsIHRoaXMudXJsKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVMYXllckJ5SXRlbUlkKCkudGhlbihsYXllciA9PiB0aGlzLmRvUXVlcnlJZHNCeUxheWVyKHF1ZXJ5UGFyYW1zLCBsYXllcikpXG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGRvQWRkUmVjb3JkVG9TZXJ2ZXJTaWRlU291cmNlIChyZWNvcmQ6IEZlYXR1cmVEYXRhUmVjb3JkKTogUHJvbWlzZTxGZWF0dXJlRGF0YVJlY29yZD4ge1xuICAgIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGRSZWNvcmRCeUxheWVyKHJlY29yZCwgdGhpcy5sYXllcilcbiAgICB9IGVsc2UgaWYgKHRoaXMudXJsKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGRSZWNvcmRCeVVybChyZWNvcmQsIHRoaXMudXJsKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVMYXllckJ5SXRlbUlkKCkudGhlbihsYXllciA9PiB0aGlzLmFkZFJlY29yZEJ5TGF5ZXIocmVjb3JkLCBsYXllcikpXG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGRvRGVsZXRlT25lUmVjb3JkRnJvbVNlcnZlclNpZGVTb3VyY2UgKHJlY29yZDogRmVhdHVyZURhdGFSZWNvcmQpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAodGhpcy5sYXllcikge1xuICAgICAgcmV0dXJuIHRoaXMuZGVsZXRlT25lUmVjb3JkQnlMYXllcihyZWNvcmQsIHRoaXMubGF5ZXIpXG4gICAgfSBlbHNlIGlmICh0aGlzLnVybCkge1xuICAgICAgcmV0dXJuIHRoaXMuZGVsZXRlT25lUmVjb3JkQnlVcmwocmVjb3JkLCB0aGlzLnVybClcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlTGF5ZXJCeUl0ZW1JZCgpLnRoZW4obGF5ZXIgPT4gdGhpcy5kZWxldGVPbmVSZWNvcmRCeUxheWVyKHJlY29yZCwgbGF5ZXIpKVxuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBkb1VwZGF0ZVJlY29yZHNJblNlcnZlclNpZGVTb3VyY2UgKHJlY29yZHM6IEZlYXR1cmVEYXRhUmVjb3JkW10pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAodGhpcy5sYXllcikge1xuICAgICAgcmV0dXJuIHRoaXMudXBkYXRlUmVjb3Jkc0J5TGF5ZXIocmVjb3JkcywgdGhpcy5sYXllcilcbiAgICB9IGVsc2UgaWYgKHRoaXMudXJsKSB7XG4gICAgICByZXR1cm4gdGhpcy51cGRhdGVSZWNvcmRzQnlVcmwocmVjb3JkcywgdGhpcy51cmwpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUxheWVyQnlJdGVtSWQoKS50aGVuKGxheWVyID0+IHRoaXMudXBkYXRlUmVjb3Jkc0J5TGF5ZXIocmVjb3JkcywgbGF5ZXIpKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZG9RdWVyeUNvdW50QnlMYXllciAocXVlcnlQYXJhbXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMsIGxheWVyOiBfX2VzcmkuRmVhdHVyZUxheWVyKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIGNvbnN0IGxheWVyVmlldyA9IHRoaXMuZ2V0TGF5ZXJWaWV3Rm9yQ2xpZW50U2lkZVF1ZXJ5KGxheWVyKVxuXG4gICAgbGV0IGNvdW50OiBudW1iZXJcbiAgICBsZXQgaXNDbGllbnRRdWVyeVN1Y2Nlc3MgPSBmYWxzZVxuXG4gICAgaWYgKGxheWVyVmlldykge1xuICAgICAgY29uc3QgY2xpZW50UXVlcnlSZXN1bHQgPSBhd2FpdCBsYXllclZpZXcuY2xpZW50UXVlcnlGZWF0dXJlQ291bnQocXVlcnlQYXJhbXMpXG5cbiAgICAgIGlmIChjbGllbnRRdWVyeVJlc3VsdD8uc3VjY2Vzcykge1xuICAgICAgICBpc0NsaWVudFF1ZXJ5U3VjY2VzcyA9IHRydWVcbiAgICAgICAgY291bnQgPSBjbGllbnRRdWVyeVJlc3VsdC5kYXRhXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFpc0NsaWVudFF1ZXJ5U3VjY2Vzcykge1xuICAgICAgY29uc3QgcXVlcnkgPSBhd2FpdCB0aGlzLmNoYW5nZUppbXVRdWVyeVRvSlNBUElRdWVyeShxdWVyeVBhcmFtcylcbiAgICAgIGNvdW50ID0gYXdhaXQgbGF5ZXIucXVlcnlGZWF0dXJlQ291bnQocXVlcnkpXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHF1ZXJ5UGFyYW1zOiBxdWVyeVBhcmFtcyxcbiAgICAgIGNvdW50XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBkb1F1ZXJ5Q291bnRCeVVybCAocXVlcnlQYXJhbXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMsIHVybDogc3RyaW5nKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gdGhpcy5jaGFuZ2VKaW11UXVlcnlUb1Jlc3RBUElRdWVyeShxdWVyeVBhcmFtcylcblxuICAgIGRlbGV0ZSBxdWVyeS5yZXN1bHRSZWNvcmRDb3VudFxuICAgIGRlbGV0ZSBxdWVyeS5yZXN1bHRPZmZzZXRcblxuICAgIGlmICghcXVlcnkucmV0dXJuQ291bnRPbmx5KSB7XG4gICAgICBxdWVyeS5yZXR1cm5Db3VudE9ubHkgPSB0cnVlXG4gICAgfVxuICAgIHJldHVybiBhd2FpdCB0aGlzLl9xKHF1ZXJ5LCB1cmwpLnRoZW4oKHF1ZXJ5UmVzcG9uc2U6IElRdWVyeUZlYXR1cmVzUmVzcG9uc2UpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHF1ZXJ5UGFyYW1zOiBxdWVyeVBhcmFtcyxcbiAgICAgICAgY291bnQ6IChxdWVyeVJlc3BvbnNlIGFzIGFueSkuY291bnRcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBkb1F1ZXJ5SWRzQnlMYXllciAocXVlcnlQYXJhbXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMsIGxheWVyOiBfX2VzcmkuRmVhdHVyZUxheWVyKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIGNvbnN0IHF1ZXJ5ID0gYXdhaXQgdGhpcy5jaGFuZ2VKaW11UXVlcnlUb0pTQVBJUXVlcnkocXVlcnlQYXJhbXMpXG4gICAgY29uc3QgbGF5ZXJWaWV3ID0gdGhpcy5nZXRMYXllclZpZXdGb3JDbGllbnRTaWRlUXVlcnkobGF5ZXIpXG5cbiAgICBsZXQgaWRzOiBudW1iZXJbXVxuICAgIGxldCBpc0NsaWVudFF1ZXJ5U3VjY2VzcyA9IGZhbHNlXG5cbiAgICBpZiAobGF5ZXJWaWV3KSB7XG4gICAgICBjb25zdCBjbGllbnRRdWVyeVJlc3VsdCA9IGF3YWl0IGxheWVyVmlldy5jbGllbnRRdWVyeU9iamVjdElkcyhxdWVyeVBhcmFtcylcblxuICAgICAgaWYgKGNsaWVudFF1ZXJ5UmVzdWx0Py5zdWNjZXNzKSB7XG4gICAgICAgIGlzQ2xpZW50UXVlcnlTdWNjZXNzID0gdHJ1ZVxuICAgICAgICBpZHMgPSBjbGllbnRRdWVyeVJlc3VsdC5kYXRhXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFpc0NsaWVudFF1ZXJ5U3VjY2Vzcykge1xuICAgICAgaWRzID0gYXdhaXQgbGF5ZXIucXVlcnlPYmplY3RJZHMocXVlcnkpXG4gICAgfVxuXG4gICAgLy8gaWRzIG1heWJlIG51bGwsIG51bGwgbWVhbnMgemVybyBpZHNcbiAgICBpZiAoIWlkcykge1xuICAgICAgaWRzID0gW11cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgcXVlcnlQYXJhbXM6IHF1ZXJ5UGFyYW1zLFxuICAgICAgaWRzOiBpZHMubWFwKGkgPT4gYCR7aX1gKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZG9RdWVyeUlkc0J5VXJsIChxdWVyeVBhcmFtczogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgdXJsOiBzdHJpbmcpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgY29uc3QgcXVlcnkgPSB0aGlzLmNoYW5nZUppbXVRdWVyeVRvUmVzdEFQSVF1ZXJ5KHF1ZXJ5UGFyYW1zKVxuXG4gICAgZGVsZXRlIHF1ZXJ5LnJlc3VsdFJlY29yZENvdW50XG4gICAgZGVsZXRlIHF1ZXJ5LnJlc3VsdE9mZnNldFxuICAgIGRlbGV0ZSBxdWVyeS5yZXR1cm5Db3VudE9ubHlcbiAgICBkZWxldGUgcXVlcnkucmV0dXJuR2VvbWV0cnlcblxuICAgIGlmICghcXVlcnkucmV0dXJuSWRzT25seSkge1xuICAgICAgcXVlcnkucmV0dXJuSWRzT25seSA9IHRydWVcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3EocXVlcnksIHVybCkudGhlbigocXVlcnlSZXNwb25zZTogSVF1ZXJ5RmVhdHVyZXNSZXNwb25zZSkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcXVlcnlQYXJhbXM6IHF1ZXJ5UGFyYW1zLFxuICAgICAgICBpZHM6IChxdWVyeVJlc3BvbnNlIGFzIGFueSkub2JqZWN0SWRzPy5tYXAoaSA9PiBgJHtpfWApXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGFzeW5jIGRvUXVlcnlCeUlkIChpZDogc3RyaW5nKTogUHJvbWlzZTxGZWF0dXJlRGF0YVJlY29yZD4ge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmRvUXVlcnlCeUNhcGFiaWxpdGllcyhJbW11dGFibGUoeyBvYmplY3RJZHM6IFtwYXJzZUludChpZCldLCByZXR1cm5HZW9tZXRyeTogdHJ1ZSwgcmV0dXJuWjogdHJ1ZSB9KSlcbiAgICAgIC50aGVuKHJlc3VsdCA9PiByZXN1bHQucmVjb3Jkc1swXSBhcyBGZWF0dXJlRGF0YVJlY29yZClcbiAgfVxuXG4gIGFzeW5jIHF1ZXJ5QnlJZCAoaWQ6IHN0cmluZyk6IFByb21pc2U8RmVhdHVyZURhdGFSZWNvcmQ+IHtcbiAgICByZXR1cm4gYXdhaXQgc3VwZXIucXVlcnlCeUlkKGlkKSBhcyBGZWF0dXJlRGF0YVJlY29yZFxuICB9XG5cbiAgZ2V0Q29uZmlnUXVlcnlQYXJhbXMgKCk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHtcbiAgICBjb25zdCBxdWVyeSA9IHRoaXMuZ2V0RGF0YVZpZXdDb25maWcoKVxuICAgIGlmICghcXVlcnkpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgY29uc3QgY29uZmlnUXVlcnkgPSB7XG4gICAgICB3aGVyZTogZGF0YVNvdXJjZVV0aWxzLmdldEFyY0dJU1NRTChxdWVyeS53aGVyZSwgdGhpcykuc3FsLFxuICAgICAgc3FsRXhwcmVzc2lvbjogcXVlcnkud2hlcmU/LmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSksXG4gICAgICBvcmRlckJ5RmllbGRzOiB0aGlzLmdldE9yZGVyQnlBcnJheShxdWVyeS5vcmRlckJ5KVxuICAgIH0gYXMgRmVhdHVyZUxheWVyUXVlcnlQYXJhbXNcblxuICAgIHJldHVybiBjb25maWdRdWVyeVxuICB9XG5cbiAgbWVyZ2VRdWVyeVBhcmFtcyAoLi4ucXVlcmllczogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXNbXSk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHtcbiAgICBxdWVyaWVzID0gcXVlcmllcyB8fCBbXVxuICAgIGxldCBtZXJnZWRRdWVyaWVzID0gcXVlcmllcy5maWx0ZXIocSA9PiBxKS5yZWR1Y2UoKHJlcywgcSkgPT4gKHsgLi4ucmVzLCAuLi5xIH0pLCB7fSlcblxuICAgIC8qKlxuICAgICAqIDEuIG1lcmdlIHRpbWUuXG4gICAgICovXG4gICAgY29uc3QgdGltZUFyciA9IHF1ZXJpZXMubWFwKHEgPT4gcT8udGltZSkuZmlsdGVyKHcgPT4gdHlwZW9mIHcgPT09ICdudW1iZXInIHx8IEFycmF5LmlzQXJyYXkodykpXG4gICAgY29uc3QgdGltZSA9IHRpbWVBcnIubGVuZ3RoID4gMSA/IHRpbWVBcnIucmVkdWNlKChyZXMsIHQpID0+IChkYXRhU291cmNlVXRpbHMubWVyZ2VUaW1lRXh0ZW50KHJlcywgdCkpLCBudWxsKSA6IHRpbWVBcnJbMF1cbiAgICAvKipcbiAgICAgKiBTb21lIHNlcnZpY2VzIGRvIG5vdCBzdXBwb3J0IHRlbXBvcmFsIHF1ZXJ5LiBBZGQgdGltZSBvbmx5IHdoZW4gbmVlZGVkLlxuICAgICAqL1xuICAgIGlmICh0aW1lID09PSAtMSkge1xuICAgICAgbWVyZ2VkUXVlcmllcy53aGVyZSA9ICcxPTInXG4gICAgICAvLyBUaGUgcmVzdWx0IHdpbGwgYmUgZW1wdHksIG5vIG5lZWQgdG8gbWVyZ2Ugb3RoZXIgcXVlcmllcy5cbiAgICAgIHJldHVybiBtZXJnZWRRdWVyaWVzXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGltZSA9PT0gJ251bWJlcicgfHwgQXJyYXkuaXNBcnJheSh0aW1lKSkge1xuICAgICAgbWVyZ2VkUXVlcmllcy50aW1lID0gdGltZVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDIuIG1lcmdlIHdoZXJlLlxuICAgICAqL1xuICAgIGNvbnN0IHdoZXJlQXJyID0gcXVlcmllcy5tYXAocSA9PiBxPy53aGVyZSkuZmlsdGVyKHcgPT4gdylcbiAgICBjb25zdCB3aGVyZSA9IHdoZXJlQXJyLmxlbmd0aCA+IDEgPyB3aGVyZUFyci5tYXAodyA9PiBgKCR7d30pYCkuam9pbignIGFuZCAnKSA6IHdoZXJlQXJyWzBdXG4gICAgbWVyZ2VkUXVlcmllcyA9IHsgLi4ubWVyZ2VkUXVlcmllcywgd2hlcmU6IHdoZXJlID8gYCR7d2hlcmV9YCA6ICcnIH1cblxuICAgIC8qKlxuICAgICAqIDMuIG1lcmdlIHNxbEV4cHJlc3Npb24uXG4gICAgICovXG4gICAgY29uc3Qgc3FsRXhwcmVzc2lvbkFyciA9IHF1ZXJpZXMubWFwKHEgPT4gcT8uc3FsRXhwcmVzc2lvbikuZmlsdGVyKHMgPT4gcylcbiAgICBjb25zdCBzcWxFeHByZXNzaW9uID0gc3FsRXhwcmVzc2lvbkFyci5sZW5ndGggPiAxXG4gICAgICA/IHNxbEV4cHJlc3Npb25BcnIucmVkdWNlKChyZXMsIHMpID0+IChkYXRhU291cmNlVXRpbHMuZ2V0TWVyZ2VkU1FMRXhwcmVzc2lvbnMoW3Jlcywgc10sIHRoaXMpKSwgbnVsbClcbiAgICAgIDogc3FsRXhwcmVzc2lvbkFyclswXVxuICAgIG1lcmdlZFF1ZXJpZXMgPSB7IC4uLm1lcmdlZFF1ZXJpZXMsIHNxbEV4cHJlc3Npb24gfVxuXG4gICAgcmV0dXJuIG1lcmdlZFF1ZXJpZXNcbiAgfVxuXG4gIGdldEN1cnJlbnRRdWVyeVBhcmFtcyAob3B0aW9ucz86IEdldEN1cnJlbnRRdWVyeVBhcmFtc09wdGlvbnMpOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyB7XG4gICAgY29uc3QgcXVlcnk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zID0gc3VwZXIuZ2V0Q3VycmVudFF1ZXJ5UGFyYW1zKG9wdGlvbnMpXG4gICAgcmV0dXJuIHRoaXMuYXBwbHlHREJWZXJzaW9uQW5kRml4KHF1ZXJ5LCBvcHRpb25zPy5kYXRhU291cmNlVG9Gb3JtYXRTcWwpXG4gIH1cblxuICBnZXRSZWFsUXVlcnlQYXJhbXMgKHF1ZXJ5LCBmbGFnOiAncXVlcnknIHwgJ2xvYWQnLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMge1xuICAgIGNvbnN0IHJxOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyA9IHN1cGVyLmdldFJlYWxRdWVyeVBhcmFtcyhxdWVyeSwgZmxhZywgb3B0aW9ucylcbiAgICByZXR1cm4gdGhpcy5hcHBseUdEQlZlcnNpb25BbmRGaXgocnEsIG9wdGlvbnM/LmRhdGFTb3VyY2VUb0Zvcm1hdFNxbClcbiAgfVxuXG4gIGdldFJlbW90ZVF1ZXJ5UGFyYW1zICgpOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyB7XG4gICAgaWYgKHRoaXMuZ2V0U2NoZW1hKCkuZmlsdGVyKSB7XG4gICAgICByZXR1cm4geyB3aGVyZTogdGhpcy5nZXRTY2hlbWEoKS5maWx0ZXIgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgcHJpdmF0ZSBhcHBseUdEQlZlcnNpb25BbmRGaXggKHF1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgZGF0YVNvdXJjZVRvRm9ybWF0U3FsOiBRdWVyaWFibGVEYXRhU291cmNlKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMge1xuICAgIGlmICh0aGlzLmdldEdEQlZlcnNpb24oKSkge1xuICAgICAgcXVlcnkuZ2RiVmVyc2lvbiA9IHRoaXMuZ2V0R0RCVmVyc2lvbigpXG4gICAgfVxuXG4gICAgbGV0IHEgPSB0aGlzLmZpeFF1ZXJ5UGFyYW0oSW1tdXRhYmxlKHF1ZXJ5KSlcblxuICAgIGlmIChxLnNxbEV4cHJlc3Npb24gJiYgZGF0YVNvdXJjZVRvRm9ybWF0U3FsICYmIGRhdGFTb3VyY2VUb0Zvcm1hdFNxbC5pc1NxbENhc2VTZW5zaXRpdmUgIT09IHRoaXMuaXNTcWxDYXNlU2Vuc2l0aXZlKSB7XG4gICAgICBxID0gcS5zZXQoJ3doZXJlJywgZGF0YVNvdXJjZVV0aWxzLmdldEFyY0dJU1NRTChxLnNxbEV4cHJlc3Npb24sIGRhdGFTb3VyY2VUb0Zvcm1hdFNxbCkuc3FsKVxuICAgIH1cblxuICAgIHJldHVybiBxLmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBTb21lIHF1ZXJ5IHBhcmFtcyBoYXZlIGNvbmZsaWN0cyBhY2NvcmRpbmcgdG8gdGhlIGZlYXR1cmUgbGF5ZXIgcXVlcnkgY2FwYWJpbGl0eSBhbmQgd2UgY2FuIG5vdCBlbmhhbmNlIGl0LlxuICAgKiBXaWxsIGZpeCBxdWVyeSBvYmplY3QgYnkgcmVtb3ZpbmcgdGhlc2UgY29uZmxpY3RzIHBhcmFtcy5cbiAgICovXG4gIGZpeFF1ZXJ5UGFyYW0gKHE6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHtcbiAgICBsZXQgZml4ZWRRdWVyeSA9IHFcbiAgICAvLyBUT0RPOiBvdGhlciBjYXNlcy5cbiAgICBpZiAocS5vdXRTdGF0aXN0aWNzKSB7XG4gICAgICAvLyBvcmRlckJ5RmllbGRzLCBwYWdlIGFuZCBwYWdlU2l6ZSBtYXkgbm90IGJlIHN1cHBvcnRlZCBieSBzZXJ2aWNlLCBidXQgd2UgY2FuIGVuaGFuY2UgaXQsIHNlZSBgZG9RdWVyeWAgbW90aG9kLlxuICAgICAgT2JqZWN0LmtleXMocSkuZm9yRWFjaChrID0+IHtcbiAgICAgICAgaWYgKCFbJ291dFN0YXRpc3RpY3MnLCAnd2hlcmUnLCAnZ2RiVmVyc2lvbicsICdnZW9tZXRyeScsICdnZW9tZXRyeVR5cGUnLCAnc3BhdGlhbFJlbCcsICdkaXN0YW5jZScsICd1bml0cycsICdncm91cEJ5RmllbGRzRm9yU3RhdGlzdGljcycsICd0aW1lJywgJ29yZGVyQnlGaWVsZHMnLCAnaGF2aW5nQ2xhdXNlJywgJ3BhZ2UnLCAncGFnZVNpemUnXS5pbmNsdWRlcyhrKSkge1xuICAgICAgICAgIGZpeGVkUXVlcnkgPSBmaXhlZFF1ZXJ5LndpdGhvdXQoayBhcyBhbnkpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICAgIGlmIChxLnJldHVybkRpc3RpbmN0VmFsdWVzICYmIHEucmV0dXJuR2VvbWV0cnkpIHtcbiAgICAgIC8vIHJldHVybkRpc3RpbmN0VmFsdWVzIGNhbiBub3Qgd29yayB3aXRoIHJldHVybkdlb21ldHJ5LlxuICAgICAgZml4ZWRRdWVyeSA9IGZpeGVkUXVlcnkuc2V0KCdyZXR1cm5HZW9tZXRyeScsIGZhbHNlKVxuICAgIH1cbiAgICBpZiAoIXEucmV0dXJuRGlzdGluY3RWYWx1ZXMgJiYgcS5yZXR1cm5HZW9tZXRyeSkge1xuICAgICAgLy8gUmV0dXJuIHotdmFsdWVzLlxuICAgICAgZml4ZWRRdWVyeSA9IGZpeGVkUXVlcnkuc2V0KCdyZXR1cm5aJywgdHJ1ZSlcbiAgICB9XG4gICAgaWYgKCFmaXhlZFF1ZXJ5Lm91dFN0YXRpc3RpY3MgJiYgIWZpeGVkUXVlcnkucmV0dXJuRGlzdGluY3RWYWx1ZXMgJiYgZml4ZWRRdWVyeS5vcmRlckJ5RmllbGRzPy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBoYXNJZEZpZWxkID0gISFmaXhlZFF1ZXJ5Lm9yZGVyQnlGaWVsZHMuZmluZChmID0+IGYuc3BsaXQoJyAnKVswXSA9PT0gdGhpcy5nZXRJZEZpZWxkKCkpXG4gICAgICBpZiAoIWhhc0lkRmllbGQpIHtcbiAgICAgICAgZml4ZWRRdWVyeSA9IGZpeGVkUXVlcnkuc2V0KCdvcmRlckJ5RmllbGRzJywgZml4ZWRRdWVyeS5vcmRlckJ5RmllbGRzLmNvbmNhdChbYCR7dGhpcy5nZXRJZEZpZWxkKCl9IEFTQ2BdKSlcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGZpeGVkUXVlcnkucmV0dXJuRGlzdGluY3RWYWx1ZXMgJiYgZml4ZWRRdWVyeS5vdXRGaWVsZHM/Lmxlbmd0aCAmJiAhZml4ZWRRdWVyeS5vcmRlckJ5RmllbGRzPy5sZW5ndGgpIHtcbiAgICAgIC8qKlxuICAgICAgICogV2hlbiBxdWVyeSBkaXN0aW5jdCwgd2UgbmVlZCB0byB1c2Ugb25lIG9mIHRoZSBvdXQgZmllbGRzIHRvIHNvcnQgdGhlIHF1ZXJ5IHJlc3VsdC5cbiAgICAgICAqIEl0IGlzIGEgbGltaXRhdGlvbiBvZiBzZXJ2ZXIuIElmIHdlIGRvbid0IGRvIGl0LCBzZXJ2ZXIgd2lsbCB1c2UgdGhlIGlkIGZpZWxkIHRvIGRvIHNvcnQgYW5kIHRoZSBpZCBmaWVsZCBpcyBnZW5lcmFsbHkgbm90IGluIHRoZSBvdXQgZmllbGRzLCB3aGljaCB3aWxsIHJlc3VsdCBpbiBhbiBlcnJvci5cbiAgICAgICAqL1xuICAgICAgZml4ZWRRdWVyeSA9IGZpeGVkUXVlcnkuc2V0KCdvcmRlckJ5RmllbGRzJywgW2ZpeGVkUXVlcnkub3V0RmllbGRzWzBdXSlcbiAgICB9XG4gICAgaWYgKGRhdGFTb3VyY2VVdGlscy5hcmVEYXRlc0luVW5rbm93blRpbWV6b25lKHRoaXMpKSB7XG4gICAgICBmaXhlZFF1ZXJ5ID0gZml4ZWRRdWVyeS5zZXQoJ3RpbWVSZWZlcmVuY2VVbmtub3duQ2xpZW50JywgdHJ1ZSlcbiAgICB9XG4gICAgcmV0dXJuIGZpeGVkUXVlcnlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYWRkUmVjb3JkQnlMYXllciAocmVjb3JkOiBGZWF0dXJlRGF0YVJlY29yZCwgbGF5ZXI6IF9fZXNyaS5GZWF0dXJlTGF5ZXIpOiBQcm9taXNlPEZlYXR1cmVEYXRhUmVjb3JkPiB7XG4gICAgY29uc3QgZmVhdHVyZSA9IGF3YWl0IGRhdGFTb3VyY2VVdGlscy5jaGFuZ2VUb0pTQVBJR3JhcGhpYyhyZWNvcmQuZmVhdHVyZSlcbiAgICBjb25zdCBmID0gZmVhdHVyZS5jbG9uZSgpXG4gICAgcmV0dXJuIGxheWVyLmFwcGx5RWRpdHMoe1xuICAgICAgYWRkRmVhdHVyZXM6IFtmXVxuICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgY29uc3Qgb2JqZWN0SWQgPSByZXNwb25zZS5hZGRGZWF0dXJlUmVzdWx0c1swXT8ub2JqZWN0SWRcbiAgICAgIGlmICh0eXBlb2Ygb2JqZWN0SWQgIT09ICdudW1iZXInIHx8IHJlc3BvbnNlLmFkZEZlYXR1cmVSZXN1bHRzWzBdPy5lcnJvcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ0FkZGluZyByZWNvcmQgZmFpbGVkLicpXG4gICAgICB9XG4gICAgICBjb25zdCBpZEZlaWxkID0gdGhpcy5nZXRJZEZpZWxkKClcbiAgICAgIGYuYXR0cmlidXRlc1tpZEZlaWxkXSA9IG9iamVjdElkXG4gICAgICAvLyByZXR1cm4gYSBuZXcgcmVjb3JkIHdpdGggYSBuZXcgdmFsdWUgb2YgaWQgZmllbGRcbiAgICAgIHJldHVybiBuZXcgRmVhdHVyZURhdGFSZWNvcmRJbXBsKGYsIHRoaXMpXG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYWRkUmVjb3JkQnlVcmwgKHJlY29yZDogRmVhdHVyZURhdGFSZWNvcmQsIHVybDogc3RyaW5nKTogUHJvbWlzZTxGZWF0dXJlRGF0YVJlY29yZD4ge1xuICAgIGNvbnN0IGZlYXR1cmUgPSBkYXRhU291cmNlVXRpbHMuY2hhbmdlVG9SZXN0QVBJRmVhdHVyZShyZWNvcmQuZmVhdHVyZSlcbiAgICBjb25zdCBmID0geyAuLi5mZWF0dXJlIH1cbiAgICBjb25zdCBvcHRpb25zOiBJQWRkRmVhdHVyZXNPcHRpb25zID0ge1xuICAgICAgdXJsLFxuICAgICAgZmVhdHVyZXM6IFtmXVxuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgcmVxdWVzdFV0aWxzLnJlcXVlc3RXcmFwcGVyKHVybCwgYXN5bmMgKHNlc3Npb24pID0+IHtcbiAgICAgIG9wdGlvbnMuYXV0aGVudGljYXRpb24gPSBzZXNzaW9uXG4gICAgICByZXR1cm4gYXdhaXQgZXNyaS5yZXN0RmVhdHVyZUxheWVyLmFkZEZlYXR1cmVzKG9wdGlvbnMpXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICBjb25zdCBvYmplY3RJZCA9IHJlc3BvbnNlLmFkZFJlc3VsdHNbMF0/Lm9iamVjdElkXG4gICAgICAgICAgaWYgKHR5cGVvZiBvYmplY3RJZCAhPT0gJ251bWJlcicgfHwgIXJlc3BvbnNlLmFkZFJlc3VsdHNbMF0/LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnQWRkaW5nIHJlY29yZCBmYWlsZWQuJylcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgaWRGZWlsZCA9IHRoaXMuZ2V0SWRGaWVsZCgpXG4gICAgICAgICAgZi5hdHRyaWJ1dGVzW2lkRmVpbGRdID0gb2JqZWN0SWRcbiAgICAgICAgICAvLyByZXR1cm4gYSBuZXcgcmVjb3JkIHdpdGggYSBuZXcgdmFsdWUgb2YgaWQgZmllbGRcbiAgICAgICAgICByZXR1cm4gbmV3IEZlYXR1cmVEYXRhUmVjb3JkSW1wbChmLCB0aGlzKVxuICAgICAgICB9KVxuICAgIH0sIDEpXG4gICAgLy8gVE9ETzogcmV0cnkgaWYgcmVxdWVzdCB3YXMgdW5hdXRoZW50aWNhdGVkXG4gICAgLy8gb25jZSB3ZSBhcmUgc2VuZGluZyB0b2tlbnMgYWJvdmVcbiAgICAvLyAuY2F0Y2goc2Vzc2lvbk1hbmFnZXIuaGFuZGxlQXV0aEVycm9yLmJpbmQoc2Vzc2lvbk1hbmFnZXIpKVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVSZWNvcmRzQnlMYXllciAocmVjb3JkczogRmVhdHVyZURhdGFSZWNvcmRbXSwgbGF5ZXI6IF9fZXNyaS5GZWF0dXJlTGF5ZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBmZWF0dXJlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJlY29yZHMubWFwKGFzeW5jIHIgPT4gKGF3YWl0IGRhdGFTb3VyY2VVdGlscy5jaGFuZ2VUb0pTQVBJR3JhcGhpYyhyLmZlYXR1cmUpLnRoZW4oZyA9PiBnLmNsb25lKCkpKSkpXG4gICAgcmV0dXJuIGxheWVyLmFwcGx5RWRpdHMoe1xuICAgICAgdXBkYXRlRmVhdHVyZXM6IGZlYXR1cmVzXG4gICAgLy8gVE9ETzogaWYgb25seSB1cGRhdGUgcGFydHMgb2YgdGhlIHJlY29yZHM/XG4gICAgfSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS51cGRhdGVGZWF0dXJlUmVzdWx0cy5maWx0ZXIociA9PiAhci5lcnJvcikubGVuZ3RoID4gMClcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdXBkYXRlUmVjb3Jkc0J5VXJsIChyZWNvcmRzOiBGZWF0dXJlRGF0YVJlY29yZFtdLCB1cmw6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGZlYXR1cmVzID0gcmVjb3Jkcy5tYXAociA9PiAoeyAuLi5kYXRhU291cmNlVXRpbHMuY2hhbmdlVG9SZXN0QVBJRmVhdHVyZShyLmZlYXR1cmUpIH0pKVxuICAgIGNvbnN0IG9wdGlvbnM6IElVcGRhdGVGZWF0dXJlc09wdGlvbnMgPSB7XG4gICAgICB1cmwsXG4gICAgICBmZWF0dXJlczogZmVhdHVyZXNcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHJlcXVlc3RVdGlscy5yZXF1ZXN0V3JhcHBlcih1cmwsIGFzeW5jIChzZXNzaW9uKSA9PiB7XG4gICAgICBvcHRpb25zLmF1dGhlbnRpY2F0aW9uID0gc2Vzc2lvblxuICAgICAgcmV0dXJuIGF3YWl0IGVzcmkucmVzdEZlYXR1cmVMYXllci51cGRhdGVGZWF0dXJlcyhvcHRpb25zKVxuICAgICAgICAvLyBUT0RPOiBpZiBvbmx5IHVwZGF0ZSBwYXJ0cyBvZiB0aGUgcmVjb3Jkcz9cbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudXBkYXRlUmVzdWx0cy5maWx0ZXIociA9PiByLnN1Y2Nlc3MpLmxlbmd0aCA+IDApXG4gICAgfSwgMSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZGVsZXRlT25lUmVjb3JkQnlMYXllciAocmVjb3JkOiBGZWF0dXJlRGF0YVJlY29yZCwgbGF5ZXI6IF9fZXNyaS5GZWF0dXJlTGF5ZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBmZWF0dXJlID0gYXdhaXQgZGF0YVNvdXJjZVV0aWxzLmNoYW5nZVRvSlNBUElHcmFwaGljKHJlY29yZC5mZWF0dXJlKVxuICAgIGNvbnN0IGYgPSBmZWF0dXJlLmNsb25lKClcbiAgICByZXR1cm4gbGF5ZXIuYXBwbHlFZGl0cyh7XG4gICAgICBkZWxldGVGZWF0dXJlczogW2ZdXG4gICAgfSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5kZWxldGVGZWF0dXJlUmVzdWx0cy5maWx0ZXIociA9PiAhci5lcnJvcikubGVuZ3RoID4gMClcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZGVsZXRlT25lUmVjb3JkQnlVcmwgKHJlY29yZDogRmVhdHVyZURhdGFSZWNvcmQsIHVybDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgZiA9IHsgLi4uZGF0YVNvdXJjZVV0aWxzLmNoYW5nZVRvUmVzdEFQSUZlYXR1cmUocmVjb3JkLmZlYXR1cmUpIH1cbiAgICBjb25zdCBpZEZpZWxkID0gdGhpcy5nZXRJZEZpZWxkKClcbiAgICBjb25zdCBvYmplY3RJZCA9IGYuYXR0cmlidXRlc1tpZEZpZWxkXVxuICAgIGNvbnN0IG9wdGlvbnM6IElEZWxldGVGZWF0dXJlc09wdGlvbnMgPSB7XG4gICAgICB1cmwsXG4gICAgICBvYmplY3RJZHM6IFtvYmplY3RJZF1cbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHJlcXVlc3RVdGlscy5yZXF1ZXN0V3JhcHBlcih1cmwsIGFzeW5jIChzZXNzaW9uKSA9PiB7XG4gICAgICBvcHRpb25zLmF1dGhlbnRpY2F0aW9uID0gc2Vzc2lvblxuICAgICAgcmV0dXJuIGF3YWl0IGVzcmkucmVzdEZlYXR1cmVMYXllci5kZWxldGVGZWF0dXJlcyhvcHRpb25zKVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5kZWxldGVSZXN1bHRzLmZpbHRlcihyID0+IHIuc3VjY2VzcykubGVuZ3RoID4gMClcbiAgICB9LCAxKVxuICB9XG5cbiAgYXN5bmMgZmV0Y2hTY2hlbWEgKCk6IFByb21pc2U8SU1EYXRhU291cmNlU2NoZW1hPiB7XG4gICAgaWYgKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc1N0YXRpc3RpYykge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShJbW11dGFibGUoe30pKVxuICAgIH1cblxuICAgIGxldCBzY2hlbWE6IElNRGF0YVNvdXJjZVNjaGVtYVxuICAgIGlmICh0aGlzLmxheWVyKSB7IC8vIGZyb20gbWFwXG4gICAgICBzY2hlbWEgPSBhd2FpdCB0aGlzLmZldGNoU2NoZW1hV2l0aExheWVyKClcbiAgICB9IGVsc2UgeyAvLyBmcm9tIGEgZmVhdHVyZSBzZXJ2aWNlIGl0ZW0gb3IgZmVhdHVyZSBzZXJ2aWNlIHVybCBvciBmcm9tIGEgZmVhdHVyZSBjb2xsZWN0aW9uIGl0ZW1cbiAgICAgIHNjaGVtYSA9IGF3YWl0IHRoaXMuZmV0Y2hTY2hlbWFXaXRob3V0TGF5ZXIoKVxuICAgIH1cblxuICAgIGlmICghc2NoZW1hPy5maWVsZHMpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRGF0YVNvdXJjZUVycm9yKHRoaXMuaWQsICdObyBmaWVsZHMuJykpXG4gICAgfVxuXG4gICAgcmV0dXJuIHNjaGVtYVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVMYXllckJ5SXRlbUlkICgpOiBQcm9taXNlPF9fZXNyaS5GZWF0dXJlTGF5ZXI+IHtcbiAgICBpZiAoIXRoaXMuY3JlYXRlRmVhdHVyZUxheWVyUHJvbWlzZSkge1xuICAgICAgaWYgKCF0aGlzLml0ZW1JZCkge1xuICAgICAgICB0aGlzLmNyZWF0ZUZlYXR1cmVMYXllclByb21pc2UgPSBQcm9taXNlLnJlamVjdCgnTm8gaXRlbSBpZC4nKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jcmVhdGVGZWF0dXJlTGF5ZXJQcm9taXNlID0gbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbJ2VzcmkvbGF5ZXJzL0xheWVyJywgJ2VzcmkvcG9ydGFsL1BvcnRhbEl0ZW0nXSkudGhlbihhc3luYyBtb2R1bGVzID0+IHtcbiAgICAgICAgICBjb25zdCBMYXllcjogdHlwZW9mIF9fZXNyaS5MYXllciA9IG1vZHVsZXNbMF1cbiAgICAgICAgICBjb25zdCBQb3J0YWxJdGVtOiB0eXBlb2YgX19lc3JpLlBvcnRhbEl0ZW0gPSBtb2R1bGVzWzFdXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IExheWVyLmZyb21Qb3J0YWxJdGVtKHsgcG9ydGFsSXRlbTogbmV3IFBvcnRhbEl0ZW0oeyBpZDogdGhpcy5pdGVtSWQsIHBvcnRhbDogeyB1cmw6IHRoaXMucG9ydGFsVXJsIH0gfSkgfSlcbiAgICAgICAgfSkudGhlbihhc3luYyBsYXllciA9PiB7XG4gICAgICAgICAgaWYgKGxheWVyPy50eXBlID09PSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuRmVhdHVyZUxheWVyKSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGxheWVyIGFzIF9fZXNyaS5GZWF0dXJlTGF5ZXIpXG4gICAgICAgICAgfSBlbHNlIGlmIChsYXllcj8udHlwZSA9PT0gU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLkdyb3VwTGF5ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCAobGF5ZXIgYXMgX19lc3JpLkdyb3VwTGF5ZXIpLmxvYWRBbGwoKS50aGVuKGFzeW5jIGxheWVyID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgZmVhdXJlTGF5ZXIgPSAobGF5ZXIpLmxheWVycy50b0FycmF5KCkuZmluZChcbiAgICAgICAgICAgICAgICAvLyBmZWF0dXJlIGxheWVyIGNyZWF0ZWQgZnJvbSBhIG11bHRpcGxlLWxheWVyIGZlYXR1cmUgY29sbGVjdGlvbiBpdGVtIG1heSBkbyBub3QgaGF2ZSBsYXllcklkLFxuICAgICAgICAgICAgICAgIC8vIHNvIHRpdGxlIHRvIGZpbmQgdGhlIGZlYXR1cmUgbGF5ZXJcbiAgICAgICAgICAgICAgICAobDogX19lc3JpLkZlYXR1cmVMYXllcikgPT4gYCR7bC5sYXllcklkfWAgPT09IHRoaXMubGF5ZXJJZCB8fCBkYXRhU291cmNlVXRpbHMuZml4TGF5ZXJJZChsLnRpdGxlKSA9PT0gZGF0YVNvdXJjZVV0aWxzLmZpeExheWVySWQodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFTb3VyY2VKc29uKCkuc291cmNlTGFiZWwpXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgaWYgKGZlYXVyZUxheWVyPy50eXBlID09PSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuRmVhdHVyZUxheWVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmZWF1cmVMYXllciBhcyBfX2VzcmkuRmVhdHVyZUxheWVyKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnRmVhdXJlIGxheWVyIGRhdGEgc291cmNlIGVycm9yOiBmYWlsZWQgdG8gY3JlYXRlIGZlYXR1cmUgbGF5ZXIgd2l0aCBzcGVjaWZpYyBsYXllciBpZC4nKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlRmVhdHVyZUxheWVyUHJvbWlzZVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaFNjaGVtYVdpdGhvdXRMYXllciAoKTogUHJvbWlzZTxJTURhdGFTb3VyY2VTY2hlbWE+IHtcbiAgICBjb25zdCBzZXJ2aWNlSW5mb1Byb21pc2UgPSB0aGlzLnVybCA/IFNlcnZpY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuZmV0Y2hTZXJ2aWNlSW5mbyh0aGlzLnVybCkgOiBQcm9taXNlLnJlc29sdmUobnVsbClcbiAgICByZXR1cm4gYXdhaXQgc2VydmljZUluZm9Qcm9taXNlLnRoZW4oKHNlcnZpY2VJbmZvOiBTZXJ2aWNlSW5mbykgPT4ge1xuICAgICAgaWYgKHRoaXMuaXRlbUlkKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5mZXRjaEl0ZW1EYXRhKCksIHRoaXMuZmV0Y2hJdGVtSW5mbygpXSkudGhlbigoW2l0ZW1EYXRhLCBpdGVtSW5mb10pID0+IHtcbiAgICAgICAgICBjb25zdCBsYXllckluZm8gPSBpdGVtRGF0YSAmJiBpdGVtRGF0YS5sYXllcnMgJiYgaXRlbURhdGEubGF5ZXJzW3RoaXMubGF5ZXJJZF1cbiAgICAgICAgICBjb25zdCBzZXJ2aWNlRGVmaW5pdGlvbiA9IHNlcnZpY2VJbmZvPy5kZWZpbml0aW9uID8gdGhpcy5nZXRVcGRhdGVkTGF5ZXJEZWZpbml0aW9uKGxheWVySW5mbywgc2VydmljZUluZm8uZGVmaW5pdGlvbikgOiBsYXllckluZm8/LmxheWVyRGVmaW5pdGlvblxuICAgICAgICAgIGlmICghdGhpcy5wYXJlbnREYXRhU291cmNlICYmIHNlcnZpY2VEZWZpbml0aW9uKSB7IC8vIGl0ZW0gaWQgaXMgcm9vdCBsYXllcidzIGl0ZW0gaWQsIHNvIHVzZSBpdGVtIHRpdGxlIGFzIGxhYmVsIG9ubHkgd2hlbiBjdXJyZW50IGRzIGRvZXNuJ3QgaGF2ZSBwYXJlbnQgZHNcbiAgICAgICAgICAgIC8vIHVzZSBpdGVtIHRpdGxlIGFzIGRhdGEgc291cmNlIHNjaGVtYSdzIGxhYmVsXG4gICAgICAgICAgICBzZXJ2aWNlRGVmaW5pdGlvbi5uYW1lID0gaXRlbUluZm8/LnRpdGxlIHx8IHNlcnZpY2VEZWZpbml0aW9uLm5hbWVcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlcnZpY2VEZWZpbml0aW9uLFxuICAgICAgICAgICAgZmllbGRJbmZvczogbGF5ZXJJbmZvICYmIGxheWVySW5mby5wb3B1cEluZm8gJiYgbGF5ZXJJbmZvLnBvcHVwSW5mby5maWVsZEluZm9zLFxuICAgICAgICAgICAgZmlsdGVyOiBsYXllckluZm8/LmxheWVyRGVmaW5pdGlvbj8uZGVmaW5pdGlvbkV4cHJlc3Npb24gPyBgKCR7bGF5ZXJJbmZvLmxheWVyRGVmaW5pdGlvbi5kZWZpbml0aW9uRXhwcmVzc2lvbn0pYCA6IG51bGwsXG4gICAgICAgICAgICByZWZyZXNoSW50ZXJ2YWw6IGxheWVySW5mbz8ucmVmcmVzaEludGVydmFsICogNjAgLy8gY2hhbmdlIHRvIHNlY29uZFxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc2VydmljZURlZmluaXRpb246IHNlcnZpY2VJbmZvPy5kZWZpbml0aW9uLFxuICAgICAgICAgIGZpZWxkSW5mb3M6IG51bGwsXG4gICAgICAgICAgZmlsdGVyOiBudWxsLFxuICAgICAgICAgIHJlZnJlc2hJbnRlcnZhbDogbnVsbFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSkudGhlbigoeyBzZXJ2aWNlRGVmaW5pdGlvbiwgZmllbGRJbmZvcywgZmlsdGVyLCByZWZyZXNoSW50ZXJ2YWwgfSkgPT4ge1xuICAgICAgY29uc3Qgc2NoZW1hOiBEYXRhU291cmNlU2NoZW1hID0ge1xuICAgICAgICBmaWVsZHM6IHt9LFxuICAgICAgICAvKipcbiAgICAgICAgICogV2Ugc2hvdWxkIHNhdmUgaWRGaWVsZCBpbiBzY2hlbWEsIGluc3RlYWQgb2YgZmluZGluZyBpdCBpbiBsYXllciBkZWZpbnRpb24uXG4gICAgICAgICAqIFRoZSByZWFzb24gaXM6XG4gICAgICAgICAqICAgLSBvdXRwdXQgZGF0YSBzb3VyY2UgbWF5IHVzZSBvcmlnaW5hbCBkYXRhIHNvdXJjZSdzIHNjaGVtYSxcbiAgICAgICAgICogICAtIG91dHB1dCBkYXRhIHNvdXJjZSBkb2Vzbid0IGhhdmUgbGF5ZXIgZGVmaW5pdGlvbiBhbmQgc2hvdWxkIGZpbmQgaWRGaWVsZCBmcm9tIGl0cyBzY2hlbWEuXG4gICAgICAgICAqL1xuICAgICAgICBpZEZpZWxkOiBzZXJ2aWNlRGVmaW5pdGlvbj8uaWRGaWVsZCB8fCBzZXJ2aWNlRGVmaW5pdGlvbj8uZmllbGRzPy5maW5kKGYgPT4gZi50eXBlID09PSAnZXNyaUZpZWxkVHlwZU9JRCcpPy5uYW1lIHx8ICdPQkpFQ1RJRCcsXG4gICAgICAgIGZpbHRlcixcbiAgICAgICAgcmVmcmVzaEludGVydmFsLFxuICAgICAgICBsYWJlbDogdGhpcy5sYXllcj8udGl0bGUgfHwgc2VydmljZURlZmluaXRpb24/Lm5hbWVcbiAgICAgIH1cblxuICAgICAgdGhpcy5zZXRMYXllckRlZmluaXRpb25BbmRRdWVyeUNhcGFiaWxpdGllcyhzZXJ2aWNlRGVmaW5pdGlvbilcbiAgICAgIHNlcnZpY2VEZWZpbml0aW9uPy5maWVsZHM/LmZvckVhY2goZiA9PiB7XG4gICAgICAgIGNvbnN0IGZpZWxkSW5mbyA9IGZpZWxkSW5mb3MgJiYgZmllbGRJbmZvcy5maW5kKGZpID0+IGZpLmZpZWxkTmFtZSA9PT0gZi5uYW1lKVxuICAgICAgICBjb25zdCBqaW11RmllbGQgPSBkYXRhU291cmNlVXRpbHMuY29udmVydEZpZWxkVG9KaW11RmllbGQoZiwgZmllbGRJbmZvKVxuICAgICAgICBpZiAoamltdUZpZWxkKSB7XG4gICAgICAgICAgc2NoZW1hLmZpZWxkc1tmLm5hbWVdID0gamltdUZpZWxkXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiBJbW11dGFibGUoc2NoZW1hKVxuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGZldGNoU2NoZW1hV2l0aExheWVyICgpOiBQcm9taXNlPElNRGF0YVNvdXJjZVNjaGVtYT4ge1xuICAgIHJldHVybiB0aGlzLmxheWVyLmxvYWQoKS50aGVuKCgpID0+IHtcbiAgICAgIGlmICghdGhpcy5sYXllci5maWVsZHMpIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBJZiBub3Qgc2NlbmUgbGF5ZXIncyBhc3NvY2lhdGVkIGZlYXR1cmUgbGF5ZXIgZGF0YSBzb3VyY2UsIHdlIGRvIG5vdCBzdXBwb3J0IG11bHRpcGF0Y2ggb3IgbWVzaC5cbiAgICAgICAqL1xuICAgICAgaWYgKCF0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkgJiYgKHRoaXMubGF5ZXIuZ2VvbWV0cnlUeXBlID09PSAnbXVsdGlwYXRjaCcgfHwgdGhpcy5sYXllci5nZW9tZXRyeVR5cGUgPT09ICdtZXNoJykpIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgdGhpcy51cGRhdGVMYXllckRlZmluaXRpb25CeUxheWVyKClcbiAgICAgIGNvbnN0IHNjaGVtYTogRGF0YVNvdXJjZVNjaGVtYSA9IHtcbiAgICAgICAgZmllbGRzOiB7fSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdlIHNob3VsZCBzYXZlIGlkRmllbGQgaW4gc2NoZW1hLCBpbnN0ZWFkIG9mIGZpbmRpbmcgaXQgaW4gbGF5ZXIgZGVmaW50aW9uLlxuICAgICAgICAgKiBUaGUgcmVhc29uIGlzOlxuICAgICAgICAgKiAgIC0gb3V0cHV0IGRhdGEgc291cmNlIG1heSB1c2Ugb3JpZ2luYWwgZGF0YSBzb3VyY2UncyBzY2hlbWEsXG4gICAgICAgICAqICAgLSBvdXRwdXQgZGF0YSBzb3VyY2UgZG9lc24ndCBoYXZlIGxheWVyIGRlZmluaXRpb24gYW5kIHNob3VsZCBmaW5kIGlkRmllbGQgZnJvbSBpdHMgc2NoZW1hLlxuICAgICAgICAgKi9cbiAgICAgICAgaWRGaWVsZDogdGhpcy5sYXllci5vYmplY3RJZEZpZWxkIHx8IHRoaXMubGF5ZXIuZmllbGRzPy5maW5kKGYgPT4gZi50eXBlID09PSAnb2lkJyk/Lm5hbWUgfHwgJ09CSkVDVElEJyxcbiAgICAgICAgZmlsdGVyOiB0aGlzLmxheWVyLmRlZmluaXRpb25FeHByZXNzaW9uID8gYCgke3RoaXMubGF5ZXIuZGVmaW5pdGlvbkV4cHJlc3Npb259KWAgOiBudWxsLFxuICAgICAgICByZWZyZXNoSW50ZXJ2YWw6IHRoaXMubGF5ZXIucmVmcmVzaEludGVydmFsICogNjAsXG4gICAgICAgIGxhYmVsOiB0aGlzLmxheWVyLnRpdGxlXG4gICAgICB9XG5cbiAgICAgIHRoaXMubGF5ZXIuZmllbGRzLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICBjb25zdCBmaWVsZEluZm8gPSB0aGlzLmxheWVyLnBvcHVwVGVtcGxhdGUgJiYgdGhpcy5sYXllci5wb3B1cFRlbXBsYXRlLmZpZWxkSW5mb3MgJiYgdGhpcy5sYXllci5wb3B1cFRlbXBsYXRlLmZpZWxkSW5mb3MuZmluZChmID0+IGYuZmllbGROYW1lID09PSBmaWVsZC5uYW1lKVxuICAgICAgICBjb25zdCBqaW11RmllbGQgPSBkYXRhU291cmNlVXRpbHMuY29udmVydEZpZWxkVG9KaW11RmllbGQoZmllbGQudG9KU09OKCkgYXMgSUZpZWxkLCBmaWVsZEluZm8/LnRvSlNPTigpIGFzIElGaWVsZEluZm8pXG4gICAgICAgIGlmIChqaW11RmllbGQpIHtcbiAgICAgICAgICBzY2hlbWEuZmllbGRzW2ZpZWxkLm5hbWVdID0gamltdUZpZWxkXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gSW1tdXRhYmxlKHNjaGVtYSlcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVMYXllckRlZmluaXRpb25CeUxheWVyICgpIHtcbiAgICBsZXQgbGF5ZXJEZWY6IElMYXllckRlZmluaXRpb24gPSB0aGlzLmxheWVyLnNvdXJjZUpTT05cbiAgICBjb25zdCByZW5kZXJlciA9IHRoaXMubGF5ZXIucmVuZGVyZXJcbiAgICBpZiAocmVuZGVyZXIgJiYgcmVuZGVyZXIudG9KU09OKCkpIHtcbiAgICAgIGNvbnN0IHJlbmRlcmVySlNPTiA9IHJlbmRlcmVyLnRvSlNPTigpXG4gICAgICBpZiAocmVuZGVyZXJKU09OLnR5cGUgPT09ICd1bmlxdWVWYWx1ZScpIHtcbiAgICAgICAgbGV0IHR5cGVzID0gdGhpcy5sYXllci5zb3VyY2VKU09OLnR5cGVzXG4gICAgICAgIGlmIChyZW5kZXJlckpTT04uZmllbGQxICE9PSB0aGlzLmxheWVyLnNvdXJjZUpTT04udHlwZUlkRmllbGQpIHtcbiAgICAgICAgICB0eXBlcyA9IFtdXG4gICAgICAgICAgcmVuZGVyZXJKU09OLnVuaXF1ZVZhbHVlSW5mb3MuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIHR5cGVzLnB1c2goeyBpZDogaXRlbS52YWx1ZSwgbmFtZTogaXRlbS5sYWJlbCwgZG9tYWluOiB7fSB9KVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgbGF5ZXJEZWYgPSBPYmplY3QuYXNzaWduKHsgbmFtZTogdGhpcy5sYXllci50aXRsZSB9LCBsYXllckRlZiwge1xuICAgICAgICAgIGRyYXdpbmdJbmZvOiB7IHJlbmRlcmVyOiByZW5kZXJlckpTT04gfSxcbiAgICAgICAgICB0eXBlSWRGaWVsZDogcmVuZGVyZXJKU09OLmZpZWxkMSxcbiAgICAgICAgICB0eXBlczogdHlwZXNcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zZXRMYXllckRlZmluaXRpb25BbmRRdWVyeUNhcGFiaWxpdGllcyhsYXllckRlZilcbiAgfVxuXG4gIGdldExheWVyRGVmaW5pdGlvbiAoKTogSUxheWVyRGVmaW5pdGlvbiB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5nZXRMYXllckRlZmluaXRpb24odGhpcylcbiAgfVxuXG4gIHNldExheWVyRGVmaW5pdGlvbiAobGF5ZXJEZWY6IElMYXllckRlZmluaXRpb24pIHtcbiAgICB0aGlzLmxheWVyRGVmaW5pdGlvbiA9IGxheWVyRGVmXG4gIH1cblxuICBnZXRQb3B1cEluZm8gKCk6IElQb3B1cEluZm8ge1xuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuZ2V0UG9wdXBJbmZvKHRoaXMpXG4gIH1cblxuICBzZXRQb3B1cEluZm8gKHBvcHVwSW5mbzogSVBvcHVwSW5mbykge1xuICAgIHRoaXMucG9wdXBJbmZvID0gcG9wdXBJbmZvXG4gIH1cblxuICBnZXRJdGVtSW5mbyAoKTogSUl0ZW0ge1xuICAgIGlmICh0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldEl0ZW1JbmZvKClcbiAgICB9XG4gICAgcmV0dXJuIHN1cGVyLmdldEl0ZW1JbmZvKClcbiAgfVxuXG4gIGdldENoYXJ0cyAoKTogV2ViTWFwV2ViQ2hhcnRbXSB7XG4gICAgY29uc3QgbWFpbkRzID0gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsXG4gICAgLyoqXG4gICAgICogSWYgdGhlIGxheWVyIGNvbnRhaW5zIGNoYXJ0cyAoZnJvbSBsYXllciBpdGVtKSBidXQgZGlkbid0IG9wZW4gdGhlIGNoYXJ0cyBpbiBtYXAgdmlld2VyLFxuICAgICAqIC0gdGhlIGNoYXJ0cyB3b24ndCBiZSBzYXZlZCB0byBtYXAgaXRlbSBkYXRhLlxuICAgICAqIC0gdGhlIEpTQVBJIGxheWVyIG9iamVjdCBjb250YWlucyBjaGFydHMgKGxvYWRlZCBieSBKU0FQSSkuXG4gICAgICovXG4gICAgaWYgKG1haW5Ecz8ubGF5ZXIpIHtcbiAgICAgIHJldHVybiAobWFpbkRzLmxheWVyIGFzIGFueSkuY2hhcnRzIGFzIFdlYk1hcFdlYkNoYXJ0W11cbiAgICB9IGVsc2UgaWYgKG1haW5Ecz8uZ2V0SXRlbURhdGEoKSkge1xuICAgICAgY29uc3QgbGF5ZXJJbmZvID0gbWFpbkRzLmdldEl0ZW1EYXRhKCk/LmxheWVycz8uZmluZChsID0+IGAke2wuaWR9YCA9PT0gdGhpcy5sYXllcklkKVxuICAgICAgcmV0dXJuIChsYXllckluZm8/LmNoYXJ0cykgYXMgV2ViTWFwV2ViQ2hhcnRbXVxuICAgIH1cbiAgICByZXR1cm4gW11cbiAgfVxuXG4gIHByaXZhdGUgc2V0TGF5ZXJEZWZpbml0aW9uQW5kUXVlcnlDYXBhYmlsaXRpZXMgKGxheWVyRGVmOiBJTGF5ZXJEZWZpbml0aW9uKSB7XG4gICAgdGhpcy5zZXRMYXllckRlZmluaXRpb24obGF5ZXJEZWYpXG4gICAgY29uc3QgaXNGZWF0dXJlQ29sbGVjdGlvbiA9ICF0aGlzLnVybCAmJiAhIXRoaXMuaXRlbUlkXG4gICAgdGhpcy5zZXRDYXBhYmlsaXRpZXMobmV3IEZlYXR1cmVMYXllckNhcGFiaWxpdGllc0ltcGwoeyBsYXllckRlZmluaXRpb246IGxheWVyRGVmLCBpc0NsaWVudFNpZGU6IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc0RhdGFJbkRhdGFTb3VyY2VJbnN0YW5jZSB8fCBpc0ZlYXR1cmVDb2xsZWN0aW9uIH0pKVxuICB9XG5cbiAgZ2V0Q2FwYWJpbGl0aWVzICgpOiBGZWF0dXJlTGF5ZXJDYXBhYmlsaXRpZXMge1xuICAgIHJldHVybiBzdXBlci5nZXRDYXBhYmlsaXRpZXMoKSBhcyBGZWF0dXJlTGF5ZXJDYXBhYmlsaXRpZXNcbiAgfVxuXG4gIGJ1aWxkUmVjb3JkIChmZWF0dXJlOiBJRmVhdHVyZSB8IF9fZXNyaS5HcmFwaGljKTogRmVhdHVyZURhdGFSZWNvcmQge1xuICAgIHJldHVybiBuZXcgRmVhdHVyZURhdGFSZWNvcmRJbXBsKGZlYXR1cmUsIHRoaXMgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSlcbiAgfVxuXG4gIGdldEZpZWxkQ29kZWRWYWx1ZUxpc3QgKGppbXVGaWVsZE5hbWU6IHN0cmluZywgcmVjb3JkPzogRmVhdHVyZURhdGFSZWNvcmQpOiBDb2RlZFZhbHVlW10ge1xuICAgIGxldCBmaWVsZE5hbWUgPSAnJ1xuICAgIGNvbnN0IGZpZWxkcyA9IHRoaXMuZ2V0U2NoZW1hKCkuZmllbGRzXG4gICAgT2JqZWN0LmtleXMoZmllbGRzKS5zb21lKG5hbWUgPT4ge1xuICAgICAgaWYgKG5hbWUgPT09IGppbXVGaWVsZE5hbWUpIHtcbiAgICAgICAgZmllbGROYW1lID0gZmllbGRzW25hbWVdLm5hbWVcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5nZXRDb2RlZFZhbHVlTGlzdEZvckNvZGVkVmFsdWVPclN1YnR5cGVGaWVsZCh0aGlzLmdldExheWVyRGVmaW5pdGlvbigpLCBmaWVsZE5hbWUsIHJlY29yZClcbiAgfVxuXG4gIGdldEdEQlZlcnNpb24gKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0SW5mbygpLmdkYlZlcnNpb25cbiAgfVxuXG4gIGNoYW5nZUdEQlZlcnNpb24gKGdkYlZlcnNpb246IHN0cmluZykge1xuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5jaGFuZ2VEYXRhU291cmNlR0RCVmVyc2lvbih0aGlzLmlkLCBnZGJWZXJzaW9uKSlcbiAgICBpZiAodGhpcy5sYXllcikge1xuICAgICAgdGhpcy5sYXllci5nZGJWZXJzaW9uID0gZ2RiVmVyc2lvblxuICAgIH1cbiAgfVxuXG4gIC8vIHVwZGF0ZSBzZXJ2aWNlSW5mbyBmcm9tIGxheWVySW5mbyBmb3IgbGF5ZXIgaXRlbVxuICBwcml2YXRlIGdldFVwZGF0ZWRMYXllckRlZmluaXRpb24gKGxheWVySW5mbywgc2VydmljZURlZmluaXRpb24pIHtcbiAgICBsZXQgdXBkYXRlZERlZmluaXRpb24gPSBzZXJ2aWNlRGVmaW5pdGlvblxuICAgIGlmIChsYXllckluZm8gJiYgbGF5ZXJJbmZvLmxheWVyRGVmaW5pdGlvbikge1xuICAgICAgbGV0IHVwZGF0ZWRPcHRpb25zXG4gICAgICBjb25zdCBkcmF3aW5nSW5mbyA9IGxheWVySW5mby5sYXllckRlZmluaXRpb24uZHJhd2luZ0luZm9cbiAgICAgIGlmIChkcmF3aW5nSW5mbykge1xuICAgICAgICBpZiAoZHJhd2luZ0luZm8ucmVuZGVyZXIgJiYgZHJhd2luZ0luZm8ucmVuZGVyZXIudHlwZSA9PT0gJ3VuaXF1ZVZhbHVlJykge1xuICAgICAgICAgIC8vIHVwZGF0ZSB0eXBlcyhpZCwgbmFtZSkgZnJvbSBkcmF3aW5nSW5mbyh2YWx1ZSxsYWJlbClcbiAgICAgICAgICBsZXQgdHlwZXMgPSBzZXJ2aWNlRGVmaW5pdGlvbi50eXBlc1xuICAgICAgICAgIGlmIChkcmF3aW5nSW5mby5yZW5kZXJlci5maWVsZDEgIT09IHNlcnZpY2VEZWZpbml0aW9uLnR5cGVJZEZpZWxkKSB7XG4gICAgICAgICAgICB0eXBlcyA9IFtdXG4gICAgICAgICAgICBkcmF3aW5nSW5mby5yZW5kZXJlci51bmlxdWVWYWx1ZUluZm9zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAgIHR5cGVzLnB1c2goeyBpZDogaXRlbS52YWx1ZSwgbmFtZTogaXRlbS5sYWJlbCwgZG9tYWluOiB7fSB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgICAgdXBkYXRlZE9wdGlvbnMgPSB7XG4gICAgICAgICAgICBkZWZhdWx0VmlzaWJpbGl0eTogbGF5ZXJJbmZvLmxheWVyRGVmaW5pdGlvbi5kZWZhdWx0VmlzaWJpbGl0eSxcbiAgICAgICAgICAgIGRyYXdpbmdJbmZvOiBsYXllckluZm8ubGF5ZXJEZWZpbml0aW9uLmRyYXdpbmdJbmZvLFxuICAgICAgICAgICAgdHlwZUlkRmllbGQ6IGRyYXdpbmdJbmZvLnJlbmRlcmVyLmZpZWxkMSxcbiAgICAgICAgICAgIHR5cGVzOiB0eXBlc1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChsYXllckluZm8ubGF5ZXJEZWZpbml0aW9uLmRlZmF1bHRWaXNpYmlsaXR5ICE9PSBzZXJ2aWNlRGVmaW5pdGlvbi5kZWZhdWx0VmlzaWJpbGl0eSkge1xuICAgICAgICB1cGRhdGVkT3B0aW9ucyA9IHsgZGVmYXVsdFZpc2liaWxpdHk6IGxheWVySW5mby5sYXllckRlZmluaXRpb24uZGVmYXVsdFZpc2liaWxpdHkgfVxuICAgICAgfVxuICAgICAgdXBkYXRlZERlZmluaXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCB1cGRhdGVkRGVmaW5pdGlvbiwgdXBkYXRlZE9wdGlvbnMpXG4gICAgfVxuICAgIHJldHVybiB1cGRhdGVkRGVmaW5pdGlvblxuICB9XG5cbiAgcHJpdmF0ZSBnZXRPcmRlckJ5QXJyYXkgKG9yZGVyQnlzOiBJbW11dGFibGUuSW1tdXRhYmxlQXJyYXk8T3JkZXJCeU9wdGlvbj4pOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIG9yZGVyQnlzPy5tYXAob3JkZXJCeSA9PiB7XG4gICAgICByZXR1cm4gb3JkZXJCeS5qaW11RmllbGROYW1lICsgJyAnICsgb3JkZXJCeS5vcmRlclxuICAgIH0pLmFzTXV0YWJsZSgpID8/IFtdXG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHRvIElRdWVyeUZlYXR1cmVzT3B0aW9ucywgdG8gcXVlcnkgZmVhdHVyZXMgYnkgc2VydmljZSB1cmwuXG4gICAqL1xuICBjaGFuZ2VKaW11UXVlcnlUb1Jlc3RBUElRdWVyeSAocXVlcnlQYXJhbXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBJUXVlcnlGZWF0dXJlc09wdGlvbnMge1xuICAgIGlmICghcXVlcnlQYXJhbXMpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgY29uc3QgcTogYW55ID0gcXVlcnlQYXJhbXMuYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KVxuXG4gICAgaWYgKHR5cGVvZiBxLnBhZ2VTaXplID09PSAnbnVtYmVyJykge1xuICAgICAgY29uc3QgcGFnZSA9IHEucGFnZSA/PyAxXG4gICAgICBxLnJlc3VsdE9mZnNldCA9IChwYWdlIC0gMSkgKiBxLnBhZ2VTaXplXG4gICAgICBxLnJlc3VsdFJlY29yZENvdW50ID0gcS5wYWdlU2l6ZVxuXG4gICAgICAvKipcbiAgICAgICAqIFdlIGRvbid0IGNoYW5nZSBxdWVyeSBwYWdlIHNpemUgaW4gYmFzZSBjbGFzcywgYmVjYXVzZSBpbiBnZW5lcmFsIGNhc2UsIGRldmVsb3BlcnMgZXhwZWN0IHRoZSBwYWdlIHNpemUgaXMgZml4ZWQuXG4gICAgICAgKi9cbiAgICAgIGlmICh0aGlzLmdldE1heFJlY29yZENvdW50KCkgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKHBhZ2UgPT09IDEpIHsgLy8gZmlyc3QgcGFnZVxuICAgICAgICAgIHEucmVzdWx0UmVjb3JkQ291bnQgPSBNYXRoLm1pbih0aGlzLmdldE1heFJlY29yZENvdW50KCksIHEucGFnZVNpemUpXG4gICAgICAgIH0gZWxzZSBpZiAocGFnZSAqIHEucGFnZVNpemUgPiB0aGlzLmdldE1heFJlY29yZENvdW50KCkpIHsgLy8gbGFzdCBwYWdlXG4gICAgICAgICAgcS5yZXN1bHRSZWNvcmRDb3VudCA9IHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSAtIChwYWdlIC0gMSkgKiBxLnBhZ2VTaXplXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZGVsZXRlIHEucGFnZVxuICAgICAgZGVsZXRlIHEucGFnZVNpemVcbiAgICB9XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShxLm9yZGVyQnlGaWVsZHMpKSB7XG4gICAgICBxLm9yZGVyQnlGaWVsZHMgPSBxLm9yZGVyQnlGaWVsZHMuam9pbignLCcpXG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KHEuZ3JvdXBCeUZpZWxkc0ZvclN0YXRpc3RpY3MpKSB7XG4gICAgICBxLmdyb3VwQnlGaWVsZHNGb3JTdGF0aXN0aWNzID0gcS5ncm91cEJ5RmllbGRzRm9yU3RhdGlzdGljcy5qb2luKCcsJylcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkocS50aW1lKSkge1xuICAgICAgcS50aW1lID0gcS50aW1lLmpvaW4oJywnKVxuICAgIH1cblxuICAgIGlmIChxLm91dFN0YXRpc3RpY3M/LnNvbWUoc3RhdCA9PiBzdGF0LnN0YXRpc3RpY1BhcmFtZXRlcnM/Lm9yZGVyQnkpKSB7XG4gICAgICBxLm91dFN0YXRpc3RpY3MgPSBxLm91dFN0YXRpc3RpY3MubWFwKHN0YXQgPT4ge1xuICAgICAgICBpZiAoc3RhdC5zdGF0aXN0aWNQYXJhbWV0ZXJzPy5vcmRlckJ5KSB7XG4gICAgICAgICAgc3RhdC5zdGF0aXN0aWNQYXJhbWV0ZXJzLm9yZGVyQnkgPSBzdGF0LnN0YXRpc3RpY1BhcmFtZXRlcnMub3JkZXJCeS50b1VwcGVyQ2FzZSgpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0YXRcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIHEgYXMgSVF1ZXJ5RmVhdHVyZXNPcHRpb25zXG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHRvIF9fZXNyaS5RdWVyeSB8IF9fZXNyaS5RdWVyeVByb3BlcnRpZXMsIHRvIHF1ZXJ5IGZlYXR1cmVzIGJ5IGxheWVyIChpbnN0YW5jZSBvZiBBcmNHSVMgTWFwcyBTREsgZm9yIEphdmFTY3JpcHQgRmVhdHVyZUxheWVyIGNsYXNzKS5cbiAgICovXG4gIGFzeW5jIGNoYW5nZUppbXVRdWVyeVRvSlNBUElRdWVyeSAocXVlcnlQYXJhbXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBQcm9taXNlPF9fZXNyaS5RdWVyeSB8IF9fZXNyaS5RdWVyeVByb3BlcnRpZXM+IHtcbiAgICByZXR1cm4gYXdhaXQgZGF0YVNvdXJjZVV0aWxzLmNoYW5nZUppbXVGZWF0dXJlTGF5ZXJRdWVyeVRvSlNBUElMYXllclF1ZXJ5KHRoaXMsIHF1ZXJ5UGFyYW1zKVxuICB9XG5cbiAgcHJpdmF0ZSBkb1F1ZXJ5QnlVcmxDYXBhYmlsaXRpZXMgKHF1ZXJ5UGFyYW1zOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zLCB1cmw6IHN0cmluZyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICBjb25zdCBxdWVyeTogSVF1ZXJ5RmVhdHVyZXNPcHRpb25zID0gdGhpcy5jaGFuZ2VKaW11UXVlcnlUb1Jlc3RBUElRdWVyeShxdWVyeVBhcmFtcylcbiAgICBpZiAocXVlcnkucmV0dXJuQ291bnRPbmx5KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdUbyBxdWVyeSBjb3VudCwgcGxlYXNlIHVzZSBxdWVyeUNvdW50LicpXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ1RvIHF1ZXJ5IGNvdW50LCBwbGVhc2UgdXNlIHF1ZXJ5Q291bnQuJylcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3EocXVlcnksIHVybCkudGhlbigocXVlcnlSZXNwb25zZTogSVF1ZXJ5RmVhdHVyZXNSZXNwb25zZSkgPT4ge1xuICAgICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXModGhpcy5nZXRTY2hlbWEoKS5maWVsZHMpLmZpbHRlcihqaW11RmllbGROYW1lID0+IHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5UmVzcG9uc2UuZmllbGRzICYmIHF1ZXJ5UmVzcG9uc2UuZmllbGRzLmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gdGhpcy5nZXRTY2hlbWEoKS5maWVsZHNbamltdUZpZWxkTmFtZV0ubmFtZSlcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHF1ZXJ5UmVzdWx0OiBRdWVyeVJlc3VsdCA9IHtcbiAgICAgICAgcXVlcnlQYXJhbXM6IHF1ZXJ5UGFyYW1zLFxuICAgICAgICBmaWVsZHM6IGZpZWxkcyxcbiAgICAgICAgcmVjb3JkczogKFxuICAgICAgICAgIHF1ZXJ5UmVzcG9uc2UuZmVhdHVyZXNcbiAgICAgICAgICAgID8gcXVlcnlSZXNwb25zZS5mZWF0dXJlcy5tYXAoZmVhdHVyZSA9PiBuZXcgRmVhdHVyZURhdGFSZWNvcmRJbXBsKGZlYXR1cmUsIHRoaXMpKVxuICAgICAgICAgICAgOiAocXVlcnlSZXNwb25zZSBhcyBhbnkpLm9iamVjdElkcz8ubWFwKGlkID0+IG5ldyBGZWF0dXJlRGF0YVJlY29yZEltcGwoeyBhdHRyaWJ1dGVzOiB7IFt0aGlzLmdldElkRmllbGQoKV06IGlkIH0gfSwgdGhpcykpXG4gICAgICAgICkgfHwgW11cbiAgICAgIH1cbiAgICAgIHJldHVybiBxdWVyeVJlc3VsdFxuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRvUXVlcnlCeUxheWVyQ2FwYWJpbGl0aWVzIChxdWVyeVBhcmFtczogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgbGF5ZXI6IF9fZXNyaS5GZWF0dXJlTGF5ZXIpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgY29uc3QgcXVlcnkgPSBhd2FpdCB0aGlzLmNoYW5nZUppbXVRdWVyeVRvSlNBUElRdWVyeShxdWVyeVBhcmFtcylcbiAgICBjb25zdCBsYXllclZpZXcgPSB0aGlzLmdldExheWVyVmlld0ZvckNsaWVudFNpZGVRdWVyeShsYXllcilcblxuICAgIGlmICgocXVlcnlQYXJhbXMgYXMgYW55KS5yZXR1cm5JZHNPbmx5KSB7XG4gICAgICBkZWxldGUgKHF1ZXJ5IGFzIGFueSkucmV0dXJuSWRzT25seVxuXG4gICAgICBsZXQgb2JqZWN0SWRzOiBudW1iZXJbXVxuICAgICAgbGV0IGlzQ2xpZW50UXVlcnlTdWNjZXNzID0gZmFsc2VcblxuICAgICAgaWYgKGxheWVyVmlldykge1xuICAgICAgICBjb25zdCBjbGllbnRRdWVyeVJlc3VsdCA9IGF3YWl0IGxheWVyVmlldy5jbGllbnRRdWVyeU9iamVjdElkcyhxdWVyeVBhcmFtcylcblxuICAgICAgICBpZiAoY2xpZW50UXVlcnlSZXN1bHQ/LnN1Y2Nlc3MpIHtcbiAgICAgICAgICBpc0NsaWVudFF1ZXJ5U3VjY2VzcyA9IHRydWVcbiAgICAgICAgICBvYmplY3RJZHMgPSBjbGllbnRRdWVyeVJlc3VsdC5kYXRhXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFpc0NsaWVudFF1ZXJ5U3VjY2Vzcykge1xuICAgICAgICBvYmplY3RJZHMgPSBhd2FpdCBsYXllci5xdWVyeU9iamVjdElkcyhxdWVyeSlcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVjb3JkcyA9IG9iamVjdElkcz8ubWFwKGlkID0+IG5ldyBGZWF0dXJlRGF0YVJlY29yZEltcGwoeyBhdHRyaWJ1dGVzOiB7IFt0aGlzLmdldElkRmllbGQoKV06IGlkIH0gfSwgdGhpcykpXG4gICAgICBjb25zdCBmaWVsZHMgPSBbdGhpcy5nZXRJZEZpZWxkKCldXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHF1ZXJ5UGFyYW1zOiBxdWVyeVBhcmFtcyxcbiAgICAgICAgcmVjb3JkcyxcbiAgICAgICAgZmllbGRzXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBmZWF0dXJlU2V0OiBfX2VzcmkuRmVhdHVyZVNldFxuICAgICAgbGV0IGlzQ2xpZW50UXVlcnlTdWNjZXNzID0gZmFsc2VcbiAgICAgIGxldCBoYXNGdWxsR2VvbWV0cmllcyA9IHRydWVcblxuICAgICAgaWYgKGxheWVyVmlldykge1xuICAgICAgICBsZXQgY2xpZW50UXVlcnlQYXJhbXMgPSBxdWVyeVBhcmFtc1xuICAgICAgICAvLyBTZXJ2ZXItc2lkZSBxdWVyeSB1c2VzIGlkIGZpZWxkIHRvIHNvcnQgcmVjb3JkcyBieSBkZWZhdWx0LiBUbyBnZXQgdGhlIGNvcnJlY3QgcGFnZSBmcm9tIGNsaWVudC1zaWRlIHF1ZXJ5LCB1c2UgdGhlIHNhbWUgcnVsZS5cbiAgICAgICAgaWYgKCFjbGllbnRRdWVyeVBhcmFtcy5vcmRlckJ5RmllbGRzPy5sZW5ndGgpIHtcbiAgICAgICAgICBjbGllbnRRdWVyeVBhcmFtcyA9IGNsaWVudFF1ZXJ5UGFyYW1zLnNldCgnb3JkZXJCeUZpZWxkcycsIFt0aGlzLmdldElkRmllbGQoKV0pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjbGllbnRRdWVyeVJlc3VsdCA9IGF3YWl0IGxheWVyVmlldy5jbGllbnRRdWVyeUZlYXR1cmVzKGNsaWVudFF1ZXJ5UGFyYW1zKVxuXG4gICAgICAgIGlmIChjbGllbnRRdWVyeVJlc3VsdD8uc3VjY2Vzcykge1xuICAgICAgICAgIGlzQ2xpZW50UXVlcnlTdWNjZXNzID0gdHJ1ZVxuICAgICAgICAgIGZlYXR1cmVTZXQgPSBjbGllbnRRdWVyeVJlc3VsdC5kYXRhXG4gICAgICAgICAgaGFzRnVsbEdlb21ldHJpZXMgPSBjbGllbnRRdWVyeVJlc3VsdC5oYXNGdWxsR2VvbWV0cmllc1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNDbGllbnRRdWVyeVN1Y2Nlc3MpIHtcbiAgICAgICAgZmVhdHVyZVNldCA9IGF3YWl0IGxheWVyLnF1ZXJ5RmVhdHVyZXMocXVlcnkpXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlY29yZHMgPSBmZWF0dXJlU2V0LmZlYXR1cmVzLm1hcChmID0+IG5ldyBGZWF0dXJlRGF0YVJlY29yZEltcGwoZiwgdGhpcywgeyBoYXNGdWxsR2VvbWV0cmllcyB9KSlcbiAgICAgIGNvbnN0IGZpZWxkcyA9IE9iamVjdC5rZXlzKHRoaXMuZ2V0U2NoZW1hKCkuZmllbGRzKS5maWx0ZXIoamltdUZpZWxkTmFtZSA9PiB7XG4gICAgICAgIHJldHVybiBmZWF0dXJlU2V0LmZpZWxkcyAmJiBmZWF0dXJlU2V0LmZpZWxkcy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IHRoaXMuZ2V0U2NoZW1hKCkuZmllbGRzW2ppbXVGaWVsZE5hbWVdLm5hbWUpXG4gICAgICB9KVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBxdWVyeVBhcmFtczogcXVlcnlQYXJhbXMsXG4gICAgICAgIHJlY29yZHMsXG4gICAgICAgIGZpZWxkc1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0TGF5ZXJWaWV3Rm9yQ2xpZW50U2lkZVF1ZXJ5ICh1c2VMYXllcjogX19lc3JpLkZlYXR1cmVMYXllcik6IEppbXVGZWF0dXJlTGF5ZXJWaWV3IHtcbiAgICAvLyBJZiByb290IGRhdGEgc291cmNlIGRvZXNuJ3QgaGF2ZSBtYXAgb3IgdGhlIGxheWVyIHVzZSB0byBxdWVyeSBpcyBub3QgYSBtYXAgbGF5ZXIgKGUuZy4gc2VsZWN0aW9uIHZpZXcgdXNlIGEgY2xpZW50LXNpZGUgbGF5ZXIgdG8gZG8gcXVlcnkpLCB0aGVyZSBtdXN0IGJlIG5vIGNvcnJlc3BvbmRpbmcgbGF5ZXIgdmlldy5cbiAgICBpZiAoISh0aGlzLmdldFJvb3REYXRhU291cmNlKCkgYXMgYW55KT8ubWFwIHx8IHVzZUxheWVyICE9PSB0aGlzLmxheWVyKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGNvbnN0IEppbXVBcmNnaXMgPSBtb2R1bGVMb2FkZXIuZ2V0TW9kdWxlU3luYygnamltdS1hcmNnaXMnKVxuICAgIGNvbnN0IG1hcFZpZXdNYW5hZ2VyOiBNYXBWaWV3TWFuYWdlciA9IEppbXVBcmNnaXM/Lk1hcFZpZXdNYW5hZ2VyPy5nZXRJbnN0YW5jZSgpXG4gICAgcmV0dXJuIG1hcFZpZXdNYW5hZ2VyPy5nZXRKaW11TGF5ZXJWaWV3Rm9yQ2xpZW50UXVlcnkodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpKSBhcyBKaW11RmVhdHVyZUxheWVyVmlld1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBfcSAocXVlcnlQYXJhbXM6IElRdWVyeUZlYXR1cmVzT3B0aW9ucywgdXJsOiBzdHJpbmcpOiBQcm9taXNlPElRdWVyeUZlYXR1cmVzUmVzcG9uc2U+IHtcbiAgICBjb25zdCBxdWVyeVN0cmluZyA9IE9iamVjdC5rZXlzKHF1ZXJ5UGFyYW1zIHx8IHt9KS5yZWR1Y2UoKHByZXZpb3VzLCBjdXJyZW50KSA9PiB7XG4gICAgICBpZiAodHlwZW9mIHF1ZXJ5UGFyYW1zW2N1cnJlbnRdICE9PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gYCR7cHJldmlvdXN9JiR7Y3VycmVudH09JHtxdWVyeVBhcmFtc1tjdXJyZW50XX1gXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYCR7cHJldmlvdXN9JiR7Y3VycmVudH09JHtKU09OLnN0cmluZ2lmeShxdWVyeVBhcmFtc1tjdXJyZW50XSl9YFxuICAgICAgfVxuICAgIH0sICcnKVxuICAgIGNvbnN0IHJhd1VybCA9IGAke3VybH0/JHtxdWVyeVN0cmluZ31gXG4gICAgY29uc3QgcmF3VXJsTGVuZ3RoID0gcmF3VXJsLmxlbmd0aFxuICAgIGNvbnN0IHVzZVBvc3QgPSByYXdVcmxMZW5ndGggPiAxNTAwIC8vIGRlZmF1bHQgbWF4IHVybCBsZW5ndGggb2YgSlMgQVBJIGlzIDIwMDBcbiAgICBjb25zdCBvcHRpb25zOiBJUXVlcnlGZWF0dXJlc09wdGlvbnMgPSB7XG4gICAgICB1cmwsXG4gICAgICBodHRwTWV0aG9kOiB1c2VQb3N0ID8gJ1BPU1QnIDogJ0dFVCcsXG4gICAgICAuLi5xdWVyeVBhcmFtc1xuICAgIH1cbiAgICAvLyB0aW1lUmVmZXJlbmNlVW5rbm93bkNsaWVudCB3aWxsIGJlIHJlbW92ZWQgYnkgZXNyaS5yZXN0RmVhdHVyZUxheWVyLnF1ZXJ5RmVhdHVyZXMsIHB1dCBpdCBpbnRvIHBhcmFtcy5cbiAgICBpZiAoKG9wdGlvbnMgYXMgYW55KS50aW1lUmVmZXJlbmNlVW5rbm93bkNsaWVudCkge1xuICAgICAgb3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgICAgIHdoZXJlOiBvcHRpb25zLndoZXJlIHx8ICcxPTEnLCAvLyBzZXQgZGVmYXVsdCBxdWVyeSBwYXJhbWV0ZXJzXG4gICAgICAgIG91dEZpZWxkczogb3B0aW9ucy5vdXRGaWVsZHMgfHwgJyonLCAvLyBzZXQgZGVmYXVsdCBxdWVyeSBwYXJhbWV0ZXJzXG4gICAgICAgIHRpbWVSZWZlcmVuY2VVbmtub3duQ2xpZW50OiB0cnVlXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCByZXF1ZXN0VXRpbHMucmVxdWVzdFdyYXBwZXIodXJsLCBhc3luYyAoc2Vzc2lvbikgPT4ge1xuICAgICAgb3B0aW9ucy5hdXRoZW50aWNhdGlvbiA9IHNlc3Npb25cbiAgICAgIHJldHVybiBhd2FpdCBlc3JpLnJlc3RGZWF0dXJlTGF5ZXIucXVlcnlGZWF0dXJlcyhvcHRpb25zKVxuICAgIH0sIDEpXG4gIH1cblxuICBnZXRUaW1lem9uZSAoKTogJ3Vua25vd24nIHwgJ2RldmljZScgfCBzdHJpbmcge1xuICAgIGlmIChkYXRhU291cmNlVXRpbHMuYXJlRGF0ZXNJblVua25vd25UaW1lem9uZSh0aGlzKSkge1xuICAgICAgcmV0dXJuICd1bmtub3duJ1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB0aW1lem9uZUluQXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbmZpZy5hdHRyaWJ1dGVzPy50aW1lem9uZVxuICAgICAgaWYgKCF0aW1lem9uZUluQXBwQ29uZmlnIHx8IHRpbWV6b25lSW5BcHBDb25maWcudHlwZSA9PT0gVGltZXpvbmVUeXBlLkRldmljZSkgeyAvLyBkZWZhdWx0IHRpbWV6b25lIGluIGFwcCBjb25maWcgaXMgZGV2aWNlXG4gICAgICAgIHJldHVybiAnZGV2aWNlJ1xuICAgICAgfSBlbHNlIGlmICh0aW1lem9uZUluQXBwQ29uZmlnLnR5cGUgPT09IFRpbWV6b25lVHlwZS5TcGVjaWZpYykge1xuICAgICAgICByZXR1cm4gdGltZXpvbmVJbkFwcENvbmZpZy52YWx1ZVxuICAgICAgfSBlbHNlIGlmICh0aW1lem9uZUluQXBwQ29uZmlnLnR5cGUgPT09IFRpbWV6b25lVHlwZS5EYXRhKSB7XG4gICAgICAgIGNvbnN0IGNhbkNvbmZpZ0luTWFwVmlld2VyID0gISEodGhpcy5nZXRSb290RGF0YVNvdXJjZSgpIGFzIGFueSk/Lm1hcFxuICAgICAgICBpZiAoY2FuQ29uZmlnSW5NYXBWaWV3ZXIpIHtcbiAgICAgICAgICBjb25zdCByb290RHNUaW1lem9uZSA9ICh0aGlzLmdldFJvb3REYXRhU291cmNlKCkgYXMgYW55KS5tYXAucmVzb3VyY2VJbmZvPy50aW1lWm9uZVxuICAgICAgICAgIGlmICghcm9vdERzVGltZXpvbmUgfHwgcm9vdERzVGltZXpvbmUgPT09ICdzeXN0ZW0nKSB7IC8vIGRldmljZSwgZGVmYXVsdCB0aW1lem9uZSBpbiBtYXAgdmlld2VyXG4gICAgICAgICAgICByZXR1cm4gJ2RldmljZSdcbiAgICAgICAgICB9IGVsc2UgaWYgKHJvb3REc1RpbWV6b25lID09PSAndW5rbm93bicpIHsgLy8gZGF0YVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TGF5ZXJUaW1lem9uZSgpXG4gICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygcm9vdERzVGltZXpvbmUgPT09ICdzdHJpbmcnKSB7IC8vIHNwZWNpZmljXG4gICAgICAgICAgICByZXR1cm4gcm9vdERzVGltZXpvbmVcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TGF5ZXJUaW1lem9uZSgpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgcHJpdmF0ZSBnZXRMYXllclRpbWV6b25lICgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmdldExheWVyRGVmaW5pdGlvbigpPy5kYXRlRmllbGRzVGltZVJlZmVyZW5jZT8udGltZVpvbmUgfHwgbnVsbFxuICB9XG5cbiAgYWxsb3dUb0V4cG9ydERhdGEgKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIC8qKlxuICAgICAqIElmIGlzIGRhdGEgdmlldyBvciBsb2NhbCBkYXRhIHNvdXJjZSwgdXNlIG1haW4gZGF0YSBzb3VyY2UncyBleHBvcnQgc2V0dGluZy5cbiAgICAgKi9cbiAgICBpZiAodGhpcy5pc0RhdGFWaWV3IHx8IHRoaXMuaXNMb2NhbCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5hbGxvd1RvRXhwb3J0RGF0YSgpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgaXMgb3V0cHV0IGRhdGEgc291cmNlLCB1c2UgaXRzIG9yaWdpbmFsIGRhdGEgc291cmNlJ3MgZXhwb3J0IHNldHRpbmcuXG4gICAgICovXG4gICAgaWYgKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pc091dHB1dEZyb21XaWRnZXQgJiYgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLm9yaWdpbkRhdGFTb3VyY2VzPy5sZW5ndGggPT09IDEpIHtcbiAgICAgIGNvbnN0IG9yaWdpbkRzSWQgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkub3JpZ2luRGF0YVNvdXJjZXNbMF0/LmRhdGFTb3VyY2VJZFxuICAgICAgY29uc3Qgb3JpZ2luRHMgPSBvcmlnaW5Ec0lkICYmICh0aGlzLmRhdGFTb3VyY2VNYW5hZ2VyLmdldERhdGFTb3VyY2Uob3JpZ2luRHNJZCkgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSB8IFNjZW5lTGF5ZXJEYXRhU291cmNlKVxuICAgICAgaWYgKG9yaWdpbkRzKSB7XG4gICAgICAgIHJldHVybiBvcmlnaW5Ecy5hbGxvd1RvRXhwb3J0RGF0YSgpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdPcmlnaW4gZGF0YSBzb3VyY2UgaXMgbm90IGNyZWF0ZWQsIGFsbG93IHRvIGV4cG9ydCBkYXRhIGJ5IGRlZmF1bHQuIE91dHB1dCBkYXRhIHNvdXJjZSBpZCBpcyAnLCB0aGlzLmlkKVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgYWxsb3dJbkRhdGFTb3VyY2UgPSAhdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmRpc2FibGVFeHBvcnRcbiAgICBpZiAoYWxsb3dJbkRhdGFTb3VyY2UpIHtcbiAgICAgIHJldHVybiB0aGlzLmFsbG93VG9FeHBvcnREYXRhSW5SZW1vdGUoKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBObyBuZWVkIHRvIGNoZWNrIHJlbW90ZSBpZiBkb2Vzbid0IGFsbG93IHRvIGV4cG9ydCBkYXRhIGluIGRhdGEgc291cmNlIHNldHRpbmcuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYWxsb3dUb0V4cG9ydERhdGFJblJlbW90ZSAoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCF0aGlzLmFsbG93RXhwb3J0UmVtb3RlQ2hlY2tQcm9taXNlKSB7XG4gICAgICB0aGlzLmFsbG93RXhwb3J0UmVtb3RlQ2hlY2tQcm9taXNlID0gcHJveHlVdGlscy5pc0RhdGFTb3VyY2VTdWJzY3JpYmVyT3JQcmVtaXVtKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKSkudGhlbihpc1N1YnNjcmliZXJPclByZW1pdW0gPT4ge1xuICAgICAgICAvLyBEbyBub3QgYWxsb3cgdG8gZXhwb3J0IHN1YnNjcmliZXIgZGF0YSBvciBwcmVtaXVtIGRhdGEuXG4gICAgICAgIGlmIChpc1N1YnNjcmliZXJPclByZW1pdW0pIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfSBlbHNlIGlmICghZGF0YVNvdXJjZVV0aWxzLmlzQUdPTEhvc3RlZFNlcnZpY2UodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnVybCkpIHsgLy8gSWYgc2VydmljZSBpcyBub3QgaG9zdGVkLCBhbGxvdyB0byBleHBvcnQgaW4gcmVtb3RlLlxuICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYWxsb3dUb0V4cG9ydERhdGFJbkl0ZW0oKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmFsbG93RXhwb3J0UmVtb3RlQ2hlY2tQcm9taXNlXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGFsbG93VG9FeHBvcnREYXRhSW5JdGVtICgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8gSWYgY3VycmVudCBkYXRhIHNvdXJjZSBkb2Vzbid0IGNvbWUgZnJvbSBhbiBpdGVtLCBhbGxvdyB0byBleHBvcnQgZGF0YS5cbiAgICAgIGlmICghdGhpcy5pdGVtSWQpIHtcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXNlciA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS51c2VyXG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2hldGhlckFsbG93VG9FeHBvcnRJbkl0ZW1TZXR0aW5nKClcbiAgICAgIH1cblxuICAgICAgbGV0IGl0ZW1JbmZvOiBJSXRlbSA9IHRoaXMuZ2V0SXRlbUluZm8oKVxuICAgICAgaXRlbUluZm8gPSBpdGVtSW5mbz8uY29udGVudE9yaWdpblxuICAgICAgICA/IGl0ZW1JbmZvXG4gICAgICAgIDogYXdhaXQgcmVxdWVzdFV0aWxzLnJlcXVlc3RXcmFwcGVyKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmwsIChzZXNzaW9uKSA9PiB7IC8vIEdldCBpdGVtIGluZm8gdmlhIGFwcCBwb3J0YWwgdXJsIHRvIGdldCBgaXRlbUluZm8uY29udGVudE9yaWdpbmAuXG4gICAgICAgICAgcmV0dXJuIGVzcmkucmVzdFBvcnRhbC5nZXRJdGVtKHRoaXMuaXRlbUlkLCB7XG4gICAgICAgICAgICBwb3J0YWw6IHBvcnRhbFVybFV0aWxzLmdldFBvcnRhbFJlc3RVcmwoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybCksXG4gICAgICAgICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgICAgICAgIH0pXG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gZ2V0IGl0ZW0gaW5mbyB2aWEgYXBwIHBvcnRhbCB1cmwuICcsIGVycilcbiAgICAgICAgICByZXR1cm4gaXRlbUluZm9cbiAgICAgICAgfSlcbiAgICAgIGNvbnN0IGlzSW5TYW1lT3JnID0gaXRlbUluZm8/LmNvbnRlbnRPcmlnaW4gPT09ICdzZWxmJ1xuXG4gICAgICBpZiAoaXNJblNhbWVPcmcpIHtcbiAgICAgICAgY29uc3QgaXNBZG1pblVzZXIgPSB1c2VyLnJvbGUgPT09ICdvcmdfYWRtaW4nXG4gICAgICAgIC8vIElmIHVzZXIgYW5kIGl0ZW0gYXJlIGluIHRoZSBzYW1lIG9yZyBhbmQgdXNlciBpcyBhZG1pbiwgYWxsb3cgdG8gZXhwb3J0IGRhdGEuXG4gICAgICAgIGlmIChpc0FkbWluVXNlcikge1xuICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgaXNPd25lZEJ5Q3VycmVudFVzZXIgPSB1c2VyICYmIGl0ZW1JbmZvPy5vd25lciA9PT0gdXNlci51c2VybmFtZVxuICAgICAgICAgIC8vIElmIHRoZSBpdGVtIGlzIG93bmVkIGJ5IGN1cnJlbnQgbG9naW4gdXNlciwgYWxsb3cgdG8gZXhwb3J0IGRhdGEuXG4gICAgICAgICAgaWYgKGlzT3duZWRCeUN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRXaGV0aGVyQWxsb3dUb0V4cG9ydEluSXRlbVNldHRpbmcoKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2hldGhlckFsbG93VG9FeHBvcnRJbkl0ZW1TZXR0aW5nKClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coYEZhaWxlZCB0byBnZXQgd2hldGhlciBkYXRhIHNvdXJjZSAke3RoaXMuaWR9IGFsbG93cyB0byBleHBvcnQgZGF0YSwgYCwgZXJyb3IpXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBleHBvcnQgc2V0dGluZyBpbiBwb3J0YWwvQUdPTCAoaXRlbSBzZXR0aW5nIHBhZ2UpLlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRXaGV0aGVyQWxsb3dUb0V4cG9ydEluSXRlbVNldHRpbmcgKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICh0aGlzLnVybCkge1xuICAgICAgY29uc3QgbGF5ZXJEZWYgPSBhd2FpdCByZXF1ZXN0VXRpbHMucmVxdWVzdFdyYXBwZXIodGhpcy51cmwsIGFzeW5jIChzZXNzaW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBlc3JpLnJlc3RSZXF1ZXN0LnJlcXVlc3QodGhpcy51cmwsIHsgYXV0aGVudGljYXRpb246IHNlc3Npb24sIGh0dHBNZXRob2Q6ICdHRVQnIH0pXG4gICAgICB9LCAxKVxuICAgICAgcmV0dXJuICEhbGF5ZXJEZWY/LmNhcGFiaWxpdGllcz8uaW5jbHVkZXMoJ0V4dHJhY3QnKVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgc3VwcG9ydFN5bWJvbCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5zdXBwb3J0U3ltYm9sKHRoaXMpXG4gIH1cblxuICBzdXBwb3J0QXR0YWNobWVudCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5zdXBwb3J0QXR0YWNobWVudCh0aGlzKVxuICB9XG5cbiAgc3VwcG9ydFRpbWUgKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuc3VwcG9ydFRpbWUodGhpcylcbiAgfVxuXG4gIGdldFRpbWVJbmZvICgpOiBUaW1lSW5mbyB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIC8qKlxuICAgICAgICogSlMgQVBJIGZlYXR1cmUgbGF5ZXIgaGFzIGB0aW1lT2Zmc2V0YCBwcm9wZXJ0eSwgYnV0IGl0IGlzIG51bGwgZXZlbiBpZiB0aGUgc2VydmljZSBoYXMgdGltZSBvZmZzZXQgaW4gbGF5ZXIgZGVmaW5pdGlvbi5cbiAgICAgICAqIFNvIHdlIGRlZXAgbWVyZ2UgYHRpbWVJbmZvYCBvZiBKUyBBUEkgbGF5ZXIgYW5kIGB0aW1lSW5mb2Agb2YgbGF5ZXIgZGVmaW5pdGlvbiBoZXJlIHRvIGdldCBgdGltZU9mZnNldGAuXG4gICAgICAgKi9cbiAgICAgIGlmICh0aGlzLmdldExheWVyRGVmaW5pdGlvbigpPy50aW1lSW5mbyAmJiB0aGlzLmxheWVyLnRpbWVJbmZvKSB7XG4gICAgICAgIHJldHVybiBsb2Rhc2gubWVyZ2UodGhpcy5nZXRMYXllckRlZmluaXRpb24oKS50aW1lSW5mbywgdGhpcy5sYXllci50aW1lSW5mby50b0pTT04oKSkgYXMgVGltZUluZm9cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxheWVyLnRpbWVJbmZvPy50b0pTT04oKSB8fCB0aGlzLmdldExheWVyRGVmaW5pdGlvbigpPy50aW1lSW5mb1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRMYXllckRlZmluaXRpb24oKT8udGltZUluZm8gYXMgVGltZUluZm9cbiAgICB9XG4gIH1cblxuICBjcmVhdGVKU0FQSUxheWVyQnlEYXRhU291cmNlICgpOiBQcm9taXNlPF9fZXNyaS5GZWF0dXJlTGF5ZXI+IHtcbiAgICByZXR1cm4gKGRhdGFTb3VyY2VVdGlscy5jcmVhdGVKU0FQSUxheWVyQnlEYXRhU291cmNlKHRoaXMpIGFzIFByb21pc2U8X19lc3JpLkZlYXR1cmVMYXllcj4pXG4gIH1cblxuICBjcmVhdGVSZXN0QVBJTGF5ZXJCeURhdGFTb3VyY2UgKCk6IElGZWF0dXJlTGF5ZXIge1xuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuY3JlYXRlUmVzdEFQSUxheWVyQnlEYXRhU291cmNlKHRoaXMpXG4gIH1cblxuICBhc3luYyB1cGRhdGVTb3VyY2VCeUZlYXR1cmVzIChmZWF0dXJlczogQXJyYXk8X19lc3JpLkdyYXBoaWMgfCBfX2VzcmkuR3JhcGhpY1Byb3BlcnRpZXM+LCBmaWVsZHM6IEFycmF5PF9fZXNyaS5GaWVsZCB8IF9fZXNyaS5GaWVsZFByb3BlcnRpZXM+LCBvYmplY3RJZEZpZWxkOiBzdHJpbmcsIG90aGVycz86IE9taXQ8X19lc3JpLkZlYXR1cmVMYXllclByb3BlcnRpZXMsICdzb3VyY2UnIHwgJ2ZpZWxkcycgfCAnb2JqZWN0SWRGaWVsZCc+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgRmVhdHVyZUxheWVyID0gYXdhaXQgbG9hZEFyY0dJU0pTQVBJTW9kdWxlKCdlc3JpL2xheWVycy9GZWF0dXJlTGF5ZXInKVxuICAgIHRoaXMuX2xheWVyID0gbmV3IEZlYXR1cmVMYXllcih7XG4gICAgICAuLi5vdGhlcnMsXG4gICAgICBvYmplY3RJZEZpZWxkLFxuICAgICAgZmllbGRzLFxuICAgICAgc291cmNlOiBmZWF0dXJlc1xuICAgIH0pXG4gICAgLy8gQ2xlYXIgbG9hZGVkIHJlY29yZHMuXG4gICAgdGhpcy5jbGVhclJlY29yZHNOb3RBZGRWZXJzaW9uKClcbiAgICAvLyBBZGQgc291cmNlIHZlcnNpb24gdG8gbGV0IHdpZGdldHMgdG8gdXBkYXRlLlxuICAgIHRoaXMuYWRkU291cmNlVmVyc2lvbigpXG4gIH1cblxuICBnZXREYXRhVmlld3MgKCk6IEZlYXR1cmVMYXllckRhdGFTb3VyY2VbXSB7XG4gICAgcmV0dXJuIHN1cGVyLmdldERhdGFWaWV3cygpIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2VbXVxuICB9XG5cbiAgZ2V0RGF0YVZpZXcgKGRhdGFWaWV3SWQ6IHN0cmluZyk6IEZlYXR1cmVMYXllckRhdGFTb3VyY2Uge1xuICAgIHJldHVybiBzdXBlci5nZXREYXRhVmlldyhkYXRhVmlld0lkKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlXG4gIH1cblxuICBnZXRNYWluRGF0YVNvdXJjZSAoKTogRmVhdHVyZUxheWVyRGF0YVNvdXJjZSB7XG4gICAgcmV0dXJuIHN1cGVyLmdldE1haW5EYXRhU291cmNlKCkgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZVxuICB9XG5cbiAgLy8gQHRzLWV4cGVjdC1lcnJvciAtIFRTMjYxMSBlcnJvciwgc2VlbXMgdG8gYmUgc29sdmVkIGluIHY0LjguMCwgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy80MTM0NyAuXG4gIGdldCBsYXllciAoKTogX19lc3JpLkZlYXR1cmVMYXllciB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5nZXRKU0FQSUxheWVyKHRoaXMpIGFzIF9fZXNyaS5GZWF0dXJlTGF5ZXJcbiAgfVxuXG4gIHNldCBsYXllciAobDogX19lc3JpLkZlYXR1cmVMYXllcikge1xuICAgIHRoaXMuX2xheWVyID0gbFxuICB9XG5cbiAgZ2V0IHJlc3RMYXllciAoKTogSUZlYXR1cmVMYXllciB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5nZXRSZXN0QVBJTGF5ZXIodGhpcylcbiAgfVxuXG4gIHNldCByZXN0TGF5ZXIgKGw6IElGZWF0dXJlTGF5ZXIpIHtcbiAgICB0aGlzLl9yZXN0TGF5ZXIgPSBsXG4gIH1cblxuICBhZnRlclVwZGF0ZVJlY29yZHMgKHJlY29yZHM6IEZlYXR1cmVEYXRhUmVjb3JkW10pIHtcbiAgICB0aGlzLmNsZWFyUmVjb3Jkc05vdEFkZFZlcnNpb25Gb3JEZXJpdmVkRHNzV2hpY2hRdWVyeVN0YXQoKVxuICAgIHN1cGVyLmFmdGVyVXBkYXRlUmVjb3JkcyhyZWNvcmRzKVxuICB9XG5cbiAgYWZ0ZXJVcGRhdGVSZWNvcmQgKHJlY29yZDogRmVhdHVyZURhdGFSZWNvcmQpIHtcbiAgICB0aGlzLmNsZWFyUmVjb3Jkc05vdEFkZFZlcnNpb25Gb3JEZXJpdmVkRHNzV2hpY2hRdWVyeVN0YXQoKVxuICAgIHN1cGVyLmFmdGVyVXBkYXRlUmVjb3JkKHJlY29yZClcbiAgfVxuXG4gIGFmdGVyQWRkUmVjb3JkIChyZWNvcmQ6IEZlYXR1cmVEYXRhUmVjb3JkKSB7XG4gICAgdGhpcy5jbGVhclJlY29yZHNOb3RBZGRWZXJzaW9uRm9yRGVyaXZlZERzc1doaWNoUXVlcnlTdGF0KClcbiAgICBzdXBlci5hZnRlckFkZFJlY29yZChyZWNvcmQpXG4gIH1cblxuICBhZnRlckRlbGV0ZVJlY29yZEJ5SWQgKGlkOiBzdHJpbmcpIHtcbiAgICB0aGlzLmNsZWFyUmVjb3Jkc05vdEFkZFZlcnNpb25Gb3JEZXJpdmVkRHNzV2hpY2hRdWVyeVN0YXQoKVxuICAgIHN1cGVyLmFmdGVyRGVsZXRlUmVjb3JkQnlJZChpZClcbiAgfVxuXG4gIHByaXZhdGUgY2xlYXJSZWNvcmRzTm90QWRkVmVyc2lvbkZvckRlcml2ZWREc3NXaGljaFF1ZXJ5U3RhdCAoKSB7XG4gICAgdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldEFsbERlcml2ZWREYXRhU291cmNlcygpLmNvbmNhdCh0aGlzLmdldE1haW5EYXRhU291cmNlKCkpLmZvckVhY2goKGRzOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlKSA9PiB7XG4gICAgICAvLyBJZiBxdWVyeSBzdGF0aXN0aWNzLCB3ZSBjYW4gbm90IHVwZGF0ZSB0aGUgbG9hZGVkIHJlY29yZHMsIHdpbGwgY2xlYXIgdGhlbS5cbiAgICAgIGlmIChkcy5nZXRDdXJyZW50UXVlcnlQYXJhbXMoKT8ub3V0U3RhdGlzdGljcykge1xuICAgICAgICBkcy5jbGVhclJlY29yZHNOb3RBZGRWZXJzaW9uKClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZXBsYWNlU3ViTGF5ZXJXaXRoRmVhdHVyZUxheWVyICgpOiBQcm9taXNlPHRoaXM+IHtcbiAgICBjb25zdCBuZWVkVG9DcmVhdGVMYXllciA9IHRoaXMubGF5ZXI/LmRlY2xhcmVkQ2xhc3MgPT09ICdlc3JpLmxheWVycy5zdXBwb3J0LlN1YmxheWVyJ1xuICAgIC8qKlxuICAgICAqIEFjdHVhbGx5IG9ubHkgc3VibGF5ZXJzIG9mIG1hcCBzZXJ2aWNlIGxheWVyIHdpbGwgbmVlZCB0byBjcmVhdGUgYSBuZXcgbGF5ZXJcbiAgICAgKiBzaW5jZSBzdWJsYXllciBpcyBub3QgYSByZWFsIGxheWVyLlxuICAgICAqIEFuZCBpbiB0aGVzZSBzdWJsYXllcnMsIHdlIG9ubHkgc3VwcG9ydCBmZWF0dXJlIGxheWVyLlxuICAgICAqIFNvIHdlIG9ubHkgbmVlZCB0byBjcmVhdGUgZmVhdHVyZSBsYXllci5cbiAgICAgKi9cbiAgICBpZiAobmVlZFRvQ3JlYXRlTGF5ZXIgJiYgdGhpcy5sYXllci51cmwpIHtcbiAgICAgIGNvbnN0IEZlYXR1cmVMYXllciA9IGF3YWl0IGxvYWRBcmNHSVNKU0FQSU1vZHVsZSgnZXNyaS9sYXllcnMvRmVhdHVyZUxheWVyJykgYXMgdHlwZW9mIF9fZXNyaS5GZWF0dXJlTGF5ZXJcbiAgICAgIGNvbnN0IGRlZmluaXRpb25FeHByZXNzaW9uID0gdGhpcy5sYXllci5kZWZpbml0aW9uRXhwcmVzc2lvbiB8fCBudWxsXG4gICAgICB0aGlzLmxheWVyID0gbmV3IEZlYXR1cmVMYXllcih7XG4gICAgICAgIGlkOiB0aGlzLmxheWVyLmlkLFxuICAgICAgICB0aXRsZTogdGhpcy5sYXllci50aXRsZSxcbiAgICAgICAgdXJsOiBkYXRhU291cmNlVXRpbHMuZ2V0VXJsQnlMYXllcih0aGlzLmxheWVyKSxcbiAgICAgICAgcmVuZGVyZXI6IHRoaXMubGF5ZXIucmVuZGVyZXIsXG4gICAgICAgIHBvcHVwVGVtcGxhdGU6IHRoaXMubGF5ZXIucG9wdXBUZW1wbGF0ZSxcbiAgICAgICAgc291cmNlSlNPTjogdGhpcy5sYXllci5zb3VyY2VKU09OLFxuICAgICAgICBwYXJlbnQ6IHRoaXMubGF5ZXIucGFyZW50LFxuICAgICAgICBkZWZpbml0aW9uRXhwcmVzc2lvblxuICAgICAgfSlcbiAgICAgIC8qKlxuICAgICAgICogQ2hpbGQgZGF0YSBzb3VyY2VzIHdpbGwgYmUgcmVhZHkgYmVmb3JlIHJvb3QgZGF0YSBzb3VyY2UuXG4gICAgICAgKiBDbGVhciBjaGlsZCBkYXRhIHNvdXJjZXMgY2FjaGUgaGVyZSB0byBsZXQgd2lkZ2V0cyB1c2luZyB0aGVzZSBjaGlsZCBkYXRhIHNvdXJjZXMgdXBkYXRlLlxuICAgICAgICovXG4gICAgICB0aGlzLmdldEFsbERlcml2ZWREYXRhU291cmNlcygpLmZvckVhY2goZHMgPT4ge1xuICAgICAgICBkcy5jbGVhclJlY29yZHMoKTtcbiAgICAgICAgKGRzIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2UpLmxheWVyID0gdGhpcy5sYXllclxuICAgICAgfSlcblxuICAgICAgYXdhaXQgdGhpcy5sYXllci5sb2FkKClcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMpXG4gIH1cblxuICBwcml2YXRlIF9wcmludFVzZUFsbEZpZWxkc1dhcm5pbmcgKG91dEZpZWxkczogc3RyaW5nW10gfCBJbW11dGFibGVBcnJheTxzdHJpbmc+KSB7XG4gICAgaWYgKG91dEZpZWxkcz8uaW5jbHVkZXMoJyonKSkge1xuICAgICAgbG9kYXNoLmRlZmVyKCgpID0+IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzZSBkZWZlciB0byBtYWtlIHRoZSB3YXJuaW5nIGNsZWFyLlxuICAgICAgICAgKiBPdGhlcndpc2UgdGhlIGNocm9tZSAod2l0aCByZWFjdCBleHRlbnNpb24gb3Blbikgd2lsbCBhbHNvIHNob3cgdGhlIHJlbGV2YW50IHN0YWNrIGFmdGVyIGxhdW5jaGluZyB0aGUgYXBwLlxuICAgICAgICAgKi9cbiAgICAgICAgY29uc29sZS53YXJuKGBVc2luZyAqIGFzIG91dCBmaWVsZHMgdG8gZG8gcXVlcnkuIERhdGEgc291cmNlIGlkIGlzOiAke3RoaXMuaWR9YClcbiAgICAgIH0pXG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyB0eXBlIEludGxTaGFwZSwgbG9hZEFyY0dJU0pTQVBJTW9kdWxlcywgZGF0YVNvdXJjZVV0aWxzLCBsb2Rhc2gsIHV1aWR2MSwgbW9kdWxlTG9hZGVyIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBJRmVhdHVyZSwgdHlwZSBJR2VvbWV0cnkgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcydcbmltcG9ydCB7IEFic3RyYWN0RGF0YVJlY29yZCB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcbmltcG9ydCB7IHR5cGUgQXR0YWNobWVudEluZm8sIHR5cGUgRmVhdHVyZURhdGFSZWNvcmQsIHR5cGUgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSwgdHlwZSBRdWVyeVBhcmFtcywgdHlwZSBTY2VuZUxheWVyRGF0YVNvdXJjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyB0eXBlIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCB9IGZyb20gJy4vc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IHR5cGUgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ZlYXR1cmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCdcblxuLy8gRGF0YSBzb3VyY2UgaWQgdXNlZCBpbiBwcm94eSB0byBsb2FkIG1pc3NpbmcgZmllbGRzLlxuY29uc3QgREFUQV9TT1VSQ0VfSURfRk9SX1JFQ09SRCA9ICdkYXRhX3NvdXJjZV9pZF9mb3JfcmVjb3JkJ1xuLy8gV2hldGhlciBkYXRhIG9mIGEgcmVjcm9kIGlzIGEgcHJveHkuXG5jb25zdCBJU19SRUNPUkRfREFUQV9BX1BST1hZID0gJ2lzX3JlY29yZF9kYXRhX2FfcHJveHknXG5cbmludGVyZmFjZSBGZWF0dXJlUmVjb3JkT3B0aW9ucyB7XG4gIGlzQmVmb3JlTWFwcGluZ0RhdGE/OiBib29sZWFuIC8vIGRlZmF1bHQgaXMgdHJ1ZVxuICBoYXNGdWxsR2VvbWV0cmllcz86IGJvb2xlYW4gLy8gZGVmYXVsdCBpcyB0cnVlXG59XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlRGF0YVJlY29yZEltcGwgZXh0ZW5kcyBBYnN0cmFjdERhdGFSZWNvcmQgaW1wbGVtZW50cyBGZWF0dXJlRGF0YVJlY29yZCB7XG4gIGZlYXR1cmU6IElGZWF0dXJlIHwgX19lc3JpLkdyYXBoaWNcbiAgYXR0YWNobWVudEluZm9zOiBBdHRhY2htZW50SW5mb1tdXG4gIGhhc0Z1bGxHZW9tZXRyaWVzOiBib29sZWFuXG4gIHByb3RlY3RlZCBfZGF0YVNvdXJjZTogRmVhdHVyZUxheWVyRGF0YVNvdXJjZSB8IFNjZW5lTGF5ZXJEYXRhU291cmNlXG4gIHByb3RlY3RlZCBfcXVlcnlBbGxBdHRhY2htZW50c1Byb21pc2U6IFByb21pc2U8QXR0YWNobWVudEluZm9bXT5cbiAgcHJvdGVjdGVkIF9nZXRTeW1ib2xQcmV2aWV3SFRNTFByb21pc2U6IFByb21pc2U8SFRNTEVsZW1lbnQ+XG4gIHByaXZhdGUgcmVhZG9ubHkgX2lkID0gbnVsbFxuXG4gIGNvbnN0cnVjdG9yIChmZWF0dXJlOiBJRmVhdHVyZSB8IF9fZXNyaS5HcmFwaGljLCBkYXRhU291cmNlOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlIHwgU2NlbmVMYXllckRhdGFTb3VyY2UsIG9wdGlvbnM/OiBGZWF0dXJlUmVjb3JkT3B0aW9ucykge1xuICAgIHN1cGVyKClcblxuICAgIHRoaXMuZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2VcblxuICAgIGlmIChmZWF0dXJlLmF0dHJpYnV0ZXNbZGF0YVNvdXJjZS5nZXRJZEZpZWxkKCldID09IG51bGwpIHtcbiAgICAgIC8vIFRoYXQgcHV0IHRoZSBkZWZhdWx0IGlkIHRvIGZlYXR1cmUuYXR0cmlidXRlcyB3aWxsIGNhdXNlIG90aGVyIGlzc3Vlcy4gRS5nLiBmb3IgY2x1c3RlciBmZWF0dXJlcywgdGhleSBzaG91bGQgbm90IGhhdmUgb2JqZWN0IGlkLlxuICAgICAgdGhpcy5faWQgPSB1dWlkdjEoKVxuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5uZWNlc3NhcnktYm9vbGVhbi1saXRlcmFsLWNvbXBhcmVcbiAgICBpZiAob3B0aW9ucz8uaXNCZWZvcmVNYXBwaW5nRGF0YSAhPT0gZmFsc2UpIHtcbiAgICAgIGZlYXR1cmUuYXR0cmlidXRlcyA9IHRoaXMuY29udmVydEJlZm9yZU1hcHBpbmdEYXRhVG9EYXRhKGZlYXR1cmUuYXR0cmlidXRlcylcbiAgICAgIHRoaXMuZmVhdHVyZSA9IGZlYXR1cmVcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5mZWF0dXJlID0gZmVhdHVyZVxuICAgIH1cblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5uZWNlc3NhcnktYm9vbGVhbi1saXRlcmFsLWNvbXBhcmVcbiAgICB0aGlzLmhhc0Z1bGxHZW9tZXRyaWVzID0gb3B0aW9ucz8uaGFzRnVsbEdlb21ldHJpZXMgIT09IGZhbHNlXG5cbiAgICB0aGlzLnNldFByb3h5Rm9yRGF0YSgpXG4gICAgdGhpcy5maWxsR2VvbWV0cnkoKVxuICB9XG5cbiAgcHJpdmF0ZSBzZXRQcm94eUZvckRhdGEgKCkge1xuICAgIGlmICghdGhpcy5mZWF0dXJlPy5hdHRyaWJ1dGVzIHx8ICF0aGlzLmRhdGFTb3VyY2UpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIElmIHByb3h5IGlzIHNldCBhbmQgZGF0YSBzb3VyY2UgaXMgbm90IGNoYW5nZWQsIG5vIG5lZWQgdG8gZG8gaXQgYWdhaW4uXG4gICAgaWYgKHRoaXMuZmVhdHVyZS5hdHRyaWJ1dGVzW0lTX1JFQ09SRF9EQVRBX0FfUFJPWFldICYmIHRoaXMuZmVhdHVyZS5hdHRyaWJ1dGVzW0RBVEFfU09VUkNFX0lEX0ZPUl9SRUNPUkRdID09PSB0aGlzLmRhdGFTb3VyY2UuaWQpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IGRhdGFTb3VyY2UgPSB0aGlzLmRhdGFTb3VyY2VcbiAgICB0aGlzLmZlYXR1cmUuYXR0cmlidXRlcyA9IG5ldyBQcm94eSh0aGlzLmZlYXR1cmUuYXR0cmlidXRlc1tJU19SRUNPUkRfREFUQV9BX1BST1hZXSA/IHsgLi4udGhpcy5mZWF0dXJlLmF0dHJpYnV0ZXMgfSA6IHRoaXMuZmVhdHVyZS5hdHRyaWJ1dGVzLCB7XG4gICAgICBnZXQgKHRhcmdldCwgcHJvcCkge1xuICAgICAgICBsZXQgdmFsdWVcbiAgICAgICAgaWYgKHByb3AgaW4gdGFyZ2V0KSB7XG4gICAgICAgICAgdmFsdWUgPSB0YXJnZXRbcHJvcF1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycgJiYgZGF0YVNvdXJjZS5nZXRTY2hlbWEoKT8uZmllbGRzICYmIHByb3AgaW4gZGF0YVNvdXJjZS5nZXRTY2hlbWEoKS5maWVsZHMpIHtcbiAgICAgICAgICAoZGF0YVNvdXJjZSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbCB8IFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCkubG9hZE1pc3NpbmdGaWVsZHMoeyAuLi5kYXRhU291cmNlLmdldEN1cnJlbnRRdWVyeVBhcmFtcygpLCBvdXRGaWVsZHM6IFtwcm9wXSB9IGFzIFF1ZXJ5UGFyYW1zLCB0cnVlKVxuICAgICAgICB9IGVsc2UgaWYgKHByb3AgPT09IERBVEFfU09VUkNFX0lEX0ZPUl9SRUNPUkQpIHtcbiAgICAgICAgICB2YWx1ZSA9IGRhdGFTb3VyY2UuaWRcbiAgICAgICAgfSBlbHNlIGlmIChwcm9wID09PSBJU19SRUNPUkRfREFUQV9BX1BST1hZKSB7XG4gICAgICAgICAgdmFsdWUgPSB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHNldCBkYXRhU291cmNlIChkOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlIHwgU2NlbmVMYXllckRhdGFTb3VyY2UpIHtcbiAgICB0aGlzLl9kYXRhU291cmNlID0gZFxuICAgIHRoaXMuc2V0UHJveHlGb3JEYXRhKClcbiAgfVxuXG4gIGdldCBkYXRhU291cmNlICgpOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlIHwgU2NlbmVMYXllckRhdGFTb3VyY2Uge1xuICAgIHJldHVybiB0aGlzLl9kYXRhU291cmNlXG4gIH1cblxuICBwcml2YXRlIGZpbGxHZW9tZXRyeSAoKSB7XG4gICAgaWYgKCF0aGlzLmZlYXR1cmUuZ2VvbWV0cnkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IGRzID0gdGhpcy5kYXRhU291cmNlIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2VcbiAgICBpZiAoIXRoaXMuZmVhdHVyZS5nZW9tZXRyeS5zcGF0aWFsUmVmZXJlbmNlKSB7XG4gICAgICB0aGlzLmZlYXR1cmUuZ2VvbWV0cnkuc3BhdGlhbFJlZmVyZW5jZSA9IGRzLmdldExheWVyRGVmaW5pdGlvbigpPy5leHRlbnQ/LnNwYXRpYWxSZWZlcmVuY2VcbiAgICB9XG5cbiAgICAvLyAodGhpcy5mZWF0dXJlLmdlb21ldHJ5IGFzIElIYXNaTSkuaGFzTSA9IGRzLmdldExheWVyRGVmaW5pdGlvbigpPy5oYXNNO1xuICAgIC8vICh0aGlzLmZlYXR1cmUuZ2VvbWV0cnkgYXMgSUhhc1pNKS5oYXNaID0gZHMuZ2V0TGF5ZXJEZWZpbml0aW9uKCk/Lmhhc1o7XG4gIH1cblxuICBhc3luYyBxdWVyeUF0dGFjaG1lbnRzIChhdHRhY2htZW50VHlwZXM/OiBzdHJpbmdbXSk6IFByb21pc2U8QXR0YWNobWVudEluZm9bXT4ge1xuICAgIGxldCBmZWF0dXJlTGF5ZXJVcmwgPSBudWxsXG4gICAgY29uc3QgZmVhdHVyZUxheWVyRHMgPSB0aGlzLmRhdGFTb3VyY2UgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZVxuICAgIGZlYXR1cmVMYXllclVybCA9IGZlYXR1cmVMYXllckRzICYmIGZlYXR1cmVMYXllckRzLmdldE1haW5EYXRhU291cmNlKCkudXJsXG4gICAgaWYgKCFmZWF0dXJlTGF5ZXJVcmwpIHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoW10pXG4gICAgfVxuXG4gICAgY29uc3QgYXR0YWNobWVudFF1ZXJ5ID0ge1xuICAgICAgYXR0YWNobWVudFR5cGVzOiBhdHRhY2htZW50VHlwZXMsXG4gICAgICB1cmw6IGZlYXR1cmVMYXllclVybCxcbiAgICAgIGZlYXR1cmVJZDogdGhpcy5nZXRJZCgpXG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLl9xdWVyeUFsbEF0dGFjaG1lbnRzUHJvbWlzZSkge1xuICAgICAgdGhpcy5fcXVlcnlBbGxBdHRhY2htZW50c1Byb21pc2UgPSBkYXRhU291cmNlVXRpbHMucXVlcnlBbGxBdHRhY2htZW50cyhhdHRhY2htZW50UXVlcnkpXG4gICAgfVxuXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuX3F1ZXJ5QWxsQXR0YWNobWVudHNQcm9taXNlLnRoZW4oYXN5bmMgKGF0dGFjaG1lbnRJbmZvcykgPT4ge1xuICAgICAgdGhpcy5hdHRhY2htZW50SW5mb3MgPSBhdHRhY2htZW50SW5mb3NcbiAgICAgIHJldHVybiBhd2FpdCBkYXRhU291cmNlVXRpbHMuZmlsdGVyQXR0YWNobWVudHMoYXR0YWNobWVudEluZm9zLCBhdHRhY2htZW50UXVlcnkpXG4gICAgfSlcbiAgfVxuXG4gIGFzeW5jIGZldGNoU3ltYm9sUHJldmlld0hUTUwgKCk6IFByb21pc2U8SFRNTEVsZW1lbnQ+IHtcbiAgICBpZiAoIXRoaXMuX2lzR3JhcGhpY0ZlYXR1cmUoKSkge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShudWxsKVxuICAgIH1cblxuICAgIGlmICh0aGlzLl9nZXRTeW1ib2xQcmV2aWV3SFRNTFByb21pc2UpIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLl9nZXRTeW1ib2xQcmV2aWV3SFRNTFByb21pc2VcbiAgICB9XG5cbiAgICB0aGlzLl9nZXRTeW1ib2xQcmV2aWV3SFRNTFByb21pc2UgPSBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAgICdlc3JpL3N5bWJvbHMvc3VwcG9ydC9zeW1ib2xVdGlscydcbiAgICBdKS50aGVuKGFzeW5jIG1vZHVsZXMgPT4ge1xuICAgICAgbGV0IHN5bWJvbFV0aWxzOiB0eXBlb2YgX19lc3JpLnN5bWJvbFV0aWxzID0gbnVsbDtcbiAgICAgIFtzeW1ib2xVdGlsc10gPSBtb2R1bGVzXG4gICAgICByZXR1cm4gYXdhaXQgc3ltYm9sVXRpbHMuZ2V0RGlzcGxheWVkU3ltYm9sKHRoaXMuZmVhdHVyZSBhcyBfX2VzcmkuR3JhcGhpYykudGhlbihhc3luYyAoc3ltYm9sKSA9PiB7XG4gICAgICAgIGNvbnN0IG5vZGVIdG1sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgICAgbm9kZUh0bWwuY2xhc3NOYW1lID0gJ3ctMTAwIGgtMTAwIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIGFsaWduLWl0ZW1zLWNlbnRlcidcbiAgICAgICAgcmV0dXJuIGF3YWl0IHN5bWJvbFV0aWxzLnJlbmRlclByZXZpZXdIVE1MKHN5bWJvbCBhcyBfX2Vzcmkuc3ltYm9sc1N5bWJvbCwge1xuICAgICAgICAgIG5vZGU6IG5vZGVIdG1sXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICByZXR1cm4gYXdhaXQgdGhpcy5fZ2V0U3ltYm9sUHJldmlld0hUTUxQcm9taXNlXG4gIH1cblxuICBnZXREYXRhICgpOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHtcbiAgICByZXR1cm4gdGhpcy5mZWF0dXJlLmF0dHJpYnV0ZXNcbiAgfVxuXG4gIHNldERhdGEgKGRhdGE6IHsgW2tleTogc3RyaW5nXTogYW55IH0pIHtcbiAgICB0aGlzLmZlYXR1cmUuYXR0cmlidXRlcyA9IGRhdGFcbiAgICB0aGlzLnNldFByb3h5Rm9yRGF0YSgpXG4gIH1cblxuICBjbG9uZSAoZGVlcD86IGJvb2xlYW4pOiBGZWF0dXJlRGF0YVJlY29yZCB7XG4gICAgY29uc3Qgc2hhbGxvd0Nsb25lID0gbG9kYXNoLmNsb25lKHRoaXMpIGFzIEZlYXR1cmVEYXRhUmVjb3JkXG4gICAgaWYgKGRlZXApIHtcbiAgICAgIGlmICgodGhpcy5mZWF0dXJlIGFzIF9fZXNyaS5HcmFwaGljKS5kZWNsYXJlZENsYXNzID09PSAnZXNyaS5HcmFwaGljJykge1xuICAgICAgICBzaGFsbG93Q2xvbmUuZmVhdHVyZSA9ICh0aGlzLmZlYXR1cmUgYXMgX19lc3JpLkdyYXBoaWMpLmNsb25lKClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNoYWxsb3dDbG9uZS5mZWF0dXJlID0gbG9kYXNoLmNsb25lRGVlcCh0aGlzLmZlYXR1cmUgYXMgSUZlYXR1cmUpXG4gICAgICB9XG4gICAgICByZXR1cm4gc2hhbGxvd0Nsb25lXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzaGFsbG93Q2xvbmVcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBEaXNwbGF5ZWQgZGF0ZSBsYWJlbCBzaG91bGQgaG9ub3IgdGltZXpvbmVcbiAgICogVGhyZWUgY2FzZXM6IHVua25vd24gdGltZXpvbmUsIHNwZWNpZmljIHRpbWV6b25lLCBvciBkZXZpY2UgKGxvY2FsLCBieSBkZWZhdWx0KS5cbiAgICovXG4gIGdldERhdGVGaWVsZFZhbHVlIChqaW11RmllbGROYW1lOiBzdHJpbmcpIHtcbiAgICBsZXQgdmFsdWUgPSB0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSlcbiAgICBjb25zdCB0aW1lem9uZSA9IHRoaXMuZGF0YVNvdXJjZS5nZXRUaW1lem9uZSgpXG4gICAgaWYgKHRpbWV6b25lID09PSAndW5rbm93bicpIHtcbiAgICAgIHZhbHVlID0gdmFsdWUgLSBkYXRhU291cmNlVXRpbHMuZ2V0TG9jYWxUaW1lT2Zmc2V0KClcbiAgICB9IGVsc2UgaWYgKHRpbWV6b25lICE9PSAnZGV2aWNlJyAmJiB0aW1lem9uZSAhPT0gbnVsbCkge1xuICAgICAgY29uc3QgdHpPZmZzZXQgPSBkYXRhU291cmNlVXRpbHMuZ2V0QXBwU2V0dGluZ1RpbWVab25lT2Zmc2V0KHRpbWV6b25lKVxuICAgICAgdmFsdWUgPSB2YWx1ZSAtIGRhdGFTb3VyY2VVdGlscy5nZXRMb2NhbFRpbWVPZmZzZXQoKSArIHR6T2Zmc2V0XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZVxuICB9XG5cbiAgZ2V0Rm9ybWF0dGVkRmllbGRWYWx1ZSAoamltdUZpZWxkTmFtZTogc3RyaW5nLCBpbnRsOiBJbnRsU2hhcGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRzID0gdGhpcy5kYXRhU291cmNlIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2VcbiAgICBjb25zdCBsYXllckRlZmluaXRpb24gPSBkcyAmJiBkcy5nZXRMYXllckRlZmluaXRpb24gJiYgZHMuZ2V0TGF5ZXJEZWZpbml0aW9uKClcbiAgICBpZiAoIWxheWVyRGVmaW5pdGlvbikge1xuICAgICAgcmV0dXJuIHN1cGVyLmdldEZvcm1hdHRlZEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSwgaW50bClcbiAgICB9XG4gICAgY29uc3QgdmFsdWVPYmogPSBkYXRhU291cmNlVXRpbHMuZ2V0RGlzcGxheVZhbHVlRm9yQ29kZWRWYWx1ZU9yU3VidHlwZShsYXllckRlZmluaXRpb24sIGppbXVGaWVsZE5hbWUsIHRoaXMuZ2V0RGF0YSgpKVxuICAgIHJldHVybiB2YWx1ZU9iai5pc0NvZGVkVmFsdWVPclN1YnR5cGUgPyB2YWx1ZU9iai5kaXNwbGF5VmFsdWUgOiBzdXBlci5nZXRGb3JtYXR0ZWRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUsIGludGwpXG4gIH1cblxuICBnZXREYXRhQmVmb3JlTWFwcGluZyAoKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB7XG4gICAgcmV0dXJuIHRoaXMuY29udmVydERhdGFUb0RhdGFCZWZvcmVNYXBwaW5nKHRoaXMuZ2V0RGF0YSgpKVxuICB9XG5cbiAgZ2V0T3JpZ2luRGF0YSAoKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB7XG4gICAgY29uc3QgY2xvbmVGZWF0dXJlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5mZWF0dXJlKVxuICAgIGNsb25lRmVhdHVyZS5hdHRyaWJ1dGVzID0gdGhpcy5jb252ZXJ0RGF0YVRvRGF0YUJlZm9yZU1hcHBpbmcodGhpcy5nZXREYXRhKCkpXG4gICAgcmV0dXJuIGNsb25lRmVhdHVyZVxuICB9XG5cbiAgdG9Kc29uICgpOiBJRmVhdHVyZSB8IF9fZXNyaS5HcmFwaGljIHtcbiAgICBjb25zdCBmZWF0dXJlSnNvbiA9IHRoaXMuZmVhdHVyZVxuICAgIHJldHVybiBmZWF0dXJlSnNvblxuICB9XG5cbiAgZ2V0SWQgKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuZmVhdHVyZS5hdHRyaWJ1dGVzW3RoaXMuZGF0YVNvdXJjZS5nZXRJZEZpZWxkKCldICE9IG51bGwgPyB0aGlzLmZlYXR1cmUuYXR0cmlidXRlc1t0aGlzLmRhdGFTb3VyY2UuZ2V0SWRGaWVsZCgpXSArICcnIDogdGhpcy5faWRcbiAgfVxuXG4gIHNldElkIChpZDogc3RyaW5nKSB7XG4gICAgLy8gVE9ET1xuICB9XG5cbiAgZ2V0R2VvbWV0cnkgKCk6IElHZW9tZXRyeSB7XG4gICAgaWYgKCh0aGlzLmZlYXR1cmUgYXMgX19lc3JpLkdyYXBoaWMpLmRlY2xhcmVkQ2xhc3MgPT09ICdlc3JpLkdyYXBoaWMnKSB7XG4gICAgICByZXR1cm4gKHRoaXMuZmVhdHVyZSBhcyBfX2VzcmkuR3JhcGhpYykuZ2VvbWV0cnk/LnRvSlNPTigpXG4gICAgfVxuICAgIHJldHVybiAodGhpcy5mZWF0dXJlIGFzIElGZWF0dXJlKS5nZW9tZXRyeVxuICB9XG5cbiAgZ2V0UmF3R2VvbWV0cnkgKCk6IElHZW9tZXRyeSB8IF9fZXNyaS5HZW9tZXRyeSB7XG4gICAgLy8gX19lc3JpLkdlb21ldHJ5J3MgdG9KU09OIHdpbGwgY2F1c2UgdGhlIGxvc3Mgb2Ygc29tZSBsaW5lcy4gVXNlIHRoaXMgbWV0aG9kIHRvIGdldCB0aGUgb3JpZ2luYWwgZ2VvbWV0cnkuXG4gICAgcmV0dXJuIHRoaXMuZmVhdHVyZS5nZW9tZXRyeVxuICB9XG5cbiAgc2V0R2VvbWV0cnkgKGdlbzogSUdlb21ldHJ5IHwgX19lc3JpLkdlb21ldHJ5KSB7XG4gICAgaWYgKCh0aGlzLmZlYXR1cmUgYXMgX19lc3JpLkdyYXBoaWMpPy5kZWNsYXJlZENsYXNzID09PSAnZXNyaS5HcmFwaGljJykge1xuICAgICAgY29uc3QgR2VvbWV0cnk6IHR5cGVvZiBfX2VzcmkuR2VvbWV0cnkgPSBtb2R1bGVMb2FkZXIuZ2V0TW9kdWxlU3luYygnZXNyaS9nZW9tZXRyeS9HZW9tZXRyeScpXG4gICAgICAvLyBJZiBmZWF0dXJlIGlzIHR5cGVvZiBHcmFwaGljLCBKUyBBUEkgbW9kdWxlIEdlb21ldHJ5IHNob3VsZCBhbHJlYWR5IGJlIGxvYWRlZC5cbiAgICAgIHRoaXMuZmVhdHVyZS5nZW9tZXRyeSA9IChnZW8gYXMgX19lc3JpLkdlb21ldHJ5KT8uZGVjbGFyZWRDbGFzcz8uaW5jbHVkZXMoJ2VzcmkuZ2VvbWV0cnknKSA/IGdlbyA6IChHZW9tZXRyeT8uZnJvbUpTT04oZ2VvKSB8fCBnZW8pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZmVhdHVyZS5nZW9tZXRyeSA9IChnZW8gYXMgX19lc3JpLkdlb21ldHJ5KT8uZGVjbGFyZWRDbGFzcz8uaW5jbHVkZXMoJ2VzcmkuZ2VvbWV0cnknKSA/IChnZW8gYXMgX19lc3JpLkdlb21ldHJ5KS50b0pTT04oKSA6IGdlb1xuICAgIH1cbiAgfVxuXG4gIHNldEZlYXR1cmUgKGZlYXR1cmU6IElGZWF0dXJlIHwgX19lc3JpLkdyYXBoaWMpIHtcbiAgICB0aGlzLmZlYXR1cmUgPSBmZWF0dXJlXG4gICAgdGhpcy5maWxsR2VvbWV0cnkoKVxuICB9XG5cbiAgZ2V0RmVhdHVyZSAoKTogSUZlYXR1cmUgfCBfX2VzcmkuR3JhcGhpYyB7XG4gICAgcmV0dXJuIHRoaXMuZmVhdHVyZVxuICB9XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogUmV0dXJucyB3aGV0aGVyIGBmZWF0dXJlYCBpcyB0eXBlIG9mIGBfX2VzcmkuR3JhcGhpY2AsIHNvbWUgbWV0aG9kcyBvbmx5IHdvcmsgd2l0aCBgX19lc3JpLkdyYXBoaWNgLlxuICAgKi9cbiAgcHJpdmF0ZSBfaXNHcmFwaGljRmVhdHVyZSAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhKHRoaXM/LmZlYXR1cmUgYXMgX19lc3JpLkdyYXBoaWMpPy5sYXllclxuICB9XG59XG4iLCJpbXBvcnQgeyBsb2FkQXJjR0lTSlNBUElNb2R1bGUsIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBEYXRhU291cmNlVHlwZXMsIHR5cGUgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSwgdHlwZSBGZWF0dXJlU2VydmljZURhdGFTb3VyY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzJ1xuaW1wb3J0IHsgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UsIHR5cGUgTGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5cbi8qKlxuICogRGF0YSBzb3VyY2UgZnJvbSBhIGZlYXR1cmUgc2VydmljZSwgd2hpY2ggbWF5IGNvbnRhaW4gbXVsdGlwbGUgY2hpbGQgZGF0YSBzb3VyY2VzLlxuICovXG5leHBvcnQgY2xhc3MgRmVhdHVyZVNlcnZpY2VEYXRhU291cmNlSW1wbCBleHRlbmRzIEFic3RyYWN0TGF5ZXJGb2xkZXJEYXRhU291cmNlIGltcGxlbWVudHMgRmVhdHVyZVNlcnZpY2VEYXRhU291cmNlIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVTZXJ2aWNlID0gRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVTZXJ2aWNlXG5cbiAgZ2V0Q2hpbGRJZHMgKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRDaGlsZElkc0J5VXJsKClcbiAgfVxuXG4gIGNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkIChjaGlsZERzSWQ6IHN0cmluZywgamltdUNoaWxkSWQ6IHN0cmluZywgY2hpbGRJZDogc3RyaW5nKTogTGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkRnJvbVVybChjaGlsZERzSWQsIGppbXVDaGlsZElkLCBjaGlsZElkKVxuICB9XG5cbiAgLyoqXG4gICAqIElmIHVzZSBMYXllci5mcm9tQXJjR0lTU2VydmVyVXJsL0xheWVyLmZyb21Qb3J0YWxJdGVtIHRvIGNyZWF0ZSBKUyBBUEkgbGF5ZXIgZm9yIGZlYXR1cmUgc2VydmljZSwgd2lsbCByZXR1cm4gYSBmZWF0dXJlIGxheWVyIGlmIHRoZSBmZWF0dXJlIHNlcnZpY2Ugb25seSBjb250YWlucyBvbmUgbGF5ZXIvdGFibGUuXG4gICAqIEl0IGNhdXNlcyB0aGUgZmVhdHVyZSBzZXJ2aWNlIGRhdGEgc291cmNlIHJldHVybnMgYSBmZWF0dXJlIGxheWVyIGFzIGl0cyBKUyBBUEkgbGF5ZXIsIHdoaWNoIGlzIG5vdCBleHBlY3RlZC5cbiAgICogU28gd2Ugb3ZlcmlkZSB0aGUgbWV0aG9kIHRvIG1ha2Ugc3VyZSBmZWF0dXJlIHNlcnZpY2UgZGF0YSBzb3VyY2UgYWx3YXlzIHJldHVybnMgYSBncm91cCBsYXllci5cbiAgKi9cbiAgYXN5bmMgY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSAoKTogUHJvbWlzZTxfX2VzcmkuR3JvdXBMYXllcj4ge1xuICAgIGxldCBsYXllcjogX19lc3JpLkdyb3VwTGF5ZXJcbiAgICB0cnkge1xuICAgICAgaWYgKCF0aGlzLmFyZUNoaWxkRGF0YVNvdXJjZXNDcmVhdGVkKCkpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5jaGlsZERhdGFTb3VyY2VzUmVhZHkoKVxuICAgICAgfVxuICAgICAgY29uc3QgaGFzU2luZ2xlTGF5ZXIgPSB0aGlzLmdldEl0ZW1JbmZvKCk/LnR5cGVLZXl3b3Jkcz8uaW5jbHVkZXMoJ1NpbmdsZWxheWVyJykgfHwgdGhpcy5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpPy5sYXllcnM/Lmxlbmd0aCA9PT0gMVxuICAgICAgaWYgKGhhc1NpbmdsZUxheWVyKSB7IC8vIHRoZSBvcmlnaW5hbCBpdGVtL3NlcnZpY2Ugb25seSBjb250YWlucyBvbmUgbGF5ZXJcbiAgICAgICAgY29uc3QgY2hpbGREc3MgPSB0aGlzLmdldENoaWxkRGF0YVNvdXJjZXMoKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlW11cbiAgICAgICAgaWYgKGNoaWxkRHNzLmxlbmd0aCA9PT0gMCkgeyAvLyBmYWlsZWQgdG8gY3JlYXRlIGNoaWxkIGRhdGEgc291cmNlcyBmb3Igc29tZSByZWFzb25cbiAgICAgICAgICBjb25zdCBbTGF5ZXIsIEdyb3VwTGF5ZXJdID0gYXdhaXQgbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbJ2VzcmkvbGF5ZXJzL0xheWVyJywgJ2VzcmkvbGF5ZXJzL0dyb3VwTGF5ZXInXSkgYXMgW3R5cGVvZiBfX2VzcmkuTGF5ZXIsIHR5cGVvZiBfX2VzcmkuR3JvdXBMYXllcl1cbiAgICAgICAgICBjb25zdCBjaGlsZExheWVyID0gYXdhaXQgTGF5ZXIuZnJvbUFyY0dJU1NlcnZlclVybCh7IHVybDogYCR7dGhpcy51cmx9LyR7dGhpcy5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpPy5sYXllcnM/LlswXT8uaWQgfHwgMH1gIH0pIGFzIF9fZXNyaS5GZWF0dXJlTGF5ZXJcbiAgICAgICAgICBsYXllciA9IG5ldyBHcm91cExheWVyKHtcbiAgICAgICAgICAgIGxheWVyczogY2hpbGRMYXllci5pc1RhYmxlID8gW10gOiBbY2hpbGRMYXllcl0sXG4gICAgICAgICAgICB0YWJsZXM6IGNoaWxkTGF5ZXIuaXNUYWJsZSA/IFtjaGlsZExheWVyXSA6IFtdLFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMuZ2V0TGFiZWwoKVxuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7IC8vIG9ubHkgaGFzIG9uZSBjaGlsZCBkYXRhIHNvdXJjZVxuICAgICAgICAgIGNvbnN0IGxvYWRKU0FQSUdyb3VwTGF5ZXJQcm9taXNlID0gbG9hZEFyY0dJU0pTQVBJTW9kdWxlKCdlc3JpL2xheWVycy9Hcm91cExheWVyJykgYXMgUHJvbWlzZTx0eXBlb2YgX19lc3JpLkdyb3VwTGF5ZXI+XG4gICAgICAgICAgY29uc3QgY3JlYXRlSlNBUElMYXllckZvckNoaWxkRHNQcm9taXNlID0gY2hpbGREc3NbMF0ubGF5ZXIgPyBQcm9taXNlLnJlc29sdmUoY2hpbGREc3NbMF0ubGF5ZXIpIDogY2hpbGREc3NbMF0uY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpXG4gICAgICAgICAgY29uc3QgW0dyb3VwTGF5ZXIsIGNoaWxkTGF5ZXJdID0gYXdhaXQgUHJvbWlzZS5hbGwoW2xvYWRKU0FQSUdyb3VwTGF5ZXJQcm9taXNlLCBjcmVhdGVKU0FQSUxheWVyRm9yQ2hpbGREc1Byb21pc2VdKVxuICAgICAgICAgIGxheWVyID0gbmV3IEdyb3VwTGF5ZXIoe1xuICAgICAgICAgICAgbGF5ZXJzOiBjaGlsZExheWVyLmlzVGFibGUgPyBbXSA6IFtjaGlsZExheWVyXSxcbiAgICAgICAgICAgIHRhYmxlczogY2hpbGRMYXllci5pc1RhYmxlID8gW2NoaWxkTGF5ZXJdIDogW10sXG4gICAgICAgICAgICB0aXRsZTogdGhpcy5nZXRMYWJlbCgpXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHsgLy8gdGhlIG9yaWdpbmFsIGl0ZW0vc2VydmljZSBjb250YWlucyBtdWx0aXBsZSBsYXllcnNcbiAgICAgICAgbGF5ZXIgPSBhd2FpdCBzdXBlci5jcmVhdGVKU0FQSUxheWVyQnlEYXRhU291cmNlKCkgYXMgX19lc3JpLkdyb3VwTGF5ZXJcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgSlMgQVBJIGxheWVyLiAnLCBlcnIsIHRoaXMuaWQpXG4gICAgfVxuICAgIHJldHVybiBsYXllcj8udHlwZSA9PT0gJ2dyb3VwJyA/IGxheWVyIDogbnVsbFxuICB9XG59XG4iLCJpbXBvcnQgeyByZXF1ZXN0VXRpbHMgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VUeXBlcywgdHlwZSBHZW9KU09ORGF0YVNvdXJjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyBJdGVtTWl4aW5JbXBsLCBKU0FQSUxheWVyTWl4aW5JbXBsLCBBYnN0cmFjdERhdGFTb3VyY2UgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2VvSlNPTkRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgZXh0ZW5kcyBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgbGF5ZXI/OiBfX2VzcmkuR2VvSlNPTkxheWVyXG59XG5cbmV4cG9ydCBjbGFzcyBHZW9KU09ORGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBKU0FQSUxheWVyTWl4aW5JbXBsKEl0ZW1NaXhpbkltcGwoQWJzdHJhY3REYXRhU291cmNlKSkgaW1wbGVtZW50cyBHZW9KU09ORGF0YVNvdXJjZSB7XG4gIGxheWVyPzogX19lc3JpLkdlb0pTT05MYXllclxuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuR2VvSlNPTiA9IERhdGFTb3VyY2VUeXBlcy5HZW9KU09OXG5cbiAgY29uc3RydWN0b3IgKG9wdGlvbnM6IEdlb0pTT05EYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcbiAgICBpZiAob3B0aW9ucy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IG9wdGlvbnMubGF5ZXJcbiAgICB9XG4gICAgY29uc3QgZHNKc29uID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpXG4gICAgdGhpcy5wb3J0YWxVcmwgPSBkc0pzb24ucG9ydGFsVXJsXG4gICAgdGhpcy5pdGVtSWQgPSBkc0pzb24uaXRlbUlkXG5cbiAgICBpZiAodGhpcy51cmwpIHtcbiAgICAgIC8qKlxuICAgICAgICogQ2FjaGUgcmVxdWVzdCBzaW5jZSAtXG4gICAgICAgKiAxLiB3ZSBuZWVkIHRvIGNhY2hlIHRoZSByZXF1ZXN0IHNpbmNlIHRoZSByZWNvcmRzIGFyZSBzYXZlZCBoZXJlLCB3aGljaCBtZWFucywgdGhlIHJlc3BvbnNlIHNpemUgbWF5IGJlIGxhcmdlLlxuICAgICAgICogMi4gd2UgZG9uJ3Qga25vdyB0aGUgVVJMIHNjaGVtYSBvZiB0aGlzIHR5cGUgb2YgZGF0YSBzb3VyY2UsIGNhbiBub3QgY2FjaGUgdGhlbSBieSBkZWZhdWx0LlxuICAgICAgICovXG4gICAgICByZXF1ZXN0VXRpbHMucmVnaXN0ZXJDYWNoZWFibGVVcmwodGhpcy51cmwpXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVhZHkgKCkge1xuICAgIGlmICghdGhpcy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IGF3YWl0IHRoaXMuY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpIGFzIF9fZXNyaS5HZW9KU09OTGF5ZXJcbiAgICB9XG4gICAgYXdhaXQgdGhpcy5sYXllci5sb2FkKClcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcbiAgfVxufVxuIiwiaW1wb3J0IHsgZGF0YVNvdXJjZVV0aWxzLCB0eXBlIFNlcnZpY2VEZWZpbml0aW9uLCB0eXBlIElNRGF0YVNvdXJjZUpzb24gfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSwgdHlwZSBMYXllckZvbGRlckNoaWxkRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcbmltcG9ydCB7IERhdGFTb3VyY2VUeXBlcywgdHlwZSBHcm91cExheWVyRGF0YVNvdXJjZSwgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLCBTdXBwb3J0ZWRJdGVtVHlwZXMgfSBmcm9tICcuLi9pbnRlcmZhY2VzJ1xuaW1wb3J0ICogYXMgZGF0YVNvdXJjZUpzb25DcmVhdG9yIGZyb20gJy4uL3N1cHBvcnQvZGF0YS1zb3VyY2UtanNvbi1jcmVhdG9yJ1xuaW1wb3J0IHsgdHlwZSBJSXRlbSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXR5cGVzJ1xuXG5pbnRlcmZhY2UgR3JvdXBMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgZXh0ZW5kcyBMYXllckZvbGRlckNoaWxkRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIGl0ZW1EYXRhPzogYW55XG59XG5cbi8qKlxuICogRGF0YSBzb3VyY2UgZnJvbSBncm91cCBsYXllciBpbiBhIG1hcCBzZXJ2aWNlLCBvciBncm91cCBpbiBtYXAgdmlld2VyL3NjZW5lIHZpZXdlciwgb3IgZmVhdHVyZSBjb2xsZWN0aW9uIGl0ZW0gd2hpY2ggY29udGFpbnMgbXVsdGlwbGUgbGF5ZXJzLlxuICogR3JvdXAgbGF5ZXIgZGF0YSBzb3VyY2UgbWF5IGNvbnRhaW4gbXVsdGlwbGUgY2hpbGQgZGF0YSBzb3VyY2VzLlxuICovXG5leHBvcnQgY2xhc3MgR3JvdXBMYXllckRhdGFTb3VyY2VJbXBsIGV4dGVuZHMgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UgaW1wbGVtZW50cyBHcm91cExheWVyRGF0YVNvdXJjZSB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5Hcm91cExheWVyID0gRGF0YVNvdXJjZVR5cGVzLkdyb3VwTGF5ZXJcbiAgLyoqXG4gICAqIElmIGlzIGZyb20gbWFwIHNlcnZpY2UsIHdpbGwgYmUgX19lc3JpLlN1YmxheWVyLFxuICAgKiBpZiBpcyBncm91cCBpbiBtYXAgdmlld2VyL3NjZW5lIHZpZXdlciBvciBmZWF0dXJlIGNvbGxlY3Rpb24gd2hpY2ggY29udGFpbnMgbXVsdGlwbGUgbGF5ZXJzLCB3aWxsIGJlIF9fZXNyaS5Hcm91cExheWVyLlxuICAgKi9cbiAgbGF5ZXI/OiBfX2VzcmkuR3JvdXBMYXllciB8IF9fZXNyaS5TdWJsYXllclxuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcbiAgICB0aGlzLnNldEl0ZW1EYXRhKG9wdGlvbnMuaXRlbURhdGEpXG4gIH1cblxuICBnZXRDaGlsZElkcyAoKTogc3RyaW5nW10ge1xuICAgIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRDaGlsZElkc0J5TGF5ZXIoKVxuICAgIH0gZWxzZSBpZiAodGhpcy51cmwpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldENoaWxkSWRzQnlVcmwoKVxuICAgIH0gZWxzZSBpZiAodGhpcy5pdGVtSWQgfHwgdGhpcy5nZXRJdGVtRGF0YSgpKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRDaGlsZElkc0J5SXRlbSgpXG4gICAgfVxuICAgIHJldHVybiBbXVxuICB9XG5cbiAgY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5SWQgKGNoaWxkRHNJZDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZElkOiBzdHJpbmcpOiBHcm91cExheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkRnJvbUxheWVyKGNoaWxkRHNJZCwgamltdUNoaWxkSWQsIGNoaWxkSWQpXG4gICAgfSBlbHNlIGlmICh0aGlzLnVybCkge1xuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5SWRGcm9tVXJsKGNoaWxkRHNJZCwgamltdUNoaWxkSWQsIGNoaWxkSWQpXG4gICAgfSBlbHNlIGlmICh0aGlzLml0ZW1JZCB8fCB0aGlzLmdldEl0ZW1EYXRhKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkRnJvbUl0ZW0oY2hpbGREc0lkLCBqaW11Q2hpbGRJZCwgY2hpbGRJZClcbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2hpbGRJZHNCeUxheWVyICgpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuaXNKU0FQSUdyb3VwTGF5ZXIodGhpcy5sYXllcikgPyB0aGlzLmdldENoaWxkSWRzQnlKU0FQSUdyb3VwTGF5ZXIoKSA6IHRoaXMuZ2V0Q2hpbGRJZHNCeUpTQVBJU3ViTGF5ZXIoKVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDaGlsZElkc0J5SXRlbSAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0aGlzLmlzRmVhdHVyZUNvbGxlY3Rpb25JdGVtKHRoaXMuZ2V0SXRlbUluZm8oKSkgPyB0aGlzLmdldENoaWxkSWRzQnlGZWF0dXJlQ29sbGVjdGlvbkl0ZW0oKSA6IHRoaXMuZ2V0Q2hpbGRJZHNCeUdyb3VwTGF5ZXJJdGVtKClcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5SWRGcm9tTGF5ZXIgKGNoaWxkRHNJZDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZElkOiBzdHJpbmcpOiBHcm91cExheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIGNvbnN0IGlzSlNBUElHcm91cExheWVyID0gdGhpcy5pc0pTQVBJR3JvdXBMYXllcih0aGlzLmxheWVyKVxuICAgICAgY29uc3QgbGF5ZXJJbmZvID0gaXNKU0FQSUdyb3VwTGF5ZXIgPyB0aGlzLmZpbmRMYXllckluZm9PZkpTQVBJR3JvdXBMYXllcihjaGlsZElkKSA6IHRoaXMuZmluZExheWVySW5mb09mSlNBUElTdWJMYXllcihjaGlsZElkKVxuICAgICAgaWYgKCFsYXllckluZm8/LmxheWVyKSB7XG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIGlmIChpc0pTQVBJR3JvdXBMYXllcikge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlMYXllcihsYXllckluZm8ubGF5ZXIgYXMgX19lc3JpLkxheWVyLCBsYXllckluZm8udXJsLCBqaW11Q2hpbGRJZCwgY2hpbGREc0lkLCBsYXllckluZm8ub3JkZXIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvKipcbiAgICAgICAgICogX19lc3JpLlN1YmxheWVyIGRvZXNuJ3QgaW5kaWNhdGUgaXRzIHR5cGUgKGdyb3VwIGxheWVyIG9yIGZlYXR1cmUgbGF5ZXIgb3IgcmFzdGVyIGxheWVyIG9yIG90aGVyIHR5cGVzKS4gSXRzIHR5cGUgYWx3YXlzIGlzICdzdWJsYXllcicuXG4gICAgICAgICAqIFNvIHdlIHVzZSBsYXllciBkZWZpbml0aW9uIHRvIGNyZWF0ZSBjaGlsZCBkYXRhIHNvdXJjZXMuXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCBkc09wdGlvbnMgPSB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUxheWVyRGVmaW5pdGlvbigobGF5ZXJJbmZvLmxheWVyIGFzIF9fZXNyaS5TdWJsYXllcikuc291cmNlSlNPTiwgbGF5ZXJJbmZvLnVybCwgamltdUNoaWxkSWQsIGNoaWxkRHNJZCwgbGF5ZXJJbmZvLm9yZGVyKVxuICAgICAgICBpZiAobGF5ZXJJbmZvLmxheWVyLnRpdGxlICYmIGRzT3B0aW9ucy5kYXRhU291cmNlSnNvbikge1xuICAgICAgICAgIGRzT3B0aW9ucy5kYXRhU291cmNlSnNvbiA9IGRzT3B0aW9ucy5kYXRhU291cmNlSnNvbi5zZXQoJ3NvdXJjZUxhYmVsJywgbGF5ZXJJbmZvLmxheWVyLnRpdGxlKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRzT3B0aW9ucyA/IHsgLi4uZHNPcHRpb25zLCBsYXllcjogbGF5ZXJJbmZvLmxheWVyIH0gOiBudWxsXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5SWRGcm9tSXRlbSAoY2hpbGREc0lkOiBzdHJpbmcsIGppbXVDaGlsZElkOiBzdHJpbmcsIGNoaWxkSWQ6IHN0cmluZyk6IEdyb3VwTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgICBjb25zdCBpc0ZlYXR1cmVDb2xsZWN0aW9uID0gdGhpcy5pc0ZlYXR1cmVDb2xsZWN0aW9uSXRlbSh0aGlzLmdldEl0ZW1JbmZvKCkpXG5cbiAgICBsZXQgZHNPcHRpb25zOiBHcm91cExheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9uc1xuICAgIGlmIChpc0ZlYXR1cmVDb2xsZWN0aW9uKSB7XG4gICAgICBjb25zdCBsYXllckluZm8gPSB0aGlzLmZpbmRMYXllckluZm9PZkZlYXR1cmVDb2xsZWN0aW9uSXRlbShjaGlsZElkKVxuICAgICAgaWYgKCFsYXllckluZm8/LmxheWVyRGVmaW5pdGlvbikge1xuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuICAgICAgZHNPcHRpb25zID0gdGhpcy5jcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlMYXllckRlZmluaXRpb24obGF5ZXJJbmZvLmxheWVyRGVmaW5pdGlvbiwgbnVsbCwgamltdUNoaWxkSWQsIGNoaWxkRHNJZCwgbGF5ZXJJbmZvLm9yZGVyKVxuICAgICAgaWYgKGRzT3B0aW9ucyAmJiAhZHNPcHRpb25zLmRhdGFTb3VyY2VKc29uLmxheWVySWQpIHtcbiAgICAgICAgLy8gSWYgaXMgbXVsdGlwbGUtbGF5ZXJzIGZlYXR1cmUgY29sbGVjdGlvbiBpdGVtLCB0aGUgbGF5ZXIgZGVmaW5pdGlvbiBtYXkgZG9uJ3QgY29udGFpbiBsYXllciBpZCwgbmVlZCB0byBwYXNzIGluIGl0LlxuICAgICAgICBkc09wdGlvbnMuZGF0YVNvdXJjZUpzb24gPSBkc09wdGlvbnMuZGF0YVNvdXJjZUpzb24uc2V0KCdsYXllcklkJywgYCR7bGF5ZXJJbmZvLm9yZGVyfWApXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGxheWVySW5mbyA9IHRoaXMuZmluZExheWVySW5mb09mR3JvdXBMYXllckl0ZW0oY2hpbGRJZClcbiAgICAgIGlmICghbGF5ZXJJbmZvPy5sYXllckl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICAgIGRzT3B0aW9ucyA9IHRoaXMuY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5TGF5ZXJJdGVtKGxheWVySW5mby5sYXllckl0ZW0sIGxheWVySW5mby5wb3J0YWxVcmwsIGppbXVDaGlsZElkLCBjaGlsZERzSWQsIGxheWVySW5mby5vcmRlcilcbiAgICB9XG5cbiAgICByZXR1cm4gZHNPcHRpb25zXG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUxheWVySXRlbSAoaXRlbTogSUl0ZW0sIHBvcnRhbFVybDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZERzSWQ6IHN0cmluZywgb3JkZXI6IG51bWJlcik6IEdyb3VwTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgICBjb25zdCBkc0pzb24gPSB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZUpzb25CeUxheWVySXRlbShpdGVtLCBwb3J0YWxVcmwsIGppbXVDaGlsZElkLCBjaGlsZERzSWQpXG4gICAgaWYgKGRzSnNvbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IGNoaWxkRHNJZCxcbiAgICAgICAgZGF0YVNvdXJjZUpzb246IGRzSnNvbixcbiAgICAgICAgcGFyZW50RGF0YVNvdXJjZTogdGhpcyxcbiAgICAgICAgamltdUNoaWxkSWQsXG4gICAgICAgIG9yZGVyLFxuICAgICAgICBpdGVtRGF0YTogaXRlbVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVDaGlsZERhdGFTb3VyY2VKc29uQnlMYXllckl0ZW0gKGl0ZW1EYXRhOiBhbnksIHBvcnRhbFVybDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZERzSWQ6IHN0cmluZyk6IElNRGF0YVNvdXJjZUpzb24ge1xuICAgIGlmICghaXRlbURhdGEgfHwgIWNoaWxkRHNJZCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCBzY2hlbWFJbkNvbmZpZyA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWE/LmNoaWxkU2NoZW1hcz8uW2ppbXVDaGlsZElkXVxuICAgIGNvbnN0IGRzSnNvbkluQ29uZmlnID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmNoaWxkRGF0YVNvdXJjZUpzb25zPy5bamltdUNoaWxkSWRdXG5cbiAgICByZXR1cm4gZGF0YVNvdXJjZUpzb25DcmVhdG9yLmNyZWF0ZURhdGFTb3VyY2VKc29uQnlJdGVtRGF0YShjaGlsZERzSWQsIGl0ZW1EYXRhLCBwb3J0YWxVcmwsIGRzSnNvbkluQ29uZmlnLCBzY2hlbWFJbkNvbmZpZylcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5TGF5ZXIgKGxheWVyOiBfX2VzcmkuTGF5ZXIsIHVybDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZERzSWQ6IHN0cmluZywgb3JkZXI6IG51bWJlcik6IEdyb3VwTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgICBjb25zdCBkc0pzb24gPSB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZUpzb25CeUxheWVyKGxheWVyLCB1cmwsIGppbXVDaGlsZElkLCBjaGlsZERzSWQpXG4gICAgaWYgKGRzSnNvbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IGNoaWxkRHNJZCxcbiAgICAgICAgZGF0YVNvdXJjZUpzb246IGRzSnNvbixcbiAgICAgICAgcGFyZW50RGF0YVNvdXJjZTogdGhpcyxcbiAgICAgICAgamltdUNoaWxkSWQsXG4gICAgICAgIG9yZGVyLFxuICAgICAgICBsYXllclxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVDaGlsZERhdGFTb3VyY2VKc29uQnlMYXllciAobGF5ZXI6IF9fZXNyaS5MYXllciwgdXJsOiBzdHJpbmcsIGppbXVDaGlsZElkOiBzdHJpbmcsIGNoaWxkRHNJZDogc3RyaW5nKTogSU1EYXRhU291cmNlSnNvbiB7XG4gICAgaWYgKCFsYXllciB8fCAhY2hpbGREc0lkKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGNvbnN0IGxheWVyRGVmaW5pdGlvbiA9IChsYXllciBhcyBhbnkpLnNvdXJjZUpTT05cbiAgICAvLyBfamltdUNoaWxkSWRGcm9tTGFiZWwgaXMgdG8gc3VwcG9ydCBkYXRhIHNvdXJjZSBiZWZvcmUgZGV2MS4xNiwgc2VlIHVwZ3JhZGVDaGlsZERzc0lkIGZvciBtb3JlIGRldGFpbHMuXG4gICAgY29uc3QgX2ppbXVDaGlsZElkRnJvbUxhYmVsID0gZGF0YVNvdXJjZVV0aWxzLl9nZXRGaXhlZExheWVySWRCeUxheWVyRGVmaW5pdGlvbihsYXllckRlZmluaXRpb24pIHx8IGRhdGFTb3VyY2VVdGlscy5nZXRMYWJlbEZyb21BcmNHSVNTZXJ2aWNlVXJsKHVybClcbiAgICBjb25zdCBzY2hlbWFJbkNvbmZpZyA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWE/LmNoaWxkU2NoZW1hcz8uW2ppbXVDaGlsZElkXSB8fCB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuc2NoZW1hPy5jaGlsZFNjaGVtYXM/LltfamltdUNoaWxkSWRGcm9tTGFiZWxdXG4gICAgY29uc3QgZHNKc29uSW5Db25maWcgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuY2hpbGREYXRhU291cmNlSnNvbnM/LltqaW11Q2hpbGRJZF0gfHwgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmNoaWxkRGF0YVNvdXJjZUpzb25zPy5bX2ppbXVDaGlsZElkRnJvbUxhYmVsXVxuXG4gICAgcmV0dXJuIGRhdGFTb3VyY2VKc29uQ3JlYXRvci5jcmVhdGVEYXRhU291cmNlSnNvbkJ5SlNBUElMYXllcihjaGlsZERzSWQsIGxheWVyLCBkc0pzb25JbkNvbmZpZywgc2NoZW1hSW5Db25maWcpXG4gIH1cblxuICBwcml2YXRlIGZpbmRMYXllckluZm9PZkpTQVBJR3JvdXBMYXllciAoY2hpbGRJZDogc3RyaW5nKTogeyBsYXllcjogX19lc3JpLkxheWVyLCB1cmw6IHN0cmluZywgb3JkZXI6IG51bWJlciB9IHtcbiAgICBjb25zdCBsYXllcnMgPSB0aGlzLmdldEpTQVBJTGF5ZXJzQW5kVGFibGVzKClcblxuICAgIGxldCBsYXllckluZm86IHsgbGF5ZXI6IF9fZXNyaS5MYXllciwgdXJsOiBzdHJpbmcsIG9yZGVyOiBudW1iZXIgfVxuICAgIGxheWVycy5zb21lKChsLCBpKSA9PiB7XG4gICAgICBjb25zdCBsYXllclVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXRVcmxCeUxheWVyKGwpXG4gICAgICBjb25zdCBsYXllclNvdXJjZVVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXREYXRhU291cmNlU291cmNlVXJsKGxheWVyVXJsKVxuICAgICAgaWYgKHRoaXMuZ2V0Q2hpbGRJZEJ5TGF5ZXIobCkgPT09IGNoaWxkSWQpIHtcbiAgICAgICAgbGF5ZXJJbmZvID0ge1xuICAgICAgICAgIGxheWVyOiBsLFxuICAgICAgICAgIHVybDogbGF5ZXJTb3VyY2VVcmwsXG4gICAgICAgICAgb3JkZXI6IGlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfSlcblxuICAgIHJldHVybiBsYXllckluZm9cbiAgfVxuXG4gIHByaXZhdGUgZmluZExheWVySW5mb09mSlNBUElTdWJMYXllciAoY2hpbGRJZDogc3RyaW5nKTogeyBsYXllcjogX19lc3JpLlN1YmxheWVyLCB1cmw6IHN0cmluZywgb3JkZXI6IG51bWJlciB9IHtcbiAgICBjb25zdCBsYXllcnMgPSB0aGlzLmdldEpTQVBJU3ViTGF5ZXJzKClcblxuICAgIGxldCBsYXllckluZm86IHsgbGF5ZXI6IF9fZXNyaS5TdWJsYXllciwgdXJsOiBzdHJpbmcsIG9yZGVyOiBudW1iZXIgfVxuICAgIGxheWVycy5zb21lKChsLCBpKSA9PiB7XG4gICAgICBjb25zdCBsYXllclVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXRVcmxCeUxheWVyKGwpXG4gICAgICBjb25zdCBsYXllclNvdXJjZVVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXREYXRhU291cmNlU291cmNlVXJsKGxheWVyVXJsKVxuICAgICAgaWYgKHRoaXMuZ2V0Q2hpbGRJZEJ5U3ViTGF5ZXIobCkgPT09IGNoaWxkSWQpIHtcbiAgICAgICAgbGF5ZXJJbmZvID0ge1xuICAgICAgICAgIGxheWVyOiBsLFxuICAgICAgICAgIHVybDogbGF5ZXJTb3VyY2VVcmwsXG4gICAgICAgICAgb3JkZXI6IGlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfSlcblxuICAgIHJldHVybiBsYXllckluZm9cbiAgfVxuXG4gIHByaXZhdGUgZmluZExheWVySW5mb09mR3JvdXBMYXllckl0ZW0gKGNoaWxkSWQ6IHN0cmluZyk6IHsgbGF5ZXJJdGVtOiBJSXRlbSwgcG9ydGFsVXJsOiBzdHJpbmcsIG9yZGVyOiBudW1iZXIgfSB7XG4gICAgY29uc3QgbGF5ZXJzID0gdGhpcy5nZXRMYXllcnNPZkdyb3VwTGF5ZXJJdGVtKClcblxuICAgIGxldCBsYXllckluZm86IHsgbGF5ZXJJdGVtOiBJSXRlbSwgcG9ydGFsVXJsOiBzdHJpbmcsIG9yZGVyOiBudW1iZXIgfVxuICAgIGxheWVycy5zb21lKChsLCBpKSA9PiB7XG4gICAgICBpZiAodGhpcy5nZXRDaGlsZElkQnlMYXllckl0ZW0obCkgPT09IGNoaWxkSWQpIHtcbiAgICAgICAgbGF5ZXJJbmZvID0ge1xuICAgICAgICAgIGxheWVySXRlbTogbCxcbiAgICAgICAgICBvcmRlcjogaSxcbiAgICAgICAgICBwb3J0YWxVcmw6IHRoaXMucG9ydGFsVXJsXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH0pXG5cbiAgICByZXR1cm4gbGF5ZXJJbmZvXG4gIH1cblxuICBwcml2YXRlIGZpbmRMYXllckluZm9PZkZlYXR1cmVDb2xsZWN0aW9uSXRlbSAoY2hpbGRJZDogc3RyaW5nKTogeyBsYXllckRlZmluaXRpb246IFNlcnZpY2VEZWZpbml0aW9uLCBvcmRlcjogbnVtYmVyIH0ge1xuICAgIGNvbnN0IGxheWVycyA9IHRoaXMuZ2V0TGF5ZXJzT2ZGZWF0dXJlQ29sbGVjdGlvbkl0ZW0oKVxuXG4gICAgbGV0IGxheWVySW5mbzogeyBsYXllckRlZmluaXRpb246IFNlcnZpY2VEZWZpbml0aW9uLCBvcmRlcjogbnVtYmVyIH1cbiAgICBsYXllcnMuc29tZSgobCwgaSkgPT4ge1xuICAgICAgaWYgKHRoaXMuZ2V0Q2hpbGRJZEJ5TGF5ZXJEZWZpbml0aW9uKGwsIG51bGwpID09PSBjaGlsZElkKSB7XG4gICAgICAgIGxheWVySW5mbyA9IHtcbiAgICAgICAgICBsYXllckRlZmluaXRpb246IGwsXG4gICAgICAgICAgb3JkZXI6IGlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfSlcblxuICAgIHJldHVybiBsYXllckluZm9cbiAgfVxuXG4gIHByaXZhdGUgZ2V0SlNBUElTdWJMYXllcnMgKCk6IF9fZXNyaS5TdWJsYXllcltdIHtcbiAgICByZXR1cm4gKHRoaXMubGF5ZXIgYXMgX19lc3JpLlN1YmxheWVyKS5zdWJsYXllcnM/LnRvQXJyYXkoKT8ucmV2ZXJzZSgpIHx8IFtdXG4gIH1cblxuICBwcml2YXRlIGdldEpTQVBJTGF5ZXJzQW5kVGFibGVzICgpOiBfX2VzcmkuTGF5ZXJbXSB7XG4gICAgY29uc3QgbGF5ZXJzID0gKHRoaXMubGF5ZXIgYXMgX19lc3JpLkdyb3VwTGF5ZXIpLmxheWVycz8udG9BcnJheSgpPy5yZXZlcnNlKCkgfHwgW11cbiAgICBjb25zdCB0YWJsZXMgPSAodGhpcy5sYXllciBhcyBfX2VzcmkuR3JvdXBMYXllcikudGFibGVzPy50b0FycmF5KCk/LnJldmVyc2UoKSB8fCBbXVxuICAgIHJldHVybiBsYXllcnMuY29uY2F0KHRhYmxlcylcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TGF5ZXJzT2ZGZWF0dXJlQ29sbGVjdGlvbkl0ZW0gKCk6IFNlcnZpY2VEZWZpbml0aW9uW10ge1xuICAgIHJldHVybiB0aGlzLmdldEl0ZW1EYXRhKCk/LmxheWVycz8ubWFwKGwgPT4gbC5sYXllckRlZmluaXRpb24pIHx8IFtdXG4gIH1cblxuICBwcml2YXRlIGdldExheWVyc09mR3JvdXBMYXllckl0ZW0gKCk6IElJdGVtW10ge1xuICAgIHJldHVybiB0aGlzLmdldEl0ZW1EYXRhKCk/LmxheWVycyB8fCBbXVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDaGlsZElkc0J5SlNBUElTdWJMYXllciAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0aGlzLmdldEpTQVBJU3ViTGF5ZXJzKCkubWFwKGwgPT4gdGhpcy5nZXRDaGlsZElkQnlTdWJMYXllcihsKSlcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2hpbGRJZHNCeUpTQVBJR3JvdXBMYXllciAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0aGlzLmdldEpTQVBJTGF5ZXJzQW5kVGFibGVzKCkubWFwKGwgPT4gdGhpcy5nZXRDaGlsZElkQnlMYXllcihsKSlcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2hpbGRJZHNCeUZlYXR1cmVDb2xsZWN0aW9uSXRlbSAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0aGlzLmdldExheWVyc09mRmVhdHVyZUNvbGxlY3Rpb25JdGVtKCkubWFwKGwgPT4gdGhpcy5nZXRDaGlsZElkQnlMYXllckRlZmluaXRpb24obCwgbnVsbCkpXG4gIH1cblxuICBwcml2YXRlIGdldENoaWxkSWRzQnlHcm91cExheWVySXRlbSAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiB0aGlzLmdldExheWVyc09mR3JvdXBMYXllckl0ZW0oKS5tYXAobCA9PiB0aGlzLmdldENoaWxkSWRCeUxheWVySXRlbShsKSlcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXRDaGlsZElkQnlMYXllckl0ZW0gKGl0ZW06IElJdGVtKTogc3RyaW5nIHtcbiAgICAvLyBEaWRuJ3QgY3JlYXRlIGEgbmV3IHV0aWwgdG8gZ2V0IGNoaWxkIGlkIGJ5IGxheWVyIGl0ZW0gZGF0YSwgc2luY2UgdGhlIGxvZ2ljIGlzIHNpbWxpYXIuXG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5nZXRGaXhlZExheWVySWRCeUxheWVyRGVmaW5pdGlvbihpdGVtIGFzIHVua25vd24gYXMgU2VydmljZURlZmluaXRpb24pXG4gIH1cblxuICBwcml2YXRlIGlzSlNBUElHcm91cExheWVyIChsYXllcjogX19lc3JpLkdyb3VwTGF5ZXIgfCBfX2VzcmkuU3VibGF5ZXIpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKGxheWVyIGFzIF9fZXNyaS5MYXllcik/LnR5cGUgPT09IFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcy5Hcm91cExheWVyXG4gIH1cblxuICBwcml2YXRlIGlzRmVhdHVyZUNvbGxlY3Rpb25JdGVtIChpdGVtOiBJSXRlbSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBpdGVtPy50eXBlID09PSBTdXBwb3J0ZWRJdGVtVHlwZXMuRmVhdHVyZUNvbGxlY3Rpb25cbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCBEYXRhU291cmNlVHlwZXMsIHR5cGUgSW1hZ2VTZXJ2aWNlRGF0YVNvdXJjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyBJdGVtTWl4aW5JbXBsLCBKU0FQSUxheWVyTWl4aW5JbXBsLCBBYnN0cmFjdERhdGFTb3VyY2UgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2VyU2VydmljZURhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgZXh0ZW5kcyBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgbGF5ZXI/OiBfX2VzcmkuSW1hZ2VyeUxheWVyXG59XG5cbmV4cG9ydCBjbGFzcyBJbWFnZVNlcnZpY2VEYXRhU291cmNlSW1wbCBleHRlbmRzIEpTQVBJTGF5ZXJNaXhpbkltcGwoSXRlbU1peGluSW1wbChBYnN0cmFjdERhdGFTb3VyY2UpKSBpbXBsZW1lbnRzIEltYWdlU2VydmljZURhdGFTb3VyY2Uge1xuICBsYXllcj86IF9fZXNyaS5JbWFnZXJ5TGF5ZXIgfCBfX2VzcmkuSW1hZ2VyeVRpbGVMYXllclxuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuSW1hZ2VTZXJ2aWNlID0gRGF0YVNvdXJjZVR5cGVzLkltYWdlU2VydmljZVxuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zOiBJbWFnZXJTZXJ2aWNlRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpXG4gICAgaWYgKG9wdGlvbnMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIgPSBvcHRpb25zLmxheWVyXG4gICAgfVxuICAgIGNvbnN0IGRzSnNvbiA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKVxuICAgIHRoaXMucG9ydGFsVXJsID0gZHNKc29uLnBvcnRhbFVybFxuICAgIHRoaXMuaXRlbUlkID0gZHNKc29uLml0ZW1JZFxuICB9XG5cbiAgYXN5bmMgcmVhZHkgKCkge1xuICAgIGlmICghdGhpcy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IGF3YWl0IHRoaXMuY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpIGFzIF9fZXNyaS5JbWFnZXJ5TGF5ZXIgfCBfX2VzcmkuSW1hZ2VyeVRpbGVMYXllclxuICAgIH1cbiAgICBhd2FpdCB0aGlzLmxheWVyLmxvYWQoKVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxuICB9XG59XG4iLCJpbXBvcnQgeyByZXF1ZXN0VXRpbHMgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VUeXBlcywgdHlwZSBLTUxEYXRhU291cmNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IEl0ZW1NaXhpbkltcGwsIEpTQVBJTGF5ZXJNaXhpbkltcGwsIEFic3RyYWN0RGF0YVNvdXJjZSB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcblxuZXhwb3J0IGludGVyZmFjZSBLTUxEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIGV4dGVuZHMgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIGxheWVyPzogX19lc3JpLktNTExheWVyXG59XG5cbmV4cG9ydCBjbGFzcyBLTUxEYXRhU291cmNlSW1wbCBleHRlbmRzIEpTQVBJTGF5ZXJNaXhpbkltcGwoSXRlbU1peGluSW1wbChBYnN0cmFjdERhdGFTb3VyY2UpKSBpbXBsZW1lbnRzIEtNTERhdGFTb3VyY2Uge1xuICBsYXllcj86IF9fZXNyaS5LTUxMYXllclxuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuS01MID0gRGF0YVNvdXJjZVR5cGVzLktNTFxuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zOiBLTUxEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcbiAgICBpZiAob3B0aW9ucy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IG9wdGlvbnMubGF5ZXJcbiAgICB9XG4gICAgY29uc3QgZHNKc29uID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpXG4gICAgdGhpcy5wb3J0YWxVcmwgPSBkc0pzb24ucG9ydGFsVXJsXG4gICAgdGhpcy5pdGVtSWQgPSBkc0pzb24uaXRlbUlkXG5cbiAgICBpZiAodGhpcy51cmwgfHwgKHRoaXMucG9ydGFsVXJsICYmIHRoaXMuaXRlbUlkKSkge1xuICAgICAgLyoqXG4gICAgICAgKiBLTUwgbGF5ZXIgd2lsbCB1c2UgdGhlIHV0aWxpdHkgc2VydmljZSB0byBhbmFseXplIHRoZSB1cmwvcG9ydGFsIGl0ZW0gZGF0YS5cbiAgICAgICAqXG4gICAgICAgKiBDYWNoZSByZXF1ZXN0IHNpbmNlIC1cbiAgICAgICAqIDEuIHdlIG5lZWQgdG8gY2FjaGUgdGhlIHJlcXVlc3Qgc2luY2UgdGhlIHJlY29yZHMgYXJlIHNhdmVkIGhlcmUsIHdoaWNoIG1lYW5zLCB0aGUgcmVzcG9uc2Ugc2l6ZSBtYXkgYmUgbGFyZ2UuXG4gICAgICAgKiAyLiB3ZSBkb24ndCBrbm93IHRoZSBVUkwgc2NoZW1hIG9mIHRoaXMgdHlwZSBvZiBkYXRhIHNvdXJjZSwgY2FuIG5vdCBjYWNoZSB0aGVtIGJ5IGRlZmF1bHQuXG4gICAgICAgKi9cbiAgICAgIHJlcXVlc3RVdGlscy5yZWdpc3RlckNhY2hlYWJsZVVybCgodXJsLCBxdWVyeSkgPT4ge1xuICAgICAgICBpZiAodXJsICE9PSAnaHR0cHM6Ly91dGlsaXR5LmFyY2dpcy5jb20vc2hhcmluZy9rbWwnKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc291cmNlVXJsID0gKHF1ZXJ5IGFzIHsgdXJsOiBzdHJpbmcgfSk/LnVybFxuICAgICAgICByZXR1cm4gc291cmNlVXJsLmluY2x1ZGVzKHRoaXMudXJsKSB8fCBzb3VyY2VVcmwuaW5jbHVkZXMoYCR7dGhpcy5wb3J0YWxVcmx9L3NoYXJpbmcvcmVzdC9jb250ZW50L2l0ZW1zLyR7dGhpcy5pdGVtSWR9YClcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVhZHkgKCkge1xuICAgIGlmICghdGhpcy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IGF3YWl0IHRoaXMuY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpIGFzIF9fZXNyaS5LTUxMYXllclxuICAgIH1cbiAgICBhd2FpdCB0aGlzLmxheWVyLmxvYWQoKVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxuICB9XG59XG4iLCJpbXBvcnQgeyBhcHBBY3Rpb25zLCBkYXRhU291cmNlVXRpbHMsIGdldEFwcFN0b3JlLCB1dGlscyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IEFic3RyYWN0TGF5ZXJGb2xkZXJEYXRhU291cmNlLCB0eXBlIExheWVyRm9sZGVyQ2hpbGREYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIH0gZnJvbSAnLi4vYmFzZS1jbGFzc2VzJ1xuaW1wb3J0IHsgRGF0YVNvdXJjZVR5cGVzLCB0eXBlIE1hcFNlcnZpY2VEYXRhU291cmNlLCB0eXBlIEZlYXR1cmVMYXllckRhdGFTb3VyY2UsIHR5cGUgVGltZUluZm8sIHR5cGUgVGltZUV4dGVudCwgdHlwZSBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5cbi8qKlxuICogRGF0YSBzb3VyY2UgZnJvbSBhIG1hcCBzZXJ2aWNlLCB3aGljaCBtYXkgY29udGFpbiBtdWx0aXBsZSBjaGlsZCBkYXRhIHNvdXJjZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBNYXBTZXJ2aWNlRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSBpbXBsZW1lbnRzIE1hcFNlcnZpY2VEYXRhU291cmNlIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLk1hcFNlcnZpY2UgPSBEYXRhU291cmNlVHlwZXMuTWFwU2VydmljZVxuICBsYXllcj86IF9fZXNyaS5NYXBJbWFnZUxheWVyIHwgX19lc3JpLlRpbGVMYXllclxuXG4gIGdldENoaWxkSWRzICgpOiBzdHJpbmdbXSB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldENoaWxkSWRzQnlMYXllcigpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdldENoaWxkSWRzQnlVcmwoKVxuICAgIH1cbiAgfVxuXG4gIGNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkIChjaGlsZERzSWQ6IHN0cmluZywgamltdUNoaWxkSWQ6IHN0cmluZywgY2hpbGRJZDogc3RyaW5nKTogTGF5ZXJGb2xkZXJDaGlsZERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICAgIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlJZEZyb21MYXllcihjaGlsZERzSWQsIGppbXVDaGlsZElkLCBjaGlsZElkKVxuICAgIH0gZWxzZSBpZiAodGhpcy51cmwpIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNoaWxkRGF0YVNvdXJjZU9wdGlvbnNCeUlkRnJvbVVybChjaGlsZERzSWQsIGppbXVDaGlsZElkLCBjaGlsZElkKVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgc3VwcG9ydFRpbWUgKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuc3VwcG9ydFRpbWUodGhpcylcbiAgfVxuXG4gIGdldFRpbWVJbmZvICgpOiBUaW1lSW5mbyB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIHJldHVybiAodGhpcy5sYXllciBhcyBfX2VzcmkuTWFwSW1hZ2VMYXllcikudGltZUluZm8/LnRvSlNPTigpIGFzIFRpbWVJbmZvXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFNlcnZpY2VEZWZpbml0aW9uKCk/LnRpbWVJbmZvIGFzIFRpbWVJbmZvXG4gICAgfVxuICB9XG5cbiAgZ2V0VGltZUV4dGVudCAoKTogVGltZUV4dGVudCB7XG4gICAgY29uc3Qgd2lkZ2V0UXVlcmllcyA9IHRoaXMuZ2V0SW5mbygpLndpZGdldFF1ZXJpZXMgfHwge31cbiAgICBjb25zdCB0aW1lQXJyID0gT2JqZWN0LnZhbHVlcyh3aWRnZXRRdWVyaWVzKS5tYXAoKHE6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKSA9PiBxPy50aW1lKS5maWx0ZXIodyA9PiB0eXBlb2YgdyA9PT0gJ251bWJlcicgfHwgQXJyYXkuaXNBcnJheSh3KSlcbiAgICBjb25zdCB0aW1lID0gdGltZUFyci5sZW5ndGggPiAxID8gdGltZUFyci5yZWR1Y2UoKHJlcywgdCkgPT4gKGRhdGFTb3VyY2VVdGlscy5tZXJnZVRpbWVFeHRlbnQocmVzLCB0KSksIG51bGwpIDogdGltZUFyclswXVxuICAgIHJldHVybiB0aW1lXG4gIH1cblxuICBjaGFuZ2VUaW1lRXh0ZW50ICh0aW1lOiBUaW1lRXh0ZW50LCB3aWRnZXRJZDogc3RyaW5nKSB7XG4gICAgaWYgKCF1dGlscy5pc0RlZXBFcXVhbCh0aW1lLCAodGhpcy5nZXRJbmZvKCkud2lkZ2V0UXVlcmllcz8uW3dpZGdldElkXSBhcyBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk/LnRpbWUpKSB7XG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMudXBkYXRlV2lkZ2V0UXVlcnkodGhpcy5pZCwgd2lkZ2V0SWQsIHsgdGltZSB9IGFzIEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKSlcbiAgICAgIHRoaXMuZ2V0QWxsQ2hpbGREYXRhU291cmNlcygpLmZvckVhY2goY0RzID0+IHtcbiAgICAgICAgaWYgKGNEcy50eXBlID09PSBEYXRhU291cmNlVHlwZXMuRmVhdHVyZUxheWVyKSB7XG4gICAgICAgICAgKGNEcyBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlKS51cGRhdGVRdWVyeVBhcmFtcyh7IHRpbWUgfSBhcyBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgd2lkZ2V0SWQpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgY2hhbmdlR0RCVmVyc2lvbiAoZ2RiVmVyc2lvbjogc3RyaW5nKSB7XG4gICAgc3VwZXIuY2hhbmdlR0RCVmVyc2lvbihnZGJWZXJzaW9uKVxuXG4gICAgaWYgKHRoaXMubGF5ZXIgJiYgdGhpcy5sYXllci50eXBlID09PSAnbWFwLWltYWdlJykge1xuICAgICAgdGhpcy5sYXllci5nZGJWZXJzaW9uID0gZ2RiVmVyc2lvblxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5SWRGcm9tTGF5ZXIgKGNoaWxkRHNJZDogc3RyaW5nLCBqaW11Q2hpbGRJZDogc3RyaW5nLCBjaGlsZElkOiBzdHJpbmcpOiBMYXllckZvbGRlckNoaWxkRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIGNvbnN0IGxheWVySW5mbyA9IHRoaXMuZmluZFN1YkxheWVySW5mbyhjaGlsZElkKVxuICAgICAgaWYgKCFsYXllckluZm8/LnN1YkxheWVyKSB7XG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRzT3B0aW9ucyA9IHRoaXMuY3JlYXRlQ2hpbGREYXRhU291cmNlT3B0aW9uc0J5TGF5ZXJEZWZpbml0aW9uKGxheWVySW5mby5zdWJMYXllci5zb3VyY2VKU09OLCBsYXllckluZm8udXJsLCBqaW11Q2hpbGRJZCwgY2hpbGREc0lkLCBsYXllckluZm8ub3JkZXIpXG4gICAgICBpZiAobGF5ZXJJbmZvLnN1YkxheWVyLnRpdGxlICYmIGRzT3B0aW9ucy5kYXRhU291cmNlSnNvbikge1xuICAgICAgICBkc09wdGlvbnMuZGF0YVNvdXJjZUpzb24gPSBkc09wdGlvbnMuZGF0YVNvdXJjZUpzb24uc2V0KCdzb3VyY2VMYWJlbCcsIGxheWVySW5mby5zdWJMYXllci50aXRsZSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRzT3B0aW9ucyA/IHsgLi4uZHNPcHRpb25zLCBsYXllcjogbGF5ZXJJbmZvLnN1YkxheWVyIH0gOiBudWxsXG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHByaXZhdGUgZmluZFN1YkxheWVySW5mbyAoY2hpbGRJZDogc3RyaW5nKTogeyBzdWJMYXllcjogX19lc3JpLlN1YmxheWVyLCB1cmw6IHN0cmluZywgb3JkZXI6IG51bWJlciB9IHtcbiAgICBjb25zdCBzdWJMYXllcnMgPSB0aGlzLmdldFN1YkxheWVycygpXG5cbiAgICBsZXQgc3ViTGF5ZXJJbmZvOiB7IHN1YkxheWVyOiBfX2VzcmkuU3VibGF5ZXIsIHVybDogc3RyaW5nLCBvcmRlcjogbnVtYmVyIH1cbiAgICBzdWJMYXllcnMuc29tZSgoc3ViTGF5ZXIsIGkpID0+IHtcbiAgICAgIGNvbnN0IGxheWVyVXJsID0gZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIoc3ViTGF5ZXIpXG4gICAgICBjb25zdCBsYXllclNvdXJjZVVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXREYXRhU291cmNlU291cmNlVXJsKGxheWVyVXJsKVxuICAgICAgaWYgKHRoaXMuZ2V0Q2hpbGRJZEJ5U3ViTGF5ZXIoc3ViTGF5ZXIpID09PSBjaGlsZElkKSB7XG4gICAgICAgIHN1YkxheWVySW5mbyA9IHtcbiAgICAgICAgICBzdWJMYXllcjogc3ViTGF5ZXIsXG4gICAgICAgICAgdXJsOiBsYXllclNvdXJjZVVybCxcbiAgICAgICAgICBvcmRlcjogaVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9KVxuXG4gICAgcmV0dXJuIHN1YkxheWVySW5mb1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRTdWJMYXllcnMgKCk6IF9fZXNyaS5TdWJsYXllcltdIHtcbiAgICByZXR1cm4gdGhpcy5sYXllci5zdWJsYXllcnM/LnRvQXJyYXkoKT8ucmV2ZXJzZSgpIHx8IFtdXG4gIH1cblxuICBwcml2YXRlIGdldENoaWxkSWRzQnlMYXllciAoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiAodGhpcy5sYXllcj8uc3VibGF5ZXJzPy50b0FycmF5KCkgfHwgW10pLm1hcChsID0+IHRoaXMuZ2V0Q2hpbGRJZEJ5U3ViTGF5ZXIobCkpXG4gIH1cbn1cbiIsImltcG9ydCB7XG4gIGRhdGFTb3VyY2VVdGlscywgU2VydmljZU1hbmFnZXIsIHR5cGUgSU1EYXRhU291cmNlSnNvbiwgdHlwZSBJTURhdGFTb3VyY2VTY2hlbWEsIHR5cGUgSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEsXG4gIERhdGFTb3VyY2VNYW5hZ2VyLCBJbW11dGFibGUsIGdldEFwcFN0b3JlLCBhcHBBY3Rpb25zLCBvYnNlcnZlU3RvcmUsIHV0aWxzXG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgSUZlYXR1cmUsIHR5cGUgSUl0ZW0sIHR5cGUgSUxheWVyRGVmaW5pdGlvbiwgdHlwZSBJUG9wdXBJbmZvIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnXG5pbXBvcnQgeyBBYnN0cmFjdFF1ZXJpYWJsZURhdGFTb3VyY2UgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMvYWJzdHJhY3QtcXVlcmlhYmxlLWRhdGEtc291cmNlJ1xuaW1wb3J0IHsgdHlwZSBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCBEYXRhU291cmNlVHlwZXMsIHR5cGUgU2NlbmVMYXllckRhdGFTb3VyY2UsIHR5cGUgSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgdHlwZSBRdWVyeVJlc3VsdCwgdHlwZSBGZWF0dXJlRGF0YVJlY29yZCwgdHlwZSBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgdHlwZSBDb2RlZFZhbHVlLCB0eXBlIFdpZGdldERhdGFTb3VyY2VQYWlyLCB0eXBlIFF1ZXJ5T3B0aW9ucywgdHlwZSBEYXRhUmVjb3JkLCB0eXBlIFF1ZXJ5UGFyYW1zLCB0eXBlIEdldEN1cnJlbnRRdWVyeVBhcmFtc09wdGlvbnMsIHR5cGUgRmVhdHVyZUxheWVyU2VsZWN0T3B0aW9ucywgdHlwZSBGZWF0dXJlTGF5ZXJDYXBhYmlsaXRpZXMsIHR5cGUgUXVlcnlQcm9ncmVzc0NhbGxiYWNrLCB0eXBlIEZlYXR1cmVMYXllclVzZWRGaWVsZHNPcHRpb25zIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IHR5cGUgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGwsIHR5cGUgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB9IGZyb20gJy4vZmVhdHVyZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgSXRlbU1peGluSW1wbCwgSlNBUElMYXllck1peGluSW1wbCB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcbmltcG9ydCB7IEZlYXR1cmVEYXRhUmVjb3JkSW1wbCB9IGZyb20gJy4vZmVhdHVyZS1yZWNvcmQtaW1wbCdcbmltcG9ydCAqIGFzIGRhdGFTb3VyY2VKc29uQ3JlYXRvciBmcm9tICcuLi9zdXBwb3J0L2RhdGEtc291cmNlLWpzb24tY3JlYXRvcidcblxuY29uc3QgQVNTT0NJQVRFRF9EQVRBX1NPVVJDRV9JRCA9ICdhc3NvY2lhdGVkX2RhdGFfc291cmNlJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjZW5lTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIGV4dGVuZHMgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIGxheWVyPzogX19lc3JpLlNjZW5lTGF5ZXJcbn1cblxuZXhwb3J0IGNsYXNzIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCBleHRlbmRzIEpTQVBJTGF5ZXJNaXhpbkltcGwoSXRlbU1peGluSW1wbChBYnN0cmFjdFF1ZXJpYWJsZURhdGFTb3VyY2UpKSBpbXBsZW1lbnRzIFNjZW5lTGF5ZXJEYXRhU291cmNlIHtcbiAgbGF5ZXJJZD86IHN0cmluZ1xuXG4gIHByaXZhdGUgX2xheWVyPzogX19lc3JpLlNjZW5lTGF5ZXJcbiAgcHJpdmF0ZSBsYXllckRlZmluaXRpb246IElMYXllckRlZmluaXRpb25cbiAgcHJpdmF0ZSBwb3B1cEluZm86IElQb3B1cEluZm9cbiAgcHJvdGVjdGVkIGFzc29jaWF0ZWREYXRhU291cmNlOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbFxuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuU2NlbmVMYXllciA9IERhdGFTb3VyY2VUeXBlcy5TY2VuZUxheWVyXG5cbiAgY29uc3RydWN0b3IgKG9wdGlvbnM6IFNjZW5lTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcbiAgICBjb25zdCBkc0pzb24gPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKClcbiAgICB0aGlzLnBvcnRhbFVybCA9IGRzSnNvbi5wb3J0YWxVcmxcbiAgICB0aGlzLml0ZW1JZCA9IGRzSnNvbi5pdGVtSWRcbiAgICB0aGlzLmxheWVySWQgPSBkc0pzb24ubGF5ZXJJZFxuXG4gICAgaWYgKG9wdGlvbnMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIgPSBvcHRpb25zLmxheWVyXG4gICAgfVxuXG4gICAgaWYgKG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlICYmIChvcHRpb25zLmJlbG9uZ1RvRGF0YVNvdXJjZSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZSkubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIgPSAob3B0aW9ucy5iZWxvbmdUb0RhdGFTb3VyY2UgYXMgU2NlbmVMYXllckRhdGFTb3VyY2UpLmxheWVyXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNMb2NhbCkge1xuICAgICAgY29uc3QgYXNzb2NpYXRlZERhdGFTb3VyY2VCZWxvbmdUb0RhdGFTb3VyY2UgPSAob3B0aW9ucy5iZWxvbmdUb0RhdGFTb3VyY2UgYXMgU2NlbmVMYXllckRhdGFTb3VyY2VJbXBsKT8uZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKVxuICAgICAgaWYgKGFzc29jaWF0ZWREYXRhU291cmNlQmVsb25nVG9EYXRhU291cmNlKSB7XG4gICAgICAgIERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuY3JlYXRlTG9jYWxEYXRhU291cmNlKGFzc29jaWF0ZWREYXRhU291cmNlQmVsb25nVG9EYXRhU291cmNlLCB0aGlzLmxvY2FsSWQpXG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzRGF0YVZpZXcpIHtcbiAgICAgIGNvbnN0IGFzc29jaWF0ZWREYXRhU291cmNlQmVsb25nVG9EYXRhU291cmNlID0gKG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlIGFzIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCk/LmdldEFzc29jaWF0ZWREYXRhU291cmNlKClcbiAgICAgIGlmIChhc3NvY2lhdGVkRGF0YVNvdXJjZUJlbG9uZ1RvRGF0YVNvdXJjZSkge1xuICAgICAgICBEYXRhU291cmNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmNyZWF0ZURhdGFWaWV3KGFzc29jaWF0ZWREYXRhU291cmNlQmVsb25nVG9EYXRhU291cmNlLCB0aGlzLmRhdGFWaWV3SWQpXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSkge1xuICAgICAgLy8gS2VlcCBkYXRhIHZpZXcgYW5kIGxvY2FsIHNjZW5lIGxheWVyIGRhdGEgc291cmNlJ3MgaW5mbyBpcyBzYW1lIGFzIGFzc29jaWF0ZWQgZGF0YSBzb3VyY2UncyBpbmZvLlxuICAgICAgb2JzZXJ2ZVN0b3JlKHRoaXMub25JbmZvQ2hhbmdlLmJpbmQodGhpcyksIFsnZGF0YVNvdXJjZXNJbmZvJywgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpLmlkXSlcbiAgICAgIC8vIFNldCBkYXRhIHZpZXcgYW5kIGxvY2FsIGFzc29jaWF0ZWQgZmVhdHVyZSBsYXllciBkYXRhIHNvdXJjZSdzIGFzc29jaWF0ZWQgZGF0YSBzb3VyY2UgdG8gc2NlbmUgbGF5ZXIgZGF0YSBzb3VyY2UuXG4gICAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkuc2V0QXNzb2NpYXRlZERhdGFTb3VyY2UodGhpcylcbiAgICB9XG5cbiAgICBpZiAodGhpcy5sYXllcj8ucG9ydGFsSXRlbSkge1xuICAgICAgdGhpcy5zZXRJdGVtSW5mbyh0aGlzLmxheWVyLnBvcnRhbEl0ZW0uc291cmNlSlNPTiBhcyBJSXRlbSlcbiAgICB9XG4gIH1cblxuICBhc3luYyByZWFkeSAoKSB7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5mZXRjaExheWVyRGVmaW5pdGlvbigpLFxuICAgICAgdGhpcy5jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZSgpXG4gICAgXSkudGhlbigoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ05lZWQgYXNzb2NpYXRlZCBmZWF0dXJlIGxheWVyLicpXG4gICAgICB9XG4gICAgICByZXR1cm4gc3VwZXIucmVhZHkoKVxuICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgLy8gS2VlcCBtYWluIHNjZW5lIGxheWVyIGRhdGEgc291cmNlJ3MgaW5mbyBpcyBzYW1lIGFzIGFzc29jaWF0ZWQgZGF0YSBzb3VyY2UncyBpbmZvLlxuICAgICAgaWYgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSkge1xuICAgICAgICBvYnNlcnZlU3RvcmUodGhpcy5vbkluZm9DaGFuZ2UuYmluZCh0aGlzKSwgWydkYXRhU291cmNlc0luZm8nLCB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkuaWRdKVxuICAgICAgfVxuICAgICAgLy8gU3luYyBwb3B1cFRlbXBsYXRlIHRvIGFzc29jaWF0ZWQgZmVhdHVyZSBsYXllci5cbiAgICAgIGlmICh0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmxheWVyICYmIHRoaXMubGF5ZXI/LnBvcHVwVGVtcGxhdGUpIHtcbiAgICAgICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpLmxheWVyLnBvcHVwVGVtcGxhdGUgPSB0aGlzLmxheWVyLnBvcHVwVGVtcGxhdGVcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLy8gTmVlZCB0byBrZWVwIHRoZSBzY2VuZSBsYXllciBkYXRhIHNvdXJjZSdzIGluZm8gaXMgc2FtZSBhcyB0aGUgYXNzb2NpYXRlZCBkYXRhIHNvdXJjZSdzIChmZWF0dXJlIGxheWVyIGRhdGEgc291cmNlKSBpbmZvLCBleGNlcHQgZm9yIGBpbnN0YW5jZVN0YXR1c2AuXG4gIHByaXZhdGUgb25JbmZvQ2hhbmdlICgpIHtcbiAgICBpZiAodGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpICYmICF1dGlscy5pc0RlZXBFcXVhbCh0aGlzLmdldEluZm8oKS53aXRob3V0KCdpbnN0YW5jZVN0YXR1cycpLCB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkuZ2V0SW5mbygpLndpdGhvdXQoJ2luc3RhbmNlU3RhdHVzJykpKSB7XG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKFxuICAgICAgICBhcHBBY3Rpb25zLnVwZGF0ZURhdGFTb3VyY2VJbmZvKFxuICAgICAgICAgIHRoaXMuaWQsXG4gICAgICAgICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpLmdldEluZm8oKS53aXRob3V0KCdpbnN0YW5jZVN0YXR1cycpLnNldCgnaW5zdGFuY2VTdGF0dXMnLCB0aGlzLmdldEluZm8oKS5pbnN0YW5jZVN0YXR1cylcbiAgICAgICAgKVxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUFzc29jaWF0ZWREYXRhU291cmNlICgpOiBQcm9taXNlPEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsPiB7XG4gICAgaWYgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSkge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZSh0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkpXG4gICAgfVxuICAgIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5fY3JlYXRlQXNzb2NpYXRlZERhdGFTb3VyY2VXaXRoTGF5ZXIoKS50aGVuKGFzc29jaWF0ZWREYXRhU291cmNlID0+IHtcbiAgICAgICAgaWYgKCFhc3NvY2lhdGVkRGF0YVNvdXJjZSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZVdpdGhVcmwoKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhc3NvY2lhdGVkRGF0YVNvdXJjZVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUFzc29jaWF0ZWREYXRhU291cmNlV2l0aFVybCgpXG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIGFzeW5jIF9jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZVdpdGhMYXllciAoKTogUHJvbWlzZTxGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbD4ge1xuICAgIGNvbnN0IGRzSWQgPSB0aGlzLl9nZXROZXdBc3NvY2lhdGVkRGF0YVNvdXJjZUlkKClcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5sYXllci5sb2FkKCkudGhlbihhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhc3NvY2lhdGVkRmVhdHVyZUxheWVyID0gKHRoaXMubGF5ZXIgYXMgYW55KS5hc3NvY2lhdGVkTGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllclxuICAgICAgaWYgKCFhc3NvY2lhdGVkRmVhdHVyZUxheWVyKSB7XG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmxheWVyLmRlZmluaXRpb25FeHByZXNzaW9uKSB7XG4gICAgICAgIGFzc29jaWF0ZWRGZWF0dXJlTGF5ZXIuZGVmaW5pdGlvbkV4cHJlc3Npb24gPSB0aGlzLmxheWVyLmRlZmluaXRpb25FeHByZXNzaW9uXG4gICAgICB9XG5cbiAgICAgIGxldCBkc0pzb246IElNRGF0YVNvdXJjZUpzb24gPSBJbW11dGFibGUoe1xuICAgICAgICBpZDogZHNJZCxcbiAgICAgICAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllcixcbiAgICAgICAgdXJsOiBkYXRhU291cmNlVXRpbHMuZ2V0VXJsQnlMYXllcihhc3NvY2lhdGVkRmVhdHVyZUxheWVyKVxuICAgICAgfSlcbiAgICAgIGRzSnNvbiA9IHRoaXMuX21lcmdlQXNzb2NpYXRlZERhdGFTb3VyY2VKc29uKGRzSnNvbilcblxuICAgICAgY29uc3Qgb3B0aW9uczogRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyA9IHtcbiAgICAgICAgaWQ6IGRzSWQsXG4gICAgICAgIGRhdGFTb3VyY2VKc29uOiBkc0pzb24sXG4gICAgICAgIGxheWVyOiBhc3NvY2lhdGVkRmVhdHVyZUxheWVyLFxuICAgICAgICBhc3NvY2lhdGVkRGF0YVNvdXJjZTogdGhpc1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5kYXRhU291cmNlTWFuYWdlci5jcmVhdGVEYXRhU291cmNlKG9wdGlvbnMpXG4gICAgfSkudGhlbihkcyA9PiB7XG4gICAgICB0aGlzLmFzc29jaWF0ZWREYXRhU291cmNlID0gZHMgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGxcbiAgICAgIHJldHVybiB0aGlzLmFzc29jaWF0ZWREYXRhU291cmNlXG4gICAgfSlcbiAgfVxuXG4gIHByb3RlY3RlZCBhc3luYyBfY3JlYXRlQXNzb2NpYXRlZERhdGFTb3VyY2VXaXRoVXJsICgpOiBQcm9taXNlPEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsPiB7XG4gICAgY29uc3QgZHNJZCA9IHRoaXMuX2dldE5ld0Fzc29jaWF0ZWREYXRhU291cmNlSWQoKVxuICAgIHJldHVybiBhd2FpdCBkYXRhU291cmNlVXRpbHMuZmV0Y2hBc3NvY2lhdGVkRmVhdHVyZUxheWVyRGVmaW5pdGlvbih0aGlzLnVybCwgdGhpcy5sYXllcklkLCB0aGlzLml0ZW1JZCwgdGhpcy5wb3J0YWxVcmwpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICBpZiAoIXJlcykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnQ2FuIG5vdCBmaW5kIGFzc29jaWF0ZWQgZmVhdHVyZSBsYXllcicpXG4gICAgICAgIH1cbiAgICAgICAgbGV0IGRzSnNvbiA9IGRhdGFTb3VyY2VKc29uQ3JlYXRvci5jcmVhdGVEYXRhU291cmNlSnNvbkJ5TGF5ZXJEZWZpbml0aW9uKGRzSWQsIHJlcy5kZWYsIHJlcy51cmwpXG4gICAgICAgIGRzSnNvbiA9IHRoaXMuX21lcmdlQXNzb2NpYXRlZERhdGFTb3VyY2VKc29uKGRzSnNvbilcblxuICAgICAgICByZXR1cm4gZHNKc29uXG4gICAgICB9KS50aGVuKGFzeW5jIGRzSnNvbiA9PiB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnM6IEZlYXR1cmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7XG4gICAgICAgICAgaWQ6IGRzSnNvbi5pZCxcbiAgICAgICAgICBkYXRhU291cmNlSnNvbjogZHNKc29uLFxuICAgICAgICAgIGFzc29jaWF0ZWREYXRhU291cmNlOiB0aGlzXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuY3JlYXRlRGF0YVNvdXJjZShvcHRpb25zKVxuICAgICAgfSkudGhlbihkcyA9PiB7XG4gICAgICAgIHRoaXMuYXNzb2NpYXRlZERhdGFTb3VyY2UgPSBkcyBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbFxuICAgICAgICByZXR1cm4gdGhpcy5hc3NvY2lhdGVkRGF0YVNvdXJjZVxuICAgICAgfSlcbiAgfVxuXG4gIHByb3RlY3RlZCBfZ2V0TmV3QXNzb2NpYXRlZERhdGFTb3VyY2VJZCAoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7dGhpcy5nZXREYXRhU291cmNlSnNvbigpLmlkfS0ke0FTU09DSUFURURfREFUQV9TT1VSQ0VfSUR9YFxuICB9XG5cbiAgZ2V0VGltZXpvbmUgKCk6ICd1bmtub3duJyB8ICdkZXZpY2UnIHwgc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRUaW1lem9uZSgpXG4gIH1cblxuICBhc3luYyBmZXRjaExheWVyRGVmaW5pdGlvbiAoKTogUHJvbWlzZTxJTGF5ZXJEZWZpbml0aW9uPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVybCA9IHRoaXMudXJsXG4gICAgICBpZiAodGhpcy5sYXllcikge1xuICAgICAgICBhd2FpdCB0aGlzLmxheWVyLmxvYWQoKVxuICAgICAgICB0aGlzLmxheWVyRGVmaW5pdGlvbiA9IHtcbiAgICAgICAgICBpZDogdGhpcy5sYXllci5sYXllcklkLFxuICAgICAgICAgIGZpZWxkczogdGhpcy5sYXllci5maWVsZHM/Lm1hcChmID0+IGY/LnRvSlNPTigpKVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudXJsKSB7XG4gICAgICAgIGNvbnN0IGxheWVyRGVmID0gYXdhaXQgU2VydmljZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5mZXRjaFNlcnZpY2VJbmZvKHVybCkudGhlbihyZXMgPT4gcmVzLmRlZmluaXRpb24pXG4gICAgICAgICAgLnRoZW4oZGVmaW5pdGlvbiA9PiB7XG4gICAgICAgICAgICBpZiAoIWRlZmluaXRpb24pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBkZWZpbml0aW9uIGFzIElMYXllckRlZmluaXRpb25cbiAgICAgICAgICB9KVxuICAgICAgICB0aGlzLmxheWVyRGVmaW5pdGlvbiA9IGxheWVyRGVmXG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMubGF5ZXJEZWZpbml0aW9uKVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKVxuICAgIH1cbiAgfVxuXG4gIGdldExheWVyRGVmaW5pdGlvbiAoKTogSUxheWVyRGVmaW5pdGlvbiB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5nZXRMYXllckRlZmluaXRpb24odGhpcylcbiAgfVxuXG4gIHNldExheWVyRGVmaW5pdGlvbiAobGF5ZXJEZWY6IElMYXllckRlZmluaXRpb24pIHtcbiAgICB0aGlzLmxheWVyRGVmaW5pdGlvbiA9IGxheWVyRGVmXG4gIH1cblxuICBnZXRQb3B1cEluZm8gKCk6IElQb3B1cEluZm8ge1xuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuZ2V0UG9wdXBJbmZvKHRoaXMpXG4gIH1cblxuICBzZXRQb3B1cEluZm8gKHBvcHVwSW5mbzogSVBvcHVwSW5mbykge1xuICAgIHRoaXMucG9wdXBJbmZvID0gcG9wdXBJbmZvXG4gIH1cblxuICBnZXRDYXBhYmlsaXRpZXMgKCk6IEZlYXR1cmVMYXllckNhcGFiaWxpdGllcyB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0Q2FwYWJpbGl0aWVzKClcbiAgfVxuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgLSBUUzI2MTEgZXJyb3IsIHNlZW1zIHRvIGJlIHNvbHZlZCBpbiB2NC44LjAsIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvNDEzNDcgLlxuICBnZXQgbGF5ZXIgKCk6IF9fZXNyaS5TY2VuZUxheWVyIHtcbiAgICByZXR1cm4gZGF0YVNvdXJjZVV0aWxzLmdldEpTQVBJTGF5ZXIodGhpcykgYXMgX19lc3JpLlNjZW5lTGF5ZXJcbiAgfVxuXG4gIHNldCBsYXllciAobDogX19lc3JpLlNjZW5lTGF5ZXIpIHtcbiAgICB0aGlzLl9sYXllciA9IGxcbiAgfVxuXG4gIGdldEl0ZW1JbmZvICgpOiBJSXRlbSB7XG4gICAgaWYgKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0SXRlbUluZm8oKVxuICAgIH1cbiAgICByZXR1cm4gc3VwZXIuZ2V0SXRlbUluZm8oKVxuICB9XG5cbiAgYXN5bmMgZmV0Y2hTY2hlbWEgKCk6IFByb21pc2U8SU1EYXRhU291cmNlU2NoZW1hPiB7XG4gICAgY29uc3QgbGFiZWwgPSBhd2FpdCBkYXRhU291cmNlVXRpbHMuZ2V0T3JpZ2luRGF0YUxhYmVsKHRoaXMpXG4gICAgY29uc3Qgc2NlbmVMYXllclNjaGVtYSA9IEltbXV0YWJsZSh7IGxhYmVsIH0pXG4gICAgY29uc3QgYXNzb2NpYXRlZExheWVyU2NoZW1hID0gYXdhaXQgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSA/IHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKS5mZXRjaFNjaGVtYSgpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpKVxuICAgIHJldHVybiBhc3NvY2lhdGVkTGF5ZXJTY2hlbWEgPyBhc3NvY2lhdGVkTGF5ZXJTY2hlbWEubWVyZ2Uoc2NlbmVMYXllclNjaGVtYSkgOiBzY2VuZUxheWVyU2NoZW1hXG4gIH1cblxuICBzZXREYXRhU291cmNlSnNvbiAoZHNKc29uOiBJTURhdGFTb3VyY2VKc29uKSB7XG4gICAgc3VwZXIuc2V0RGF0YVNvdXJjZUpzb24oZHNKc29uKVxuICAgIGlmICh0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkpIHtcbiAgICAgIGNvbnN0IGFEc0pzb24gPSB0aGlzLl9tZXJnZUFzc29jaWF0ZWREYXRhU291cmNlSnNvbih0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkuZ2V0RGF0YVNvdXJjZUpzb24oKSlcbiAgICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKS5zZXREYXRhU291cmNlSnNvbihhRHNKc29uKVxuICAgIH1cbiAgfVxuXG4gIGdldEZldGNoZWRTY2hlbWEgKCk6IElNRGF0YVNvdXJjZVNjaGVtYSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0RmV0Y2hlZFNjaGVtYSgpXG4gIH1cblxuICBzZXRGZXRjaGVkU2NoZW1hIChmZXRjaGVkU2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEpIHtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LnNldEZldGNoZWRTY2hlbWEoZmV0Y2hlZFNjaGVtYSlcbiAgfVxuXG4gIGdldFJldmVyc2VkQ29uZmlnU2NoZW1hICgpOiBJTVJldmVyc2VkRGF0YVNvdXJjZVNjaGVtYSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0UmV2ZXJzZWRDb25maWdTY2hlbWEoKVxuICB9XG5cbiAgZ2V0U2VsZWN0ZWRGaWVsZHMgKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRTZWxlY3RlZEZpZWxkcygpXG4gIH1cblxuICBzZXRTZWxlY3RlZEZpZWxkcyAoamltdU5hbWVzOiBzdHJpbmdbXSkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2V0U2VsZWN0ZWRGaWVsZHMoamltdU5hbWVzKVxuICB9XG5cbiAgZ2V0SWRGaWVsZCAoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRJZEZpZWxkKClcbiAgfVxuXG4gIGFzeW5jIHF1ZXJ5QnlJZCAoaWQ6IHN0cmluZyk6IFByb21pc2U8RmVhdHVyZURhdGFSZWNvcmQ+IHtcbiAgICByZXR1cm4gYXdhaXQgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ucXVlcnlCeUlkKGlkKSA/PyBQcm9taXNlLnJlamVjdChFcnJvcignTm8gQXNzb2NpYXRlZCBEYXRhU291cmNlLicpKSlcbiAgfVxuXG4gIGFzeW5jIGFkZFJlY29yZCAocmVjb3JkOiBGZWF0dXJlRGF0YVJlY29yZCk6IFByb21pc2U8RmVhdHVyZURhdGFSZWNvcmQ+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5hZGRSZWNvcmQocmVjb3JkKSBhcyBGZWF0dXJlRGF0YVJlY29yZFxuICB9XG5cbiAgYXN5bmMgdXBkYXRlUmVjb3JkIChyZWNvcmQ6IEZlYXR1cmVEYXRhUmVjb3JkKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8udXBkYXRlUmVjb3JkKHJlY29yZClcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVJlY29yZHMgKHJlY29yZHM6IEZlYXR1cmVEYXRhUmVjb3JkW10pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy51cGRhdGVSZWNvcmRzKHJlY29yZHMpXG4gIH1cblxuICBhc3luYyBkZWxldGVSZWNvcmQgKGluZGV4OiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5kZWxldGVSZWNvcmQoaW5kZXgpXG4gIH1cblxuICBhc3luYyBkZWxldGVSZWNvcmRCeUlkIChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZGVsZXRlUmVjb3JkQnlJZChpZClcbiAgfVxuXG4gIGRvUXVlcnkgKHJlYWxRdWVyeTogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgb3JpZ2luUXVlcnk6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgaWYgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKS5kb1F1ZXJ5KHJlYWxRdWVyeSwgb3JpZ2luUXVlcnkpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmVzLnJlY29yZHMgPSByZXMucmVjb3Jkcy5tYXAociA9PiB0aGlzLmZpeFJlY29yZERhdGFTb3VyY2UocikpXG4gICAgICAgIHJldHVybiByZXNcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChFcnJvcignTm8gQXNzb2NpYXRlZCBEYXRhU291cmNlLicpKVxuICAgIH1cbiAgfVxuXG4gIGRvUXVlcnlCeUlkIChpZDogc3RyaW5nKTogUHJvbWlzZTxEYXRhUmVjb3JkPiB7XG4gICAgaWYgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKS5kb1F1ZXJ5QnlJZChpZCkudGhlbihyZWNvcmQgPT4gdGhpcy5maXhSZWNvcmREYXRhU291cmNlKHJlY29yZCkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChFcnJvcignTm8gQXNzb2NpYXRlZCBEYXRhU291cmNlLicpKVxuICAgIH1cbiAgfVxuXG4gIGRvUXVlcnlJZHMgKHF1ZXJ5UGFyYW1zOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD4ge1xuICAgIGlmICh0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCkuZG9RdWVyeUlkcyhxdWVyeVBhcmFtcykudGhlbihyZXMgPT4ge1xuICAgICAgICByZXMucmVjb3JkcyA9IHJlcy5yZWNvcmRzLm1hcChyID0+IHRoaXMuZml4UmVjb3JkRGF0YVNvdXJjZShyKSlcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KEVycm9yKCdObyBBc3NvY2lhdGVkIERhdGFTb3VyY2UuJykpXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZG9RdWVyeUNvdW50IChxdWVyeVByb3BlcnRpZXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgcmV0dXJuIGF3YWl0ICh0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmRvUXVlcnlDb3VudChxdWVyeVByb3BlcnRpZXMpID8/IFByb21pc2UucmVqZWN0KEVycm9yKCdObyBBc3NvY2lhdGVkIERhdGFTb3VyY2UuJykpKVxuICB9XG5cbiAgZ2V0Q29uZmlnUXVlcnlQYXJhbXMgKCk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRDb25maWdRdWVyeVBhcmFtcygpXG4gIH1cblxuICBnZXRSZW1vdGVRdWVyeVBhcmFtcyAoKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFJlbW90ZVF1ZXJ5UGFyYW1zKClcbiAgfVxuXG4gIGdldEN1cnJlbnRRdWVyeVBhcmFtcyAob3B0aW9ucz86IEdldEN1cnJlbnRRdWVyeVBhcmFtc09wdGlvbnMpOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyB7XG4gICAgb3B0aW9ucz8uZXhjbHVkZSAmJiB0aGlzLmZpeEV4Y2x1ZGVRdWVyeShvcHRpb25zLmV4Y2x1ZGUpXG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0Q3VycmVudFF1ZXJ5UGFyYW1zKG9wdGlvbnMpXG4gIH1cblxuICBnZXRSdW50aW1lUXVlcnlQYXJhbXNnZXRSdW50aW1lUXVlcnlQYXJhbXMgKGV4Y2x1ZGVXaWRnZXRJZD86IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFJ1bnRpbWVRdWVyeVBhcmFtcyhleGNsdWRlV2lkZ2V0SWQpXG4gIH1cblxuICBnZXRDdXJyZW50UXVlcnlJZCAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0Q3VycmVudFF1ZXJ5SWQoKVxuICB9XG5cbiAgbWVyZ2VRdWVyeVBhcmFtcyAoLi4ucXVlcmllczogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXNbXSk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5tZXJnZVF1ZXJ5UGFyYW1zKC4uLnF1ZXJpZXMpXG4gIH1cblxuICBidWlsZFJlY29yZCAoZmVhdHVyZTogSUZlYXR1cmUgfCBfX2VzcmkuR3JhcGhpYyk6IEZlYXR1cmVEYXRhUmVjb3JkIHtcbiAgICByZXR1cm4gbmV3IEZlYXR1cmVEYXRhUmVjb3JkSW1wbChmZWF0dXJlLCB0aGlzIGFzIFNjZW5lTGF5ZXJEYXRhU291cmNlKVxuICB9XG5cbiAgZ2V0RmllbGRDb2RlZFZhbHVlTGlzdCAoamltdUZpZWxkTmFtZTogc3RyaW5nLCByZWNvcmQ/OiBGZWF0dXJlRGF0YVJlY29yZCk6IENvZGVkVmFsdWVbXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0RmllbGRDb2RlZFZhbHVlTGlzdChqaW11RmllbGROYW1lLCByZWNvcmQpXG4gIH1cblxuICBnZXRSZWFsUXVlcnlQYXJhbXMgKHF1ZXJ5LCBmbGFnOiAncXVlcnknIHwgJ2xvYWQnLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMge1xuICAgIG9wdGlvbnMgJiYgdGhpcy5maXhRdWVyeU9wdGlvbnMob3B0aW9ucylcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRSZWFsUXVlcnlQYXJhbXMocXVlcnksIGZsYWcsIG9wdGlvbnMpXG4gIH1cblxuICBnZXRBbGxVc2VkRmllbGRzIChvcHRpb25zPzogRmVhdHVyZUxheWVyVXNlZEZpZWxkc09wdGlvbnMpOiBzdHJpbmdbXSB8ICcqJyB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0QWxsVXNlZEZpZWxkcyhvcHRpb25zKVxuICB9XG5cbiAgYXBwbHlVc2VkRmllbGRzIChxdWVyeTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMsIHVzZWRGaWVsZHM/OiBzdHJpbmdbXSB8ICcqJyk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5hcHBseVVzZWRGaWVsZHMocXVlcnksIHVzZWRGaWVsZHMpXG4gIH1cblxuICB1cGRhdGVRdWVyeVBhcmFtcyAocXVlcnk6IFF1ZXJ5UGFyYW1zLCB3aWRnZXRJZDogc3RyaW5nKSB7XG4gICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy51cGRhdGVRdWVyeVBhcmFtcyhxdWVyeSwgd2lkZ2V0SWQpXG4gIH1cblxuICBnZXRHREJWZXJzaW9uICgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldEdEQlZlcnNpb24oKVxuICB9XG5cbiAgZ2V0UXVlcnlQYWdlU2l6ZSAoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRRdWVyeVBhZ2VTaXplKClcbiAgfVxuXG4gIGdldE1heFJlY29yZENvdW50ICgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldE1heFJlY29yZENvdW50KClcbiAgfVxuXG4gIGdldFJlY29yZHNCeVBhZ2UgKHBhZ2U6IG51bWJlciwgcGFnZVNpemU6IG51bWJlcik6IERhdGFSZWNvcmRbXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0UmVjb3Jkc0J5UGFnZShwYWdlLCBwYWdlU2l6ZSlcbiAgfVxuXG4gIGdldFBhZ2VzRGF0YSAoKTogeyBbcGFnZTogbnVtYmVyXTogRGF0YVJlY29yZFtdIH0ge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFBhZ2VzRGF0YSgpXG4gIH1cblxuICBzZXRQYWdlc0RhdGEgKHBhZ2VzOiB7IFtwYWdlOiBudW1iZXJdOiBEYXRhUmVjb3JkW10gfSkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2V0UGFnZXNEYXRhKHBhZ2VzKVxuICB9XG5cbiAgZ2V0UmVhbFF1ZXJ5UGFnZXMgKHBhZ2U6IG51bWJlciwgcGFnZVNpemU6IG51bWJlcik6IG51bWJlcltdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRSZWFsUXVlcnlQYWdlcyhwYWdlLCBwYWdlU2l6ZSlcbiAgfVxuXG4gIGFzeW5jIGxvYWQgKHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9uczogUXVlcnlPcHRpb25zID0ge30pOiBQcm9taXNlPERhdGFSZWNvcmRbXT4ge1xuICAgIG9wdGlvbnMgJiYgdGhpcy5maXhRdWVyeU9wdGlvbnMob3B0aW9ucylcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5sb2FkKHF1ZXJ5LCBvcHRpb25zKSA/PyBQcm9taXNlLnJlamVjdChFcnJvcignTm8gQXNzb2NpYXRlZCBEYXRhU291cmNlLicpKVxuICB9XG5cbiAgYXN5bmMgbG9hZENvdW50IChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM6IFF1ZXJ5T3B0aW9ucyA9IHt9KTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBvcHRpb25zICYmIHRoaXMuZml4UXVlcnlPcHRpb25zKG9wdGlvbnMpXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ubG9hZENvdW50KHF1ZXJ5LCBvcHRpb25zKSA/PyBQcm9taXNlLnJlamVjdChFcnJvcignTm8gQXNzb2NpYXRlZCBEYXRhU291cmNlLicpKVxuICB9XG5cbiAgYXN5bmMgcXVlcnkgKHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+IHtcbiAgICBvcHRpb25zICYmIHRoaXMuZml4UXVlcnlPcHRpb25zKG9wdGlvbnMpXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ucXVlcnkocXVlcnksIG9wdGlvbnMpID8/IFByb21pc2UucmVqZWN0KEVycm9yKCdObyBBc3NvY2lhdGVkIERhdGFTb3VyY2UuJykpXG4gIH1cblxuICBhc3luYyBxdWVyeUNvdW50IChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgb3B0aW9ucyAmJiB0aGlzLmZpeFF1ZXJ5T3B0aW9ucyhvcHRpb25zKVxuICAgIHJldHVybiBhd2FpdCB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LnF1ZXJ5Q291bnQocXVlcnksIG9wdGlvbnMpID8/IFByb21pc2UucmVqZWN0KEVycm9yKCdObyBBc3NvY2lhdGVkIERhdGFTb3VyY2UuJykpXG4gIH1cblxuICBhc3luYyBsb2FkQnlJZCAoaWQ6IHN0cmluZywgcmVmcmVzaD86IGJvb2xlYW4pOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5sb2FkQnlJZChpZCwgcmVmcmVzaCkgPz8gUHJvbWlzZS5yZWplY3QoRXJyb3IoJ05vIEFzc29jaWF0ZWQgRGF0YVNvdXJjZS4nKSlcbiAgfVxuXG4gIGNoYW5nZUdEQlZlcnNpb24gKGdkYlZlcnNpb246IHN0cmluZykge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uY2hhbmdlR0RCVmVyc2lvbihnZGJWZXJzaW9uKVxuICB9XG5cbiAgZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UgKCk6IEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsIHtcbiAgICBpZiAoIXRoaXMuaXNEYXRhVmlldyAmJiAhdGhpcy5pc0xvY2FsKSB7XG4gICAgICByZXR1cm4gdGhpcy5hc3NvY2lhdGVkRGF0YVNvdXJjZVxuICAgIH1cblxuICAgIGNvbnN0IHJlYWxBc3NvRHNJZCA9IHRoaXMuX2dldFJlYWxBc3NvY2lhdGVkRGF0YVNvdXJjZUlkKClcbiAgICByZXR1cm4gRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXREYXRhU291cmNlKHJlYWxBc3NvRHNJZCkgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGxcbiAgfVxuXG4gIHByaXZhdGUgZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2VCeUlkIChkc0lkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gKHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVNvdXJjZShkc0lkKSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZSkuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKVxuICB9XG5cbiAgcHJpdmF0ZSBmaXhRdWVyeU9wdGlvbnMgKG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmIChvcHRpb25zLmV4Y2x1ZGVRdWVyeSkge1xuICAgICAgdGhpcy5maXhFeGNsdWRlUXVlcnkob3B0aW9ucy5leGNsdWRlUXVlcnkpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmaXhFeGNsdWRlUXVlcnkgKGV4Y2x1ZGVRdWVyeTogV2lkZ2V0RGF0YVNvdXJjZVBhaXIpIHtcbiAgICBpZiAoZXhjbHVkZVF1ZXJ5Py5kYXRhU291cmNlSWQgJiYgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZUJ5SWQoZXhjbHVkZVF1ZXJ5LmRhdGFTb3VyY2VJZCkpIHtcbiAgICAgIGV4Y2x1ZGVRdWVyeS5kYXRhU291cmNlSWQgPSB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlQnlJZChleGNsdWRlUXVlcnkuZGF0YVNvdXJjZUlkKS5pZFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2dldFJlYWxBc3NvY2lhdGVkRGF0YVNvdXJjZUlkICgpOiBzdHJpbmcge1xuICAgIGxldCByZWFsQXNzb0RzSWRcbiAgICBjb25zdCBiZWxvbmdUb0Fzc29EcyA9ICh0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZUltcGwpPy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpXG4gICAgaWYgKHRoaXMuaXNMb2NhbCkge1xuICAgICAgcmVhbEFzc29Ec0lkID0gRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRMb2NhbERhdGFTb3VyY2VJZChiZWxvbmdUb0Fzc29Ecz8uaWQsIHRoaXMubG9jYWxJZClcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNEYXRhVmlldykge1xuICAgICAgcmVhbEFzc29Ec0lkID0gRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXREYXRhVmlld0RhdGFTb3VyY2VJZChiZWxvbmdUb0Fzc29Ecz8uaWQsIHRoaXMuZGF0YVZpZXdJZClcbiAgICB9IGVsc2Uge1xuICAgICAgcmVhbEFzc29Ec0lkID0gdGhpcy5hc3NvY2lhdGVkRGF0YVNvdXJjZS5pZFxuICAgIH1cbiAgICByZXR1cm4gcmVhbEFzc29Ec0lkXG4gIH1cblxuICBjbGVhclJlY29yZHMgKCkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uY2xlYXJSZWNvcmRzKClcbiAgfVxuXG4gIHNldFJlY29yZHMgKHJlY29yZHM6IERhdGFSZWNvcmRbXSkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2V0UmVjb3JkcyhyZWNvcmRzKVxuICB9XG5cbiAgZ2V0UmVjb3JkcyAoKTogRGF0YVJlY29yZFtdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRSZWNvcmRzKCk/Lm1hcChyID0+IHRoaXMuZml4UmVjb3JkRGF0YVNvdXJjZShyKSlcbiAgfVxuXG4gIHNldFNvdXJjZVJlY29yZHMgKHJlY29yZHM6IERhdGFSZWNvcmRbXSkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2V0U291cmNlUmVjb3JkcyhyZWNvcmRzKVxuICB9XG5cbiAgZ2V0U291cmNlUmVjb3JkcyAoKTogRGF0YVJlY29yZFtdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRTb3VyY2VSZWNvcmRzKCk/Lm1hcChyID0+IHRoaXMuZml4UmVjb3JkRGF0YVNvdXJjZShyKSlcbiAgfVxuXG4gIHByaXZhdGUgZml4UmVjb3JkRGF0YVNvdXJjZSAocjogRGF0YVJlY29yZCk6IERhdGFSZWNvcmQge1xuICAgIGlmICghcikge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2NlbmUgbGF5ZXIgZGF0YSBzb3VyY2UgdXNlcyBhc3NvY2lhdGVkIGZlYXR1cmUgbGF5ZXIgZGF0YSBzb3VyY2UgdG8gZG8gcXVlcnkuXG4gICAgICogSWYgdGhlIGZlYXR1cmUgcmVjb3JkIGJlbG9uZ3MgdG8gYW4gYXNzb2NpYXRlZCBmZWF0dXJlIGxheWVyIGRhdGEgc291cmNlLCBhY3R1YWxseSwgaXQgc2hvdWxkIGJlbG9uZyB0byB0aGUgc2NlbmUgbGF5ZXIgZGF0YSBzb3VyY2UuXG4gICAgICovXG4gICAgY29uc3QgcmVjb3JkID0gci5jbG9uZSgpXG4gICAgcmVjb3JkLmRhdGFTb3VyY2UgPSB0aGlzXG4gICAgcmV0dXJuIHJlY29yZFxuICB9XG5cbiAgZ2V0U2VsZWN0ZWRSZWNvcmRzICgpOiBEYXRhUmVjb3JkW10ge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFNlbGVjdGVkUmVjb3JkcygpXG4gIH1cblxuICBuZXh0UmVjb3JkICgpOiBEYXRhUmVjb3JkIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5uZXh0UmVjb3JkKClcbiAgfVxuXG4gIHByZXZSZWNvcmQgKCk6IERhdGFSZWNvcmQge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LnByZXZSZWNvcmQoKVxuICB9XG5cbiAgZ2V0UmVjb3JkIChpbmRleDogbnVtYmVyKTogRGF0YVJlY29yZCB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0UmVjb3JkKGluZGV4KVxuICB9XG5cbiAgZ2V0UmVjb3JkQnlJZCAoaWQ6IHN0cmluZyk6IERhdGFSZWNvcmQge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFJlY29yZEJ5SWQoaWQpXG4gIH1cblxuICBjbGVhclJlY29yZHNOb3RBZGRWZXJzaW9uICgpIHtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmNsZWFyUmVjb3Jkc05vdEFkZFZlcnNpb24oKVxuICB9XG5cbiAgY2xlYXJTZWxlY3Rpb24gKCkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uY2xlYXJTZWxlY3Rpb24oKVxuICB9XG5cbiAgYWRkVmVyc2lvbiAoKSB7XG4gICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5hZGRWZXJzaW9uKClcbiAgfVxuXG4gIHNlbGVjdFJlY29yZCAoaW5kZXg6IG51bWJlcikge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2VsZWN0UmVjb3JkKGluZGV4KVxuICB9XG5cbiAgc2VsZWN0UmVjb3JkcyAob3B0aW9uczogRmVhdHVyZUxheWVyU2VsZWN0T3B0aW9ucywgc2lnbmFsPzogQWJvcnRTaWduYWwsIHByb2dyZXNzQ2FsbGJhY2s/OiBRdWVyeVByb2dyZXNzQ2FsbGJhY2spOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2VsZWN0UmVjb3JkcyhvcHRpb25zKVxuICB9XG5cbiAgc2VsZWN0UmVjb3JkQnlJZCAoaWQ6IHN0cmluZywgcmVjb3JkPzogRGF0YVJlY29yZCkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2VsZWN0UmVjb3JkQnlJZChpZCwgcmVjb3JkKVxuICB9XG5cbiAgc2VsZWN0UmVjb3Jkc0J5SWRzIChpZHM6IHN0cmluZ1tdLCByZWNvcmRzPzogRGF0YVJlY29yZFtdKSB7XG4gICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5zZWxlY3RSZWNvcmRzQnlJZHMoaWRzLCByZWNvcmRzKVxuICB9XG5cbiAgZGVzdHJveSAoKSB7XG4gICAgY29uc3QgYXNzb2NpYXRlZERhdGFTb3VyY2UgPSB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKClcbiAgICBpZiAoYXNzb2NpYXRlZERhdGFTb3VyY2UpIHtcbiAgICAgIHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZGVzdHJveURhdGFTb3VyY2UoYXNzb2NpYXRlZERhdGFTb3VyY2UuaWQpXG4gICAgfVxuICB9XG5cbiAgc3VwcG9ydFN5bWJvbCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5zdXBwb3J0U3ltYm9sKHRoaXMpXG4gIH1cblxuICBzdXBwb3J0QXR0YWNobWVudCAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5zdXBwb3J0QXR0YWNobWVudCh0aGlzKVxuICB9XG5cbiAgYXN5bmMgY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSAoKTogUHJvbWlzZTxfX2VzcmkuU2NlbmVMYXllcj4ge1xuICAgIHJldHVybiBhd2FpdCAoZGF0YVNvdXJjZVV0aWxzLmNyZWF0ZUpTQVBJTGF5ZXJCeURhdGFTb3VyY2UodGhpcykgYXMgUHJvbWlzZTxfX2VzcmkuU2NlbmVMYXllcj4pXG4gIH1cblxuICBnZXREYXRhVmlld3MgKCk6IFNjZW5lTGF5ZXJEYXRhU291cmNlW10ge1xuICAgIHJldHVybiBzdXBlci5nZXREYXRhVmlld3MoKSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZVtdXG4gIH1cblxuICBnZXREYXRhVmlldyAoZGF0YVZpZXdJZDogc3RyaW5nKTogU2NlbmVMYXllckRhdGFTb3VyY2Uge1xuICAgIHJldHVybiBzdXBlci5nZXREYXRhVmlldyhkYXRhVmlld0lkKSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZVxuICB9XG5cbiAgZ2V0TWFpbkRhdGFTb3VyY2UgKCk6IFNjZW5lTGF5ZXJEYXRhU291cmNlIHtcbiAgICByZXR1cm4gc3VwZXIuZ2V0TWFpbkRhdGFTb3VyY2UoKSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZVxuICB9XG5cbiAgcHJvdGVjdGVkIF9tZXJnZUFzc29jaWF0ZWREYXRhU291cmNlSnNvbiAoYXNzb2NpYXRlZERhdGFTb3VyY2VKc29uOiBJTURhdGFTb3VyY2VKc29uKTogSU1EYXRhU291cmNlSnNvbiB7XG4gICAgcmV0dXJuIGFzc29jaWF0ZWREYXRhU291cmNlSnNvbj8uc2V0KCdxdWVyeScsIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5xdWVyeSlcbiAgICAgIC5zZXQoJ2RhdGFWaWV3cycsIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5kYXRhVmlld3MpXG4gICAgICAuc2V0KCdzY2hlbWEnLCB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuc2NoZW1hKVxuICB9XG5cbiAgZ2V0IGNvdW50ICgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5jb3VudFxuICB9XG5cbiAgc2V0IGNvdW50IChjb3VudDogbnVtYmVyKSB7XG4gICAgaWYgKHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKSkge1xuICAgICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpLmNvdW50ID0gY291bnRcbiAgICB9XG4gIH1cblxuICBhc3luYyBhbGxvd1RvRXhwb3J0RGF0YSAoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgYWxsb3dJbkRhdGFTb3VyY2UgPSAhdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmRpc2FibGVFeHBvcnRcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGFsbG93SW5EYXRhU291cmNlKVxuICB9XG59XG4iLCJpbXBvcnQgeyBsb2FkQXJjR0lTSlNBUElNb2R1bGUsIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSwgdHlwZSBMYXllckZvbGRlckNoaWxkRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcbmltcG9ydCB7IERhdGFTb3VyY2VUeXBlcywgdHlwZSBTY2VuZVNlcnZpY2VEYXRhU291cmNlLCB0eXBlIFNjZW5lTGF5ZXJEYXRhU291cmNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcblxuLyoqXG4gKiBEYXRhIHNvdXJjZSBmcm9tIGEgc2NlbmUgc2VydmljZSwgd2hpY2ggbWF5IGNvbnRhaW4gbXVsdGlwbGUgY2hpbGQgZGF0YSBzb3VyY2VzLlxuICovXG5leHBvcnQgY2xhc3MgU2NlbmVTZXJ2aWNlRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSBpbXBsZW1lbnRzIFNjZW5lU2VydmljZURhdGFTb3VyY2Uge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuU2NlbmVTZXJ2aWNlID0gRGF0YVNvdXJjZVR5cGVzLlNjZW5lU2VydmljZVxuXG4gIGdldENoaWxkSWRzICgpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q2hpbGRJZHNCeVVybCgpXG4gIH1cblxuICBjcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlJZCAoY2hpbGREc0lkOiBzdHJpbmcsIGppbXVDaGlsZElkOiBzdHJpbmcsIGNoaWxkSWQ6IHN0cmluZyk6IExheWVyRm9sZGVyQ2hpbGREYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVDaGlsZERhdGFTb3VyY2VPcHRpb25zQnlJZEZyb21VcmwoY2hpbGREc0lkLCBqaW11Q2hpbGRJZCwgY2hpbGRJZClcbiAgfVxuXG4gIC8qKlxuICAgKiBJZiB1c2UgTGF5ZXIuZnJvbUFyY0dJU1NlcnZlclVybC9MYXllci5mcm9tUG9ydGFsSXRlbSB0byBjcmVhdGUgSlMgQVBJIGxheWVyIGZvciBmZWF0dXJlIHNlcnZpY2UsIHdpbGwgcmV0dXJuIGEgZmVhdHVyZSBsYXllciBpZiB0aGUgZmVhdHVyZSBzZXJ2aWNlIG9ubHkgY29udGFpbnMgb25lIGxheWVyL3RhYmxlLlxuICAgKiBJdCBjYXVzZXMgdGhlIGZlYXR1cmUgc2VydmljZSBkYXRhIHNvdXJjZSByZXR1cm5zIGEgZmVhdHVyZSBsYXllciBhcyBpdHMgSlMgQVBJIGxheWVyLCB3aGljaCBpcyBub3QgZXhwZWN0ZWQuXG4gICAqIFNvIHdlIG92ZXJpZGUgdGhlIG1ldGhvZCB0byBtYWtlIHN1cmUgZmVhdHVyZSBzZXJ2aWNlIGRhdGEgc291cmNlIGFsd2F5cyByZXR1cm5zIGEgZ3JvdXAgbGF5ZXIuXG4gICovXG4gIGFzeW5jIGNyZWF0ZUpTQVBJTGF5ZXJCeURhdGFTb3VyY2UgKCk6IFByb21pc2U8X19lc3JpLkdyb3VwTGF5ZXI+IHtcbiAgICBsZXQgbGF5ZXI6IF9fZXNyaS5Hcm91cExheWVyXG4gICAgdHJ5IHtcbiAgICAgIGlmICghdGhpcy5hcmVDaGlsZERhdGFTb3VyY2VzQ3JlYXRlZCgpKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY2hpbGREYXRhU291cmNlc1JlYWR5KClcbiAgICAgIH1cbiAgICAgIGNvbnN0IGhhc1NpbmdsZUxheWVyID0gdGhpcy5nZXRJdGVtSW5mbygpPy50eXBlS2V5d29yZHM/LmluY2x1ZGVzKCdTaW5nbGVsYXllcicpIHx8IHRoaXMuZ2V0U2VydmljZURlZmluaXRpb24oKT8ubGF5ZXJzPy5sZW5ndGggPT09IDFcbiAgICAgIGlmIChoYXNTaW5nbGVMYXllcikgeyAvLyB0aGUgb3JpZ2luYWwgaXRlbS9zZXJ2aWNlIG9ubHkgY29udGFpbnMgb25lIGxheWVyXG4gICAgICAgIGNvbnN0IGNoaWxkRHNzID0gdGhpcy5nZXRDaGlsZERhdGFTb3VyY2VzKCkgYXMgU2NlbmVMYXllckRhdGFTb3VyY2VbXVxuICAgICAgICBpZiAoY2hpbGREc3MubGVuZ3RoID09PSAwKSB7IC8vIGZhaWxlZCB0byBjcmVhdGUgY2hpbGQgZGF0YSBzb3VyY2VzIGZvciBzb21lIHJlYXNvblxuICAgICAgICAgIGNvbnN0IFtMYXllciwgR3JvdXBMYXllcl0gPSBhd2FpdCBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFsnZXNyaS9sYXllcnMvTGF5ZXInLCAnZXNyaS9sYXllcnMvR3JvdXBMYXllciddKSBhcyBbdHlwZW9mIF9fZXNyaS5MYXllciwgdHlwZW9mIF9fZXNyaS5Hcm91cExheWVyXVxuICAgICAgICAgIGNvbnN0IGNoaWxkTGF5ZXIgPSBhd2FpdCBMYXllci5mcm9tQXJjR0lTU2VydmVyVXJsKHsgdXJsOiBgJHt0aGlzLnVybH0vbGF5ZXJzLyR7dGhpcy5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpPy5sYXllcnM/LlswXT8uaWQgfHwgMH1gIH0pIGFzIF9fZXNyaS5TY2VuZUxheWVyXG4gICAgICAgICAgbGF5ZXIgPSBuZXcgR3JvdXBMYXllcih7XG4gICAgICAgICAgICBsYXllcnM6IFtjaGlsZExheWVyXSxcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLmdldExhYmVsKClcbiAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgeyAvLyBvbmx5IGhhcyBvbmUgY2hpbGQgZGF0YSBzb3VyY2VcbiAgICAgICAgICBjb25zdCBsb2FkSlNBUElHcm91cExheWVyUHJvbWlzZSA9IGxvYWRBcmNHSVNKU0FQSU1vZHVsZSgnZXNyaS9sYXllcnMvR3JvdXBMYXllcicpIGFzIFByb21pc2U8dHlwZW9mIF9fZXNyaS5Hcm91cExheWVyPlxuICAgICAgICAgIGNvbnN0IGNyZWF0ZUpTQVBJTGF5ZXJGb3JDaGlsZERzUHJvbWlzZSA9IGNoaWxkRHNzWzBdLmxheWVyID8gUHJvbWlzZS5yZXNvbHZlKGNoaWxkRHNzWzBdLmxheWVyKSA6IGNoaWxkRHNzWzBdLmNyZWF0ZUpTQVBJTGF5ZXJCeURhdGFTb3VyY2UoKVxuICAgICAgICAgIGNvbnN0IFtHcm91cExheWVyLCBjaGlsZExheWVyXSA9IGF3YWl0IFByb21pc2UuYWxsKFtsb2FkSlNBUElHcm91cExheWVyUHJvbWlzZSwgY3JlYXRlSlNBUElMYXllckZvckNoaWxkRHNQcm9taXNlXSlcbiAgICAgICAgICBsYXllciA9IG5ldyBHcm91cExheWVyKHtcbiAgICAgICAgICAgIGxheWVyczogW2NoaWxkTGF5ZXJdLFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMuZ2V0TGFiZWwoKVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7IC8vIHRoZSBvcmlnaW5hbCBpdGVtL3NlcnZpY2UgY29udGFpbnMgbXVsdGlwbGUgbGF5ZXJzXG4gICAgICAgIGxheWVyID0gYXdhaXQgc3VwZXIuY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpIGFzIF9fZXNyaS5Hcm91cExheWVyXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIEpTIEFQSSBsYXllci4gJywgZXJyLCB0aGlzLmlkKVxuICAgIH1cbiAgICByZXR1cm4gbGF5ZXI/LnR5cGUgPT09ICdncm91cCcgPyBsYXllciA6IG51bGxcbiAgfVxufVxuIiwiaW1wb3J0IHsgdXVpZHYxIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgQWJzdHJhY3REYXRhU291cmNlIH0gZnJvbSAnLi4vYmFzZS1jbGFzc2VzJ1xuaW1wb3J0IHsgdHlwZSBEYXRhUmVjb3JkLCB0eXBlIFNpbXBsZUxvY2FsRGF0YVNvdXJjZSwgRGF0YVNvdXJjZVR5cGVzIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcblxuLyoqXG4gKiBAaWdub3JlXG4gKi9cbmV4cG9ydCBjbGFzcyBTaW1wbGVMb2NhbERhdGFTb3VyY2VJbXBsIGV4dGVuZHMgQWJzdHJhY3REYXRhU291cmNlIGltcGxlbWVudHMgU2ltcGxlTG9jYWxEYXRhU291cmNlIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLlNpbXBsZUxvY2FsID0gRGF0YVNvdXJjZVR5cGVzLlNpbXBsZUxvY2FsXG5cbiAgdXBkYXRlUmVjb3JlZHMgKHJlY29yZHM6IERhdGFSZWNvcmRbXSkge1xuICAgIHRoaXMucmVjb3JkcyA9IHJlY29yZHNcbiAgICB0aGlzLmFkZFZlcnNpb24oKVxuICB9XG5cbiAgYXN5bmMgYWRkUmVjb3JkIChyZWNvcmQ6IERhdGFSZWNvcmQpOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICBpZiAoIXJlY29yZC5nZXRJZCgpKSB7XG4gICAgICByZWNvcmQuc2V0SWQodXVpZHYxKCkpXG4gICAgfVxuICAgIHRoaXMucmVjb3Jkcy5wdXNoKHJlY29yZClcbiAgICB0aGlzLmFkZFZlcnNpb24oKVxuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVjb3JkKVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlUmVjb3JkIChyZWNvcmQ6IERhdGFSZWNvcmQpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCBpID0gdGhpcy5yZWNvcmRzLmZpbmRJbmRleChyID0+IHIuZ2V0SWQoKSA9PT0gcmVjb3JkLmdldElkKCkpXG4gICAgdGhpcy5yZWNvcmRzLnNwbGljZShpLCAxLCByZWNvcmQpXG4gICAgdGhpcy5hZGRWZXJzaW9uKClcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpXG4gIH1cblxuICBhc3luYyBkZWxldGVSZWNvcmQgKGluZGV4OiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0aGlzLnJlY29yZHMuc3BsaWNlKGluZGV4LCAxKVxuICAgIHRoaXMuYWRkVmVyc2lvbigpXG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZSh0cnVlKVxuICB9XG59XG4iLCJpbXBvcnQgeyB0eXBlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VUeXBlcywgdHlwZSBWZWN0b3JUaWxlU2VydmljZURhdGFTb3VyY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzJ1xuaW1wb3J0IHsgSXRlbU1peGluSW1wbCwgSlNBUElMYXllck1peGluSW1wbCwgQWJzdHJhY3REYXRhU291cmNlIH0gZnJvbSAnLi4vYmFzZS1jbGFzc2VzJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFZlY3RvclRpbGVTZXJ2aWNlRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBsYXllcj86IF9fZXNyaS5WZWN0b3JUaWxlTGF5ZXJcbn1cblxuZXhwb3J0IGNsYXNzIFZlY3RvclRpbGVTZXJ2aWNlRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBKU0FQSUxheWVyTWl4aW5JbXBsKEl0ZW1NaXhpbkltcGwoQWJzdHJhY3REYXRhU291cmNlKSkgaW1wbGVtZW50cyBWZWN0b3JUaWxlU2VydmljZURhdGFTb3VyY2Uge1xuICBsYXllcj86IF9fZXNyaS5WZWN0b3JUaWxlTGF5ZXJcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLlZlY3RvclRpbGVTZXJ2aWNlID0gRGF0YVNvdXJjZVR5cGVzLlZlY3RvclRpbGVTZXJ2aWNlXG5cbiAgY29uc3RydWN0b3IgKG9wdGlvbnM6IFZlY3RvclRpbGVTZXJ2aWNlRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpXG4gICAgaWYgKG9wdGlvbnMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIgPSBvcHRpb25zLmxheWVyXG4gICAgfVxuICAgIGNvbnN0IGRzSnNvbiA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKVxuICAgIHRoaXMucG9ydGFsVXJsID0gZHNKc29uLnBvcnRhbFVybFxuICAgIHRoaXMuaXRlbUlkID0gZHNKc29uLml0ZW1JZFxuICB9XG5cbiAgYXN5bmMgcmVhZHkgKCkge1xuICAgIGlmICghdGhpcy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IGF3YWl0IHRoaXMuY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpIGFzIF9fZXNyaS5WZWN0b3JUaWxlTGF5ZXJcbiAgICB9XG4gICAgYXdhaXQgdGhpcy5sYXllci5sb2FkKClcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCBEYXRhU291cmNlVHlwZXMsIHR5cGUgV0ZTRGF0YVNvdXJjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5pbXBvcnQgeyBJdGVtTWl4aW5JbXBsLCBKU0FQSUxheWVyTWl4aW5JbXBsLCBBYnN0cmFjdERhdGFTb3VyY2UgfSBmcm9tICcuLi9iYXNlLWNsYXNzZXMnXG5cbmV4cG9ydCBpbnRlcmZhY2UgV0ZTRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBsYXllcj86IF9fZXNyaS5XRlNMYXllclxufVxuXG5leHBvcnQgY2xhc3MgV0ZTRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBKU0FQSUxheWVyTWl4aW5JbXBsKEl0ZW1NaXhpbkltcGwoQWJzdHJhY3REYXRhU291cmNlKSkgaW1wbGVtZW50cyBXRlNEYXRhU291cmNlIHtcbiAgbGF5ZXI/OiBfX2VzcmkuV0ZTTGF5ZXJcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLldGUyA9IERhdGFTb3VyY2VUeXBlcy5XRlNcblxuICBjb25zdHJ1Y3RvciAob3B0aW9uczogV0ZTRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpXG4gICAgaWYgKG9wdGlvbnMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIgPSBvcHRpb25zLmxheWVyXG4gICAgfVxuICAgIGNvbnN0IGRzSnNvbiA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKVxuICAgIHRoaXMucG9ydGFsVXJsID0gZHNKc29uLnBvcnRhbFVybFxuICAgIHRoaXMuaXRlbUlkID0gZHNKc29uLml0ZW1JZFxuICB9XG5cbiAgYXN5bmMgcmVhZHkgKCkge1xuICAgIGlmICghdGhpcy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IGF3YWl0IHRoaXMuY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZSgpIGFzIF9fZXNyaS5XRlNMYXllclxuICAgIH1cbiAgICBhd2FpdCB0aGlzLmxheWVyLmxvYWQoKVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKVxuICB9XG59XG4iLCJpbXBvcnQgeyB0eXBlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VUeXBlcywgdHlwZSBXTVNEYXRhU291cmNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IEl0ZW1NaXhpbkltcGwsIEpTQVBJTGF5ZXJNaXhpbkltcGwsIEFic3RyYWN0RGF0YVNvdXJjZSB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcblxuZXhwb3J0IGludGVyZmFjZSBXTVNEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIGV4dGVuZHMgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIGxheWVyPzogX19lc3JpLldNU0xheWVyXG59XG5cbmV4cG9ydCBjbGFzcyBXTVNEYXRhU291cmNlSW1wbCBleHRlbmRzIEpTQVBJTGF5ZXJNaXhpbkltcGwoSXRlbU1peGluSW1wbChBYnN0cmFjdERhdGFTb3VyY2UpKSBpbXBsZW1lbnRzIFdNU0RhdGFTb3VyY2Uge1xuICBsYXllcj86IF9fZXNyaS5XTVNMYXllclxuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuV01TID0gRGF0YVNvdXJjZVR5cGVzLldNU1xuXG4gIGNvbnN0cnVjdG9yIChvcHRpb25zOiBXTVNEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucylcbiAgICBpZiAob3B0aW9ucy5sYXllcikge1xuICAgICAgdGhpcy5sYXllciA9IG9wdGlvbnMubGF5ZXJcbiAgICB9XG4gICAgY29uc3QgZHNKc29uID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpXG4gICAgdGhpcy5wb3J0YWxVcmwgPSBkc0pzb24ucG9ydGFsVXJsXG4gICAgdGhpcy5pdGVtSWQgPSBkc0pzb24uaXRlbUlkXG4gIH1cblxuICBhc3luYyByZWFkeSAoKSB7XG4gICAgaWYgKCF0aGlzLmxheWVyKSB7XG4gICAgICB0aGlzLmxheWVyID0gYXdhaXQgdGhpcy5jcmVhdGVKU0FQSUxheWVyQnlEYXRhU291cmNlKCkgYXMgX19lc3JpLldNU0xheWVyXG4gICAgfVxuICAgIGF3YWl0IHRoaXMubGF5ZXIubG9hZCgpXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG4gIH1cbn1cbiIsImltcG9ydCB7IHR5cGUgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucywgRGF0YVNvdXJjZVR5cGVzLCB0eXBlIFdNVFNEYXRhU291cmNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IEl0ZW1NaXhpbkltcGwsIEpTQVBJTGF5ZXJNaXhpbkltcGwsIEFic3RyYWN0RGF0YVNvdXJjZSB9IGZyb20gJy4uL2Jhc2UtY2xhc3NlcydcblxuZXhwb3J0IGludGVyZmFjZSBXTVRTRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBsYXllcj86IF9fZXNyaS5XTVRTTGF5ZXJcbn1cblxuZXhwb3J0IGNsYXNzIFdNVFNEYXRhU291cmNlSW1wbCBleHRlbmRzIEpTQVBJTGF5ZXJNaXhpbkltcGwoSXRlbU1peGluSW1wbChBYnN0cmFjdERhdGFTb3VyY2UpKSBpbXBsZW1lbnRzIFdNVFNEYXRhU291cmNlIHtcbiAgbGF5ZXI/OiBfX2VzcmkuV01UU0xheWVyXG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5XTVRTID0gRGF0YVNvdXJjZVR5cGVzLldNVFNcblxuICBjb25zdHJ1Y3RvciAob3B0aW9uczogV01UU0RhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKVxuICAgIGlmIChvcHRpb25zLmxheWVyKSB7XG4gICAgICB0aGlzLmxheWVyID0gb3B0aW9ucy5sYXllclxuICAgIH1cbiAgICBjb25zdCBkc0pzb24gPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKClcbiAgICB0aGlzLnBvcnRhbFVybCA9IGRzSnNvbi5wb3J0YWxVcmxcbiAgICB0aGlzLml0ZW1JZCA9IGRzSnNvbi5pdGVtSWRcbiAgfVxuXG4gIGFzeW5jIHJlYWR5ICgpIHtcbiAgICBpZiAoIXRoaXMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIgPSBhd2FpdCB0aGlzLmNyZWF0ZUpTQVBJTGF5ZXJCeURhdGFTb3VyY2UoKSBhcyBfX2VzcmkuV01UU0xheWVyXG4gICAgfVxuICAgIGF3YWl0IHRoaXMubGF5ZXIubG9hZCgpXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpXG4gIH1cbn1cbiIsImltcG9ydCB7IHR5cGUgRGF0YVNvdXJjZSwgdHlwZSBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCB0eXBlIERhdGFTb3VyY2VGYWN0b3J5LCBEYXRhU291cmNlVHlwZXMgfSBmcm9tICcuL2ludGVyZmFjZXMnXG5pbXBvcnQgeyBGZWF0dXJlRGF0YVJlY29yZEltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLXJlY29yZC1pbXBsJ1xuaW1wb3J0IHsgQ1NWRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9jc3YtZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB0eXBlIHsgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB9IGZyb20gJy4vaW1wbGVtZW50YXRpb25zL2ZlYXR1cmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB0eXBlIHsgU2NlbmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9zY2VuZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLWxheWVyLWRhdGEtc291cmNlLWltcGwnXG5pbXBvcnQgeyBGZWF0dXJlU2VydmljZURhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1zZXJ2aWNlLWRhdGEtc291cmNlLWltcGwnXG5pbXBvcnQgeyBHcm91cExheWVyRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9ncm91cC1sYXllci1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgTWFwU2VydmljZURhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvbWFwLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IFNpbXBsZUxvY2FsRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9zaW1wbGUtbG9jYWwtZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IFNjZW5lU2VydmljZURhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvc2NlbmUtc2VydmljZS1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgU2NlbmVMYXllckRhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IEltYWdlU2VydmljZURhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvaW1hZ2Utc2VydmljZS1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgVmVjdG9yVGlsZVNlcnZpY2VEYXRhU291cmNlSW1wbCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb25zL3ZlY3Rvci10aWxlLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IEdlb0pTT05EYXRhU291cmNlSW1wbCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb25zL2dlb2pzb24tZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IEtNTERhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMva21sLWRhdGEtc291cmNlLWltcGwnXG5pbXBvcnQgeyBXRlNEYXRhU291cmNlSW1wbCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb25zL3dmcy1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgV01TRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy93bXMtZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IFdNVFNEYXRhU291cmNlSW1wbCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb25zL3dtdHMtZGF0YS1zb3VyY2UtaW1wbCdcbmltcG9ydCB7IEVycm9yRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9lcnJvci1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgQnVpbGRpbmdTY2VuZUxheWVyRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9idWlsZGluZy1zY2VuZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsJ1xuaW1wb3J0IHsgQnVpbGRpbmdDb21wb25lbnRTdWJMYXllckRhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvYnVpbGRpbmctY29tcG9uZW50LXN1YmxheWVyLWRhdGEtc291cmNlLWltcGwnXG5pbXBvcnQgeyBCdWlsZGluZ0dyb3VwU3ViTGF5ZXJEYXRhU291cmNlSW1wbCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb25zL2J1aWxkaW5nLWdyb3VwLXN1YmxheWVyLWRhdGEtc291cmNlLWltcGwnXG5pbXBvcnQgKiBhcyBkYXRhU291cmNlSnNvbkNyZWF0b3IgZnJvbSAnLi9zdXBwb3J0L2RhdGEtc291cmNlLWpzb24tY3JlYXRvcidcblxuZXhwb3J0IGNsYXNzIEppbXVDb3JlRGF0YVNvdXJjZUZhY3RvcnkgaW1wbGVtZW50cyBEYXRhU291cmNlRmFjdG9yeSB7XG4gIGNyZWF0ZURhdGFTb3VyY2UgKG9wdGlvbnM6IERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMpOiBEYXRhU291cmNlIHtcbiAgICBjb25zdCBkc0pzb24gPSBvcHRpb25zLmRhdGFTb3VyY2VKc29uID8/IG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlLmdldE1haW5EYXRhU291cmNlKCkuZ2V0RGF0YVNvdXJjZUpzb24oKVxuICAgIGNvbnN0IGRzVHlwZSA9IChvcHRpb25zLmRhdGFWaWV3SWQgJiYgZHNKc29uLmRhdGFWaWV3cyAmJiBkc0pzb24uZGF0YVZpZXdzW29wdGlvbnMuZGF0YVZpZXdJZF0gPyBkc0pzb24uZGF0YVZpZXdzW29wdGlvbnMuZGF0YVZpZXdJZF0udHlwZSB8fCBkc0pzb24udHlwZSA6IGRzSnNvbi50eXBlKSBhcyBEYXRhU291cmNlVHlwZXNcblxuICAgIHN3aXRjaCAoZHNUeXBlKSB7XG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5FcnJvcjpcbiAgICAgICAgcmV0dXJuIG5ldyBFcnJvckRhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5DU1Y6XG4gICAgICAgIHJldHVybiBuZXcgQ1NWRGF0YVNvdXJjZUltcGwob3B0aW9ucylcbiAgICAgIGNhc2UgRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllcjpcbiAgICAgICAgcmV0dXJuIG5ldyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbChvcHRpb25zIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlU2VydmljZTpcbiAgICAgICAgcmV0dXJuIG5ldyBGZWF0dXJlU2VydmljZURhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5Hcm91cExheWVyOlxuICAgICAgICByZXR1cm4gbmV3IEdyb3VwTGF5ZXJEYXRhU291cmNlSW1wbChvcHRpb25zKVxuICAgICAgY2FzZSBEYXRhU291cmNlVHlwZXMuTWFwU2VydmljZTpcbiAgICAgICAgcmV0dXJuIG5ldyBNYXBTZXJ2aWNlRGF0YVNvdXJjZUltcGwob3B0aW9ucylcbiAgICAgIGNhc2UgRGF0YVNvdXJjZVR5cGVzLlNjZW5lU2VydmljZTpcbiAgICAgICAgcmV0dXJuIG5ldyBTY2VuZVNlcnZpY2VEYXRhU291cmNlSW1wbChvcHRpb25zKVxuICAgICAgY2FzZSBEYXRhU291cmNlVHlwZXMuSW1hZ2VTZXJ2aWNlOlxuICAgICAgICByZXR1cm4gbmV3IEltYWdlU2VydmljZURhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5WZWN0b3JUaWxlU2VydmljZTpcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3JUaWxlU2VydmljZURhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5HZW9KU09OOlxuICAgICAgICByZXR1cm4gbmV3IEdlb0pTT05EYXRhU291cmNlSW1wbChvcHRpb25zKVxuICAgICAgY2FzZSBEYXRhU291cmNlVHlwZXMuS01MOlxuICAgICAgICByZXR1cm4gbmV3IEtNTERhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5XRlM6XG4gICAgICAgIHJldHVybiBuZXcgV0ZTRGF0YVNvdXJjZUltcGwob3B0aW9ucylcbiAgICAgIGNhc2UgRGF0YVNvdXJjZVR5cGVzLldNUzpcbiAgICAgICAgcmV0dXJuIG5ldyBXTVNEYXRhU291cmNlSW1wbChvcHRpb25zKVxuICAgICAgY2FzZSBEYXRhU291cmNlVHlwZXMuV01UUzpcbiAgICAgICAgcmV0dXJuIG5ldyBXTVRTRGF0YVNvdXJjZUltcGwob3B0aW9ucylcbiAgICAgIGNhc2UgRGF0YVNvdXJjZVR5cGVzLlNjZW5lTGF5ZXI6XG4gICAgICAgIHJldHVybiBuZXcgU2NlbmVMYXllckRhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5TaW1wbGVMb2NhbDpcbiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVMb2NhbERhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5CdWlsZGluZ1NjZW5lTGF5ZXI6XG4gICAgICAgIHJldHVybiBuZXcgQnVpbGRpbmdTY2VuZUxheWVyRGF0YVNvdXJjZUltcGwob3B0aW9ucylcbiAgICAgIGNhc2UgRGF0YVNvdXJjZVR5cGVzLkJ1aWxkaW5nQ29tcG9uZW50U3ViTGF5ZXI6XG4gICAgICAgIHJldHVybiBuZXcgQnVpbGRpbmdDb21wb25lbnRTdWJMYXllckRhdGFTb3VyY2VJbXBsKG9wdGlvbnMpXG4gICAgICBjYXNlIERhdGFTb3VyY2VUeXBlcy5CdWlsZGluZ0dyb3VwU3ViTGF5ZXI6XG4gICAgICAgIHJldHVybiBuZXcgQnVpbGRpbmdHcm91cFN1YkxheWVyRGF0YVNvdXJjZUltcGwob3B0aW9ucylcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGNvbnN0IGV4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBkc1R5cGVcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmhhbmRsZWQgY2FzZTogJHtleGhhdXN0aXZlQ2hlY2t9YClcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0ICogZnJvbSAnLi9iYXNlLWNsYXNzZXMnXG5leHBvcnQgKiBmcm9tICcuL2ludGVyZmFjZXMnXG5leHBvcnQge1xuICBGZWF0dXJlRGF0YVJlY29yZEltcGwsXG4gIENTVkRhdGFTb3VyY2VJbXBsLFxuICBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbCxcbiAgRmVhdHVyZVNlcnZpY2VEYXRhU291cmNlSW1wbCxcbiAgR3JvdXBMYXllckRhdGFTb3VyY2VJbXBsLFxuICBNYXBTZXJ2aWNlRGF0YVNvdXJjZUltcGwsXG4gIFNpbXBsZUxvY2FsRGF0YVNvdXJjZUltcGwsXG4gIFNjZW5lU2VydmljZURhdGFTb3VyY2VJbXBsLFxuICBTY2VuZUxheWVyRGF0YVNvdXJjZUltcGwsXG4gIHR5cGUgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyxcbiAgdHlwZSBTY2VuZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyxcbiAgZGF0YVNvdXJjZUpzb25DcmVhdG9yXG59XG4iLCJpbXBvcnQgeyB0eXBlIElHZW9tZXRyeSwgdHlwZSBHZW9tZXRyeVR5cGUsIHR5cGUgSUl0ZW0gfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcydcbmltcG9ydCB7IHR5cGUgSUF0dGFjaG1lbnRJbmZvIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtZmVhdHVyZS1sYXllcidcbmltcG9ydCB7IHR5cGUgRGF0YVNvdXJjZU1hbmFnZXIsIHR5cGUgSU1EYXRhU291cmNlSnNvbiwgdHlwZSBJTURhdGFTb3VyY2VTY2hlbWEsIHR5cGUgSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEsIHR5cGUgSW50bFNoYXBlLCB0eXBlIElNRGF0YVNvdXJjZUluZm8sIHR5cGUgU2VydmljZURlZmluaXRpb24sIHR5cGUgSW1tdXRhYmxlT2JqZWN0LCB0eXBlIEltbXV0YWJsZUFycmF5LCB0eXBlIFNxbEV4cHJlc3Npb24sIHR5cGUgSU1EYXRhVmlld0pzb24gfSBmcm9tICdqaW11LWNvcmUnXG5cbi8qKlxuICogQWxsIGRhdGEgc291cmNlIHN0YXR1cyBpcyBoZXJlLCBpbmNsdWRpbmcgZGF0YSBzb3VyY2UgaW5zdGFuY2Ugc3RhdHVzIGFuZCBkYXRhIHN0YXR1cyAoZm9yIFF1ZXJpYWJsZURhdGFTb3VyY2UpLlxuICogKiBJbnN0YW5jZSBzdGF0dXMgaW5jbHVkZXM6IE5vdENyZWF0ZWQsIENyZWF0ZWQsIENyZWF0ZUVycm9yLiA8YnIvPlxuICogICAgV2hlbiBhIGRhdGEgc291cmNlIGlzIHJlcXVlc3RlZCB0byBiZSBjcmVhdGVkLCBpdCBpcyBzZXQgdG8gYE5vdENyZWF0ZWRgIGF0IGZpcnN0LlxuICogICAgSWYgYSBkYXRhIHNvdXJjZSBoYXMgbmV2ZXIgYmVlbiB1c2VkLCB0aGVyZSBpcyBubyBkYXRhIHNvdXJjZSBzdGF0dXMuXG4gKiAqIERhdGEgc3RhdHVzIGluY2x1ZGVzOiBOb3RSZWFkeSwgVW5sb2FkZWQsIExvYWRpbmcsIExvYWRlZCwgTG9hZEVycm9yLiA8YnIvPlxuICogICAgV2hlbiBhIFF1ZXJpYWJsZURhdGFTb3VyY2UgaXMgY3JlYXRlZCwgaXQgaXMgc2V0IGFzIGBOb3RSZWFkeWAgb3IgYFVubG9hZGVkYCBhdCBmaXJzdC5cbiAqICAgIElmIHRoZSBkYXRhIHNvdXJjZSBpcyBnZW5lcmF0ZWQgYnkgd2lkZ2V0cywgdGhlIGluaXRpYWwgc3RhdHVzIHdpbGwgYmUgYE5vdFJlYWR5YCwgb3RoZXJ3aXNlIHRoZSBpbml0aWFsIHN0YXR1cyB3aWxsIGJlIGBVbmxvYWRlZGAuXG4gKiAgICBXaGVuIHdpZGdldHMgYXJlIHJlYWR5IHRvIGdlbmVyYXRlIGRhdGEsIHRoYXQgaXMgdG8gc2F5LCB0aGUgZGF0YSBzb3VyY2UgaXMgcmVhZHkgdG8gZG8gcXVlcnksIHdpZGdldHMgd2lsbCBjaGFuZ2UgdGhlIHN0YXR1cyBmcm9tIGBOb3RSZWFkeWAgdG8gYFVubG9hZGVkYC5cbiAqICAgIFdoZW4gd2lkZ2V0cyBhcmUgbm90IHJlYWR5IHRvIGdlbmVyYXRlIGRhdGEsIHdpZGdldHMgd2lsbCBjaGFuZ2UgdGhlIHN0YXR1cyBiYWNrIHRvIGBOb3RSZWFkeWAsXG4gKiAgICB0aGVuIGZyYW1ld29yayB3aWxsIGhlbHAgdG8gY2xlYXIgc291cmNlIHJlY29yZHMsIHJlY29yZHMgYW5kIGNhY2hlIGluIGRhdGEgc291cmNlIGluc3RhbmNlLlxuICogICAgSWYgYGxvYWQoKWAgaXMgaW52b2tlZCwgaXQgd2lsbCBiZSBzZXQgYXMgYExvYWRpbmdgLiBJZiBkYXRhIGlzIHJldHVybmVkLCBpdCB3aWxsIGJlIHNldCBhcyBgTG9hZGVkYC5cbiAqICAgIElmIGFuIGVycm9yIG9jY3VycywgaXQgd2lsbCBiZSBzZXQgYXMgYExvYWRFcnJvcmAuXG4gKi9cbmV4cG9ydCBlbnVtIERhdGFTb3VyY2VTdGF0dXMge1xuICAvLyBJbnN0YW5jZSBzdGF0dXMuXG4gIE5vdENyZWF0ZWQgPSAnTk9UX0NSRUFURUQnLFxuICBDcmVhdGVkID0gJ0NSRUFURUQnLFxuICBDcmVhdGVFcnJvciA9ICdDUkVBVEVfRVJST1InLFxuXG4gIC8vIERhdGEgc3RhdHVzLlxuICAvKipcbiAgICogTm90UmVhZHkgaXMgZm9yIHdpZGdldCBvdXRwdXQgZGF0YSBzb3VyY2Ugb25seS5cbiAgICogV2hlbiBvdXRwdXQgZGF0YSBzb3VyY2UgaW5zdGFuY2UgaXMgY3JlYXRlZCwgdGhlIGRhdGEgaXMgbm90IHJlYWR5IGZvciB1c2UuXG4gICAqIFdpZGdldCBzaG91bGQgZGlzcGF0Y2ggYW4gYWN0aW9uIChEYXRhU291cmNlU3RhdHVzQ2hhbmdlZCkgdG8gbWFrZSB0aGUgZGF0YSBzb3VyY2UgcmVhZHkgZm9yIHVzZS5cbiAgICogSWYgYSBkYXRhIHNvdXJjZSBzdGF0dXMgaXMgbm90IHJlYWR5LCB0aGUgcXVlcnkgc2hvdWxkIHJldHVybiBhbiBlbXB0eSByZXN1bHQuXG4gICAqL1xuICBOb3RSZWFkeSA9ICdOT1RfUkVBRFknLFxuICBVbmxvYWRlZCA9ICdVTkxPQURFRCcsXG4gIExvYWRpbmcgPSAnTE9BRElORycsXG4gIExvYWRlZCA9ICdMT0FERUQnLFxuICBMb2FkRXJyb3IgPSAnTE9BRF9FUlJPUicsXG5cbiAgLy8gU2F2ZSBzdGF0dXMuXG4gIC8qKiBAaWdub3JlICovXG4gIFNhdmluZyA9ICdTQVZJTkcnLFxuICAvKiogQGlnbm9yZSAqL1xuICBTYXZlZCA9ICdTQVZFRCcsXG4gIC8qKiBAaWdub3JlICovXG4gIFNhdmVFcnJvciA9ICdTQVZFX0VSUk9SJyxcblxuICAvLyBGb3IgcmVtb3RlIHB1c2goc3RyZWFtKSBkYXRhIHNvdXJjZXMuXG4gIC8qKiBAaWdub3JlICovXG4gIENsb3NlZCA9ICdDTE9TRUQnLFxuICAvKiogQGlnbm9yZSAqL1xuICBDb25uZWN0aW5nID0gJ0NPTk5FQ1RJTkcnLFxuICAvKiogQGlnbm9yZSAqL1xuICBDb25uZWN0ZWQgPSAnQ09OTkVDVEVEJyxcbiAgLyoqIEBpZ25vcmUgKi9cbiAgQ2xvc2luZyA9ICdDTE9TSU5HJyxcblxuICAvLyBGb3IgY2xpZW50IERTLCB3ZSBkb24ndCBkZWZpbmUgc3RhdHVzLlxufVxuXG4vKipcbiAqIFRoZSBkYXRhIHNvdXJjZSB0eXBlcyB0aGF0IGBqaW11LWNvcmVgIHN1cHBvcnRzLlxuICovXG5leHBvcnQgZW51bSBEYXRhU291cmNlVHlwZXMge1xuICBFcnJvciA9ICdFUlJPUicsXG4gIC8qKiBAaWdub3JlICovXG4gIFNpbXBsZUxvY2FsID0gJ1NJTVBMRV9MT0NBTCcsXG4gIC8qKlxuICAgKiBDU1YgZGF0YSBzb3VyY2UgaXMgZnJvbSBhIENTViBmaWxlICguY3N2LCAudHh0KS5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgQ1NWID0gJ0NTVicsXG5cbiAgLyoqXG4gICAqIEZlYXR1cmVMYXllciBkYXRhIHNvdXJjZSBpcyBhIGBRdWVyaWFibGVEYXRhU291cmNlYCwgd2hpY2ggaXMgdXNlZCB0byBxdWVyeSBBcmNHSVMgZmVhdHVyZSBzZXJ2aWNlLlxuICAgKiBTZWUge0BsaW5rIEZlYXR1cmVMYXllckRhdGFTb3VyY2V9XG4gICAqL1xuICBGZWF0dXJlTGF5ZXIgPSAnRkVBVFVSRV9MQVlFUicsXG4gIC8qKlxuICAgKiBTZWUge0BsaW5rIFNjZW5lTGF5ZXJEYXRhU291cmNlfVxuICAgKi9cbiAgU2NlbmVMYXllciA9ICdTQ0VORV9MQVlFUicsXG4gIC8qKlxuICAgKiBHcm91cExheWVyIGRhdGEgc291cmNlIGlzIGEgZGF0YSBzb3VyY2Ugc2V0IHRoYXQgbWF5IGhhdmUgY2hpbGQgZGF0YSBzb3VyY2VzLiBJdCBpcyBmcm9tIGdyb3VwIGxheWVyIGluIGEgbWFwIHNlcnZpY2Ugb3IgYSB3ZWJtYXAvd2Vic2NlbmUuXG4gICAqL1xuICBHcm91cExheWVyID0gJ0dST1VQX0xBWUVSJyxcbiAgLyoqXG4gICAqIEZlYXR1cmVTZXJ2aWNlIGRhdGEgc291cmNlIGlzIGEgZGF0YSBzb3VyY2Ugc2V0IHRoYXQgbWF5IGhhdmUgY2hpbGQgZGF0YSBzb3VyY2VzLiBJdCBpcyBmcm9tIHRoZSBmZWF0dXJlIHNlcnZpY2UuXG4gICAqL1xuICBGZWF0dXJlU2VydmljZSA9ICdGRUFUVVJFX1NFUlZJQ0UnLFxuICAvKipcbiAgICogTWFwU2VydmljZSBkYXRhIHNvdXJjZSBpcyBhIGRhdGEgc291cmNlIHNldCB0aGF0IG1heSBoYXZlIGNoaWxkIGRhdGEgc291cmNlcy4gSXQgaXMgZnJvbSB0aGUgbWFwIHNlcnZpY2UuXG4gICAqL1xuICBNYXBTZXJ2aWNlID0gJ01BUF9TRVJWSUNFJyxcbiAgLyoqXG4gICAqIFNjZW5lU2VydmljZSBkYXRhIHNvdXJjZSBpcyBhIGRhdGEgc291cmNlIHNldCB0aGF0IG1heSBoYXZlIGNoaWxkIGRhdGEgc291cmNlcy4gSXQgaXMgZnJvbSB0aGUgc2NlbmUgc2VydmljZS5cbiAgICovXG4gIFNjZW5lU2VydmljZSA9ICdTQ0VORV9TRVJWSUNFJyxcbiAgLyoqXG4gICAqIEltYWdlU2VydmljZSBkYXRhIHNvdXJjZSBpcyBmcm9tIHRoZSBpbWFnZSBzZXJ2aWNlLlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBJbWFnZVNlcnZpY2UgPSAnSU1BR0VfU0VSVklDRScsXG4gIC8qKlxuICAgKiBWZWN0b3JUaWxlU2VydmljZSBkYXRhIHNvdXJjZSBpcyBmcm9tIHRoZSB2ZWN0b3IgdGlsZSBzZXJ2aWNlLlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBWZWN0b3JUaWxlU2VydmljZSA9ICdWRUNUT1JfVElMRV9TRVJWSUNFJyxcbiAgLyoqXG4gICAqIEdlb0pTT05MYXllciBkYXRhIHNvdXJjZSBpcyBmcm9tIGEgW0dlb0pTT05dKGh0dHBzOi8vZ2VvanNvbi5vcmcvKSBmaWxlLlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBHZW9KU09OID0gJ0dFT19KU09OJyxcbiAgLyoqXG4gICAqIEtNTExheWVyIGRhdGEgc291cmNlIGlzIGZyb20gYSBLTUwgZmlsZSAoLmttbCwgLmtteikuXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIEtNTCA9ICdLTUwnLFxuICAvKipcbiAgICogV0ZTTGF5ZXIgZGF0YSBzb3VyY2UgaXMgZnJvbSBhbiBPR0MgV2ViIEZlYXR1cmUgU2VydmljZSAoV0ZTKS5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgV0ZTID0gJ1dGUycsXG4gIC8qKlxuICAgKiBXTVNMYXllciBkYXRhIHNvdXJjZSBpcyBmcm9tIGFuIE9HQyBXZWIgTWFwIFNlcnZpY2VzIChXTVMpLlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBXTVMgPSAnV01TJyxcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogV01UU0xheWVyIGRhdGEgc291cmNlIGlzIGZyb20gYW4gT0dDIFdlYiBNYXAgVGlsZSBTZXJ2aWNlcyAoV01UUykuXG4gICAqL1xuICBXTVRTID0gJ1dNVFMnLFxuICBCdWlsZGluZ1NjZW5lTGF5ZXIgPSAnYnVpbGRpbmctc2NlbmUnLFxuICBCdWlsZGluZ0dyb3VwU3ViTGF5ZXIgPSAnYnVpbGRpbmctZ3JvdXAnLFxuICBCdWlsZGluZ0NvbXBvbmVudFN1YkxheWVyID0gJ2J1aWxkaW5nLWNvbXBvbmVudCdcbn1cblxuLyoqXG4gKiBAaWdub3JlXG4gKi9cbmV4cG9ydCBlbnVtIEFyY0dJU0RhdGFTb3VyY2VUeXBlcyB7XG4gIE1hcCA9ICdNQVAnLFxuICBXZWJNYXAgPSAnV0VCX01BUCcsXG4gIFdlYlNjZW5lID0gJ1dFQl9TQ0VORScsXG59XG5cbi8qKlxuICogQGlnbm9yZVxuICogQWxsIGRhdGEgc291cmNlIHR5cGVzLCBpbmNsdWRpbmcgdHlwZXMgZnJvbSBqaW11LWNvcmUgYW5kIGppbXUtYXJjZ2lzLlxuICogVGhlIHZhcmlhYmxlIGlzIG9ubHkgdXNlZCBhcyBgdmFsdWVgLCBlLmcuIGNvbnN0IHR5cGVzID0gW0FsbERhdGFTb3VyY2VUeXBlcy5XZWJNYXBdLlxuICovXG5leHBvcnQgY29uc3QgQWxsRGF0YVNvdXJjZVR5cGVzID0geyAuLi5EYXRhU291cmNlVHlwZXMsIC4uLkFyY0dJU0RhdGFTb3VyY2VUeXBlcyB9XG5cbi8qKlxuKiBBbGwgZGF0YSBzb3VyY2UgdHlwZXMsIGluY2x1ZGluZyB0eXBlcyBmcm9tIGppbXUtY29yZSBhbmQgamltdS1hcmNnaXMuXG4qIFRoZSB2YXJpYWJsZSBpcyBvbmx5IHVzZWQgYXMgYHR5cGVgLCBlLmcuIGxldCB0eXBlczogQWxsRGF0YVNvdXJjZVR5cGVzW10uXG4qL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gZXhwb3J0IHR5cGUgQWxsRGF0YVNvdXJjZVR5cGVzID0gRGF0YVNvdXJjZVR5cGVzIHwgQXJjR0lTRGF0YVNvdXJjZVR5cGVzXG5cbi8qKlxuICogRm9yIG5vdywgd2Ugb25seSBzdXBwb3J0IHNvbWUgbGF5ZXIgc2VydmljZSB0eXBlcy5cbiAqIFRoaXMgdHlwZSBpcyB1c2VkIGJ5IGFkZGluZyBkYXRhIHNvdXJjZSBieSBVUkwuXG4gKi9cbmV4cG9ydCBlbnVtIFN1cHBvcnRlZExheWVyU2VydmljZVR5cGVzIHtcbiAgLy8gc2luZ2xlIGxheWVyIHNlcnZpY2UgdW5kZXIgbWFwIHNlcnZpY2Ugb3IgZmVhdHVyZSBzZXJ2aWNlXG4gIEZlYXR1cmVMYXllciA9ICdGZWF0dXJlIExheWVyJyxcbiAgVGFibGUgPSAnVGFibGUnLFxuICBHcm91cExheWVyID0gJ0dyb3VwIExheWVyJyxcblxuICAvLyBzaW5nbGUgbGF5ZXIgc2VydmljZSB1bmRlciBzY2VuZSBzZXJ2aWNlXG4gIFNjZW5lTGF5ZXJQb2ludCA9ICdQb2ludCcsXG4gIFNjZW5lTGF5ZXIzRE9iamVjdCA9ICczRE9iamVjdCcsXG5cbiAgQnVpbGRpbmdTY2VuZUxheWVyID0gJ0J1aWxkaW5nJyxcbiAgQnVpbGRpbmdHcm91cFN1YkxheWVyID0gJ2J1aWxkaW5nLWdyb3VwJyxcbiAgQnVpbGRpbmdDb21wb25lbnRTdWJMYXllciA9ICdidWlsZGluZy1jb21wb25lbnQnXG59XG5cbi8qKlxuICogRm9yIG5vdywgd2Ugb25seSBzdXBwb3J0IHNvbWUgc2VydmljZSB0eXBlcy5cbiAqIFRoaXMgdHlwZSBpcyB1c2VkIGJ5IGFkZGluZyBkYXRhIHNvdXJjZSBieSBVUkwuXG4gKi9cbmV4cG9ydCBlbnVtIFN1cHBvcnRlZFNlcnZlclR5cGVzIHtcbiAgLy8gW0ZlYXR1cmUgU2VydmljZV0oaHR0cHM6Ly9kZXZlbG9wZXJzLmFyY2dpcy5jb20vcmVzdC9zZXJ2aWNlcy1yZWZlcmVuY2UvZmVhdHVyZS1zZXJ2aWNlLmh0bSlcbiAgRmVhdHVyZVNlcnZpY2UgPSAnRmVhdHVyZVNlcnZlcicsXG4gIC8vIFtNYXAgU2VydmljZV0oaHR0cHM6Ly9kZXZlbG9wZXJzLmFyY2dpcy5jb20vcmVzdC9zZXJ2aWNlcy1yZWZlcmVuY2UvaG9zdGVkLW1hcC1zZXJ2aWNlLmh0bSlcbiAgTWFwU2VydmljZSA9ICdNYXBTZXJ2ZXInLFxuICAvLyBbU2NlbmUgU2VydmljZV0oaHR0cHM6Ly9kZXZlbG9wZXJzLmFyY2dpcy5jb20vcmVzdC9zZXJ2aWNlcy1yZWZlcmVuY2Uvc2NlbmUtc2VydmljZS5odG0pXG4gIFNjZW5lU2VydmljZSA9ICdTY2VuZVNlcnZlcicsXG4gIC8vIFtJbWFnZSBTZXJ2aWNlXShodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9yZXN0L3NlcnZpY2VzLXJlZmVyZW5jZS9pbWFnZS1zZXJ2aWNlLmh0bSlcbiAgSW1hZ2VTZXJ2aWNlID0gJ0ltYWdlU2VydmVyJyxcbiAgLy8gW1ZlY3RvciBUaWxlIFNlcnZpY2VdKGh0dHBzOi8vZGV2ZWxvcGVycy5hcmNnaXMuY29tL3Jlc3Qvc2VydmljZXMtcmVmZXJlbmNlL3ZlY3Rvci10aWxlLXNlcnZpY2UuaHRtKVxuICBWZWN0b3JUaWxlU2VydmljZSA9ICdWZWN0b3JUaWxlU2VydmVyJ1xufVxuXG4vKipcbiAqIEZvciBub3csIHdlIG9ubHkgc3VwcG9ydCBzb21lIHBvcnRhbCBpdGVtIHR5cGVzLlxuICogVGhpcyB0eXBlIGlzIHVzZWQgYnkgYWRkaW5nIGRhdGEgc291cmNlIGJ5IGl0ZW1zLlxuICogUGxlYXNlIHNlZSBbSXRlbXMgYW5kIGl0ZW0gdHlwZXNdKGh0dHBzOi8vZGV2ZWxvcGVycy5hcmNnaXMuY29tL3Jlc3QvdXNlcnMtZ3JvdXBzLWFuZC1pdGVtcy9pdGVtcy1hbmQtaXRlbS10eXBlcy5odG0pLlxuICovXG5leHBvcnQgZW51bSBTdXBwb3J0ZWRJdGVtVHlwZXMge1xuICBXZWJNYXAgPSAnV2ViIE1hcCcsXG4gIFdlYlNjZW5lID0gJ1dlYiBTY2VuZScsXG4gIEZlYXR1cmVTZXJ2aWNlID0gJ0ZlYXR1cmUgU2VydmljZScsXG4gIE1hcFNlcnZpY2UgPSAnTWFwIFNlcnZpY2UnLFxuICBTY2VuZVNlcnZpY2UgPSAnU2NlbmUgU2VydmljZScsXG4gIEltYWdlU2VydmljZSA9ICdJbWFnZSBTZXJ2aWNlJyxcbiAgVmVjdG9yVGlsZVNlcnZpY2UgPSAnVmVjdG9yIFRpbGUgU2VydmljZScsXG4gIEZlYXR1cmVDb2xsZWN0aW9uID0gJ0ZlYXR1cmUgQ29sbGVjdGlvbicsXG4gIEdyb3VwTGF5ZXIgPSAnR3JvdXAgTGF5ZXInLFxuICBDU1YgPSAnQ1NWJyxcbiAgR2VvSlNPTiA9ICdHZW9Kc29uJyxcbiAgS01MID0gJ0tNTCcsXG4gIFdGUyA9ICdXRlMnLFxuICBXTVMgPSAnV01TJyxcbiAgV01UUyA9ICdXTVRTJyxcbiAgR2VvbWV0cnlTZXJ2aWNlID0gJ0dlb21ldHJ5IFNlcnZpY2UnLFxuICBHZW9jb2RpbmdTZXJ2aWNlID0gJ0dlb2NvZGluZyBTZXJ2aWNlJyxcbiAgR2VvcHJvY2Vzc2luZ1NlcnZpY2UgPSAnR2VvcHJvY2Vzc2luZyBTZXJ2aWNlJyxcbiAgTmV0d29ya0FuYWx5c2lzU2VydmljZSA9ICdOZXR3b3JrIEFuYWx5c2lzIFNlcnZpY2UnLFxuICBHZW9lbnJpY2htZW50U2VydmljZSA9ICdHZW9lbnJpY2htZW50IHNlcnZpY2UnXG59XG5cbi8qKlxuICogRm9yIG5vdywgd2Ugb25seSBzdXBwb3J0IHNvbWUgdHlwZXMgb2YgQXJjR0lTIE1hcHMgU0RLIGZvciBKYXZhU2NyaXB0IGxheWVyLlxuICogVGhpcyB0eXBlIGlzIHVzZWQgYnkgYWRkaW5nIGRhdGEgc291cmNlIGJ5IEFyY0dJUyBNYXBzIFNESyBmb3IgSmF2YVNjcmlwdCBsYXllci5cbiAqIFBsZWFzZSBzZWUgW0xheWVyXShodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9qYXZhc2NyaXB0L2xhdGVzdC9hcGktcmVmZXJlbmNlL2VzcmktbGF5ZXJzLUxheWVyLmh0bWwpLlxuICovXG5leHBvcnQgZW51bSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMge1xuICBGZWF0dXJlTGF5ZXIgPSAnZmVhdHVyZScsXG4gIE1hcEltYWdlTGF5ZXIgPSAnbWFwLWltYWdlJyxcbiAgVGlsZUxheWVyID0gJ3RpbGUnLFxuICBHcm91cExheWVyID0gJ2dyb3VwJyxcbiAgU2NlbmVMYXllciA9ICdzY2VuZScsXG4gIEltYWdlcnlMYXllciA9ICdpbWFnZXJ5JyxcbiAgSW1hZ2VyeVRpbGVMYXllciA9ICdpbWFnZXJ5LXRpbGUnLFxuICBWZWN0b3JUaWxlTGF5ZXIgPSAndmVjdG9yLXRpbGUnLFxuICBLTUxMYXllciA9ICdrbWwnLFxuICBDU1ZMYXllciA9ICdjc3YnLFxuICBHZW9KU09OTGF5ZXIgPSAnZ2VvanNvbicsXG4gIFdGU0xheWVyID0gJ3dmcycsXG4gIFdNU0xheWVyID0gJ3dtcycsXG4gIFdNVFNMYXllciA9ICd3bXRzJyxcbiAgQnVpbGRpbmdTY2VuZUxheWVyID0gJ2J1aWxkaW5nLXNjZW5lJyxcbiAgQnVpbGRpbmdDb21wb25lbnRTdWJMYXllciA9ICdidWlsZGluZy1jb21wb25lbnQnLFxuICBCdWlsZGluZ0dyb3VwU3ViTGF5ZXIgPSAnYnVpbGRpbmctZ3JvdXAnLFxufVxuXG4vKipcbiAqIEZvciBub3csIHdlIG9ubHkgc3VwcG9ydCBzb21lIHR5cGVzIG9mIGxheWVycy5cbiAqIFRoaXMgdHlwZSBpcyB1c2VkIGJ5IGFkZGluZyBkYXRhIHNvdXJjZSBieSBpdGVtIGRhdGEuIEZvciBleGFtcGxlLCBhZGQgZGF0YSBmcm9tIGdyb3VwIGxheWVyIGl0ZW0sIHRvIGNyZWF0ZSBjaGlsZCBkYXRhIHNvdXJjZXMsIHdlIG5lZWQgdG8gcGFyc2UgZ3JvdXAgbGF5ZXIgaXRlbSBkYXRhLlxuICogUGxlYXNlIHNlZSBodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS93ZWItbWFwLXNwZWNpZmljYXRpb24vb2JqZWN0cy9vcGVyYXRpb25hbExheWVycy8gYW5kIGh0dHBzOi8vZGV2ZWxvcGVycy5hcmNnaXMuY29tL3dlYi1zY2VuZS1zcGVjaWZpY2F0aW9uL29iamVjdHMvb3BlcmF0aW9uYWxMYXllcnMvLlxuICovXG5leHBvcnQgZW51bSBTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjIHtcbiAgRmVhdHVyZUxheWVyID0gJ0FyY0dJU0ZlYXR1cmVMYXllcicsXG4gIFNjZW5lTGF5ZXIgPSAnQXJjR0lTU2NlbmVTZXJ2aWNlTGF5ZXInLFxuICBHcm91cExheWVyID0gJ0dyb3VwTGF5ZXInLFxuICBNYXBTZXJ2aWNlID0gJ0FyY0dJU01hcFNlcnZpY2VMYXllcicsXG4gIFRpbGVkTWFwU2VydmljZSA9ICdBcmNHSVNUaWxlZE1hcFNlcnZpY2VMYXllcicsXG4gIFZlY3RvclRpbGVTZXJ2aWNlID0gJ1ZlY3RvclRpbGVMYXllcicsXG4gIEltYWdlU2VydmljZSA9ICdBcmNHSVNJbWFnZVNlcnZpY2VMYXllcicsXG4gIFRpbGVkSW1hZ2VTZXJ2aWNlID0gJ0FyY0dJU1RpbGVkSW1hZ2VTZXJ2aWNlTGF5ZXInLFxuICBDU1YgPSAnQ1NWJyxcbiAgR2VvSlNPTiA9ICdHZW9KU09OJyxcbiAgS01MID0gJ0tNTCcsXG4gIFdGUyA9ICdXRlMnLFxuICBXTVMgPSAnV01TJyxcbn1cblxuLyoqXG4gKiBEYXRhIHNvdXJjZSBmYWN0b3J5IGlzIHVzZWQgdG8gY3JlYXRlIGRhdGEgc291cmNlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTb3VyY2VGYWN0b3J5IHtcbiAgY3JlYXRlRGF0YVNvdXJjZTogKG9wdGlvbnM6IERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMpID0+IERhdGFTb3VyY2Vcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBpbnRlcmZhY2UgQXR0YWNobWVudEluZm8gZXh0ZW5kcyBJQXR0YWNobWVudEluZm8ge1xuICB1cmw/OiBzdHJpbmdcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBpbnRlcmZhY2UgQXR0YWNobWVudFF1ZXJ5T3B0aW9ucyB7XG4gIGF0dGFjaG1lbnRUeXBlczogc3RyaW5nW11cbiAgdXJsOiBzdHJpbmdcbiAgZmVhdHVyZUlkOiBudW1iZXIgfCBzdHJpbmdcbn1cblxuLyoqXG4gKiBQYXJhbWV0ZXJzIG9mIGBEYXRhU291cmNlYCdzIGNvbnN0cnVjdG9yLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICAvKiogVGhlIGRhdGEgc291cmNlIElELiAqL1xuICBpZDogc3RyaW5nXG5cbiAgLyoqXG4gICAqIGRhdGFTb3VyY2VKc29uIG9yIGJlbG9uZ1RvRGF0YVNvdXJjZSBpcyBlaXRoZXItb3Igb3B0aW9uLlxuICAgKiBQYXNzIGRhdGFTb3VyY2VKc29uIHdpbGwgY3JlYXRlIGEgbWFpbiBkYXRhIHNvdXJjZS5cbiAgICogUGFzcyBiZWxvbmdUb0RhdGFTb3VyY2Ugd2lsbCBjcmVhdGUgZGF0YSB2aWV3IG9yIGxvY2FsIGRhdGEgc291cmNlLlxuICAgKi9cbiAgZGF0YVNvdXJjZUpzb24/OiBJTURhdGFTb3VyY2VKc29uXG5cbiAgLyoqIERhdGEgc291cmNlIHRoYXQgdGhlIHRvLWJlLWNyZWF0ZWQgZGF0YSBzb3VyY2UgYmVsb25ncyB0by4gKi9cbiAgYmVsb25nVG9EYXRhU291cmNlPzogRGF0YVNvdXJjZVxuXG4gIC8qKlxuICAgKiBJZiBkYXRhVmlld0lkIGV4aXN0cywgYSBkYXRhIHZpZXcgd2lsbCBiZSBjcmVhdGVkLlxuICAgKi9cbiAgZGF0YVZpZXdJZD86IHN0cmluZ1xuXG4gIC8qKlxuICAgKiBpZiBsb2NhbElkIGV4aXN0cywgYSBsb2NhbCBkYXRhIHNvdXJjZSB3aWxsIGJlIGNyZWF0ZWQuXG4gICAqL1xuICBsb2NhbElkPzogc3RyaW5nXG5cbiAgZGF0YVNvdXJjZU1hbmFnZXI/OiBEYXRhU291cmNlTWFuYWdlclxuICBwYXJlbnREYXRhU291cmNlPzogRGF0YVNvdXJjZVxuICAvKipcbiAgICogamltdUNoaWxkSWQgaXMgdGhlIGlkIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gZGlmZmVyZW50IGNoaWxkIGRhdGEgc291cmNlcyBpbiBhIHBhcmVudCBkYXRhIHNvdXJjZS5cbiAgICogQmVzaWRlcyBqaW11Q2hpbGRJZCwgZXZlcnkgY2hpbGQgZGF0YSBzb3VyY2UgaGFzIGEgZGF0YSBzb3VyY2UgaWQsIHdoaWNoIGNvbnNpc3RzIG9mIHBhcmVudCBkYXRhIHNvdXJjZSBpZCBhbmQgamltdUNoaWxkSWQuXG4gICAqL1xuICBqaW11Q2hpbGRJZD86IHN0cmluZ1xuICAvKipcbiAgKiBJZiBhbGwgb2YgdGhlIGRhdGEgaXMgaG9sZGVkIGluIHRoZSBkYXRhIHNvdXJjZSBpbnN0YW5jZSwgcHV0IHRoZSBkYXRhIGluIHRoZSBzb3VyY2UgcmVjb3Jkcy5cbiAgKiBGb3Igb3RoZXJzLCB0aGUgZGF0YSBtYXkgY29tZSBmcm9tIEFHT0wvcG9ydGFsIGl0ZW0gb3IgYSByZW1vdGUgZGF0YWJhc2UuXG4gICpcbiAgKiBPbmx5IG1haW4gZGF0YSBzb3VyY2Ugb3Igc2VsZWN0aW9uIHZpZXcgd2lsbCBzYXZlIHNvdXJjZSByZWNvcmRzLFxuICAqIGlmIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgYSB2aWV3IG9mIHNlbGVjdGlvbiB2aWV3LCB3aWxsIHVzZSBzZWxlY3Rpb24gdmlldydzIHNvdXJjZSByZWNvcmRzLCBlbHNlLFxuICAqIHdpbGwgdXNlIG1haW4gZGF0YSBzb3VyY2UncyBzb3VyY2UgcmVjb3Jkcy5cbiAgKi9cbiAgc291cmNlUmVjb3Jkcz86IERhdGFSZWNvcmRbXVxuICAvKipcbiAgICogT3JkZXIgaW4gdGhlIHBhcmVudCBkYXRhIHNvdXJjZS5cbiAgICovXG4gIG9yZGVyPzogbnVtYmVyXG59XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgY2xhc3MgRGF0YVNvdXJjZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBkYXRhU291cmNlSWQ6IHN0cmluZ1xuICBjb25zdHJ1Y3RvciAoaWQsIG1lc3NhZ2UpIHtcbiAgICBzdXBlcihgZGF0YSBzb3VyY2UgaWQ6ICR7aWR9LCAke21lc3NhZ2V9YClcbiAgICB0aGlzLmRhdGFTb3VyY2VJZCA9IGlkXG4gIH1cbn1cblxuLy8gI3JlZ2lvbiBEYXRhIHJlY29yZHNcblxuLyoqXG4gKiBBIGRhdGEgcmVjb3JkIHJlcHJlc2VudHMgYSByZWNvcmQgaW4gYSBkYXRhIHNvdXJjZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBEYXRhUmVjb3JkIHtcbiAgLyoqIEEgcmVmZXJlbmNlIG9mIHRoZSBkYXRhIHNvdXJjZSBvYmplY3QgdGhhdCBoYXMgdGhpcyByZWNvcmQuICovXG4gIGRhdGFTb3VyY2U6IERhdGFTb3VyY2VcblxuICAvKipcbiAgICogVGhlIGRhdGEgaXMgYSBwbGFpbiBvYmplY3QuIFRoZSBmb3JtYXQgaXMge2tleTogdmFsdWV9LCBhbmQgdGhlIGtleSBpcyBcImppbXVGaWVsZE5hbWVcIi5cbiAgICpcbiAgICogVGhlIGRhdGEgYmVmb3JlIG1hcHBpbmcgdXNlIHRoaXMgc2NoZW1hOiB7ZmllbGROYW1lOiB2YWx1ZX0uIFdlIG5lZWQgdG8gcmV0dXJuIHRoaXMgc2NoZW1hOiB7amltdUZpZWxkTmFtZTogdmFsdWV9LlxuICAgKi9cbiAgZ2V0RGF0YTogKCkgPT4gYW55XG4gIHNldERhdGE6IChkYXRhKSA9PiB2b2lkXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBjbG9uZSBvZiB0aGUgZGF0YSByZWNvcmQgb2JqZWN0LlxuICAgKiBVc2Ugc2hhbGxvdyBjbG9uZSBieSBkZWZhdWx0LiBJZiBgZGVlcGAgaXMgYHRydWVgLCB3aWxsIHVzZSBkZWVwIGNsb25lLlxuICAgKi9cbiAgY2xvbmU6IChkZWVwPzogYm9vbGVhbikgPT4gRGF0YVJlY29yZFxuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldERhdGFCZWZvcmVNYXBwaW5nOiAoKSA9PiBhbnlcbiAgLyoqXG4gICAqIFJldHVybiBmb3JtYXR0ZWQgcmVjb3JkLlxuICAgKi9cbiAgZ2V0Rm9ybWF0dGVkRGF0YTogKGludGw6IEludGxTaGFwZSkgPT4gYW55XG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIHZhbHVlIG9mIGEgc3BlY2lmaWMgZmllbGQuXG4gICAqL1xuICBnZXRGaWVsZFZhbHVlOiAoamltdUZpZWxkTmFtZTogc3RyaW5nKSA9PiBhbnlcbiAgLyoqIEBpZ25vcmUgKi9cbiAgZ2V0RGF0ZUZpZWxkVmFsdWU6IChqaW11RmllbGROYW1lOiBzdHJpbmcpID0+IGFueVxuICAvKipcbiAgICogUmV0dXJuIHRoZSBmb3JtYXR0ZWQgdmFsdWUgb2YgYSBzcGVjaWZpYyBmaWVsZC5cbiAgICovXG4gIGdldEZvcm1hdHRlZEZpZWxkVmFsdWU6IChqaW11RmllbGROYW1lOiBzdHJpbmcsIGludGw6IEludGxTaGFwZSkgPT4gc3RyaW5nXG4gIC8qKiBAaWdub3JlICovXG4gIGNvbnZlcnRCZWZvcmVNYXBwaW5nRGF0YVRvRGF0YTogKGJlZm9yZU1hcHBpbmdEYXRhOiBhbnkpID0+IGFueVxuICAvKipcbiAgICogUmV0dXJuIHRoZSBkYXRhIGluIEpTT04gZm9ybWF0LCB3aGljaCBpcyB1c2VkIHRvIHNlcmlhbGl6ZSBkYXRhLCBhbmQgdGhlIGtleSBpcyBcImppbXVGaWVsZE5hbWVcIi5cbiAgICovXG4gIHRvSnNvbjogKCkgPT4gYW55XG4gIC8qKlxuICAgKiBSZXR1cm4gSUQgb2YgdGhlIHJlY29yZC5cbiAgICovXG4gIGdldElkOiAoKSA9PiBzdHJpbmdcbiAgLyoqXG4gICAqIFNldCBJRCBvZiB0aGUgcmVjb3JkLlxuICAgKi9cbiAgc2V0SWQ6IChpZDogc3RyaW5nKSA9PiB2b2lkXG4gIC8qKlxuICAgKiBSZXR1cm4gZ2VvbWV0cnkgb2YgdGhlIHJlY29yZC5cbiAgICovXG4gIGdldEdlb21ldHJ5OiAoKSA9PiBJR2VvbWV0cnlcbiAgLyoqXG4gICAqIFJldHVybiB0aGUgb3JpZ2luYWwgZ2VvbWV0cnkgb2YgdGhlIHJlY29yZC5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgZ2V0UmF3R2VvbWV0cnk6ICgpID0+IGFueVxuICBzZXRHZW9tZXRyeTogKGdlbzogSUdlb21ldHJ5KSA9PiB2b2lkXG59XG5cbi8qKlxuICogQSBEYXRhUmVjb3JkU2V0IGhhcyBhIGNvbGxlY3Rpb24gb2YgZGF0YSByZWNvcmRzLiBTaW1pbGFyIHRvIFtGZWF0dXJlU2V0XShodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9qYXZhc2NyaXB0L2xhdGVzdC9hcGktcmVmZXJlbmNlL2VzcmktdGFza3Mtc3VwcG9ydC1GZWF0dXJlU2V0Lmh0bWwpXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVJlY29yZFNldCB7XG4gIC8qKiBUaGUgbmFtZSBvZiB0aGUgRGF0YVJlY29yZFNldCAqL1xuICBuYW1lOiBzdHJpbmdcblxuICAvKiogVGhlIHR5cGUgb2YgdGhlIERhdGFSZWNvcmRTZXQuIEN1cnJlbnRseSwgdGhpcyBpcyB1c2VkIGluIGRhdGEgYWN0aW9uLiAqL1xuICB0eXBlPzogJ3NlbGVjdGVkJyB8ICdsb2FkZWQnIHwgJ2N1cnJlbnQnXG5cbiAgLyoqIFRoZSBkYXRhIHNvdXJjZSB3aGVyZSB0aGUgZGF0YSByZWNvcmQgc2V0IGNvbWVzIGZyb20uICovXG4gIGRhdGFTb3VyY2U6IERhdGFTb3VyY2VcblxuICAvKiogVGhlIHJlY29yZHMgb2YgdGhlIHNldCAqL1xuICByZWNvcmRzOiBEYXRhUmVjb3JkW11cblxuICAvKiogVGhlIGZpZWxkcyBuYW1lcyAqL1xuICBmaWVsZHM/OiBzdHJpbmdbXVxufVxuXG4vLyAjZW5kcmVnaW9uIERhdGEgcmVjb3Jkc1xuXG4vLyAjcmVnaW9uIERhdGEgcXVlcmllc1xuXG4vKipcbiAqIFRoZSByZXN1bHQgb2YgZGF0YSBzb3VyY2UncyBxdWVyeSBtZXRob2QuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUXVlcnlSZXN1bHQge1xuICAvKipcbiAgICogVGhlIHF1ZXJ5IHBhcmFtZXRlcnMgdGhhdCBnZW5lcmF0ZSB0aGUgcmVzdWx0LlxuICAgKi9cbiAgcXVlcnlQYXJhbXM6IElNUXVlcnlQYXJhbXNcbiAgLyoqXG4gICAqIFJlY29yZHMgb2YgdGhlIHF1ZXJ5IHJlc3VsdC5cbiAgICovXG4gIHJlY29yZHM/OiBEYXRhUmVjb3JkW11cbiAgLyoqXG4gICAqIFRoZSBqaW11RmllbGROYW1lLlxuICAgKi9cbiAgZmllbGRzPzogc3RyaW5nW11cbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2YgcmVzdWx0IHJlY29yZHMuXG4gICAqL1xuICBjb3VudD86IG51bWJlclxuICAvKipcbiAgICogVGhlIElEcyBvZiB0aGUgcmVzdWx0IHJlY29yZHMuXG4gICAqL1xuICBpZHM/OiBzdHJpbmdbXVxuICAvKipcbiAgICogV2hldGhlciB0aGUgcXVlcnkgcHJvY2VzcyBpcyBhYm9ydGVkLiBgaXNBYm9ydGVkYCBpcyBgdW5kZWZpbmVkYCBvciBgZmFsc2VgIG1lYW5zIHRoZSBxdWVyeSBwcm9jZXNzIGlzIGRvbmUuXG4gICAqL1xuICBpc0Fib3J0ZWQ/OiBib29sZWFuXG4gIC8qKlxuICAgKiBTb3VyY2UgdmVyc2lvbiBvZiBkYXRhIHNvdXJjZS5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgc291cmNlVmVyc2lvbj86IG51bWJlclxufVxuXG5leHBvcnQgdHlwZSBRdWVyeVByb2dyZXNzQ2FsbGJhY2sgPSAocHJvZ3Jlc3M6IG51bWJlciwgcmVzdWx0OiBRdWVyeVJlc3VsdCkgPT4gdm9pZFxuXG4vKipcbiAqIFF1ZXJ5IHNjb3BlIGRlZmluZXMgd2hpY2ggZGF0YSBpcyByZXR1cm5lZCB3aGVuIHRoZSBxdWVyeSBpcyBleGVjdXRlZCBpbiBhZGRpdGlvbiB0byB0aGUgcXVlcnkgcGFyYW1ldGVycy5cbiAqL1xuZXhwb3J0IGVudW0gUXVlcnlTY29wZSB7XG4gIC8qKiBVc2UgdGhlIHF1ZXJ5IHBhcmFtZXRlcnMgZGlyZWN0bHkgdG8gcXVlcnkuICovXG4gIEluQWxsRGF0YSA9ICdJTl9BTExfREFUQScsXG5cbiAgLyoqIFVzZSB0aGUgcXVlcnkgcGFyYW1ldGVycyBhbmQgdGhlIGZpbHRlcnMgY29uZmlndXJlZCBpbiBleGIgdG8gcXVlcnkuICovXG4gIEluUmVtb3RlQ29uZmlnVmlldyA9ICdJTl9SRU1PVEVfQ09ORklHX1ZJRVcnLFxuXG4gIC8qKiBVc2UgdGhlIHF1ZXJ5IHBhcmFtZXRlcnMgYW5kIHRoZSBjb25maWd1cmVkIGZpbHRlcnMgaW4gZGF0YSBzb3VyY2UgYW5kIGZpbHRlcnMgY29uZmlndXJlZCBpbiBleGIgdG8gcXVlcnkuICovXG4gIEluQ29uZmlnVmlldyA9ICdJTl9DT05GSUdfVklFVycsXG5cbiAgLyoqIFVzZSBhbGwgb2YgdGhlIGFwcGxpeWVkIHF1ZXJ5IHBhcmFtZXRlcnMgdG8gcXVlcnkuICovXG4gIEluUnVudGltZVZpZXcgPSAnSU5fUlVOVElNRV9WSUVXJ1xufVxuXG4vKipcbiAqIE9wdGlvbnMgd2hlbiBjYWxsaW5nIGRhdGEgc291cmNlJ3MgbG9hZCBtZXRob2QuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUXVlcnlPcHRpb25zIHtcbiAgc2NvcGU/OiBRdWVyeVNjb3BlXG5cbiAgLyoqIEZvciBsb2FkIG9ubHkuXG4gICAqICBGb3IgbG9jYWwgZGF0YSBzb3VyY2UsIHlvdSBjYW4gdXNlIGxvY2FsIElEIGFzIHdpZGdldCBJRC5cbiAgICovXG4gIHdpZGdldElkPzogc3RyaW5nXG5cbiAgLyoqIEZvcmNlIHRoZSBxdWVyeSBldmVuIGlmICB0aGUgcXVlcnkgcGFyYW1ldGVycyBoYXZlIG5vdCBjaGFuZ2VkLiAqL1xuICByZWZyZXNoPzogYm9vbGVhblxuXG4gIC8qKlxuICAgKiBXaGVuIGV4ZWN1dGUgcXVlcnksIHRoZSBtYXRjaGVkIHF1ZXJ5IGlzIGV4Y2x1ZGVkLlxuICAgKiBWYWxpZCBpbiBydW50aW1lIHNjb3BlIG9ubHkuXG4gICAqL1xuICBleGNsdWRlUXVlcnk/OiBXaWRnZXREYXRhU291cmNlUGFpclxuXG4gIGRhdGFTb3VyY2VUb0Zvcm1hdFNxbD86IFF1ZXJpYWJsZURhdGFTb3VyY2Vcbn1cblxuZXhwb3J0IGludGVyZmFjZSBHZXRDdXJyZW50UXVlcnlQYXJhbXNPcHRpb25zIHtcbiAgZXhjbHVkZT86IFdpZGdldERhdGFTb3VyY2VQYWlyXG4gIGRhdGFTb3VyY2VUb0Zvcm1hdFNxbD86IFF1ZXJpYWJsZURhdGFTb3VyY2Vcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaWRnZXREYXRhU291cmNlUGFpciB7XG4gIGRhdGFTb3VyY2VJZDogc3RyaW5nXG4gIHdpZGdldElkOiBzdHJpbmdcbn1cblxuLyoqXG4gKiBTZWxlY3QgcmVjb3JkcyBvcHRpb25zLlxuICogSWYgcHJvdmlkZSBgcmVjb3Jkc2AsIHdpbGwgaWdub3JlIGBpZHNgLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdE9wdGlvbnMge1xuICB3aWRnZXRJZDogc3RyaW5nXG4gIGlkcz86IHN0cmluZ1tdXG4gIHJlY29yZHM/OiBEYXRhUmVjb3JkW11cbn1cblxuLyoqXG4gKiBJZiBwcm92aWRlIGByZWNvcmRzYCwgd2lsbCBpZ25vcmUgYGlkc2AgYW5kIGBxdWVyeVBhcmFtc2AuXG4gKiBJZiBubyBgcmVjb3Jkc2AgYW5kIHByb3ZpZGUgYGlkc2AsIHdpbGwgaWdub3JlIGBxdWVyeVBhcmFtc2AuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUXVlcmlhYmxlU2VsZWN0T3B0aW9ucyBleHRlbmRzIFNlbGVjdE9wdGlvbnMge1xuICBxdWVyeVBhcmFtcz86IFBpY2s8UXVlcnlQYXJhbXMsIG51bGw+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXNlZEZpZWxkc09wdGlvbnMge1xuICAvKipcbiAgICogRGVmYXVsdCB2YWx1ZSBpcyBmYWxzZS5cbiAgICogRXhjbHVkZSB3aWRnZXRzIHdoaWNoIGRvIG5vdCB1c2UgZGF0YSBzb3VyY2UgdG8gZG8gcXVlcnkuIEFjdHVhbGx5LCBkYXRhIHNvdXJjZSBkb2VzIG5vdCBuZWVkIHRvIGxvYWQgcmVjb3JkcyBmb3IgdGhlc2Ugd2lkZ2V0cy5cbiAgICovXG4gIGV4Y2x1ZGVXaWRnZXRzRG9Ob3RVc2VEc1RvUXVlcnk/OiBib29sZWFuXG4gIC8vIERlZmF1bHQgaXMgbm9uZS5cbiAgbG9nTGV2ZWw/OiAnZGVidWcnIHwgJ25vbmUnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUXVlcmlhYmxlVXNlZEZpZWxkc09wdGlvbnMgZXh0ZW5kcyBVc2VkRmllbGRzT3B0aW9ucyB7XG4gIHF1ZXJ5UGFyYW1zPzogUXVlcnlQYXJhbXNcbn1cblxuLyoqIFRoZSBiYXNlIHF1ZXJ5IHBhcmFtZXRlciBpbnRlcmZhY2UuICovXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5UGFyYW1zIHtcbiAgLyoqXG4gICAqIFBhZ2UgbnVtYmVyIHN0YXJ0cyBmcm9tIDEsIG5vdCAwLlxuICAgKi9cbiAgcGFnZT86IG51bWJlclxuICAvKipcbiAgICogUGFnZSBzaXplLlxuICAgKi9cbiAgcGFnZVNpemU/OiBudW1iZXJcbn1cbmV4cG9ydCB0eXBlIElNUXVlcnlQYXJhbXMgPSBJbW11dGFibGVPYmplY3Q8UXVlcnlQYXJhbXM+XG5cbi8qKlxuICogUXVlcnkgcGFyYW1ldGVyIHdoaWNoIHN1cHBvcnRzIFNRTC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTcWxRdWVyeVBhcmFtcyBleHRlbmRzIFF1ZXJ5UGFyYW1zIHtcbiAgLyoqXG4gICAqIEEgd2hlcmUgY2xhdXNlIGZvciB0aGUgcXVlcnkuXG4gICAqL1xuICB3aGVyZT86IHN0cmluZ1xuICAvKipcbiAgICogQGlnbm9yZVxuICAgKiBJZiB0aGUgd2hlcmUgY2xhdXNlIGlzIGZyb20gU3FsRXhwcmVzc2lvblJ1bnRpbWUgY29tcG9uZW50IG9yIGNyZWF0ZVNRTEV4cHJlc3Npb24gdXRpbCwgdGhlIHF1ZXJ5IHBhcmFtcyBzaG91bGQgY29udGFpbiB0aGlzIHByb3BlcnR5LlxuICAgKiBUaGUgcHJvcGVydHkgY2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgbmV3IHdoZXJlIGNsYXVzZSBiYXNlZCBvbiBkaWZmZXJlbnQgZGF0YSB2aWV3cyBzaW5jZSBkYXRhIHZpZXdzJyBgaXNDYXNlU2Vuc2l0aXZlYCBjYW4gYmUgZGlmZmVyZW50IChlLmcuIG1haW4gZGF0YSBzb3VyY2UgaXMgaG9zdGVkIEFHT0wgc2VydmljZSBhbmQgaXRzIHNlbGVjdGlvbiB2aWV3KS5cbiAgICpcbiAgICogV2hlbiBtZXJnaW5nIG9uZSBkYXRhIHZpZXcncyBxdWVyeSBwYXJhbXMgYW5kIG1haW4gZGF0YSBzb3VyY2UncyBxdWVyeSBwYXJhbXMsIHdpbGwgY2hlY2sgd2hlaHRlciB0aGVpciBgaXNDYXNlU2Vuc2l0aXZlYCBhcmUgdGhlIHNhbWUuXG4gICAqIElmIG5vdCwgd2lsbCB1c2UgbWFpbiBkYXRhIHNvdXJjZSdzIGBzcWxFeHByZXNzaW9uYCBhbmQgdGhlIGN1cnJlbnQgZGF0YSB2aWV3IHRvIGdlbmVyYXRlIGEgbmV3IHdoZXJlIGNsYXVzZSwgdG8gbWFrZSBpdCBtYXRjaGluZyB0aGUgY3VycmVudCBkYXRhIHZpZXcncyBgaXNDYXNlU2Vuc2l0aXZlYCBjYXBhYmlsaXR5LlxuICAgKi9cbiAgc3FsRXhwcmVzc2lvbj86IFNxbEV4cHJlc3Npb25cbiAgLyoqXG4gICAqIFRoZSBsaXN0IG9mIGZpZWxkcyB0byBiZSBpbmNsdWRlZCBpbiB0aGUgcmV0dXJuZWQgcmVzdWx0IHNldC5cbiAgICovXG4gIG91dEZpZWxkcz86IHN0cmluZ1tdXG4gIC8qKlxuICAgKiBPbmUgb3IgbW9yZSBgamltdUZpZWxkTmFtZWAgYnkgd2hpY2ggdGhlIGZlYXR1cmVzL3JlY29yZHMgd2lsbCBiZSBvcmRlcmVkLlxuICAgKiBVc2UgQVNDIGZvciBhc2NlbmRpbmcgYW5kIERFU0MgZm9yIGRlc2NlbmRpbmcuIFRoZSBmb2xsb3dpbmcgZmllbGRzIGFyZSB1c2VkIHRvIGNvbnRyb2wgdGhlIG9yZGVyaW5nLlxuICAgKiBvcmRlckJ5RmllbGRzIGlzIHNldCB0byBBU0MgKGFzY2VuZGluZyBvcmRlcikgYnkgZGVmYXVsdCBpZiA8T1JERVI+IGlzIHVuc3BlY2lmaWVkLlxuICAgKi9cbiAgb3JkZXJCeUZpZWxkcz86IHN0cmluZ1tdXG4gIC8qKlxuICAgKiBPbmUgb3IgbW9yZSBgamltdUZpZWxkTmFtZWAgYnkgd2hpY2ggdGhlIHZhbHVlcyB3aWxsIGJlIGdyb3VwZWQgZm9yIGNhbGN1bGF0aW5nIHRoZSBzdGF0aXN0aWNzLlxuICAgKi9cbiAgZ3JvdXBCeUZpZWxkc0ZvclN0YXRpc3RpY3M/OiBzdHJpbmdbXVxufVxuXG5leHBvcnQgdHlwZSBJTVNxbFF1ZXJ5UGFyYW1zID0gSW1tdXRhYmxlT2JqZWN0PFNxbFF1ZXJ5UGFyYW1zPlxuXG4vKipcbiAqIFRoZSBkZWZpbml0aW9ucyBmb3Igb25lIG9yIG1vcmUgZmllbGQtYmFzZWQgc3RhdGlzdGljcyB0byBiZSBjYWxjdWxhdGVkLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRpc3RpY0RlZmluaXRpb24ge1xuICAvKipcbiAgICogU3RhdGlzdGljIHR5cGUuXG4gICAqL1xuICBzdGF0aXN0aWNUeXBlOiAnY291bnQnIHwgJ3N1bScgfCAnbWluJyB8ICdtYXgnIHwgJ2F2ZycgfCAnc3RkZGV2JyB8ICd2YXInIHwgJ3BlcmNlbnRpbGVfY29udCcgfCAncGVyY2VudGlsZV9kaXNjJ1xuICAvKipcbiAgICogRmllbGQgdG8gZXhlY3V0ZSBzdGF0aXN0aWMgcXVlcnkuXG4gICAqL1xuICBvblN0YXRpc3RpY0ZpZWxkOiBzdHJpbmdcbiAgLyoqXG4gICAqIE5hbWUgb2Ygc3RhdGlzdGljIHF1ZXJ5IHJlc3VsdC5cbiAgICovXG4gIG91dFN0YXRpc3RpY0ZpZWxkTmFtZTogc3RyaW5nXG4gIC8qKlxuICAgKiBUaGUgcGFyYW1ldGVycyBpcyBmb3IgcGVyY2VudGlsZSBzdGF0aXN0aWNzLlxuICAgKi9cbiAgc3RhdGlzdGljUGFyYW1ldGVycz86IFN0YXRpc3RpY1BhcmFtZXRlcnNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNQYXJhbWV0ZXJzIHtcbiAgLyoqXG4gICAqIGB2YWx1ZWAgc2hvdWxkIGJlIGEgZGVjaW1hbCB2YWx1ZSBiZXR3ZWVuIDAgYW5kIDEuXG4gICAqL1xuICB2YWx1ZTogbnVtYmVyXG4gIC8vIGBvcmRlckJ5YCBpbiBjaGFydCBzZXJpZXMgcXVlcnkgaXMgbG93ZXIgY2FzZS5cbiAgb3JkZXJCeT86ICdBU0MnIHwgJ0RFU0MnIHwgJ2FzYycgfCAnZGVzYydcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29kZWRWYWx1ZSB7XG4gIHZhbHVlOiBzdHJpbmcgfCBudW1iZXJcbiAgbGFiZWw6IHN0cmluZ1xuICByZW5kZXI/OiAoaXRlbTogQ29kZWRWYWx1ZSkgPT4gYW55XG59XG5cbmV4cG9ydCB0eXBlIFRpbWVFeHRlbnQgPSBudW1iZXIgfCBbbnVtYmVyLCBudW1iZXJdXG5cbmV4cG9ydCBpbnRlcmZhY2UgVGltZUluZm8ge1xuICB0aW1lRXh0ZW50OiBbbnVtYmVyLCBudW1iZXJdXG4gIHN0YXJ0VGltZUZpZWxkPzogc3RyaW5nXG4gIGVuZFRpbWVGaWVsZD86IHN0cmluZ1xuICB0cmFja0lkRmllbGQ/OiBzdHJpbmdcbiAgdGltZVJlZmVyZW5jZT86IFRpbWVSZWZlcmVuY2VcbiAgdGltZUludGVydmFsPzogbnVtYmVyXG4gIHRpbWVJbnRlcnZhbFVuaXRzPzogJ2VzcmlUaW1lVW5pdHNDZW50dXJpZXMnIHwgJ2VzcmlUaW1lVW5pdHNEYXlzJyB8ICdlc3JpVGltZVVuaXRzRGVjYWRlcycgfCAnZXNyaVRpbWVVbml0c0hvdXJzJyB8ICdlc3JpVGltZVVuaXRzTWlsbGlzZWNvbmRzJyB8ICdlc3JpVGltZVVuaXRzTWludXRlcycgfCAnZXNyaVRpbWVVbml0c01vbnRocycgfCAnZXNyaVRpbWVVbml0c1NlY29uZHMnIHwgJ2VzcmlUaW1lVW5pdHNXZWVrcycgfCAnZXNyaVRpbWVVbml0c1llYXJzJyB8ICdlc3JpVGltZVVuaXRzVW5rbm93bidcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUaW1lUmVmZXJlbmNlIHtcbiAgcmVzcGVjdHNEYXlsaWdodFNhdmluZz86IGJvb2xlYW5cbiAgdGltZVpvbmU/OiBzdHJpbmdcbn1cblxuLy8gI2VuZHJlZ2lvbiBEYXRhIHF1ZXJpZXNcblxuLy8gI3JlZ2lvbiBEYXRhIHNvdXJjZXNcblxuLyoqXG4gKiBUaGUgaW50ZXJmYWNlIGZvciBhbGwgZGF0YSBzb3VyY2VzLlxuICpcbiAqIENvbmNlcHR1YWxseSwgd2UgaGF2ZSBmb3VyIHR5cGVzIG9mIGRhdGEgc291cmNlcyBidXQgYWxsIG9mIHRoZW0gYXJlIGNyZWF0ZWQgYXMgZGF0YSBzb3VyY2Ugb2JqZWN0OlxuICogKiBNYWluIGRhdGEgc291cmNlOiB0aGUgZGF0YSBzb3VyY2UgdXNlciBhZGRlZCBpbiBkYXRhIHBhbmVsLlxuICogKiBEYXRhIHZpZXc6IHRoZSBkYXRhIHZpZXcgdXNlciBjcmVhdGVkIGluIGRhdGEgcGFuZWwuXG4gKiAqIExvY2FsIGRhdGEgc291cmNlOiB3aGVuIG11bHRpcGxlIHdpZGdldHMgY29ubm5lY3QgdG8gYSBtYWluIGRhdGEgc291cmNlIG9yIGEgZGF0YSB2aWV3LCB0aGV5J2xsIHNoYXJlIHRoZSBzYW1lIGRhdGEgcmVjb3Jkcy4gSWYgeW91IG5lZWQgdG9cbiAqICAgIHVzZSBhIGxvY2FsIGRhdGEgY29weSwgeW91IGNhbiBjcmVhdGUgYSBsb2NhbCBkYXRhIHNvdXJjZSBmcm9tIGEgbWFpbiBkYXRhIHNvdXJjZSBieSB1c2luZyBgRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5jcmVhdGVMb2NhbERhdGFTb3VyY2UoKWAuXG4gKiAqIExvY2FsIGRhdGEgdmlldzogYSBsb2NhbCBkYXRhIHNvdXJjZSBjcmVhdGVkIGZyb20gYSBkYXRhIHZpZXcuXG4gKlxuICogRGF0YSB2aWV3LCBsb2NhbCBkYXRhIHNvdXJjZSBvciBsb2NhbCBkYXRhIHZpZXcgZGVyaXZlZCBmcm9tIHRoZSBzYW1lIG1haW4gZGF0YSBzb3VyY2Ugd2lsbCBzaGFyZSB0aGUgc2FtZSBzY2hlbWEsIHNhbWUgc2VsZWN0aW9uIHJlY29yZHMsIGJ1dCBtYXkgaGF2ZSBkaWZmZXJlbnQgZGF0YSByZWNvcmRzLlxuICogVGhlIHNjaGVtYSBpcyBpbiBtYWluIGRhdGEgc291cmNlIG9ubHkuXG4gKlxuICogVG8gc2hhcmUgdGhlIHNlbGVjdGlvbiBiZXR3ZWVuIGRhdGEgc291cmNlIGFuZCB2aWV3LCB3ZSBjcmVhdGUgYSBzZWxlY3Rpb24gZGF0YSB2aWV3IHdoZW4gY3JlYXRpbmcgdGhlIGRhdGEgc291cmNlLiBUaGUgc2VsZWN0aW9uIGRhdGEgc291cmNlIHZpZXcgSUQgaXM6IGAke2RhdGFTb3VyY2VJZH0tc2VsZWN0aW9uYC5cbiAqIFdoZW4gc2VsZWN0aW5nIHJlY29yZHMsIHRoZSBzZWxlY3RlZCByZWNvcmRzIGFyZSBjb3BpZWQgdG8gdGhlIHNlbGVjdGlvbiBkYXRhIHZpZXcuXG4gKlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGFTb3VyY2Uge1xuXG4gIC8vICNyZWdpb24gQmFzaWMgaW50ZXJmYWNlXG5cbiAgLyoqIFRoZSBkYXRhIHNvdXJjZSBJRC4gKi9cbiAgaWQ6IHN0cmluZ1xuICAvKiogVGhlIHR5cGUgb2YgdGhlIGRhdGEgc291cmNlLiAqL1xuICB0eXBlOiBzdHJpbmdcbiAgLyoqIFRoZSBkYXRhIHNvdXJjZSBtYW5hZ2VyLCB3aGljaCBpcyB1c2VkIHRvIG1hbmFnZSB0aGUgZGF0YSBzb3VyY2UsIGluY2x1ZGluZyBjcmVhdGUvZ2V0L2Rlc3Ryb3kgdGhlIGRhdGEgc291cmNlIGluc3RhbmNlLiAqL1xuICBkYXRhU291cmNlTWFuYWdlcjogRGF0YVNvdXJjZU1hbmFnZXJcbiAgLyoqXG4gICAqIFdoZXRoZXIgYSBkYXRhIHNvdXJjZSBjb250YWlucyBjaGlsZCBkYXRhIHNvdXJjZXMuXG4gICAqIEEgc2V0IGRhdGEgc291cmNlIHdvbid0IGNyZWF0ZSBhbGwgaXRzIGNoaWxkIGRhdGEgc291cmNlcyB3aGVuIGByZWFkeWAgaXMgcmVzb2x2ZWQuXG4gICAqIFRvIG1ha2Ugc3VyZSBhbGwgY2hpbGQgZGF0YSBzb3VyY2VzIGFyZSBjcmVhdGVkLCBwbGVhc2UgdXNlIGBjaGlsZERhdGFTb3VyY2VzUmVhZHlgLlxuICAgKi9cbiAgaXNEYXRhU291cmNlU2V0OiBib29sZWFuXG4gIC8qKiBUaGUgdG90YWwgcmVjb3JkcyBjb3VudCBkZXBlbmRzIG9uIHRoZSBjdXJyZW50IHF1ZXJ5ICovXG4gIGNvdW50PzogbnVtYmVyXG5cbiAgLyoqIFJldHVybiBkYXRhIHNvdXJjZSBsYWJlbC4gKi9cbiAgZ2V0TGFiZWw6ICgpID0+IHN0cmluZ1xuXG4gIC8qKlxuICAgKiBUaGUgZGF0YSBzb3VyY2UgSlNPTiBvYmplY3QgaW4gYXBwIGNvbmZpZy5cbiAgICovXG4gIGdldERhdGFTb3VyY2VKc29uOiAoKSA9PiBJTURhdGFTb3VyY2VKc29uXG4gIC8qKiBVcGRhdGUgZGF0YSBzb3VyY2UgSlNPTiBpbiBkYXRhIHNvdXJjZSBpbnN0YW5jZSAqL1xuICBzZXREYXRhU291cmNlSnNvbjogKGRzSnNvbjogSU1EYXRhU291cmNlSnNvbikgPT4gdm9pZFxuICAvKiogUmV0dXJuIHRoZSBkYXRhIHNvdXJjZSBJRCBmaWVsZC4gKi9cbiAgZ2V0SWRGaWVsZDogKCkgPT4gc3RyaW5nXG4gIC8qKlxuICAgKiBUaGUgc2NoZW1hIHJldHVybmVkIGhlcmUgaXMgdGhlIG1lcmdlZCByZXN1bHQgb2YgdGhlIGNvbmZpZ3VyZWQgc2NoZW1hIGFuZCB0aGUgZmV0Y2hlZCBzY2hlbWEuXG4gICAqIFRoZSBjb25maWd1cmVkIHNjaGVtYSBpcyB0aGUgdXNlcidzIGNoYW5nZXMsIHN1Y2ggYXMgYSBuZXcgZGF0YSBzb3VyY2UgbmFtZS5cbiAgICogVGhlIGZldGNoZWQgc2NoZW1hIGlzIHRoZSBvcmlnaW5hbCBzY2hlbWEgZnJvbSBBR09ML3BvcnRhbCBpdGVtIG9yIGEgcmVtb3RlIGRhdGFiYXNlLCBzdWNoIGFzIHRoZSBzZXJ2aWNlIG5hbWUsIHRoZSBmaWVsZHMgYW5kIHRoZSBmaWx0ZXJzLlxuICAgKi9cbiAgZ2V0U2NoZW1hOiAoKSA9PiBJTURhdGFTb3VyY2VTY2hlbWFcbiAgc2V0U2NoZW1hOiAoc2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEpID0+IHZvaWRcbiAgLyoqXG4gICAqIFRoZSBkYXRhIHNjaGVtYSBpcyBpbiBcImRhdGFTb3VyY2VKc29uXCIsXG4gICAqICAgICogRm9yIGRhdGEgc291cmNlLCB1c2UgXCJqaW11TmFtZVwiIGFzIGtleSwgYW5kIHNhdmUgdGhlIGFjdHVhbCBmaWVsZCBuYW1lIGluIHRoZSBvYmplY3QuXG4gICAqICAgICogRm9yIGRhdGEgc291cmNlIHNldCwgdXNlIFwiamltdUNoaWxkSWRcIiBhcyBrZXksIGFuZCBzYXZlIHRoZSBhY3R1YWwgY2hpbGQgSUQgaW4gdGhlIG9iamVjdC5cbiAgICogSW4gbWFueSBjYXNlcywgd2UgbmVlZCB0byB1c2UgdGhlIGFjdHVhbCBcImNoaWxkSWRcIiBvciBcImZpZWxkTmFtZVwiIHRvIGFjY2VzcyBpbmZvLCBzbyB3ZSBjYW4gdXNlIHRoaXMgbWV0aG9kIHRvIGdldCBhIHJldmVyc2Ugc2NoZW1hIGZvciBlYXNlIG9mIHVzZS5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgZ2V0UmV2ZXJzZWRDb25maWdTY2hlbWE6ICgpID0+IElNUmV2ZXJzZWREYXRhU291cmNlU2NoZW1hXG4gIC8qKlxuICAgKiBGZXRjaCB0aGUgZGF0YSBzY2hlbWEgZnJvbSBhbiBhY3R1YWwgZGF0YSBzb3VyY2UuIElmIGl0J3MgYSBzdGF0aXN0aWMgZGF0YSBzb3VyY2UsIHRoZSBzY2hlbWEgd2lsbCBub3QgYmUgZmV0Y2hlZC5cbiAgICovXG4gIGZldGNoU2NoZW1hOiAoKSA9PiBQcm9taXNlPElNRGF0YVNvdXJjZVNjaGVtYT5cblxuICBnZXRGZXRjaGVkU2NoZW1hOiAoKSA9PiBJTURhdGFTb3VyY2VTY2hlbWFcbiAgc2V0RmV0Y2hlZFNjaGVtYTogKHNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hKSA9PiB2b2lkXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqIFRoZSBzY2hlbWEgY29udGFpbnMgYWxsIGZpZWxkcyBkZWZpbmVkIGluIHRoZSBhY3R1YWwgc2VydmljZS4gWW91IGNhbiBzZWxlY3Qgc29tZSBvZiB0aGUgZmllbGRzIGFuZCBvbmx5IGFsbG93IHdpZGdldHMgdG8gdXNlIHRoZXNlIGZpZWxkcy5cbiAgICogRnJhbWV3b3JrIHByb3ZpZGUgdHdvIHdheXMgdG8gc2VsZWN0IGZpZWxkcywgb25lIGlzIHRvIGNoYW5nZSB0aGUgYXBwIGNvbmZpZyBpbiBidWlsZGVyLCB0aGUgb3RoZXIgaXMgdG8gY2FsbCBgZGF0YVNvdXJjZS5zZXRTZWxlY3RlZEZpZWxkc2AgaW4gYXBwLlxuICAgKlxuICAgKiBUaGUgbWV0aG9kIHdpbGwgcmV0dXJuIHRoZSBpbnRlcnNlY3Rpb24gb2YgY29uZmlndXJlZCBzZWxlY3RlZCBmaWVsZHMgYW5kIHJ1bnRpbWUgc2VsZWN0ZWQgZmllbGRzLlxuICAgKiBUaGUgZmllbGRzIG9mIHVzZWQgZGF0YSBzb3VyY2UgaW4gd2lkZ2V0IGpzb24gc2hvdWxkIGJlIGEgc3ViIHNldCBvZiB0aGUgcmV0dXJuZWQgc2VsZWN0ZWQgZmllbGRzLlxuICAgKiBGb3IgZXhhbXBsZSwgd2lkZ2V0cyBjYW4gY2FsbCBgc2V0U2VsZWN0ZWRGaWVsZHNgIHRvIGxpbWl0IHRoZSBzZWxlY3RhYmxlIGZpZWxkcyBvZiBpdHMgb3V0cHV0IGRhdGEgc291cmNlLlxuICAgKi9cbiAgZ2V0U2VsZWN0ZWRGaWVsZHM6ICgpID0+IHN0cmluZ1tdIC8vIGppbXVOYW1lXG4gIHNldFNlbGVjdGVkRmllbGRzOiAoamltdU5hbWVzOiBzdHJpbmdbXSkgPT4gdm9pZFxuICAvKipcbiAgICogUmV0dXJuIHVzZWQgZmllbGRzIGJvdGggc2F2ZWQgaW4gY29uZmlnIGFuZCBsb2FkIG9uIGRlbWFuZC5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgZ2V0QWxsVXNlZEZpZWxkczogKG9wdGlvbnM/OiBVc2VkRmllbGRzT3B0aW9ucykgPT4gc3RyaW5nW10gfCAnKidcbiAgLyoqXG4gICAqIFJldHVybiB1c2VkIGZpZWxkcyBsb2FkIG9uIGRlbWFuZC4gRm9yIGV4YW1wbGUsIG91dCBmaWVsZHMgaW4gcXVlcnkgcGFyYW1zLlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBnZXRMb2FkT25EZW1hbmRVc2VkRmllbGRzOiAob3B0aW9ucz86IFVzZWRGaWVsZHNPcHRpb25zKSA9PiBzdHJpbmdbXSB8ICcqJ1xuICAvKipcbiAgICogUmV0dXJuIHVzZWQgZmllbGRzIHNhdmVkIGluIGNvbmZpZy4gRm9yIGV4YW1wbGUsIGZpZWxkcyBzYXZlZCBpbiB1c2UgZGF0YSBzb3VyY2VzIG9mIHdpZGdldCBjb25maWcuXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGdldENvbmZpZ1VzZWRGaWVsZHM6IChvcHRpb25zPzogVXNlZEZpZWxkc09wdGlvbnMpID0+IHN0cmluZ1tdIHwgJyonXG5cbiAgLyoqXG4gICAqIFdoZW4gY3VycmVudCBkYXRhIHNvdXJjZSBpcyBjcmVhdGVkIGZyb20gYW4gYXJyYXkgb2YgcmVjb3Jkcywgd2lsbCBzYXZlIGl0IGluIGBzb3VyY2VSZWNvcmRzYC5cbiAgICogVGhlc2UgdHdvIG1ldGhvZHMgYXJlIHVzZWQgdG8gdXBkYXRlIG9yIGdldCB0aGUgc291cmNlIGRhdGEuXG4gICAqL1xuICBzZXRTb3VyY2VSZWNvcmRzOiAocmVjb3JkczogRGF0YVJlY29yZFtdKSA9PiB2b2lkXG4gIC8qKiBSZXR1cm4gdGhlIHNvdXJjZSByZWNvcmRzICovXG4gIGdldFNvdXJjZVJlY29yZHM6ICgpID0+IERhdGFSZWNvcmRbXVxuICAvKipcbiAgICAqIElmIHNlbGVjdGVkIHJlY29yZHMgYXJlIG5vdCBsb2FkZWQgaW4gdGhlIGN1cnJlbnQgZGF0YSBzb3VyY2UsIHRoZXkgd2lsbCBiZSBjb25jYXRlbmF0ZWQgdG8gdGhlIGVuZCBvZiByZWNvcmRzIGFycmF5LlxuICAgICogRm9yIGV4YW1wbGUsIHJlY29yZCAxIGlzIHNlbGVjdGVkIGluIGRhdGEgdmlldyAxIGFuZCBpdCBpcyBub3QgbG9hZGVkIGluIGRhdGEgdmlldyAyIChyZWNvcmQgMSBhY3R1YWxseSBtYXRjaGVzIHF1ZXJ5IHBhcmFtcyBvZiBkYXRhIHZpZXcgMiksXG4gICAgKiBkYXRhVmlldzIuZ2V0UmVjb3Jkc1dpdGhTZWxlY3Rpb24oKSB3aWxsIHJldHVybiBhbGwgbG9hZGVkIHJlY29yZHMgaW4gZGF0YSB2aWV3IDIgYW5kIHJlY29yZCAxLlxuICAgICovXG4gIGdldFJlY29yZHNXaXRoU2VsZWN0aW9uOiAoKSA9PiBEYXRhUmVjb3JkW11cbiAgLyoqXG4gICAqIFJldHVybiB3aGV0aGVyIGN1cnJlbnQgZGF0YSBzb3VyY2UgY2FuIHNhdmUgc291cmNlIHJlY29yZHMgdG8gaXRzZWxmLlxuICAgKiBBIGRhdGEgdmlldyAvIGxvY2FsIGRhdGEgc291cmNlIGRvZXNuJ3Qgc2F2ZSBzb3VyY2UgcmVjb3JkcywgaW5zdGVhZCwgd2lsbCB1c2Ugc291cmNlIHJlY29yZHMgaW4gbWFpbiBkYXRhIHNvdXJjZS5cbiAgICogU2VsZWN0aW9uIHZpZXcgaXMgYSBzcGVjaWFsIGRhdGEgdmlldyB3aGljaCB3aWxsIHNhdmUgc2VsZWN0ZWQgcmVjb3Jkcy5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgY2FuU2F2ZVNvdXJjZVJlY29yZHM6ICgpID0+IGJvb2xlYW5cbiAgLyoqXG4gICAqIEJ1aWxkcyBhIGRhdGEgcmVjb3JkIG9ubHkgLS0gZG9lcyBub3QgYWRkIHRoZSByZWNvcmQgaW50byBkYXRhIHNvdXJjZS5cbiAgICovXG4gIGJ1aWxkUmVjb3JkOiAoZGF0YTogYW55KSA9PiBEYXRhUmVjb3JkXG5cbiAgLyoqIEdldCByZWNvcmQgYnkgaW5kZXggKi9cbiAgZ2V0UmVjb3JkOiAoaW5kZXg6IG51bWJlcikgPT4gRGF0YVJlY29yZFxuXG4gIC8qKiBHZXQgcmVjb3JkIGJ5IElEICovXG4gIGdldFJlY29yZEJ5SWQ6IChpZDogc3RyaW5nKSA9PiBEYXRhUmVjb3JkXG4gIC8qKiBHZXQgcmVjb3JkcyAqL1xuICBnZXRSZWNvcmRzOiAoKSA9PiBEYXRhUmVjb3JkW11cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgcmVjb3JkcyBpbiB0aGUgZGF0YSBzb3VyY2Ugb2JqZWN0IG9ubHksIGRvZXMgbm90IHVwZGF0ZSB0aGUgc291cmNlIGRhdGEuXG4gICAqL1xuICBzZXRSZWNvcmRzOiAocmVjb3JkczogRGF0YVJlY29yZFtdKSA9PiB2b2lkXG4gIC8qKiBAaWdub3JlICovXG4gIG5leHRSZWNvcmQ/OiAoKSA9PiBEYXRhUmVjb3JkXG4gIC8qKiBAaWdub3JlICovXG4gIHByZXZSZWNvcmQ/OiAoKSA9PiBEYXRhUmVjb3JkXG4gIC8qKlxuICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgY2xlYXIgdGhlIGxvYWRlZCByZWNvcmRzIGFuZCB3b24ndCBjbGVhciB0aGUgc291cmNlUmVjb3Jkcy4gT25jZSB0aGUgbG9hZGVkIHJlY29yZHMgYXJlIGNsZWFyZWQsIHRoZSB2ZXJzaW9uIGluIHRoZSBkYXRhIHNvdXJjZSBpbmZvIHdpbGwgYmUgdXBkYXRlZC5cbiAgICovXG4gIGNsZWFyUmVjb3Jkcz86ICgpID0+IHZvaWRcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogQ2xlYXIgcmVjb3JkcyBidXQgZG9uJ3QgYWRkIHZlcnNpb24gaW4gZGF0YSBzb3VyY2UgaW5mby5cbiAgICovXG4gIGNsZWFyUmVjb3Jkc05vdEFkZFZlcnNpb24/OiAoKSA9PiB2b2lkXG4gIC8qKlxuICAgKiBDbGVhciBib3RoIHNvdXJjZVJlY29yZHMgYW5kIGxvYWRlZCByZWNvcmRzLiBCb3RoIHNvdXJjZSB2ZXJzaW9uIGFuZCB2ZXJzaW9uIGluIGRhdGEgc291cmNlIGluZm8gd2lsbCBiZSB1cGRhdGVkLlxuICAgKi9cbiAgY2xlYXJTb3VyY2VSZWNvcmRzOiAoKSA9PiB2b2lkXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqIENsZWFyIHNvdXJjZSByZWNvcmRzIGFuZCByZWNvcmRzLCBuZWl0aGVyIHNvdXJjZSB2ZXJzaW9uIG5vciB2ZXJzaW9uIHdpbGwgYmUgYWRkZWQuXG4gICAqL1xuICBjbGVhclNvdXJjZVJlY29yZHNOb3RBZGRWZXJzaW9uOiAoKSA9PiB2b2lkXG5cbiAgLyoqIFJldHVybiBkYXRhIHNvdXJjZSBzdGF0dXMuICovXG4gIGdldFN0YXR1czogKCkgPT4gRGF0YVNvdXJjZVN0YXR1c1xuICAvKiogVXBkYXRlIGRhdGEgc291cmNlIHN0YXR1cy4gKi9cbiAgc2V0U3RhdHVzPzogKHN0YXR1czogRGF0YVNvdXJjZVN0YXR1cykgPT4gdm9pZFxuICAvKiogUmV0dXJuIGRhdGEgc291cmNlIGNvdW50IHN0YXR1cy4gKi9cbiAgZ2V0Q291bnRTdGF0dXM6ICgpID0+IERhdGFTb3VyY2VTdGF0dXNcbiAgLyoqIFVwZGF0ZSBkYXRhIHNvdXJjZSBjb3VudCBzdGF0dXMuICovXG4gIHNldENvdW50U3RhdHVzPzogKHN0YXR1czogRGF0YVNvdXJjZVN0YXR1cykgPT4gdm9pZFxuICAvKiogUmV0dXJuIGRhdGEgc291cmNlIHZlcnNpb24uICovXG4gIGdldFZlcnNpb246ICgpID0+IG51bWJlclxuICAvKiogVXBkYXRlIGRhdGEgc291cmNlIHZlcnNpb24uICovXG4gIGFkZFZlcnNpb24/OiAoKSA9PiB2b2lkXG4gIC8qKlxuICAgKiBXaGVuIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgY3JlYXRlZCBmcm9tIGFuIGFycmF5IG9mIHJlY29yZHMsIGl0IHdpbGwgYmUgc2F2ZWQgaW4gYHNvdXJjZVJlY29yZHNgLlxuICAgKiBSZXR1cm4gdGhlIHZlcnNpb24gb2YgYHNvdXJjZVJlY29yZHNgLlxuICAgKi9cbiAgZ2V0U291cmNlVmVyc2lvbjogKCkgPT4gbnVtYmVyXG4gIC8qKlxuICAgKiBXaGVuIGN1cnJlbnQgZGF0YSBzb3VyY2UgaXMgY3JlYXRlZCBmcm9tIGFuIGFycmF5IG9mIHJlY29yZHMsIGl0IHdpbGwgYmUgc2F2ZWQgaW4gYHNvdXJjZVJlY29yZHNgLlxuICAgKiBBZGQgdGhlIHZlcnNpb24gb2YgYHNvdXJjZVJlY29yZHNgLlxuICAgKiBgc2V0U291cmNlUmVjb3Jkc2Agd2lsbCBhZGQgdGhlIHZlcnNpb24gYnkgZGVmYXVsdC5cbiAgICovXG4gIGFkZFNvdXJjZVZlcnNpb246ICgpID0+IHZvaWRcblxuICAvKipcbiAgICogRGVzdHJveSB0aGUgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBkZXN0cm95OiAoKSA9PiB2b2lkXG4gIC8qKlxuICAgKiBSZWFkeSBpcyByZXNvbHZlZCBtZWFucyB0aGUgZGF0YSBzb3VyY2UgaW5zdGFuY2UgaXMgcmVhZHkgZm9yIHVzZS5cbiAgICogUGxlYXNlIG5vdGUgdGhhdCBjYW4gbm90IG1ha2Ugc3VyZSBhbGwgY2hpbGQgZGF0YSBzb3VyY2VzIGFyZSBjcmVhdGVkIGlmIGEgc2V0IGRhdGEgc291cmNlIGlzIHJlYWR5LlxuICAgKiBUbyBtYWtlIHN1cmUgYWxsIGNoaWxkIGRhdGEgc291cmNlcyBhcmUgY3JlYXRlZCwgcGxlYXNlIHVzZSBgY2hpbGREYXRhU291cmNlc1JlYWR5YC5cbiAgICovXG4gIHJlYWR5OiAoKSA9PiBQcm9taXNlPHZvaWQgfCBhbnk+XG5cbiAgLyoqIFJldHVybiB0aGUgZGF0YSBzb3VyY2UgaW5mbyBpbiByZWR1eCBzdG9yZS4gKi9cbiAgZ2V0SW5mbzogKCkgPT4gSU1EYXRhU291cmNlSW5mb1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gbnVsbCBtZWFucyB0aGUgZGF0YSBzb3VyY2UgaXMgYSBub24tc3BhdGlhbCBkYXRhIHNvdXJjZS5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgZ2V0R2VvbWV0cnlUeXBlOiAoKSA9PiBHZW9tZXRyeVR5cGVcblxuICAvKipcbiAgICogRm9yIG1vc3Qgb2YgdGhlIHdpZGdldCBvdXRwdXQgZGF0YSBzb3VyY2UsIGl0IGhhcyBhbiBvcmlnaW5hbCBkYXRhIHNvdXJjZSBmcm9tIHdoaWNoIGl0J3MgZ2VuZXJhdGVkLlxuICAgKiBGb3IgdGhlIGNvbmZpZ3VyZWQgZGF0YSBzb3VyY2UsIHJldHVybiBudWxsLlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBnZXRPcmlnaW5EYXRhU291cmNlcz86ICgpID0+IERhdGFTb3VyY2VbXVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGRlcml2ZWQgZGF0YSB2aWV3cyBhbmQgbG9jYWwgZGF0YSBzb3VyY2VzLlxuICAgKi9cbiAgZ2V0QWxsRGVyaXZlZERhdGFTb3VyY2VzOiAoKSA9PiBEYXRhU291cmNlW11cblxuICAvKipcbiAgICogUmV0dXJuIHdoZXRoZXIgdGhlIGRhdGEgc291cmNlIGlzIGFkZGVkIGluIGJ1aWxkZXIgYW5kIGlzIHNhdmVkIGluIGFwcCBjb25maWcuXG4gICAqL1xuICBpc0luQXBwQ29uZmlnOiAoKSA9PiBib29sZWFuXG5cbiAgLy8gI2VuZHJlZ2lvblxuXG4gIC8vICNyZWdpb24gaW50ZXJmYWNlIGZvciBwYXJlbnQgZGF0YSBzb3VyY2VcbiAgLyoqIFJldHVybiBjaGlsZCBkYXRhIHNvdXJjZXMgb2YgYSBwYXJlbnQgZGF0YSBzb3VyY2UuICovXG4gIGdldENoaWxkRGF0YVNvdXJjZXM/OiAoKSA9PiBEYXRhU291cmNlW11cblxuICAvKiogUmV0dXJuIGFsbCBjaGlsZCBkYXRhIHNvdXJjZXMgb2YgYSBwYXJlbnQgZGF0YSBzb3VyY2UsIGluY2x1ZGVzIHRoZSBncmFuZGNoaWxkcmVuICovXG4gIGdldEFsbENoaWxkRGF0YVNvdXJjZXM/OiAoKSA9PiBEYXRhU291cmNlW11cblxuICAvKipcbiAgICogR2V0IGNoaWxkIGRhdGEgc291cmNlIGJ5IGBqaW11Q2hpbGRJZGAuIFlvdSBjYW4gZ2V0IGBqaW11Q2hpbGRJZGAgYnkgYGdldEppbXVDaGlsZElkKClgLlxuICAgKi9cbiAgZ2V0Q2hpbGREYXRhU291cmNlPzogKGppbXVDaGlsZElkOiBzdHJpbmcpID0+IERhdGFTb3VyY2VcblxuICAvKipcbiAgICogR2V0IHRoZSBhY3R1YWwgZGF0YSBzb3VyY2UgSUQgYnkgYGppbXVDaGlsZElkYC5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgZ2V0Q2hpbGREYXRhU291cmNlSWQ/OiAoamltdUNoaWxkSWQ6IHN0cmluZykgPT4gc3RyaW5nXG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogVGhlIGppbXUgY2hpbGQgSUQgaXMgc2ltaWxhciB0byB0aGUgamltdUZpZWxkTmFtZSwgYW5kIHdpZGdldHMgc2hvdWxkIHVzZSB0aGUgamltdUNoaWxkSWQgaW5zdGVhZCBvZiB0aGUgY2hpbGRJZCB0byBtYWtlIGRhdGEgbWFwcGluZyB3b3JrLlxuICAgKi9cbiAgZ2V0SmltdUNoaWxkSWQ/OiAoY2hpbGRJZDogc3RyaW5nKSA9PiBzdHJpbmdbXVxuICAvKipcbiAgKiBBbGwgY2hpbGQgZGF0YSBzb3VyY2VzIChpbmNsdWRpbmcgZGVzY2VuZGFudCBkYXRhIHNvdXJjZXMpIGFyZSByZWFkeSBmb3IgdXNlLlxuICAqIERhdGEgc291cmNlIGhhcyB0aGlzIG1ldGhvZCBvbmx5IGlmIGl0IGlzIGRhdGEgc291cmNlIHNldCAoYGRhdGFTb3VyY2UuaXNEYXRhU291cmNlU2V0YCBpcyB0cnVlKS5cbiAgKi9cbiAgY2hpbGREYXRhU291cmNlc1JlYWR5PzogKCkgPT4gUHJvbWlzZTxEYXRhU291cmNlW10+XG4gIC8qKlxuICAgKiBSZXR1cm4gd2hldGhlciBhbGwgY2hpbGQgZGF0YSBzb3VyY2VzIChpbmNsdWRpbmcgZGVzY2VuZGFudCBkYXRhIHNvdXJjZXMpIGFyZSBjcmVhdGVkLlxuICAgKiBEYXRhIHNvdXJjZSBoYXMgdGhpcyBtZXRob2Qgb25seSBpZiBpdCBpcyBkYXRhIHNvdXJjZSBzZXQgKGBkYXRhU291cmNlLmlzRGF0YVNvdXJjZVNldGAgaXMgdHJ1ZSkuXG4gICAqL1xuICBhcmVDaGlsZERhdGFTb3VyY2VzQ3JlYXRlZD86ICgpID0+IGJvb2xlYW5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIGNoaWxkIG9yIGEgZGVzY2VuZGFudCBkYXRhIHNvdXJjZSBieSBpZC5cbiAgICogRGF0YSBzb3VyY2UgaGFzIHRoaXMgbWV0aG9kIG9ubHkgaWYgaXQgaXMgZGF0YSBzb3VyY2Ugc2V0IChgZGF0YVNvdXJjZS5pc0RhdGFTb3VyY2VTZXRgIGlzIHRydWUpLlxuICAgKlxuICAgKiBQbGVhc2Ugbm90ZSB3aWxsIG9ubHkgY3JlYXRlIHRoZSBzcGVjaWZpYyBkYXRhIHNvdXJjZSwgd29uJ3QgY3JlYXRlIGRlc2NlbmRhbnQgZGF0YSBzb3VyY2VzIG9mIGl0LlxuICAgKi9cbiAgY3JlYXRlRGF0YVNvdXJjZUJ5SWQ/OiAoZGF0YVNvdXJjZUlkOiBzdHJpbmcpID0+IFByb21pc2U8RGF0YVNvdXJjZT5cbiAgLy8gI2VuZHJlZ2lvblxuXG4gIC8vICNyZWdpb24gaW50ZXJmYWNlIGZvciBjaGlsZCBkYXRhIHNvdXJjZVxuICAvKipcbiAgICogVGhlIHBhcmVudCBkYXRhIHNvdXJjZSBvZiB0aGlzIGRhdGEgc291cmNlLCBtdWxsIG1lYW5zIGl0J3MgYSByb290IGRhdGEgc291cmNlLlxuICAgKi9cbiAgcGFyZW50RGF0YVNvdXJjZTogRGF0YVNvdXJjZVxuXG4gIGppbXVDaGlsZElkOiBzdHJpbmdcbiAgLyoqXG4gICAqIE9yZGVyIGluIHRoZSBwYXJlbnQgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBvcmRlcj86IG51bWJlclxuICAvKiogUmV0dXJuIHRoZSByb290IGRhdGEgc291cmNlLiAqL1xuICBnZXRSb290RGF0YVNvdXJjZTogKCkgPT4gRGF0YVNvdXJjZVxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBpbnRlcmZhY2UgZm9yIGRhdGEgdmlldyBvciBsb2NhbCBkYXRhIHNvdXJjZVxuICAvKiogVGhlIGRhdGEgc291cmNlIHdoaWNoIHRoaXMgZGF0YSBzb3VyY2UgZGVyaXZlcyBmcm9tLiAqL1xuICBiZWxvbmdUb0RhdGFTb3VyY2U/OiBEYXRhU291cmNlXG4gIC8qKiBUaGUgZGF0YSB2aWV3IElEIGNvbmZpZ3VyZWQgaW4gSnNvbi4gKi9cbiAgZGF0YVZpZXdJZD86IHN0cmluZ1xuICAvKipcbiAgICogVHJ1ZSBtZWFucyB0aGUgZGF0YSBzb3VyY2UgaXMgYSBkYXRhIHZpZXcuXG4gICAqIEZvciBsb2NhbCBkYXRhIHNvdXJjZSwgdGhpcyBpcyBmYWxzZSBldmVuIHRoZSBsb2NhbCBkYXRhIHNvdXJjZSBpcyBjcmVhdGVkIGZyb20gYSBkYXRhIHZpZXcuXG4gICAqL1xuICBpc0RhdGFWaWV3OiBib29sZWFuXG4gIC8qKlxuICAgKiBUcnVlIG1lYW5zIHRoZSBkYXRhIHNvdXJjZSBpcyBhIGxvY2FsIGRhdGEgc291cmNlLlxuICAgKi9cbiAgaXNMb2NhbDogYm9vbGVhblxuICAvKiogVGhlIGxvY2FsIElEIG9mIHRoZSBkYXRhIHNvdXJjZS4gKi9cbiAgbG9jYWxJZD86IHN0cmluZ1xuICAvKiogUmV0dXJuIHRoZSBtYWluIGRhdGEgc291cmNlLiAqL1xuICBnZXRNYWluRGF0YVNvdXJjZTogKCkgPT4gRGF0YVNvdXJjZVxuICAvKiogUmV0dXJuIGFsbCBkYXRhIHZpZXdzIGNyZWF0ZWQgZnJvbSBhIG1haW4gZGF0YSBzb3VyY2UuICovXG4gIGdldERhdGFWaWV3czogKCkgPT4gRGF0YVNvdXJjZVtdXG4gIC8qKiBHZXQgZGF0YSB2aWV3IGJ5IGRhdGEgdmlldyBJRC4gKi9cbiAgZ2V0RGF0YVZpZXc6IChkYXRhVmlld0lkOiBzdHJpbmcpID0+IERhdGFTb3VyY2VcbiAgLyoqIFJldHVybiB0aGUgY29uZmlnIG9mIHRoZSBjdXJyZW50IGRhdGEgc291cmNlLiAqL1xuICBnZXREYXRhVmlld0NvbmZpZzogKCkgPT4gSU1EYXRhVmlld0pzb25cblxuICAvKiogUmV0dXJuIGFsbCBsb2NhbCBkYXRhIHNvdXJjZXMgY3JlYXRlZCBmcm9tIGEgbWFpbiBkYXRhIHNvdXJjZSBvciBkYXRhIHZpZXcuICovXG4gIGdldExvY2FsRGF0YVNvdXJjZXM6ICgpID0+IERhdGFTb3VyY2VbXVxuICAvKiogR2V0IGxvY2FsIGRhdGEgc291cmNlIGJ5IGxvY2FsIElELiAqL1xuICBnZXRMb2NhbERhdGFTb3VyY2U6IChsb2NhbElkOiBzdHJpbmcpID0+IERhdGFTb3VyY2VcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogR2V0IHdoZXRoZXIgYSBkYXRhIHNvdXJjZSBzaG91bGQgdXNlIHJlY29yZHMgb2Ygbm9fc2VsZWN0aW9uIHZpZXcgYXMgaXRzIG93biBzb3VyY2UgcmVjb3Jkcy5cbiAgICovXG4gIHVzZU5vU2VsZWN0aW9uVmlldzogKGRhdGFTb3VyY2U/OiBEYXRhU291cmNlKSA9PiBib29sZWFuXG4gIC8vICNlbmRyZWdpb25cblxuICAvLyAjcmVnaW9uIGludGVyZmFjZSBmb3IgZGF0YSBzb3VyY2UgZWRpdCBvcGVyYXRpb25zXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqIFRoZXNlIG1ldGhvZHMgd2lsbCB1cGRhdGUgdGhlIHNvdXJjZSBkYXRhIG9mIGRhdGEgc291cmNlLlxuICAgKlxuICAgKiBUaGUgZGF0YSBzb3VyY2Ugb2JqZWN0IHByb3ZpZGVzIGFuIGludGVyZmFjZSBpbnRlcmFjdCB3aXRoIGl0cyBzb3VyY2UsXG4gICAqIHRoZSBzb3VyY2UgMS4gbWF5IGNvbWUgZnJvbSBBR09ML3BvcnRhbCBpdGVtIG9yIGEgcmVtb3RlIGRhdGFiYXNlLCAyLiBtYXkgY29tZSBmcm9tIGFuIGFycmF5IGRpcmVjdGx5LlxuICAgKiBJZiB0aGUgc291cmNlIGNvbWVzIGZyb20gQUdPTC9wb3J0YWwgaXRlbSBvciBhIHJlbW90ZSBkYXRhYmFzZSwgdGhlc2Ugb3BlcmF0aW9ucyB3aWxsIHVzZSBBcmNHSVMgTWFwcyBTREsgZm9yIEphdmFTY3JpcHQgb3IgQXJjR0lTIFJFU1QgQVBJcyB0byBhcHBseSBlZGl0cyB0byBpdC5cbiAgICogSWYgdGhlIHNvdXJjZSBjb21lcyBmcm9tIGFuIGFycmF5IGRpcmVjdGx5LCB3aWxsIHNhdmUgaXQgaW4gYHNvdXJjZVJlY29yZHNgIGFuZCB0aGVzZSBvcGVyYXRpb25zIHdpbGwgZWRpdCB0aGUgYHNvdXJjZVJlY29yZHNgLlxuICAgKlxuICAgKiBUaGUgZGF0YSBzb3VyY2Ugb2JqZWN0IGFsc28gY29udGFpbnMgYSBzdWJzZXQgb2YgaXRzIHNvdXJjZSwgdGhlIHN1YnNldCBpcyBzYXZlZCBpbiBgcmVjb3Jkc2AgYW5kIGxvYWRlZCBmcm9tIHNvdXJjZS5cbiAgICogVG8gdXBkYXRlIHRoZSBzdWJzZXQsIHBsZWFzZSB1c2UgYHNldFJlY29yZHMoKWAsIHRvIHVwZGF0ZSB0aGUgc291cmNlLCBwbGVhc2UgdXNlIHRoZXNlIG9wZXJhdGlvbnMuXG4gICAqIFRvIGdldCB0aGUgc3Vic2V0LCBwbGVhc2UgdXNlIGBnZXRSZWNvcmRzKClgLCB0byBnZXQgdGhlIHNvdXJjZTpcbiAgICogICAtIGZvciBkYXRhIHNvdXJjZSB3aGljaCBjb21lcyBmcm9tIGFuIGFycmF5IGRpcmVjdGx5LCBwbGVhc2UgdXNlIGBnZXRTb3VyY2VSZWNvcmRzKClgLFxuICAgKiAgIC0gZm9yIGRhdGEgc291cmNlIHdoaWNoIGNvbWVzIGZyb20gQUdPTC9wb3J0YWwgaXRlbSBvciBhIHJlbW90ZSBkYXRhYmFzZTpcbiAgICogICAgIC0gZm9yIHF1ZXJpYWJsZSBkYXRhIHNvdXJjZSwgcGxlYXNlIHVzZSBgcXVlcnkoKWAgb3IgYGxvYWQoKWAsXG4gICAqICAgICAtIGZvciBzdHJlYW0gZGF0YSBzb3VyY2UsIHBsZWFzZSB1c2UgYG9uRGF0YWAgKFRCRCkuXG4gICAqL1xuICB1cGRhdGVSZWNvcmRzOiAocmVjb3JkczogRGF0YVJlY29yZFtdKSA9PiBQcm9taXNlPGJvb2xlYW4+XG4gIGFkZFJlY29yZDogKHJlY29yZDogRGF0YVJlY29yZCkgPT4gUHJvbWlzZTxEYXRhUmVjb3JkPlxuICB1cGRhdGVSZWNvcmQ6IChyZWNvcmQ6IERhdGFSZWNvcmQpID0+IFByb21pc2U8Ym9vbGVhbj5cbiAgZGVsZXRlUmVjb3JkOiAoaW5kZXg6IG51bWJlcikgPT4gUHJvbWlzZTxib29sZWFuPlxuICBkZWxldGVSZWNvcmRCeUlkOiAoaWQ6IHN0cmluZykgPT4gUHJvbWlzZTxib29sZWFuPlxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBpbnRlcmZhY2UgYWZ0ZXIgZWRpdGluZyBzb3VyY2UgZGF0YSBvZiBkYXRhIHNvdXJjZSAoKip0aGUgZWRpdCBvcGVyYXRpb24gaXNuJ3QgZG9uZSBieSBkYXRhIHNvdXJjZSoqLCBlLmcuIHZpYSBBcmNHSVMgQXJjR0lTIFJFU1QgQVBJcyBkaXJlY3RseSlcbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogVGhlc2UgbWV0aG9kcyBhcmUgdXNlZCB0byB1cGRhdGUgcmVjb3JkcyBpbiBkYXRhIHNvdXJjZSBhZnRlciBlZGl0aW5nIGRhdGEgb3V0IG9mIGRhdGEgc291cmNlICgqKnRoZSBlZGl0IG9wZXJhdGlvbiBpc24ndCBkb25lIGJ5IGRhdGEgc291cmNlKiopLlxuXG4gICAqIE5vIG5lZWQgdG8gdXNlIHRoZXNlIG1ldGhvZHMgaWYgdGhlIGVkaXQgb3BlcmF0aW9uIGlzIGRvbmUgYnkgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBhZnRlclVwZGF0ZVJlY29yZHM6IChyZWNvcmRzOiBEYXRhUmVjb3JkW10pID0+IHZvaWRcbiAgYWZ0ZXJBZGRSZWNvcmQ6IChyZWNvcmQ6IERhdGFSZWNvcmQpID0+IHZvaWRcbiAgYWZ0ZXJVcGRhdGVSZWNvcmQ6IChyZWNvcmQ6IERhdGFSZWNvcmQpID0+IHZvaWRcbiAgYWZ0ZXJEZWxldGVSZWNvcmRCeUlkOiAoaWQ6IHN0cmluZykgPT4gdm9pZFxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBpbnRlcmZhY2UgZm9yIGRhdGEgc291cmNlIHNlbGVjdGlvblxuICAvKipcbiAgICogRGF0YSBzb3VyY2UgbWF5IGhhdmUgc2VsZWN0ZWQgZGF0YSwgdXNlIHNlbGVjdGlvbiB2aWV3IHRvIGhhbmRsZSBpdC5cbiAgICpcbiAgICogIC0gQWxsIHVzZXIgc2VsZWN0ZWQgcmVjb3JkcyB3aWxsIGJlIHNhdmVkIGluIGBzb3VyY2VSZWNvcmRzYCBvZiBzZWxlY3Rpb24gdmlldyxcbiAgICogIC0gYHJlY29yZHNgIG9mIHNlbGVjdGlvbiB2aWV3IGFyZSB1cGRhdGVkIGF1dG9tYXRpY2FsbHkgd2hlbmV2ZXIgYHNvdXJjZVJlY29yZHNgIG9yIGZpbHRlciBvZiBzZWxlY3Rpb24gdmlldyBjaGFuZ2VzLFxuICAgKiAgLSBgc2VsZWN0ZWRJZHNgIG9mIGRhdGEgc291cmNlIGluZm8gaXMgdGhlIHJlYWwgaGlnaHRsaWdodGVkIHJlY29yZHMgb2YgdGhlIGRhdGEgc291cmNlLFxuICAgKiAgICBib3RoIG9mIG1haW4gZGF0YSBzb3VyY2UgYW5kIGRhdGEgdmlld3MgaGF2ZSB0aGVpciBvd24gaW5mbywgYHNlbGVjdGVkSWRzYCBvZiBkYXRhIHZpZXcgaW5mbyBpcyBzdWJzZXQgb2YgYHNlbGVjdGVkSWRzYCBvZiBtYWluIGRhdGEgc291cmNlIGluZm8gc2luY2Ugc29tZSBzZWxlY3RlZCByZWNvcmRzIG9mIG1haW4gZGF0YSBzb3VyY2UgbWF5IGRvIG5vdCBtYXRjaCBmaWx0ZXIgb2YgZGF0YSB2aWV3LFxuICAgKlxuICAgKiAgLSBJZiB3aWRnZXQgYWRkIGEgZmlsdGVyIHRvIHNlbGVjdGlvbiB2aWV3LFxuICAgKiAgICAgLSBgc291cmNlUmVjb3Jkc2Agb2Ygc2VsZWN0aW9uIHZpZXcgd2lsbCBzdGlsbCBiZSB0aGUgc2FtZSxcbiAgICogICAgIC0gYHJlY29yZHNgIG9mIHNlbGVjdGlvbiB2aWV3IGFuZCBgc2VsZWN0ZWRJZHNgIG9mIG1haW4gZGF0YSBzb3VyY2UgYW5kIGFsbCBkZXJpdmVkIGRhdGEgc291cmNlcyB3aWxsIGJlIHRoZSBmaWx0ZXJlZCByZXN1bHQsXG4gICAqICAtIElmIHdpZGdldCBhZGQgYSBmaWx0ZXIgdG8gbWFpbiBkYXRhIHNvdXJjZS9kYXRhIHZpZXcsXG4gICAqICAgICAtIGlmIGxvYWQgZGF0YSwgYHNvdXJjZVJlY29yZHNgIGFuZCBgcmVjb3Jkc2Agd2lsbCBiZSBhZGRlZCBtaXNzaW5nIG9uZXMsIGlmIGRvbid0IGxvYWQgZGF0YSwgdGhleSB3aWxsIGtlZXAgdGhlIHNhbWUsXG4gICAqICAgICAtIGBzZWxlY3RlZElkc2Agb2YgdGhlIGZpbHRlcmVkIGRhdGEgc291cmNlIGFuZCBkYXRhIHNvdXJjZXMgd2hpY2ggYXJlIGRlcml2ZWQgZnJvbSBpdCB3aWxsIGJlIHRoZSBmaWx0ZXJlZCByZXN1bHQsXG4gICAqXG4gICAqICAtIElmIHF1ZXJ5IG9yIGxvYWQgc2VsZWN0aW9uIHZpZXcsIHRoZSB2aWV3IHdpbGwgbG9hZCBBcmNHSVMgTWFwcyBTREsgZm9yIEphdmFTY3JpcHQgYW5kIHRoZW4gd2lsbCBjcmVhdGUgYSBjbGllbnQtc2lkZSBmZWF0dXJlIGxheWVyIHRvIGRvIHF1ZXJ5LFxuICAgKiAgLSBJZiBvcGVuIG5vX3NlbGVjdGlvbiB2aWV3IGFuZCBgc291cmNlUmVjb3Jkc2Agb2Ygc2VsZWN0aW9uIHZpZXcgaXMgZW1wdHksIHdpbGwgdXNlIGByZWNvcmRzYCBvZiBub19zZWxlY3Rpb24gdmlldyBhcyBgc291cmNlUmVjb3Jkc2Agb2Ygc2VsZWN0aW9uIHZpZXcsXG4gICAqICAtIGByZWNvcmRzYCBvZiBub19zZWxlY3Rpb24gdmlldyBhcmUgdXBkYXRlZCBhdXRvbWF0aWNhbGx5LCB0b28uXG4gICAqICAtIE5vX3NlbGVjdGlvbiB2aWV3IG9ubHkgbG9hZHMgb25lIHBhZ2UsIHdvbid0IHVzZSBhbGwgcmVjb3JkcyBvZiBub19zZWxlY3Rpb24gdmlldyBhcyBkZWZhdWx0IHZhbHVlIG9mIHNlbGVjdGlvbiB2aWV3LlxuICAgKi9cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogQGRlcHJlY2F0ZWRcbiAgICogU2VsZWN0IHJlY29yZCBieSBpbmRleC5cbiAgICovXG4gIHNlbGVjdFJlY29yZDogKGluZGV4OiBudW1iZXIpID0+IHZvaWRcbiAgLyoqXG4gICAqIFNlbGVjdCByZWNvcmRzLlxuICAgKi9cbiAgc2VsZWN0UmVjb3JkczogKG9wdGlvbnM6IFNlbGVjdE9wdGlvbnMpID0+IFByb21pc2U8UGljazxRdWVyeVJlc3VsdCwgJ3JlY29yZHMnPj5cbiAgLyoqXG4gICAqIFNlbGVjdCBhIHJlY29yZCBieSBJRC5cbiAgICogV2hlbiBzZWxlY3QgcmVjb3JkIGJ5IElELCB3ZSBjYW4gcGFzcyBpbiB0aGUgcmVjb3JkLiBTbyB3aGVuIHRoZSBzZWxlY3RlZCByZWNvcmQgaXMgbm90IGxvYWRlZCwgd2UgY2FuIGFkZCBpdCBpbi5cbiAgICpcbiAgICogQHBhcmFtIGlkIFRoZSBJRCB0byBiZSBzZWxlY3RlZC4gVGhlIHNlbGVjdGlvbiB3aWxsIGJlIGNsZWFyZWQgaWYgdGhlIElEIGlzIG51bGwuXG4gICAqL1xuICBzZWxlY3RSZWNvcmRCeUlkOiAoaWQ6IHN0cmluZywgcmVjb3JkPzogRGF0YVJlY29yZCkgPT4gdm9pZFxuICAvKipcbiAgICogU2VsZWN0IHJlY29yZHMgYnkgSURzLlxuICAgKiBXaGVuIHNlbGVjdCByZWNvcmRzIGJ5IElEcywgd2UgY2FuIHBhc3MgaW4gdGhlIHJlY29yZHMuIFNvIHdoZW4gdGhlIHNlbGVjdGVkIHJlY29yZHMgYXJlIG5vdCBsb2FkZWQsIHdlIGNhbiBhZGQgdGhlbSBpbi5cbiAgICpcbiAgICogQHBhcmFtIGlkcyBUaGUgSURzIHRvIGJlIHNlbGVjdGVkLiBUaGUgc2VsZWN0aW9uIHdpbGwgYmUgY2xlYXJlZCBpZiB0aGUgSURzIGFyZSBudWxsLlxuICAgKi9cbiAgc2VsZWN0UmVjb3Jkc0J5SWRzOiAoaWRzOiBzdHJpbmdbXSwgcmVjb3Jkcz86IERhdGFSZWNvcmRbXSkgPT4gdm9pZFxuICAvKiogR2V0IHNlbGVjdGVkIHJlY29yZHMgKi9cbiAgZ2V0U2VsZWN0ZWRSZWNvcmRzOiAoKSA9PiBEYXRhUmVjb3JkW11cbiAgLyoqIEdldCBzZWxlY3RlZCByZWNvcmQgaW5kZXhlcyovXG4gIGdldFNlbGVjdGVkUmVjb3JkSW5kZXhlczogKCkgPT4gbnVtYmVyW11cbiAgLyoqIEdldCBzZWxlY3RlZCByZWNvcmQgSURzKi9cbiAgZ2V0U2VsZWN0ZWRSZWNvcmRJZHM6ICgpID0+IHN0cmluZ1tdXG4gIGdldFNlbGVjdGVkUmVjb3JkSWRzRnJvbUluZm86ICgpID0+IEltbXV0YWJsZUFycmF5PHN0cmluZz5cbiAgZ2V0U2VsZWN0T3B0aW9uc0Zyb21JbmZvOiAoKSA9PiBJbW11dGFibGVPYmplY3Q8U2VsZWN0T3B0aW9ucz5cbiAgLyoqXG4gICAqIFVwZGF0ZSBzZWxlY3RlZCByZWNvcmRzIGluIGRhdGEgc291cmNlIGluZm8gaWYgdGhlIGN1cnJlbnQgZGF0YSBzb3VyY2UgbGlzdGVucyBzZWxlY3Rpb24gY2hhbmdlIChzZWUgYHNldExpc3RlblNlbGVjdGlvbmApIG9yIHRoZSBjdXJyZW50IGRhdGEgc291cmNlIGlzIHRoZSB0cmlnZ2VyIGRhdGEgc291cmNlICh0aGF0IGlzIHRvIHNheSwgc2VsZWN0IHZpYSBpdCkuXG4gICAqXG4gICAqIEJlZm9yZSB1cGRhdGUgaW5mbywgd2lsbCBjaGVjayB3aGV0aGVyIHRoZXNlIHNlbGVjdGVkIHJlY29yZHMgbWF0Y2ggZmlsdGVycyBvZiB0aGUgY3VycmVudCBkYXRhIHNvdXJjZSBmaXJzdGx5LCBhbmQgdGhlbiBvbmx5IHNldCB0aGUgbWF0Y2hlZCBzZWxlY3RlZCByZWNvcmRzIHRvIGluZm8uXG4gICAqIFdpbGwgc2tpcCB0aGUgY2hlY2sgaW4gc29tZSBjYXNlcyB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIGlmIHRoZSBgZm9yY2VDaGVja2AgaXMgbm90IHBhc3NlZCBpbiBvciBpcyBmYWxzZS4gRm9yIGV4YW1wbGUsIGlmIHRoZSBjdXJyZW4gZGF0YSBzb3VyY2UgaXMgbWFpbiBkYXRhIHNvdXJjZSAod2Ugc3VwcG9zZSB0aGF0IG1haW4gZGF0YSBzb3VyY2UgY29udGFpbnMgYWxsIHJlY29yZHMsIG5vIG5lZWQgdG8gY2hlY2spLlxuICAgKiBCdXQgaWYgdGhlIGBmb3JjZUNoZWNrYCBpcyB0cnVlLCB3b24ndCBza2lwIHRoZSBjaGVjay5cbiAgICovXG4gIHVwZGF0ZVNlbGVjdGlvbkluZm86IChvcHRpb25zOiBTZWxlY3RPcHRpb25zLCB0cmlnZ2VyRGF0YVNvdXJjZTogRGF0YVNvdXJjZSwgZm9yY2VDaGVjaz86IGJvb2xlYW4pID0+IHZvaWRcbiAgY2xlYXJTZWxlY3Rpb246ICgpID0+IHZvaWRcbiAgLyoqXG4gICAgKiBXaGV0aGVyIGxpc3RlbiBzZWxlY3RlZCByZWNvcmRzIGZyb20gb3RoZXIgZGF0YSBzb3VyY2VzIHdoaWNoIGFyZSBkZXJpdmVkIGZyb20gdGhlIHNhbWUgbWFpbiBkYXRhIHNvdXJjZS5cbiAgICAqIElmIHRydWUsIHdpbGwgdXBkYXRlIHNlbGVjdGVkIHJlY29yZCBJRHMgb2YgY3VycmVudCBkYXRhIHNvdXJjZSBpbmZvIHdoZW4gc2VsZWN0aW5nIHJlY29yZHMgdmlhIG90aGVyIGRlcml2ZWQgZGF0YSBzb3VyY2VzLiBXaWxsIGFsc28gdXBkYXRlIHNlbGVjdGVkIHJlY29yZCBJRHMgd2hlbiBzZWxlY3RpbmcgcmVjb3JkcyB2aWEgY3VycmVudCBkYXRhIHNvdXJjZSBpdHNlbGYuXG4gICAgKiBJZiBmYWxzZSwgd29uJ3QgY2hhbmdlIHNlbGVjdGVkIHJlY29yZCBJRHMgd2hlbiBzZWxlY3RpbmcgcmVjb3JkcyB2aWEgb3RoZXIgZGVyaXZlZCBkYXRhIHNvdXJjZXMuIFdpbGwgdXBkYXRlIHNlbGVjdGVkIHJlY29yZCBJRHMgb25seSB3aGVuIHNlbGVjdGluZyByZWNvcmRzIHZpYSBjdXJyZW50IGRhdGEgc291cmNlIGl0c2VsZi5cbiAgICAqXG4gICAgKiBNYWluIGRhdGEgc291cmNlIGFuZCBpdHMgZGF0YSB2aWV3cyB3aWxsIGxpc3RlbiBzZWxlY3RlZCByZWNvcmRzIGJ5IGRlZmF1bHQsIGxvY2FsIGRhdGEgc291cmNlIGRvZXMgbm90IGxpc3RlbiBzZWxlY3RlZCByZWNvcmRzIGJ5IGRlZmF1bHQuXG4gICAgKi9cbiAgc2V0TGlzdGVuU2VsZWN0aW9uOiAobGlzdGVuOiBib29sZWFuKSA9PiB2b2lkXG4gIC8qKiBSZXR1cm4gd2hldGhlciBsaXN0ZW4gc2VsZWN0aW9uLiAqL1xuICBnZXRMaXN0ZW5TZWxlY3Rpb246ICgpID0+IGJvb2xlYW5cbiAgLy8gI2VuZHJlZ2lvblxufVxuXG4vKipcbiAqIGBRdWVyaWFibGVEYXRhU291cmNlYCBleHRlbmRzIGBEYXRhU291cmNlYCBhbmQgYWRkIHF1ZXJ5IGNhcGFiaWxpdHkuIEEgcXVlcmlhYmxlIGRhdGEgc291cmNlIG11c3RcbiAqIGhhdmUgYW4gYFVSTGAgdG8gZXhlY3V0ZSB0aGUgcXVlcnkuXG4gKlxuICogVGhlIGN1cnJlbnQgZGVmYXVsdCBxdWVyeSBpbXBsZW1lbnRhdGlvbiBzdXBwb3J0cyBwYWdpbmF0aW9uLiBJdCBhbGxvd3MgbXVsaXRwbGUgd2lkZ2V0cyB0byBhcHBseSBxdWVyaWVzIG9uIHRoZSBzYW1lIGRhdGEgc291cmNlLFxuICogYWxsIG9mIHdoaWNoIGFyZSBtZXJnZWQgYnkgdXNpbmcgdGhlIGBBTkRgIGxvZ2ljIG9wZXJhdG9yLlxuICpcbiAqIFdoZW4gZXhlY3V0ZSBhIHF1ZXJ5LCBpbiBhZGRpdGlvbiB0byB0aGUgcGFzc2VkIGluIHF1ZXJ5IHBhcmFtZXRlcnMsIGFsbCBjb25maWd1cmVkIHF1ZXJpZXMgYW5kXG4gKiBhbGwgb3RoZXIgd2lkZ2V0cyBhcHBsaWVkIHF1ZXJpZXMgYXJlIG1lcmdlZCBieSB1c2luZyB0aGUgYEFORGAgbG9naWMgb3BlcmF0b3IuXG4gKlxuICogV2hlbiBhIHF1ZXJ5IGlzIGV4ZWN1dGVkIGFnYWluc3QgYSBkYXRhIHZpZXcsIHRoZSBxdWVyeSBmcm9tIGl0cyBtYWluIGRhdGEgc291cmNlIGlzIHVzZWQgYXMgd2VsbC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBRdWVyaWFibGVEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZSB7XG4gIC8qKiBUaGUgZGF0YSBzb3VyY2UgVVJMICovXG4gIHVybD86IHN0cmluZ1xuICBsYXN0VXBkYXRlVGltZTogRGF0ZVxuICAvKipcbiAgICogV2hldGhlciB0aGUgZGF0YSBzb3VyY2UgaXMgY2FzZS1zZW5zaXRpdmUgd2hlbiBkb2luZyBxdWVyeSBieSBTUUwgY2xhdXNlcy5cbiAgICovXG4gIGlzU3FsQ2FzZVNlbnNpdGl2ZTogYm9vbGVhblxuXG4gIC8qKlxuICAgKiBFeGVjdXRlIHRoZSBxdWVyeSBhZ2FpbnN0IHRoZSBzZXJ2aWNlIGFuZCB1cGRhdGUgdGhlIGludGVybmFsIGRhdGEgcmVjb3JkcywgcGFnaW5hdGlvbiBpcyBzdXBwb3J0ZWQuXG4gICAqIFdoZW4gY2FsbCB0aGlzIG1ldGhvZCwgdGhlIHJlYWwgcXVlcnkgaXMgcmV0dXJuZCBieSBgZ2V0UmVhbFF1ZXJ5UGFyYW1zYC5cbiAgICpcbiAgICogUGFnaW5hdGlvbjpcbiAgICogVGhlIHBhZ2luYXRpb24gcHJvcGVydGllcyBpbiB0aGUgcGFzc2VkIGluIHF1ZXJ5IHBhcmFtZXRlciBtYXkgYmUgbm90IHRoZSBzYW1lIGFzIHRoZSByZWFsIHF1ZXJ5IHBhZ2luYXRpb24gdGhhdCBpcyBzZW50IHRvIHRoZSBzZXJ2aWNlLlxuICAgKiBUaGUgcmVhbCBxdWVyeSBwYWdpbmF0aW9uIGlzIGRlZmluZWQgaW4gdGhlIGRhdGEgc291cmNlIHNldHRpbmcuXG4gICAqL1xuICBsb2FkOiAocXVlcnk6IFF1ZXJ5UGFyYW1zLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKSA9PiBQcm9taXNlPERhdGFSZWNvcmRbXT5cblxuICAvKipcbiAgICogTG9hZCByZWNvcmQgYnkgSUQsIGRvIG5vdCBjb25zaWRlciBvdGhlciBxdWVyaWVzLlxuICAgKi9cbiAgbG9hZEJ5SWQ6IChpZDogc3RyaW5nLCByZWZyZXNoPzogYm9vbGVhbikgPT4gUHJvbWlzZTxEYXRhUmVjb3JkPlxuXG4gIC8qKiBMb2FkIHRoZSByZWNvcmRzIGNvdW50LiAqL1xuICBsb2FkQ291bnQ6IChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpID0+IFByb21pc2U8bnVtYmVyPlxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGRhdGEgc291cmNlIHF1ZXJ5IHdpdGhvdXQgZXhlY3V0aW5nIHRoZSBhY3R1YWwgcXVlcnkuXG4gICAqL1xuICB1cGRhdGVRdWVyeVBhcmFtczogKHF1ZXJ5OiBRdWVyeVBhcmFtcywgd2lkZ2V0SWQ6IHN0cmluZykgPT4gdm9pZFxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgcXVlcnkgcGFyYW1ldGVycy4gVGhlIGN1cnJlbnQgcXVlcnkgcGFyYW1ldGVycyBjb250YWluIGFsbCBhcHBsaWVkIHF1ZXJpZXMuXG4gICAqL1xuICBnZXRDdXJyZW50UXVlcnlQYXJhbXM6IChvcHRpb25zPzogR2V0Q3VycmVudFF1ZXJ5UGFyYW1zT3B0aW9ucykgPT4gUXVlcnlQYXJhbXNcblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IGxvYWRlZCByZWNvcmQgaWQsIHdoaWNoIGlzIHVzZWQgaW4gYGxvYWRCeUlkYCBtZXRob2QuXG4gICAqL1xuICBnZXRDdXJyZW50UXVlcnlJZDogKCkgPT4gc3RyaW5nXG5cbiAgLyoqIEdldCB0aGUgcXVlcmllcyBhcHBsaWVkIGluIHJ1bnRpbWUuIElmIHRoZSBleGNsdWRlV2lkZ2V0SWQgaXMgcGFzc2VkIGluLCB0aGUgcXVlcmllcyBvZiB0aGlzIHdpZGdldCB3aWxsIGJlIGV4Y2x1ZGVkLiAqL1xuICBnZXRSdW50aW1lUXVlcnlQYXJhbXM6IChleGNsdWRlV2lkZ2V0SWQ/OiBzdHJpbmcpID0+IFF1ZXJ5UGFyYW1zXG4gIC8qKlxuICAgKiBHZXQgdGhlIHVzZXIgY29uZmlnIHF1ZXJ5IHBhcmFtZXRlcnMuXG4gICAqL1xuICBnZXRDb25maWdRdWVyeVBhcmFtczogKCkgPT4gUXVlcnlQYXJhbXNcblxuICAvKiogR2V0IHRoZSBxdWVyeSBwYXJhbWV0ZXJzIGNvbmZpZ3VyZWQgaW4gcmVtb3RlIChub3QgaW4gZXhiKS4gKi9cbiAgZ2V0UmVtb3RlUXVlcnlQYXJhbXM6ICgpID0+IFF1ZXJ5UGFyYW1zXG5cbiAgLyoqXG4gICAqIE1lcmdlIHF1ZXJpZXMgYnkgdXNpbmcgYEFORGAsIGFuZCByZXR1cm4gdGhlIG1lcmdlZCByZXN1bHQuXG4gICAqIElmIGFueSBxdWVyeSBpcyB1bmRlZmluZWQvbnVsbCwgaXQgd2lsbCBiZSBpZ25vcmVkLlxuICAgKi9cbiAgbWVyZ2VRdWVyeVBhcmFtczogKC4uLnF1ZXJpZXM6IFF1ZXJ5UGFyYW1zW10pID0+IFF1ZXJ5UGFyYW1zXG5cbiAgLyoqXG4gICAqIFdoZW4gZG8gcXVlcnkvbG9hZCwgd2UgZG8gbm90IGZpcmUgdGhlIHF1ZXJ5IHJlcXVlc3QgZGlyZWN0bHkuIEluc3RlYWQsIHdlJ2xsIGNvbnNpZGVyIHRoZSBkYXRhIHNvdXJjZSdzIGNvbmZpZy9jdXJyZW50IHF1ZXJ5IHBhcmFtZXRlci5cbiAgICogICogRm9yIGxvYWQ6IHdlJ2xsIG1lcmdlIHRoZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtZXRlciBpZiBpdCBoYXMsIGFuZCBhbGwgd2lkZ2V0IGFwcGxpZWQgcXVlcmllcy5cbiAgICogICogRm9yIHF1ZXJ5LCB3ZSdsbCBtZXJnZSB0aGUgY3VycmVudCBxdWVyeSBwYXJhbWV0ZXIgYW5kIHRoZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtZXRlciBpdCBoYXMuXG4gICAqL1xuICBnZXRSZWFsUXVlcnlQYXJhbXM6IChxdWVyeTogUXVlcnlQYXJhbXMsIGZsYWc6ICdxdWVyeScgfCAnbG9hZCcsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpID0+IFF1ZXJ5UGFyYW1zXG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgcXVlcnkgYWdhaW5zdCB0aGUgc2VydmljZSBvbmx5LCBkbyBOT1QgdXBkYXRlIHRoZSBpbnRlcm5hbCBkYXRhIHJlY29yZHMuXG4gICAqIFRoZSBhY3R1cmFsIHF1ZXJ5IHBhcmFtZXRlcnMgYXJlIGdlbmVyYXRlZCBieSBgZ2V0UmVhbFF1ZXJ5UGFyYW1zYC5cbiAgICpcbiAgICogVG8gcXVlcnkgY291bnQsIHBsZWFzZSB1c2UgYHF1ZXJ5Q291bnRgLlxuICAgKi9cbiAgcXVlcnk6IChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpID0+IFByb21pc2U8UXVlcnlSZXN1bHQ+XG5cbiAgLyoqIFF1ZXJ5IHJlY29yZCBieSBJRCAqL1xuICBxdWVyeUJ5SWQ6IChpZDogc3RyaW5nKSA9PiBQcm9taXNlPERhdGFSZWNvcmQ+XG5cbiAgLyoqIFF1ZXJ5IGNvdW50ICovXG4gIHF1ZXJ5Q291bnQ6IChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpID0+IFByb21pc2U8UXVlcnlSZXN1bHQ+XG5cbiAgLyoqIFF1ZXJ5IHJlY29yZCBJRHMsIHRoZXJlIGlzIG5vIGxpbWl0IHRvIHRoZSBudW1iZXIgb2YgdGhlIElEcyByZXR1cm5lZCBpbiB0aGUgYGlkc2AgYXJyYXkgcmVzcG9uc2UuICovXG4gIHF1ZXJ5SWRzOiAocXVlcnk6IFF1ZXJ5UGFyYW1zLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKSA9PiBQcm9taXNlPFF1ZXJ5UmVzdWx0PlxuXG4gIC8qKlxuICAgKiBRdWVyeSBhbGwgcmVjb3JkcywgdGhlcmUgaXMgbm8gbGltaXQgdG8gdGhlIG51bWJlciBvZiB0aGUgcmVjb3JkcyByZXR1cm5lZCBpbiB0aGUgYHJlY29yZHNgIGFycmF5IHJlc3BvbnNlLlxuICAgKiBZb3UgY2FuIGFib3J0IHRoZSBwcm9ncmVzcyBieSBhIGFib3J0IGBzaWduYWxgIGFuZCBjYW4gdXNlIGBwcm9ncmVzc0NhbGxiYWNrYCB0byBnZXQgdGhlIHByb2dyZXNzIGFuZCB0aGUgY3VycmVudCByZXN1bHRzLlxuICAgKi9cbiAgcXVlcnlBbGw6IChxdWVyeTogUXVlcnlQYXJhbXMsIHNpZ25hbD86IEFib3J0U2lnbmFsLCBwcm9ncmVzc0NhbGxiYWNrPzogUXVlcnlQcm9ncmVzc0NhbGxiYWNrLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKSA9PiBQcm9taXNlPFF1ZXJ5UmVzdWx0PlxuXG4gIHNlbGVjdFJlY29yZHM6IChvcHRpb25zOiBRdWVyaWFibGVTZWxlY3RPcHRpb25zLCBzaWduYWw/OiBBYm9ydFNpZ25hbCwgcHJvZ3Jlc3NDYWxsYmFjaz86IFF1ZXJ5UHJvZ3Jlc3NDYWxsYmFjaykgPT4gUHJvbWlzZTxRdWVyeVJlc3VsdD5cblxuICAvKipcbiAgICogVGhlIHBhZ2Ugc2l6ZSBoZXJlIGRlZmluZXMgdGhlIHJlY29yZHMgdGhpcyBtZXRob2QgcmV0dXJucywgd2hpY2ggYXJlIG5vdCB0aGUgYWN0dWFsIHF1ZXJ5IHBhZ2VTaXplLiBXaWxsIHVzZSBhIGZpeGVkIHBhZ2VTaXplIHRvIHF1ZXJ5IGFuZCBjYWNoZSBkYXRhLlxuICAgKi9cbiAgZ2V0UmVjb3Jkc0J5UGFnZTogKHBhZ2U6IG51bWJlciwgcGFnZVNpemU6IG51bWJlcikgPT4gRGF0YVJlY29yZFtdXG5cbiAgZ2V0UGFnZXNEYXRhOiAoKSA9PiB7IFtwYWdlOiBudW1iZXJdOiBEYXRhUmVjb3JkW10gfVxuICBzZXRQYWdlc0RhdGE6IChwYWdlczogeyBbcGFnZTogbnVtYmVyXTogRGF0YVJlY29yZFtdIH0pID0+IHZvaWRcblxuICAvKipcbiAgICogR2V0IHJlYWwgcXVlcnkgcGFnZSBkZXBlbmRzIG9uIHRoZSB3aWRnZXQncyByZXF1ZXN0IHBhZ2UuXG4gICAqL1xuICBnZXRSZWFsUXVlcnlQYWdlczogKHBhZ2VTaXplOiBudW1iZXIsIHBhZ2U6IG51bWJlcikgPT4gbnVtYmVyW11cblxuICBnZXRRdWVyeVBhZ2VTaXplOiAoKSA9PiBudW1iZXJcblxuICAvKipcbiAgICogTnVsbCBtZWFucyB0aGVyZSBpcyBubyByZWNvcmQgY291bnQgbGltaXQsIGFuZCB3aWxsIHJldHVybiBhbGwgcmVjb3JkcyBmcm9tIHRoZSBzZXJ2aWNlLlxuICAgKi9cbiAgZ2V0TWF4UmVjb3JkQ291bnQ6ICgpID0+IG51bWJlclxuXG4gIC8vIFRPRE8gYWRkL3VwZGF0ZS9kZWxldGUgbXVsdGlwbGUgcmVjb3Jkc1xuICAvKiogQGlnbm9yZSAqL1xuICBnZXRTYXZlU3RhdHVzOiAoKSA9PiBEYXRhU291cmNlU3RhdHVzXG4gIC8qKiBAaWdub3JlICovXG4gIHNldFNhdmVTdGF0dXM/OiAoc3RhdHVzOiBEYXRhU291cmNlU3RhdHVzKSA9PiB2b2lkXG5cbiAgLyoqIE92ZXJyaWRlIHBhcmVudCBpbnRlcmZhY2UgdG8gZ2V0IGNvcnJlY3QgdHlwZS4gKi9cbiAgZ2V0RGF0YVZpZXdzOiAoKSA9PiBRdWVyaWFibGVEYXRhU291cmNlW11cbiAgZ2V0RGF0YVZpZXc6IChkYXRhVmlld0lkOiBzdHJpbmcpID0+IFF1ZXJpYWJsZURhdGFTb3VyY2VcbiAgZ2V0TWFpbkRhdGFTb3VyY2U6ICgpID0+IFF1ZXJpYWJsZURhdGFTb3VyY2VcblxuICAvKiogSWYgdGhlIHJldHVybiB2YWx1ZSA+IDAsIGF1dG8gcmVmcmVzaCBpcyBlbmFibGVkLiAqL1xuICBnZXRBdXRvUmVmcmVzaEludGVydmFsOiAoKSA9PiBudW1iZXJcbiAgZ2V0TGFzdFJlZnJlc2hUaW1lOiAoKSA9PiBEYXRlXG4gIHN0YXJ0QXV0b1JlZnJlc2g6ICgpID0+IHZvaWRcbiAgc3RvcEF1dG9SZWZyZXNoOiAoKSA9PiB2b2lkXG4gIGFsbG93VG9FeHBvcnREYXRhOiAoKSA9PiBQcm9taXNlPGJvb2xlYW4+XG5cbiAgLyoqXG4gICogSWYgc2VsZWN0ZWQgcmVjb3JkcyBhcmUgbm90IGxvYWRlZCBpbiB0aGUgY3VycmVudCBkYXRhIHNvdXJjZSwgd2lsbCBjb25jYXQgdGhlbSB0byB0aGUgZW5kIG9mIHJlY29yZHMgYXJyYXkuXG4gICogU2VlIHtAbGluayBnZXRSZWNvcmRzV2l0aFNlbGVjdGlvbn0gZm9yIGRldGFpbHMuXG4gICovXG4gIGdldFJlY29yZHNCeVBhZ2VXaXRoU2VsZWN0aW9uOiAocGFnZTogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyKSA9PiBEYXRhUmVjb3JkW11cblxuICBnZXRDYXBhYmlsaXRpZXM6ICgpID0+IENhcGFiaWxpdGllc1xuICBnZXRBbGxVc2VkRmllbGRzOiAob3B0aW9ucz86IFF1ZXJpYWJsZVVzZWRGaWVsZHNPcHRpb25zKSA9PiBzdHJpbmdbXSB8ICcqJ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhcGFiaWxpdGllcyB7XG4gIGdldFF1ZXJ5Q2FwYWJpbGl0aWVzOiAoKSA9PiBRdWVyeUNhcGFiaWxpdGllc1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5Q2FwYWJpbGl0aWVzIHtcbiAgbWF4UGFnZVNpemU6IG51bWJlclxufVxuXG4vKiogQGlnbm9yZSAqL1xuZXhwb3J0IGludGVyZmFjZSBMb2FkYWJsZURhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNlIHtcbiAgdXJsPzogc3RyaW5nXG5cbiAgLyoqXG4gICAqIExvYWQgYWxsIGRhdGEgcmVjb3Jkcy5cbiAgICovXG4gIGxvYWQ6ICgpID0+IFByb21pc2U8RGF0YVJlY29yZFtdPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNpbXBsZUxvY2FsRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2Uge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuU2ltcGxlTG9jYWxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDU1ZEYXRhU291cmNlIGV4dGVuZHMgTG9hZGFibGVEYXRhU291cmNlLCBKU0FQSUxheWVyTWl4aW4ge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuQ1NWXG4gIGRvTG9hZDogKCkgPT4gUHJvbWlzZTxEYXRhUmVjb3JkW10+XG4gIGxheWVyPzogX19lc3JpLkNTVkxheWVyXG59XG5cbi8qKlxuICogTGF5ZXIgZnJvbSBBcmNHSVMgTWFwcyBTREsgZm9yIEphdmFTY3JpcHQsIHdoaWNoIG1heSBjb250YWluIHN1YmxheWVycy5cbiAqL1xuZXhwb3J0IHR5cGUgQXJjR0lTRm9sZGVyTGF5ZXIgPSBfX2VzcmkuTWFwSW1hZ2VMYXllciB8IF9fZXNyaS5UaWxlTGF5ZXIgfCBfX2VzcmkuR3JvdXBMYXllciB8IF9fZXNyaS5TdWJsYXllciB8IF9fZXNyaS5CdWlsZGluZ1NjZW5lTGF5ZXJcblxuLyoqXG4gKiBMYXllciBmcm9tIEFyY0dJUyBNYXBzIFNESyBmb3IgSmF2YVNjcmlwdCwgd2hpY2ggaXMgc3VibGF5ZXIgb2YgX19lc3JpLkxheWVyLlxuICovXG5leHBvcnQgdHlwZSBBcmNHSVNTdWJMYXllciA9IF9fZXNyaS5TdWJsYXllciB8IF9fZXNyaS5LTUxTdWJsYXllciB8IF9fZXNyaS5XTVNTdWJsYXllciB8IF9fZXNyaS5XTVRTU3VibGF5ZXJcblxuLyoqXG4gKiBUaGVyZSBpcyBubyBhY3R1YWwgQXJjR0lTIFwiTGF5ZXJGb2xkZXJcIiBzZXJ2aWNlLCB0aGlzIGludGVyZmFjZSBkZWZpbmVzIHRoZSBjb21tb24gYmVoYXZpb3Igb2YgdGhlc2Ugc2VydmljZTpcbiAqICBNYXBTZXJ2aWNlLCBGZWF0dXJlU2VydmljZSwgU2NlbmVTZXJ2aWNlLCBhbmQgR3JvdXBMYXllclNlcnZpY2VcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBYnN0cmFjdEFyY0dJU0xheWVyRm9sZGVyRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2UsIEpTQVBJTGF5ZXJNaXhpbiwgSXRlbU1peGluIHtcbiAgZ2V0U2VydmljZURlZmluaXRpb246ICgpID0+IFNlcnZpY2VEZWZpbml0aW9uXG5cbiAgLyoqIEdldCB0aGUgc2VydmljZSBHREIgdmVyc2lvbi4gKi9cbiAgZ2V0R0RCVmVyc2lvbjogKCkgPT4gc3RyaW5nXG4gIC8qKiBDaGFuZ2UgdGhlIEdEQiB2ZXJzaW9uIGZvciBhbGwgbGF5ZXJzIGluIHRoZSBzZXJ2aWNlLiAqL1xuICBjaGFuZ2VHREJWZXJzaW9uOiAoZ2RiVmVyc2lvbjogc3RyaW5nKSA9PiB2b2lkXG59XG5cbi8qKlxuICogYEltYWdlU2VydmljZURhdGFTb3VyY2VgIGlzIGNyZWF0ZWQgZnJvbSBpbWFnZSBzZXJ2aWNlIG9yIHdlYm1hcC93ZWJzY2VuZS5cbiAqIEBpZ25vcmVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJbWFnZVNlcnZpY2VEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZSwgSlNBUElMYXllck1peGluLCBJdGVtTWl4aW4ge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuSW1hZ2VTZXJ2aWNlXG4gIGxheWVyPzogX19lc3JpLkltYWdlcnlMYXllciB8IF9fZXNyaS5JbWFnZXJ5VGlsZUxheWVyXG59XG5cbi8qKlxuICogYFZlY3RvclRpbGVTZXJ2aWNlRGF0YVNvdXJjZWAgaXMgY3JlYXRlZCBmcm9tIHZlY3RvciB0aWxlIHNlcnZpY2Ugb3Igd2VibWFwL3dlYnNjZW5lLlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFZlY3RvclRpbGVTZXJ2aWNlRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2UsIEpTQVBJTGF5ZXJNaXhpbiwgSXRlbU1peGluIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLlZlY3RvclRpbGVTZXJ2aWNlXG4gIGxheWVyPzogX19lc3JpLlZlY3RvclRpbGVMYXllclxufVxuXG4vKipcbiAqIGBHZW9Kc29uRGF0YVNvdXJjZWAgaXMgY3JlYXRlZCBmcm9tIGEgW0dlb0pTT05dKGh0dHBzOi8vZ2VvanNvbi5vcmcvKSBmaWxlIG9yIHdlYm1hcC93ZWJzY2VuZS5cbiAqIEBpZ25vcmVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHZW9KU09ORGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2UsIEpTQVBJTGF5ZXJNaXhpbiwgSXRlbU1peGluIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkdlb0pTT05cbiAgbGF5ZXI/OiBfX2VzcmkuR2VvSlNPTkxheWVyXG59XG5cbi8qKlxuICogYEtNTERhdGFTb3VyY2VgIGlzIGNyZWF0ZWQgZnJvbSBhIEtNTCBmaWxlICgua21sLCAua216KSBvciB3ZWJtYXAvd2Vic2NlbmUuXG4gKiBAaWdub3JlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgS01MRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2UsIEpTQVBJTGF5ZXJNaXhpbiwgSXRlbU1peGluIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLktNTFxuICBsYXllcj86IF9fZXNyaS5LTUxMYXllclxufVxuXG4vKipcbiAqIGBXRlNEYXRhU291cmNlYCBpcyBjcmVhdGVkIGZyb20gYW4gT0dDIFdlYiBGZWF0dXJlIFNlcnZpY2UgKFdGUykgb3Igd2VibWFwL3dlYnNjZW5lLlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFdGU0RhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNlLCBKU0FQSUxheWVyTWl4aW4sIEl0ZW1NaXhpbiB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5XRlNcbiAgbGF5ZXI/OiBfX2VzcmkuV0ZTTGF5ZXJcbn1cblxuLyoqXG4gKiBgV01TRGF0YVNvdXJjZWAgaXMgY3JlYXRlZCBmcm9tIGFuIE9HQyBXZWIgTWFwIFNlcnZpY2VzIChXTVMpIG9yIHdlYm1hcC93ZWJzY2VuZS5cbiAqIEBpZ25vcmVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBXTVNEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZSwgSlNBUElMYXllck1peGluLCBJdGVtTWl4aW4ge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuV01TXG4gIGxheWVyPzogX19lc3JpLldNU0xheWVyXG59XG5cbi8qKlxuICogYFdNVFNEYXRhU291cmNlYCBpcyBjcmVhdGVkIGZyb20gYW4gT0dDIFdlYiBNYXAgVGlsZSBTZXJ2aWNlcyAoV01UUykgb3Igd2VibWFwL3dlYnNjZW5lLlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFdNVFNEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZSwgSlNBUElMYXllck1peGluLCBJdGVtTWl4aW4ge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuV01UU1xuICBsYXllcj86IF9fZXNyaS5XTVRTTGF5ZXJcbn1cblxuLy8gI2VuZHJlZ2lvbiBEYXRhIHNvdXJjZXNcblxuLy8gI3JlZ2lvbiBEYXRhIHNvdXJjZSBtaXhpbnNcblxuZXhwb3J0IGludGVyZmFjZSBJdGVtTWl4aW4ge1xuICBpdGVtSWQ/OiBzdHJpbmdcbiAgcG9ydGFsVXJsPzogc3RyaW5nXG4gIGdldEl0ZW1JbmZvOiAoKSA9PiBJSXRlbVxuICBnZXRJdGVtRGF0YTogKCkgPT4gYW55XG4gIGZldGNoSXRlbUluZm86ICgpID0+IFByb21pc2U8SUl0ZW0+XG4gIGZldGNoSXRlbURhdGE6ICgpID0+IFByb21pc2U8YW55PlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEpTQVBJTGF5ZXJNaXhpbiB7XG4gIC8qKlxuICAgKiAxIEhvdyB0byB1c2UgQXJjR0lTIE1hcHMgU0RLIGZvciBKYXZhU2NyaXB0IGxheWVyXG4gICAqICAgMS4xIGEgZGF0YSBzb3VyY2UgbWF5IGhhdmUgYSBsYXllciwgdGhlIGxheWVyIGlzIHRoZSBzb3VyY2Ugb2YgdGhlIGRhdGEgc291cmNlIChgaXNEYXRhSW5EYXRhU291cmNlSW5zdGFuY2VgIHNob3VsZCBiZSBmYWxzZSkgYW5kIGlzIHVzZWQgdG8gc2F2ZSBzb3VyY2UgZGF0YSBhbmQgY29tbXVuaWNhdGUgd2l0aCBNYXBzIFNESyBmb3IgSmF2YVNjcmlwdCAoZ2V0IHBvcHVwVGVtcGxhdGUsIHN5bWJvbCBhbmQgc28gb24pLCBpZiB3YW50IHRvIHF1ZXJ5IGZlYXR1cmVzLCBzaG91bGQgdXNlIGRhdGEgc291cmNlIGluc3RhbmNlLCBub3QgdGhlIGxheWVyLlxuICAgKiAgIDEuMiBtYWluIGRhdGEgc291cmNlIGFuZCBhbGwgb3RoZXIgZGF0YSB2aWV3cy9sb2NhbCBkYXRhIHNvdXJjZSBzaGFyZSB0aGUgc2FtZSBsYXllci5cbiAgICogICAxLjMgc2VsZWN0aW9uIHZpZXcgY3JlYXRlIGEgbmV3IGxheWVyIHdoZW4gZG8gcXVlcnksIGJ1dCBkb2Vzbid0IHNhdmUgdGhlIGxheWVyLlxuICAgKiAgIDEuNCBpZiB3aWRnZXQgbmVlZHMgYW4gQXJjR0lTIE1hcHMgU0RLIGZvciBKYXZhU2NyaXB0IGxheWVyLCBjYWxsIGBkYXRhU291cmNlLmNyZWF0ZUpTQVBJTGF5ZXJCeURhdGFTb3VyY2UoKWAgdG8gY3JlYXRlIGEgbmV3IGxheWVyLCBkbyBub3QgdXNlIHRoZSBsYXllciBpbiBkYXRhIHNvdXJjZSBpbnN0YW5jZSBkaXJlY3RseSwgdG8gbGlzdGVuIGRhdGEgc291cmNlIGNoYW5nZXMgYW5kIGFwcGx5IHRoZSBjaGFuZ2VzIHRvIHRoZSBuZXcgbGF5ZXIsIHNlZSAyLjIuXG4gICAqXG4gICAqIDIgSG93IHRvIGxpc3RlbiBkYXRhIHNvdXJjZSBjaGFuZ2VzIHZpYSBEYXRhU291cmNlQ29tcG9uZW50XG4gICAqICAgMi4xIGlmIHdpZGdldCBsb2FkcyByZWNvcmRzLCB1c2UgYG9uRGF0YVNvdXJjZUluZm9DaGFuZ2VgIHRvIGxpc3RlbiBzZWxlY3RlZCByZWNvcmRzIGNoYW5nZSwgcXVlcnkgcGFyYW1zIGNoYW5nZSBhbmQgbG9hZGVkIHJlY29yZHMgY2hhbmdlLlxuICAgKiAgIDIuMiBpZiB3aWRnZXQgZG9lc24ndCAgbG9hZCByZWNvcmRzICh1c2UgYSBNYXBzIFNESyBmb3IgSmF2YVNjcmlwdCB3aWRnZXQgYW5kIG5lZWRzIGFuIEFyY0dJUyBNYXBzIFNESyBmb3IgSmF2YVNjcmlwdCBsYXllciksIHVzZSBgb25RdWVyeVJlcXVpcmVkYCB0byBsaXN0ZW4gcXVlcnkgcGFyYW1zIGNoYW5nZSwgdXNlIGBvblNlbGVjdGlvbkNoYW5nZWAgdG8gbGlzdGVuIHNlbGVjdGVkIHJlY29yZHMgY2hhbmdlLlxuICAgKlxuICAgKiAzIFJlbGF0aW9uIGJldHdlZW4gb3V0cHV0IGRhdGEgc291cmNlIGFuZCBvcmlnaW4gZGF0YSBzb3VyY2VcbiAgICogICAzLjEgaWYgc2NoZW1hIGlzIG5vdCBjaGFuZ2VkIChlLmcuIHF1ZXJ5IG91dHB1dCkgYW5kIG9ubHkgaGFzIG9uZSBvcmlnaW4gZGF0YSBzb3VyY2UsIHdpbGwgdXNlIG9yaWdpbiBkYXRhIHNvdXJjZSdzIGBsYXllckRlZmluaXRpb25gLCBgcG9wdXBJbmZvYCBhbmQgTWFwcyBTREsgZm9yIEphdmFTY3JpcHQgYGxheWVyYC5cbiAgICogICAzLjIgaWYgc2NoZW1hIGlzIGNoYW5nZWQgKGUuZy4gY2hhcnQgb3V0cHV0KSwgbmVlZCB3aWRnZXQgdG8gc2V0IGBsYXllckRlZmluaXRpb25gLCBgcG9wdXBJbmZvYCBhbmQgTWFwcyBTREsgZm9yIEphdmFTY3JpcHQgYGxheWVyYCB0byBkYXRhIHNvdXJjZSBpbnN0YW5jZS5cbiAgICovXG4gIGxheWVyPzogX19lc3JpLkxheWVyIHwgQXJjR0lTU3ViTGF5ZXJcbiAgamltdUxheWVySWQ/OiBzdHJpbmdcbiAgdXJsPzogc3RyaW5nXG4gIGl0ZW1JZD86IHN0cmluZ1xuICBwb3J0YWxVcmw/OiBzdHJpbmdcbiAgY3JlYXRlSlNBUElMYXllckJ5RGF0YVNvdXJjZTogKCkgPT4gUHJvbWlzZTxfX2VzcmkuTGF5ZXI+XG4gIC8vIFdoZXRoZXIgdGhlIGxheWVyIGhhcyBzcGF0aWFsIGluZm9tYXRpb24gdG8gZHJhdyB0aGUgbGF5ZXIgdG8gYSBtYXAsIHN1Y2ggYXMgbGF0aXR1ZGUgYW5kIGxvbmdpdHVkZS5cbiAgc3VwcG9ydFNwYXRpYWxJbmZvOiAoKSA9PiBib29sZWFuXG59XG5cbi8vICNlbmRyZWdpb24gRGF0YSBzb3VyY2UgbWl4aW5zXG5cbmV4cG9ydCBlbnVtIERhdGFTb3VyY2VTZWxlY3Rpb25Nb2RlIHtcbiAgTmV3ID0gJ05ldycsXG4gIEFkZFRvQ3VycmVudCA9ICdBZGRUb0N1cnJlbnQnLFxuICBSZW1vdmVGcm9tQ3VycmVudCA9ICdSZW1vdmVGcm9tQ3VycmVudCcsXG4gIFNlbGVjdEZyb21DdXJyZW50ID0gJ1NlbGVjdEZyb21DdXJyZW50J1xufVxuIiwiZXhwb3J0ICogZnJvbSAnLi9jb21tb24tZGF0YS1zb3VyY2UtaW50ZXJmYWNlJ1xuZXhwb3J0ICogZnJvbSAnLi9mZWF0dXJlLWxheWVyLWRhdGEtc291cmNlLWludGVyZmFjZSdcbmV4cG9ydCAqIGZyb20gJy4vc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW50ZXJmYWNlJ1xuZXhwb3J0ICogZnJvbSAnLi9ncm91cC1sYXllci1kYXRhLXNvdXJjZS1pbnRlcmZhY2UnXG5leHBvcnQgKiBmcm9tICcuL2ZlYXR1cmUtc2VydmljZS1kYXRhLXNvdXJjZS1pbnRlcmZhY2UnXG5leHBvcnQgKiBmcm9tICcuL3NjZW5lLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW50ZXJmYWNlJ1xuZXhwb3J0ICogZnJvbSAnLi9tYXAtc2VydmljZS1kYXRhLXNvdXJjZS1pbnRlcmZhY2UnXG4iLCJpbXBvcnQgeyB0eXBlIENhcGFiaWxpdGllcywgdHlwZSBRdWVyeUNhcGFiaWxpdGllcyB9IGZyb20gJy4uL2ludGVyZmFjZXMnXG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIENhcGFiaWxpdGllc0NvbnN0cnVjdG9yT3B0aW9ucyB7fVxuXG5leHBvcnQgY2xhc3MgQ2FwYWJpbGl0aWVzSW1wbCBpbXBsZW1lbnRzIENhcGFiaWxpdGllcyB7XG4gIGNvbnN0cnVjdG9yIChvcHRpb25zOiBDYXBhYmlsaXRpZXNDb25zdHJ1Y3Rvck9wdGlvbnMpIHtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpXG4gIH1cblxuICBnZXRRdWVyeUNhcGFiaWxpdGllcyAoKTogUXVlcnlDYXBhYmlsaXRpZXMge1xuICAgIHJldHVybiB7XG4gICAgICBtYXhQYWdlU2l6ZTogbnVsbFxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJTURhdGFTb3VyY2VKc29uLCBJbW11dGFibGUsIGRhdGFTb3VyY2VVdGlscywgdHlwZSBEYXRhU291cmNlU2NoZW1hLCB0eXBlIFNlcnZpY2VEZWZpbml0aW9uIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBJSXRlbSwgdHlwZSBHZW9tZXRyeVR5cGUsIHR5cGUgSUxheWVyIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnXG5pbXBvcnQgeyBTdXBwb3J0ZWRJdGVtVHlwZXMsIEFsbERhdGFTb3VyY2VUeXBlcywgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLCBTdXBwb3J0ZWRTZXJ2ZXJUeXBlcywgU3VwcG9ydGVkTGF5ZXJTZXJ2aWNlVHlwZXMsIFN1cHBvcnRlZExheWVyVHlwZXNJbldlYk1hcFNwZWMgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvbW1vbi1kYXRhLXNvdXJjZS1pbnRlcmZhY2UnXG5cbmludGVyZmFjZSBMYXllckluV2ViTWFwU3BlYyBleHRlbmRzIElMYXllciB7XG4gIGxheWVyVHlwZTogU3VwcG9ydGVkTGF5ZXJUeXBlc0luV2ViTWFwU3BlY1xuICBsYXllckRlZmluaXRpb246IFNlcnZpY2VEZWZpbml0aW9uXG4gIGxheWVyczogTGF5ZXJJbldlYk1hcFNwZWNbXVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGF0YVNvdXJjZUpzb24gKGRzSWQ6IHN0cmluZywgbGF5ZXI6IF9fZXNyaS5MYXllciwgaXRlbUluZm86IHsgcG9ydGFsVXJsOiBzdHJpbmcsIGl0ZW0/OiBJSXRlbSwgZGF0YT86IGFueSB9LCBzZXJ2aWNlSW5mbzogeyB1cmw6IHN0cmluZywgbGF5ZXJEZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvbiB9LCBkc0pzb25JbkNvbmZpZz86IElNRGF0YVNvdXJjZUpzb24sIHNjaGVtYUluQ29uZmlnPzogSW1tdXRhYmxlLkltbXV0YWJsZU9iamVjdDxEYXRhU291cmNlU2NoZW1hPikge1xuICBpZiAobGF5ZXIpIHtcbiAgICByZXR1cm4gY3JlYXRlRGF0YVNvdXJjZUpzb25CeUpTQVBJTGF5ZXIoZHNJZCwgbGF5ZXIsIGRzSnNvbkluQ29uZmlnLCBzY2hlbWFJbkNvbmZpZylcbiAgfSBlbHNlIHtcbiAgICBsZXQgZHNKc29uRnJvbUl0ZW06IElNRGF0YVNvdXJjZUpzb25cbiAgICBsZXQgZHNKc29uRnJvbVNlcnZpY2U6IElNRGF0YVNvdXJjZUpzb25cbiAgICBpZiAoaXRlbUluZm8uZGF0YSkge1xuICAgICAgZHNKc29uRnJvbUl0ZW0gPSBjcmVhdGVEYXRhU291cmNlSnNvbkJ5SXRlbURhdGEoZHNJZCwgaXRlbUluZm8uZGF0YSwgaXRlbUluZm8ucG9ydGFsVXJsLCBkc0pzb25JbkNvbmZpZywgc2NoZW1hSW5Db25maWcpXG4gICAgfSBlbHNlIGlmIChpdGVtSW5mby5pdGVtKSB7XG4gICAgICBkc0pzb25Gcm9tSXRlbSA9IGNyZWF0ZURhdGFTb3VyY2VKc29uQnlJdGVtSW5mbyhkc0lkLCBpdGVtSW5mby5pdGVtLCBpdGVtSW5mby5wb3J0YWxVcmwsIGRzSnNvbkluQ29uZmlnLCBzY2hlbWFJbkNvbmZpZylcbiAgICB9XG4gICAgaWYgKHNlcnZpY2VJbmZvKSB7XG4gICAgICBkc0pzb25Gcm9tU2VydmljZSA9IGNyZWF0ZURhdGFTb3VyY2VKc29uQnlMYXllckRlZmluaXRpb24oZHNJZCwgc2VydmljZUluZm8ubGF5ZXJEZWZpbml0aW9uLCBzZXJ2aWNlSW5mby51cmwsIGRzSnNvbkluQ29uZmlnLCBzY2hlbWFJbkNvbmZpZylcbiAgICB9XG4gICAgcmV0dXJuIGRzSnNvbkZyb21JdGVtICYmIGRzSnNvbkZyb21TZXJ2aWNlID8gZHNKc29uRnJvbVNlcnZpY2UubWVyZ2UoZHNKc29uRnJvbUl0ZW0pIDogZHNKc29uRnJvbUl0ZW0gfHwgZHNKc29uRnJvbVNlcnZpY2VcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGF0YVNvdXJjZUpzb25CeUpTQVBJTGF5ZXIgKGRzSWQ6IHN0cmluZywgbGF5ZXI6IF9fZXNyaS5MYXllciwgZHNKc29uSW5Db25maWc/OiBJTURhdGFTb3VyY2VKc29uLCBzY2hlbWFJbkNvbmZpZz86IEltbXV0YWJsZS5JbW11dGFibGVPYmplY3Q8RGF0YVNvdXJjZVNjaGVtYT4pOiBJTURhdGFTb3VyY2VKc29uIHtcbiAgaWYgKCFkc0lkIHx8ICFsYXllcikge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBsZXQgZHNUeXBlOiBBbGxEYXRhU291cmNlVHlwZXNcbiAgbGV0IGxheWVySWQ6IHN0cmluZ1xuICBsZXQgZ2VvbWV0cnlUeXBlOiBHZW9tZXRyeVR5cGVcblxuICAvLyBsYXllciBzaG91bGQgYmUgbG9hZGVkLlxuICBjb25zdCBsYXllclR5cGUgPSBsYXllci50eXBlIGFzIFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlc1xuXG4gIHN3aXRjaCAobGF5ZXJUeXBlKSB7XG4gICAgY2FzZSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuR3JvdXBMYXllcjpcbiAgICAgIGRzVHlwZSA9IEFsbERhdGFTb3VyY2VUeXBlcy5Hcm91cExheWVyXG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLkZlYXR1cmVMYXllcjpcbiAgICAgIGRzVHlwZSA9IEFsbERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlTGF5ZXJcbiAgICAgIGxheWVySWQgPSBgJHsobGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllcikubGF5ZXJJZH1gXG4gICAgICBnZW9tZXRyeVR5cGUgPSAobGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllcikuc291cmNlSlNPTj8uZ2VvbWV0cnlUeXBlXG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLlNjZW5lTGF5ZXI6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuU2NlbmVMYXllclxuICAgICAgbGF5ZXJJZCA9IGAkeyhsYXllciBhcyBfX2VzcmkuU2NlbmVMYXllcikubGF5ZXJJZH1gXG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLk1hcEltYWdlTGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuVGlsZUxheWVyOlxuICAgICAgZHNUeXBlID0gQWxsRGF0YVNvdXJjZVR5cGVzLk1hcFNlcnZpY2VcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuQnVpbGRpbmdTY2VuZUxheWVyOlxuICAgICAgZHNUeXBlID0gQWxsRGF0YVNvdXJjZVR5cGVzLkJ1aWxkaW5nU2NlbmVMYXllclxuICAgICAgYnJlYWtcbiAgICBjYXNlIFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcy5CdWlsZGluZ0dyb3VwU3ViTGF5ZXI6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuQnVpbGRpbmdHcm91cFN1YkxheWVyXG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLkJ1aWxkaW5nQ29tcG9uZW50U3ViTGF5ZXI6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuQnVpbGRpbmdDb21wb25lbnRTdWJMYXllclxuICAgICAgYnJlYWtcbiAgICBjYXNlIFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcy5JbWFnZXJ5TGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuSW1hZ2VyeVRpbGVMYXllcjpcbiAgICBjYXNlIFN1cHBvcnRlZEpTQVBJTGF5ZXJUeXBlcy5WZWN0b3JUaWxlTGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuS01MTGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuQ1NWTGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRKU0FQSUxheWVyVHlwZXMuR2VvSlNPTkxheWVyOlxuICAgIGNhc2UgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLldGU0xheWVyOlxuICAgIGNhc2UgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLldNU0xheWVyOlxuICAgIGNhc2UgU3VwcG9ydGVkSlNBUElMYXllclR5cGVzLldNVFNMYXllcjpcbiAgICAgIGJyZWFrXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnN0IGV4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBsYXllclR5cGVcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5oYW5kbGVkIGNhc2U6ICR7ZXhoYXVzdGl2ZUNoZWNrfWApXG4gIH1cblxuICBsZXQgZHNKc29uOiBJTURhdGFTb3VyY2VKc29uXG4gIGlmIChkc1R5cGUpIHtcbiAgICBkc0pzb24gPSBJbW11dGFibGUoe1xuICAgICAgaWQ6IGRzSWQsXG4gICAgICB0eXBlOiBkc1R5cGUsXG4gICAgICBzb3VyY2VMYWJlbDogbGF5ZXIudGl0bGUgfHwgKGxheWVyIGFzIGFueSkuc291cmNlSlNPTj8ubmFtZVxuICAgIH0pXG4gICAgZHNKc29uID0gKGxheWVyIGFzIGFueSkudXJsID8gZHNKc29uLnNldCgndXJsJywgZGF0YVNvdXJjZVV0aWxzLmdldERhdGFTb3VyY2VTb3VyY2VVcmwoZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIobGF5ZXIpKSkgOiBkc0pzb25cbiAgICBkc0pzb24gPSAobGF5ZXIgYXMgYW55KS5wb3J0YWxJdGVtPy5pZCA/IGRzSnNvbi5zZXQoJ3BvcnRhbFVybCcsIChsYXllciBhcyBhbnkpLnBvcnRhbEl0ZW0ucG9ydGFsPy51cmwpLnNldCgnaXRlbUlkJywgKGxheWVyIGFzIGFueSkucG9ydGFsSXRlbS5pZCkgOiBkc0pzb25cbiAgICBkc0pzb24gPSAvXlxcZCskLy50ZXN0KGxheWVySWQpID8gZHNKc29uLnNldCgnbGF5ZXJJZCcsIGxheWVySWQpIDogZHNKc29uXG4gICAgZHNKc29uID0gZ2VvbWV0cnlUeXBlID8gZHNKc29uLnNldCgnZ2VvbWV0cnlUeXBlJywgZ2VvbWV0cnlUeXBlKSA6IGRzSnNvblxuICAgIGRzSnNvbiA9IGRzSnNvbkluQ29uZmlnID8gZHNKc29uLm1lcmdlKGRzSnNvbkluQ29uZmlnLndpdGhvdXQoJ2lkJyksIHsgZGVlcDogdHJ1ZSB9KSA6IGRzSnNvblxuICAgIGRzSnNvbiA9IHNjaGVtYUluQ29uZmlnID8gZHNKc29uLnNldCgnc2NoZW1hJywgc2NoZW1hSW5Db25maWcpIDogZHNKc29uXG4gIH1cblxuICByZXR1cm4gZHNKc29uXG59XG5cbi8qKlxuICogR2VuZXJhbGx5LCB3ZSBvbmx5IHVzZSB0aGlzIG1ldGhvZCB0byBnZXQgcmF3IGRhdGEgc291cmNlIGpzb24gdG8gZ2V0IGRhdGEgc291cmNlIHR5cGUgYW5kIGxhYmVsLlxuICogSXRlbSBpbmZvIG1pc3NlcyBzb21lIGluZm9ybWF0aW9uIHN1Y2ggYXMgZ2VvbWV0cnkgdHlwZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURhdGFTb3VyY2VKc29uQnlJdGVtSW5mbyAoZHNJZDogc3RyaW5nLCBpdGVtOiBJSXRlbSwgcG9ydGFsVXJsOiBzdHJpbmcsIGRzSnNvbkluQ29uZmlnPzogSU1EYXRhU291cmNlSnNvbiwgc2NoZW1hSW5Db25maWc/OiBJbW11dGFibGUuSW1tdXRhYmxlT2JqZWN0PERhdGFTb3VyY2VTY2hlbWE+KTogSU1EYXRhU291cmNlSnNvbiB7XG4gIGlmICghZHNJZCB8fCAhaXRlbSkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBsZXQgZHNUeXBlOiBBbGxEYXRhU291cmNlVHlwZXNcbiAgbGV0IGxheWVySWQ6IHN0cmluZ1xuICBsZXQgdXJsOiBzdHJpbmdcblxuICBjb25zdCBpdGVtVHlwZSA9IGl0ZW0udHlwZSBhcyBTdXBwb3J0ZWRJdGVtVHlwZXNcblxuICBzd2l0Y2ggKGl0ZW1UeXBlKSB7XG4gICAgY2FzZSBTdXBwb3J0ZWRJdGVtVHlwZXMuV2ViTWFwOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLldlYlNjZW5lOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLkNTVjpcbiAgICBjYXNlIFN1cHBvcnRlZEl0ZW1UeXBlcy5HZW9KU09OOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLktNTDpcbiAgICBjYXNlIFN1cHBvcnRlZEl0ZW1UeXBlcy5XRlM6XG4gICAgY2FzZSBTdXBwb3J0ZWRJdGVtVHlwZXMuV01TOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLldNVFM6XG4gICAgY2FzZSBTdXBwb3J0ZWRJdGVtVHlwZXMuR3JvdXBMYXllcjpcbiAgICAgIGRzVHlwZSA9IEFsbERhdGFTb3VyY2VUeXBlc1tmaW5kS2V5KFN1cHBvcnRlZEl0ZW1UeXBlcywgaXRlbVR5cGUpXVxuICAgICAgdXJsID0gaXRlbS51cmw/LnJlcGxhY2UoL15odHRwOi8sICdodHRwczonKS5yZXBsYWNlKC9cXC8kLywgJycpXG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLkZlYXR1cmVDb2xsZWN0aW9uOlxuICAgICAgaWYgKGl0ZW0udHlwZUtleXdvcmRzPy5pbmNsdWRlcygnU2luZ2xlbGF5ZXInKSkge1xuICAgICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuRmVhdHVyZUxheWVyXG4gICAgICAgIGxheWVySWQgPSAnMCdcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRzVHlwZSA9IEFsbERhdGFTb3VyY2VUeXBlcy5Hcm91cExheWVyXG4gICAgICB9XG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLkZlYXR1cmVTZXJ2aWNlOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLk1hcFNlcnZpY2U6XG4gICAgY2FzZSBTdXBwb3J0ZWRJdGVtVHlwZXMuU2NlbmVTZXJ2aWNlOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLkltYWdlU2VydmljZTpcbiAgICBjYXNlIFN1cHBvcnRlZEl0ZW1UeXBlcy5WZWN0b3JUaWxlU2VydmljZTpcbiAgICAgIGlmIChkYXRhU291cmNlVXRpbHMuaXNTdXBwb3J0ZWRXaG9sZUFyY0dJU1NlcnZpY2UoaXRlbS51cmwpKSB7XG4gICAgICAgIGRzVHlwZSA9IGdldERhdGFTb3VyY2VUeXBlRnJvbUFyY0dJU1dob2xlU2VydmljZVVybChpdGVtLnVybClcbiAgICAgIH0gZWxzZSBpZiAoZGF0YVNvdXJjZVV0aWxzLmlzU3VwcG9ydGVkU2luZ2xlQXJjR0lTTGF5ZXJTZXJ2aWNlKGl0ZW0udXJsKSkge1xuICAgICAgICBjb25zdCBzZXJ2aWNlVXJsID0gZGF0YVNvdXJjZVV0aWxzLmdldEZ1bGxBcmNHSVNTZXJ2aWNlVXJsKGl0ZW0udXJsLCBmYWxzZSlcbiAgICAgICAgY29uc3Qgc2VydmljZURzVHlwZSA9IGdldERhdGFTb3VyY2VUeXBlRnJvbUFyY0dJU1dob2xlU2VydmljZVVybChzZXJ2aWNlVXJsKVxuICAgICAgICBpZiAoc2VydmljZURzVHlwZSA9PT0gQWxsRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVTZXJ2aWNlIHx8IHNlcnZpY2VEc1R5cGUgPT09IEFsbERhdGFTb3VyY2VUeXBlcy5NYXBTZXJ2aWNlKSB7XG4gICAgICAgICAgZHNUeXBlID0gQWxsRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllclxuICAgICAgICB9IGVsc2UgaWYgKHNlcnZpY2VEc1R5cGUgPT09IEFsbERhdGFTb3VyY2VUeXBlcy5TY2VuZVNlcnZpY2UpIHtcbiAgICAgICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuU2NlbmVMYXllclxuICAgICAgICB9XG4gICAgICAgIGxheWVySWQgPSBkc1R5cGUgJiYgaXRlbS51cmw/LnJlcGxhY2UoL1xcLyQvLCAnJykuc3BsaXQoJy8nKS5yZXZlcnNlKClbMF1cbiAgICAgIH1cbiAgICAgIC8vIHVybCBvZiB2ZWN0b3IgdGlsZSBzZXJ2aWNlIG1heSBiZSBhIHN0eWxlIGpzb24gb3IgYSB2ZWN0b3IgdGlsZSBzZXJ2aWNlLCBzaG91bGQgbm90IHJlcGxhY2UgdXJsIHF1ZXJpZXMgKHN0cmluZyBhZnRlciAnPycpLlxuICAgICAgdXJsID0gZHNUeXBlID09PSBBbGxEYXRhU291cmNlVHlwZXMuVmVjdG9yVGlsZVNlcnZpY2UgPyBpdGVtLnVybD8ucmVwbGFjZSgvXmh0dHA6LywgJ2h0dHBzOicpLnJlcGxhY2UoL1xcLyQvLCAnJykgOiBpdGVtLnVybD8uc3BsaXQoJz8nKVswXS5yZXBsYWNlKC9eaHR0cDovLCAnaHR0cHM6JykucmVwbGFjZSgvXFwvJC8sICcnKVxuICAgICAgYnJlYWtcbiAgICBjYXNlIFN1cHBvcnRlZEl0ZW1UeXBlcy5HZW9jb2RpbmdTZXJ2aWNlOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLkdlb2VucmljaG1lbnRTZXJ2aWNlOlxuICAgIGNhc2UgU3VwcG9ydGVkSXRlbVR5cGVzLkdlb21ldHJ5U2VydmljZTpcbiAgICBjYXNlIFN1cHBvcnRlZEl0ZW1UeXBlcy5HZW9wcm9jZXNzaW5nU2VydmljZTpcbiAgICBjYXNlIFN1cHBvcnRlZEl0ZW1UeXBlcy5OZXR3b3JrQW5hbHlzaXNTZXJ2aWNlOlxuICAgICAgYnJlYWtcbiAgICBkZWZhdWx0OlxuICAgICAgY29uc3QgZXhoYXVzdGl2ZUNoZWNrOiBuZXZlciA9IGl0ZW1UeXBlXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCBjYXNlOiAke2V4aGF1c3RpdmVDaGVja31gKVxuICB9XG5cbiAgbGV0IGRzSnNvbjogSU1EYXRhU291cmNlSnNvblxuICBpZiAoZHNUeXBlKSB7XG4gICAgZHNKc29uID0gSW1tdXRhYmxlKHtcbiAgICAgIGlkOiBkc0lkLFxuICAgICAgdHlwZTogZHNUeXBlLFxuICAgICAgc291cmNlTGFiZWw6IGl0ZW0udGl0bGVcbiAgICB9KVxuICAgIGRzSnNvbiA9IGRzSnNvbi5zZXQoJ2l0ZW1JZCcsIGl0ZW0uaWQpXG4gICAgZHNKc29uID0gZHNKc29uLnNldCgncG9ydGFsVXJsJywgcG9ydGFsVXJsKVxuICAgIGRzSnNvbiA9IC9eXFxkKyQvLnRlc3QobGF5ZXJJZCkgPyBkc0pzb24uc2V0KCdsYXllcklkJywgbGF5ZXJJZCkgOiBkc0pzb25cbiAgICBkc0pzb24gPSB1cmwgPyBkc0pzb24uc2V0KCd1cmwnLCB1cmwpIDogZHNKc29uXG4gICAgZHNKc29uID0gZHNKc29uSW5Db25maWcgPyBkc0pzb24ubWVyZ2UoZHNKc29uSW5Db25maWcud2l0aG91dCgnaWQnKSwgeyBkZWVwOiB0cnVlIH0pIDogZHNKc29uXG4gICAgZHNKc29uID0gc2NoZW1hSW5Db25maWcgPyBkc0pzb24uc2V0KCdzY2hlbWEnLCBzY2hlbWFJbkNvbmZpZykgOiBkc0pzb25cbiAgfVxuXG4gIHJldHVybiBkc0pzb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURhdGFTb3VyY2VKc29uQnlJdGVtRGF0YSAoZHNJZDogc3RyaW5nLCBpdGVtRGF0YTogYW55LCBwb3J0YWxVcmw6IHN0cmluZywgZHNKc29uSW5Db25maWc/OiBJTURhdGFTb3VyY2VKc29uLCBzY2hlbWFJbkNvbmZpZz86IEltbXV0YWJsZS5JbW11dGFibGVPYmplY3Q8RGF0YVNvdXJjZVNjaGVtYT4pOiBJTURhdGFTb3VyY2VKc29uIHtcbiAgaWYgKCFkc0lkIHx8ICFpdGVtRGF0YSkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBsZXQgZHNUeXBlOiBBbGxEYXRhU291cmNlVHlwZXNcbiAgbGV0IGxheWVySWQ6IHN0cmluZ1xuXG4gIC8vIEdlbmVyYWwgaXRlbSBkYXRhIGRvZXNuJ3QgaGF2ZSBhIHNwZWNpZmljIGludGVyZmFjZSwgYnV0IHRoZSBsYXllcnMgd2Ugc3VwcG9ydGVkIGRvZXMsIHdlIGFzc3VtZSB0aGUgaXRlbSBkYXRhIGlzIHRoZSB0eXBlIHdoaWNoIHdlIHN1cHBvcnQuXG4gIGNvbnN0IGRhdGEgPSBpdGVtRGF0YSBhcyBMYXllckluV2ViTWFwU3BlY1xuICBjb25zdCBpdGVtVHlwZSA9IGRhdGEubGF5ZXJUeXBlXG5cbiAgc3dpdGNoIChpdGVtVHlwZSkge1xuICAgIGNhc2UgU3VwcG9ydGVkTGF5ZXJUeXBlc0luV2ViTWFwU3BlYy5GZWF0dXJlTGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLlNjZW5lTGF5ZXI6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXNbZmluZEtleShTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLCBpdGVtVHlwZSldXG4gICAgICBsYXllcklkID0gZGF0YS51cmw/LnJlcGxhY2UoL1xcLyQvLCAnJykuc3BsaXQoJy8nKS5yZXZlcnNlKClbMF1cbiAgICAgIGJyZWFrXG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLkdyb3VwTGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLk1hcFNlcnZpY2U6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXNbZmluZEtleShTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLCBpdGVtVHlwZSldXG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkTGF5ZXJUeXBlc0luV2ViTWFwU3BlYy5UaWxlZE1hcFNlcnZpY2U6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuTWFwU2VydmljZVxuICAgICAgYnJlYWtcbiAgICBjYXNlIFN1cHBvcnRlZExheWVyVHlwZXNJbldlYk1hcFNwZWMuVmVjdG9yVGlsZVNlcnZpY2U6XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLkltYWdlU2VydmljZTpcbiAgICBjYXNlIFN1cHBvcnRlZExheWVyVHlwZXNJbldlYk1hcFNwZWMuVGlsZWRJbWFnZVNlcnZpY2U6XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLkNTVjpcbiAgICBjYXNlIFN1cHBvcnRlZExheWVyVHlwZXNJbldlYk1hcFNwZWMuR2VvSlNPTjpcbiAgICBjYXNlIFN1cHBvcnRlZExheWVyVHlwZXNJbldlYk1hcFNwZWMuS01MOlxuICAgIGNhc2UgU3VwcG9ydGVkTGF5ZXJUeXBlc0luV2ViTWFwU3BlYy5XRlM6XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclR5cGVzSW5XZWJNYXBTcGVjLldNUzpcbiAgICAgIGJyZWFrXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnN0IGV4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBpdGVtVHlwZVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmhhbmRsZWQgY2FzZTogJHtleGhhdXN0aXZlQ2hlY2t9YClcbiAgfVxuXG4gIGxldCBkc0pzb246IElNRGF0YVNvdXJjZUpzb25cbiAgaWYgKGRzVHlwZSkge1xuICAgIGRzSnNvbiA9IEltbXV0YWJsZSh7XG4gICAgICBpZDogZHNJZCxcbiAgICAgIHR5cGU6IGRzVHlwZSxcbiAgICAgIHNvdXJjZUxhYmVsOiBkYXRhLnRpdGxlXG4gICAgfSlcbiAgICBkc0pzb24gPSBkc0pzb24uc2V0KCdpdGVtSWQnLCBkYXRhLml0ZW1JZClcbiAgICBkc0pzb24gPSBkc0pzb24uc2V0KCdwb3J0YWxVcmwnLCBwb3J0YWxVcmwpXG4gICAgZHNKc29uID0gL15cXGQrJC8udGVzdChsYXllcklkKSA/IGRzSnNvbi5zZXQoJ2xheWVySWQnLCBsYXllcklkKSA6IGRzSnNvblxuICAgIGRzSnNvbiA9IGRhdGEudXJsID8gZHNKc29uLnNldCgndXJsJywgZGF0YS51cmwucmVwbGFjZSgvXmh0dHA6LywgJ2h0dHBzOicpLnJlcGxhY2UoL1xcLyQvLCAnJykpIDogZHNKc29uXG4gICAgZHNKc29uID0gZHNKc29uSW5Db25maWcgPyBkc0pzb24ubWVyZ2UoZHNKc29uSW5Db25maWcud2l0aG91dCgnaWQnKSwgeyBkZWVwOiB0cnVlIH0pIDogZHNKc29uXG4gICAgZHNKc29uID0gc2NoZW1hSW5Db25maWcgPyBkc0pzb24uc2V0KCdzY2hlbWEnLCBzY2hlbWFJbkNvbmZpZykgOiBkc0pzb25cbiAgfVxuXG4gIHJldHVybiBkc0pzb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURhdGFTb3VyY2VKc29uQnlMYXllckRlZmluaXRpb24gKGRzSWQ6IHN0cmluZywgbGF5ZXJEZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvbiwgdXJsOiBzdHJpbmcsIGRzSnNvbkluQ29uZmlnPzogSU1EYXRhU291cmNlSnNvbiwgc2NoZW1hSW5Db25maWc/OiBJbW11dGFibGUuSW1tdXRhYmxlT2JqZWN0PERhdGFTb3VyY2VTY2hlbWE+KTogSU1EYXRhU291cmNlSnNvbiB7XG4gIGlmICghZHNJZCB8fCAhbGF5ZXJEZWZpbml0aW9uKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGNvbnN0IGxheWVyVXJsID0gZGF0YVNvdXJjZVV0aWxzLmdldEZ1bGxBcmNHSVNTZXJ2aWNlVXJsKHVybCwgdHJ1ZSwgbGF5ZXJEZWZpbml0aW9uKVxuICBjb25zdCBsYXllclNvdXJjZVVybCA9IGRhdGFTb3VyY2VVdGlscy5nZXREYXRhU291cmNlU291cmNlVXJsKGxheWVyVXJsKVxuXG4gIGxldCBkc0pzb246IElNRGF0YVNvdXJjZUpzb25cbiAgaWYgKGRhdGFTb3VyY2VVdGlscy5pc1N1cHBvcnRlZFdob2xlQXJjR0lTU2VydmljZShsYXllclNvdXJjZVVybCkpIHtcbiAgICBkc0pzb24gPSBjcmVhdGVEYXRhU291cmNlSnNvbkJ5V2hvbGVTZXJ2aWNlRGVmaW5pdGlvbihkc0lkLCBsYXllclNvdXJjZVVybCwgbGF5ZXJEZWZpbml0aW9uKVxuICB9IGVsc2UgaWYgKCFsYXllclNvdXJjZVVybCB8fCBkYXRhU291cmNlVXRpbHMuaXNTdXBwb3J0ZWRTaW5nbGVBcmNHSVNMYXllclNlcnZpY2UobGF5ZXJTb3VyY2VVcmwpKSB7IC8vIEZlYXR1cmUgY29sbGVjdGlvbiBpdGVtIGRvZXMgbm90IGhhdmUgdXJsIGJ1dCBoYXMgbGF5ZXIgZGVmbml0aW9uICh2aWEgaXRlbSBkYXRhKS5cbiAgICBkc0pzb24gPSBjcmVhdGVEYXRhU291cmNlSnNvbkJ5U2luZ2xlTGF5ZXJEZWZpbml0aW9uKGRzSWQsIGxheWVyU291cmNlVXJsLCBsYXllckRlZmluaXRpb24pXG4gIH1cblxuICBkc0pzb24gPSBkc0pzb25JbkNvbmZpZyAmJiBkc0pzb24gPyBkc0pzb24ubWVyZ2UoZHNKc29uSW5Db25maWcud2l0aG91dCgnaWQnKSwgeyBkZWVwOiB0cnVlIH0pIDogZHNKc29uXG4gIGRzSnNvbiA9IHNjaGVtYUluQ29uZmlnICYmIGRzSnNvbiA/IGRzSnNvbi5zZXQoJ3NjaGVtYScsIHNjaGVtYUluQ29uZmlnKSA6IGRzSnNvblxuXG4gIHJldHVybiBkc0pzb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGFTb3VyY2VUeXBlRnJvbUFyY0dJU1dob2xlU2VydmljZVVybCAodXJsOiBzdHJpbmcpOiBBbGxEYXRhU291cmNlVHlwZXMge1xuICBpZiAoIWRhdGFTb3VyY2VVdGlscy5pc1N1cHBvcnRlZFdob2xlQXJjR0lTU2VydmljZSh1cmwpKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGNvbnN0IHVybEFycmF5ID0gdXJsLnNwbGl0KCc/JylbMF0uc3BsaXQoJy8nKVxuICBjb25zdCBzZXJ2aWNlVHlwZSA9IE9iamVjdC52YWx1ZXMoU3VwcG9ydGVkU2VydmVyVHlwZXMpLmZpbmQocyA9PiB1cmxBcnJheS5zb21lKHUgPT4gcy50b0xvd2VyQ2FzZSgpID09PSB1LnRvTG93ZXJDYXNlKCkpKVxuXG4gIGxldCBkc1R5cGU6IEFsbERhdGFTb3VyY2VUeXBlc1xuXG4gIHN3aXRjaCAoc2VydmljZVR5cGUpIHtcbiAgICBjYXNlIFN1cHBvcnRlZFNlcnZlclR5cGVzLkZlYXR1cmVTZXJ2aWNlOlxuICAgIGNhc2UgU3VwcG9ydGVkU2VydmVyVHlwZXMuTWFwU2VydmljZTpcbiAgICBjYXNlIFN1cHBvcnRlZFNlcnZlclR5cGVzLlNjZW5lU2VydmljZTpcbiAgICBjYXNlIFN1cHBvcnRlZFNlcnZlclR5cGVzLkltYWdlU2VydmljZTpcbiAgICBjYXNlIFN1cHBvcnRlZFNlcnZlclR5cGVzLlZlY3RvclRpbGVTZXJ2aWNlOlxuICAgICAgZHNUeXBlID0gQWxsRGF0YVNvdXJjZVR5cGVzW2ZpbmRLZXkoU3VwcG9ydGVkU2VydmVyVHlwZXMsIHNlcnZpY2VUeXBlKV1cbiAgICAgIGJyZWFrXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnN0IGV4aGF1c3RpdmVDaGVjazogbmV2ZXIgPSBzZXJ2aWNlVHlwZVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmhhbmRsZWQgY2FzZTogJHtleGhhdXN0aXZlQ2hlY2t9YClcbiAgfVxuXG4gIHJldHVybiBkc1R5cGVcbn1cblxuZnVuY3Rpb24gY3JlYXRlRGF0YVNvdXJjZUpzb25CeVdob2xlU2VydmljZURlZmluaXRpb24gKGRzSWQ6IHN0cmluZywgdXJsOiBzdHJpbmcsIHNlcnZpY2VEZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvbik6IElNRGF0YVNvdXJjZUpzb24ge1xuICBpZiAoIWRzSWQgfHwgIXVybCB8fCAhc2VydmljZURlZmluaXRpb24pIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgY29uc3QgdHlwZSA9IGdldERhdGFTb3VyY2VUeXBlRnJvbUFyY0dJU1dob2xlU2VydmljZVVybCh1cmwpXG4gIGlmICghdHlwZSkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBjb25zdCBkc0pzb246IElNRGF0YVNvdXJjZUpzb24gPSBJbW11dGFibGUoe1xuICAgIGlkOiBkc0lkLFxuICAgIHR5cGUsXG4gICAgdXJsOiBkYXRhU291cmNlVXRpbHMuZ2V0RnVsbEFyY0dJU1NlcnZpY2VVcmwodXJsLCBmYWxzZSksXG4gICAgc291cmNlTGFiZWw6IGRhdGFTb3VyY2VVdGlscy5nZXRMYWJlbEZyb21BcmNHSVNTZXJ2aWNlVXJsKHVybClcbiAgfSlcblxuICByZXR1cm4gZHNKc29uXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZURhdGFTb3VyY2VKc29uQnlTaW5nbGVMYXllckRlZmluaXRpb24gKGRzSWQ6IHN0cmluZywgdXJsOiBzdHJpbmcsIGxheWVyRGVmaW5pdGlvbjogU2VydmljZURlZmluaXRpb24pOiBJTURhdGFTb3VyY2VKc29uIHtcbiAgaWYgKCFkc0lkIHx8ICFsYXllckRlZmluaXRpb24pIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgbGV0IGRzVHlwZTogQWxsRGF0YVNvdXJjZVR5cGVzXG4gIGNvbnN0IGxheWVyVHlwZSA9IChsYXllckRlZmluaXRpb24udHlwZSB8fCBsYXllckRlZmluaXRpb24ubGF5ZXJUeXBlKSBhcyBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlc1xuXG4gIHN3aXRjaCAobGF5ZXJUeXBlKSB7XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5Hcm91cExheWVyOlxuICAgICAgZHNUeXBlID0gQWxsRGF0YVNvdXJjZVR5cGVzLkdyb3VwTGF5ZXJcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5GZWF0dXJlTGF5ZXI6XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5UYWJsZTpcbiAgICAgIGRzVHlwZSA9IEFsbERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlTGF5ZXJcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5TY2VuZUxheWVyM0RPYmplY3Q6XG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5TY2VuZUxheWVyUG9pbnQ6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuU2NlbmVMYXllclxuICAgICAgYnJlYWtcbiAgICBjYXNlIFN1cHBvcnRlZExheWVyU2VydmljZVR5cGVzLkJ1aWxkaW5nU2NlbmVMYXllcjpcbiAgICAgIGRzVHlwZSA9IEFsbERhdGFTb3VyY2VUeXBlcy5CdWlsZGluZ1NjZW5lTGF5ZXJcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5CdWlsZGluZ0dyb3VwU3ViTGF5ZXI6XG4gICAgICBkc1R5cGUgPSBBbGxEYXRhU291cmNlVHlwZXMuQnVpbGRpbmdHcm91cFN1YkxheWVyXG4gICAgICBicmVha1xuICAgIGNhc2UgU3VwcG9ydGVkTGF5ZXJTZXJ2aWNlVHlwZXMuQnVpbGRpbmdDb21wb25lbnRTdWJMYXllcjpcbiAgICAgIGRzVHlwZSA9IEFsbERhdGFTb3VyY2VUeXBlcy5CdWlsZGluZ0NvbXBvbmVudFN1YkxheWVyXG4gICAgICBicmVha1xuICAgIGRlZmF1bHQ6XG4gICAgICBjb25zdCBleGhhdXN0aXZlQ2hlY2s6IG5ldmVyID0gbGF5ZXJUeXBlXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCBjYXNlOiAke2V4aGF1c3RpdmVDaGVja31gKVxuICB9XG5cbiAgbGV0IGRzSnNvbjogSU1EYXRhU291cmNlSnNvblxuICBpZiAoZHNUeXBlKSB7XG4gICAgZHNKc29uID0gSW1tdXRhYmxlKHtcbiAgICAgIGlkOiBkc0lkLFxuICAgICAgdHlwZTogZHNUeXBlLFxuICAgICAgc291cmNlTGFiZWw6IGxheWVyRGVmaW5pdGlvbi5uYW1lXG4gICAgfSlcbiAgICBkc0pzb24gPSB1cmwgPyBkc0pzb24uc2V0KCd1cmwnLCBkYXRhU291cmNlVXRpbHMuZ2V0RnVsbEFyY0dJU1NlcnZpY2VVcmwodXJsLCB0cnVlLCBsYXllckRlZmluaXRpb24pKSA6IGRzSnNvblxuICAgIGRzSnNvbiA9IC9eXFxkKyQvLnRlc3QoYCR7bGF5ZXJEZWZpbml0aW9uLmlkfWApID8gZHNKc29uLnNldCgnbGF5ZXJJZCcsIGAke2xheWVyRGVmaW5pdGlvbi5pZH1gKSA6IGRzSnNvblxuICAgIGRzSnNvbiA9IGxheWVyRGVmaW5pdGlvbi5nZW9tZXRyeVR5cGUgPyBkc0pzb24uc2V0KCdnZW9tZXRyeVR5cGUnLCBsYXllckRlZmluaXRpb24uZ2VvbWV0cnlUeXBlKSA6IGRzSnNvblxuICB9XG5cbiAgcmV0dXJuIGRzSnNvblxufVxuXG5mdW5jdGlvbiBmaW5kS2V5IDxUIGV4dGVuZHMgb2JqZWN0LCBLIGV4dGVuZHMga2V5b2YgVD4gKG9iajogVCwgdmFsdWU6IFRbS10pOiBLIHtcbiAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKG9iaikuZmluZCgoW2ssIHZdKSA9PiB2ID09PSB2YWx1ZSk/LlswXSBhcyBLXG59XG4iLCJpbXBvcnQgeyB0eXBlIFNlcnZpY2VEZWZpbml0aW9uIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBGZWF0dXJlTGF5ZXJDYXBhYmlsaXRpZXMsIHR5cGUgRmVhdHVyZUxheWVyUXVlcnlDYXBhYmlsaXRpZXMgfSBmcm9tICcuLi9pbnRlcmZhY2VzJ1xuaW1wb3J0IHsgQ2FwYWJpbGl0aWVzSW1wbCwgdHlwZSBDYXBhYmlsaXRpZXNDb25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICcuL2NhcGFiaWxpdGllcy1pbXBsJ1xuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVMYXllckNhcGFiaWxpdGllc0NvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIENhcGFiaWxpdGllc0NvbnN0cnVjdG9yT3B0aW9ucyB7XG4gIGxheWVyRGVmaW5pdGlvbjogU2VydmljZURlZmluaXRpb25cbiAgLy8gRGF0YSBpcyBzYXZlZCBpbiBkYXRhIHNvdXJjZSBpbnN0YW5jZSwgb3IgaXMgZmVhdHVyZSBjb2xsZWN0aW9uLlxuICBpc0NsaWVudFNpZGU6IGJvb2xlYW5cbiAgLy8gVE9ETzogbmVlZCBpdGVtIGlkIHRvIGdldCBvdGhlciBjYXBhYmlsaXRpZXMuXG59XG5cbmNvbnN0IFF1ZXJ5Q2FwYWJpbGl0aWVzT2ZDbGllbnRTaWRlRmVhdHVyZUxheWVyID0ge1xuICBtYXhQYWdlU2l6ZTogMTAwMCxcbiAgc3VwcG9ydHNTdGF0aXN0aWNzOiB0cnVlLFxuICBzdXBwb3J0c1BhZ2luYXRpb246IHRydWUsXG4gIHN1cHBvcnRzT3JkZXJCeTogdHJ1ZSxcbiAgc3VwcG9ydHNEaXN0aW5jdDogdHJ1ZSxcbiAgLyoqXG4gICAqIFN1cHBvcnQgcGFnaW5hdGlvbiB3aXRoIGRpc3RpbmN0LlxuICAgKi9cbiAgc3VwcG9ydHNQYWdpbmF0aW9uT25EaXN0aW5jdDogdHJ1ZSxcbiAgLyoqXG4gICAqIERvIG5vdCBzdXBwb3J0IHBhZ2luYXRpb24gd2l0aCBzdGF0aXN0aWMgd2l0aCBncm91cCBieS5cbiAgICogV2lsbCBpZ25vcmUgdGhlIHBhZ2luYXRpb24gYW5kIGFsd2F5cyByZXR1cm4gYWxsIHJlc3VsdHMuXG4gICAqL1xuICBzdXBwb3J0c1BhZ2luYXRpb25PblN0YXRpc3RpY3NXaXRoR3JvdXBCeTogZmFsc2UsXG4gIHN1cHBvcnRzUGFnaW5hdGlvbk9uQWdncmVnYXRlZFF1ZXJpZXM6IHRydWUsXG4gIHN1cHBvcnRzT3JkZXJCeU9ubHlPbkxheWVyRmllbGRzOiB0cnVlLFxuICBzdXBwb3J0c1BlcmNlbnRpbGVTdGF0aXN0aWNzOiB0cnVlLFxuICBzdXBwb3J0ZWRRdWVyeUZvcm1hdHM6ICdKU09OLCBnZW9KU09OJ1xufVxuXG5leHBvcnQgY2xhc3MgRmVhdHVyZUxheWVyQ2FwYWJpbGl0aWVzSW1wbCBleHRlbmRzIENhcGFiaWxpdGllc0ltcGwgaW1wbGVtZW50cyBGZWF0dXJlTGF5ZXJDYXBhYmlsaXRpZXMge1xuICBwcml2YXRlIHJlYWRvbmx5IGxheWVyRGVmaW5pdGlvbjogU2VydmljZURlZmluaXRpb25cbiAgcHJpdmF0ZSByZWFkb25seSBpc0NsaWVudFNpZGU6IGJvb2xlYW5cblxuICBnZXRRdWVyeUNhcGFiaWxpdGllcyAoKTogRmVhdHVyZUxheWVyUXVlcnlDYXBhYmlsaXRpZXMge1xuICAgIGlmICh0aGlzLmlzQ2xpZW50U2lkZSB8fCAhdGhpcy5sYXllckRlZmluaXRpb24pIHtcbiAgICAgIHJldHVybiBRdWVyeUNhcGFiaWxpdGllc09mQ2xpZW50U2lkZUZlYXR1cmVMYXllclxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtYXhQYWdlU2l6ZTogdGhpcy5sYXllckRlZmluaXRpb24ubWF4UmVjb3JkQ291bnQsXG4gICAgICAgIHN1cHBvcnRzU3RhdGlzdGljczogISF0aGlzLmxheWVyRGVmaW5pdGlvbi5hZHZhbmNlZFF1ZXJ5Q2FwYWJpbGl0aWVzPy5zdXBwb3J0c1N0YXRpc3RpY3MsXG4gICAgICAgIHN1cHBvcnRzUGFnaW5hdGlvbjogISF0aGlzLmxheWVyRGVmaW5pdGlvbi5hZHZhbmNlZFF1ZXJ5Q2FwYWJpbGl0aWVzPy5zdXBwb3J0c1BhZ2luYXRpb24sXG4gICAgICAgIHN1cHBvcnRzT3JkZXJCeTogISF0aGlzLmxheWVyRGVmaW5pdGlvbi5hZHZhbmNlZFF1ZXJ5Q2FwYWJpbGl0aWVzPy5zdXBwb3J0c09yZGVyQnksXG4gICAgICAgIHN1cHBvcnRzRGlzdGluY3Q6ICEhdGhpcy5sYXllckRlZmluaXRpb24uYWR2YW5jZWRRdWVyeUNhcGFiaWxpdGllcz8uc3VwcG9ydHNEaXN0aW5jdCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHVuZGVmaW5lZCB3aWxsIGJlIHJlZ2FyZGVkIGFzIHRydWUgc2luY2Ugc29tZSBzZXJ2aWNlcyBkbyBub3QgaGF2ZSB0aGlzIGNhcGFiaWxpdHkgYnV0IHN1cHBvcnQgdG8gdXNlIHBhZ2luYXRpb24gd2l0aCBkaXN0aW5jdC5cbiAgICAgICAgICovXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICBzdXBwb3J0c1BhZ2luYXRpb25PbkRpc3RpbmN0OiB0aGlzLmxheWVyRGVmaW5pdGlvbi5hZHZhbmNlZFF1ZXJ5Q2FwYWJpbGl0aWVzPy5zdXBwb3J0c1BhZ2luYXRpb25PbkFnZ3JlZ2F0ZWRRdWVyaWVzICE9PSBmYWxzZSxcbiAgICAgICAgc3VwcG9ydHNQYWdpbmF0aW9uT25TdGF0aXN0aWNzV2l0aEdyb3VwQnk6ICEhdGhpcy5sYXllckRlZmluaXRpb24uYWR2YW5jZWRRdWVyeUNhcGFiaWxpdGllcz8uc3VwcG9ydHNQYWdpbmF0aW9uT25BZ2dyZWdhdGVkUXVlcmllcyxcbiAgICAgICAgc3VwcG9ydHNPcmRlckJ5T25seU9uTGF5ZXJGaWVsZHM6ICEhdGhpcy5sYXllckRlZmluaXRpb24uYWR2YW5jZWRRdWVyeUNhcGFiaWxpdGllcz8uc3VwcG9ydHNPcmRlckJ5T25seU9uTGF5ZXJGaWVsZHMsXG4gICAgICAgIHN1cHBvcnRzUGVyY2VudGlsZVN0YXRpc3RpY3M6ICEhdGhpcy5sYXllckRlZmluaXRpb24uYWR2YW5jZWRRdWVyeUNhcGFiaWxpdGllcz8uc3VwcG9ydHNQZXJjZW50aWxlU3RhdGlzdGljcyxcbiAgICAgICAgc3VwcG9ydGVkUXVlcnlGb3JtYXRzOiB0aGlzLmxheWVyRGVmaW5pdGlvbi5zdXBwb3J0ZWRRdWVyeUZvcm1hdHNcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9qaW11X2NvcmVfXzsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7IEppbXVDb3JlRGF0YVNvdXJjZUZhY3RvcnkgfSBmcm9tICcuL2xpYi9kYXRhLXNvdXJjZXMnXG5cbmV4cG9ydCBkZWZhdWx0IEppbXVDb3JlRGF0YVNvdXJjZUZhY3RvcnlcblxuZXhwb3J0ICogZnJvbSAnLi9saWIvZGF0YS1zb3VyY2VzJ1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9