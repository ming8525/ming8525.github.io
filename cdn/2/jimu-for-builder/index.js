System.register(["jimu-core","jimu-core/react","jimu-theme","jimu-layouts/layout-runtime","jimu-for-builder/templates","jimu-ui","jimu-for-builder"], function(__WEBPACK_DYNAMIC_EXPORT__, __system_context__) {
	var __WEBPACK_EXTERNAL_MODULE_jimu_core__ = {};
	var __WEBPACK_EXTERNAL_MODULE_react__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_theme__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_layouts_layout_runtime__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_for_builder_templates__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_ui__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_for_builder__ = {};
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_core__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_react__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_theme__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_layouts_layout_runtime__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_for_builder_templates__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_ui__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_for_builder__, "__esModule", { value: true });
	return {
		setters: [
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_core__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_react__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_theme__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_layouts_layout_runtime__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_for_builder_templates__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_ui__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_for_builder__[key] = module[key];
				});
			}
		],
		execute: function() {
			__WEBPACK_DYNAMIC_EXPORT__(
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./jimu-icons/svg/outlined/application/dialog.svg":
/*!********************************************************!*\
  !*** ./jimu-icons/svg/outlined/application/dialog.svg ***!
  \********************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 12 12\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M.007.883A1 1 0 0 1 1 0h10l.117.007A1 1 0 0 1 12 1v7l-.007.117A1 1 0 0 1 11 9H4l-4 3V1zM11 1H1v9l2.667-2H11zM3 3.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5M3.5 5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1z\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/application/folder.svg":
/*!********************************************************!*\
  !*** ./jimu-icons/svg/outlined/application/folder.svg ***!
  \********************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 16\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M1.333 0h4c.737 0 1.334.597 1.334 1.333v1.334h8C15.403 2.667 16 3.264 16 4v10.667c0 .736-.597 1.333-1.333 1.333H1.333A1.333 1.333 0 0 1 0 14.667V1.333C0 .597.597 0 1.333 0m0 7.333v7.334h13.334V7.333zm0-1.333h13.334V4H5.334V1.335h-4z\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/screen-group.svg":
/*!********************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/screen-group.svg ***!
  \********************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 16\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M2 2h12v4H2zM1 7V1h14v6zm1 3h12v4H2zm-1 5V9h14v6z\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/screen.svg":
/*!**************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/screen.svg ***!
  \**************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 16\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M2 2h12v12H2zM1 15V1h14v14zm4-9h6v4H5zm-1 5V5h8v6z\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/widget-column.svg":
/*!*********************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/widget-column.svg ***!
  \*********************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 20 20\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M17 2a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2zM5 1h10a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m2 2h6v6H7zm0 8h1v2H7zm2 0h1v1H9zm4 2h-1v1h1zm-6 1h1v1H7zm4 2h-1v1h1zm1-1h1v2h-1zm-3 2v-1H7v1zm2-6h2v1h-2z\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/widget-fixed-panel.svg":
/*!**************************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/widget-fixed-panel.svg ***!
  \**************************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 20 20\"><path fill=\"#000\" d=\"M3 3h7v7H3zM11 11h1v2h-1zM13 11h1v1h-1zM17 13h-1v1h1zM11 14h1v1h-1zM15 16h-1v1h1zM16 15h1v2h-1zM13 17v-1h-2v1zM15 11h2v1h-2z\"></path><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M20 2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2zM2 1h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/widget-place-holder.svg":
/*!***************************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/widget-place-holder.svg ***!
  \***************************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 20 20\"><path fill=\"#000\" d=\"M4 4h2v1H4zM8 4h2v1H8zM14 4h-2v1h2zM15 4h1v2h-1zM16 8h-1v2h1zM4 14h1v2H4zM5 6H4v2h1zM4 10h1v2H4zM16 12h-1v2h1zM16 15v1h-2v-1zM12 15h-2v1h2zM6 15h2v1H6z\"></path><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/widget-row.svg":
/*!******************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/widget-row.svg ***!
  \******************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 20 20\"><path fill=\"#000\" d=\"M3 7h6v6H3zM11 7h1v2h-1zM13 7h1v1h-1zM17 9h-1v1h1zM11 10h1v1h-1zM15 12h-1v1h1zM16 11h1v2h-1zM13 13v-1h-2v1zM15 7h2v1h-2z\"></path><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M20 5a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2zM2 4h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/widget-section-view.svg":
/*!***************************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/widget-section-view.svg ***!
  \***************************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 20 20\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M1.25 2.5h17.5v11.25H1.25zM0 2.5c0-.69.56-1.25 1.25-1.25h17.5c.69 0 1.25.56 1.25 1.25v11.25c0 .69-.56 1.25-1.25 1.25H1.25C.56 15 0 14.44 0 13.75zm3.75 16.25h2.5V17.5h-2.5zm7.5 0h-2.5V17.5h2.5zm2.5 0h2.5V17.5h-2.5z\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/brand/widget-section.svg":
/*!**********************************************************!*\
  !*** ./jimu-icons/svg/outlined/brand/widget-section.svg ***!
  \**********************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 20 20\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M14 2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2zM2 1h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1\" clip-rule=\"evenodd\"></path><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M20 8a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2zM8 7h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/data/link-combined.svg":
/*!********************************************************!*\
  !*** ./jimu-icons/svg/outlined/data/link-combined.svg ***!
  \********************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 12 40\"><path fill=\"#A8A8A8\" fill-rule=\"evenodd\" d=\"M6 30v10H0v-1h5v-9zM3.162 18.582a.5.5 0 0 1 0 .71l-1.416 1.421a2.497 2.497 0 0 0-.003 3.545c.983.983 2.56.98 3.544-.003l1.42-1.42a.504.504 0 0 1 .712.713L6 24.968a3.502 3.502 0 0 1-4.967 0 3.501 3.501 0 0 1 0-4.967l1.416-1.422a.504.504 0 0 1 .713.003m4.967-.71a.5.5 0 0 1 0 .71L4.58 22.129a.504.504 0 0 1-.713-.712l3.548-3.548a.504.504 0 0 1 .713.003m2.838-2.838a3.501 3.501 0 0 1 0 4.967l-1.42 1.419a.504.504 0 0 1-.713-.712l1.423-1.417a2.5 2.5 0 0 0 0-3.547 2.502 2.502 0 0 0-3.547 0l-1.42 1.419a.504.504 0 0 1-.713-.712l1.42-1.42a3.506 3.506 0 0 1 4.97.003M6 0v10H5V1H0V0z\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/data/link-tilted.svg":
/*!******************************************************!*\
  !*** ./jimu-icons/svg/outlined/data/link-tilted.svg ***!
  \******************************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 16\"><path fill=\"#000\" d=\"m1.373 8 2.07-2.071.83.828L2.2 8.828a3.515 3.515 0 0 0 4.97 4.971l2.072-2.071.828.828L8 14.627A4.686 4.686 0 1 1 1.373 8M13.799 7.172l-2.071 2.07.828.83L14.627 8A4.686 4.686 0 1 0 8 1.373l-2.071 2.07.828.83L8.828 2.2a3.515 3.515 0 0 1 4.971 4.97\"></path><path fill=\"#000\" d=\"M5.515 9.657a.586.586 0 0 0 .828.828l4.142-4.142a.586.586 0 0 0-.828-.828z\"></path></svg>"

/***/ }),

/***/ "./jimu-icons/svg/outlined/data/page.svg":
/*!***********************************************!*\
  !*** ./jimu-icons/svg/outlined/data/page.svg ***!
  \***********************************************/
/***/ ((module) => {

module.exports = "<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 12 12\"><path fill=\"#000\" fill-rule=\"evenodd\" d=\"M10.167 0H1.833A.845.845 0 0 0 1 .857v10.286c0 .473.373.857.833.857h8.334c.46 0 .833-.384.833-.857V.857A.845.845 0 0 0 10.167 0M2 11V1h8v10zm1.6-8h4.8c.331 0 .6.224.6.5s-.269.5-.6.5H3.6c-.331 0-.6-.224-.6-.5s.269-.5.6-.5m4.8 3H3.6c-.331 0-.6.224-.6.5s.269.5.6.5h4.8c.331 0 .6-.224.6-.5S8.731 6 8.4 6\" clip-rule=\"evenodd\"></path></svg>"

/***/ }),

/***/ "./jimu-for-builder/index.tsx":
/*!************************************!*\
  !*** ./jimu-for-builder/index.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AppConfigAction: () => (/* reexport safe */ _lib_app_config_actions__WEBPACK_IMPORTED_MODULE_18__.AppConfigAction),
/* harmony export */   AppDataActionManager: () => (/* reexport safe */ _lib_app_data_action_manager__WEBPACK_IMPORTED_MODULE_3__["default"]),
/* harmony export */   AppMessageManager: () => (/* reexport safe */ _lib_app_message_manager__WEBPACK_IMPORTED_MODULE_2__["default"]),
/* harmony export */   AppResourceFilePath: () => (/* reexport safe */ _lib_app_resource_manager__WEBPACK_IMPORTED_MODULE_21__.AppResourceFilePath),
/* harmony export */   AppResourceManager: () => (/* reexport safe */ _lib_app_resource_manager__WEBPACK_IMPORTED_MODULE_21__.AppResourceManager),
/* harmony export */   AppStateHistoryActionKeys: () => (/* reexport safe */ _lib_app_state_history_extension__WEBPACK_IMPORTED_MODULE_6__.AppStateHistoryActionKeys),
/* harmony export */   AppStateHistoryExtension: () => (/* reexport safe */ _lib_app_state_history_extension__WEBPACK_IMPORTED_MODULE_6__["default"]),
/* harmony export */   AppStateReduxStoreExtension: () => (/* reexport safe */ _lib_app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_5__["default"]),
/* harmony export */   AppWidgetManager: () => (/* reexport safe */ _lib_app_widget_manager__WEBPACK_IMPORTED_MODULE_4__["default"]),
/* harmony export */   BaseLayoutService: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.BaseLayoutService),
/* harmony export */   BaseWidgetSetting: () => (/* reexport safe */ _lib_base_widget_setting__WEBPACK_IMPORTED_MODULE_0__["default"]),
/* harmony export */   BuilderKeyboardComponent: () => (/* reexport safe */ _lib_builder_keyboard_component__WEBPACK_IMPORTED_MODULE_17__["default"]),
/* harmony export */   BuilderStateActionTypes: () => (/* reexport safe */ _lib_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__.BuilderStateActionTypes),
/* harmony export */   BuilderStateReduxStoreExtension: () => (/* reexport safe */ _lib_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__["default"]),
/* harmony export */   BuilderStateResourceActionKeys: () => (/* reexport safe */ _lib_builder_state_resource_extension__WEBPACK_IMPORTED_MODULE_8__.BuilderStateResourceActionKeys),
/* harmony export */   BuilderStateResourceExtension: () => (/* reexport safe */ _lib_builder_state_resource_extension__WEBPACK_IMPORTED_MODULE_8__["default"]),
/* harmony export */   ContentServiceWrapper: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.ContentServiceWrapper),
/* harmony export */   ExtActionKeys: () => (/* reexport safe */ _lib_app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_5__.ExtActionKeys),
/* harmony export */   LayoutServiceProvider: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.LayoutServiceProvider),
/* harmony export */   ToBuilderMessage: () => (/* reexport safe */ _lib_sync_type__WEBPACK_IMPORTED_MODULE_19__.ToBuilderMessage),
/* harmony export */   UrlConfigManager: () => (/* reexport safe */ _lib_url_config_manager__WEBPACK_IMPORTED_MODULE_9__["default"]),
/* harmony export */   WidgetSettingManager: () => (/* reexport safe */ _lib_widget_setting_manager__WEBPACK_IMPORTED_MODULE_1__["default"]),
/* harmony export */   appBuilderSync: () => (/* reexport module object */ _lib_app_builder_sync__WEBPACK_IMPORTED_MODULE_11__),
/* harmony export */   appConfigUtils: () => (/* reexport module object */ _lib_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_15__),
/* harmony export */   appStateActions: () => (/* reexport safe */ _lib_app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_5__.appStateActions),
/* harmony export */   appStateHistoryActions: () => (/* reexport safe */ _lib_app_state_history_extension__WEBPACK_IMPORTED_MODULE_6__.appStateHistoryActions),
/* harmony export */   builderActionKeys: () => (/* reexport safe */ _lib_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__.builderActionKeys),
/* harmony export */   builderActions: () => (/* reexport safe */ _lib_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__.builderActions),
/* harmony export */   builderAppSync: () => (/* reexport module object */ _lib_builder_app_sync__WEBPACK_IMPORTED_MODULE_10__),
/* harmony export */   builderStateResourceActions: () => (/* reexport safe */ _lib_builder_state_resource_extension__WEBPACK_IMPORTED_MODULE_8__.builderStateResourceActions),
/* harmony export */   defaultMessages: () => (/* reexport safe */ _lib_translations_default__WEBPACK_IMPORTED_MODULE_12__["default"]),
/* harmony export */   emptyContentService: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.emptyContentService),
/* harmony export */   getAppConfigAction: () => (/* reexport safe */ _lib_app_config_actions__WEBPACK_IMPORTED_MODULE_18__.getAppConfigAction),
/* harmony export */   helpUtils: () => (/* reexport module object */ _lib_utils_help_utils__WEBPACK_IMPORTED_MODULE_14__),
/* harmony export */   init: () => (/* reexport safe */ _lib_init__WEBPACK_IMPORTED_MODULE_22__.init),
/* harmony export */   loadI18nMessage: () => (/* reexport safe */ _lib_builder_locale__WEBPACK_IMPORTED_MODULE_24__.loadI18nMessage),
/* harmony export */   makeSureTemplateConfig: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.makeSureTemplateConfig),
/* harmony export */   screenGroupService: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.screenGroupService),
/* harmony export */   sectionService: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.sectionService),
/* harmony export */   templateService: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.templateService),
/* harmony export */   templateUtils: () => (/* reexport module object */ _lib_utils_template_utils__WEBPACK_IMPORTED_MODULE_16__),
/* harmony export */   utils: () => (/* reexport module object */ _lib_utils_utils__WEBPACK_IMPORTED_MODULE_13__),
/* harmony export */   widgetService: () => (/* reexport safe */ _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__.widgetService)
/* harmony export */ });
/* harmony import */ var _lib_base_widget_setting__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./lib/base-widget-setting */ "./jimu-for-builder/lib/base-widget-setting.tsx");
/* harmony import */ var _lib_widget_setting_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/widget-setting-manager */ "./jimu-for-builder/lib/widget-setting-manager.tsx");
/* harmony import */ var _lib_app_message_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/app-message-manager */ "./jimu-for-builder/lib/app-message-manager.tsx");
/* harmony import */ var _lib_app_data_action_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lib/app-data-action-manager */ "./jimu-for-builder/lib/app-data-action-manager.tsx");
/* harmony import */ var _lib_app_widget_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/app-widget-manager */ "./jimu-for-builder/lib/app-widget-manager.tsx");
/* harmony import */ var _lib_app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./lib/app-state-redux-store-extension */ "./jimu-for-builder/lib/app-state-redux-store-extension.ts");
/* harmony import */ var _lib_app_state_history_extension__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./lib/app-state-history-extension */ "./jimu-for-builder/lib/app-state-history-extension.ts");
/* harmony import */ var _lib_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./lib/builder-state-store-extension */ "./jimu-for-builder/lib/builder-state-store-extension.ts");
/* harmony import */ var _lib_builder_state_resource_extension__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./lib/builder-state-resource-extension */ "./jimu-for-builder/lib/builder-state-resource-extension.ts");
/* harmony import */ var _lib_url_config_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./lib/url-config-manager */ "./jimu-for-builder/lib/url-config-manager.tsx");
/* harmony import */ var _lib_builder_app_sync__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./lib/builder-app-sync */ "./jimu-for-builder/lib/builder-app-sync.ts");
/* harmony import */ var _lib_app_builder_sync__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./lib/app-builder-sync */ "./jimu-for-builder/lib/app-builder-sync.ts");
/* harmony import */ var _lib_translations_default__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./lib/translations/default */ "./jimu-for-builder/lib/translations/default.ts");
/* harmony import */ var _lib_utils_utils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./lib/utils/utils */ "./jimu-for-builder/lib/utils/utils.ts");
/* harmony import */ var _lib_utils_help_utils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./lib/utils/help-utils */ "./jimu-for-builder/lib/utils/help-utils.ts");
/* harmony import */ var _lib_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./lib/utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var _lib_utils_template_utils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./lib/utils/template-utils */ "./jimu-for-builder/lib/utils/template-utils.ts");
/* harmony import */ var _lib_builder_keyboard_component__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./lib/builder-keyboard-component */ "./jimu-for-builder/lib/builder-keyboard-component.tsx");
/* harmony import */ var _lib_app_config_actions__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./lib/app-config-actions */ "./jimu-for-builder/lib/app-config-actions.ts");
/* harmony import */ var _lib_sync_type__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./lib/sync-type */ "./jimu-for-builder/lib/sync-type.ts");
/* harmony import */ var _lib_props__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./lib/props */ "./jimu-for-builder/lib/props.ts");
/* harmony import */ var _lib_app_resource_manager__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./lib/app-resource-manager */ "./jimu-for-builder/lib/app-resource-manager.tsx");
/* harmony import */ var _lib_init__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./lib/init */ "./jimu-for-builder/lib/init.ts");
/* harmony import */ var _lib_app_config_service__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./lib/app-config-service */ "./jimu-for-builder/lib/app-config-service/index.ts");
/* harmony import */ var _lib_builder_locale__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./lib/builder-locale */ "./jimu-for-builder/lib/builder-locale.ts");

































/***/ }),

/***/ "./jimu-for-builder/lib/app-builder-sync.ts":
/*!**************************************************!*\
  !*** ./jimu-for-builder/lib/app-builder-sync.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   clearLastAppConfigFromHistory: () => (/* binding */ clearLastAppConfigFromHistory),
/* harmony export */   letBuilderAddResource: () => (/* binding */ letBuilderAddResource),
/* harmony export */   letBuilderClearResource: () => (/* binding */ letBuilderClearResource),
/* harmony export */   letBuilderPopupChooseWidget: () => (/* binding */ letBuilderPopupChooseWidget),
/* harmony export */   letBuilderResponseToKeyboard: () => (/* binding */ letBuilderResponseToKeyboard),
/* harmony export */   letBuilderShowLayoutToolbar: () => (/* binding */ letBuilderShowLayoutToolbar),
/* harmony export */   listenBuilderEvents: () => (/* binding */ listenBuilderEvents),
/* harmony export */   publishAppIsLoadedToBuilder: () => (/* binding */ publishAppIsLoadedToBuilder),
/* harmony export */   publishAppSessionChangeToBuilder: () => (/* binding */ publishAppSessionChangeToBuilder),
/* harmony export */   publishAppStateChangeToBuilder: () => (/* binding */ publishAppStateChangeToBuilder),
/* harmony export */   publishCheck498ErrorToBuilder: () => (/* binding */ publishCheck498ErrorToBuilder),
/* harmony export */   publishConfirmDeleteToApp: () => (/* binding */ publishConfirmDeleteToApp),
/* harmony export */   publishIsBusyToBuilder: () => (/* binding */ publishIsBusyToBuilder),
/* harmony export */   publishNoPermissionResourceInfoListChangeToBuilder: () => (/* binding */ publishNoPermissionResourceInfoListChangeToBuilder),
/* harmony export */   publishPortalUrlNeedToRegisterClientId: () => (/* binding */ publishPortalUrlNeedToRegisterClientId),
/* harmony export */   publishSidePanelToApp: () => (/* binding */ publishSidePanelToApp)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _sync_type__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sync-type */ "./jimu-for-builder/lib/sync-type.ts");


let pubsub;
try {
    pubsub = window.parent && window.parent._builderPubsub;
}
catch (e) {
    /**
     * In normal case, this file should not be loaded if app is out of builder,
     * but we catch this error to avoid this file is loaded accidentally when app is launched out of builder.
     */
    console.error('Can access parent.');
}
function listenBuilderEvents() {
    if (!pubsub) {
        return;
    }
    pubsub.unsubscribe('to_app');
    const store = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)();
    pubsub.subscribe('to_app', function (evt, data) {
        console.debug(evt, data);
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.AppConfigChanged}`, function (evt, appConfig) {
        const state = store.getState();
        if (state.appRuntimeInfo.currentPageId && !appConfig.pages[state.appRuntimeInfo.currentPageId]) {
            const defaultPageId = Object.keys(appConfig.pages).find(pId => appConfig.pages[pId].isDefault);
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.jimuHistory.changePage(defaultPageId);
        }
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.appConfigChanged(appConfig));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.AppInfoChanged}`, function (evt, appInfo) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.appInfoChanged(appInfo));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.PortalSelfChanged}`, function (evt, portalSelf) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.setPortalSelf(portalSelf));
        if (portalSelf && !portalSelf.isPortal) {
            const newPortalUrl = `https://${portalSelf.urlKey}.${portalSelf.customBaseUrl}`;
            if (portalSelf.urlKey && !jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isSamePortalUrl(store.getState().portalUrl, newPortalUrl)) {
                store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.setPortalInfo({
                    portalUrl: newPortalUrl
                }));
            }
        }
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.UserSignIn}`, function (evt, user) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.userSignIn(user));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.SetMainPortal}`, function (evt, mainPortalInfo) {
        const portalInfo = Object.assign({
            portalUrl: store.getState().portalUrl,
            clientId: store.getState().clientId,
            isWebTier: store.getState().isWebTier
        }, mainPortalInfo);
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.setPortalInfo(portalInfo));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.DialogInfosChanged}`, function (action, dialogIds) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.dialogInfosChanged(dialogIds));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangeAppMode}`, function (action, mode) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.appModeChanged(mode));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangeWidgetStateProp}`, function (action, alterState) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.widgetStatePropChange(alterState.widgetId, alterState.propKey, alterState.value));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangeWidgetMutableStateProp}`, function (action, alterState) {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.MutableStoreManager.getInstance().updateStateValue(alterState.widgetId, alterState.propKey, alterState.value);
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangePage}`, function (action, pageId) {
        const pageJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig.pages[pageId];
        if (pageJson.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Link || pageJson.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Folder || jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlUtils.parseAppPath(location.pathname, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig).pageId === pageId) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.currentPageChanged(pageId));
        }
        else {
            // currentPage will be updated after path change.
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.jimuHistory.changePage(pageId);
        }
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangeDialog}`, function (action, dialogId) {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.jimuHistory.changeDialog(dialogId);
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.currentDialogChanged(dialogId));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangeSelection}`, function (action, selection) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.selectionChanged(selection));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.BuilderTriggerKeyboard}`, function (action, event) {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.keyboardUtils.triggerEvent(event);
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangeBrowserSizeMode}`, function (action, mode) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.browserSizeModeChanged(mode));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.BuilderSessionChanged}`, function (action, sessions) {
        // console.log(JSON.stringify(sessions));
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().syncSessionsFromOtherWindow(sessions);
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.BuilderNoPermissionResourceInfoListChanged}`, function (action, noPermissionResourceInfoList) {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().syncNoPermissionResourceInfoListFromOtherWindow(noPermissionResourceInfoList);
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ChangeZoomScale}`, function (action, zoomScale) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.zoomScaleChange(zoomScale));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ActivePagePartChanged}`, function (action, part) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.activePagePartChanged(part));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.AnimationPreview}`, function (action, info) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.setupAnimationPreview(info));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.HoverPreview}`, function (action, info) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.setupHoverPreview(info));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.SectionNavInfoChanged}`, function (action, data) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.sectionNavInfoChanged(data.sectionId, data.navInfo));
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.jimuHistory.changeViewBySectionNavInfo(data.sectionId, data.navInfo);
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.ScreenGroupNavInfoChanged}`, function (action, data) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.screenGroupNavInfoChanged(data.screenGroupId, data.activeIndex));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.TocHoverInfoChanged}`, function (action, data) {
        const { layoutInfo, hovered } = data;
        const { layoutId, layoutItemId } = layoutInfo;
        const element = document.querySelector(`div.builder-layout-item[data-layoutid="${layoutId}"][data-layoutitemid="${layoutItemId}"]`);
        if (element) {
            hovered ? element.classList.add('hovered') : element.classList.remove('hovered');
        }
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.SetClientIdAlertIsCancelled}`, function (action, data) {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().onClientIdDialogFinished(data === null || data === void 0 ? void 0 : data.portalUrl, null, new Error('setting clientId is cancelled.'));
    });
    pubsub.subscribe(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToAppMessage.UtilityStateChanged}`, function (action, data) {
        store.dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.utilityStateChange(data.utilityId, data.state));
    });
}
function publishAppSessionChangeToBuilder() {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.AppSessionChanged}`, jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getSessions());
}
function publishNoPermissionResourceInfoListChangeToBuilder() {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.AppNoPermissionResourceInfoListChanged}`, jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getNoPermissionResourceInfoList());
}
function publishCheck498ErrorToBuilder(url) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.NeedToCheck498Error}`, url);
}
function publishAppStateChangeToBuilder() {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.AppStateChanged}`, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState());
}
function publishAppIsLoadedToBuilder() {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.AppIsLoaded}`);
}
function letBuilderPopupChooseWidget(layoutId, layoutItemId) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.PopupChooseWidget}`, {
        layoutId: layoutId,
        layoutItemId: layoutItemId
    });
}
function letBuilderAddResource(resourceItemInfo) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.AppAddResource}`, resourceItemInfo);
}
function letBuilderClearResource(appId) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.AppClearResources}`, appId);
}
function letBuilderResponseToKeyboard(event) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.AppTriggerKeyboard}`, event);
}
function letBuilderShowLayoutToolbar(tools) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.SetLayoutTools}`, tools);
}
function clearLastAppConfigFromHistory() {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.ClearLastAppConfigFromHistory}`);
}
function publishIsBusyToBuilder(isBusy) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.SetIsBusy}`, isBusy);
}
function publishConfirmDeleteToApp(itemToDelete) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.ConfirmDelete}`, itemToDelete);
}
function publishPortalUrlNeedToRegisterClientId(portalUrl, needToSignIn, serviceUrl) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.NeedToRegisterClinetId}`, { portalUrl, needToSignIn, serviceUrl });
}
function publishSidePanelToApp(option) {
    publishEventToBuilder(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_1__.ToBuilderMessage.SetSidePanel}`, option);
}
function publishEventToBuilder(action, data) {
    if (!pubsub) {
        return;
    }
    pubsub.publishSync(action, data);
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-actions.ts":
/*!****************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-actions.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AppConfigAction: () => (/* binding */ AppConfigAction),
/* harmony export */   getAppConfigAction: () => (/* binding */ getAppConfigAction)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-layouts/layout-runtime */ "jimu-layouts/layout-runtime");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var _builder_app_sync__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./builder-app-sync */ "./jimu-for-builder/lib/builder-app-sync.ts");
/* harmony import */ var _app_builder_sync__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./app-builder-sync */ "./jimu-for-builder/lib/app-builder-sync.ts");
/* harmony import */ var _app_state_history_extension__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./app-state-history-extension */ "./jimu-for-builder/lib/app-state-history-extension.ts");
/* harmony import */ var _app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./app-state-redux-store-extension */ "./jimu-for-builder/lib/app-state-redux-store-extension.ts");
/* harmony import */ var _builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./builder-state-store-extension */ "./jimu-for-builder/lib/builder-state-store-extension.ts");
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../index */ "./jimu-for-builder/index.tsx");
/* harmony import */ var _app_widget_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./app-widget-manager */ "./jimu-for-builder/lib/app-widget-manager.tsx");
/* harmony import */ var _app_config_service__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./app-config-service */ "./jimu-for-builder/lib/app-config-service/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};











function getAppConfig() {
    const state = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState();
    if (window.jimuConfig.isBuilder) {
        return state && state.appStateInBuilder && state.appStateInBuilder.appConfig;
    }
    else {
        return state && state.appConfig;
    }
}
function getAppConfigAction(appConfig = undefined) {
    if (!appConfig) {
        appConfig = getAppConfig();
    }
    return new AppConfigAction(appConfig);
}
class AppConfigAction {
    /**
   * When duplicate a page or dialog, we'll duplicate all size mode layouts, but the shared contents should be duplicated only one time.
   * So, when duplicate the size mode layouts, we need to consider the contents that have been duplicated. If a content has been duplicated,
   * duplicate the same content will need to use the duplicated content id instead of create a new one.
   *
   * When start to duplicate a page or dialog, must clean this map and set it as `{}`, and restore to {} when duplication is done.
   */
    // private duplicatedContentMaps?: { [id: string]: string } = {}
    // private isDuplicatingPage?: boolean
    constructor(appConfig) {
        /**
         * After delete the widget, clear the message action of the widget
         * @oldAppConfig
         * @newAppConfig
         * */
        this.clearDeletedWidgetMessageAction = (oldAppConfig, newAppConfig) => {
            const deletedMessageConfigs = this.getDeletedWidgetsMessageConfigs(oldAppConfig, newAppConfig);
            deletedMessageConfigs.forEach(message => {
                this.removeMessageAction(message);
            });
        };
        /**
         * Get the message config of the deleted widget
         * @oldAppConfig
         * @newAppConfig
         * */
        this.getDeletedWidgetsMessageConfigs = (oldAppConfig, newAppConfig) => {
            const oldMessageConfigs = oldAppConfig.messageConfigs;
            const newMessageConfigs = newAppConfig.messageConfigs;
            const deletedMessageConfigs = [];
            if (!oldMessageConfigs) {
                return deletedMessageConfigs;
            }
            const oldMessageConfigsKeys = Object.keys(oldMessageConfigs);
            const newMessageConfigsKeys = Object.keys(newMessageConfigs);
            for (let i = 0; i < oldMessageConfigsKeys.length; i++) {
                if (!newMessageConfigsKeys.includes(oldMessageConfigsKeys[i])) {
                    deletedMessageConfigs.push(oldMessageConfigs[oldMessageConfigsKeys[i]]);
                }
            }
            return deletedMessageConfigs;
        };
        /**
         * Remove message action
         * @message
         * */
        this.removeMessageAction = (message) => {
            var _a;
            (_a = message === null || message === void 0 ? void 0 : message.actions) === null || _a === void 0 ? void 0 : _a.forEach(actionJson => {
                const actionObj = _index__WEBPACK_IMPORTED_MODULE_8__.AppMessageManager.getInstance().getAction(actionJson.widgetId, actionJson.actionName);
                if (actionObj) {
                    actionObj.onRemoveListen(message.messageType, message.widgetId);
                }
            });
        };
        this.appConfig = appConfig;
    }
    /**
     *
     * @param replace by default, the change is appended to the change list. If replace = true, the change will replace the last change
     */
    exec(replace = false) {
        // this.duplicatedContentMaps = {}
        // this.isDuplicatingPage = false
        if (window.jimuConfig.isBuilder) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch({ type: 'IN_BUILDER_APPCONFIG_REDOCLEAR' });
            if (replace) {
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_history_extension__WEBPACK_IMPORTED_MODULE_5__.appStateHistoryActions.InBuilderRemoveLastAppConfigFromHistory());
            }
            _builder_app_sync__WEBPACK_IMPORTED_MODULE_3__.publishAppConfigChangeToApp(this.appConfig);
            const oldAppConfig = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig;
            const newAppConfig = this.appConfig;
            const removedWidgets = Object.keys(oldAppConfig.widgets).filter(wId => !newAppConfig.widgets[wId]);
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__.builderActions.widgetsRemoved(removedWidgets));
            //clear the message action of the deleted widget
            this.clearDeletedWidgetMessageAction(oldAppConfig, newAppConfig);
            const newWidgets = Object.keys(newAppConfig.widgets).filter(wId => !oldAppConfig.widgets[wId]).map(wId => ({
                widgetId: wId,
                widgetUri: newAppConfig.widgets[wId].uri
            }));
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_7__.builderActions.widgetsAdded(newWidgets));
            const appInfo = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appInfo;
            /**
             * After `publishAppConfigChangeToApp`, app will call `publishAppStateChangeToBuilder` to update the appConfig in builder's state.
             * However, the `publishAppStateChangeToBuilder` is async, so we update the appConfig in builder's state here.
             */
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_6__.appStateActions.inBuilderAppConfigChanged(this.appConfig));
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_history_extension__WEBPACK_IMPORTED_MODULE_5__.appStateHistoryActions.InBuilderPutAppConfigIntoHistory({ appConfig: this.appConfig, appInfo: appInfo }));
        }
        else {
            if (replace) {
                _app_builder_sync__WEBPACK_IMPORTED_MODULE_4__.clearLastAppConfigFromHistory();
            }
            const oldAppConfig = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig;
            const newAppConfig = this.appConfig;
            //clear the message action of the deleted widget
            this.clearDeletedWidgetMessageAction(oldAppConfig, newAppConfig);
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.appConfigChanged(this.appConfig));
        }
        return this;
    }
    // #region Widget APIs
    editWidgetConfig(widgetId, widgetConfig) {
        if (!this.appConfig.widgets[widgetId]) {
            return this;
        }
        this.appConfig = this.appConfig.setIn(['widgets', widgetId, 'config'], widgetConfig);
        return this;
    }
    /**
     * Update the passed in properties only.
     * To delete a property, please set the property to null
     * @param partialWidgetJson
     * @param outputDataSourcesJsons
     *    To create a data source, you need to pass in all of the generated properties.
     *    To update a data source, you can pass in the change properties only. Pass null to delete a property.
     */
    editWidget(partialWidgetJson, outputDataSourcesJsons) {
        if (!this.appConfig.widgets[partialWidgetJson.id]) {
            return this;
        }
        const oldWidgetJson = this.appConfig.widgets[partialWidgetJson.id];
        let newWidgetJson = oldWidgetJson;
        if (outputDataSourcesJsons) {
            outputDataSourcesJsons.forEach(dsJson => {
                if (!dsJson.isOutputFromWidget) {
                    dsJson.isOutputFromWidget = true;
                }
            });
            newWidgetJson = newWidgetJson.set('outputDataSources', outputDataSourcesJsons.map(dsJson => dsJson.id));
        }
        Object.keys(partialWidgetJson).forEach(k => {
            if (partialWidgetJson[k] === null) {
                if (k === 'outputDataSourcesJson') {
                    if (partialWidgetJson.outputDataSources) {
                        partialWidgetJson.outputDataSources.forEach(dsId => this.removeDataSource(dsId));
                    }
                }
                newWidgetJson = newWidgetJson.without(k);
                delete partialWidgetJson[k];
            }
        });
        // remove old ds
        if (oldWidgetJson.outputDataSources) {
            oldWidgetJson.outputDataSources.forEach(dsId => {
                if (!newWidgetJson.outputDataSources || !newWidgetJson.outputDataSources.includes(dsId)) {
                    this.removeDataSource(dsId);
                }
            });
        }
        // add/update new ds
        if (newWidgetJson.outputDataSources) {
            newWidgetJson.outputDataSources.forEach(dsId => {
                const outputDataSourcesJson = outputDataSourcesJsons && outputDataSourcesJsons.find(newDsJson => newDsJson.id === dsId);
                if (outputDataSourcesJson) {
                    if (!oldWidgetJson.outputDataSources || !oldWidgetJson.outputDataSources.includes(dsId)) {
                        this.addDataSource((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(outputDataSourcesJson));
                    }
                    else {
                        let oldDsJson = this.appConfig.dataSources[dsId];
                        if (!oldDsJson) {
                            console.error('Unknown error. Widget output data source is not in data source json.', dsId);
                            return;
                        }
                        Object.keys(outputDataSourcesJson).forEach(k => {
                            if (outputDataSourcesJson[k] === null) {
                                oldDsJson = oldDsJson.without(k);
                                delete outputDataSourcesJson[k];
                            }
                        });
                        this.editDataSource(oldDsJson.merge(outputDataSourcesJson));
                    }
                }
            });
        }
        newWidgetJson = newWidgetJson.merge(partialWidgetJson);
        if (partialWidgetJson.useDataSources && newWidgetJson.layouts && newWidgetJson.manifest.properties.passDataSourceToChildren) {
            this.copyUseDataSourceToAllChildWidgets(oldWidgetJson, newWidgetJson);
        }
        this.appConfig = this.appConfig.setIn(['widgets', partialWidgetJson.id], newWidgetJson);
        return this;
    }
    /**
     * Update a sigle widget property. Does not `outputDataSources` property
     * @param widgetId
     * @param prop
     * @param val
     */
    editWidgetProperty(widgetId, prop, val) {
        if (!this.appConfig.widgets || !this.appConfig.widgets[widgetId]) {
            return this;
        }
        if (prop === 'outputDataSources') {
            console.error('Please use editWidget to update outputDataSources.');
            return this;
        }
        const widgetJson = this.appConfig.widgets[widgetId];
        const newWidgetJson = this.editJsonProperty(widgetJson, prop, val);
        if (widgetJson === newWidgetJson) {
            return this;
        }
        this.appConfig = this.appConfig.setIn(['widgets', widgetId], newWidgetJson);
        if (prop.includes('.')) {
            return this;
        }
        return this.editWidget({ id: widgetId, [prop]: val });
    }
    /**
     *
     * @param widgetJson basic widget info, like uri. manifest and id will be set in this method.
     * @param createEmbedLayout
     */
    createWidget(widgetJson, createEmbedLayout = true) {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const loadedJson = yield _app_widget_manager__WEBPACK_IMPORTED_MODULE_9__["default"].getInstance().handleNewWidgetJson(widgetJson);
                const result = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.createWidget(this.appConfig, loadedJson, [jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode()], createEmbedLayout);
                this.appConfig = result[0];
                const widgetId = result[1];
                return this.appConfig.widgets[widgetId];
            }
            catch (e) {
                console.error(e);
            }
            return null;
        });
    }
    removeWidget(widgetId) {
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.remove(this.appConfig, widgetId);
        return this;
    }
    editControllerPanel(controllerWidgetId, value) {
        this.appConfig = this.appConfig.setIn(['controllerPanels', controllerWidgetId], value);
        return this;
    }
    removeControllerPanel(controllerWidgetId) {
        var _a;
        if ((_a = this.appConfig.controllerPanels) === null || _a === void 0 ? void 0 : _a[controllerWidgetId]) {
            this.appConfig = this.appConfig.set('controllerPanels', this.appConfig.controllerPanels.without(controllerWidgetId));
        }
        return this;
    }
    removeLayoutFromWidget(widgetId, layoutName) {
        var _a, _b, _c;
        if (!((_a = this.appConfig.widgets[widgetId]) === null || _a === void 0 ? void 0 : _a.layouts) || !((_b = this.appConfig.widgets[widgetId]) === null || _b === void 0 ? void 0 : _b.layouts[layoutName])) {
            return this;
        }
        Object.keys((_c = this.appConfig.widgets[widgetId]) === null || _c === void 0 ? void 0 : _c.layouts[layoutName]).forEach(sizeMode => {
            var _a;
            const layoutId = (_a = this.appConfig.widgets[widgetId]) === null || _a === void 0 ? void 0 : _a.layouts[layoutName][sizeMode];
            this.removeLayout(layoutId);
        });
        this.appConfig = this.appConfig.setIn(['widgets', widgetId, 'layouts'], this.appConfig.widgets[widgetId].layouts.without(layoutName));
        return this;
    }
    // #endregion
    // #region Section APIs, View APIs
    /**
     * create section only, does not add into layout
     */
    createSection() {
        const result = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.sectionService.createSection(this.appConfig, [jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode()]);
        this.appConfig = result[0];
        const sectionId = result[1];
        return this.appConfig.sections[sectionId];
    }
    editSectionProperty(sectionId, prop, val) {
        let sectionJson = this.appConfig.sections[sectionId];
        if (!sectionJson) {
            return this;
        }
        sectionJson = this.editJsonProperty(sectionJson, prop, val);
        this.appConfig = this.appConfig.setIn(['sections', sectionId], sectionJson);
        return this;
    }
    editViewProperty(viewId, prop, val) {
        let viewJson = this.appConfig.views[viewId];
        if (!viewJson) {
            return this;
        }
        viewJson = this.editJsonProperty(viewJson, prop, val);
        this.appConfig = this.appConfig.setIn(['views', viewId], viewJson);
        return this;
    }
    /**
     * Add a view into a section, will create layouts for the view. The layouts are created depends on the section.
     *
     * @param viewJson the viewJson has id and label only
     * @param sectionId the section that the view will be added in
     */
    addView(sectionId) {
        var _a;
        let sizeModeList;
        const sectionJson = this.appConfig.sections[sectionId];
        if (((_a = sectionJson.views) === null || _a === void 0 ? void 0 : _a.length) > 0) {
            const firseViewId = sectionJson.views[0];
            const viewJson = this.appConfig.views[firseViewId];
            sizeModeList = Object.keys(viewJson.layout);
        }
        else {
            const { type, id } = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.getContentRootContainerInfo(this.appConfig, sectionId, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode());
            if (type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.ContainerType.Header || type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.ContainerType.Footer) {
                sizeModeList = Object.keys(this.appConfig[id].layout);
            }
            else if (type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.ContainerType.Page) {
                sizeModeList = Object.keys(this.appConfig.pages[id].layout);
            }
            else if (type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.ContainerType.Dialog) {
                sizeModeList = Object.keys(this.appConfig.dialogs[id].layout);
            }
        }
        const result = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.sectionService.addView(this.appConfig, sectionId, sizeModeList);
        this.appConfig = result[0];
        return result[1];
    }
    /**
     * Duplicate the view in the section, return the new view.
     * @param viewId
     * @param sectionId
     * @param addToSection
     */
    duplicateView(viewId, sectionId, addToSection) {
        const sectionJson = this.appConfig.sections[sectionId];
        const firstView = this.appConfig.views[sectionJson.views[0]];
        const sizeModeList = Object.keys(firstView.layout);
        const result = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.sectionService.duplicateView(this.appConfig, sectionId, viewId, sizeModeList, addToSection, null);
        this.appConfig = result[0];
        const newId = result[1];
        return this.appConfig.views[newId];
    }
    /**
     * Remove the view from the section. The last view in the section is not allowed remove
     * @param viewId
     * @param sectionId
     */
    removeView(viewId, sectionId) {
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.sectionService.removeView(this.appConfig, sectionId, viewId);
        return this;
    }
    /**
     * Move the view position in the section. Move the view to the targetView's above/below
     * @param sectionId
     * @param viewId
     * @param targetViewId
     * @param position
     */
    moveViewInSection(sectionId, viewId, targetViewId, position) {
        if (!this.appConfig.sections || !this.appConfig.sections[sectionId] ||
            !this.appConfig.views || !this.appConfig.views[viewId] || !this.appConfig.views[targetViewId]) {
            return this;
        }
        if (targetViewId === viewId) {
            console.error('viewId is same to targetViewId.');
            return this;
        }
        let views = this.appConfig.sections[sectionId].views.asMutable();
        views = views.filter(view => view !== viewId);
        let index = views.indexOf(targetViewId);
        if (position === 'below')
            index++;
        views = views.slice(0, index).concat(viewId).concat(views.slice(index));
        this.appConfig = this.appConfig.setIn(['sections', sectionId, 'views'], views);
        return this;
    }
    // #endregion
    // #region Screen Group APIs, Screen APIs
    /**
     * Create an empty screen group
     */
    createScreenGroup() {
        // Create a new screenGroupJson
        const screenGroupId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(this.appConfig, 'screenGroup');
        const screenGroupLabel = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(this.appConfig, 'screenGroup', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'screenGroup' }));
        const screenGroupJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
            id: screenGroupId,
            label: screenGroupLabel,
            screens: [],
            transitionType: jimu_core__WEBPACK_IMPORTED_MODULE_0__.ScreenTransitionType.Fade
        });
        this.appConfig = this.appConfig.setIn(['screenGroups', screenGroupJson.id], screenGroupJson);
        return screenGroupJson;
    }
    editScreenGroupProperty(screenGroupId, prop, val) {
        let sgJson = this.appConfig.screenGroups[screenGroupId];
        if (!sgJson) {
            return this;
        }
        sgJson = this.editJsonProperty(sgJson, prop, val);
        this.appConfig = this.appConfig.setIn(['screenGroups', screenGroupId], sgJson);
        return this;
    }
    editScreenProperty(screenId, prop, val) {
        let screenJson = this.appConfig.screens[screenId];
        if (!screenJson) {
            return this;
        }
        screenJson = this.editJsonProperty(screenJson, prop, val);
        this.appConfig = this.appConfig.setIn(['screens', screenId], screenJson);
        return this;
    }
    moveScreenInGroup(screenGroupId, index, targetIndex, position) {
        var _a;
        if (!((_a = this.appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[screenGroupId]) || index === targetIndex) {
            return this;
        }
        const screens = this.appConfig.screenGroups[screenGroupId].screens.asMutable();
        const dragId = screens[index];
        const targetId = screens[targetIndex];
        screens.splice(index, 1);
        const newTargetIndex = screens.indexOf(targetId);
        if (position === 'below') {
            screens.splice(newTargetIndex, 1, targetId, dragId);
        }
        else {
            screens.splice(newTargetIndex, 1, dragId, targetId);
        }
        this.appConfig = this.appConfig.setIn(['screenGroups', screenGroupId, 'screens'], screens);
        return this;
    }
    removeScreenByIndex(index, screenGroupId) {
        var _a, _b;
        const screens = (_b = (_a = this.appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[screenGroupId]) === null || _b === void 0 ? void 0 : _b.screens;
        const screenId = screens === null || screens === void 0 ? void 0 : screens[index];
        return this.removeScreen(screenId, screenGroupId);
    }
    /**
     * Remove the screen from the screen group. The last screen in the screen group is not allowed remove
     * @param screenId
     * @param screenGroupId
     */
    removeScreen(screenId, screenGroupId, force = false) {
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.screenGroupService.removeScreen(this.appConfig, screenGroupId, screenId);
        return this;
    }
    duplicateScreenByIndex(index, screenGroupId, addToScreenGroup = true) {
        var _a, _b;
        const screens = (_b = (_a = this.appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[screenGroupId]) === null || _b === void 0 ? void 0 : _b.screens;
        const screenId = screens === null || screens === void 0 ? void 0 : screens[index];
        return this.duplicateScreen(screenId, screenGroupId, addToScreenGroup);
    }
    /**
     * Duplicate the screen in the screen group, return the new screen.
     * @param screenId
     * @param screenGroupId
     * @param addToScreenGroup
     */
    duplicateScreen(screenId, screenGroupId, addToScreenGroup = true) {
        const sgJson = this.appConfig.screenGroups[screenGroupId];
        const firstScreen = this.appConfig.screens[sgJson.screens[0]];
        const sizeModeList = Object.keys(firstScreen.main.layout);
        const result = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.screenGroupService.duplicateScreen(this.appConfig, screenGroupId, screenId, sizeModeList, addToScreenGroup, null);
        this.appConfig = result[0];
        const newId = result[1];
        return this.appConfig.screens[newId];
    }
    // #endregion
    // #region Page APIs
    editPageProperty(pageId, prop, val) {
        if (!this.appConfig.pages || !this.appConfig.pages[pageId]) {
            return this;
        }
        let pageJson = this.appConfig.pages[pageId];
        pageJson = this.editJsonProperty(pageJson, prop, val);
        this.appConfig = this.appConfig.setIn(['pages', pageId], pageJson);
        return this;
    }
    /**
     *
     * @param pageJson
     *
     * Add a new page. Only the folder and link page is created here.
     * The other page (the page can put widgets) are created in `template-utils in jimu-for-builder`
     */
    addPage(pageJson) {
        if (this.appConfig.pages && this.appConfig.pages[pageJson.id]) {
            return this;
        }
        this.appConfig = this.appConfig.setIn(['pages', pageJson.id], pageJson);
        this.appConfig = this.appConfig.set('pageStructure', this.appConfig.pageStructure.concat([{ [pageJson.id]: [] }]));
        return this;
    }
    /**
     *
     * @param pageId
     * @param duplicatePageJsonOnly
     * if duplicatePageJsonOnly is true, the page won't be put into page structure.
     * It's used when one page(or folder, or link) need to duplicate its sub pages.
     *
     * This logic need to be refacted when page structure has more than two levels.
     */
    duplicatePage(pageId, duplicatePageJsonOnly = false) {
        if (!this.appConfig.pages || !this.appConfig.pages[pageId]) {
            return null;
        }
        // this.isDuplicatingPage = true
        let newPageJson = this.appConfig.pages[pageId].set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(this.appConfig, 'page'));
        newPageJson = newPageJson.set('label', this.getDuplicateLabel('page', newPageJson.label));
        this.appConfig = this.appConfig.setIn(['pages', newPageJson.id], newPageJson);
        if (newPageJson.isDefault) {
            newPageJson = newPageJson.set('isDefault', false);
        }
        // duplicate the page self
        if (newPageJson.type !== jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Link && newPageJson.type !== jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Folder) {
            const duplicateContext = {};
            const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getServiceFromSizeModeLayout(this.appConfig, newPageJson.layout);
            const result = service.duplicateSizeModeLayouts(this.appConfig, newPageJson.layout, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page, newPageJson.id, duplicateContext);
            this.appConfig = result[0];
            newPageJson = newPageJson.set('layout', result[1]);
            // this.isDuplicatingPage = false
            // handle internal config after copying the widget.
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, this.appConfig, duplicateContext);
        }
        const ps = this.appConfig.pageStructure.find(ps => !!ps[pageId]);
        // duplicate sub pages if it has
        const newSubPId = [];
        if (ps) {
            ps[pageId].forEach(subId => {
                // add sub page
                const newSubPageJson = this.duplicatePage(subId, true);
                newSubPId.push(newSubPageJson.id);
            });
        }
        // handle the structure
        if (!duplicatePageJsonOnly) {
            if (ps) { // first aspect  add ps
                // add parent ps
                this.appConfig = this.appConfig.set('pageStructure', this.appConfig.pageStructure.concat([{ [newPageJson.id]: [] }]));
                if (newSubPId.length > 0) { // add sub ps
                    const parentPId = newPageJson.id;
                    let psIndex = this.appConfig.pageStructure.length - 1;
                    if (psIndex < 0)
                        psIndex = 0;
                    this.appConfig = this.appConfig.setIn(['pageStructure', psIndex + '', parentPId], newSubPId);
                }
            }
            else {
                // eslint-disable-next-line
                this.appConfig.pageStructure.some((ps, i) => {
                    const pId = Object.keys(ps).find(pId => ps[pId].includes(pageId));
                    if (pId) {
                        this.appConfig = this.appConfig.setIn(['pageStructure', i + '', pId], this.appConfig.pageStructure[i][pId].concat(newPageJson.id));
                        return true;
                    }
                });
            }
        }
        this.appConfig = this.appConfig.setIn(['pages', newPageJson.id], newPageJson);
        return newPageJson;
    }
    movePageIntoPage(subPageId, parentPageId) {
        if (!this.appConfig.pages || !this.appConfig.pages[subPageId] || !this.appConfig.pages[parentPageId]) {
            return this;
        }
        if (subPageId === parentPageId) {
            console.error('SubPage is same to ParentPage.');
            return this;
        }
        if (!_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.isFirstLevelPage(this.appConfig, parentPageId)) {
            console.error('ParentPage is not on the first aspect.');
            return this;
        }
        if (_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.isPageHasSubPage(this.appConfig, subPageId)) {
            console.error('SubPage has sub page(s).');
            return this;
        }
        this.removePageFromPageStructure(subPageId);
        this.movePageIntoPageForPageStructure(subPageId, parentPageId);
        return this;
    }
    orderPageToPage(pageId, targetPageId, type) {
        if (!this.appConfig.pages || !this.appConfig.pages[targetPageId] || !this.appConfig.pages[pageId]) {
            return this;
        }
        if (targetPageId === pageId) {
            console.error('pageId is same to targetPageId.');
            return this;
        }
        const isTopPageSub = !_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.isFirstLevelPage(this.appConfig, targetPageId);
        if ((_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.isPageHasSubPage(this.appConfig, pageId) || this.appConfig.pages[pageId].type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Folder) && isTopPageSub) {
            console.error('page structure allow two aspects only');
            return this;
        }
        // get pageId's page structure
        const ps = this.appConfig.pageStructure.find(ps => !!ps[pageId]);
        this.removePageFromPageStructure(pageId);
        if (isTopPageSub) {
            // eslint-disable-next-line
            this.appConfig.pageStructure.some((p, i) => {
                const pId = Object.keys(p)[0];
                let index = p[pId].indexOf(targetPageId);
                if (index > -1) {
                    let subPS = this.appConfig.pageStructure[i][pId];
                    if (type === 'bottom') {
                        index = index + 1;
                    }
                    subPS = subPS.slice(0, index).concat([pageId]).concat(subPS.slice(index));
                    this.appConfig = this.appConfig.setIn(['pageStructure', i + '', pId], subPS);
                    return true;
                }
            });
        }
        else {
            // eslint-disable-next-line
            this.appConfig.pageStructure.some((p, i) => {
                const pId = Object.keys(p)[0];
                if (pId === targetPageId) {
                    if (type === 'bottom') {
                        i = i + 1;
                    }
                    const pageStructure = this.appConfig.pageStructure.slice(0, i).concat([ps || { [pageId]: [] }]).concat(this.appConfig.pageStructure.slice(i));
                    this.appConfig = this.appConfig.set('pageStructure', pageStructure);
                    return true;
                }
            });
        }
        return this;
    }
    removePage(pageId, newHomePageId) {
        if (!this.appConfig.pages || !this.appConfig.pages[pageId]) {
            return this;
        }
        // TODO handle header/footer
        const pageJson = this.appConfig.pages[pageId];
        if (pageJson.type !== jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Folder && pageJson.type !== jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Link) {
            const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getServiceFromSizeModeLayout(this.appConfig, pageJson.layout);
            this.appConfig = service.removeSizeModeLayouts(this.appConfig, pageJson.layout);
        }
        const { pageStructure } = this.appConfig;
        const ps = pageStructure && pageStructure.find(ps => !!ps[pageId]);
        if (ps && ps[pageId].length > 0) {
            ps[pageId].forEach(subPId => {
                this.removePage(subPId);
                // this.orderPageToPage(subPId, Object.keys(pageStructure[pageStructure.length - 1])[0], 'bottom');
            });
        }
        this.removePageFromPageStructure(pageId);
        this.appConfig = this.appConfig.set('pages', this.appConfig.pages.without(pageId));
        // set new home page if current page is default
        if (newHomePageId) {
            this.setHomePage(newHomePageId);
        }
        return this;
    }
    setHomePage(pageId) {
        return this.editPageProperty(pageId, 'isDefault', true);
    }
    setUseAutoSortInFixedLayout(value) {
        this.appConfig = this.appConfig.set('useAutoSortInFixedLayout', value);
        return this;
    }
    replaceHomePage(pageId) {
        // eslint-disable-next-line
        Object.keys(this.appConfig.pages).some((key, i) => {
            const pageJson = this.appConfig.pages[key];
            if (pageJson.isDefault) {
                this.editPageProperty(pageJson.id, 'isDefault', false);
                return true;
            }
        });
        return this.editPageProperty(pageId, 'isDefault', true);
    }
    // #endregion
    // #region Dialog APIs
    editDialog(dialogJson) {
        // update dialogs' index and config order when mode is changed.
        const prevDilgMode = this.appConfig.dialogs[dialogJson.id].mode;
        if (prevDilgMode !== dialogJson.mode) {
            const dialogs = this.appConfig.dialogs.asMutable({ deep: true });
            Object.keys(dialogs).forEach(dlgId => {
                const dlg = dialogs[dlgId];
                if (dlg.id === dialogJson.id) {
                    dialogs[dlgId] = Object.assign({}, dialogJson.asMutable({ deep: true }), {
                        index: Object.keys(dialogs).filter(dlgId => dialogs[dlgId].mode !== prevDilgMode).length
                    });
                }
                else if (dlg.mode === prevDilgMode) {
                    if (dlg.index > dialogJson.index) {
                        dlg.index = dlg.index - 1;
                    }
                }
            });
            this.appConfig = this.appConfig.set('dialogs', (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(dialogs));
        }
        else {
            this.appConfig = this.appConfig.setIn(['dialogs', dialogJson.id], dialogJson);
        }
        return this;
    }
    editDialogProperty(dlgId, prop, val) {
        if (!this.appConfig.dialogs || !this.appConfig.dialogs[dlgId]) {
            return this;
        }
        let dlgJson = this.appConfig.dialogs[dlgId];
        dlgJson = this.editJsonProperty(dlgJson, prop, val);
        return this.editDialog(dlgJson);
    }
    removeDialog(dialogId) {
        var _a;
        const dialogJson = (_a = this.appConfig.dialogs) === null || _a === void 0 ? void 0 : _a[dialogId];
        if (!dialogJson) {
            return this;
        }
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getServiceFromSizeModeLayout(this.appConfig, dialogJson.layout);
        this.appConfig = service.removeSizeModeLayouts(this.appConfig, dialogJson.layout);
        // update dialogs' order
        const currentDlgMode = dialogJson.mode;
        const currentDlgIndex = dialogJson.index;
        const dialogs = this.appConfig.dialogs.without(dialogId).asMutable({ deep: true });
        Object.keys(dialogs).forEach(dlgId => {
            const dlg = dialogs[dlgId];
            if (dlg.mode === currentDlgMode && dlg.index > currentDlgIndex) {
                dlg.index = dlg.index - 1;
            }
        });
        this.appConfig = this.appConfig.set('dialogs', (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(dialogs));
        return this;
    }
    duplicateDialog(dialogId) {
        const dialogs = this.appConfig.dialogs;
        let newDlgJson = dialogs[dialogId];
        if (!dialogs || !newDlgJson) {
            return null;
        }
        const newDlgId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(this.appConfig, 'dialog');
        const duplicateContext = {};
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getServiceFromSizeModeLayout(this.appConfig, newDlgJson.layout);
        const result = service.duplicateSizeModeLayouts(this.appConfig, newDlgJson.layout, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog, newDlgId, duplicateContext);
        this.appConfig = result[0];
        const sizeModeLayout = result[1];
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, this.appConfig, duplicateContext);
        // get max index for current dialog mode.
        const dlgMaxIndex = Object.keys(Object.keys(dialogs).filter(dlgId => dialogs[dlgId].mode === newDlgJson.mode)).length;
        // duplicate the dialog with unique id and label, index,  and layout copy
        newDlgJson = newDlgJson.set('id', newDlgId)
            .set('index', dlgMaxIndex)
            .set('isSplash', false)
            .set('label', this.getDuplicateLabel('dialog', newDlgJson.label))
            .set('layout', sizeModeLayout);
        this.appConfig = this.appConfig.setIn(['dialogs', newDlgJson.id], newDlgJson);
        return newDlgJson;
    }
    /**
     * Only support reordering dialogs for same mode.
     */
    orderDialogToDialog(dialogId, targetDialogId, type) {
        const dialogs = this.appConfig.dialogs.asMutable({ deep: true });
        const currentDlg = dialogs[dialogId];
        const targetDlg = dialogs[targetDialogId];
        if (!dialogs || !currentDlg || !targetDlg) {
            return this;
        }
        if (targetDialogId === dialogId) {
            console.error('dialogId is same to targetDialogId.');
            return this;
        }
        let newIndex;
        if (targetDlg.index > currentDlg.index) {
            newIndex = type === 'top' ? targetDlg.index - 1 : targetDlg.index;
            Object.keys(dialogs).forEach(dlgId => {
                const dlg = dialogs[dlgId];
                if (dlg.mode === targetDlg.mode && dlg.id !== dialogId && dlg.index > currentDlg.index && dlg.index <= newIndex) {
                    dlg.index = dlg.index - 1;
                }
            });
        }
        else {
            newIndex = type === 'top' ? targetDlg.index : targetDlg.index + 1;
            Object.keys(dialogs).forEach(dlgId => {
                const dlg = dialogs[dlgId];
                if (dlg.mode === targetDlg.mode && dlg.id !== dialogId && dlg.index >= newIndex && dlg.index < currentDlg.index) {
                    dlg.index = dlg.index + 1;
                }
            });
        }
        // update current dialog
        dialogs[dialogId] = Object.assign({}, currentDlg, {
            index: newIndex,
            mode: targetDlg.mode
        });
        this.appConfig = this.appConfig.set('dialogs', (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(dialogs));
        return this;
    }
    replaceSplashDialog(dialogId, splashDialogId) {
        if (splashDialogId) {
            this.editDialogProperty(splashDialogId, 'isSplash', false);
        }
        if (dialogId !== splashDialogId) {
            return this.editDialogProperty(dialogId, 'isSplash', true);
        }
        else {
            return this;
        }
    }
    // #endregion
    // #region Layout APIs
    createLayoutForSizeMode(sizeMode, fromSizeMode, layouts, parentType, parentId, layoutName) {
        var _a;
        if (!layouts || !layouts[fromSizeMode] || layouts[sizeMode]) {
            return null;
        }
        const layoutId = layouts[fromSizeMode];
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, layoutId);
        const result = service.duplicateLayout(this.appConfig, layouts[fromSizeMode], fromSizeMode, sizeMode, null, false);
        if (result[1]) {
            this.appConfig = result[0];
            const newLayoutId = result[1];
            this.appConfig = this.appConfig.setIn(['layouts', newLayoutId, 'parent'], { id: parentId, type: parentType });
            const newLayouts = layouts.set(sizeMode, newLayoutId);
            switch (parentType) {
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog:
                    this.appConfig = this.appConfig.setIn(['dialogs', parentId, 'layout'], newLayouts);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page:
                    this.appConfig = this.appConfig.setIn(['pages', parentId, 'layout'], newLayouts);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Header:
                    this.appConfig = this.appConfig.setIn(['header', 'layout'], newLayouts);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Footer:
                    this.appConfig = this.appConfig.setIn(['footer', 'layout'], newLayouts);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen:
                    this.appConfig = this.appConfig.setIn(['screens', parentId, 'layout'], newLayouts);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View:
                    this.appConfig = this.appConfig.setIn(['views', parentId, 'layout'], newLayouts);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget:
                    {
                        const widgetJson = this.appConfig.widgets[parentId];
                        if ((_a = widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.layouts) === null || _a === void 0 ? void 0 : _a[layoutName]) {
                            this.appConfig = this.appConfig.setIn(['widgets', parentId, 'layouts', layoutName], newLayouts);
                        }
                        break;
                    }
            }
            return newLayouts;
        }
        return null;
    }
    /**
     * Remove the layout and all the embedde layout for the size mode
     * If a widget is only used in current size mode, it should be removed
     * @param layoutId
     * @param sizeMode
     */
    removeSizeModeLayout(layoutId, sizeMode) {
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, layoutId);
        this.appConfig = service.removeLayout(this.appConfig, layoutId, sizeMode);
        return this;
    }
    addNewSectionToLayout(targetLayoutId) {
        const sectionJson = this.createSection();
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, targetLayoutId);
        const result = service.createBlankItem(this.appConfig, targetLayoutId);
        this.appConfig = result[0];
        const newItemId = result[1];
        const newLayoutInfo = { layoutId: targetLayoutId, layoutItemId: newItemId };
        this.editLayoutItemProperty(newLayoutInfo, 'type', jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section)
            .editLayoutItemProperty(newLayoutInfo, 'sectionId', sectionJson.id);
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.sectionService.addParent(this.appConfig, sectionJson.id, newLayoutInfo, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode());
        return newItemId;
    }
    addPlaceholderToLayout(targetLayoutId) {
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, targetLayoutId);
        const result = service.createBlankItem(this.appConfig, targetLayoutId);
        this.appConfig = result[0];
        const newItemId = result[1];
        const newLayoutInfo = { layoutId: targetLayoutId, layoutItemId: newItemId };
        this.editLayoutItemProperty(newLayoutInfo, 'type', jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget);
        return newItemId;
    }
    addNewWidgetToLayout(targetLayoutId, widgetJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const newWidgetJson = yield this.createWidget(widgetJson, true);
            if (newWidgetJson) {
                const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, targetLayoutId);
                const result = service.createBlankItem(this.appConfig, targetLayoutId);
                this.appConfig = result[0];
                const newItemId = result[1];
                const newLayoutInfo = { layoutId: targetLayoutId, layoutItemId: newItemId };
                this.editLayoutItemProperty(newLayoutInfo, 'type', jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget)
                    .editLayoutItemProperty(newLayoutInfo, 'widgetId', newWidgetJson.id);
                const sizeMode = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode();
                this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.addParent(this.appConfig, newWidgetJson.id, newLayoutInfo, sizeMode);
                this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterAdded(this.appConfig, newWidgetJson.id, targetLayoutId, sizeMode, sizeMode);
                return newItemId;
            }
            return null;
        });
    }
    /**
     * Content has been created from template, add it to the layout using this method.
     * @param targetLayoutId
     * @param type
     * @param templateContentId
     * @returns
     */
    addTemplateContentToLayout(targetLayoutId, type, templateContentId) {
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, targetLayoutId);
        const result = service.addContent(this.appConfig, targetLayoutId, templateContentId, type, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode());
        this.appConfig = result[0];
        return { layoutId: targetLayoutId, layoutItemId: result[1] };
    }
    addContentToPlaceholder(placeholderLayoutInfo, type, contentId) {
        const { layoutId } = placeholderLayoutInfo;
        const sizeMode = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode();
        this.editLayoutItemProperty(placeholderLayoutInfo, 'type', type);
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.emptyContentService.setContentId(this.appConfig, placeholderLayoutInfo, contentId, sizeMode);
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(this.appConfig, placeholderLayoutInfo);
        const service = new _app_config_service__WEBPACK_IMPORTED_MODULE_10__.ContentServiceWrapper(this.appConfig, layoutItem);
        this.appConfig = service.afterAdded(layoutId, sizeMode, sizeMode);
        return this;
    }
    duplicateLayoutItemInSameLayout(layoutInfo) {
        const { layoutId } = layoutInfo;
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, layoutId);
        const context = {};
        const currentSizeMode = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode();
        const result = service.duplicateItemInSameLayout(this.appConfig, layoutInfo, currentSizeMode, context);
        this.appConfig = result[0];
        const layoutItemId = result[1];
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, this.appConfig, context);
        // remove the parent of the new content in other size mode
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(this.appConfig, { layoutId, layoutItemId });
        const contentService = new _app_config_service__WEBPACK_IMPORTED_MODULE_10__.ContentServiceWrapper(this.appConfig, layoutItem);
        const allSizeModes = [jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Large, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Medium, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Small];
        allSizeModes.forEach((sizeMode) => {
            if (sizeMode !== currentSizeMode) {
                contentService.removeSizeModeParent(sizeMode);
            }
        });
        return result[1];
    }
    duplicateLayoutItemToOtherLayout(layoutInfo, targetLayoutId) {
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(this.appConfig, layoutInfo);
        const contentService = new _app_config_service__WEBPACK_IMPORTED_MODULE_10__.ContentServiceWrapper(this.appConfig, layoutItem);
        const context = {};
        const currentSizeMode = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode();
        const dupResult = contentService.duplicate(currentSizeMode, context);
        this.appConfig = dupResult[0];
        const newContentId = dupResult[1];
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, this.appConfig, context);
        // the layoutInfo may not from the same size mode
        this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.removeParent(this.appConfig, newContentId, layoutInfo);
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, targetLayoutId);
        const cResult = service.createBlankItem(this.appConfig, targetLayoutId);
        this.appConfig = cResult[0];
        const newItemId = cResult[1];
        const newLayoutInfo = { layoutId: targetLayoutId, layoutItemId: newItemId };
        this.editLayoutItemProperty(newLayoutInfo, 'type', layoutItem.type);
        switch (layoutItem.type) {
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget:
                this.editLayoutItemProperty(newLayoutInfo, 'widgetId', newContentId);
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section:
                this.editLayoutItemProperty(newLayoutInfo, 'sectionId', newContentId);
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.ScreenGroup:
                this.editLayoutItemProperty(newLayoutInfo, 'screenGroupId', newContentId);
                break;
        }
        const newLayoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(this.appConfig, newLayoutInfo);
        const newContentService = new _app_config_service__WEBPACK_IMPORTED_MODULE_10__.ContentServiceWrapper(this.appConfig, newLayoutItem);
        newContentService.addParent(newLayoutInfo, currentSizeMode);
        // remove the parent of the new content in other size mode
        const allSizeModes = [jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Large, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Medium, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Small];
        allSizeModes.forEach((sizeMode) => {
            if (sizeMode !== currentSizeMode) {
                newContentService.removeSizeModeParent(sizeMode);
            }
        });
        this.appConfig = newContentService.getConfig();
        return newItemId;
    }
    /**
     * move a layout item to another layout
     * @param fromLayoutInfo
     * @param toLayoutInfo
     */
    moveLayoutItem(fromLayoutInfo, toLayoutId, fromSizeMode, toSizeMode) {
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, toLayoutId);
        const result = service.moveLayoutItem(this.appConfig, fromLayoutInfo, toLayoutId, fromSizeMode, toSizeMode);
        this.appConfig = result[0];
        return result[1];
    }
    setLayoutItemToPending(layoutInfo, value) {
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(this.appConfig, layoutInfo);
        if (!layoutItem) {
            return this;
        }
        if (value) {
            const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, layoutInfo.layoutId);
            this.appConfig = service.pendItem(this.appConfig, layoutInfo);
        }
        else {
            this.appConfig = this.appConfig.setIn(['layouts', layoutInfo.layoutId, 'content', layoutInfo.layoutItemId, 'isPending'], value);
        }
        return this;
    }
    /**
     *
     * @param layoutInfo
     * @param removeContent false, remove layout item only. true, remove the widget/section in the layout item
     */
    removeLayoutItem(layoutInfo, removeContent, force) {
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, layoutInfo.layoutId);
        this.appConfig = service.removeItem(this.appConfig, layoutInfo, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode(), removeContent, force);
        return this;
    }
    removeLayout(layoutId) {
        return this.removeSizeModeLayout(layoutId, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode());
    }
    clearLayoutContent(layoutId) {
        var _a;
        const layoutJson = this.appConfig.layouts[layoutId];
        if (!layoutJson) {
            return this;
        }
        Object.keys((_a = layoutJson.content) !== null && _a !== void 0 ? _a : {}).forEach(itemId => {
            this.removeLayoutItem({ layoutId, layoutItemId: itemId }, true, false);
        });
        return this;
    }
    /**
     * Duplicate layout and return new layout json.
     * @param layoutId
     * @param duplicateContent
     */
    duplicateLayout(layoutId, duplicateContent) {
        const layoutJson = this.appConfig.layouts[layoutId];
        if (!layoutJson) {
            return null;
        }
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getService(this.appConfig, layoutId);
        const sizeMode = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode();
        const result = service.duplicateLayout(this.appConfig, layoutId, sizeMode, sizeMode, null, duplicateContent);
        this.appConfig = result[0];
        const newLayoutId = result[1];
        return this.appConfig.layouts[newLayoutId];
    }
    editLayoutProperty(layoutId, prop, val) {
        let layoutJson = this.appConfig.layouts[layoutId];
        if (!layoutJson) {
            return this;
        }
        layoutJson = this.editJsonProperty(layoutJson, prop, val);
        this.appConfig = this.appConfig.setIn(['layouts', layoutId], layoutJson);
        return this;
    }
    editLayoutItemProperty(layoutInfo, prop, val) {
        const { layoutId, layoutItemId } = layoutInfo;
        let layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(this.appConfig, layoutInfo);
        if (!layoutItem) {
            return this;
        }
        layoutItem = this.editJsonProperty(layoutItem, prop, val);
        this.appConfig = this.appConfig.setIn(['layouts', layoutId, 'content', layoutItemId], layoutItem);
        return this;
    }
    editLabelOfTocNode(node, label) {
        switch (node.type) {
            case 'view':
                return this.editViewProperty(node.id, 'label', label);
            case 'screen':
                return this.editScreenProperty(node.id, 'label', label);
            case 'widget':
                return this.editWidgetProperty(node.id, 'label', label);
            case 'section':
                return this.editSectionProperty(node.id, 'label', label);
            case 'screenGroup':
                return this.editScreenGroupProperty(node.id, 'label', label);
            case 'layoutItem':
                return this.editLayoutItemProperty({ layoutId: node.layoutId, layoutItemId: node.layoutItemId }, 'label', label);
            default:
                return this;
        }
    }
    editLayoutItemSize(layoutInfo, width, height) {
        var _a;
        if (width === 0 || height === 0) {
            return this;
        }
        const { layoutId, layoutItemId } = layoutInfo;
        const layout = this.appConfig.layouts[layoutId];
        const layoutItem = (_a = layout === null || layout === void 0 ? void 0 : layout.content) === null || _a === void 0 ? void 0 : _a[layoutItemId];
        if (!layout || !layoutItem) {
            return this;
        }
        let setting = layoutItem.setting || (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
        if (layout.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FixedLayout) {
            const bbox = layoutItem.bbox.set('width', `${width}px`).set('height', `${height}px`);
            setting = setting.setIn(['autoProps', 'width'], false).setIn(['autoProps', 'height'], false);
            return this
                .editLayoutItemProperty(layoutInfo, 'bbox', bbox)
                .editLayoutItemProperty(layoutInfo, 'setting', setting);
        }
        else {
            // keep aspect ratio
            setting = setting
                .setIn(['autoProps', 'width'], false)
                .setIn(['autoProps', 'height'], false)
                .set('heightMode', 'ratio')
                .set('aspectRatio', Number((height / width).toFixed(2)));
            return this.editLayoutItemProperty(layoutInfo, 'setting', setting);
        }
    }
    /**
     * This operation only works in fixed layout.
     */
    exchangeWidthAndHeight() {
        var _a, _b, _c, _d, _e;
        // get the selected layout item
        let layoutInfo;
        const state = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState();
        if (window.jimuConfig.isBuilder) {
            layoutInfo = (_b = (_a = state === null || state === void 0 ? void 0 : state.appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appRuntimeInfo) === null || _b === void 0 ? void 0 : _b.selection;
        }
        else {
            layoutInfo = (_c = state === null || state === void 0 ? void 0 : state.appRuntimeInfo) === null || _c === void 0 ? void 0 : _c.selection;
        }
        if (!layoutInfo) {
            return this;
        }
        const { layoutId } = layoutInfo;
        const layout = this.appConfig.layouts[layoutId];
        if ((layout === null || layout === void 0 ? void 0 : layout.type) === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FixedLayout) {
            const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(this.appConfig, layoutInfo);
            if (layoutItem) {
                // exchange width and height
                let bbox = layoutItem.bbox;
                let settingChanged = false;
                let setting = (_d = layoutItem.setting) !== null && _d !== void 0 ? _d : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
                const autoProps = (_e = setting.autoProps) !== null && _e !== void 0 ? _e : { right: true, bottom: true };
                bbox = bbox.set('width', bbox.height).set('height', bbox.width);
                ['left', 'right', 'top', 'bottom'].forEach(prop => {
                    if (autoProps[prop]) {
                        bbox = bbox.without(prop);
                    }
                });
                this.editLayoutItemProperty(layoutInfo, 'bbox', bbox);
                // exchange autoProps of width and height
                if (autoProps.width != null || autoProps.height != null) {
                    setting = setting.setIn(['autoProps', 'width'], autoProps.height)
                        .setIn(['autoProps', 'height'], autoProps.width);
                    settingChanged = true;
                }
                // set keep aspect ratio to false
                if (setting.heightMode === 'ratio') {
                    setting = setting.set('heightMode', 'fixed');
                    settingChanged = true;
                }
                if (settingChanged) {
                    this.editLayoutItemProperty(layoutInfo, 'setting', setting);
                }
            }
        }
        return this;
    }
    adjustOrderOfItem(layoutInfo, insertIndex) {
        const { layoutId, layoutItemId } = layoutInfo;
        const layout = this.appConfig.layouts[layoutId];
        let order = [].concat(layout.order || []);
        if (order.includes(layoutItemId)) {
            order = order.filter(item => item !== layoutItemId);
        }
        if (insertIndex != null && insertIndex >= 0 && insertIndex <= order.length) {
            order.splice(insertIndex, 0, layoutItemId);
        }
        else {
            order.push(layoutItemId);
        }
        this.appConfig = this.appConfig.setIn(['layouts', layoutId, 'order'], order);
        return this;
    }
    createLayout(type) {
        const service = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.LayoutServiceProvider.getInstance().getServiceByType(type);
        const result = service.createBlankLayout(this.appConfig, type);
        this.appConfig = result[0];
        return result[1];
    }
    // #endregion
    // #region Template APIs
    createPageFromTemplate(templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            const result = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.templateService.createPageFromTemplate(this.appConfig, templateJson, context);
            this.appConfig = result[0];
            const pageId = result[1];
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
            return pageId;
        });
    }
    createDialogFromTemplate(templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            const result = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.templateService.createDialogFromTemplate(this.appConfig, templateJson, context);
            this.appConfig = result[0];
            const dialogId = result[1];
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
            return dialogId;
        });
    }
    applyHeaderTemplate(templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            this.appConfig = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.templateService.applyTemplateToHeader(this.appConfig, templateJson, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode(), context);
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
        });
    }
    applyFooterTemplate(templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            this.appConfig = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.templateService.applyTemplateToFooter(this.appConfig, templateJson, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode(), context);
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
        });
    }
    applyPageBodyTemplate(pageId, templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            this.appConfig = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.templateService.applyTemplateToBody(this.appConfig, pageId, templateJson, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode(), context);
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
        });
    }
    applyDialogTemplate(dialogId, templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            this.appConfig = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.templateService.applyTemplateToDialog(this.appConfig, dialogId, templateJson, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode(), context);
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
        });
    }
    applyGridTemplate(widgetId, templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            this.appConfig = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.templateService.applyGridTemplate(this.appConfig, widgetId, templateJson, jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode(), context);
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
        });
    }
    createScreenFromTemplate(screenId, templateJson) {
        return __awaiter(this, void 0, void 0, function* () {
            const context = {};
            const result = yield _app_config_service__WEBPACK_IMPORTED_MODULE_10__.screenGroupService.createScreenFromTemplate(this.appConfig, templateJson, screenId, [jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getCurrentSizeMode()], context);
            this.appConfig = result[0];
            this.appConfig = _app_config_service__WEBPACK_IMPORTED_MODULE_10__.widgetService.afterBatchCopied(this.appConfig, templateJson.config, context);
            // TODO
            // if screens in this screenGroup has multiple size mode, we should sync all size mode of the new screen with others
            return result[1];
        });
    }
    // #endregion
    /**
     * Copy the parent use datasource to children widgets
     * @param parentWidgetId
     */
    copyUseDataSourceToAllChildWidgets(oldParentWidgetJson, newParentWidgetJson) {
        const allChildrenWidgets = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.getChildrenContents(this.appConfig, newParentWidgetJson.id, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget, true);
        // TODO parent widget support one ds only for now!
        const newUseDs = newParentWidgetJson.useDataSources && newParentWidgetJson.useDataSources.map(useDs => {
            return useDs.set('fields', []);
        })[0];
        const oldUseDs = oldParentWidgetJson.useDataSources && oldParentWidgetJson.useDataSources.map(useDs => {
            return useDs.set('fields', []);
        })[0];
        if (newUseDs && oldUseDs && newUseDs.dataSourceId === oldUseDs.dataSourceId) {
            return this;
        }
        allChildrenWidgets.forEach(widgetId => {
            let widgetJson = this.appConfig.widgets[widgetId];
            // remove old
            if (widgetJson.useDataSources && oldUseDs && widgetJson.useDataSources.find(useDs => useDs.dataSourceId === oldUseDs.dataSourceId)) {
                widgetJson = widgetJson.set('useDataSources', widgetJson.useDataSources.filter(useDs => useDs.dataSourceId !== oldUseDs.dataSourceId));
            }
            if (newUseDs) {
                widgetJson = widgetJson.set('useDataSources', widgetJson.useDataSources ? widgetJson.useDataSources.concat(newUseDs) : [newUseDs])
                    .set('useDataSourcesEnabled', true);
            }
            this.appConfig = this.appConfig.setIn(['widgets', widgetId], widgetJson);
        });
        return this;
    }
    // #endregion
    // #region Datasource APIs
    addDataSource(dataSourceJson) {
        if (this.appConfig.dataSources && this.appConfig.dataSources[dataSourceJson.id]) {
            return this;
        }
        this.appConfig = this.appConfig.setIn(['dataSources', dataSourceJson.id], dataSourceJson);
        return this;
    }
    addDataSources(dataSourceJsons) {
        dataSourceJsons.forEach(dataSourceJson => {
            if (!this.appConfig.dataSources || !this.appConfig.dataSources[dataSourceJson.id]) {
                this.appConfig = this.appConfig.setIn(['dataSources', dataSourceJson.id], dataSourceJson);
            }
        });
        return this;
    }
    addUtility(utility) {
        var _a;
        let utilities = (_a = this.appConfig.utilities) !== null && _a !== void 0 ? _a : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
        utilities = utilities.set(utility.id, utility);
        this.appConfig = this.appConfig.set('utilities', utilities);
        return this;
    }
    removeUtility(utilityId) {
        var _a;
        let utilities = (_a = this.appConfig.utilities) !== null && _a !== void 0 ? _a : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
        utilities = utilities.without(utilityId);
        this.appConfig = this.appConfig.set('utilities', utilities);
        return this;
    }
    updateUtilities(utilities) {
        this.appConfig = this.appConfig.set('utilities', utilities);
        return this;
    }
    removeUseMapWidgetId(mapWidgetId) {
        Object.keys(this.appConfig.widgets).forEach((widgetId) => {
            var _a;
            const widgetJson = this.appConfig.widgets[widgetId];
            if ((_a = widgetJson.useMapWidgetIds) === null || _a === void 0 ? void 0 : _a.includes(mapWidgetId)) {
                const useMapWidgetIds = widgetJson.useMapWidgetIds.filter((id) => id !== mapWidgetId);
                this.appConfig = this.appConfig.setIn(['widgets', widgetId, 'useMapWidgetIds'], useMapWidgetIds);
            }
        });
        return this.appConfig;
    }
    removeDataSource(dataSourceId) {
        if (!this.appConfig.dataSources || !this.appConfig.dataSources[dataSourceId]) {
            return this;
        }
        this.appConfig = this.appConfig.set('dataSources', this.appConfig.dataSources.without(dataSourceId));
        // update widget use data source
        this.appConfig.widgets && Object.entries(this.appConfig.widgets).forEach(([wId, wJson]) => {
            if (wJson.useDataSources && wJson.useDataSources.find(useDs => this.isUseDataSourceShouldBeRemoved(useDs, dataSourceId))) {
                this.appConfig = this.appConfig.setIn(['widgets', wId, 'useDataSources'], wJson.useDataSources.filter(useDs => !this.isUseDataSourceShouldBeRemoved(useDs, dataSourceId)));
            }
        });
        // update widget output data source
        this.appConfig.widgets && Object.entries(this.appConfig.widgets).forEach(([wId, wJson]) => {
            if (wJson.outputDataSources && wJson.outputDataSources.find(outDsId => outDsId === dataSourceId)) {
                this.appConfig = this.appConfig.setIn(['widgets', wId, 'outputDataSources'], wJson.outputDataSources.filter(outDsId => outDsId !== dataSourceId));
            }
        });
        // update message use data source
        this.appConfig.messageConfigs && Object.keys(this.appConfig.messageConfigs).forEach(mcId => {
            var _a;
            const mJson = this.appConfig.messageConfigs[mcId];
            const actions = (_a = mJson.actions) === null || _a === void 0 ? void 0 : _a.asMutable({ deep: true });
            actions === null || actions === void 0 ? void 0 : actions.forEach((action, index) => {
                var _a;
                if ((_a = action === null || action === void 0 ? void 0 : action.useDataSources) === null || _a === void 0 ? void 0 : _a.find(useDs => this.isUseDataSourceShouldBeRemoved(useDs, dataSourceId))) {
                    actions[index].useDataSources = action.useDataSources.filter(useDs => !this.isUseDataSourceShouldBeRemoved(useDs, dataSourceId));
                    this.appConfig = this.appConfig.setIn(['messageConfigs', mcId, 'actions'], actions);
                }
            });
        });
        // remove output data source
        Object.entries(this.appConfig.dataSources).forEach(([dsId, dsJson]) => {
            if (dsJson.originDataSources && !!dsJson.originDataSources.find(useDs => this.isUseDataSourceShouldBeRemoved(useDs, dataSourceId))) {
                this.removeDataSource(dsId);
            }
        });
        return this;
    }
    isUseDataSourceShouldBeRemoved(useDs, realToBeRemovedDsId) {
        /**
         * Remove data source which is:
         *  1. the data source to be removed, or,
         *  2. derived from the data source to be removed (data views and local data sources), or,
         *  3. descendant data source of the data source to be removed (e.g. child data source and grandchild data source), or,
         *  4. derived from the descendant data source of the data source to be removed (e.g. data views of child data source).
         */
        return !useDs || (useDs.dataSourceId === realToBeRemovedDsId || useDs.mainDataSourceId === realToBeRemovedDsId || useDs.rootDataSourceId === realToBeRemovedDsId);
    }
    editDataSource(dataSourceJson) {
        this.appConfig = this.appConfig.setIn(['dataSources', dataSourceJson.id], dataSourceJson);
        return this;
    }
    /**
     * Duplicate the datasourcen and return the new datasource. The new datasource has been added to app config
     * @param dataSourceId
     */
    duplicateDataSource(dataSourceId) {
        if (!this.appConfig.dataSources || !this.appConfig.dataSources[dataSourceId]) {
            return null;
        }
        const dsJson = this.appConfig.dataSources[dataSourceId];
        const newDsJson = dsJson.set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(this.appConfig, 'dataSource'))
            .set('label', this.getDuplicateLabel('dataSource', dsJson.label));
        this.addDataSource(newDsJson);
        return newDsJson;
    }
    // #endregion
    // #region App proxy APIs
    addAppProxy(proxyJson) {
        if (this.appConfig.appProxies && this.appConfig.appProxies[proxyJson.id]) {
            return this;
        }
        this.appConfig = this.appConfig.setIn(['appProxies', proxyJson.id], proxyJson);
        return this;
    }
    editAppProxy(proxyJson) {
        this.appConfig = this.appConfig.setIn(['appProxies', proxyJson.id], proxyJson);
        return this;
    }
    removeAppProxy(appProxyId) {
        if (!this.appConfig.appProxies || !this.appConfig.appProxies[appProxyId]) {
            return this;
        }
        this.appConfig = this.appConfig.set('appProxies', this.appConfig.appProxies.without(appProxyId));
        return this;
    }
    // #endregion
    // #region Message action APIs
    addMessage(messageJson) {
        this.appConfig = this.appConfig.setIn(['messageConfigs', messageJson.id], messageJson);
        return this;
    }
    editMessage(messageJson) {
        this.appConfig = this.appConfig.setIn(['messageConfigs', messageJson.id], messageJson);
        return this;
    }
    removeMessage(messageJson) {
        if (!this.appConfig.messageConfigs || !this.appConfig.messageConfigs[messageJson.id]) {
            return this;
        }
        this.appConfig = this.appConfig.set('messageConfigs', this.appConfig.messageConfigs.without(messageJson.id));
        return this;
    }
    // #endregion
    // #region Theme APIs
    editTheme(themeName) {
        this.appConfig = this.appConfig.set('theme', themeName);
        return this;
    }
    editCustomTheme(customTheme) {
        this.appConfig = this.appConfig.set('customTheme', customTheme);
        return this;
    }
    editCustomThemeOption(themeOption) {
        this.appConfig = this.appConfig.set('customThemeOptions', themeOption);
        return this;
    }
    // #endregion
    // #region Header APIs, Footer APIs
    initHeaderLayout() {
        const layoutId = this.createLayout(jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FixedLayout);
        this.editLayoutProperty(layoutId, 'setting.lockDescendants', true);
        this.appConfig = this.appConfig
            .setIn(['layouts', layoutId, 'parent'], { id: '', type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Header })
            .setIn(['header', 'layout', this.appConfig.mainSizeMode], layoutId);
        return this;
    }
    editHeaderProperty(prop, val) {
        let header = this.appConfig.header;
        if (!header) {
            return this;
        }
        header = this.editJsonProperty(header, prop, val);
        this.appConfig = this.appConfig.set('header', header);
        return this;
    }
    initFooterLayout() {
        const layoutId = this.createLayout(jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FixedLayout);
        this.editLayoutProperty(layoutId, 'setting.lockDescendants', true);
        this.appConfig = this.appConfig
            .setIn(['layouts', layoutId, 'parent'], { id: '', type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Footer })
            .setIn(['footer', 'layout', this.appConfig.mainSizeMode], layoutId);
        return this;
    }
    editFooterProperty(prop, val) {
        let footer = this.appConfig.footer;
        if (!footer) {
            return this;
        }
        footer = this.editJsonProperty(footer, prop, val);
        this.appConfig = this.appConfig.set('footer', footer);
        return this;
    }
    // #endregion
    // #region Other APIs
    setViewportSize(browserSizeMode, size) {
        this.appConfig = this.appConfig.setIn(['forBuilderAttributes', 'viewPortSize', browserSizeMode], size);
        return this;
    }
    setLockLayout(lockLayout) {
        this.appConfig = this.appConfig.setIn(['forBuilderAttributes', 'lockLayout'], lockLayout);
        return this;
    }
    editAttributes(attributesJson) {
        this.appConfig = this.appConfig.setIn(['attributes'], attributesJson);
        return this;
    }
    // #endregion
    // #region UrlParameters
    updateUrlParamsConfig(urlParams) {
        if (!this.appConfig.urlParams) {
            this.appConfig = this.appConfig.set('urlParams', ({})); // default value is empty object
        }
        const urlParamsConfigs = this.appConfig.urlParams.merge((urlParams));
        this.appConfig = this.appConfig.set('urlParams', urlParamsConfigs);
        return this;
    }
    // #endregion UrlParameters
    // #region Private methods
    getDuplicateLabel(type, label) {
        const [prefix] = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.parseUniqueLabel(label);
        let newLabel = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(this.appConfig, type, prefix);
        if (newLabel === prefix) {
            newLabel = `${prefix} 1`;
        }
        return newLabel;
    }
    removePageFromPageStructure(pageId) {
        if (!this.appConfig.pageStructure) {
            return this;
        }
        const ps = this.appConfig.pageStructure.find(ps => !!ps[pageId]);
        if (ps) {
            this.appConfig = this.appConfig.set('pageStructure', this.appConfig.pageStructure.flatMap(item => item[pageId] ? [] : [item]));
        }
        else {
            this.appConfig.pageStructure.forEach((ps, i) => {
                const pId = Object.keys(ps).find(pId => ps[pId].includes(pageId));
                if (pId) {
                    this.appConfig = this.appConfig.setIn(['pageStructure', i + '', pId], ps[pId].flatMap(subPid => subPid === pageId ? [] : [subPid]));
                    return true;
                }
            });
        }
        return this;
    }
    movePageIntoPageForPageStructure(subPageId, parentPageId) {
        if (!this.appConfig.pageStructure) {
            return this;
        }
        // eslint-disable-next-line
        this.appConfig.pageStructure.some((ps, i) => {
            const pId = Object.keys(ps).find(pId => pId === parentPageId);
            if (pId) {
                this.appConfig = this.appConfig.setIn(['pageStructure', i + '', pId], this.appConfig.pageStructure[i][pId].concat([subPageId]));
                return true;
            }
        });
        return this;
    }
    editJsonProperty(json, prop, value) {
        if (!json) {
            return json;
        }
        const props = prop.split('.').filter(item => item !== '');
        if (props.length > 0) {
            if (json.getIn(props) === value) {
                return json;
            }
            if (value == null) {
                // remove the property
                if (props.length === 1) {
                    return json.without(props[0]);
                }
                const lastProp = props.pop();
                const remainValue = json.getIn(props);
                return json.setIn(props, remainValue.without(lastProp));
            }
            return json.setIn(props, value);
        }
        return json;
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/base-content-service.ts":
/*!*************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/base-content-service.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BaseContentService: () => (/* binding */ BaseContentService)
/* harmony export */ });
class BaseContentService {
    addParentToList(appConfig, existingParents, parent) {
        if (!existingParents || existingParents.length === 0) {
            return [parent];
        }
        const exists = existingParents.some((info) => info.layoutId === parent.layoutId && info.layoutItemId === parent.layoutItemId);
        if (!exists) {
            // if a content has multiple parents, their layout must have a same parent
            const existingParentLayoutId = existingParents[0].layoutId;
            const existingParentLayout = appConfig.layouts[existingParentLayoutId];
            const addingParentLayout = appConfig.layouts[parent.layoutId];
            if (existingParentLayoutId === parent.layoutId || addingParentLayout.parent.id !== existingParentLayout.parent.id || addingParentLayout.parent.type !== existingParentLayout.parent.type) {
                // replace the existing parents with the new parent
                return [parent];
            }
            const list = [].concat(existingParents, parent);
            return list;
        }
        return existingParents;
    }
    removeParentFromList(existingParents, parent) {
        if (!existingParents || existingParents.length === 0) {
            return [];
        }
        return existingParents.filter((item) => item.layoutId !== parent.layoutId || item.layoutItemId !== parent.layoutItemId);
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/base-layout-service.ts":
/*!************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/base-layout-service.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BaseLayoutService: () => (/* binding */ BaseLayoutService)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _empty_content_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./empty-content-service */ "./jimu-for-builder/lib/app-config-service/empty-content-service.ts");
/* harmony import */ var _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./content-service-wrapper */ "./jimu-for-builder/lib/app-config-service/content-service-wrapper.ts");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jimu-layouts/layout-runtime */ "jimu-layouts/layout-runtime");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/app-config-service/util.ts");
/* harmony import */ var _layout_service_provider__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./layout-service-provider */ "./jimu-for-builder/lib/app-config-service/layout-service-provider.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







class BaseLayoutService {
    /**
     * Create a blank layout.
     * @param appConfig
     * @param type
     * @returns
     */
    createBlankLayout(appConfig, type) {
        const layoutId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_3__.getUniqueId(appConfig, 'layout');
        const layoutJson = {
            id: layoutId,
            content: {},
            type
        };
        console.debug('create a blank layout with type', type);
        const updatedConfig = appConfig.setIn(['layouts', layoutId], layoutJson);
        return [updatedConfig, layoutId];
    }
    /**
     * Duplicate a layout.
     * If duplicateContent is true, the content of the layout will be duplicated.
     * If duplicateContent is false, a new parent will be added to the content.
     *   - If the content is a layout widget, a new layout widget will be created under the toSizeMode.
     *   - If the content has embedded layout, the embedded layout will be duplicated.
     * @param appConfig
     * @param layoutId
     * @param fromSizeMode
     * @param toSizeMode
     * @param context
     * @param duplicateContent
     * @returns
     */
    duplicateLayout(appConfig, layoutId, fromSizeMode, toSizeMode, context, duplicateContent) {
        var _a;
        const layoutJson = appConfig.layouts[layoutId];
        if (!layoutJson) {
            return [appConfig, null];
        }
        const newLayoutJson = layoutJson.set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_3__.getUniqueId(appConfig, 'layout'));
        let updatedAppConfig = appConfig.setIn(['layouts', newLayoutJson.id], newLayoutJson);
        console.debug('duplicate layout', layoutId, ', from size mode', fromSizeMode, ', to size mode', toSizeMode);
        // duplicate content
        Object.keys((_a = newLayoutJson.content) !== null && _a !== void 0 ? _a : {}).forEach(itemId => {
            var _a;
            const layoutItem = newLayoutJson.content[itemId];
            if (layoutItem.isPending) {
                // no need to duplicate pending item
                const layout = updatedAppConfig.layouts[newLayoutJson.id];
                updatedAppConfig = updatedAppConfig.setIn(['layouts', layout.id, 'content'], layout.content.without(itemId));
                if ((_a = layout.order) === null || _a === void 0 ? void 0 : _a.includes(itemId)) {
                    const order = layout.order.filter(id => id !== itemId);
                    updatedAppConfig = updatedAppConfig.setIn(['layouts', layout.id, 'order'], order);
                }
            }
            else {
                if (duplicateContent) {
                    updatedAppConfig = this.duplicateAndReplaceContent(updatedAppConfig, { layoutId, layoutItemId: itemId }, { layoutId: newLayoutJson.id, layoutItemId: itemId }, fromSizeMode, toSizeMode, context);
                }
                else {
                    const service = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(updatedAppConfig, layoutItem);
                    // duplicate embed layout content if any
                    const result = service.duplicateEmbedLayout(fromSizeMode, toSizeMode);
                    updatedAppConfig = result[0];
                    if (result[1]) { // new layout widget id
                        const newLayoutItem = layoutItem.set('widgetId', result[1]);
                        updatedAppConfig = updatedAppConfig.setIn(['layouts', newLayoutJson.id, 'content', itemId], newLayoutItem);
                        const service2 = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(updatedAppConfig, newLayoutItem);
                        // update parentInfo, each content adds a parent layoutInfo
                        updatedAppConfig = service2.addParent({ layoutId: newLayoutJson.id, layoutItemId: itemId }, toSizeMode);
                    }
                    else {
                        // update parentInfo, each content adds a parent layoutInfo
                        updatedAppConfig = service.addParent({ layoutId: newLayoutJson.id, layoutItemId: itemId }, toSizeMode);
                    }
                }
            }
        });
        if (fromSizeMode !== toSizeMode) {
            // TODO transform the layout?
            const layoutJson = this.transformLayout(updatedAppConfig, updatedAppConfig.layouts[newLayoutJson.id], fromSizeMode, toSizeMode);
            updatedAppConfig = updatedAppConfig.setIn(['layouts', newLayoutJson.id], layoutJson);
        }
        return [updatedAppConfig, newLayoutJson.id];
    }
    duplicateSizeModeLayouts(appConfig, layouts, parentType, parentId, context) {
        let updatedAppConfig = appConfig;
        const outputLayouts = {};
        Object.keys(layouts !== null && layouts !== void 0 ? layouts : {}).forEach((mode) => {
            const layoutId = layouts[mode];
            const result = this.duplicateLayout(updatedAppConfig, layoutId, mode, mode, context, true);
            updatedAppConfig = result[0];
            outputLayouts[mode] = result[1];
            if (result[1] != null) {
                updatedAppConfig = updatedAppConfig.setIn(['layouts', result[1], 'parent'], { type: parentType, id: parentId });
            }
        });
        return [updatedAppConfig, outputLayouts];
    }
    /**
     * Duplicate the content in origin layoutItem and replace the content in des layoutItem.
     * @param appConfig
     * @param originLayoutId
     * @param desLayoutId
     * @param originItemId
     * @param desItemId
     * @param fromSizeMode
     * @param toSizeMode
     * @param context
     * @returns
     */
    duplicateAndReplaceContent(appConfig, originLayoutInfo, desLayoutInfo, fromSizeMode, toSizeMode, context) {
        const { layoutId: originLayoutId, layoutItemId: originItemId } = originLayoutInfo;
        const { layoutId: desLayoutId, layoutItemId: desItemId } = desLayoutInfo;
        if (!appConfig.layouts || !appConfig.layouts[originLayoutId] || !appConfig.layouts[desLayoutId]) {
            return appConfig;
        }
        const oriLayoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(appConfig, {
            layoutId: originLayoutId,
            layoutItemId: originItemId
        });
        // 1. duplicate content
        const service = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(appConfig, oriLayoutItem);
        const result = service.duplicate(toSizeMode, context);
        let updatedAppConfig = result[0];
        const contentId = result[1];
        // 2. set content to layout item
        updatedAppConfig = updatedAppConfig.setIn(['layouts', desLayoutId, 'content', desItemId, 'type'], oriLayoutItem.type);
        updatedAppConfig = _empty_content_service__WEBPACK_IMPORTED_MODULE_1__["default"].setContentId(updatedAppConfig, { layoutId: desLayoutId, layoutItemId: desItemId }, contentId, toSizeMode);
        // 3. update the parent info of the duplicated content
        const desLayoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(updatedAppConfig, desLayoutInfo);
        const service2 = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(updatedAppConfig, desLayoutItem);
        service2.removeParent({
            layoutId: originLayoutId,
            layoutItemId: originItemId
        }, fromSizeMode);
        return service2.getConfig();
    }
    addContent(appConfig, layoutId, contentId, type, sizeMode) {
        const result = this.createBlankItem(appConfig, layoutId);
        let updatedAppConfig = result[0];
        const newItemId = result[1];
        console.debug(`add ${contentId} to ${layoutId}`);
        updatedAppConfig = updatedAppConfig
            .setIn(['layouts', layoutId, 'content', newItemId, 'type'], type);
        const layoutInfo = { layoutId, layoutItemId: newItemId };
        updatedAppConfig = _empty_content_service__WEBPACK_IMPORTED_MODULE_1__["default"].setContentId(updatedAppConfig, layoutInfo, contentId, sizeMode);
        updatedAppConfig = this.afterItemAdded(updatedAppConfig, layoutInfo, sizeMode, sizeMode);
        return [updatedAppConfig, newItemId];
    }
    removeLayout(appConfig, layoutId, sizeMode) {
        var _a;
        const layoutJson = appConfig.layouts[layoutId];
        if (!layoutJson) {
            return appConfig;
        }
        let updatedAppConfig = appConfig;
        console.debug('remove layout', layoutId, 'in size mode', sizeMode);
        Object.keys((_a = layoutJson.content) !== null && _a !== void 0 ? _a : {}).forEach(itemId => {
            updatedAppConfig = this.removeItem(updatedAppConfig, { layoutId: layoutId, layoutItemId: itemId }, sizeMode, true, false);
        });
        updatedAppConfig = this.removeLayoutIdFromParent(updatedAppConfig, layoutId, sizeMode);
        updatedAppConfig = updatedAppConfig.setIn(['layouts'], updatedAppConfig.layouts.without(layoutId));
        return updatedAppConfig;
    }
    removeSizeModeLayouts(appConfig, layouts) {
        let updatedAppConfig = appConfig;
        Object.keys(layouts).forEach((mode) => {
            const layoutId = layouts[mode];
            updatedAppConfig = this.removeLayout(updatedAppConfig, layoutId, mode);
        });
        return updatedAppConfig;
    }
    removeLayoutIdFromParent(appConfig, layoutId, sizeMode) {
        var _a, _b, _c;
        const layoutJson = appConfig.layouts[layoutId];
        if (!layoutJson) {
            return appConfig;
        }
        let updatedAppConfig = appConfig;
        // remove it from its parent
        const parentId = (_a = layoutJson.parent) === null || _a === void 0 ? void 0 : _a.id;
        switch ((_b = layoutJson.parent) === null || _b === void 0 ? void 0 : _b.type) {
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Header:
                if (updatedAppConfig.header.layout[sizeMode] === layoutId) {
                    console.debug('remove layout', layoutId, 'from header, in size mode', sizeMode);
                    updatedAppConfig = updatedAppConfig.setIn(['header', 'layout'], updatedAppConfig.header.layout.without(sizeMode));
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Footer:
                if (updatedAppConfig.footer.layout[sizeMode] === layoutId) {
                    console.debug('remove layout', layoutId, 'from footer, in size mode', sizeMode);
                    updatedAppConfig = updatedAppConfig.setIn(['footer', 'layout'], updatedAppConfig.footer.layout.without(sizeMode));
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog:
                if (updatedAppConfig.dialogs[parentId].layout[sizeMode] === layoutId) {
                    console.debug('remove layout', layoutId, 'from dialog', parentId, ', in size mode', sizeMode);
                    updatedAppConfig = updatedAppConfig.setIn(['dialogs', parentId, 'layout'], updatedAppConfig.dialogs[parentId].layout.without(sizeMode));
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page:
                if (updatedAppConfig.pages[parentId].layout[sizeMode] === layoutId) {
                    console.debug('remove layout', layoutId, 'from page', parentId, ', in size mode', sizeMode);
                    updatedAppConfig = updatedAppConfig.setIn(['pages', parentId, 'layout'], updatedAppConfig.pages[parentId].layout.without(sizeMode));
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View:
                if (updatedAppConfig.views[parentId].layout[sizeMode] === layoutId) {
                    console.debug('remove layout', layoutId, 'from view', parentId, ', in size mode', sizeMode);
                    updatedAppConfig = updatedAppConfig.setIn(['views', parentId, 'layout'], updatedAppConfig.views[parentId].layout.without(sizeMode));
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen:
                if (updatedAppConfig.screens[parentId].main.layout[sizeMode] === layoutId) {
                    console.debug('remove layout', layoutId, 'from screen main', parentId, ', in size mode', sizeMode);
                    updatedAppConfig = updatedAppConfig.setIn(['screens', parentId, 'main', 'layout'], updatedAppConfig.screens[parentId].main.layout.without(sizeMode));
                }
                if ((_c = updatedAppConfig.screens[parentId].panel) === null || _c === void 0 ? void 0 : _c.layout) {
                    if (updatedAppConfig.screens[parentId].panel.layout[sizeMode] === layoutId) {
                        console.debug('remove layout', layoutId, 'from screen panel', parentId, ', in size mode', sizeMode);
                        updatedAppConfig = updatedAppConfig.setIn(['screens', parentId, 'panel', 'layout'], updatedAppConfig.screens[parentId].panel.layout.without(sizeMode));
                    }
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget:
                const widgetJson = updatedAppConfig.widgets[parentId];
                Object.keys(widgetJson.layouts).forEach(name => {
                    const layouts = widgetJson.layouts[name];
                    if (layouts[sizeMode] === layoutId) {
                        console.debug('remove layout', layoutId, 'from widget', parentId, ', in size mode', sizeMode);
                        updatedAppConfig = updatedAppConfig.setIn(['widgets', parentId, 'layouts', name], layouts.without(sizeMode));
                    }
                });
                break;
        }
        return updatedAppConfig;
    }
    replaceLayoutIdInParent(appConfig, parentInfo, oldLayoutId, newLayoutId, sizeMode) {
        let updatedAppConfig = appConfig;
        // update parent, only some of the type can choose template
        console.debug('replace layout', oldLayoutId, 'with new one', newLayoutId, 'in parent', parentInfo.id, sizeMode);
        switch (parentInfo.type) {
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Header:
                if (updatedAppConfig.header.layout[sizeMode] === oldLayoutId) {
                    updatedAppConfig = updatedAppConfig.setIn(['header', 'layout', sizeMode], newLayoutId);
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Footer:
                if (updatedAppConfig.footer.layout[sizeMode] === oldLayoutId) {
                    updatedAppConfig = updatedAppConfig.setIn(['footer', 'layout', sizeMode], newLayoutId);
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog:
                if (updatedAppConfig.dialogs[parentInfo.id].layout[sizeMode] === oldLayoutId) {
                    updatedAppConfig = updatedAppConfig.setIn(['dialogs', parentInfo.id, 'layout', sizeMode], newLayoutId);
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page:
                if (updatedAppConfig.pages[parentInfo.id].layout[sizeMode] === oldLayoutId) {
                    updatedAppConfig = updatedAppConfig.setIn(['pages', parentInfo.id, 'layout', sizeMode], newLayoutId);
                }
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget:
                const widgetJson = updatedAppConfig.widgets[parentInfo.id];
                if (widgetJson) {
                    Object.keys(widgetJson.layouts).some(name => {
                        const sizeModeLayouts = widgetJson.layouts[name];
                        if (sizeModeLayouts[sizeMode] === oldLayoutId) {
                            updatedAppConfig = updatedAppConfig.setIn(['widgets', parentInfo.id, 'layouts', name, sizeMode], newLayoutId);
                            return true;
                        }
                        return false;
                    });
                }
                break;
        }
        return updatedAppConfig;
    }
    transformLayout(appConfig, layoutJson, fromSizeMode, toSizeMode) {
        let extManager;
        if (window.jimuConfig.isBuilder) {
            // because widget's extensions are registered in app only, so we need to get the extension manager from app
            extManager = window._appWindow && window._appWindow._extensionManager;
        }
        else {
            extManager = jimu_core__WEBPACK_IMPORTED_MODULE_0__.ExtensionManager.getInstance();
        }
        const exts = extManager.getExtensions(jimu_core__WEBPACK_IMPORTED_MODULE_0__.extensionSpec.ExtensionPoints.LayoutTransformer);
        if (exts.length > 0) {
            const ext = exts.find((ext) => ext.layoutType === layoutJson.type);
            if (ext && ext.transformLayout) {
                layoutJson = ext.transformLayout(layoutJson, fromSizeMode, toSizeMode, appConfig);
            }
        }
        return layoutJson;
    }
    /**
     * Create a new blank layout item in the given layout. Only id is set in the new layout item.
     * @param appConfig
     * @param layoutId
     * @returns
     */
    createBlankItem(appConfig, layoutId) {
        const nextLayoutItemId = `${jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.utils.getMaximumId(appConfig.layouts[layoutId]) + 1}`;
        const newLayoutItem = {
            id: nextLayoutItemId
        };
        const updatedConfig = appConfig.setIn(['layouts', layoutId, 'content', nextLayoutItemId], newLayoutItem);
        return [updatedConfig, nextLayoutItemId];
    }
    duplicateItemInSameLayout(appConfig, layoutInfo, sizeMode, context) {
        const { layoutId, layoutItemId } = layoutInfo;
        if (!appConfig.layouts || !appConfig.layouts[layoutId]) {
            return [appConfig, null];
        }
        console.debug('duplicate layout item', layoutId, layoutItemId, 'in size mode', sizeMode);
        const oriLayoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(appConfig, {
            layoutId: layoutId,
            layoutItemId: layoutItemId
        });
        const newItemId = `${jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.utils.getMaximumId(appConfig.layouts[layoutId]) + 1}`;
        const newItem = oriLayoutItem.set('id', newItemId);
        let updatedAppConfig = appConfig
            .setIn(['layouts', layoutId, 'content', newItem.id], newItem);
        updatedAppConfig = this.duplicateAndReplaceContent(updatedAppConfig, { layoutId, layoutItemId }, { layoutId, layoutItemId: newItem.id }, sizeMode, sizeMode, context);
        return [updatedAppConfig, newItem.id];
    }
    pendItem(appConfig, layoutInfo) {
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(appConfig, layoutInfo);
        const { layoutId, layoutItemId } = layoutInfo;
        let updatedConfig = appConfig;
        if (layoutItem) {
            updatedConfig = appConfig.setIn(['layouts', layoutId, 'content', layoutItemId, 'isPending'], true);
        }
        return updatedConfig;
    }
    /**
     * Remove a layout item. It has multiple use cases:
     * - do not remove content. Only remove the layout item from the layout and remove if from its content parent.
     *   - when a widget will be removed, its parent layout items should be removed ahead of it.
     * - remove content.
     *   - force is false. Try to remove the content. If the content is used by other layout items, do not remove it.
     *   - force is true. Remove the content directly.
     * @param appConfig
     * @param layoutInfo
     * @param sizeMode
     * @param removeContent
     * @param force
     */
    removeItem(appConfig, layoutInfo, sizeMode, removeContent, force) {
        var _a, _b;
        const { layoutId, layoutItemId } = layoutInfo;
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(appConfig, layoutInfo);
        if (!layoutItem) {
            return appConfig;
        }
        console.debug(`remove layout item, ${layoutId} ${layoutItemId}, removeContent=${removeContent}, force=${force}`);
        // 0. call beforeItemRemoved if any
        let updatedAppConfig = this.beforeItemRemoved(appConfig, layoutInfo);
        // 1. remove content if needed
        const service = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(updatedAppConfig, layoutItem);
        if (removeContent) {
            if (force) {
                service.remove();
            }
            else {
                service.tryRemove(layoutInfo, sizeMode);
            }
        }
        else {
            service.removeParent(layoutInfo, sizeMode);
        }
        updatedAppConfig = service.getConfig();
        // 2. remove layout item
        const lockLayout = (_b = (_a = appConfig.forBuilderAttributes) === null || _a === void 0 ? void 0 : _a.lockLayout) !== null && _b !== void 0 ? _b : false;
        if (lockLayout) {
            if (layoutItem.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget && layoutItem.widgetId) {
                updatedAppConfig = updatedAppConfig.setIn(['layouts', layoutId, 'content', layoutItemId], layoutItem.without('widgetId'));
            }
        }
        else {
            const layoutJson = updatedAppConfig.layouts[layoutId];
            if (layoutJson) { // layout may be removed if it's a blank block in flow layout
                updatedAppConfig = updatedAppConfig.setIn(['layouts', layoutId, 'content'], layoutJson.content.without(layoutItemId));
            }
            // 3. after removed
            updatedAppConfig = this.afterItemRemoved(updatedAppConfig, layoutInfo);
        }
        return updatedAppConfig;
    }
    /**
     * Choose a template to replace the layout.
     * 1. if current size mode is main size mode, replace other size mode layout if it is not set.
     * 2. if current size mode is not main size mode, only replace current size mode layout.
     * @param appConfig
     * @param targetSizeModeLayout
     * @param templatePageJson
     * @param sourceSizeModeLayout
     * @param currentSizeMode
     * @returns
     */
    replaceSizeModeLayout(appConfig, targetSizeModeLayout, templatePageJson, sourceSizeModeLayout, currentSizeMode, parentType, parentId, context) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!sourceSizeModeLayout) {
                return [appConfig, targetSizeModeLayout];
            }
            const isMainSizeMode = currentSizeMode === appConfig.mainSizeMode;
            let updatedAppConfig = appConfig;
            let updatedSizeModeLayout = targetSizeModeLayout;
            let sizemodeKeys;
            if (isMainSizeMode) {
                sizemodeKeys = Object.keys(sourceSizeModeLayout).filter(key => key === currentSizeMode || targetSizeModeLayout[key] == null);
            }
            else {
                sizemodeKeys = [currentSizeMode];
            }
            for (let i = 0; i < sizemodeKeys.length; i += 1) {
                const sizeMode = sizemodeKeys[i];
                const layoutResult = yield this.replaceLayout(updatedAppConfig, updatedSizeModeLayout[sizeMode], templatePageJson, sourceSizeModeLayout[sizeMode], sizeMode, parentType, parentId, context);
                if (layoutResult[1]) {
                    updatedAppConfig = layoutResult[0];
                    updatedSizeModeLayout = updatedSizeModeLayout.set(sizeMode, layoutResult[1]);
                }
            }
            // replace current size mode layout using main size mode if it is not set
            if (sourceSizeModeLayout[currentSizeMode] == null) {
                // no template defined for current size mode
                const layoutResult = yield this.replaceLayout(updatedAppConfig, updatedSizeModeLayout[currentSizeMode], templatePageJson, sourceSizeModeLayout[updatedAppConfig.mainSizeMode], currentSizeMode, parentType, parentId, context);
                updatedAppConfig = layoutResult[0];
                updatedSizeModeLayout = updatedSizeModeLayout.set(currentSizeMode, layoutResult[1]);
            }
            return [updatedAppConfig, updatedSizeModeLayout];
        });
    }
    /**
     * Use the layout in sourceLayout to replace the targetLayout
     * @param appConfig
     * @param targetLayoutId
     * @param templatePageJson
     * @param sourceLayoutId
     * @param browserSizeMode
     */
    replaceLayout(appConfig, targetLayoutId, templatePageJson, sourceLayoutId, sizeMode, parentType, parentId, context) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            if (((_b = (_a = templatePageJson.config) === null || _a === void 0 ? void 0 : _a.layouts) === null || _b === void 0 ? void 0 : _b[sourceLayoutId]) == null) {
                return [appConfig, null];
            }
            console.debug(`replace ${targetLayoutId} with template ${sourceLayoutId} in ${sizeMode}`);
            let updatedAppConfig = appConfig;
            if ((_c = appConfig.layouts) === null || _c === void 0 ? void 0 : _c[targetLayoutId]) {
                const targetLayout = appConfig.layouts[targetLayoutId];
                if ((targetLayout === null || targetLayout === void 0 ? void 0 : targetLayout.content) && Object.keys(targetLayout.content).length > 0) {
                    // Do not replace non-empty layout
                    return [appConfig, null];
                }
                updatedAppConfig = updatedAppConfig.set('layouts', updatedAppConfig.layouts.without(targetLayoutId));
            }
            // target layout does not exist, create one for it
            const result = yield this.createLayoutFromTemplate(updatedAppConfig, templatePageJson, sourceLayoutId, sizeMode, parentType, parentId, context);
            updatedAppConfig = result[0];
            const newLayoutId = result[1];
            updatedAppConfig = this.replaceLayoutIdInParent(updatedAppConfig, { type: parentType, id: parentId }, targetLayoutId, newLayoutId, sizeMode);
            return [updatedAppConfig, newLayoutId];
        });
    }
    createLayoutFromTemplate(appConfig, templateJson, layoutId, sizeMode, parentType, parentId, context) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            let updatedAppConfig = appConfig;
            yield (0,_util__WEBPACK_IMPORTED_MODULE_5__.makeSureTemplateConfig)(templateJson);
            console.debug('create layout', layoutId, 'from template');
            const templateConfig = templateJson.config;
            const templateLayout = templateConfig.layouts[layoutId];
            const nextLayoutId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_3__.getUniqueId(appConfig, 'layout');
            updatedAppConfig = updatedAppConfig.setIn(['layouts', nextLayoutId], templateLayout)
                .setIn(['layouts', nextLayoutId, 'id'], nextLayoutId)
                .setIn(['layouts', nextLayoutId, 'parent'], { type: parentType, id: parentId });
            const items = templateLayout.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.GridLayout
                ? Object.keys(templateLayout.content || {})
                : ((_a = templateLayout.order) !== null && _a !== void 0 ? _a : []);
            for (let i = 0; i < items.length; i++) {
                const itemId = items[i];
                const layoutItem = templateLayout.content[itemId];
                const service = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(updatedAppConfig, layoutItem);
                const result = yield service.createFromTemplate(templateJson, [sizeMode], context, { isBlock: templateLayout.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FlowLayout });
                updatedAppConfig = result[0];
                const newContentId = result[1];
                updatedAppConfig = _empty_content_service__WEBPACK_IMPORTED_MODULE_1__["default"].setContentId(updatedAppConfig, { layoutId: nextLayoutId, layoutItemId: itemId }, newContentId, sizeMode);
            }
            return [updatedAppConfig, nextLayoutId];
        });
    }
    // provided by subclass
    getTocStructure(appConfig, layoutId) {
        return null;
    }
    // should be invoked by the layout service of the toLayoutId
    moveLayoutItem(appConfig, fromLayoutInfo, toLayoutId, fromSizeMode, toSizeMode) {
        var _a, _b, _c, _d;
        const movingLayoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(appConfig, fromLayoutInfo);
        if (!movingLayoutItem) {
            return [appConfig, null];
        }
        let updatedAppConfig = appConfig;
        const fromLayout = appConfig.layouts[fromLayoutInfo.layoutId];
        const fromLayoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(updatedAppConfig, fromLayoutInfo);
        // 1. pended item has been detached from the grid
        // 2. move to different size mode does not change the fromSizeMode layout. e.g., add from the pending list
        if (fromLayout.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.GridLayout && !fromLayoutItem.isPending && fromSizeMode === toSizeMode) {
            // grid layout is a special one, it has some non-content layout items, such as row, column, etc.
            const gridService = _layout_service_provider__WEBPACK_IMPORTED_MODULE_6__.LayoutServiceProvider.getInstance().getServiceByType(jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.GridLayout);
            updatedAppConfig = gridService.beforeItemRemoved(updatedAppConfig, fromLayoutInfo);
        }
        console.debug('move layout item from', fromLayoutInfo.layoutId, fromLayoutInfo.layoutItemId, 'to', toLayoutId, toSizeMode);
        if (fromLayoutItem.isPending && fromSizeMode === toSizeMode) {
            // make sure it can be added back to its original layout
            updatedAppConfig = updatedAppConfig.setIn(['layouts', fromLayoutInfo.layoutId, 'content', fromLayoutInfo.layoutItemId], fromLayoutItem.without('isPending'));
        }
        if (fromLayoutInfo.layoutId !== toLayoutId) {
            const fromLayoutService = _layout_service_provider__WEBPACK_IMPORTED_MODULE_6__.LayoutServiceProvider.getService(updatedAppConfig, fromLayoutInfo.layoutId);
            // only remove target from its parent if it is from the same size mode
            if (fromSizeMode === toSizeMode) {
                let parentLayoutInfos = [fromLayoutInfo];
                if (fromLayoutItem.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget) {
                    const widgetJson = updatedAppConfig.widgets[fromLayoutItem.widgetId];
                    if (widgetJson && ((_b = (_a = widgetJson.parent) === null || _a === void 0 ? void 0 : _a[fromSizeMode]) === null || _b === void 0 ? void 0 : _b.length) > 1) {
                        parentLayoutInfos = widgetJson.parent[fromSizeMode];
                    }
                }
                else if (fromLayoutItem.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section) {
                    const sectionJson = updatedAppConfig.sections[fromLayoutItem.sectionId];
                    if (((_d = (_c = sectionJson.parent) === null || _c === void 0 ? void 0 : _c[fromSizeMode]) === null || _d === void 0 ? void 0 : _d.length) > 1) {
                        parentLayoutInfos = sectionJson.parent[fromSizeMode];
                    }
                }
                parentLayoutInfos.forEach(parentLayoutInfo => {
                    updatedAppConfig = fromLayoutService.removeItem(updatedAppConfig, parentLayoutInfo, fromSizeMode, false);
                });
            }
            // create an empty layout
            const result = this.createBlankItem(updatedAppConfig, toLayoutId);
            updatedAppConfig = result[0];
            const newItemId = result[1];
            updatedAppConfig = updatedAppConfig.setIn(['layouts', toLayoutId, 'content', newItemId, 'type'], movingLayoutItem.type);
            // update widgetId or sectionId
            if (movingLayoutItem.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget) {
                updatedAppConfig = updatedAppConfig.setIn(['layouts', toLayoutId, 'content', newItemId, 'widgetId'], movingLayoutItem.widgetId);
            }
            else if (movingLayoutItem.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section) {
                updatedAppConfig = updatedAppConfig.setIn(['layouts', toLayoutId, 'content', newItemId, 'sectionId'], movingLayoutItem.sectionId);
            }
            // add parent for the content
            const newLayoutInfo = { layoutId: toLayoutId, layoutItemId: newItemId };
            const toLayoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(updatedAppConfig, newLayoutInfo);
            const service = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(updatedAppConfig, toLayoutItem);
            service.addParent(newLayoutInfo, toSizeMode);
            // update content after move
            if (fromSizeMode === toSizeMode) {
                service.afterMoved(fromLayoutInfo.layoutId, toLayoutId);
            }
            else {
                service.afterAdded(toLayoutId, fromSizeMode, toSizeMode);
            }
            updatedAppConfig = service.getConfig();
            return [updatedAppConfig, newLayoutInfo];
        }
        return [updatedAppConfig, fromLayoutInfo];
    }
    afterItemAdded(appConfig, layoutInfo, fromSizeMode, currentSizeMode, options) {
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_4__.searchUtils.findLayoutItem(appConfig, layoutInfo);
        const service = new _content_service_wrapper__WEBPACK_IMPORTED_MODULE_2__.ContentServiceWrapper(appConfig, layoutItem);
        service.afterAdded(layoutInfo.layoutId, fromSizeMode, currentSizeMode);
        return service.getConfig();
    }
    // no need to add beforeItemMoved, the logic can be executed in beforeItemRemoved
    afterItemMoved(appConfig, layoutInfo, toLayoutId) {
        return appConfig;
    }
    beforeItemRemoved(appConfig, layoutInfo) {
        return appConfig;
    }
    afterItemRemoved(appConfig, layoutInfo) {
        return appConfig;
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/content-service-wrapper.ts":
/*!****************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/content-service-wrapper.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ContentServiceWrapper: () => (/* binding */ ContentServiceWrapper)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _widget_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./widget-service */ "./jimu-for-builder/lib/app-config-service/widget-service.ts");
/* harmony import */ var _section_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./section-service */ "./jimu-for-builder/lib/app-config-service/section-service.ts");
/* harmony import */ var _screen_group_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./screen-group-service */ "./jimu-for-builder/lib/app-config-service/screen-group-service.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




class ContentServiceWrapper {
    constructor(appConfig, layoutItem) {
        this.appConfig = appConfig;
        this.layoutItem = layoutItem;
        switch (layoutItem.type) {
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget:
                this.service = _widget_service__WEBPACK_IMPORTED_MODULE_1__["default"];
                this.contentId = layoutItem.widgetId;
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section:
                this.service = _section_service__WEBPACK_IMPORTED_MODULE_2__["default"];
                this.contentId = layoutItem.sectionId;
                break;
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.ScreenGroup:
                this.service = _screen_group_service__WEBPACK_IMPORTED_MODULE_3__["default"];
                this.contentId = layoutItem.screenGroupId;
                break;
        }
    }
    getConfig() {
        return this.appConfig;
    }
    getContentId() {
        return this.contentId;
    }
    createFromTemplate(templateJson, sizeModeList, context, options) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.contentId && this.service) {
                const result = yield this.service.createFromTemplate(this.appConfig, templateJson, this.contentId, sizeModeList, context, options);
                this.appConfig = result[0];
                return result;
            }
            return [this.appConfig, null];
        });
    }
    duplicateEmbedLayout(fromSizeMode, toSizeMdoe) {
        if (this.service) {
            const result = this.service.duplicateEmbedLayout(this.appConfig, this.contentId, fromSizeMode, toSizeMdoe);
            this.appConfig = result[0];
            return result;
        }
        return [this.appConfig, null];
    }
    duplicate(targetBrowserSize, context) {
        if (this.service) {
            const result = this.service.duplicate(this.appConfig, this.contentId, targetBrowserSize, context);
            this.appConfig = result[0];
            return result;
        }
        return [this.appConfig, null];
    }
    tryRemove(layoutInfo, browserSizeMode) {
        if (this.service) {
            this.appConfig = this.service.tryRemove(this.appConfig, this.contentId, layoutInfo, browserSizeMode);
        }
        return this.appConfig;
    }
    remove() {
        if (this.service) {
            this.appConfig = this.service.remove(this.appConfig, this.contentId);
        }
        return this.appConfig;
    }
    toTocNode(parent, browserSizeMode) {
        if (this.service) {
            return this.service.toTocNode(this.appConfig, this.contentId, parent, browserSizeMode);
        }
        return null;
    }
    afterMoved(fromLayoutId, toLayoutId) {
        if (this.service) {
            this.appConfig = this.service.afterMoved(this.appConfig, this.contentId, fromLayoutId, toLayoutId);
        }
        return this.appConfig;
    }
    afterAdded(layoutId, fromSizeMode, toSizeMode) {
        if (this.service) {
            this.appConfig = this.service.afterAdded(this.appConfig, this.contentId, layoutId, fromSizeMode, toSizeMode);
        }
        return this.appConfig;
    }
    addParent(layoutInfo, browserSizeMode) {
        if (this.service) {
            this.appConfig = this.service.addParent(this.appConfig, this.contentId, layoutInfo, browserSizeMode);
        }
        return this.appConfig;
    }
    removeParent(layoutInfo, browserSizeMode) {
        if (this.service) {
            this.appConfig = this.service.removeParent(this.appConfig, this.contentId, layoutInfo, browserSizeMode);
        }
        return this.appConfig;
    }
    clearParent() {
        if (this.service) {
            this.appConfig = this.service.clearParent(this.appConfig, this.contentId);
        }
        return this.appConfig;
    }
    removeSizeModeParent(browserSizeMode) {
        if (this.service) {
            this.appConfig = this.service.removeSizeModeParent(this.appConfig, this.contentId, browserSizeMode);
        }
        return this.appConfig;
    }
    findParent(browserSizeMode) {
        var _a;
        return (_a = this.service) === null || _a === void 0 ? void 0 : _a.findParent(this.appConfig, this.contentId, browserSizeMode);
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/empty-content-service.ts":
/*!**************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/empty-content-service.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EmptyContentService: () => (/* binding */ EmptyContentService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-layouts/layout-runtime */ "jimu-layouts/layout-runtime");
/* harmony import */ var _widget_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./widget-service */ "./jimu-for-builder/lib/app-config-service/widget-service.ts");
/* harmony import */ var _section_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./section-service */ "./jimu-for-builder/lib/app-config-service/section-service.ts");
/* harmony import */ var _screen_group_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./screen-group-service */ "./jimu-for-builder/lib/app-config-service/screen-group-service.ts");





// represent an empty layout item
class EmptyContentService {
    /**
     * Set content id of the layout item, the type of the layout item should have been set.
     * @param appConfig
     * @param layoutInfo
     * @param contentId
     * @param sizeMode
     * @returns
     */
    setContentId(appConfig, layoutInfo, contentId, sizeMode) {
        if (!contentId) {
            return appConfig;
        }
        const { layoutId, layoutItemId } = layoutInfo;
        const layoutItem = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.searchUtils.findLayoutItem(appConfig, layoutInfo);
        if (layoutItem) {
            let updatedAppConfig = appConfig;
            switch (layoutItem.type) {
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget:
                    updatedAppConfig = updatedAppConfig.setIn(['layouts', layoutId, 'content', layoutItemId, 'widgetId'], contentId);
                    updatedAppConfig = _widget_service__WEBPACK_IMPORTED_MODULE_2__["default"].addParent(updatedAppConfig, contentId, layoutInfo, sizeMode);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section:
                    updatedAppConfig = updatedAppConfig.setIn(['layouts', layoutId, 'content', layoutItemId, 'sectionId'], contentId);
                    updatedAppConfig = _section_service__WEBPACK_IMPORTED_MODULE_3__["default"].addParent(updatedAppConfig, contentId, layoutInfo, sizeMode);
                    break;
                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.ScreenGroup:
                    updatedAppConfig = updatedAppConfig.setIn(['layouts', layoutId, 'content', layoutItemId, 'screenGroupId'], contentId);
                    updatedAppConfig = _screen_group_service__WEBPACK_IMPORTED_MODULE_4__["default"].addParent(updatedAppConfig, contentId, layoutInfo, sizeMode);
                    break;
            }
            return updatedAppConfig;
        }
        return appConfig;
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new EmptyContentService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/index.ts":
/*!**********************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/index.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BaseLayoutService: () => (/* reexport safe */ _base_layout_service__WEBPACK_IMPORTED_MODULE_5__.BaseLayoutService),
/* harmony export */   ContentServiceWrapper: () => (/* reexport safe */ _content_service_wrapper__WEBPACK_IMPORTED_MODULE_8__.ContentServiceWrapper),
/* harmony export */   LayoutServiceProvider: () => (/* reexport safe */ _layout_service_provider__WEBPACK_IMPORTED_MODULE_6__.LayoutServiceProvider),
/* harmony export */   emptyContentService: () => (/* reexport safe */ _empty_content_service__WEBPACK_IMPORTED_MODULE_3__["default"]),
/* harmony export */   makeSureTemplateConfig: () => (/* reexport safe */ _util__WEBPACK_IMPORTED_MODULE_7__.makeSureTemplateConfig),
/* harmony export */   screenGroupService: () => (/* reexport safe */ _screen_group_service__WEBPACK_IMPORTED_MODULE_2__["default"]),
/* harmony export */   sectionService: () => (/* reexport safe */ _section_service__WEBPACK_IMPORTED_MODULE_1__["default"]),
/* harmony export */   templateService: () => (/* reexport safe */ _template_service__WEBPACK_IMPORTED_MODULE_4__["default"]),
/* harmony export */   widgetService: () => (/* reexport safe */ _widget_service__WEBPACK_IMPORTED_MODULE_0__["default"])
/* harmony export */ });
/* harmony import */ var _widget_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./widget-service */ "./jimu-for-builder/lib/app-config-service/widget-service.ts");
/* harmony import */ var _section_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./section-service */ "./jimu-for-builder/lib/app-config-service/section-service.ts");
/* harmony import */ var _screen_group_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./screen-group-service */ "./jimu-for-builder/lib/app-config-service/screen-group-service.ts");
/* harmony import */ var _empty_content_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./empty-content-service */ "./jimu-for-builder/lib/app-config-service/empty-content-service.ts");
/* harmony import */ var _template_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./template-service */ "./jimu-for-builder/lib/app-config-service/template-service.ts");
/* harmony import */ var _base_layout_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./base-layout-service */ "./jimu-for-builder/lib/app-config-service/base-layout-service.ts");
/* harmony import */ var _layout_service_provider__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./layout-service-provider */ "./jimu-for-builder/lib/app-config-service/layout-service-provider.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/app-config-service/util.ts");
/* harmony import */ var _content_service_wrapper__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./content-service-wrapper */ "./jimu-for-builder/lib/app-config-service/content-service-wrapper.ts");












/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/layout-service-provider.ts":
/*!****************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/layout-service-provider.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   LayoutServiceProvider: () => (/* binding */ LayoutServiceProvider)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

const DEFAULT_LAYOUT_TYPE = jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FixedLayout;
class LayoutServiceProvider {
    static getInstance() {
        if (!LayoutServiceProvider.instance) {
            LayoutServiceProvider.instance = new LayoutServiceProvider();
        }
        return LayoutServiceProvider.instance;
    }
    static getService(appConfig, layoutId) {
        var _a;
        const layoutJson = appConfig.layouts[layoutId];
        return LayoutServiceProvider.getInstance().getServiceByType((_a = layoutJson === null || layoutJson === void 0 ? void 0 : layoutJson.type) !== null && _a !== void 0 ? _a : DEFAULT_LAYOUT_TYPE);
    }
    static getServiceFromSizeModeLayout(appConfig, layouts) {
        var _a;
        const firstLayoutId = Object.values(layouts)[0];
        const defaultLayoutId = layouts[appConfig.mainSizeMode];
        return (_a = LayoutServiceProvider.getService(appConfig, firstLayoutId)) !== null && _a !== void 0 ? _a : LayoutServiceProvider.getService(appConfig, defaultLayoutId);
    }
    constructor() {
        this.serviceMap = new Map();
    }
    registerService(type, service) {
        this.serviceMap.set(type, service);
    }
    getServiceByType(type) {
        return this.serviceMap.get(type !== null && type !== void 0 ? type : DEFAULT_LAYOUT_TYPE);
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/screen-group-service.ts":
/*!*************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/screen-group-service.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ScreenGroupService: () => (/* binding */ ScreenGroupService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_content_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base-content-service */ "./jimu-for-builder/lib/app-config-service/base-content-service.ts");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/app-config-service/util.ts");
/* harmony import */ var _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./layout-service-provider */ "./jimu-for-builder/lib/app-config-service/layout-service-provider.ts");
/* harmony import */ var jimu_icons_svg_outlined_brand_screen_svg__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/screen.svg */ "./jimu-icons/svg/outlined/brand/screen.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_screen_svg__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_screen_svg__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var jimu_icons_svg_outlined_brand_screen_group_svg__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/screen-group.svg */ "./jimu-icons/svg/outlined/brand/screen-group.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_screen_group_svg__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_screen_group_svg__WEBPACK_IMPORTED_MODULE_6__);
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







class ScreenGroupService extends _base_content_service__WEBPACK_IMPORTED_MODULE_1__.BaseContentService {
    createFromTemplate(appConfig, templateJson, screenGroupId, sizeModeList, contentMapping) {
        return __awaiter(this, void 0, void 0, function* () {
            if (contentMapping[screenGroupId]) {
                return [appConfig, contentMapping[screenGroupId]];
            }
            let updatedAppConfig = appConfig;
            console.debug('create screen group', screenGroupId, 'from template in', sizeModeList);
            yield (0,_util__WEBPACK_IMPORTED_MODULE_3__.makeSureTemplateConfig)(templateJson);
            const templateConfig = templateJson.config;
            screenGroupId = screenGroupId !== null && screenGroupId !== void 0 ? screenGroupId : Object.keys(templateConfig.screenGroups)[0];
            const templateScreenGroup = templateConfig.screenGroups[screenGroupId];
            const nextGroupId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'screenGroup');
            updatedAppConfig = updatedAppConfig
                .setIn(['screenGroups', nextGroupId], templateScreenGroup)
                .setIn(['screenGroups', nextGroupId, 'id'], nextGroupId)
                .setIn(['screenGroups', nextGroupId, 'label'], _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(appConfig, 'screenGroup', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'screenGroup' })));
            const newScreenIds = [];
            for (let i = 0; i < templateScreenGroup.screens.length; i += 1) { // awaits in a for-loop should get executed in series
                const screenId = templateScreenGroup.screens[i];
                const result = yield this.createScreenFromTemplate(updatedAppConfig, templateJson, screenId, sizeModeList, contentMapping);
                updatedAppConfig = result[0];
                newScreenIds.push(result[1]);
                updatedAppConfig = updatedAppConfig.setIn(['screens', result[1], 'parent'], nextGroupId);
            }
            updatedAppConfig = updatedAppConfig.setIn(['screenGroups', nextGroupId, 'screens'], newScreenIds);
            contentMapping[screenGroupId] = nextGroupId;
            return [updatedAppConfig, nextGroupId];
        });
    }
    createScreenFromTemplate(appConfig, templateJson, screenId, sizeModeList, contentMapping) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            let updatedAppConfig = appConfig;
            console.debug('create screen', screenId, 'from template in', sizeModeList);
            yield (0,_util__WEBPACK_IMPORTED_MODULE_3__.makeSureTemplateConfig)(templateJson);
            const templateConfig = templateJson.config;
            screenId = screenId !== null && screenId !== void 0 ? screenId : Object.keys(templateConfig.screens)[0];
            const templateScreen = templateConfig.screens[screenId];
            const nextScreenId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'screen');
            updatedAppConfig = updatedAppConfig.setIn(['screens', nextScreenId], templateScreen)
                .setIn(['screens', nextScreenId, 'id'], nextScreenId)
                .setIn(['screens', nextScreenId, 'label'], _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(appConfig, 'screen', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'screen' })));
            const layoutIds = [];
            Object.keys((_b = (_a = templateScreen.panel) === null || _a === void 0 ? void 0 : _a.layout) !== null && _b !== void 0 ? _b : {}).forEach((sizeMode) => {
                layoutIds.push({
                    sizeMode,
                    isSide: true,
                    layoutId: templateScreen.panel.layout[sizeMode]
                });
            });
            Object.keys((_c = templateScreen.main.layout) !== null && _c !== void 0 ? _c : {}).forEach((sizeMode) => {
                layoutIds.push({
                    sizeMode,
                    isSide: false,
                    layoutId: templateScreen.main.layout[sizeMode]
                });
            });
            for (let i = 0; i < layoutIds.length; i += 1) { // awaits in a for-loop should get executed in series
                const { sizeMode, layoutId, isSide } = layoutIds[i];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(templateConfig, layoutId);
                const result = yield service.createLayoutFromTemplate(updatedAppConfig, templateJson, layoutId, sizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, nextScreenId, contentMapping);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                updatedAppConfig = updatedAppConfig.setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, id: nextScreenId });
                if (isSide) {
                    updatedAppConfig = updatedAppConfig.setIn(['screens', nextScreenId, 'panel', 'layout', sizeMode], newLayoutId);
                }
                else {
                    updatedAppConfig = updatedAppConfig.setIn(['screens', nextScreenId, 'main', 'layout', sizeMode], newLayoutId);
                }
            }
            return [updatedAppConfig, nextScreenId];
        });
    }
    duplicateEmbedLayout(appConfig, contentId, fromSizeMode, toSizeMode) {
        var _a;
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sgJson) {
            return [appConfig, null];
        }
        let updatedAppConfig = appConfig;
        sgJson.screens.forEach(screenId => {
            var _a;
            const screenJson = updatedAppConfig.screens[screenId];
            const mainLayouts = screenJson.main.layout;
            if (mainLayouts[fromSizeMode] && !mainLayouts[toSizeMode]) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(updatedAppConfig, mainLayouts[fromSizeMode]);
                const result = service.duplicateLayout(updatedAppConfig, mainLayouts[fromSizeMode], fromSizeMode, toSizeMode, null, false);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                if (result[1] != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, id: screenId })
                        .setIn(['screens', screenId, 'main', 'layout', toSizeMode], newLayoutId);
                }
            }
            const panelLayouts = (_a = screenJson.panel) === null || _a === void 0 ? void 0 : _a.layout;
            if (panelLayouts && panelLayouts[fromSizeMode] && !panelLayouts[toSizeMode]) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(updatedAppConfig, panelLayouts[fromSizeMode]);
                const result = service.duplicateLayout(updatedAppConfig, panelLayouts[fromSizeMode], fromSizeMode, toSizeMode, null, false);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                if (result[1] != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, id: screenId })
                        .setIn(['screens', screenId, 'panel', 'layout', toSizeMode], newLayoutId);
                }
            }
        });
        return [updatedAppConfig, null];
    }
    duplicate(appConfig, contentId, targetBrowserSize, context) {
        var _a;
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sgJson) {
            return [appConfig, null];
        }
        if (context === null || context === void 0 ? void 0 : context[contentId]) {
            // already duplicatd in a stack of function invokations.
            // Use case: same as section
            // check the duplicated section has the target browser size mode layout
            const sgJson = appConfig.screenGroups[context[contentId]];
            const firstScreen = appConfig.screens[sgJson.screens[0]];
            if (firstScreen.main.layout[targetBrowserSize]) {
                return [appConfig, context[contentId]];
            }
            else {
                // duplicate embed layout in target browser size mode from original sg to duplicated sg
                const originSg = appConfig.screenGroups[contentId];
                let updatedAppConfig = appConfig;
                originSg.screens.forEach(screenId => {
                    var _a;
                    const screenJson = updatedAppConfig.screens[screenId];
                    const mLayoutId = screenJson.main.layout[targetBrowserSize];
                    const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(updatedAppConfig, mLayoutId);
                    const dupResult = service.duplicateLayout(updatedAppConfig, mLayoutId, targetBrowserSize, targetBrowserSize, context, true);
                    updatedAppConfig = dupResult[0];
                    const newLayoutId = dupResult[1];
                    if (newLayoutId != null) {
                        updatedAppConfig = updatedAppConfig
                            .setIn(['screens', context[screenId], 'main', 'layout', targetBrowserSize], newLayoutId)
                            .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, id: context[screenId] });
                    }
                    if ((_a = screenJson.panel) === null || _a === void 0 ? void 0 : _a.layout) {
                        const pLayoutId = screenJson.panel.layout[targetBrowserSize];
                        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(updatedAppConfig, pLayoutId);
                        const dupResult = service.duplicateLayout(updatedAppConfig, pLayoutId, targetBrowserSize, targetBrowserSize, context, true);
                        updatedAppConfig = dupResult[0];
                        const newLayoutId = dupResult[1];
                        if (newLayoutId != null) {
                            updatedAppConfig = updatedAppConfig
                                .setIn(['screens', context[screenId], 'panel', 'layout', targetBrowserSize], newLayoutId)
                                .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, id: context[screenId] });
                        }
                    }
                });
                return [updatedAppConfig, context[contentId]];
            }
        }
        console.debug('duplicate screen group', contentId, 'to', targetBrowserSize);
        let newSgJson = sgJson
            .set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'screenGroup'))
            .set('label', (0,_util__WEBPACK_IMPORTED_MODULE_3__.getDuplicateLabel)(appConfig, 'screenGroup', sgJson.label));
        let updatedAppConfig = appConfig.setIn(['screenGroups', newSgJson.id], newSgJson);
        const screenIds = sgJson.screens.map((screenId) => {
            const result = this.duplicateScreen(updatedAppConfig, sgJson.id, screenId, [targetBrowserSize], false, context);
            updatedAppConfig = result[0];
            const newScreenId = result[1];
            updatedAppConfig = updatedAppConfig.setIn(['screens', newScreenId, 'parent'], newSgJson.id);
            return newScreenId;
        });
        newSgJson = newSgJson.set('screens', screenIds);
        updatedAppConfig = updatedAppConfig.setIn(['screenGroups', newSgJson.id], newSgJson);
        if (context) {
            context[contentId] = newSgJson.id;
        }
        return [updatedAppConfig, newSgJson.id];
    }
    tryRemove(appConfig, contentId, layoutInfo, sizeMode) {
        var _a;
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sgJson) {
            return appConfig;
        }
        console.debug(`try remove screenGroup ${contentId} from ${layoutInfo.layoutId} ${layoutInfo.layoutItemId}`, sizeMode);
        // 1. current size mode passed, check other size mode
        const hasOtherModes = [jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Large, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Medium, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Small]
            .filter(mode => mode !== sizeMode)
            .some(mode => { var _a; return ((_a = sgJson.parent) === null || _a === void 0 ? void 0 : _a[mode]) != null; });
        if (!hasOtherModes) { // can be removed
            return this.remove(appConfig, contentId);
        }
        else {
            // 1. remove parent for this size mode
            let updatedAppConfig = this.removeParent(appConfig, contentId, layoutInfo, sizeMode);
            // 2. remove embed layout of this size mode if any
            sgJson.screens.forEach((screenId) => {
                var _a;
                const screenJson = updatedAppConfig.screens[screenId];
                if (screenJson.main.layout[sizeMode]) {
                    const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, screenJson.main.layout);
                    updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, { [sizeMode]: screenJson.main.layout[sizeMode] });
                    updatedAppConfig = updatedAppConfig.setIn(['screens', screenId, 'main', 'layout'], screenJson.main.layout.without(sizeMode));
                }
                if ((_a = screenJson.panel) === null || _a === void 0 ? void 0 : _a.layout[sizeMode]) {
                    const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, screenJson.panel.layout);
                    updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, { [sizeMode]: screenJson.panel.layout[sizeMode] });
                    updatedAppConfig = updatedAppConfig.setIn(['screens', screenId, 'panel', 'layout'], screenJson.panel.layout.without(sizeMode));
                }
            });
            return updatedAppConfig;
        }
    }
    remove(appConfig, contentId) {
        var _a, _b;
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sgJson) {
            return appConfig;
        }
        let updatedAppConfig = appConfig;
        console.debug('remove screen group', contentId);
        // remove all parent layout infos
        Object.keys((_b = sgJson.parent) !== null && _b !== void 0 ? _b : {}).forEach((sizeMode) => {
            const { layoutId } = sgJson.parent[sizeMode];
            const layoutJson = updatedAppConfig.layouts[layoutId];
            if (layoutJson) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(updatedAppConfig, layoutId);
                updatedAppConfig = service.removeItem(updatedAppConfig, sgJson.parent[sizeMode], sizeMode, false);
            }
        });
        // remove screens
        sgJson.screens.forEach((screenId) => {
            var _a;
            const screenJson = updatedAppConfig.screens[screenId];
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, screenJson.main.layout);
            updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, screenJson.main.layout);
            if ((_a = screenJson.panel) === null || _a === void 0 ? void 0 : _a.layout) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, screenJson.panel.layout);
                updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, screenJson.panel.layout);
            }
            updatedAppConfig = updatedAppConfig.set('screens', updatedAppConfig.screens.without(screenId));
        });
        // remove screen group
        updatedAppConfig = updatedAppConfig.set('screenGroups', updatedAppConfig.screenGroups.without(contentId));
        return updatedAppConfig;
    }
    toTocNode(appConfig, contentId, parent, browserSizeMode) {
        var _a, _b;
        const { layoutId, layoutItemId } = parent;
        const result = {
            label: '',
            layoutId,
            layoutItemId,
            type: 'screenGroup',
            id: contentId,
            children: []
        };
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sgJson) {
            return result;
        }
        result.label = sgJson.label;
        result.icon = (_b = sgJson.icon) !== null && _b !== void 0 ? _b : (jimu_icons_svg_outlined_brand_screen_group_svg__WEBPACK_IMPORTED_MODULE_6___default());
        result.flipIcon = false;
        sgJson.screens.forEach((screenId) => {
            var _a, _b, _c;
            const screenJson = appConfig.screens[screenId];
            const screenNode = {
                label: screenJson.label,
                icon: (jimu_icons_svg_outlined_brand_screen_svg__WEBPACK_IMPORTED_MODULE_5___default()),
                flipIcon: false,
                type: 'screen',
                id: screenId,
                children: []
            };
            const mainLayoutId = (_a = screenJson.main.layout[browserSizeMode]) !== null && _a !== void 0 ? _a : screenJson.main.layout[appConfig.mainSizeMode];
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(appConfig, mainLayoutId);
            const mainChildren = service.getTocStructure(appConfig, mainLayoutId);
            screenNode.children.push({
                label: jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'mainStage' }),
                isLabelReadOnly: true,
                type: 'layout',
                id: mainLayoutId,
                children: mainChildren
            });
            if ((_b = screenJson.panel) === null || _b === void 0 ? void 0 : _b.layout) {
                const panelLayoutId = (_c = screenJson.panel.layout[browserSizeMode]) !== null && _c !== void 0 ? _c : screenJson.panel.layout[appConfig.mainSizeMode];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(appConfig, panelLayoutId);
                const panelChildren = service.getTocStructure(appConfig, panelLayoutId);
                screenNode.children.push({
                    label: jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'scrollingPanel' }),
                    isLabelReadOnly: true,
                    type: 'layout',
                    id: panelLayoutId,
                    children: panelChildren
                });
            }
            result.children.push(screenNode);
        });
        return result;
    }
    afterMoved(appConfig, contentId, fromLayout, toLayout) {
        // no extra logic to process
        return appConfig;
    }
    afterAdded(appConfig, contentId, toLayout, fromSizeMode, toSizeMode) {
        var _a;
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sgJson) {
            return appConfig;
        }
        let updatedAppConfig = appConfig;
        // If the view layout does not exist in the current sizeMode, we'll create a new one for them.
        sgJson.screens.forEach(screenId => {
            var _a, _b;
            const screenJson = updatedAppConfig.screens[screenId];
            if (screenJson.main.layout[fromSizeMode] && !screenJson.main.layout[toSizeMode]) {
                const layoutJson = updatedAppConfig.layouts[screenJson.main.layout[fromSizeMode]];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(updatedAppConfig, screenJson.main.layout[fromSizeMode]);
                const result = service.duplicateLayout(updatedAppConfig, layoutJson.id, fromSizeMode, toSizeMode, null);
                updatedAppConfig = result[0];
                const layoutId = result[1];
                if (layoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', layoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, id: screenId })
                        .setIn(['screens', screenId, 'main', 'layout', toSizeMode], layoutId);
                }
            }
            if (((_b = (_a = screenJson.panel) === null || _a === void 0 ? void 0 : _a.layout) === null || _b === void 0 ? void 0 : _b[fromSizeMode]) && !screenJson.panel.layout[toSizeMode]) {
                const layoutJson = updatedAppConfig.layouts[screenJson.panel.layout[fromSizeMode]];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getService(updatedAppConfig, screenJson.panel.layout[fromSizeMode]);
                const result = service.duplicateLayout(updatedAppConfig, layoutJson.id, fromSizeMode, toSizeMode, null);
                updatedAppConfig = result[0];
                const layoutId = result[1];
                if (layoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', layoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, id: screenId })
                        .setIn(['screens', screenId, 'panel', 'layout', toSizeMode], layoutId);
                }
            }
        });
        return updatedAppConfig;
    }
    addParent(appConfig, contentId, layoutInfo, sizeMode) {
        const sgJson = appConfig.screenGroups[contentId];
        if (!sgJson) {
            return appConfig;
        }
        console.debug('add parent', layoutInfo.layoutId, layoutInfo.layoutItemId, 'to', contentId, 'in', sizeMode);
        return appConfig.setIn(['screenGroups', contentId, 'parent', sizeMode], layoutInfo);
    }
    removeParent(appConfig, contentId, layoutInfo, sizeMode) {
        const sgJson = appConfig.screenGroups[contentId];
        if (!sgJson || !sgJson.parent) {
            return appConfig;
        }
        console.debug('remove parent', layoutInfo.layoutId, layoutInfo.layoutItemId, 'from', contentId);
        if (sizeMode) {
            const parent = sgJson.parent[sizeMode];
            if ((parent === null || parent === void 0 ? void 0 : parent.layoutId) === layoutInfo.layoutId && (parent === null || parent === void 0 ? void 0 : parent.layoutItemId) === layoutInfo.layoutItemId) {
                return appConfig.setIn(['screenGroups', contentId, 'parent'], sgJson.parent.without(sizeMode));
            }
            return appConfig;
        }
        let updatedAppConfig = appConfig;
        Object.keys(sgJson.parent).forEach((s) => {
            const parent = sgJson.parent[s];
            if (parent.layoutId === layoutInfo.layoutId && parent.layoutItemId === layoutInfo.layoutItemId) {
                updatedAppConfig = appConfig.setIn(['screenGroups', contentId, 'parent'], sgJson.parent.without(s));
            }
        });
        return updatedAppConfig;
    }
    clearParent(appConfig, contentId) {
        const sgJson = appConfig.screenGroups[contentId];
        if (!sgJson) {
            return appConfig;
        }
        return appConfig.setIn(['screenGroups', contentId], sgJson.without('parent'));
    }
    removeSizeModeParent(appConfig, contentId, browserSizeMode) {
        var _a;
        const sgJson = appConfig.screenGroups[contentId];
        if (!sgJson || !((_a = sgJson.parent) === null || _a === void 0 ? void 0 : _a[browserSizeMode])) {
            return appConfig;
        }
        return appConfig.setIn(['screenGroups', contentId, 'parent'], sgJson.parent.without(browserSizeMode));
    }
    findParent(appConfig, contentId, sizeMode) {
        var _a;
        const sgJson = appConfig.screenGroups[contentId];
        if (!sgJson || !sgJson.parent) {
            return null;
        }
        // browserSizeMode may be not a custom layout, it is transformed from mainSizeMode
        const sgParent = (_a = sgJson.parent[sizeMode]) !== null && _a !== void 0 ? _a : sgJson.parent[appConfig.mainSizeMode];
        return sgParent;
    }
    duplicateScreen(appConfig, sgId, screenId, sizeModeList, addToScreenGroup, context) {
        var _a, _b, _c;
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[sgId];
        const sJson = (_b = appConfig.screens) === null || _b === void 0 ? void 0 : _b[screenId];
        // screen group should contain at least one screen
        if (!sJson || !sgJson || !sgJson.screens.includes(screenId)) {
            return [appConfig, null];
        }
        console.debug('duplicate screen', screenId, 'in', sizeModeList, 'to', sgId);
        let screenJson = sJson
            .set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'screen'))
            .set('label', (0,_util__WEBPACK_IMPORTED_MODULE_3__.getDuplicateLabel)(appConfig, 'screen', sJson.label));
        if (!addToScreenGroup) {
            screenJson = screenJson.without('parent');
        }
        // must save into appconfig before duplicate iteration, or it's content section will get same section id to itself by getUniqueId.
        let updatedAppConfig = appConfig.setIn(['screens', screenJson.id], screenJson);
        // duplicate screen layout
        const mainSizeModeLayouts = {};
        sizeModeList.forEach(mode => { mainSizeModeLayouts[mode] = screenJson.main.layout[mode]; });
        const duplicateContext = context !== null && context !== void 0 ? context : {};
        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, mainSizeModeLayouts);
        const duplicateResult = service.duplicateSizeModeLayouts(updatedAppConfig, mainSizeModeLayouts, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, screenJson.id, duplicateContext);
        updatedAppConfig = duplicateResult[0];
        screenJson = screenJson.setIn(['main', 'layout'], duplicateResult[1]);
        if ((_c = screenJson.panel) === null || _c === void 0 ? void 0 : _c.layout) {
            const panelSizeModeLayouts = {};
            sizeModeList.forEach(mode => { panelSizeModeLayouts[mode] = screenJson.panel.layout[mode]; });
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, panelSizeModeLayouts);
            const duplicateResult = service.duplicateSizeModeLayouts(updatedAppConfig, panelSizeModeLayouts, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Screen, screenJson.id, duplicateContext);
            updatedAppConfig = duplicateResult[0];
            screenJson = screenJson.setIn(['panel', 'layout'], duplicateResult[1]);
        }
        updatedAppConfig = updatedAppConfig.setIn(['screens', screenJson.id], screenJson);
        if (addToScreenGroup) {
            const screens = sgJson.screens.asMutable();
            const index = screens.indexOf(screenId);
            screens.splice(index, 1, screenId, screenJson.id);
            updatedAppConfig = updatedAppConfig.setIn(['screenGroups', sgId, 'screens'], screens);
        }
        if (context) {
            context[screenId] = screenJson.id;
        }
        return [updatedAppConfig, screenJson.id];
    }
    removeScreen(appConfig, contentId, screenId) {
        var _a, _b;
        const sgJson = (_a = appConfig.screenGroups) === null || _a === void 0 ? void 0 : _a[contentId];
        const sJson = (_b = appConfig.screens) === null || _b === void 0 ? void 0 : _b[screenId];
        // screen group should contain at least one screen
        if (!sJson || !sgJson || sgJson.screens.length === 1 || !sgJson.screens.includes(screenId)) {
            return appConfig;
        }
        console.debug('remove screen', screenId, 'in', contentId);
        // remove from screenGroup.screens
        const screens = sgJson.screens.filter((sId) => sId !== screenId);
        let updatedAppConfig = appConfig.setIn(['screenGroups', contentId, 'screens'], screens);
        // remove screen layout
        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, sJson.main.layout);
        updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, sJson.main.layout);
        if (sJson.panel) {
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_4__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, sJson.panel.layout);
            updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, sJson.panel.layout);
        }
        // remove from screen list
        updatedAppConfig = updatedAppConfig.set('screens', updatedAppConfig.screens.without(screenId));
        return updatedAppConfig;
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new ScreenGroupService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/section-service.ts":
/*!********************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/section-service.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SectionService: () => (/* binding */ SectionService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_content_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base-content-service */ "./jimu-for-builder/lib/app-config-service/base-content-service.ts");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/app-config-service/util.ts");
/* harmony import */ var _widget_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./widget-service */ "./jimu-for-builder/lib/app-config-service/widget-service.ts");
/* harmony import */ var _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./layout-service-provider */ "./jimu-for-builder/lib/app-config-service/layout-service-provider.ts");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/widget-section.svg */ "./jimu-icons/svg/outlined/brand/widget-section.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_section_view_svg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/widget-section-view.svg */ "./jimu-icons/svg/outlined/brand/widget-section-view.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_section_view_svg__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_widget_section_view_svg__WEBPACK_IMPORTED_MODULE_7__);
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};








class SectionService extends _base_content_service__WEBPACK_IMPORTED_MODULE_1__.BaseContentService {
    createFromTemplate(appConfig, templateJson, sectionId, sizeModeList, context) {
        return __awaiter(this, void 0, void 0, function* () {
            if (context[sectionId]) {
                // already duplicatd in a stack of function invokations.
                // Use case: A section is shared in a page's Large and Small size mode, and the page is duplicated.
                // 1. section is duplicated in Large size mode, view layout is duplicated in Large size mode too.
                // 2. when duplicate the small size mode, the section does not need to be duplicated again, but the view layout needs to be duplicated.
                // check the duplicated section has the target browser size mode layout
                const sectionJson = appConfig.sections[context[sectionId]];
                const firstView = appConfig.views[sectionJson.views[0]];
                // duplicate embed layout in target browser size mode from original section to duplicated section
                const originSection = templateJson.config.sections[sectionId];
                let updatedAppConfig = appConfig;
                for (let i = 0; i < sizeModeList.length; i++) {
                    const sizeMode = sizeModeList[i];
                    if (firstView.layout[sizeMode]) {
                        continue;
                    }
                    for (let j = 0; j < originSection.views.length; j++) {
                        const viewId = originSection.views[j];
                        const viewJson = templateJson.config.views[viewId];
                        const layoutId = viewJson.layout[sizeMode];
                        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getService(templateJson.config, layoutId);
                        const dupResult = yield service.createLayoutFromTemplate(updatedAppConfig, templateJson, layoutId, sizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View, context[viewId], context);
                        updatedAppConfig = dupResult[0];
                        const newLayoutId = dupResult[1];
                        if (newLayoutId != null) {
                            updatedAppConfig = updatedAppConfig.setIn(['views', context[viewId], 'layout', sizeMode], newLayoutId);
                        }
                    }
                }
                return [updatedAppConfig, context[sectionId]];
            }
            yield (0,_util__WEBPACK_IMPORTED_MODULE_3__.makeSureTemplateConfig)(templateJson);
            let updatedAppConfig = appConfig;
            const templateConfig = templateJson.config;
            const templateSection = templateConfig.sections[sectionId];
            const nextSectionId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'section');
            updatedAppConfig = updatedAppConfig.setIn(['sections', nextSectionId], templateSection)
                .setIn(['sections', nextSectionId, 'id'], nextSectionId)
                .setIn(['sections', nextSectionId, 'label'], _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(appConfig, 'section', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'section' })));
            const newViewIds = [];
            for (let i = 0; i < templateSection.views.length; i += 1) { // awaits in a for-loop should get executed in series
                const viewId = templateSection.views[i];
                const result = yield this.createViewFromTemplate(updatedAppConfig, templateJson, viewId, sizeModeList, context);
                updatedAppConfig = result[0];
                newViewIds.push(result[1]);
                updatedAppConfig = updatedAppConfig.setIn(['views', result[1], 'parent'], nextSectionId);
            }
            updatedAppConfig = updatedAppConfig.setIn(['sections', nextSectionId, 'views'], newViewIds);
            context[sectionId] = nextSectionId;
            return [updatedAppConfig, nextSectionId];
        });
    }
    createViewFromTemplate(appConfig, templateJson, viewId, sizeModeList, context) {
        return __awaiter(this, void 0, void 0, function* () {
            let updatedAppConfig = appConfig;
            yield (0,_util__WEBPACK_IMPORTED_MODULE_3__.makeSureTemplateConfig)(templateJson);
            const templateConfig = templateJson.config;
            const templateView = templateConfig.views[viewId];
            const nextViewId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'view');
            updatedAppConfig = updatedAppConfig
                .setIn(['views', nextViewId], templateView)
                .setIn(['views', nextViewId, 'id'], nextViewId)
                .setIn(['views', nextViewId, 'label'], _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(appConfig, 'view', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'view' })));
            const layoutIds = [];
            Object.keys(templateView.layout || {}).forEach((sizeMode) => {
                layoutIds.push({
                    sizeMode,
                    layoutId: templateView.layout[sizeMode]
                });
            });
            for (let i = 0; i < layoutIds.length; i += 1) { // awaits in a for-loop should get executed in series
                const { sizeMode, layoutId } = layoutIds[i];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getService(templateConfig, layoutId);
                const result = yield service.createLayoutFromTemplate(updatedAppConfig, templateJson, layoutId, sizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View, nextViewId, context);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                updatedAppConfig = updatedAppConfig.setIn(['views', nextViewId, 'layout', sizeMode], newLayoutId);
            }
            if (context) {
                context[viewId] = nextViewId;
            }
            return [updatedAppConfig, nextViewId];
        });
    }
    duplicateEmbedLayout(appConfig, contentId, fromSizeMode, toSizeMode) {
        var _a;
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sectionJson) {
            return [appConfig, null];
        }
        let updatedAppConfig = appConfig;
        console.debug(`duplicate section ${contentId} from ${fromSizeMode} to ${toSizeMode}`);
        sectionJson.views.forEach(viewId => {
            const viewJson = updatedAppConfig.views[viewId];
            const layouts = viewJson.layout;
            if (layouts[fromSizeMode] && !layouts[toSizeMode]) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getService(updatedAppConfig, layouts[fromSizeMode]);
                const result = service.duplicateLayout(updatedAppConfig, layouts[fromSizeMode], fromSizeMode, toSizeMode, null, false);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                if (newLayoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View, id: viewId })
                        .setIn(['views', viewId, 'layout', toSizeMode], newLayoutId);
                }
            }
        });
        return [updatedAppConfig, null];
    }
    /**
     * Duplicate a section, only duplicate the content in target browser size mode.
     * @param appConfig
     * @param contentId id of the section
     * @param context duplicating context, keeps the relation between original id and duplicated id
     * @returns updatd app config and the id of the duplicated section
     */
    duplicate(appConfig, contentId, targetBrowserSize, context) {
        var _a;
        console.debug('dplicate section', contentId, 'in', targetBrowserSize);
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sectionJson) {
            return [appConfig, null];
        }
        if (context === null || context === void 0 ? void 0 : context[contentId]) {
            // already duplicatd in a stack of function invokations.
            // Use case: A section is shared in a page's Large and Small size mode, and the page is duplicated.
            // 1. section is duplicated in Large size mode, view layout is duplicated in Large size mode too.
            // 2. when duplicate the small size mode, the section does not need to be duplicated again, but the view layout needs to be duplicated.
            // check the duplicated section has the target browser size mode layout
            const sectionJson = appConfig.sections[context[contentId]];
            const firstView = appConfig.views[sectionJson.views[0]];
            if (firstView.layout[targetBrowserSize]) {
                return [appConfig, context[contentId]];
            }
            // duplicate embed layout in target browser size mode from original section to duplicated section
            const originSection = appConfig.sections[contentId];
            let updatedAppConfig = appConfig;
            originSection.views.forEach(viewId => {
                const viewJson = updatedAppConfig.views[viewId];
                const layoutId = viewJson.layout[targetBrowserSize];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getService(updatedAppConfig, layoutId);
                const dupResult = service.duplicateLayout(updatedAppConfig, layoutId, targetBrowserSize, targetBrowserSize, context, true);
                updatedAppConfig = dupResult[0];
                const newLayoutId = dupResult[1];
                if (newLayoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['views', context[viewId], 'layout', targetBrowserSize], newLayoutId)
                        .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View, id: context[viewId] });
                }
            });
            return [updatedAppConfig, context[contentId]];
        }
        let newSectionJson = sectionJson
            .set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'section'))
            .set('label', (0,_util__WEBPACK_IMPORTED_MODULE_3__.getDuplicateLabel)(appConfig, 'section', sectionJson.label));
        let updatedAppConfig = appConfig.setIn(['sections', newSectionJson.id], newSectionJson);
        const viewIds = sectionJson.views.map((viewId) => {
            const result = this.duplicateView(updatedAppConfig, sectionJson.id, viewId, [targetBrowserSize], false, context);
            updatedAppConfig = result[0];
            const newViewId = result[1];
            updatedAppConfig = updatedAppConfig.setIn(['views', newViewId, 'parent'], newSectionJson.id);
            return newViewId;
        });
        newSectionJson = newSectionJson.set('views', viewIds);
        updatedAppConfig = updatedAppConfig.setIn(['sections', newSectionJson.id], newSectionJson);
        if (context) {
            context[contentId] = newSectionJson.id;
        }
        return [updatedAppConfig, newSectionJson.id];
    }
    removeDirectly(appConfig, contentId) {
        var _a;
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[contentId];
        let updatedAppConfig = appConfig;
        // remove views
        sectionJson.views.forEach((viewId) => {
            const viewJson = updatedAppConfig.views[viewId];
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, viewJson.layout);
            updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, viewJson.layout);
            updatedAppConfig = updatedAppConfig.set('views', updatedAppConfig.views.without(viewId));
        });
        updatedAppConfig = updatedAppConfig.set('sections', updatedAppConfig.sections.without(contentId));
        return updatedAppConfig;
    }
    tryRemove(appConfig, contentId, layoutInfo, sizeMode) {
        var _a;
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sectionJson) {
            return appConfig;
        }
        console.debug(`remove section ${contentId} from ${layoutInfo.layoutId} ${layoutInfo.layoutItemId}`, sizeMode);
        // 1. current size mode passed, check other size mode
        const hasOtherModes = [jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Large, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Medium, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Small]
            .filter(mode => mode !== sizeMode)
            .some(mode => { var _a, _b; return ((_b = (_a = sectionJson.parent) === null || _a === void 0 ? void 0 : _a[mode]) === null || _b === void 0 ? void 0 : _b.length) > 0; });
        if (!hasOtherModes) { // can be removed
            return this.remove(appConfig, contentId);
        }
        else {
            // 1. remove parent for this size mode
            let updatedAppConfig = this.removeParent(appConfig, contentId, layoutInfo, sizeMode);
            // 2. remove embed layout of this size mode if any
            sectionJson.views.forEach((viewId) => {
                const viewJson = updatedAppConfig.views[viewId];
                if (viewJson.layout[sizeMode]) {
                    const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, viewJson.layout);
                    updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, { [sizeMode]: viewJson.layout[sizeMode] });
                    updatedAppConfig = updatedAppConfig.setIn(['views', viewId, 'layout'], viewJson.layout.without(sizeMode));
                }
            });
            return updatedAppConfig;
        }
    }
    /**
     * Remove a section
     * @param appConfig
     * @param contentId id of the section
     * @returns updatd app config
     */
    remove(appConfig, contentId) {
        var _a, _b;
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sectionJson) {
            return appConfig;
        }
        console.debug('remove section', contentId);
        // remove all parent layout infos
        let updatedAppConfig = appConfig;
        Object.keys((_b = sectionJson.parent) !== null && _b !== void 0 ? _b : {}).forEach((sizeMode) => {
            if (sectionJson.parent[sizeMode].length > 0) {
                sectionJson.parent[sizeMode].forEach(item => {
                    const layoutJson = updatedAppConfig.layouts[item.layoutId];
                    if (layoutJson) {
                        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getService(updatedAppConfig, item.layoutId);
                        updatedAppConfig = service.removeItem(updatedAppConfig, item, sizeMode, false);
                    }
                });
            }
        });
        return this.removeDirectly(updatedAppConfig, contentId);
    }
    toTocNode(appConfig, contentId, parent, browserSizeMode) {
        var _a, _b;
        const { layoutId, layoutItemId } = parent;
        const result = {
            label: '',
            layoutId,
            layoutItemId,
            type: 'section',
            id: contentId,
            children: []
        };
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sectionJson) {
            return result;
        }
        result.label = sectionJson.label;
        result.icon = (_b = sectionJson.icon) !== null && _b !== void 0 ? _b : (jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_6___default());
        result.flipIcon = true;
        sectionJson.views.forEach((viewId) => {
            var _a, _b;
            const viewJson = appConfig.views[viewId];
            const viewLayoutId = (_a = viewJson.layout[browserSizeMode]) !== null && _a !== void 0 ? _a : viewJson.layout[appConfig.mainSizeMode];
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getService(appConfig, viewLayoutId);
            const viewChildren = service.getTocStructure(appConfig, viewLayoutId);
            result.children.push({
                label: viewJson.label,
                icon: (_b = viewJson.icon) !== null && _b !== void 0 ? _b : (jimu_icons_svg_outlined_brand_widget_section_view_svg__WEBPACK_IMPORTED_MODULE_7___default()),
                flipIcon: false,
                type: 'view',
                id: viewId,
                children: viewChildren
            });
        });
        return result;
    }
    afterMoved(appConfig, contentId, fromLayout, toLayout) {
        // no extra logic to process
        return appConfig;
    }
    afterAdded(appConfig, contentId, toLayout, fromSizeMode, toSizeMode) {
        var _a;
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!sectionJson) {
            return appConfig;
        }
        let updatedAppConfig = appConfig;
        // If the view layout does not exist in the current sizeMode, we'll create a new one for them.
        sectionJson.views.forEach(vId => {
            const viewJson = updatedAppConfig.views[vId];
            if (viewJson.layout[fromSizeMode] && !viewJson.layout[toSizeMode]) {
                const layoutJson = updatedAppConfig.layouts[viewJson.layout[fromSizeMode]];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getService(updatedAppConfig, viewJson.layout[fromSizeMode]);
                const result = service.duplicateLayout(updatedAppConfig, layoutJson.id, fromSizeMode, toSizeMode, null);
                updatedAppConfig = result[0];
                const layoutId = result[1];
                if (layoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', layoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View, id: vId })
                        .setIn(['views', vId, 'layout', toSizeMode], layoutId);
                }
            }
        });
        return updatedAppConfig;
    }
    /**
     * Add a parent layoutInfo to this section. Occurs when this section is added to a layout item.
     * @param appConfig
     * @param contentId
     * @param layoutInfo
     * @param sizeMode
     * @returns
     */
    addParent(appConfig, contentId, layoutInfo, sizeMode) {
        var _a;
        const sectionJson = appConfig.sections[contentId];
        if (!sectionJson) {
            return appConfig;
        }
        console.debug('add parent', layoutInfo.layoutId, layoutInfo.layoutItemId, 'to section', contentId, 'in', sizeMode);
        const list = this.addParentToList(appConfig, (_a = sectionJson.parent) === null || _a === void 0 ? void 0 : _a[sizeMode], layoutInfo);
        return appConfig.setIn(['sections', contentId, 'parent', sizeMode], list);
    }
    /**
     * Remove a parent layoutInfo from this section. Occurs when this section is removed from a layout item.
     * @param appConfig
     * @param contentId id of the section
     * @param layoutInfo refer to a layout item
     * @param sizeMode the environment of this operation
     * @returns
     */
    removeParent(appConfig, contentId, layoutInfo, sizeMode) {
        const sectionJson = appConfig.sections[contentId];
        if (!sectionJson || sectionJson.parent == null) {
            return appConfig;
        }
        console.debug('remove parent', layoutInfo.layoutId, layoutInfo.layoutItemId, 'from section', contentId, 'in', sizeMode);
        if (sizeMode) {
            const parents = sectionJson.parent[sizeMode];
            const newParents = this.removeParentFromList(parents, layoutInfo);
            if (newParents.length === 0) {
                return appConfig.setIn(['sections', contentId, 'parent'], sectionJson.parent.without(sizeMode));
            }
            return appConfig.setIn(['sections', contentId, 'parent', sizeMode], newParents);
        }
        let updatedAppConfig = appConfig;
        Object.keys(sectionJson.parent).forEach((s) => {
            const parents = sectionJson.parent[s];
            const newParents = this.removeParentFromList(parents, layoutInfo);
            if (newParents.length === 0) {
                updatedAppConfig = updatedAppConfig.setIn(['sections', contentId, 'parent'], sectionJson.parent.without(s));
            }
            else {
                updatedAppConfig = updatedAppConfig.setIn(['sections', contentId, 'parent', s], newParents);
            }
        });
        return updatedAppConfig;
    }
    clearParent(appConfig, contentId) {
        const sectionJson = appConfig.sections[contentId];
        if (!sectionJson || sectionJson.parent == null) {
            return appConfig;
        }
        return appConfig.setIn(['sections', contentId], sectionJson.without('parent'));
    }
    removeSizeModeParent(appConfig, contentId, browserSizeMode) {
        var _a;
        const sectionJson = appConfig.sections[contentId];
        if (!sectionJson || ((_a = sectionJson.parent) === null || _a === void 0 ? void 0 : _a[browserSizeMode]) == null) {
            return appConfig;
        }
        return appConfig.setIn(['sections', contentId, 'parent'], sectionJson.parent.without(browserSizeMode));
    }
    /**
     * Find the parent of a section in the size mode
     * @param appConfig
     * @param contentId
     * @param sizeMode
     * @returns
     */
    findParent(appConfig, contentId, sizeMode) {
        var _a, _b;
        const sectionJson = appConfig.sections[contentId];
        if (!sectionJson.parent) {
            return null;
        }
        // browserSizeMode may be not a custom layout, it is transformed from mainSizeMode
        const sectionParent = (_a = sectionJson.parent[sizeMode]) !== null && _a !== void 0 ? _a : sectionJson.parent[appConfig.mainSizeMode];
        if (!sectionParent) {
            return null;
        }
        if (sectionParent.length === 1) {
            return sectionParent[0];
        }
        // multiple parent, go to the their common parent.
        const layoutId = sectionParent[0].layoutId;
        const layout = appConfig.layouts[layoutId];
        // the parent of the layout must be a widget, i.e. List or Card
        return _widget_service__WEBPACK_IMPORTED_MODULE_4__["default"].findParent(appConfig, (_b = layout.parent) === null || _b === void 0 ? void 0 : _b.id, sizeMode);
    }
    /**
     * Create a new section. The size mode list is used to generate the layout of the view.
     * @param appConfig
     * @param sizeModeList
     * @returns
     */
    createSection(appConfig, sizeModeList) {
        console.debug('create a blank section', sizeModeList);
        // Create a new sectionJson
        const sectionId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'section');
        const sectionLabel = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(appConfig, 'section', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'section' }));
        const sectionJson = {
            id: sectionId,
            label: sectionLabel,
            views: []
        };
        let updatedAppConfig = appConfig.setIn(['sections', sectionJson.id], sectionJson);
        const result = this.addView(updatedAppConfig, sectionId, sizeModeList);
        updatedAppConfig = result[0];
        return [updatedAppConfig, sectionId];
    }
    /**
     * Create a blank view. Only unique id and parent set.
     * @param appConfig
     * @param sectionId
     * @returns
     */
    createBlankView(appConfig, sectionId) {
        return {
            id: _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'view'),
            parent: sectionId,
            label: _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(appConfig, 'view', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'view' }))
        };
    }
    /**
     * Generate and add a new view to the section.
     * @param appConfig
     * @param sectionId
     * @param sizeModeList
     * @returns
     */
    addView(appConfig, sectionId, sizeModeList) {
        var _a;
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[sectionId];
        if (!sectionJson) {
            return [appConfig, null];
        }
        // create view json
        let views;
        const viewJson = this.createBlankView(appConfig, sectionId);
        if (sectionJson.views) {
            views = sectionJson.views.asMutable();
            views.push(viewJson.id);
        }
        else {
            views = [viewJson.id];
        }
        let updatedAppConfig = appConfig
            .setIn(['views', viewJson.id], viewJson)
            .setIn(['sections', sectionId, 'views'], views);
        sizeModeList.forEach((mode) => {
            const layoutJson = {
                id: _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(updatedAppConfig, 'layout'),
                type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FixedLayout,
                content: {},
                parent: { id: viewJson.id, type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View }
            };
            updatedAppConfig = updatedAppConfig
                .setIn(['layouts', layoutJson.id], layoutJson)
                .setIn(['views', viewJson.id, 'layout', mode], layoutJson.id);
        });
        return [updatedAppConfig, viewJson.id];
    }
    /**
     * Duplicate an existing view. Only duplicate the content in specified browser size modes.
     * @param appConfig
     * @param sectionId
     * @param viewId
     * @param sizeModeList
     * @param targetBrowserSize
     * @param addToSection
     * @param context
     * @returns
     */
    duplicateView(appConfig, sectionId, viewId, sizeModeList, addToSection, context) {
        if (!appConfig.views || !appConfig.views[viewId]) {
            return [appConfig, null];
        }
        console.debug('duplicate a view', viewId, 'in', sizeModeList);
        let viewJson = appConfig.views[viewId].set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'view'));
        viewJson = viewJson.set('label', (0,_util__WEBPACK_IMPORTED_MODULE_3__.getDuplicateLabel)(appConfig, 'view', viewJson.label));
        if (!addToSection) {
            viewJson = viewJson.without('parent');
        }
        // must save into appconfig before duplicate iteration, or it's content section will get same section id to itself by getUniqueId.
        let updatedAppConfig = appConfig.setIn(['views', viewJson.id], viewJson);
        const sizeModeLayouts = {};
        sizeModeList.forEach(mode => { sizeModeLayouts[mode] = viewJson.layout[mode]; });
        // duplicate view layout
        const duplicateContext = context !== null && context !== void 0 ? context : {};
        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, sizeModeLayouts);
        const duplicateResult = service.duplicateSizeModeLayouts(updatedAppConfig, sizeModeLayouts, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.View, viewJson.id, duplicateContext);
        updatedAppConfig = duplicateResult[0];
        viewJson = viewJson.set('layout', duplicateResult[1]);
        updatedAppConfig = updatedAppConfig.setIn(['views', viewJson.id], viewJson);
        if (addToSection) {
            const views = updatedAppConfig.sections[sectionId].views.asMutable();
            const index = views.indexOf(viewId);
            views.splice(index, 1, viewId, viewJson.id);
            updatedAppConfig = updatedAppConfig.setIn(['sections', sectionId, 'views'], views);
        }
        if (context) {
            context[viewId] = viewJson.id;
        }
        return [updatedAppConfig, viewJson.id];
    }
    /**
     * Remove a view.
     * @param appConfig
     * @param sectionId
     * @param viewId
     * @returns
     */
    removeView(appConfig, sectionId, viewId) {
        var _a, _b;
        const sectionJson = (_a = appConfig.sections) === null || _a === void 0 ? void 0 : _a[sectionId];
        const viewJson = (_b = appConfig.views) === null || _b === void 0 ? void 0 : _b[viewId];
        // section should contain at least one view
        if (!viewJson || !sectionJson || sectionJson.views.length === 1 || !sectionJson.views.includes(viewId)) {
            return appConfig;
        }
        console.debug('remove a view', viewId, 'from', sectionId);
        // remove from section.views
        const views = sectionJson.views.filter((vId) => vId !== viewId);
        let updatedAppConfig = appConfig.setIn(['sections', sectionId, 'views'], views);
        // remove view layout
        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_5__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, viewJson.layout);
        updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, viewJson.layout);
        // remove from view list
        updatedAppConfig = updatedAppConfig.set('views', updatedAppConfig.views.without(viewId));
        return updatedAppConfig;
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new SectionService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/template-service.ts":
/*!*********************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/template-service.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   TemplateService: () => (/* binding */ TemplateService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_for_builder_templates__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-for-builder/templates */ "jimu-for-builder/templates");
/* harmony import */ var _translations_default__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../translations/default */ "./jimu-for-builder/lib/translations/default.ts");
/* harmony import */ var _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./layout-service-provider */ "./jimu-for-builder/lib/app-config-service/layout-service-provider.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/app-config-service/util.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class TemplateService {
    createPageFromTemplate(appConfig, templateJson, contentMapping) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            let updatedAppConfig = appConfig;
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            const templateConfig = templateJson.config;
            const pageId = Object.keys(templateConfig.pages)[0];
            const templatePage = templateConfig.pages[pageId];
            const nextPageId = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.getUniqueId(appConfig, 'page');
            const label = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.getUniqueLabel(appConfig, 'page', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'page' }));
            const sizeModeList = Object.keys((_a = templatePage.layout) !== null && _a !== void 0 ? _a : {});
            updatedAppConfig = updatedAppConfig.setIn(['pages', nextPageId], templatePage)
                .setIn(['pages', nextPageId, 'id'], nextPageId)
                .setIn(['pages', nextPageId, 'isVisible'], true)
                .setIn(['pages', nextPageId, 'isDefault'], false)
                .setIn(['pages', nextPageId, 'label'], label)
                .setIn(['pages', nextPageId, 'header'], false)
                .setIn(['pages', nextPageId, 'footer'], false);
            for (let i = 0; i < sizeModeList.length; i += 1) { // awaits in a for-loop should get executed in series
                const sizeMode = sizeModeList[i];
                const layoutId = templatePage.layout[sizeMode];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateConfig, layoutId);
                const result = yield service.createLayoutFromTemplate(updatedAppConfig, templateJson, layoutId, sizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page, nextPageId, contentMapping);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                updatedAppConfig = updatedAppConfig
                    .setIn(['pages', nextPageId, 'layout', sizeMode], newLayoutId)
                    .setIn(['layouts', newLayoutId, 'parent'], { id: nextPageId, type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page });
            }
            return [updatedAppConfig, nextPageId];
        });
    }
    createDialogFromTemplate(appConfig, templateJson, contentMapping) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            let updatedAppConfig = appConfig;
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            const templateConfig = templateJson.config;
            const dlgId = Object.keys(templateConfig.dialogs)[0];
            const templateDlg = templateConfig.dialogs[dlgId];
            const nextDlgId = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.getUniqueId(appConfig, 'dialog');
            const label = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.getUniqueLabel(appConfig, 'dialog', jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'dialog' }));
            const sizeModeList = Object.keys((_a = templateDlg.layout) !== null && _a !== void 0 ? _a : {});
            const dlgIndex = Object.keys(Object.keys(updatedAppConfig.dialogs).filter(dlgId => updatedAppConfig.dialogs[dlgId].mode === templateDlg.mode)).length;
            updatedAppConfig = updatedAppConfig.setIn(['dialogs', nextDlgId], templateDlg)
                .setIn(['dialogs', nextDlgId, 'id'], nextDlgId)
                .setIn(['dialogs', nextDlgId, 'label'], label)
                .setIn(['dialogs', nextDlgId, 'index'], dlgIndex)
                .setIn(['dialogs', nextDlgId, 'isSplash'], false)
                .setIn(['dialogs', nextDlgId, 'closeWhenClickOverlay'], templateDlg.closeWhenClickOverlay)
                .setIn(['dialogs', nextDlgId, 'sizeMode'], templateDlg.sizeMode);
            for (let i = 0; i < sizeModeList.length; i += 1) { // awaits in a for-loop should get executed in series
                const sizeMode = sizeModeList[i];
                const layoutId = templateDlg.layout[sizeMode];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateConfig, layoutId);
                const result = yield service.createLayoutFromTemplate(updatedAppConfig, templateJson, layoutId, sizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog, nextDlgId, contentMapping);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                updatedAppConfig = updatedAppConfig
                    .setIn(['dialogs', nextDlgId, 'layout', sizeMode], newLayoutId)
                    .setIn(['layouts', newLayoutId, 'parent'], { id: nextDlgId, type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog });
            }
            return [updatedAppConfig, nextDlgId];
        });
    }
    applyTemplateToHeader(appConfig, templateJson, currentSizeMode, context) {
        var _a, _b, _c, _d;
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            if (!((_a = templateJson === null || templateJson === void 0 ? void 0 : templateJson.config) === null || _a === void 0 ? void 0 : _a.header)) {
                return appConfig;
            }
            const templateHeaderLayout = templateJson.config.header.layout;
            const templateHeaderLayoutId = Object.values(templateHeaderLayout)[0];
            const headerLayout = (_b = appConfig === null || appConfig === void 0 ? void 0 : appConfig.header) === null || _b === void 0 ? void 0 : _b.layout;
            if (headerLayout) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateJson.config, templateHeaderLayoutId);
                const result = yield service.replaceSizeModeLayout(appConfig, headerLayout, templateJson, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)((_d = (_c = templateJson === null || templateJson === void 0 ? void 0 : templateJson.config) === null || _c === void 0 ? void 0 : _c.header) === null || _d === void 0 ? void 0 : _d.layout), currentSizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Header, 'header', context);
                let updatedAppConfig = result[0];
                Object.keys(result[1]).forEach(mode => {
                    const layoutId = result[1][mode];
                    updatedAppConfig = updatedAppConfig
                        .setIn(['header', 'layout', mode], layoutId)
                        .setIn(['layouts', layoutId, 'parent'], { id: 'header', type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Header });
                });
                // update other props in header template
                Object.keys(templateJson.config.header).forEach((key) => {
                    if (key !== 'layout' && templateJson.config.header[key] != null) {
                        updatedAppConfig = updatedAppConfig.setIn(['header', key], templateJson.config.header[key]);
                    }
                });
                return updatedAppConfig;
            }
            return appConfig;
        });
    }
    applyTemplateToFooter(appConfig, templateJson, currentSizeMode, context) {
        var _a, _b, _c, _d;
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            if (!((_a = templateJson === null || templateJson === void 0 ? void 0 : templateJson.config) === null || _a === void 0 ? void 0 : _a.footer)) {
                return appConfig;
            }
            const templateFooterLayout = templateJson.config.footer.layout;
            const templateFooterLayoutId = Object.values(templateFooterLayout)[0];
            const footerLayout = (_b = appConfig === null || appConfig === void 0 ? void 0 : appConfig.footer) === null || _b === void 0 ? void 0 : _b.layout;
            if (footerLayout) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateJson.config, templateFooterLayoutId);
                const result = yield service.replaceSizeModeLayout(appConfig, footerLayout, templateJson, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)((_d = (_c = templateJson === null || templateJson === void 0 ? void 0 : templateJson.config) === null || _c === void 0 ? void 0 : _c.footer) === null || _d === void 0 ? void 0 : _d.layout), currentSizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Footer, 'footer', context);
                let updatedAppConfig = result[0];
                Object.keys(result[1]).forEach(mode => {
                    const layoutId = result[1][mode];
                    updatedAppConfig = updatedAppConfig
                        .setIn(['footer', 'layout', mode], layoutId)
                        .setIn(['layouts', layoutId, 'parent'], { id: 'footer', type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Footer });
                });
                // update other props in footer template
                Object.keys(templateJson.config.footer).forEach((key) => {
                    if (key !== 'layout' && templateJson.config.footer[key] != null) {
                        updatedAppConfig = updatedAppConfig.setIn(['footer', key], templateJson.config.footer[key]);
                    }
                });
                return updatedAppConfig;
            }
            return appConfig;
        });
    }
    applyTemplateToBody(appConfig, pageId, templateJson, currentSizeMode, context) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            if (!templateJson.config) {
                const templateContent = yield (0,jimu_for_builder_templates__WEBPACK_IMPORTED_MODULE_1__.getTemplateConfig)(templateJson.type, templateJson.name);
                templateJson.config = templateContent;
                if (!templateJson.config) {
                    return appConfig;
                }
                else {
                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.fixLayoutIds(templateJson.config);
                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceI18nPlaceholdersInObject(templateJson.config, jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl(), _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"]);
                }
            }
            const templatePageId = Object.keys(templateJson.config.pages)[0];
            const templatePageLayout = templateJson.config.pages[templatePageId].layout;
            const templatePageLayoutId = Object.values(templatePageLayout)[0];
            const pageLayout = (_b = (_a = appConfig === null || appConfig === void 0 ? void 0 : appConfig.pages) === null || _a === void 0 ? void 0 : _a[pageId]) === null || _b === void 0 ? void 0 : _b.layout;
            if (pageLayout) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateJson.config, templatePageLayoutId);
                const result = yield service.replaceSizeModeLayout(appConfig, pageLayout, templateJson, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(templatePageLayout), currentSizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page, pageId, context);
                let updatedAppConfig = result[0];
                Object.keys(result[1]).forEach(mode => {
                    const layoutId = result[1][mode];
                    updatedAppConfig = updatedAppConfig
                        .setIn(['pages', pageId, 'layout', mode], layoutId)
                        .setIn(['layouts', layoutId, 'parent'], { id: pageId, type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Page });
                });
                // update other props in page template
                const props = ['mode', 'maxWidth', 'bodyBackgroundColor', 'bodyBackgroundIMage', 'bodyBackgroundPosition'];
                props.forEach((key) => {
                    const value = templateJson.config.pages[templatePageId][key];
                    if (key !== 'layout' && value != null) {
                        updatedAppConfig = updatedAppConfig.setIn(['pages', pageId, key], value);
                    }
                });
                return updatedAppConfig;
            }
            return appConfig;
        });
    }
    applyTemplateToDialog(appConfig, dialogId, templateJson, currentSizeMode, context) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            const templateDlgId = Object.keys(templateJson.config.dialogs)[0];
            const dialog = (_a = appConfig === null || appConfig === void 0 ? void 0 : appConfig.dialogs) === null || _a === void 0 ? void 0 : _a[dialogId];
            const dialogLayout = dialog === null || dialog === void 0 ? void 0 : dialog.layout;
            const templateDlg = (_c = (_b = templateJson === null || templateJson === void 0 ? void 0 : templateJson.config) === null || _b === void 0 ? void 0 : _b.dialogs) === null || _c === void 0 ? void 0 : _c[templateDlgId];
            if (dialogLayout && (templateDlg === null || templateDlg === void 0 ? void 0 : templateDlg.layout)) {
                const templateDlgLayout = templateDlg.layout;
                const templateDlgLayoutId = Object.values(templateDlgLayout)[0];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateJson.config, templateDlgLayoutId);
                const result = yield service.replaceSizeModeLayout(appConfig, dialogLayout, templateJson, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(templateDlgLayout), currentSizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog, dialogId, context);
                let updatedAppConfig = result[0];
                const isSameMode = dialog.mode === templateDlg.mode;
                const dlgIndex = isSameMode
                    ? dialog.index
                    : Object.keys(Object.keys(updatedAppConfig.dialogs).filter(dlgId => updatedAppConfig.dialogs[dlgId].mode === templateDlg.mode)).length;
                updatedAppConfig = updatedAppConfig.setIn(['dialogs', dialogId, 'index'], dlgIndex);
                Object.keys(result[1]).forEach(mode => {
                    const layoutId = result[1][mode];
                    updatedAppConfig = updatedAppConfig
                        .setIn(['dialogs', dialogId, 'layout', mode], layoutId)
                        .setIn(['layouts', layoutId, 'parent'], { id: dialogId, type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Dialog });
                });
                // update other props in dialog template
                const props = [
                    'sizeMode', 'mode', 'overlayColor', 'dialogBackground',
                    'interactionType', 'interactionStyles', 'confirmBeforeClose', 'alwaysShowConfirmation', 'closeWhenClickOverlay'
                ];
                props.forEach((key) => {
                    updatedAppConfig = updatedAppConfig.setIn(['dialogs', dialogId, key], templateDlg[key]);
                });
                // update index for other dialogs which has same mode when current dialog's mode is changed.
                if (!isSameMode) {
                    Object.keys(updatedAppConfig.dialogs).forEach(dlgId => {
                        const dlg = updatedAppConfig.dialogs[dlgId];
                        if (dlg.mode === dialog.mode && dlg.index > dialog.index) {
                            updatedAppConfig = updatedAppConfig.setIn(['dialogs', dlg.id, 'index'], dlg.index - 1);
                        }
                    });
                }
                return updatedAppConfig;
            }
            return appConfig;
        });
    }
    applyGridTemplate(appConfig, widgetId, templateJson, currentSizeMode, context) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            const widgetLayout = (_b = (_a = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _a === void 0 ? void 0 : _a[widgetId]) === null || _b === void 0 ? void 0 : _b.layouts;
            const templateGridWidget = Object.values(templateJson.config.widgets).find(widgetJson => widgetJson.uri === 'widgets/layout/grid/');
            const name = 'DEFAULT';
            const sizeModeLayouts = widgetLayout[name];
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getInstance().getServiceByType(jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.GridLayout);
            const result = yield service.replaceSizeModeLayout(appConfig, sizeModeLayouts, templateJson, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(templateGridWidget.layouts[name]), currentSizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, widgetId, context);
            let updatedAppConfig = result[0];
            Object.keys(result[1]).forEach(mode => {
                const layoutId = result[1][mode];
                updatedAppConfig = updatedAppConfig
                    .setIn(['widgets', widgetId, 'layouts', name, mode], layoutId)
                    .setIn(['layouts', layoutId, 'parent'], { id: widgetId, type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget });
            });
            return updatedAppConfig;
        });
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new TemplateService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/util.ts":
/*!*********************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/util.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getDuplicateLabel: () => (/* binding */ getDuplicateLabel),
/* harmony export */   makeSureTemplateConfig: () => (/* binding */ makeSureTemplateConfig)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_for_builder_templates__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-for-builder/templates */ "jimu-for-builder/templates");
/* harmony import */ var _translations_default__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../translations/default */ "./jimu-for-builder/lib/translations/default.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



function getDuplicateLabel(appConfig, type, label) {
    const [prefix] = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.parseUniqueLabel(label);
    let newLabel = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.getUniqueLabel(appConfig, type, prefix);
    if (newLabel === prefix) {
        newLabel = `${prefix} 1`;
    }
    return newLabel;
}
function makeSureTemplateConfig(templateJson) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!templateJson.config) {
            const templateContent = yield (0,jimu_for_builder_templates__WEBPACK_IMPORTED_MODULE_1__.getTemplateConfig)(templateJson.type, templateJson.name);
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.fixLayoutIds(templateContent);
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceI18nPlaceholdersInObject(templateContent, jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl(), _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"]);
            templateJson.config = templateContent;
        }
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/widget-resource/data-action-service.ts":
/*!****************************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/widget-resource/data-action-service.ts ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DataActionService: () => (/* binding */ DataActionService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
class DataActionService {
    removeFromWidget(appConfig, widgetId) {
        var _a;
        const widget = appConfig.widgets[widgetId];
        if (!((_a = widget.manifest) === null || _a === void 0 ? void 0 : _a.dataActions) || widget.manifest.dataActions.length === 0) {
            return appConfig;
        }
        console.debug('remove data action in', widgetId);
        const actionNames = widget.manifest.dataActions.map(dataAction => dataAction.name);
        let updatedAppConfig = appConfig;
        Object.keys(appConfig.widgets).forEach(id => {
            let widgetItem = appConfig.widgets[id];
            if (widgetItem.dataActions) {
                actionNames.forEach(actionName => {
                    var _a, _b;
                    const dataActionConfig = (_a = widgetItem.dataActions) === null || _a === void 0 ? void 0 : _a[actionName];
                    if (dataActionConfig) {
                        const newActions = (_b = dataActionConfig.actions) === null || _b === void 0 ? void 0 : _b.without(widgetId);
                        if (Object.keys(newActions || {}).length === 0) {
                            // remove this type of data action
                            widgetItem = widgetItem.set('dataActions', widgetItem.dataActions.without(actionName));
                            if (Object.keys(widgetItem.dataActions).length === 0) { // no action left in dataActions
                                widgetItem = widgetItem.without('dataActions');
                            }
                        }
                        else {
                            widgetItem = widgetItem.setIn(['dataActions', actionName, 'actions'], newActions);
                        }
                        updatedAppConfig = updatedAppConfig.setIn(['widgets', id], widgetItem);
                    }
                });
            }
        });
        return updatedAppConfig;
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new DataActionService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/widget-resource/data-source-service.ts":
/*!****************************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/widget-resource/data-source-service.ts ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DataSourceService: () => (/* binding */ DataSourceService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-layouts/layout-runtime */ "jimu-layouts/layout-runtime");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/app-config-service/util.ts");



class DataSourceService {
    removeDataSource(appConfig, dataSourceId) {
        var _a, _b;
        if (!appConfig.dataSources || !appConfig.dataSources[dataSourceId]) {
            return appConfig;
        }
        console.debug('removeDataSource', dataSourceId);
        let updatedAppConfig = appConfig.set('dataSources', appConfig.dataSources.without(dataSourceId));
        Object.entries((_a = updatedAppConfig.widgets) !== null && _a !== void 0 ? _a : {}).forEach(([wId, wJson]) => {
            // update widget use data source
            if (wJson.useDataSources &&
                wJson.useDataSources.find((useDs) => this.shouldBeRemoved(useDs, dataSourceId))) {
                updatedAppConfig = updatedAppConfig.setIn(['widgets', wId, 'useDataSources'], wJson.useDataSources.filter((useDs) => !this.shouldBeRemoved(useDs, dataSourceId)));
            }
            // update widget output data source
            if (wJson.outputDataSources && wJson.outputDataSources.find((outDsId) => outDsId === dataSourceId)) {
                updatedAppConfig = updatedAppConfig.setIn(['widgets', wId, 'outputDataSources'], wJson.outputDataSources.filter((outDsId) => outDsId !== dataSourceId));
            }
        });
        // update message use data source
        Object.keys((_b = updatedAppConfig.messageConfigs) !== null && _b !== void 0 ? _b : {}).forEach((mcId) => {
            var _a;
            const mJson = updatedAppConfig.messageConfigs[mcId];
            const actions = (_a = mJson.actions) === null || _a === void 0 ? void 0 : _a.asMutable({ deep: true });
            actions === null || actions === void 0 ? void 0 : actions.forEach((action, index) => {
                var _a;
                if ((_a = action === null || action === void 0 ? void 0 : action.useDataSources) === null || _a === void 0 ? void 0 : _a.find((useDs) => this.shouldBeRemoved(useDs, dataSourceId))) {
                    actions[index].useDataSources = action.useDataSources.filter((useDs) => !this.shouldBeRemoved(useDs, dataSourceId));
                    updatedAppConfig = updatedAppConfig.setIn(['messageConfigs', mcId, 'actions'], actions);
                }
            });
        });
        // remove output data source
        Object.entries(updatedAppConfig.dataSources).forEach(([dsId, dsJson]) => {
            if (dsJson.originDataSources &&
                !!dsJson.originDataSources.find((useDs) => this.shouldBeRemoved(useDs, dataSourceId))) {
                updatedAppConfig = this.removeDataSource(updatedAppConfig, dsId);
            }
        });
        return updatedAppConfig;
    }
    duplicateDataSource(appConfig, dataSourceId) {
        if (!appConfig.dataSources || !appConfig.dataSources[dataSourceId]) {
            return null;
        }
        console.debug('duplicate data source', dataSourceId);
        const dsJson = appConfig.dataSources[dataSourceId];
        const newDsJson = dsJson.set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_1__.getUniqueId(appConfig, 'dataSource'))
            .set('label', (0,_util__WEBPACK_IMPORTED_MODULE_2__.getDuplicateLabel)(appConfig, 'dataSource', dsJson.label));
        const updatedAppConfig = this.addDataSource(appConfig, newDsJson);
        return [updatedAppConfig, newDsJson];
    }
    addDataSource(appConfig, dataSourceJson) {
        if (appConfig.dataSources && appConfig.dataSources[dataSourceJson.id]) {
            return appConfig;
        }
        return appConfig.setIn(['dataSources', dataSourceJson.id], dataSourceJson);
    }
    updateAfterChangingLayout(appConfig, widgetId, toLayoutId) {
        if (!appConfig.widgets[widgetId]) {
            return appConfig;
        }
        console.debug(widgetId, 'update data source after move to', toLayoutId);
        let widgetJson = appConfig.widgets[widgetId];
        let updatedAppConfig = appConfig;
        const parentWidgetId = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_0__.searchUtils.getWidgetIdThatUseTheLayoutId(updatedAppConfig, toLayoutId);
        if (parentWidgetId) {
            const parentWidgetJson = updatedAppConfig.widgets[parentWidgetId];
            if (parentWidgetJson.manifest.properties.passDataSourceToChildren) {
                widgetJson = this.mergeUseDataSource(parentWidgetJson, widgetJson);
                updatedAppConfig = updatedAppConfig.setIn(['widgets', widgetJson.id], widgetJson);
            }
        }
        return updatedAppConfig;
    }
    mergeUseDataSource(fromWidgetJson, toWidgetJson) {
        if (!fromWidgetJson.useDataSources) {
            return toWidgetJson;
        }
        const fromUseDs = fromWidgetJson.useDataSources.map(useDs => {
            return useDs.without('fields');
        });
        if (!toWidgetJson.useDataSources) {
            return toWidgetJson.set('useDataSources', fromUseDs).set('useDataSourcesEnabled', true);
        }
        fromUseDs.forEach(useDs => {
            if (useDs.dataViewId) {
                if (!toWidgetJson.useDataSources.find(ds => ds.dataSourceId === useDs.dataSourceId && ds.dataViewId === useDs.dataViewId)) {
                    toWidgetJson = toWidgetJson.set('useDataSources', toWidgetJson.useDataSources.concat([useDs]));
                }
            }
            else {
                if (!toWidgetJson.useDataSources.find(ds => ds.dataSourceId === useDs.dataSourceId)) {
                    toWidgetJson = toWidgetJson.set('useDataSources', toWidgetJson.useDataSources.concat([useDs]));
                }
            }
        });
        return toWidgetJson.set('useDataSourcesEnabled', true);
    }
    /**
     * Remove data source which is:
     *  1. the data source to be removed, or,
     *  2. derived from the data source to be removed (data views and local data sources), or,
     *  3. descendant data source of the data source to be removed (e.g. child data source and grandchild data source), or,
     *  4. derived from the descendant data source of the data source to be removed (e.g. data views of child data source).
     */
    shouldBeRemoved(useDs, realToBeRemovedDsId) {
        return (!useDs ||
            useDs.dataSourceId === realToBeRemovedDsId ||
            useDs.mainDataSourceId === realToBeRemovedDsId ||
            useDs.rootDataSourceId === realToBeRemovedDsId);
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new DataSourceService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/widget-resource/message-action-service.ts":
/*!*******************************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/widget-resource/message-action-service.ts ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MessageActionService: () => (/* binding */ MessageActionService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");


class MessageActionService {
    /**
     * Duplicate a widget's message action config. Including:
     * 1. duplicate the item that matches widgetId
     * 2. duplicate actions that matches widgetId
     * @param appConfig
     * @param widgetId
     * @param newWidgetId
     * @returns
     */
    duplicate(appConfig, widgetId, newWidgetId) {
        const messageConfigs = appConfig.messageConfigs;
        if (!messageConfigs) {
            return [appConfig, null];
        }
        console.debug('duplicate message configs from', widgetId, 'to', newWidgetId);
        let updatedAppConfig = appConfig;
        let newMcId = null;
        Object.keys(messageConfigs).forEach(mcId => {
            if (messageConfigs[mcId].widgetId === widgetId) {
                const newMJson = messageConfigs[mcId]
                    .set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_1__.getUniqueId(appConfig, 'messageConfig'))
                    .set('widgetId', newWidgetId);
                newMcId = newMJson.id;
                updatedAppConfig = updatedAppConfig.setIn(['messageConfigs', newMJson.id], newMJson);
            }
            if (messageConfigs[mcId].actions) {
                const toAdd = [];
                messageConfigs[mcId].actions.forEach(actionJson => {
                    if (actionJson.widgetId === widgetId) {
                        const newActionJson = actionJson.set('widgetId', newWidgetId);
                        toAdd.push(newActionJson);
                    }
                });
                if (toAdd.length > 0) {
                    updatedAppConfig = updatedAppConfig.setIn(['messageConfigs', messageConfigs[mcId].id, 'actions'], messageConfigs[mcId].actions.concat(toAdd));
                }
            }
        });
        return [updatedAppConfig, newMcId];
    }
    /**
     * Clean the messageConfigs, remove anything that related to the widgetId
     * @param appConfig
     * @param widgetId
     * @returns
     */
    removeFromWidget(appConfig, widgetId) {
        const messageConfigs = appConfig.messageConfigs;
        if (!messageConfigs) {
            return appConfig;
        }
        console.debug('remove message and action in', widgetId);
        const messageConfigsKeys = Object.keys(messageConfigs);
        let messageConfigsWithoutWidgetId = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
        for (let i = 0; i < messageConfigsKeys.length; i++) {
            if (messageConfigs[messageConfigsKeys[i]].widgetId !== widgetId) {
                messageConfigsWithoutWidgetId = messageConfigsWithoutWidgetId.setIn([messageConfigs[messageConfigsKeys[i]].id], messageConfigs[messageConfigsKeys[i]]);
            }
        }
        const newMessageConfigsKeys = Object.keys(messageConfigsWithoutWidgetId);
        for (let i = 0; i < newMessageConfigsKeys.length; i++) {
            const newMessageConfig = messageConfigsWithoutWidgetId[newMessageConfigsKeys[i]];
            const actions = newMessageConfig.actions;
            if (actions.length === 0) {
                continue;
            }
            const actionsWithoutWidgetId = actions.filter((action) => action.widgetId !== widgetId);
            const tempActions = Object.assign([], actionsWithoutWidgetId);
            messageConfigsWithoutWidgetId = messageConfigsWithoutWidgetId.setIn([messageConfigs[newMessageConfigsKeys[i]].id, 'actions'], tempActions);
        }
        return appConfig.set('messageConfigs', messageConfigsWithoutWidgetId);
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new MessageActionService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/widget-resource/usemap-service.ts":
/*!***********************************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/widget-resource/usemap-service.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   UseMapService: () => (/* binding */ UseMapService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
class UseMapService {
    remove(appConfig, mapWidgetId) {
        let updatedAppConfig = appConfig;
        console.debug('remove used map widgets', mapWidgetId);
        Object.keys(updatedAppConfig.widgets).forEach((widgetId) => {
            var _a;
            const widgetJson = updatedAppConfig.widgets[widgetId];
            if ((_a = widgetJson.useMapWidgetIds) === null || _a === void 0 ? void 0 : _a.includes(mapWidgetId)) {
                const useMapWidgetIds = widgetJson.useMapWidgetIds.filter((id) => id !== mapWidgetId);
                updatedAppConfig = updatedAppConfig.setIn(['widgets', widgetId, 'useMapWidgetIds'], useMapWidgetIds);
            }
        });
        return updatedAppConfig;
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new UseMapService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-config-service/widget-service.ts":
/*!*******************************************************************!*\
  !*** ./jimu-for-builder/lib/app-config-service/widget-service.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WidgetService: () => (/* binding */ WidgetService),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _base_content_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base-content-service */ "./jimu-for-builder/lib/app-config-service/base-content-service.ts");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./layout-service-provider */ "./jimu-for-builder/lib/app-config-service/layout-service-provider.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/app-config-service/util.ts");
/* harmony import */ var _widget_resource_data_source_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./widget-resource/data-source-service */ "./jimu-for-builder/lib/app-config-service/widget-resource/data-source-service.ts");
/* harmony import */ var _widget_resource_message_action_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./widget-resource/message-action-service */ "./jimu-for-builder/lib/app-config-service/widget-resource/message-action-service.ts");
/* harmony import */ var _widget_resource_data_action_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./widget-resource/data-action-service */ "./jimu-for-builder/lib/app-config-service/widget-resource/data-action-service.ts");
/* harmony import */ var _widget_resource_usemap_service__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./widget-resource/usemap-service */ "./jimu-for-builder/lib/app-config-service/widget-resource/usemap-service.ts");
/* harmony import */ var _app_widget_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../app-widget-manager */ "./jimu-for-builder/lib/app-widget-manager.tsx");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_place_holder_svg__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/widget-place-holder.svg */ "./jimu-icons/svg/outlined/brand/widget-place-holder.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_place_holder_svg__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_widget_place_holder_svg__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_fixed_panel_svg__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/widget-fixed-panel.svg */ "./jimu-icons/svg/outlined/brand/widget-fixed-panel.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_fixed_panel_svg__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_widget_fixed_panel_svg__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_row_svg__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/widget-row.svg */ "./jimu-icons/svg/outlined/brand/widget-row.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_row_svg__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_widget_row_svg__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_column_svg__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/widget-column.svg */ "./jimu-icons/svg/outlined/brand/widget-column.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_column_svg__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_widget_column_svg__WEBPACK_IMPORTED_MODULE_13__);
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};














function hasEmbeddedLayoutInWidget(manifest) {
    var _a, _b;
    return (manifest === null || manifest === void 0 ? void 0 : manifest.widgetType) === jimu_core__WEBPACK_IMPORTED_MODULE_0__.WidgetType.Layout || ((_b = (_a = manifest === null || manifest === void 0 ? void 0 : manifest.properties) === null || _a === void 0 ? void 0 : _a.hasEmbeddedLayout) !== null && _b !== void 0 ? _b : false);
}
function getLayoutIcon(layoutType) {
    switch (layoutType) {
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.FixedLayout:
            return (jimu_icons_svg_outlined_brand_widget_fixed_panel_svg__WEBPACK_IMPORTED_MODULE_11___default());
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.RowLayout:
            return (jimu_icons_svg_outlined_brand_widget_row_svg__WEBPACK_IMPORTED_MODULE_12___default());
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutType.ColumnLayout:
            return (jimu_icons_svg_outlined_brand_widget_column_svg__WEBPACK_IMPORTED_MODULE_13___default());
        default:
            return null;
    }
}
/**
 * Widget manages some resources, e.g. layout, data source, data action, etc.
 * Will handle all properties listed in the WidgetJson except the config
 */
class WidgetService extends _base_content_service__WEBPACK_IMPORTED_MODULE_1__.BaseContentService {
    constructor() {
        super();
        this.dsService = _widget_resource_data_source_service__WEBPACK_IMPORTED_MODULE_5__["default"];
        this.messageActionService = _widget_resource_message_action_service__WEBPACK_IMPORTED_MODULE_6__["default"];
        this.dataActionService = _widget_resource_data_action_service__WEBPACK_IMPORTED_MODULE_7__["default"];
        this.useMapService = _widget_resource_usemap_service__WEBPACK_IMPORTED_MODULE_8__["default"];
    }
    createFromTemplate(appConfig, templateJson, widgetId, sizeModeList, context, options) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            if (context[widgetId]) {
                // already duplicatd in a stack of function invokations.
                // Use case: A Card widget is shared in a page's Large and Small size mode, and the page is duplicated.
                // 1. card is duplicated in Large size mode, its embed layouts is duplicated in Large size mode too.
                // 2. when duplicate the small size mode, the card does not need to be duplicated again, but the embed layouts needs to be duplicated.
                // check the duplicated widget has the target browser size mode layout
                const widgetJson = appConfig.widgets[context[widgetId]];
                if (!widgetJson.layouts) {
                    return [appConfig, context[widgetId]];
                }
                let updatedAppConfig = appConfig;
                const originWidget = templateJson.config.widgets[widgetId];
                for (let i = 0; i < sizeModeList.length; i++) {
                    const sizeMode = sizeModeList[i];
                    // create embed layout in target browser size mode from template, only select non-empty layoutName
                    const layoutNames = Object.keys(originWidget.layouts).filter(layoutName => { var _a; return Object.keys((_a = originWidget.layouts[layoutName]) !== null && _a !== void 0 ? _a : {}).length > 0; });
                    for (let j = 0; j < layoutNames.length; j++) {
                        const name = layoutNames[j];
                        if (widgetJson.layouts[name][sizeMode]) {
                            continue;
                        }
                        const layoutId = originWidget.layouts[name][sizeMode];
                        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateJson.config, layoutId);
                        const dupResult = yield service.createLayoutFromTemplate(updatedAppConfig, templateJson, layoutId, sizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, context[widgetId], context);
                        updatedAppConfig = dupResult[0];
                        const newLayoutId = dupResult[1];
                        if (newLayoutId != null) {
                            updatedAppConfig = updatedAppConfig.setIn(['widgets', context[widgetId], 'layouts', name, sizeMode], newLayoutId);
                        }
                    }
                }
                return [updatedAppConfig, context[widgetId]];
            }
            const isBlock = (_a = options === null || options === void 0 ? void 0 : options.isBlock) !== null && _a !== void 0 ? _a : false;
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            const templateConfig = templateJson.config;
            const blockWidgetId = Object.keys(templateConfig.widgets).find(wId => templateConfig.widgets[wId].uri === 'widgets/layout/row/');
            widgetId = widgetId !== null && widgetId !== void 0 ? widgetId : blockWidgetId;
            const templateWidget = templateConfig.widgets[widgetId];
            const useMapWidgetIds = [];
            const loadedJson = yield _app_widget_manager__WEBPACK_IMPORTED_MODULE_9__["default"].getInstance().handleNewWidgetJson({
                uri: templateWidget.uri
            });
            // update label, since the appConfig doesnot updated, the label will always be the same
            loadedJson.label = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(appConfig, 'widget', loadedJson.manifest ? loadedJson.manifest.i18nMessages._widgetLabel || loadedJson.manifest.label || loadedJson.manifest.name : '');
            const result = this.createWidget(appConfig, loadedJson, sizeModeList, false); // embed layout will be updated later
            let updatedAppConfig = result[0];
            const newWidgetId = result[1];
            // register extensions
            yield _app_widget_manager__WEBPACK_IMPORTED_MODULE_9__["default"].getInstance().registerManifestProps(updatedAppConfig.widgets[newWidgetId]);
            if (isBlock) {
                // update the widget label using block
                const blockLabel = jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'block' });
                const newLabel = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueLabel(updatedAppConfig, 'widget', blockLabel);
                updatedAppConfig = updatedAppConfig.setIn(['widgets', newWidgetId, 'label'], newLabel);
            }
            context[widgetId] = newWidgetId;
            // TODO move this logic after creating page/dialog/header/footer from template
            // create map widgets that this widget depend on
            if (((_b = templateWidget.useMapWidgetIds) === null || _b === void 0 ? void 0 : _b.length) > 0) {
                for (let i = 0; i < templateWidget.useMapWidgetIds.length; i++) {
                    // contentMapping is used to avoid creating multiple instances of a widget
                    const result = yield this.createFromTemplate(updatedAppConfig, templateJson, templateWidget.useMapWidgetIds[i], sizeModeList, context, options);
                    updatedAppConfig = result[0];
                    useMapWidgetIds.push(result[1]);
                }
            }
            if (useMapWidgetIds.length > 0) {
                updatedAppConfig = updatedAppConfig.setIn(['widgets', newWidgetId, 'useMapWidgetIds'], useMapWidgetIds);
            }
            updatedAppConfig = yield this.updateWidgetByTemplate(updatedAppConfig, templateJson, newWidgetId, widgetId, sizeModeList, context);
            return [updatedAppConfig, newWidgetId];
        });
    }
    /**
     * Apply widget configs and other resources from template.
     * Used in card, bookmark which have template layout.
     * @param appConfig
     * @param templateJson
     * @param widgetId
     * @param templateWidgetId
     * @param context
     * @param settingDefaultMessages
     * @returns
     */
    updateWidgetByTemplate(appConfig, templateJson, widgetId, templateWidgetId, sizeModeList, context) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            const oldWidgetJson = (_a = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _a === void 0 ? void 0 : _a[widgetId];
            if (!oldWidgetJson) {
                return appConfig;
            }
            yield (0,_util__WEBPACK_IMPORTED_MODULE_4__.makeSureTemplateConfig)(templateJson);
            let updatedAppConfig = appConfig;
            // remove layouts of the old widget if any
            oldWidgetJson.layouts && Object.keys(oldWidgetJson.layouts).forEach(key => {
                const devices = oldWidgetJson.layouts[key];
                Object.keys(devices).forEach(device => {
                    const layoutId = devices[device];
                    const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(updatedAppConfig, layoutId);
                    updatedAppConfig = service.removeLayout(updatedAppConfig, layoutId, device);
                });
            });
            updatedAppConfig = updatedAppConfig.setIn(['widgets', widgetId], oldWidgetJson.without('layouts'));
            const templateConfig = templateJson === null || templateJson === void 0 ? void 0 : templateJson.config;
            const templateWidget = (_b = templateConfig === null || templateConfig === void 0 ? void 0 : templateConfig.widgets) === null || _b === void 0 ? void 0 : _b[templateWidgetId];
            const newLayoutIds = [];
            if (templateWidget) { // It's not a empty template
                if (templateWidget.config) {
                    updatedAppConfig = updatedAppConfig.setIn(['widgets', widgetId, 'config'], templateWidget.config);
                }
                if (templateWidget.style) {
                    updatedAppConfig = updatedAppConfig.setIn(['widgets', widgetId, 'style'], templateWidget.style);
                }
                if (templateWidget.layouts) {
                    const layouts = templateWidget.layouts;
                    const layoutIds = []; // widget layouts need to be assigned
                    Object.keys(layouts).forEach((layoutName) => {
                        var _a, _b;
                        const sizeModeLayouts = layouts[layoutName] || {};
                        const layoutInManifest = ((_b = (_a = oldWidgetJson.manifest) === null || _a === void 0 ? void 0 : _a.layouts) !== null && _b !== void 0 ? _b : []).find(item => item.name === layoutName);
                        sizeModeList.forEach(sizeMode => {
                            var _a;
                            const layoutId = (_a = sizeModeLayouts[sizeMode]) !== null && _a !== void 0 ? _a : sizeModeLayouts[appConfig.mainSizeMode];
                            if (layoutId) {
                                layoutIds.push({
                                    layoutName,
                                    sizeMode,
                                    layoutId,
                                    layoutLabel: layoutInManifest === null || layoutInManifest === void 0 ? void 0 : layoutInManifest.label
                                });
                            }
                        });
                    });
                    for (let i = 0; i < layoutIds.length; i += 1) { // awaits in a for-loop should get executed in series
                        const { layoutName, sizeMode, layoutId, layoutLabel } = layoutIds[i];
                        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(templateConfig, layoutId);
                        const result = yield service.createLayoutFromTemplate(updatedAppConfig, templateJson, layoutId, sizeMode, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, oldWidgetJson.id, context);
                        updatedAppConfig = result[0];
                        const newLayoutId = result[1];
                        newLayoutIds.push(newLayoutId);
                        updatedAppConfig = updatedAppConfig
                            .setIn(['widgets', oldWidgetJson.id, 'layouts', layoutName, sizeMode], newLayoutId)
                            .setIn(['layouts', newLayoutId, 'label'], ((_c = oldWidgetJson === null || oldWidgetJson === void 0 ? void 0 : oldWidgetJson.manifest) === null || _c === void 0 ? void 0 : _c.i18nMessages[`_layout_${layoutName}_label`]) || layoutLabel || layoutName);
                    }
                }
            }
            return updatedAppConfig;
        });
    }
    /**
     * The widgetJson should have been processed by AppWidgetManager.getInstance().handleNewWidgetJson(widgetJson)
     * and it's ready to be added into appConfig
     * @param appConfig
     * @param widgetJson
     * @param sizeModeList
     * @param createEmbedLayout
     * @returns
     */
    createWidget(appConfig, widgetJson, sizeModeList, createEmbedLayout = true) {
        let updatedAppConfig = appConfig;
        const widgetId = _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'widget');
        console.debug('createWidget', widgetJson);
        updatedAppConfig = updatedAppConfig
            .setIn(['widgets', widgetId], widgetJson)
            .setIn(['widgets', widgetId, 'id'], widgetId);
        if (createEmbedLayout && hasEmbeddedLayoutInWidget(widgetJson.manifest)) {
            const layouts = widgetJson.manifest.layouts || [];
            layouts.forEach((layout) => {
                sizeModeList.forEach(sizeMode => {
                    const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getInstance().getServiceByType(layout.type);
                    const result = service.createBlankLayout(updatedAppConfig, layout.type);
                    updatedAppConfig = result[0];
                    const layoutId = result[1];
                    console.debug('embed layout', layout.name, layoutId, layout.type, 'created in', sizeMode);
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', layoutId, 'label'], widgetJson.manifest.i18nMessages[`_layout_${layout.name}_label`] || layout.label)
                        .setIn(['layouts', layoutId, 'parent'], { id: widgetId, type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget })
                        .setIn(['widgets', widgetId, 'layouts', layout.name, sizeMode], layoutId);
                });
            });
        }
        return [updatedAppConfig, widgetId];
    }
    duplicateEmbedLayout(appConfig, contentId, fromSizeMode, toSizeMode) {
        var _a;
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson || !widgetJson.layouts) {
            return [appConfig, null];
        }
        let updatedAppConfig = appConfig;
        console.debug('duplicate layout of widget', contentId);
        if (((_a = widgetJson.manifest) === null || _a === void 0 ? void 0 : _a.widgetType) === jimu_core__WEBPACK_IMPORTED_MODULE_0__.WidgetType.Layout && fromSizeMode !== toSizeMode) {
            console.debug('deuplicate layout widget and its layout from', fromSizeMode, 'to', toSizeMode);
            // a layout widget should duplicate itself instead of duplicate its layout content
            const newWidgetJson = widgetJson.set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'widget')).without('layouts').without('parent');
            updatedAppConfig = updatedAppConfig.setIn(['widgets', newWidgetJson.id], newWidgetJson);
            Object.keys(widgetJson.layouts).forEach(name => {
                const layouts = widgetJson.layouts[name];
                if (layouts[fromSizeMode]) {
                    const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(updatedAppConfig, layouts[fromSizeMode]);
                    const result = service.duplicateLayout(updatedAppConfig, layouts[fromSizeMode], fromSizeMode, toSizeMode, null, false);
                    updatedAppConfig = result[0];
                    const newLayoutId = result[1];
                    if (newLayoutId != null) {
                        updatedAppConfig = updatedAppConfig
                            .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, id: newWidgetJson.id })
                            .setIn(['widgets', newWidgetJson.id, 'layouts', name, toSizeMode], newLayoutId);
                    }
                }
            });
            return [updatedAppConfig, newWidgetJson.id];
        }
        console.debug('duplicate widget layout only from', fromSizeMode, 'to', toSizeMode);
        // a functional widget like card or list should only duplicate a size mode layout. The widget itself remains the same.
        Object.keys(widgetJson.layouts).forEach(name => {
            const layouts = widgetJson.layouts[name];
            if (layouts[fromSizeMode]) {
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(updatedAppConfig, layouts[fromSizeMode]);
                if (layouts[toSizeMode]) { // remove the existing layout in target size mode
                    updatedAppConfig = service.removeLayout(updatedAppConfig, layouts[toSizeMode], toSizeMode);
                }
                const result = service.duplicateLayout(updatedAppConfig, layouts[fromSizeMode], fromSizeMode, toSizeMode, null, false);
                updatedAppConfig = result[0];
                const newLayoutId = result[1];
                if (newLayoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, id: contentId })
                        .setIn(['widgets', contentId, 'layouts', name, toSizeMode], newLayoutId);
                }
            }
        });
        return [updatedAppConfig, null];
    }
    duplicate(appConfig, contentId, targetBrowserSize, context) {
        console.debug('duplicate a widget', contentId);
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson) {
            return [appConfig, null];
        }
        if (context === null || context === void 0 ? void 0 : context[contentId]) {
            // already duplicatd in a stack of function invokations.
            // Use case: A Card widget is shared in a page's Large and Small size mode, and the page is duplicated.
            // 1. card is duplicated in Large size mode, its embed layouts is duplicated in Large size mode too.
            // 2. when duplicate the small size mode, the card does not need to be duplicated again, but the embed layouts needs to be duplicated.
            // check the duplicated widget has the target browser size mode layout
            const widgetJson = appConfig.widgets[context[contentId]];
            if (!widgetJson.layouts) {
                return [appConfig, context[contentId]];
            }
            const firstName = Object.keys(widgetJson.layouts)[0];
            const sizemodeLayouts = widgetJson.layouts[firstName];
            if (sizemodeLayouts[targetBrowserSize]) {
                return [appConfig, context[contentId]];
            }
            // duplicate embed layout in target browser size mode from original widget to duplicated widget
            const originWidget = appConfig.widgets[contentId];
            let updatedAppConfig = appConfig;
            Object.keys(originWidget.layouts).forEach(name => {
                const layoutId = originWidget.layouts[name][targetBrowserSize];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(updatedAppConfig, layoutId);
                const dupResult = service.duplicateLayout(updatedAppConfig, layoutId, targetBrowserSize, targetBrowserSize, context, true);
                updatedAppConfig = dupResult[0];
                const newLayoutId = dupResult[1];
                if (newLayoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['widgets', context[contentId], 'layouts', name, targetBrowserSize], newLayoutId)
                        .setIn(['layouts', newLayoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, id: context[contentId] });
                }
            });
            return [updatedAppConfig, context[contentId]];
        }
        const newWJson = widgetJson.set('id', _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_2__.getUniqueId(appConfig, 'widget'))
            .set('label', (0,_util__WEBPACK_IMPORTED_MODULE_4__.getDuplicateLabel)(appConfig, 'widget', widgetJson.label));
        const updatedAppConfig = this.beforeDuplicated(appConfig, contentId, newWJson, targetBrowserSize, context);
        if (context) {
            context[contentId] = newWJson.id;
        }
        return [updatedAppConfig, newWJson.id];
    }
    tryRemove(appConfig, contentId, layoutInfo, sizeMode) {
        var _a, _b, _c;
        const widgetJson = (_a = appConfig.widgets) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!widgetJson) {
            return appConfig;
        }
        // 1. current size mode passed, check other size mode
        const hasOtherModes = [jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Large, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Medium, jimu_core__WEBPACK_IMPORTED_MODULE_0__.BrowserSizeMode.Small]
            .filter(mode => mode !== sizeMode)
            .some(mode => { var _a, _b; return ((_b = (_a = widgetJson.parent) === null || _a === void 0 ? void 0 : _a[mode]) === null || _b === void 0 ? void 0 : _b.length) > 0; });
        const isMultipleParents = ((_c = (_b = widgetJson.parent) === null || _b === void 0 ? void 0 : _b[sizeMode]) === null || _c === void 0 ? void 0 : _c.length) > 1;
        if (!hasOtherModes && !isMultipleParents) { // can be removed
            return this.remove(appConfig, contentId);
        }
        else {
            // 1. remove parent for this size mode
            let updatedAppConfig = this.removeParent(appConfig, contentId, layoutInfo, sizeMode);
            // 2. remove embed layout of this size mode if any
            if (widgetJson.layouts) {
                Object.keys(widgetJson.layouts).forEach((name) => {
                    const sizeModeLayout = widgetJson.layouts[name];
                    if (sizeModeLayout[sizeMode]) {
                        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, sizeModeLayout);
                        updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, { [sizeMode]: sizeModeLayout[sizeMode] });
                        updatedAppConfig = updatedAppConfig.setIn(['widgets', contentId, 'layouts', name], sizeModeLayout.without(sizeMode));
                    }
                });
            }
            return updatedAppConfig;
        }
    }
    remove(appConfig, contentId) {
        var _a;
        const widgetJson = (_a = appConfig.widgets) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!widgetJson) {
            return appConfig;
        }
        console.debug('remove a widget', contentId);
        const updatedAppConfig = this.beforeRemoved(appConfig, contentId);
        // remove the widget
        return updatedAppConfig.set('widgets', updatedAppConfig.widgets.without(contentId));
    }
    toTocNode(appConfig, contentId, parent, browserSizeMode) {
        var _a, _b, _c, _d;
        const { layoutId, layoutItemId } = parent;
        const result = {
            label: '',
            layoutId,
            layoutItemId,
            type: 'widget',
            id: contentId
        };
        const widgetJson = (_a = appConfig.widgets) === null || _a === void 0 ? void 0 : _a[contentId];
        if (!widgetJson) {
            if (contentId == null) {
                result.label = jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'placeholder' });
                result.icon = (jimu_icons_svg_outlined_brand_widget_place_holder_svg__WEBPACK_IMPORTED_MODULE_10___default());
                result.flipIcon = false;
                result.isLabelReadOnly = true;
            }
            return result;
        }
        result.label = widgetJson.label;
        result.icon = widgetJson.icon;
        result.flipIcon = (_d = (_c = (_b = widgetJson.manifest) === null || _b === void 0 ? void 0 : _b.properties) === null || _c === void 0 ? void 0 : _c.flipIcon) !== null && _d !== void 0 ? _d : false;
        if (!(widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.layouts)) {
            return result;
        }
        const children = [];
        const isSolo = Object.keys(widgetJson.layouts).length === 1;
        Object.keys(widgetJson.layouts).forEach((name) => {
            var _a, _b, _c, _d;
            const layoutId = (_a = widgetJson.layouts[name][browserSizeMode]) !== null && _a !== void 0 ? _a : widgetJson.layouts[name][appConfig.mainSizeMode];
            const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(appConfig, layoutId);
            const embedChildren = service.getTocStructure(appConfig, layoutId);
            if (embedChildren.length > 0) {
                const layoutType = appConfig.layouts[layoutId].type;
                const manifestLayout = (_c = (_b = widgetJson.manifest) === null || _b === void 0 ? void 0 : _b.layouts) === null || _c === void 0 ? void 0 : _c.find(item => item.name === name);
                children.push({
                    label: isSolo ? '' : (manifestLayout != null ? ((_d = widgetJson.manifest.i18nMessages[`_layout_${name}_label`]) !== null && _d !== void 0 ? _d : manifestLayout.label) : name),
                    icon: getLayoutIcon(layoutType),
                    type: 'layout',
                    id: layoutId,
                    isLabelReadOnly: true,
                    children: embedChildren
                });
            }
        });
        if (children.length === 1) {
            result.children = children[0].children;
        }
        else if (children.length > 1) {
            result.children = children;
        }
        return result;
    }
    afterMoved(appConfig, contentId, fromLayout, toLayout) {
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson) {
            return appConfig;
        }
        console.debug('update widget', contentId, 'ds after moved to a new layout', toLayout);
        return this.dsService.updateAfterChangingLayout(appConfig, contentId, toLayout);
    }
    /**
     * 1. add new widget
     * 2. add pending item back to the layout, may be from different size mode
     * @param appConfig
     * @param contentId
     * @param toLayout
     * @param fromSizeMode
     * @param toSizeMode
     * @returns
     */
    afterAdded(appConfig, contentId, toLayout, fromSizeMode, toSizeMode) {
        var _a;
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson) {
            return appConfig;
        }
        console.debug('after added, update widget', contentId, 'added to a new layout', toLayout, 'from', fromSizeMode, 'to', toSizeMode);
        let updatedAppConfig = this.dsService.updateAfterChangingLayout(appConfig, contentId, toLayout);
        // If the widget has embed layout, and the layout does not exist in the current sizeMode, we'll create a new one for them.
        Object.keys((_a = widgetJson.layouts) !== null && _a !== void 0 ? _a : {}).forEach(layoutName => {
            const sizeModeLayouts = widgetJson.layouts[layoutName];
            if (sizeModeLayouts[fromSizeMode] && !sizeModeLayouts[toSizeMode]) {
                const layoutJson = updatedAppConfig.layouts[sizeModeLayouts[fromSizeMode]];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(updatedAppConfig, sizeModeLayouts[fromSizeMode]);
                const result = service.duplicateLayout(updatedAppConfig, layoutJson.id, fromSizeMode, toSizeMode, null);
                updatedAppConfig = result[0];
                const layoutId = result[1];
                if (layoutId != null) {
                    updatedAppConfig = updatedAppConfig
                        .setIn(['layouts', layoutId, 'parent'], { type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, id: contentId })
                        .setIn(['widgets', contentId, 'layouts', layoutName, toSizeMode], layoutId);
                }
            }
        });
        return updatedAppConfig;
    }
    /**
     * Clear resource related to this widget
     * @param appConfig
     * @param contentId
     */
    beforeRemoved(appConfig, contentId) {
        var _a, _b, _c;
        const widgetJson = appConfig.widgets[contentId];
        let updatedAppConfig = appConfig;
        console.debug('clear widget resource before removing', contentId);
        // remove all parent layout infos
        Object.keys((_a = widgetJson.parent) !== null && _a !== void 0 ? _a : {}).forEach((sizeMode) => {
            if (widgetJson.parent[sizeMode].length > 0) {
                widgetJson.parent[sizeMode].forEach(item => {
                    const layoutJson = updatedAppConfig.layouts[item.layoutId];
                    if (layoutJson) {
                        const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getService(updatedAppConfig, item.layoutId);
                        updatedAppConfig = service.removeItem(updatedAppConfig, item, sizeMode, false);
                    }
                });
            }
        });
        // data source
        if (widgetJson.outputDataSources) {
            widgetJson.outputDataSources.forEach((odsId) => {
                updatedAppConfig = this.dsService.removeDataSource(updatedAppConfig, odsId);
            });
        }
        // message/action
        updatedAppConfig = this.messageActionService.removeFromWidget(updatedAppConfig, contentId);
        // remove data action of this widget if any
        updatedAppConfig = this.dataActionService.removeFromWidget(updatedAppConfig, contentId);
        // remvoe layout if any
        if (widgetJson.layouts) {
            Object.keys(widgetJson.layouts).forEach((name) => {
                const sizeModeLayout = widgetJson.layouts[name];
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, sizeModeLayout);
                updatedAppConfig = service.removeSizeModeLayouts(updatedAppConfig, sizeModeLayout);
            });
        }
        // TODO should be handled before remove operation starts
        // remove useMapWidgetIds if the removed widget is map
        if ((_c = (_b = widgetJson.manifest) === null || _b === void 0 ? void 0 : _b.properties) === null || _c === void 0 ? void 0 : _c.canCreateMapView) {
            updatedAppConfig = this.useMapService.remove(updatedAppConfig, widgetJson.id);
        }
        // Do other clean actions before removing the widget
        const ext = this.findAppConfigOperationExtension(contentId);
        if (ext) {
            updatedAppConfig = ext.widgetWillRemove(updatedAppConfig);
        }
        return updatedAppConfig;
    }
    beforeDuplicated(appConfig, contentId, newWidgetJson, toSizeMode, context) {
        var _a, _b, _c;
        let updatedAppConfig = appConfig;
        console.debug('process before duplicate widget', contentId);
        // duplicate layouts in the widget
        if (hasEmbeddedLayoutInWidget(newWidgetJson.manifest)) {
            // add into appconfig first for generate a different unique id of it's sub widgets
            updatedAppConfig = updatedAppConfig.setIn(['widgets', newWidgetJson.id], newWidgetJson);
            Object.keys((_a = newWidgetJson.layouts) !== null && _a !== void 0 ? _a : {}).forEach(key => {
                var _a;
                const layouts = newWidgetJson.layouts[key];
                // should have duplicate context in duplicating size mode layout
                const duplicateContext = context !== null && context !== void 0 ? context : {};
                const service = _layout_service_provider__WEBPACK_IMPORTED_MODULE_3__.LayoutServiceProvider.getServiceFromSizeModeLayout(updatedAppConfig, layouts);
                const duplicateResult = service.duplicateSizeModeLayouts(updatedAppConfig, { [toSizeMode]: (_a = layouts[toSizeMode]) !== null && _a !== void 0 ? _a : layouts[appConfig.mainSizeMode] }, // only duplicate the target size mode
                jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutParentType.Widget, newWidgetJson.id, duplicateContext);
                updatedAppConfig = duplicateResult[0];
                newWidgetJson = newWidgetJson.setIn(['layouts', key], duplicateResult[1]);
            });
        }
        // duplicate message/actions
        updatedAppConfig = this.messageActionService.duplicate(updatedAppConfig, contentId, newWidgetJson.id)[0];
        // duplicate output ds
        if (((_b = newWidgetJson.outputDataSources) === null || _b === void 0 ? void 0 : _b.length) > 0) {
            const newDsIds = newWidgetJson.outputDataSources.map(dsId => {
                const result = this.dsService.duplicateDataSource(updatedAppConfig, dsId);
                updatedAppConfig = result[0];
                const newDsJson = result[1];
                return newDsJson.id;
            });
            newWidgetJson = newWidgetJson.set('outputDataSources', newDsIds);
            // update datasource id used in the widget config
            // TODO improve this logic, move into widget that has lifecycle operations
            let strWConfig = JSON.stringify(newWidgetJson.config);
            newDsIds.forEach((id, index) => {
                const oldId = newWidgetJson.outputDataSources[index];
                const re = new RegExp(oldId, 'g');
                strWConfig = strWConfig.replace(re, id);
            });
            try {
                const newWConfig = JSON.parse(strWConfig);
                newWidgetJson = newWidgetJson.set('config', newWConfig);
            }
            catch (e) {
                console.error('JSON format error', newWidgetJson);
            }
        }
        // TODO should be handled after duplication operation finished
        // handle useMapWidgetIds
        if (((_c = newWidgetJson.useMapWidgetIds) === null || _c === void 0 ? void 0 : _c.length) > 0) {
            newWidgetJson.useMapWidgetIds.forEach((mapWidgetId, i) => {
                if (context === null || context === void 0 ? void 0 : context[mapWidgetId]) {
                    newWidgetJson = newWidgetJson.setIn(['useMapWidgetIds', i], context[mapWidgetId]);
                }
            });
        }
        updatedAppConfig = updatedAppConfig.setIn(['widgets', newWidgetJson.id], newWidgetJson);
        return updatedAppConfig;
    }
    /**
     * Invoke the afterWidgetCopied when a size mode layouts is duplicate.
     * @param destAppConfig
     * @param context
     */
    afterBatchCopied(destAppConfig, sourceAppConfig, context) {
        let updatedAppConfig = destAppConfig;
        Object.keys(context !== null && context !== void 0 ? context : {}).forEach(contentId => {
            const destWidgetId = context[contentId];
            if (sourceAppConfig.widgets[contentId] && updatedAppConfig.widgets[destWidgetId]) { // the content is a widget
                let ext;
                if (destAppConfig === sourceAppConfig) {
                    // operation in the same environment, extension should have been registered by the contentId
                    ext = this.findAppConfigOperationExtension(contentId);
                    if (ext) {
                        updatedAppConfig = ext.afterWidgetCopied(contentId, sourceAppConfig, destWidgetId, updatedAppConfig, context);
                    }
                }
                else {
                    ext = this.findAppConfigOperationExtension(destWidgetId); // the copied widget is registered in the extension
                    if (ext) {
                        updatedAppConfig = ext.afterWidgetCopied(contentId, sourceAppConfig, destWidgetId, updatedAppConfig, context);
                    }
                }
            }
        });
        return updatedAppConfig;
    }
    addParent(appConfig, contentId, layoutInfo, sizeMode) {
        var _a;
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson) {
            return appConfig;
        }
        console.debug('add parent', layoutInfo.layoutId, layoutInfo.layoutItemId, 'to widget', contentId, 'in', sizeMode);
        const list = this.addParentToList(appConfig, (_a = widgetJson.parent) === null || _a === void 0 ? void 0 : _a[sizeMode], layoutInfo);
        return appConfig.setIn(['widgets', contentId, 'parent', sizeMode], list);
    }
    removeParent(appConfig, contentId, layoutInfo, sizeMode) {
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson || widgetJson.parent == null) {
            return appConfig;
        }
        console.debug('remove parent', layoutInfo.layoutId, layoutInfo.layoutItemId, 'from widget', contentId, 'in', sizeMode);
        if (sizeMode) {
            const parents = widgetJson.parent[sizeMode];
            const newParents = this.removeParentFromList(parents, layoutInfo);
            if (newParents.length === 0) {
                return appConfig.setIn(['widgets', contentId, 'parent'], widgetJson.parent.without(sizeMode));
            }
            return appConfig.setIn(['widgets', contentId, 'parent', sizeMode], newParents);
        }
        let updatedAppConfig = appConfig;
        Object.keys(widgetJson.parent).forEach((s) => {
            const parents = widgetJson.parent[s];
            const newParents = this.removeParentFromList(parents, layoutInfo);
            if (newParents.length === 0) {
                updatedAppConfig = updatedAppConfig.setIn(['widgets', contentId, 'parent'], widgetJson.parent.without(s));
            }
            else {
                updatedAppConfig = updatedAppConfig.setIn(['widgets', contentId, 'parent', s], newParents);
            }
        });
        return updatedAppConfig;
    }
    clearParent(appConfig, contentId) {
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson || widgetJson.parent == null) {
            return appConfig;
        }
        return appConfig.setIn(['widgets', contentId], widgetJson.without('parent'));
    }
    removeSizeModeParent(appConfig, contentId, browserSizeMode) {
        var _a;
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson || ((_a = widgetJson.parent) === null || _a === void 0 ? void 0 : _a[browserSizeMode]) == null) {
            return appConfig;
        }
        return appConfig.setIn(['widgets', contentId, 'parent'], widgetJson.parent.without(browserSizeMode));
    }
    findParent(appConfig, contentId, browserSizeMode) {
        var _a, _b;
        const widgetJson = appConfig.widgets[contentId];
        if (!widgetJson || !widgetJson.parent) {
            return null;
        }
        // browserSizeMode may be not a custom layout, it is transformed from mainSizeMode
        const widgetParent = (_a = widgetJson.parent[browserSizeMode]) !== null && _a !== void 0 ? _a : widgetJson.parent[appConfig.mainSizeMode];
        if (!widgetParent) {
            return null;
        }
        if (widgetParent.length === 1) {
            return widgetParent[0];
        }
        // multiple parent, go to the their common parent.
        const layoutId = widgetParent[0].layoutId;
        const layout = appConfig.layouts[layoutId];
        // the parent of the layout must be a widget, i.e. List or Card
        return this.findParent(appConfig, (_b = layout.parent) === null || _b === void 0 ? void 0 : _b.id, browserSizeMode);
    }
    findAppConfigOperationExtension(widgetId) {
        // should use the extensionManager of the app
        let extensionManager;
        if (window.jimuConfig.isBuilder) {
            extensionManager = window._appWindow._extensionManager;
        }
        else {
            extensionManager = window._extensionManager;
        }
        const exts = extensionManager === null || extensionManager === void 0 ? void 0 : extensionManager.getExtensions(`${jimu_core__WEBPACK_IMPORTED_MODULE_0__.extensionSpec.ExtensionPoints.AppConfigOperations}`);
        return exts === null || exts === void 0 ? void 0 : exts.find((item) => item.widgetId === widgetId);
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new WidgetService());


/***/ }),

/***/ "./jimu-for-builder/lib/app-data-action-manager.tsx":
/*!**********************************************************!*\
  !*** ./jimu-for-builder/lib/app-data-action-manager.tsx ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ AppDataActionManager)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _app_config_actions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./app-config-actions */ "./jimu-for-builder/lib/app-config-actions.ts");
/* harmony import */ var _widget_setting_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./widget-setting-manager */ "./jimu-for-builder/lib/widget-setting-manager.tsx");



const { getTranslatedLocale: getSupportedLocale } = jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n;
class AppDataActionManager {
    constructor() {
        this.actionSettings = {};
    }
    static getInstance() {
        if (!AppDataActionManager.instance) {
            AppDataActionManager.instance = new AppDataActionManager();
        }
        return AppDataActionManager.instance;
    }
    /**
     * Update this.actionSettings if there is new widget with data action is added.
     */
    loadAllActionSettingClasses() {
        var _a;
        const appConfigAction = (0,_app_config_actions__WEBPACK_IMPORTED_MODULE_1__.getAppConfigAction)();
        Object.keys(((_a = appConfigAction.appConfig) === null || _a === void 0 ? void 0 : _a.widgets) || {}).forEach(widgetId => {
            var _a;
            const widget = appConfigAction.appConfig.widgets[widgetId];
            const actionJsons = [].concat((_a = widget.manifest) === null || _a === void 0 ? void 0 : _a.dataActions).filter(action => action);
            if (actionJsons.length > 0) {
                actionJsons.forEach(action => {
                    if (action.settingUri) {
                        const uri = `${widget.uri}dist/${action.settingUri}`;
                        if (!this.actionSettings[uri]) {
                            this.actionSettings[uri] = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader
                                .loadModule(uri, ['default'])
                                .then(ActionClass => {
                                const rawClazz = ActionClass.default;
                                return _widget_setting_manager__WEBPACK_IMPORTED_MODULE_2__["default"].getInstance().loadI18nMessagesForSetting(widget.uri).then(i18nMessages => {
                                    return this.injectActionSettingProps(rawClazz, i18nMessages, widget.id);
                                });
                            });
                        }
                    }
                });
            }
        });
        return this.actionSettings;
    }
    injectActionSettingProps(WrappedComponent, i18nMessages, actionWidgetId) {
        const IntlInjectedComponent = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.injectIntl)(WrappedComponent);
        const actionWidgetJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig.widgets[actionWidgetId];
        let widgetName = null;
        if (actionWidgetId && actionWidgetJson) {
            widgetName = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig.widgets[actionWidgetId].manifest.name;
        }
        else {
            widgetName = 'Framework';
        }
        class WidgetWrapper extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.PureComponent {
            render() {
                const injectProps = {
                    messages: i18nMessages
                };
                // merge in the app's messages before creating the context so that
                // any jimu-ui components in this component can have access to their own messages
                // NOTE: messages with the same key will be overridden, so please make sure widget do not use the same key with jimu.
                const appI18nMessages = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appI18nMessages;
                let locale = null;
                if (actionWidgetId && actionWidgetJson) {
                    locale = getSupportedLocale((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale, actionWidgetJson.manifest.translatedLocales.asMutable());
                    if (!locale) {
                        // widget does not support user's locale, use the default locale
                        locale = actionWidgetJson.manifest.translatedLocales && actionWidgetJson.manifest.translatedLocales[0];
                    }
                    if (!locale) {
                        locale = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale;
                    }
                }
                else {
                    locale = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale;
                }
                const allMessages = Object.assign({}, i18nMessages, appI18nMessages);
                return (jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement(jimu_core__WEBPACK_IMPORTED_MODULE_0__.IntlProvider, { locale: locale, messages: allMessages },
                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement(IntlInjectedComponent, Object.assign({}, this.props, injectProps))));
            }
        }
        WidgetWrapper.displayName = `ActionSettingWrapper(${widgetName})`;
        // copy static properites
        for (const p in WrappedComponent) {
            if (!WidgetWrapper[p]) {
                WidgetWrapper[p] = WrappedComponent[p];
            }
        }
        return WidgetWrapper;
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-message-manager.tsx":
/*!******************************************************!*\
  !*** ./jimu-for-builder/lib/app-message-manager.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ AppMessageManager)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _widget_setting_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./widget-setting-manager */ "./jimu-for-builder/lib/widget-setting-manager.tsx");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


const { getTranslatedLocale: getSupportedLocale } = jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n;
class AppMessageManager {
    constructor() {
        this.actionSettings = {};
    }
    static getInstance() {
        if (!AppMessageManager.instance) {
            AppMessageManager.instance = new AppMessageManager();
        }
        return AppMessageManager.instance;
    }
    getAllActions() {
        const appMM = this.getAppMessageManager();
        if (appMM) {
            return appMM.getActions();
        }
        else {
            return [];
        }
    }
    getAction(widgetId, actionName) {
        const appMM = this.getAppMessageManager();
        if (appMM) {
            return appMM.getAction(widgetId, actionName);
        }
        else {
            return null;
        }
    }
    getAppMessageManager() {
        if (window.jimuConfig.isBuilder) {
            if (window._appWindow._messageManager) {
                return window._appWindow._messageManager;
            }
        }
        else if (window._messageManager) {
            return window._messageManager;
        }
        return null;
    }
    /**
     * Return the action setting component uri, null means no setting.
     */
    getActionSettingComponentUri(action, messageType, messageWidgetId) {
        if (action.getSettingComponentUri) {
            return action.getSettingComponentUri(messageType, messageWidgetId);
        }
        else {
            if (action.widgetId) {
                const widgetJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig.widgets[action.widgetId];
                const actionInManifest = widgetJson.manifest.messageActions.find(a => a.name === action.name);
                if (!actionInManifest) {
                    return null;
                }
                else {
                    return actionInManifest.settingUri;
                }
            }
            else {
                return null;
            }
        }
    }
    getFilteredActions(messageType, messageWidgetId) {
        if (window._appWindow._messageManager) {
            const actions = window._appWindow._messageManager.getActions();
            const filteredActions = [];
            const messageDescription = {
                messageType,
                widgetId: messageWidgetId
            };
            const state = window.jimuConfig.isBuilder ? (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState();
            const widgetJson = state.appConfig.widgets[messageWidgetId];
            const pm = widgetJson.manifest.publishMessages.find(pm => {
                if (typeof pm === 'string') {
                    return pm === messageType;
                }
                else {
                    return pm.messageType === messageType;
                }
            });
            if (pm && typeof pm !== 'string') {
                messageDescription.messageCarryData = pm.messageCarryData;
            }
            for (let i = 0; i < actions.length; i++) {
                if (actions[i].filterMessageDescription(messageDescription)) {
                    filteredActions.push(actions[i]);
                }
            }
            return filteredActions;
        }
        else {
            return [];
        }
    }
    getConvertedSettingUri(actionId, settingUri) {
        const allActions = this.getAllActions();
        let resultUri = null;
        for (let i = 0; i < allActions.length; i++) {
            if (actionId.includes(allActions[i].id)) {
                const actionWidgetId = allActions[i].widgetId;
                if (actionWidgetId) {
                    // the action target is widget
                    const widgetJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig.widgets[actionWidgetId];
                    const messageActions = widgetJson.manifest.messageActions;
                    let actionProperty = null;
                    if (messageActions) {
                        for (let k = 0; k < messageActions.length; k++) {
                            if (messageActions[k].name === allActions[i].name) {
                                actionProperty = messageActions[k];
                            }
                        }
                    }
                    if (actionProperty && settingUri) {
                        resultUri = widgetJson.uri + 'dist/' + settingUri;
                        return resultUri;
                    }
                    else {
                        return null;
                    }
                }
                else {
                    // the action target is framework
                    return settingUri;
                }
            }
        }
        return resultUri;
    }
    loadActionSettingClass(actionJson, actionSettingUri) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const uri = actionSettingUri ? this.getConvertedSettingUri(actionJson.actionId, actionSettingUri) : null;
            if (!uri) {
                Promise.resolve(null);
            }
            if (!this.actionSettings[uri]) {
                this.actionSettings[uri] = {};
            }
            if ((_a = this.actionSettings[uri]) === null || _a === void 0 ? void 0 : _a.clazzPromise) {
                return yield this.actionSettings[uri].clazzPromise;
            }
            const actionWidgetId = actionJson.widgetId;
            const actionWidgetJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig.widgets[actionWidgetId];
            this.actionSettings[uri].clazzPromise = this.loadRawSettingClass(uri).then((rawClazz) => __awaiter(this, void 0, void 0, function* () {
                return _widget_setting_manager__WEBPACK_IMPORTED_MODULE_1__["default"].getInstance().loadI18nMessagesForSetting(actionWidgetJson && actionWidgetJson.uri).then(i18nMessages => {
                    return this.injectActionSettingProps(rawClazz, i18nMessages, actionWidgetJson && actionWidgetJson.id);
                });
            })).then((wrapedClass) => {
                this.actionSettings[uri].clazz = wrapedClass;
                return wrapedClass;
            });
            return this.actionSettings[uri].clazzPromise;
        });
    }
    loadRawSettingClass(uri) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.actionSettings[uri].rawClazzPromise) {
                return yield this.actionSettings[uri].rawClazzPromise;
            }
            this.actionSettings[uri].rawClazzPromise = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.loadModule(uri).then(rawClazz => {
                rawClazz = rawClazz.default ? rawClazz.default : rawClazz;
                this.actionSettings[uri].rawClazz = rawClazz;
                return this.actionSettings[uri].rawClazz;
            });
            return this.actionSettings[uri].rawClazzPromise;
        });
    }
    injectActionSettingProps(WrappedComponent, i18nMessages, actionWidgetId) {
        const IntlInjectedComponent = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.injectIntl)(WrappedComponent);
        const actionWidgetJson = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig.widgets[actionWidgetId];
        let widgetName = null;
        if (actionWidgetId && actionWidgetJson) {
            widgetName = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig.widgets[actionWidgetId].manifest.name;
        }
        else {
            widgetName = 'Framework';
        }
        class WidgetWrapper extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.PureComponent {
            render() {
                const injectProps = {
                    messages: i18nMessages
                };
                // merge in the app's messages before creating the context so that
                // any jimu-ui components in this component can have access to their own messages
                // NOTE: messages with the same key will be overridden, so please make sure widget do not use the same key with jimu.
                const appI18nMessages = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appI18nMessages;
                let locale = null;
                if (actionWidgetId && actionWidgetJson) {
                    locale = getSupportedLocale((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale, actionWidgetJson.manifest.translatedLocales.asMutable());
                    if (!locale) {
                        // widget does not support user's locale, use the default locale
                        locale = actionWidgetJson.manifest.translatedLocales && actionWidgetJson.manifest.translatedLocales[0];
                    }
                    if (!locale) {
                        locale = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale;
                    }
                }
                else {
                    locale = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale;
                }
                const allMessages = Object.assign({}, i18nMessages, appI18nMessages);
                return (jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement(jimu_core__WEBPACK_IMPORTED_MODULE_0__.IntlProvider, { locale: locale, messages: allMessages },
                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement(IntlInjectedComponent, Object.assign({}, this.props, injectProps))));
            }
        }
        WidgetWrapper.displayName = `ActionSettingWrapper(${widgetName})`;
        // copy static properites
        for (const p in WrappedComponent) {
            if (!WidgetWrapper[p]) {
                WidgetWrapper[p] = WrappedComponent[p];
            }
        }
        return WidgetWrapper;
    }
    registerActionRawSettingClass(uri, rawSettingClass) {
        if (!this.actionSettings[uri]) {
            this.actionSettings[uri] = {};
        }
        this.actionSettings[uri].rawClazz = rawSettingClass;
        this.actionSettings[uri].rawClazzPromise = Promise.resolve(rawSettingClass);
        this.actionSettings[uri].settingI18nMessages = {};
        this.actionSettings[uri].settingI18nMessagesPromise = Promise.resolve({});
    }
    getActionRawSettingClass(uri) {
        return this.actionSettings[uri].rawClazz;
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-resource-manager.tsx":
/*!*******************************************************!*\
  !*** ./jimu-for-builder/lib/app-resource-manager.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AppResourceFilePath: () => (/* binding */ AppResourceFilePath),
/* harmony export */   AppResourceManager: () => (/* binding */ AppResourceManager)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _builder_state_resource_extension__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./builder-state-resource-extension */ "./jimu-for-builder/lib/builder-state-resource-extension.ts");
/* harmony import */ var _service_app_service_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./service/app-service/util */ "./jimu-for-builder/lib/service/app-service/util.ts");
/* harmony import */ var _service_rest_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./service/rest-service */ "./jimu-for-builder/lib/service/rest-service.tsx");
/* harmony import */ var _utils_app_config_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils/app-config-utils */ "./jimu-for-builder/lib/utils/app-config-utils.ts");
/* harmony import */ var jimu_ui__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jimu-ui */ "jimu-ui");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






var AppResourceFilePath;
(function (AppResourceFilePath) {
    AppResourceFilePath["Config"] = "config/config.json";
    AppResourceFilePath["Image"] = "images/image-resources-list.json";
    AppResourceFilePath["Icon"] = "images/icon-resources-list.json";
})(AppResourceFilePath || (AppResourceFilePath = {}));
/**
 * The resource manager is used to process the resources in the app. It can be used to upload resources to the server, update the config, and to fetch resources from the server.
 *
 * App resources refer to files used by the app, such as images, icons, and config.json. They are stored on the ArcGIS rest server associated with the app item.
 * The storage structure of the resources are as follows:
 * {
 *    resources: [
 *        { resource: 'config/config.json' , ...}, // This file is the draft version appConfig
 *        { resource: 'images/image-resources-list.json' , ...}, // This file is stored imageResources.
 *        { resource: 'images/icon-resources-list.json' , ...}, // This file is stored iconResources.
 *        { resource: 'images/widget_1/123456.jpg' , ...}, // This file is stored image item.
 *        ...
 *    ]
 * }
 *
 * These first 3 app resources are special. The config.json is the draft version appConfig.
 * The image-resources-list.json and icon-resources-list.json are used to manage other resources, we call them management resources, they don't have `ResourceItemInfo` but their content have `ResourceItemInfo` to manage the item resources.
 * All other resources are called resource items, they have `ResourceItemInfo`.
 *
 * The manager handles mapping app resource URLs to the underlying storage location. So code can refer to a normalized URL like ${appResourceUrl}/images/widget1/image.png. And the manager will handle uploading resources to the proper /images/widget1/location.
 *
 * Here is how the resources are processed:
 *  * When uploading resources, it converts files to blobs and generates blob URLs.
 *  * When saving and updating the app config, it replaces blob URLs with the corresponding resource URLs.
 *  * When fetching resources from server, it replaces `${appResourceUrl}` with portalUrl and add token to the end of the url.
 *
 */
class AppResourceManager {
    constructor() {
        // Cache app resources data in local web app by uploaded.
        this.resourceMap = {};
        this.blobToResourceMap = {};
        // All app resources, includes the resources that are uploaded but have not been saved yet.
        this.resources = {};
        this.getResourcesInDraft = () => this.resources;
        this.setResourcesInDraft = (resources) => {
            this.resources = Object.assign(Object.assign({}, this.getResourcesInDraft()), resources);
        };
        /**
         * Get the image resource list from the draft. The draft resources contains the resources that have been uploaded or fetched from the server.
         * If the resource is already cached in the draft, return the image resources in the draft.
         * If not, will fetch the image resources from the server and replace `${appResourceUrl}` with portalUrl and add token.
         */
        this.getImageResourceListFromDraft = (appId) => __awaiter(this, void 0, void 0, function* () {
            const resourcesInDraft = this.getResourcesInDraft();
            if (resourcesInDraft.imageResources) {
                return yield Promise.resolve(resourcesInDraft.imageResources);
            }
            else {
                const session = this.getSession();
                const portalUrlWithFull = this.getPortalUrlWithFull(appId);
                const { resources } = yield this.fetchAppResourceInfoList(appId);
                const isExistImageResourcesListFile = (resources === null || resources === void 0 ? void 0 : resources.some(({ resource }) => resource === AppResourceFilePath.Image)) || false;
                if (isExistImageResourcesListFile) {
                    const imageResourceList = (yield this.fetchAppResource(appId, { fileName: AppResourceFilePath.Image, readAs: 'json' })) || {};
                    Object.values(imageResourceList).forEach(resource => {
                        if (resource.url.includes('?token=')) {
                            resource.url = resource.url.slice(0, resource.url.indexOf('?token='));
                        }
                        resource.url = resource.url.replace('${appResourceUrl}', portalUrlWithFull) + '?token=' + (session === null || session === void 0 ? void 0 : session.token);
                    });
                    return yield Promise.resolve(imageResourceList);
                }
                return yield this.upLoadImageResourceList({});
            }
        });
        this.getIconResourceListFromDraft = () => __awaiter(this, void 0, void 0, function* () {
            const { iconResources } = this.getResourcesInDraft();
            if (iconResources) {
                return yield Promise.resolve(iconResources);
            }
            const appId = this.getAppId();
            const session = this.getSession();
            const portalUrlWithFull = this.getPortalUrlWithFull(appId);
            const { resources } = yield this.fetchAppResourceInfoList(appId);
            const isExistIconResourceListFile = (resources === null || resources === void 0 ? void 0 : resources.some(({ resource }) => resource === AppResourceFilePath.Icon)) || false;
            if (isExistIconResourceListFile) {
                const iconResourceList = yield this.fetchAppResource(appId, { fileName: AppResourceFilePath.Icon, readAs: 'json' });
                if (iconResourceList) {
                    Object.values(iconResourceList).forEach(resource => {
                        resource.svg = resource.svg.replace('${appResourceUrl}', portalUrlWithFull) + '?token=' + (session === null || session === void 0 ? void 0 : session.token);
                        if (typeof resource.properties.path === 'string') {
                            resource.properties.path = resource.properties.path.replace('${appResourceUrl}', portalUrlWithFull) + '?token=' + (session === null || session === void 0 ? void 0 : session.token);
                        }
                    });
                    return yield Promise.resolve(iconResourceList);
                }
            }
            return yield this.upLoadIconResourceList({});
        });
        /**
         * Filter out the image resources being used by widgets or components in the app from the image resource list.
         * It checks the app config for matches. And it will replace the local image blob url or portal url to `${appResourceUrl}` so that it can be matched. The result will be cached into configSourceMap.
         */
        this.getInUseImageResources = (imageResourceList) => {
            var _a;
            const appConfig = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig;
            // Modify the url in appConfig to ${appResourceUrl}/...
            let cleanAppConfig = (0,_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_4__.getCleanAppConfig)(appConfig);
            // Replace local image blob url to ${appResourceUrl}/... in appConfig.
            cleanAppConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceStringInObject(Object.assign({}, cleanAppConfig), {
                matcher: (value) => /^blob:\http(s?):\/\/(.)/.test(value),
                handler: (value) => { var _a; return ((_a = this.blobToResourceMap[value]) === null || _a === void 0 ? void 0 : _a.resourceUrl) || value; }
            });
            // Matcher ${appResourceUrl}/... from appConfig, and cache into configSourceMap.
            const configSourceMap = {};
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceStringInObject(Object.assign({}, cleanAppConfig), {
                matcher: (value) => /^\$\{appResourceUrl\}+(.)/.test(value),
                handler: (value) => (configSourceMap[value] = value)
            });
            // Filter related image resources in draft.
            const relatedImageResources = [];
            Object.values(imageResourceList).forEach((imageResource) => {
                const resourceUrl = `\${appResourceUrl}/${imageResource.resourcesPrefix}/${imageResource.fileName}`;
                configSourceMap[resourceUrl] && relatedImageResources.push(imageResource);
            });
            const imageResourcesInUse = this.formatRelatedImageResources(imageResourceList, relatedImageResources);
            return imageResourcesInUse;
        };
        this.getInUseIconResources = (iconResourceList) => {
            var _a;
            const appConfig = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig;
            // Modify the url in appConfig to ${appResourceUrl}/...
            let cleanAppConfig = (0,_utils_app_config_utils__WEBPACK_IMPORTED_MODULE_4__.getCleanAppConfig)(appConfig);
            // Replace local image blob url to ${appResourceUrl}/... in appConfig.
            cleanAppConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceStringInObject(Object.assign({}, cleanAppConfig), {
                matcher: (value) => /^blob:\http(s?):\/\/(.)/.test(value),
                handler: (value) => { var _a; return ((_a = this.blobToResourceMap[value]) === null || _a === void 0 ? void 0 : _a.resourceUrl) || value; }
            });
            // Matcher ${appResourceUrl}/... from appConfig, and cache into configSourceMap.
            const configSourceMap = {};
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceStringInObject(Object.assign({}, cleanAppConfig), {
                matcher: (value) => /^\$\{appResourceUrl\}+(.)/.test(value),
                handler: (value) => (configSourceMap[value] = value)
            });
            // Filter related icon resources in draft.
            const inUseIconResources = [];
            Object.values(iconResourceList).forEach((iconResource) => {
                const resourceUrl = `\${appResourceUrl}/images/icon_picker_in_setting/${iconResource.properties.filename}`;
                configSourceMap[resourceUrl] && inUseIconResources.push(iconResource);
            });
            return inUseIconResources;
        };
        /**
         * Upload config.json (AppConfig) to the app resources, this function is called when the save app button is clicked.
         */
        this.upLoadAppConfig = (appId, config, owner) => __awaiter(this, void 0, void 0, function* () {
            const noLocalFileConfig = yield this.upLoadLocalResource(config);
            const file = new Blob([JSON.stringify(noLocalFileConfig)], { type: 'application/json' });
            const resourceItemInfo = {
                appId,
                file,
                fileName: 'config.json',
                type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.ResourceType.Config,
                owner
            };
            return yield this.upLoadAppResource(resourceItemInfo)
                .then(() => __awaiter(this, void 0, void 0, function* () { return yield Promise.resolve(config); }))
                .catch((err) => __awaiter(this, void 0, void 0, function* () { return yield Promise.reject(err); }));
        });
        /**
         * Upload the image-resources-list.json to app resources list.
         */
        this.upLoadImageResourceList = (resourceList, newAppId) => __awaiter(this, void 0, void 0, function* () {
            const resourceListToUpload = Object.assign({}, resourceList);
            return yield this.upLoadResourceList(AppResourceFilePath.Image, resourceListToUpload, newAppId);
        });
        this.upLoadIconResourceList = (resourceList, newAppId) => __awaiter(this, void 0, void 0, function* () {
            return yield this.upLoadResourceList(AppResourceFilePath.Icon, resourceList, newAppId);
        });
        /**
         * Upload a resource file to the server via rest api.
         * It will check if the resource already exists on the server. If it does, will update the resource. If not, will add the resource.
         *
         * The resource file can be a config/config.json, images/image-resources-list.json, images/icon-resources-list.json, and the image items like images/widget_1/1689818129651.png
         */
        this.upLoadAppResource = (resourceItemInfo) => __awaiter(this, void 0, void 0, function* () {
            resourceItemInfo.resourcesPrefix = AppResourceManager.getResourcePrefix(resourceItemInfo);
            const { appId = this.getAppId(), fileName, originalName, resourcesPrefix } = resourceItemInfo;
            const resourcePath = (resourcesPrefix ? resourcesPrefix + '/' : '') + fileName;
            const resourceUrl = '${appResourceUrl}/' + resourcePath;
            const resourceKey = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.uuidv1)();
            const resourceInfoInBuilder = {
                id: resourceKey,
                appId: appId,
                fileName: fileName,
                originalName: originalName,
                resourcesPrefix: resourcesPrefix,
                url: resourceItemInfo.url,
                blobUrl: resourceItemInfo.blobUrl,
                resourceUrl: resourceUrl,
                type: resourceItemInfo.type,
                status: jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Fetching,
                widgetId: resourceItemInfo.widgetId,
                owner: resourceItemInfo.owner
            };
            const tempResourceInfoForUpload = Object.assign({}, resourceInfoInBuilder);
            tempResourceInfoForUpload.file = resourceItemInfo.file;
            const resourcePromise = this.fetchAppResourceInfoList(appId)
                .then(({ resources }) => __awaiter(this, void 0, void 0, function* () {
                if ((resources === null || resources === void 0 ? void 0 : resources.length) === 0) {
                    return yield this.addAppResource(tempResourceInfoForUpload);
                }
                else if ((resources === null || resources === void 0 ? void 0 : resources.length) > 0) {
                    return resources.some(({ resource }) => resource === resourcePath)
                        ? yield this.updateAppResource(tempResourceInfoForUpload)
                        : yield this.addAppResource(tempResourceInfoForUpload);
                }
                else {
                    throw new Error('return value from fetchAppResourceInfoList is not right');
                }
            }))
                .catch((error) => __awaiter(this, void 0, void 0, function* () {
                console.error(error);
                this.setResourceItemInfoStatus(tempResourceInfoForUpload, jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Error);
                return yield Promise.reject(error);
            }));
            tempResourceInfoForUpload.promise = resourcePromise;
            this.setResourceMap(resourceKey, resourceInfoInBuilder);
            return yield resourcePromise;
        });
        /**
         * Upload the local blob resources. It will replaces the blobUrl with resource url '${appResource}/...' in the config.
         * This helps persist local draft resources to the server.
         */
        this.upLoadLocalResource = (config) => __awaiter(this, void 0, void 0, function* () {
            const blobToResourceMap = this.blobToResourceMap;
            // eslint-disable-next-line
            const isBlobCacheResourceExp = new RegExp('^blob:\http(s?)://(.)');
            // the localResourcesInConfig variable is used for check resource status in config
            const localResourcesInConfig = [];
            function isNeedUpdateResource(value) {
                return isBlobCacheResourceExp.test(value);
            }
            function updateResourceUrl(value) {
                let newValue = value;
                newValue = blobToResourceMap[value];
                !localResourcesInConfig.includes(newValue.id) && localResourcesInConfig.push(newValue.id);
                return newValue.resourceUrl;
            }
            const replaceOperator = {
                matcher: isNeedUpdateResource,
                handler: updateResourceUrl
            };
            const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceStringInObject(config, replaceOperator);
            return yield this.checkResourcesUploadStatus(localResourcesInConfig).then((resourceUploadStatus) => __awaiter(this, void 0, void 0, function* () {
                if (resourceUploadStatus === jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Success) {
                    return yield Promise.resolve(appConfig);
                }
                else {
                    return yield Promise.reject();
                }
            }));
        });
        /**
         * Fetch app resource list data from arcgis rest api.
         * The list includes the files of config.json, image-resources-list.json, icon-resources-list.json, and image items including the images that just uploaded without saved.
         */
        this.fetchAppResourceInfoList = (appId, option) => __awaiter(this, void 0, void 0, function* () {
            const session = this.getSession();
            return yield (0,_service_rest_service__WEBPACK_IMPORTED_MODULE_3__.getItemResources)({ id: appId, isLocalApp: window.jimuConfig.isDevEdition }, Object.assign({ authentication: session }, option))
                .catch((err) => __awaiter(this, void 0, void 0, function* () {
                console.log(err);
                return yield Promise.reject(err);
            }));
        });
        /**
         * Fetch app resource item data from arcgis rest api. Like image-resources-list.json.
         *
         * Note: image-resources-list.json only includes the images that have been saved. Because only call appResourceManagerInstance.upLoadImageResourceList(cloneObj(imageResources)) after upLoadAppConfig Promise in saveApp() function in jimu-for-builder\lib\service\app-service\index.ts.
         */
        this.fetchAppResource = (appId, option) => __awaiter(this, void 0, void 0, function* () {
            const session = this.getSession();
            return yield (0,_service_rest_service__WEBPACK_IMPORTED_MODULE_3__.getItemResource)({ id: appId, isLocalApp: window.jimuConfig.isDevEdition }, Object.assign({ authentication: session }, option))
                .catch((err) => __awaiter(this, void 0, void 0, function* () {
                console.log(err);
                return yield Promise.reject(null);
            }));
        });
        /**
         * Clear out unused resources from the app.
         * It will clean resourceMap and blobToResourceMap and release the blob url cached in memory.
         * It will also remove the unsaved resources.
         * @param appId
         */
        this.clearResources = (appId) => {
            // Clear resourceMap and blobToResourceMap.
            this.clearResourceMap();
            // Clear resources without saved.
            this.clearResourcesWithoutSaved(appId);
            // Dispatch clearResources action.
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_resource_extension__WEBPACK_IMPORTED_MODULE_1__.builderStateResourceActions.ClearResources());
        };
        /**
         * Update the image resource item info.
         * This function will be called when the image resource item is updated, like after cropping image.
         */
        this.updateImageResourceItemInfo = (imageResourceItemInfo) => {
            const appId = this.getAppId();
            this.getImageResourceListFromDraft(appId).then((imageResourceList) => {
                const tempImageResourceItemInfo = Object.assign({}, imageResourceItemInfo);
                delete tempImageResourceItemInfo.blobUrl;
                delete tempImageResourceItemInfo.type;
                imageResourceList[tempImageResourceItemInfo.fileName.split('.')[0]] = tempImageResourceItemInfo;
                this.setResourcesInDraft({ imageResources: imageResourceList });
            });
        };
    }
    static getInstance() {
        if (!AppResourceManager._instance) {
            AppResourceManager._instance = new AppResourceManager();
            window._appResourceManager = AppResourceManager._instance;
        }
        return window._appResourceManager;
    }
    // Change the file to blobUrl. Calculate width and height from blobUrl. Finally assign these variables to resourceItemInfo.
    static assignBlobUrlToResourceItem(resourceItemInfo) {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const blobUrl = window.URL.createObjectURL(resourceItemInfo.file);
                const { width, height } = yield jimu_ui__WEBPACK_IMPORTED_MODULE_5__.imageUtils.getImageOriginalSizeByUrl(blobUrl).catch(() => ({ width: 0, height: 0 }));
                resourceItemInfo.url = blobUrl;
                resourceItemInfo.blobUrl = blobUrl;
                resourceItemInfo.originalWidth = width;
                resourceItemInfo.originalHeight = height;
                return yield Promise.resolve(resourceItemInfo);
            }
            catch (error) {
                return yield Promise.reject(error);
            }
        });
    }
    static getBlobByBlobUrl(blobUrl) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield new Promise((resolve, reject) => {
                const xhr = new XMLHttpRequest();
                xhr.responseType = 'blob';
                xhr.open('GET', blobUrl, true);
                xhr.onerror = reject;
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        resolve(xhr.response);
                    }
                    else {
                        reject();
                    }
                };
                xhr.send();
            });
        });
    }
    static getResourcePrefix({ resourcesPrefix, widgetId, type }) {
        if (resourcesPrefix)
            return resourcesPrefix;
        const resourcesPrefixMap = new Map([
            [jimu_core__WEBPACK_IMPORTED_MODULE_0__.ResourceType.Config, 'config'],
            [jimu_core__WEBPACK_IMPORTED_MODULE_0__.ResourceType.Image, widgetId ? `images/${widgetId}` : 'images/templates']
        ]);
        return resourcesPrefixMap.get(type) || 'templates';
    }
    // Add resource item data by arcgis rest api.
    addAppResource(resourceItemInfo) {
        return __awaiter(this, void 0, void 0, function* () {
            const session = this.getSession();
            return yield this.getAppInfo({ id: resourceItemInfo.appId, isLocalApp: window.jimuConfig.isDevEdition }).then((res) => __awaiter(this, void 0, void 0, function* () {
                return yield (0,_service_rest_service__WEBPACK_IMPORTED_MODULE_3__.addItemResource)({
                    id: resourceItemInfo.appId,
                    resource: resourceItemInfo.file,
                    name: resourceItemInfo.fileName,
                    owner: res.owner,
                    params: {
                        resourcesPrefix: resourceItemInfo.resourcesPrefix
                    },
                    authentication: session
                }).then((result) => __awaiter(this, void 0, void 0, function* () {
                    this.setResourceItemInfoStatus(resourceItemInfo, jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Success);
                    return yield Promise.resolve(result);
                }), (error) => __awaiter(this, void 0, void 0, function* () {
                    this.setResourceItemInfoStatus(resourceItemInfo, jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Error);
                    return yield Promise.reject(error);
                }));
            }));
        });
    }
    // Update resource item data by arcgis rest api.
    updateAppResource(resourceItemInfo) {
        return __awaiter(this, void 0, void 0, function* () {
            const session = this.getSession();
            return yield this.getAppInfo({ id: resourceItemInfo.appId, isLocalApp: window.jimuConfig.isDevEdition }).then((res) => __awaiter(this, void 0, void 0, function* () {
                return yield (0,_service_rest_service__WEBPACK_IMPORTED_MODULE_3__.updateItemResource)({
                    id: resourceItemInfo.appId,
                    resource: resourceItemInfo.file,
                    name: resourceItemInfo.fileName,
                    owner: res.owner,
                    params: {
                        resourcesPrefix: resourceItemInfo.resourcesPrefix
                    },
                    authentication: session
                }).then((result) => __awaiter(this, void 0, void 0, function* () {
                    this.setResourceItemInfoStatus(resourceItemInfo, jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Success);
                    return yield Promise.resolve(result);
                }), (error) => __awaiter(this, void 0, void 0, function* () {
                    this.setResourceItemInfoStatus(resourceItemInfo, jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Error);
                    return yield Promise.reject(error);
                }));
            }));
        });
    }
    // Remove resource item data by arcgis rest api.
    removeAppResource(resourceItemInfo) {
        return __awaiter(this, void 0, void 0, function* () {
            const session = this.getSession();
            const appId = resourceItemInfo.appId ? resourceItemInfo.appId : this.getAppId();
            return yield this.getAppInfo({ id: appId, isLocalApp: window.jimuConfig.isDevEdition }).then((res) => __awaiter(this, void 0, void 0, function* () {
                return yield (0,_service_rest_service__WEBPACK_IMPORTED_MODULE_3__.removeItemResource)({
                    id: appId,
                    owner: res.owner,
                    resource: resourceItemInfo.fileName,
                    authentication: session
                }).then((result) => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.resolve(result);
                }), (error) => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.reject(error);
                }));
            }));
        });
    }
    getAppId() {
        var _a;
        return (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appId;
    }
    getSession() {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
    }
    getPortalUrlWithTemplate() {
        return '${appResourceUrl}/';
    }
    getPortalUrlWithFull(appId) {
        return (0,_service_rest_service__WEBPACK_IMPORTED_MODULE_3__.getResourceOrigin)({ isLocalApp: window.jimuConfig.isDevEdition }) + appId + '/resources';
    }
    setResourceMap(resourceKey, resourceItemInfo) {
        const { id, resourceUrl } = resourceItemInfo;
        this.resourceMap[resourceKey] = Object.assign(Object.assign({}, this.resourceMap[resourceKey]), resourceItemInfo);
        this.blobToResourceMap[resourceItemInfo.blobUrl] = { id, resourceUrl };
        // Dispatch addResource action.
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_resource_extension__WEBPACK_IMPORTED_MODULE_1__.builderStateResourceActions.AddResource(resourceKey, this.resourceMap[resourceKey]));
    }
    setResourceItemInfoStatus(resourceItemInfo, status) {
        if (this.resourceMap && this.resourceMap[resourceItemInfo.id]) {
            resourceItemInfo.status = status;
            delete resourceItemInfo.file;
            this.setResourceMap(resourceItemInfo.id, resourceItemInfo);
        }
    }
    clearResourceMap() {
        // Release the blobUrl which was previously created by window.URL.createObjectURL(), to let the browser know not to keep the reference to the file any longer.
        for (const resourceKey in this.resourceMap) {
            this.resourceMap[resourceKey] && window.URL.revokeObjectURL(this.resourceMap[resourceKey].blobUrl);
        }
        // Clean resourceMap and blobToResourceMap.
        this.resourceMap = {};
        this.blobToResourceMap = {};
    }
    /**
     * Filter out the resources that have been uploaded without saved from the 'resourceUrlList'. Return the remaining resource items.
     * The resourceUrlList is the 'shouldClearResources' list which contains all the resource list (upload + saved) and not in the config being used.
     * @param appId May be not equal with current app id.
     * @param resourceUrlList For example: [images/widget_1/123456.jpg, ...]. Include resource url such as images or icons.
     * @returns
     */
    clearValueWithoutInResourcesInDraft(appId, resourceUrlList) {
        return __awaiter(this, void 0, void 0, function* () {
            const currentAppId = this.getAppId();
            if (currentAppId !== appId) {
                Object.keys(this.resources).forEach(key => {
                    this.resources[key] = null;
                });
            }
            if (resourceUrlList.length > 0) {
                const imageResourceList = yield this.getImageResourceListFromDraft(appId);
                const iconResourceList = yield this.getIconResourceListFromDraft();
                const imageResourcesUrlList = Object.values(imageResourceList)
                    .map(({ resourcesPrefix, fileName }) => `${resourcesPrefix}/${fileName}`);
                const iconResourcesUrlList = Object.values(iconResourceList)
                    .map(({ properties: { filename } }) => `images/icon_picker_in_setting/${filename}`);
                const resourceUrlListInDraft = [...imageResourcesUrlList, ...iconResourcesUrlList];
                const shouldCleanResourceUrlList = resourceUrlList.filter(resource => {
                    return !resourceUrlListInDraft.includes(resource);
                });
                return yield Promise.resolve(shouldCleanResourceUrlList);
            }
            else {
                return yield Promise.resolve(resourceUrlList);
            }
        });
    }
    /**
     * Clear resources that have not been saved as well as not in the config.
     * Any resources on the draft not referenced on server resource list will be deleted.
     * @param appId
     */
    clearResourcesWithoutSaved(appId) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!appId) {
                return;
            }
            try {
                const portalUrlWithFull = this.getPortalUrlWithFull(appId);
                const portalUrlWithTemplate = this.getPortalUrlWithTemplate();
                const { resources: portalResources } = yield this.fetchAppResourceInfoList(appId, { httpMethod: 'GET' });
                const isExistConfig = (portalResources === null || portalResources === void 0 ? void 0 : portalResources.some(({ resource }) => resource === AppResourceFilePath.Config)) || false;
                const appConfig = isExistConfig
                    ? yield this.fetchAppResource(appId, { fileName: AppResourceFilePath.Config, readAs: 'json' })
                    : {};
                // eslint-disable-next-line
                const isPortalUrlWithTemplateExp = new RegExp('^\\$\\{appResourceUrl\\}+(.)');
                const isPortalUrlWithFullExp = new RegExp('^' + portalUrlWithFull);
                const resourcesMap = {};
                jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceStringInObject(appConfig, {
                    matcher: (value) => (isPortalUrlWithTemplateExp.test(value) || isPortalUrlWithFullExp.test(value)),
                    handler: (value) => (resourcesMap[value] = value)
                });
                const shouldClearResources = [];
                portalResources === null || portalResources === void 0 ? void 0 : portalResources.forEach(({ resource }) => {
                    //Not config.json, image-resources-list.json, icon-resources-list.json nor the resource item that is in app config.
                    if (!(resource === AppResourceFilePath.Config) &&
                        !(resource === AppResourceFilePath.Image) &&
                        !(resource === AppResourceFilePath.Icon) &&
                        !resourcesMap[portalUrlWithTemplate + resource.replace('_compress', '')] &&
                        !resourcesMap[portalUrlWithFull + resource.replace('_compress', '')]) {
                        shouldClearResources.push(resource);
                    }
                });
                const newShouldClearResources = yield this.clearValueWithoutInResourcesInDraft(appId, shouldClearResources);
                const promiseList = newShouldClearResources.map(fileName => this.removeAppResource({ appId, fileName }));
                Promise.all(promiseList);
            }
            catch (error) {
                console.error(error);
            }
        });
    }
    // Filter out the image Resources being used.
    formatRelatedImageResources(imageResourceList, relatedImageResourceList) {
        const tempMap = {};
        const relatedImageResourcesConfig = {};
        const resourceIdsInAppConfig = [];
        for (let i = 0; i < relatedImageResourceList.length; i++) {
            const resourceId = relatedImageResourceList[i].fileName.split('.')[0];
            resourceIdsInAppConfig.push(resourceId);
        }
        Object.keys(imageResourceList).forEach(id => {
            imageResourceList[id].referedIds = [];
            const originId = imageResourceList[id].originId;
            if (resourceIdsInAppConfig.includes(originId) || resourceIdsInAppConfig.includes(id)) {
                relatedImageResourcesConfig[id] = imageResourceList[id];
                relatedImageResourcesConfig[originId] = imageResourceList[originId];
            }
        });
        Object.keys(relatedImageResourcesConfig).forEach(id => {
            relatedImageResourcesConfig[id].referedIds = [];
            const originId = relatedImageResourcesConfig[id].originId;
            if (originId !== id) {
                if (!tempMap[originId]) {
                    tempMap[originId] = Object.assign({}, relatedImageResourcesConfig[originId]);
                    tempMap[originId].referedIds = [id];
                }
                else {
                    tempMap[originId].referedIds.push(id);
                }
            }
        });
        Object.keys(tempMap).forEach(id => {
            if (relatedImageResourcesConfig[id]) {
                relatedImageResourcesConfig[id].referedIds = tempMap[id].referedIds;
            }
        });
        return relatedImageResourcesConfig;
    }
    checkResourcesUploadStatus(checkResources) {
        return __awaiter(this, void 0, void 0, function* () {
            if (checkResources.length > 0) {
                const checkResourcesPromiseArr = checkResources.map(checkResource => {
                    return this.resourceMap[checkResource].promise;
                });
                return yield Promise.all(checkResourcesPromiseArr).then(() => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.resolve(jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Success);
                }), () => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.resolve(jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Error);
                })).catch((error) => __awaiter(this, void 0, void 0, function* () {
                    console.error(error);
                    return yield Promise.reject();
                }));
            }
            else {
                return yield Promise.resolve(jimu_core__WEBPACK_IMPORTED_MODULE_0__.AjaxState.Success);
            }
        });
    }
    /**
     * Upload image resources list (images/image-resources-list.json) or icon resources list (images/icon-resources-list.json).
     */
    upLoadResourceList(appResourceFilePath, resourceList = {}, newAppId) {
        return __awaiter(this, void 0, void 0, function* () {
            const appId = newAppId || this.getAppId();
            const noLocalFileIconResourceList = yield this.upLoadLocalResource(resourceList);
            const cleanedPortalResourceList = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.cleanPortalInfoFromResource(noLocalFileIconResourceList);
            const file = new Blob([JSON.stringify(cleanedPortalResourceList)], { type: 'application/json' });
            const [resourcesPrefix, fileName] = appResourceFilePath.split('/');
            const resourceItemInfo = {
                appId,
                file,
                resourcesPrefix,
                fileName,
                type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.ResourceType.Image
            };
            return yield this.upLoadAppResource(resourceItemInfo)
                .then(() => __awaiter(this, void 0, void 0, function* () { return yield Promise.resolve(cleanedPortalResourceList); }))
                .catch((err) => __awaiter(this, void 0, void 0, function* () { return yield Promise.reject(err); }));
        });
    }
    getAppInfo(appInfo) {
        return __awaiter(this, void 0, void 0, function* () {
            const session = (0,_service_app_service_util__WEBPACK_IMPORTED_MODULE_2__.getSession)(appInfo);
            return yield (0,_service_rest_service__WEBPACK_IMPORTED_MODULE_3__.getItem)(appInfo, {
                authentication: session
            }).then((result) => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.resolve(result);
            }));
        });
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-state-history-extension.ts":
/*!*************************************************************!*\
  !*** ./jimu-for-builder/lib/app-state-history-extension.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AppStateHistoryActionKeys: () => (/* binding */ ActionKeys),
/* harmony export */   appStateHistoryActions: () => (/* binding */ actions),
/* harmony export */   "default": () => (/* binding */ AppStateHistoryExtension)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _builder_app_sync__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./builder-app-sync */ "./jimu-for-builder/lib/builder-app-sync.ts");


var ActionKeys;
(function (ActionKeys) {
    ActionKeys["InBuilderPutAppConfigIntoHistory"] = "IN_BUILDER_PUT_APPCONFIG_INTO_HISTORY";
    ActionKeys["InBuilderRemoveLastAppConfigFromHistory"] = "IN_BUILDER_REMOVE_LAST_APPCONFIG_FROM_HISTORY";
    ActionKeys["InBuilderAppConfigUndo"] = "IN_BUILDER_APPCONFIG_UNDO";
    ActionKeys["InBuilderAppConfigRedo"] = "IN_BUILDER_APPCONFIG_REDO";
    ActionKeys["InBuilderAppConfigRedoClear"] = "IN_BUILDER_APPCONFIG_REDOCLEAR";
    ActionKeys["InBuilderAppConfigClear"] = "IN_BUILDER_APPCONFIG_CLEAR";
})(ActionKeys || (ActionKeys = {}));
const actions = {
    InBuilderAppConfigUndo: () => {
        return {
            type: ActionKeys.InBuilderAppConfigUndo
        };
    },
    InBuilderAppConfigRedo: () => {
        return {
            type: ActionKeys.InBuilderAppConfigRedo
        };
    },
    InBuilderPutAppConfigIntoHistory: (appState) => {
        return {
            type: ActionKeys.InBuilderPutAppConfigIntoHistory,
            appState: appState
        };
    },
    InBuilderRemoveLastAppConfigFromHistory: () => {
        return {
            type: ActionKeys.InBuilderRemoveLastAppConfigFromHistory
        };
    },
    InBuilderAppConfigRedoClear: () => {
        return {
            type: ActionKeys.InBuilderAppConfigRedoClear
        };
    },
    InBuilderAppConfigClear: () => {
        return {
            type: ActionKeys.InBuilderAppConfigClear
        };
    }
};

class AppStateHistoryExtension {
    constructor() {
        this.id = 'app-state-history-extension';
    }
    getActions() {
        return [
            ActionKeys.InBuilderPutAppConfigIntoHistory,
            ActionKeys.InBuilderRemoveLastAppConfigFromHistory,
            ActionKeys.InBuilderAppConfigUndo,
            ActionKeys.InBuilderAppConfigRedo,
            ActionKeys.InBuilderAppConfigRedoClear,
            ActionKeys.InBuilderAppConfigClear
        ];
    }
    getInitLocalState() {
        return {
            past: [],
            future: []
        };
    }
    getReducer() {
        return (historyState, action, builderState) => {
            switch (action.type) {
                case ActionKeys.InBuilderAppConfigUndo:
                    return this.handleAppStateUndo(historyState);
                case ActionKeys.InBuilderAppConfigRedo:
                    return this.handleAppStateRedo(historyState);
                case ActionKeys.InBuilderPutAppConfigIntoHistory:
                    return this.handleAppStateAdd(historyState, action.appState);
                case ActionKeys.InBuilderRemoveLastAppConfigFromHistory:
                    return this.handleAppStateRemoveLast(historyState);
                case ActionKeys.InBuilderAppConfigRedoClear:
                    return this.handleAppStateRedoClear(historyState);
                case ActionKeys.InBuilderAppConfigClear:
                    return this.handleAppStateClear(historyState);
                default:
                    return historyState;
            }
        };
    }
    handleAppStateUndo(state) {
        // last member in `past` array is the current appState
        if (state.past.length < 2) {
            console.warn('Can not undo since no history there');
            return state;
        }
        const previous = state.past[state.past.length - 2];
        const current = state.past[state.past.length - 1];
        const past = state.past.slice(0, state.past.length - 1);
        const future = [current].concat(state.future);
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
            (0,_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__.publishAppConfigChangeToApp)(previous.appConfig);
            (0,_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__.publishAppInfoChangeToApp)(previous.appInfo);
        });
        return state.merge({
            past: past,
            future: future
        });
    }
    handleAppStateRedo(state) {
        // last member in `past` array is the current appState
        if (state.future.length < 1) {
            console.warn('Can not redo since no history there');
            return state;
        }
        const next = state.future[0];
        const future = state.future.slice(1);
        const past = state.past.concat([next]);
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.lodash.defer(() => {
            (0,_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__.publishAppConfigChangeToApp)(next.appConfig);
            (0,_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__.publishAppInfoChangeToApp)(next.appInfo);
        });
        return state.merge({
            past: past,
            future: future
        });
    }
    handleAppStateAdd(state, appState) {
        // if appState is not generated by redo or undo or `past` is emperty
        const lastStateInPast = state.past[state.past.length - 1];
        if (appState !== null && ((state.past.length > 0 && (lastStateInPast.appConfig !== appState.appConfig || lastStateInPast.appInfo !== appState.appInfo)) || state.past.length === 0)) {
            const past = state.past.concat([appState]);
            return state.set('past', past).set('future', []);
        }
        return state;
    }
    handleAppStateRemoveLast(state) {
        // if appState is not generated by redo or undo or `past` is emperty
        if (state.past.length > 0) {
            const past = state.past.slice(0, state.past.length - 1);
            return state.set('past', past);
        }
        return state;
    }
    handleAppStateRedoClear(state) {
        return state.set('future', []);
    }
    handleAppStateClear(state) {
        return state.set('future', []).set('past', []);
    }
    getStoreKey() {
        return 'appStateHistory';
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-state-redux-store-extension.ts":
/*!*****************************************************************!*\
  !*** ./jimu-for-builder/lib/app-state-redux-store-extension.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ExtActionKeys: () => (/* binding */ ExtActionKeys),
/* harmony export */   appStateActions: () => (/* binding */ actions),
/* harmony export */   "default": () => (/* binding */ BuilderAppStateReduxStoreExtension)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

var ExtActionKeys;
(function (ExtActionKeys) {
    // actions from app
    ExtActionKeys["InAppAppStateChanged"] = "IN_APP_APP_STATE_CHANGED";
    ExtActionKeys["InBuilderAppConfigChanged"] = "IN_BUILDER_APP_CONFIG_CHANGED";
})(ExtActionKeys || (ExtActionKeys = {}));
const actions = {
    inAppAppStateChanged: (appState) => {
        return {
            type: ExtActionKeys.InAppAppStateChanged,
            appState: appState
        };
    },
    inBuilderAppConfigChanged: (appConfig) => {
        return {
            type: ExtActionKeys.InBuilderAppConfigChanged,
            appConfig
        };
    }
};

class BuilderAppStateReduxStoreExtension {
    constructor() {
        this.id = 'builder-app-state-redux-store-extension';
    }
    getActions() {
        return Object.keys(ExtActionKeys).map(k => ExtActionKeys[k]);
    }
    getInitLocalState() {
        return null;
    }
    getReducer() {
        return (appState, action, builderState) => {
            switch (action.type) {
                case ExtActionKeys.InAppAppStateChanged:
                    return action.appState;
                case ExtActionKeys.InBuilderAppConfigChanged:
                    return jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.updateStateWhenAppConfigChange(appState, action.appConfig);
                default:
                    return appState;
            }
        };
    }
    getStoreKey() {
        return 'appStateInBuilder';
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/app-widget-manager.tsx":
/*!*****************************************************!*\
  !*** ./jimu-for-builder/lib/app-widget-manager.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ AppWidgetManager)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

class AppWidgetManager extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.WidgetManager {
    static getInstance() {
        if (window.jimuConfig.isBuilder) {
            return window._appWindow && window._appWindow._widgetManager;
        }
        else {
            return jimu_core__WEBPACK_IMPORTED_MODULE_0__.WidgetManager.getInstance();
        }
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/base-widget-setting.tsx":
/*!******************************************************!*\
  !*** ./jimu-for-builder/lib/base-widget-setting.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

class BaseWidgetSetting extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.PureComponent {
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BaseWidgetSetting);


/***/ }),

/***/ "./jimu-for-builder/lib/builder-app-sync.ts":
/*!**************************************************!*\
  !*** ./jimu-for-builder/lib/builder-app-sync.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   listenAppEvents: () => (/* binding */ listenAppEvents),
/* harmony export */   publichActivePagePartChangeToApp: () => (/* binding */ publichActivePagePartChangeToApp),
/* harmony export */   publichChangeZoomScaleToApp: () => (/* binding */ publichChangeZoomScaleToApp),
/* harmony export */   publichUtilityStateChangeToApp: () => (/* binding */ publichUtilityStateChangeToApp),
/* harmony export */   publishAnimationPreviewToApp: () => (/* binding */ publishAnimationPreviewToApp),
/* harmony export */   publishAppConfigChangeToApp: () => (/* binding */ publishAppConfigChangeToApp),
/* harmony export */   publishAppInfoChangeToApp: () => (/* binding */ publishAppInfoChangeToApp),
/* harmony export */   publishAppModeChangeToApp: () => (/* binding */ publishAppModeChangeToApp),
/* harmony export */   publishChangeBrowserSizeModeToApp: () => (/* binding */ publishChangeBrowserSizeModeToApp),
/* harmony export */   publishChangeSelectionToApp: () => (/* binding */ publishChangeSelectionToApp),
/* harmony export */   publishChangeSessionToApp: () => (/* binding */ publishChangeSessionToApp),
/* harmony export */   publishChangeWidgetMutableStatePropToApp: () => (/* binding */ publishChangeWidgetMutableStatePropToApp),
/* harmony export */   publishChangeWidgetStatePropToApp: () => (/* binding */ publishChangeWidgetStatePropToApp),
/* harmony export */   publishDialogChangeToApp: () => (/* binding */ publishDialogChangeToApp),
/* harmony export */   publishDialogInfosChangeToApp: () => (/* binding */ publishDialogInfosChangeToApp),
/* harmony export */   publishHoverPreviewToApp: () => (/* binding */ publishHoverPreviewToApp),
/* harmony export */   publishKeyboardToApp: () => (/* binding */ publishKeyboardToApp),
/* harmony export */   publishNoPermissionResourceInfoListChangeToApp: () => (/* binding */ publishNoPermissionResourceInfoListChangeToApp),
/* harmony export */   publishPageChangeToApp: () => (/* binding */ publishPageChangeToApp),
/* harmony export */   publishScreenGroupNavInfoToApp: () => (/* binding */ publishScreenGroupNavInfoToApp),
/* harmony export */   publishSectionNavInfoToApp: () => (/* binding */ publishSectionNavInfoToApp),
/* harmony export */   publishSetClientIdAlertIsCancelled: () => (/* binding */ publishSetClientIdAlertIsCancelled),
/* harmony export */   publishTocHoverInfoToApp: () => (/* binding */ publishTocHoverInfoToApp)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./app-state-redux-store-extension */ "./jimu-for-builder/lib/app-state-redux-store-extension.ts");
/* harmony import */ var _app_state_history_extension__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app-state-history-extension */ "./jimu-for-builder/lib/app-state-history-extension.ts");
/* harmony import */ var _builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./builder-state-store-extension */ "./jimu-for-builder/lib/builder-state-store-extension.ts");
/* harmony import */ var _sync_type__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./sync-type */ "./jimu-for-builder/lib/sync-type.ts");
/* harmony import */ var _app_resource_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./app-resource-manager */ "./jimu-for-builder/lib/app-resource-manager.tsx");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






function publishAppConfigChangeToApp(appConfig) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.AppConfigChanged}`, appConfig);
}
function publishAppInfoChangeToApp(appInfo) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.AppInfoChanged}`, appInfo);
}
function publishDialogInfosChangeToApp(dialogInfos) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.DialogInfosChanged}`, dialogInfos);
}
function publishAppModeChangeToApp(appMode) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangeAppMode}`, appMode);
}
function publishPageChangeToApp(pageId) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangePage}`, pageId);
}
function publishDialogChangeToApp(dialogId) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangeDialog}`, dialogId);
}
function publishChangeSelectionToApp(selection) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangeSelection}`, selection);
}
function publishChangeWidgetStatePropToApp(alterState) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangeWidgetStateProp}`, alterState);
}
function publichUtilityStateChangeToApp(utilityId, state) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.UtilityStateChanged}`, { utilityId, state });
}
function publishChangeWidgetMutableStatePropToApp(alterState) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangeWidgetMutableStateProp}`, alterState);
}
function publishKeyboardToApp(event) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.BuilderTriggerKeyboard}`, event);
}
function publishChangeBrowserSizeModeToApp(mode) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangeBrowserSizeMode}`, mode);
}
function publishChangeSessionToApp() {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.BuilderSessionChanged}`, jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getSessions());
}
function publishNoPermissionResourceInfoListChangeToApp() {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.BuilderNoPermissionResourceInfoListChanged}`, jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getNoPermissionResourceInfoList());
}
function publichChangeZoomScaleToApp(zoomScale) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ChangeZoomScale}`, zoomScale);
}
function publichActivePagePartChangeToApp(pagePart) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ActivePagePartChanged}`, pagePart);
}
function publishAnimationPreviewToApp(data) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.AnimationPreview}`, data);
}
function publishHoverPreviewToApp(data) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.HoverPreview}`, data);
}
function publishSectionNavInfoToApp(sectionId, navInfo) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.SectionNavInfoChanged}`, { sectionId, navInfo });
}
function publishScreenGroupNavInfoToApp(screenGroupId, activeIndex) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.ScreenGroupNavInfoChanged}`, { screenGroupId, activeIndex });
}
function publishTocHoverInfoToApp(layoutInfo, hovered) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.TocHoverInfoChanged}`, { layoutInfo, hovered });
}
function publishSetClientIdAlertIsCancelled(portalUrl) {
    publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.SetClientIdAlertIsCancelled}`, { portalUrl });
}
function publishEventToApp(action, data) {
    window._builderPubsub.publishSync(action, data);
}
function listenAppEvents() {
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.AppSessionChanged}`, (evt, sessions) => {
        // console.log('to_builder' + JSON.stringify(sessions));
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().syncSessionsFromOtherWindow(sessions);
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.AppNoPermissionResourceInfoListChanged}`, (evt, noPermissionResourceInfoList) => {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().syncNoPermissionResourceInfoListFromOtherWindow(noPermissionResourceInfoList);
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.NeedToCheck498Error}`, (evt, url) => {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().handleInvalidToken(url);
    });
    window._builderPubsub.subscribe('to_builder', function (evt, data) {
        console.debug(evt, data);
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.AppStateChanged}`, (evt, appState) => {
        var _a;
        if ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().builder.currentAppId !== appState.appId) {
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.changeCurrentApp(appState.appId));
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_history_extension__WEBPACK_IMPORTED_MODULE_2__.appStateHistoryActions.InBuilderAppConfigClear());
            /**
             * Because of the history API, when user click the browser back button, the appId in URL may is not the same as the internal appId, we need to sync them here.
             *
             * Note: Changing the iframe.src will update the host parent window's history (tested in chrome.)
             */
            if ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().queryObject.id !== appState.appId) {
                jimu_core__WEBPACK_IMPORTED_MODULE_0__.jimuHistory.changeQueryObject({ id: appState.appId });
            }
        }
        if (!(0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder ||
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig !== appState.appConfig) {
            const newAppConfig = appState.appConfig;
            const oldAppConfig = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig;
            if (newAppConfig && oldAppConfig) {
                const isWidgetVersionChange = Object.keys(newAppConfig.widgets || {})
                    .find(wId => newAppConfig.widgets[wId] && oldAppConfig.widgets[wId] && newAppConfig.widgets[wId].version !== oldAppConfig.widgets[wId].version);
                // the appConfig change is caused by widget version change, which means load an old app and do upgrade
                // for this case, we don't trigger save button.
                if (isWidgetVersionChange) {
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_1__.appStateActions.inAppAppStateChanged(appState));
                    return;
                }
                const removedWidgets = Object.keys(oldAppConfig.widgets).filter(wId => !newAppConfig.widgets[wId]);
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.widgetsRemoved(removedWidgets));
                const newWidgets = Object.keys(newAppConfig.widgets).filter(wId => !oldAppConfig.widgets[wId]).map(wId => ({
                    widgetId: wId,
                    widgetUri: newAppConfig.widgets[wId].uri
                }));
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.widgetsAdded(newWidgets));
            }
            appState.appConfig && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_history_extension__WEBPACK_IMPORTED_MODULE_2__.appStateHistoryActions.InBuilderPutAppConfigIntoHistory({ appConfig: appState.appConfig, appInfo: appState.appInfo }));
        }
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_redux_store_extension__WEBPACK_IMPORTED_MODULE_1__.appStateActions.inAppAppStateChanged(appState));
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.PopupChooseWidget}`, (evt, layout) => {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.openChooseWidgetPopup(layout.layoutId, layout.layoutItemId));
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.AppAddResource}`, (evt, resource) => {
        const appResourceManager = _app_resource_manager__WEBPACK_IMPORTED_MODULE_5__.AppResourceManager.getInstance();
        _app_resource_manager__WEBPACK_IMPORTED_MODULE_5__.AppResourceManager.getBlobByBlobUrl(resource.file).then((blob) => __awaiter(this, void 0, void 0, function* () {
            resource.file = blob;
            appResourceManager.upLoadAppResource(resource);
            if (resource.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.ResourceType.Image && resource.originId) {
                _app_resource_manager__WEBPACK_IMPORTED_MODULE_5__.AppResourceManager.getInstance().updateImageResourceItemInfo(resource);
            }
        }));
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.AppClearResources}`, (evt, appId) => {
        const appResourceManager = _app_resource_manager__WEBPACK_IMPORTED_MODULE_5__.AppResourceManager.getInstance();
        appResourceManager.clearResources(appId);
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.AppTriggerKeyboard}`, (evt, event) => {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.keyboardUtils.triggerEvent(event);
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.SetLayoutTools}`, (evt, tools) => {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.setLayoutTools(tools));
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.ClearLastAppConfigFromHistory}`, evt => {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_app_state_history_extension__WEBPACK_IMPORTED_MODULE_2__.appStateHistoryActions.InBuilderRemoveLastAppConfigFromHistory());
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.SetIsBusy}`, (evt, isBusy) => {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.setIsBusy(isBusy));
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.ConfirmDelete}`, (evt, itemToDelete) => {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.confirmDeleteContentChanged(itemToDelete));
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.NeedToRegisterClinetId}`, (evt, portalInfo) => {
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.addToRegisterClientIdList(portalInfo.portalUrl, portalInfo.needToSignIn, portalInfo.serviceUrl));
    });
    window._builderPubsub.subscribe(`to_builder.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToBuilderMessage.AppIsLoaded}`, (evt, isBusy) => {
        var _a;
        // sync mainPortalInfo
        const state = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState();
        const mainPortalInfo = {
            portalUrl: state.portalUrl,
            clientId: state.clientId,
            isWebTier: state.isWebTier
        };
        publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.SetMainPortal}`, mainPortalInfo);
        /*
        * After app loaded, the portalUrl and portalSelf may still change, because if we use platform url in builder,
        * the url will be changed to org url later if app loads fast. So, listen to change here.
        */
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.observeStore)((prePortalUrl, portalUrl) => {
            publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.SetMainPortal}`, { portalUrl });
        }, ['portalUrl']);
        if ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalSelf) {
            publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.PortalSelfChanged}`, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalSelf);
        }
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.observeStore)((prePortalSelf, portalSelf) => {
            publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.PortalSelfChanged}`, portalSelf);
        }, ['portalSelf']);
        // sync appInfo.
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUtils.getAppInfo((_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().queryObject) === null || _a === void 0 ? void 0 : _a.id).then(appInfo => {
            publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.AppInfoChanged}`, appInfo);
        });
        // sync user info
        if ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().user) {
            publishEventToApp(`to_app.${_sync_type__WEBPACK_IMPORTED_MODULE_4__.ToAppMessage.UserSignIn}`, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().user);
        }
        // sync sessions
        publishChangeSessionToApp();
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/builder-keyboard-component.tsx":
/*!*************************************************************!*\
  !*** ./jimu-for-builder/lib/builder-keyboard-component.tsx ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _lib_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/builder-app-sync */ "./jimu-for-builder/lib/builder-app-sync.ts");
/* harmony import */ var _lib_app_state_history_extension__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/app-state-history-extension */ "./jimu-for-builder/lib/app-state-history-extension.ts");



class BuilderKeyboardComponentInner extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.PureComponent {
    constructor() {
        super(...arguments);
        this.isSupportKeyboard = () => {
            let isSupportKeyboard = false;
            // for builder except home, template page
            if (window.jimuConfig.isBuilder && this.props.currentPageId !== 'home' && this.props.currentPageId !== 'template') {
                isSupportKeyboard = true;
                return isSupportKeyboard;
            }
            return isSupportKeyboard;
        };
        this.switchAppMode = () => {
            var _a, _b;
            // when event is triggered in builder
            const appMode = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appRuntimeInfo) === null || _b === void 0 ? void 0 : _b.appMode;
            if (appMode === jimu_core__WEBPACK_IMPORTED_MODULE_0__.AppMode.Run) {
                _lib_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__.publishAppModeChangeToApp(jimu_core__WEBPACK_IMPORTED_MODULE_0__.AppMode.Design);
            }
            else {
                _lib_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__.publishAppModeChangeToApp(jimu_core__WEBPACK_IMPORTED_MODULE_0__.AppMode.Run);
            }
        };
        this.undo = () => {
            if (this.props.stateHistory.past.length <= 1) {
                return;
            }
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_lib_app_state_history_extension__WEBPACK_IMPORTED_MODULE_2__.appStateHistoryActions.InBuilderAppConfigUndo());
        };
        this.redo = () => {
            if (this.props.stateHistory.future.length <= 0) {
                return;
            }
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(_lib_app_state_history_extension__WEBPACK_IMPORTED_MODULE_2__.appStateHistoryActions.InBuilderAppConfigRedo());
        };
        this.onKeyboardTrigger = (event) => {
            if (!event.key.includes('-manual')) {
                _lib_builder_app_sync__WEBPACK_IMPORTED_MODULE_1__.publishKeyboardToApp(event);
            }
        };
        this.isMac = () => {
            var _a, _b;
            return ((_b = (_a = window.jimuUA) === null || _a === void 0 ? void 0 : _a.os) === null || _b === void 0 ? void 0 : _b.name) === 'macOS';
        };
    }
    render() {
        if (this.isMac()) {
            return this.isSupportKeyboard()
                ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement(jimu_core__WEBPACK_IMPORTED_MODULE_0__.Keyboard, { onKeyboardTrigger: this.onKeyboardTrigger, bindings: {
                        'shift+alt+keyx': () => { this.switchAppMode(); },
                        'command+keyz': () => { this.undo(); },
                        'command+shift+keyz': () => { this.redo(); }
                    } })
                : null;
        }
        else {
            return this.isSupportKeyboard()
                ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement(jimu_core__WEBPACK_IMPORTED_MODULE_0__.Keyboard, { onKeyboardTrigger: this.onKeyboardTrigger, bindings: {
                        'shift+alt+keyx': () => { this.switchAppMode(); },
                        'ctrl+keyz': () => { this.undo(); },
                        'ctrl+shift+keyz': () => { this.redo(); }
                    } })
                : null;
        }
    }
}
const mapStateToProps = (state) => {
    return {
        currentPageId: state.appRuntimeInfo.currentPageId,
        stateHistory: state.appStateHistory
    };
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (jimu_core__WEBPACK_IMPORTED_MODULE_0__.ReactRedux.connect(mapStateToProps)(BuilderKeyboardComponentInner));


/***/ }),

/***/ "./jimu-for-builder/lib/builder-locale.ts":
/*!************************************************!*\
  !*** ./jimu-for-builder/lib/builder-locale.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   loadI18nMessage: () => (/* binding */ loadI18nMessage)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _translations_default__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./translations/default */ "./jimu-for-builder/lib/translations/default.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function loadLocaleMessagesForJimuBuilder(locale, supportedLocales) {
    return __awaiter(this, void 0, void 0, function* () {
        locale = jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getLocaleToLoad(locale, supportedLocales);
        if (locale) {
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.loadLocaleMessages('jimu-for-builder/lib/translations', locale).then(messages => {
                return messages;
            });
        }
        else {
            return Promise.resolve(_translations_default__WEBPACK_IMPORTED_MODULE_1__["default"]);
        }
    });
}
function loadI18nMessage() {
    return __awaiter(this, void 0, void 0, function* () {
        const locale = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale;
        return yield loadLocaleMessagesForJimuBuilder(locale, jimu_core__WEBPACK_IMPORTED_MODULE_0__.translatedLocales).then((messages) => {
            messages && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.i18nMessagesLoaded('jimu-for-builder', messages));
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.resetIntls();
            return messages;
        });
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/builder-state-resource-extension.ts":
/*!******************************************************************!*\
  !*** ./jimu-for-builder/lib/builder-state-resource-extension.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BuilderStateResourceActionKeys: () => (/* binding */ ActionKeys),
/* harmony export */   builderStateResourceActions: () => (/* binding */ actions),
/* harmony export */   "default": () => (/* binding */ BuilderStateResourceExtension)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

var ActionKeys;
(function (ActionKeys) {
    ActionKeys["AddResource"] = "ADD_RESOURCE";
    ActionKeys["UpdateResource"] = "UPDATE_RESOURCE";
    ActionKeys["ClearResources"] = "CLEAR_RESOURCES";
})(ActionKeys || (ActionKeys = {}));
const actions = {
    AddResource: (resourceKey, resourceItemInfo) => {
        return {
            type: ActionKeys.AddResource,
            resourceKey: resourceKey,
            resourceItemInfo: resourceItemInfo
        };
    },
    UpdateResource: (resourceKey, resourceItemInfo) => {
        return {
            type: ActionKeys.UpdateResource,
            resourceKey: resourceKey,
            resourceItemInfo: resourceItemInfo
        };
    },
    ClearResources: () => {
        return {
            type: ActionKeys.ClearResources
        };
    }
};

class BuilderStateResourceExtension {
    constructor() {
        this.id = 'builder-state-resource-extension';
    }
    getActions() {
        return Object.keys(ActionKeys).map(k => ActionKeys[k]);
    }
    getInitLocalState() {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
    }
    getReducer() {
        return (resourcesInfo, action, builderFullState) => {
            switch (action.type) {
                case ActionKeys.AddResource:
                    return resourcesInfo.set(action.resourceKey, action.resourceItemInfo);
                case ActionKeys.UpdateResource:
                    return resourcesInfo.set(action.resourceKey, action.resourceItemInfo);
                case ActionKeys.ClearResources:
                    const tempResourceInfo = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({});
                    return tempResourceInfo;
                default:
                    return resourcesInfo;
            }
        };
    }
    getStoreKey() {
        return 'resourcesInfo';
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/builder-state-store-extension.ts":
/*!***************************************************************!*\
  !*** ./jimu-for-builder/lib/builder-state-store-extension.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BuilderStateActionTypes: () => (/* binding */ ActionKeys),
/* harmony export */   builderActionKeys: () => (/* binding */ ActionKeys),
/* harmony export */   builderActions: () => (/* binding */ actions),
/* harmony export */   "default": () => (/* binding */ BuilderStateReduxStoreExtension)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

var ActionKeys;
(function (ActionKeys) {
    ActionKeys["SelectTemplate"] = "SELECT_TEMPLATE";
    ActionKeys["OpenChooseWidgetPopup"] = "OPEN_CHOOSE_WIDGET_POPUP";
    ActionKeys["CloseChooseWidgetPopup"] = "CLOSE_CHOOSE_WIDGET_POPUP";
    ActionKeys["WidgetSettingClassLoaded"] = "WIDGET_SETTING_CLASS_LOADED";
    ActionKeys["WidgetsRemoved"] = "WIDGETS_REMOVED";
    ActionKeys["WidgetsAdded"] = "WIDGETS_ADDED";
    ActionKeys["ChangeCurrentApp"] = "CHANGE_CURRENT_APP";
    ActionKeys["RefreshAppList"] = "REFRSH_APPLIST";
    ActionKeys["SetLayoutTools"] = "SET_LAYOUT_TOOLS";
    ActionKeys["StartGuide"] = "START_GUIDE";
    ActionKeys["StopGuide"] = "STOP_GUIDE";
    ActionKeys["WidgetSettingI18nMessageLoaded"] = "WIDGET_SETTING_I18N_MESSAGE_LOADED";
    ActionKeys["ConfirmDeleteContentChanged"] = "CONFIRM_DELETE_CONTENT_CHANGED";
})(ActionKeys || (ActionKeys = {}));

const actions = {
    selectTemplate: (templateName) => {
        return {
            type: ActionKeys.SelectTemplate,
            templateName: templateName
        };
    },
    refreshAppListAction: (isRefresh) => {
        return {
            type: ActionKeys.RefreshAppList,
            isRefresh: isRefresh
        };
    },
    openChooseWidgetPopup: (layoutId, layoutItemId) => {
        return {
            type: ActionKeys.OpenChooseWidgetPopup,
            layoutId: layoutId,
            layoutItemId: layoutItemId
        };
    },
    closeChooseWidgetPopup: () => {
        return {
            type: ActionKeys.CloseChooseWidgetPopup
        };
    },
    widgetSettingClassLoaded: (wigetUri) => {
        return {
            type: ActionKeys.WidgetSettingClassLoaded,
            wigetUri
        };
    },
    widgetsAdded: (widgets) => {
        return {
            type: ActionKeys.WidgetsAdded,
            widgets
        };
    },
    widgetsRemoved: (widgetIds) => {
        return {
            type: ActionKeys.WidgetsRemoved,
            widgetIds
        };
    },
    changeCurrentApp: (appId) => {
        return {
            type: ActionKeys.ChangeCurrentApp,
            appId: appId
        };
    },
    setLayoutTools: (tools) => {
        return {
            type: ActionKeys.SetLayoutTools,
            tools: tools
        };
    },
    startGuide: (guideId) => {
        return {
            type: ActionKeys.StartGuide,
            guideId: guideId
        };
    },
    stopGuide: () => {
        return {
            type: ActionKeys.StopGuide
        };
    },
    widgetSettingI18nMessageLoaded: (widgetName, i18nMessages) => {
        return {
            type: ActionKeys.WidgetSettingI18nMessageLoaded,
            widgetName,
            i18nMessages
        };
    },
    confirmDeleteContentChanged: (itemToDelete) => {
        return {
            type: ActionKeys.ConfirmDeleteContentChanged,
            itemToDelete
        };
    }
};

class BuilderStateReduxStoreExtension {
    constructor() {
        this.id = 'builder-state-redux-store-extension';
    }
    getActions() {
        return Object.keys(ActionKeys).map(k => ActionKeys[k]);
    }
    getInitLocalState() {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
            templateName: null,
            showChooseWidgetPopup: false,
            currentAppId: null,
            refreshAppList: false,
            isMobile: false,
            currentGuideId: null,
            widgetSettingI18nMessages: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({}),
            widgetsSettingClassStatus: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({})
        });
    }
    getReducer() {
        return (builderState, action, builderFullState) => {
            // let s;
            switch (action.type) {
                case ActionKeys.SelectTemplate:
                    return builderState.set('templateName', action.templateName);
                case ActionKeys.OpenChooseWidgetPopup:
                    return builderState.set('showChooseWidgetPopup', true)
                        .set('currentLayout', (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
                        layoutId: action.layoutId,
                        layoutItemId: action.layoutItemId
                    }));
                case ActionKeys.CloseChooseWidgetPopup:
                    return builderState.set('showChooseWidgetPopup', false);
                case ActionKeys.WidgetSettingClassLoaded:
                    builderState = builderState.setIn(['widgetsSettingClassStatus', action.wigetUri], true);
                    getWidgetIdsByUri(builderFullState, action.wigetUri).forEach(wId => {
                        builderState = builderState.setIn(['widgetsSettingRuntimeInfo', wId, 'isClassLoaded'], true);
                    });
                    return builderState;
                case ActionKeys.WidgetsAdded:
                    action.widgets.forEach(w => {
                        if (builderState.widgetsSettingClassStatus[w.widgetUri]) {
                            builderState = builderState.setIn(['widgetsSettingRuntimeInfo', w.widgetId, 'isClassLoaded'], true);
                        }
                    });
                    return builderState;
                case ActionKeys.WidgetsRemoved:
                    return builderState.set('widgetsSettingRuntimeInfo', builderState.widgetsSettingRuntimeInfo.without(...action.widgetIds));
                case ActionKeys.ChangeCurrentApp:
                    builderState = this.getInitLocalState();
                    return builderState.set('currentAppId', action.appId).set('widgetsSettingRuntimeInfo', {});
                case ActionKeys.RefreshAppList:
                    return builderState.set('refreshAppList', action.isRefresh);
                case ActionKeys.SetLayoutTools:
                    return builderState.set('toolbarConfig', action.tools);
                case ActionKeys.StartGuide:
                    return builderState.set('currentGuideId', action.guideId);
                case ActionKeys.StopGuide:
                    return builderState.set('currentGuideId', null);
                case ActionKeys.WidgetSettingI18nMessageLoaded:
                    return builderState.setIn(['widgetSettingI18nMessages', action.widgetName], action.i18nMessages);
                case ActionKeys.ConfirmDeleteContentChanged: {
                    const { itemToDelete } = action;
                    return builderState.set('contentToDelete', itemToDelete);
                }
                default:
                    return builderState;
            }
        };
    }
    getStoreKey() {
        return 'builder';
    }
}
function getWidgetIdsByUri(builderFullState, wigetUri) {
    var _a, _b;
    const widgets = ((_b = (_a = builderFullState.appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig) === null || _b === void 0 ? void 0 : _b.widgets) || {};
    const widgetIds = Object.keys(widgets).filter(wId => widgets[wId].uri === wigetUri);
    return widgetIds;
}


/***/ }),

/***/ "./jimu-for-builder/lib/init.ts":
/*!**************************************!*\
  !*** ./jimu-for-builder/lib/init.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   init: () => (/* binding */ init)
/* harmony export */ });
/* harmony import */ var _lib_app_message_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/app-message-manager */ "./jimu-for-builder/lib/app-message-manager.tsx");
/* harmony import */ var _lib_message_actions_filter_data_record_action_setting__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/message-actions/filter-data-record-action-setting */ "./jimu-for-builder/lib/message-actions/filter-data-record-action-setting.tsx");
/* harmony import */ var _lib_message_actions_select_data_record_action_setting__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/message-actions/select-data-record-action-setting */ "./jimu-for-builder/lib/message-actions/select-data-record-action-setting.tsx");
/* harmony import */ var _builder_locale__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./builder-locale */ "./jimu-for-builder/lib/builder-locale.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




function init() {
    return __awaiter(this, void 0, void 0, function* () {
        registerActionSettingClassInfoForBuilder();
        yield (0,_builder_locale__WEBPACK_IMPORTED_MODULE_3__.loadI18nMessage)();
        return yield Promise.resolve({});
    });
}
function registerActionSettingClassInfoForBuilder() {
    _lib_app_message_manager__WEBPACK_IMPORTED_MODULE_0__["default"].getInstance().registerActionRawSettingClass('filter-data-record-action', _lib_message_actions_filter_data_record_action_setting__WEBPACK_IMPORTED_MODULE_1__["default"]);
    _lib_app_message_manager__WEBPACK_IMPORTED_MODULE_0__["default"].getInstance().registerActionRawSettingClass('select-data-record-action', _lib_message_actions_select_data_record_action_setting__WEBPACK_IMPORTED_MODULE_2__["default"]);
}


/***/ }),

/***/ "./jimu-for-builder/lib/message-actions/filter-data-record-action-setting.tsx":
/*!************************************************************************************!*\
  !*** ./jimu-for-builder/lib/message-actions/filter-data-record-action-setting.tsx ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_theme__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-theme */ "jimu-theme");
/* harmony import */ var _translations_default__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../translations/default */ "./jimu-for-builder/lib/translations/default.ts");
/* harmony import */ var _init__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./init */ "./jimu-for-builder/lib/message-actions/init.ts");
/* harmony import */ var jimu_icons_outlined_data_link_combined__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jimu-icons/outlined/data/link-combined */ "./jimu-icons/outlined/data/link-combined.tsx");
/** @jsx jsx */





class _FilterDataRecordActionSetting extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.PureComponent {
    constructor(props) {
        super(props);
        this.modalStyle = {
            position: 'absolute',
            top: '0',
            bottom: '0',
            width: '259px',
            height: 'auto',
            borderRight: '',
            borderBottom: '',
            paddingBottom: '1px'
        };
        this.getInitConfig = () => {
            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;
            const { messageWidgetId, messageType } = this.props;
            const dsM = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance();
            let messageUseDataSource = null;
            let actionUseDataSource = null;
            let enableQueryWithCurrentExtent = true;
            if (!this.props.config.messageUseDataSource) {
                const ds = (0,_init__WEBPACK_IMPORTED_MODULE_3__.getDsByWidgetId)(messageWidgetId, messageType);
                if ((ds === null || ds === void 0 ? void 0 : ds[0]) && (ds === null || ds === void 0 ? void 0 : ds.length) === 1) {
                    const dsJson = (_a = dsM.getDataSource(ds === null || ds === void 0 ? void 0 : ds[0].dataSourceId)) === null || _a === void 0 ? void 0 : _a.getDataSourceJson();
                    if (dsJson && ((dsJson.type === this.state.ArcGISDataSourceTypes.WebMap) || (dsJson.type === this.state.ArcGISDataSourceTypes.WebScene))) {
                        messageUseDataSource = null;
                    }
                    else {
                        messageUseDataSource = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
                            dataSourceId: (_b = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _b === void 0 ? void 0 : _b.dataSourceId,
                            mainDataSourceId: (_c = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _c === void 0 ? void 0 : _c.mainDataSourceId,
                            dataViewId: (_d = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _d === void 0 ? void 0 : _d.dataViewId,
                            rootDataSourceId: (_e = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _e === void 0 ? void 0 : _e.rootDataSourceId
                        });
                    }
                }
            }
            else {
                messageUseDataSource = (0,_init__WEBPACK_IMPORTED_MODULE_3__.checkAndGetInitUseDataSource)({
                    widgetId: messageWidgetId,
                    oldUseDataSource: this.props.config.messageUseDataSource,
                    messageType: messageType,
                    arcGISDataSourceTypes: this.state.ArcGISDataSourceTypes
                });
            }
            if (this.props.config.enableQueryWithCurrentExtent !== undefined) {
                enableQueryWithCurrentExtent = this.props.config.enableQueryWithCurrentExtent;
            }
            if (!this.props.config.actionUseDataSource) {
                actionUseDataSource = null;
            }
            else {
                const actionDataSourceId = (_g = (_f = this.props.config) === null || _f === void 0 ? void 0 : _f.actionUseDataSource) === null || _g === void 0 ? void 0 : _g.dataSourceId;
                const actionRootDataSourceId = (_j = (_h = this.props.config) === null || _h === void 0 ? void 0 : _h.actionUseDataSource) === null || _j === void 0 ? void 0 : _j.rootDataSourceId;
                const dsJson = ((_k = dsM.getDataSource(actionDataSourceId)) === null || _k === void 0 ? void 0 : _k.getDataSourceJson()) ||
                    ((_l = dsM.getDataSource(actionRootDataSourceId)) === null || _l === void 0 ? void 0 : _l.getDataSourceJson());
                if (dsJson) {
                    actionUseDataSource = this.props.config.actionUseDataSource;
                }
                else {
                    actionUseDataSource = null;
                }
            }
            if (actionUseDataSource && actionUseDataSource.dataSourceId) {
                return {
                    messageUseDataSource: messageUseDataSource,
                    actionUseDataSource: actionUseDataSource,
                    sqlExprObj: this.props.config.sqlExprObj,
                    enableQueryWithCurrentExtent: enableQueryWithCurrentExtent
                };
            }
            else {
                return {
                    messageUseDataSource: messageUseDataSource,
                    actionUseDataSource: actionUseDataSource,
                    sqlExprObj: null,
                    enableQueryWithCurrentExtent: enableQueryWithCurrentExtent
                };
            }
        };
        this.handleTriggerLayerChange = (useDataSources) => {
            if (useDataSources && useDataSources.length > 0) {
                this.handleTriggerLayerSelected(useDataSources[0]);
            }
            else {
                this.handleRemoveLayerForTriggerLayer();
            }
        };
        this.handleActionLayerChange = (useDataSources) => {
            if (useDataSources && useDataSources.length > 0) {
                this.handleActionLayerSelected(useDataSources[0]);
            }
            else {
                this.handleRemoveLayerForActionLayer();
            }
        };
        this.handleTriggerLayerSelected = (currentSelectedDs) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('messageUseDataSource', currentSelectedDs)
            });
        };
        this.handleActionLayerSelected = (currentSelectedDs) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('actionUseDataSource', currentSelectedDs).set('sqlExprObj', null)
            });
        };
        this.handleRemoveLayerForTriggerLayer = () => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('messageUseDataSource', null)
            });
        };
        this.handleRemoveLayerForActionLayer = () => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('actionUseDataSource', null).set('sqlExprObj', null)
            });
        };
        this.showSqlExprPopup = () => {
            this.setState({ isSqlExprShow: true });
        };
        this.toggleSqlExprPopup = () => {
            this.setState({ isSqlExprShow: !this.state.isSqlExprShow });
        };
        this.onSqlExprBuilderChange = (sqlExprObj) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('sqlExprObj', sqlExprObj)
            });
        };
        this.onMessageFieldSelected = (allSelectedFields, ds) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('messageUseDataSource', {
                    dataSourceId: this.props.config.messageUseDataSource.dataSourceId,
                    mainDataSourceId: this.props.config.messageUseDataSource.mainDataSourceId,
                    dataViewId: this.props.config.messageUseDataSource.dataViewId,
                    rootDataSourceId: this.props.config.messageUseDataSource.rootDataSourceId,
                    fields: allSelectedFields.map(f => f.jimuName)
                })
            });
        };
        this.onActionFieldSelected = (allSelectedFields, ds) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('actionUseDataSource', {
                    dataSourceId: this.props.config.actionUseDataSource.dataSourceId,
                    mainDataSourceId: this.props.config.actionUseDataSource.mainDataSourceId,
                    dataViewId: this.props.config.actionUseDataSource.dataViewId,
                    rootDataSourceId: this.props.config.actionUseDataSource.rootDataSourceId,
                    fields: allSelectedFields.map(f => f.jimuName)
                })
            });
        };
        this.swicthEnabledDataRelationShip = (checked) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('enabledDataRelationShip', checked)
            });
        };
        this.swicthEnabledQueryWithCurrentExtent = (checked) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('enableQueryWithCurrentExtent', checked)
            });
        };
        this.checkIsDisableDataView = (widgetId) => {
            var _a, _b, _c, _d;
            if (this.props.messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataRecordsSelectionChange) {
                return true;
            }
            const appConfig = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState()) === null || _a === void 0 ? void 0 : _a.appStateInBuilder) === null || _b === void 0 ? void 0 : _b.appConfig;
            const widgetJson = (_c = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _c === void 0 ? void 0 : _c[widgetId];
            if (widgetJson) {
                const widgetLabel = (_d = widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.manifest) === null || _d === void 0 ? void 0 : _d.label;
                if (widgetLabel === 'Map') {
                    return true;
                }
                else {
                    return false;
                }
            }
            else {
                return false;
            }
        };
        this.modalStyle.borderRight = '1px solid black';
        this.modalStyle.borderBottom = '1px solid black';
        this.state = {
            isShowLayerList: false,
            currentLayerType: null,
            isSqlExprShow: false
        };
    }
    componentDidMount() {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.loadModules([
            'jimu-ui',
            'jimu-ui/advanced/setting-components',
            'jimu-ui/advanced/data-source-selector',
            'jimu-arcgis',
            'jimu-ui/advanced/sql-expression-builder'
        ]).then(modules => {
            this.setState({
                Button: modules[0].Button,
                Icon: modules[0].Icon,
                Switch: modules[0].Switch,
                Collapse: modules[0].Collapse,
                SettingSection: modules[1].SettingSection,
                SettingRow: modules[1].SettingRow,
                FieldSelector: modules[2].FieldSelector,
                DataSourceSelector: modules[2].DataSourceSelector,
                ArcGISDataSourceTypes: modules[3].ArcGISDataSourceTypes,
                SqlExpressionBuilderPopup: modules[4].SqlExpressionBuilderPopup,
                DSSelectorTypes: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([jimu_core__WEBPACK_IMPORTED_MODULE_0__.AllDataSourceTypes.FeatureLayer, jimu_core__WEBPACK_IMPORTED_MODULE_0__.AllDataSourceTypes.SceneLayer])
            }, () => {
                const initConfig = this.getInitConfig();
                this.props.onSettingChange({
                    actionId: this.props.actionId,
                    config: this.props.config.set('messageUseDataSource', initConfig.messageUseDataSource)
                        .set('actionUseDataSource', initConfig.actionUseDataSource).set('sqlExprObj', initConfig.sqlExprObj)
                });
            });
        });
    }
    getStyle(theme) {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.css) `
      .setting-header {
        padding: ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(10)} ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(16)} ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(0)} ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(16)}
      }

      .deleteIcon {
        cursor: pointer;
        opacity: .8;
      }

      .deleteIcon:hover {
        opacity: 1;
      }

      .sql-expr-display {
        width: 100%;
        height: auto;
        min-height: 60px;
        line-height: 25px;
        padding: 3px 5px;
        color: ${theme.colors.palette.dark[300]};
        border: 1px solid ${theme.colors.palette.light[500]};
      }

      .relate-panel-left {
        flex: auto;
        overflow: hidden;
        .action-select-chooser {
          margin-top: ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(12)};
        }
      }
    `;
    }
    render() {
        var _a, _b;
        const { Button, Icon, Switch, Collapse, SettingSection, SettingRow, FieldSelector, DataSourceSelector, ArcGISDataSourceTypes, SqlExpressionBuilderPopup } = this.state;
        const { messageWidgetId, messageType, config, theme } = this.props;
        if (!Button || !Icon || !Switch || !Collapse || !SettingSection || !SettingRow || !FieldSelector ||
            !DataSourceSelector || !ArcGISDataSourceTypes || !SqlExpressionBuilderPopup) {
            return null;
        }
        const triggerDsSelectorSourceData = (0,_init__WEBPACK_IMPORTED_MODULE_3__.getDsSelectorSourceData)({
            widgetId: messageWidgetId,
            useDataSource: config.messageUseDataSource,
            messageType: messageType,
            arcGISDataSourceTypes: ArcGISDataSourceTypes
        });
        const actionUseDataSourceInstance = config.actionUseDataSource &&
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().getDataSource(config.actionUseDataSource.dataSourceId);
        if (this.props.messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.ExtentChange) {
            return ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { css: this.getStyle(this.props.theme) },
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_ActionLayer', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_ActionLayer }) },
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(DataSourceSelector, { types: this.state.DSSelectorTypes, useDataSources: this.props.config.actionUseDataSource ? (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([this.props.config.actionUseDataSource]) : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]), closeDataSourceListOnChange: true, hideAddDataButton: true, hideTypeDropdown: true, mustUseDataSource: true, onChange: this.handleActionLayerChange, widgetId: this.props.widgetId, enableToSelectOutputDsFromSelf: true })),
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_Conditions', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_Conditions }) },
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, { label: this.props.intl.formatMessage({ id: 'frameworkAction_QueryByExtent', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_QueryByExtent }) },
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Switch, { checked: this.props.config.enableQueryWithCurrentExtent, onChange: evt => { this.swicthEnabledQueryWithCurrentExtent(evt.target.checked); } })),
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Button, { className: 'p-0 text-left', type: 'link', disabled: !this.props.config.actionUseDataSource, onClick: this.showSqlExprPopup, title: this.props.intl.formatMessage({ id: 'frameworkAction_MoreConditions', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_MoreConditions }) }, this.props.intl.formatMessage({ id: 'frameworkAction_MoreConditions', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_MoreConditions }))),
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                        this.props.config.actionUseDataSource && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceComponent, { useDataSource: this.props.config.actionUseDataSource }, (ds) => {
                            return ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SqlExpressionBuilderPopup, { dataSource: ds, mode: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SqlExpressionMode.Simple, isOpen: this.state.isSqlExprShow, toggle: this.toggleSqlExprPopup, expression: this.props.config.sqlExprObj, onChange: (sqlExprObj) => { this.onSqlExprBuilderChange(sqlExprObj); }, id: 'filter-widget-sql-expression-builder-popup' }));
                        }),
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'sql-expr-display body-1' }, this.props.config.sqlExprObj && actionUseDataSourceInstance
                            ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getArcGISSQL(this.props.config.sqlExprObj, actionUseDataSourceInstance).displaySQL
                            : this.props.intl.formatMessage({ id: 'frameworkAction_SetExpression', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_SetExpression }))))));
        }
        else {
            return ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { css: this.getStyle(this.props.theme) },
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_TriggerLayer', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_TriggerLayer }) },
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(DataSourceSelector, { types: this.state.DSSelectorTypes, useDataSources: triggerDsSelectorSourceData.useDataSources, fromRootDsIds: triggerDsSelectorSourceData.fromRootDsIds, fromDsIds: triggerDsSelectorSourceData.fromDsIds, closeDataSourceListOnChange: true, disableRemove: () => triggerDsSelectorSourceData.isReadOnly, disableDataSourceList: triggerDsSelectorSourceData.isReadOnly, hideAddDataButton: true, hideTypeDropdown: true, mustUseDataSource: true, onChange: this.handleTriggerLayerChange, widgetId: this.props.messageWidgetId, disableDataView: true, hideDataView: this.checkIsDisableDataView(this.props.messageWidgetId), enableToSelectOutputDsFromSelf: true })),
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_ActionLayer', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_ActionLayer }) },
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(DataSourceSelector, { types: this.state.DSSelectorTypes, useDataSources: this.props.config.actionUseDataSource ? (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([this.props.config.actionUseDataSource]) : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]), closeDataSourceListOnChange: true, hideAddDataButton: true, hideTypeDropdown: true, mustUseDataSource: true, onChange: this.handleActionLayerChange, widgetId: this.props.widgetId, enableToSelectOutputDsFromSelf: true })),
                this.props.config && this.props.config.actionUseDataSource && this.props.config.messageUseDataSource &&
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_Conditions', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_Conditions }) },
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, { label: this.props.intl.formatMessage({ id: 'frameworkAction_RelateMessage', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_RelateMessage }) },
                            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Switch, { checked: this.props.config.enabledDataRelationShip, onChange: evt => { this.swicthEnabledDataRelationShip(evt.target.checked); } })),
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Collapse, { isOpen: this.props.config.enabledDataRelationShip, className: 'w-100' },
                                (0,_init__WEBPACK_IMPORTED_MODULE_3__.checkTrigerLayerIsSameToActionLayer)(config) &&
                                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'w-100 border p-1 mr-2' }, this.props.intl.formatMessage({ id: 'frameworkAction_AutoBind', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_AutoBind })),
                                !(0,_init__WEBPACK_IMPORTED_MODULE_3__.checkTrigerLayerIsSameToActionLayer)(config) && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'w-100 d-flex align-items-center' },
                                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'd-flex flex-column relate-panel-left' },
                                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(FieldSelector, { className: 'w-100', useDataSources: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([(_a = this.props.config.messageUseDataSource) === null || _a === void 0 ? void 0 : _a.asMutable({ deep: true })]), isDataSourceDropDownHidden: true, placeholder: this.props.intl.formatMessage({ id: 'frameworkAction_TriggerLayerField', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_TriggerLayerField }), onChange: this.onMessageFieldSelected, useDropdown: true, isSearchInputHidden: true, selectedFields: this.props.config.messageUseDataSource && this.props.config.messageUseDataSource.fields
                                                ? this.props.config.messageUseDataSource.fields
                                                : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]) }),
                                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(FieldSelector, { className: 'w-100 action-select-chooser', placeholder: this.props.intl.formatMessage({ id: 'frameworkAction_ActionLayerField', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_ActionLayerField }), useDataSources: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([(_b = this.props.config.actionUseDataSource) === null || _b === void 0 ? void 0 : _b.asMutable({ deep: true })]), isDataSourceDropDownHidden: true, onChange: this.onActionFieldSelected, useDropdown: true, isSearchInputHidden: true, selectedFields: this.props.config.actionUseDataSource && this.props.config.actionUseDataSource.fields
                                                ? this.props.config.actionUseDataSource.fields
                                                : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]) })),
                                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_icons_outlined_data_link_combined__WEBPACK_IMPORTED_MODULE_4__.LinkCombinedOutlined, { autoFlip: true, className: 'flex-none', width: 12, height: 40, color: theme.colors.dark[400] })))),
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Button, { type: 'link', disabled: !this.props.config.actionUseDataSource, className: 'w-100 d-flex justify-content-start', onClick: this.showSqlExprPopup },
                                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'w-100 text-truncate', style: { textAlign: 'start' } }, this.props.intl.formatMessage({ id: 'frameworkAction_MoreConditions', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_MoreConditions }))),
                            this.props.config.actionUseDataSource && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceComponent, { useDataSource: this.props.config.actionUseDataSource }, (ds) => {
                                return ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SqlExpressionBuilderPopup, { dataSource: ds, mode: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SqlExpressionMode.Simple, isOpen: this.state.isSqlExprShow, toggle: this.toggleSqlExprPopup, expression: this.props.config.sqlExprObj, onChange: (sqlExprObj) => { this.onSqlExprBuilderChange(sqlExprObj); }, id: 'filter-widget-sql-expression-builder-popup' }));
                            })),
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'sql-expr-display' }, this.props.config.sqlExprObj && actionUseDataSourceInstance
                                ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getArcGISSQL(this.props.config.sqlExprObj, actionUseDataSourceInstance).displaySQL
                                : this.props.intl.formatMessage({ id: 'frameworkAction_SetExpression', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_SetExpression }))))));
        }
    }
}
_FilterDataRecordActionSetting.defaultProps = {
    config: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
        messageUseDataSource: null,
        actionUseDataSource: null,
        sqlExprObj: null,
        enabledDataRelationShip: true,
        enableQueryWithCurrentExtent: true
    })
};
const mapStateToProps = (state) => {
    return {
        dataSources: state.appStateInBuilder && state.appStateInBuilder.appConfig && state.appStateInBuilder.appConfig.dataSources,
        dataSourcesInfo: state.appStateInBuilder && state.appStateInBuilder.dataSourcesInfo
    };
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (jimu_core__WEBPACK_IMPORTED_MODULE_0__.ReactRedux.connect(mapStateToProps)((0,jimu_theme__WEBPACK_IMPORTED_MODULE_1__.withTheme)(_FilterDataRecordActionSetting)));


/***/ }),

/***/ "./jimu-for-builder/lib/message-actions/init.ts":
/*!******************************************************!*\
  !*** ./jimu-for-builder/lib/message-actions/init.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   checkAndGetInitUseDataSource: () => (/* binding */ checkAndGetInitUseDataSource),
/* harmony export */   checkIsOnlyOneDs: () => (/* binding */ checkIsOnlyOneDs),
/* harmony export */   checkIsSameRootDataSourceId: () => (/* binding */ checkIsSameRootDataSourceId),
/* harmony export */   checkTrigerLayerIsSameToActionLayer: () => (/* binding */ checkTrigerLayerIsSameToActionLayer),
/* harmony export */   getDsByWidgetId: () => (/* binding */ getDsByWidgetId),
/* harmony export */   getDsIdsByWidgetId: () => (/* binding */ getDsIdsByWidgetId),
/* harmony export */   getDsRootIdsByWidgetId: () => (/* binding */ getDsRootIdsByWidgetId),
/* harmony export */   getDsSelectorSourceData: () => (/* binding */ getDsSelectorSourceData),
/* harmony export */   getMessageCarryData: () => (/* binding */ getMessageCarryData),
/* harmony export */   getMessageCarryDataByWidgetId: () => (/* binding */ getMessageCarryDataByWidgetId),
/* harmony export */   initOutputDataSources: () => (/* binding */ initOutputDataSources),
/* harmony export */   isUseOutputDs: () => (/* binding */ isUseOutputDs)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/** @jsx jsx */

function getDsSelectorSourceData(props) {
    var _a, _b, _c;
    const { widgetId, useDataSource, messageType, arcGISDataSourceTypes } = props;
    const appConfig = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState()) === null || _a === void 0 ? void 0 : _a.appStateInBuilder) === null || _b === void 0 ? void 0 : _b.appConfig;
    const widgetJson = (_c = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _c === void 0 ? void 0 : _c[widgetId];
    const dsRootIds = getDsRootIdsByWidgetId(widgetId, arcGISDataSourceTypes);
    const messageCarryData = getMessageCarryData(widgetId, messageType);
    const isReadOnly = checkIsOnlyOneDs(widgetJson, messageCarryData, dsRootIds);
    const useDataSources = (useDataSource && useDataSource.dataSourceId)
        ? (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([useDataSource.asMutable({ deep: true })])
        : null;
    const fromDsIds = dsRootIds ? null : getDsIdsByWidgetId(widgetId, messageType);
    const dsSelectorSource = {
        isReadOnly: isReadOnly,
        useDataSources: useDataSources,
        fromRootDsIds: dsRootIds,
        fromDsIds: fromDsIds
    };
    return dsSelectorSource;
}
function checkIsOnlyOneDs(widgetJson, messageCarryData, dsRootIds) {
    const outputDs = (widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.outputDataSources) || [];
    const useDs = (widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.useDataSources) || [];
    if (dsRootIds) {
        return false;
    }
    switch (messageCarryData) {
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.OutputDataSource:
            return (outputDs === null || outputDs === void 0 ? void 0 : outputDs.length) === 1;
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.UseDataSource:
            return (useDs === null || useDs === void 0 ? void 0 : useDs.length) === 1;
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.BothDataSource:
            const dsLength = outputDs.length + useDs.length;
            return dsLength === 1;
    }
}
function getDsRootIdsByWidgetId(wId, arcGISDataSourceTypes) {
    var _a, _b, _c, _d;
    const appConfig = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState()) === null || _a === void 0 ? void 0 : _a.appStateInBuilder) === null || _b === void 0 ? void 0 : _b.appConfig;
    const widgetJson = (_c = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _c === void 0 ? void 0 : _c[wId];
    const rootIds = [];
    const dsM = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance();
    (_d = widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.useDataSources) === null || _d === void 0 ? void 0 : _d.forEach((useDS) => {
        const ds = dsM.getDataSource(useDS.dataSourceId);
        if ((ds === null || ds === void 0 ? void 0 : ds.type) === arcGISDataSourceTypes.WebMap || (ds === null || ds === void 0 ? void 0 : ds.type) === arcGISDataSourceTypes.WebScene) { // is root ds
            rootIds.push(useDS.dataSourceId);
        }
    });
    return rootIds.length > 0 ? (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(rootIds) : null;
}
function getDsIdsByWidgetId(wId, messageType) {
    var _a;
    const ds = getDsByWidgetId(wId, messageType);
    return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)((_a = ds === null || ds === void 0 ? void 0 : ds.map((useDS) => useDS === null || useDS === void 0 ? void 0 : useDS.mainDataSourceId)) !== null && _a !== void 0 ? _a : []);
}
function getDsByWidgetId(wId, messageType) {
    var _a, _b, _c;
    const messageCarryData = getMessageCarryData(wId, messageType);
    const appConfig = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState()) === null || _a === void 0 ? void 0 : _a.appStateInBuilder) === null || _b === void 0 ? void 0 : _b.appConfig;
    const widgetJson = (_c = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _c === void 0 ? void 0 : _c[wId];
    const useDataSources = (widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.useDataSources) || (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]);
    const outputDataSources = initOutputDataSources(widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.outputDataSources) || (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]);
    const bothDatasource = useDataSources === null || useDataSources === void 0 ? void 0 : useDataSources.asMutable({ deep: true }).concat(outputDataSources === null || outputDataSources === void 0 ? void 0 : outputDataSources.asMutable({ deep: true }));
    switch (messageCarryData) {
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.OutputDataSource:
            return outputDataSources;
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.UseDataSource:
            return useDataSources;
        case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.BothDataSource:
            return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(bothDatasource);
    }
}
function isUseOutputDs(wId, messageType) {
    const messageCarryData = getMessageCarryDataByWidgetId(wId, messageType);
    return messageCarryData === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.OutputDataSource;
}
/**
 * Get MessageCarryData by widget id and messageType
*/
function getMessageCarryData(wId, messageType) {
    const messageCarryData = getMessageCarryDataByWidgetId(wId, messageType);
    if (!messageCarryData) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageCarryData.UseDataSource;
    }
    else {
        return messageCarryData;
    }
}
function initOutputDataSources(outputDataSources) {
    var _a;
    const ds = (_a = outputDataSources === null || outputDataSources === void 0 ? void 0 : outputDataSources.map(dsId => {
        return {
            dataSourceId: dsId,
            mainDataSourceId: dsId,
            rootDataSourceId: null
        };
    })) !== null && _a !== void 0 ? _a : [];
    return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(ds);
}
function getMessageCarryDataByWidgetId(wId, messageType) {
    var _a, _b, _c, _d;
    const appConfig = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState()) === null || _a === void 0 ? void 0 : _a.appStateInBuilder) === null || _b === void 0 ? void 0 : _b.appConfig;
    const widgetJson = (_c = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _c === void 0 ? void 0 : _c[wId];
    const publishMessages = (_d = widgetJson === null || widgetJson === void 0 ? void 0 : widgetJson.manifest) === null || _d === void 0 ? void 0 : _d.publishMessages;
    let messageCarryData = null;
    publishMessages.forEach(el => {
        const publishMessageProperty = el;
        if ((publishMessageProperty === null || publishMessageProperty === void 0 ? void 0 : publishMessageProperty.messageCarryData) && (publishMessageProperty === null || publishMessageProperty === void 0 ? void 0 : publishMessageProperty.messageType) === messageType) {
            messageCarryData = publishMessageProperty === null || publishMessageProperty === void 0 ? void 0 : publishMessageProperty.messageCarryData;
        }
    });
    return messageCarryData;
}
/**
 * Initialize the useDataSource by comparing the current useDatasources and oldUseDatasources of the widget,
 * if they are the same, use oldDatasources, otherwise update to null
*/
function checkAndGetInitUseDataSource(props) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;
    const { widgetId, oldUseDataSource, messageType, arcGISDataSourceTypes } = props;
    const config = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig;
    const dsM = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance();
    const widgetJson = config.widgets[widgetId];
    let initUseDataSource = null;
    let isMapDs = false;
    const isoldUseDataSourceIsOutputDs = (_b = (_a = dsM.getDataSource(oldUseDataSource.dataSourceId)) === null || _a === void 0 ? void 0 : _a.getDataSourceJson()) === null || _b === void 0 ? void 0 : _b.isOutputFromWidget;
    const ds = getDsByWidgetId(widgetId, messageType);
    const dsId = (ds === null || ds === void 0 ? void 0 : ds[0]) && ((_c = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _c === void 0 ? void 0 : _c.dataSourceId);
    if (!dsId) {
        return null;
    }
    const dsJson = (_d = dsM.getDataSource(dsId)) === null || _d === void 0 ? void 0 : _d.getDataSourceJson();
    if (dsJson && ((dsJson.type === arcGISDataSourceTypes.WebMap) || (dsJson.type === arcGISDataSourceTypes.WebScene))) {
        isMapDs = true;
    }
    if (isMapDs) {
        // webmap or webscene ds
        let isUseOldDs = false;
        if (widgetJson && widgetJson.useDataSources) {
            for (let i = 0; i < widgetJson.useDataSources.length; i++) {
                if (widgetJson.useDataSources[i].dataSourceId === oldUseDataSource.rootDataSourceId) {
                    isUseOldDs = true;
                    break;
                }
            }
        }
        if (isUseOldDs) {
            initUseDataSource = oldUseDataSource;
        }
        else {
            initUseDataSource = null;
        }
    }
    else {
        // featurelayer ds
        let isUseOldDs = false;
        if (ds) {
            for (let i = 0; i < (ds === null || ds === void 0 ? void 0 : ds.length); i++) {
                const oldUseDataSourceId = isoldUseDataSourceIsOutputDs ? (_f = (_e = dsM.getDataSource(oldUseDataSource.dataSourceId)) === null || _e === void 0 ? void 0 : _e.getMainDataSource()) === null || _f === void 0 ? void 0 : _f.id : oldUseDataSource.dataSourceId;
                const widgetDsId = isoldUseDataSourceIsOutputDs ? (_j = (_h = dsM.getDataSource((_g = ds === null || ds === void 0 ? void 0 : ds[i]) === null || _g === void 0 ? void 0 : _g.dataSourceId)) === null || _h === void 0 ? void 0 : _h.getMainDataSource()) === null || _j === void 0 ? void 0 : _j.id : (_k = ds === null || ds === void 0 ? void 0 : ds[i]) === null || _k === void 0 ? void 0 : _k.dataSourceId;
                if (widgetDsId === oldUseDataSourceId) {
                    isUseOldDs = true;
                    break;
                }
            }
        }
        if (isUseOldDs) {
            initUseDataSource = oldUseDataSource;
        }
        else {
            if ((ds === null || ds === void 0 ? void 0 : ds.length) === 1) {
                initUseDataSource = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
                    dataSourceId: (_l = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _l === void 0 ? void 0 : _l.dataSourceId,
                    mainDataSourceId: (_m = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _m === void 0 ? void 0 : _m.mainDataSourceId,
                    dataViewId: (_o = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _o === void 0 ? void 0 : _o.dataViewId,
                    rootDataSourceId: (_p = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _p === void 0 ? void 0 : _p.rootDataSourceId
                });
            }
            else {
                initUseDataSource = null;
            }
        }
    }
    return initUseDataSource;
}
function checkTrigerLayerIsSameToActionLayer(config) {
    if (config.messageUseDataSource && config.actionUseDataSource) {
        if (config.messageUseDataSource.mainDataSourceId === config.actionUseDataSource.mainDataSourceId && checkIsSameRootDataSourceId(config)) {
            return true;
        }
        else {
            return false;
        }
    }
    else {
        return false;
    }
}
function checkIsSameRootDataSourceId(config) {
    if (config.messageUseDataSource.rootDataSourceId || config.actionUseDataSource.rootDataSourceId) {
        return config.messageUseDataSource.rootDataSourceId === config.actionUseDataSource.rootDataSourceId;
    }
    else {
        return true;
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/message-actions/select-data-record-action-setting.tsx":
/*!************************************************************************************!*\
  !*** ./jimu-for-builder/lib/message-actions/select-data-record-action-setting.tsx ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_theme__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-theme */ "jimu-theme");
/* harmony import */ var _translations_default__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../translations/default */ "./jimu-for-builder/lib/translations/default.ts");
/* harmony import */ var _init__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./init */ "./jimu-for-builder/lib/message-actions/init.ts");
/* harmony import */ var jimu_icons_outlined_data_link_combined__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jimu-icons/outlined/data/link-combined */ "./jimu-icons/outlined/data/link-combined.tsx");
/** @jsx jsx */





class _SelectDataRecordActionSetting extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.PureComponent {
    constructor(props) {
        super(props);
        this.modalStyle = {
            position: 'absolute',
            top: '0',
            bottom: '0',
            width: '259px',
            height: 'auto',
            borderRight: '',
            borderBottom: '',
            paddingBottom: '1px'
        };
        this.getInitConfig = () => {
            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;
            const { messageWidgetId, messageType } = this.props;
            const dsM = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance();
            let messageUseDataSource = null;
            let actionUseDataSource = null;
            if (!this.props.config.messageUseDataSource) {
                const ds = (0,_init__WEBPACK_IMPORTED_MODULE_3__.getDsByWidgetId)(messageWidgetId, messageType);
                if ((ds === null || ds === void 0 ? void 0 : ds[0]) && (ds === null || ds === void 0 ? void 0 : ds.length) === 1) {
                    const dsJson = (_a = dsM.getDataSource(ds === null || ds === void 0 ? void 0 : ds[0].dataSourceId)) === null || _a === void 0 ? void 0 : _a.getDataSourceJson();
                    if (dsJson && ((dsJson.type === this.state.ArcGISDataSourceTypes.WebMap) || (dsJson.type === this.state.ArcGISDataSourceTypes.WebScene))) {
                        messageUseDataSource = null;
                    }
                    else {
                        messageUseDataSource = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
                            dataSourceId: (_b = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _b === void 0 ? void 0 : _b.dataSourceId,
                            mainDataSourceId: (_c = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _c === void 0 ? void 0 : _c.mainDataSourceId,
                            dataViewId: (_d = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _d === void 0 ? void 0 : _d.dataViewId,
                            rootDataSourceId: (_e = ds === null || ds === void 0 ? void 0 : ds[0]) === null || _e === void 0 ? void 0 : _e.rootDataSourceId
                        });
                    }
                }
            }
            else {
                messageUseDataSource = (0,_init__WEBPACK_IMPORTED_MODULE_3__.checkAndGetInitUseDataSource)({
                    widgetId: messageWidgetId,
                    oldUseDataSource: this.props.config.messageUseDataSource,
                    messageType: messageType,
                    arcGISDataSourceTypes: this.state.ArcGISDataSourceTypes
                });
            }
            if (!this.props.config.actionUseDataSource) {
                actionUseDataSource = null;
            }
            else {
                const actionDataSourceId = (_g = (_f = this.props.config) === null || _f === void 0 ? void 0 : _f.actionUseDataSource) === null || _g === void 0 ? void 0 : _g.dataSourceId;
                const actionRootDataSourceId = (_j = (_h = this.props.config) === null || _h === void 0 ? void 0 : _h.actionUseDataSource) === null || _j === void 0 ? void 0 : _j.rootDataSourceId;
                const dsJson = ((_k = dsM.getDataSource(actionDataSourceId)) === null || _k === void 0 ? void 0 : _k.getDataSourceJson()) ||
                    ((_l = dsM.getDataSource(actionRootDataSourceId)) === null || _l === void 0 ? void 0 : _l.getDataSourceJson());
                if (dsJson) {
                    actionUseDataSource = this.props.config.actionUseDataSource;
                }
                else {
                    actionUseDataSource = null;
                }
            }
            if (actionUseDataSource && actionUseDataSource.dataSourceId) {
                return {
                    messageUseDataSource: messageUseDataSource,
                    actionUseDataSource: actionUseDataSource,
                    sqlExprObj: this.props.config.sqlExprObj
                };
            }
            else {
                return {
                    messageUseDataSource: messageUseDataSource,
                    actionUseDataSource: actionUseDataSource,
                    sqlExprObj: null
                };
            }
        };
        this.handleTriggerLayerChange = (useDataSources) => {
            if (useDataSources && useDataSources.length > 0) {
                this.handleTriggerLayerSelected(useDataSources[0]);
            }
            else {
                this.handleRemoveLayerForTriggerLayer();
            }
        };
        this.handleActionLayerChange = (useDataSources) => {
            if (useDataSources && useDataSources.length > 0) {
                this.handleActionLayerSelected(useDataSources[0]);
            }
            else {
                this.handleRemoveLayerForActionLayer();
            }
        };
        this.handleTriggerLayerSelected = (currentSelectedDs) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('messageUseDataSource', currentSelectedDs)
            });
        };
        this.handleActionLayerSelected = (currentSelectedDs) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('actionUseDataSource', currentSelectedDs).set('sqlExprObj', null)
            });
        };
        this.handleRemoveLayerForTriggerLayer = () => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('messageUseDataSource', null)
            });
        };
        this.handleRemoveLayerForActionLayer = () => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('actionUseDataSource', null).set('sqlExprObj', null)
            });
        };
        this.showSqlExprPopup = () => {
            this.setState({ isSqlExprShow: true });
        };
        this.toggleSqlExprPopup = () => {
            this.setState({ isSqlExprShow: !this.state.isSqlExprShow });
        };
        this.onSqlExprBuilderChange = (sqlExprObj) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('sqlExprObj', sqlExprObj)
            });
        };
        this.onMessageFieldSelected = (allSelectedFields, ds) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('messageUseDataSource', {
                    dataSourceId: this.props.config.messageUseDataSource.dataSourceId,
                    mainDataSourceId: this.props.config.messageUseDataSource.mainDataSourceId,
                    dataViewId: this.props.config.messageUseDataSource.dataViewId,
                    rootDataSourceId: this.props.config.messageUseDataSource.rootDataSourceId,
                    fields: allSelectedFields.map(f => f.jimuName)
                })
            });
        };
        this.onActionFieldSelected = (allSelectedFields, ds) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('actionUseDataSource', {
                    dataSourceId: this.props.config.actionUseDataSource.dataSourceId,
                    mainDataSourceId: this.props.config.actionUseDataSource.mainDataSourceId,
                    dataViewId: this.props.config.actionUseDataSource.dataViewId,
                    rootDataSourceId: this.props.config.actionUseDataSource.rootDataSourceId,
                    fields: allSelectedFields.map(f => f.jimuName)
                })
            });
        };
        this.swicthEnabledDataRelationShip = (checked) => {
            this.props.onSettingChange({
                actionId: this.props.actionId,
                config: this.props.config.set('enabledDataRelationShip', checked)
            });
        };
        this.modalStyle.borderRight = '1px solid black';
        this.modalStyle.borderBottom = '1px solid black';
        this.state = {
            isShowLayerList: false,
            currentLayerType: null,
            isSqlExprShow: false
        };
    }
    componentDidMount() {
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.loadModules([
            'jimu-ui',
            'jimu-ui/advanced/setting-components',
            'jimu-ui/advanced/data-source-selector',
            'jimu-arcgis',
            'jimu-ui/advanced/sql-expression-builder'
        ]).then(modules => {
            this.setState({
                Button: modules[0].Button,
                Icon: modules[0].Icon,
                Switch: modules[0].Switch,
                Collapse: modules[0].Collapse,
                SettingSection: modules[1].SettingSection,
                SettingRow: modules[1].SettingRow,
                FieldSelector: modules[2].FieldSelector,
                DataSourceSelector: modules[2].DataSourceSelector,
                ArcGISDataSourceTypes: modules[3].ArcGISDataSourceTypes,
                SqlExpressionBuilderPopup: modules[4].SqlExpressionBuilderPopup,
                DSSelectorTypes: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([jimu_core__WEBPACK_IMPORTED_MODULE_0__.AllDataSourceTypes.FeatureLayer, jimu_core__WEBPACK_IMPORTED_MODULE_0__.AllDataSourceTypes.SceneLayer])
            }, () => {
                const initConfig = this.getInitConfig();
                this.props.onSettingChange({
                    actionId: this.props.actionId,
                    config: this.props.config.set('messageUseDataSource', initConfig.messageUseDataSource)
                        .set('actionUseDataSource', initConfig.actionUseDataSource).set('sqlExprObj', initConfig.sqlExprObj)
                });
            });
        });
    }
    getStyle(theme) {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.css) `
      .setting-header {
        padding: ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(10)} ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(16)} ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(0)} ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(16)}
      }

      .deleteIcon {
        cursor: pointer;
        opacity: .8;
      }

      .deleteIcon:hover {
        opacity: 1;
      }

      .sql-expr-display {
        width: 100%;
        height: auto;
        min-height: 60px;
        line-height: 25px;
        padding: 3px 5px;
        color: ${theme.colors.palette.dark[300]};
        border: 1px solid ${theme.colors.palette.light[500]};
      }

      .relate-panel-left {
        flex: auto;
        overflow: hidden;
        .action-select-chooser {
          margin-top: ${jimu_core__WEBPACK_IMPORTED_MODULE_0__.polished.rem(12)};
        }
      }
    `;
    }
    render() {
        var _a, _b;
        const { Button, Icon, Switch, Collapse, SettingSection, SettingRow, FieldSelector, DataSourceSelector, ArcGISDataSourceTypes, SqlExpressionBuilderPopup } = this.state;
        const { messageWidgetId, messageType, config, theme } = this.props;
        if (!Button || !Icon || !Switch || !Collapse || !SettingSection || !SettingRow || !FieldSelector ||
            !DataSourceSelector || !ArcGISDataSourceTypes || !SqlExpressionBuilderPopup) {
            return null;
        }
        const triggerDsSelectorSourceData = (0,_init__WEBPACK_IMPORTED_MODULE_3__.getDsSelectorSourceData)({
            widgetId: messageWidgetId,
            useDataSource: config.messageUseDataSource,
            messageType: messageType,
            arcGISDataSourceTypes: ArcGISDataSourceTypes
        });
        const actionUseDataSourceInstance = this.props.config.actionUseDataSource &&
            jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().getDataSource(this.props.config.actionUseDataSource.dataSourceId);
        return ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { css: this.getStyle(this.props.theme) },
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_TriggerLayer', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_TriggerLayer }) },
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(DataSourceSelector, { types: this.state.DSSelectorTypes, useDataSources: triggerDsSelectorSourceData.useDataSources, fromRootDsIds: triggerDsSelectorSourceData.fromRootDsIds, fromDsIds: triggerDsSelectorSourceData.fromDsIds, closeDataSourceListOnChange: true, disableRemove: () => triggerDsSelectorSourceData.isReadOnly, disableDataSourceList: triggerDsSelectorSourceData.isReadOnly, hideAddDataButton: true, hideTypeDropdown: true, mustUseDataSource: true, onChange: this.handleTriggerLayerChange, widgetId: this.props.messageWidgetId, hideDataView: true, enableToSelectOutputDsFromSelf: true })),
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_ActionLayer', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_ActionLayer }) },
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(DataSourceSelector, { types: this.state.DSSelectorTypes, useDataSources: this.props.config.actionUseDataSource ? (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([this.props.config.actionUseDataSource]) : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]), closeDataSourceListOnChange: true, hideAddDataButton: true, hideTypeDropdown: true, mustUseDataSource: true, onChange: this.handleActionLayerChange, widgetId: this.props.widgetId, hideDataView: true, enableToSelectOutputDsFromSelf: true })),
            this.props.config && this.props.config.actionUseDataSource && this.props.config.messageUseDataSource &&
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingSection, { title: this.props.intl.formatMessage({ id: 'frameworkAction_Conditions', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_Conditions }) },
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, { label: this.props.intl.formatMessage({ id: 'frameworkAction_RelateMessage', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_RelateMessage }) },
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Switch, { checked: this.props.config.enabledDataRelationShip, onChange: evt => { this.swicthEnabledDataRelationShip(evt.target.checked); } })),
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Collapse, { isOpen: this.props.config.enabledDataRelationShip, className: 'w-100' },
                            (0,_init__WEBPACK_IMPORTED_MODULE_3__.checkTrigerLayerIsSameToActionLayer)(config) &&
                                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'w-100 border p-1 mr-2' }, this.props.intl.formatMessage({ id: 'frameworkAction_AutoBind', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_AutoBind })),
                            !(0,_init__WEBPACK_IMPORTED_MODULE_3__.checkTrigerLayerIsSameToActionLayer)(config) && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'w-100 d-flex align-items-center' },
                                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'd-flex flex-column relate-panel-left' },
                                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(FieldSelector, { className: 'w-100', useDataSources: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([(_a = this.props.config.messageUseDataSource) === null || _a === void 0 ? void 0 : _a.asMutable({ deep: true })]), isDataSourceDropDownHidden: true, placeholder: this.props.intl.formatMessage({ id: 'frameworkAction_TriggerLayerField', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_TriggerLayerField }), onChange: this.onMessageFieldSelected, useDropdown: true, isSearchInputHidden: true, selectedFields: this.props.config.messageUseDataSource && this.props.config.messageUseDataSource.fields
                                            ? this.props.config.messageUseDataSource.fields
                                            : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]) }),
                                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(FieldSelector, { className: 'w-100 action-select-chooser', placeholder: this.props.intl.formatMessage({ id: 'frameworkAction_ActionLayerField', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_ActionLayerField }), useDataSources: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([(_b = this.props.config.actionUseDataSource) === null || _b === void 0 ? void 0 : _b.asMutable({ deep: true })]), isDataSourceDropDownHidden: true, onChange: this.onActionFieldSelected, useDropdown: true, isSearchInputHidden: true, selectedFields: this.props.config.actionUseDataSource && this.props.config.actionUseDataSource.fields
                                            ? this.props.config.actionUseDataSource.fields
                                            : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)([]) })),
                                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_icons_outlined_data_link_combined__WEBPACK_IMPORTED_MODULE_4__.LinkCombinedOutlined, { autoFlip: true, className: 'flex-none', width: 12, height: 40, color: theme.colors.dark[400] })))),
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(Button, { type: 'link', disabled: !this.props.config.actionUseDataSource, className: 'w-100 d-flex justify-content-start', onClick: this.showSqlExprPopup },
                            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'w-100 text-truncate', style: { textAlign: 'start' } }, this.props.intl.formatMessage({ id: 'frameworkAction_MoreConditions', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_MoreConditions }))),
                        this.props.config.actionUseDataSource && (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceComponent, { useDataSource: this.props.config.actionUseDataSource }, (ds) => {
                            return ((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SqlExpressionBuilderPopup, { dataSource: ds, mode: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SqlExpressionMode.Simple, isOpen: this.state.isSqlExprShow, toggle: this.toggleSqlExprPopup, expression: this.props.config.sqlExprObj, onChange: (sqlExprObj) => { this.onSqlExprBuilderChange(sqlExprObj); }, id: 'filter-widget-sql-expression-builder-popup' }));
                        })),
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(SettingRow, null,
                        (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { className: 'sql-expr-display' }, this.props.config.sqlExprObj && actionUseDataSourceInstance
                            ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getArcGISSQL(this.props.config.sqlExprObj, actionUseDataSourceInstance).displaySQL
                            : this.props.intl.formatMessage({ id: 'frameworkAction_SetExpression', defaultMessage: _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"].frameworkAction_SetExpression }))))));
    }
}
_SelectDataRecordActionSetting.defaultProps = {
    config: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)({
        messageUseDataSource: null,
        actionUseDataSource: null,
        sqlExprObj: null,
        enabledDataRelationShip: true
    })
};
const mapStateToProps = (state) => {
    return {
        dataSources: state.appStateInBuilder && state.appStateInBuilder.appConfig && state.appStateInBuilder.appConfig.dataSources,
        dataSourcesInfo: state.appStateInBuilder && state.appStateInBuilder.dataSourcesInfo
    };
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (jimu_core__WEBPACK_IMPORTED_MODULE_0__.ReactRedux.connect(mapStateToProps)((0,jimu_theme__WEBPACK_IMPORTED_MODULE_1__.withTheme)(_SelectDataRecordActionSetting)));


/***/ }),

/***/ "./jimu-for-builder/lib/props.ts":
/*!***************************************!*\
  !*** ./jimu-for-builder/lib/props.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./jimu-for-builder/lib/service/app-service/index.ts":
/*!***********************************************************!*\
  !*** ./jimu-for-builder/lib/service/app-service/index.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   addToFavorites: () => (/* binding */ addToFavorites),
/* harmony export */   changeAppFolder: () => (/* binding */ changeAppFolder),
/* harmony export */   checkImportAppVersion: () => (/* binding */ checkImportAppVersion),
/* harmony export */   createAppByDefaultTemplate: () => (/* binding */ createAppByDefaultTemplate),
/* harmony export */   createAppByItemTemplate: () => (/* binding */ createAppByItemTemplate),
/* harmony export */   createAppByTemplateId: () => (/* binding */ createAppByTemplateId),
/* harmony export */   createTemplateByApp: () => (/* binding */ createTemplateByApp),
/* harmony export */   deleteApp: () => (/* binding */ deleteApp),
/* harmony export */   duplicateApp: () => (/* binding */ duplicateApp),
/* harmony export */   getAppConfig: () => (/* binding */ getAppConfig),
/* harmony export */   getAppGroups: () => (/* binding */ getAppGroups),
/* harmony export */   getAppInfo: () => (/* binding */ getAppInfo),
/* harmony export */   getDefaultTemplateConfig: () => (/* binding */ getDefaultTemplateConfig),
/* harmony export */   getFolders: () => (/* binding */ getFolders),
/* harmony export */   getGroupCategorySchema: () => (/* binding */ getGroupCategorySchema),
/* harmony export */   getGroupContent: () => (/* binding */ getGroupContent),
/* harmony export */   getOrgCategorySchema: () => (/* binding */ getOrgCategorySchema),
/* harmony export */   getUserTags: () => (/* binding */ getUserTags),
/* harmony export */   importAppFromPortal: () => (/* binding */ importAppFromPortal),
/* harmony export */   importItem: () => (/* binding */ importItem),
/* harmony export */   publishApp: () => (/* binding */ publishApp),
/* harmony export */   removeFromFavorites: () => (/* binding */ removeFromFavorites),
/* harmony export */   saveApp: () => (/* binding */ saveApp),
/* harmony export */   saveAsApp: () => (/* binding */ saveAsApp),
/* harmony export */   searchApp: () => (/* binding */ searchApp),
/* harmony export */   searchAppByPortalUrl: () => (/* binding */ searchAppByPortalUrl),
/* harmony export */   searchGroups: () => (/* binding */ searchGroups),
/* harmony export */   updateAppInfo: () => (/* binding */ updateAppInfo),
/* harmony export */   updateAppInfoWhenSaveApp: () => (/* binding */ updateAppInfoWhenSaveApp),
/* harmony export */   updateAppThumbnail: () => (/* binding */ updateAppThumbnail)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _rest_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rest-service */ "./jimu-for-builder/lib/service/rest-service.tsx");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/service/app-service/util.ts");
/* harmony import */ var _type__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../type */ "./jimu-for-builder/lib/service/type/index.ts");
/* harmony import */ var jimu_for_builder_templates__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jimu-for-builder/templates */ "jimu-for-builder/templates");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





/**
 * Create app by portal template/AGOL template/local template
 * folderId: If the folderId has a value, the app will be created in the folder corresponding to the folderId
*/
function createAppByItemTemplate(appInfo, folderId) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.crateAppByApp)(appInfo, false, folderId);
    });
}
/**
 * Create app with template id, such as: xxx.com/builder/?template=id
*/
function createAppByTemplateId(templateId) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.getCreateAppParamsByAppId)(templateId).then((appInfo) => __awaiter(this, void 0, void 0, function* () {
            return yield createAppByItemTemplate(appInfo);
        }));
    });
}
/**
 *Create app by default template defined in the code
 *title: The translated string of 'Untitled experience'
 *lable: The default template's name
 *folderId: If the folderId has a value, the app will be created in the folder corresponding to the folderId
 */
function createAppByDefaultTemplate(title, templateName, folderId, webmapId, websceneId) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.getNewAppTitleWithIndex)(title).then((newTitle) => __awaiter(this, void 0, void 0, function* () {
            if (newTitle) {
                const appInfo = {
                    template: templateName,
                    name: newTitle,
                    description: '',
                    type: _type__WEBPACK_IMPORTED_MODULE_3__.AppType.ExperienceType
                };
                return yield Promise.all([getDefaultTemplateConfig(appInfo)])
                    .then(function (results) {
                    return __awaiter(this, void 0, void 0, function* () {
                        let defaultAppConfig = results[0];
                        defaultAppConfig.template = appInfo.template;
                        defaultAppConfig = (0,_util__WEBPACK_IMPORTED_MODULE_2__.initAppConfigOfNewApp)(defaultAppConfig);
                        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.toCreateAppByDefaultTemplate)(appInfo, folderId).then((item) => __awaiter(this, void 0, void 0, function* () {
                            return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.createAppCallBack)(defaultAppConfig, item, webmapId, websceneId);
                        }));
                    });
                })
                    .catch((error) => __awaiter(this, void 0, void 0, function* () {
                    console.error(error);
                    return yield Promise.reject(error);
                }));
            }
            else {
                return yield Promise.reject(null);
            }
        }));
    });
}
/**
 * folderId: If the folderId has a value, the template will be created in the folder corresponding to the folderId
*/
function createTemplateByApp(appInfo, folderId) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.crateAppByApp)(appInfo, true, folderId);
    });
}
function importItem(importAppOption) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.importApp)(importAppOption, { authentication: session });
    });
}
function checkImportAppVersion(importAppOption) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.checkAppVersion)(importAppOption, { authentication: session });
    });
}
function importAppFromPortal(portalAppInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        return duplicateApp(portalAppInfo, null, true);
    });
}
/**
 * folderId: If the folderId has a value, the app will be created in the folder corresponding to the folderId
*/
function duplicateApp(appInfo, folderId, isNotUpdateNewAppTitle) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield getAppInfo(appInfo).then((appItem) => __awaiter(this, void 0, void 0, function* () {
            if (appItem) {
                const copy = jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl().formatMessage({ id: 'copy' }) || 'copy';
                const title = isNotUpdateNewAppTitle ? appItem.title : `${appItem.title} ${copy}`;
                return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.getNewAppTitleWithIndex)(title, true, appInfo.type).then((newTitle) => __awaiter(this, void 0, void 0, function* () {
                    if (newTitle) {
                        const duplicateAppInfo = {
                            name: newTitle,
                            description: (appItem === null || appItem === void 0 ? void 0 : appItem.description) || '',
                            snippet: (appItem === null || appItem === void 0 ? void 0 : appItem.snippet) || '',
                            typeKeywords: (appItem === null || appItem === void 0 ? void 0 : appItem.typeKeywords) || [],
                            tags: appItem.tags,
                            thumbnail: appItem.thumbnail,
                            type: appInfo.type || appItem.type
                        };
                        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.createAppForDuplicate)(duplicateAppInfo, folderId).then((newAppItem) => __awaiter(this, void 0, void 0, function* () {
                            if (newAppItem) {
                                return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.updateThumbnail)(newAppItem.id, appInfo, appItem.thumbnail).then(() => __awaiter(this, void 0, void 0, function* () {
                                    return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.duplicateRelatedDataInApp)(newAppItem.id, appInfo, false).then(() => __awaiter(this, void 0, void 0, function* () {
                                        return yield Promise.resolve(newAppItem.id);
                                    }), (error) => __awaiter(this, void 0, void 0, function* () {
                                        console.error(error);
                                        deleteApp(newAppItem.id);
                                        return yield Promise.reject(error);
                                    }));
                                }));
                            }
                            else {
                                return yield Promise.reject(null);
                            }
                        }));
                    }
                    else {
                        return yield Promise.reject(null);
                    }
                }));
            }
            else {
                return yield Promise.reject(null);
            }
        }));
    });
}
/**
 * folderId: If the folderId has a value, the app will be created in the folder corresponding to the folderId
*/
function saveAsApp(originAppInfo, newAppUpdateInfo, folderId, thumbnailFiles) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.getNewAppTitleWithIndex)(`${newAppUpdateInfo.title}`, true, newAppUpdateInfo.type).then((newTitle) => __awaiter(this, void 0, void 0, function* () {
            if (newTitle) {
                const duplicateAppInfo = {
                    name: newAppUpdateInfo.title,
                    description: (newAppUpdateInfo === null || newAppUpdateInfo === void 0 ? void 0 : newAppUpdateInfo.description) || '',
                    snippet: (newAppUpdateInfo === null || newAppUpdateInfo === void 0 ? void 0 : newAppUpdateInfo.snippet) || '',
                    typeKeywords: (newAppUpdateInfo === null || newAppUpdateInfo === void 0 ? void 0 : newAppUpdateInfo.typeKeywords) || [],
                    tags: newAppUpdateInfo.tags,
                    thumbnail: newAppUpdateInfo.thumbnail,
                    type: originAppInfo.type || originAppInfo.type
                };
                //Create new app
                return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.createAppForDuplicate)(duplicateAppInfo, folderId).then((newAppItem) => __awaiter(this, void 0, void 0, function* () {
                    if (newAppItem) {
                        newAppUpdateInfo.id = newAppItem.id;
                        //Update thumbnail of new item
                        return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.updateThumbnailForSaveAsApp)(originAppInfo, newAppUpdateInfo, thumbnailFiles).then(() => __awaiter(this, void 0, void 0, function* () {
                            return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.updateItemDataInApp)(newAppItem.id).then((result) => __awaiter(this, void 0, void 0, function* () {
                                if (!result) {
                                    return yield Promise.reject(null);
                                }
                                //Update resources of new item
                                return yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.duplicateResourcesForDuplicate)(newAppItem.id, originAppInfo, true).then(() => __awaiter(this, void 0, void 0, function* () {
                                    //Save current new config
                                    let newAppConfig = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder.appConfig;
                                    newAppConfig = (0,_util__WEBPACK_IMPORTED_MODULE_2__.replaceExbVersionInAppConfig)(newAppConfig);
                                    const config = newAppConfig === null || newAppConfig === void 0 ? void 0 : newAppConfig.asMutable({ deep: true });
                                    /**
                                     * Proxy is connected to item id, proxy created in item A cannot be used in item B.
                                     * So delete app proxies when duplicate items.
                                     */
                                    delete config.appProxies;
                                    delete config.historyLabels;
                                    return saveApp(newAppUpdateInfo, (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(config), newAppItem.id).then(() => __awaiter(this, void 0, void 0, function* () {
                                        //return id and config of new item
                                        return (0,_util__WEBPACK_IMPORTED_MODULE_2__.getAppConfigInResources)(newAppItem.id).then((config) => __awaiter(this, void 0, void 0, function* () {
                                            return Promise.resolve({
                                                id: newAppItem.id,
                                                appConfig: config
                                            });
                                        }));
                                    }));
                                }), (error) => __awaiter(this, void 0, void 0, function* () {
                                    //Delete new app when save as error
                                    console.error(error);
                                    deleteApp(newAppItem.id);
                                    return yield Promise.reject(error);
                                }));
                            }), (err) => __awaiter(this, void 0, void 0, function* () {
                                //Delete new app when save as error
                                console.error(err);
                                deleteApp(newAppItem.id);
                                return yield Promise.reject(err);
                            }));
                        }));
                    }
                    else {
                        return yield Promise.reject(null);
                    }
                }));
            }
            else {
                return yield Promise.reject(null);
            }
        }), err => {
            return Promise.reject(err);
        });
    });
}
function getAppConfig(appInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getSession)(appInfo);
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getItemData)(appInfo, { authentication: session }).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }), (error) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject(error);
        }));
    });
}
function searchApp(searchOption, searchType) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getSessionBySearchType)(searchType);
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.searchItems)(Object.assign(Object.assign({}, searchOption), { authentication: session }), searchType).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function searchAppByPortalUrl(searchOption, portalUrl) {
    return __awaiter(this, void 0, void 0, function* () {
        const currentPortalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
        const isUseCurrentPortal = portalUrl === currentPortalUrl;
        if (isUseCurrentPortal) {
            const session = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getSessionBySearchType)(_type__WEBPACK_IMPORTED_MODULE_3__.SearchType.Portal);
            searchOption.authentication = session;
        }
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.searchItemsByPortalUrl)(searchOption, portalUrl).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function getAppInfo(appInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getSession)(appInfo);
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getItem)(appInfo, {
            authentication: session
        }).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function getGroupCategorySchema(groupId, isGetAGOLCategorySchema) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getGroupCategorySchema)(groupId, {
            authentication: session
        }, isGetAGOLCategorySchema).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function getOrgCategorySchema(isGetAGOLCategorySchema) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getOrgCategorySchema)({
            authentication: session
        }, isGetAGOLCategorySchema).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function getGroupContent(groupId, params, isGetAGOLGroupContent) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getGroupContents)(groupId, {
            params,
            authentication: session
        }, isGetAGOLGroupContent).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function updateAppInfo(itemParam) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        const portalUrl = window.jimuConfig.isDevEdition ? 'localhost:' : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
        const getAppInfoParams = {
            id: itemParam.id,
            portalUrl: portalUrl
        };
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getItem)(getAppInfoParams, {
            authentication: session
        }).then((res) => __awaiter(this, void 0, void 0, function* () {
            return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.updateItem)({
                item: itemParam,
                owner: res.owner,
                authentication: session
            }).then(() => {
                return null;
            });
        }));
    });
}
function updateAppInfoWhenSaveApp(appInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        return updateAppInfo(Object.assign(Object.assign({}, appInfo), { thumbnailurl: undefined })).then(res => {
            var _a;
            const thumbnailurl = appInfo === null || appInfo === void 0 ? void 0 : appInfo.thumbnailurl;
            const saveThumbnailUrl = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appRuntimeInfo) === null || _a === void 0 ? void 0 : _a.saveThumbnailUrl;
            if (thumbnailurl && thumbnailurl !== saveThumbnailUrl) {
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__.appActions.saveThumbnailUrl(thumbnailurl));
                return (0,_util__WEBPACK_IMPORTED_MODULE_2__.updateThumbnail)(appInfo.id, appInfo, thumbnailurl);
            }
            else {
                return Promise.resolve(true);
            }
        }).catch(err => {
            return Promise.reject('Update appInfo error');
        });
    });
}
function updateAppThumbnail(itemParam, owner = '') {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.updateAppsThumbnail)({
            item: itemParam,
            authentication: session,
            owner
        }).then(() => {
            return null;
        });
    });
}
function deleteApp(appId) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getItem)({ id: appId }, {
            authentication: session
        }).then((res) => __awaiter(this, void 0, void 0, function* () {
            return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.removeItem)({
                id: appId,
                owner: res.owner,
                authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession()
            });
        }));
    });
}
function saveApp(appInfo, appConfig, newAppId) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        const AppResourceManager = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.getModuleSync('jimu-for-builder').AppResourceManager;
        const appConfigUtilsForBuilder = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.getModuleSync('jimu-for-builder').appConfigUtils;
        const owners = (appInfo === null || appInfo === void 0 ? void 0 : appInfo.owner) || session.username;
        const config = Object.assign({}, appConfigUtilsForBuilder.getCleanAppConfig(appConfig));
        const appResourceManagerInstance = AppResourceManager.getInstance();
        if (!config) {
            yield Promise.reject();
            return;
        }
        try {
            yield appResourceManagerInstance.upLoadAppConfig(appInfo.id, config, owners);
            const promises = [];
            const { imageResources, iconResources } = appResourceManagerInstance.getResourcesInDraft();
            imageResources && promises.push(appResourceManagerInstance.upLoadImageResourceList((0,_util__WEBPACK_IMPORTED_MODULE_2__.cloneObj)(imageResources), newAppId));
            iconResources && promises.push(appResourceManagerInstance.upLoadIconResourceList((0,_util__WEBPACK_IMPORTED_MODULE_2__.cloneObj)(iconResources), newAppId));
            promises.push(updateAppInfoWhenSaveApp(appInfo));
            yield Promise.all(promises);
        }
        catch (error) {
            yield Promise.reject(error);
        }
    });
}
function publishApp(appInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        const draftAppConfig = yield (0,_util__WEBPACK_IMPORTED_MODULE_2__.getAppConfigInResources)(appInfo.id);
        const publishedAppConfig = yield getAppConfig(appInfo);
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        if (draftAppConfig && publishedAppConfig) {
            const newTypeKeywords = (0,_util__WEBPACK_IMPORTED_MODULE_2__.updateTypeKeywords)(appInfo === null || appInfo === void 0 ? void 0 : appInfo.typeKeywords, publishedAppConfig === null || publishedAppConfig === void 0 ? void 0 : publishedAppConfig.exbVersion);
            const AppResourceManager = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.getModuleSync('jimu-for-builder')
                .AppResourceManager;
            const appResourceManagerInstance = AppResourceManager.getInstance();
            return appResourceManagerInstance
                .upLoadLocalResource(draftAppConfig)
                .then((draftAppConfig) => __awaiter(this, void 0, void 0, function* () {
                if (!draftAppConfig) {
                    return yield Promise.reject();
                }
                draftAppConfig = (0,_util__WEBPACK_IMPORTED_MODULE_2__.optimizeWidgetsConfig)(draftAppConfig, appInfo);
                draftAppConfig = (0,_util__WEBPACK_IMPORTED_MODULE_2__.updateHistoryLabels)(draftAppConfig, publishedAppConfig);
                const previewUrl = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getPreviewUrl)(appInfo);
                yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.updateItem)({
                    item: {
                        id: appInfo.id,
                        owner: appInfo.owner || (session === null || session === void 0 ? void 0 : session.username),
                        data: draftAppConfig,
                        typeKeywords: newTypeKeywords,
                        url: previewUrl
                    },
                    authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession()
                }).then(() => __awaiter(this, void 0, void 0, function* () {
                    yield Promise.resolve();
                }), () => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.reject();
                }));
            }), () => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.reject();
            }))
                .catch((error) => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.reject(error);
            }));
        }
        else {
            yield Promise.reject();
        }
    });
}
function getFolders(requestOption) {
    return __awaiter(this, void 0, void 0, function* () {
        return (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getUserContent)(requestOption).then((result) => __awaiter(this, void 0, void 0, function* () {
            const folders = (result === null || result === void 0 ? void 0 : result.folders) || [];
            return yield Promise.resolve(folders);
        }), (error) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject(error);
        }));
    });
}
function addToFavorites(params) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.shareItemWithGroup)(params).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function removeFromFavorites(params) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.unshareItemWithGroup)(params).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function getAppGroups(params) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getItemsGroups)(params).then((result) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(result);
        }));
    });
}
function changeAppFolder(params) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.moveItem)(Object.assign(Object.assign({}, params), { authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession() }));
    });
}
function getUserTags(username) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getUsersTags)({
            username: username,
            authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession()
        });
    });
}
function searchGroups(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.searchGroup)(requestOptions);
    });
}
function getDefaultTemplateConfig(appInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        return (0,jimu_for_builder_templates__WEBPACK_IMPORTED_MODULE_4__.getTemplateConfig)(jimu_for_builder_templates__WEBPACK_IMPORTED_MODULE_4__.TemplateType.App, appInfo.template);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/app-service/util.ts":
/*!**********************************************************!*\
  !*** ./jimu-for-builder/lib/service/app-service/util.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   cloneObj: () => (/* binding */ cloneObj),
/* harmony export */   crateAppByApp: () => (/* binding */ crateAppByApp),
/* harmony export */   createApp: () => (/* binding */ createApp),
/* harmony export */   createAppCallBack: () => (/* binding */ createAppCallBack),
/* harmony export */   createAppForDuplicate: () => (/* binding */ createAppForDuplicate),
/* harmony export */   duplicatePublishedAppsConfig: () => (/* binding */ duplicatePublishedAppsConfig),
/* harmony export */   duplicateRelatedDataInApp: () => (/* binding */ duplicateRelatedDataInApp),
/* harmony export */   duplicateResourcesForCreateNew: () => (/* binding */ duplicateResourcesForCreateNew),
/* harmony export */   duplicateResourcesForDuplicate: () => (/* binding */ duplicateResourcesForDuplicate),
/* harmony export */   duplicateResourcesInApp: () => (/* binding */ duplicateResourcesInApp),
/* harmony export */   getAppConfigInResources: () => (/* binding */ getAppConfigInResources),
/* harmony export */   getAppName: () => (/* binding */ getAppName),
/* harmony export */   getConfigFromPortalItemResource: () => (/* binding */ getConfigFromPortalItemResource),
/* harmony export */   getCreateAppParamsByAppId: () => (/* binding */ getCreateAppParamsByAppId),
/* harmony export */   getMaxIndex: () => (/* binding */ getMaxIndex),
/* harmony export */   getNewAppTitleWithIndex: () => (/* binding */ getNewAppTitleWithIndex),
/* harmony export */   getPreviewUrl: () => (/* binding */ getPreviewUrl),
/* harmony export */   getResourceOrigin: () => (/* binding */ getResourceOrigin),
/* harmony export */   getSession: () => (/* binding */ getSession),
/* harmony export */   getSessionBySearchType: () => (/* binding */ getSessionBySearchType),
/* harmony export */   initAppConfigOfNewApp: () => (/* binding */ initAppConfigOfNewApp),
/* harmony export */   initAppConfigPortalUrl: () => (/* binding */ initAppConfigPortalUrl),
/* harmony export */   initDuplicatedTypeKeywords: () => (/* binding */ initDuplicatedTypeKeywords),
/* harmony export */   isAGOLApp: () => (/* binding */ isAGOLApp),
/* harmony export */   isAppNameRepeat: () => (/* binding */ isAppNameRepeat),
/* harmony export */   isLocalApp: () => (/* binding */ isLocalApp),
/* harmony export */   isPortalApp: () => (/* binding */ isPortalApp),
/* harmony export */   isUpdateDataSourcesPortalUrl: () => (/* binding */ isUpdateDataSourcesPortalUrl),
/* harmony export */   optimizeTextWidgetConfig: () => (/* binding */ optimizeTextWidgetConfig),
/* harmony export */   optimizeWidgetsConfig: () => (/* binding */ optimizeWidgetsConfig),
/* harmony export */   replaceExbVersionInAppConfig: () => (/* binding */ replaceExbVersionInAppConfig),
/* harmony export */   toCreateAppByDefaultTemplate: () => (/* binding */ toCreateAppByDefaultTemplate),
/* harmony export */   updateHistoryLabels: () => (/* binding */ updateHistoryLabels),
/* harmony export */   updateItemDataInApp: () => (/* binding */ updateItemDataInApp),
/* harmony export */   updateThumbnail: () => (/* binding */ updateThumbnail),
/* harmony export */   updateThumbnailForSaveAsApp: () => (/* binding */ updateThumbnailForSaveAsApp),
/* harmony export */   updateTypeKeywords: () => (/* binding */ updateTypeKeywords),
/* harmony export */   uploadResource: () => (/* binding */ uploadResource)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _rest_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rest-service */ "./jimu-for-builder/lib/service/rest-service.tsx");
/* harmony import */ var _translations_default__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../translations/default */ "./jimu-for-builder/lib/translations/default.ts");
/* harmony import */ var _type__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../type */ "./jimu-for-builder/lib/service/type/index.ts");
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index */ "./jimu-for-builder/lib/service/app-service/index.ts");
/* harmony import */ var _local_rest_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../local-rest-service */ "./jimu-for-builder/lib/service/local-rest-service/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable camelcase */






const request = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.request;
function isPortalApp(appInfo) {
    var _a, _b;
    if (!(appInfo === null || appInfo === void 0 ? void 0 : appInfo.portalUrl)) {
        return !window.jimuConfig.isDevEdition;
    }
    const appPortalUrl = (appInfo === null || appInfo === void 0 ? void 0 : appInfo.portalUrl) || '';
    const portalUrl = ((_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)()) === null || _a === void 0 ? void 0 : _a.getState()) === null || _b === void 0 ? void 0 : _b.portalUrl) || '';
    const isSamePortal = (portalUrl === null || portalUrl === void 0 ? void 0 : portalUrl.includes(appPortalUrl)) || (appPortalUrl === null || appPortalUrl === void 0 ? void 0 : appPortalUrl.includes(portalUrl));
    if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isAGOLDomain(appPortalUrl) && jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isAGOLDomain(portalUrl)) {
        return !isLocalApp(appInfo);
    }
    else {
        return isSamePortal && !isLocalApp(appInfo);
    }
}
function isAGOLApp(appInfo) {
    if (!(appInfo === null || appInfo === void 0 ? void 0 : appInfo.portalUrl)) {
        return false;
    }
    const appPortalUrl = (appInfo === null || appInfo === void 0 ? void 0 : appInfo.portalUrl) || '';
    const isPortalAGOL = jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isAGOLDomain(appPortalUrl);
    const isNotPortalApp = !isPortalApp(appInfo);
    const isNotLocalApp = !isLocalApp(appInfo);
    return isNotPortalApp && isNotLocalApp && isPortalAGOL;
}
function isLocalApp(appInfo) {
    const appPortalUrl = (appInfo === null || appInfo === void 0 ? void 0 : appInfo.portalUrl) || '';
    if (appPortalUrl.endsWith('localhost:')) {
        return true;
    }
    return appInfo.isLocalApp;
}
function getSession(appInfo) {
    if (isLocalApp(appInfo)) {
        return {};
    }
    const portalSession = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
    const session = isPortalApp(appInfo) ? portalSession : {};
    return session;
}
function getSessionBySearchType(searchType) {
    let session;
    const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    const portalSession = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
    const isAGOLDomain = jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isAGOLDomain(portalUrl);
    switch (searchType) {
        case _type__WEBPACK_IMPORTED_MODULE_3__.SearchType.Portal:
            session = portalSession;
            break;
        case _type__WEBPACK_IMPORTED_MODULE_3__.SearchType.AGOL:
            session = isAGOLDomain ? portalSession : {};
            break;
        case _type__WEBPACK_IMPORTED_MODULE_3__.SearchType.Other:
            session = window.jimuConfig.isDevEdition ? {} : portalSession;
            break;
    }
    return session;
}
function getNewAppTitleWithIndex(title, isCopy = false, type = '') {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        let newTitle = null;
        const appType = !(type === null || type === void 0 ? void 0 : type.includes('Template'))
            ? _type__WEBPACK_IMPORTED_MODULE_3__.AppType.ExperienceType
            : _type__WEBPACK_IMPORTED_MODULE_3__.AppType.TemplateType;
        return yield (0,_index__WEBPACK_IMPORTED_MODULE_4__.searchApp)({
            q: `type: "${appType}" AND owner:${session === null || session === void 0 ? void 0 : session.username} AND  title:"${title}"`,
            sortField: 'modified',
            sortOrder: 'desc'
        }, _type__WEBPACK_IMPORTED_MODULE_3__.SearchType.Other)
            .then((result) => __awaiter(this, void 0, void 0, function* () {
            const apps = result.results;
            if (apps && apps.length > 0) {
                const index = getMaxIndex(apps, title);
                newTitle = getAppName(title, apps, index, isCopy);
                return yield Promise.resolve(newTitle);
            }
            else {
                newTitle = isCopy ? title : `${title} 1`;
                return yield Promise.resolve(newTitle);
            }
        }))
            .catch((err) => __awaiter(this, void 0, void 0, function* () {
            console.error(err);
            return yield Promise.reject(err);
        }));
    });
}
function duplicateRelatedDataInApp(newAppId, originalAppInfo, isCreateNew = false) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield updateItemDataInApp(newAppId).then((result) => __awaiter(this, void 0, void 0, function* () {
            if (!result) {
                return yield Promise.reject(null);
            }
            if (isCreateNew) {
                return yield duplicateResourcesForCreateNew(newAppId, originalAppInfo);
            }
            else {
                return yield duplicateResourcesForDuplicate(newAppId, originalAppInfo);
            }
        }), (err) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject(err);
        }));
    });
}
function updateTypeKeywords(typeKeywords, appConfigVersion) {
    let isHavePublishStatus = false;
    let haveUpdatePublishVersion = false;
    const newTypeKeywords = typeKeywords.map(el => {
        if (el.includes('status:')) {
            isHavePublishStatus = true;
            return `status: ${_type__WEBPACK_IMPORTED_MODULE_3__.PublishStatus.Published}`;
        }
        if (el.includes('publishVersion:') && appConfigVersion) {
            haveUpdatePublishVersion = true;
            return `publishVersion:${appConfigVersion}`;
        }
        return el;
    });
    if (!isHavePublishStatus) {
        const keyworlds = `status: ${_type__WEBPACK_IMPORTED_MODULE_3__.PublishStatus.Published}`;
        newTypeKeywords.push(keyworlds);
    }
    if (!haveUpdatePublishVersion && appConfigVersion) {
        newTypeKeywords.push(`publishVersion:${appConfigVersion}`);
    }
    return newTypeKeywords;
}
function toCreateAppByDefaultTemplate(appInfo, folderId) {
    return __awaiter(this, void 0, void 0, function* () {
        const itemInfo = {
            title: appInfo === null || appInfo === void 0 ? void 0 : appInfo.name,
            type: (appInfo === null || appInfo === void 0 ? void 0 : appInfo.type) || 'Web Experience',
            typeKeywords: [
                'EXB Experience',
                'Ready To Use',
                'JavaScript',
                'status: Draft',
                `version:${jimu_core__WEBPACK_IMPORTED_MODULE_0__.version}`
            ],
            snippet: (appInfo === null || appInfo === void 0 ? void 0 : appInfo.snippet) || '',
            description: (appInfo === null || appInfo === void 0 ? void 0 : appInfo.description) || '',
            tags: (appInfo === null || appInfo === void 0 ? void 0 : appInfo.tags) || [],
            data: { __not_publish: true }
            // thumbnailUrl:appInfo.thumbnailUrl
        };
        const checkExist = () => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(false);
        });
        return yield checkExist().then(function (exist) {
            return __awaiter(this, void 0, void 0, function* () {
                if (exist) {
                    return yield Promise.reject('app existed.');
                }
                return yield createApp(itemInfo, folderId);
            });
        });
    });
}
function updateItemDataInApp(newAppId) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.updateItem)({
            item: {
                id: newAppId,
                owner: session === null || session === void 0 ? void 0 : session.username,
                text: '',
                data: { __not_publish: true }
                // data: newData
            },
            authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession()
        }).then(() => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(true);
        }), (error) => __awaiter(this, void 0, void 0, function* () {
            console.error(error);
            return yield Promise.reject(error);
        }));
    });
}
function duplicateResourcesInApp(newAppId, originalAppInfo, isCreateNew = false, updateAppConfigVersion = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = getSession(originalAppInfo);
        return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.getItemResources)(originalAppInfo, {
            authentication: session
        }).then((resourceResults) => __awaiter(this, void 0, void 0, function* () {
            const resourcePromises = [];
            const portalResources = resourceResults && resourceResults.resources;
            let isAppHasConfig = false;
            if (portalResources) {
                for (let i = 0; i < portalResources.length; i++) {
                    const isConfig = portalResources[i].resource === 'config/config.json';
                    // Use published version of a template when create an app from a template
                    if (isCreateNew && isConfig) {
                        continue;
                    }
                    // If an app has no config, it cannot be duplicate
                    if (isConfig) {
                        isAppHasConfig = true;
                    }
                    resourcePromises.push(uploadResource(newAppId, originalAppInfo, portalResources[i], updateAppConfigVersion));
                }
            }
            if (isAppHasConfig || isCreateNew) {
                return yield Promise.all(resourcePromises);
            }
            else {
                return yield Promise.resolve(null);
            }
        }), 
        // eslint-disable-next-line
        (err) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(null);
        }));
    });
}
function duplicateResourcesForCreateNew(newAppId, originalAppInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield duplicatePublishedAppsConfig(newAppId, originalAppInfo).then((res) => __awaiter(this, void 0, void 0, function* () {
            return yield duplicateResourcesInApp(newAppId, originalAppInfo, true).then((resourceResult) => __awaiter(this, void 0, void 0, function* () {
                if (resourceResult) {
                    return yield Promise.resolve(true);
                }
                else {
                    return yield Promise.reject('Resource does not exist or is inaccessible');
                }
            }), (err) => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.reject(err);
            }));
        }));
    });
}
function duplicateResourcesForDuplicate(newAppId, originalAppInfo, updateAppConfigVersion = false) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield duplicateResourcesInApp(newAppId, originalAppInfo, false, updateAppConfigVersion).then((resourceResult) => __awaiter(this, void 0, void 0, function* () {
            if (resourceResult) {
                return yield Promise.resolve(true);
            }
            else {
                return yield Promise.reject('Resource does not exist or is inaccessible');
            }
        }), (err) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject(err);
        }));
    });
}
function duplicatePublishedAppsConfig(newAppId, originalAppInfo) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_index__WEBPACK_IMPORTED_MODULE_4__.getAppConfig)(originalAppInfo).then((data) => __awaiter(this, void 0, void 0, function* () {
            const newConfigData = initAppConfigPortalUrl(data, originalAppInfo);
            newConfigData.template = originalAppInfo === null || originalAppInfo === void 0 ? void 0 : originalAppInfo.id;
            /**
             * Proxy is connected to item id, proxy created in item A cannot be used in item B.
             * So delete app proxies when duplicate items.
             */
            delete newConfigData.appProxies;
            delete newConfigData.historyLabels;
            const portalUrl = window.jimuConfig.isDevEdition ? 'localhost:' : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
            const session = getSession({ portalUrl: portalUrl });
            if (data === null || data === void 0 ? void 0 : data.__not_publish) {
                return yield Promise.reject('This item is not published');
            }
            const file = new Blob([JSON.stringify(newConfigData)], {
                type: 'application/json'
            });
            return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.addItemResource)({
                id: newAppId,
                resource: file,
                name: 'config.json',
                params: {
                    resourcesPrefix: 'config'
                },
                authentication: session
            }).then(() => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.resolve(true);
            }), (error) => __awaiter(this, void 0, void 0, function* () {
                console.error(error);
                return yield Promise.reject(error);
            }));
        }), 
        // eslint-disable-next-line
        (err) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject('Resource does not exist or is inaccessible');
        }));
    });
}
function updateThumbnail(newAppId, originalAppInfo, thumbnail) {
    return __awaiter(this, void 0, void 0, function* () {
        const portalUrl = window.jimuConfig.isDevEdition ? 'localhost:' : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
        const session = getSession({ portalUrl: portalUrl });
        const originalAppSession = getSession(originalAppInfo);
        if (thumbnail) {
            const portalThumbnailUrl = `${getResourceOrigin(originalAppInfo)}${originalAppInfo.id}/info/${thumbnail}?token=${originalAppSession === null || originalAppSession === void 0 ? void 0 : originalAppSession.token}`;
            const devThumbnailUrl = `${getResourceOrigin(originalAppInfo)}${originalAppInfo.id}/${thumbnail}`;
            let thumbnailUrl;
            if (thumbnail === null || thumbnail === void 0 ? void 0 : thumbnail.startsWith('blob:')) {
                thumbnailUrl = thumbnail;
            }
            else if (thumbnail === null || thumbnail === void 0 ? void 0 : thumbnail.includes('http')) {
                thumbnailUrl = `${thumbnail}?token=${originalAppSession === null || originalAppSession === void 0 ? void 0 : originalAppSession.token}`;
            }
            else {
                thumbnailUrl = isPortalApp(originalAppInfo) ? portalThumbnailUrl : devThumbnailUrl;
            }
            return yield new Promise(function (resolve, reject) {
                const xhr = new XMLHttpRequest();
                xhr.open('GET', thumbnailUrl, true);
                xhr.responseType = 'blob';
                xhr.onload = function (e) {
                    if (this.status === 200) {
                        const blob = this.response;
                        return (0,_index__WEBPACK_IMPORTED_MODULE_4__.updateAppThumbnail)({
                            id: newAppId,
                            thumbnail: blob,
                            f: 'json',
                            token: session === null || session === void 0 ? void 0 : session.token
                        }).then(() => {
                            resolve(true);
                        }, () => {
                            reject(false);
                        });
                    }
                    else {
                        reject(false);
                    }
                };
                xhr.onerror = function (e) {
                    reject();
                };
                xhr.send();
            });
        }
        else {
            return Promise.resolve(true);
        }
    });
}
function uploadResource(newAppId, originalAppInfo, resourceInfo, updateAppConfigVersion = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const originalAppSession = getSession(originalAppInfo);
        const token = isPortalApp(originalAppInfo) ? `?token=${originalAppSession === null || originalAppSession === void 0 ? void 0 : originalAppSession.token}` : '';
        const portalUrlPrefix = `${getResourceOrigin(originalAppInfo)}${originalAppInfo.id}/resources/`;
        const portalUrl = window.jimuConfig.isDevEdition ? 'localhost:' : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
        const session = getSession({ portalUrl: portalUrl });
        if (resourceInfo.resource === 'config/config.json' ||
            resourceInfo.resource === 'images/image-resources-list.json') {
            const resourceUrl = portalUrlPrefix + resourceInfo.resource + token;
            return yield fetch(resourceUrl, { cache: 'no-cache' })
                .then((res) => __awaiter(this, void 0, void 0, function* () { return yield res.json(); }))
                .then((data) => __awaiter(this, void 0, void 0, function* () {
                // If an app's config.json or image-resources-list.json is not obtained successfully, it cannot be duplicate
                const isConfig = resourceInfo.resource === 'config/config.json';
                const newAppData = isConfig ? initAppConfigPortalUrl(data, originalAppInfo) : data;
                return yield replaceConfigWithNewAppID(newAppId, originalAppInfo.id, newAppData).then((newData) => __awaiter(this, void 0, void 0, function* () {
                    var _a;
                    /**
                     * Proxy is connected to item id, proxy created in item A cannot be used in item B.
                     * So delete app proxies when duplicate items.
                     */
                    delete newData.appProxies;
                    delete newData.historyLabels;
                    if (isConfig) {
                        if (updateAppConfigVersion) {
                            //Update app version and widget version to current ExbVersion
                            newData = (_a = replaceExbVersionInAppConfig((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(newData))) === null || _a === void 0 ? void 0 : _a.asMutable({ deep: true });
                        }
                        const date = new Date();
                        const utcTimeStamp = date.getTime();
                        newData.timestamp = `${utcTimeStamp}`;
                    }
                    const file = new Blob([JSON.stringify(newData)], {
                        type: 'application/json'
                    });
                    return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.addItemResource)({
                        id: newAppId,
                        resource: file,
                        name: resourceInfo.resource.split('/')[resourceInfo.resource.split('/').length - 1],
                        params: {
                            resourcesPrefix: resourceInfo.resource
                                .split('/')
                                .slice(0, resourceInfo.resource.split('/').length - 1)
                                .join('/')
                        },
                        authentication: session
                    }).then(() => __awaiter(this, void 0, void 0, function* () {
                        return yield Promise.resolve(true);
                    }), (error) => __awaiter(this, void 0, void 0, function* () {
                        console.error(error);
                        return yield Promise.reject(error);
                    }));
                }));
            }))
                .catch((error) => __awaiter(this, void 0, void 0, function* () {
                console.error(error);
                return yield Promise.reject(error);
            }));
        }
        else {
            const resourceUrl = portalUrlPrefix + resourceInfo.resource + token;
            return yield new Promise(function (resolve, reject) {
                const xhr = new XMLHttpRequest();
                xhr.open('GET', resourceUrl, true);
                xhr.responseType = 'blob';
                xhr.onload = function (e) {
                    if (this.status === 200) {
                        const blob = this.response;
                        return (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.addItemResource)({
                            id: newAppId,
                            resource: blob,
                            name: resourceInfo.resource.split('/')[resourceInfo.resource.split('/').length - 1],
                            params: {
                                resourcesPrefix: resourceInfo.resource
                                    .split('/')
                                    .slice(0, resourceInfo.resource.split('/').length - 1)
                                    .join('/')
                            },
                            authentication: session
                        }).then(() => {
                            resolve(true);
                        }, () => {
                            resolve(false);
                        });
                    }
                    else {
                        resolve(false);
                    }
                };
                xhr.onerror = function (e) {
                    resolve(false);
                };
                xhr.send();
            });
        }
    });
}
function initAppConfigPortalUrl(appConfig, originalAppInfo) {
    var _a;
    const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    appConfig.attributes && (appConfig.attributes.portalUrl = portalUrl);
    const dataSources = appConfig === null || appConfig === void 0 ? void 0 : appConfig.dataSources;
    if (dataSources && isAGOLApp(originalAppInfo)) {
        for (const key in dataSources) {
            const dataSourcesPortalUrl = (_a = dataSources[key]) === null || _a === void 0 ? void 0 : _a.portalUrl;
            if (isUpdateDataSourcesPortalUrl(dataSourcesPortalUrl)) {
                dataSources[key].portalUrl = portalUrl;
            }
        }
    }
    return appConfig;
}
function isUpdateDataSourcesPortalUrl(dataSourcesPortalUrl) {
    let isCanUpdate = false;
    const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    if (isSamePortal(portalUrl, dataSourcesPortalUrl, 'mapsdevext.arcgis.com') ||
        isSamePortal(portalUrl, dataSourcesPortalUrl, 'mapsqa.arcgis.com') ||
        isSamePortal(portalUrl, dataSourcesPortalUrl, 'maps.arcgis.com')) {
        isCanUpdate = true;
    }
    return isCanUpdate;
}
function isSamePortal(portalUrl, dataSourcesPortalUrl, urlEndString) {
    const isSamePortal = ((portalUrl === null || portalUrl === void 0 ? void 0 : portalUrl.endsWith(urlEndString)) ||
        (portalUrl === null || portalUrl === void 0 ? void 0 : portalUrl.endsWith(`${urlEndString}/`))) &&
        ((dataSourcesPortalUrl === null || dataSourcesPortalUrl === void 0 ? void 0 : dataSourcesPortalUrl.endsWith(urlEndString)) ||
            (dataSourcesPortalUrl === null || dataSourcesPortalUrl === void 0 ? void 0 : dataSourcesPortalUrl.endsWith(`${urlEndString}/`)));
    return isSamePortal;
}
function crateAppByApp(appInfo, isCreateTemplate, folderId) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield (0,_index__WEBPACK_IMPORTED_MODULE_4__.getAppInfo)(appInfo).then((appItem) => __awaiter(this, void 0, void 0, function* () {
            if (appItem) {
                const type = isCreateTemplate
                    ? _type__WEBPACK_IMPORTED_MODULE_3__.AppType.TemplateType
                    : _type__WEBPACK_IMPORTED_MODULE_3__.AppType.ExperienceType;
                return yield getNewAppTitleWithIndex(appItem.title).then((newTitle) => __awaiter(this, void 0, void 0, function* () {
                    if (newTitle) {
                        const duplicateAppInfo = {
                            name: newTitle,
                            tags: appItem.tags,
                            thumbnail: appItem.thumbnail,
                            type: type,
                            typeKeywords: appInfo === null || appInfo === void 0 ? void 0 : appInfo.typeKeywords
                        };
                        return yield createAppForDuplicate(duplicateAppInfo, folderId).then((newAppItem) => __awaiter(this, void 0, void 0, function* () {
                            if (newAppItem) {
                                return yield duplicateRelatedDataInApp(newAppItem.id, appInfo, !isCreateTemplate).then(() => __awaiter(this, void 0, void 0, function* () {
                                    return yield Promise.resolve(newAppItem.id);
                                }), (error) => __awaiter(this, void 0, void 0, function* () {
                                    console.error(error);
                                    (0,_index__WEBPACK_IMPORTED_MODULE_4__.deleteApp)(newAppItem.id);
                                    return yield Promise.reject(error);
                                }));
                            }
                            else {
                                return yield Promise.reject(null);
                            }
                        }));
                    }
                    else {
                        return yield Promise.reject(null);
                    }
                }));
            }
            else {
                return yield Promise.reject(null);
            }
        }));
    });
}
function initDuplicatedTypeKeywords(typeKeywords) {
    const itemVersion = `version:${jimu_core__WEBPACK_IMPORTED_MODULE_0__.version}`;
    if (!typeKeywords || typeKeywords.length === 0) {
        return [
            'EXB Experience',
            'Ready To Use',
            'JavaScript',
            'status: Draft',
            itemVersion
        ];
    }
    let isHasStatus = false;
    let isHasVersion = false;
    const newTypeKeywords = typeKeywords.map(el => {
        if (el.includes('version:')) {
            isHasVersion = true;
        }
        if (!el.includes('status:')) {
            return el;
        }
        else {
            isHasStatus = true;
            return 'status: Draft';
        }
    });
    !isHasStatus && newTypeKeywords.push('status: Draft');
    !isHasVersion && newTypeKeywords.push(itemVersion);
    return newTypeKeywords;
}
function getMaxIndex(appList, name) {
    const indexData = [];
    const reg = /^[\d]+$/;
    appList.forEach(el => {
        var _a, _b;
        const index = (_b = (_a = el.title) === null || _a === void 0 ? void 0 : _a.split(`${name} `)[1]) === null || _b === void 0 ? void 0 : _b.split(' ')[0];
        if (reg.test(index)) {
            indexData.push(Number(index));
        }
    });
    indexData.sort(function (a, b) {
        return a < b ? 1 : -1;
    });
    return indexData[0] || 1;
}
function getAppName(name, appList, index = 1, isCopy = false) {
    const appName = index === 1 && isCopy ? name : `${name} ${index}`;
    if (!isAppNameRepeat(appName, appList)) {
        return appName;
    }
    const _index = index + 1;
    return getAppName(name, appList, _index);
}
function isAppNameRepeat(name, appList) {
    let isHasName = false;
    appList.forEach(el => {
        if (name === el.title) {
            isHasName = true;
        }
    });
    return isHasName;
}
function replaceConfigWithNewAppID(newAppId, originalAppId, config) {
    return __awaiter(this, void 0, void 0, function* () {
        const portalUrlPrefix = getResourceOrigin(originalAppId) + originalAppId + '/resources/';
        const isPortalResourceExp = new RegExp('^' + portalUrlPrefix);
        function isPortalResources(value) {
            return isPortalResourceExp.test(value);
        }
        function matchHandle(value) {
            const newValue = value.replace('/' + originalAppId + '/', '/' + newAppId + '/');
            return newValue;
        }
        const replaceOperator = {
            matcher: isPortalResources,
            handler: matchHandle
        };
        return Promise.resolve(jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceStringInObject(config, replaceOperator));
    });
}
function createAppCallBack(defaultAppConfigs, item, webmapId, websceneId) {
    return __awaiter(this, void 0, void 0, function* () {
        const AppResourceManager = jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.getModuleSync('jimu-for-builder')
            .AppResourceManager;
        const appResourceManagerInstance = AppResourceManager.getInstance();
        const itemId = item.id;
        let defaultAppConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceI18nPlaceholdersInObject(defaultAppConfigs, jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl(), _translations_default__WEBPACK_IMPORTED_MODULE_2__["default"]);
        defaultAppConfig = initAppConfig(defaultAppConfig);
        jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.addWebmapOrWebsceneToAppConfig(defaultAppConfig, webmapId, websceneId);
        return appResourceManagerInstance
            .upLoadAppConfig(itemId.toString(), defaultAppConfig)
            .then(() => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(item);
        }));
    });
}
function createAppForDuplicate(appInfo, folderId) {
    return __awaiter(this, void 0, void 0, function* () {
        const itemInfo = {
            title: appInfo.name,
            type: appInfo.type || 'Web Experience',
            typeKeywords: initDuplicatedTypeKeywords(appInfo === null || appInfo === void 0 ? void 0 : appInfo.typeKeywords),
            snippet: (appInfo === null || appInfo === void 0 ? void 0 : appInfo.snippet) || '',
            description: (appInfo === null || appInfo === void 0 ? void 0 : appInfo.description) || '',
            tags: appInfo.tags,
            thumbnail: appInfo.thumbnail
            // thumbnailUrl:appInfo.thumbnailUrl
        };
        return yield createApp(itemInfo, folderId);
    });
}
function getPreviewUrl(appInfo) {
    const { type, id } = appInfo;
    const { isDevEdition, isInPortal, hostEnv } = window.jimuConfig;
    const isTemplate = type === _type__WEBPACK_IMPORTED_MODULE_3__.AppType.TemplateType;
    const isArcGisOnlineApp = !isDevEdition && !isInPortal;
    if (isDevEdition) {
        return null;
    }
    let previewUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlUtils.getAppUrl({ appId: id, isTemplate: isTemplate });
    if (isArcGisOnlineApp) {
        switch (hostEnv) {
            case 'prod':
                previewUrl = `https://experience.arcgis.com${previewUrl}`;
                break;
            case 'dev':
                previewUrl = `https://experiencedev.arcgis.com${previewUrl}`;
                break;
            case 'qa':
                previewUrl = `https://experienceqa.arcgis.com${previewUrl}`;
                break;
        }
    }
    if (isInPortal) {
        previewUrl = `${window.location.origin}${previewUrl}`;
    }
    return previewUrl;
}
function getAppConfigInResources(appId) {
    return __awaiter(this, void 0, void 0, function* () {
        const sessionManager = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance();
        const timestamp = new Date().getTime();
        if (window.jimuConfig.isDevEdition) {
            return yield window.fetch(`/apps/${appId}/resources/config/config.json`).then((res) => __awaiter(this, void 0, void 0, function* () { return yield res.json(); }));
        }
        else {
            return yield request(`${jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPortalRestUrl((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl)}/content/items/${appId}/resources/config/config.json`, {
                authentication: sessionManager.getSessionByUrl((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl),
                httpMethod: 'GET',
                params: {
                    timestamp: timestamp
                }
            }).catch((err) => __awaiter(this, void 0, void 0, function* () {
                return Promise.reject(err);
            }));
        }
    });
}
function getCreateAppParamsByAppId(templateId) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield checkIsPortalApp(templateId).then((portalAppInfo) => __awaiter(this, void 0, void 0, function* () {
            // Check is portal app
            return yield Promise.resolve(portalAppInfo);
            // eslint-disable-next-line
        })).catch((err) => __awaiter(this, void 0, void 0, function* () {
            // Check is AGOL app
            return yield checkIsAGOLApp(templateId).then((AGOLAppInfo) => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.resolve(AGOLAppInfo);
                // eslint-disable-next-line
            })).catch((err) => __awaiter(this, void 0, void 0, function* () {
                // Check is local app
                return yield checkIsLocalApp(templateId);
            }));
        }));
    });
}
function checkIsPortalApp(templateId) {
    return __awaiter(this, void 0, void 0, function* () {
        const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
        const getAppInfoParams = {
            id: templateId,
            portalUrl: portalUrl,
            isLocalApp: false
        };
        return yield (0,_index__WEBPACK_IMPORTED_MODULE_4__.getAppInfo)(getAppInfoParams).then((appInfo) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(getAppInfoParams);
            // eslint-disable-next-line
        })).catch((err) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject('Item does not exist or is inaccessible.');
        }));
    });
}
function checkIsLocalApp(templateId) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!window.jimuConfig.isDevEdition) {
            return yield Promise.reject('Item does not exist or is inaccessible.');
        }
        else {
            const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
            const getAppInfoParams = {
                id: templateId,
                portalUrl: portalUrl,
                isLocalApp: true
            };
            return yield (0,_index__WEBPACK_IMPORTED_MODULE_4__.getAppInfo)(getAppInfoParams).then((localAppInfo) => __awaiter(this, void 0, void 0, function* () {
                if (!(localAppInfo === null || localAppInfo === void 0 ? void 0 : localAppInfo.success)) {
                    return yield Promise.reject('Item does not exist or is inaccessible.');
                }
                else {
                    return yield Promise.resolve(getAppInfoParams);
                }
                // eslint-disable-next-line
            })).catch((err) => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.reject('Item does not exist or is inaccessible.');
            }));
        }
    });
}
function checkIsAGOLApp(templateId) {
    return __awaiter(this, void 0, void 0, function* () {
        const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
        if (jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isAGOLDomain(portalUrl)) {
            return yield Promise.reject(false);
        }
        const getAppInfoParams = {
            id: templateId,
            portalUrl: 'https://maps.arcgis.com',
            isLocalApp: false
        };
        return yield (0,_index__WEBPACK_IMPORTED_MODULE_4__.getAppInfo)(getAppInfoParams).then((localAppInfo) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.resolve(getAppInfoParams);
            // eslint-disable-next-line
        })).catch((err) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject('Item does not exist or is inaccessible.');
        }));
    });
}
function getConfigFromPortalItemResource(appID) {
    return __awaiter(this, void 0, void 0, function* () {
        const sessionManager = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance();
        const timestamp = new Date().getTime();
        return yield request(`${jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPortalRestUrl((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl)}/content/items/${appID}/resources/config/config.json`, {
            authentication: sessionManager.getSessionByUrl((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl),
            httpMethod: 'GET',
            params: {
                timestamp: timestamp
            }
        }).catch((err) => __awaiter(this, void 0, void 0, function* () {
            return yield Promise.reject(null);
        }));
    });
}
function getResourceOrigin(originalAppInfo) {
    const portalUrl = isAGOLApp(originalAppInfo) ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlUtils.getArcgisOnlineUrl() : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    const isLocalAppResourceOrigin = originalAppInfo === null || originalAppInfo === void 0 ? void 0 : originalAppInfo.isLocalApp;
    if (isLocalAppResourceOrigin) {
        // local app`s resource origin in devEdtion
        return _local_rest_service__WEBPACK_IMPORTED_MODULE_5__.getOriginUrl() + '/apps/';
    }
    else {
        return (jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPlatformUrlByOrgUrl(portalUrl) +
            '/sharing/rest/content/items/');
    }
}
function createApp(appInfo, folderId) {
    return __awaiter(this, void 0, void 0, function* () {
        if (folderId) {
            return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.createAppInFolder)({
                item: appInfo,
                folderId: folderId,
                authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession()
            });
        }
        else {
            return yield (0,_rest_service__WEBPACK_IMPORTED_MODULE_1__.createItem)({
                item: appInfo,
                authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession()
            });
        }
    });
}
function initAppConfig(appConfig) {
    if (!appConfig.attributes) {
        appConfig.attributes = {};
    }
    if (!appConfig.widgets) {
        appConfig.widgets = {};
    }
    if (!appConfig.widgetsManifest) {
        appConfig.widgetsManifest = {};
    }
    if (!appConfig.views) {
        appConfig.views = {};
    }
    if (!appConfig.sections) {
        appConfig.sections = {};
    }
    if (!appConfig.dialogs) {
        appConfig.dialogs = {};
    }
    if (!appConfig.pages) {
        appConfig.pages = {};
    }
    if (!appConfig.layouts) {
        appConfig.layouts = {};
    }
    if (!appConfig.dataSources) {
        appConfig.dataSources = {};
    }
    if (!appConfig.messageConfigs) {
        appConfig.messageConfigs = {};
    }
    return appConfig;
}
function optimizeWidgetsConfig(appConfig, appInfo) {
    Object.values(appConfig.widgets).forEach((json) => {
        if (json.uri === 'widgets/common/text/') {
            optimizeTextWidgetConfig(json.config, appInfo);
        }
    });
    return appConfig;
}
function optimizeTextWidgetConfig(config, appInfo) {
    const isTemplate = appInfo.type === _type__WEBPACK_IMPORTED_MODULE_3__.AppType.TemplateType;
    //Do not remove placeholder for template type app
    if (isTemplate)
        return config;
    //Placeholder are useless at run time if display text is configured.
    if (!isBlankRichText(config === null || config === void 0 ? void 0 : config.text)) {
        delete config.placeholder;
    }
    return config;
}
/**
 * Update the history labels in draft app config, then return the draft app config
 * @param draftAppConfig
 * @param publishedAppConfig
 */
function updateHistoryLabels(draftAppConfig, publishedAppConfig) {
    if (publishedAppConfig.__not_publish) {
        return draftAppConfig;
    }
    // remove ids that are not existed
    if (draftAppConfig.historyLabels) {
        removeNonExistIds(draftAppConfig, 'pages');
        removeNonExistIds(draftAppConfig, 'views');
        removeNonExistIds(draftAppConfig, 'dialogs');
    }
    addHisLabels(draftAppConfig, publishedAppConfig, 'pages');
    addHisLabels(draftAppConfig, publishedAppConfig, 'views');
    addHisLabels(draftAppConfig, publishedAppConfig, 'dialogs');
    return draftAppConfig;
}
function updateThumbnailForSaveAsApp(originAppInfo, newAppInfo, thumbnailFiles) {
    return __awaiter(this, void 0, void 0, function* () {
        if (thumbnailFiles) {
            const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
            const localAppItem = {
                id: newAppInfo.id,
                f: 'json',
                token: session === null || session === void 0 ? void 0 : session.token,
                thumbnail: thumbnailFiles
            };
            yield (0,_index__WEBPACK_IMPORTED_MODULE_4__.updateAppThumbnail)(localAppItem, newAppInfo.owner);
        }
        else {
            return yield updateThumbnail(newAppInfo.id, originAppInfo, (originAppInfo === null || originAppInfo === void 0 ? void 0 : originAppInfo.thumbnailurl) || originAppInfo.thumbnail);
        }
    });
}
/**
 * Deep clone. But only clone two levels.
 * And param must be Object.
 */
function cloneObj(obj) {
    const result = {};
    Object.keys(obj).forEach(id => {
        result[id] = Object.assign({}, obj[id]);
    });
    return result;
}
function removeNonExistIds(appConfig, type) {
    const his = appConfig.historyLabels;
    Object.keys(his[type] || {}).forEach(hisId => {
        var _a;
        if (!((_a = appConfig[type]) === null || _a === void 0 ? void 0 : _a[hisId])) {
            delete his[type][hisId];
        }
    });
}
function addHisLabels(draftAppConfig, publishedAppConfig, type) {
    const draftObj = draftAppConfig[type];
    const publishedObj = publishedAppConfig[type];
    if (!draftObj || !publishedObj) {
        return;
    }
    Object.keys(draftObj).forEach(id => {
        var _a, _b;
        const hisLabels = ((_b = (_a = publishedAppConfig.historyLabels) === null || _a === void 0 ? void 0 : _a[type]) === null || _b === void 0 ? void 0 : _b[id]) || [];
        if (publishedObj[id] && draftObj[id].label !== publishedObj[id].label) {
            if (!hisLabels.includes(publishedObj[id].label)) {
                hisLabels.push(publishedObj[id].label);
            }
        }
        if (hisLabels.length > 0) {
            if (!draftAppConfig.historyLabels) {
                draftAppConfig.historyLabels = {
                    [type]: {
                        [id]: hisLabels
                    }
                };
            }
            else if (!draftAppConfig.historyLabels[type]) {
                draftAppConfig.historyLabels[type] = {
                    [id]: hisLabels
                };
            }
            else {
                draftAppConfig.historyLabels[type][id] = hisLabels;
            }
        }
    });
}
const HTML_TAG_REGEXP = /<[^>]*>/mg;
/**
 * Check whether is rich text with empty content.
 */
const isBlankRichText = (html) => {
    if (!html)
        return true;
    if (html === '<p></p>' || html === '<p><br></p>')
        return true;
    let plainText = '';
    if (!html.includes('<')) {
        plainText = html;
    }
    else {
        plainText = html.replace(HTML_TAG_REGEXP, '');
    }
    plainText = plainText === null || plainText === void 0 ? void 0 : plainText.trim();
    return !plainText;
};
function replaceExbVersionInAppConfig(appConfig) {
    var _a;
    if (!appConfig)
        return null;
    const isHigherVersionApp = jimu_core__WEBPACK_IMPORTED_MODULE_0__.semver.lt(jimu_core__WEBPACK_IMPORTED_MODULE_0__.version, appConfig === null || appConfig === void 0 ? void 0 : appConfig.exbVersion);
    if (isHigherVersionApp) {
        //downgrade app version
        appConfig = appConfig.set('exbVersion', jimu_core__WEBPACK_IMPORTED_MODULE_0__.version);
    }
    const config = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig;
    const widgets = config.widgets || {};
    Object.keys(widgets).forEach(widgetId => {
        var _a, _b, _c, _d, _e;
        //Manifest.version is the version of the current widget code,
        //When the version of the widget is higher than the current code version, it needs to be downgraded to be consistent with the manifest.version
        //For custom widgets, if the version they use is not consistent with ExbBuilder, it needs further discussion on how to deal with it
        const isHigherVersionWidget = jimu_core__WEBPACK_IMPORTED_MODULE_0__.semver.lt((_b = (_a = widgets[widgetId]) === null || _a === void 0 ? void 0 : _a.manifest) === null || _b === void 0 ? void 0 : _b.version, (_c = widgets[widgetId]) === null || _c === void 0 ? void 0 : _c.version);
        if (isHigherVersionWidget) {
            appConfig = appConfig.setIn(['widgets', widgetId, 'version'], (_e = (_d = widgets[widgetId]) === null || _d === void 0 ? void 0 : _d.manifest) === null || _e === void 0 ? void 0 : _e.version);
        }
    });
    return appConfig;
}
function initAppConfigOfNewApp(appConfig) {
    var _a, _b;
    if (appConfig.attributes) {
        appConfig.attributes.portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    }
    else {
        appConfig.attributes = {
            portalUrl: (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl
        };
    }
    const sharedThemeJson = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalSelf) === null || _a === void 0 ? void 0 : _a.portalProperties) === null || _b === void 0 ? void 0 : _b.sharedTheme;
    appConfig.sharedThemeVariables = jimu_core__WEBPACK_IMPORTED_MODULE_0__.sharedThemeUtils.createSharedThemeVariables(sharedThemeJson);
    return appConfig;
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/index.ts":
/*!************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/index.ts ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getGroupCategorySchema: () => (/* reexport safe */ _items_get_category_schema__WEBPACK_IMPORTED_MODULE_5__.getGroupCategorySchema),
/* harmony export */   getGroupContent: () => (/* reexport safe */ _items_get_user_content__WEBPACK_IMPORTED_MODULE_1__.getGroupContent),
/* harmony export */   getOrgCategorySchema: () => (/* reexport safe */ _items_get_category_schema__WEBPACK_IMPORTED_MODULE_5__.getOrgCategorySchema),
/* harmony export */   getUserContent: () => (/* reexport safe */ _items_get_user_content__WEBPACK_IMPORTED_MODULE_1__.getUserContent),
/* harmony export */   itemsgroups: () => (/* reexport safe */ _items_itemsgroups__WEBPACK_IMPORTED_MODULE_4__.itemsgroups),
/* harmony export */   shareItems: () => (/* reexport safe */ _items_share_items__WEBPACK_IMPORTED_MODULE_2__.shareItems),
/* harmony export */   unShareItems: () => (/* reexport safe */ _items_unshare_items__WEBPACK_IMPORTED_MODULE_3__.unShareItems),
/* harmony export */   updateItem: () => (/* reexport safe */ _items_update_thumbnail__WEBPACK_IMPORTED_MODULE_0__.updateItem)
/* harmony export */ });
/* harmony import */ var _items_update_thumbnail__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./items/update-thumbnail */ "./jimu-for-builder/lib/service/jimu-request/items/update-thumbnail.ts");
/* harmony import */ var _items_get_user_content__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./items/get-user-content */ "./jimu-for-builder/lib/service/jimu-request/items/get-user-content.ts");
/* harmony import */ var _items_share_items__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./items/share-items */ "./jimu-for-builder/lib/service/jimu-request/items/share-items.ts");
/* harmony import */ var _items_unshare_items__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./items/unshare-items */ "./jimu-for-builder/lib/service/jimu-request/items/unshare-items.ts");
/* harmony import */ var _items_itemsgroups__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./items/itemsgroups */ "./jimu-for-builder/lib/service/jimu-request/items/itemsgroups.ts");
/* harmony import */ var _items_get_category_schema__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./items/get-category-schema */ "./jimu-for-builder/lib/service/jimu-request/items/get-category-schema.ts");








/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/items/get-category-schema.ts":
/*!********************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/items/get-category-schema.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getGroupCategorySchema: () => (/* binding */ getGroupCategorySchema),
/* harmony export */   getOrgCategorySchema: () => (/* binding */ getOrgCategorySchema)
/* harmony export */ });
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/service/jimu-request/util.ts");
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-core */ "jimu-core");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function getGroupCategorySchema(groupId, requestOptions, isArcGisOnlineRequest = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getOriginUrl)(isArcGisOnlineRequest)}/sharing/rest/community/groups/${groupId}/categorySchema`;
        if (isArcGisOnlineRequest && !isPortalAGOL()) {
            delete requestOptions.authentication;
        }
        const options = Object.assign(Object.assign({}, requestOptions), { params: {
                id: groupId
            }, httpMethod: 'GET' });
        const request = jimu_core__WEBPACK_IMPORTED_MODULE_1__.esri.restRequest.request;
        return yield request(url, options);
    });
}
function getOrgCategorySchema(requestOptions, isArcGisOnlineRequest = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const orgId = (0,_util__WEBPACK_IMPORTED_MODULE_0__.getOriginId)(isArcGisOnlineRequest);
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getOriginUrl)(isArcGisOnlineRequest)}/sharing/rest/portals/${orgId}/categorySchema`;
        if (isArcGisOnlineRequest && !isPortalAGOL()) {
            delete requestOptions.authentication;
        }
        const options = Object.assign(Object.assign({}, requestOptions), { httpMethod: 'GET' });
        const request = jimu_core__WEBPACK_IMPORTED_MODULE_1__.esri.restRequest.request;
        return yield request(url, options);
    });
}
function isPortalAGOL() {
    const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_1__.getAppStore)().getState().portalUrl;
    return jimu_core__WEBPACK_IMPORTED_MODULE_1__.portalUrlUtils.isAGOLDomain(portalUrl);
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/items/get-user-content.ts":
/*!*****************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/items/get-user-content.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getGroupContent: () => (/* binding */ getGroupContent),
/* harmony export */   getUserContent: () => (/* binding */ getUserContent)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/jimu-request/request.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/service/jimu-request/util.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



function getUserContent(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        const url = `${(0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl}/sharing/rest/content/users/${session === null || session === void 0 ? void 0 : session.username}`;
        const requestOption = Object.assign(Object.assign({}, requestOptions.params), { f: 'json', token: session === null || session === void 0 ? void 0 : session.token });
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, requestOption, 'GET');
    });
}
function getGroupContent(groupId, requestOptions, isGetAGOLContent = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_2__.getOriginUrl)(isGetAGOLContent)}/sharing/rest/content/groups/${groupId}/search`;
        if (isGetAGOLContent && !(0,_util__WEBPACK_IMPORTED_MODULE_2__.isPortalAGOL)()) {
            delete requestOptions.authentication;
        }
        const options = Object.assign(Object.assign({}, requestOptions), { httpMethod: 'GET' });
        const request = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.request;
        return yield request(url, options);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/items/itemsgroups.ts":
/*!************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/items/itemsgroups.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   itemsgroups: () => (/* binding */ itemsgroups)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

function itemsgroups(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        const url = `${(0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl}/sharing/rest/content/itemsgroups`;
        const options = {
            params: requestOptions,
            httpMethod: 'GET',
            authentication: session
        };
        return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.request(url, options);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/items/share-items.ts":
/*!************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/items/share-items.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   shareItems: () => (/* binding */ shareItems)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/jimu-request/request.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function shareItems(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        const url = `${(0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl}/sharing/rest/content/items/${requestOptions.items}/share`;
        requestOptions = Object.assign(Object.assign({}, requestOptions), { f: 'json', token: session === null || session === void 0 ? void 0 : session.token });
        const keys = Object.keys(requestOptions);
        const data = new FormData();
        for (let i = 0; i < keys.length; i++) {
            data.append(keys[i], requestOptions[keys[i]]);
        }
        requestOptions = data;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, requestOptions);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/items/unshare-items.ts":
/*!**************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/items/unshare-items.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   unShareItems: () => (/* binding */ unShareItems)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/jimu-request/request.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function unShareItems(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        const url = `${(0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl}/sharing/rest/content/items/${requestOptions.items}/unshare`;
        requestOptions = Object.assign(Object.assign({}, requestOptions), { f: 'json', token: session === null || session === void 0 ? void 0 : session.token });
        const keys = Object.keys(requestOptions);
        const data = new FormData();
        for (let i = 0; i < keys.length; i++) {
            data.append(keys[i], requestOptions[keys[i]]);
        }
        requestOptions = data;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, requestOptions);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/items/update-thumbnail.ts":
/*!*****************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/items/update-thumbnail.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   updateItem: () => (/* binding */ updateItem)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/jimu-request/request.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function updateItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const session = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getMainSession();
        const owner = requestOptions.owner ? requestOptions.owner : session === null || session === void 0 ? void 0 : session.username;
        const url = `${(0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl}/sharing/rest/content/users/${owner}/items/${requestOptions.item.id}/update`;
        requestOptions.params = Object.assign(Object.assign({}, requestOptions.params), requestOptions.item);
        const keys = Object.keys(requestOptions.params);
        const data = new FormData();
        for (let i = 0; i < keys.length; i++) {
            data.append(keys[i], requestOptions.params[keys[i]]);
        }
        requestOptions.params = data;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, data);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/request.ts":
/*!**************************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/request.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   request: () => (/* binding */ request)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

const isWebTier = jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().isTrustedServer((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl);
function request(url, requestOptions = { f: 'json' }, requestType = 'POST') {
    return __awaiter(this, void 0, void 0, function* () {
        if (requestType === 'GET') {
            const requestUrl = url + encodeQueryString(requestOptions);
            return yield fetch(requestUrl, {
                credentials: isWebTier ? 'include' : 'same-origin',
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then((response) => __awaiter(this, void 0, void 0, function* () {
                return yield response.json();
            })).then((data) => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.resolve(data);
            }));
        }
        if (requestType === 'POST') {
            if (requestOptions && requestOptions.constructor.name === 'FormData') {
                return yield fetch(url, {
                    credentials: isWebTier ? 'include' : 'same-origin',
                    method: 'POST',
                    body: requestOptions
                }).then((response) => __awaiter(this, void 0, void 0, function* () {
                    return yield response.json();
                })).then((data) => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.resolve(data);
                }));
            }
            else {
                return yield fetch(url, {
                    credentials: isWebTier ? 'include' : 'same-origin',
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestOptions)
                }).then((response) => __awaiter(this, void 0, void 0, function* () {
                    return yield response.json();
                })).then((data) => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.resolve(data);
                }));
            }
        }
        return yield Promise.reject(null);
    });
}
function encodeQueryString(params) {
    if (!params) {
        return '';
    }
    const keys = Object.keys(params);
    return keys.length
        ? '?' + keys
            .map(key => encodeURIComponent(key) +
            '=' + encodeURIComponent(params[key]))
            .join('&')
        : '';
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/jimu-request/util.ts":
/*!***********************************************************!*\
  !*** ./jimu-for-builder/lib/service/jimu-request/util.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getOriginId: () => (/* binding */ getOriginId),
/* harmony export */   getOriginUrl: () => (/* binding */ getOriginUrl),
/* harmony export */   getUserContentUrl: () => (/* binding */ getUserContentUrl),
/* harmony export */   getUserName: () => (/* binding */ getUserName),
/* harmony export */   isPortalAGOL: () => (/* binding */ isPortalAGOL)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

function getOriginUrl(isArcGisOnlineRequest = false) {
    if (isArcGisOnlineRequest) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlUtils.getArcgisOnlineUrl();
    }
    else {
        return window.location.origin;
    }
}
function getUserContentUrl(isNotContainUsers = false) {
    if (isNotContainUsers) {
        return '/sharing/rest/content/';
    }
    else {
        return '/sharing/rest/content/users/';
    }
}
function getUserName() {
    var _a;
    return (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().user) === null || _a === void 0 ? void 0 : _a.username;
}
function getOriginId(isArcGisOnlineRequest = false) {
    var _a;
    if (isArcGisOnlineRequest) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlUtils.getArcgisOnlineOrgId();
    }
    else {
        return (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().user) === null || _a === void 0 ? void 0 : _a.orgId;
    }
}
function isPortalAGOL() {
    const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    return jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isAGOLDomain(portalUrl);
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/index.ts":
/*!******************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/index.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   addItemResource: () => (/* reexport safe */ _items_add__WEBPACK_IMPORTED_MODULE_5__.addItemResource),
/* harmony export */   checkItemVersion: () => (/* reexport safe */ _items_create__WEBPACK_IMPORTED_MODULE_1__.checkItemVersion),
/* harmony export */   createItem: () => (/* reexport safe */ _items_create__WEBPACK_IMPORTED_MODULE_1__.createItem),
/* harmony export */   getItem: () => (/* reexport safe */ _items_get__WEBPACK_IMPORTED_MODULE_2__.getItem),
/* harmony export */   getItemData: () => (/* reexport safe */ _items_get__WEBPACK_IMPORTED_MODULE_2__.getItemData),
/* harmony export */   getItemResource: () => (/* reexport safe */ _items_get__WEBPACK_IMPORTED_MODULE_2__.getItemResource),
/* harmony export */   getItemResources: () => (/* reexport safe */ _items_get__WEBPACK_IMPORTED_MODULE_2__.getItemResources),
/* harmony export */   getOriginUrl: () => (/* reexport safe */ _util__WEBPACK_IMPORTED_MODULE_7__.getOriginUrl),
/* harmony export */   getRequestMethod: () => (/* reexport safe */ _util__WEBPACK_IMPORTED_MODULE_7__.getRequestMethod),
/* harmony export */   getUserContentUrl: () => (/* reexport safe */ _util__WEBPACK_IMPORTED_MODULE_7__.getUserContentUrl),
/* harmony export */   getUserName: () => (/* reexport safe */ _util__WEBPACK_IMPORTED_MODULE_7__.getUserName),
/* harmony export */   importItem: () => (/* reexport safe */ _items_create__WEBPACK_IMPORTED_MODULE_1__.importItem),
/* harmony export */   removeItem: () => (/* reexport safe */ _items_remove__WEBPACK_IMPORTED_MODULE_3__.removeItem),
/* harmony export */   removeItemResource: () => (/* reexport safe */ _items_remove__WEBPACK_IMPORTED_MODULE_3__.removeItemResource),
/* harmony export */   request: () => (/* reexport safe */ _request__WEBPACK_IMPORTED_MODULE_6__.request),
/* harmony export */   searchItems: () => (/* reexport safe */ _items_search__WEBPACK_IMPORTED_MODULE_0__.searchItems),
/* harmony export */   searchItemsByPortalUrl: () => (/* reexport safe */ _items_search__WEBPACK_IMPORTED_MODULE_0__.searchItemsByPortalUrl),
/* harmony export */   updateItem: () => (/* reexport safe */ _items_update__WEBPACK_IMPORTED_MODULE_4__.updateItem),
/* harmony export */   updateItemResource: () => (/* reexport safe */ _items_update__WEBPACK_IMPORTED_MODULE_4__.updateItemResource)
/* harmony export */ });
/* harmony import */ var _items_search__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./items/search */ "./jimu-for-builder/lib/service/local-rest-service/items/search.ts");
/* harmony import */ var _items_create__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./items/create */ "./jimu-for-builder/lib/service/local-rest-service/items/create.ts");
/* harmony import */ var _items_get__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./items/get */ "./jimu-for-builder/lib/service/local-rest-service/items/get.ts");
/* harmony import */ var _items_remove__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./items/remove */ "./jimu-for-builder/lib/service/local-rest-service/items/remove.ts");
/* harmony import */ var _items_update__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./items/update */ "./jimu-for-builder/lib/service/local-rest-service/items/update.ts");
/* harmony import */ var _items_add__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./items/add */ "./jimu-for-builder/lib/service/local-rest-service/items/add.ts");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./request */ "./jimu-for-builder/lib/service/local-rest-service/request.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./util */ "./jimu-for-builder/lib/service/local-rest-service/util.ts");










/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/items/add.ts":
/*!**********************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/items/add.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   addItemResource: () => (/* binding */ addItemResource)
/* harmony export */ });
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/local-rest-service/request.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/service/local-rest-service/util.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function addItemResource(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_1__.getOriginUrl)()}${(0,_util__WEBPACK_IMPORTED_MODULE_1__.getUserContentUrl)()}items/${requestOptions.id}/addResources`;
        requestOptions.params = Object.assign(Object.assign({ fileName: requestOptions.name, text: requestOptions.content, access: requestOptions.private ? 'private' : 'inherit' }, requestOptions.params), { file: requestOptions.resource });
        delete requestOptions.params.file;
        requestOptions.params.file = requestOptions.resource;
        const keys = Object.keys(requestOptions.params);
        const data = new FormData();
        for (let i = 0; i < keys.length; i++) {
            data.append(keys[i], requestOptions.params[keys[i]]);
        }
        requestOptions.params = data;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_0__.request)(url, requestOptions);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/items/create.ts":
/*!*************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/items/create.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   checkItemVersion: () => (/* binding */ checkItemVersion),
/* harmony export */   createItem: () => (/* binding */ createItem),
/* harmony export */   importItem: () => (/* binding */ importItem)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/local-rest-service/request.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/service/local-rest-service/util.ts");
/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./helpers */ "./jimu-for-builder/lib/service/local-rest-service/items/helpers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




function createItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        // delegate to createItemInFolder placing in the root of the filestore
        const options = Object.assign({ folderId: null }, requestOptions);
        return yield createItemInFolder(options);
    });
}
function createItemInFolder(requestOptions) {
    var _a, _b;
    return __awaiter(this, void 0, void 0, function* () {
        if (requestOptions.file && !requestOptions.multipart) {
            return yield Promise.reject(new Error('The request must be a multipart request for file uploading.'));
        }
        if (requestOptions.multipart && !requestOptions.filename) {
            return yield Promise.reject(new Error('The file name is required for a multipart request.'));
        }
        const userName = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getUserName)();
        const owner = userName;
        const baseUrl = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getOriginUrl)();
        const url = `${baseUrl}${(0,_util__WEBPACK_IMPORTED_MODULE_2__.getUserContentUrl)()}addItem`;
        requestOptions.params = Object.assign(Object.assign(Object.assign({}, requestOptions.params), (0,_helpers__WEBPACK_IMPORTED_MODULE_3__.serializeItem)(requestOptions.item)), { portalUrl: (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)()) === null || _a === void 0 ? void 0 : _a.getState()) === null || _b === void 0 ? void 0 : _b.portalUrl });
        // serialize the item into something Portal will accept
        const options = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.appendCustomParams(requestOptions, [
            'owner',
            'folderId',
            'file',
            'dataUrl',
            'text',
            'async',
            'multipart',
            'filename',
            'overwrite'
        ], {
            params: Object.assign({}, requestOptions.params)
        });
        options.params.username = owner;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, options);
    });
}
function importItem(item, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const baseUrl = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getOriginUrl)();
        const url = `${baseUrl}${(0,_util__WEBPACK_IMPORTED_MODULE_2__.getUserContentUrl)()}importItem`;
        if (!(item === null || item === void 0 ? void 0 : item.appZip)) {
            return Promise.reject('No app files');
        }
        requestOptions.params = Object.assign(Object.assign({}, requestOptions.params), item);
        const keys = Object.keys(requestOptions.params);
        const data = new FormData();
        for (let i = 0; i < keys.length; i++) {
            data.append(keys[i], requestOptions.params[keys[i]]);
        }
        requestOptions.params = data;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, requestOptions);
    });
}
function checkItemVersion(item, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const baseUrl = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getOriginUrl)();
        const url = `${baseUrl}${(0,_util__WEBPACK_IMPORTED_MODULE_2__.getUserContentUrl)()}checkItemVersion`;
        if (!(item === null || item === void 0 ? void 0 : item.appZip)) {
            return Promise.reject('No app files');
        }
        requestOptions.params = Object.assign(Object.assign({}, requestOptions.params), item);
        const keys = Object.keys(requestOptions.params);
        const data = new FormData();
        for (let i = 0; i < keys.length; i++) {
            data.append(keys[i], requestOptions.params[keys[i]]);
        }
        requestOptions.params = data;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, requestOptions);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/items/get.ts":
/*!**********************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/items/get.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getItem: () => (/* binding */ getItem),
/* harmony export */   getItemData: () => (/* binding */ getItemData),
/* harmony export */   getItemResource: () => (/* binding */ getItemResource),
/* harmony export */   getItemResources: () => (/* binding */ getItemResources)
/* harmony export */ });
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/service/local-rest-service/util.ts");
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-core */ "jimu-core");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function getItemData(id, requestOptions, isArcGisOnlineRequest = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const baseUrl = (0,_util__WEBPACK_IMPORTED_MODULE_0__.getOriginUrl)(isArcGisOnlineRequest);
        const url = `${baseUrl}${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getUserContentUrl)(isArcGisOnlineRequest)}items/${id}/data`;
        // default to a GET request
        const options = Object.assign({ params: {} }, requestOptions);
        if (options.file) {
            options.params.f = null;
        }
        if (isArcGisOnlineRequest && !isPortalAGOL()) {
            delete options.authentication;
        }
        const request = (0,_util__WEBPACK_IMPORTED_MODULE_0__.getRequestMethod)(isArcGisOnlineRequest);
        return yield request(url, options).catch(err => {
            /* if the item doesn't include data, the response will be empty
               and the internal call to response.json() will fail */
            const emptyResponseErr = /Unexpected end of (JSON input|data at line 1 column 1)/i;
            /* istanbul ignore else */
            if (!emptyResponseErr.test(err.message)) {
                throw err;
            }
        });
    });
}
function getItem(id, requestOptions, isArcGisOnlineRequest = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const baseUrl = (0,_util__WEBPACK_IMPORTED_MODULE_0__.getOriginUrl)(isArcGisOnlineRequest);
        // const users = isArcGisOnlineRequest ? '' : 'users/'
        const url = `${baseUrl}${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getUserContentUrl)(isArcGisOnlineRequest)}items/${id}`;
        // default to a GET request
        const options = Object.assign({}, requestOptions);
        if (isArcGisOnlineRequest && !isPortalAGOL()) {
            delete options.authentication;
        }
        const request = (0,_util__WEBPACK_IMPORTED_MODULE_0__.getRequestMethod)(isArcGisOnlineRequest);
        return yield request(url, options);
    });
}
function getItemResources(id, requestOptions, isArcGisOnlineRequest = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getOriginUrl)(isArcGisOnlineRequest)}${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getUserContentUrl)(isArcGisOnlineRequest)}items/${id}/resources`;
        // mix in user supplied params
        requestOptions.params = Object.assign(Object.assign({}, requestOptions.params), { num: 1000 });
        if (isArcGisOnlineRequest && !isPortalAGOL()) {
            delete requestOptions.authentication;
        }
        const request = (0,_util__WEBPACK_IMPORTED_MODULE_0__.getRequestMethod)(isArcGisOnlineRequest);
        return yield request(url, requestOptions, 'GET');
    });
}
function getItemResource(id, requestOptions, isArcGisOnlineRequest = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const resourceName = requestOptions.fileName;
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getOriginUrl)(isArcGisOnlineRequest)}${(0,_util__WEBPACK_IMPORTED_MODULE_0__.getUserContentUrl)(isArcGisOnlineRequest)}items/${id}/resources/${resourceName}`;
        if (isArcGisOnlineRequest && !isPortalAGOL()) {
            delete requestOptions.authentication;
        }
        const request = (0,_util__WEBPACK_IMPORTED_MODULE_0__.getRequestMethod)(isArcGisOnlineRequest);
        return yield request(url, requestOptions, 'GET');
    });
}
function isPortalAGOL() {
    const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_1__.getAppStore)().getState().portalUrl;
    return jimu_core__WEBPACK_IMPORTED_MODULE_1__.portalUrlUtils.isAGOLDomain(portalUrl);
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/items/helpers.ts":
/*!**************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/items/helpers.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   determineOwner: () => (/* binding */ determineOwner),
/* harmony export */   serializeItem: () => (/* binding */ serializeItem)
/* harmony export */ });
/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.
 * Apache-2.0 */
/**
 * Serialize an item and its data into a json format accepted by the Portal API for create and update operations
 *
 * @param item Item to be serialized
 * @returns a formatted json object to be sent to Portal
 */
function serializeItem(item) {
    // create a clone so we're not messing with the original
    const clone = JSON.parse(JSON.stringify(item));
    // binary data needs POSTed as a `file`
    // JSON object literals should be passed as `text`.
    if (clone.data) {
        (typeof Blob !== 'undefined' && item.data instanceof Blob) ||
            // Node.js doesn't implement Blob
            item.data.constructor.name === 'ReadStream'
            ? (clone.file = item.data)
            : (clone.text = item.data);
        delete clone.data;
    }
    return clone;
}
/**
 * requestOptions.owner is given priority, requestOptions.item.owner will be checked next. If neither are present, authentication.username will be assumed.
 */
function determineOwner(requestOptions) {
    if (requestOptions.owner) {
        return requestOptions.owner;
    }
    if (requestOptions.item && requestOptions.item.owner) {
        return requestOptions.item.owner;
    }
    else {
        return requestOptions.authentication.username;
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/items/remove.ts":
/*!*************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/items/remove.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   removeItem: () => (/* binding */ removeItem),
/* harmony export */   removeItemResource: () => (/* binding */ removeItemResource)
/* harmony export */ });
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/local-rest-service/request.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/service/local-rest-service/util.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


function removeItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const userName = (0,_util__WEBPACK_IMPORTED_MODULE_1__.getUserName)();
        const baseUrl = (0,_util__WEBPACK_IMPORTED_MODULE_1__.getOriginUrl)();
        requestOptions.userName = userName;
        const url = `${baseUrl}${(0,_util__WEBPACK_IMPORTED_MODULE_1__.getUserContentUrl)()}items/${requestOptions.id}/delete`;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_0__.request)(url, requestOptions);
    });
}
function removeItemResource(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_1__.getOriginUrl)()}${(0,_util__WEBPACK_IMPORTED_MODULE_1__.getUserContentUrl)()}items/${requestOptions.id}/removeResources`;
        // mix in user supplied params
        requestOptions.params = Object.assign(Object.assign({}, requestOptions.params), { resource: requestOptions.resource });
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_0__.request)(url, requestOptions);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/items/search.ts":
/*!*************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/items/search.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   searchItems: () => (/* binding */ searchItems),
/* harmony export */   searchItemsByPortalUrl: () => (/* binding */ searchItemsByPortalUrl)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _type__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../type */ "./jimu-for-builder/lib/service/type/index.ts");
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../index */ "./jimu-for-builder/lib/service/local-rest-service/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable prefer-const */



function searchItems(search, searchType = _type__WEBPACK_IMPORTED_MODULE_1__.SearchType.Other) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield genericSearch(search, 'item', searchType);
    });
}
function genericSearch(search, searchRequestType, searchType = _type__WEBPACK_IMPORTED_MODULE_1__.SearchType.Other) {
    return __awaiter(this, void 0, void 0, function* () {
        let url;
        let options;
        const originUrl = searchType === _type__WEBPACK_IMPORTED_MODULE_1__.SearchType.AGOL ? 'https://www.arcgis.com' : window.location.origin;
        url = `${originUrl}/sharing/rest/search`;
        if (typeof search === 'string' || search instanceof jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.SearchQueryBuilder) {
            options = {
                params: {
                    q: search
                }
            };
        }
        else {
            options = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.appendCustomParams(Object.assign(Object.assign({}, search), { f: 'json' }), ['q', 'num', 'start', 'sortField', 'sortOrder', 'portalUrl', 'f']);
        }
        // send the request
        return (0,_index__WEBPACK_IMPORTED_MODULE_2__.request)(url, options, 'GET').then(r => {
            if (r.nextStart && r.nextStart !== -1) {
                r.nextPage = function () {
                    return __awaiter(this, void 0, void 0, function* () {
                        let newOptions;
                        if (typeof search === 'string' ||
                            search instanceof jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.SearchQueryBuilder) {
                            newOptions = {
                                q: search,
                                start: r.nextStart
                            };
                        }
                        else {
                            newOptions = search;
                            newOptions.start = r.nextStart;
                        }
                        return yield genericSearch(newOptions, searchRequestType);
                    });
                };
            }
            return r;
        });
    });
}
function searchItemsByPortalUrl(search, portalUrl) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield genericSearchByPortalUrl(search, portalUrl);
    });
}
function genericSearchByPortalUrl(search, portalUrl) {
    return __awaiter(this, void 0, void 0, function* () {
        let url;
        let options;
        if (!url)
            Promise.resolve(null);
        url = `${portalUrl}/sharing/rest/search`;
        if (typeof search === 'string' || search instanceof jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.SearchQueryBuilder) {
            options = {
                params: {
                    q: search
                }
            };
        }
        else {
            options = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.appendCustomParams(Object.assign(Object.assign({}, search), { f: 'json' }), ['q', 'num', 'start', 'sortField', 'sortOrder', 'portalUrl', 'f']);
        }
        // send the request
        return (0,_index__WEBPACK_IMPORTED_MODULE_2__.request)(url, options, 'GET').then(r => {
            if (r.nextStart && r.nextStart !== -1) {
                r.nextPage = function () {
                    return __awaiter(this, void 0, void 0, function* () {
                        let newOptions;
                        if (typeof search === 'string' ||
                            search instanceof jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.SearchQueryBuilder) {
                            newOptions = {
                                q: search,
                                start: r.nextStart
                            };
                        }
                        else {
                            newOptions = search;
                            newOptions.start = r.nextStart;
                        }
                        return yield genericSearchByPortalUrl(newOptions, 'item');
                    });
                };
            }
            return r;
        });
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/items/update.ts":
/*!*************************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/items/update.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   updateItem: () => (/* binding */ updateItem),
/* harmony export */   updateItemResource: () => (/* binding */ updateItemResource)
/* harmony export */ });
/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./helpers */ "./jimu-for-builder/lib/service/local-rest-service/items/helpers.ts");
/* harmony import */ var _request__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../request */ "./jimu-for-builder/lib/service/local-rest-service/request.ts");
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util */ "./jimu-for-builder/lib/service/local-rest-service/util.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



function updateItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const userName = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getUserName)();
        const baseUrl = (0,_util__WEBPACK_IMPORTED_MODULE_2__.getOriginUrl)();
        requestOptions.userName = userName;
        const url = `${baseUrl}${(0,_util__WEBPACK_IMPORTED_MODULE_2__.getUserContentUrl)()}items/${requestOptions.item.id}/update`;
        // serialize the item into something Portal will accept
        requestOptions.params = Object.assign(Object.assign({}, requestOptions.params), (0,_helpers__WEBPACK_IMPORTED_MODULE_0__.serializeItem)(requestOptions.item));
        if (requestOptions.item.thumbnail && typeof (requestOptions.item.thumbnail) !== 'string') {
            requestOptions.params = Object.assign(Object.assign({}, requestOptions.params), requestOptions.item);
            const keys = Object.keys(requestOptions.params);
            const data = new FormData();
            for (let i = 0; i < keys.length; i++) {
                data.append(keys[i], requestOptions.params[keys[i]]);
            }
            requestOptions.params = data;
        }
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, requestOptions);
    });
}
function updateItemResource(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        const url = `${(0,_util__WEBPACK_IMPORTED_MODULE_2__.getOriginUrl)()}${(0,_util__WEBPACK_IMPORTED_MODULE_2__.getUserContentUrl)()}items/${requestOptions.id}/updateResources`;
        // mix in user supplied params
        requestOptions.params = Object.assign(Object.assign({ fileName: requestOptions.name, text: requestOptions.content }, requestOptions.params), { file: requestOptions.resource });
        delete requestOptions.params.file;
        requestOptions.params.file = requestOptions.resource;
        // only override the access specified previously if 'private' is passed explicitly
        if (typeof requestOptions.private !== 'undefined') {
            requestOptions.params.access = requestOptions.private
                ? 'private'
                : 'inherit';
        }
        const keys = Object.keys(requestOptions.params);
        const data = new FormData();
        for (let i = 0; i < keys.length; i++) {
            data.append(keys[i], requestOptions.params[keys[i]]);
        }
        requestOptions.params = data;
        return yield (0,_request__WEBPACK_IMPORTED_MODULE_1__.request)(url, requestOptions);
    });
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/request.ts":
/*!********************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/request.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   request: () => (/* binding */ request)
/* harmony export */ });
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
function request(url, requestOptions = { params: { f: 'json' } }, requestType = 'POST') {
    return __awaiter(this, void 0, void 0, function* () {
        if (requestType === 'GET') {
            const requestUrl = url + encodeQueryString(requestOptions.params);
            return yield fetch(requestUrl, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then((response) => __awaiter(this, void 0, void 0, function* () {
                return yield response.json();
            })).then((data) => __awaiter(this, void 0, void 0, function* () {
                return yield Promise.resolve(data);
            }));
        }
        if (requestType === 'POST') {
            if (requestOptions.params && requestOptions.params.constructor.name === 'FormData') {
                return yield fetch(url, {
                    method: 'POST',
                    body: requestOptions.params
                }).then((response) => __awaiter(this, void 0, void 0, function* () {
                    return yield response.json();
                })).then((data) => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.resolve(data);
                }));
            }
            else {
                return yield fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestOptions.params)
                }).then((response) => __awaiter(this, void 0, void 0, function* () {
                    return yield response.json();
                })).then((data) => __awaiter(this, void 0, void 0, function* () {
                    return yield Promise.resolve(data);
                }));
            }
        }
        return yield Promise.reject(null);
    });
}
function encodeQueryString(params) {
    if (!params) {
        return '';
    }
    const keys = Object.keys(params);
    return keys.length
        ? '?' + keys
            .map(key => encodeURIComponent(key) +
            '=' + encodeURIComponent(params[key]))
            .join('&')
        : '';
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/local-rest-service/util.ts":
/*!*****************************************************************!*\
  !*** ./jimu-for-builder/lib/service/local-rest-service/util.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getOriginUrl: () => (/* binding */ getOriginUrl),
/* harmony export */   getRequestMethod: () => (/* binding */ getRequestMethod),
/* harmony export */   getUserContentUrl: () => (/* binding */ getUserContentUrl),
/* harmony export */   getUserName: () => (/* binding */ getUserName)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index */ "./jimu-for-builder/lib/service/local-rest-service/index.ts");


const restRequest = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restRequest.request;
function getOriginUrl(isArcGisOnlineRequest = false) {
    if (isArcGisOnlineRequest) {
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlUtils.getArcgisOnlineUrl();
    }
    else {
        return window.location.origin;
    }
}
function getUserContentUrl(isNotContainUsers = false) {
    if (isNotContainUsers) {
        return '/sharing/rest/content/';
    }
    else {
        return '/sharing/rest/content/users/';
    }
}
function getUserName() {
    var _a;
    return (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().user) === null || _a === void 0 ? void 0 : _a.username;
}
function getRequestMethod(isArcGisOnlineRequest = false) {
    return isArcGisOnlineRequest ? restRequest : _index__WEBPACK_IMPORTED_MODULE_1__.request;
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/rest-service.tsx":
/*!*******************************************************!*\
  !*** ./jimu-for-builder/lib/service/rest-service.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   addItemResource: () => (/* binding */ addItemResource),
/* harmony export */   checkAppVersion: () => (/* binding */ checkAppVersion),
/* harmony export */   createAppInFolder: () => (/* binding */ createAppInFolder),
/* harmony export */   createItem: () => (/* binding */ createItem),
/* harmony export */   getGroupCategorySchema: () => (/* binding */ getGroupCategorySchema),
/* harmony export */   getGroupContents: () => (/* binding */ getGroupContents),
/* harmony export */   getItem: () => (/* binding */ getItem),
/* harmony export */   getItemData: () => (/* binding */ getItemData),
/* harmony export */   getItemResource: () => (/* binding */ getItemResource),
/* harmony export */   getItemResources: () => (/* binding */ getItemResources),
/* harmony export */   getItemsGroups: () => (/* binding */ getItemsGroups),
/* harmony export */   getOrgCategorySchema: () => (/* binding */ getOrgCategorySchema),
/* harmony export */   getResourceOrigin: () => (/* binding */ getResourceOrigin),
/* harmony export */   getUserContent: () => (/* binding */ getUserContent),
/* harmony export */   getUsersTags: () => (/* binding */ getUsersTags),
/* harmony export */   importApp: () => (/* binding */ importApp),
/* harmony export */   itemsgroups: () => (/* binding */ itemsgroups),
/* harmony export */   moveItem: () => (/* binding */ moveItem),
/* harmony export */   removeItem: () => (/* binding */ removeItem),
/* harmony export */   removeItemResource: () => (/* binding */ removeItemResource),
/* harmony export */   searchGroup: () => (/* binding */ searchGroup),
/* harmony export */   searchItems: () => (/* binding */ searchItems),
/* harmony export */   searchItemsByPortalUrl: () => (/* binding */ searchItemsByPortalUrl),
/* harmony export */   shareItemWithGroup: () => (/* binding */ shareItemWithGroup),
/* harmony export */   unshareItemWithGroup: () => (/* binding */ unshareItemWithGroup),
/* harmony export */   updateAppsThumbnail: () => (/* binding */ updateAppsThumbnail),
/* harmony export */   updateItem: () => (/* binding */ updateItem),
/* harmony export */   updateItemResource: () => (/* binding */ updateItemResource)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _local_rest_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./local-rest-service */ "./jimu-for-builder/lib/service/local-rest-service/index.ts");
/* harmony import */ var _jimu_request__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./jimu-request */ "./jimu-for-builder/lib/service/jimu-request/index.ts");
/* harmony import */ var _app_service_util__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app-service/util */ "./jimu-for-builder/lib/service/app-service/util.ts");
/* harmony import */ var _type__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./type */ "./jimu-for-builder/lib/service/type/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





const { importItem, checkItemVersion } = _local_rest_service__WEBPACK_IMPORTED_MODULE_1__;
function requestMethodProvider(restPortalRequestName, appInfo, localRequestName) {
    const localRequestMethod = localRequestName ? _local_rest_service__WEBPACK_IMPORTED_MODULE_1__[localRequestName] : _local_rest_service__WEBPACK_IMPORTED_MODULE_1__[restPortalRequestName];
    const restPortalRequestMethod = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal[restPortalRequestName];
    if (!appInfo) {
        if (window.jimuConfig.isDevEdition) {
            return localRequestMethod;
        }
        else {
            return restPortalRequestMethod;
        }
    }
    else {
        if ((0,_app_service_util__WEBPACK_IMPORTED_MODULE_3__.isPortalApp)(appInfo)) {
            return restPortalRequestMethod;
        }
        else {
            return localRequestMethod;
        }
    }
}
function searchMethodProvider(searchType) {
    let method;
    const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    const isAGOLDomain = jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.isAGOLDomain(portalUrl);
    switch (searchType) {
        case _type__WEBPACK_IMPORTED_MODULE_4__.SearchType.Portal:
            method = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.searchItems;
            break;
        case _type__WEBPACK_IMPORTED_MODULE_4__.SearchType.AGOL:
            method = isAGOLDomain ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.searchItems : _local_rest_service__WEBPACK_IMPORTED_MODULE_1__.searchItems;
            break;
        case _type__WEBPACK_IMPORTED_MODULE_4__.SearchType.Other:
            method = window.jimuConfig.isDevEdition ? _local_rest_service__WEBPACK_IMPORTED_MODULE_1__.searchItems : jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.searchItems;
            break;
    }
    return method;
}
function searchItems(search, searchType) {
    return __awaiter(this, void 0, void 0, function* () {
        return searchMethodProvider(searchType)(search, searchType);
    });
}
function searchItemsByPortalUrl(search, portalUrl) {
    return __awaiter(this, void 0, void 0, function* () {
        return _local_rest_service__WEBPACK_IMPORTED_MODULE_1__.searchItemsByPortalUrl(search, portalUrl);
    });
}
function removeItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('removeItem')(requestOptions);
    });
}
function updateItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('updateItem')(requestOptions);
    });
}
function importApp(item, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return importItem(item, requestOptions);
    });
}
function checkAppVersion(item, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return checkItemVersion(item, requestOptions);
    });
}
function updateAppsThumbnail(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        if (window.jimuConfig.isDevEdition) {
            return yield _local_rest_service__WEBPACK_IMPORTED_MODULE_1__.updateItem(requestOptions);
        }
        else {
            return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.updateItem(requestOptions);
        }
    });
}
function createItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('createItem')(requestOptions);
    });
}
function getItem(appInfo, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('getItem', appInfo)(appInfo.id, requestOptions, (0,_app_service_util__WEBPACK_IMPORTED_MODULE_3__.isAGOLApp)(appInfo));
    });
}
function getItemData(appInfo, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('getItemData', appInfo)(appInfo.id, requestOptions, (0,_app_service_util__WEBPACK_IMPORTED_MODULE_3__.isAGOLApp)(appInfo));
    });
}
function getItemResources(appInfo, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('getItemResources', appInfo)(appInfo.id, requestOptions, (0,_app_service_util__WEBPACK_IMPORTED_MODULE_3__.isAGOLApp)(appInfo));
    });
}
function getOrgCategorySchema(requestOptions, isGetAGOLCategorySchema) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.getOrgCategorySchema(requestOptions, isGetAGOLCategorySchema);
    });
}
function getGroupCategorySchema(groupId, requestOptions, isGetAGOLCategorySchema) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.getGroupCategorySchema(groupId, requestOptions, isGetAGOLCategorySchema);
    });
}
function getGroupContents(groupId, requestOptions, isGetAGOLGroupContent) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.getGroupContent(groupId, requestOptions, isGetAGOLGroupContent);
    });
}
function getItemResource(appInfo, requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('getItemResource', appInfo)(appInfo.id, requestOptions, (0,_app_service_util__WEBPACK_IMPORTED_MODULE_3__.isAGOLApp)(appInfo));
    });
}
function addItemResource(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('addItemResource')(requestOptions);
    });
}
function updateItemResource(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('updateItemResource')(requestOptions);
    });
}
function shareItemWithGroup(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        // return esri.restPortal.shareItemWithGroup(requestOptions)
        return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.shareItems(requestOptions);
    });
}
function unshareItemWithGroup(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        // return esri.restPortal.unshareItemWithGroup(requestOptions)
        return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.unShareItems(requestOptions);
    });
}
function itemsgroups(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        // return esri.restPortal.unshareItemWithGroup(requestOptions)
        return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.itemsgroups(requestOptions);
    });
}
function removeItemResource(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestMethodProvider('removeItemResource')(requestOptions);
    });
}
function getItemsGroups(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield _jimu_request__WEBPACK_IMPORTED_MODULE_2__.itemsgroups(requestOptions);
    });
}
function moveItem(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.moveItem(requestOptions);
    });
}
function getUsersTags(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.getUserTags(requestOptions);
    });
}
function searchGroup(requestOptions) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.searchGroups(requestOptions);
    });
}
function getUserContent(requestOptions) {
    return _jimu_request__WEBPACK_IMPORTED_MODULE_2__.getUserContent(requestOptions);
}
function createAppInFolder(requestOptions) {
    return jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.createItemInFolder(requestOptions);
}
function getResourceOrigin(originalAppInfo) {
    const portalUrl = (0,_app_service_util__WEBPACK_IMPORTED_MODULE_3__.isAGOLApp)(originalAppInfo) ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlUtils.getArcgisOnlineUrl() : (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
    const isLocalAppResourceOrigin = originalAppInfo === null || originalAppInfo === void 0 ? void 0 : originalAppInfo.isLocalApp;
    if (isLocalAppResourceOrigin) {
        // local app`s resource origin in devEdtion
        return _local_rest_service__WEBPACK_IMPORTED_MODULE_1__.getOriginUrl() + '/apps/';
    }
    else {
        return (jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPlatformUrlByOrgUrl(portalUrl) +
            '/sharing/rest/content/items/');
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/service/type/index.ts":
/*!****************************************************!*\
  !*** ./jimu-for-builder/lib/service/type/index.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AppType: () => (/* binding */ AppType),
/* harmony export */   PublishStatus: () => (/* binding */ PublishStatus),
/* harmony export */   SearchType: () => (/* binding */ SearchType)
/* harmony export */ });
var SearchType;
(function (SearchType) {
    SearchType["AGOL"] = "AGOL";
    SearchType["Portal"] = "Portal";
    SearchType["Other"] = "Other";
})(SearchType || (SearchType = {}));
var AppType;
(function (AppType) {
    AppType["TemplateType"] = "Web Experience Template";
    AppType["ExperienceType"] = "Web Experience";
})(AppType || (AppType = {}));
var PublishStatus;
(function (PublishStatus) {
    PublishStatus["Published"] = "Published";
    PublishStatus["Draft"] = "Draft";
    PublishStatus["Changed"] = "Changed"; // There are unpublished changes since last publishing.
})(PublishStatus || (PublishStatus = {}));


/***/ }),

/***/ "./jimu-for-builder/lib/sync-type.ts":
/*!*******************************************!*\
  !*** ./jimu-for-builder/lib/sync-type.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ToAppMessage: () => (/* binding */ ToAppMessage),
/* harmony export */   ToBuilderMessage: () => (/* binding */ ToBuilderMessage)
/* harmony export */ });
var ToAppMessage;
(function (ToAppMessage) {
    ToAppMessage["AppConfigChanged"] = "app_config_changed";
    ToAppMessage["AppInfoChanged"] = "app_info_changed";
    ToAppMessage["PortalSelfChanged"] = "portal_self_changed";
    ToAppMessage["DialogInfosChanged"] = "dialog_infos_changed";
    ToAppMessage["UserSignIn"] = "user_sign_in";
    ToAppMessage["SetMainPortal"] = "set_main_portal";
    ToAppMessage["ChangeAppMode"] = "change_app_mode";
    ToAppMessage["ChangePage"] = "change_page";
    ToAppMessage["ChangeDialog"] = "change_dialog";
    ToAppMessage["ChangeSelection"] = "change_selection";
    ToAppMessage["ChangeWidgetStateProp"] = "change_widget_state_prop";
    ToAppMessage["ChangeWidgetMutableStateProp"] = "change_widget_mutable_state_prop";
    ToAppMessage["ChangeZoomScale"] = "change_zoom_scale";
    ToAppMessage["BuilderTriggerKeyboard"] = "builder_trigger_keyboard";
    ToAppMessage["ChangeBrowserSizeMode"] = "change_browser_size_mode";
    ToAppMessage["BuilderSessionChanged"] = "builder_session_changed";
    ToAppMessage["BuilderNoPermissionResourceInfoListChanged"] = "builder_no_permission_resource_info_list_changed";
    ToAppMessage["ActivePagePartChanged"] = "active_page_part_changed";
    ToAppMessage["AnimationPreview"] = "animation_preview";
    ToAppMessage["HoverPreview"] = "hover_preview";
    ToAppMessage["SectionNavInfoChanged"] = "section_navinfo_changed";
    ToAppMessage["ScreenGroupNavInfoChanged"] = "screengroup_navinfo_changed";
    ToAppMessage["TocHoverInfoChanged"] = "toc_hover_info_changed";
    ToAppMessage["SetClientIdAlertIsCancelled"] = "set_client_id_alert_is_cancelled";
    ToAppMessage["UtilityStateChanged"] = "utility_state_changed";
})(ToAppMessage || (ToAppMessage = {}));
var ToBuilderMessage;
(function (ToBuilderMessage) {
    ToBuilderMessage["AppStateChanged"] = "app_state_changed";
    ToBuilderMessage["AppSessionChanged"] = "app_session_changed";
    ToBuilderMessage["AppNoPermissionResourceInfoListChanged"] = "app_no_permission_resource_info_list_changed";
    ToBuilderMessage["NeedToCheck498Error"] = "need_to_check_498_error";
    ToBuilderMessage["PopupChooseWidget"] = "popup_choose_widget";
    ToBuilderMessage["AppAddResource"] = "app_add_resource";
    ToBuilderMessage["AppClearResources"] = "app_clear_resources";
    ToBuilderMessage["AppTriggerKeyboard"] = "app_trigger_keyboard";
    ToBuilderMessage["SetLayoutTools"] = "app_set_layout_tools";
    ToBuilderMessage["ClearLastAppConfigFromHistory"] = "clear_last_app_config_from_history";
    ToBuilderMessage["SetIsBusy"] = "app_set_isbusy";
    ToBuilderMessage["AppIsLoaded"] = "app_is_loaded";
    ToBuilderMessage["ConfirmDelete"] = "confirm_delete";
    ToBuilderMessage["NeedToRegisterClinetId"] = "need_to_register_client_id";
    ToBuilderMessage["SetSidePanel"] = "app_side_panel";
})(ToBuilderMessage || (ToBuilderMessage = {}));


/***/ }),

/***/ "./jimu-for-builder/lib/translations/default.ts":
/*!******************************************************!*\
  !*** ./jimu-for-builder/lib/translations/default.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    frameworkAction_TriggerLayer: 'Trigger data',
    frameworkAction_SetData: 'Select data',
    frameworkAction_ActionLayer: 'Action data',
    frameworkAction_Conditions: 'Conditions',
    frameworkAction_RelateMessage: 'Trigger / action connection',
    frameworkAction_TriggerLayerField: 'Select a trigger field',
    frameworkAction_None: 'none',
    frameworkAction_Equals: 'equals',
    frameworkAction_ActionLayerField: 'Select an action field',
    frameworkAction_MoreConditions: 'More conditions',
    frameworkAction_SetExpression: 'Please set your expression first.',
    frameworkAction_ChooseLayer: 'Select data',
    frameworkAction_AutoBind: 'Auto bound.',
    frameworkAction_NoLayer: 'No data.',
    frameworkAction_QueryByExtent: 'Query by current extent',
    // common template strings
    defaultTextPlaceholder: 'Double click to edit text',
    titlePlaceholder: 'Here is the title',
    subTitlePlaceholder: 'Here is the subtitle',
    shortTitlePlaceholder: 'Title',
    shortSubTitlePlaceholder: 'Subtitle',
    copyrightPlaceholder: 'Copyright info',
    cardTitle: 'Card title',
    bookmark: 'Bookmark',
    number: 'Number',
    templateSearchResult: 'Search result',
    logo: 'Logo',
    appItemCopy: 'Copy'
});


/***/ }),

/***/ "./jimu-for-builder/lib/url-config-manager.tsx":
/*!*****************************************************!*\
  !*** ./jimu-for-builder/lib/url-config-manager.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_for_builder__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-for-builder */ "jimu-for-builder");
/* harmony import */ var jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jimu-layouts/layout-runtime */ "jimu-layouts/layout-runtime");



class UrlConfigManager {
    constructor() {
        // general settings
        this.isGeneralUrlConfigEnable = (generalConfig) => {
            var _a;
            const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
            const urlConfig = (_a = appConfig === null || appConfig === void 0 ? void 0 : appConfig.urlParams) === null || _a === void 0 ? void 0 : _a.getIn(['general', generalConfig]);
            let isEnable = urlConfig === null || urlConfig === void 0 ? void 0 : urlConfig.isEnable;
            if (typeof isEnable === 'undefined') {
                isEnable = true; // default is open
            }
            return isEnable;
        };
    }
    static getInstance() {
        if (!UrlConfigManager.instance) {
            UrlConfigManager.instance = new UrlConfigManager();
        }
        return UrlConfigManager.instance;
    }
    // Manifest
    getWidgetsUseUrlParamsInManifest() {
        const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
        let widgetsWithUrlParameters = null;
        if (appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) {
            widgetsWithUrlParameters = jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable.from({});
            for (const widgetId of Object.keys(appConfig.widgets)) {
                const widget = appConfig.widgets[widgetId];
                const urlParametersInManifest = widget.manifest.urlParameters;
                // set urlParameters data
                if ((urlParametersInManifest === null || urlParametersInManifest === void 0 ? void 0 : urlParametersInManifest.length) > 0) {
                    widgetsWithUrlParameters = widgetsWithUrlParameters.set(widgetId, widget);
                    // use i18n label, key: _url_params_{}_label
                    const urlParametersWithI18nLabel = urlParametersInManifest.map(urlParameter => {
                        var _a;
                        const label = (_a = widget.manifest.i18nMessages[`_url_params_${urlParameter.name}_label`]) !== null && _a !== void 0 ? _a : urlParameter.label;
                        return urlParameter.set('label', label);
                    });
                    widgetsWithUrlParameters = widgetsWithUrlParameters.setIn([widgetId, 'manifest', 'urlParameters'], urlParametersWithI18nLabel);
                }
            }
        }
        return widgetsWithUrlParameters;
    }
    updateGeneralUrlConfigEnable(generalUrlConfig, isEnable) {
        var _a, _b;
        let appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
        let generalUrlConfigs /*: UrlParamsConfig */ = (_a = appConfig.urlParams) === null || _a === void 0 ? void 0 : _a.getIn(['general', generalUrlConfig]);
        if (!generalUrlConfigs) {
            generalUrlConfigs = jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable.from({ isEnable: false });
        }
        generalUrlConfigs = generalUrlConfigs === null || generalUrlConfigs === void 0 ? void 0 : generalUrlConfigs.merge({ isEnable: isEnable });
        if (!appConfig.urlParams) {
            appConfig = appConfig.setIn(['urlParams'], jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable.from({ general: {} }));
        }
        const urlParams = (_b = appConfig.urlParams) === null || _b === void 0 ? void 0 : _b.setIn(['general', generalUrlConfig], generalUrlConfigs);
        // update
        this.updateUrlParamsConfig(urlParams);
    }
    // widgets
    isWidgetParamEnable(widgetId, paramName) {
        var _a;
        const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
        let isChecked = true;
        const widget = (_a = appConfig.urlParams) === null || _a === void 0 ? void 0 : _a.getIn(['widgets', widgetId]);
        isChecked = widget === null || widget === void 0 ? void 0 : widget.getIn(['params', paramName]);
        if (typeof isChecked === 'undefined') {
            isChecked = true; // default is open
        }
        return isChecked;
    }
    updateWidgetEnable(widgetId, isEnable) {
        let { appConfig, widgetUrlConfig } = this.getWidgetsUrlParamsConfig(widgetId);
        widgetUrlConfig = widgetUrlConfig === null || widgetUrlConfig === void 0 ? void 0 : widgetUrlConfig.merge({ isEnable: isEnable });
        this._setWidgetUrlConfig(widgetId, widgetUrlConfig, appConfig, (0,jimu_for_builder__WEBPACK_IMPORTED_MODULE_1__.getAppConfigAction)());
    }
    updateWidgetParamEnable(widgetId, paramName, isEnable) {
        let { appConfig, widgetUrlConfig } = this.getWidgetsUrlParamsConfig(widgetId);
        widgetUrlConfig = widgetUrlConfig.setIn(['params', paramName], isEnable);
        // enable widget, when once itme become enable
        if (isEnable) {
            widgetUrlConfig = widgetUrlConfig === null || widgetUrlConfig === void 0 ? void 0 : widgetUrlConfig.merge({ isEnable: true });
        }
        this._setWidgetUrlConfig(widgetId, widgetUrlConfig, appConfig, (0,jimu_for_builder__WEBPACK_IMPORTED_MODULE_1__.getAppConfigAction)());
    }
    // widgets filter for pages
    getWidgetsInPages(currentBrowserSizeMode, filterString) {
        const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
        const infos = [];
        for (const pageId of Object.keys(appConfig.pages)) {
            const containerInfo = {
                type: jimu_core__WEBPACK_IMPORTED_MODULE_0__.ContainerType.Page,
                id: pageId
            };
            const widgetIdsInPage = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_2__.searchUtils.getContentsInContainerRecursive(appConfig, containerInfo, jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget, currentBrowserSizeMode);
            const widgetIds = this._findCommonWidgetsInManifest(widgetIdsInPage);
            // 1.pageInfo
            const pageInfo = {
                id: pageId,
                label: this._getPageLabel(pageId)
            };
            // 2.widgetsInfo
            let widgetsInfo = [];
            widgetIds.forEach((widgetId) => {
                widgetsInfo.push({
                    id: widgetId,
                    label: this._getWidgetLabel(widgetId)
                });
            });
            // 3.filter
            if (filterString) {
                widgetsInfo = widgetsInfo.filter((widgetInfo) => {
                    var _a;
                    return (_a = widgetInfo.label) === null || _a === void 0 ? void 0 : _a.toLowerCase().includes(filterString.toLowerCase()); // ignore case
                });
            }
            // 1+2+3 result
            infos.push({
                pageInfo: pageInfo,
                widgetsInfo: widgetsInfo
            });
        }
        return infos;
    }
    _findCommonWidgetsInManifest(widgetIdsInPage) {
        const urlParamsWidgetsInManifest = this.getWidgetsUseUrlParamsInManifest();
        const widgetsInManifest = Object.keys(urlParamsWidgetsInManifest);
        const commonElements = [];
        widgetIdsInPage.forEach((widgetId) => {
            if (widgetsInManifest.includes(widgetId)) {
                commonElements.push(widgetId);
            }
        });
        return commonElements;
    }
    _getWidgetLabel(widgetId) {
        const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
        const widgetInfo = appConfig.widgets.getIn([widgetId]);
        return (widgetInfo === null || widgetInfo === void 0 ? void 0 : widgetInfo.label) || widgetId;
    }
    _getPageLabel(pageId) {
        const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
        const pageInfo = appConfig.pages.getIn([pageId]);
        return (pageInfo === null || pageInfo === void 0 ? void 0 : pageInfo.label) || pageId;
    }
    // setting & getter
    getWidgetsUrlParamsConfig(widgetId) {
        var _a;
        const appConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.urlManagerUtils.getAppConfig();
        let widgetUrlConfig = (_a = appConfig.urlParams) === null || _a === void 0 ? void 0 : _a.getIn(['widgets', widgetId]);
        if (!widgetUrlConfig) {
            widgetUrlConfig = jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable.from({ isEnable: true });
        }
        return { appConfig, widgetUrlConfig };
    }
    _setWidgetUrlConfig(widgetId, widgetUrlConfig, appConfig, appConfigAction) {
        var _a;
        if (!appConfig.urlParams) {
            appConfig = appConfig.setIn(['urlParams'], jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable.from({ widgets: {} }));
        }
        const widgetUrlParams = (_a = appConfig.urlParams) === null || _a === void 0 ? void 0 : _a.setIn(['widgets', widgetId], widgetUrlConfig);
        // update
        this.updateUrlParamsConfig(widgetUrlParams);
    }
    updateUrlParamsConfig(urlParams) {
        (0,jimu_for_builder__WEBPACK_IMPORTED_MODULE_1__.getAppConfigAction)().updateUrlParamsConfig(urlParams).exec();
    }
}
/**
 * The `UrlConfigManager` is used to manage url params config, in app-setting.
 */
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (UrlConfigManager);


/***/ }),

/***/ "./jimu-for-builder/lib/utils/app-config-utils.ts":
/*!********************************************************!*\
  !*** ./jimu-for-builder/lib/utils/app-config-utils.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   cleanAppStructure: () => (/* binding */ cleanAppStructure),
/* harmony export */   getCleanAppConfig: () => (/* binding */ getCleanAppConfig),
/* harmony export */   getRealPageCount: () => (/* binding */ getRealPageCount),
/* harmony export */   getRealPageCountExcludeOnePage: () => (/* binding */ getRealPageCountExcludeOnePage),
/* harmony export */   getSizeModeOfALayout: () => (/* binding */ getSizeModeOfALayout),
/* harmony export */   getSubRealPageCount: () => (/* binding */ getSubRealPageCount),
/* harmony export */   getUniqueId: () => (/* binding */ getUniqueId),
/* harmony export */   getUniqueLabel: () => (/* binding */ getUniqueLabel),
/* harmony export */   isFirstLevelPage: () => (/* binding */ isFirstLevelPage),
/* harmony export */   isLabelDuplicated: () => (/* binding */ isLabelDuplicated),
/* harmony export */   isPageHasSubPage: () => (/* binding */ isPageHasSubPage),
/* harmony export */   isRealPage: () => (/* binding */ isRealPage),
/* harmony export */   parseUniqueLabel: () => (/* binding */ parseUniqueLabel)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _layout_write_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./layout-write-utils */ "./jimu-for-builder/lib/utils/layout-write-utils.ts");


const { getUniqueId, getUniqueLabel, parseUniqueLabel, getSizeModeOfALayout } = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils;

function isFirstLevelPage(appConfig, pageId) {
    return !!appConfig.pageStructure.find(ps => !!ps[pageId]);
}
function isPageHasSubPage(appConfig, pageId) {
    const ps = appConfig.pageStructure.find(ps => !!ps[pageId]);
    return ps && ps[pageId].length > 0;
}
function getRealPageCount(appConfig) {
    let count = 0;
    Object.keys(appConfig.pages).forEach((pId, i) => {
        if (isRealPage(appConfig, pId)) {
            count++;
        }
    });
    return count;
}
function getSubRealPageCount(appConfig, parentPageId) {
    if (!isFirstLevelPage(appConfig, parentPageId))
        return 0;
    let count = 0;
    appConfig.pageStructure.forEach((ps, i) => {
        const pId = Object.keys(ps)[0];
        if (pId === parentPageId) {
            ps[pId].forEach((subPId) => {
                if (isRealPage(appConfig, subPId)) {
                    count++;
                }
            });
        }
    });
    return count;
}
/**
 * Exclude the passed in page and it's sub pages.
 * @param appConfig
 * @param pageId the page that is excluded
 */
function getRealPageCountExcludeOnePage(appConfig, pageId) {
    let count = 0;
    if (isRealPage(appConfig, pageId))
        count = 1;
    return getRealPageCount(appConfig) - getSubRealPageCount(appConfig, pageId) - count;
}
function isRealPage(appConfig, pageId) {
    const pageJson = appConfig.pages[pageId];
    if (!pageJson)
        return false;
    if (pageJson.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Normal) {
        return true;
    }
    return false;
}
function cleanAppStructure(config) {
    var _a, _b, _c, _d;
    Object.values((_a = config.pages) !== null && _a !== void 0 ? _a : {}).forEach(pageJson => {
        config = _layout_write_utils__WEBPACK_IMPORTED_MODULE_1__.cleanupSizemodeLayoutStructure(config, pageJson.layout);
    });
    Object.values((_b = config.dialogs) !== null && _b !== void 0 ? _b : {}).forEach(dialogJson => {
        config = _layout_write_utils__WEBPACK_IMPORTED_MODULE_1__.cleanupSizemodeLayoutStructure(config, dialogJson.layout);
    });
    if ((_c = config.header) === null || _c === void 0 ? void 0 : _c.layout) {
        config = _layout_write_utils__WEBPACK_IMPORTED_MODULE_1__.cleanupSizemodeLayoutStructure(config, config.header.layout);
    }
    if ((_d = config.footer) === null || _d === void 0 ? void 0 : _d.layout) {
        config = _layout_write_utils__WEBPACK_IMPORTED_MODULE_1__.cleanupSizemodeLayoutStructure(config, config.footer.layout);
    }
    return config;
}
function getCleanAppConfig(appConfig) {
    let config = appConfig.asMutable({ deep: true });
    // config = removeOrphanItems(config, true)
    Object.keys(config.widgets).forEach(wid => {
        var _a, _b, _c;
        const w = config.widgets[wid];
        if (w.label === ((_a = w.manifest) === null || _a === void 0 ? void 0 : _a.name)) {
            delete w.label;
        }
        if (w.icon === w.context.folderUrl + 'icon.svg') {
            delete w.icon;
        }
        if (typeof w.icon === 'object') {
            if ((w.icon).svg === w.context.folderUrl + 'icon.svg' &&
                (((_b = (w.icon).properties) === null || _b === void 0 ? void 0 : _b.color) === '#fff' || !((_c = (w.icon).properties) === null || _c === void 0 ? void 0 : _c.color))) {
                delete w.icon;
            }
        }
        delete w.context;
        delete w.manifest;
        delete w._originManifest;
    });
    config.layouts = _layout_write_utils__WEBPACK_IMPORTED_MODULE_1__.cleanupRuntimeLayouts(config.layouts);
    config = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.cleanPortalInfoFromResource(config);
    config = cleanAppStructure(config);
    return config;
}
// check if the label is duplicated with its siblings
function isLabelDuplicated(appConfig, type, id, label) {
    let contents;
    if (type === 'page') {
        contents = appConfig.pages;
    }
    else if (type === 'view') {
        contents = appConfig.views;
    }
    else if (type === 'dialog') {
        contents = appConfig.dialogs;
    }
    if (!contents) {
        return false;
    }
    return Object.keys(contents).some(contentId => {
        if (contentId === id) {
            return false;
        }
        return contents[contentId].label === label;
    });
}
window._getCleanAppConfig = getCleanAppConfig;


/***/ }),

/***/ "./jimu-for-builder/lib/utils/help-utils.ts":
/*!**************************************************!*\
  !*** ./jimu-for-builder/lib/utils/help-utils.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getBuildAppsHelpLink: () => (/* binding */ getBuildAppsHelpLink),
/* harmony export */   getHomeHelpLink: () => (/* binding */ getHomeHelpLink),
/* harmony export */   getWhatsNewLink: () => (/* binding */ getWhatsNewLink),
/* harmony export */   getWidgetHelpLink: () => (/* binding */ getWidgetHelpLink),
/* harmony export */   isSupportLanguage: () => (/* binding */ isSupportLanguage)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

const helpDocJson = __webpack_require__(/*! builder/help-doc.json */ "./builder/help-doc.json");
const supportLanguages = ['en', 'de', 'es', 'fr', 'ja', 'ru',
    'zh-cn']; // TODO: add `bg` once it's supported in online 9.4.
function isSupportLanguage() {
    const locale = window.locale.toLowerCase();
    let support = false;
    if (supportLanguages.includes(locale)) {
        support = true;
    }
    else {
        const splitLocale = locale.split('-')[0];
        for (let i = 0; i < supportLanguages.length; i++) {
            if (splitLocale === supportLanguages[i].split('-')[0]) {
                support = true;
                break;
            }
        }
    }
    return support;
}
/**
 *
 * @param helpKey reference helop-doc build-apps part
 */
function getBuildAppsHelpLink(helpKey) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield _getHelpLinkUrl('build-apps', helpKey);
    });
}
function getHomeHelpLink() {
    return __awaiter(this, void 0, void 0, function* () {
        if (window.jimuConfig.isDevEdition) {
            return yield _getHelpLinkUrl(undefined, 'home', true);
        }
        return yield _getHelpLinkUrl('get-started', 'what-is-arcgis-experience-builder', true);
        // return _getHelpLinkUrl(undefined, 'home')
    });
}
function getWhatsNewLink() {
    return __awaiter(this, void 0, void 0, function* () {
        return yield _getHelpLinkUrl('get-started', 'whats-new', true);
    });
}
/**
 *
 * @param helpKey the name prop in the widget manifest
 * include section and layout widget
 */
function getWidgetHelpLink(helpKey) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield _getHelpLinkUrl('widgets', helpKey);
    });
}
function _getHelpLinkUrl(type, helpKey, isHome) {
    return __awaiter(this, void 0, void 0, function* () {
        let helpId = null;
        helpKey = helpKey.toLowerCase();
        let baseUrl;
        if (window.jimuConfig.isDevEdition) { // master-dev.
            baseUrl = 'https://developers.arcgis.com/experience-builder/';
            const helpDoc = helpDocJson.dev;
            if (type) {
                helpId = `${helpDoc[type].prefix}${helpDoc[type][helpKey]}`;
            }
            else {
                helpId = `${helpDoc[helpKey]}`;
            }
            let onlineHelp = baseUrl + '#';
            if (!helpId) {
                return yield Promise.resolve(onlineHelp);
            }
            onlineHelp = baseUrl + helpId;
            return yield Promise.resolve(onlineHelp);
        }
        else {
            const portalUrl = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl;
            if (!window.jimuConfig.isInPortal) {
                const helpDoc = helpDocJson.online;
                if (type) {
                    helpId = `${helpDoc[type].prefix}${helpDoc[type][helpKey]}`;
                }
                else {
                    helpId = `${helpDoc[helpKey]}`;
                }
                const isProd = portalUrl.includes('maps.arcgis.com') || portalUrl.includes('www.arcgis.com');
                const lead = isProd ? 'doc' : 'docdev';
                baseUrl = 'https://' + lead + '.arcgis.com/en' + '/experience-builder/';
                let onlineHelp = baseUrl + '#';
                if (!helpId) {
                    return yield Promise.resolve(onlineHelp);
                }
                onlineHelp = baseUrl + helpId;
                if (!isSupportLanguage()) {
                    return yield Promise.resolve(onlineHelp);
                }
                else {
                    const selfUrl = jimu_core__WEBPACK_IMPORTED_MODULE_0__.portalUrlUtils.getPortalSelfInfoUrl(portalUrl);
                    const helpUrl = _getHelpLinkForAGOL(selfUrl, helpId, onlineHelp);
                    return yield Promise.resolve(helpUrl);
                }
            }
            else { // for portal
                const portalLocale = window.locale || 'en';
                const helpDoc = helpDocJson.portal;
                if (type) {
                    helpId = `${helpDoc[type][helpKey]}`;
                }
                else {
                    helpId = `${helpDoc[helpKey]}`;
                }
                const headers = {
                    'Content-Type': 'text/json'
                };
                const helpBase = _getHelpBaseForPortal(portalUrl, portalLocale);
                const helpHome = helpBase.includes('https:') ? helpBase + '/experience-builder' : helpBase;
                return yield fetch(portalUrl + '/sharing/rest/portals/helpmap?f=json', {
                    method: 'get',
                    headers: headers
                })
                    .then((res) => __awaiter(this, void 0, void 0, function* () { return yield res.json(); }))
                    .then((help) => __awaiter(this, void 0, void 0, function* () {
                    if (help && help.helpMap && help.helpMap.m && helpId && help.helpMap.m[helpId]) {
                        // Portal will redirect en help doc, if portalLocale help doc doesn't be installed.
                        const portalHelp = helpBase + '/' + help.helpMap.m[helpId];
                        return yield Promise.resolve(portalHelp);
                    }
                    else {
                        return isHome ? yield Promise.resolve(helpHome) : yield getHomeHelpLink();
                    }
                })).catch((err) => __awaiter(this, void 0, void 0, function* () {
                    console.warn(err);
                    return isHome ? yield Promise.resolve(helpHome) : yield getHomeHelpLink();
                }));
            }
        }
    });
}
function _getHelpBaseForPortal(portalUrl, portalLocale) {
    let baseUrl = '';
    const portalSelf = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalSelf;
    const parts = portalSelf === null || portalSelf === void 0 ? void 0 : portalSelf.helpBase.split('/');
    if (parts === null || parts === void 0 ? void 0 : parts.includes('https:')) { // online: 'https://enterprise.arcgis.com/en/', 'https://enterprise-k8s.arcgis.com/en/'
        const locale = isSupportLanguage() ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.findLocale(window.locale, supportLanguages) : 'en';
        baseUrl = parts.slice(0, 3).join('/') + '/' + locale;
    }
    else { // local: '/gis/portalhelp/en' (Windows & Linux: 'portalhelp', Kubernetes: 'help')
        baseUrl = portalUrl + '/' + (parts === null || parts === void 0 ? void 0 : parts[2]) + '/' + portalLocale;
    }
    return baseUrl;
}
function _getHelpLinkForAGOL(selfUrl, helpId, defaultHelpLink) {
    let baseUrl;
    const portalSelf = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalSelf;
    if (portalSelf && portalSelf.helpBase) {
        try {
            // The returned locale of helpBase is already in the supportLanguages by request with window.lcoale. So no need to extra check.
            const parts = portalSelf.helpBase.split('/').slice(0, 4);
            baseUrl = parts.join('/') +
                '/experience-builder/';
        }
        catch (err) {
            return defaultHelpLink;
        }
        return baseUrl ? (baseUrl + helpId) : defaultHelpLink;
    }
    else {
        return defaultHelpLink;
    }
}


/***/ }),

/***/ "./jimu-for-builder/lib/utils/layout-write-utils.ts":
/*!**********************************************************!*\
  !*** ./jimu-for-builder/lib/utils/layout-write-utils.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   cleanupLayoutStructure: () => (/* binding */ cleanupLayoutStructure),
/* harmony export */   cleanupRuntimeLayouts: () => (/* binding */ cleanupRuntimeLayouts),
/* harmony export */   cleanupSizemodeLayoutStructure: () => (/* binding */ cleanupSizemodeLayoutStructure),
/* harmony export */   createEmptyLayoutItem: () => (/* binding */ createEmptyLayoutItem),
/* harmony export */   removeItemFromParent: () => (/* binding */ removeItemFromParent)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-layouts/layout-runtime */ "jimu-layouts/layout-runtime");


/**
 * Remove the item id from its parent's content
 * @param layoutInfo
 * @param deleteFromLayout
 * @param layouts
 */
function removeItemFromParent(layoutInfo, deleteFromLayout, layouts) {
    const { layoutId, layoutItemId } = layoutInfo;
    if (!layouts[layoutId]) {
        return layouts;
    }
    const layoutItem = layouts[layoutId].content[layoutItemId];
    if (!layoutItem) {
        return layouts;
    }
    const layout = layouts[layoutId];
    let updatedLayouts = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(layouts);
    if (layout.order && layout.order.includes(layoutItemId)) {
        const filterContent = [];
        layout.order.forEach(id => {
            if (id !== layoutItemId) {
                filterContent.push(id);
            }
        });
        updatedLayouts = updatedLayouts.setIn([layoutId, 'order'], filterContent);
    }
    if (deleteFromLayout) {
        updatedLayouts = updatedLayouts.setIn([layoutId, 'content'], updatedLayouts[layoutId].content.without(layoutItemId));
    }
    return updatedLayouts;
}
function createEmptyLayoutItem(layoutId, layouts) {
    const nextId = jimu_layouts_layout_runtime__WEBPACK_IMPORTED_MODULE_1__.utils.getMaximumId(layouts[layoutId]) + 1;
    let updatedLayouts = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.Immutable)(layouts);
    const newItem = {
        id: `${nextId}`
    };
    updatedLayouts = updatedLayouts.setIn([layoutId, 'content', newItem.id], newItem);
    return {
        layoutInfo: {
            layoutId: layoutId,
            layoutItemId: newItem.id
        },
        layouts: updatedLayouts
    };
}
function cleanupRuntimeLayouts(layouts) {
    Object.keys(layouts).forEach(layoutId => {
        const layout = layouts[layoutId];
        delete layout.id;
        if (layout.content) {
            Object.keys(layout.content).forEach(id => {
                const layoutItem = layout.content[id];
                delete layoutItem.id;
            });
        }
    });
    return layouts;
}
function cleanupLayoutStructure(appConfig, layoutId) {
    var _a;
    const layout = appConfig.layouts[layoutId];
    if (!layout) {
        return appConfig;
    }
    delete layout.parent;
    Object.keys((_a = layout.content) !== null && _a !== void 0 ? _a : {}).forEach((itemId) => {
        const layoutItem = layout.content[itemId];
        switch (layoutItem.type) {
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget:
                {
                    const widgetJson = appConfig.widgets[layoutItem.widgetId];
                    if (widgetJson) {
                        delete widgetJson.parent;
                        if (widgetJson.layouts) {
                            Object.values(widgetJson.layouts).forEach((layouts) => {
                                appConfig = cleanupSizemodeLayoutStructure(appConfig, layouts);
                            });
                        }
                    }
                    break;
                }
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Section:
                {
                    const sectionJson = appConfig.sections[layoutItem.sectionId];
                    delete sectionJson.parent;
                    sectionJson.views.forEach(viewId => {
                        const viewJson = appConfig.views[viewId];
                        delete viewJson.parent;
                        appConfig = cleanupSizemodeLayoutStructure(appConfig, viewJson.layout);
                    });
                    break;
                }
            case jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.ScreenGroup:
                {
                    const sgJson = appConfig.screenGroups[layoutItem.screenGroupId];
                    delete sgJson.parent;
                    sgJson.screens.forEach(screenId => {
                        var _a;
                        const screenJson = appConfig.screens[screenId];
                        delete screenJson.parent;
                        appConfig = cleanupSizemodeLayoutStructure(appConfig, screenJson.main.layout);
                        if ((_a = screenJson.panel) === null || _a === void 0 ? void 0 : _a.layout) {
                            appConfig = cleanupSizemodeLayoutStructure(appConfig, screenJson.panel.layout);
                        }
                    });
                    break;
                }
        }
    });
    return appConfig;
}
function cleanupSizemodeLayoutStructure(appConfig, sizeModeLayout) {
    Object.values(sizeModeLayout !== null && sizeModeLayout !== void 0 ? sizeModeLayout : {}).forEach(layoutId => {
        appConfig = cleanupLayoutStructure(appConfig, layoutId);
    });
    return appConfig;
}


/***/ }),

/***/ "./jimu-for-builder/lib/utils/template-utils.ts":
/*!******************************************************!*\
  !*** ./jimu-for-builder/lib/utils/template-utils.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   processForTemplate: () => (/* binding */ processForTemplate)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");

/**
 *
 * @param templateJson
 * @param widgetId widget name is used to get translation. This is for the case that widget has internal templates such as list, card, etc.
 *    for other templates, pass null
 * @param defaultMessages
 */
function processForTemplate(templateJson, widgetId, defaultMessages) {
    (templateJson === null || templateJson === void 0 ? void 0 : templateJson.config) && jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.fixLayoutIds(templateJson.config);
    const intl = widgetId ? jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl(widgetId, 'setting') : jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.getIntl();
    templateJson = jimu_core__WEBPACK_IMPORTED_MODULE_0__.utils.replaceI18nPlaceholdersInObject(templateJson, intl, defaultMessages);
    return templateJson;
}


/***/ }),

/***/ "./jimu-for-builder/lib/utils/utils.ts":
/*!*********************************************!*\
  !*** ./jimu-for-builder/lib/utils/utils.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CUSTOM_GROUP: () => (/* binding */ CUSTOM_GROUP),
/* harmony export */   fetchCommonWidgetList: () => (/* binding */ fetchCommonWidgetList),
/* harmony export */   fetchRemoteCustomWidgetList: () => (/* binding */ fetchRemoteCustomWidgetList),
/* harmony export */   getDefaultSectionIcon: () => (/* binding */ getDefaultSectionIcon),
/* harmony export */   getDefaultTocDialogIcon: () => (/* binding */ getDefaultTocDialogIcon),
/* harmony export */   getDefaultTocPageIcon: () => (/* binding */ getDefaultTocPageIcon),
/* harmony export */   getPageListByDialogId: () => (/* binding */ getPageListByDialogId),
/* harmony export */   showCustomWidgets: () => (/* binding */ showCustomWidgets),
/* harmony export */   showRemoteCustomWidgets: () => (/* binding */ showRemoteCustomWidgets)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_icons_svg_outlined_data_page_svg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-icons/svg/outlined/data/page.svg */ "./jimu-icons/svg/outlined/data/page.svg");
/* harmony import */ var jimu_icons_svg_outlined_data_page_svg__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_data_page_svg__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var jimu_icons_svg_outlined_data_link_tilted_svg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jimu-icons/svg/outlined/data/link-tilted.svg */ "./jimu-icons/svg/outlined/data/link-tilted.svg");
/* harmony import */ var jimu_icons_svg_outlined_data_link_tilted_svg__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_data_link_tilted_svg__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var jimu_icons_svg_outlined_application_folder_svg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jimu-icons/svg/outlined/application/folder.svg */ "./jimu-icons/svg/outlined/application/folder.svg");
/* harmony import */ var jimu_icons_svg_outlined_application_folder_svg__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_application_folder_svg__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jimu_icons_svg_outlined_application_dialog_svg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jimu-icons/svg/outlined/application/dialog.svg */ "./jimu-icons/svg/outlined/application/dialog.svg");
/* harmony import */ var jimu_icons_svg_outlined_application_dialog_svg__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_application_dialog_svg__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! jimu-icons/svg/outlined/brand/widget-section.svg */ "./jimu-icons/svg/outlined/brand/widget-section.svg");
/* harmony import */ var jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_5__);
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






function getDefaultTocPageIcon(pageJson, formatMessage, pagelabel) {
    let icon;
    if (pageJson.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Folder) {
        icon = {
            svg: (jimu_icons_svg_outlined_application_folder_svg__WEBPACK_IMPORTED_MODULE_3___default()),
            properties: {
                filename: 'folder',
                originalName: 'outlined/application/folder.svg',
                path: ['general', 'folder'],
                color: 'var(--dark-800)',
                inlineSvg: true
            }
        };
    }
    else if (pageJson.type === jimu_core__WEBPACK_IMPORTED_MODULE_0__.PageType.Link) {
        icon = {
            svg: (jimu_icons_svg_outlined_data_link_tilted_svg__WEBPACK_IMPORTED_MODULE_2___default()),
            properties: {
                filename: 'link',
                originalName: 'outlined/data/link-tilted.svg',
                path: ['general', 'link'],
                color: 'var(--dark-800)',
                inlineSvg: true
            }
        };
    }
    else {
        icon = {
            svg: (jimu_icons_svg_outlined_data_page_svg__WEBPACK_IMPORTED_MODULE_1___default()),
            properties: {
                filename: pagelabel || (formatMessage === null || formatMessage === void 0 ? void 0 : formatMessage('page')) || '',
                originalName: 'outlined/data/page.svg',
                color: 'var(--dark-800)',
                inlineSvg: true
            }
        };
    }
    return icon;
}
function getDefaultTocDialogIcon() {
    return (jimu_icons_svg_outlined_application_dialog_svg__WEBPACK_IMPORTED_MODULE_4___default());
}
function getDefaultSectionIcon() {
    return (jimu_icons_svg_outlined_brand_widget_section_svg__WEBPACK_IMPORTED_MODULE_5___default());
}
/**
 * Get related page id by dialog's id.
 */
function getPageListByDialogId(pages, dialogId) {
    if (!pages) {
        return [];
    }
    const pageList = [];
    // eslint-disable-next-line
    Object.keys(pages).some(id => {
        if (pages[id].autoOpenDialogId === dialogId) {
            pageList.push({ id: id, label: pages[id].label });
        }
    });
    return pageList;
}
let fetchCommonWidgetListPromise = null;
function fetchCommonWidgetList() {
    if (!fetchCommonWidgetListPromise) {
        fetchCommonWidgetListPromise = fetch(`${jimu_core__WEBPACK_IMPORTED_MODULE_0__.moduleLoader.resolveModuleFullPath('widgets/')}/widgets-info.json`).then((res) => __awaiter(this, void 0, void 0, function* () { return yield res.json(); })).then((widgetInfo) => {
            const list = widgetInfo.map(w => {
                var _a, _b;
                w.manifest = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.addWidgetManifestProperties(w.manifest);
                const locale = jimu_core__WEBPACK_IMPORTED_MODULE_0__.i18n.findLocale((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext.locale, w.manifest.translatedLocales);
                const listItemTemplate = {
                    itemType: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget,
                    name: w.name,
                    label: ((_a = w.i18nLabel) === null || _a === void 0 ? void 0 : _a[locale]) || w.manifest.label || w.name,
                    desription: ((_b = w.i18nDescription) === null || _b === void 0 ? void 0 : _b[locale]) || w.manifest.desription || w.name,
                    uri: w.uri,
                    manifest: w.manifest,
                    icon: '../' + w.icon,
                    group: w.group,
                    order: w.order
                };
                return listItemTemplate;
            });
            return list;
        }).catch(err => {
            console.error('Failed to fetch common widget list. ', err);
            return [];
        });
    }
    return fetchCommonWidgetListPromise;
}
let fetchRemoteCustomWidgetListPromise = null;
/**
 * Fetch remote custom widgets from AGOL or portal.
 */
function fetchRemoteCustomWidgetList() {
    if (!showRemoteCustomWidgets()) {
        return Promise.resolve([]);
    }
    if (!fetchRemoteCustomWidgetListPromise) {
        // const isPortal = getAppStore().getState().portalSelf?.isPortal
        const q = 'type:"Experience Builder Widget" AND typekeywords:"Widget"'; // 'type:"Experience Builder Widget" AND typekeywords:"Hosted Widget"'
        fetchRemoteCustomWidgetListPromise = jimu_core__WEBPACK_IMPORTED_MODULE_0__.esri.restPortal.searchItems({ q, num: 100, start: 0, authentication: jimu_core__WEBPACK_IMPORTED_MODULE_0__.SessionManager.getInstance().getSessionByUrl((0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().portalUrl) }).then(res => res.results).then(items => {
            let list = [];
            items.forEach((item, index) => {
                if (!item.url) {
                    return;
                }
                const uri = getCustomUriByItemUrl(item.url);
                const widgetContext = jimu_core__WEBPACK_IMPORTED_MODULE_0__.appConfigUtils.getWidgetContext(uri);
                const listItemTemplate = {
                    itemType: jimu_core__WEBPACK_IMPORTED_MODULE_0__.LayoutItemType.Widget,
                    name: item.url, // TODO parse url
                    label: item.title,
                    itemId: item.id,
                    manifest: {},
                    icon: `${widgetContext.folderUrl}icon.svg`,
                    uri: widgetContext.folderUrl,
                    group: CUSTOM_GROUP,
                    order: index
                };
                list = list.concat(listItemTemplate);
            });
            return Promise.allSettled(list.map(l => fetch(`${l.uri}manifest.json`).then(res => res.json()))).then(res => res.map(r => r.status === 'fulfilled' ? r.value : null)).then(manifests => {
                return list.map((l, i) => (Object.assign(Object.assign({}, l), { manifest: manifests[i] || { defaultSize: { width: 400, height: 400 } } })));
            });
        }).catch(err => {
            console.error('Failed to fetch custom widget list. ', err);
            return [];
        });
    }
    return fetchRemoteCustomWidgetListPromise;
}
function getCustomUriByItemUrl(itemUrl) {
    let uri;
    if (/manifest\.json$/.test(itemUrl)) {
        uri = itemUrl.substring(0, itemUrl.length - 'manifest.json'.length);
    }
    else if (/\/$/.test(itemUrl)) {
        uri = itemUrl;
    }
    else {
        uri = itemUrl + '/';
    }
    uri = uri.replace(/^http:\/\//, 'https://');
    return uri;
}
function showRemoteCustomWidgets() {
    var _a, _b;
    return (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appContext) === null || _a === void 0 ? void 0 : _a.jimuConfig) === null || _b === void 0 ? void 0 : _b.isInPortal;
}
function showCustomWidgets(commonWidgetList) {
    return showRemoteCustomWidgets() || (commonWidgetList === null || commonWidgetList === void 0 ? void 0 : commonWidgetList.some(w => w.group === CUSTOM_GROUP));
}
const CUSTOM_GROUP = 7;


/***/ }),

/***/ "./jimu-for-builder/lib/widget-setting-manager.tsx":
/*!*********************************************************!*\
  !*** ./jimu-for-builder/lib/widget-setting-manager.tsx ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WidgetSettingManager: () => (/* binding */ WidgetSettingManager),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var jimu_theme__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-theme */ "jimu-theme");
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./builder-state-store-extension */ "./jimu-for-builder/lib/builder-state-store-extension.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




const { getLocaleToLoad, loadLocaleMessages } = jimu_core__WEBPACK_IMPORTED_MODULE_2__.i18n;
class WidgetSettingManager {
    /** Return the singleton `WidgetSettingManager` instance. */
    static getInstance() {
        if (!WidgetSettingManager.instance) {
            WidgetSettingManager.instance = new WidgetSettingManager();
            window._widgetSettingManager = WidgetSettingManager.instance;
        }
        return WidgetSettingManager.instance;
    }
    constructor() {
        this.settings = {};
        (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.observeStore)(this.onStoreChange.bind(this), ['appStateInBuilder', 'appConfig', 'widgets']);
    }
    getWidgetUri(widgetId) {
        var _a, _b, _c;
        const appConfig = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig;
        return (_c = (_b = appConfig === null || appConfig === void 0 ? void 0 : appConfig.widgets) === null || _b === void 0 ? void 0 : _b[widgetId]) === null || _c === void 0 ? void 0 : _c.uri;
    }
    getWidgetManifestByUri(uri) {
        var _a, _b, _c;
        const widgets = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig) === null || _b === void 0 ? void 0 : _b.widgets;
        const widgetId = Object.keys(widgets || {}).find(wId => widgets[wId].uri === uri);
        return (_c = widgets[widgetId]) === null || _c === void 0 ? void 0 : _c.manifest;
    }
    // for easy test
    updateWidgetCache(uri, obj) {
        if (!this.settings[uri]) {
            this.settings[uri] = {};
        }
        for (const k in obj) {
            this.settings[uri][k] = obj[k];
        }
    }
    getWidgetSettingClass(widgetId) {
        var _a;
        return (_a = this.settings[this.getWidgetUri(widgetId)]) === null || _a === void 0 ? void 0 : _a.settingClazz;
    }
    destroyWidgetSettingClass(widgetId) {
        const uri = this.getWidgetUri(widgetId);
        if (uri) {
            delete this.settings[uri];
        }
    }
    destroyWidgetSettingClassByUri(uri) {
        if (this.checkWidgetUriInConfig(uri)) {
            return;
        }
        delete this.settings[uri];
    }
    getItemSettingClass(widgetId) {
        var _a;
        return (_a = this.settings[this.getWidgetUri(widgetId)]) === null || _a === void 0 ? void 0 : _a.itemSettingClazz;
    }
    getSettingI18nMessagesByUri(widgetUri) {
        var _a;
        return (_a = this.settings[widgetUri]) === null || _a === void 0 ? void 0 : _a.settingI18nMessage;
    }
    destoryAllWidgetSettingClasses() {
        this.settings = {};
    }
    /** Load the widget setting class by widget id. A widget setting class is loaded only one time. */
    loadWidgetSettingClass(widgetId) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            const widgetJson = (_c = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig) === null || _b === void 0 ? void 0 : _b.widgets) === null || _c === void 0 ? void 0 : _c[widgetId];
            if (!widgetJson) {
                return yield Promise.resolve(null);
            }
            if (!widgetJson.manifest) {
                return yield Promise.resolve(null);
            }
            const widgetUri = this.getWidgetUri(widgetId);
            return this.loadWidgetSettingClassByUri(widgetUri);
        });
    }
    checkWidgetUriInConfig(widgetUri) {
        var _a, _b;
        const widgets = ((_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig) === null || _b === void 0 ? void 0 : _b.widgets) || {};
        return !!Object.keys(widgets).find(wId => widgets[wId].uri === widgetUri);
    }
    loadWidgetSettingClassByUri(uri) {
        if (!this.settings[uri]) {
            this.settings[uri] = {};
        }
        if (this.settings[uri].settingClazzPromise) {
            return this.settings[uri].settingClazzPromise;
        }
        this.settings[uri].settingClazzPromise = this.loadRawSettingClass(uri).then(() => __awaiter(this, void 0, void 0, function* () {
            return yield this.loadI18nMessagesForSetting(uri);
        })).then(() => {
            const wrappedSetting = this.injectWidgetSettingProps(uri);
            if (!wrappedSetting) {
                delete this.settings[uri];
                return null;
            }
            this.settings[uri].settingClazz = wrappedSetting;
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.widgetSettingClassLoaded(uri));
            return wrappedSetting;
        });
        return this.settings[uri].settingClazzPromise;
    }
    loadRawSettingClass(uri) {
        return __awaiter(this, void 0, void 0, function* () {
            const manifest = this.getWidgetManifestByUri(uri);
            let settingUri = `${uri}dist/setting/setting`;
            if (!manifest.properties.hasSettingPage) {
                settingUri = 'jimu-for-builder/json-editor-setting';
            }
            return yield this.loadWidgetSettingDependency(uri).then(() => __awaiter(this, void 0, void 0, function* () {
                return yield jimu_core__WEBPACK_IMPORTED_MODULE_2__.moduleLoader.loadModule(settingUri);
            })).then(clazz => {
                const rawSettingClass = clazz.default ? clazz.default : clazz;
                this.settings[uri].rawSettingClazz = rawSettingClass;
                return rawSettingClass;
            });
        });
    }
    loadI18nMessagesForSetting(uri) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.settings[uri]) {
                this.settings[uri] = {};
            }
            if (this.settings[uri].settingI18nMessagePromise) {
                return yield this.settings[uri].settingI18nMessagePromise;
            }
            const manifest = this.getWidgetManifestByUri(uri);
            if (!manifest) {
                return yield Promise.resolve({});
            }
            if (manifest.translatedLocales) {
                let locale = (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().getState().appContext.locale;
                locale = getLocaleToLoad(locale, manifest.translatedLocales);
                if (locale) {
                    this.settings[uri].settingI18nMessagePromise = loadLocaleMessages(`${uri}dist/setting/translations`, locale);
                }
                else {
                    this.settings[uri].settingI18nMessagePromise = Promise.resolve({});
                }
            }
            else {
                this.settings[uri].settingI18nMessagePromise = Promise.resolve({});
            }
            return yield this.settings[uri].settingI18nMessagePromise.then((i18nMessages = {}) => {
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().dispatch(_builder_state_store_extension__WEBPACK_IMPORTED_MODULE_3__.builderActions.widgetSettingI18nMessageLoaded(manifest.name, i18nMessages));
                this.settings[uri].settingI18nMessage = i18nMessages;
                return i18nMessages;
            });
        });
    }
    loadWidgetSettingDependency(uri) {
        return __awaiter(this, void 0, void 0, function* () {
            const manifest = this.getWidgetManifestByUri(uri);
            if (!manifest.settingDependency) {
                yield Promise.resolve();
                return;
            }
            const widgetDependencies = (typeof manifest.settingDependency === 'string' ? [manifest.settingDependency] : manifest.settingDependency);
            yield (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.loadDependencies)(widgetDependencies);
        });
    }
    loadItemSettingClass(widgetId) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            const widgetJson = (_c = (_b = (_a = (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.getAppStore)().getState().appStateInBuilder) === null || _a === void 0 ? void 0 : _a.appConfig) === null || _b === void 0 ? void 0 : _b.widgets) === null || _c === void 0 ? void 0 : _c[widgetId];
            if (!widgetJson) {
                return yield Promise.resolve(null);
            }
            if (!widgetJson.manifest) {
                return yield Promise.resolve(null);
            }
            return yield this.loadItemSettingClassByUri(this.getWidgetUri(widgetId));
        });
    }
    loadItemSettingClassByUri(uri) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.settings[uri]) {
                this.settings[uri] = {};
            }
            if (this.settings[uri].itemSettingClazzPromise) {
                return this.settings[uri].itemSettingClazzPromise;
            }
            this.settings[uri].itemSettingClazzPromise = this.loadRawItemSettingClass(uri).then((itemClazz) => {
                this.settings[uri].itemSettingClazz = itemClazz;
                return itemClazz;
            });
            return this.settings[uri].itemSettingClazzPromise;
        });
    }
    loadRawItemSettingClass(uri) {
        return __awaiter(this, void 0, void 0, function* () {
            const itemUri = `${uri}dist/setting/item-setting`;
            return yield jimu_core__WEBPACK_IMPORTED_MODULE_2__.moduleLoader.loadModule(itemUri).then(clazz => {
                return clazz.default ? clazz.default : clazz;
            });
        });
    }
    injectWidgetSettingProps(uri) {
        if (!this.checkWidgetUriInConfig(uri)) {
            return null;
        }
        const rawSettingClazz = this.settings[uri].rawSettingClazz;
        const IntlInjectedComponent = (0,jimu_core__WEBPACK_IMPORTED_MODULE_2__.injectIntl)(rawSettingClazz);
        const ThemedWidgetWrapper = (0,jimu_theme__WEBPACK_IMPORTED_MODULE_1__.withTheme)(IntlInjectedComponent, true);
        const manifest = this.getWidgetManifestByUri(uri);
        const widgetName = manifest.name;
        const i18nMessages = this.settings[uri].settingI18nMessage;
        class WidgetSettingWrapper extends react__WEBPACK_IMPORTED_MODULE_0__.PureComponent {
            render() {
                if (manifest.version !== this.props.version) {
                    return null;
                }
                const injectProps = {
                    messages: i18nMessages
                };
                // merge in the app's messages before creating the context so that
                // any jimu-ui components in this component can have access to their own messages
                // NOTE: messages with the same key will be overridden, so please make sure widget do not use the same key with jimu.
                if (true) {
                    const k = i18nMessages && Object.keys(i18nMessages).find(k => !!this.props.appI18nMessages[k]);
                    if (k) {
                        console.error('Widget translation key conflict.', `Widget: ${widgetName}, key: ${k}`);
                    }
                }
                const allMessages = Object.assign({}, i18nMessages, this.props.appI18nMessages);
                return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(jimu_core__WEBPACK_IMPORTED_MODULE_2__.IntlProvider, { locale: this.props.locale, defaultLocale: this.props.locale, messages: allMessages },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement(ThemedWidgetWrapper, Object.assign({}, this.props, injectProps))));
            }
        }
        WidgetSettingWrapper.displayName = `WidgetSettingWrapper(${widgetName})`;
        const mapStateToProps = (state, ownProps) => {
            const props = {
                queryObject: state.queryObject,
                user: state.user,
                token: state.token,
                portalUrl: state.portalUrl,
                portalSelf: state.portalSelf,
                locale: state.appContext.locale,
                appI18nMessages: state.appI18nMessages
            };
            const widgetId = ownProps.widgetId;
            const widgetJson = state.appStateInBuilder.appConfig.widgets[widgetId];
            if (!widgetJson) {
                return {};
            }
            const allOwnProps = Object.assign(props, widgetJson, ownProps);
            return Object.assign(allOwnProps, rawSettingClazz.mapExtraStateProps ? rawSettingClazz.mapExtraStateProps(state, allOwnProps) : {});
        };
        return jimu_core__WEBPACK_IMPORTED_MODULE_2__.ReactRedux.connect(mapStateToProps)(WidgetSettingWrapper);
    }
    onStoreChange(preWidgets, widgets) {
        preWidgets && widgets && Object.keys(preWidgets).forEach(preWId => {
            if (!widgets[preWId]) { // widget is removed
                // this.destroyWidgetSettingClassByUri(preWidgets[preWId].uri) // Do not remove for performance reason.
            }
        });
    }
}
/**
 * The `WidgetSettingManager` is used to manage the widget setting.
 */
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (WidgetSettingManager);


/***/ }),

/***/ "./jimu-icons/outlined/data/link-combined.tsx":
/*!****************************************************!*\
  !*** ./jimu-icons/outlined/data/link-combined.tsx ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   LinkCombinedOutlined: () => (/* binding */ LinkCombinedOutlined)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var _svg_outlined_data_link_combined_svg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../svg/outlined/data/link-combined.svg */ "./jimu-icons/svg/outlined/data/link-combined.svg");
/* harmony import */ var _svg_outlined_data_link_combined_svg__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_svg_outlined_data_link_combined_svg__WEBPACK_IMPORTED_MODULE_1__);
var __rest = (undefined && undefined.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};


const LinkCombinedOutlined = (props) => {
    const SVG = window.SVG;
    const { className } = props, others = __rest(props, ["className"]);
    const classes = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.classNames)('jimu-icon jimu-icon-component', className);
    if (!SVG)
        return jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement("svg", Object.assign({ className: classes }, others));
    return jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.createElement(SVG, Object.assign({ className: classes, src: (_svg_outlined_data_link_combined_svg__WEBPACK_IMPORTED_MODULE_1___default()) }, others));
};


/***/ }),

/***/ "jimu-core":
/*!****************************!*\
  !*** external "jimu-core" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_core__;

/***/ }),

/***/ "react":
/*!**********************************!*\
  !*** external "jimu-core/react" ***!
  \**********************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_react__;

/***/ }),

/***/ "jimu-for-builder":
/*!***********************************!*\
  !*** external "jimu-for-builder" ***!
  \***********************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_for_builder__;

/***/ }),

/***/ "jimu-for-builder/templates":
/*!*********************************************!*\
  !*** external "jimu-for-builder/templates" ***!
  \*********************************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_for_builder_templates__;

/***/ }),

/***/ "jimu-layouts/layout-runtime":
/*!**********************************************!*\
  !*** external "jimu-layouts/layout-runtime" ***!
  \**********************************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_layouts_layout_runtime__;

/***/ }),

/***/ "jimu-theme":
/*!*****************************!*\
  !*** external "jimu-theme" ***!
  \*****************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_theme__;

/***/ }),

/***/ "jimu-ui":
/*!**************************!*\
  !*** external "jimu-ui" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_ui__;

/***/ }),

/***/ "./builder/help-doc.json":
/*!*******************************!*\
  !*** ./builder/help-doc.json ***!
  \*******************************/
/***/ ((module) => {

"use strict";
module.exports = JSON.parse('{"online":{"home":"#","get-started":{"prefix":"get-started/","what-is-arcgis-experience-builder":"what-is-arcgis-experience-builder.htm","whats-new":"whats-new.htm"},"build-apps":{"prefix":"build-apps/","add-a-page":"add-a-page.htm","add-a-dialog":"add-windows.htm","add-utility-services":"add-utility-services.htm","add-custom-widgets":"getting-started-widget.htm","add-screen-groups":"add-screen-groups.htm","select-data":"select-data.htm","change-app-theme":"change-app-theme.htm","app-settings":"app-settings.htm"},"widgets":{"prefix":"configure-widgets/","overview":"widgets-overview.htm","3d-toolbox":"3d-toolbox-widget.htm","add-data":"add-data-widget.htm","analysis":"analysis-widget.htm","arcgis-map":"map-widget.htm","basemap-gallery":"basemap-gallery-widget.htm","ba-infographic":"business-analyst-infographic-widget.htm","bookmark":"bookmark-widget.htm","branch-version-management":"branch-version-management-widget.htm","button":"button-widget.htm","card":"card-widget.htm","chart":"chart-widget.htm","column":"column-widget.htm","controller":"widget-controller-widget.htm","coordinates":"coordinates-widget.htm","coordinate-conversion":"coordinate-conversion-widget.htm","divider":"divider-widget.htm","draw":"draw-widget.htm","directions":"directions-widget.htm","edit":"edit-widget.htm","elevation-profile":"elevation-profile-widget.htm","embed":"embed-widget.htm","feature-info":"feature-info-widget.htm","filter":"filter-widget.htm","fixed":"fixed-panel-widget.htm","floor-filter":"floor-filter-widget.htm","fly-controller":"fly-controller-widget.htm","grid":"grid-widget.htm","image":"image-widget.htm","legend":"legend-widget.htm","list":"list-widget.htm","map-layers":"map-layers-widget.htm","menu":"menu-widget.htm","navigator":"view-navigation-widget.htm","near-me":"near-me-widget.htm","oriented-imagery":"oriented-imagery-widget.htm","placeholder":"placeholder-widget.htm","print":"print-widget.htm","query":"query-widget.htm","row":"row-widget.htm","search":"search-widget.htm","section":"section-widget.htm","select":"select-widget.htm","share":"share-widget.htm","sidebar":"sidebar-widget.htm","suitability-modeler":"suitability-modeler-widget.htm","survey123":"survey-widget.htm","swipe":"swipe-widget.htm","table":"table-widget.htm","text":"text-widget.htm","timeline":"timeline-widget.htm","utility-network-trace":"utility-network-trace-widget.htm"}},"portal":{"home":"120001864","get-started":{"what-is-arcgis-experience-builder":"120001877","whats-new":"120002535"},"build-apps":{"add-a-page":"120001863","add-a-dialog":"120002539","add-utility-services":"120003733","add-custom-widgets":"120003728","add-screen-groups":"120002592","select-data":"120002590","change-app-theme":"120004139"},"widgets":{"overview":"#","3d-toolbox":"120003734","add-data":"120004128","analysis":"120004647","arcgis-map":"120001851","basemap-gallery":"120004168","bookmark":"120002536","button":"120001841","branch-version-management":"120002654","ba-infographic":"120003631","card":"120002537","chart":"120002727","column":"120001842","controller":"120001862","coordinates":"120003879","coordinate-conversion":"120002728","divider":"120002538","draw":"120003632","directions":"120003635","edit":"120002844","elevation-profile":"120002905","embed":"120001843","feature-info":"120001844","filter":"120001845","fixed":"120001846","floor-filter":"120003634","fly-controller":"120001847","grid":"120003880","image":"120001848","legend":"120001849","list":"120001850","map-layers":"120001852","menu":"120001853","navigator":"120001861","near-me":"120004170","oriented-imagery":"120002843","placeholder":"120001854","print":"120003716","query":"120002729","row":"120001855","search":"120002845","section":"120001856","select":"120004732","share":"120001857","sidebar":"120001858","suitability-modeler":"120002906","survey123":"120001859","swipe":"120004169","table":"120002591","text":"120001860","timeline":"120003717","utility-network-trace":"120003633"}},"dev":{"home":"#","get-started":{"prefix":"guide/","what-is-arcgis-experience-builder":"getting-started-widget","whats-new":"whats-new"},"build-apps":{"prefix":"guide/","add-a-page":"add-a-page","add-a-dialog":"add-windows","add-utility-services":"add-utility-services","add-custom-widgets":"getting-started-widget","add-screen-groups":"add-screen-groups","select-data":"select-data","change-app-theme":"change-app-theme"},"widgets":{"prefix":"guide/","overview":"widgets-overview","3d-toolbox":"3d-toolbox-widget","add-data":"add-data-widget","analysis":"analysis-widget","arcgis-map":"map-widget","basemap-gallery":"basemap-gallery-widget","ba-infographic":"business-analyst-infographic-widget","bookmark":"bookmark-widget","branch-version-management":"branch-version-management-widget","button":"button-widget","card":"card-widget","chart":"chart-widget","column":"column-widget","controller":"widget-controller-widget","coordinates":"coordinates-widget","coordinate-conversion":"coordinate-conversion-widget","divider":"divider-widget","draw":"draw-widget","directions":"directions-widget","edit":"edit-widget","elevation-profile":"elevation-profile-widget","embed":"embed-widget","feature-info":"feature-info-widget","filter":"filter-widget","fixed":"fixed-panel-widget","floor-filter":"floor-filter-widget","fly-controller":"fly-controller-widget","grid":"grid-widget","image":"image-widget","legend":"legend-widget","list":"list-widget","map-layers":"map-layers-widget","menu":"menu-widget","navigator":"view-navigation-widget","near-me":"near-me-widget","oriented-imagery":"oriented-imagery-widget","placeholder":"placeholder-widget","print":"print-widget","query":"query-widget","row":"row-widget","search":"search-widget","section":"section-widget","select":"select-widget","share":"share-widget","sidebar":"sidebar-widget","suitability-modeler":"suitability-modeler-widget","survey123":"survey-widget","swipe":"swipe-widget","table":"table-widget","text":"text-widget","timeline":"timeline-widget","utility-network-trace":"utility-network-trace-widget"}}}');

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./jimu-for-builder/index.tsx");
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()

			);
		}
	};
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamltdS1mb3ItYnVpbGRlci9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNBeUQ7QUFDTTtBQUNOO0FBQ087QUFDVDtBQUN3QjtBQUNQO0FBQ1M7QUFDQztBQUNFO0FBQzVCO0FBQ0E7QUFDQTtBQUVkO0FBQ1M7QUFDVztBQUNIO0FBQ1k7QUFDL0I7QUFDVTtBQU1qRDtBQUV3QztBQUNkO0FBQzBCO0FBQ0o7QUFDRTtBQUNHO0FBQ1o7QUFDaEI7QUFDYztBQUVKOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNuQmxCO0FBQzBDO0FBSzVELElBQUksTUFBTTtBQUNWLElBQUksQ0FBQztJQUNILE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYztBQUN4RCxDQUFDO0FBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztJQUNYOzs7T0FHRztJQUNILE9BQU8sQ0FBQyxLQUFLLENBQUMsb0JBQW9CLENBQUM7QUFDckMsQ0FBQztBQUNNLFNBQVMsbUJBQW1CO0lBQ2pDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNaLE9BQU07SUFDUixDQUFDO0lBRUQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUM7SUFFNUIsTUFBTSxLQUFLLEdBQUcsc0RB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QU0sQ0FBQyxHQUFHO0lBQ3RCLE1BQU0sRUFBRSxTQUFTLEtBQWdCLEtBQUssRUFBaEIsTUFBTSxVQUFLLEtBQUssRUFBaEMsYUFBd0IsQ0FBUTtJQUV0QyxNQUFNLE9BQU8sR0FBRyxxREFBVSxDQUFDLCtCQUErQixFQUFFLFNBQVMsQ0FBQztJQUN0RSxJQUFJLENBQUMsR0FBRztRQUFFLE9BQU8sa0ZBQUssU0FBUyxFQUFFLE9BQU8sSUFBTSxNQUFhLEVBQUk7SUFDL0QsT0FBTywyREFBQyxHQUFHLGtCQUFDLFNBQVMsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLDZFQUFHLElBQU0sTUFBTSxFQUFJO0FBQzFELENBQUM7Ozs7Ozs7Ozs7OztBQ1hEOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7Ozs7Ozs7OztVQ0FBO1VBQ0E7O1VBRUE7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7O1VBRUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7Ozs7O1dDdEJBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxpQ0FBaUMsV0FBVztXQUM1QztXQUNBOzs7OztXQ1BBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EseUNBQXlDLHdDQUF3QztXQUNqRjtXQUNBO1dBQ0E7Ozs7O1dDUEE7Ozs7O1dDQUE7V0FDQTtXQUNBO1dBQ0EsdURBQXVELGlCQUFpQjtXQUN4RTtXQUNBLGdEQUFnRCxhQUFhO1dBQzdEOzs7OztVRU5BO1VBQ0E7VUFDQTtVQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2FwcGxpY2F0aW9uL2RpYWxvZy5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2FwcGxpY2F0aW9uL2ZvbGRlci5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3NjcmVlbi1ncm91cC5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3NjcmVlbi5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3dpZGdldC1jb2x1bW4uc3ZnIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWljb25zL3N2Zy9vdXRsaW5lZC9icmFuZC93aWRnZXQtZml4ZWQtcGFuZWwuc3ZnIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWljb25zL3N2Zy9vdXRsaW5lZC9icmFuZC93aWRnZXQtcGxhY2UtaG9sZGVyLnN2ZyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1pY29ucy9zdmcvb3V0bGluZWQvYnJhbmQvd2lkZ2V0LXJvdy5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3dpZGdldC1zZWN0aW9uLXZpZXcuc3ZnIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWljb25zL3N2Zy9vdXRsaW5lZC9icmFuZC93aWRnZXQtc2VjdGlvbi5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2RhdGEvbGluay1jb21iaW5lZC5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2RhdGEvbGluay10aWx0ZWQuc3ZnIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWljb25zL3N2Zy9vdXRsaW5lZC9kYXRhL3BhZ2Uuc3ZnIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLWJ1aWxkZXItc3luYy50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLWNvbmZpZy1hY3Rpb25zLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9hcHAtY29uZmlnLXNlcnZpY2UvYmFzZS1jb250ZW50LXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1jb25maWctc2VydmljZS9iYXNlLWxheW91dC1zZXJ2aWNlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9hcHAtY29uZmlnLXNlcnZpY2UvY29udGVudC1zZXJ2aWNlLXdyYXBwZXIudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1jb25maWctc2VydmljZS9lbXB0eS1jb250ZW50LXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1jb25maWctc2VydmljZS9pbmRleC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLWNvbmZpZy1zZXJ2aWNlL2xheW91dC1zZXJ2aWNlLXByb3ZpZGVyLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9hcHAtY29uZmlnLXNlcnZpY2Uvc2NyZWVuLWdyb3VwLXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1jb25maWctc2VydmljZS9zZWN0aW9uLXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1jb25maWctc2VydmljZS90ZW1wbGF0ZS1zZXJ2aWNlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9hcHAtY29uZmlnLXNlcnZpY2UvdXRpbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLWNvbmZpZy1zZXJ2aWNlL3dpZGdldC1yZXNvdXJjZS9kYXRhLWFjdGlvbi1zZXJ2aWNlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9hcHAtY29uZmlnLXNlcnZpY2Uvd2lkZ2V0LXJlc291cmNlL2RhdGEtc291cmNlLXNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1jb25maWctc2VydmljZS93aWRnZXQtcmVzb3VyY2UvbWVzc2FnZS1hY3Rpb24tc2VydmljZS50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLWNvbmZpZy1zZXJ2aWNlL3dpZGdldC1yZXNvdXJjZS91c2VtYXAtc2VydmljZS50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLWNvbmZpZy1zZXJ2aWNlL3dpZGdldC1zZXJ2aWNlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9hcHAtZGF0YS1hY3Rpb24tbWFuYWdlci50c3giLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1tZXNzYWdlLW1hbmFnZXIudHN4Iiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9hcHAtcmVzb3VyY2UtbWFuYWdlci50c3giLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2FwcC1zdGF0ZS1oaXN0b3J5LWV4dGVuc2lvbi50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLXN0YXRlLXJlZHV4LXN0b3JlLWV4dGVuc2lvbi50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYXBwLXdpZGdldC1tYW5hZ2VyLnRzeCIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYmFzZS13aWRnZXQtc2V0dGluZy50c3giLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2J1aWxkZXItYXBwLXN5bmMudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2J1aWxkZXIta2V5Ym9hcmQtY29tcG9uZW50LnRzeCIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvYnVpbGRlci1sb2NhbGUudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL2J1aWxkZXItc3RhdGUtcmVzb3VyY2UtZXh0ZW5zaW9uLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9idWlsZGVyLXN0YXRlLXN0b3JlLWV4dGVuc2lvbi50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvaW5pdC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvbWVzc2FnZS1hY3Rpb25zL2ZpbHRlci1kYXRhLXJlY29yZC1hY3Rpb24tc2V0dGluZy50c3giLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL21lc3NhZ2UtYWN0aW9ucy9pbml0LnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9tZXNzYWdlLWFjdGlvbnMvc2VsZWN0LWRhdGEtcmVjb3JkLWFjdGlvbi1zZXR0aW5nLnRzeCIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvcHJvcHMudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvYXBwLXNlcnZpY2UvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvYXBwLXNlcnZpY2UvdXRpbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9qaW11LXJlcXVlc3QvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvamltdS1yZXF1ZXN0L2l0ZW1zL2dldC1jYXRlZ29yeS1zY2hlbWEudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvamltdS1yZXF1ZXN0L2l0ZW1zL2dldC11c2VyLWNvbnRlbnQudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvamltdS1yZXF1ZXN0L2l0ZW1zL2l0ZW1zZ3JvdXBzLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9zZXJ2aWNlL2ppbXUtcmVxdWVzdC9pdGVtcy9zaGFyZS1pdGVtcy50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9qaW11LXJlcXVlc3QvaXRlbXMvdW5zaGFyZS1pdGVtcy50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9qaW11LXJlcXVlc3QvaXRlbXMvdXBkYXRlLXRodW1ibmFpbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9qaW11LXJlcXVlc3QvcmVxdWVzdC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9qaW11LXJlcXVlc3QvdXRpbC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9sb2NhbC1yZXN0LXNlcnZpY2UvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvbG9jYWwtcmVzdC1zZXJ2aWNlL2l0ZW1zL2FkZC50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9sb2NhbC1yZXN0LXNlcnZpY2UvaXRlbXMvY3JlYXRlLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9zZXJ2aWNlL2xvY2FsLXJlc3Qtc2VydmljZS9pdGVtcy9nZXQudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvbG9jYWwtcmVzdC1zZXJ2aWNlL2l0ZW1zL2hlbHBlcnMudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvbG9jYWwtcmVzdC1zZXJ2aWNlL2l0ZW1zL3JlbW92ZS50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS9sb2NhbC1yZXN0LXNlcnZpY2UvaXRlbXMvc2VhcmNoLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9zZXJ2aWNlL2xvY2FsLXJlc3Qtc2VydmljZS9pdGVtcy91cGRhdGUudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvbG9jYWwtcmVzdC1zZXJ2aWNlL3JlcXVlc3QudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvbG9jYWwtcmVzdC1zZXJ2aWNlL3V0aWwudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3NlcnZpY2UvcmVzdC1zZXJ2aWNlLnRzeCIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvc2VydmljZS90eXBlL2luZGV4LnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi9zeW5jLXR5cGUudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3RyYW5zbGF0aW9ucy9kZWZhdWx0LnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi91cmwtY29uZmlnLW1hbmFnZXIudHN4Iiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi91dGlscy9hcHAtY29uZmlnLXV0aWxzLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi91dGlscy9oZWxwLXV0aWxzLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi91dGlscy9sYXlvdXQtd3JpdGUtdXRpbHMudHMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtZm9yLWJ1aWxkZXIvbGliL3V0aWxzL3RlbXBsYXRlLXV0aWxzLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9qaW11LWZvci1idWlsZGVyL2xpYi91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vamltdS1mb3ItYnVpbGRlci9saWIvd2lkZ2V0LXNldHRpbmctbWFuYWdlci50c3giLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtaWNvbnMvb3V0bGluZWQvZGF0YS9saW5rLWNvbWJpbmVkLnRzeCIsIndlYnBhY2s6Ly9leGItY2xpZW50L2V4dGVybmFsIHN5c3RlbSBcImppbXUtY29yZVwiIiwid2VicGFjazovL2V4Yi1jbGllbnQvZXh0ZXJuYWwgc3lzdGVtIFwiamltdS1jb3JlL3JlYWN0XCIiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC9leHRlcm5hbCBzeXN0ZW0gXCJqaW11LWZvci1idWlsZGVyXCIiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC9leHRlcm5hbCBzeXN0ZW0gXCJqaW11LWZvci1idWlsZGVyL3RlbXBsYXRlc1wiIiwid2VicGFjazovL2V4Yi1jbGllbnQvZXh0ZXJuYWwgc3lzdGVtIFwiamltdS1sYXlvdXRzL2xheW91dC1ydW50aW1lXCIiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC9leHRlcm5hbCBzeXN0ZW0gXCJqaW11LXRoZW1lXCIiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC9leHRlcm5hbCBzeXN0ZW0gXCJqaW11LXVpXCIiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9leGItY2xpZW50L3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL2V4Yi1jbGllbnQvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2V4Yi1jbGllbnQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9leGItY2xpZW50L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC93ZWJwYWNrL2JlZm9yZS1zdGFydHVwIiwid2VicGFjazovL2V4Yi1jbGllbnQvd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL2V4Yi1jbGllbnQvd2VicGFjay9hZnRlci1zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgZmlsbD1cXFwibm9uZVxcXCIgdmlld0JveD1cXFwiMCAwIDEyIDEyXFxcIj48cGF0aCBmaWxsPVxcXCIjMDAwXFxcIiBmaWxsLXJ1bGU9XFxcImV2ZW5vZGRcXFwiIGQ9XFxcIk0uMDA3Ljg4M0ExIDEgMCAwIDEgMSAwaDEwbC4xMTcuMDA3QTEgMSAwIDAgMSAxMiAxdjdsLS4wMDcuMTE3QTEgMSAwIDAgMSAxMSA5SDRsLTQgM1Yxek0xMSAxSDF2OWwyLjY2Ny0ySDExek0zIDMuNWEuNS41IDAgMCAxIC41LS41aDVhLjUuNSAwIDAgMSAwIDFoLTVhLjUuNSAwIDAgMS0uNS0uNU0zLjUgNWEuNS41IDAgMCAwIDAgMWg1YS41LjUgMCAwIDAgMC0xelxcXCIgY2xpcC1ydWxlPVxcXCJldmVub2RkXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIHZpZXdCb3g9XFxcIjAgMCAxNiAxNlxcXCI+PHBhdGggZmlsbD1cXFwiIzAwMFxcXCIgZmlsbC1ydWxlPVxcXCJldmVub2RkXFxcIiBkPVxcXCJNMS4zMzMgMGg0Yy43MzcgMCAxLjMzNC41OTcgMS4zMzQgMS4zMzN2MS4zMzRoOEMxNS40MDMgMi42NjcgMTYgMy4yNjQgMTYgNHYxMC42NjdjMCAuNzM2LS41OTcgMS4zMzMtMS4zMzMgMS4zMzNIMS4zMzNBMS4zMzMgMS4zMzMgMCAwIDEgMCAxNC42NjdWMS4zMzNDMCAuNTk3LjU5NyAwIDEuMzMzIDBtMCA3LjMzM3Y3LjMzNGgxMy4zMzRWNy4zMzN6bTAtMS4zMzNoMTMuMzM0VjRINS4zMzRWMS4zMzVoLTR6XFxcIiBjbGlwLXJ1bGU9XFxcImV2ZW5vZGRcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgZmlsbD1cXFwibm9uZVxcXCIgdmlld0JveD1cXFwiMCAwIDE2IDE2XFxcIj48cGF0aCBmaWxsPVxcXCIjMDAwXFxcIiBmaWxsLXJ1bGU9XFxcImV2ZW5vZGRcXFwiIGQ9XFxcIk0yIDJoMTJ2NEgyek0xIDdWMWgxNHY2em0xIDNoMTJ2NEgyem0tMSA1VjloMTR2NnpcXFwiIGNsaXAtcnVsZT1cXFwiZXZlbm9kZFxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiBmaWxsPVxcXCJub25lXFxcIiB2aWV3Qm94PVxcXCIwIDAgMTYgMTZcXFwiPjxwYXRoIGZpbGw9XFxcIiMwMDBcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgZD1cXFwiTTIgMmgxMnYxMkgyek0xIDE1VjFoMTR2MTR6bTQtOWg2djRINXptLTEgNVY1aDh2NnpcXFwiIGNsaXAtcnVsZT1cXFwiZXZlbm9kZFxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiBmaWxsPVxcXCJub25lXFxcIiB2aWV3Qm94PVxcXCIwIDAgMjAgMjBcXFwiPjxwYXRoIGZpbGw9XFxcIiMwMDBcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgZD1cXFwiTTE3IDJhMiAyIDAgMCAwLTItMkg1YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMGEyIDIgMCAwIDAgMi0yek01IDFoMTBhMSAxIDAgMCAxIDEgMXYxNmExIDEgMCAwIDEtMSAxSDVhMSAxIDAgMCAxLTEtMVYyYTEgMSAwIDAgMSAxLTFtMiAyaDZ2Nkg3em0wIDhoMXYySDd6bTIgMGgxdjFIOXptNCAyaC0xdjFoMXptLTYgMWgxdjFIN3ptNCAyaC0xdjFoMXptMS0xaDF2MmgtMXptLTMgMnYtMUg3djF6bTItNmgydjFoLTJ6XFxcIiBjbGlwLXJ1bGU9XFxcImV2ZW5vZGRcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgZmlsbD1cXFwibm9uZVxcXCIgdmlld0JveD1cXFwiMCAwIDIwIDIwXFxcIj48cGF0aCBmaWxsPVxcXCIjMDAwXFxcIiBkPVxcXCJNMyAzaDd2N0gzek0xMSAxMWgxdjJoLTF6TTEzIDExaDF2MWgtMXpNMTcgMTNoLTF2MWgxek0xMSAxNGgxdjFoLTF6TTE1IDE2aC0xdjFoMXpNMTYgMTVoMXYyaC0xek0xMyAxN3YtMWgtMnYxek0xNSAxMWgydjFoLTJ6XFxcIj48L3BhdGg+PHBhdGggZmlsbD1cXFwiIzAwMFxcXCIgZmlsbC1ydWxlPVxcXCJldmVub2RkXFxcIiBkPVxcXCJNMjAgMmEyIDIgMCAwIDAtMi0ySDJhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDE2YTIgMiAwIDAgMCAyLTJ6TTIgMWgxNmExIDEgMCAwIDEgMSAxdjE2YTEgMSAwIDAgMS0xIDFIMmExIDEgMCAwIDEtMS0xVjJhMSAxIDAgMCAxIDEtMVxcXCIgY2xpcC1ydWxlPVxcXCJldmVub2RkXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIHZpZXdCb3g9XFxcIjAgMCAyMCAyMFxcXCI+PHBhdGggZmlsbD1cXFwiIzAwMFxcXCIgZD1cXFwiTTQgNGgydjFINHpNOCA0aDJ2MUg4ek0xNCA0aC0ydjFoMnpNMTUgNGgxdjJoLTF6TTE2IDhoLTF2Mmgxek00IDE0aDF2Mkg0ek01IDZINHYyaDF6TTQgMTBoMXYySDR6TTE2IDEyaC0xdjJoMXpNMTYgMTV2MWgtMnYtMXpNMTIgMTVoLTJ2MWgyek02IDE1aDJ2MUg2elxcXCI+PC9wYXRoPjxwYXRoIGZpbGw9XFxcIiMwMDBcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgZD1cXFwiTTE4IDBhMiAyIDAgMCAxIDIgMnYxNmEyIDIgMCAwIDEtMiAySDJhMiAyIDAgMCAxLTItMlYyYTIgMiAwIDAgMSAyLTJ6bTAgMUgyYTEgMSAwIDAgMC0xIDF2MTZhMSAxIDAgMCAwIDEgMWgxNmExIDEgMCAwIDAgMS0xVjJhMSAxIDAgMCAwLTEtMVxcXCIgY2xpcC1ydWxlPVxcXCJldmVub2RkXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIHZpZXdCb3g9XFxcIjAgMCAyMCAyMFxcXCI+PHBhdGggZmlsbD1cXFwiIzAwMFxcXCIgZD1cXFwiTTMgN2g2djZIM3pNMTEgN2gxdjJoLTF6TTEzIDdoMXYxaC0xek0xNyA5aC0xdjFoMXpNMTEgMTBoMXYxaC0xek0xNSAxMmgtMXYxaDF6TTE2IDExaDF2MmgtMXpNMTMgMTN2LTFoLTJ2MXpNMTUgN2gydjFoLTJ6XFxcIj48L3BhdGg+PHBhdGggZmlsbD1cXFwiIzAwMFxcXCIgZmlsbC1ydWxlPVxcXCJldmVub2RkXFxcIiBkPVxcXCJNMjAgNWEyIDIgMCAwIDAtMi0ySDJhMiAyIDAgMCAwLTIgMnYxMGEyIDIgMCAwIDAgMiAyaDE2YTIgMiAwIDAgMCAyLTJ6TTIgNGgxNmExIDEgMCAwIDEgMSAxdjEwYTEgMSAwIDAgMS0xIDFIMmExIDEgMCAwIDEtMS0xVjVhMSAxIDAgMCAxIDEtMVxcXCIgY2xpcC1ydWxlPVxcXCJldmVub2RkXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIHZpZXdCb3g9XFxcIjAgMCAyMCAyMFxcXCI+PHBhdGggZmlsbD1cXFwiIzAwMFxcXCIgZmlsbC1ydWxlPVxcXCJldmVub2RkXFxcIiBkPVxcXCJNMS4yNSAyLjVoMTcuNXYxMS4yNUgxLjI1ek0wIDIuNWMwLS42OS41Ni0xLjI1IDEuMjUtMS4yNWgxNy41Yy42OSAwIDEuMjUuNTYgMS4yNSAxLjI1djExLjI1YzAgLjY5LS41NiAxLjI1LTEuMjUgMS4yNUgxLjI1Qy41NiAxNSAwIDE0LjQ0IDAgMTMuNzV6bTMuNzUgMTYuMjVoMi41VjE3LjVoLTIuNXptNy41IDBoLTIuNVYxNy41aDIuNXptMi41IDBoMi41VjE3LjVoLTIuNXpcXFwiIGNsaXAtcnVsZT1cXFwiZXZlbm9kZFxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiBmaWxsPVxcXCJub25lXFxcIiB2aWV3Qm94PVxcXCIwIDAgMjAgMjBcXFwiPjxwYXRoIGZpbGw9XFxcIiMwMDBcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgZD1cXFwiTTE0IDJhMiAyIDAgMCAwLTItMkgyYTIgMiAwIDAgMC0yIDJ2MTBhMiAyIDAgMCAwIDIgMmgxMGEyIDIgMCAwIDAgMi0yek0yIDFoMTBhMSAxIDAgMCAxIDEgMXYxMGExIDEgMCAwIDEtMSAxSDJhMSAxIDAgMCAxLTEtMVYyYTEgMSAwIDAgMSAxLTFcXFwiIGNsaXAtcnVsZT1cXFwiZXZlbm9kZFxcXCI+PC9wYXRoPjxwYXRoIGZpbGw9XFxcIiMwMDBcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgZD1cXFwiTTIwIDhhMiAyIDAgMCAwLTItMkg4YTIgMiAwIDAgMC0yIDJ2MTBhMiAyIDAgMCAwIDIgMmgxMGEyIDIgMCAwIDAgMi0yek04IDdoMTBhMSAxIDAgMCAxIDEgMXYxMGExIDEgMCAwIDEtMSAxSDhhMSAxIDAgMCAxLTEtMVY4YTEgMSAwIDAgMSAxLTFcXFwiIGNsaXAtcnVsZT1cXFwiZXZlbm9kZFxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB2aWV3Qm94PVxcXCIwIDAgMTIgNDBcXFwiPjxwYXRoIGZpbGw9XFxcIiNBOEE4QThcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgZD1cXFwiTTYgMzB2MTBIMHYtMWg1di05ek0zLjE2MiAxOC41ODJhLjUuNSAwIDAgMSAwIC43MWwtMS40MTYgMS40MjFhMi40OTcgMi40OTcgMCAwIDAtLjAwMyAzLjU0NWMuOTgzLjk4MyAyLjU2Ljk4IDMuNTQ0LS4wMDNsMS40Mi0xLjQyYS41MDQuNTA0IDAgMCAxIC43MTIuNzEzTDYgMjQuOTY4YTMuNTAyIDMuNTAyIDAgMCAxLTQuOTY3IDAgMy41MDEgMy41MDEgMCAwIDEgMC00Ljk2N2wxLjQxNi0xLjQyMmEuNTA0LjUwNCAwIDAgMSAuNzEzLjAwM200Ljk2Ny0uNzFhLjUuNSAwIDAgMSAwIC43MUw0LjU4IDIyLjEyOWEuNTA0LjUwNCAwIDAgMS0uNzEzLS43MTJsMy41NDgtMy41NDhhLjUwNC41MDQgMCAwIDEgLjcxMy4wMDNtMi44MzgtMi44MzhhMy41MDEgMy41MDEgMCAwIDEgMCA0Ljk2N2wtMS40MiAxLjQxOWEuNTA0LjUwNCAwIDAgMS0uNzEzLS43MTJsMS40MjMtMS40MTdhMi41IDIuNSAwIDAgMCAwLTMuNTQ3IDIuNTAyIDIuNTAyIDAgMCAwLTMuNTQ3IDBsLTEuNDIgMS40MTlhLjUwNC41MDQgMCAwIDEtLjcxMy0uNzEybDEuNDItMS40MmEzLjUwNiAzLjUwNiAwIDAgMSA0Ljk3LjAwM002IDB2MTBINVYxSDBWMHpcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgZmlsbD1cXFwibm9uZVxcXCIgdmlld0JveD1cXFwiMCAwIDE2IDE2XFxcIj48cGF0aCBmaWxsPVxcXCIjMDAwXFxcIiBkPVxcXCJtMS4zNzMgOCAyLjA3LTIuMDcxLjgzLjgyOEwyLjIgOC44MjhhMy41MTUgMy41MTUgMCAwIDAgNC45NyA0Ljk3MWwyLjA3Mi0yLjA3MS44MjguODI4TDggMTQuNjI3QTQuNjg2IDQuNjg2IDAgMSAxIDEuMzczIDhNMTMuNzk5IDcuMTcybC0yLjA3MSAyLjA3LjgyOC44M0wxNC42MjcgOEE0LjY4NiA0LjY4NiAwIDEgMCA4IDEuMzczbC0yLjA3MSAyLjA3LjgyOC44M0w4LjgyOCAyLjJhMy41MTUgMy41MTUgMCAwIDEgNC45NzEgNC45N1xcXCI+PC9wYXRoPjxwYXRoIGZpbGw9XFxcIiMwMDBcXFwiIGQ9XFxcIk01LjUxNSA5LjY1N2EuNTg2LjU4NiAwIDAgMCAuODI4LjgyOGw0LjE0Mi00LjE0MmEuNTg2LjU4NiAwIDAgMC0uODI4LS44Mjh6XFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIHZpZXdCb3g9XFxcIjAgMCAxMiAxMlxcXCI+PHBhdGggZmlsbD1cXFwiIzAwMFxcXCIgZmlsbC1ydWxlPVxcXCJldmVub2RkXFxcIiBkPVxcXCJNMTAuMTY3IDBIMS44MzNBLjg0NS44NDUgMCAwIDAgMSAuODU3djEwLjI4NmMwIC40NzMuMzczLjg1Ny44MzMuODU3aDguMzM0Yy40NiAwIC44MzMtLjM4NC44MzMtLjg1N1YuODU3QS44NDUuODQ1IDAgMCAwIDEwLjE2NyAwTTIgMTFWMWg4djEwem0xLjYtOGg0LjhjLjMzMSAwIC42LjIyNC42LjVzLS4yNjkuNS0uNi41SDMuNmMtLjMzMSAwLS42LS4yMjQtLjYtLjVzLjI2OS0uNS42LS41bTQuOCAzSDMuNmMtLjMzMSAwLS42LjIyNC0uNi41cy4yNjkuNS42LjVoNC44Yy4zMzEgMCAuNi0uMjI0LjYtLjVTOC43MzEgNiA4LjQgNlxcXCIgY2xpcC1ydWxlPVxcXCJldmVub2RkXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJpbXBvcnQgQmFzZVdpZGdldFNldHRpbmcgZnJvbSAnLi9saWIvYmFzZS13aWRnZXQtc2V0dGluZydcbmltcG9ydCBXaWRnZXRTZXR0aW5nTWFuYWdlciBmcm9tICcuL2xpYi93aWRnZXQtc2V0dGluZy1tYW5hZ2VyJ1xuaW1wb3J0IEFwcE1lc3NhZ2VNYW5hZ2VyIGZyb20gJy4vbGliL2FwcC1tZXNzYWdlLW1hbmFnZXInXG5pbXBvcnQgQXBwRGF0YUFjdGlvbk1hbmFnZXIgZnJvbSAnLi9saWIvYXBwLWRhdGEtYWN0aW9uLW1hbmFnZXInXG5pbXBvcnQgQXBwV2lkZ2V0TWFuYWdlciBmcm9tICcuL2xpYi9hcHAtd2lkZ2V0LW1hbmFnZXInXG5pbXBvcnQgQXBwU3RhdGVSZWR1eFN0b3JlRXh0ZW5zaW9uIGZyb20gJy4vbGliL2FwcC1zdGF0ZS1yZWR1eC1zdG9yZS1leHRlbnNpb24nXG5pbXBvcnQgQXBwU3RhdGVIaXN0b3J5RXh0ZW5zaW9uIGZyb20gJy4vbGliL2FwcC1zdGF0ZS1oaXN0b3J5LWV4dGVuc2lvbidcbmltcG9ydCBCdWlsZGVyU3RhdGVSZWR1eFN0b3JlRXh0ZW5zaW9uIGZyb20gJy4vbGliL2J1aWxkZXItc3RhdGUtc3RvcmUtZXh0ZW5zaW9uJ1xuaW1wb3J0IEJ1aWxkZXJTdGF0ZVJlc291cmNlRXh0ZW5zaW9uIGZyb20gJy4vbGliL2J1aWxkZXItc3RhdGUtcmVzb3VyY2UtZXh0ZW5zaW9uJ1xuaW1wb3J0IFVybENvbmZpZ01hbmFnZXIsIHsgdHlwZSBXaWRnZXRzSW5mb0luUGFnZXMgfSBmcm9tICcuL2xpYi91cmwtY29uZmlnLW1hbmFnZXInXG5pbXBvcnQgKiBhcyBidWlsZGVyQXBwU3luYyBmcm9tICcuL2xpYi9idWlsZGVyLWFwcC1zeW5jJ1xuaW1wb3J0ICogYXMgYXBwQnVpbGRlclN5bmMgZnJvbSAnLi9saWIvYXBwLWJ1aWxkZXItc3luYydcbmltcG9ydCBkZWZhdWx0TWVzc2FnZXMgZnJvbSAnLi9saWIvdHJhbnNsYXRpb25zL2RlZmF1bHQnXG5cbmltcG9ydCAqIGFzIHV0aWxzIGZyb20gJy4vbGliL3V0aWxzL3V0aWxzJ1xuaW1wb3J0ICogYXMgaGVscFV0aWxzIGZyb20gJy4vbGliL3V0aWxzL2hlbHAtdXRpbHMnXG5pbXBvcnQgKiBhcyBhcHBDb25maWdVdGlscyBmcm9tICcuL2xpYi91dGlscy9hcHAtY29uZmlnLXV0aWxzJ1xuaW1wb3J0ICogYXMgdGVtcGxhdGVVdGlscyBmcm9tICcuL2xpYi91dGlscy90ZW1wbGF0ZS11dGlscydcbmltcG9ydCBCdWlsZGVyS2V5Ym9hcmRDb21wb25lbnQgZnJvbSAnLi9saWIvYnVpbGRlci1rZXlib2FyZC1jb21wb25lbnQnXG5leHBvcnQgKiBmcm9tICcuL2xpYi9hcHAtY29uZmlnLWFjdGlvbnMnXG5leHBvcnQgeyBUb0J1aWxkZXJNZXNzYWdlIH0gZnJvbSAnLi9saWIvc3luYy10eXBlJ1xuXG5leHBvcnQge1xuICBCYXNlV2lkZ2V0U2V0dGluZywgV2lkZ2V0U2V0dGluZ01hbmFnZXIsIEFwcFN0YXRlUmVkdXhTdG9yZUV4dGVuc2lvbiwgQnVpbGRlclN0YXRlUmVkdXhTdG9yZUV4dGVuc2lvbiwgQnVpbGRlclN0YXRlUmVzb3VyY2VFeHRlbnNpb24sXG4gIEFwcE1lc3NhZ2VNYW5hZ2VyLCBBcHBEYXRhQWN0aW9uTWFuYWdlciwgVXJsQ29uZmlnTWFuYWdlciwgdHlwZSBXaWRnZXRzSW5mb0luUGFnZXMsIEFwcFN0YXRlSGlzdG9yeUV4dGVuc2lvbiwgYnVpbGRlckFwcFN5bmMsIGFwcEJ1aWxkZXJTeW5jLCB0ZW1wbGF0ZVV0aWxzLFxuICB1dGlscywgaGVscFV0aWxzLCBCdWlsZGVyS2V5Ym9hcmRDb21wb25lbnQsIGFwcENvbmZpZ1V0aWxzLCBkZWZhdWx0TWVzc2FnZXMsIEFwcFdpZGdldE1hbmFnZXJcbn1cblxuZXhwb3J0ICogZnJvbSAnLi9saWIvYmFzZS13aWRnZXQtc2V0dGluZydcbmV4cG9ydCAqIGZyb20gJy4vbGliL3Byb3BzJ1xuZXhwb3J0ICogZnJvbSAnLi9saWIvYXBwLXN0YXRlLXJlZHV4LXN0b3JlLWV4dGVuc2lvbidcbmV4cG9ydCAqIGZyb20gJy4vbGliL2FwcC1zdGF0ZS1oaXN0b3J5LWV4dGVuc2lvbidcbmV4cG9ydCAqIGZyb20gJy4vbGliL2J1aWxkZXItc3RhdGUtc3RvcmUtZXh0ZW5zaW9uJ1xuZXhwb3J0ICogZnJvbSAnLi9saWIvYnVpbGRlci1zdGF0ZS1yZXNvdXJjZS1leHRlbnNpb24nXG5leHBvcnQgKiBmcm9tICcuL2xpYi9hcHAtcmVzb3VyY2UtbWFuYWdlcidcbmV4cG9ydCAqIGZyb20gJy4vbGliL2luaXQnXG5leHBvcnQgKiBmcm9tICcuL2xpYi9hcHAtY29uZmlnLXNlcnZpY2UnXG5cbmV4cG9ydCAqIGZyb20gJy4vbGliL2J1aWxkZXItbG9jYWxlJ1xuIiwiaW1wb3J0IHtcbiAgYXBwQWN0aW9ucyxcbiAgZ2V0QXBwU3RvcmUsXG4gIHR5cGUgSU1BcHBDb25maWcsXG4gIGppbXVIaXN0b3J5LFxuICB0eXBlIFNlbGVjdGlvbixcbiAgdXJsVXRpbHMsXG4gIGtleWJvYXJkVXRpbHMsXG4gIHR5cGUgQnJvd3NlclNpemVNb2RlLFxuICBQYWdlVHlwZSxcbiAgU2Vzc2lvbk1hbmFnZXIsXG4gIHR5cGUgQXBwSW5mbyxcbiAgdHlwZSBTZWN0aW9uTmF2SW5mbyxcbiAgTXV0YWJsZVN0b3JlTWFuYWdlcixcbiAgdHlwZSBMYXlvdXRJbmZvLFxuICBwb3J0YWxVcmxVdGlscyxcbiAgdHlwZSBQb3J0YWxJbmZvLFxuICB0eXBlIE5vUGVybWlzc2lvblJlc291cmNlSW5mb0xpc3QsXG4gIHR5cGUgTW9iaWxlU2lkZVBhbmVsQ29udGVudE9wdGlvbnNcbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgVG9BcHBNZXNzYWdlLCBUb0J1aWxkZXJNZXNzYWdlIH0gZnJvbSAnLi9zeW5jLXR5cGUnXG5pbXBvcnQgeyB0eXBlIFJlc291cmNlSXRlbUluZm8gfSBmcm9tICcuL2FwcC1yZXNvdXJjZS1tYW5hZ2VyJ1xuaW1wb3J0IHsgdHlwZSBUb29sYmFyQ29uZmlnIH0gZnJvbSAnamltdS1sYXlvdXRzL2xheW91dC1ydW50aW1lJ1xuaW1wb3J0IHsgdHlwZSBVc2VyU2Vzc2lvbiB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LWF1dGgnXG5cbmxldCBwdWJzdWJcbnRyeSB7XG4gIHB1YnN1YiA9IHdpbmRvdy5wYXJlbnQgJiYgd2luZG93LnBhcmVudC5fYnVpbGRlclB1YnN1YlxufSBjYXRjaCAoZSkge1xuICAvKipcbiAgICogSW4gbm9ybWFsIGNhc2UsIHRoaXMgZmlsZSBzaG91bGQgbm90IGJlIGxvYWRlZCBpZiBhcHAgaXMgb3V0IG9mIGJ1aWxkZXIsXG4gICAqIGJ1dCB3ZSBjYXRjaCB0aGlzIGVycm9yIHRvIGF2b2lkIHRoaXMgZmlsZSBpcyBsb2FkZWQgYWNjaWRlbnRhbGx5IHdoZW4gYXBwIGlzIGxhdW5jaGVkIG91dCBvZiBidWlsZGVyLlxuICAgKi9cbiAgY29uc29sZS5lcnJvcignQ2FuIGFjY2VzcyBwYXJlbnQuJylcbn1cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5CdWlsZGVyRXZlbnRzICgpIHtcbiAgaWYgKCFwdWJzdWIpIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHB1YnN1Yi51bnN1YnNjcmliZSgndG9fYXBwJylcblxuICBjb25zdCBzdG9yZSA9IGdldEFwcFN0b3JlKClcbiAgcHVic3ViLnN1YnNjcmliZSgndG9fYXBwJywgZnVuY3Rpb24gKGV2dCwgZGF0YSkge1xuICAgIGNvbnNvbGUuZGVidWcoZXZ0LCBkYXRhKVxuICB9KVxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQXBwQ29uZmlnQ2hhbmdlZH1gLCBmdW5jdGlvbiAoZXZ0LCBhcHBDb25maWc6IElNQXBwQ29uZmlnKSB7XG4gICAgY29uc3Qgc3RhdGUgPSBzdG9yZS5nZXRTdGF0ZSgpXG4gICAgaWYgKHN0YXRlLmFwcFJ1bnRpbWVJbmZvLmN1cnJlbnRQYWdlSWQgJiYgIWFwcENvbmZpZy5wYWdlc1tzdGF0ZS5hcHBSdW50aW1lSW5mby5jdXJyZW50UGFnZUlkXSkge1xuICAgICAgY29uc3QgZGVmYXVsdFBhZ2VJZCA9IE9iamVjdC5rZXlzKGFwcENvbmZpZy5wYWdlcykuZmluZChwSWQgPT4gYXBwQ29uZmlnLnBhZ2VzW3BJZF0uaXNEZWZhdWx0KVxuICAgICAgamltdUhpc3RvcnkuY2hhbmdlUGFnZShkZWZhdWx0UGFnZUlkKVxuICAgIH1cbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLmFwcENvbmZpZ0NoYW5nZWQoYXBwQ29uZmlnKSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQXBwSW5mb0NoYW5nZWR9YCwgZnVuY3Rpb24gKGV2dCwgYXBwSW5mbzogQXBwSW5mbykge1xuICAgIHN0b3JlLmRpc3BhdGNoKGFwcEFjdGlvbnMuYXBwSW5mb0NoYW5nZWQoYXBwSW5mbykpXG4gIH0pXG5cbiAgcHVic3ViLnN1YnNjcmliZShgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLlBvcnRhbFNlbGZDaGFuZ2VkfWAsIGZ1bmN0aW9uIChldnQsIHBvcnRhbFNlbGY6IGFueSkge1xuICAgIHN0b3JlLmRpc3BhdGNoKGFwcEFjdGlvbnMuc2V0UG9ydGFsU2VsZihwb3J0YWxTZWxmKSlcbiAgICBpZiAocG9ydGFsU2VsZiAmJiAhcG9ydGFsU2VsZi5pc1BvcnRhbCkge1xuICAgICAgY29uc3QgbmV3UG9ydGFsVXJsID0gYGh0dHBzOi8vJHtwb3J0YWxTZWxmLnVybEtleX0uJHtwb3J0YWxTZWxmLmN1c3RvbUJhc2VVcmx9YFxuICAgICAgaWYgKHBvcnRhbFNlbGYudXJsS2V5ICYmICFwb3J0YWxVcmxVdGlscy5pc1NhbWVQb3J0YWxVcmwoc3RvcmUuZ2V0U3RhdGUoKS5wb3J0YWxVcmwsIG5ld1BvcnRhbFVybCkpIHtcbiAgICAgICAgc3RvcmUuZGlzcGF0Y2goYXBwQWN0aW9ucy5zZXRQb3J0YWxJbmZvKHtcbiAgICAgICAgICBwb3J0YWxVcmw6IG5ld1BvcnRhbFVybFxuICAgICAgICB9KSlcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgcHVic3ViLnN1YnNjcmliZShgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLlVzZXJTaWduSW59YCwgZnVuY3Rpb24gKGV2dCwgdXNlcikge1xuICAgIHN0b3JlLmRpc3BhdGNoKGFwcEFjdGlvbnMudXNlclNpZ25Jbih1c2VyKSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuU2V0TWFpblBvcnRhbH1gLCBmdW5jdGlvbiAoZXZ0LCBtYWluUG9ydGFsSW5mbzogUG9ydGFsSW5mbykge1xuICAgIGNvbnN0IHBvcnRhbEluZm86IFBvcnRhbEluZm8gPSBPYmplY3QuYXNzaWduKHtcbiAgICAgIHBvcnRhbFVybDogc3RvcmUuZ2V0U3RhdGUoKS5wb3J0YWxVcmwsXG4gICAgICBjbGllbnRJZDogc3RvcmUuZ2V0U3RhdGUoKS5jbGllbnRJZCxcbiAgICAgIGlzV2ViVGllcjogc3RvcmUuZ2V0U3RhdGUoKS5pc1dlYlRpZXJcbiAgICB9LCBtYWluUG9ydGFsSW5mbylcbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLnNldFBvcnRhbEluZm8ocG9ydGFsSW5mbykpXG4gIH0pXG5cbiAgcHVic3ViLnN1YnNjcmliZShgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLkRpYWxvZ0luZm9zQ2hhbmdlZH1gLCBmdW5jdGlvbiAoYWN0aW9uLCBkaWFsb2dJZHMpIHtcbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLmRpYWxvZ0luZm9zQ2hhbmdlZChkaWFsb2dJZHMpKVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VBcHBNb2RlfWAsIGZ1bmN0aW9uIChhY3Rpb24sIG1vZGUpIHtcbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLmFwcE1vZGVDaGFuZ2VkKG1vZGUpKVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VXaWRnZXRTdGF0ZVByb3B9YCwgZnVuY3Rpb24gKGFjdGlvbiwgYWx0ZXJTdGF0ZSkge1xuICAgIHN0b3JlLmRpc3BhdGNoKGFwcEFjdGlvbnMud2lkZ2V0U3RhdGVQcm9wQ2hhbmdlKGFsdGVyU3RhdGUud2lkZ2V0SWQsIGFsdGVyU3RhdGUucHJvcEtleSwgYWx0ZXJTdGF0ZS52YWx1ZSkpXG4gIH0pXG5cbiAgcHVic3ViLnN1YnNjcmliZShgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLkNoYW5nZVdpZGdldE11dGFibGVTdGF0ZVByb3B9YCwgZnVuY3Rpb24gKGFjdGlvbiwgYWx0ZXJTdGF0ZSkge1xuICAgIE11dGFibGVTdG9yZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS51cGRhdGVTdGF0ZVZhbHVlKGFsdGVyU3RhdGUud2lkZ2V0SWQsIGFsdGVyU3RhdGUucHJvcEtleSwgYWx0ZXJTdGF0ZS52YWx1ZSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQ2hhbmdlUGFnZX1gLCBmdW5jdGlvbiAoYWN0aW9uLCBwYWdlSWQpIHtcbiAgICBjb25zdCBwYWdlSnNvbiA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBDb25maWcucGFnZXNbcGFnZUlkXVxuICAgIGlmIChwYWdlSnNvbi50eXBlID09PSBQYWdlVHlwZS5MaW5rIHx8IHBhZ2VKc29uLnR5cGUgPT09IFBhZ2VUeXBlLkZvbGRlciB8fCB1cmxVdGlscy5wYXJzZUFwcFBhdGgobG9jYXRpb24ucGF0aG5hbWUsIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBDb25maWcpLnBhZ2VJZCA9PT0gcGFnZUlkKSB7XG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuY3VycmVudFBhZ2VDaGFuZ2VkKHBhZ2VJZCkpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGN1cnJlbnRQYWdlIHdpbGwgYmUgdXBkYXRlZCBhZnRlciBwYXRoIGNoYW5nZS5cbiAgICAgIGppbXVIaXN0b3J5LmNoYW5nZVBhZ2UocGFnZUlkKVxuICAgIH1cbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQ2hhbmdlRGlhbG9nfWAsIGZ1bmN0aW9uIChhY3Rpb24sIGRpYWxvZ0lkKSB7XG4gICAgamltdUhpc3RvcnkuY2hhbmdlRGlhbG9nKGRpYWxvZ0lkKVxuICAgIHN0b3JlLmRpc3BhdGNoKGFwcEFjdGlvbnMuY3VycmVudERpYWxvZ0NoYW5nZWQoZGlhbG9nSWQpKVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VTZWxlY3Rpb259YCwgZnVuY3Rpb24gKGFjdGlvbiwgc2VsZWN0aW9uOiBTZWxlY3Rpb24pIHtcbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLnNlbGVjdGlvbkNoYW5nZWQoc2VsZWN0aW9uKSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQnVpbGRlclRyaWdnZXJLZXlib2FyZH1gLCBmdW5jdGlvbiAoYWN0aW9uLCBldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgIGtleWJvYXJkVXRpbHMudHJpZ2dlckV2ZW50KGV2ZW50KVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VCcm93c2VyU2l6ZU1vZGV9YCwgZnVuY3Rpb24gKGFjdGlvbiwgbW9kZTogQnJvd3NlclNpemVNb2RlKSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goYXBwQWN0aW9ucy5icm93c2VyU2l6ZU1vZGVDaGFuZ2VkKG1vZGUpKVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5CdWlsZGVyU2Vzc2lvbkNoYW5nZWR9YCwgZnVuY3Rpb24gKGFjdGlvbiwgc2Vzc2lvbnM6IFVzZXJTZXNzaW9uW10pIHtcbiAgICAvLyBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShzZXNzaW9ucykpO1xuICAgIFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuc3luY1Nlc3Npb25zRnJvbU90aGVyV2luZG93KHNlc3Npb25zKVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5CdWlsZGVyTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdENoYW5nZWR9YCwgZnVuY3Rpb24gKGFjdGlvbiwgbm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdDogTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdCkge1xuICAgIFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuc3luY05vUGVybWlzc2lvblJlc291cmNlSW5mb0xpc3RGcm9tT3RoZXJXaW5kb3cobm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdClcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQ2hhbmdlWm9vbVNjYWxlfWAsIGZ1bmN0aW9uIChhY3Rpb24sIHpvb21TY2FsZTogbnVtYmVyKSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goYXBwQWN0aW9ucy56b29tU2NhbGVDaGFuZ2Uoem9vbVNjYWxlKSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQWN0aXZlUGFnZVBhcnRDaGFuZ2VkfWAsIGZ1bmN0aW9uIChhY3Rpb24sIHBhcnQpIHtcbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLmFjdGl2ZVBhZ2VQYXJ0Q2hhbmdlZChwYXJ0KSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQW5pbWF0aW9uUHJldmlld31gLCBmdW5jdGlvbiAoYWN0aW9uLCBpbmZvKSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goYXBwQWN0aW9ucy5zZXR1cEFuaW1hdGlvblByZXZpZXcoaW5mbykpXG4gIH0pXG5cbiAgcHVic3ViLnN1YnNjcmliZShgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLkhvdmVyUHJldmlld31gLCBmdW5jdGlvbiAoYWN0aW9uLCBpbmZvKSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goYXBwQWN0aW9ucy5zZXR1cEhvdmVyUHJldmlldyhpbmZvKSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuU2VjdGlvbk5hdkluZm9DaGFuZ2VkfWAsIGZ1bmN0aW9uIChhY3Rpb24sIGRhdGE6IHsgc2VjdGlvbklkOiBzdHJpbmcsIG5hdkluZm86IFNlY3Rpb25OYXZJbmZvIH0pIHtcbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLnNlY3Rpb25OYXZJbmZvQ2hhbmdlZChkYXRhLnNlY3Rpb25JZCwgZGF0YS5uYXZJbmZvKSlcbiAgICBqaW11SGlzdG9yeS5jaGFuZ2VWaWV3QnlTZWN0aW9uTmF2SW5mbyhkYXRhLnNlY3Rpb25JZCwgZGF0YS5uYXZJbmZvKVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5TY3JlZW5Hcm91cE5hdkluZm9DaGFuZ2VkfWAsIGZ1bmN0aW9uIChhY3Rpb24sIGRhdGE6IHsgc2NyZWVuR3JvdXBJZDogc3RyaW5nLCBhY3RpdmVJbmRleDogbnVtYmVyIH0pIHtcbiAgICBzdG9yZS5kaXNwYXRjaChhcHBBY3Rpb25zLnNjcmVlbkdyb3VwTmF2SW5mb0NoYW5nZWQoZGF0YS5zY3JlZW5Hcm91cElkLCBkYXRhLmFjdGl2ZUluZGV4KSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuVG9jSG92ZXJJbmZvQ2hhbmdlZH1gLCBmdW5jdGlvbiAoYWN0aW9uLCBkYXRhKSB7XG4gICAgY29uc3QgeyBsYXlvdXRJbmZvLCBob3ZlcmVkIH0gPSBkYXRhXG4gICAgY29uc3QgeyBsYXlvdXRJZCwgbGF5b3V0SXRlbUlkIH0gPSBsYXlvdXRJbmZvXG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGRpdi5idWlsZGVyLWxheW91dC1pdGVtW2RhdGEtbGF5b3V0aWQ9XCIke2xheW91dElkfVwiXVtkYXRhLWxheW91dGl0ZW1pZD1cIiR7bGF5b3V0SXRlbUlkfVwiXWApXG4gICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgIGhvdmVyZWQgPyBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2hvdmVyZWQnKSA6IGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaG92ZXJlZCcpXG4gICAgfVxuICB9KVxuXG4gIHB1YnN1Yi5zdWJzY3JpYmUoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5TZXRDbGllbnRJZEFsZXJ0SXNDYW5jZWxsZWR9YCwgZnVuY3Rpb24gKGFjdGlvbiwgZGF0YSkge1xuICAgIFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkub25DbGllbnRJZERpYWxvZ0ZpbmlzaGVkKGRhdGE/LnBvcnRhbFVybCwgbnVsbCwgbmV3IEVycm9yKCdzZXR0aW5nIGNsaWVudElkIGlzIGNhbmNlbGxlZC4nKSlcbiAgfSlcblxuICBwdWJzdWIuc3Vic2NyaWJlKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuVXRpbGl0eVN0YXRlQ2hhbmdlZH1gLCBmdW5jdGlvbiAoYWN0aW9uLCBkYXRhKSB7XG4gICAgc3RvcmUuZGlzcGF0Y2goYXBwQWN0aW9ucy51dGlsaXR5U3RhdGVDaGFuZ2UoZGF0YS51dGlsaXR5SWQsIGRhdGEuc3RhdGUpKVxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaEFwcFNlc3Npb25DaGFuZ2VUb0J1aWxkZXIgKCkge1xuICBwdWJsaXNoRXZlbnRUb0J1aWxkZXIoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLkFwcFNlc3Npb25DaGFuZ2VkfWAsIFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0U2Vzc2lvbnMoKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hOb1Blcm1pc3Npb25SZXNvdXJjZUluZm9MaXN0Q2hhbmdlVG9CdWlsZGVyICgpIHtcbiAgcHVibGlzaEV2ZW50VG9CdWlsZGVyKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5BcHBOb1Blcm1pc3Npb25SZXNvdXJjZUluZm9MaXN0Q2hhbmdlZH1gLCBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE5vUGVybWlzc2lvblJlc291cmNlSW5mb0xpc3QoKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hDaGVjazQ5OEVycm9yVG9CdWlsZGVyICh1cmw6IHN0cmluZykge1xuICBwdWJsaXNoRXZlbnRUb0J1aWxkZXIoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLk5lZWRUb0NoZWNrNDk4RXJyb3J9YCwgdXJsKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaEFwcFN0YXRlQ2hhbmdlVG9CdWlsZGVyICgpIHtcbiAgcHVibGlzaEV2ZW50VG9CdWlsZGVyKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5BcHBTdGF0ZUNoYW5nZWR9YCwgZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaEFwcElzTG9hZGVkVG9CdWlsZGVyICgpIHtcbiAgcHVibGlzaEV2ZW50VG9CdWlsZGVyKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5BcHBJc0xvYWRlZH1gKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbGV0QnVpbGRlclBvcHVwQ2hvb3NlV2lkZ2V0IChsYXlvdXRJZDogc3RyaW5nLCBsYXlvdXRJdGVtSWQ6IHN0cmluZykge1xuICBwdWJsaXNoRXZlbnRUb0J1aWxkZXIoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLlBvcHVwQ2hvb3NlV2lkZ2V0fWAsIHtcbiAgICBsYXlvdXRJZDogbGF5b3V0SWQsXG4gICAgbGF5b3V0SXRlbUlkOiBsYXlvdXRJdGVtSWRcbiAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxldEJ1aWxkZXJBZGRSZXNvdXJjZSAocmVzb3VyY2VJdGVtSW5mbzogUmVzb3VyY2VJdGVtSW5mbykge1xuICBwdWJsaXNoRXZlbnRUb0J1aWxkZXIoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLkFwcEFkZFJlc291cmNlfWAsIHJlc291cmNlSXRlbUluZm8pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsZXRCdWlsZGVyQ2xlYXJSZXNvdXJjZSAoYXBwSWQ6IHN0cmluZykge1xuICBwdWJsaXNoRXZlbnRUb0J1aWxkZXIoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLkFwcENsZWFyUmVzb3VyY2VzfWAsIGFwcElkKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbGV0QnVpbGRlclJlc3BvbnNlVG9LZXlib2FyZCAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgcHVibGlzaEV2ZW50VG9CdWlsZGVyKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5BcHBUcmlnZ2VyS2V5Ym9hcmR9YCwgZXZlbnQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsZXRCdWlsZGVyU2hvd0xheW91dFRvb2xiYXIgKHRvb2xzOiBUb29sYmFyQ29uZmlnKSB7XG4gIHB1Ymxpc2hFdmVudFRvQnVpbGRlcihgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuU2V0TGF5b3V0VG9vbHN9YCwgdG9vbHMpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhckxhc3RBcHBDb25maWdGcm9tSGlzdG9yeSAoKSB7XG4gIHB1Ymxpc2hFdmVudFRvQnVpbGRlcihgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuQ2xlYXJMYXN0QXBwQ29uZmlnRnJvbUhpc3Rvcnl9YClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hJc0J1c3lUb0J1aWxkZXIgKGlzQnVzeTogYm9vbGVhbikge1xuICBwdWJsaXNoRXZlbnRUb0J1aWxkZXIoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLlNldElzQnVzeX1gLCBpc0J1c3kpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoQ29uZmlybURlbGV0ZVRvQXBwIChpdGVtVG9EZWxldGU6IExheW91dEluZm8pIHtcbiAgcHVibGlzaEV2ZW50VG9CdWlsZGVyKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5Db25maXJtRGVsZXRlfWAsIGl0ZW1Ub0RlbGV0ZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hQb3J0YWxVcmxOZWVkVG9SZWdpc3RlckNsaWVudElkIChwb3J0YWxVcmw6IHN0cmluZywgbmVlZFRvU2lnbkluOiBzdHJpbmcsIHNlcnZpY2VVcmw/OiBzdHJpbmcpIHtcbiAgcHVibGlzaEV2ZW50VG9CdWlsZGVyKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5OZWVkVG9SZWdpc3RlckNsaW5ldElkfWAsIHsgcG9ydGFsVXJsLCBuZWVkVG9TaWduSW4sIHNlcnZpY2VVcmwgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hTaWRlUGFuZWxUb0FwcCAob3B0aW9uOiBNb2JpbGVTaWRlUGFuZWxDb250ZW50T3B0aW9ucykge1xuICBwdWJsaXNoRXZlbnRUb0J1aWxkZXIoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLlNldFNpZGVQYW5lbH1gLCBvcHRpb24pXG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2hFdmVudFRvQnVpbGRlciAoYWN0aW9uLCBkYXRhPykge1xuICBpZiAoIXB1YnN1Yikge1xuICAgIHJldHVyblxuICB9XG5cbiAgcHVic3ViLnB1Ymxpc2hTeW5jKGFjdGlvbiwgZGF0YSlcbn1cbiIsImltcG9ydCB7XG4gIGFwcEFjdGlvbnMsXG4gIGdldEFwcFN0b3JlLFxuICB0eXBlIElNQXBwQ29uZmlnLFxuICB0eXBlIElNQXR0cmlidXRlc0pzb24sXG4gIHR5cGUgSU1DdXN0b21UaGVtZUpzb24sXG4gIHR5cGUgSU1EYXRhU291cmNlSnNvbixcbiAgdHlwZSBJTURpYWxvZ0pzb24sXG4gIHR5cGUgSU1MYXlvdXRKc29uLFxuICB0eXBlIElNTWVzc2FnZUpzb24sXG4gIEltbXV0YWJsZSxcbiAgdHlwZSBJTVBhZ2VKc29uLFxuICB0eXBlIElNVmlld0pzb24sXG4gIHR5cGUgSU1TZWN0aW9uSnNvbixcbiAgdHlwZSBJTVdpZGdldEpzb24sXG4gIHR5cGUgTGF5b3V0SW5mbyxcbiAgTGF5b3V0SXRlbVR5cGUsXG4gIExheW91dFR5cGUsXG4gIHR5cGUgSU1TaXplTW9kZUxheW91dEpzb24sXG4gIENvbnRhaW5lclR5cGUsXG4gIEJyb3dzZXJTaXplTW9kZSxcbiAgUGFnZVR5cGUsXG4gIHR5cGUgU2l6ZSxcbiAgdHlwZSBEYXRhU291cmNlSnNvbixcbiAgdHlwZSBXaWRnZXRKc29uLFxuICBpMThuLFxuICB0eXBlIElNUHJveHlKc29uLFxuICB0eXBlIElNU2NyZWVuR3JvdXBKc29uLFxuICBTY3JlZW5UcmFuc2l0aW9uVHlwZSxcbiAgdHlwZSBJTVNjcmVlbkpzb24sXG4gIHR5cGUgVXNlRGF0YVNvdXJjZSxcbiAgdHlwZSBJTVVzZURhdGFTb3VyY2UsXG4gIHR5cGUgRWxlbWVudFR5cGUsXG4gIHR5cGUgSU1VdGlsaXRpZXNKc29uLFxuICB0eXBlIFV0aWxpdHlKc29uLFxuICBMYXlvdXRQYXJlbnRUeXBlLFxuICB0eXBlIENvbnRyb2xsZXJQYW5lbEpzb24sXG4gIHR5cGUgSW1tdXRhYmxlT2JqZWN0LFxuICB0eXBlIFVybFBhcmFtc0NvbmZpZ1xufSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBzZWFyY2hVdGlscywgdXRpbHMgfSBmcm9tICdqaW11LWxheW91dHMvbGF5b3V0LXJ1bnRpbWUnXG5pbXBvcnQgKiBhcyBhcHBDb25maWdVdGlscyBmcm9tICcuL3V0aWxzL2FwcC1jb25maWctdXRpbHMnXG5pbXBvcnQgKiBhcyBidWlsZGVyQXBwU3luYyBmcm9tICcuL2J1aWxkZXItYXBwLXN5bmMnXG5pbXBvcnQgKiBhcyBhcHBCdWlsZGVyU3luYyBmcm9tICcuL2FwcC1idWlsZGVyLXN5bmMnXG5pbXBvcnQgeyBhcHBTdGF0ZUhpc3RvcnlBY3Rpb25zIH0gZnJvbSAnLi9hcHAtc3RhdGUtaGlzdG9yeS1leHRlbnNpb24nXG5pbXBvcnQgeyBhcHBTdGF0ZUFjdGlvbnMgfSBmcm9tICcuL2FwcC1zdGF0ZS1yZWR1eC1zdG9yZS1leHRlbnNpb24nXG5pbXBvcnQgeyBidWlsZGVyQWN0aW9ucyB9IGZyb20gJy4vYnVpbGRlci1zdGF0ZS1zdG9yZS1leHRlbnNpb24nXG5pbXBvcnQgeyBBcHBNZXNzYWdlTWFuYWdlciB9IGZyb20gJy4uL2luZGV4J1xuaW1wb3J0IHsgdHlwZSBUZW1wbGF0ZSB9IGZyb20gJy4vdGVtcGxhdGVzL3R5cGUnXG5pbXBvcnQgQXBwV2lkZ2V0TWFuYWdlciBmcm9tICcuL2FwcC13aWRnZXQtbWFuYWdlcidcbmltcG9ydCB7XG4gIHdpZGdldFNlcnZpY2UsXG4gIHNlY3Rpb25TZXJ2aWNlLFxuICBzY3JlZW5Hcm91cFNlcnZpY2UsXG4gIExheW91dFNlcnZpY2VQcm92aWRlcixcbiAgQ29udGVudFNlcnZpY2VXcmFwcGVyLFxuICBlbXB0eUNvbnRlbnRTZXJ2aWNlLFxuICB0ZW1wbGF0ZVNlcnZpY2UsXG4gIHR5cGUgVG9jTm9kZVxufSBmcm9tICcuL2FwcC1jb25maWctc2VydmljZSdcbmltcG9ydCB7IHR5cGUgVGhlbWVPcHRpb25zIH0gZnJvbSAnamltdS10aGVtZSdcblxuZnVuY3Rpb24gZ2V0QXBwQ29uZmlnICgpOiBJTUFwcENvbmZpZyB7XG4gIGNvbnN0IHN0YXRlID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpXG4gIGlmICh3aW5kb3cuamltdUNvbmZpZy5pc0J1aWxkZXIpIHtcbiAgICByZXR1cm4gc3RhdGUgJiYgc3RhdGUuYXBwU3RhdGVJbkJ1aWxkZXIgJiYgc3RhdGUuYXBwU3RhdGVJbkJ1aWxkZXIuYXBwQ29uZmlnXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHN0YXRlICYmIHN0YXRlLmFwcENvbmZpZ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBcHBDb25maWdBY3Rpb24gKGFwcENvbmZpZzogSU1BcHBDb25maWcgPSB1bmRlZmluZWQpOiBBcHBDb25maWdBY3Rpb24ge1xuICBpZiAoIWFwcENvbmZpZykge1xuICAgIGFwcENvbmZpZyA9IGdldEFwcENvbmZpZygpXG4gIH1cbiAgcmV0dXJuIG5ldyBBcHBDb25maWdBY3Rpb24oYXBwQ29uZmlnKVxufVxuXG5leHBvcnQgY2xhc3MgQXBwQ29uZmlnQWN0aW9uIHtcbiAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZ1xuICAvKipcbiAqIFdoZW4gZHVwbGljYXRlIGEgcGFnZSBvciBkaWFsb2csIHdlJ2xsIGR1cGxpY2F0ZSBhbGwgc2l6ZSBtb2RlIGxheW91dHMsIGJ1dCB0aGUgc2hhcmVkIGNvbnRlbnRzIHNob3VsZCBiZSBkdXBsaWNhdGVkIG9ubHkgb25lIHRpbWUuXG4gKiBTbywgd2hlbiBkdXBsaWNhdGUgdGhlIHNpemUgbW9kZSBsYXlvdXRzLCB3ZSBuZWVkIHRvIGNvbnNpZGVyIHRoZSBjb250ZW50cyB0aGF0IGhhdmUgYmVlbiBkdXBsaWNhdGVkLiBJZiBhIGNvbnRlbnQgaGFzIGJlZW4gZHVwbGljYXRlZCxcbiAqIGR1cGxpY2F0ZSB0aGUgc2FtZSBjb250ZW50IHdpbGwgbmVlZCB0byB1c2UgdGhlIGR1cGxpY2F0ZWQgY29udGVudCBpZCBpbnN0ZWFkIG9mIGNyZWF0ZSBhIG5ldyBvbmUuXG4gKlxuICogV2hlbiBzdGFydCB0byBkdXBsaWNhdGUgYSBwYWdlIG9yIGRpYWxvZywgbXVzdCBjbGVhbiB0aGlzIG1hcCBhbmQgc2V0IGl0IGFzIGB7fWAsIGFuZCByZXN0b3JlIHRvIHt9IHdoZW4gZHVwbGljYXRpb24gaXMgZG9uZS5cbiAqL1xuICAvLyBwcml2YXRlIGR1cGxpY2F0ZWRDb250ZW50TWFwcz86IHsgW2lkOiBzdHJpbmddOiBzdHJpbmcgfSA9IHt9XG4gIC8vIHByaXZhdGUgaXNEdXBsaWNhdGluZ1BhZ2U/OiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IgKGFwcENvbmZpZzogSU1BcHBDb25maWcpIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSByZXBsYWNlIGJ5IGRlZmF1bHQsIHRoZSBjaGFuZ2UgaXMgYXBwZW5kZWQgdG8gdGhlIGNoYW5nZSBsaXN0LiBJZiByZXBsYWNlID0gdHJ1ZSwgdGhlIGNoYW5nZSB3aWxsIHJlcGxhY2UgdGhlIGxhc3QgY2hhbmdlXG4gICAqL1xuICBleGVjIChyZXBsYWNlID0gZmFsc2UpOiB0aGlzIHtcbiAgICAvLyB0aGlzLmR1cGxpY2F0ZWRDb250ZW50TWFwcyA9IHt9XG4gICAgLy8gdGhpcy5pc0R1cGxpY2F0aW5nUGFnZSA9IGZhbHNlXG4gICAgaWYgKHdpbmRvdy5qaW11Q29uZmlnLmlzQnVpbGRlcikge1xuICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaCh7IHR5cGU6ICdJTl9CVUlMREVSX0FQUENPTkZJR19SRURPQ0xFQVInIH0pXG4gICAgICBpZiAocmVwbGFjZSkge1xuICAgICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcFN0YXRlSGlzdG9yeUFjdGlvbnMuSW5CdWlsZGVyUmVtb3ZlTGFzdEFwcENvbmZpZ0Zyb21IaXN0b3J5KCkpXG4gICAgICB9XG5cbiAgICAgIGJ1aWxkZXJBcHBTeW5jLnB1Ymxpc2hBcHBDb25maWdDaGFuZ2VUb0FwcCh0aGlzLmFwcENvbmZpZylcblxuICAgICAgY29uc3Qgb2xkQXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyLmFwcENvbmZpZ1xuICAgICAgY29uc3QgbmV3QXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWdcbiAgICAgIGNvbnN0IHJlbW92ZWRXaWRnZXRzID0gT2JqZWN0LmtleXMob2xkQXBwQ29uZmlnLndpZGdldHMpLmZpbHRlcih3SWQgPT4gIW5ld0FwcENvbmZpZy53aWRnZXRzW3dJZF0pXG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGJ1aWxkZXJBY3Rpb25zLndpZGdldHNSZW1vdmVkKHJlbW92ZWRXaWRnZXRzKSlcblxuICAgICAgLy9jbGVhciB0aGUgbWVzc2FnZSBhY3Rpb24gb2YgdGhlIGRlbGV0ZWQgd2lkZ2V0XG4gICAgICB0aGlzLmNsZWFyRGVsZXRlZFdpZGdldE1lc3NhZ2VBY3Rpb24ob2xkQXBwQ29uZmlnLCBuZXdBcHBDb25maWcpXG5cbiAgICAgIGNvbnN0IG5ld1dpZGdldHMgPSBPYmplY3Qua2V5cyhuZXdBcHBDb25maWcud2lkZ2V0cykuZmlsdGVyKHdJZCA9PiAhb2xkQXBwQ29uZmlnLndpZGdldHNbd0lkXSkubWFwKHdJZCA9PiAoe1xuICAgICAgICB3aWRnZXRJZDogd0lkLFxuICAgICAgICB3aWRnZXRVcmk6IG5ld0FwcENvbmZpZy53aWRnZXRzW3dJZF0udXJpXG4gICAgICB9KSlcbiAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYnVpbGRlckFjdGlvbnMud2lkZ2V0c0FkZGVkKG5ld1dpZGdldHMpKVxuXG4gICAgICBjb25zdCBhcHBJbmZvID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyLmFwcEluZm9cbiAgICAgIC8qKlxuICAgICAgICogQWZ0ZXIgYHB1Ymxpc2hBcHBDb25maWdDaGFuZ2VUb0FwcGAsIGFwcCB3aWxsIGNhbGwgYHB1Ymxpc2hBcHBTdGF0ZUNoYW5nZVRvQnVpbGRlcmAgdG8gdXBkYXRlIHRoZSBhcHBDb25maWcgaW4gYnVpbGRlcidzIHN0YXRlLlxuICAgICAgICogSG93ZXZlciwgdGhlIGBwdWJsaXNoQXBwU3RhdGVDaGFuZ2VUb0J1aWxkZXJgIGlzIGFzeW5jLCBzbyB3ZSB1cGRhdGUgdGhlIGFwcENvbmZpZyBpbiBidWlsZGVyJ3Mgc3RhdGUgaGVyZS5cbiAgICAgICAqL1xuICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBTdGF0ZUFjdGlvbnMuaW5CdWlsZGVyQXBwQ29uZmlnQ2hhbmdlZCh0aGlzLmFwcENvbmZpZykpXG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcFN0YXRlSGlzdG9yeUFjdGlvbnMuSW5CdWlsZGVyUHV0QXBwQ29uZmlnSW50b0hpc3RvcnkoeyBhcHBDb25maWc6IHRoaXMuYXBwQ29uZmlnLCBhcHBJbmZvOiBhcHBJbmZvIH0pKVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocmVwbGFjZSkge1xuICAgICAgICBhcHBCdWlsZGVyU3luYy5jbGVhckxhc3RBcHBDb25maWdGcm9tSGlzdG9yeSgpXG4gICAgICB9XG4gICAgICBjb25zdCBvbGRBcHBDb25maWcgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwQ29uZmlnXG4gICAgICBjb25zdCBuZXdBcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZ1xuXG4gICAgICAvL2NsZWFyIHRoZSBtZXNzYWdlIGFjdGlvbiBvZiB0aGUgZGVsZXRlZCB3aWRnZXRcbiAgICAgIHRoaXMuY2xlYXJEZWxldGVkV2lkZ2V0TWVzc2FnZUFjdGlvbihvbGRBcHBDb25maWcsIG5ld0FwcENvbmZpZylcbiAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5hcHBDb25maWdDaGFuZ2VkKHRoaXMuYXBwQ29uZmlnKSlcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qKlxuICAgKiBBZnRlciBkZWxldGUgdGhlIHdpZGdldCwgY2xlYXIgdGhlIG1lc3NhZ2UgYWN0aW9uIG9mIHRoZSB3aWRnZXRcbiAgICogQG9sZEFwcENvbmZpZ1xuICAgKiBAbmV3QXBwQ29uZmlnXG4gICAqICovXG4gIHByaXZhdGUgcmVhZG9ubHkgY2xlYXJEZWxldGVkV2lkZ2V0TWVzc2FnZUFjdGlvbiA9IChvbGRBcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdBcHBDb25maWc6IElNQXBwQ29uZmlnKTogdm9pZCA9PiB7XG4gICAgY29uc3QgZGVsZXRlZE1lc3NhZ2VDb25maWdzID0gdGhpcy5nZXREZWxldGVkV2lkZ2V0c01lc3NhZ2VDb25maWdzKG9sZEFwcENvbmZpZywgbmV3QXBwQ29uZmlnKVxuICAgIGRlbGV0ZWRNZXNzYWdlQ29uZmlncy5mb3JFYWNoKG1lc3NhZ2UgPT4ge1xuICAgICAgdGhpcy5yZW1vdmVNZXNzYWdlQWN0aW9uKG1lc3NhZ2UpXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIG1lc3NhZ2UgY29uZmlnIG9mIHRoZSBkZWxldGVkIHdpZGdldFxuICAgKiBAb2xkQXBwQ29uZmlnXG4gICAqIEBuZXdBcHBDb25maWdcbiAgICogKi9cbiAgcHJpdmF0ZSByZWFkb25seSBnZXREZWxldGVkV2lkZ2V0c01lc3NhZ2VDb25maWdzID0gKG9sZEFwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld0FwcENvbmZpZzogSU1BcHBDb25maWcpOiBJTU1lc3NhZ2VKc29uW10gPT4ge1xuICAgIGNvbnN0IG9sZE1lc3NhZ2VDb25maWdzID0gb2xkQXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzXG4gICAgY29uc3QgbmV3TWVzc2FnZUNvbmZpZ3MgPSBuZXdBcHBDb25maWcubWVzc2FnZUNvbmZpZ3NcbiAgICBjb25zdCBkZWxldGVkTWVzc2FnZUNvbmZpZ3M6IElNTWVzc2FnZUpzb25bXSA9IFtdXG4gICAgaWYgKCFvbGRNZXNzYWdlQ29uZmlncykge1xuICAgICAgcmV0dXJuIGRlbGV0ZWRNZXNzYWdlQ29uZmlnc1xuICAgIH1cblxuICAgIGNvbnN0IG9sZE1lc3NhZ2VDb25maWdzS2V5cyA9IE9iamVjdC5rZXlzKG9sZE1lc3NhZ2VDb25maWdzKVxuICAgIGNvbnN0IG5ld01lc3NhZ2VDb25maWdzS2V5cyA9IE9iamVjdC5rZXlzKG5ld01lc3NhZ2VDb25maWdzKVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2xkTWVzc2FnZUNvbmZpZ3NLZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIW5ld01lc3NhZ2VDb25maWdzS2V5cy5pbmNsdWRlcyhvbGRNZXNzYWdlQ29uZmlnc0tleXNbaV0pKSB7XG4gICAgICAgIGRlbGV0ZWRNZXNzYWdlQ29uZmlncy5wdXNoKG9sZE1lc3NhZ2VDb25maWdzW29sZE1lc3NhZ2VDb25maWdzS2V5c1tpXV0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlbGV0ZWRNZXNzYWdlQ29uZmlnc1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBtZXNzYWdlIGFjdGlvblxuICAgKiBAbWVzc2FnZVxuICAgKiAqL1xuICBwcml2YXRlIHJlYWRvbmx5IHJlbW92ZU1lc3NhZ2VBY3Rpb24gPSAobWVzc2FnZTogSU1NZXNzYWdlSnNvbik6IHZvaWQgPT4ge1xuICAgIG1lc3NhZ2U/LmFjdGlvbnM/LmZvckVhY2goYWN0aW9uSnNvbiA9PiB7XG4gICAgICBjb25zdCBhY3Rpb25PYmogPSBBcHBNZXNzYWdlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldEFjdGlvbihhY3Rpb25Kc29uLndpZGdldElkLCBhY3Rpb25Kc29uLmFjdGlvbk5hbWUpXG4gICAgICBpZiAoYWN0aW9uT2JqKSB7XG4gICAgICAgIGFjdGlvbk9iai5vblJlbW92ZUxpc3RlbihtZXNzYWdlLm1lc3NhZ2VUeXBlLCBtZXNzYWdlLndpZGdldElkKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvLyAjcmVnaW9uIFdpZGdldCBBUElzXG4gIGVkaXRXaWRnZXRDb25maWcgKHdpZGdldElkOiBzdHJpbmcsIHdpZGdldENvbmZpZzogYW55KTogdGhpcyB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZCwgJ2NvbmZpZyddLCB3aWRnZXRDb25maWcpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIHBhc3NlZCBpbiBwcm9wZXJ0aWVzIG9ubHkuXG4gICAqIFRvIGRlbGV0ZSBhIHByb3BlcnR5LCBwbGVhc2Ugc2V0IHRoZSBwcm9wZXJ0eSB0byBudWxsXG4gICAqIEBwYXJhbSBwYXJ0aWFsV2lkZ2V0SnNvblxuICAgKiBAcGFyYW0gb3V0cHV0RGF0YVNvdXJjZXNKc29uc1xuICAgKiAgICBUbyBjcmVhdGUgYSBkYXRhIHNvdXJjZSwgeW91IG5lZWQgdG8gcGFzcyBpbiBhbGwgb2YgdGhlIGdlbmVyYXRlZCBwcm9wZXJ0aWVzLlxuICAgKiAgICBUbyB1cGRhdGUgYSBkYXRhIHNvdXJjZSwgeW91IGNhbiBwYXNzIGluIHRoZSBjaGFuZ2UgcHJvcGVydGllcyBvbmx5LiBQYXNzIG51bGwgdG8gZGVsZXRlIGEgcHJvcGVydHkuXG4gICAqL1xuICBlZGl0V2lkZ2V0IChwYXJ0aWFsV2lkZ2V0SnNvbjogUGFydGlhbDxXaWRnZXRKc29uPiwgb3V0cHV0RGF0YVNvdXJjZXNKc29ucz86IERhdGFTb3VyY2VKc29uW10pOiB0aGlzIHtcbiAgICBpZiAoIXRoaXMuYXBwQ29uZmlnLndpZGdldHNbcGFydGlhbFdpZGdldEpzb24uaWRdKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIGNvbnN0IG9sZFdpZGdldEpzb24gPSB0aGlzLmFwcENvbmZpZy53aWRnZXRzW3BhcnRpYWxXaWRnZXRKc29uLmlkXVxuICAgIGxldCBuZXdXaWRnZXRKc29uID0gb2xkV2lkZ2V0SnNvblxuXG4gICAgaWYgKG91dHB1dERhdGFTb3VyY2VzSnNvbnMpIHtcbiAgICAgIG91dHB1dERhdGFTb3VyY2VzSnNvbnMuZm9yRWFjaChkc0pzb24gPT4ge1xuICAgICAgICBpZiAoIWRzSnNvbi5pc091dHB1dEZyb21XaWRnZXQpIHtcbiAgICAgICAgICBkc0pzb24uaXNPdXRwdXRGcm9tV2lkZ2V0ID0gdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgbmV3V2lkZ2V0SnNvbiA9IG5ld1dpZGdldEpzb24uc2V0KCdvdXRwdXREYXRhU291cmNlcycsIG91dHB1dERhdGFTb3VyY2VzSnNvbnMubWFwKGRzSnNvbiA9PiBkc0pzb24uaWQpKVxuICAgIH1cblxuICAgIE9iamVjdC5rZXlzKHBhcnRpYWxXaWRnZXRKc29uKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgaWYgKHBhcnRpYWxXaWRnZXRKc29uW2tdID09PSBudWxsKSB7XG4gICAgICAgIGlmIChrID09PSAnb3V0cHV0RGF0YVNvdXJjZXNKc29uJykge1xuICAgICAgICAgIGlmIChwYXJ0aWFsV2lkZ2V0SnNvbi5vdXRwdXREYXRhU291cmNlcykge1xuICAgICAgICAgICAgcGFydGlhbFdpZGdldEpzb24ub3V0cHV0RGF0YVNvdXJjZXMuZm9yRWFjaChkc0lkID0+IHRoaXMucmVtb3ZlRGF0YVNvdXJjZShkc0lkKSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBuZXdXaWRnZXRKc29uID0gbmV3V2lkZ2V0SnNvbi53aXRob3V0KGsgYXMga2V5b2YgV2lkZ2V0SnNvbilcbiAgICAgICAgZGVsZXRlIHBhcnRpYWxXaWRnZXRKc29uW2tdXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIHJlbW92ZSBvbGQgZHNcbiAgICBpZiAob2xkV2lkZ2V0SnNvbi5vdXRwdXREYXRhU291cmNlcykge1xuICAgICAgb2xkV2lkZ2V0SnNvbi5vdXRwdXREYXRhU291cmNlcy5mb3JFYWNoKGRzSWQgPT4ge1xuICAgICAgICBpZiAoIW5ld1dpZGdldEpzb24ub3V0cHV0RGF0YVNvdXJjZXMgfHwgIW5ld1dpZGdldEpzb24ub3V0cHV0RGF0YVNvdXJjZXMuaW5jbHVkZXMoZHNJZCkpIHtcbiAgICAgICAgICB0aGlzLnJlbW92ZURhdGFTb3VyY2UoZHNJZClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gICAgLy8gYWRkL3VwZGF0ZSBuZXcgZHNcbiAgICBpZiAobmV3V2lkZ2V0SnNvbi5vdXRwdXREYXRhU291cmNlcykge1xuICAgICAgbmV3V2lkZ2V0SnNvbi5vdXRwdXREYXRhU291cmNlcy5mb3JFYWNoKGRzSWQgPT4ge1xuICAgICAgICBjb25zdCBvdXRwdXREYXRhU291cmNlc0pzb24gPSBvdXRwdXREYXRhU291cmNlc0pzb25zICYmIG91dHB1dERhdGFTb3VyY2VzSnNvbnMuZmluZChuZXdEc0pzb24gPT4gbmV3RHNKc29uLmlkID09PSBkc0lkKVxuICAgICAgICBpZiAob3V0cHV0RGF0YVNvdXJjZXNKc29uKSB7XG4gICAgICAgICAgaWYgKCFvbGRXaWRnZXRKc29uLm91dHB1dERhdGFTb3VyY2VzIHx8ICFvbGRXaWRnZXRKc29uLm91dHB1dERhdGFTb3VyY2VzLmluY2x1ZGVzKGRzSWQpKSB7XG4gICAgICAgICAgICB0aGlzLmFkZERhdGFTb3VyY2UoSW1tdXRhYmxlKG91dHB1dERhdGFTb3VyY2VzSnNvbikpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBvbGREc0pzb24gPSB0aGlzLmFwcENvbmZpZy5kYXRhU291cmNlc1tkc0lkXVxuICAgICAgICAgICAgaWYgKCFvbGREc0pzb24pIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignVW5rbm93biBlcnJvci4gV2lkZ2V0IG91dHB1dCBkYXRhIHNvdXJjZSBpcyBub3QgaW4gZGF0YSBzb3VyY2UganNvbi4nLCBkc0lkKVxuICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgT2JqZWN0LmtleXMob3V0cHV0RGF0YVNvdXJjZXNKc29uKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgICAgICAgICBpZiAob3V0cHV0RGF0YVNvdXJjZXNKc29uW2tdID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgb2xkRHNKc29uID0gb2xkRHNKc29uLndpdGhvdXQoayBhcyBrZXlvZiBEYXRhU291cmNlSnNvbilcbiAgICAgICAgICAgICAgICBkZWxldGUgb3V0cHV0RGF0YVNvdXJjZXNKc29uW2tdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHRoaXMuZWRpdERhdGFTb3VyY2Uob2xkRHNKc29uLm1lcmdlKG91dHB1dERhdGFTb3VyY2VzSnNvbikpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIG5ld1dpZGdldEpzb24gPSBuZXdXaWRnZXRKc29uLm1lcmdlKHBhcnRpYWxXaWRnZXRKc29uKVxuXG4gICAgaWYgKHBhcnRpYWxXaWRnZXRKc29uLnVzZURhdGFTb3VyY2VzICYmIG5ld1dpZGdldEpzb24ubGF5b3V0cyAmJiBuZXdXaWRnZXRKc29uLm1hbmlmZXN0LnByb3BlcnRpZXMucGFzc0RhdGFTb3VyY2VUb0NoaWxkcmVuKSB7XG4gICAgICB0aGlzLmNvcHlVc2VEYXRhU291cmNlVG9BbGxDaGlsZFdpZGdldHMob2xkV2lkZ2V0SnNvbiwgbmV3V2lkZ2V0SnNvbilcbiAgICB9XG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIHBhcnRpYWxXaWRnZXRKc29uLmlkXSwgbmV3V2lkZ2V0SnNvbilcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhIHNpZ2xlIHdpZGdldCBwcm9wZXJ0eS4gRG9lcyBub3QgYG91dHB1dERhdGFTb3VyY2VzYCBwcm9wZXJ0eVxuICAgKiBAcGFyYW0gd2lkZ2V0SWRcbiAgICogQHBhcmFtIHByb3BcbiAgICogQHBhcmFtIHZhbFxuICAgKi9cbiAgZWRpdFdpZGdldFByb3BlcnR5ICh3aWRnZXRJZDogc3RyaW5nLCBwcm9wOiBzdHJpbmcsIHZhbDogYW55KTogdGhpcyB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy53aWRnZXRzIHx8ICF0aGlzLmFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgaWYgKHByb3AgPT09ICdvdXRwdXREYXRhU291cmNlcycpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1BsZWFzZSB1c2UgZWRpdFdpZGdldCB0byB1cGRhdGUgb3V0cHV0RGF0YVNvdXJjZXMuJylcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICAgIGNvbnN0IHdpZGdldEpzb24gPSB0aGlzLmFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXVxuICAgIGNvbnN0IG5ld1dpZGdldEpzb24gPSB0aGlzLmVkaXRKc29uUHJvcGVydHkod2lkZ2V0SnNvbiwgcHJvcCwgdmFsKVxuICAgIGlmICh3aWRnZXRKc29uID09PSBuZXdXaWRnZXRKc29uKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIHdpZGdldElkXSwgbmV3V2lkZ2V0SnNvbilcbiAgICBpZiAocHJvcC5pbmNsdWRlcygnLicpKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5lZGl0V2lkZ2V0KHsgaWQ6IHdpZGdldElkLCBbcHJvcF06IHZhbCB9KVxuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSB3aWRnZXRKc29uIGJhc2ljIHdpZGdldCBpbmZvLCBsaWtlIHVyaS4gbWFuaWZlc3QgYW5kIGlkIHdpbGwgYmUgc2V0IGluIHRoaXMgbWV0aG9kLlxuICAgKiBAcGFyYW0gY3JlYXRlRW1iZWRMYXlvdXRcbiAgICovXG4gIGFzeW5jIGNyZWF0ZVdpZGdldCAod2lkZ2V0SnNvbjogV2lkZ2V0SnNvbiwgY3JlYXRlRW1iZWRMYXlvdXQgPSB0cnVlKTogUHJvbWlzZTxJTVdpZGdldEpzb24+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbG9hZGVkSnNvbiA9IGF3YWl0IEFwcFdpZGdldE1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5oYW5kbGVOZXdXaWRnZXRKc29uKHdpZGdldEpzb24gYXMgYW55KVxuICAgICAgY29uc3QgcmVzdWx0ID0gd2lkZ2V0U2VydmljZS5jcmVhdGVXaWRnZXQodGhpcy5hcHBDb25maWcsIGxvYWRlZEpzb24sIFt1dGlscy5nZXRDdXJyZW50U2l6ZU1vZGUoKV0sIGNyZWF0ZUVtYmVkTGF5b3V0KVxuICAgICAgdGhpcy5hcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgIGNvbnN0IHdpZGdldElkID0gcmVzdWx0WzFdXG5cbiAgICAgIHJldHVybiB0aGlzLmFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZSlcbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHJlbW92ZVdpZGdldCAod2lkZ2V0SWQ6IHN0cmluZyk6IHRoaXMge1xuICAgIHRoaXMuYXBwQ29uZmlnID0gd2lkZ2V0U2VydmljZS5yZW1vdmUodGhpcy5hcHBDb25maWcsIHdpZGdldElkKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBlZGl0Q29udHJvbGxlclBhbmVsIChjb250cm9sbGVyV2lkZ2V0SWQ6IHN0cmluZywgdmFsdWU6IENvbnRyb2xsZXJQYW5lbEpzb24pIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnY29udHJvbGxlclBhbmVscycsIGNvbnRyb2xsZXJXaWRnZXRJZF0sIHZhbHVlKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICByZW1vdmVDb250cm9sbGVyUGFuZWwgKGNvbnRyb2xsZXJXaWRnZXRJZDogc3RyaW5nKSB7XG4gICAgaWYgKHRoaXMuYXBwQ29uZmlnLmNvbnRyb2xsZXJQYW5lbHM/Lltjb250cm9sbGVyV2lkZ2V0SWRdKSB7XG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgnY29udHJvbGxlclBhbmVscycsIHRoaXMuYXBwQ29uZmlnLmNvbnRyb2xsZXJQYW5lbHMud2l0aG91dChjb250cm9sbGVyV2lkZ2V0SWQpKVxuICAgIH1cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcmVtb3ZlTGF5b3V0RnJvbVdpZGdldCAod2lkZ2V0SWQ6IHN0cmluZywgbGF5b3V0TmFtZTogc3RyaW5nKTogdGhpcyB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXT8ubGF5b3V0cyB8fCAhdGhpcy5hcHBDb25maWcud2lkZ2V0c1t3aWRnZXRJZF0/LmxheW91dHNbbGF5b3V0TmFtZV0pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICAgIE9iamVjdC5rZXlzKHRoaXMuYXBwQ29uZmlnLndpZGdldHNbd2lkZ2V0SWRdPy5sYXlvdXRzW2xheW91dE5hbWVdKS5mb3JFYWNoKHNpemVNb2RlID0+IHtcbiAgICAgIGNvbnN0IGxheW91dElkID0gdGhpcy5hcHBDb25maWcud2lkZ2V0c1t3aWRnZXRJZF0/LmxheW91dHNbbGF5b3V0TmFtZV1bc2l6ZU1vZGVdXG4gICAgICB0aGlzLnJlbW92ZUxheW91dChsYXlvdXRJZClcbiAgICB9KVxuXG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZCwgJ2xheW91dHMnXSwgdGhpcy5hcHBDb25maWcud2lkZ2V0c1t3aWRnZXRJZF0ubGF5b3V0cy53aXRob3V0KGxheW91dE5hbWUpKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBTZWN0aW9uIEFQSXMsIFZpZXcgQVBJc1xuXG4gIC8qKlxuICAgKiBjcmVhdGUgc2VjdGlvbiBvbmx5LCBkb2VzIG5vdCBhZGQgaW50byBsYXlvdXRcbiAgICovXG4gIGNyZWF0ZVNlY3Rpb24gKCk6IElNU2VjdGlvbkpzb24ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHNlY3Rpb25TZXJ2aWNlLmNyZWF0ZVNlY3Rpb24odGhpcy5hcHBDb25maWcsIFt1dGlscy5nZXRDdXJyZW50U2l6ZU1vZGUoKV0pXG4gICAgdGhpcy5hcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICBjb25zdCBzZWN0aW9uSWQgPSByZXN1bHRbMV1cbiAgICByZXR1cm4gdGhpcy5hcHBDb25maWcuc2VjdGlvbnNbc2VjdGlvbklkXVxuICB9XG5cbiAgZWRpdFNlY3Rpb25Qcm9wZXJ0eSAoc2VjdGlvbklkOiBzdHJpbmcsIHByb3A6IHN0cmluZywgdmFsOiBhbnkpOiB0aGlzIHtcbiAgICBsZXQgc2VjdGlvbkpzb24gPSB0aGlzLmFwcENvbmZpZy5zZWN0aW9uc1tzZWN0aW9uSWRdXG4gICAgaWYgKCFzZWN0aW9uSnNvbikge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgc2VjdGlvbkpzb24gPSB0aGlzLmVkaXRKc29uUHJvcGVydHkoc2VjdGlvbkpzb24sIHByb3AsIHZhbCkgYXMgYW55XG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgc2VjdGlvbklkXSwgc2VjdGlvbkpzb24pXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVkaXRWaWV3UHJvcGVydHkgKHZpZXdJZDogc3RyaW5nLCBwcm9wOiBzdHJpbmcsIHZhbDogYW55KTogdGhpcyB7XG4gICAgbGV0IHZpZXdKc29uID0gdGhpcy5hcHBDb25maWcudmlld3Nbdmlld0lkXVxuICAgIGlmICghdmlld0pzb24pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICAgIHZpZXdKc29uID0gdGhpcy5lZGl0SnNvblByb3BlcnR5KHZpZXdKc29uLCBwcm9wLCB2YWwpIGFzIGFueVxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWyd2aWV3cycsIHZpZXdJZF0sIHZpZXdKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgdmlldyBpbnRvIGEgc2VjdGlvbiwgd2lsbCBjcmVhdGUgbGF5b3V0cyBmb3IgdGhlIHZpZXcuIFRoZSBsYXlvdXRzIGFyZSBjcmVhdGVkIGRlcGVuZHMgb24gdGhlIHNlY3Rpb24uXG4gICAqXG4gICAqIEBwYXJhbSB2aWV3SnNvbiB0aGUgdmlld0pzb24gaGFzIGlkIGFuZCBsYWJlbCBvbmx5XG4gICAqIEBwYXJhbSBzZWN0aW9uSWQgdGhlIHNlY3Rpb24gdGhhdCB0aGUgdmlldyB3aWxsIGJlIGFkZGVkIGluXG4gICAqL1xuICBhZGRWaWV3IChzZWN0aW9uSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgbGV0IHNpemVNb2RlTGlzdFxuICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gdGhpcy5hcHBDb25maWcuc2VjdGlvbnNbc2VjdGlvbklkXVxuXG4gICAgaWYgKHNlY3Rpb25Kc29uLnZpZXdzPy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBmaXJzZVZpZXdJZCA9IHNlY3Rpb25Kc29uLnZpZXdzWzBdXG4gICAgICBjb25zdCB2aWV3SnNvbiA9IHRoaXMuYXBwQ29uZmlnLnZpZXdzW2ZpcnNlVmlld0lkXVxuICAgICAgc2l6ZU1vZGVMaXN0ID0gT2JqZWN0LmtleXModmlld0pzb24ubGF5b3V0KVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB7IHR5cGUsIGlkIH0gPSBzZWFyY2hVdGlscy5nZXRDb250ZW50Um9vdENvbnRhaW5lckluZm8odGhpcy5hcHBDb25maWcsIHNlY3Rpb25JZCwgTGF5b3V0SXRlbVR5cGUuU2VjdGlvbiwgdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKCkpXG5cbiAgICAgIGlmICh0eXBlID09PSBDb250YWluZXJUeXBlLkhlYWRlciB8fCB0eXBlID09PSBDb250YWluZXJUeXBlLkZvb3Rlcikge1xuICAgICAgICBzaXplTW9kZUxpc3QgPSBPYmplY3Qua2V5cyh0aGlzLmFwcENvbmZpZ1tpZF0ubGF5b3V0KVxuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBDb250YWluZXJUeXBlLlBhZ2UpIHtcbiAgICAgICAgc2l6ZU1vZGVMaXN0ID0gT2JqZWN0LmtleXModGhpcy5hcHBDb25maWcucGFnZXNbaWRdLmxheW91dClcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gQ29udGFpbmVyVHlwZS5EaWFsb2cpIHtcbiAgICAgICAgc2l6ZU1vZGVMaXN0ID0gT2JqZWN0LmtleXModGhpcy5hcHBDb25maWcuZGlhbG9nc1tpZF0ubGF5b3V0KVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IHNlY3Rpb25TZXJ2aWNlLmFkZFZpZXcodGhpcy5hcHBDb25maWcsIHNlY3Rpb25JZCwgc2l6ZU1vZGVMaXN0IGFzIEJyb3dzZXJTaXplTW9kZVtdKVxuICAgIHRoaXMuYXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgcmV0dXJuIHJlc3VsdFsxXVxuICB9XG5cbiAgLyoqXG4gICAqIER1cGxpY2F0ZSB0aGUgdmlldyBpbiB0aGUgc2VjdGlvbiwgcmV0dXJuIHRoZSBuZXcgdmlldy5cbiAgICogQHBhcmFtIHZpZXdJZFxuICAgKiBAcGFyYW0gc2VjdGlvbklkXG4gICAqIEBwYXJhbSBhZGRUb1NlY3Rpb25cbiAgICovXG4gIGR1cGxpY2F0ZVZpZXcgKHZpZXdJZDogc3RyaW5nLCBzZWN0aW9uSWQ6IHN0cmluZywgYWRkVG9TZWN0aW9uOiBib29sZWFuKTogSU1WaWV3SnNvbiB7XG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSB0aGlzLmFwcENvbmZpZy5zZWN0aW9uc1tzZWN0aW9uSWRdXG4gICAgY29uc3QgZmlyc3RWaWV3ID0gdGhpcy5hcHBDb25maWcudmlld3Nbc2VjdGlvbkpzb24udmlld3NbMF1dXG4gICAgY29uc3Qgc2l6ZU1vZGVMaXN0ID0gT2JqZWN0LmtleXMoZmlyc3RWaWV3LmxheW91dCkgYXMgQnJvd3NlclNpemVNb2RlW11cbiAgICBjb25zdCByZXN1bHQgPSBzZWN0aW9uU2VydmljZS5kdXBsaWNhdGVWaWV3KHRoaXMuYXBwQ29uZmlnLCBzZWN0aW9uSWQsIHZpZXdJZCwgc2l6ZU1vZGVMaXN0LCBhZGRUb1NlY3Rpb24sIG51bGwpXG4gICAgdGhpcy5hcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICBjb25zdCBuZXdJZCA9IHJlc3VsdFsxXVxuXG4gICAgcmV0dXJuIHRoaXMuYXBwQ29uZmlnLnZpZXdzW25ld0lkXVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgdmlldyBmcm9tIHRoZSBzZWN0aW9uLiBUaGUgbGFzdCB2aWV3IGluIHRoZSBzZWN0aW9uIGlzIG5vdCBhbGxvd2VkIHJlbW92ZVxuICAgKiBAcGFyYW0gdmlld0lkXG4gICAqIEBwYXJhbSBzZWN0aW9uSWRcbiAgICovXG4gIHJlbW92ZVZpZXcgKHZpZXdJZDogc3RyaW5nLCBzZWN0aW9uSWQ6IHN0cmluZyk6IHRoaXMge1xuICAgIHRoaXMuYXBwQ29uZmlnID0gc2VjdGlvblNlcnZpY2UucmVtb3ZlVmlldyh0aGlzLmFwcENvbmZpZywgc2VjdGlvbklkLCB2aWV3SWQpXG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyoqXG4gICAqIE1vdmUgdGhlIHZpZXcgcG9zaXRpb24gaW4gdGhlIHNlY3Rpb24uIE1vdmUgdGhlIHZpZXcgdG8gdGhlIHRhcmdldFZpZXcncyBhYm92ZS9iZWxvd1xuICAgKiBAcGFyYW0gc2VjdGlvbklkXG4gICAqIEBwYXJhbSB2aWV3SWRcbiAgICogQHBhcmFtIHRhcmdldFZpZXdJZFxuICAgKiBAcGFyYW0gcG9zaXRpb25cbiAgICovXG4gIG1vdmVWaWV3SW5TZWN0aW9uIChzZWN0aW9uSWQ6IHN0cmluZywgdmlld0lkOiBzdHJpbmcsIHRhcmdldFZpZXdJZDogc3RyaW5nLCBwb3NpdGlvbjogJ2Fib3ZlJyB8ICdiZWxvdycpOiB0aGlzIHtcbiAgICBpZiAoIXRoaXMuYXBwQ29uZmlnLnNlY3Rpb25zIHx8ICF0aGlzLmFwcENvbmZpZy5zZWN0aW9uc1tzZWN0aW9uSWRdIHx8XG4gICAgICAhdGhpcy5hcHBDb25maWcudmlld3MgfHwgIXRoaXMuYXBwQ29uZmlnLnZpZXdzW3ZpZXdJZF0gfHwgIXRoaXMuYXBwQ29uZmlnLnZpZXdzW3RhcmdldFZpZXdJZF0pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgaWYgKHRhcmdldFZpZXdJZCA9PT0gdmlld0lkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCd2aWV3SWQgaXMgc2FtZSB0byB0YXJnZXRWaWV3SWQuJylcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgbGV0IHZpZXdzID0gdGhpcy5hcHBDb25maWcuc2VjdGlvbnNbc2VjdGlvbklkXS52aWV3cy5hc011dGFibGUoKVxuICAgIHZpZXdzID0gdmlld3MuZmlsdGVyKHZpZXcgPT4gdmlldyAhPT0gdmlld0lkKVxuICAgIGxldCBpbmRleCA9IHZpZXdzLmluZGV4T2YodGFyZ2V0Vmlld0lkKVxuICAgIGlmIChwb3NpdGlvbiA9PT0gJ2JlbG93JykgaW5kZXgrK1xuICAgIHZpZXdzID0gdmlld3Muc2xpY2UoMCwgaW5kZXgpLmNvbmNhdCh2aWV3SWQpLmNvbmNhdCh2aWV3cy5zbGljZShpbmRleCkpXG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgc2VjdGlvbklkLCAndmlld3MnXSwgdmlld3MpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8vICNlbmRyZWdpb25cblxuICAvLyAjcmVnaW9uIFNjcmVlbiBHcm91cCBBUElzLCBTY3JlZW4gQVBJc1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgYW4gZW1wdHkgc2NyZWVuIGdyb3VwXG4gICAqL1xuICBjcmVhdGVTY3JlZW5Hcm91cCAoKTogSU1TY3JlZW5Hcm91cEpzb24ge1xuICAgIC8vIENyZWF0ZSBhIG5ldyBzY3JlZW5Hcm91cEpzb25cbiAgICBjb25zdCBzY3JlZW5Hcm91cElkID0gYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQodGhpcy5hcHBDb25maWcsICdzY3JlZW5Hcm91cCcpXG4gICAgY29uc3Qgc2NyZWVuR3JvdXBMYWJlbCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUxhYmVsKHRoaXMuYXBwQ29uZmlnLCAnc2NyZWVuR3JvdXAnLCBpMThuLmdldEludGwoKS5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdzY3JlZW5Hcm91cCcgfSkpXG4gICAgY29uc3Qgc2NyZWVuR3JvdXBKc29uID0gSW1tdXRhYmxlKHtcbiAgICAgIGlkOiBzY3JlZW5Hcm91cElkLFxuICAgICAgbGFiZWw6IHNjcmVlbkdyb3VwTGFiZWwsXG4gICAgICBzY3JlZW5zOiBbXSxcbiAgICAgIHRyYW5zaXRpb25UeXBlOiBTY3JlZW5UcmFuc2l0aW9uVHlwZS5GYWRlXG4gICAgfSkgYXMgSU1TY3JlZW5Hcm91cEpzb25cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnc2NyZWVuR3JvdXBzJywgc2NyZWVuR3JvdXBKc29uLmlkXSwgc2NyZWVuR3JvdXBKc29uKVxuXG4gICAgcmV0dXJuIHNjcmVlbkdyb3VwSnNvblxuICB9XG5cbiAgZWRpdFNjcmVlbkdyb3VwUHJvcGVydHkgKHNjcmVlbkdyb3VwSWQ6IHN0cmluZywgcHJvcDogc3RyaW5nLCB2YWw6IGFueSk6IHRoaXMge1xuICAgIGxldCBzZ0pzb24gPSB0aGlzLmFwcENvbmZpZy5zY3JlZW5Hcm91cHNbc2NyZWVuR3JvdXBJZF1cbiAgICBpZiAoIXNnSnNvbikge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgc2dKc29uID0gdGhpcy5lZGl0SnNvblByb3BlcnR5KHNnSnNvbiwgcHJvcCwgdmFsKSBhcyBhbnlcblxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydzY3JlZW5Hcm91cHMnLCBzY3JlZW5Hcm91cElkXSwgc2dKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBlZGl0U2NyZWVuUHJvcGVydHkgKHNjcmVlbklkOiBzdHJpbmcsIHByb3A6IHN0cmluZywgdmFsOiBhbnkpOiB0aGlzIHtcbiAgICBsZXQgc2NyZWVuSnNvbiA9IHRoaXMuYXBwQ29uZmlnLnNjcmVlbnNbc2NyZWVuSWRdXG4gICAgaWYgKCFzY3JlZW5Kc29uKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICBzY3JlZW5Kc29uID0gdGhpcy5lZGl0SnNvblByb3BlcnR5KHNjcmVlbkpzb24sIHByb3AsIHZhbCkgYXMgYW55XG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbnMnLCBzY3JlZW5JZF0sIHNjcmVlbkpzb24pXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIG1vdmVTY3JlZW5Jbkdyb3VwIChzY3JlZW5Hcm91cElkOiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIHRhcmdldEluZGV4OiBudW1iZXIsIHBvc2l0aW9uOiAnYWJvdmUnIHwgJ2JlbG93Jyk6IHRoaXMge1xuICAgIGlmICghdGhpcy5hcHBDb25maWcuc2NyZWVuR3JvdXBzPy5bc2NyZWVuR3JvdXBJZF0gfHwgaW5kZXggPT09IHRhcmdldEluZGV4KSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIGNvbnN0IHNjcmVlbnMgPSB0aGlzLmFwcENvbmZpZy5zY3JlZW5Hcm91cHNbc2NyZWVuR3JvdXBJZF0uc2NyZWVucy5hc011dGFibGUoKVxuXG4gICAgY29uc3QgZHJhZ0lkID0gc2NyZWVuc1tpbmRleF1cbiAgICBjb25zdCB0YXJnZXRJZCA9IHNjcmVlbnNbdGFyZ2V0SW5kZXhdXG4gICAgc2NyZWVucy5zcGxpY2UoaW5kZXgsIDEpXG5cbiAgICBjb25zdCBuZXdUYXJnZXRJbmRleCA9IHNjcmVlbnMuaW5kZXhPZih0YXJnZXRJZClcbiAgICBpZiAocG9zaXRpb24gPT09ICdiZWxvdycpIHtcbiAgICAgIHNjcmVlbnMuc3BsaWNlKG5ld1RhcmdldEluZGV4LCAxLCB0YXJnZXRJZCwgZHJhZ0lkKVxuICAgIH0gZWxzZSB7XG4gICAgICBzY3JlZW5zLnNwbGljZShuZXdUYXJnZXRJbmRleCwgMSwgZHJhZ0lkLCB0YXJnZXRJZClcbiAgICB9XG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnc2NyZWVuR3JvdXBzJywgc2NyZWVuR3JvdXBJZCwgJ3NjcmVlbnMnXSwgc2NyZWVucylcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcmVtb3ZlU2NyZWVuQnlJbmRleCAoaW5kZXg6IG51bWJlciwgc2NyZWVuR3JvdXBJZDogc3RyaW5nKTogdGhpcyB7XG4gICAgY29uc3Qgc2NyZWVucyA9IHRoaXMuYXBwQ29uZmlnLnNjcmVlbkdyb3Vwcz8uW3NjcmVlbkdyb3VwSWRdPy5zY3JlZW5zXG4gICAgY29uc3Qgc2NyZWVuSWQgPSBzY3JlZW5zPy5baW5kZXhdXG4gICAgcmV0dXJuIHRoaXMucmVtb3ZlU2NyZWVuKHNjcmVlbklkLCBzY3JlZW5Hcm91cElkKVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgc2NyZWVuIGZyb20gdGhlIHNjcmVlbiBncm91cC4gVGhlIGxhc3Qgc2NyZWVuIGluIHRoZSBzY3JlZW4gZ3JvdXAgaXMgbm90IGFsbG93ZWQgcmVtb3ZlXG4gICAqIEBwYXJhbSBzY3JlZW5JZFxuICAgKiBAcGFyYW0gc2NyZWVuR3JvdXBJZFxuICAgKi9cbiAgcmVtb3ZlU2NyZWVuIChzY3JlZW5JZDogc3RyaW5nLCBzY3JlZW5Hcm91cElkOiBzdHJpbmcsIGZvcmNlID0gZmFsc2UpOiB0aGlzIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHNjcmVlbkdyb3VwU2VydmljZS5yZW1vdmVTY3JlZW4odGhpcy5hcHBDb25maWcsIHNjcmVlbkdyb3VwSWQsIHNjcmVlbklkKVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGR1cGxpY2F0ZVNjcmVlbkJ5SW5kZXggKGluZGV4OiBudW1iZXIsIHNjcmVlbkdyb3VwSWQ6IHN0cmluZywgYWRkVG9TY3JlZW5Hcm91cCA9IHRydWUpOiBJTVNjcmVlbkpzb24ge1xuICAgIGNvbnN0IHNjcmVlbnMgPSB0aGlzLmFwcENvbmZpZy5zY3JlZW5Hcm91cHM/LltzY3JlZW5Hcm91cElkXT8uc2NyZWVuc1xuICAgIGNvbnN0IHNjcmVlbklkID0gc2NyZWVucz8uW2luZGV4XVxuICAgIHJldHVybiB0aGlzLmR1cGxpY2F0ZVNjcmVlbihzY3JlZW5JZCwgc2NyZWVuR3JvdXBJZCwgYWRkVG9TY3JlZW5Hcm91cClcbiAgfVxuXG4gIC8qKlxuICAgKiBEdXBsaWNhdGUgdGhlIHNjcmVlbiBpbiB0aGUgc2NyZWVuIGdyb3VwLCByZXR1cm4gdGhlIG5ldyBzY3JlZW4uXG4gICAqIEBwYXJhbSBzY3JlZW5JZFxuICAgKiBAcGFyYW0gc2NyZWVuR3JvdXBJZFxuICAgKiBAcGFyYW0gYWRkVG9TY3JlZW5Hcm91cFxuICAgKi9cbiAgZHVwbGljYXRlU2NyZWVuIChzY3JlZW5JZDogc3RyaW5nLCBzY3JlZW5Hcm91cElkOiBzdHJpbmcsIGFkZFRvU2NyZWVuR3JvdXAgPSB0cnVlKTogSU1TY3JlZW5Kc29uIHtcbiAgICBjb25zdCBzZ0pzb24gPSB0aGlzLmFwcENvbmZpZy5zY3JlZW5Hcm91cHNbc2NyZWVuR3JvdXBJZF1cbiAgICBjb25zdCBmaXJzdFNjcmVlbiA9IHRoaXMuYXBwQ29uZmlnLnNjcmVlbnNbc2dKc29uLnNjcmVlbnNbMF1dXG4gICAgY29uc3Qgc2l6ZU1vZGVMaXN0ID0gT2JqZWN0LmtleXMoZmlyc3RTY3JlZW4ubWFpbi5sYXlvdXQpIGFzIEJyb3dzZXJTaXplTW9kZVtdXG5cbiAgICBjb25zdCByZXN1bHQgPSBzY3JlZW5Hcm91cFNlcnZpY2UuZHVwbGljYXRlU2NyZWVuKHRoaXMuYXBwQ29uZmlnLCBzY3JlZW5Hcm91cElkLCBzY3JlZW5JZCwgc2l6ZU1vZGVMaXN0LCBhZGRUb1NjcmVlbkdyb3VwLCBudWxsKVxuICAgIHRoaXMuYXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgY29uc3QgbmV3SWQgPSByZXN1bHRbMV1cbiAgICByZXR1cm4gdGhpcy5hcHBDb25maWcuc2NyZWVuc1tuZXdJZF1cbiAgfVxuXG4gIC8vICNlbmRyZWdpb25cblxuICAvLyAjcmVnaW9uIFBhZ2UgQVBJc1xuXG4gIGVkaXRQYWdlUHJvcGVydHkgKHBhZ2VJZDogc3RyaW5nLCBwcm9wOiBzdHJpbmcsIHZhbDogYW55KTogdGhpcyB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy5wYWdlcyB8fCAhdGhpcy5hcHBDb25maWcucGFnZXNbcGFnZUlkXSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgbGV0IHBhZ2VKc29uID0gdGhpcy5hcHBDb25maWcucGFnZXNbcGFnZUlkXVxuICAgIHBhZ2VKc29uID0gdGhpcy5lZGl0SnNvblByb3BlcnR5KHBhZ2VKc29uLCBwcm9wLCB2YWwpIGFzIGFueVxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydwYWdlcycsIHBhZ2VJZF0sIHBhZ2VKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIHBhZ2VKc29uXG4gICAqXG4gICAqIEFkZCBhIG5ldyBwYWdlLiBPbmx5IHRoZSBmb2xkZXIgYW5kIGxpbmsgcGFnZSBpcyBjcmVhdGVkIGhlcmUuXG4gICAqIFRoZSBvdGhlciBwYWdlICh0aGUgcGFnZSBjYW4gcHV0IHdpZGdldHMpIGFyZSBjcmVhdGVkIGluIGB0ZW1wbGF0ZS11dGlscyBpbiBqaW11LWZvci1idWlsZGVyYFxuICAgKi9cbiAgYWRkUGFnZSAocGFnZUpzb246IElNUGFnZUpzb24pOiB0aGlzIHtcbiAgICBpZiAodGhpcy5hcHBDb25maWcucGFnZXMgJiYgdGhpcy5hcHBDb25maWcucGFnZXNbcGFnZUpzb24uaWRdKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydwYWdlcycsIHBhZ2VKc29uLmlkXSwgcGFnZUpzb24pXG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ3BhZ2VTdHJ1Y3R1cmUnLCB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlLmNvbmNhdChbeyBbcGFnZUpzb24uaWRdOiBbXSB9IGFzIGFueV0pKVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0gcGFnZUlkXG4gICAqIEBwYXJhbSBkdXBsaWNhdGVQYWdlSnNvbk9ubHlcbiAgICogaWYgZHVwbGljYXRlUGFnZUpzb25Pbmx5IGlzIHRydWUsIHRoZSBwYWdlIHdvbid0IGJlIHB1dCBpbnRvIHBhZ2Ugc3RydWN0dXJlLlxuICAgKiBJdCdzIHVzZWQgd2hlbiBvbmUgcGFnZShvciBmb2xkZXIsIG9yIGxpbmspIG5lZWQgdG8gZHVwbGljYXRlIGl0cyBzdWIgcGFnZXMuXG4gICAqXG4gICAqIFRoaXMgbG9naWMgbmVlZCB0byBiZSByZWZhY3RlZCB3aGVuIHBhZ2Ugc3RydWN0dXJlIGhhcyBtb3JlIHRoYW4gdHdvIGxldmVscy5cbiAgICovXG4gIGR1cGxpY2F0ZVBhZ2UgKHBhZ2VJZDogc3RyaW5nLCBkdXBsaWNhdGVQYWdlSnNvbk9ubHk6IGJvb2xlYW4gPSBmYWxzZSk6IElNUGFnZUpzb24ge1xuICAgIGlmICghdGhpcy5hcHBDb25maWcucGFnZXMgfHwgIXRoaXMuYXBwQ29uZmlnLnBhZ2VzW3BhZ2VJZF0pIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgLy8gdGhpcy5pc0R1cGxpY2F0aW5nUGFnZSA9IHRydWVcbiAgICBsZXQgbmV3UGFnZUpzb24gPSB0aGlzLmFwcENvbmZpZy5wYWdlc1twYWdlSWRdLnNldCgnaWQnLCBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVJZCh0aGlzLmFwcENvbmZpZywgJ3BhZ2UnKSlcbiAgICBuZXdQYWdlSnNvbiA9IG5ld1BhZ2VKc29uLnNldCgnbGFiZWwnLCB0aGlzLmdldER1cGxpY2F0ZUxhYmVsKCdwYWdlJywgbmV3UGFnZUpzb24ubGFiZWwpKVxuXG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3BhZ2VzJywgbmV3UGFnZUpzb24uaWRdLCBuZXdQYWdlSnNvbilcblxuICAgIGlmIChuZXdQYWdlSnNvbi5pc0RlZmF1bHQpIHtcbiAgICAgIG5ld1BhZ2VKc29uID0gbmV3UGFnZUpzb24uc2V0KCdpc0RlZmF1bHQnLCBmYWxzZSlcbiAgICB9XG5cbiAgICAvLyBkdXBsaWNhdGUgdGhlIHBhZ2Ugc2VsZlxuICAgIGlmIChuZXdQYWdlSnNvbi50eXBlICE9PSBQYWdlVHlwZS5MaW5rICYmIG5ld1BhZ2VKc29uLnR5cGUgIT09IFBhZ2VUeXBlLkZvbGRlcikge1xuICAgICAgY29uc3QgZHVwbGljYXRlQ29udGV4dCA9IHt9XG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodGhpcy5hcHBDb25maWcsIG5ld1BhZ2VKc29uLmxheW91dClcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuZHVwbGljYXRlU2l6ZU1vZGVMYXlvdXRzKHRoaXMuYXBwQ29uZmlnLCBuZXdQYWdlSnNvbi5sYXlvdXQsIExheW91dFBhcmVudFR5cGUuUGFnZSwgbmV3UGFnZUpzb24uaWQsIGR1cGxpY2F0ZUNvbnRleHQpXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgbmV3UGFnZUpzb24gPSBuZXdQYWdlSnNvbi5zZXQoJ2xheW91dCcsIHJlc3VsdFsxXSlcbiAgICAgIC8vIHRoaXMuaXNEdXBsaWNhdGluZ1BhZ2UgPSBmYWxzZVxuICAgICAgLy8gaGFuZGxlIGludGVybmFsIGNvbmZpZyBhZnRlciBjb3B5aW5nIHRoZSB3aWRnZXQuXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHdpZGdldFNlcnZpY2UuYWZ0ZXJCYXRjaENvcGllZCh0aGlzLmFwcENvbmZpZywgdGhpcy5hcHBDb25maWcsIGR1cGxpY2F0ZUNvbnRleHQpXG4gICAgfVxuXG4gICAgY29uc3QgcHMgPSB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlLmZpbmQocHMgPT4gISFwc1twYWdlSWRdKVxuICAgIC8vIGR1cGxpY2F0ZSBzdWIgcGFnZXMgaWYgaXQgaGFzXG4gICAgY29uc3QgbmV3U3ViUElkID0gW11cbiAgICBpZiAocHMpIHtcbiAgICAgIHBzW3BhZ2VJZF0uZm9yRWFjaChzdWJJZCA9PiB7XG4gICAgICAgIC8vIGFkZCBzdWIgcGFnZVxuICAgICAgICBjb25zdCBuZXdTdWJQYWdlSnNvbiA9IHRoaXMuZHVwbGljYXRlUGFnZShzdWJJZCwgdHJ1ZSlcbiAgICAgICAgbmV3U3ViUElkLnB1c2gobmV3U3ViUGFnZUpzb24uaWQpXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIGhhbmRsZSB0aGUgc3RydWN0dXJlXG4gICAgaWYgKCFkdXBsaWNhdGVQYWdlSnNvbk9ubHkpIHtcbiAgICAgIGlmIChwcykgeyAvLyBmaXJzdCBhc3BlY3QgIGFkZCBwc1xuICAgICAgICAvLyBhZGQgcGFyZW50IHBzXG4gICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0KCdwYWdlU3RydWN0dXJlJywgdGhpcy5hcHBDb25maWcucGFnZVN0cnVjdHVyZS5jb25jYXQoW3sgW25ld1BhZ2VKc29uLmlkXTogW10gfSBhcyBhbnldKSlcblxuICAgICAgICBpZiAobmV3U3ViUElkLmxlbmd0aCA+IDApIHsgLy8gYWRkIHN1YiBwc1xuICAgICAgICAgIGNvbnN0IHBhcmVudFBJZCA9IG5ld1BhZ2VKc29uLmlkXG4gICAgICAgICAgbGV0IHBzSW5kZXggPSB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlLmxlbmd0aCAtIDFcbiAgICAgICAgICBpZiAocHNJbmRleCA8IDApIHBzSW5kZXggPSAwXG4gICAgICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3BhZ2VTdHJ1Y3R1cmUnLCBwc0luZGV4ICsgJycsIHBhcmVudFBJZF0sIG5ld1N1YlBJZClcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgIHRoaXMuYXBwQ29uZmlnLnBhZ2VTdHJ1Y3R1cmUuc29tZSgocHMsIGkpID0+IHtcbiAgICAgICAgICBjb25zdCBwSWQgPSBPYmplY3Qua2V5cyhwcykuZmluZChwSWQgPT4gcHNbcElkXS5pbmNsdWRlcyhwYWdlSWQpKVxuICAgICAgICAgIGlmIChwSWQpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydwYWdlU3RydWN0dXJlJywgaSArICcnLCBwSWRdLCB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlW2ldW3BJZF0uY29uY2F0KG5ld1BhZ2VKc29uLmlkKSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydwYWdlcycsIG5ld1BhZ2VKc29uLmlkXSwgbmV3UGFnZUpzb24pXG5cbiAgICByZXR1cm4gbmV3UGFnZUpzb25cbiAgfVxuXG4gIG1vdmVQYWdlSW50b1BhZ2UgKHN1YlBhZ2VJZDogc3RyaW5nLCBwYXJlbnRQYWdlSWQ6IHN0cmluZyk6IHRoaXMge1xuICAgIGlmICghdGhpcy5hcHBDb25maWcucGFnZXMgfHwgIXRoaXMuYXBwQ29uZmlnLnBhZ2VzW3N1YlBhZ2VJZF0gfHwgIXRoaXMuYXBwQ29uZmlnLnBhZ2VzW3BhcmVudFBhZ2VJZF0pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgaWYgKHN1YlBhZ2VJZCA9PT0gcGFyZW50UGFnZUlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTdWJQYWdlIGlzIHNhbWUgdG8gUGFyZW50UGFnZS4nKVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICBpZiAoIWFwcENvbmZpZ1V0aWxzLmlzRmlyc3RMZXZlbFBhZ2UodGhpcy5hcHBDb25maWcsIHBhcmVudFBhZ2VJZCkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1BhcmVudFBhZ2UgaXMgbm90IG9uIHRoZSBmaXJzdCBhc3BlY3QuJylcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgaWYgKGFwcENvbmZpZ1V0aWxzLmlzUGFnZUhhc1N1YlBhZ2UodGhpcy5hcHBDb25maWcsIHN1YlBhZ2VJZCkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1YlBhZ2UgaGFzIHN1YiBwYWdlKHMpLicpXG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIHRoaXMucmVtb3ZlUGFnZUZyb21QYWdlU3RydWN0dXJlKHN1YlBhZ2VJZClcbiAgICB0aGlzLm1vdmVQYWdlSW50b1BhZ2VGb3JQYWdlU3RydWN0dXJlKHN1YlBhZ2VJZCwgcGFyZW50UGFnZUlkKVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIG9yZGVyUGFnZVRvUGFnZSAocGFnZUlkOiBzdHJpbmcsIHRhcmdldFBhZ2VJZDogc3RyaW5nLCB0eXBlOiAndG9wJyB8ICdib3R0b20nKTogdGhpcyB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy5wYWdlcyB8fCAhdGhpcy5hcHBDb25maWcucGFnZXNbdGFyZ2V0UGFnZUlkXSB8fCAhdGhpcy5hcHBDb25maWcucGFnZXNbcGFnZUlkXSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0UGFnZUlkID09PSBwYWdlSWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3BhZ2VJZCBpcyBzYW1lIHRvIHRhcmdldFBhZ2VJZC4nKVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICBjb25zdCBpc1RvcFBhZ2VTdWIgPSAhYXBwQ29uZmlnVXRpbHMuaXNGaXJzdExldmVsUGFnZSh0aGlzLmFwcENvbmZpZywgdGFyZ2V0UGFnZUlkKVxuXG4gICAgaWYgKChhcHBDb25maWdVdGlscy5pc1BhZ2VIYXNTdWJQYWdlKHRoaXMuYXBwQ29uZmlnLCBwYWdlSWQpIHx8IHRoaXMuYXBwQ29uZmlnLnBhZ2VzW3BhZ2VJZF0udHlwZSA9PT0gUGFnZVR5cGUuRm9sZGVyKSAmJiBpc1RvcFBhZ2VTdWIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3BhZ2Ugc3RydWN0dXJlIGFsbG93IHR3byBhc3BlY3RzIG9ubHknKVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICAvLyBnZXQgcGFnZUlkJ3MgcGFnZSBzdHJ1Y3R1cmVcbiAgICBjb25zdCBwcyA9IHRoaXMuYXBwQ29uZmlnLnBhZ2VTdHJ1Y3R1cmUuZmluZChwcyA9PiAhIXBzW3BhZ2VJZF0pXG4gICAgdGhpcy5yZW1vdmVQYWdlRnJvbVBhZ2VTdHJ1Y3R1cmUocGFnZUlkKVxuICAgIGlmIChpc1RvcFBhZ2VTdWIpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgdGhpcy5hcHBDb25maWcucGFnZVN0cnVjdHVyZS5zb21lKChwLCBpKSA9PiB7XG4gICAgICAgIGNvbnN0IHBJZCA9IE9iamVjdC5rZXlzKHApWzBdXG4gICAgICAgIGxldCBpbmRleCA9IHBbcElkXS5pbmRleE9mKHRhcmdldFBhZ2VJZClcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICBsZXQgc3ViUFMgPSB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlW2ldW3BJZF1cbiAgICAgICAgICBpZiAodHlwZSA9PT0gJ2JvdHRvbScpIHtcbiAgICAgICAgICAgIGluZGV4ID0gaW5kZXggKyAxXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3ViUFMgPSBzdWJQUy5zbGljZSgwLCBpbmRleCkuY29uY2F0KFtwYWdlSWRdKS5jb25jYXQoc3ViUFMuc2xpY2UoaW5kZXgpKSBhcyBhbnlcbiAgICAgICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsncGFnZVN0cnVjdHVyZScsIGkgKyAnJywgcElkXSwgc3ViUFMpXG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlLnNvbWUoKHAsIGkpID0+IHtcbiAgICAgICAgY29uc3QgcElkID0gT2JqZWN0LmtleXMocClbMF1cbiAgICAgICAgaWYgKHBJZCA9PT0gdGFyZ2V0UGFnZUlkKSB7XG4gICAgICAgICAgaWYgKHR5cGUgPT09ICdib3R0b20nKSB7XG4gICAgICAgICAgICBpID0gaSArIDFcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgcGFnZVN0cnVjdHVyZSA9IHRoaXMuYXBwQ29uZmlnLnBhZ2VTdHJ1Y3R1cmUuc2xpY2UoMCwgaSkuY29uY2F0KFtwcyB8fCB7IFtwYWdlSWRdOiBbXSB9IGFzIGFueV0pLmNvbmNhdCh0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlLnNsaWNlKGkpKVxuICAgICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0KCdwYWdlU3RydWN0dXJlJywgcGFnZVN0cnVjdHVyZSlcbiAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICByZW1vdmVQYWdlIChwYWdlSWQ6IHN0cmluZywgbmV3SG9tZVBhZ2VJZD86IHN0cmluZyk6IHRoaXMge1xuICAgIGlmICghdGhpcy5hcHBDb25maWcucGFnZXMgfHwgIXRoaXMuYXBwQ29uZmlnLnBhZ2VzW3BhZ2VJZF0pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgLy8gVE9ETyBoYW5kbGUgaGVhZGVyL2Zvb3RlclxuICAgIGNvbnN0IHBhZ2VKc29uID0gdGhpcy5hcHBDb25maWcucGFnZXNbcGFnZUlkXVxuICAgIGlmIChwYWdlSnNvbi50eXBlICE9PSBQYWdlVHlwZS5Gb2xkZXIgJiYgcGFnZUpzb24udHlwZSAhPT0gUGFnZVR5cGUuTGluaykge1xuICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlRnJvbVNpemVNb2RlTGF5b3V0KHRoaXMuYXBwQ29uZmlnLCBwYWdlSnNvbi5sYXlvdXQpXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHNlcnZpY2UucmVtb3ZlU2l6ZU1vZGVMYXlvdXRzKHRoaXMuYXBwQ29uZmlnLCBwYWdlSnNvbi5sYXlvdXQpXG4gICAgfVxuXG4gICAgY29uc3QgeyBwYWdlU3RydWN0dXJlIH0gPSB0aGlzLmFwcENvbmZpZ1xuICAgIGNvbnN0IHBzID0gcGFnZVN0cnVjdHVyZSAmJiBwYWdlU3RydWN0dXJlLmZpbmQocHMgPT4gISFwc1twYWdlSWRdKVxuICAgIGlmIChwcyAmJiBwc1twYWdlSWRdLmxlbmd0aCA+IDApIHtcbiAgICAgIHBzW3BhZ2VJZF0uZm9yRWFjaChzdWJQSWQgPT4ge1xuICAgICAgICB0aGlzLnJlbW92ZVBhZ2Uoc3ViUElkKVxuICAgICAgICAvLyB0aGlzLm9yZGVyUGFnZVRvUGFnZShzdWJQSWQsIE9iamVjdC5rZXlzKHBhZ2VTdHJ1Y3R1cmVbcGFnZVN0cnVjdHVyZS5sZW5ndGggLSAxXSlbMF0sICdib3R0b20nKTtcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5yZW1vdmVQYWdlRnJvbVBhZ2VTdHJ1Y3R1cmUocGFnZUlkKVxuXG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ3BhZ2VzJywgdGhpcy5hcHBDb25maWcucGFnZXMud2l0aG91dChwYWdlSWQpKVxuXG4gICAgLy8gc2V0IG5ldyBob21lIHBhZ2UgaWYgY3VycmVudCBwYWdlIGlzIGRlZmF1bHRcbiAgICBpZiAobmV3SG9tZVBhZ2VJZCkge1xuICAgICAgdGhpcy5zZXRIb21lUGFnZShuZXdIb21lUGFnZUlkKVxuICAgIH1cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgc2V0SG9tZVBhZ2UgKHBhZ2VJZDogc3RyaW5nKTogdGhpcyB7XG4gICAgcmV0dXJuIHRoaXMuZWRpdFBhZ2VQcm9wZXJ0eShwYWdlSWQsICdpc0RlZmF1bHQnLCB0cnVlKVxuICB9XG5cbiAgc2V0VXNlQXV0b1NvcnRJbkZpeGVkTGF5b3V0ICh2YWx1ZTogYm9vbGVhbik6IHRoaXMge1xuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0KCd1c2VBdXRvU29ydEluRml4ZWRMYXlvdXQnLCB2YWx1ZSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcmVwbGFjZUhvbWVQYWdlIChwYWdlSWQ6IHN0cmluZyk6IHRoaXMge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIE9iamVjdC5rZXlzKHRoaXMuYXBwQ29uZmlnLnBhZ2VzKS5zb21lKChrZXksIGkpID0+IHtcbiAgICAgIGNvbnN0IHBhZ2VKc29uID0gdGhpcy5hcHBDb25maWcucGFnZXNba2V5XVxuICAgICAgaWYgKHBhZ2VKc29uLmlzRGVmYXVsdCkge1xuICAgICAgICB0aGlzLmVkaXRQYWdlUHJvcGVydHkocGFnZUpzb24uaWQsICdpc0RlZmF1bHQnLCBmYWxzZSlcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiB0aGlzLmVkaXRQYWdlUHJvcGVydHkocGFnZUlkLCAnaXNEZWZhdWx0JywgdHJ1ZSlcbiAgfVxuXG4gIC8vICNlbmRyZWdpb25cblxuICAvLyAjcmVnaW9uIERpYWxvZyBBUElzXG4gIGVkaXREaWFsb2cgKGRpYWxvZ0pzb246IElNRGlhbG9nSnNvbik6IHRoaXMge1xuICAgIC8vIHVwZGF0ZSBkaWFsb2dzJyBpbmRleCBhbmQgY29uZmlnIG9yZGVyIHdoZW4gbW9kZSBpcyBjaGFuZ2VkLlxuICAgIGNvbnN0IHByZXZEaWxnTW9kZSA9IHRoaXMuYXBwQ29uZmlnLmRpYWxvZ3NbZGlhbG9nSnNvbi5pZF0ubW9kZVxuICAgIGlmIChwcmV2RGlsZ01vZGUgIT09IGRpYWxvZ0pzb24ubW9kZSkge1xuICAgICAgY29uc3QgZGlhbG9ncyA9IHRoaXMuYXBwQ29uZmlnLmRpYWxvZ3MuYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KVxuICAgICAgT2JqZWN0LmtleXMoZGlhbG9ncykuZm9yRWFjaChkbGdJZCA9PiB7XG4gICAgICAgIGNvbnN0IGRsZyA9IGRpYWxvZ3NbZGxnSWRdXG4gICAgICAgIGlmIChkbGcuaWQgPT09IGRpYWxvZ0pzb24uaWQpIHtcbiAgICAgICAgICBkaWFsb2dzW2RsZ0lkXSA9IE9iamVjdC5hc3NpZ24oe30sIGRpYWxvZ0pzb24uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KSwge1xuICAgICAgICAgICAgaW5kZXg6IE9iamVjdC5rZXlzKGRpYWxvZ3MpLmZpbHRlcihkbGdJZCA9PiBkaWFsb2dzW2RsZ0lkXS5tb2RlICE9PSBwcmV2RGlsZ01vZGUpLmxlbmd0aFxuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoZGxnLm1vZGUgPT09IHByZXZEaWxnTW9kZSkge1xuICAgICAgICAgIGlmIChkbGcuaW5kZXggPiBkaWFsb2dKc29uLmluZGV4KSB7XG4gICAgICAgICAgICBkbGcuaW5kZXggPSBkbGcuaW5kZXggLSAxXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ2RpYWxvZ3MnLCBJbW11dGFibGUoZGlhbG9ncykpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydkaWFsb2dzJywgZGlhbG9nSnNvbi5pZF0sIGRpYWxvZ0pzb24pXG4gICAgfVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBlZGl0RGlhbG9nUHJvcGVydHkgKGRsZ0lkOiBzdHJpbmcsIHByb3A6IHN0cmluZywgdmFsOiBhbnkpOiB0aGlzIHtcbiAgICBpZiAoIXRoaXMuYXBwQ29uZmlnLmRpYWxvZ3MgfHwgIXRoaXMuYXBwQ29uZmlnLmRpYWxvZ3NbZGxnSWRdKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICBsZXQgZGxnSnNvbiA9IHRoaXMuYXBwQ29uZmlnLmRpYWxvZ3NbZGxnSWRdXG4gICAgZGxnSnNvbiA9IHRoaXMuZWRpdEpzb25Qcm9wZXJ0eShkbGdKc29uLCBwcm9wLCB2YWwpIGFzIGFueVxuXG4gICAgcmV0dXJuIHRoaXMuZWRpdERpYWxvZyhkbGdKc29uKVxuICB9XG5cbiAgcmVtb3ZlRGlhbG9nIChkaWFsb2dJZDogc3RyaW5nKTogdGhpcyB7XG4gICAgY29uc3QgZGlhbG9nSnNvbiA9IHRoaXMuYXBwQ29uZmlnLmRpYWxvZ3M/LltkaWFsb2dJZF1cbiAgICBpZiAoIWRpYWxvZ0pzb24pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZUZyb21TaXplTW9kZUxheW91dCh0aGlzLmFwcENvbmZpZywgZGlhbG9nSnNvbi5sYXlvdXQpXG4gICAgdGhpcy5hcHBDb25maWcgPSBzZXJ2aWNlLnJlbW92ZVNpemVNb2RlTGF5b3V0cyh0aGlzLmFwcENvbmZpZywgZGlhbG9nSnNvbi5sYXlvdXQpXG5cbiAgICAvLyB1cGRhdGUgZGlhbG9ncycgb3JkZXJcbiAgICBjb25zdCBjdXJyZW50RGxnTW9kZSA9IGRpYWxvZ0pzb24ubW9kZVxuICAgIGNvbnN0IGN1cnJlbnREbGdJbmRleCA9IGRpYWxvZ0pzb24uaW5kZXhcbiAgICBjb25zdCBkaWFsb2dzID0gdGhpcy5hcHBDb25maWcuZGlhbG9ncy53aXRob3V0KGRpYWxvZ0lkKS5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pXG4gICAgT2JqZWN0LmtleXMoZGlhbG9ncykuZm9yRWFjaChkbGdJZCA9PiB7XG4gICAgICBjb25zdCBkbGcgPSBkaWFsb2dzW2RsZ0lkXVxuICAgICAgaWYgKGRsZy5tb2RlID09PSBjdXJyZW50RGxnTW9kZSAmJiBkbGcuaW5kZXggPiBjdXJyZW50RGxnSW5kZXgpIHtcbiAgICAgICAgZGxnLmluZGV4ID0gZGxnLmluZGV4IC0gMVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgnZGlhbG9ncycsIEltbXV0YWJsZShkaWFsb2dzKSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgZHVwbGljYXRlRGlhbG9nIChkaWFsb2dJZDogc3RyaW5nKTogSU1EaWFsb2dKc29uIHtcbiAgICBjb25zdCBkaWFsb2dzID0gdGhpcy5hcHBDb25maWcuZGlhbG9nc1xuICAgIGxldCBuZXdEbGdKc29uID0gZGlhbG9nc1tkaWFsb2dJZF1cbiAgICBpZiAoIWRpYWxvZ3MgfHwgIW5ld0RsZ0pzb24pIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgY29uc3QgbmV3RGxnSWQgPSBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVJZCh0aGlzLmFwcENvbmZpZywgJ2RpYWxvZycpXG4gICAgY29uc3QgZHVwbGljYXRlQ29udGV4dCA9IHt9XG4gICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlRnJvbVNpemVNb2RlTGF5b3V0KHRoaXMuYXBwQ29uZmlnLCBuZXdEbGdKc29uLmxheW91dClcbiAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZVNpemVNb2RlTGF5b3V0cyh0aGlzLmFwcENvbmZpZywgbmV3RGxnSnNvbi5sYXlvdXQsIExheW91dFBhcmVudFR5cGUuRGlhbG9nLCBuZXdEbGdJZCwgZHVwbGljYXRlQ29udGV4dClcbiAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgIGNvbnN0IHNpemVNb2RlTGF5b3V0ID0gcmVzdWx0WzFdXG4gICAgdGhpcy5hcHBDb25maWcgPSB3aWRnZXRTZXJ2aWNlLmFmdGVyQmF0Y2hDb3BpZWQodGhpcy5hcHBDb25maWcsIHRoaXMuYXBwQ29uZmlnLCBkdXBsaWNhdGVDb250ZXh0KVxuXG4gICAgLy8gZ2V0IG1heCBpbmRleCBmb3IgY3VycmVudCBkaWFsb2cgbW9kZS5cbiAgICBjb25zdCBkbGdNYXhJbmRleCA9IE9iamVjdC5rZXlzKE9iamVjdC5rZXlzKGRpYWxvZ3MpLmZpbHRlcihkbGdJZCA9PiBkaWFsb2dzW2RsZ0lkXS5tb2RlID09PSBuZXdEbGdKc29uLm1vZGUpKS5sZW5ndGhcblxuICAgIC8vIGR1cGxpY2F0ZSB0aGUgZGlhbG9nIHdpdGggdW5pcXVlIGlkIGFuZCBsYWJlbCwgaW5kZXgsICBhbmQgbGF5b3V0IGNvcHlcbiAgICBuZXdEbGdKc29uID0gbmV3RGxnSnNvbi5zZXQoJ2lkJywgbmV3RGxnSWQpXG4gICAgICAuc2V0KCdpbmRleCcsIGRsZ01heEluZGV4KVxuICAgICAgLnNldCgnaXNTcGxhc2gnLCBmYWxzZSlcbiAgICAgIC5zZXQoJ2xhYmVsJywgdGhpcy5nZXREdXBsaWNhdGVMYWJlbCgnZGlhbG9nJywgbmV3RGxnSnNvbi5sYWJlbCkpXG4gICAgICAuc2V0KCdsYXlvdXQnLCBzaXplTW9kZUxheW91dClcblxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydkaWFsb2dzJywgbmV3RGxnSnNvbi5pZF0sIG5ld0RsZ0pzb24pXG5cbiAgICByZXR1cm4gbmV3RGxnSnNvblxuICB9XG5cbiAgLyoqXG4gICAqIE9ubHkgc3VwcG9ydCByZW9yZGVyaW5nIGRpYWxvZ3MgZm9yIHNhbWUgbW9kZS5cbiAgICovXG4gIG9yZGVyRGlhbG9nVG9EaWFsb2cgKGRpYWxvZ0lkOiBzdHJpbmcsIHRhcmdldERpYWxvZ0lkOiBzdHJpbmcsIHR5cGU6ICd0b3AnIHwgJ2JvdHRvbScpOiB0aGlzIHtcbiAgICBjb25zdCBkaWFsb2dzID0gdGhpcy5hcHBDb25maWcuZGlhbG9ncy5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pXG4gICAgY29uc3QgY3VycmVudERsZyA9IGRpYWxvZ3NbZGlhbG9nSWRdXG4gICAgY29uc3QgdGFyZ2V0RGxnID0gZGlhbG9nc1t0YXJnZXREaWFsb2dJZF1cblxuICAgIGlmICghZGlhbG9ncyB8fCAhY3VycmVudERsZyB8fCAhdGFyZ2V0RGxnKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIGlmICh0YXJnZXREaWFsb2dJZCA9PT0gZGlhbG9nSWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2RpYWxvZ0lkIGlzIHNhbWUgdG8gdGFyZ2V0RGlhbG9nSWQuJylcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgbGV0IG5ld0luZGV4XG4gICAgaWYgKHRhcmdldERsZy5pbmRleCA+IGN1cnJlbnREbGcuaW5kZXgpIHtcbiAgICAgIG5ld0luZGV4ID0gdHlwZSA9PT0gJ3RvcCcgPyB0YXJnZXREbGcuaW5kZXggLSAxIDogdGFyZ2V0RGxnLmluZGV4XG4gICAgICBPYmplY3Qua2V5cyhkaWFsb2dzKS5mb3JFYWNoKGRsZ0lkID0+IHtcbiAgICAgICAgY29uc3QgZGxnID0gZGlhbG9nc1tkbGdJZF1cbiAgICAgICAgaWYgKGRsZy5tb2RlID09PSB0YXJnZXREbGcubW9kZSAmJiBkbGcuaWQgIT09IGRpYWxvZ0lkICYmIGRsZy5pbmRleCA+IGN1cnJlbnREbGcuaW5kZXggJiYgZGxnLmluZGV4IDw9IG5ld0luZGV4KSB7XG4gICAgICAgICAgZGxnLmluZGV4ID0gZGxnLmluZGV4IC0gMVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICBuZXdJbmRleCA9IHR5cGUgPT09ICd0b3AnID8gdGFyZ2V0RGxnLmluZGV4IDogdGFyZ2V0RGxnLmluZGV4ICsgMVxuICAgICAgT2JqZWN0LmtleXMoZGlhbG9ncykuZm9yRWFjaChkbGdJZCA9PiB7XG4gICAgICAgIGNvbnN0IGRsZyA9IGRpYWxvZ3NbZGxnSWRdXG4gICAgICAgIGlmIChkbGcubW9kZSA9PT0gdGFyZ2V0RGxnLm1vZGUgJiYgZGxnLmlkICE9PSBkaWFsb2dJZCAmJiBkbGcuaW5kZXggPj0gbmV3SW5kZXggJiYgZGxnLmluZGV4IDwgY3VycmVudERsZy5pbmRleCkge1xuICAgICAgICAgIGRsZy5pbmRleCA9IGRsZy5pbmRleCArIDFcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gICAgLy8gdXBkYXRlIGN1cnJlbnQgZGlhbG9nXG4gICAgZGlhbG9nc1tkaWFsb2dJZF0gPSBPYmplY3QuYXNzaWduKHt9LCBjdXJyZW50RGxnLCB7XG4gICAgICBpbmRleDogbmV3SW5kZXgsXG4gICAgICBtb2RlOiB0YXJnZXREbGcubW9kZVxuICAgIH0pXG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgnZGlhbG9ncycsIEltbXV0YWJsZShkaWFsb2dzKSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcmVwbGFjZVNwbGFzaERpYWxvZyAoZGlhbG9nSWQ6IHN0cmluZywgc3BsYXNoRGlhbG9nSWQ/OiBzdHJpbmcpOiB0aGlzIHtcbiAgICBpZiAoc3BsYXNoRGlhbG9nSWQpIHtcbiAgICAgIHRoaXMuZWRpdERpYWxvZ1Byb3BlcnR5KHNwbGFzaERpYWxvZ0lkLCAnaXNTcGxhc2gnLCBmYWxzZSlcbiAgICB9XG4gICAgaWYgKGRpYWxvZ0lkICE9PSBzcGxhc2hEaWFsb2dJZCkge1xuICAgICAgcmV0dXJuIHRoaXMuZWRpdERpYWxvZ1Byb3BlcnR5KGRpYWxvZ0lkLCAnaXNTcGxhc2gnLCB0cnVlKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgfVxuXG4gIC8vICNlbmRyZWdpb25cblxuICAvLyAjcmVnaW9uIExheW91dCBBUElzXG5cbiAgY3JlYXRlTGF5b3V0Rm9yU2l6ZU1vZGUgKFxuICAgIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgZnJvbVNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgbGF5b3V0czogSU1TaXplTW9kZUxheW91dEpzb24sXG4gICAgcGFyZW50VHlwZTogTGF5b3V0UGFyZW50VHlwZSxcbiAgICBwYXJlbnRJZDogc3RyaW5nLFxuICAgIGxheW91dE5hbWU/OiBzdHJpbmdcbiAgKTogSU1TaXplTW9kZUxheW91dEpzb24ge1xuICAgIGlmICghbGF5b3V0cyB8fCAhbGF5b3V0c1tmcm9tU2l6ZU1vZGVdIHx8IGxheW91dHNbc2l6ZU1vZGVdKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICBjb25zdCBsYXlvdXRJZCA9IGxheW91dHNbZnJvbVNpemVNb2RlXVxuICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0aGlzLmFwcENvbmZpZywgbGF5b3V0SWQpXG4gICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGVMYXlvdXQodGhpcy5hcHBDb25maWcsIGxheW91dHNbZnJvbVNpemVNb2RlXSwgZnJvbVNpemVNb2RlLCBzaXplTW9kZSwgbnVsbCwgZmFsc2UpXG4gICAgaWYgKHJlc3VsdFsxXSkge1xuICAgICAgdGhpcy5hcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgIGNvbnN0IG5ld0xheW91dElkID0gcmVzdWx0WzFdXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIG5ld0xheW91dElkLCAncGFyZW50J10sIHsgaWQ6IHBhcmVudElkLCB0eXBlOiBwYXJlbnRUeXBlIH0pXG5cbiAgICAgIGNvbnN0IG5ld0xheW91dHMgPSBsYXlvdXRzLnNldChzaXplTW9kZSwgbmV3TGF5b3V0SWQpXG5cbiAgICAgIHN3aXRjaCAocGFyZW50VHlwZSkge1xuICAgICAgICBjYXNlIExheW91dFBhcmVudFR5cGUuRGlhbG9nOlxuICAgICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydkaWFsb2dzJywgcGFyZW50SWQsICdsYXlvdXQnXSwgbmV3TGF5b3V0cylcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIExheW91dFBhcmVudFR5cGUuUGFnZTpcbiAgICAgICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsncGFnZXMnLCBwYXJlbnRJZCwgJ2xheW91dCddLCBuZXdMYXlvdXRzKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTGF5b3V0UGFyZW50VHlwZS5IZWFkZXI6XG4gICAgICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ2hlYWRlcicsICdsYXlvdXQnXSwgbmV3TGF5b3V0cylcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIExheW91dFBhcmVudFR5cGUuRm9vdGVyOlxuICAgICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydmb290ZXInLCAnbGF5b3V0J10sIG5ld0xheW91dHMpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBMYXlvdXRQYXJlbnRUeXBlLlNjcmVlbjpcbiAgICAgICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnc2NyZWVucycsIHBhcmVudElkLCAnbGF5b3V0J10sIG5ld0xheW91dHMpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBMYXlvdXRQYXJlbnRUeXBlLlZpZXc6XG4gICAgICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3ZpZXdzJywgcGFyZW50SWQsICdsYXlvdXQnXSwgbmV3TGF5b3V0cylcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIExheW91dFBhcmVudFR5cGUuV2lkZ2V0OlxuICAgICAgICB7XG4gICAgICAgICAgY29uc3Qgd2lkZ2V0SnNvbiA9IHRoaXMuYXBwQ29uZmlnLndpZGdldHNbcGFyZW50SWRdXG4gICAgICAgICAgaWYgKHdpZGdldEpzb24/LmxheW91dHM/LltsYXlvdXROYW1lXSkge1xuICAgICAgICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCBwYXJlbnRJZCwgJ2xheW91dHMnLCBsYXlvdXROYW1lXSwgbmV3TGF5b3V0cylcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3TGF5b3V0c1xuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgbGF5b3V0IGFuZCBhbGwgdGhlIGVtYmVkZGUgbGF5b3V0IGZvciB0aGUgc2l6ZSBtb2RlXG4gICAqIElmIGEgd2lkZ2V0IGlzIG9ubHkgdXNlZCBpbiBjdXJyZW50IHNpemUgbW9kZSwgaXQgc2hvdWxkIGJlIHJlbW92ZWRcbiAgICogQHBhcmFtIGxheW91dElkXG4gICAqIEBwYXJhbSBzaXplTW9kZVxuICAgKi9cbiAgcmVtb3ZlU2l6ZU1vZGVMYXlvdXQgKGxheW91dElkOiBzdHJpbmcsIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUpOiB0aGlzIHtcbiAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGhpcy5hcHBDb25maWcsIGxheW91dElkKVxuICAgIHRoaXMuYXBwQ29uZmlnID0gc2VydmljZS5yZW1vdmVMYXlvdXQodGhpcy5hcHBDb25maWcsIGxheW91dElkLCBzaXplTW9kZSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgYWRkTmV3U2VjdGlvblRvTGF5b3V0ICh0YXJnZXRMYXlvdXRJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBzZWN0aW9uSnNvbiA9IHRoaXMuY3JlYXRlU2VjdGlvbigpXG5cbiAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGhpcy5hcHBDb25maWcsIHRhcmdldExheW91dElkKVxuICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuY3JlYXRlQmxhbmtJdGVtKHRoaXMuYXBwQ29uZmlnLCB0YXJnZXRMYXlvdXRJZClcbiAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgIGNvbnN0IG5ld0l0ZW1JZCA9IHJlc3VsdFsxXVxuICAgIGNvbnN0IG5ld0xheW91dEluZm8gPSB7IGxheW91dElkOiB0YXJnZXRMYXlvdXRJZCwgbGF5b3V0SXRlbUlkOiBuZXdJdGVtSWQgfVxuXG4gICAgdGhpcy5lZGl0TGF5b3V0SXRlbVByb3BlcnR5KG5ld0xheW91dEluZm8sICd0eXBlJywgTGF5b3V0SXRlbVR5cGUuU2VjdGlvbilcbiAgICAgIC5lZGl0TGF5b3V0SXRlbVByb3BlcnR5KG5ld0xheW91dEluZm8sICdzZWN0aW9uSWQnLCBzZWN0aW9uSnNvbi5pZClcblxuICAgIHRoaXMuYXBwQ29uZmlnID0gc2VjdGlvblNlcnZpY2UuYWRkUGFyZW50KHRoaXMuYXBwQ29uZmlnLCBzZWN0aW9uSnNvbi5pZCwgbmV3TGF5b3V0SW5mbywgdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKCkpXG4gICAgcmV0dXJuIG5ld0l0ZW1JZFxuICB9XG5cbiAgYWRkUGxhY2Vob2xkZXJUb0xheW91dCAodGFyZ2V0TGF5b3V0SWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHRoaXMuYXBwQ29uZmlnLCB0YXJnZXRMYXlvdXRJZClcbiAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmNyZWF0ZUJsYW5rSXRlbSh0aGlzLmFwcENvbmZpZywgdGFyZ2V0TGF5b3V0SWQpXG4gICAgdGhpcy5hcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICBjb25zdCBuZXdJdGVtSWQgPSByZXN1bHRbMV1cbiAgICBjb25zdCBuZXdMYXlvdXRJbmZvID0geyBsYXlvdXRJZDogdGFyZ2V0TGF5b3V0SWQsIGxheW91dEl0ZW1JZDogbmV3SXRlbUlkIH1cblxuICAgIHRoaXMuZWRpdExheW91dEl0ZW1Qcm9wZXJ0eShuZXdMYXlvdXRJbmZvLCAndHlwZScsIExheW91dEl0ZW1UeXBlLldpZGdldClcblxuICAgIHJldHVybiBuZXdJdGVtSWRcbiAgfVxuXG4gIGFzeW5jIGFkZE5ld1dpZGdldFRvTGF5b3V0ICh0YXJnZXRMYXlvdXRJZDogc3RyaW5nLCB3aWRnZXRKc29uOiBQYXJ0aWFsPFdpZGdldEpzb24+KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBuZXdXaWRnZXRKc29uID0gYXdhaXQgdGhpcy5jcmVhdGVXaWRnZXQod2lkZ2V0SnNvbiBhcyBhbnksIHRydWUpXG5cbiAgICBpZiAobmV3V2lkZ2V0SnNvbikge1xuICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHRoaXMuYXBwQ29uZmlnLCB0YXJnZXRMYXlvdXRJZClcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuY3JlYXRlQmxhbmtJdGVtKHRoaXMuYXBwQ29uZmlnLCB0YXJnZXRMYXlvdXRJZClcbiAgICAgIHRoaXMuYXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgICBjb25zdCBuZXdJdGVtSWQgPSByZXN1bHRbMV1cbiAgICAgIGNvbnN0IG5ld0xheW91dEluZm8gPSB7IGxheW91dElkOiB0YXJnZXRMYXlvdXRJZCwgbGF5b3V0SXRlbUlkOiBuZXdJdGVtSWQgfVxuXG4gICAgICB0aGlzLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkobmV3TGF5b3V0SW5mbywgJ3R5cGUnLCBMYXlvdXRJdGVtVHlwZS5XaWRnZXQpXG4gICAgICAgIC5lZGl0TGF5b3V0SXRlbVByb3BlcnR5KG5ld0xheW91dEluZm8sICd3aWRnZXRJZCcsIG5ld1dpZGdldEpzb24uaWQpXG5cbiAgICAgIGNvbnN0IHNpemVNb2RlID0gdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKClcbiAgICAgIHRoaXMuYXBwQ29uZmlnID0gd2lkZ2V0U2VydmljZS5hZGRQYXJlbnQodGhpcy5hcHBDb25maWcsIG5ld1dpZGdldEpzb24uaWQsIG5ld0xheW91dEluZm8sIHNpemVNb2RlKVxuICAgICAgdGhpcy5hcHBDb25maWcgPSB3aWRnZXRTZXJ2aWNlLmFmdGVyQWRkZWQodGhpcy5hcHBDb25maWcsIG5ld1dpZGdldEpzb24uaWQsIHRhcmdldExheW91dElkLCBzaXplTW9kZSwgc2l6ZU1vZGUpXG4gICAgICByZXR1cm4gbmV3SXRlbUlkXG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIC8qKlxuICAgKiBDb250ZW50IGhhcyBiZWVuIGNyZWF0ZWQgZnJvbSB0ZW1wbGF0ZSwgYWRkIGl0IHRvIHRoZSBsYXlvdXQgdXNpbmcgdGhpcyBtZXRob2QuXG4gICAqIEBwYXJhbSB0YXJnZXRMYXlvdXRJZFxuICAgKiBAcGFyYW0gdHlwZVxuICAgKiBAcGFyYW0gdGVtcGxhdGVDb250ZW50SWRcbiAgICogQHJldHVybnNcbiAgICovXG4gIGFkZFRlbXBsYXRlQ29udGVudFRvTGF5b3V0ICh0YXJnZXRMYXlvdXRJZDogc3RyaW5nLCB0eXBlOiBMYXlvdXRJdGVtVHlwZSwgdGVtcGxhdGVDb250ZW50SWQ6IHN0cmluZyk6IExheW91dEluZm8ge1xuICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0aGlzLmFwcENvbmZpZywgdGFyZ2V0TGF5b3V0SWQpXG4gICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5hZGRDb250ZW50KHRoaXMuYXBwQ29uZmlnLCB0YXJnZXRMYXlvdXRJZCwgdGVtcGxhdGVDb250ZW50SWQsIHR5cGUsIHV0aWxzLmdldEN1cnJlbnRTaXplTW9kZSgpKVxuICAgIHRoaXMuYXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgcmV0dXJuIHsgbGF5b3V0SWQ6IHRhcmdldExheW91dElkLCBsYXlvdXRJdGVtSWQ6IHJlc3VsdFsxXSB9XG4gIH1cblxuICBhZGRDb250ZW50VG9QbGFjZWhvbGRlciAocGxhY2Vob2xkZXJMYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCB0eXBlOiBMYXlvdXRJdGVtVHlwZSwgY29udGVudElkOiBzdHJpbmcpOiB0aGlzIHtcbiAgICBjb25zdCB7IGxheW91dElkIH0gPSBwbGFjZWhvbGRlckxheW91dEluZm9cblxuICAgIGNvbnN0IHNpemVNb2RlID0gdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKClcbiAgICB0aGlzLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkocGxhY2Vob2xkZXJMYXlvdXRJbmZvLCAndHlwZScsIHR5cGUpXG4gICAgdGhpcy5hcHBDb25maWcgPSBlbXB0eUNvbnRlbnRTZXJ2aWNlLnNldENvbnRlbnRJZCh0aGlzLmFwcENvbmZpZywgcGxhY2Vob2xkZXJMYXlvdXRJbmZvLCBjb250ZW50SWQsIHNpemVNb2RlKVxuXG4gICAgY29uc3QgbGF5b3V0SXRlbSA9IHNlYXJjaFV0aWxzLmZpbmRMYXlvdXRJdGVtKHRoaXMuYXBwQ29uZmlnLCBwbGFjZWhvbGRlckxheW91dEluZm8pXG4gICAgY29uc3Qgc2VydmljZSA9IG5ldyBDb250ZW50U2VydmljZVdyYXBwZXIodGhpcy5hcHBDb25maWcsIGxheW91dEl0ZW0pXG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHNlcnZpY2UuYWZ0ZXJBZGRlZChsYXlvdXRJZCwgc2l6ZU1vZGUsIHNpemVNb2RlKVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGR1cGxpY2F0ZUxheW91dEl0ZW1JblNhbWVMYXlvdXQgKGxheW91dEluZm86IExheW91dEluZm8pOiBzdHJpbmcge1xuICAgIGNvbnN0IHsgbGF5b3V0SWQgfSA9IGxheW91dEluZm9cbiAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGhpcy5hcHBDb25maWcsIGxheW91dElkKVxuICAgIGNvbnN0IGNvbnRleHQgPSB7fVxuXG4gICAgY29uc3QgY3VycmVudFNpemVNb2RlID0gdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKClcbiAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZUl0ZW1JblNhbWVMYXlvdXQodGhpcy5hcHBDb25maWcsIGxheW91dEluZm8sIGN1cnJlbnRTaXplTW9kZSwgY29udGV4dClcbiAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgIGNvbnN0IGxheW91dEl0ZW1JZCA9IHJlc3VsdFsxXVxuICAgIHRoaXMuYXBwQ29uZmlnID0gd2lkZ2V0U2VydmljZS5hZnRlckJhdGNoQ29waWVkKHRoaXMuYXBwQ29uZmlnLCB0aGlzLmFwcENvbmZpZywgY29udGV4dClcblxuICAgIC8vIHJlbW92ZSB0aGUgcGFyZW50IG9mIHRoZSBuZXcgY29udGVudCBpbiBvdGhlciBzaXplIG1vZGVcbiAgICBjb25zdCBsYXlvdXRJdGVtID0gc2VhcmNoVXRpbHMuZmluZExheW91dEl0ZW0odGhpcy5hcHBDb25maWcsIHsgbGF5b3V0SWQsIGxheW91dEl0ZW1JZCB9KVxuICAgIGNvbnN0IGNvbnRlbnRTZXJ2aWNlID0gbmV3IENvbnRlbnRTZXJ2aWNlV3JhcHBlcih0aGlzLmFwcENvbmZpZywgbGF5b3V0SXRlbSlcbiAgICBjb25zdCBhbGxTaXplTW9kZXMgPSBbQnJvd3NlclNpemVNb2RlLkxhcmdlLCBCcm93c2VyU2l6ZU1vZGUuTWVkaXVtLCBCcm93c2VyU2l6ZU1vZGUuU21hbGxdXG4gICAgYWxsU2l6ZU1vZGVzLmZvckVhY2goKHNpemVNb2RlKSA9PiB7XG4gICAgICBpZiAoc2l6ZU1vZGUgIT09IGN1cnJlbnRTaXplTW9kZSkge1xuICAgICAgICBjb250ZW50U2VydmljZS5yZW1vdmVTaXplTW9kZVBhcmVudChzaXplTW9kZSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIHJlc3VsdFsxXVxuICB9XG5cbiAgZHVwbGljYXRlTGF5b3V0SXRlbVRvT3RoZXJMYXlvdXQgKGxheW91dEluZm86IExheW91dEluZm8sIHRhcmdldExheW91dElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxheW91dEl0ZW0gPSBzZWFyY2hVdGlscy5maW5kTGF5b3V0SXRlbSh0aGlzLmFwcENvbmZpZywgbGF5b3V0SW5mbylcbiAgICBjb25zdCBjb250ZW50U2VydmljZSA9IG5ldyBDb250ZW50U2VydmljZVdyYXBwZXIodGhpcy5hcHBDb25maWcsIGxheW91dEl0ZW0pXG4gICAgY29uc3QgY29udGV4dCA9IHt9XG4gICAgY29uc3QgY3VycmVudFNpemVNb2RlID0gdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKClcblxuICAgIGNvbnN0IGR1cFJlc3VsdCA9IGNvbnRlbnRTZXJ2aWNlLmR1cGxpY2F0ZShjdXJyZW50U2l6ZU1vZGUsIGNvbnRleHQpXG4gICAgdGhpcy5hcHBDb25maWcgPSBkdXBSZXN1bHRbMF1cbiAgICBjb25zdCBuZXdDb250ZW50SWQgPSBkdXBSZXN1bHRbMV1cbiAgICB0aGlzLmFwcENvbmZpZyA9IHdpZGdldFNlcnZpY2UuYWZ0ZXJCYXRjaENvcGllZCh0aGlzLmFwcENvbmZpZywgdGhpcy5hcHBDb25maWcsIGNvbnRleHQpXG4gICAgLy8gdGhlIGxheW91dEluZm8gbWF5IG5vdCBmcm9tIHRoZSBzYW1lIHNpemUgbW9kZVxuICAgIHRoaXMuYXBwQ29uZmlnID0gd2lkZ2V0U2VydmljZS5yZW1vdmVQYXJlbnQodGhpcy5hcHBDb25maWcsIG5ld0NvbnRlbnRJZCwgbGF5b3V0SW5mbylcblxuICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0aGlzLmFwcENvbmZpZywgdGFyZ2V0TGF5b3V0SWQpXG4gICAgY29uc3QgY1Jlc3VsdCA9IHNlcnZpY2UuY3JlYXRlQmxhbmtJdGVtKHRoaXMuYXBwQ29uZmlnLCB0YXJnZXRMYXlvdXRJZClcbiAgICB0aGlzLmFwcENvbmZpZyA9IGNSZXN1bHRbMF1cbiAgICBjb25zdCBuZXdJdGVtSWQgPSBjUmVzdWx0WzFdXG4gICAgY29uc3QgbmV3TGF5b3V0SW5mbyA9IHsgbGF5b3V0SWQ6IHRhcmdldExheW91dElkLCBsYXlvdXRJdGVtSWQ6IG5ld0l0ZW1JZCB9XG5cbiAgICB0aGlzLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkobmV3TGF5b3V0SW5mbywgJ3R5cGUnLCBsYXlvdXRJdGVtLnR5cGUpXG5cbiAgICBzd2l0Y2ggKGxheW91dEl0ZW0udHlwZSkge1xuICAgICAgY2FzZSBMYXlvdXRJdGVtVHlwZS5XaWRnZXQ6XG4gICAgICAgIHRoaXMuZWRpdExheW91dEl0ZW1Qcm9wZXJ0eShuZXdMYXlvdXRJbmZvLCAnd2lkZ2V0SWQnLCBuZXdDb250ZW50SWQpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIExheW91dEl0ZW1UeXBlLlNlY3Rpb246XG4gICAgICAgIHRoaXMuZWRpdExheW91dEl0ZW1Qcm9wZXJ0eShuZXdMYXlvdXRJbmZvLCAnc2VjdGlvbklkJywgbmV3Q29udGVudElkKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBMYXlvdXRJdGVtVHlwZS5TY3JlZW5Hcm91cDpcbiAgICAgICAgdGhpcy5lZGl0TGF5b3V0SXRlbVByb3BlcnR5KG5ld0xheW91dEluZm8sICdzY3JlZW5Hcm91cElkJywgbmV3Q29udGVudElkKVxuICAgICAgICBicmVha1xuICAgIH1cblxuICAgIGNvbnN0IG5ld0xheW91dEl0ZW0gPSBzZWFyY2hVdGlscy5maW5kTGF5b3V0SXRlbSh0aGlzLmFwcENvbmZpZywgbmV3TGF5b3V0SW5mbylcbiAgICBjb25zdCBuZXdDb250ZW50U2VydmljZSA9IG5ldyBDb250ZW50U2VydmljZVdyYXBwZXIodGhpcy5hcHBDb25maWcsIG5ld0xheW91dEl0ZW0pXG4gICAgbmV3Q29udGVudFNlcnZpY2UuYWRkUGFyZW50KG5ld0xheW91dEluZm8sIGN1cnJlbnRTaXplTW9kZSlcblxuICAgIC8vIHJlbW92ZSB0aGUgcGFyZW50IG9mIHRoZSBuZXcgY29udGVudCBpbiBvdGhlciBzaXplIG1vZGVcbiAgICBjb25zdCBhbGxTaXplTW9kZXMgPSBbQnJvd3NlclNpemVNb2RlLkxhcmdlLCBCcm93c2VyU2l6ZU1vZGUuTWVkaXVtLCBCcm93c2VyU2l6ZU1vZGUuU21hbGxdXG4gICAgYWxsU2l6ZU1vZGVzLmZvckVhY2goKHNpemVNb2RlKSA9PiB7XG4gICAgICBpZiAoc2l6ZU1vZGUgIT09IGN1cnJlbnRTaXplTW9kZSkge1xuICAgICAgICBuZXdDb250ZW50U2VydmljZS5yZW1vdmVTaXplTW9kZVBhcmVudChzaXplTW9kZSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5hcHBDb25maWcgPSBuZXdDb250ZW50U2VydmljZS5nZXRDb25maWcoKVxuXG4gICAgcmV0dXJuIG5ld0l0ZW1JZFxuICB9XG5cbiAgLyoqXG4gICAqIG1vdmUgYSBsYXlvdXQgaXRlbSB0byBhbm90aGVyIGxheW91dFxuICAgKiBAcGFyYW0gZnJvbUxheW91dEluZm9cbiAgICogQHBhcmFtIHRvTGF5b3V0SW5mb1xuICAgKi9cbiAgbW92ZUxheW91dEl0ZW0gKFxuICAgIGZyb21MYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIHRvTGF5b3V0SWQ6IHN0cmluZyxcbiAgICBmcm9tU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICB0b1NpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGVcbiAgKTogTGF5b3V0SW5mbyB7XG4gICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHRoaXMuYXBwQ29uZmlnLCB0b0xheW91dElkKVxuICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UubW92ZUxheW91dEl0ZW0odGhpcy5hcHBDb25maWcsIGZyb21MYXlvdXRJbmZvLCB0b0xheW91dElkLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUpXG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgIHJldHVybiByZXN1bHRbMV1cbiAgfVxuXG4gIHNldExheW91dEl0ZW1Ub1BlbmRpbmcgKGxheW91dEluZm86IExheW91dEluZm8sIHZhbHVlOiBib29sZWFuKTogdGhpcyB7XG4gICAgY29uc3QgbGF5b3V0SXRlbSA9IHNlYXJjaFV0aWxzLmZpbmRMYXlvdXRJdGVtKHRoaXMuYXBwQ29uZmlnLCBsYXlvdXRJbmZvKVxuICAgIGlmICghbGF5b3V0SXRlbSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGhpcy5hcHBDb25maWcsIGxheW91dEluZm8ubGF5b3V0SWQpXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHNlcnZpY2UucGVuZEl0ZW0odGhpcy5hcHBDb25maWcsIGxheW91dEluZm8pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SW5mby5sYXlvdXRJZCwgJ2NvbnRlbnQnLCBsYXlvdXRJbmZvLmxheW91dEl0ZW1JZCwgJ2lzUGVuZGluZyddLCB2YWx1ZSlcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0gbGF5b3V0SW5mb1xuICAgKiBAcGFyYW0gcmVtb3ZlQ29udGVudCBmYWxzZSwgcmVtb3ZlIGxheW91dCBpdGVtIG9ubHkuIHRydWUsIHJlbW92ZSB0aGUgd2lkZ2V0L3NlY3Rpb24gaW4gdGhlIGxheW91dCBpdGVtXG4gICAqL1xuICByZW1vdmVMYXlvdXRJdGVtIChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCByZW1vdmVDb250ZW50OiBib29sZWFuLCBmb3JjZT86IGJvb2xlYW4pOiB0aGlzIHtcbiAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGhpcy5hcHBDb25maWcsIGxheW91dEluZm8ubGF5b3V0SWQpXG4gICAgdGhpcy5hcHBDb25maWcgPSBzZXJ2aWNlLnJlbW92ZUl0ZW0odGhpcy5hcHBDb25maWcsIGxheW91dEluZm8sIHV0aWxzLmdldEN1cnJlbnRTaXplTW9kZSgpLCByZW1vdmVDb250ZW50LCBmb3JjZSlcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICByZW1vdmVMYXlvdXQgKGxheW91dElkOiBzdHJpbmcpOiB0aGlzIHtcbiAgICByZXR1cm4gdGhpcy5yZW1vdmVTaXplTW9kZUxheW91dChsYXlvdXRJZCwgdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKCkpXG4gIH1cblxuICBjbGVhckxheW91dENvbnRlbnQgKGxheW91dElkOiBzdHJpbmcpOiB0aGlzIHtcbiAgICBjb25zdCBsYXlvdXRKc29uID0gdGhpcy5hcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgICBpZiAoIWxheW91dEpzb24pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgT2JqZWN0LmtleXMobGF5b3V0SnNvbi5jb250ZW50ID8/IHt9KS5mb3JFYWNoKGl0ZW1JZCA9PiB7XG4gICAgICB0aGlzLnJlbW92ZUxheW91dEl0ZW0oeyBsYXlvdXRJZCwgbGF5b3V0SXRlbUlkOiBpdGVtSWQgfSwgdHJ1ZSwgZmFsc2UpXG4gICAgfSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyoqXG4gICAqIER1cGxpY2F0ZSBsYXlvdXQgYW5kIHJldHVybiBuZXcgbGF5b3V0IGpzb24uXG4gICAqIEBwYXJhbSBsYXlvdXRJZFxuICAgKiBAcGFyYW0gZHVwbGljYXRlQ29udGVudFxuICAgKi9cbiAgZHVwbGljYXRlTGF5b3V0IChsYXlvdXRJZDogc3RyaW5nLCBkdXBsaWNhdGVDb250ZW50OiBib29sZWFuKTogSU1MYXlvdXRKc29uIHtcbiAgICBjb25zdCBsYXlvdXRKc29uID0gdGhpcy5hcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgICBpZiAoIWxheW91dEpzb24pIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0aGlzLmFwcENvbmZpZywgbGF5b3V0SWQpXG4gICAgY29uc3Qgc2l6ZU1vZGUgPSB1dGlscy5nZXRDdXJyZW50U2l6ZU1vZGUoKVxuICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuZHVwbGljYXRlTGF5b3V0KHRoaXMuYXBwQ29uZmlnLCBsYXlvdXRJZCwgc2l6ZU1vZGUsIHNpemVNb2RlLCBudWxsLCBkdXBsaWNhdGVDb250ZW50KVxuICAgIHRoaXMuYXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgY29uc3QgbmV3TGF5b3V0SWQgPSByZXN1bHRbMV1cblxuICAgIHJldHVybiB0aGlzLmFwcENvbmZpZy5sYXlvdXRzW25ld0xheW91dElkXVxuICB9XG5cbiAgZWRpdExheW91dFByb3BlcnR5IChsYXlvdXRJZDogc3RyaW5nLCBwcm9wOiBzdHJpbmcsIHZhbDogYW55KTogdGhpcyB7XG4gICAgbGV0IGxheW91dEpzb24gPSB0aGlzLmFwcENvbmZpZy5sYXlvdXRzW2xheW91dElkXVxuICAgIGlmICghbGF5b3V0SnNvbikge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgbGF5b3V0SnNvbiA9IHRoaXMuZWRpdEpzb25Qcm9wZXJ0eShsYXlvdXRKc29uLCBwcm9wLCB2YWwpIGFzIGFueVxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SWRdLCBsYXlvdXRKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBlZGl0TGF5b3V0SXRlbVByb3BlcnR5IChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCBwcm9wOiBzdHJpbmcsIHZhbDogYW55KTogdGhpcyB7XG4gICAgY29uc3QgeyBsYXlvdXRJZCwgbGF5b3V0SXRlbUlkIH0gPSBsYXlvdXRJbmZvXG4gICAgbGV0IGxheW91dEl0ZW0gPSBzZWFyY2hVdGlscy5maW5kTGF5b3V0SXRlbSh0aGlzLmFwcENvbmZpZywgbGF5b3V0SW5mbylcbiAgICBpZiAoIWxheW91dEl0ZW0pIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgbGF5b3V0SXRlbSA9IHRoaXMuZWRpdEpzb25Qcm9wZXJ0eShsYXlvdXRJdGVtLCBwcm9wLCB2YWwpIGFzIGFueVxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SWQsICdjb250ZW50JywgbGF5b3V0SXRlbUlkXSwgbGF5b3V0SXRlbSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgZWRpdExhYmVsT2ZUb2NOb2RlIChcbiAgICBub2RlOiBUb2NOb2RlLFxuICAgIGxhYmVsOiBzdHJpbmdcbiAgKTogdGhpcyB7XG4gICAgc3dpdGNoIChub2RlLnR5cGUpIHtcbiAgICAgIGNhc2UgJ3ZpZXcnOlxuICAgICAgICByZXR1cm4gdGhpcy5lZGl0Vmlld1Byb3BlcnR5KG5vZGUuaWQsICdsYWJlbCcsIGxhYmVsKVxuICAgICAgY2FzZSAnc2NyZWVuJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdFNjcmVlblByb3BlcnR5KG5vZGUuaWQsICdsYWJlbCcsIGxhYmVsKVxuICAgICAgY2FzZSAnd2lkZ2V0JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdFdpZGdldFByb3BlcnR5KG5vZGUuaWQsICdsYWJlbCcsIGxhYmVsKVxuICAgICAgY2FzZSAnc2VjdGlvbic6XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRTZWN0aW9uUHJvcGVydHkobm9kZS5pZCwgJ2xhYmVsJywgbGFiZWwpXG4gICAgICBjYXNlICdzY3JlZW5Hcm91cCc6XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRTY3JlZW5Hcm91cFByb3BlcnR5KG5vZGUuaWQsICdsYWJlbCcsIGxhYmVsKVxuICAgICAgY2FzZSAnbGF5b3V0SXRlbSc6XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkoeyBsYXlvdXRJZDogbm9kZS5sYXlvdXRJZCwgbGF5b3V0SXRlbUlkOiBub2RlLmxheW91dEl0ZW1JZCB9LCAnbGFiZWwnLCBsYWJlbClcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICB9XG5cbiAgZWRpdExheW91dEl0ZW1TaXplIChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgIGlmICh3aWR0aCA9PT0gMCB8fCBoZWlnaHQgPT09IDApIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgY29uc3QgeyBsYXlvdXRJZCwgbGF5b3V0SXRlbUlkIH0gPSBsYXlvdXRJbmZvXG4gICAgY29uc3QgbGF5b3V0ID0gdGhpcy5hcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgICBjb25zdCBsYXlvdXRJdGVtID0gbGF5b3V0Py5jb250ZW50Py5bbGF5b3V0SXRlbUlkXVxuICAgIGlmICghbGF5b3V0IHx8ICFsYXlvdXRJdGVtKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICBsZXQgc2V0dGluZyA9IGxheW91dEl0ZW0uc2V0dGluZyB8fCBJbW11dGFibGUoe30pXG5cbiAgICBpZiAobGF5b3V0LnR5cGUgPT09IExheW91dFR5cGUuRml4ZWRMYXlvdXQpIHtcbiAgICAgIGNvbnN0IGJib3ggPSBsYXlvdXRJdGVtLmJib3guc2V0KCd3aWR0aCcsIGAke3dpZHRofXB4YCkuc2V0KCdoZWlnaHQnLCBgJHtoZWlnaHR9cHhgKVxuICAgICAgc2V0dGluZyA9IHNldHRpbmcuc2V0SW4oWydhdXRvUHJvcHMnLCAnd2lkdGgnXSwgZmFsc2UpLnNldEluKFsnYXV0b1Byb3BzJywgJ2hlaWdodCddLCBmYWxzZSlcbiAgICAgIHJldHVybiB0aGlzXG4gICAgICAgIC5lZGl0TGF5b3V0SXRlbVByb3BlcnR5KGxheW91dEluZm8sICdiYm94JywgYmJveClcbiAgICAgICAgLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkobGF5b3V0SW5mbywgJ3NldHRpbmcnLCBzZXR0aW5nKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBrZWVwIGFzcGVjdCByYXRpb1xuICAgICAgc2V0dGluZyA9IHNldHRpbmdcbiAgICAgICAgLnNldEluKFsnYXV0b1Byb3BzJywgJ3dpZHRoJ10sIGZhbHNlKVxuICAgICAgICAuc2V0SW4oWydhdXRvUHJvcHMnLCAnaGVpZ2h0J10sIGZhbHNlKVxuICAgICAgICAuc2V0KCdoZWlnaHRNb2RlJywgJ3JhdGlvJylcbiAgICAgICAgLnNldCgnYXNwZWN0UmF0aW8nLCBOdW1iZXIoKGhlaWdodCAvIHdpZHRoKS50b0ZpeGVkKDIpKSlcbiAgICAgIHJldHVybiB0aGlzLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkobGF5b3V0SW5mbywgJ3NldHRpbmcnLCBzZXR0aW5nKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIG9wZXJhdGlvbiBvbmx5IHdvcmtzIGluIGZpeGVkIGxheW91dC5cbiAgICovXG4gIGV4Y2hhbmdlV2lkdGhBbmRIZWlnaHQgKCk6IHRoaXMge1xuICAgIC8vIGdldCB0aGUgc2VsZWN0ZWQgbGF5b3V0IGl0ZW1cbiAgICBsZXQgbGF5b3V0SW5mb1xuICAgIGNvbnN0IHN0YXRlID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpXG4gICAgaWYgKHdpbmRvdy5qaW11Q29uZmlnLmlzQnVpbGRlcikge1xuICAgICAgbGF5b3V0SW5mbyA9IHN0YXRlPy5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwUnVudGltZUluZm8/LnNlbGVjdGlvblxuICAgIH0gZWxzZSB7XG4gICAgICBsYXlvdXRJbmZvID0gc3RhdGU/LmFwcFJ1bnRpbWVJbmZvPy5zZWxlY3Rpb25cbiAgICB9XG4gICAgaWYgKCFsYXlvdXRJbmZvKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICBjb25zdCB7IGxheW91dElkIH0gPSBsYXlvdXRJbmZvXG4gICAgY29uc3QgbGF5b3V0ID0gdGhpcy5hcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgICBpZiAobGF5b3V0Py50eXBlID09PSBMYXlvdXRUeXBlLkZpeGVkTGF5b3V0KSB7XG4gICAgICBjb25zdCBsYXlvdXRJdGVtID0gc2VhcmNoVXRpbHMuZmluZExheW91dEl0ZW0odGhpcy5hcHBDb25maWcsIGxheW91dEluZm8pXG4gICAgICBpZiAobGF5b3V0SXRlbSkge1xuICAgICAgICAvLyBleGNoYW5nZSB3aWR0aCBhbmQgaGVpZ2h0XG4gICAgICAgIGxldCBiYm94ID0gbGF5b3V0SXRlbS5iYm94XG4gICAgICAgIGxldCBzZXR0aW5nQ2hhbmdlZCA9IGZhbHNlXG4gICAgICAgIGxldCBzZXR0aW5nID0gbGF5b3V0SXRlbS5zZXR0aW5nID8/IEltbXV0YWJsZSh7fSlcbiAgICAgICAgY29uc3QgYXV0b1Byb3BzID0gc2V0dGluZy5hdXRvUHJvcHMgPz8geyByaWdodDogdHJ1ZSwgYm90dG9tOiB0cnVlIH1cblxuICAgICAgICBiYm94ID0gYmJveC5zZXQoJ3dpZHRoJywgYmJveC5oZWlnaHQpLnNldCgnaGVpZ2h0JywgYmJveC53aWR0aCk7XG5cbiAgICAgICAgWydsZWZ0JywgJ3JpZ2h0JywgJ3RvcCcsICdib3R0b20nXS5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgIGlmIChhdXRvUHJvcHNbcHJvcF0pIHtcbiAgICAgICAgICAgIGJib3ggPSBiYm94LndpdGhvdXQocHJvcCBhcyBhbnkpXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICB0aGlzLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkobGF5b3V0SW5mbywgJ2Jib3gnLCBiYm94KVxuXG4gICAgICAgIC8vIGV4Y2hhbmdlIGF1dG9Qcm9wcyBvZiB3aWR0aCBhbmQgaGVpZ2h0XG4gICAgICAgIGlmIChhdXRvUHJvcHMud2lkdGggIT0gbnVsbCB8fCBhdXRvUHJvcHMuaGVpZ2h0ICE9IG51bGwpIHtcbiAgICAgICAgICBzZXR0aW5nID0gc2V0dGluZy5zZXRJbihbJ2F1dG9Qcm9wcycsICd3aWR0aCddLCBhdXRvUHJvcHMuaGVpZ2h0KVxuICAgICAgICAgICAgLnNldEluKFsnYXV0b1Byb3BzJywgJ2hlaWdodCddLCBhdXRvUHJvcHMud2lkdGgpXG4gICAgICAgICAgc2V0dGluZ0NoYW5nZWQgPSB0cnVlXG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXQga2VlcCBhc3BlY3QgcmF0aW8gdG8gZmFsc2VcbiAgICAgICAgaWYgKHNldHRpbmcuaGVpZ2h0TW9kZSA9PT0gJ3JhdGlvJykge1xuICAgICAgICAgIHNldHRpbmcgPSBzZXR0aW5nLnNldCgnaGVpZ2h0TW9kZScsICdmaXhlZCcpXG4gICAgICAgICAgc2V0dGluZ0NoYW5nZWQgPSB0cnVlXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2V0dGluZ0NoYW5nZWQpIHtcbiAgICAgICAgICB0aGlzLmVkaXRMYXlvdXRJdGVtUHJvcGVydHkobGF5b3V0SW5mbywgJ3NldHRpbmcnLCBzZXR0aW5nKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBhZGp1c3RPcmRlck9mSXRlbSAobGF5b3V0SW5mbzogTGF5b3V0SW5mbywgaW5zZXJ0SW5kZXg6IG51bWJlcik6IHRoaXMge1xuICAgIGNvbnN0IHsgbGF5b3V0SWQsIGxheW91dEl0ZW1JZCB9ID0gbGF5b3V0SW5mb1xuICAgIGNvbnN0IGxheW91dCA9IHRoaXMuYXBwQ29uZmlnLmxheW91dHNbbGF5b3V0SWRdXG4gICAgbGV0IG9yZGVyID0gW10uY29uY2F0KGxheW91dC5vcmRlciB8fCBbXSlcblxuICAgIGlmIChvcmRlci5pbmNsdWRlcyhsYXlvdXRJdGVtSWQpKSB7XG4gICAgICBvcmRlciA9IG9yZGVyLmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IGxheW91dEl0ZW1JZClcbiAgICB9XG5cbiAgICBpZiAoaW5zZXJ0SW5kZXggIT0gbnVsbCAmJiBpbnNlcnRJbmRleCA+PSAwICYmIGluc2VydEluZGV4IDw9IG9yZGVyLmxlbmd0aCkge1xuICAgICAgb3JkZXIuc3BsaWNlKGluc2VydEluZGV4LCAwLCBsYXlvdXRJdGVtSWQpXG4gICAgfSBlbHNlIHtcbiAgICAgIG9yZGVyLnB1c2gobGF5b3V0SXRlbUlkKVxuICAgIH1cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIGxheW91dElkLCAnb3JkZXInXSwgb3JkZXIpXG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgY3JlYXRlTGF5b3V0ICh0eXBlOiBMYXlvdXRUeXBlKTogc3RyaW5nIHtcbiAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldEluc3RhbmNlKCkuZ2V0U2VydmljZUJ5VHlwZSh0eXBlKVxuICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuY3JlYXRlQmxhbmtMYXlvdXQodGhpcy5hcHBDb25maWcsIHR5cGUpXG4gICAgdGhpcy5hcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICByZXR1cm4gcmVzdWx0WzFdXG4gIH1cblxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBUZW1wbGF0ZSBBUElzXG4gIGFzeW5jIGNyZWF0ZVBhZ2VGcm9tVGVtcGxhdGUgKHRlbXBsYXRlSnNvbjogVGVtcGxhdGUpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSB7fVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRlbXBsYXRlU2VydmljZS5jcmVhdGVQYWdlRnJvbVRlbXBsYXRlKHRoaXMuYXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24sIGNvbnRleHQpXG4gICAgdGhpcy5hcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICBjb25zdCBwYWdlSWQgPSByZXN1bHRbMV1cblxuICAgIHRoaXMuYXBwQ29uZmlnID0gd2lkZ2V0U2VydmljZS5hZnRlckJhdGNoQ29waWVkKHRoaXMuYXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24uY29uZmlnIGFzIGFueSwgY29udGV4dClcblxuICAgIHJldHVybiBwYWdlSWRcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZURpYWxvZ0Zyb21UZW1wbGF0ZSAodGVtcGxhdGVKc29uOiBUZW1wbGF0ZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgY29udGV4dCA9IHt9XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGVtcGxhdGVTZXJ2aWNlLmNyZWF0ZURpYWxvZ0Zyb21UZW1wbGF0ZSh0aGlzLmFwcENvbmZpZywgdGVtcGxhdGVKc29uLCBjb250ZXh0KVxuICAgIHRoaXMuYXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgY29uc3QgZGlhbG9nSWQgPSByZXN1bHRbMV1cblxuICAgIHRoaXMuYXBwQ29uZmlnID0gd2lkZ2V0U2VydmljZS5hZnRlckJhdGNoQ29waWVkKHRoaXMuYXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24uY29uZmlnIGFzIGFueSwgY29udGV4dClcblxuICAgIHJldHVybiBkaWFsb2dJZFxuICB9XG5cbiAgYXN5bmMgYXBwbHlIZWFkZXJUZW1wbGF0ZSAodGVtcGxhdGVKc29uOiBUZW1wbGF0ZSkge1xuICAgIGNvbnN0IGNvbnRleHQgPSB7fVxuICAgIHRoaXMuYXBwQ29uZmlnID0gYXdhaXQgdGVtcGxhdGVTZXJ2aWNlLmFwcGx5VGVtcGxhdGVUb0hlYWRlcih0aGlzLmFwcENvbmZpZywgdGVtcGxhdGVKc29uLCB1dGlscy5nZXRDdXJyZW50U2l6ZU1vZGUoKSwgY29udGV4dClcbiAgICB0aGlzLmFwcENvbmZpZyA9IHdpZGdldFNlcnZpY2UuYWZ0ZXJCYXRjaENvcGllZCh0aGlzLmFwcENvbmZpZywgdGVtcGxhdGVKc29uLmNvbmZpZyBhcyBhbnksIGNvbnRleHQpXG4gIH1cblxuICBhc3luYyBhcHBseUZvb3RlclRlbXBsYXRlICh0ZW1wbGF0ZUpzb246IFRlbXBsYXRlKSB7XG4gICAgY29uc3QgY29udGV4dCA9IHt9XG4gICAgdGhpcy5hcHBDb25maWcgPSBhd2FpdCB0ZW1wbGF0ZVNlcnZpY2UuYXBwbHlUZW1wbGF0ZVRvRm9vdGVyKHRoaXMuYXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24sIHV0aWxzLmdldEN1cnJlbnRTaXplTW9kZSgpLCBjb250ZXh0KVxuICAgIHRoaXMuYXBwQ29uZmlnID0gd2lkZ2V0U2VydmljZS5hZnRlckJhdGNoQ29waWVkKHRoaXMuYXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24uY29uZmlnIGFzIGFueSwgY29udGV4dClcbiAgfVxuXG4gIGFzeW5jIGFwcGx5UGFnZUJvZHlUZW1wbGF0ZSAocGFnZUlkOiBzdHJpbmcsIHRlbXBsYXRlSnNvbjogVGVtcGxhdGUpIHtcbiAgICBjb25zdCBjb250ZXh0ID0ge31cbiAgICB0aGlzLmFwcENvbmZpZyA9IGF3YWl0IHRlbXBsYXRlU2VydmljZS5hcHBseVRlbXBsYXRlVG9Cb2R5KHRoaXMuYXBwQ29uZmlnLCBwYWdlSWQsIHRlbXBsYXRlSnNvbiwgdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKCksIGNvbnRleHQpXG4gICAgdGhpcy5hcHBDb25maWcgPSB3aWRnZXRTZXJ2aWNlLmFmdGVyQmF0Y2hDb3BpZWQodGhpcy5hcHBDb25maWcsIHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55LCBjb250ZXh0KVxuICB9XG5cbiAgYXN5bmMgYXBwbHlEaWFsb2dUZW1wbGF0ZSAoZGlhbG9nSWQ6IHN0cmluZywgdGVtcGxhdGVKc29uOiBUZW1wbGF0ZSkge1xuICAgIGNvbnN0IGNvbnRleHQgPSB7fVxuICAgIHRoaXMuYXBwQ29uZmlnID0gYXdhaXQgdGVtcGxhdGVTZXJ2aWNlLmFwcGx5VGVtcGxhdGVUb0RpYWxvZyh0aGlzLmFwcENvbmZpZywgZGlhbG9nSWQsIHRlbXBsYXRlSnNvbiwgdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKCksIGNvbnRleHQpXG4gICAgdGhpcy5hcHBDb25maWcgPSB3aWRnZXRTZXJ2aWNlLmFmdGVyQmF0Y2hDb3BpZWQodGhpcy5hcHBDb25maWcsIHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55LCBjb250ZXh0KVxuICB9XG5cbiAgYXN5bmMgYXBwbHlHcmlkVGVtcGxhdGUgKHdpZGdldElkOiBzdHJpbmcsIHRlbXBsYXRlSnNvbjogVGVtcGxhdGUpIHtcbiAgICBjb25zdCBjb250ZXh0ID0ge31cbiAgICB0aGlzLmFwcENvbmZpZyA9IGF3YWl0IHRlbXBsYXRlU2VydmljZS5hcHBseUdyaWRUZW1wbGF0ZSh0aGlzLmFwcENvbmZpZywgd2lkZ2V0SWQsIHRlbXBsYXRlSnNvbiwgdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKCksIGNvbnRleHQpXG4gICAgdGhpcy5hcHBDb25maWcgPSB3aWRnZXRTZXJ2aWNlLmFmdGVyQmF0Y2hDb3BpZWQodGhpcy5hcHBDb25maWcsIHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55LCBjb250ZXh0KVxuICB9XG5cbiAgYXN5bmMgY3JlYXRlU2NyZWVuRnJvbVRlbXBsYXRlIChzY3JlZW5JZDogc3RyaW5nLCB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBjb250ZXh0ID0ge31cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzY3JlZW5Hcm91cFNlcnZpY2UuY3JlYXRlU2NyZWVuRnJvbVRlbXBsYXRlKHRoaXMuYXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24sIHNjcmVlbklkLCBbdXRpbHMuZ2V0Q3VycmVudFNpemVNb2RlKCldLCBjb250ZXh0KVxuICAgIHRoaXMuYXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgdGhpcy5hcHBDb25maWcgPSB3aWRnZXRTZXJ2aWNlLmFmdGVyQmF0Y2hDb3BpZWQodGhpcy5hcHBDb25maWcsIHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55LCBjb250ZXh0KVxuICAgIC8vIFRPRE9cbiAgICAvLyBpZiBzY3JlZW5zIGluIHRoaXMgc2NyZWVuR3JvdXAgaGFzIG11bHRpcGxlIHNpemUgbW9kZSwgd2Ugc2hvdWxkIHN5bmMgYWxsIHNpemUgbW9kZSBvZiB0aGUgbmV3IHNjcmVlbiB3aXRoIG90aGVyc1xuXG4gICAgcmV0dXJuIHJlc3VsdFsxXVxuICB9XG4gIC8vICNlbmRyZWdpb25cblxuICAvKipcbiAgICogQ29weSB0aGUgcGFyZW50IHVzZSBkYXRhc291cmNlIHRvIGNoaWxkcmVuIHdpZGdldHNcbiAgICogQHBhcmFtIHBhcmVudFdpZGdldElkXG4gICAqL1xuICBjb3B5VXNlRGF0YVNvdXJjZVRvQWxsQ2hpbGRXaWRnZXRzIChvbGRQYXJlbnRXaWRnZXRKc29uOiBJTVdpZGdldEpzb24sIG5ld1BhcmVudFdpZGdldEpzb246IElNV2lkZ2V0SnNvbik6IHRoaXMge1xuICAgIGNvbnN0IGFsbENoaWxkcmVuV2lkZ2V0cyA9IHNlYXJjaFV0aWxzLmdldENoaWxkcmVuQ29udGVudHModGhpcy5hcHBDb25maWcsIG5ld1BhcmVudFdpZGdldEpzb24uaWQsIExheW91dEl0ZW1UeXBlLldpZGdldCwgdHJ1ZSlcblxuICAgIC8vIFRPRE8gcGFyZW50IHdpZGdldCBzdXBwb3J0IG9uZSBkcyBvbmx5IGZvciBub3chXG5cbiAgICBjb25zdCBuZXdVc2VEcyA9IG5ld1BhcmVudFdpZGdldEpzb24udXNlRGF0YVNvdXJjZXMgJiYgbmV3UGFyZW50V2lkZ2V0SnNvbi51c2VEYXRhU291cmNlcy5tYXAodXNlRHMgPT4ge1xuICAgICAgcmV0dXJuIHVzZURzLnNldCgnZmllbGRzJywgW10pXG4gICAgfSlbMF1cbiAgICBjb25zdCBvbGRVc2VEcyA9IG9sZFBhcmVudFdpZGdldEpzb24udXNlRGF0YVNvdXJjZXMgJiYgb2xkUGFyZW50V2lkZ2V0SnNvbi51c2VEYXRhU291cmNlcy5tYXAodXNlRHMgPT4ge1xuICAgICAgcmV0dXJuIHVzZURzLnNldCgnZmllbGRzJywgW10pXG4gICAgfSlbMF1cblxuICAgIGlmIChuZXdVc2VEcyAmJiBvbGRVc2VEcyAmJiBuZXdVc2VEcy5kYXRhU291cmNlSWQgPT09IG9sZFVzZURzLmRhdGFTb3VyY2VJZCkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICBhbGxDaGlsZHJlbldpZGdldHMuZm9yRWFjaCh3aWRnZXRJZCA9PiB7XG4gICAgICBsZXQgd2lkZ2V0SnNvbiA9IHRoaXMuYXBwQ29uZmlnLndpZGdldHNbd2lkZ2V0SWRdXG4gICAgICAvLyByZW1vdmUgb2xkXG4gICAgICBpZiAod2lkZ2V0SnNvbi51c2VEYXRhU291cmNlcyAmJiBvbGRVc2VEcyAmJiB3aWRnZXRKc29uLnVzZURhdGFTb3VyY2VzLmZpbmQodXNlRHMgPT4gdXNlRHMuZGF0YVNvdXJjZUlkID09PSBvbGRVc2VEcy5kYXRhU291cmNlSWQpKSB7XG4gICAgICAgIHdpZGdldEpzb24gPSB3aWRnZXRKc29uLnNldCgndXNlRGF0YVNvdXJjZXMnLCB3aWRnZXRKc29uLnVzZURhdGFTb3VyY2VzLmZpbHRlcih1c2VEcyA9PiB1c2VEcy5kYXRhU291cmNlSWQgIT09IG9sZFVzZURzLmRhdGFTb3VyY2VJZCkpXG4gICAgICB9XG5cbiAgICAgIGlmIChuZXdVc2VEcykge1xuICAgICAgICB3aWRnZXRKc29uID0gd2lkZ2V0SnNvbi5zZXQoJ3VzZURhdGFTb3VyY2VzJywgd2lkZ2V0SnNvbi51c2VEYXRhU291cmNlcyA/IHdpZGdldEpzb24udXNlRGF0YVNvdXJjZXMuY29uY2F0KG5ld1VzZURzKSA6IFtuZXdVc2VEc10pXG4gICAgICAgICAgLnNldCgndXNlRGF0YVNvdXJjZXNFbmFibGVkJywgdHJ1ZSlcbiAgICAgIH1cblxuICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZF0sIHdpZGdldEpzb24pXG4gICAgfSlcblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBEYXRhc291cmNlIEFQSXNcbiAgYWRkRGF0YVNvdXJjZSAoZGF0YVNvdXJjZUpzb246IElNRGF0YVNvdXJjZUpzb24pOiB0aGlzIHtcbiAgICBpZiAodGhpcy5hcHBDb25maWcuZGF0YVNvdXJjZXMgJiYgdGhpcy5hcHBDb25maWcuZGF0YVNvdXJjZXNbZGF0YVNvdXJjZUpzb24uaWRdKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydkYXRhU291cmNlcycsIGRhdGFTb3VyY2VKc29uLmlkXSwgZGF0YVNvdXJjZUpzb24pXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGFkZERhdGFTb3VyY2VzIChkYXRhU291cmNlSnNvbnM6IElNRGF0YVNvdXJjZUpzb25bXSk6IHRoaXMge1xuICAgIGRhdGFTb3VyY2VKc29ucy5mb3JFYWNoKGRhdGFTb3VyY2VKc29uID0+IHtcbiAgICAgIGlmICghdGhpcy5hcHBDb25maWcuZGF0YVNvdXJjZXMgfHwgIXRoaXMuYXBwQ29uZmlnLmRhdGFTb3VyY2VzW2RhdGFTb3VyY2VKc29uLmlkXSkge1xuICAgICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnZGF0YVNvdXJjZXMnLCBkYXRhU291cmNlSnNvbi5pZF0sIGRhdGFTb3VyY2VKc29uKVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGFkZFV0aWxpdHkgKHV0aWxpdHk6IFV0aWxpdHlKc29uKTogdGhpcyB7XG4gICAgbGV0IHV0aWxpdGllcyA9IHRoaXMuYXBwQ29uZmlnLnV0aWxpdGllcyA/PyBJbW11dGFibGUoe30gYXMgYW55KVxuICAgIHV0aWxpdGllcyA9IHV0aWxpdGllcy5zZXQodXRpbGl0eS5pZCwgdXRpbGl0eSlcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgndXRpbGl0aWVzJywgdXRpbGl0aWVzKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICByZW1vdmVVdGlsaXR5ICh1dGlsaXR5SWQ6IHN0cmluZyk6IHRoaXMge1xuICAgIGxldCB1dGlsaXRpZXMgPSB0aGlzLmFwcENvbmZpZy51dGlsaXRpZXMgPz8gSW1tdXRhYmxlKHt9IGFzIGFueSlcbiAgICB1dGlsaXRpZXMgPSB1dGlsaXRpZXMud2l0aG91dCh1dGlsaXR5SWQpXG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ3V0aWxpdGllcycsIHV0aWxpdGllcylcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgdXBkYXRlVXRpbGl0aWVzICh1dGlsaXRpZXM6IElNVXRpbGl0aWVzSnNvbik6IHRoaXMge1xuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0KCd1dGlsaXRpZXMnLCB1dGlsaXRpZXMpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHJlbW92ZVVzZU1hcFdpZGdldElkIChtYXBXaWRnZXRJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIE9iamVjdC5rZXlzKHRoaXMuYXBwQ29uZmlnLndpZGdldHMpLmZvckVhY2goKHdpZGdldElkKSA9PiB7XG4gICAgICBjb25zdCB3aWRnZXRKc29uID0gdGhpcy5hcHBDb25maWcud2lkZ2V0c1t3aWRnZXRJZF1cbiAgICAgIGlmICh3aWRnZXRKc29uLnVzZU1hcFdpZGdldElkcz8uaW5jbHVkZXMobWFwV2lkZ2V0SWQpKSB7XG4gICAgICAgIGNvbnN0IHVzZU1hcFdpZGdldElkcyA9IHdpZGdldEpzb24udXNlTWFwV2lkZ2V0SWRzLmZpbHRlcigoaWQpID0+IGlkICE9PSBtYXBXaWRnZXRJZClcbiAgICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZCwgJ3VzZU1hcFdpZGdldElkcyddLCB1c2VNYXBXaWRnZXRJZHMpXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gdGhpcy5hcHBDb25maWdcbiAgfVxuXG4gIHJlbW92ZURhdGFTb3VyY2UgKGRhdGFTb3VyY2VJZDogc3RyaW5nKTogdGhpcyB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy5kYXRhU291cmNlcyB8fCAhdGhpcy5hcHBDb25maWcuZGF0YVNvdXJjZXNbZGF0YVNvdXJjZUlkXSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ2RhdGFTb3VyY2VzJywgdGhpcy5hcHBDb25maWcuZGF0YVNvdXJjZXMud2l0aG91dChkYXRhU291cmNlSWQpKVxuXG4gICAgLy8gdXBkYXRlIHdpZGdldCB1c2UgZGF0YSBzb3VyY2VcbiAgICB0aGlzLmFwcENvbmZpZy53aWRnZXRzICYmIE9iamVjdC5lbnRyaWVzKHRoaXMuYXBwQ29uZmlnLndpZGdldHMpLmZvckVhY2goKFt3SWQsIHdKc29uXSkgPT4ge1xuICAgICAgaWYgKHdKc29uLnVzZURhdGFTb3VyY2VzICYmIHdKc29uLnVzZURhdGFTb3VyY2VzLmZpbmQodXNlRHMgPT4gdGhpcy5pc1VzZURhdGFTb3VyY2VTaG91bGRCZVJlbW92ZWQodXNlRHMsIGRhdGFTb3VyY2VJZCkpKSB7XG4gICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgd0lkLCAndXNlRGF0YVNvdXJjZXMnXSwgd0pzb24udXNlRGF0YVNvdXJjZXMuZmlsdGVyKHVzZURzID0+ICF0aGlzLmlzVXNlRGF0YVNvdXJjZVNob3VsZEJlUmVtb3ZlZCh1c2VEcywgZGF0YVNvdXJjZUlkKSkpXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIHVwZGF0ZSB3aWRnZXQgb3V0cHV0IGRhdGEgc291cmNlXG4gICAgdGhpcy5hcHBDb25maWcud2lkZ2V0cyAmJiBPYmplY3QuZW50cmllcyh0aGlzLmFwcENvbmZpZy53aWRnZXRzKS5mb3JFYWNoKChbd0lkLCB3SnNvbl0pID0+IHtcbiAgICAgIGlmICh3SnNvbi5vdXRwdXREYXRhU291cmNlcyAmJiB3SnNvbi5vdXRwdXREYXRhU291cmNlcy5maW5kKG91dERzSWQgPT4gb3V0RHNJZCA9PT0gZGF0YVNvdXJjZUlkKSkge1xuICAgICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIHdJZCwgJ291dHB1dERhdGFTb3VyY2VzJ10sIHdKc29uLm91dHB1dERhdGFTb3VyY2VzLmZpbHRlcihvdXREc0lkID0+IG91dERzSWQgIT09IGRhdGFTb3VyY2VJZCkpXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIHVwZGF0ZSBtZXNzYWdlIHVzZSBkYXRhIHNvdXJjZVxuICAgIHRoaXMuYXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzICYmIE9iamVjdC5rZXlzKHRoaXMuYXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzKS5mb3JFYWNoKG1jSWQgPT4ge1xuICAgICAgY29uc3QgbUpzb24gPSB0aGlzLmFwcENvbmZpZy5tZXNzYWdlQ29uZmlnc1ttY0lkXVxuICAgICAgY29uc3QgYWN0aW9ucyA9IG1Kc29uLmFjdGlvbnM/LmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSlcbiAgICAgIGFjdGlvbnM/LmZvckVhY2goKGFjdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKGFjdGlvbj8udXNlRGF0YVNvdXJjZXM/LmZpbmQodXNlRHMgPT4gdGhpcy5pc1VzZURhdGFTb3VyY2VTaG91bGRCZVJlbW92ZWQodXNlRHMsIGRhdGFTb3VyY2VJZCkpKSB7XG4gICAgICAgICAgYWN0aW9uc1tpbmRleF0udXNlRGF0YVNvdXJjZXMgPSBhY3Rpb24udXNlRGF0YVNvdXJjZXMuZmlsdGVyKHVzZURzID0+ICF0aGlzLmlzVXNlRGF0YVNvdXJjZVNob3VsZEJlUmVtb3ZlZCh1c2VEcywgZGF0YVNvdXJjZUlkKSlcbiAgICAgICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnbWVzc2FnZUNvbmZpZ3MnLCBtY0lkLCAnYWN0aW9ucyddLCBhY3Rpb25zKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG5cbiAgICAvLyByZW1vdmUgb3V0cHV0IGRhdGEgc291cmNlXG4gICAgT2JqZWN0LmVudHJpZXModGhpcy5hcHBDb25maWcuZGF0YVNvdXJjZXMpLmZvckVhY2goKFtkc0lkLCBkc0pzb25dKSA9PiB7XG4gICAgICBpZiAoZHNKc29uLm9yaWdpbkRhdGFTb3VyY2VzICYmICEhZHNKc29uLm9yaWdpbkRhdGFTb3VyY2VzLmZpbmQodXNlRHMgPT4gdGhpcy5pc1VzZURhdGFTb3VyY2VTaG91bGRCZVJlbW92ZWQodXNlRHMsIGRhdGFTb3VyY2VJZCkpKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlRGF0YVNvdXJjZShkc0lkKVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGlzVXNlRGF0YVNvdXJjZVNob3VsZEJlUmVtb3ZlZCAodXNlRHM6IFVzZURhdGFTb3VyY2UgfCBJTVVzZURhdGFTb3VyY2UsIHJlYWxUb0JlUmVtb3ZlZERzSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIC8qKlxuICAgICAqIFJlbW92ZSBkYXRhIHNvdXJjZSB3aGljaCBpczpcbiAgICAgKiAgMS4gdGhlIGRhdGEgc291cmNlIHRvIGJlIHJlbW92ZWQsIG9yLFxuICAgICAqICAyLiBkZXJpdmVkIGZyb20gdGhlIGRhdGEgc291cmNlIHRvIGJlIHJlbW92ZWQgKGRhdGEgdmlld3MgYW5kIGxvY2FsIGRhdGEgc291cmNlcyksIG9yLFxuICAgICAqICAzLiBkZXNjZW5kYW50IGRhdGEgc291cmNlIG9mIHRoZSBkYXRhIHNvdXJjZSB0byBiZSByZW1vdmVkIChlLmcuIGNoaWxkIGRhdGEgc291cmNlIGFuZCBncmFuZGNoaWxkIGRhdGEgc291cmNlKSwgb3IsXG4gICAgICogIDQuIGRlcml2ZWQgZnJvbSB0aGUgZGVzY2VuZGFudCBkYXRhIHNvdXJjZSBvZiB0aGUgZGF0YSBzb3VyY2UgdG8gYmUgcmVtb3ZlZCAoZS5nLiBkYXRhIHZpZXdzIG9mIGNoaWxkIGRhdGEgc291cmNlKS5cbiAgICAgKi9cbiAgICByZXR1cm4gIXVzZURzIHx8ICh1c2VEcy5kYXRhU291cmNlSWQgPT09IHJlYWxUb0JlUmVtb3ZlZERzSWQgfHwgdXNlRHMubWFpbkRhdGFTb3VyY2VJZCA9PT0gcmVhbFRvQmVSZW1vdmVkRHNJZCB8fCB1c2VEcy5yb290RGF0YVNvdXJjZUlkID09PSByZWFsVG9CZVJlbW92ZWREc0lkKVxuICB9XG5cbiAgZWRpdERhdGFTb3VyY2UgKGRhdGFTb3VyY2VKc29uOiBJTURhdGFTb3VyY2VKc29uKTogdGhpcyB7XG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXRJbihbJ2RhdGFTb3VyY2VzJywgZGF0YVNvdXJjZUpzb24uaWRdLCBkYXRhU291cmNlSnNvbilcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyoqXG4gICAqIER1cGxpY2F0ZSB0aGUgZGF0YXNvdXJjZW4gYW5kIHJldHVybiB0aGUgbmV3IGRhdGFzb3VyY2UuIFRoZSBuZXcgZGF0YXNvdXJjZSBoYXMgYmVlbiBhZGRlZCB0byBhcHAgY29uZmlnXG4gICAqIEBwYXJhbSBkYXRhU291cmNlSWRcbiAgICovXG4gIGR1cGxpY2F0ZURhdGFTb3VyY2UgKGRhdGFTb3VyY2VJZDogc3RyaW5nKTogSU1EYXRhU291cmNlSnNvbiB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy5kYXRhU291cmNlcyB8fCAhdGhpcy5hcHBDb25maWcuZGF0YVNvdXJjZXNbZGF0YVNvdXJjZUlkXSkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCBkc0pzb24gPSB0aGlzLmFwcENvbmZpZy5kYXRhU291cmNlc1tkYXRhU291cmNlSWRdXG4gICAgY29uc3QgbmV3RHNKc29uID0gZHNKc29uLnNldCgnaWQnLCBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVJZCh0aGlzLmFwcENvbmZpZywgJ2RhdGFTb3VyY2UnKSlcbiAgICAgIC5zZXQoJ2xhYmVsJywgdGhpcy5nZXREdXBsaWNhdGVMYWJlbCgnZGF0YVNvdXJjZScsIGRzSnNvbi5sYWJlbCkpXG4gICAgdGhpcy5hZGREYXRhU291cmNlKG5ld0RzSnNvbilcblxuICAgIHJldHVybiBuZXdEc0pzb25cbiAgfVxuXG4gIC8vICNlbmRyZWdpb25cblxuICAvLyAjcmVnaW9uIEFwcCBwcm94eSBBUElzXG4gIGFkZEFwcFByb3h5IChwcm94eUpzb246IElNUHJveHlKc29uKTogdGhpcyB7XG4gICAgaWYgKHRoaXMuYXBwQ29uZmlnLmFwcFByb3hpZXMgJiYgdGhpcy5hcHBDb25maWcuYXBwUHJveGllc1twcm94eUpzb24uaWRdKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydhcHBQcm94aWVzJywgcHJveHlKc29uLmlkXSwgcHJveHlKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBlZGl0QXBwUHJveHkgKHByb3h5SnNvbjogSU1Qcm94eUpzb24pOiB0aGlzIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnYXBwUHJveGllcycsIHByb3h5SnNvbi5pZF0sIHByb3h5SnNvbilcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcmVtb3ZlQXBwUHJveHkgKGFwcFByb3h5SWQ6IHN0cmluZyk6IHRoaXMge1xuICAgIGlmICghdGhpcy5hcHBDb25maWcuYXBwUHJveGllcyB8fCAhdGhpcy5hcHBDb25maWcuYXBwUHJveGllc1thcHBQcm94eUlkXSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgnYXBwUHJveGllcycsIHRoaXMuYXBwQ29uZmlnLmFwcFByb3hpZXMud2l0aG91dChhcHBQcm94eUlkKSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG4gIC8vICNlbmRyZWdpb25cblxuICAvLyAjcmVnaW9uIE1lc3NhZ2UgYWN0aW9uIEFQSXNcbiAgYWRkTWVzc2FnZSAobWVzc2FnZUpzb246IElNTWVzc2FnZUpzb24pOiB0aGlzIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnbWVzc2FnZUNvbmZpZ3MnLCBtZXNzYWdlSnNvbi5pZF0sIG1lc3NhZ2VKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBlZGl0TWVzc2FnZSAobWVzc2FnZUpzb246IElNTWVzc2FnZUpzb24pOiB0aGlzIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnbWVzc2FnZUNvbmZpZ3MnLCBtZXNzYWdlSnNvbi5pZF0sIG1lc3NhZ2VKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICByZW1vdmVNZXNzYWdlIChtZXNzYWdlSnNvbjogSU1NZXNzYWdlSnNvbik6IHRoaXMge1xuICAgIGlmICghdGhpcy5hcHBDb25maWcubWVzc2FnZUNvbmZpZ3MgfHwgIXRoaXMuYXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzW21lc3NhZ2VKc29uLmlkXSkge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgnbWVzc2FnZUNvbmZpZ3MnLCB0aGlzLmFwcENvbmZpZy5tZXNzYWdlQ29uZmlncy53aXRob3V0KG1lc3NhZ2VKc29uLmlkKSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLy8gI2VuZHJlZ2lvblxuXG4gIC8vICNyZWdpb24gVGhlbWUgQVBJc1xuXG4gIGVkaXRUaGVtZSAodGhlbWVOYW1lOiBzdHJpbmcpOiB0aGlzIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgndGhlbWUnLCB0aGVtZU5hbWUpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVkaXRDdXN0b21UaGVtZSAoY3VzdG9tVGhlbWU6IElNQ3VzdG9tVGhlbWVKc29uKTogdGhpcyB7XG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ2N1c3RvbVRoZW1lJywgY3VzdG9tVGhlbWUpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVkaXRDdXN0b21UaGVtZU9wdGlvbiAodGhlbWVPcHRpb246IFRoZW1lT3B0aW9ucyk6IHRoaXMge1xuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0KCdjdXN0b21UaGVtZU9wdGlvbnMnLCB0aGVtZU9wdGlvbilcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLy8gI2VuZHJlZ2lvblxuXG4gIC8vICNyZWdpb24gSGVhZGVyIEFQSXMsIEZvb3RlciBBUElzXG5cbiAgaW5pdEhlYWRlckxheW91dCAoKTogdGhpcyB7XG4gICAgY29uc3QgbGF5b3V0SWQgPSB0aGlzLmNyZWF0ZUxheW91dChMYXlvdXRUeXBlLkZpeGVkTGF5b3V0KVxuICAgIHRoaXMuZWRpdExheW91dFByb3BlcnR5KGxheW91dElkLCAnc2V0dGluZy5sb2NrRGVzY2VuZGFudHMnLCB0cnVlKVxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWdcbiAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ3BhcmVudCddLCB7IGlkOiAnJywgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5IZWFkZXIgfSlcbiAgICAgIC5zZXRJbihbJ2hlYWRlcicsICdsYXlvdXQnLCB0aGlzLmFwcENvbmZpZy5tYWluU2l6ZU1vZGVdLCBsYXlvdXRJZClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgZWRpdEhlYWRlclByb3BlcnR5IChwcm9wOiBzdHJpbmcsIHZhbDogYW55KTogdGhpcyB7XG4gICAgbGV0IGhlYWRlciA9IHRoaXMuYXBwQ29uZmlnLmhlYWRlclxuICAgIGlmICghaGVhZGVyKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICBoZWFkZXIgPSB0aGlzLmVkaXRKc29uUHJvcGVydHkoaGVhZGVyLCBwcm9wLCB2YWwpIGFzIGFueVxuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0KCdoZWFkZXInLCBoZWFkZXIpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGluaXRGb290ZXJMYXlvdXQgKCk6IHRoaXMge1xuICAgIGNvbnN0IGxheW91dElkID0gdGhpcy5jcmVhdGVMYXlvdXQoTGF5b3V0VHlwZS5GaXhlZExheW91dClcbiAgICB0aGlzLmVkaXRMYXlvdXRQcm9wZXJ0eShsYXlvdXRJZCwgJ3NldHRpbmcubG9ja0Rlc2NlbmRhbnRzJywgdHJ1ZSlcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnXG4gICAgICAuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SWQsICdwYXJlbnQnXSwgeyBpZDogJycsIHR5cGU6IExheW91dFBhcmVudFR5cGUuRm9vdGVyIH0pXG4gICAgICAuc2V0SW4oWydmb290ZXInLCAnbGF5b3V0JywgdGhpcy5hcHBDb25maWcubWFpblNpemVNb2RlXSwgbGF5b3V0SWQpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVkaXRGb290ZXJQcm9wZXJ0eSAocHJvcDogc3RyaW5nLCB2YWw6IGFueSk6IHRoaXMge1xuICAgIGxldCBmb290ZXIgPSB0aGlzLmFwcENvbmZpZy5mb290ZXJcbiAgICBpZiAoIWZvb3Rlcikge1xuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gICAgZm9vdGVyID0gdGhpcy5lZGl0SnNvblByb3BlcnR5KGZvb3RlciwgcHJvcCwgdmFsKSBhcyBhbnlcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldCgnZm9vdGVyJywgZm9vdGVyKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBPdGhlciBBUElzXG4gIHNldFZpZXdwb3J0U2l6ZSAoYnJvd3NlclNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsIHNpemU6IFNpemUpIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuYXBwQ29uZmlnLnNldEluKFsnZm9yQnVpbGRlckF0dHJpYnV0ZXMnLCAndmlld1BvcnRTaXplJywgYnJvd3NlclNpemVNb2RlXSwgc2l6ZSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgc2V0TG9ja0xheW91dCAobG9ja0xheW91dDogYm9vbGVhbikge1xuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydmb3JCdWlsZGVyQXR0cmlidXRlcycsICdsb2NrTGF5b3V0J10sIGxvY2tMYXlvdXQpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGVkaXRBdHRyaWJ1dGVzIChhdHRyaWJ1dGVzSnNvbjogSU1BdHRyaWJ1dGVzSnNvbik6IHRoaXMge1xuICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydhdHRyaWJ1dGVzJ10sIGF0dHJpYnV0ZXNKc29uKVxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyAjZW5kcmVnaW9uXG5cbiAgLy8gI3JlZ2lvbiBVcmxQYXJhbWV0ZXJzXG4gIHVwZGF0ZVVybFBhcmFtc0NvbmZpZyAodXJsUGFyYW1zOiBVcmxQYXJhbXNDb25maWcpOiB0aGlzIHtcbiAgICBpZiAoIXRoaXMuYXBwQ29uZmlnLnVybFBhcmFtcykge1xuICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ3VybFBhcmFtcycsICh7fSkpIC8vIGRlZmF1bHQgdmFsdWUgaXMgZW1wdHkgb2JqZWN0XG4gICAgfVxuICAgIGNvbnN0IHVybFBhcmFtc0NvbmZpZ3MgPSB0aGlzLmFwcENvbmZpZy51cmxQYXJhbXMubWVyZ2UoKHVybFBhcmFtcykpXG4gICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ3VybFBhcmFtcycsIHVybFBhcmFtc0NvbmZpZ3MpXG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG4gIC8vICNlbmRyZWdpb24gVXJsUGFyYW1ldGVyc1xuXG4gIC8vICNyZWdpb24gUHJpdmF0ZSBtZXRob2RzXG5cbiAgcHJpdmF0ZSBnZXREdXBsaWNhdGVMYWJlbCAodHlwZTogRWxlbWVudFR5cGUsIGxhYmVsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IFtwcmVmaXhdID0gYXBwQ29uZmlnVXRpbHMucGFyc2VVbmlxdWVMYWJlbChsYWJlbClcbiAgICBsZXQgbmV3TGFiZWwgPSBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVMYWJlbCh0aGlzLmFwcENvbmZpZywgdHlwZSwgcHJlZml4KVxuICAgIGlmIChuZXdMYWJlbCA9PT0gcHJlZml4KSB7XG4gICAgICBuZXdMYWJlbCA9IGAke3ByZWZpeH0gMWBcbiAgICB9XG4gICAgcmV0dXJuIG5ld0xhYmVsXG4gIH1cblxuICBwcml2YXRlIHJlbW92ZVBhZ2VGcm9tUGFnZVN0cnVjdHVyZSAocGFnZUlkOiBzdHJpbmcpOiB0aGlzIHtcbiAgICBpZiAoIXRoaXMuYXBwQ29uZmlnLnBhZ2VTdHJ1Y3R1cmUpIHtcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuICAgIGNvbnN0IHBzID0gdGhpcy5hcHBDb25maWcucGFnZVN0cnVjdHVyZS5maW5kKHBzID0+ICEhcHNbcGFnZUlkXSlcblxuICAgIGlmIChwcykge1xuICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLmFwcENvbmZpZy5zZXQoJ3BhZ2VTdHJ1Y3R1cmUnLCB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlLmZsYXRNYXAoaXRlbSA9PiBpdGVtW3BhZ2VJZF0gPyBbXSA6IFtpdGVtXSkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYXBwQ29uZmlnLnBhZ2VTdHJ1Y3R1cmUuZm9yRWFjaCgocHMsIGkpID0+IHtcbiAgICAgICAgY29uc3QgcElkID0gT2JqZWN0LmtleXMocHMpLmZpbmQocElkID0+IHBzW3BJZF0uaW5jbHVkZXMocGFnZUlkKSlcbiAgICAgICAgaWYgKHBJZCkge1xuICAgICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydwYWdlU3RydWN0dXJlJywgaSArICcnLCBwSWRdLCBwc1twSWRdLmZsYXRNYXAoc3ViUGlkID0+IHN1YlBpZCA9PT0gcGFnZUlkID8gW10gOiBbc3ViUGlkXSkpXG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcHJpdmF0ZSBtb3ZlUGFnZUludG9QYWdlRm9yUGFnZVN0cnVjdHVyZSAoc3ViUGFnZUlkOiBzdHJpbmcsIHBhcmVudFBhZ2VJZDogc3RyaW5nKTogdGhpcyB7XG4gICAgaWYgKCF0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlKSB7XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlLnNvbWUoKHBzLCBpKSA9PiB7XG4gICAgICBjb25zdCBwSWQgPSBPYmplY3Qua2V5cyhwcykuZmluZChwSWQgPT4gcElkID09PSBwYXJlbnRQYWdlSWQpXG4gICAgICBpZiAocElkKSB7XG4gICAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5hcHBDb25maWcuc2V0SW4oWydwYWdlU3RydWN0dXJlJywgaSArICcnLCBwSWRdLCB0aGlzLmFwcENvbmZpZy5wYWdlU3RydWN0dXJlW2ldW3BJZF0uY29uY2F0KFtzdWJQYWdlSWRdKSlcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHByaXZhdGUgZWRpdEpzb25Qcm9wZXJ0eSAoanNvbjogSW1tdXRhYmxlT2JqZWN0PGFueT4sIHByb3A6IHN0cmluZywgdmFsdWU6IGFueSk6IEltbXV0YWJsZU9iamVjdDxhbnk+IHtcbiAgICBpZiAoIWpzb24pIHtcbiAgICAgIHJldHVybiBqc29uXG4gICAgfVxuICAgIGNvbnN0IHByb3BzID0gcHJvcC5zcGxpdCgnLicpLmZpbHRlcihpdGVtID0+IGl0ZW0gIT09ICcnKVxuXG4gICAgaWYgKHByb3BzLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmIChqc29uLmdldEluKHByb3BzKSA9PT0gdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGpzb25cbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgIC8vIHJlbW92ZSB0aGUgcHJvcGVydHlcbiAgICAgICAgaWYgKHByb3BzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIHJldHVybiBqc29uLndpdGhvdXQocHJvcHNbMF0pXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGFzdFByb3AgPSBwcm9wcy5wb3AoKVxuICAgICAgICBjb25zdCByZW1haW5WYWx1ZSA9IGpzb24uZ2V0SW4ocHJvcHMpXG4gICAgICAgIHJldHVybiBqc29uLnNldEluKHByb3BzLCByZW1haW5WYWx1ZS53aXRob3V0KGxhc3RQcm9wKSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBqc29uLnNldEluKHByb3BzLCB2YWx1ZSlcbiAgICB9XG5cbiAgICByZXR1cm4ganNvblxuICB9XG4gIC8vICNlbmRyZWdpb25cbn1cbiIsImltcG9ydCB7XG4gIHR5cGUgSU1BcHBDb25maWcsXG4gIHR5cGUgSW1tdXRhYmxlQXJyYXksXG4gIHR5cGUgTGF5b3V0SW5mbyxcbiAgdHlwZSBCcm93c2VyU2l6ZU1vZGVcbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBUZW1wbGF0ZSB9IGZyb20gJy4uL3RlbXBsYXRlcy90eXBlJ1xuaW1wb3J0IHsgdHlwZSBUb2NOb2RlIH0gZnJvbSAnLi9iYXNlLWxheW91dC1zZXJ2aWNlJ1xuXG5leHBvcnQgaW50ZXJmYWNlIER1cGxpY2F0ZUNvbnRleHQge1xuICBba2V5OiBzdHJpbmddOiBzdHJpbmdcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJhc2VDb250ZW50U2VydmljZSB7XG4gIGFic3RyYWN0IGNyZWF0ZUZyb21UZW1wbGF0ZSAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLFxuICAgIHNlY3Rpb25JZDogc3RyaW5nLFxuICAgIHNpemVNb2RlTGlzdDogQnJvd3NlclNpemVNb2RlW10sXG4gICAgY29udGVudE1hcHBpbmc6IER1cGxpY2F0ZUNvbnRleHQsXG4gICAgb3B0aW9ucz86IGFueVxuICApOiBQcm9taXNlPFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdJZDogc3RyaW5nXT5cblxuICBhYnN0cmFjdCBkdXBsaWNhdGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgdGFyZ2V0QnJvd3NlclNpemU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdJZDogc3RyaW5nXVxuXG4gIGFic3RyYWN0IGR1cGxpY2F0ZUVtYmVkTGF5b3V0IChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIHRvU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZVxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbmV3Q29udGVudElkOiBzdHJpbmddXG5cbiAgLyoqXG4gICAqIFRyeSB0byByZW1vdmUgYSBjb250ZW50LiBJdCBpcyB1c2VkIGluIHJlbW92aW5nIGEgbGF5b3V0IGR1cmluZyB3aGljaCBldmVyeSBsYXlvdXQgaXRlbSBpcyBiZWluZyByZW1vdmVkLlxuICAgKiBCdXQgYSBjb250ZW50IG1heSBiZSB1c2VkIGluIG11bHRpcGxlIHBsYWNlcy4gT25seSByZW1vdmUgdGhlIGNvbnRlbnQgd2hlbjpcbiAgICogLSBUaGVyZSBpcyBubyBwYXJlbnQgaW4gb3RoZXIgc2l6ZSBtb2RlcyBvdGhlciB0aGFuIHRoZSBzcGVjaWZpZWQgc2l6ZU1vZGVcbiAgICogSWYgdGhlcmUgYXJlIHR3byBtdWx0aXBsZSBwYXJlbnRzIGluIHRoZSBzcGVjaWZpZWQgc2l6ZU1vZGUsIHJlbW92ZSB0aGVtIGJvdGguXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIGNvbnRlbnRJZFxuICAgKiBAcGFyYW0gbGF5b3V0SW5mb1xuICAgKiBAcGFyYW0gc2l6ZU1vZGVcbiAgICovXG4gIGFic3RyYWN0IHRyeVJlbW92ZSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcsIGxheW91dEluZm86IExheW91dEluZm8sIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUpOiBJTUFwcENvbmZpZ1xuXG4gIC8qKlxuICAgKiBGb3JjZSB0byByZW1vdmUgYSBjb250ZW50IGFuZCBhbGwgaXRzIHBhcmVudCBsYXlvdXQgaXRlbXMuXG4gICAqIDEuIEZpbmQgYWxsIHBhcmVudCBpdGVtcywgcmVtb3ZlIHRoZW1cbiAgICogMi4gcmVtb3ZlIHRoZSBjb250ZW50XG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIGNvbnRlbnRJZFxuICAgKi9cbiAgYWJzdHJhY3QgcmVtb3ZlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZyk6IElNQXBwQ29uZmlnXG5cbiAgYWJzdHJhY3QgdG9Ub2NOb2RlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgcGFyZW50OiBMYXlvdXRJbmZvLCBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IFRvY05vZGVcblxuICAvKipcbiAgICogSG9va3MgdG8gYmUgY2FsbGVkIGFmdGVyIGEgY29udGVudCBpcyBtb3ZlZCB0byBhbm90aGVyIGxheW91dC5cbiAgICogT2NjdXJzIGluIHNhbWUgc2l6ZSBtb2RlLlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBjb250ZW50SWRcbiAgICogQHBhcmFtIGZyb21MYXlvdXRcbiAgICogQHBhcmFtIHRvTGF5b3V0XG4gICAqL1xuICBhYnN0cmFjdCBhZnRlck1vdmVkIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgZnJvbUxheW91dDogc3RyaW5nLCB0b0xheW91dDogc3RyaW5nKTogSU1BcHBDb25maWdcblxuICAvKipcbiAgICogSG9va3MgdG8gYmUgY2FsbGVkIGFmdGVyIGEgY29udGVudCBpcyBhZGRlZCB0byBhIGxheW91dC5cbiAgICogT2NjdXJzIGluIHRoZSBmb2xsb3dpbmcgY2FzZXM6XG4gICAqIDEuIERyYWcgdG8gYWRkIGEgbmV3IGNvbnRlbnQgdG8gYSBsYXlvdXQuXG4gICAqIDIuIERyYWcgYSBwZW5kaW5nIGl0ZW0gdG8gYSBsYXlvdXQuXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIGNvbnRlbnRJZFxuICAgKiBAcGFyYW0gdG9MYXlvdXRcbiAgICogQHBhcmFtIGZyb21TaXplTW9kZVxuICAgKiBAcGFyYW0gdG9TaXplTWRvZVxuICAgKi9cbiAgYWJzdHJhY3QgYWZ0ZXJBZGRlZCAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcsIHRvTGF5b3V0OiBzdHJpbmcsIGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLCB0b1NpemVNZG9lOiBCcm93c2VyU2l6ZU1vZGUpOiBJTUFwcENvbmZpZ1xuXG4gIGFic3RyYWN0IGZpbmRQYXJlbnQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGNvbnRlbnRJZDogc3RyaW5nLCBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IExheW91dEluZm9cblxuICBhYnN0cmFjdCBhZGRQYXJlbnQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgbGF5b3V0SW5mbzogTGF5b3V0SW5mbyxcbiAgICBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZVxuICApOiBJTUFwcENvbmZpZ1xuXG4gIGFic3RyYWN0IHJlbW92ZVBhcmVudCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIGJyb3dzZXJTaXplTW9kZT86IEJyb3dzZXJTaXplTW9kZVxuICApOiBJTUFwcENvbmZpZ1xuXG4gIGFic3RyYWN0IHJlbW92ZVNpemVNb2RlUGFyZW50IChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIGJyb3dzZXJTaXplTW9kZTogQnJvd3NlclNpemVNb2RlXG4gICk6IElNQXBwQ29uZmlnXG5cbiAgYWJzdHJhY3QgY2xlYXJQYXJlbnQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmdcbiAgKTogSU1BcHBDb25maWdcblxuICBwcm90ZWN0ZWQgYWRkUGFyZW50VG9MaXN0IChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGV4aXN0aW5nUGFyZW50czogSW1tdXRhYmxlQXJyYXk8TGF5b3V0SW5mbz4sXG4gICAgcGFyZW50OiBMYXlvdXRJbmZvXG4gICk6IExheW91dEluZm9bXSB8IEltbXV0YWJsZUFycmF5PExheW91dEluZm8+IHtcbiAgICBpZiAoIWV4aXN0aW5nUGFyZW50cyB8fCBleGlzdGluZ1BhcmVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gW3BhcmVudF1cbiAgICB9XG5cbiAgICBjb25zdCBleGlzdHMgPSBleGlzdGluZ1BhcmVudHMuc29tZShcbiAgICAgIChpbmZvKSA9PiBpbmZvLmxheW91dElkID09PSBwYXJlbnQubGF5b3V0SWQgJiYgaW5mby5sYXlvdXRJdGVtSWQgPT09IHBhcmVudC5sYXlvdXRJdGVtSWRcbiAgICApXG4gICAgaWYgKCFleGlzdHMpIHtcbiAgICAgIC8vIGlmIGEgY29udGVudCBoYXMgbXVsdGlwbGUgcGFyZW50cywgdGhlaXIgbGF5b3V0IG11c3QgaGF2ZSBhIHNhbWUgcGFyZW50XG4gICAgICBjb25zdCBleGlzdGluZ1BhcmVudExheW91dElkID0gZXhpc3RpbmdQYXJlbnRzWzBdLmxheW91dElkXG4gICAgICBjb25zdCBleGlzdGluZ1BhcmVudExheW91dCA9IGFwcENvbmZpZy5sYXlvdXRzW2V4aXN0aW5nUGFyZW50TGF5b3V0SWRdXG4gICAgICBjb25zdCBhZGRpbmdQYXJlbnRMYXlvdXQgPSBhcHBDb25maWcubGF5b3V0c1twYXJlbnQubGF5b3V0SWRdXG4gICAgICBpZiAoZXhpc3RpbmdQYXJlbnRMYXlvdXRJZCA9PT0gcGFyZW50LmxheW91dElkIHx8IGFkZGluZ1BhcmVudExheW91dC5wYXJlbnQuaWQgIT09IGV4aXN0aW5nUGFyZW50TGF5b3V0LnBhcmVudC5pZCB8fCBhZGRpbmdQYXJlbnRMYXlvdXQucGFyZW50LnR5cGUgIT09IGV4aXN0aW5nUGFyZW50TGF5b3V0LnBhcmVudC50eXBlKSB7XG4gICAgICAgIC8vIHJlcGxhY2UgdGhlIGV4aXN0aW5nIHBhcmVudHMgd2l0aCB0aGUgbmV3IHBhcmVudFxuICAgICAgICByZXR1cm4gW3BhcmVudF1cbiAgICAgIH1cblxuICAgICAgY29uc3QgbGlzdCA9IFtdLmNvbmNhdChleGlzdGluZ1BhcmVudHMsIHBhcmVudClcbiAgICAgIHJldHVybiBsaXN0XG4gICAgfVxuICAgIHJldHVybiBleGlzdGluZ1BhcmVudHNcbiAgfVxuXG4gIHByb3RlY3RlZCByZW1vdmVQYXJlbnRGcm9tTGlzdCAoXG4gICAgZXhpc3RpbmdQYXJlbnRzOiBJbW11dGFibGVBcnJheTxMYXlvdXRJbmZvPixcbiAgICBwYXJlbnQ6IExheW91dEluZm9cbiAgKTogTGF5b3V0SW5mb1tdIHwgSW1tdXRhYmxlQXJyYXk8TGF5b3V0SW5mbz4ge1xuICAgIGlmICghZXhpc3RpbmdQYXJlbnRzIHx8IGV4aXN0aW5nUGFyZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cblxuICAgIHJldHVybiBleGlzdGluZ1BhcmVudHMuZmlsdGVyKFxuICAgICAgKGl0ZW0pID0+IGl0ZW0ubGF5b3V0SWQgIT09IHBhcmVudC5sYXlvdXRJZCB8fCBpdGVtLmxheW91dEl0ZW1JZCAhPT0gcGFyZW50LmxheW91dEl0ZW1JZFxuICAgIClcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgdHlwZSBJTUFwcENvbmZpZyxcbiAgdHlwZSBMYXlvdXRJbmZvLFxuICB0eXBlIElNTGF5b3V0SnNvbixcbiAgdHlwZSBCcm93c2VyU2l6ZU1vZGUsXG4gIHR5cGUgSU1TaXplTW9kZUxheW91dEpzb24sXG4gIHR5cGUgU2l6ZU1vZGVMYXlvdXRKc29uLFxuICB0eXBlIExheW91dEl0ZW1Db25zdHJ1Y3RvclByb3BzLFxuICB0eXBlIEljb25SZXN1bHQsXG4gIHR5cGUgSW1tdXRhYmxlT2JqZWN0LFxuICB0eXBlIEltbXV0YWJsZUFycmF5LFxuICBMYXlvdXRUeXBlLFxuICBFeHRlbnNpb25NYW5hZ2VyLFxuICBleHRlbnNpb25TcGVjLFxuICBMYXlvdXRJdGVtVHlwZSxcbiAgTGF5b3V0UGFyZW50VHlwZVxufSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIER1cGxpY2F0ZUNvbnRleHQgfSBmcm9tICcuL2Jhc2UtY29udGVudC1zZXJ2aWNlJ1xuaW1wb3J0IGVtcHR5Q29udGVudFNlcnZpY2UgZnJvbSAnLi9lbXB0eS1jb250ZW50LXNlcnZpY2UnXG5pbXBvcnQgeyBDb250ZW50U2VydmljZVdyYXBwZXIgfSBmcm9tICcuL2NvbnRlbnQtc2VydmljZS13cmFwcGVyJ1xuaW1wb3J0ICogYXMgYXBwQ29uZmlnVXRpbHMgZnJvbSAnLi4vdXRpbHMvYXBwLWNvbmZpZy11dGlscydcbmltcG9ydCB7IHNlYXJjaFV0aWxzLCB1dGlscyBhcyBsYXlvdXRVdGlscywgdHlwZSBUb29sSXRlbUNvbmZpZyB9IGZyb20gJ2ppbXUtbGF5b3V0cy9sYXlvdXQtcnVudGltZSdcbmltcG9ydCB7IHR5cGUgVGVtcGxhdGUgfSBmcm9tICcuLi90ZW1wbGF0ZXMnXG5pbXBvcnQgeyBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnIH0gZnJvbSAnLi91dGlsJ1xuaW1wb3J0IHsgTGF5b3V0U2VydmljZVByb3ZpZGVyIH0gZnJvbSAnLi9sYXlvdXQtc2VydmljZS1wcm92aWRlcidcblxuZXhwb3J0IGludGVyZmFjZSBUb2NOb2RlIHtcbiAgbGFiZWw6IHN0cmluZ1xuICBpY29uPzogSWNvblJlc3VsdCB8IEltbXV0YWJsZU9iamVjdDxJY29uUmVzdWx0PiB8IHN0cmluZ1xuICBmbGlwSWNvbj86IGJvb2xlYW5cbiAgbGF5b3V0SWQ/OiBzdHJpbmdcbiAgbGF5b3V0SXRlbUlkPzogc3RyaW5nXG4gIGlzTGFiZWxSZWFkT25seT86IGJvb2xlYW5cbiAgdHlwZT86ICd2aWV3JyB8ICdzY3JlZW4nIHwgJ3dpZGdldCcgfCAnc2VjdGlvbicgfCAnc2NyZWVuR3JvdXAnIHwgJ2xheW91dCcgfCAnbGF5b3V0SXRlbSdcbiAgaWQ/OiBzdHJpbmcgLy8gaWQgb2YgdGhlIGNvbXBvbmVudCBzcGVjaWZpZWQgYnkgdGhlIHR5cGVcbiAgY2hpbGRyZW4/OiBUb2NOb2RlW11cbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJhc2VMYXlvdXRTZXJ2aWNlIHtcbiAgLyoqXG4gICAqIENyZWF0ZSBhIGJsYW5rIGxheW91dC5cbiAgICogQHBhcmFtIGFwcENvbmZpZ1xuICAgKiBAcGFyYW0gdHlwZVxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgY3JlYXRlQmxhbmtMYXlvdXQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIHR5cGU6IExheW91dFR5cGUpOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbGF5b3V0SWQ6IHN0cmluZ10ge1xuICAgIGNvbnN0IGxheW91dElkID0gYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnbGF5b3V0JylcbiAgICBjb25zdCBsYXlvdXRKc29uID0ge1xuICAgICAgaWQ6IGxheW91dElkLFxuICAgICAgY29udGVudDoge30sXG4gICAgICB0eXBlXG4gICAgfVxuICAgIGNvbnNvbGUuZGVidWcoJ2NyZWF0ZSBhIGJsYW5rIGxheW91dCB3aXRoIHR5cGUnLCB0eXBlKVxuICAgIGNvbnN0IHVwZGF0ZWRDb25maWcgPSBhcHBDb25maWcuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SWRdLCBsYXlvdXRKc29uKVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQ29uZmlnLCBsYXlvdXRJZF1cbiAgfVxuXG4gIC8qKlxuICAgKiBEdXBsaWNhdGUgYSBsYXlvdXQuXG4gICAqIElmIGR1cGxpY2F0ZUNvbnRlbnQgaXMgdHJ1ZSwgdGhlIGNvbnRlbnQgb2YgdGhlIGxheW91dCB3aWxsIGJlIGR1cGxpY2F0ZWQuXG4gICAqIElmIGR1cGxpY2F0ZUNvbnRlbnQgaXMgZmFsc2UsIGEgbmV3IHBhcmVudCB3aWxsIGJlIGFkZGVkIHRvIHRoZSBjb250ZW50LlxuICAgKiAgIC0gSWYgdGhlIGNvbnRlbnQgaXMgYSBsYXlvdXQgd2lkZ2V0LCBhIG5ldyBsYXlvdXQgd2lkZ2V0IHdpbGwgYmUgY3JlYXRlZCB1bmRlciB0aGUgdG9TaXplTW9kZS5cbiAgICogICAtIElmIHRoZSBjb250ZW50IGhhcyBlbWJlZGRlZCBsYXlvdXQsIHRoZSBlbWJlZGRlZCBsYXlvdXQgd2lsbCBiZSBkdXBsaWNhdGVkLlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBsYXlvdXRJZFxuICAgKiBAcGFyYW0gZnJvbVNpemVNb2RlXG4gICAqIEBwYXJhbSB0b1NpemVNb2RlXG4gICAqIEBwYXJhbSBjb250ZXh0XG4gICAqIEBwYXJhbSBkdXBsaWNhdGVDb250ZW50XG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBkdXBsaWNhdGVMYXlvdXQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgbGF5b3V0SWQ6IHN0cmluZyxcbiAgICBmcm9tU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICB0b1NpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dCxcbiAgICBkdXBsaWNhdGVDb250ZW50PzogYm9vbGVhblxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbGF5b3V0SWQ6IHN0cmluZ10ge1xuICAgIGNvbnN0IGxheW91dEpzb24gPSBhcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgICBpZiAoIWxheW91dEpzb24pIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgIH1cbiAgICBjb25zdCBuZXdMYXlvdXRKc29uID0gbGF5b3V0SnNvbi5zZXQoJ2lkJywgYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnbGF5b3V0JykpXG5cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ2xheW91dHMnLCBuZXdMYXlvdXRKc29uLmlkXSwgbmV3TGF5b3V0SnNvbilcblxuICAgIGNvbnNvbGUuZGVidWcoJ2R1cGxpY2F0ZSBsYXlvdXQnLCBsYXlvdXRJZCwgJywgZnJvbSBzaXplIG1vZGUnLCBmcm9tU2l6ZU1vZGUsICcsIHRvIHNpemUgbW9kZScsIHRvU2l6ZU1vZGUpXG4gICAgLy8gZHVwbGljYXRlIGNvbnRlbnRcbiAgICBPYmplY3Qua2V5cyhuZXdMYXlvdXRKc29uLmNvbnRlbnQgPz8ge30pLmZvckVhY2goaXRlbUlkID0+IHtcbiAgICAgIGNvbnN0IGxheW91dEl0ZW0gPSBuZXdMYXlvdXRKc29uLmNvbnRlbnRbaXRlbUlkXVxuICAgICAgaWYgKGxheW91dEl0ZW0uaXNQZW5kaW5nKSB7XG4gICAgICAgIC8vIG5vIG5lZWQgdG8gZHVwbGljYXRlIHBlbmRpbmcgaXRlbVxuICAgICAgICBjb25zdCBsYXlvdXQgPSB1cGRhdGVkQXBwQ29uZmlnLmxheW91dHNbbmV3TGF5b3V0SnNvbi5pZF1cbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0LmlkLCAnY29udGVudCddLCBsYXlvdXQuY29udGVudC53aXRob3V0KGl0ZW1JZCkpXG5cbiAgICAgICAgaWYgKGxheW91dC5vcmRlcj8uaW5jbHVkZXMoaXRlbUlkKSkge1xuICAgICAgICAgIGNvbnN0IG9yZGVyID0gbGF5b3V0Lm9yZGVyLmZpbHRlcihpZCA9PiBpZCAhPT0gaXRlbUlkKVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIGxheW91dC5pZCwgJ29yZGVyJ10sIG9yZGVyKVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZHVwbGljYXRlQ29udGVudCkge1xuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLmR1cGxpY2F0ZUFuZFJlcGxhY2VDb250ZW50KFxuICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyxcbiAgICAgICAgICAgIHsgbGF5b3V0SWQsIGxheW91dEl0ZW1JZDogaXRlbUlkIH0sXG4gICAgICAgICAgICB7IGxheW91dElkOiBuZXdMYXlvdXRKc29uLmlkLCBsYXlvdXRJdGVtSWQ6IGl0ZW1JZCB9LFxuICAgICAgICAgICAgZnJvbVNpemVNb2RlLFxuICAgICAgICAgICAgdG9TaXplTW9kZSxcbiAgICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgICApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3Qgc2VydmljZSA9IG5ldyBDb250ZW50U2VydmljZVdyYXBwZXIodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SXRlbSlcbiAgICAgICAgICAvLyBkdXBsaWNhdGUgZW1iZWQgbGF5b3V0IGNvbnRlbnQgaWYgYW55XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGVFbWJlZExheW91dChmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUpXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgICAgIGlmIChyZXN1bHRbMV0pIHsgLy8gbmV3IGxheW91dCB3aWRnZXQgaWRcbiAgICAgICAgICAgIGNvbnN0IG5ld0xheW91dEl0ZW0gPSBsYXlvdXRJdGVtLnNldCgnd2lkZ2V0SWQnLCByZXN1bHRbMV0pXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2xheW91dHMnLCBuZXdMYXlvdXRKc29uLmlkLCAnY29udGVudCcsIGl0ZW1JZF0sIG5ld0xheW91dEl0ZW0pXG4gICAgICAgICAgICBjb25zdCBzZXJ2aWNlMiA9IG5ldyBDb250ZW50U2VydmljZVdyYXBwZXIodXBkYXRlZEFwcENvbmZpZywgbmV3TGF5b3V0SXRlbSlcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBwYXJlbnRJbmZvLCBlYWNoIGNvbnRlbnQgYWRkcyBhIHBhcmVudCBsYXlvdXRJbmZvXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZTIuYWRkUGFyZW50KHsgbGF5b3V0SWQ6IG5ld0xheW91dEpzb24uaWQsIGxheW91dEl0ZW1JZDogaXRlbUlkIH0sIHRvU2l6ZU1vZGUpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBwYXJlbnRJbmZvLCBlYWNoIGNvbnRlbnQgYWRkcyBhIHBhcmVudCBsYXlvdXRJbmZvXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZS5hZGRQYXJlbnQoeyBsYXlvdXRJZDogbmV3TGF5b3V0SnNvbi5pZCwgbGF5b3V0SXRlbUlkOiBpdGVtSWQgfSwgdG9TaXplTW9kZSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgaWYgKGZyb21TaXplTW9kZSAhPT0gdG9TaXplTW9kZSkge1xuICAgICAgLy8gVE9ETyB0cmFuc2Zvcm0gdGhlIGxheW91dD9cbiAgICAgIGNvbnN0IGxheW91dEpzb24gPSB0aGlzLnRyYW5zZm9ybUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCB1cGRhdGVkQXBwQ29uZmlnLmxheW91dHNbbmV3TGF5b3V0SnNvbi5pZF0sIGZyb21TaXplTW9kZSwgdG9TaXplTW9kZSlcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIG5ld0xheW91dEpzb24uaWRdLCBsYXlvdXRKc29uKVxuICAgIH1cblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV3TGF5b3V0SnNvbi5pZF1cbiAgfVxuXG4gIGR1cGxpY2F0ZVNpemVNb2RlTGF5b3V0cyAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBsYXlvdXRzOiBJTVNpemVNb2RlTGF5b3V0SnNvbixcbiAgICBwYXJlbnRUeXBlOiBMYXlvdXRQYXJlbnRUeXBlLFxuICAgIHBhcmVudElkOiBzdHJpbmcsXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dFxuICApOiBbSU1BcHBDb25maWcsIFNpemVNb2RlTGF5b3V0SnNvbl0ge1xuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgY29uc3Qgb3V0cHV0TGF5b3V0czogU2l6ZU1vZGVMYXlvdXRKc29uID0ge31cblxuICAgIE9iamVjdC5rZXlzKGxheW91dHMgPz8ge30pLmZvckVhY2goKG1vZGU6IEJyb3dzZXJTaXplTW9kZSkgPT4ge1xuICAgICAgY29uc3QgbGF5b3V0SWQgPSBsYXlvdXRzW21vZGVdXG4gICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmR1cGxpY2F0ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRJZCwgbW9kZSwgbW9kZSwgY29udGV4dCwgdHJ1ZSlcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgIG91dHB1dExheW91dHNbbW9kZV0gPSByZXN1bHRbMV1cbiAgICAgIGlmIChyZXN1bHRbMV0gIT0gbnVsbCkge1xuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2xheW91dHMnLCByZXN1bHRbMV0sICdwYXJlbnQnXSwgeyB0eXBlOiBwYXJlbnRUeXBlLCBpZDogcGFyZW50SWQgfSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBvdXRwdXRMYXlvdXRzXVxuICB9XG5cbiAgLyoqXG4gICAqIER1cGxpY2F0ZSB0aGUgY29udGVudCBpbiBvcmlnaW4gbGF5b3V0SXRlbSBhbmQgcmVwbGFjZSB0aGUgY29udGVudCBpbiBkZXMgbGF5b3V0SXRlbS5cbiAgICogQHBhcmFtIGFwcENvbmZpZ1xuICAgKiBAcGFyYW0gb3JpZ2luTGF5b3V0SWRcbiAgICogQHBhcmFtIGRlc0xheW91dElkXG4gICAqIEBwYXJhbSBvcmlnaW5JdGVtSWRcbiAgICogQHBhcmFtIGRlc0l0ZW1JZFxuICAgKiBAcGFyYW0gZnJvbVNpemVNb2RlXG4gICAqIEBwYXJhbSB0b1NpemVNb2RlXG4gICAqIEBwYXJhbSBjb250ZXh0XG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBkdXBsaWNhdGVBbmRSZXBsYWNlQ29udGVudCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBvcmlnaW5MYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIGRlc0xheW91dEluZm86IExheW91dEluZm8sXG4gICAgZnJvbVNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgdG9TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHsgbGF5b3V0SWQ6IG9yaWdpbkxheW91dElkLCBsYXlvdXRJdGVtSWQ6IG9yaWdpbkl0ZW1JZCB9ID0gb3JpZ2luTGF5b3V0SW5mb1xuICAgIGNvbnN0IHsgbGF5b3V0SWQ6IGRlc0xheW91dElkLCBsYXlvdXRJdGVtSWQ6IGRlc0l0ZW1JZCB9ID0gZGVzTGF5b3V0SW5mb1xuICAgIGlmICghYXBwQ29uZmlnLmxheW91dHMgfHwgIWFwcENvbmZpZy5sYXlvdXRzW29yaWdpbkxheW91dElkXSB8fCAhYXBwQ29uZmlnLmxheW91dHNbZGVzTGF5b3V0SWRdKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuXG4gICAgY29uc3Qgb3JpTGF5b3V0SXRlbSA9IHNlYXJjaFV0aWxzLmZpbmRMYXlvdXRJdGVtKGFwcENvbmZpZywge1xuICAgICAgbGF5b3V0SWQ6IG9yaWdpbkxheW91dElkLFxuICAgICAgbGF5b3V0SXRlbUlkOiBvcmlnaW5JdGVtSWRcbiAgICB9KVxuXG4gICAgLy8gMS4gZHVwbGljYXRlIGNvbnRlbnRcbiAgICBjb25zdCBzZXJ2aWNlID0gbmV3IENvbnRlbnRTZXJ2aWNlV3JhcHBlcihhcHBDb25maWcsIG9yaUxheW91dEl0ZW0pXG4gICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGUodG9TaXplTW9kZSwgY29udGV4dClcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgIGNvbnN0IGNvbnRlbnRJZCA9IHJlc3VsdFsxXVxuXG4gICAgLy8gMi4gc2V0IGNvbnRlbnQgdG8gbGF5b3V0IGl0ZW1cbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2xheW91dHMnLCBkZXNMYXlvdXRJZCwgJ2NvbnRlbnQnLCBkZXNJdGVtSWQsICd0eXBlJ10sIG9yaUxheW91dEl0ZW0udHlwZSlcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gZW1wdHlDb250ZW50U2VydmljZS5zZXRDb250ZW50SWQodXBkYXRlZEFwcENvbmZpZywgeyBsYXlvdXRJZDogZGVzTGF5b3V0SWQsIGxheW91dEl0ZW1JZDogZGVzSXRlbUlkIH0sIGNvbnRlbnRJZCwgdG9TaXplTW9kZSlcblxuICAgIC8vIDMuIHVwZGF0ZSB0aGUgcGFyZW50IGluZm8gb2YgdGhlIGR1cGxpY2F0ZWQgY29udGVudFxuICAgIGNvbnN0IGRlc0xheW91dEl0ZW0gPSBzZWFyY2hVdGlscy5maW5kTGF5b3V0SXRlbSh1cGRhdGVkQXBwQ29uZmlnLCBkZXNMYXlvdXRJbmZvKVxuXG4gICAgY29uc3Qgc2VydmljZTIgPSBuZXcgQ29udGVudFNlcnZpY2VXcmFwcGVyKHVwZGF0ZWRBcHBDb25maWcsIGRlc0xheW91dEl0ZW0pXG4gICAgc2VydmljZTIucmVtb3ZlUGFyZW50KFxuICAgICAge1xuICAgICAgICBsYXlvdXRJZDogb3JpZ2luTGF5b3V0SWQsXG4gICAgICAgIGxheW91dEl0ZW1JZDogb3JpZ2luSXRlbUlkXG4gICAgICB9LFxuICAgICAgZnJvbVNpemVNb2RlXG4gICAgKVxuICAgIHJldHVybiBzZXJ2aWNlMi5nZXRDb25maWcoKVxuICB9XG5cbiAgYWRkQ29udGVudCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBsYXlvdXRJZDogc3RyaW5nLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIHR5cGU6IExheW91dEl0ZW1UeXBlLFxuICAgIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGVcbiAgKTogW2FwcENvbmZpZzogSU1BcHBDb25maWcsIGl0ZW1JZDogc3RyaW5nXSB7XG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jcmVhdGVCbGFua0l0ZW0oYXBwQ29uZmlnLCBsYXlvdXRJZClcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgIGNvbnN0IG5ld0l0ZW1JZCA9IHJlc3VsdFsxXVxuXG4gICAgY29uc29sZS5kZWJ1ZyhgYWRkICR7Y29udGVudElkfSB0byAke2xheW91dElkfWApXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ2NvbnRlbnQnLCBuZXdJdGVtSWQsICd0eXBlJ10sIHR5cGUpXG5cbiAgICBjb25zdCBsYXlvdXRJbmZvID0geyBsYXlvdXRJZCwgbGF5b3V0SXRlbUlkOiBuZXdJdGVtSWQgfVxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSBlbXB0eUNvbnRlbnRTZXJ2aWNlLnNldENvbnRlbnRJZCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRJbmZvLCBjb250ZW50SWQsIHNpemVNb2RlKVxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLmFmdGVySXRlbUFkZGVkKHVwZGF0ZWRBcHBDb25maWcsIGxheW91dEluZm8sIHNpemVNb2RlLCBzaXplTW9kZSlcblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV3SXRlbUlkXVxuICB9XG5cbiAgcmVtb3ZlTGF5b3V0IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRJZDogc3RyaW5nLCBzaXplTW9kZTogQnJvd3NlclNpemVNb2RlKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IGxheW91dEpzb24gPSBhcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgICBpZiAoIWxheW91dEpzb24pIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBsYXlvdXQnLCBsYXlvdXRJZCwgJ2luIHNpemUgbW9kZScsIHNpemVNb2RlKVxuICAgIE9iamVjdC5rZXlzKGxheW91dEpzb24uY29udGVudCA/PyB7fSkuZm9yRWFjaChpdGVtSWQgPT4ge1xuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMucmVtb3ZlSXRlbShcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyxcbiAgICAgICAgeyBsYXlvdXRJZDogbGF5b3V0SWQsIGxheW91dEl0ZW1JZDogaXRlbUlkIH0sXG4gICAgICAgIHNpemVNb2RlLFxuICAgICAgICB0cnVlLFxuICAgICAgICBmYWxzZVxuICAgICAgKVxuICAgIH0pXG5cbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdGhpcy5yZW1vdmVMYXlvdXRJZEZyb21QYXJlbnQodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SWQsIHNpemVNb2RlKVxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cyddLCB1cGRhdGVkQXBwQ29uZmlnLmxheW91dHMud2l0aG91dChsYXlvdXRJZCkpXG5cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgcmVtb3ZlU2l6ZU1vZGVMYXlvdXRzIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRzOiBJTVNpemVNb2RlTGF5b3V0SnNvbik6IElNQXBwQ29uZmlnIHtcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuXG4gICAgT2JqZWN0LmtleXMobGF5b3V0cykuZm9yRWFjaCgobW9kZSkgPT4ge1xuICAgICAgY29uc3QgbGF5b3V0SWQgPSBsYXlvdXRzW21vZGVdXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdGhpcy5yZW1vdmVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SWQsIG1vZGUgYXMgQnJvd3NlclNpemVNb2RlKVxuICAgIH0pXG5cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgcmVtb3ZlTGF5b3V0SWRGcm9tUGFyZW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRJZDogc3RyaW5nLCBzaXplTW9kZTogQnJvd3NlclNpemVNb2RlKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IGxheW91dEpzb24gPSBhcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgICBpZiAoIWxheW91dEpzb24pIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcbiAgICAvLyByZW1vdmUgaXQgZnJvbSBpdHMgcGFyZW50XG4gICAgY29uc3QgcGFyZW50SWQgPSBsYXlvdXRKc29uLnBhcmVudD8uaWRcbiAgICBzd2l0Y2ggKGxheW91dEpzb24ucGFyZW50Py50eXBlKSB7XG4gICAgICBjYXNlIExheW91dFBhcmVudFR5cGUuSGVhZGVyOlxuICAgICAgICBpZiAodXBkYXRlZEFwcENvbmZpZy5oZWFkZXIubGF5b3V0W3NpemVNb2RlXSA9PT0gbGF5b3V0SWQpIHtcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCdyZW1vdmUgbGF5b3V0JywgbGF5b3V0SWQsICdmcm9tIGhlYWRlciwgaW4gc2l6ZSBtb2RlJywgc2l6ZU1vZGUpXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydoZWFkZXInLCAnbGF5b3V0J10sIHVwZGF0ZWRBcHBDb25maWcuaGVhZGVyLmxheW91dC53aXRob3V0KHNpemVNb2RlKSlcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBMYXlvdXRQYXJlbnRUeXBlLkZvb3RlcjpcbiAgICAgICAgaWYgKHVwZGF0ZWRBcHBDb25maWcuZm9vdGVyLmxheW91dFtzaXplTW9kZV0gPT09IGxheW91dElkKSB7XG4gICAgICAgICAgY29uc29sZS5kZWJ1ZygncmVtb3ZlIGxheW91dCcsIGxheW91dElkLCAnZnJvbSBmb290ZXIsIGluIHNpemUgbW9kZScsIHNpemVNb2RlKVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnZm9vdGVyJywgJ2xheW91dCddLCB1cGRhdGVkQXBwQ29uZmlnLmZvb3Rlci5sYXlvdXQud2l0aG91dChzaXplTW9kZSkpXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgTGF5b3V0UGFyZW50VHlwZS5EaWFsb2c6XG4gICAgICAgIGlmICh1cGRhdGVkQXBwQ29uZmlnLmRpYWxvZ3NbcGFyZW50SWRdLmxheW91dFtzaXplTW9kZV0gPT09IGxheW91dElkKSB7XG4gICAgICAgICAgY29uc29sZS5kZWJ1ZygncmVtb3ZlIGxheW91dCcsIGxheW91dElkLCAnZnJvbSBkaWFsb2cnLCBwYXJlbnRJZCwgJywgaW4gc2l6ZSBtb2RlJywgc2l6ZU1vZGUpXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydkaWFsb2dzJywgcGFyZW50SWQsICdsYXlvdXQnXSwgdXBkYXRlZEFwcENvbmZpZy5kaWFsb2dzW3BhcmVudElkXS5sYXlvdXQud2l0aG91dChzaXplTW9kZSkpXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgTGF5b3V0UGFyZW50VHlwZS5QYWdlOlxuICAgICAgICBpZiAodXBkYXRlZEFwcENvbmZpZy5wYWdlc1twYXJlbnRJZF0ubGF5b3V0W3NpemVNb2RlXSA9PT0gbGF5b3V0SWQpIHtcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCdyZW1vdmUgbGF5b3V0JywgbGF5b3V0SWQsICdmcm9tIHBhZ2UnLCBwYXJlbnRJZCwgJywgaW4gc2l6ZSBtb2RlJywgc2l6ZU1vZGUpXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydwYWdlcycsIHBhcmVudElkLCAnbGF5b3V0J10sIHVwZGF0ZWRBcHBDb25maWcucGFnZXNbcGFyZW50SWRdLmxheW91dC53aXRob3V0KHNpemVNb2RlKSlcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBMYXlvdXRQYXJlbnRUeXBlLlZpZXc6XG4gICAgICAgIGlmICh1cGRhdGVkQXBwQ29uZmlnLnZpZXdzW3BhcmVudElkXS5sYXlvdXRbc2l6ZU1vZGVdID09PSBsYXlvdXRJZCkge1xuICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBsYXlvdXQnLCBsYXlvdXRJZCwgJ2Zyb20gdmlldycsIHBhcmVudElkLCAnLCBpbiBzaXplIG1vZGUnLCBzaXplTW9kZSlcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3ZpZXdzJywgcGFyZW50SWQsICdsYXlvdXQnXSwgdXBkYXRlZEFwcENvbmZpZy52aWV3c1twYXJlbnRJZF0ubGF5b3V0LndpdGhvdXQoc2l6ZU1vZGUpKVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIExheW91dFBhcmVudFR5cGUuU2NyZWVuOlxuICAgICAgICBpZiAodXBkYXRlZEFwcENvbmZpZy5zY3JlZW5zW3BhcmVudElkXS5tYWluLmxheW91dFtzaXplTW9kZV0gPT09IGxheW91dElkKSB7XG4gICAgICAgICAgY29uc29sZS5kZWJ1ZygncmVtb3ZlIGxheW91dCcsIGxheW91dElkLCAnZnJvbSBzY3JlZW4gbWFpbicsIHBhcmVudElkLCAnLCBpbiBzaXplIG1vZGUnLCBzaXplTW9kZSlcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbnMnLCBwYXJlbnRJZCwgJ21haW4nLCAnbGF5b3V0J10sIHVwZGF0ZWRBcHBDb25maWcuc2NyZWVuc1twYXJlbnRJZF0ubWFpbi5sYXlvdXQud2l0aG91dChzaXplTW9kZSkpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVwZGF0ZWRBcHBDb25maWcuc2NyZWVuc1twYXJlbnRJZF0ucGFuZWw/LmxheW91dCkge1xuICAgICAgICAgIGlmICh1cGRhdGVkQXBwQ29uZmlnLnNjcmVlbnNbcGFyZW50SWRdLnBhbmVsLmxheW91dFtzaXplTW9kZV0gPT09IGxheW91dElkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdyZW1vdmUgbGF5b3V0JywgbGF5b3V0SWQsICdmcm9tIHNjcmVlbiBwYW5lbCcsIHBhcmVudElkLCAnLCBpbiBzaXplIG1vZGUnLCBzaXplTW9kZSlcbiAgICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnc2NyZWVucycsIHBhcmVudElkLCAncGFuZWwnLCAnbGF5b3V0J10sIHVwZGF0ZWRBcHBDb25maWcuc2NyZWVuc1twYXJlbnRJZF0ucGFuZWwubGF5b3V0LndpdGhvdXQoc2l6ZU1vZGUpKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBMYXlvdXRQYXJlbnRUeXBlLldpZGdldDpcbiAgICAgICAgY29uc3Qgd2lkZ2V0SnNvbiA9IHVwZGF0ZWRBcHBDb25maWcud2lkZ2V0c1twYXJlbnRJZF1cbiAgICAgICAgT2JqZWN0LmtleXMod2lkZ2V0SnNvbi5sYXlvdXRzKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgIGNvbnN0IGxheW91dHMgPSB3aWRnZXRKc29uLmxheW91dHNbbmFtZV1cbiAgICAgICAgICBpZiAobGF5b3V0c1tzaXplTW9kZV0gPT09IGxheW91dElkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdyZW1vdmUgbGF5b3V0JywgbGF5b3V0SWQsICdmcm9tIHdpZGdldCcsIHBhcmVudElkLCAnLCBpbiBzaXplIG1vZGUnLCBzaXplTW9kZSlcbiAgICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIHBhcmVudElkLCAnbGF5b3V0cycsIG5hbWVdLCBsYXlvdXRzLndpdGhvdXQoc2l6ZU1vZGUpKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxuXG4gIHJlcGxhY2VMYXlvdXRJZEluUGFyZW50IChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIHBhcmVudEluZm86IHsgdHlwZTogTGF5b3V0UGFyZW50VHlwZSwgaWQ6IHN0cmluZyB9LFxuICAgIG9sZExheW91dElkOiBzdHJpbmcsXG4gICAgbmV3TGF5b3V0SWQ6IHN0cmluZyxcbiAgICBzaXplTW9kZTogQnJvd3NlclNpemVNb2RlXG4gICk6IElNQXBwQ29uZmlnIHtcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICAgIC8vIHVwZGF0ZSBwYXJlbnQsIG9ubHkgc29tZSBvZiB0aGUgdHlwZSBjYW4gY2hvb3NlIHRlbXBsYXRlXG4gICAgY29uc29sZS5kZWJ1ZygncmVwbGFjZSBsYXlvdXQnLCBvbGRMYXlvdXRJZCwgJ3dpdGggbmV3IG9uZScsIG5ld0xheW91dElkLCAnaW4gcGFyZW50JywgcGFyZW50SW5mby5pZCwgc2l6ZU1vZGUpXG4gICAgc3dpdGNoIChwYXJlbnRJbmZvLnR5cGUpIHtcbiAgICAgIGNhc2UgTGF5b3V0UGFyZW50VHlwZS5IZWFkZXI6XG4gICAgICAgIGlmICh1cGRhdGVkQXBwQ29uZmlnLmhlYWRlci5sYXlvdXRbc2l6ZU1vZGVdID09PSBvbGRMYXlvdXRJZCkge1xuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnaGVhZGVyJywgJ2xheW91dCcsIHNpemVNb2RlXSwgbmV3TGF5b3V0SWQpXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgTGF5b3V0UGFyZW50VHlwZS5Gb290ZXI6XG4gICAgICAgIGlmICh1cGRhdGVkQXBwQ29uZmlnLmZvb3Rlci5sYXlvdXRbc2l6ZU1vZGVdID09PSBvbGRMYXlvdXRJZCkge1xuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnZm9vdGVyJywgJ2xheW91dCcsIHNpemVNb2RlXSwgbmV3TGF5b3V0SWQpXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgTGF5b3V0UGFyZW50VHlwZS5EaWFsb2c6XG4gICAgICAgIGlmICh1cGRhdGVkQXBwQ29uZmlnLmRpYWxvZ3NbcGFyZW50SW5mby5pZF0ubGF5b3V0W3NpemVNb2RlXSA9PT0gb2xkTGF5b3V0SWQpIHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2RpYWxvZ3MnLCBwYXJlbnRJbmZvLmlkLCAnbGF5b3V0Jywgc2l6ZU1vZGVdLCBuZXdMYXlvdXRJZClcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBMYXlvdXRQYXJlbnRUeXBlLlBhZ2U6XG4gICAgICAgIGlmICh1cGRhdGVkQXBwQ29uZmlnLnBhZ2VzW3BhcmVudEluZm8uaWRdLmxheW91dFtzaXplTW9kZV0gPT09IG9sZExheW91dElkKSB7XG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydwYWdlcycsIHBhcmVudEluZm8uaWQsICdsYXlvdXQnLCBzaXplTW9kZV0sIG5ld0xheW91dElkKVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIExheW91dFBhcmVudFR5cGUuV2lkZ2V0OlxuICAgICAgICBjb25zdCB3aWRnZXRKc29uID0gdXBkYXRlZEFwcENvbmZpZy53aWRnZXRzW3BhcmVudEluZm8uaWRdXG4gICAgICAgIGlmICh3aWRnZXRKc29uKSB7XG4gICAgICAgICAgT2JqZWN0LmtleXMod2lkZ2V0SnNvbi5sYXlvdXRzKS5zb21lKG5hbWUgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2l6ZU1vZGVMYXlvdXRzID0gd2lkZ2V0SnNvbi5sYXlvdXRzW25hbWVdXG4gICAgICAgICAgICBpZiAoc2l6ZU1vZGVMYXlvdXRzW3NpemVNb2RlXSA9PT0gb2xkTGF5b3V0SWQpIHtcbiAgICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgcGFyZW50SW5mby5pZCwgJ2xheW91dHMnLCBuYW1lLCBzaXplTW9kZV0sIG5ld0xheW91dElkKVxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgdHJhbnNmb3JtTGF5b3V0IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRKc29uOiBJTUxheW91dEpzb24sIGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLCB0b1NpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUpOiBJTUxheW91dEpzb24ge1xuICAgIGxldCBleHRNYW5hZ2VyOiBFeHRlbnNpb25NYW5hZ2VyXG4gICAgaWYgKHdpbmRvdy5qaW11Q29uZmlnLmlzQnVpbGRlcikge1xuICAgICAgLy8gYmVjYXVzZSB3aWRnZXQncyBleHRlbnNpb25zIGFyZSByZWdpc3RlcmVkIGluIGFwcCBvbmx5LCBzbyB3ZSBuZWVkIHRvIGdldCB0aGUgZXh0ZW5zaW9uIG1hbmFnZXIgZnJvbSBhcHBcbiAgICAgIGV4dE1hbmFnZXIgPSB3aW5kb3cuX2FwcFdpbmRvdyAmJiB3aW5kb3cuX2FwcFdpbmRvdy5fZXh0ZW5zaW9uTWFuYWdlclxuICAgIH0gZWxzZSB7XG4gICAgICBleHRNYW5hZ2VyID0gRXh0ZW5zaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpXG4gICAgfVxuICAgIGNvbnN0IGV4dHMgPSBleHRNYW5hZ2VyLmdldEV4dGVuc2lvbnMoZXh0ZW5zaW9uU3BlYy5FeHRlbnNpb25Qb2ludHMuTGF5b3V0VHJhbnNmb3JtZXIpXG5cbiAgICBpZiAoZXh0cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBleHQ6IGV4dGVuc2lvblNwZWMuTGF5b3V0VHJhbnNmb3JtZXJFeHRlbnNpb24gPSBleHRzLmZpbmQoXG4gICAgICAgIChleHQpID0+IChleHQgYXMgZXh0ZW5zaW9uU3BlYy5MYXlvdXRUcmFuc2Zvcm1lckV4dGVuc2lvbikubGF5b3V0VHlwZSA9PT0gbGF5b3V0SnNvbi50eXBlXG4gICAgICApIGFzIGV4dGVuc2lvblNwZWMuTGF5b3V0VHJhbnNmb3JtZXJFeHRlbnNpb25cbiAgICAgIGlmIChleHQgJiYgZXh0LnRyYW5zZm9ybUxheW91dCkge1xuICAgICAgICBsYXlvdXRKc29uID0gZXh0LnRyYW5zZm9ybUxheW91dChsYXlvdXRKc29uLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUsIGFwcENvbmZpZylcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGxheW91dEpzb25cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgYmxhbmsgbGF5b3V0IGl0ZW0gaW4gdGhlIGdpdmVuIGxheW91dC4gT25seSBpZCBpcyBzZXQgaW4gdGhlIG5ldyBsYXlvdXQgaXRlbS5cbiAgICogQHBhcmFtIGFwcENvbmZpZ1xuICAgKiBAcGFyYW0gbGF5b3V0SWRcbiAgICogQHJldHVybnNcbiAgICovXG4gIGNyZWF0ZUJsYW5rSXRlbSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbGF5b3V0SWQ6IHN0cmluZyk6IFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRJdGVtSWQ6IHN0cmluZ10ge1xuICAgIGNvbnN0IG5leHRMYXlvdXRJdGVtSWQgPSBgJHtsYXlvdXRVdGlscy5nZXRNYXhpbXVtSWQoYXBwQ29uZmlnLmxheW91dHNbbGF5b3V0SWRdKSArIDF9YFxuICAgIGNvbnN0IG5ld0xheW91dEl0ZW0gPSB7XG4gICAgICBpZDogbmV4dExheW91dEl0ZW1JZFxuICAgIH1cbiAgICBjb25zdCB1cGRhdGVkQ29uZmlnID0gYXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIGxheW91dElkLCAnY29udGVudCcsIG5leHRMYXlvdXRJdGVtSWRdLCBuZXdMYXlvdXRJdGVtKVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQ29uZmlnLCBuZXh0TGF5b3V0SXRlbUlkXVxuICB9XG5cbiAgZHVwbGljYXRlSXRlbUluU2FtZUxheW91dCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dFxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbGF5b3V0SXRlbUlkOiBzdHJpbmddIHtcbiAgICBjb25zdCB7IGxheW91dElkLCBsYXlvdXRJdGVtSWQgfSA9IGxheW91dEluZm9cbiAgICBpZiAoIWFwcENvbmZpZy5sYXlvdXRzIHx8ICFhcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF0pIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ2R1cGxpY2F0ZSBsYXlvdXQgaXRlbScsIGxheW91dElkLCBsYXlvdXRJdGVtSWQsICdpbiBzaXplIG1vZGUnLCBzaXplTW9kZSlcbiAgICBjb25zdCBvcmlMYXlvdXRJdGVtID0gc2VhcmNoVXRpbHMuZmluZExheW91dEl0ZW0oYXBwQ29uZmlnLCB7XG4gICAgICBsYXlvdXRJZDogbGF5b3V0SWQsXG4gICAgICBsYXlvdXRJdGVtSWQ6IGxheW91dEl0ZW1JZFxuICAgIH0pXG5cbiAgICBjb25zdCBuZXdJdGVtSWQgPSBgJHtsYXlvdXRVdGlscy5nZXRNYXhpbXVtSWQoYXBwQ29uZmlnLmxheW91dHNbbGF5b3V0SWRdKSArIDF9YFxuICAgIGNvbnN0IG5ld0l0ZW0gPSBvcmlMYXlvdXRJdGVtLnNldCgnaWQnLCBuZXdJdGVtSWQpXG5cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICAgICAgLnNldEluKFsnbGF5b3V0cycsIGxheW91dElkLCAnY29udGVudCcsIG5ld0l0ZW0uaWRdLCBuZXdJdGVtKVxuXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMuZHVwbGljYXRlQW5kUmVwbGFjZUNvbnRlbnQoXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgeyBsYXlvdXRJZCwgbGF5b3V0SXRlbUlkIH0sXG4gICAgICB7IGxheW91dElkLCBsYXlvdXRJdGVtSWQ6IG5ld0l0ZW0uaWQgfSxcbiAgICAgIHNpemVNb2RlLFxuICAgICAgc2l6ZU1vZGUsXG4gICAgICBjb250ZXh0XG4gICAgKVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBuZXdJdGVtLmlkXVxuICB9XG5cbiAgcGVuZEl0ZW0gKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGxheW91dEluZm86IExheW91dEluZm8pOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3QgbGF5b3V0SXRlbSA9IHNlYXJjaFV0aWxzLmZpbmRMYXlvdXRJdGVtKGFwcENvbmZpZywgbGF5b3V0SW5mbylcbiAgICBjb25zdCB7IGxheW91dElkLCBsYXlvdXRJdGVtSWQgfSA9IGxheW91dEluZm9cbiAgICBsZXQgdXBkYXRlZENvbmZpZyA9IGFwcENvbmZpZ1xuICAgIGlmIChsYXlvdXRJdGVtKSB7XG4gICAgICB1cGRhdGVkQ29uZmlnID0gYXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIGxheW91dElkLCAnY29udGVudCcsIGxheW91dEl0ZW1JZCwgJ2lzUGVuZGluZyddLCB0cnVlKVxuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlZENvbmZpZ1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIGxheW91dCBpdGVtLiBJdCBoYXMgbXVsdGlwbGUgdXNlIGNhc2VzOlxuICAgKiAtIGRvIG5vdCByZW1vdmUgY29udGVudC4gT25seSByZW1vdmUgdGhlIGxheW91dCBpdGVtIGZyb20gdGhlIGxheW91dCBhbmQgcmVtb3ZlIGlmIGZyb20gaXRzIGNvbnRlbnQgcGFyZW50LlxuICAgKiAgIC0gd2hlbiBhIHdpZGdldCB3aWxsIGJlIHJlbW92ZWQsIGl0cyBwYXJlbnQgbGF5b3V0IGl0ZW1zIHNob3VsZCBiZSByZW1vdmVkIGFoZWFkIG9mIGl0LlxuICAgKiAtIHJlbW92ZSBjb250ZW50LlxuICAgKiAgIC0gZm9yY2UgaXMgZmFsc2UuIFRyeSB0byByZW1vdmUgdGhlIGNvbnRlbnQuIElmIHRoZSBjb250ZW50IGlzIHVzZWQgYnkgb3RoZXIgbGF5b3V0IGl0ZW1zLCBkbyBub3QgcmVtb3ZlIGl0LlxuICAgKiAgIC0gZm9yY2UgaXMgdHJ1ZS4gUmVtb3ZlIHRoZSBjb250ZW50IGRpcmVjdGx5LlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBsYXlvdXRJbmZvXG4gICAqIEBwYXJhbSBzaXplTW9kZVxuICAgKiBAcGFyYW0gcmVtb3ZlQ29udGVudFxuICAgKiBAcGFyYW0gZm9yY2VcbiAgICovXG4gIHJlbW92ZUl0ZW0gKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgbGF5b3V0SW5mbzogTGF5b3V0SW5mbyxcbiAgICBzaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIHJlbW92ZUNvbnRlbnQ6IGJvb2xlYW4sXG4gICAgZm9yY2U/OiBib29sZWFuXG4gICk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCB7IGxheW91dElkLCBsYXlvdXRJdGVtSWQgfSA9IGxheW91dEluZm9cbiAgICBjb25zdCBsYXlvdXRJdGVtID0gc2VhcmNoVXRpbHMuZmluZExheW91dEl0ZW0oYXBwQ29uZmlnLCBsYXlvdXRJbmZvKVxuXG4gICAgaWYgKCFsYXlvdXRJdGVtKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuXG4gICAgY29uc29sZS5kZWJ1ZyhgcmVtb3ZlIGxheW91dCBpdGVtLCAke2xheW91dElkfSAke2xheW91dEl0ZW1JZH0sIHJlbW92ZUNvbnRlbnQ9JHtyZW1vdmVDb250ZW50fSwgZm9yY2U9JHtmb3JjZX1gKVxuICAgIC8vIDAuIGNhbGwgYmVmb3JlSXRlbVJlbW92ZWQgaWYgYW55XG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLmJlZm9yZUl0ZW1SZW1vdmVkKGFwcENvbmZpZywgbGF5b3V0SW5mbylcblxuICAgIC8vIDEuIHJlbW92ZSBjb250ZW50IGlmIG5lZWRlZFxuICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgQ29udGVudFNlcnZpY2VXcmFwcGVyKHVwZGF0ZWRBcHBDb25maWcsIGxheW91dEl0ZW0pXG4gICAgaWYgKHJlbW92ZUNvbnRlbnQpIHtcbiAgICAgIGlmIChmb3JjZSkge1xuICAgICAgICBzZXJ2aWNlLnJlbW92ZSgpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXJ2aWNlLnRyeVJlbW92ZShsYXlvdXRJbmZvLCBzaXplTW9kZSlcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc2VydmljZS5yZW1vdmVQYXJlbnQobGF5b3V0SW5mbywgc2l6ZU1vZGUpXG4gICAgfVxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSBzZXJ2aWNlLmdldENvbmZpZygpXG5cbiAgICAvLyAyLiByZW1vdmUgbGF5b3V0IGl0ZW1cbiAgICBjb25zdCBsb2NrTGF5b3V0ID0gYXBwQ29uZmlnLmZvckJ1aWxkZXJBdHRyaWJ1dGVzPy5sb2NrTGF5b3V0ID8/IGZhbHNlXG5cbiAgICBpZiAobG9ja0xheW91dCkge1xuICAgICAgaWYgKGxheW91dEl0ZW0udHlwZSA9PT0gTGF5b3V0SXRlbVR5cGUuV2lkZ2V0ICYmIGxheW91dEl0ZW0ud2lkZ2V0SWQpIHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SWQsICdjb250ZW50JywgbGF5b3V0SXRlbUlkXSwgbGF5b3V0SXRlbS53aXRob3V0KCd3aWRnZXRJZCcpKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsYXlvdXRKc29uID0gdXBkYXRlZEFwcENvbmZpZy5sYXlvdXRzW2xheW91dElkXVxuICAgICAgaWYgKGxheW91dEpzb24pIHsgLy8gbGF5b3V0IG1heSBiZSByZW1vdmVkIGlmIGl0J3MgYSBibGFuayBibG9jayBpbiBmbG93IGxheW91dFxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ2NvbnRlbnQnXSwgbGF5b3V0SnNvbi5jb250ZW50LndpdGhvdXQobGF5b3V0SXRlbUlkKSlcbiAgICAgIH1cbiAgICAgIC8vIDMuIGFmdGVyIHJlbW92ZWRcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLmFmdGVySXRlbVJlbW92ZWQodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SW5mbylcbiAgICB9XG5cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgLyoqXG4gICAqIENob29zZSBhIHRlbXBsYXRlIHRvIHJlcGxhY2UgdGhlIGxheW91dC5cbiAgICogMS4gaWYgY3VycmVudCBzaXplIG1vZGUgaXMgbWFpbiBzaXplIG1vZGUsIHJlcGxhY2Ugb3RoZXIgc2l6ZSBtb2RlIGxheW91dCBpZiBpdCBpcyBub3Qgc2V0LlxuICAgKiAyLiBpZiBjdXJyZW50IHNpemUgbW9kZSBpcyBub3QgbWFpbiBzaXplIG1vZGUsIG9ubHkgcmVwbGFjZSBjdXJyZW50IHNpemUgbW9kZSBsYXlvdXQuXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIHRhcmdldFNpemVNb2RlTGF5b3V0XG4gICAqIEBwYXJhbSB0ZW1wbGF0ZVBhZ2VKc29uXG4gICAqIEBwYXJhbSBzb3VyY2VTaXplTW9kZUxheW91dFxuICAgKiBAcGFyYW0gY3VycmVudFNpemVNb2RlXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBhc3luYyByZXBsYWNlU2l6ZU1vZGVMYXlvdXQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgdGFyZ2V0U2l6ZU1vZGVMYXlvdXQ6IElNU2l6ZU1vZGVMYXlvdXRKc29uLFxuICAgIHRlbXBsYXRlUGFnZUpzb246IFRlbXBsYXRlLFxuICAgIHNvdXJjZVNpemVNb2RlTGF5b3V0OiBJTVNpemVNb2RlTGF5b3V0SnNvbixcbiAgICBjdXJyZW50U2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBwYXJlbnRUeXBlOiBMYXlvdXRQYXJlbnRUeXBlLFxuICAgIHBhcmVudElkOiBzdHJpbmcsXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dFxuICApOiBQcm9taXNlPFthcHBDb25maWc6IElNQXBwQ29uZmlnLCB1cGRhdGVkU2l6ZU1vZGVMYXlvdXQ6IElNU2l6ZU1vZGVMYXlvdXRKc29uXT4ge1xuICAgIGlmICghc291cmNlU2l6ZU1vZGVMYXlvdXQpIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCB0YXJnZXRTaXplTW9kZUxheW91dF1cbiAgICB9XG5cbiAgICBjb25zdCBpc01haW5TaXplTW9kZSA9IGN1cnJlbnRTaXplTW9kZSA9PT0gYXBwQ29uZmlnLm1haW5TaXplTW9kZVxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgbGV0IHVwZGF0ZWRTaXplTW9kZUxheW91dCA9IHRhcmdldFNpemVNb2RlTGF5b3V0XG4gICAgbGV0IHNpemVtb2RlS2V5c1xuXG4gICAgaWYgKGlzTWFpblNpemVNb2RlKSB7XG4gICAgICBzaXplbW9kZUtleXMgPSBPYmplY3Qua2V5cyhzb3VyY2VTaXplTW9kZUxheW91dCkuZmlsdGVyKGtleSA9PiBrZXkgPT09IGN1cnJlbnRTaXplTW9kZSB8fCB0YXJnZXRTaXplTW9kZUxheW91dFtrZXldID09IG51bGwpXG4gICAgfSBlbHNlIHtcbiAgICAgIHNpemVtb2RlS2V5cyA9IFtjdXJyZW50U2l6ZU1vZGVdXG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplbW9kZUtleXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIGNvbnN0IHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUgPSBzaXplbW9kZUtleXNbaV0gYXMgQnJvd3NlclNpemVNb2RlXG5cbiAgICAgIGNvbnN0IGxheW91dFJlc3VsdCA9IGF3YWl0IHRoaXMucmVwbGFjZUxheW91dChcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyxcbiAgICAgICAgdXBkYXRlZFNpemVNb2RlTGF5b3V0W3NpemVNb2RlXSxcbiAgICAgICAgdGVtcGxhdGVQYWdlSnNvbixcbiAgICAgICAgc291cmNlU2l6ZU1vZGVMYXlvdXRbc2l6ZU1vZGVdLFxuICAgICAgICBzaXplTW9kZSxcbiAgICAgICAgcGFyZW50VHlwZSxcbiAgICAgICAgcGFyZW50SWQsXG4gICAgICAgIGNvbnRleHRcbiAgICAgIClcbiAgICAgIGlmIChsYXlvdXRSZXN1bHRbMV0pIHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IGxheW91dFJlc3VsdFswXVxuICAgICAgICB1cGRhdGVkU2l6ZU1vZGVMYXlvdXQgPSB1cGRhdGVkU2l6ZU1vZGVMYXlvdXQuc2V0KHNpemVNb2RlLCBsYXlvdXRSZXN1bHRbMV0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gcmVwbGFjZSBjdXJyZW50IHNpemUgbW9kZSBsYXlvdXQgdXNpbmcgbWFpbiBzaXplIG1vZGUgaWYgaXQgaXMgbm90IHNldFxuICAgIGlmIChzb3VyY2VTaXplTW9kZUxheW91dFtjdXJyZW50U2l6ZU1vZGVdID09IG51bGwpIHtcbiAgICAgIC8vIG5vIHRlbXBsYXRlIGRlZmluZWQgZm9yIGN1cnJlbnQgc2l6ZSBtb2RlXG4gICAgICBjb25zdCBsYXlvdXRSZXN1bHQgPSBhd2FpdCB0aGlzLnJlcGxhY2VMYXlvdXQoXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcsXG4gICAgICAgIHVwZGF0ZWRTaXplTW9kZUxheW91dFtjdXJyZW50U2l6ZU1vZGVdLFxuICAgICAgICB0ZW1wbGF0ZVBhZ2VKc29uLFxuICAgICAgICBzb3VyY2VTaXplTW9kZUxheW91dFt1cGRhdGVkQXBwQ29uZmlnLm1haW5TaXplTW9kZV0sXG4gICAgICAgIGN1cnJlbnRTaXplTW9kZSxcbiAgICAgICAgcGFyZW50VHlwZSxcbiAgICAgICAgcGFyZW50SWQsXG4gICAgICAgIGNvbnRleHRcbiAgICAgIClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBsYXlvdXRSZXN1bHRbMF1cbiAgICAgIHVwZGF0ZWRTaXplTW9kZUxheW91dCA9IHVwZGF0ZWRTaXplTW9kZUxheW91dC5zZXQoY3VycmVudFNpemVNb2RlLCBsYXlvdXRSZXN1bHRbMV0pXG4gICAgfVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCB1cGRhdGVkU2l6ZU1vZGVMYXlvdXRdXG4gIH1cblxuICAvKipcbiAgICogVXNlIHRoZSBsYXlvdXQgaW4gc291cmNlTGF5b3V0IHRvIHJlcGxhY2UgdGhlIHRhcmdldExheW91dFxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSB0YXJnZXRMYXlvdXRJZFxuICAgKiBAcGFyYW0gdGVtcGxhdGVQYWdlSnNvblxuICAgKiBAcGFyYW0gc291cmNlTGF5b3V0SWRcbiAgICogQHBhcmFtIGJyb3dzZXJTaXplTW9kZVxuICAgKi9cbiAgYXN5bmMgcmVwbGFjZUxheW91dCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICB0YXJnZXRMYXlvdXRJZDogc3RyaW5nLFxuICAgIHRlbXBsYXRlUGFnZUpzb246IFRlbXBsYXRlLFxuICAgIHNvdXJjZUxheW91dElkOiBzdHJpbmcsXG4gICAgc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBwYXJlbnRUeXBlOiBMYXlvdXRQYXJlbnRUeXBlLFxuICAgIHBhcmVudElkOiBzdHJpbmcsXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dFxuICApOiBQcm9taXNlPFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdMYXlvdXRJZDogc3RyaW5nXT4ge1xuICAgIGlmICh0ZW1wbGF0ZVBhZ2VKc29uLmNvbmZpZz8ubGF5b3V0cz8uW3NvdXJjZUxheW91dElkXSA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gW2FwcENvbmZpZywgbnVsbF1cbiAgICB9XG5cbiAgICBjb25zb2xlLmRlYnVnKGByZXBsYWNlICR7dGFyZ2V0TGF5b3V0SWR9IHdpdGggdGVtcGxhdGUgJHtzb3VyY2VMYXlvdXRJZH0gaW4gJHtzaXplTW9kZX1gKVxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG5cbiAgICBpZiAoYXBwQ29uZmlnLmxheW91dHM/Llt0YXJnZXRMYXlvdXRJZF0pIHtcbiAgICAgIGNvbnN0IHRhcmdldExheW91dCA9IGFwcENvbmZpZy5sYXlvdXRzW3RhcmdldExheW91dElkXVxuICAgICAgaWYgKHRhcmdldExheW91dD8uY29udGVudCAmJiBPYmplY3Qua2V5cyh0YXJnZXRMYXlvdXQuY29udGVudCkubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBEbyBub3QgcmVwbGFjZSBub24tZW1wdHkgbGF5b3V0XG4gICAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgICAgfVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0KCdsYXlvdXRzJywgdXBkYXRlZEFwcENvbmZpZy5sYXlvdXRzLndpdGhvdXQodGFyZ2V0TGF5b3V0SWQpKVxuICAgIH1cblxuICAgIC8vIHRhcmdldCBsYXlvdXQgZG9lcyBub3QgZXhpc3QsIGNyZWF0ZSBvbmUgZm9yIGl0XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jcmVhdGVMYXlvdXRGcm9tVGVtcGxhdGUoXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgdGVtcGxhdGVQYWdlSnNvbixcbiAgICAgIHNvdXJjZUxheW91dElkLFxuICAgICAgc2l6ZU1vZGUsXG4gICAgICBwYXJlbnRUeXBlLFxuICAgICAgcGFyZW50SWQsXG4gICAgICBjb250ZXh0XG4gICAgKVxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICBjb25zdCBuZXdMYXlvdXRJZCA9IHJlc3VsdFsxXVxuXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMucmVwbGFjZUxheW91dElkSW5QYXJlbnQoXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgeyB0eXBlOiBwYXJlbnRUeXBlLCBpZDogcGFyZW50SWQgfSxcbiAgICAgIHRhcmdldExheW91dElkLFxuICAgICAgbmV3TGF5b3V0SWQsXG4gICAgICBzaXplTW9kZVxuICAgIClcblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV3TGF5b3V0SWRdXG4gIH1cblxuICBhc3luYyBjcmVhdGVMYXlvdXRGcm9tVGVtcGxhdGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgdGVtcGxhdGVKc29uOiBUZW1wbGF0ZSxcbiAgICBsYXlvdXRJZDogc3RyaW5nLFxuICAgIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgcGFyZW50VHlwZTogTGF5b3V0UGFyZW50VHlwZSxcbiAgICBwYXJlbnRJZDogc3RyaW5nLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogUHJvbWlzZTxbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbmV3TGF5b3V0SWQ6IHN0cmluZ10+IHtcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuXG4gICAgYXdhaXQgbWFrZVN1cmVUZW1wbGF0ZUNvbmZpZyh0ZW1wbGF0ZUpzb24pXG5cbiAgICBjb25zb2xlLmRlYnVnKCdjcmVhdGUgbGF5b3V0JywgbGF5b3V0SWQsICdmcm9tIHRlbXBsYXRlJylcbiAgICBjb25zdCB0ZW1wbGF0ZUNvbmZpZyA9IHRlbXBsYXRlSnNvbi5jb25maWdcbiAgICBjb25zdCB0ZW1wbGF0ZUxheW91dCA9IHRlbXBsYXRlQ29uZmlnLmxheW91dHNbbGF5b3V0SWRdXG4gICAgY29uc3QgbmV4dExheW91dElkID0gYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnbGF5b3V0JylcblxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIG5leHRMYXlvdXRJZF0sIHRlbXBsYXRlTGF5b3V0KVxuICAgICAgLnNldEluKFsnbGF5b3V0cycsIG5leHRMYXlvdXRJZCwgJ2lkJ10sIG5leHRMYXlvdXRJZClcbiAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBuZXh0TGF5b3V0SWQsICdwYXJlbnQnXSwgeyB0eXBlOiBwYXJlbnRUeXBlLCBpZDogcGFyZW50SWQgfSlcblxuICAgIGNvbnN0IGl0ZW1zID0gdGVtcGxhdGVMYXlvdXQudHlwZSA9PT0gTGF5b3V0VHlwZS5HcmlkTGF5b3V0XG4gICAgICA/IE9iamVjdC5rZXlzKHRlbXBsYXRlTGF5b3V0LmNvbnRlbnQgfHwge30pXG4gICAgICA6ICh0ZW1wbGF0ZUxheW91dC5vcmRlciA/PyBbXSlcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpdGVtSWQgPSBpdGVtc1tpXVxuICAgICAgY29uc3QgbGF5b3V0SXRlbSA9IHRlbXBsYXRlTGF5b3V0LmNvbnRlbnRbaXRlbUlkXVxuXG4gICAgICBjb25zdCBzZXJ2aWNlID0gbmV3IENvbnRlbnRTZXJ2aWNlV3JhcHBlcih1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRJdGVtKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVGcm9tVGVtcGxhdGUodGVtcGxhdGVKc29uLCBbc2l6ZU1vZGVdLCBjb250ZXh0LCB7IGlzQmxvY2s6IHRlbXBsYXRlTGF5b3V0LnR5cGUgPT09IExheW91dFR5cGUuRmxvd0xheW91dCB9KVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgY29uc3QgbmV3Q29udGVudElkID0gcmVzdWx0WzFdXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gZW1wdHlDb250ZW50U2VydmljZS5zZXRDb250ZW50SWQodXBkYXRlZEFwcENvbmZpZywgeyBsYXlvdXRJZDogbmV4dExheW91dElkLCBsYXlvdXRJdGVtSWQ6IGl0ZW1JZCB9LCBuZXdDb250ZW50SWQsIHNpemVNb2RlKVxuICAgIH1cblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV4dExheW91dElkXVxuICB9XG5cbiAgLy8gcHJvdmlkZWQgYnkgc3ViY2xhc3NcbiAgZ2V0VG9jU3RydWN0dXJlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRJZDogc3RyaW5nKTogVG9jTm9kZVtdIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLy8gc2hvdWxkIGJlIGludm9rZWQgYnkgdGhlIGxheW91dCBzZXJ2aWNlIG9mIHRoZSB0b0xheW91dElkXG4gIG1vdmVMYXlvdXRJdGVtIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGZyb21MYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIHRvTGF5b3V0SWQ6IHN0cmluZyxcbiAgICBmcm9tU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICB0b1NpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGVcbiAgKTogW0lNQXBwQ29uZmlnLCBMYXlvdXRJbmZvXSB7XG4gICAgY29uc3QgbW92aW5nTGF5b3V0SXRlbSA9IHNlYXJjaFV0aWxzLmZpbmRMYXlvdXRJdGVtKGFwcENvbmZpZywgZnJvbUxheW91dEluZm8pXG4gICAgaWYgKCFtb3ZpbmdMYXlvdXRJdGVtKSB7XG4gICAgICByZXR1cm4gW2FwcENvbmZpZywgbnVsbF1cbiAgICB9XG5cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICAgIGNvbnN0IGZyb21MYXlvdXQgPSBhcHBDb25maWcubGF5b3V0c1tmcm9tTGF5b3V0SW5mby5sYXlvdXRJZF1cbiAgICBjb25zdCBmcm9tTGF5b3V0SXRlbSA9IHNlYXJjaFV0aWxzLmZpbmRMYXlvdXRJdGVtKHVwZGF0ZWRBcHBDb25maWcsIGZyb21MYXlvdXRJbmZvKVxuXG4gICAgLy8gMS4gcGVuZGVkIGl0ZW0gaGFzIGJlZW4gZGV0YWNoZWQgZnJvbSB0aGUgZ3JpZFxuICAgIC8vIDIuIG1vdmUgdG8gZGlmZmVyZW50IHNpemUgbW9kZSBkb2VzIG5vdCBjaGFuZ2UgdGhlIGZyb21TaXplTW9kZSBsYXlvdXQuIGUuZy4sIGFkZCBmcm9tIHRoZSBwZW5kaW5nIGxpc3RcbiAgICBpZiAoZnJvbUxheW91dC50eXBlID09PSBMYXlvdXRUeXBlLkdyaWRMYXlvdXQgJiYgIWZyb21MYXlvdXRJdGVtLmlzUGVuZGluZyAmJiBmcm9tU2l6ZU1vZGUgPT09IHRvU2l6ZU1vZGUpIHtcbiAgICAgIC8vIGdyaWQgbGF5b3V0IGlzIGEgc3BlY2lhbCBvbmUsIGl0IGhhcyBzb21lIG5vbi1jb250ZW50IGxheW91dCBpdGVtcywgc3VjaCBhcyByb3csIGNvbHVtbiwgZXRjLlxuICAgICAgY29uc3QgZ3JpZFNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0SW5zdGFuY2UoKS5nZXRTZXJ2aWNlQnlUeXBlKExheW91dFR5cGUuR3JpZExheW91dClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBncmlkU2VydmljZS5iZWZvcmVJdGVtUmVtb3ZlZCh1cGRhdGVkQXBwQ29uZmlnLCBmcm9tTGF5b3V0SW5mbylcbiAgICB9XG5cbiAgICBjb25zb2xlLmRlYnVnKCdtb3ZlIGxheW91dCBpdGVtIGZyb20nLCBmcm9tTGF5b3V0SW5mby5sYXlvdXRJZCwgZnJvbUxheW91dEluZm8ubGF5b3V0SXRlbUlkLCAndG8nLCB0b0xheW91dElkLCB0b1NpemVNb2RlKVxuICAgIGlmIChmcm9tTGF5b3V0SXRlbS5pc1BlbmRpbmcgJiYgZnJvbVNpemVNb2RlID09PSB0b1NpemVNb2RlKSB7XG4gICAgICAvLyBtYWtlIHN1cmUgaXQgY2FuIGJlIGFkZGVkIGJhY2sgdG8gaXRzIG9yaWdpbmFsIGxheW91dFxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oXG4gICAgICAgIFsnbGF5b3V0cycsIGZyb21MYXlvdXRJbmZvLmxheW91dElkLCAnY29udGVudCcsIGZyb21MYXlvdXRJbmZvLmxheW91dEl0ZW1JZF0sXG4gICAgICAgIGZyb21MYXlvdXRJdGVtLndpdGhvdXQoJ2lzUGVuZGluZycpXG4gICAgICApXG4gICAgfVxuICAgIGlmIChmcm9tTGF5b3V0SW5mby5sYXlvdXRJZCAhPT0gdG9MYXlvdXRJZCkge1xuICAgICAgY29uc3QgZnJvbUxheW91dFNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh1cGRhdGVkQXBwQ29uZmlnLCBmcm9tTGF5b3V0SW5mby5sYXlvdXRJZClcbiAgICAgIC8vIG9ubHkgcmVtb3ZlIHRhcmdldCBmcm9tIGl0cyBwYXJlbnQgaWYgaXQgaXMgZnJvbSB0aGUgc2FtZSBzaXplIG1vZGVcbiAgICAgIGlmIChmcm9tU2l6ZU1vZGUgPT09IHRvU2l6ZU1vZGUpIHtcbiAgICAgICAgbGV0IHBhcmVudExheW91dEluZm9zOiBbTGF5b3V0SW5mb10gfCBJbW11dGFibGVBcnJheTxMYXlvdXRJbmZvPiA9IFtmcm9tTGF5b3V0SW5mb11cbiAgICAgICAgaWYgKGZyb21MYXlvdXRJdGVtLnR5cGUgPT09IExheW91dEl0ZW1UeXBlLldpZGdldCkge1xuICAgICAgICAgIGNvbnN0IHdpZGdldEpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLndpZGdldHNbZnJvbUxheW91dEl0ZW0ud2lkZ2V0SWRdXG4gICAgICAgICAgaWYgKHdpZGdldEpzb24gJiYgd2lkZ2V0SnNvbi5wYXJlbnQ/Lltmcm9tU2l6ZU1vZGVdPy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBwYXJlbnRMYXlvdXRJbmZvcyA9IHdpZGdldEpzb24ucGFyZW50W2Zyb21TaXplTW9kZV1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZnJvbUxheW91dEl0ZW0udHlwZSA9PT0gTGF5b3V0SXRlbVR5cGUuU2VjdGlvbikge1xuICAgICAgICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gdXBkYXRlZEFwcENvbmZpZy5zZWN0aW9uc1tmcm9tTGF5b3V0SXRlbS5zZWN0aW9uSWRdXG4gICAgICAgICAgaWYgKHNlY3Rpb25Kc29uLnBhcmVudD8uW2Zyb21TaXplTW9kZV0/Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHBhcmVudExheW91dEluZm9zID0gc2VjdGlvbkpzb24ucGFyZW50W2Zyb21TaXplTW9kZV1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50TGF5b3V0SW5mb3MuZm9yRWFjaChwYXJlbnRMYXlvdXRJbmZvID0+IHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gZnJvbUxheW91dFNlcnZpY2UucmVtb3ZlSXRlbSh1cGRhdGVkQXBwQ29uZmlnLCBwYXJlbnRMYXlvdXRJbmZvLCBmcm9tU2l6ZU1vZGUsIGZhbHNlKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgLy8gY3JlYXRlIGFuIGVtcHR5IGxheW91dFxuICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jcmVhdGVCbGFua0l0ZW0odXBkYXRlZEFwcENvbmZpZywgdG9MYXlvdXRJZClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgIGNvbnN0IG5ld0l0ZW1JZCA9IHJlc3VsdFsxXVxuXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2xheW91dHMnLCB0b0xheW91dElkLCAnY29udGVudCcsIG5ld0l0ZW1JZCwgJ3R5cGUnXSwgbW92aW5nTGF5b3V0SXRlbS50eXBlKVxuICAgICAgLy8gdXBkYXRlIHdpZGdldElkIG9yIHNlY3Rpb25JZFxuICAgICAgaWYgKG1vdmluZ0xheW91dEl0ZW0udHlwZSA9PT0gTGF5b3V0SXRlbVR5cGUuV2lkZ2V0KSB7XG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIHRvTGF5b3V0SWQsICdjb250ZW50JywgbmV3SXRlbUlkLCAnd2lkZ2V0SWQnXSwgbW92aW5nTGF5b3V0SXRlbS53aWRnZXRJZClcbiAgICAgIH0gZWxzZSBpZiAobW92aW5nTGF5b3V0SXRlbS50eXBlID09PSBMYXlvdXRJdGVtVHlwZS5TZWN0aW9uKSB7XG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnbGF5b3V0cycsIHRvTGF5b3V0SWQsICdjb250ZW50JywgbmV3SXRlbUlkLCAnc2VjdGlvbklkJ10sIG1vdmluZ0xheW91dEl0ZW0uc2VjdGlvbklkKVxuICAgICAgfVxuICAgICAgLy8gYWRkIHBhcmVudCBmb3IgdGhlIGNvbnRlbnRcbiAgICAgIGNvbnN0IG5ld0xheW91dEluZm8gPSB7IGxheW91dElkOiB0b0xheW91dElkLCBsYXlvdXRJdGVtSWQ6IG5ld0l0ZW1JZCB9XG4gICAgICBjb25zdCB0b0xheW91dEl0ZW0gPSBzZWFyY2hVdGlscy5maW5kTGF5b3V0SXRlbSh1cGRhdGVkQXBwQ29uZmlnLCBuZXdMYXlvdXRJbmZvKVxuICAgICAgY29uc3Qgc2VydmljZSA9IG5ldyBDb250ZW50U2VydmljZVdyYXBwZXIodXBkYXRlZEFwcENvbmZpZywgdG9MYXlvdXRJdGVtKVxuICAgICAgc2VydmljZS5hZGRQYXJlbnQobmV3TGF5b3V0SW5mbywgdG9TaXplTW9kZSlcbiAgICAgIC8vIHVwZGF0ZSBjb250ZW50IGFmdGVyIG1vdmVcbiAgICAgIGlmIChmcm9tU2l6ZU1vZGUgPT09IHRvU2l6ZU1vZGUpIHtcbiAgICAgICAgc2VydmljZS5hZnRlck1vdmVkKGZyb21MYXlvdXRJbmZvLmxheW91dElkLCB0b0xheW91dElkKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VydmljZS5hZnRlckFkZGVkKHRvTGF5b3V0SWQsIGZyb21TaXplTW9kZSwgdG9TaXplTW9kZSlcbiAgICAgIH1cbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBzZXJ2aWNlLmdldENvbmZpZygpXG5cbiAgICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV3TGF5b3V0SW5mb11cbiAgICB9XG5cbiAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIGZyb21MYXlvdXRJbmZvXVxuICB9XG5cbiAgYWZ0ZXJJdGVtQWRkZWQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgbGF5b3V0SW5mbzogTGF5b3V0SW5mbyxcbiAgICBmcm9tU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBjdXJyZW50U2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBvcHRpb25zPzogYW55XG4gICk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCBsYXlvdXRJdGVtID0gc2VhcmNoVXRpbHMuZmluZExheW91dEl0ZW0oYXBwQ29uZmlnLCBsYXlvdXRJbmZvKVxuICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgQ29udGVudFNlcnZpY2VXcmFwcGVyKGFwcENvbmZpZywgbGF5b3V0SXRlbSlcbiAgICBzZXJ2aWNlLmFmdGVyQWRkZWQobGF5b3V0SW5mby5sYXlvdXRJZCwgZnJvbVNpemVNb2RlLCBjdXJyZW50U2l6ZU1vZGUpXG5cbiAgICByZXR1cm4gc2VydmljZS5nZXRDb25maWcoKVxuICB9XG5cbiAgLy8gbm8gbmVlZCB0byBhZGQgYmVmb3JlSXRlbU1vdmVkLCB0aGUgbG9naWMgY2FuIGJlIGV4ZWN1dGVkIGluIGJlZm9yZUl0ZW1SZW1vdmVkXG5cbiAgYWZ0ZXJJdGVtTW92ZWQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGxheW91dEluZm86IExheW91dEluZm8sIHRvTGF5b3V0SWQ6IHN0cmluZyk6IElNQXBwQ29uZmlnIHtcbiAgICByZXR1cm4gYXBwQ29uZmlnXG4gIH1cblxuICBiZWZvcmVJdGVtUmVtb3ZlZCAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbGF5b3V0SW5mbzogTGF5b3V0SW5mbyk6IElNQXBwQ29uZmlnIHtcbiAgICByZXR1cm4gYXBwQ29uZmlnXG4gIH1cblxuICBhZnRlckl0ZW1SZW1vdmVkIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvKTogSU1BcHBDb25maWcge1xuICAgIHJldHVybiBhcHBDb25maWdcbiAgfVxuXG4gIGFic3RyYWN0IHByb2Nlc3NBZnRlckl0ZW1BZGRlZCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBkcmFnZ2luZ0l0ZW06IExheW91dEl0ZW1Db25zdHJ1Y3RvclByb3BzLFxuICAgIGxheW91dEluZm86IExheW91dEluZm8sXG4gICAgY3VycmVudFNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgY29udGFpbmVyUmVjdDogRE9NUmVjdFJlYWRPbmx5LFxuICAgIGl0ZW1SZWN0OiBET01SZWN0UmVhZE9ubHksXG4gICAgaW5zZXJ0SW5kZXg6IG51bWJlcixcbiAgICBvcHRpb25zPzogYW55XG4gICk6IElNQXBwQ29uZmlnXG5cbiAgYWJzdHJhY3QgZ2V0VG9vbEl0ZW1zIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCB0eXBlOiBzdHJpbmcpOiBBcnJheTxUb29sSXRlbUNvbmZpZyB8IFRvb2xJdGVtQ29uZmlnW10+XG59XG4iLCJpbXBvcnQge1xuICB0eXBlIElNQXBwQ29uZmlnLFxuICB0eXBlIElNTGF5b3V0SXRlbUpzb24sXG4gIHR5cGUgTGF5b3V0SW5mbyxcbiAgdHlwZSBCcm93c2VyU2l6ZU1vZGUsXG4gIHR5cGUgTGF5b3V0SXRlbUpzb24sXG4gIExheW91dEl0ZW1UeXBlXG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB3aWRnZXRTZXJ2aWNlIGZyb20gJy4vd2lkZ2V0LXNlcnZpY2UnXG5pbXBvcnQgc2VjdGlvblNlcnZpY2UgZnJvbSAnLi9zZWN0aW9uLXNlcnZpY2UnXG5pbXBvcnQgc2NyZWVuR3JvdXBTZXJ2aWNlIGZyb20gJy4vc2NyZWVuLWdyb3VwLXNlcnZpY2UnXG5pbXBvcnQgeyB0eXBlIEJhc2VDb250ZW50U2VydmljZSwgdHlwZSBEdXBsaWNhdGVDb250ZXh0IH0gZnJvbSAnLi9iYXNlLWNvbnRlbnQtc2VydmljZSdcbmltcG9ydCB7IHR5cGUgVG9jTm9kZSB9IGZyb20gJy4vYmFzZS1sYXlvdXQtc2VydmljZSdcbmltcG9ydCB7IHR5cGUgVGVtcGxhdGUgfSBmcm9tICcuLi90ZW1wbGF0ZXMnXG5cbmV4cG9ydCBjbGFzcyBDb250ZW50U2VydmljZVdyYXBwZXIge1xuICBzZXJ2aWNlOiBCYXNlQ29udGVudFNlcnZpY2VcbiAgY29udGVudElkOiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAocHJpdmF0ZSBhcHBDb25maWc6IElNQXBwQ29uZmlnLCBwcml2YXRlIHJlYWRvbmx5IGxheW91dEl0ZW06IExheW91dEl0ZW1Kc29uIHwgSU1MYXlvdXRJdGVtSnNvbikge1xuICAgIHN3aXRjaCAobGF5b3V0SXRlbS50eXBlKSB7XG4gICAgICBjYXNlIExheW91dEl0ZW1UeXBlLldpZGdldDpcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gd2lkZ2V0U2VydmljZVxuICAgICAgICB0aGlzLmNvbnRlbnRJZCA9IGxheW91dEl0ZW0ud2lkZ2V0SWRcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgTGF5b3V0SXRlbVR5cGUuU2VjdGlvbjpcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VjdGlvblNlcnZpY2VcbiAgICAgICAgdGhpcy5jb250ZW50SWQgPSBsYXlvdXRJdGVtLnNlY3Rpb25JZFxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBMYXlvdXRJdGVtVHlwZS5TY3JlZW5Hcm91cDpcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2NyZWVuR3JvdXBTZXJ2aWNlXG4gICAgICAgIHRoaXMuY29udGVudElkID0gbGF5b3V0SXRlbS5zY3JlZW5Hcm91cElkXG4gICAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgZ2V0Q29uZmlnICgpOiBJTUFwcENvbmZpZyB7XG4gICAgcmV0dXJuIHRoaXMuYXBwQ29uZmlnXG4gIH1cblxuICBnZXRDb250ZW50SWQgKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29udGVudElkXG4gIH1cblxuICBhc3luYyBjcmVhdGVGcm9tVGVtcGxhdGUgKHRlbXBsYXRlSnNvbjogVGVtcGxhdGUsIHNpemVNb2RlTGlzdDogQnJvd3NlclNpemVNb2RlW10sIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHQsIG9wdGlvbnM/OiBhbnkpOiBQcm9taXNlPFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdDb250ZW50SWQ6IHN0cmluZ10+IHtcbiAgICBpZiAodGhpcy5jb250ZW50SWQgJiYgdGhpcy5zZXJ2aWNlKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnNlcnZpY2UuY3JlYXRlRnJvbVRlbXBsYXRlKHRoaXMuYXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24sIHRoaXMuY29udGVudElkLCBzaXplTW9kZUxpc3QsIGNvbnRleHQsIG9wdGlvbnMpXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH1cbiAgICByZXR1cm4gW3RoaXMuYXBwQ29uZmlnLCBudWxsXVxuICB9XG5cbiAgZHVwbGljYXRlRW1iZWRMYXlvdXQgKGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLCB0b1NpemVNZG9lOiBCcm93c2VyU2l6ZU1vZGUpOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbmV3Q29udGVudElkOiBzdHJpbmddIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnNlcnZpY2UuZHVwbGljYXRlRW1iZWRMYXlvdXQodGhpcy5hcHBDb25maWcsIHRoaXMuY29udGVudElkLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1kb2UpXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH1cbiAgICByZXR1cm4gW3RoaXMuYXBwQ29uZmlnLCBudWxsXVxuICB9XG5cbiAgZHVwbGljYXRlICh0YXJnZXRCcm93c2VyU2l6ZTogQnJvd3NlclNpemVNb2RlLCBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0KTogW2FwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld0lkOiBzdHJpbmddIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnNlcnZpY2UuZHVwbGljYXRlKHRoaXMuYXBwQ29uZmlnLCB0aGlzLmNvbnRlbnRJZCwgdGFyZ2V0QnJvd3NlclNpemUsIGNvbnRleHQpXG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH1cbiAgICByZXR1cm4gW3RoaXMuYXBwQ29uZmlnLCBudWxsXVxuICB9XG5cbiAgdHJ5UmVtb3ZlIChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IElNQXBwQ29uZmlnIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuc2VydmljZS50cnlSZW1vdmUodGhpcy5hcHBDb25maWcsIHRoaXMuY29udGVudElkLCBsYXlvdXRJbmZvLCBicm93c2VyU2l6ZU1vZGUpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmFwcENvbmZpZ1xuICB9XG5cbiAgcmVtb3ZlICgpOiBJTUFwcENvbmZpZyB7XG4gICAgaWYgKHRoaXMuc2VydmljZSkge1xuICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLnNlcnZpY2UucmVtb3ZlKHRoaXMuYXBwQ29uZmlnLCB0aGlzLmNvbnRlbnRJZClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuYXBwQ29uZmlnXG4gIH1cblxuICB0b1RvY05vZGUgKHBhcmVudDogTGF5b3V0SW5mbywgYnJvd3NlclNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUpOiBUb2NOb2RlIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXJ2aWNlLnRvVG9jTm9kZSh0aGlzLmFwcENvbmZpZywgdGhpcy5jb250ZW50SWQsIHBhcmVudCwgYnJvd3NlclNpemVNb2RlKVxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgYWZ0ZXJNb3ZlZCAoZnJvbUxheW91dElkOiBzdHJpbmcsIHRvTGF5b3V0SWQ6IHN0cmluZyk6IElNQXBwQ29uZmlnIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuc2VydmljZS5hZnRlck1vdmVkKHRoaXMuYXBwQ29uZmlnLCB0aGlzLmNvbnRlbnRJZCwgZnJvbUxheW91dElkLCB0b0xheW91dElkKVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5hcHBDb25maWdcbiAgfVxuXG4gIGFmdGVyQWRkZWQgKGxheW91dElkOiBzdHJpbmcsIGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLCB0b1NpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUpOiBJTUFwcENvbmZpZyB7XG4gICAgaWYgKHRoaXMuc2VydmljZSkge1xuICAgICAgdGhpcy5hcHBDb25maWcgPSB0aGlzLnNlcnZpY2UuYWZ0ZXJBZGRlZCh0aGlzLmFwcENvbmZpZywgdGhpcy5jb250ZW50SWQsIGxheW91dElkLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmFwcENvbmZpZ1xuICB9XG5cbiAgYWRkUGFyZW50IChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IElNQXBwQ29uZmlnIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuc2VydmljZS5hZGRQYXJlbnQodGhpcy5hcHBDb25maWcsIHRoaXMuY29udGVudElkLCBsYXlvdXRJbmZvLCBicm93c2VyU2l6ZU1vZGUpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmFwcENvbmZpZ1xuICB9XG5cbiAgcmVtb3ZlUGFyZW50IChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IElNQXBwQ29uZmlnIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuc2VydmljZS5yZW1vdmVQYXJlbnQodGhpcy5hcHBDb25maWcsIHRoaXMuY29udGVudElkLCBsYXlvdXRJbmZvLCBicm93c2VyU2l6ZU1vZGUpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmFwcENvbmZpZ1xuICB9XG5cbiAgY2xlYXJQYXJlbnQgKCk6IElNQXBwQ29uZmlnIHtcbiAgICBpZiAodGhpcy5zZXJ2aWNlKSB7XG4gICAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuc2VydmljZS5jbGVhclBhcmVudCh0aGlzLmFwcENvbmZpZywgdGhpcy5jb250ZW50SWQpXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmFwcENvbmZpZ1xuICB9XG5cbiAgcmVtb3ZlU2l6ZU1vZGVQYXJlbnQgKGJyb3dzZXJTaXplTW9kZTogQnJvd3NlclNpemVNb2RlKTogSU1BcHBDb25maWcge1xuICAgIGlmICh0aGlzLnNlcnZpY2UpIHtcbiAgICAgIHRoaXMuYXBwQ29uZmlnID0gdGhpcy5zZXJ2aWNlLnJlbW92ZVNpemVNb2RlUGFyZW50KHRoaXMuYXBwQ29uZmlnLCB0aGlzLmNvbnRlbnRJZCwgYnJvd3NlclNpemVNb2RlKVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5hcHBDb25maWdcbiAgfVxuXG4gIGZpbmRQYXJlbnQgKGJyb3dzZXJTaXplTW9kZTogQnJvd3NlclNpemVNb2RlKTogTGF5b3V0SW5mbyB7XG4gICAgcmV0dXJuIHRoaXMuc2VydmljZT8uZmluZFBhcmVudCh0aGlzLmFwcENvbmZpZywgdGhpcy5jb250ZW50SWQsIGJyb3dzZXJTaXplTW9kZSlcbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJTUFwcENvbmZpZywgdHlwZSBMYXlvdXRJbmZvLCBMYXlvdXRJdGVtVHlwZSwgdHlwZSBCcm93c2VyU2l6ZU1vZGUgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBzZWFyY2hVdGlscyB9IGZyb20gJ2ppbXUtbGF5b3V0cy9sYXlvdXQtcnVudGltZSdcbmltcG9ydCB3aWRnZXRTZXJ2aWNlIGZyb20gJy4vd2lkZ2V0LXNlcnZpY2UnXG5pbXBvcnQgc2VjdGlvblNlcnZpY2UgZnJvbSAnLi9zZWN0aW9uLXNlcnZpY2UnXG5pbXBvcnQgc2NyZWVuR3JvdXBTZXJ2aWNlIGZyb20gJy4vc2NyZWVuLWdyb3VwLXNlcnZpY2UnXG5cbi8vIHJlcHJlc2VudCBhbiBlbXB0eSBsYXlvdXQgaXRlbVxuZXhwb3J0IGNsYXNzIEVtcHR5Q29udGVudFNlcnZpY2Uge1xuICAvKipcbiAgICogU2V0IGNvbnRlbnQgaWQgb2YgdGhlIGxheW91dCBpdGVtLCB0aGUgdHlwZSBvZiB0aGUgbGF5b3V0IGl0ZW0gc2hvdWxkIGhhdmUgYmVlbiBzZXQuXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIGxheW91dEluZm9cbiAgICogQHBhcmFtIGNvbnRlbnRJZFxuICAgKiBAcGFyYW0gc2l6ZU1vZGVcbiAgICogQHJldHVybnNcbiAgICovXG4gIHNldENvbnRlbnRJZCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGVcbiAgKTogSU1BcHBDb25maWcge1xuICAgIGlmICghY29udGVudElkKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIGNvbnN0IHsgbGF5b3V0SWQsIGxheW91dEl0ZW1JZCB9ID0gbGF5b3V0SW5mb1xuICAgIGNvbnN0IGxheW91dEl0ZW0gPSBzZWFyY2hVdGlscy5maW5kTGF5b3V0SXRlbShhcHBDb25maWcsIGxheW91dEluZm8pXG4gICAgaWYgKGxheW91dEl0ZW0pIHtcbiAgICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgICBzd2l0Y2ggKGxheW91dEl0ZW0udHlwZSkge1xuICAgICAgICBjYXNlIExheW91dEl0ZW1UeXBlLldpZGdldDpcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihcbiAgICAgICAgICAgIFsnbGF5b3V0cycsIGxheW91dElkLCAnY29udGVudCcsIGxheW91dEl0ZW1JZCwgJ3dpZGdldElkJ10sXG4gICAgICAgICAgICBjb250ZW50SWRcbiAgICAgICAgICApXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHdpZGdldFNlcnZpY2UuYWRkUGFyZW50KHVwZGF0ZWRBcHBDb25maWcsIGNvbnRlbnRJZCwgbGF5b3V0SW5mbywgc2l6ZU1vZGUpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBMYXlvdXRJdGVtVHlwZS5TZWN0aW9uOlxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFxuICAgICAgICAgICAgWydsYXlvdXRzJywgbGF5b3V0SWQsICdjb250ZW50JywgbGF5b3V0SXRlbUlkLCAnc2VjdGlvbklkJ10sXG4gICAgICAgICAgICBjb250ZW50SWRcbiAgICAgICAgICApXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHNlY3Rpb25TZXJ2aWNlLmFkZFBhcmVudCh1cGRhdGVkQXBwQ29uZmlnLCBjb250ZW50SWQsIGxheW91dEluZm8sIHNpemVNb2RlKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTGF5b3V0SXRlbVR5cGUuU2NyZWVuR3JvdXA6XG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oXG4gICAgICAgICAgICBbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ2NvbnRlbnQnLCBsYXlvdXRJdGVtSWQsICdzY3JlZW5Hcm91cElkJ10sXG4gICAgICAgICAgICBjb250ZW50SWRcbiAgICAgICAgICApXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHNjcmVlbkdyb3VwU2VydmljZS5hZGRQYXJlbnQodXBkYXRlZEFwcENvbmZpZywgY29udGVudElkLCBsYXlvdXRJbmZvLCBzaXplTW9kZSlcbiAgICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgICB9XG4gICAgcmV0dXJuIGFwcENvbmZpZ1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBFbXB0eUNvbnRlbnRTZXJ2aWNlKClcbiIsImltcG9ydCB3aWRnZXRTZXJ2aWNlIGZyb20gJy4vd2lkZ2V0LXNlcnZpY2UnXG5pbXBvcnQgc2VjdGlvblNlcnZpY2UgZnJvbSAnLi9zZWN0aW9uLXNlcnZpY2UnXG5pbXBvcnQgc2NyZWVuR3JvdXBTZXJ2aWNlIGZyb20gJy4vc2NyZWVuLWdyb3VwLXNlcnZpY2UnXG5pbXBvcnQgZW1wdHlDb250ZW50U2VydmljZSBmcm9tICcuL2VtcHR5LWNvbnRlbnQtc2VydmljZSdcbmltcG9ydCB0ZW1wbGF0ZVNlcnZpY2UgZnJvbSAnLi90ZW1wbGF0ZS1zZXJ2aWNlJ1xuaW1wb3J0IHsgQmFzZUxheW91dFNlcnZpY2UsIHR5cGUgVG9jTm9kZSB9IGZyb20gJy4vYmFzZS1sYXlvdXQtc2VydmljZSdcbmltcG9ydCB7IExheW91dFNlcnZpY2VQcm92aWRlciB9IGZyb20gJy4vbGF5b3V0LXNlcnZpY2UtcHJvdmlkZXInXG5pbXBvcnQgeyBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnIH0gZnJvbSAnLi91dGlsJ1xuaW1wb3J0IHsgdHlwZSBEdXBsaWNhdGVDb250ZXh0IH0gZnJvbSAnLi9iYXNlLWNvbnRlbnQtc2VydmljZSdcbmltcG9ydCB7IENvbnRlbnRTZXJ2aWNlV3JhcHBlciB9IGZyb20gJy4vY29udGVudC1zZXJ2aWNlLXdyYXBwZXInXG5cbmV4cG9ydCB7XG4gIHR5cGUgVG9jTm9kZSxcbiAgdHlwZSBEdXBsaWNhdGVDb250ZXh0LFxuICB3aWRnZXRTZXJ2aWNlLFxuICBzZWN0aW9uU2VydmljZSxcbiAgc2NyZWVuR3JvdXBTZXJ2aWNlLFxuICBlbXB0eUNvbnRlbnRTZXJ2aWNlLFxuICB0ZW1wbGF0ZVNlcnZpY2UsXG4gIEJhc2VMYXlvdXRTZXJ2aWNlLFxuICBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIsXG4gIENvbnRlbnRTZXJ2aWNlV3JhcHBlcixcbiAgbWFrZVN1cmVUZW1wbGF0ZUNvbmZpZ1xufVxuIiwiaW1wb3J0IHtcbiAgTGF5b3V0VHlwZSxcbiAgdHlwZSBJTUFwcENvbmZpZyxcbiAgdHlwZSBJbW11dGFibGVPYmplY3QsXG4gIHR5cGUgU2l6ZU1vZGVMYXlvdXRKc29uXG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgQmFzZUxheW91dFNlcnZpY2UgfSBmcm9tICcuL2Jhc2UtbGF5b3V0LXNlcnZpY2UnXG5cbmNvbnN0IERFRkFVTFRfTEFZT1VUX1RZUEUgPSBMYXlvdXRUeXBlLkZpeGVkTGF5b3V0XG5cbmV4cG9ydCBjbGFzcyBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogTGF5b3V0U2VydmljZVByb3ZpZGVyXG4gIHByaXZhdGUgcmVhZG9ubHkgc2VydmljZU1hcDogTWFwPHN0cmluZywgQmFzZUxheW91dFNlcnZpY2U+XG5cbiAgc3RhdGljIGdldEluc3RhbmNlICgpOiBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIge1xuICAgIGlmICghTGF5b3V0U2VydmljZVByb3ZpZGVyLmluc3RhbmNlKSB7XG4gICAgICBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuaW5zdGFuY2UgPSBuZXcgTGF5b3V0U2VydmljZVByb3ZpZGVyKClcbiAgICB9XG4gICAgcmV0dXJuIExheW91dFNlcnZpY2VQcm92aWRlci5pbnN0YW5jZVxuICB9XG5cbiAgc3RhdGljIGdldFNlcnZpY2UgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGxheW91dElkOiBzdHJpbmcpOiBCYXNlTGF5b3V0U2VydmljZSB7XG4gICAgY29uc3QgbGF5b3V0SnNvbiA9IGFwcENvbmZpZy5sYXlvdXRzW2xheW91dElkXVxuICAgIHJldHVybiBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0SW5zdGFuY2UoKS5nZXRTZXJ2aWNlQnlUeXBlKGxheW91dEpzb24/LnR5cGUgPz8gREVGQVVMVF9MQVlPVVRfVFlQRSlcbiAgfVxuXG4gIHN0YXRpYyBnZXRTZXJ2aWNlRnJvbVNpemVNb2RlTGF5b3V0IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBsYXlvdXRzOiBJbW11dGFibGVPYmplY3Q8U2l6ZU1vZGVMYXlvdXRKc29uPik6IEJhc2VMYXlvdXRTZXJ2aWNlIHtcbiAgICBjb25zdCBmaXJzdExheW91dElkID0gT2JqZWN0LnZhbHVlcyhsYXlvdXRzKVswXVxuICAgIGNvbnN0IGRlZmF1bHRMYXlvdXRJZCA9IGxheW91dHNbYXBwQ29uZmlnLm1haW5TaXplTW9kZV1cbiAgICByZXR1cm4gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UoYXBwQ29uZmlnLCBmaXJzdExheW91dElkKSA/PyBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZShhcHBDb25maWcsIGRlZmF1bHRMYXlvdXRJZClcbiAgfVxuXG4gIGNvbnN0cnVjdG9yICgpIHtcbiAgICB0aGlzLnNlcnZpY2VNYXAgPSBuZXcgTWFwKClcbiAgfVxuXG4gIHJlZ2lzdGVyU2VydmljZSAodHlwZTogTGF5b3V0VHlwZSwgc2VydmljZTogQmFzZUxheW91dFNlcnZpY2UpIHtcbiAgICB0aGlzLnNlcnZpY2VNYXAuc2V0KHR5cGUsIHNlcnZpY2UpXG4gIH1cblxuICBnZXRTZXJ2aWNlQnlUeXBlICh0eXBlOiBMYXlvdXRUeXBlKTogQmFzZUxheW91dFNlcnZpY2Uge1xuICAgIHJldHVybiB0aGlzLnNlcnZpY2VNYXAuZ2V0KHR5cGUgPz8gREVGQVVMVF9MQVlPVVRfVFlQRSlcbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJTUFwcENvbmZpZywgdHlwZSBMYXlvdXRJbmZvLCBCcm93c2VyU2l6ZU1vZGUsIExheW91dFBhcmVudFR5cGUsIGkxOG4gfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBCYXNlQ29udGVudFNlcnZpY2UsIHR5cGUgRHVwbGljYXRlQ29udGV4dCB9IGZyb20gJy4vYmFzZS1jb250ZW50LXNlcnZpY2UnXG5pbXBvcnQgKiBhcyBhcHBDb25maWdVdGlscyBmcm9tICcuLi91dGlscy9hcHAtY29uZmlnLXV0aWxzJ1xuaW1wb3J0IHsgZ2V0RHVwbGljYXRlTGFiZWwsIG1ha2VTdXJlVGVtcGxhdGVDb25maWcgfSBmcm9tICcuL3V0aWwnXG5pbXBvcnQgeyB0eXBlIFRlbXBsYXRlIH0gZnJvbSAnLi4vdGVtcGxhdGVzJ1xuaW1wb3J0IHsgTGF5b3V0U2VydmljZVByb3ZpZGVyIH0gZnJvbSAnLi9sYXlvdXQtc2VydmljZS1wcm92aWRlcidcbmltcG9ydCB7IHR5cGUgVG9jTm9kZSB9IGZyb20gJy4vYmFzZS1sYXlvdXQtc2VydmljZSdcbmltcG9ydCBzY3JlZW5PdXRsaW5lZCBmcm9tICdqaW11LWljb25zL3N2Zy9vdXRsaW5lZC9icmFuZC9zY3JlZW4uc3ZnJ1xuaW1wb3J0IHNjcmVlbkdyb3VwT3V0bGluZWQgZnJvbSAnamltdS1pY29ucy9zdmcvb3V0bGluZWQvYnJhbmQvc2NyZWVuLWdyb3VwLnN2ZydcblxuZXhwb3J0IGNsYXNzIFNjcmVlbkdyb3VwU2VydmljZSBleHRlbmRzIEJhc2VDb250ZW50U2VydmljZSB7XG4gIGFzeW5jIGNyZWF0ZUZyb21UZW1wbGF0ZSAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLFxuICAgIHNjcmVlbkdyb3VwSWQ6IHN0cmluZyxcbiAgICBzaXplTW9kZUxpc3Q6IEJyb3dzZXJTaXplTW9kZVtdLFxuICAgIGNvbnRlbnRNYXBwaW5nOiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFByb21pc2U8W2FwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld0lkOiBzdHJpbmddPiB7XG4gICAgaWYgKGNvbnRlbnRNYXBwaW5nW3NjcmVlbkdyb3VwSWRdKSB7XG4gICAgICByZXR1cm4gW2FwcENvbmZpZywgY29udGVudE1hcHBpbmdbc2NyZWVuR3JvdXBJZF1dXG4gICAgfVxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG5cbiAgICBjb25zb2xlLmRlYnVnKCdjcmVhdGUgc2NyZWVuIGdyb3VwJywgc2NyZWVuR3JvdXBJZCwgJ2Zyb20gdGVtcGxhdGUgaW4nLCBzaXplTW9kZUxpc3QpXG4gICAgYXdhaXQgbWFrZVN1cmVUZW1wbGF0ZUNvbmZpZyh0ZW1wbGF0ZUpzb24pXG4gICAgY29uc3QgdGVtcGxhdGVDb25maWcgPSB0ZW1wbGF0ZUpzb24uY29uZmlnXG4gICAgc2NyZWVuR3JvdXBJZCA9IHNjcmVlbkdyb3VwSWQgPz8gT2JqZWN0LmtleXModGVtcGxhdGVDb25maWcuc2NyZWVuR3JvdXBzKVswXVxuICAgIGNvbnN0IHRlbXBsYXRlU2NyZWVuR3JvdXAgPSB0ZW1wbGF0ZUNvbmZpZy5zY3JlZW5Hcm91cHNbc2NyZWVuR3JvdXBJZF1cbiAgICBjb25zdCBuZXh0R3JvdXBJZCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3NjcmVlbkdyb3VwJylcblxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnXG4gICAgICAuc2V0SW4oWydzY3JlZW5Hcm91cHMnLCBuZXh0R3JvdXBJZF0sIHRlbXBsYXRlU2NyZWVuR3JvdXApXG4gICAgICAuc2V0SW4oWydzY3JlZW5Hcm91cHMnLCBuZXh0R3JvdXBJZCwgJ2lkJ10sIG5leHRHcm91cElkKVxuICAgICAgLnNldEluKFxuICAgICAgICBbJ3NjcmVlbkdyb3VwcycsIG5leHRHcm91cElkLCAnbGFiZWwnXSxcbiAgICAgICAgYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlTGFiZWwoYXBwQ29uZmlnLCAnc2NyZWVuR3JvdXAnLCBpMThuLmdldEludGwoKS5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdzY3JlZW5Hcm91cCcgfSkpXG4gICAgICApXG5cbiAgICBjb25zdCBuZXdTY3JlZW5JZHMgPSBbXVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcGxhdGVTY3JlZW5Hcm91cC5zY3JlZW5zLmxlbmd0aDsgaSArPSAxKSB7IC8vIGF3YWl0cyBpbiBhIGZvci1sb29wIHNob3VsZCBnZXQgZXhlY3V0ZWQgaW4gc2VyaWVzXG4gICAgICBjb25zdCBzY3JlZW5JZCA9IHRlbXBsYXRlU2NyZWVuR3JvdXAuc2NyZWVuc1tpXVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jcmVhdGVTY3JlZW5Gcm9tVGVtcGxhdGUodXBkYXRlZEFwcENvbmZpZywgdGVtcGxhdGVKc29uLCBzY3JlZW5JZCwgc2l6ZU1vZGVMaXN0LCBjb250ZW50TWFwcGluZylcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgIG5ld1NjcmVlbklkcy5wdXNoKHJlc3VsdFsxXSlcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnc2NyZWVucycsIHJlc3VsdFsxXSwgJ3BhcmVudCddLCBuZXh0R3JvdXBJZClcbiAgICB9XG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oXG4gICAgICBbJ3NjcmVlbkdyb3VwcycsIG5leHRHcm91cElkLCAnc2NyZWVucyddLFxuICAgICAgbmV3U2NyZWVuSWRzKVxuXG4gICAgY29udGVudE1hcHBpbmdbc2NyZWVuR3JvdXBJZF0gPSBuZXh0R3JvdXBJZFxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBuZXh0R3JvdXBJZF1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVNjcmVlbkZyb21UZW1wbGF0ZSAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLFxuICAgIHNjcmVlbklkOiBzdHJpbmcsXG4gICAgc2l6ZU1vZGVMaXN0OiBCcm93c2VyU2l6ZU1vZGVbXSxcbiAgICBjb250ZW50TWFwcGluZzogRHVwbGljYXRlQ29udGV4dFxuICApOiBQcm9taXNlPFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdTY3JlZW5JZDogc3RyaW5nXT4ge1xuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG5cbiAgICBjb25zb2xlLmRlYnVnKCdjcmVhdGUgc2NyZWVuJywgc2NyZWVuSWQsICdmcm9tIHRlbXBsYXRlIGluJywgc2l6ZU1vZGVMaXN0KVxuICAgIGF3YWl0IG1ha2VTdXJlVGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uKVxuICAgIGNvbnN0IHRlbXBsYXRlQ29uZmlnID0gdGVtcGxhdGVKc29uLmNvbmZpZ1xuICAgIHNjcmVlbklkID0gc2NyZWVuSWQgPz8gT2JqZWN0LmtleXModGVtcGxhdGVDb25maWcuc2NyZWVucylbMF1cbiAgICBjb25zdCB0ZW1wbGF0ZVNjcmVlbiA9IHRlbXBsYXRlQ29uZmlnLnNjcmVlbnNbc2NyZWVuSWRdXG4gICAgY29uc3QgbmV4dFNjcmVlbklkID0gYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnc2NyZWVuJylcblxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnc2NyZWVucycsIG5leHRTY3JlZW5JZF0sIHRlbXBsYXRlU2NyZWVuKVxuICAgICAgLnNldEluKFsnc2NyZWVucycsIG5leHRTY3JlZW5JZCwgJ2lkJ10sIG5leHRTY3JlZW5JZClcbiAgICAgIC5zZXRJbihbJ3NjcmVlbnMnLCBuZXh0U2NyZWVuSWQsICdsYWJlbCddLCBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVMYWJlbChhcHBDb25maWcsICdzY3JlZW4nLCBpMThuLmdldEludGwoKS5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdzY3JlZW4nIH0pKSlcblxuICAgIGNvbnN0IGxheW91dElkcyA9IFtdXG4gICAgT2JqZWN0LmtleXModGVtcGxhdGVTY3JlZW4ucGFuZWw/LmxheW91dCA/PyB7fSkuZm9yRWFjaCgoc2l6ZU1vZGUpID0+IHtcbiAgICAgIGxheW91dElkcy5wdXNoKHtcbiAgICAgICAgc2l6ZU1vZGUsXG4gICAgICAgIGlzU2lkZTogdHJ1ZSxcbiAgICAgICAgbGF5b3V0SWQ6IHRlbXBsYXRlU2NyZWVuLnBhbmVsLmxheW91dFtzaXplTW9kZV1cbiAgICAgIH0pXG4gICAgfSlcbiAgICBPYmplY3Qua2V5cyh0ZW1wbGF0ZVNjcmVlbi5tYWluLmxheW91dCA/PyB7fSkuZm9yRWFjaCgoc2l6ZU1vZGUpID0+IHtcbiAgICAgIGxheW91dElkcy5wdXNoKHtcbiAgICAgICAgc2l6ZU1vZGUsXG4gICAgICAgIGlzU2lkZTogZmFsc2UsXG4gICAgICAgIGxheW91dElkOiB0ZW1wbGF0ZVNjcmVlbi5tYWluLmxheW91dFtzaXplTW9kZV1cbiAgICAgIH0pXG4gICAgfSlcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGF5b3V0SWRzLmxlbmd0aDsgaSArPSAxKSB7IC8vIGF3YWl0cyBpbiBhIGZvci1sb29wIHNob3VsZCBnZXQgZXhlY3V0ZWQgaW4gc2VyaWVzXG4gICAgICBjb25zdCB7IHNpemVNb2RlLCBsYXlvdXRJZCwgaXNTaWRlIH0gPSBsYXlvdXRJZHNbaV1cbiAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0ZW1wbGF0ZUNvbmZpZyBhcyBhbnksIGxheW91dElkKVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVMYXlvdXRGcm9tVGVtcGxhdGUoXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcsXG4gICAgICAgIHRlbXBsYXRlSnNvbixcbiAgICAgICAgbGF5b3V0SWQsXG4gICAgICAgIHNpemVNb2RlLFxuICAgICAgICBMYXlvdXRQYXJlbnRUeXBlLlNjcmVlbixcbiAgICAgICAgbmV4dFNjcmVlbklkLFxuICAgICAgICBjb250ZW50TWFwcGluZ1xuICAgICAgKVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgY29uc3QgbmV3TGF5b3V0SWQgPSByZXN1bHRbMV1cbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFxuICAgICAgICBbJ2xheW91dHMnLCBuZXdMYXlvdXRJZCwgJ3BhcmVudCddLFxuICAgICAgICB7IHR5cGU6IExheW91dFBhcmVudFR5cGUuU2NyZWVuLCBpZDogbmV4dFNjcmVlbklkIH0pXG4gICAgICBpZiAoaXNTaWRlKSB7XG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFxuICAgICAgICAgIFsnc2NyZWVucycsIG5leHRTY3JlZW5JZCwgJ3BhbmVsJywgJ2xheW91dCcsIHNpemVNb2RlXSxcbiAgICAgICAgICBuZXdMYXlvdXRJZClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFxuICAgICAgICAgIFsnc2NyZWVucycsIG5leHRTY3JlZW5JZCwgJ21haW4nLCAnbGF5b3V0Jywgc2l6ZU1vZGVdLFxuICAgICAgICAgIG5ld0xheW91dElkKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV4dFNjcmVlbklkXVxuICB9XG5cbiAgZHVwbGljYXRlRW1iZWRMYXlvdXQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgZnJvbVNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgdG9TaXplTW9kZTogQnJvd3NlclNpemVNb2RlXG4gICk6IFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdDb250ZW50SWQ6IHN0cmluZ10ge1xuICAgIGNvbnN0IHNnSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5Hcm91cHM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZ0pzb24pIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgIH1cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuXG4gICAgc2dKc29uLnNjcmVlbnMuZm9yRWFjaChzY3JlZW5JZCA9PiB7XG4gICAgICBjb25zdCBzY3JlZW5Kc29uID0gdXBkYXRlZEFwcENvbmZpZy5zY3JlZW5zW3NjcmVlbklkXVxuICAgICAgY29uc3QgbWFpbkxheW91dHMgPSBzY3JlZW5Kc29uLm1haW4ubGF5b3V0XG4gICAgICBpZiAobWFpbkxheW91dHNbZnJvbVNpemVNb2RlXSAmJiAhbWFpbkxheW91dHNbdG9TaXplTW9kZV0pIHtcbiAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHVwZGF0ZWRBcHBDb25maWcsIG1haW5MYXlvdXRzW2Zyb21TaXplTW9kZV0pXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuZHVwbGljYXRlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIG1haW5MYXlvdXRzW2Zyb21TaXplTW9kZV0sIGZyb21TaXplTW9kZSwgdG9TaXplTW9kZSwgbnVsbCwgZmFsc2UpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgY29uc3QgbmV3TGF5b3V0SWQgPSByZXN1bHRbMV1cbiAgICAgICAgaWYgKHJlc3VsdFsxXSAhPSBudWxsKSB7XG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBuZXdMYXlvdXRJZCwgJ3BhcmVudCddLCB7IHR5cGU6IExheW91dFBhcmVudFR5cGUuU2NyZWVuLCBpZDogc2NyZWVuSWQgfSlcbiAgICAgICAgICAgIC5zZXRJbihbJ3NjcmVlbnMnLCBzY3JlZW5JZCwgJ21haW4nLCAnbGF5b3V0JywgdG9TaXplTW9kZV0sIG5ld0xheW91dElkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBwYW5lbExheW91dHMgPSBzY3JlZW5Kc29uLnBhbmVsPy5sYXlvdXRcbiAgICAgIGlmIChwYW5lbExheW91dHMgJiYgcGFuZWxMYXlvdXRzW2Zyb21TaXplTW9kZV0gJiYgIXBhbmVsTGF5b3V0c1t0b1NpemVNb2RlXSkge1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodXBkYXRlZEFwcENvbmZpZywgcGFuZWxMYXlvdXRzW2Zyb21TaXplTW9kZV0pXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuZHVwbGljYXRlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIHBhbmVsTGF5b3V0c1tmcm9tU2l6ZU1vZGVdLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUsIG51bGwsIGZhbHNlKVxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgICAgIGNvbnN0IG5ld0xheW91dElkID0gcmVzdWx0WzFdXG4gICAgICAgIGlmIChyZXN1bHRbMV0gIT0gbnVsbCkge1xuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnXG4gICAgICAgICAgICAuc2V0SW4oWydsYXlvdXRzJywgbmV3TGF5b3V0SWQsICdwYXJlbnQnXSwgeyB0eXBlOiBMYXlvdXRQYXJlbnRUeXBlLlNjcmVlbiwgaWQ6IHNjcmVlbklkIH0pXG4gICAgICAgICAgICAuc2V0SW4oWydzY3JlZW5zJywgc2NyZWVuSWQsICdwYW5lbCcsICdsYXlvdXQnLCB0b1NpemVNb2RlXSwgbmV3TGF5b3V0SWQpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBudWxsXVxuICB9XG5cbiAgZHVwbGljYXRlIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIHRhcmdldEJyb3dzZXJTaXplOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dFxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbmV3SWQ6IHN0cmluZ10ge1xuICAgIGNvbnN0IHNnSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5Hcm91cHM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZ0pzb24pIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgIH1cblxuICAgIGlmIChjb250ZXh0Py5bY29udGVudElkXSkge1xuICAgICAgLy8gYWxyZWFkeSBkdXBsaWNhdGQgaW4gYSBzdGFjayBvZiBmdW5jdGlvbiBpbnZva2F0aW9ucy5cbiAgICAgIC8vIFVzZSBjYXNlOiBzYW1lIGFzIHNlY3Rpb25cbiAgICAgIC8vIGNoZWNrIHRoZSBkdXBsaWNhdGVkIHNlY3Rpb24gaGFzIHRoZSB0YXJnZXQgYnJvd3NlciBzaXplIG1vZGUgbGF5b3V0XG4gICAgICBjb25zdCBzZ0pzb24gPSBhcHBDb25maWcuc2NyZWVuR3JvdXBzW2NvbnRleHRbY29udGVudElkXV1cbiAgICAgIGNvbnN0IGZpcnN0U2NyZWVuID0gYXBwQ29uZmlnLnNjcmVlbnNbc2dKc29uLnNjcmVlbnNbMF1dXG4gICAgICBpZiAoZmlyc3RTY3JlZW4ubWFpbi5sYXlvdXRbdGFyZ2V0QnJvd3NlclNpemVdKSB7XG4gICAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBjb250ZXh0W2NvbnRlbnRJZF1dXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBkdXBsaWNhdGUgZW1iZWQgbGF5b3V0IGluIHRhcmdldCBicm93c2VyIHNpemUgbW9kZSBmcm9tIG9yaWdpbmFsIHNnIHRvIGR1cGxpY2F0ZWQgc2dcbiAgICAgICAgY29uc3Qgb3JpZ2luU2cgPSBhcHBDb25maWcuc2NyZWVuR3JvdXBzW2NvbnRlbnRJZF1cbiAgICAgICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcbiAgICAgICAgb3JpZ2luU2cuc2NyZWVucy5mb3JFYWNoKHNjcmVlbklkID0+IHtcbiAgICAgICAgICBjb25zdCBzY3JlZW5Kc29uID0gdXBkYXRlZEFwcENvbmZpZy5zY3JlZW5zW3NjcmVlbklkXVxuICAgICAgICAgIGNvbnN0IG1MYXlvdXRJZCA9IHNjcmVlbkpzb24ubWFpbi5sYXlvdXRbdGFyZ2V0QnJvd3NlclNpemVdXG4gICAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHVwZGF0ZWRBcHBDb25maWcsIG1MYXlvdXRJZClcbiAgICAgICAgICBjb25zdCBkdXBSZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBtTGF5b3V0SWQsIHRhcmdldEJyb3dzZXJTaXplLCB0YXJnZXRCcm93c2VyU2l6ZSwgY29udGV4dCwgdHJ1ZSlcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gZHVwUmVzdWx0WzBdXG4gICAgICAgICAgY29uc3QgbmV3TGF5b3V0SWQgPSBkdXBSZXN1bHRbMV1cbiAgICAgICAgICBpZiAobmV3TGF5b3V0SWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAgICAgLnNldEluKFsnc2NyZWVucycsIGNvbnRleHRbc2NyZWVuSWRdLCAnbWFpbicsICdsYXlvdXQnLCB0YXJnZXRCcm93c2VyU2l6ZV0sIG5ld0xheW91dElkKVxuICAgICAgICAgICAgICAuc2V0SW4oWydsYXlvdXRzJywgbmV3TGF5b3V0SWQsICdwYXJlbnQnXSwgeyB0eXBlOiBMYXlvdXRQYXJlbnRUeXBlLlNjcmVlbiwgaWQ6IGNvbnRleHRbc2NyZWVuSWRdIH0pXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHNjcmVlbkpzb24ucGFuZWw/LmxheW91dCkge1xuICAgICAgICAgICAgY29uc3QgcExheW91dElkID0gc2NyZWVuSnNvbi5wYW5lbC5sYXlvdXRbdGFyZ2V0QnJvd3NlclNpemVdXG4gICAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodXBkYXRlZEFwcENvbmZpZywgcExheW91dElkKVxuICAgICAgICAgICAgY29uc3QgZHVwUmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgcExheW91dElkLCB0YXJnZXRCcm93c2VyU2l6ZSwgdGFyZ2V0QnJvd3NlclNpemUsIGNvbnRleHQsIHRydWUpXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gZHVwUmVzdWx0WzBdXG4gICAgICAgICAgICBjb25zdCBuZXdMYXlvdXRJZCA9IGR1cFJlc3VsdFsxXVxuICAgICAgICAgICAgaWYgKG5ld0xheW91dElkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAgICAgICAuc2V0SW4oWydzY3JlZW5zJywgY29udGV4dFtzY3JlZW5JZF0sICdwYW5lbCcsICdsYXlvdXQnLCB0YXJnZXRCcm93c2VyU2l6ZV0sIG5ld0xheW91dElkKVxuICAgICAgICAgICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBuZXdMYXlvdXRJZCwgJ3BhcmVudCddLCB7IHR5cGU6IExheW91dFBhcmVudFR5cGUuU2NyZWVuLCBpZDogY29udGV4dFtzY3JlZW5JZF0gfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgY29udGV4dFtjb250ZW50SWRdXVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ2R1cGxpY2F0ZSBzY3JlZW4gZ3JvdXAnLCBjb250ZW50SWQsICd0bycsIHRhcmdldEJyb3dzZXJTaXplKVxuICAgIGxldCBuZXdTZ0pzb24gPSBzZ0pzb25cbiAgICAgIC5zZXQoJ2lkJywgYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnc2NyZWVuR3JvdXAnKSlcbiAgICAgIC5zZXQoJ2xhYmVsJywgZ2V0RHVwbGljYXRlTGFiZWwoYXBwQ29uZmlnLCAnc2NyZWVuR3JvdXAnLCBzZ0pzb24ubGFiZWwpKVxuXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWcuc2V0SW4oWydzY3JlZW5Hcm91cHMnLCBuZXdTZ0pzb24uaWRdLCBuZXdTZ0pzb24pXG5cbiAgICBjb25zdCBzY3JlZW5JZHMgPSBzZ0pzb24uc2NyZWVucy5tYXAoKHNjcmVlbklkKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmR1cGxpY2F0ZVNjcmVlbih1cGRhdGVkQXBwQ29uZmlnLCBzZ0pzb24uaWQsIHNjcmVlbklkLCBbdGFyZ2V0QnJvd3NlclNpemVdLCBmYWxzZSwgY29udGV4dClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgIGNvbnN0IG5ld1NjcmVlbklkID0gcmVzdWx0WzFdXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbnMnLCBuZXdTY3JlZW5JZCwgJ3BhcmVudCddLCBuZXdTZ0pzb24uaWQpXG4gICAgICByZXR1cm4gbmV3U2NyZWVuSWRcbiAgICB9KVxuXG4gICAgbmV3U2dKc29uID0gbmV3U2dKc29uLnNldCgnc2NyZWVucycsIHNjcmVlbklkcylcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbkdyb3VwcycsIG5ld1NnSnNvbi5pZF0sIG5ld1NnSnNvbilcblxuICAgIGlmIChjb250ZXh0KSB7XG4gICAgICBjb250ZXh0W2NvbnRlbnRJZF0gPSBuZXdTZ0pzb24uaWRcbiAgICB9XG5cbiAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIG5ld1NnSnNvbi5pZF1cbiAgfVxuXG4gIHRyeVJlbW92ZSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcsIGxheW91dEluZm86IExheW91dEluZm8sIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2dKc29uID0gYXBwQ29uZmlnLnNjcmVlbkdyb3Vwcz8uW2NvbnRlbnRJZF1cbiAgICBpZiAoIXNnSnNvbikge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cbiAgICBjb25zb2xlLmRlYnVnKGB0cnkgcmVtb3ZlIHNjcmVlbkdyb3VwICR7Y29udGVudElkfSBmcm9tICR7bGF5b3V0SW5mby5sYXlvdXRJZH0gJHtsYXlvdXRJbmZvLmxheW91dEl0ZW1JZH1gLCBzaXplTW9kZSlcbiAgICAvLyAxLiBjdXJyZW50IHNpemUgbW9kZSBwYXNzZWQsIGNoZWNrIG90aGVyIHNpemUgbW9kZVxuICAgIGNvbnN0IGhhc090aGVyTW9kZXMgPSBbQnJvd3NlclNpemVNb2RlLkxhcmdlLCBCcm93c2VyU2l6ZU1vZGUuTWVkaXVtLCBCcm93c2VyU2l6ZU1vZGUuU21hbGxdXG4gICAgICAuZmlsdGVyKG1vZGUgPT4gbW9kZSAhPT0gc2l6ZU1vZGUpXG4gICAgICAuc29tZShtb2RlID0+IHNnSnNvbi5wYXJlbnQ/Llttb2RlXSAhPSBudWxsKVxuXG4gICAgaWYgKCFoYXNPdGhlck1vZGVzKSB7IC8vIGNhbiBiZSByZW1vdmVkXG4gICAgICByZXR1cm4gdGhpcy5yZW1vdmUoYXBwQ29uZmlnLCBjb250ZW50SWQpXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIDEuIHJlbW92ZSBwYXJlbnQgZm9yIHRoaXMgc2l6ZSBtb2RlXG4gICAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMucmVtb3ZlUGFyZW50KGFwcENvbmZpZywgY29udGVudElkLCBsYXlvdXRJbmZvLCBzaXplTW9kZSlcbiAgICAgIC8vIDIuIHJlbW92ZSBlbWJlZCBsYXlvdXQgb2YgdGhpcyBzaXplIG1vZGUgaWYgYW55XG4gICAgICBzZ0pzb24uc2NyZWVucy5mb3JFYWNoKChzY3JlZW5JZCkgPT4ge1xuICAgICAgICBjb25zdCBzY3JlZW5Kc29uID0gdXBkYXRlZEFwcENvbmZpZy5zY3JlZW5zW3NjcmVlbklkXVxuICAgICAgICBpZiAoc2NyZWVuSnNvbi5tYWluLmxheW91dFtzaXplTW9kZV0pIHtcbiAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgc2NyZWVuSnNvbi5tYWluLmxheW91dClcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZS5yZW1vdmVTaXplTW9kZUxheW91dHModXBkYXRlZEFwcENvbmZpZywgeyBbc2l6ZU1vZGVdOiBzY3JlZW5Kc29uLm1haW4ubGF5b3V0W3NpemVNb2RlXSB9IGFzIGFueSlcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbnMnLCBzY3JlZW5JZCwgJ21haW4nLCAnbGF5b3V0J10sIHNjcmVlbkpzb24ubWFpbi5sYXlvdXQud2l0aG91dChzaXplTW9kZSkpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNjcmVlbkpzb24ucGFuZWw/LmxheW91dFtzaXplTW9kZV0pIHtcbiAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgc2NyZWVuSnNvbi5wYW5lbC5sYXlvdXQpXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHNlcnZpY2UucmVtb3ZlU2l6ZU1vZGVMYXlvdXRzKHVwZGF0ZWRBcHBDb25maWcsIHsgW3NpemVNb2RlXTogc2NyZWVuSnNvbi5wYW5lbC5sYXlvdXRbc2l6ZU1vZGVdIH0gYXMgYW55KVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnc2NyZWVucycsIHNjcmVlbklkLCAncGFuZWwnLCAnbGF5b3V0J10sIHNjcmVlbkpzb24ucGFuZWwubGF5b3V0LndpdGhvdXQoc2l6ZU1vZGUpKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgICB9XG4gIH1cblxuICByZW1vdmUgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGNvbnRlbnRJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHNnSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5Hcm91cHM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZ0pzb24pIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG5cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuXG4gICAgY29uc29sZS5kZWJ1ZygncmVtb3ZlIHNjcmVlbiBncm91cCcsIGNvbnRlbnRJZClcbiAgICAvLyByZW1vdmUgYWxsIHBhcmVudCBsYXlvdXQgaW5mb3NcbiAgICBPYmplY3Qua2V5cyhzZ0pzb24ucGFyZW50ID8/IHt9KS5mb3JFYWNoKChzaXplTW9kZTogQnJvd3NlclNpemVNb2RlKSA9PiB7XG4gICAgICBjb25zdCB7IGxheW91dElkIH0gPSBzZ0pzb24ucGFyZW50W3NpemVNb2RlXVxuXG4gICAgICBjb25zdCBsYXlvdXRKc29uID0gdXBkYXRlZEFwcENvbmZpZy5sYXlvdXRzW2xheW91dElkXVxuICAgICAgaWYgKGxheW91dEpzb24pIHtcbiAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHVwZGF0ZWRBcHBDb25maWcsIGxheW91dElkKVxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZS5yZW1vdmVJdGVtKHVwZGF0ZWRBcHBDb25maWcsIHNnSnNvbi5wYXJlbnRbc2l6ZU1vZGVdLCBzaXplTW9kZSwgZmFsc2UpXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIHJlbW92ZSBzY3JlZW5zXG4gICAgc2dKc29uLnNjcmVlbnMuZm9yRWFjaCgoc2NyZWVuSWQpID0+IHtcbiAgICAgIGNvbnN0IHNjcmVlbkpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLnNjcmVlbnNbc2NyZWVuSWRdXG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgc2NyZWVuSnNvbi5tYWluLmxheW91dClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBzZXJ2aWNlLnJlbW92ZVNpemVNb2RlTGF5b3V0cyh1cGRhdGVkQXBwQ29uZmlnLCBzY3JlZW5Kc29uLm1haW4ubGF5b3V0KVxuICAgICAgaWYgKHNjcmVlbkpzb24ucGFuZWw/LmxheW91dCkge1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgc2NyZWVuSnNvbi5wYW5lbC5sYXlvdXQpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBzZXJ2aWNlLnJlbW92ZVNpemVNb2RlTGF5b3V0cyh1cGRhdGVkQXBwQ29uZmlnLCBzY3JlZW5Kc29uLnBhbmVsLmxheW91dClcbiAgICAgIH1cbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldCgnc2NyZWVucycsIHVwZGF0ZWRBcHBDb25maWcuc2NyZWVucy53aXRob3V0KHNjcmVlbklkKSlcbiAgICB9KVxuXG4gICAgLy8gcmVtb3ZlIHNjcmVlbiBncm91cFxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldCgnc2NyZWVuR3JvdXBzJywgdXBkYXRlZEFwcENvbmZpZy5zY3JlZW5Hcm91cHMud2l0aG91dChjb250ZW50SWQpKVxuXG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxuXG4gIHRvVG9jTm9kZSAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICBwYXJlbnQ6IExheW91dEluZm8sXG4gICAgYnJvd3NlclNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGVcbiAgKTogVG9jTm9kZSB7XG4gICAgY29uc3QgeyBsYXlvdXRJZCwgbGF5b3V0SXRlbUlkIH0gPSBwYXJlbnRcbiAgICBjb25zdCByZXN1bHQ6IFRvY05vZGUgPSB7XG4gICAgICBsYWJlbDogJycsXG4gICAgICBsYXlvdXRJZCxcbiAgICAgIGxheW91dEl0ZW1JZCxcbiAgICAgIHR5cGU6ICdzY3JlZW5Hcm91cCcsXG4gICAgICBpZDogY29udGVudElkLFxuICAgICAgY2hpbGRyZW46IFtdXG4gICAgfVxuICAgIGNvbnN0IHNnSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5Hcm91cHM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZ0pzb24pIHtcbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9XG4gICAgcmVzdWx0LmxhYmVsID0gc2dKc29uLmxhYmVsXG4gICAgcmVzdWx0Lmljb24gPSBzZ0pzb24uaWNvbiA/PyBzY3JlZW5Hcm91cE91dGxpbmVkXG4gICAgcmVzdWx0LmZsaXBJY29uID0gZmFsc2VcblxuICAgIHNnSnNvbi5zY3JlZW5zLmZvckVhY2goKHNjcmVlbklkKSA9PiB7XG4gICAgICBjb25zdCBzY3JlZW5Kc29uID0gYXBwQ29uZmlnLnNjcmVlbnNbc2NyZWVuSWRdXG4gICAgICBjb25zdCBzY3JlZW5Ob2RlOiBUb2NOb2RlID0ge1xuICAgICAgICBsYWJlbDogc2NyZWVuSnNvbi5sYWJlbCxcbiAgICAgICAgaWNvbjogc2NyZWVuT3V0bGluZWQsXG4gICAgICAgIGZsaXBJY29uOiBmYWxzZSxcbiAgICAgICAgdHlwZTogJ3NjcmVlbicsXG4gICAgICAgIGlkOiBzY3JlZW5JZCxcbiAgICAgICAgY2hpbGRyZW46IFtdXG4gICAgICB9XG4gICAgICBjb25zdCBtYWluTGF5b3V0SWQgPSBzY3JlZW5Kc29uLm1haW4ubGF5b3V0W2Jyb3dzZXJTaXplTW9kZV0gPz8gc2NyZWVuSnNvbi5tYWluLmxheW91dFthcHBDb25maWcubWFpblNpemVNb2RlXVxuICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKGFwcENvbmZpZywgbWFpbkxheW91dElkKVxuICAgICAgY29uc3QgbWFpbkNoaWxkcmVuID0gc2VydmljZS5nZXRUb2NTdHJ1Y3R1cmUoYXBwQ29uZmlnLCBtYWluTGF5b3V0SWQpXG4gICAgICBzY3JlZW5Ob2RlLmNoaWxkcmVuLnB1c2goe1xuICAgICAgICBsYWJlbDogaTE4bi5nZXRJbnRsKCkuZm9ybWF0TWVzc2FnZSh7IGlkOiAnbWFpblN0YWdlJyB9KSxcbiAgICAgICAgaXNMYWJlbFJlYWRPbmx5OiB0cnVlLFxuICAgICAgICB0eXBlOiAnbGF5b3V0JyxcbiAgICAgICAgaWQ6IG1haW5MYXlvdXRJZCxcbiAgICAgICAgY2hpbGRyZW46IG1haW5DaGlsZHJlblxuICAgICAgfSlcblxuICAgICAgaWYgKHNjcmVlbkpzb24ucGFuZWw/LmxheW91dCkge1xuICAgICAgICBjb25zdCBwYW5lbExheW91dElkID0gc2NyZWVuSnNvbi5wYW5lbC5sYXlvdXRbYnJvd3NlclNpemVNb2RlXSA/PyBzY3JlZW5Kc29uLnBhbmVsLmxheW91dFthcHBDb25maWcubWFpblNpemVNb2RlXVxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UoYXBwQ29uZmlnLCBwYW5lbExheW91dElkKVxuICAgICAgICBjb25zdCBwYW5lbENoaWxkcmVuID0gc2VydmljZS5nZXRUb2NTdHJ1Y3R1cmUoYXBwQ29uZmlnLCBwYW5lbExheW91dElkKVxuICAgICAgICBzY3JlZW5Ob2RlLmNoaWxkcmVuLnB1c2goe1xuICAgICAgICAgIGxhYmVsOiBpMThuLmdldEludGwoKS5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdzY3JvbGxpbmdQYW5lbCcgfSksXG4gICAgICAgICAgaXNMYWJlbFJlYWRPbmx5OiB0cnVlLFxuICAgICAgICAgIHR5cGU6ICdsYXlvdXQnLFxuICAgICAgICAgIGlkOiBwYW5lbExheW91dElkLFxuICAgICAgICAgIGNoaWxkcmVuOiBwYW5lbENoaWxkcmVuXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICByZXN1bHQuY2hpbGRyZW4ucHVzaChzY3JlZW5Ob2RlKVxuICAgIH0pXG5cbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cblxuICBhZnRlck1vdmVkIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgZnJvbUxheW91dDogc3RyaW5nLCB0b0xheW91dDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIC8vIG5vIGV4dHJhIGxvZ2ljIHRvIHByb2Nlc3NcbiAgICByZXR1cm4gYXBwQ29uZmlnXG4gIH1cblxuICBhZnRlckFkZGVkIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIHRvTGF5b3V0OiBzdHJpbmcsXG4gICAgZnJvbVNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgdG9TaXplTW9kZTogQnJvd3NlclNpemVNb2RlXG4gICk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCBzZ0pzb24gPSBhcHBDb25maWcuc2NyZWVuR3JvdXBzPy5bY29udGVudElkXVxuICAgIGlmICghc2dKc29uKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIC8vIElmIHRoZSB2aWV3IGxheW91dCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgY3VycmVudCBzaXplTW9kZSwgd2UnbGwgY3JlYXRlIGEgbmV3IG9uZSBmb3IgdGhlbS5cbiAgICBzZ0pzb24uc2NyZWVucy5mb3JFYWNoKHNjcmVlbklkID0+IHtcbiAgICAgIGNvbnN0IHNjcmVlbkpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLnNjcmVlbnNbc2NyZWVuSWRdXG4gICAgICBpZiAoc2NyZWVuSnNvbi5tYWluLmxheW91dFtmcm9tU2l6ZU1vZGVdICYmICFzY3JlZW5Kc29uLm1haW4ubGF5b3V0W3RvU2l6ZU1vZGVdKSB7XG4gICAgICAgIGNvbnN0IGxheW91dEpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLmxheW91dHNbc2NyZWVuSnNvbi5tYWluLmxheW91dFtmcm9tU2l6ZU1vZGVdXVxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodXBkYXRlZEFwcENvbmZpZywgc2NyZWVuSnNvbi5tYWluLmxheW91dFtmcm9tU2l6ZU1vZGVdKVxuICAgICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRKc29uLmlkLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUsIG51bGwpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgY29uc3QgbGF5b3V0SWQgPSByZXN1bHRbMV1cbiAgICAgICAgaWYgKGxheW91dElkICE9IG51bGwpIHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIGxheW91dElkLCAncGFyZW50J10sIHsgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5TY3JlZW4sIGlkOiBzY3JlZW5JZCB9KVxuICAgICAgICAgICAgLnNldEluKFsnc2NyZWVucycsIHNjcmVlbklkLCAnbWFpbicsICdsYXlvdXQnLCB0b1NpemVNb2RlXSwgbGF5b3V0SWQpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzY3JlZW5Kc29uLnBhbmVsPy5sYXlvdXQ/Lltmcm9tU2l6ZU1vZGVdICYmICFzY3JlZW5Kc29uLnBhbmVsLmxheW91dFt0b1NpemVNb2RlXSkge1xuICAgICAgICBjb25zdCBsYXlvdXRKc29uID0gdXBkYXRlZEFwcENvbmZpZy5sYXlvdXRzW3NjcmVlbkpzb24ucGFuZWwubGF5b3V0W2Zyb21TaXplTW9kZV1dXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh1cGRhdGVkQXBwQ29uZmlnLCBzY3JlZW5Kc29uLnBhbmVsLmxheW91dFtmcm9tU2l6ZU1vZGVdKVxuICAgICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRKc29uLmlkLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUsIG51bGwpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgY29uc3QgbGF5b3V0SWQgPSByZXN1bHRbMV1cbiAgICAgICAgaWYgKGxheW91dElkICE9IG51bGwpIHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIGxheW91dElkLCAncGFyZW50J10sIHsgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5TY3JlZW4sIGlkOiBzY3JlZW5JZCB9KVxuICAgICAgICAgICAgLnNldEluKFsnc2NyZWVucycsIHNjcmVlbklkLCAncGFuZWwnLCAnbGF5b3V0JywgdG9TaXplTW9kZV0sIGxheW91dElkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgYWRkUGFyZW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgbGF5b3V0SW5mbzogTGF5b3V0SW5mbywgc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCBzZ0pzb24gPSBhcHBDb25maWcuc2NyZWVuR3JvdXBzW2NvbnRlbnRJZF1cbiAgICBpZiAoIXNnSnNvbikge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cbiAgICBjb25zb2xlLmRlYnVnKCdhZGQgcGFyZW50JywgbGF5b3V0SW5mby5sYXlvdXRJZCwgbGF5b3V0SW5mby5sYXlvdXRJdGVtSWQsICd0bycsIGNvbnRlbnRJZCwgJ2luJywgc2l6ZU1vZGUpXG4gICAgcmV0dXJuIGFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbkdyb3VwcycsIGNvbnRlbnRJZCwgJ3BhcmVudCcsIHNpemVNb2RlXSwgbGF5b3V0SW5mbylcbiAgfVxuXG4gIHJlbW92ZVBhcmVudCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIHNpemVNb2RlPzogQnJvd3NlclNpemVNb2RlXG4gICk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCBzZ0pzb24gPSBhcHBDb25maWcuc2NyZWVuR3JvdXBzW2NvbnRlbnRJZF1cbiAgICBpZiAoIXNnSnNvbiB8fCAhc2dKc29uLnBhcmVudCkge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBwYXJlbnQnLCBsYXlvdXRJbmZvLmxheW91dElkLCBsYXlvdXRJbmZvLmxheW91dEl0ZW1JZCwgJ2Zyb20nLCBjb250ZW50SWQpXG4gICAgaWYgKHNpemVNb2RlKSB7XG4gICAgICBjb25zdCBwYXJlbnQgPSBzZ0pzb24ucGFyZW50W3NpemVNb2RlXVxuICAgICAgaWYgKHBhcmVudD8ubGF5b3V0SWQgPT09IGxheW91dEluZm8ubGF5b3V0SWQgJiYgcGFyZW50Py5sYXlvdXRJdGVtSWQgPT09IGxheW91dEluZm8ubGF5b3V0SXRlbUlkKSB7XG4gICAgICAgIHJldHVybiBhcHBDb25maWcuc2V0SW4oWydzY3JlZW5Hcm91cHMnLCBjb250ZW50SWQsICdwYXJlbnQnXSwgc2dKc29uLnBhcmVudC53aXRob3V0KHNpemVNb2RlKSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG5cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICAgIE9iamVjdC5rZXlzKHNnSnNvbi5wYXJlbnQpLmZvckVhY2goKHMpID0+IHtcbiAgICAgIGNvbnN0IHBhcmVudCA9IHNnSnNvbi5wYXJlbnRbc11cbiAgICAgIGlmIChwYXJlbnQubGF5b3V0SWQgPT09IGxheW91dEluZm8ubGF5b3V0SWQgJiYgcGFyZW50LmxheW91dEl0ZW1JZCA9PT0gbGF5b3V0SW5mby5sYXlvdXRJdGVtSWQpIHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbkdyb3VwcycsIGNvbnRlbnRJZCwgJ3BhcmVudCddLCBzZ0pzb24ucGFyZW50LndpdGhvdXQocykpXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgY2xlYXJQYXJlbnQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGNvbnRlbnRJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHNnSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5Hcm91cHNbY29udGVudElkXVxuICAgIGlmICghc2dKc29uKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIHJldHVybiBhcHBDb25maWcuc2V0SW4oWydzY3JlZW5Hcm91cHMnLCBjb250ZW50SWRdLCBzZ0pzb24ud2l0aG91dCgncGFyZW50JykpXG4gIH1cblxuICByZW1vdmVTaXplTW9kZVBhcmVudCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZVxuICApOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2dKc29uID0gYXBwQ29uZmlnLnNjcmVlbkdyb3Vwc1tjb250ZW50SWRdXG4gICAgaWYgKCFzZ0pzb24gfHwgIXNnSnNvbi5wYXJlbnQ/Llticm93c2VyU2l6ZU1vZGVdKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIHJldHVybiBhcHBDb25maWcuc2V0SW4oWydzY3JlZW5Hcm91cHMnLCBjb250ZW50SWQsICdwYXJlbnQnXSwgc2dKc29uLnBhcmVudC53aXRob3V0KGJyb3dzZXJTaXplTW9kZSkpXG4gIH1cblxuICBmaW5kUGFyZW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IExheW91dEluZm8ge1xuICAgIGNvbnN0IHNnSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5Hcm91cHNbY29udGVudElkXVxuICAgIGlmICghc2dKc29uIHx8ICFzZ0pzb24ucGFyZW50KSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICAvLyBicm93c2VyU2l6ZU1vZGUgbWF5IGJlIG5vdCBhIGN1c3RvbSBsYXlvdXQsIGl0IGlzIHRyYW5zZm9ybWVkIGZyb20gbWFpblNpemVNb2RlXG4gICAgY29uc3Qgc2dQYXJlbnQgPSBzZ0pzb24ucGFyZW50W3NpemVNb2RlXSA/PyBzZ0pzb24ucGFyZW50W2FwcENvbmZpZy5tYWluU2l6ZU1vZGVdXG4gICAgcmV0dXJuIHNnUGFyZW50XG4gIH1cblxuICBkdXBsaWNhdGVTY3JlZW4gKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgc2dJZDogc3RyaW5nLFxuICAgIHNjcmVlbklkOiBzdHJpbmcsXG4gICAgc2l6ZU1vZGVMaXN0OiBCcm93c2VyU2l6ZU1vZGVbXSxcbiAgICBhZGRUb1NjcmVlbkdyb3VwOiBib29sZWFuLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogW2FwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld0lkOiBzdHJpbmddIHtcbiAgICBjb25zdCBzZ0pzb24gPSBhcHBDb25maWcuc2NyZWVuR3JvdXBzPy5bc2dJZF1cbiAgICBjb25zdCBzSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5zPy5bc2NyZWVuSWRdXG4gICAgLy8gc2NyZWVuIGdyb3VwIHNob3VsZCBjb250YWluIGF0IGxlYXN0IG9uZSBzY3JlZW5cbiAgICBpZiAoIXNKc29uIHx8ICFzZ0pzb24gfHwgIXNnSnNvbi5zY3JlZW5zLmluY2x1ZGVzKHNjcmVlbklkKSkge1xuICAgICAgcmV0dXJuIFthcHBDb25maWcsIG51bGxdXG4gICAgfVxuXG4gICAgY29uc29sZS5kZWJ1ZygnZHVwbGljYXRlIHNjcmVlbicsIHNjcmVlbklkLCAnaW4nLCBzaXplTW9kZUxpc3QsICd0bycsIHNnSWQpXG4gICAgbGV0IHNjcmVlbkpzb24gPSBzSnNvblxuICAgICAgLnNldCgnaWQnLCBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVJZChhcHBDb25maWcsICdzY3JlZW4nKSlcbiAgICAgIC5zZXQoJ2xhYmVsJywgZ2V0RHVwbGljYXRlTGFiZWwoYXBwQ29uZmlnLCAnc2NyZWVuJywgc0pzb24ubGFiZWwpKVxuICAgIGlmICghYWRkVG9TY3JlZW5Hcm91cCkge1xuICAgICAgc2NyZWVuSnNvbiA9IHNjcmVlbkpzb24ud2l0aG91dCgncGFyZW50JylcbiAgICB9XG4gICAgLy8gbXVzdCBzYXZlIGludG8gYXBwY29uZmlnIGJlZm9yZSBkdXBsaWNhdGUgaXRlcmF0aW9uLCBvciBpdCdzIGNvbnRlbnQgc2VjdGlvbiB3aWxsIGdldCBzYW1lIHNlY3Rpb24gaWQgdG8gaXRzZWxmIGJ5IGdldFVuaXF1ZUlkLlxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnLnNldEluKFsnc2NyZWVucycsIHNjcmVlbkpzb24uaWRdLCBzY3JlZW5Kc29uKVxuXG4gICAgLy8gZHVwbGljYXRlIHNjcmVlbiBsYXlvdXRcbiAgICBjb25zdCBtYWluU2l6ZU1vZGVMYXlvdXRzID0ge31cbiAgICBzaXplTW9kZUxpc3QuZm9yRWFjaChtb2RlID0+IHsgbWFpblNpemVNb2RlTGF5b3V0c1ttb2RlXSA9IHNjcmVlbkpzb24ubWFpbi5sYXlvdXRbbW9kZV0gfSlcbiAgICBjb25zdCBkdXBsaWNhdGVDb250ZXh0ID0gY29udGV4dCA/PyB7fVxuICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZUZyb21TaXplTW9kZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBtYWluU2l6ZU1vZGVMYXlvdXRzIGFzIGFueSlcbiAgICBjb25zdCBkdXBsaWNhdGVSZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZVNpemVNb2RlTGF5b3V0cyh1cGRhdGVkQXBwQ29uZmlnLCBtYWluU2l6ZU1vZGVMYXlvdXRzIGFzIGFueSwgTGF5b3V0UGFyZW50VHlwZS5TY3JlZW4sIHNjcmVlbkpzb24uaWQsIGR1cGxpY2F0ZUNvbnRleHQpXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IGR1cGxpY2F0ZVJlc3VsdFswXVxuICAgIHNjcmVlbkpzb24gPSBzY3JlZW5Kc29uLnNldEluKFsnbWFpbicsICdsYXlvdXQnXSwgZHVwbGljYXRlUmVzdWx0WzFdKVxuXG4gICAgaWYgKHNjcmVlbkpzb24ucGFuZWw/LmxheW91dCkge1xuICAgICAgY29uc3QgcGFuZWxTaXplTW9kZUxheW91dHMgPSB7fVxuICAgICAgc2l6ZU1vZGVMaXN0LmZvckVhY2gobW9kZSA9PiB7IHBhbmVsU2l6ZU1vZGVMYXlvdXRzW21vZGVdID0gc2NyZWVuSnNvbi5wYW5lbC5sYXlvdXRbbW9kZV0gfSlcbiAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZUZyb21TaXplTW9kZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBwYW5lbFNpemVNb2RlTGF5b3V0cyBhcyBhbnkpXG4gICAgICBjb25zdCBkdXBsaWNhdGVSZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZVNpemVNb2RlTGF5b3V0cyh1cGRhdGVkQXBwQ29uZmlnLCBwYW5lbFNpemVNb2RlTGF5b3V0cyBhcyBhbnksIExheW91dFBhcmVudFR5cGUuU2NyZWVuLCBzY3JlZW5Kc29uLmlkLCBkdXBsaWNhdGVDb250ZXh0KVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IGR1cGxpY2F0ZVJlc3VsdFswXVxuICAgICAgc2NyZWVuSnNvbiA9IHNjcmVlbkpzb24uc2V0SW4oWydwYW5lbCcsICdsYXlvdXQnXSwgZHVwbGljYXRlUmVzdWx0WzFdKVxuICAgIH1cblxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnc2NyZWVucycsIHNjcmVlbkpzb24uaWRdLCBzY3JlZW5Kc29uKVxuXG4gICAgaWYgKGFkZFRvU2NyZWVuR3JvdXApIHtcbiAgICAgIGNvbnN0IHNjcmVlbnMgPSBzZ0pzb24uc2NyZWVucy5hc011dGFibGUoKVxuICAgICAgY29uc3QgaW5kZXggPSBzY3JlZW5zLmluZGV4T2Yoc2NyZWVuSWQpXG4gICAgICBzY3JlZW5zLnNwbGljZShpbmRleCwgMSwgc2NyZWVuSWQsIHNjcmVlbkpzb24uaWQpXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3NjcmVlbkdyb3VwcycsIHNnSWQsICdzY3JlZW5zJ10sIHNjcmVlbnMpXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgIGNvbnRleHRbc2NyZWVuSWRdID0gc2NyZWVuSnNvbi5pZFxuICAgIH1cblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgc2NyZWVuSnNvbi5pZF1cbiAgfVxuXG4gIHJlbW92ZVNjcmVlbiAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcsIHNjcmVlbklkOiBzdHJpbmcpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2dKc29uID0gYXBwQ29uZmlnLnNjcmVlbkdyb3Vwcz8uW2NvbnRlbnRJZF1cbiAgICBjb25zdCBzSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5zPy5bc2NyZWVuSWRdXG4gICAgLy8gc2NyZWVuIGdyb3VwIHNob3VsZCBjb250YWluIGF0IGxlYXN0IG9uZSBzY3JlZW5cbiAgICBpZiAoIXNKc29uIHx8ICFzZ0pzb24gfHwgc2dKc29uLnNjcmVlbnMubGVuZ3RoID09PSAxIHx8ICFzZ0pzb24uc2NyZWVucy5pbmNsdWRlcyhzY3JlZW5JZCkpIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG5cbiAgICBjb25zb2xlLmRlYnVnKCdyZW1vdmUgc2NyZWVuJywgc2NyZWVuSWQsICdpbicsIGNvbnRlbnRJZClcbiAgICAvLyByZW1vdmUgZnJvbSBzY3JlZW5Hcm91cC5zY3JlZW5zXG4gICAgY29uc3Qgc2NyZWVucyA9IHNnSnNvbi5zY3JlZW5zLmZpbHRlcigoc0lkKSA9PiBzSWQgIT09IHNjcmVlbklkKVxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnLnNldEluKFsnc2NyZWVuR3JvdXBzJywgY29udGVudElkLCAnc2NyZWVucyddLCBzY3JlZW5zKVxuXG4gICAgLy8gcmVtb3ZlIHNjcmVlbiBsYXlvdXRcbiAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgc0pzb24ubWFpbi5sYXlvdXQpXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHNlcnZpY2UucmVtb3ZlU2l6ZU1vZGVMYXlvdXRzKHVwZGF0ZWRBcHBDb25maWcsIHNKc29uLm1haW4ubGF5b3V0KVxuICAgIGlmIChzSnNvbi5wYW5lbCkge1xuICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlRnJvbVNpemVNb2RlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIHNKc29uLnBhbmVsLmxheW91dClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBzZXJ2aWNlLnJlbW92ZVNpemVNb2RlTGF5b3V0cyh1cGRhdGVkQXBwQ29uZmlnLCBzSnNvbi5wYW5lbC5sYXlvdXQpXG4gICAgfVxuXG4gICAgLy8gcmVtb3ZlIGZyb20gc2NyZWVuIGxpc3RcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXQoJ3NjcmVlbnMnLCB1cGRhdGVkQXBwQ29uZmlnLnNjcmVlbnMud2l0aG91dChzY3JlZW5JZCkpXG5cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBTY3JlZW5Hcm91cFNlcnZpY2UoKVxuIiwiaW1wb3J0IHtcbiAgdHlwZSBJTUFwcENvbmZpZyxcbiAgdHlwZSBMYXlvdXRJbmZvLFxuICBCcm93c2VyU2l6ZU1vZGUsXG4gIHR5cGUgU2VjdGlvbkpzb24sXG4gIHR5cGUgVmlld0pzb24sXG4gIExheW91dFBhcmVudFR5cGUsXG4gIGkxOG4sXG4gIExheW91dFR5cGVcbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgQmFzZUNvbnRlbnRTZXJ2aWNlLCB0eXBlIER1cGxpY2F0ZUNvbnRleHQgfSBmcm9tICcuL2Jhc2UtY29udGVudC1zZXJ2aWNlJ1xuaW1wb3J0ICogYXMgYXBwQ29uZmlnVXRpbHMgZnJvbSAnLi4vdXRpbHMvYXBwLWNvbmZpZy11dGlscydcbmltcG9ydCB7IGdldER1cGxpY2F0ZUxhYmVsLCBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnIH0gZnJvbSAnLi91dGlsJ1xuaW1wb3J0IHdpZGdldFNlcnZpY2UgZnJvbSAnLi93aWRnZXQtc2VydmljZSdcbmltcG9ydCB7IHR5cGUgVGVtcGxhdGUgfSBmcm9tICcuLi90ZW1wbGF0ZXMnXG5pbXBvcnQgeyBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIgfSBmcm9tICcuL2xheW91dC1zZXJ2aWNlLXByb3ZpZGVyJ1xuaW1wb3J0IHsgdHlwZSBUb2NOb2RlIH0gZnJvbSAnLi9iYXNlLWxheW91dC1zZXJ2aWNlJ1xuaW1wb3J0IHNlY3Rpb25PdXRsaW5lZCBmcm9tICdqaW11LWljb25zL3N2Zy9vdXRsaW5lZC9icmFuZC93aWRnZXQtc2VjdGlvbi5zdmcnXG5pbXBvcnQgdmlld091dGxpbmVkIGZyb20gJ2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3dpZGdldC1zZWN0aW9uLXZpZXcuc3ZnJ1xuXG5leHBvcnQgY2xhc3MgU2VjdGlvblNlcnZpY2UgZXh0ZW5kcyBCYXNlQ29udGVudFNlcnZpY2Uge1xuICBhc3luYyBjcmVhdGVGcm9tVGVtcGxhdGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgdGVtcGxhdGVKc29uOiBUZW1wbGF0ZSxcbiAgICBzZWN0aW9uSWQ6IHN0cmluZyxcbiAgICBzaXplTW9kZUxpc3Q6IEJyb3dzZXJTaXplTW9kZVtdLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogUHJvbWlzZTxbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbmV3SWQ6IHN0cmluZ10+IHtcbiAgICBpZiAoY29udGV4dFtzZWN0aW9uSWRdKSB7XG4gICAgICAvLyBhbHJlYWR5IGR1cGxpY2F0ZCBpbiBhIHN0YWNrIG9mIGZ1bmN0aW9uIGludm9rYXRpb25zLlxuICAgICAgLy8gVXNlIGNhc2U6IEEgc2VjdGlvbiBpcyBzaGFyZWQgaW4gYSBwYWdlJ3MgTGFyZ2UgYW5kIFNtYWxsIHNpemUgbW9kZSwgYW5kIHRoZSBwYWdlIGlzIGR1cGxpY2F0ZWQuXG4gICAgICAvLyAxLiBzZWN0aW9uIGlzIGR1cGxpY2F0ZWQgaW4gTGFyZ2Ugc2l6ZSBtb2RlLCB2aWV3IGxheW91dCBpcyBkdXBsaWNhdGVkIGluIExhcmdlIHNpemUgbW9kZSB0b28uXG4gICAgICAvLyAyLiB3aGVuIGR1cGxpY2F0ZSB0aGUgc21hbGwgc2l6ZSBtb2RlLCB0aGUgc2VjdGlvbiBkb2VzIG5vdCBuZWVkIHRvIGJlIGR1cGxpY2F0ZWQgYWdhaW4sIGJ1dCB0aGUgdmlldyBsYXlvdXQgbmVlZHMgdG8gYmUgZHVwbGljYXRlZC5cblxuICAgICAgLy8gY2hlY2sgdGhlIGR1cGxpY2F0ZWQgc2VjdGlvbiBoYXMgdGhlIHRhcmdldCBicm93c2VyIHNpemUgbW9kZSBsYXlvdXRcbiAgICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gYXBwQ29uZmlnLnNlY3Rpb25zW2NvbnRleHRbc2VjdGlvbklkXV1cbiAgICAgIGNvbnN0IGZpcnN0VmlldyA9IGFwcENvbmZpZy52aWV3c1tzZWN0aW9uSnNvbi52aWV3c1swXV1cbiAgICAgIC8vIGR1cGxpY2F0ZSBlbWJlZCBsYXlvdXQgaW4gdGFyZ2V0IGJyb3dzZXIgc2l6ZSBtb2RlIGZyb20gb3JpZ2luYWwgc2VjdGlvbiB0byBkdXBsaWNhdGVkIHNlY3Rpb25cbiAgICAgIGNvbnN0IG9yaWdpblNlY3Rpb24gPSB0ZW1wbGF0ZUpzb24uY29uZmlnLnNlY3Rpb25zW3NlY3Rpb25JZF1cbiAgICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZU1vZGVMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHNpemVNb2RlID0gc2l6ZU1vZGVMaXN0W2ldXG4gICAgICAgIGlmIChmaXJzdFZpZXcubGF5b3V0W3NpemVNb2RlXSkge1xuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBvcmlnaW5TZWN0aW9uLnZpZXdzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgY29uc3Qgdmlld0lkID0gb3JpZ2luU2VjdGlvbi52aWV3c1tqXVxuICAgICAgICAgIGNvbnN0IHZpZXdKc29uID0gdGVtcGxhdGVKc29uLmNvbmZpZy52aWV3c1t2aWV3SWRdXG4gICAgICAgICAgY29uc3QgbGF5b3V0SWQgPSB2aWV3SnNvbi5sYXlvdXRbc2l6ZU1vZGVdXG4gICAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55LCBsYXlvdXRJZClcblxuICAgICAgICAgIGNvbnN0IGR1cFJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlTGF5b3V0RnJvbVRlbXBsYXRlKFxuICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyxcbiAgICAgICAgICAgIHRlbXBsYXRlSnNvbixcbiAgICAgICAgICAgIGxheW91dElkLFxuICAgICAgICAgICAgc2l6ZU1vZGUsXG4gICAgICAgICAgICBMYXlvdXRQYXJlbnRUeXBlLlZpZXcsXG4gICAgICAgICAgICBjb250ZXh0W3ZpZXdJZF0sXG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgICAgKVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBkdXBSZXN1bHRbMF1cbiAgICAgICAgICBjb25zdCBuZXdMYXlvdXRJZCA9IGR1cFJlc3VsdFsxXVxuICAgICAgICAgIGlmIChuZXdMYXlvdXRJZCAhPSBudWxsKSB7XG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3ZpZXdzJywgY29udGV4dFt2aWV3SWRdLCAnbGF5b3V0Jywgc2l6ZU1vZGVdLCBuZXdMYXlvdXRJZClcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgY29udGV4dFtzZWN0aW9uSWRdXVxuICAgIH1cblxuICAgIGF3YWl0IG1ha2VTdXJlVGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uKVxuXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcbiAgICBjb25zdCB0ZW1wbGF0ZUNvbmZpZyA9IHRlbXBsYXRlSnNvbi5jb25maWdcbiAgICBjb25zdCB0ZW1wbGF0ZVNlY3Rpb24gPSB0ZW1wbGF0ZUNvbmZpZy5zZWN0aW9uc1tzZWN0aW9uSWRdXG4gICAgY29uc3QgbmV4dFNlY3Rpb25JZCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3NlY3Rpb24nKVxuXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydzZWN0aW9ucycsIG5leHRTZWN0aW9uSWRdLCB0ZW1wbGF0ZVNlY3Rpb24pXG4gICAgICAuc2V0SW4oWydzZWN0aW9ucycsIG5leHRTZWN0aW9uSWQsICdpZCddLCBuZXh0U2VjdGlvbklkKVxuICAgICAgLnNldEluKFsnc2VjdGlvbnMnLCBuZXh0U2VjdGlvbklkLCAnbGFiZWwnXSwgYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlTGFiZWwoYXBwQ29uZmlnLCAnc2VjdGlvbicsIGkxOG4uZ2V0SW50bCgpLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ3NlY3Rpb24nIH0pKSlcblxuICAgIGNvbnN0IG5ld1ZpZXdJZHMgPSBbXVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcGxhdGVTZWN0aW9uLnZpZXdzLmxlbmd0aDsgaSArPSAxKSB7IC8vIGF3YWl0cyBpbiBhIGZvci1sb29wIHNob3VsZCBnZXQgZXhlY3V0ZWQgaW4gc2VyaWVzXG4gICAgICBjb25zdCB2aWV3SWQgPSB0ZW1wbGF0ZVNlY3Rpb24udmlld3NbaV1cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuY3JlYXRlVmlld0Zyb21UZW1wbGF0ZSh1cGRhdGVkQXBwQ29uZmlnLCB0ZW1wbGF0ZUpzb24sIHZpZXdJZCwgc2l6ZU1vZGVMaXN0LCBjb250ZXh0KVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgbmV3Vmlld0lkcy5wdXNoKHJlc3VsdFsxXSlcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsndmlld3MnLCByZXN1bHRbMV0sICdwYXJlbnQnXSwgbmV4dFNlY3Rpb25JZClcbiAgICB9XG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oXG4gICAgICBbJ3NlY3Rpb25zJywgbmV4dFNlY3Rpb25JZCwgJ3ZpZXdzJ10sXG4gICAgICBuZXdWaWV3SWRzKVxuXG4gICAgY29udGV4dFtzZWN0aW9uSWRdID0gbmV4dFNlY3Rpb25JZFxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBuZXh0U2VjdGlvbklkXVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVWaWV3RnJvbVRlbXBsYXRlIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIHRlbXBsYXRlSnNvbjogVGVtcGxhdGUsXG4gICAgdmlld0lkOiBzdHJpbmcsXG4gICAgc2l6ZU1vZGVMaXN0OiBCcm93c2VyU2l6ZU1vZGVbXSxcbiAgICBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFByb21pc2U8W2FwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld1ZpZXdJZDogc3RyaW5nXT4ge1xuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG5cbiAgICBhd2FpdCBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnKHRlbXBsYXRlSnNvbilcblxuICAgIGNvbnN0IHRlbXBsYXRlQ29uZmlnID0gdGVtcGxhdGVKc29uLmNvbmZpZ1xuICAgIGNvbnN0IHRlbXBsYXRlVmlldyA9IHRlbXBsYXRlQ29uZmlnLnZpZXdzW3ZpZXdJZF1cbiAgICBjb25zdCBuZXh0Vmlld0lkID0gYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAndmlldycpXG5cbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgLnNldEluKFsndmlld3MnLCBuZXh0Vmlld0lkXSwgdGVtcGxhdGVWaWV3KVxuICAgICAgLnNldEluKFsndmlld3MnLCBuZXh0Vmlld0lkLCAnaWQnXSwgbmV4dFZpZXdJZClcbiAgICAgIC5zZXRJbihbJ3ZpZXdzJywgbmV4dFZpZXdJZCwgJ2xhYmVsJ10sIGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUxhYmVsKGFwcENvbmZpZywgJ3ZpZXcnLCBpMThuLmdldEludGwoKS5mb3JtYXRNZXNzYWdlKHsgaWQ6ICd2aWV3JyB9KSkpXG5cbiAgICBjb25zdCBsYXlvdXRJZHMgPSBbXVxuICAgIE9iamVjdC5rZXlzKHRlbXBsYXRlVmlldy5sYXlvdXQgfHwge30pLmZvckVhY2goKHNpemVNb2RlKSA9PiB7XG4gICAgICBsYXlvdXRJZHMucHVzaCh7XG4gICAgICAgIHNpemVNb2RlLFxuICAgICAgICBsYXlvdXRJZDogdGVtcGxhdGVWaWV3LmxheW91dFtzaXplTW9kZV1cbiAgICAgIH0pXG4gICAgfSlcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGF5b3V0SWRzLmxlbmd0aDsgaSArPSAxKSB7IC8vIGF3YWl0cyBpbiBhIGZvci1sb29wIHNob3VsZCBnZXQgZXhlY3V0ZWQgaW4gc2VyaWVzXG4gICAgICBjb25zdCB7IHNpemVNb2RlLCBsYXlvdXRJZCB9ID0gbGF5b3V0SWRzW2ldXG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGVtcGxhdGVDb25maWcgYXMgYW55LCBsYXlvdXRJZClcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlTGF5b3V0RnJvbVRlbXBsYXRlKFxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgICB0ZW1wbGF0ZUpzb24sXG4gICAgICAgIGxheW91dElkLFxuICAgICAgICBzaXplTW9kZSxcbiAgICAgICAgTGF5b3V0UGFyZW50VHlwZS5WaWV3LFxuICAgICAgICBuZXh0Vmlld0lkLFxuICAgICAgICBjb250ZXh0XG4gICAgICApXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgICBjb25zdCBuZXdMYXlvdXRJZCA9IHJlc3VsdFsxXVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oXG4gICAgICAgIFsndmlld3MnLCBuZXh0Vmlld0lkLCAnbGF5b3V0Jywgc2l6ZU1vZGVdLFxuICAgICAgICBuZXdMYXlvdXRJZClcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCkge1xuICAgICAgY29udGV4dFt2aWV3SWRdID0gbmV4dFZpZXdJZFxuICAgIH1cblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV4dFZpZXdJZF1cbiAgfVxuXG4gIGR1cGxpY2F0ZUVtYmVkTGF5b3V0IChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIHRvU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZVxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbmV3Q29udGVudElkOiBzdHJpbmddIHtcbiAgICBjb25zdCBzZWN0aW9uSnNvbiA9IGFwcENvbmZpZy5zZWN0aW9ucz8uW2NvbnRlbnRJZF1cbiAgICBpZiAoIXNlY3Rpb25Kc29uKSB7XG4gICAgICByZXR1cm4gW2FwcENvbmZpZywgbnVsbF1cbiAgICB9XG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIGNvbnNvbGUuZGVidWcoYGR1cGxpY2F0ZSBzZWN0aW9uICR7Y29udGVudElkfSBmcm9tICR7ZnJvbVNpemVNb2RlfSB0byAke3RvU2l6ZU1vZGV9YClcbiAgICBzZWN0aW9uSnNvbi52aWV3cy5mb3JFYWNoKHZpZXdJZCA9PiB7XG4gICAgICBjb25zdCB2aWV3SnNvbiA9IHVwZGF0ZWRBcHBDb25maWcudmlld3Nbdmlld0lkXVxuICAgICAgY29uc3QgbGF5b3V0cyA9IHZpZXdKc29uLmxheW91dFxuICAgICAgaWYgKGxheW91dHNbZnJvbVNpemVNb2RlXSAmJiAhbGF5b3V0c1t0b1NpemVNb2RlXSkge1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0c1tmcm9tU2l6ZU1vZGVdKVxuICAgICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRzW2Zyb21TaXplTW9kZV0sIGZyb21TaXplTW9kZSwgdG9TaXplTW9kZSwgbnVsbCwgZmFsc2UpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgY29uc3QgbmV3TGF5b3V0SWQgPSByZXN1bHRbMV1cbiAgICAgICAgaWYgKG5ld0xheW91dElkICE9IG51bGwpIHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIG5ld0xheW91dElkLCAncGFyZW50J10sIHsgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5WaWV3LCBpZDogdmlld0lkIH0pXG4gICAgICAgICAgICAuc2V0SW4oWyd2aWV3cycsIHZpZXdJZCwgJ2xheW91dCcsIHRvU2l6ZU1vZGVdLCBuZXdMYXlvdXRJZClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIG51bGxdXG4gIH1cblxuICAvKipcbiAgICogRHVwbGljYXRlIGEgc2VjdGlvbiwgb25seSBkdXBsaWNhdGUgdGhlIGNvbnRlbnQgaW4gdGFyZ2V0IGJyb3dzZXIgc2l6ZSBtb2RlLlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBjb250ZW50SWQgaWQgb2YgdGhlIHNlY3Rpb25cbiAgICogQHBhcmFtIGNvbnRleHQgZHVwbGljYXRpbmcgY29udGV4dCwga2VlcHMgdGhlIHJlbGF0aW9uIGJldHdlZW4gb3JpZ2luYWwgaWQgYW5kIGR1cGxpY2F0ZWQgaWRcbiAgICogQHJldHVybnMgdXBkYXRkIGFwcCBjb25maWcgYW5kIHRoZSBpZCBvZiB0aGUgZHVwbGljYXRlZCBzZWN0aW9uXG4gICAqL1xuICBkdXBsaWNhdGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgdGFyZ2V0QnJvd3NlclNpemU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdJZDogc3RyaW5nXSB7XG4gICAgY29uc29sZS5kZWJ1ZygnZHBsaWNhdGUgc2VjdGlvbicsIGNvbnRlbnRJZCwgJ2luJywgdGFyZ2V0QnJvd3NlclNpemUpXG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSBhcHBDb25maWcuc2VjdGlvbnM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZWN0aW9uSnNvbikge1xuICAgICAgcmV0dXJuIFthcHBDb25maWcsIG51bGxdXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQ/Lltjb250ZW50SWRdKSB7XG4gICAgICAvLyBhbHJlYWR5IGR1cGxpY2F0ZCBpbiBhIHN0YWNrIG9mIGZ1bmN0aW9uIGludm9rYXRpb25zLlxuICAgICAgLy8gVXNlIGNhc2U6IEEgc2VjdGlvbiBpcyBzaGFyZWQgaW4gYSBwYWdlJ3MgTGFyZ2UgYW5kIFNtYWxsIHNpemUgbW9kZSwgYW5kIHRoZSBwYWdlIGlzIGR1cGxpY2F0ZWQuXG4gICAgICAvLyAxLiBzZWN0aW9uIGlzIGR1cGxpY2F0ZWQgaW4gTGFyZ2Ugc2l6ZSBtb2RlLCB2aWV3IGxheW91dCBpcyBkdXBsaWNhdGVkIGluIExhcmdlIHNpemUgbW9kZSB0b28uXG4gICAgICAvLyAyLiB3aGVuIGR1cGxpY2F0ZSB0aGUgc21hbGwgc2l6ZSBtb2RlLCB0aGUgc2VjdGlvbiBkb2VzIG5vdCBuZWVkIHRvIGJlIGR1cGxpY2F0ZWQgYWdhaW4sIGJ1dCB0aGUgdmlldyBsYXlvdXQgbmVlZHMgdG8gYmUgZHVwbGljYXRlZC5cblxuICAgICAgLy8gY2hlY2sgdGhlIGR1cGxpY2F0ZWQgc2VjdGlvbiBoYXMgdGhlIHRhcmdldCBicm93c2VyIHNpemUgbW9kZSBsYXlvdXRcbiAgICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gYXBwQ29uZmlnLnNlY3Rpb25zW2NvbnRleHRbY29udGVudElkXV1cbiAgICAgIGNvbnN0IGZpcnN0VmlldyA9IGFwcENvbmZpZy52aWV3c1tzZWN0aW9uSnNvbi52aWV3c1swXV1cbiAgICAgIGlmIChmaXJzdFZpZXcubGF5b3V0W3RhcmdldEJyb3dzZXJTaXplXSkge1xuICAgICAgICByZXR1cm4gW2FwcENvbmZpZywgY29udGV4dFtjb250ZW50SWRdXVxuICAgICAgfVxuICAgICAgLy8gZHVwbGljYXRlIGVtYmVkIGxheW91dCBpbiB0YXJnZXQgYnJvd3NlciBzaXplIG1vZGUgZnJvbSBvcmlnaW5hbCBzZWN0aW9uIHRvIGR1cGxpY2F0ZWQgc2VjdGlvblxuICAgICAgY29uc3Qgb3JpZ2luU2VjdGlvbiA9IGFwcENvbmZpZy5zZWN0aW9uc1tjb250ZW50SWRdXG4gICAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICAgICAgb3JpZ2luU2VjdGlvbi52aWV3cy5mb3JFYWNoKHZpZXdJZCA9PiB7XG4gICAgICAgIGNvbnN0IHZpZXdKc29uID0gdXBkYXRlZEFwcENvbmZpZy52aWV3c1t2aWV3SWRdXG4gICAgICAgIGNvbnN0IGxheW91dElkID0gdmlld0pzb24ubGF5b3V0W3RhcmdldEJyb3dzZXJTaXplXVxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SWQpXG4gICAgICAgIGNvbnN0IGR1cFJlc3VsdCA9IHNlcnZpY2UuZHVwbGljYXRlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIGxheW91dElkLCB0YXJnZXRCcm93c2VyU2l6ZSwgdGFyZ2V0QnJvd3NlclNpemUsIGNvbnRleHQsIHRydWUpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBkdXBSZXN1bHRbMF1cbiAgICAgICAgY29uc3QgbmV3TGF5b3V0SWQgPSBkdXBSZXN1bHRbMV1cbiAgICAgICAgaWYgKG5ld0xheW91dElkICE9IG51bGwpIHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgICAgICAgLnNldEluKFsndmlld3MnLCBjb250ZXh0W3ZpZXdJZF0sICdsYXlvdXQnLCB0YXJnZXRCcm93c2VyU2l6ZV0sIG5ld0xheW91dElkKVxuICAgICAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIG5ld0xheW91dElkLCAncGFyZW50J10sIHsgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5WaWV3LCBpZDogY29udGV4dFt2aWV3SWRdIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIGNvbnRleHRbY29udGVudElkXV1cbiAgICB9XG5cbiAgICBsZXQgbmV3U2VjdGlvbkpzb24gPSBzZWN0aW9uSnNvblxuICAgICAgLnNldCgnaWQnLCBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVJZChhcHBDb25maWcsICdzZWN0aW9uJykpXG4gICAgICAuc2V0KCdsYWJlbCcsIGdldER1cGxpY2F0ZUxhYmVsKGFwcENvbmZpZywgJ3NlY3Rpb24nLCBzZWN0aW9uSnNvbi5sYWJlbCkpXG5cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgbmV3U2VjdGlvbkpzb24uaWRdLCBuZXdTZWN0aW9uSnNvbilcblxuICAgIGNvbnN0IHZpZXdJZHMgPSBzZWN0aW9uSnNvbi52aWV3cy5tYXAoKHZpZXdJZCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5kdXBsaWNhdGVWaWV3KFxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgICBzZWN0aW9uSnNvbi5pZCxcbiAgICAgICAgdmlld0lkLFxuICAgICAgICBbdGFyZ2V0QnJvd3NlclNpemVdLFxuICAgICAgICBmYWxzZSxcbiAgICAgICAgY29udGV4dFxuICAgICAgKVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgY29uc3QgbmV3Vmlld0lkID0gcmVzdWx0WzFdXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3ZpZXdzJywgbmV3Vmlld0lkLCAncGFyZW50J10sIG5ld1NlY3Rpb25Kc29uLmlkKVxuICAgICAgcmV0dXJuIG5ld1ZpZXdJZFxuICAgIH0pXG5cbiAgICBuZXdTZWN0aW9uSnNvbiA9IG5ld1NlY3Rpb25Kc29uLnNldCgndmlld3MnLCB2aWV3SWRzKVxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnc2VjdGlvbnMnLCBuZXdTZWN0aW9uSnNvbi5pZF0sIG5ld1NlY3Rpb25Kc29uKVxuXG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgIGNvbnRleHRbY29udGVudElkXSA9IG5ld1NlY3Rpb25Kc29uLmlkXG4gICAgfVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBuZXdTZWN0aW9uSnNvbi5pZF1cbiAgfVxuXG4gIHByaXZhdGUgcmVtb3ZlRGlyZWN0bHkgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGNvbnRlbnRJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gYXBwQ29uZmlnLnNlY3Rpb25zPy5bY29udGVudElkXVxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG5cbiAgICAvLyByZW1vdmUgdmlld3NcbiAgICBzZWN0aW9uSnNvbi52aWV3cy5mb3JFYWNoKCh2aWV3SWQpID0+IHtcbiAgICAgIGNvbnN0IHZpZXdKc29uID0gdXBkYXRlZEFwcENvbmZpZy52aWV3c1t2aWV3SWRdXG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgdmlld0pzb24ubGF5b3V0KVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHNlcnZpY2UucmVtb3ZlU2l6ZU1vZGVMYXlvdXRzKHVwZGF0ZWRBcHBDb25maWcsIHZpZXdKc29uLmxheW91dClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldCgndmlld3MnLCB1cGRhdGVkQXBwQ29uZmlnLnZpZXdzLndpdGhvdXQodmlld0lkKSlcbiAgICB9KVxuXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0KCdzZWN0aW9ucycsIHVwZGF0ZWRBcHBDb25maWcuc2VjdGlvbnMud2l0aG91dChjb250ZW50SWQpKVxuXG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxuXG4gIHRyeVJlbW92ZSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcsIGxheW91dEluZm86IExheW91dEluZm8sIHNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSBhcHBDb25maWcuc2VjdGlvbnM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZWN0aW9uSnNvbikge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cbiAgICBjb25zb2xlLmRlYnVnKGByZW1vdmUgc2VjdGlvbiAke2NvbnRlbnRJZH0gZnJvbSAke2xheW91dEluZm8ubGF5b3V0SWR9ICR7bGF5b3V0SW5mby5sYXlvdXRJdGVtSWR9YCwgc2l6ZU1vZGUpXG4gICAgLy8gMS4gY3VycmVudCBzaXplIG1vZGUgcGFzc2VkLCBjaGVjayBvdGhlciBzaXplIG1vZGVcbiAgICBjb25zdCBoYXNPdGhlck1vZGVzID0gW0Jyb3dzZXJTaXplTW9kZS5MYXJnZSwgQnJvd3NlclNpemVNb2RlLk1lZGl1bSwgQnJvd3NlclNpemVNb2RlLlNtYWxsXVxuICAgICAgLmZpbHRlcihtb2RlID0+IG1vZGUgIT09IHNpemVNb2RlKVxuICAgICAgLnNvbWUobW9kZSA9PiBzZWN0aW9uSnNvbi5wYXJlbnQ/Llttb2RlXT8ubGVuZ3RoID4gMClcblxuICAgIGlmICghaGFzT3RoZXJNb2RlcykgeyAvLyBjYW4gYmUgcmVtb3ZlZFxuICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlKGFwcENvbmZpZywgY29udGVudElkKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyAxLiByZW1vdmUgcGFyZW50IGZvciB0aGlzIHNpemUgbW9kZVxuICAgICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLnJlbW92ZVBhcmVudChhcHBDb25maWcsIGNvbnRlbnRJZCwgbGF5b3V0SW5mbywgc2l6ZU1vZGUpXG4gICAgICAvLyAyLiByZW1vdmUgZW1iZWQgbGF5b3V0IG9mIHRoaXMgc2l6ZSBtb2RlIGlmIGFueVxuICAgICAgc2VjdGlvbkpzb24udmlld3MuZm9yRWFjaCgodmlld0lkKSA9PiB7XG4gICAgICAgIGNvbnN0IHZpZXdKc29uID0gdXBkYXRlZEFwcENvbmZpZy52aWV3c1t2aWV3SWRdXG4gICAgICAgIGlmICh2aWV3SnNvbi5sYXlvdXRbc2l6ZU1vZGVdKSB7XG4gICAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlRnJvbVNpemVNb2RlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIHZpZXdKc29uLmxheW91dClcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZS5yZW1vdmVTaXplTW9kZUxheW91dHModXBkYXRlZEFwcENvbmZpZywgeyBbc2l6ZU1vZGVdOiB2aWV3SnNvbi5sYXlvdXRbc2l6ZU1vZGVdIH0gYXMgYW55KVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsndmlld3MnLCB2aWV3SWQsICdsYXlvdXQnXSwgdmlld0pzb24ubGF5b3V0LndpdGhvdXQoc2l6ZU1vZGUpKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGEgc2VjdGlvblxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBjb250ZW50SWQgaWQgb2YgdGhlIHNlY3Rpb25cbiAgICogQHJldHVybnMgdXBkYXRkIGFwcCBjb25maWdcbiAgICovXG4gIHJlbW92ZSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSBhcHBDb25maWcuc2VjdGlvbnM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZWN0aW9uSnNvbikge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBzZWN0aW9uJywgY29udGVudElkKVxuICAgIC8vIHJlbW92ZSBhbGwgcGFyZW50IGxheW91dCBpbmZvc1xuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgT2JqZWN0LmtleXMoc2VjdGlvbkpzb24ucGFyZW50ID8/IHt9KS5mb3JFYWNoKChzaXplTW9kZTogQnJvd3NlclNpemVNb2RlKSA9PiB7XG4gICAgICBpZiAoc2VjdGlvbkpzb24ucGFyZW50W3NpemVNb2RlXS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNlY3Rpb25Kc29uLnBhcmVudFtzaXplTW9kZV0uZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICBjb25zdCBsYXlvdXRKc29uID0gdXBkYXRlZEFwcENvbmZpZy5sYXlvdXRzW2l0ZW0ubGF5b3V0SWRdXG4gICAgICAgICAgaWYgKGxheW91dEpzb24pIHtcbiAgICAgICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh1cGRhdGVkQXBwQ29uZmlnLCBpdGVtLmxheW91dElkKVxuICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHNlcnZpY2UucmVtb3ZlSXRlbSh1cGRhdGVkQXBwQ29uZmlnLCBpdGVtLCBzaXplTW9kZSwgZmFsc2UpXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gdGhpcy5yZW1vdmVEaXJlY3RseSh1cGRhdGVkQXBwQ29uZmlnLCBjb250ZW50SWQpXG4gIH1cblxuICB0b1RvY05vZGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgcGFyZW50OiBMYXlvdXRJbmZvLFxuICAgIGJyb3dzZXJTaXplTW9kZTogQnJvd3NlclNpemVNb2RlXG4gICk6IFRvY05vZGUge1xuICAgIGNvbnN0IHsgbGF5b3V0SWQsIGxheW91dEl0ZW1JZCB9ID0gcGFyZW50XG4gICAgY29uc3QgcmVzdWx0OiBUb2NOb2RlID0ge1xuICAgICAgbGFiZWw6ICcnLFxuICAgICAgbGF5b3V0SWQsXG4gICAgICBsYXlvdXRJdGVtSWQsXG4gICAgICB0eXBlOiAnc2VjdGlvbicsXG4gICAgICBpZDogY29udGVudElkLFxuICAgICAgY2hpbGRyZW46IFtdXG4gICAgfVxuICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gYXBwQ29uZmlnLnNlY3Rpb25zPy5bY29udGVudElkXVxuICAgIGlmICghc2VjdGlvbkpzb24pIHtcbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9XG4gICAgcmVzdWx0LmxhYmVsID0gc2VjdGlvbkpzb24ubGFiZWxcbiAgICByZXN1bHQuaWNvbiA9IHNlY3Rpb25Kc29uLmljb24gPz8gc2VjdGlvbk91dGxpbmVkXG4gICAgcmVzdWx0LmZsaXBJY29uID0gdHJ1ZVxuXG4gICAgc2VjdGlvbkpzb24udmlld3MuZm9yRWFjaCgodmlld0lkKSA9PiB7XG4gICAgICBjb25zdCB2aWV3SnNvbiA9IGFwcENvbmZpZy52aWV3c1t2aWV3SWRdXG4gICAgICBjb25zdCB2aWV3TGF5b3V0SWQgPSB2aWV3SnNvbi5sYXlvdXRbYnJvd3NlclNpemVNb2RlXSA/PyB2aWV3SnNvbi5sYXlvdXRbYXBwQ29uZmlnLm1haW5TaXplTW9kZV1cbiAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZShhcHBDb25maWcsIHZpZXdMYXlvdXRJZClcbiAgICAgIGNvbnN0IHZpZXdDaGlsZHJlbiA9IHNlcnZpY2UuZ2V0VG9jU3RydWN0dXJlKGFwcENvbmZpZywgdmlld0xheW91dElkKVxuICAgICAgcmVzdWx0LmNoaWxkcmVuLnB1c2goe1xuICAgICAgICBsYWJlbDogdmlld0pzb24ubGFiZWwsXG4gICAgICAgIGljb246IHZpZXdKc29uLmljb24gPz8gdmlld091dGxpbmVkLFxuICAgICAgICBmbGlwSWNvbjogZmFsc2UsXG4gICAgICAgIHR5cGU6ICd2aWV3JyxcbiAgICAgICAgaWQ6IHZpZXdJZCxcbiAgICAgICAgY2hpbGRyZW46IHZpZXdDaGlsZHJlblxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgYWZ0ZXJNb3ZlZCAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcsIGZyb21MYXlvdXQ6IHN0cmluZywgdG9MYXlvdXQ6IHN0cmluZyk6IElNQXBwQ29uZmlnIHtcbiAgICAvLyBubyBleHRyYSBsb2dpYyB0byBwcm9jZXNzXG4gICAgcmV0dXJuIGFwcENvbmZpZ1xuICB9XG5cbiAgYWZ0ZXJBZGRlZCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICB0b0xheW91dDogc3RyaW5nLFxuICAgIGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIHRvU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZVxuICApOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSBhcHBDb25maWcuc2VjdGlvbnM/Lltjb250ZW50SWRdXG4gICAgaWYgKCFzZWN0aW9uSnNvbikge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cblxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG5cbiAgICAvLyBJZiB0aGUgdmlldyBsYXlvdXQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGN1cnJlbnQgc2l6ZU1vZGUsIHdlJ2xsIGNyZWF0ZSBhIG5ldyBvbmUgZm9yIHRoZW0uXG4gICAgc2VjdGlvbkpzb24udmlld3MuZm9yRWFjaCh2SWQgPT4ge1xuICAgICAgY29uc3Qgdmlld0pzb24gPSB1cGRhdGVkQXBwQ29uZmlnLnZpZXdzW3ZJZF1cbiAgICAgIGlmICh2aWV3SnNvbi5sYXlvdXRbZnJvbVNpemVNb2RlXSAmJiAhdmlld0pzb24ubGF5b3V0W3RvU2l6ZU1vZGVdKSB7XG4gICAgICAgIGNvbnN0IGxheW91dEpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLmxheW91dHNbdmlld0pzb24ubGF5b3V0W2Zyb21TaXplTW9kZV1dXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh1cGRhdGVkQXBwQ29uZmlnLCB2aWV3SnNvbi5sYXlvdXRbZnJvbVNpemVNb2RlXSlcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SnNvbi5pZCwgZnJvbVNpemVNb2RlLCB0b1NpemVNb2RlLCBudWxsKVxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgICAgIGNvbnN0IGxheW91dElkID0gcmVzdWx0WzFdXG4gICAgICAgIGlmIChsYXlvdXRJZCAhPSBudWxsKSB7XG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ3BhcmVudCddLCB7IHR5cGU6IExheW91dFBhcmVudFR5cGUuVmlldywgaWQ6IHZJZCB9KVxuICAgICAgICAgICAgLnNldEluKFsndmlld3MnLCB2SWQsICdsYXlvdXQnLCB0b1NpemVNb2RlXSwgbGF5b3V0SWQpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiB1cGRhdGVkQXBwQ29uZmlnXG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgcGFyZW50IGxheW91dEluZm8gdG8gdGhpcyBzZWN0aW9uLiBPY2N1cnMgd2hlbiB0aGlzIHNlY3Rpb24gaXMgYWRkZWQgdG8gYSBsYXlvdXQgaXRlbS5cbiAgICogQHBhcmFtIGFwcENvbmZpZ1xuICAgKiBAcGFyYW0gY29udGVudElkXG4gICAqIEBwYXJhbSBsYXlvdXRJbmZvXG4gICAqIEBwYXJhbSBzaXplTW9kZVxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgYWRkUGFyZW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgbGF5b3V0SW5mbzogTGF5b3V0SW5mbywgc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCBzZWN0aW9uSnNvbiA9IGFwcENvbmZpZy5zZWN0aW9uc1tjb250ZW50SWRdXG4gICAgaWYgKCFzZWN0aW9uSnNvbikge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cbiAgICBjb25zb2xlLmRlYnVnKCdhZGQgcGFyZW50JywgbGF5b3V0SW5mby5sYXlvdXRJZCwgbGF5b3V0SW5mby5sYXlvdXRJdGVtSWQsICd0byBzZWN0aW9uJywgY29udGVudElkLCAnaW4nLCBzaXplTW9kZSlcbiAgICBjb25zdCBsaXN0ID0gdGhpcy5hZGRQYXJlbnRUb0xpc3QoYXBwQ29uZmlnLCBzZWN0aW9uSnNvbi5wYXJlbnQ/LltzaXplTW9kZV0sIGxheW91dEluZm8pXG4gICAgcmV0dXJuIGFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgY29udGVudElkLCAncGFyZW50Jywgc2l6ZU1vZGVdLCBsaXN0KVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIHBhcmVudCBsYXlvdXRJbmZvIGZyb20gdGhpcyBzZWN0aW9uLiBPY2N1cnMgd2hlbiB0aGlzIHNlY3Rpb24gaXMgcmVtb3ZlZCBmcm9tIGEgbGF5b3V0IGl0ZW0uXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIGNvbnRlbnRJZCBpZCBvZiB0aGUgc2VjdGlvblxuICAgKiBAcGFyYW0gbGF5b3V0SW5mbyByZWZlciB0byBhIGxheW91dCBpdGVtXG4gICAqIEBwYXJhbSBzaXplTW9kZSB0aGUgZW52aXJvbm1lbnQgb2YgdGhpcyBvcGVyYXRpb25cbiAgICogQHJldHVybnNcbiAgICovXG4gIHJlbW92ZVBhcmVudCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICAgIHNpemVNb2RlPzogQnJvd3NlclNpemVNb2RlXG4gICk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCBzZWN0aW9uSnNvbiA9IGFwcENvbmZpZy5zZWN0aW9uc1tjb250ZW50SWRdXG4gICAgaWYgKCFzZWN0aW9uSnNvbiB8fCBzZWN0aW9uSnNvbi5wYXJlbnQgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBwYXJlbnQnLCBsYXlvdXRJbmZvLmxheW91dElkLCBsYXlvdXRJbmZvLmxheW91dEl0ZW1JZCwgJ2Zyb20gc2VjdGlvbicsIGNvbnRlbnRJZCwgJ2luJywgc2l6ZU1vZGUpXG4gICAgaWYgKHNpemVNb2RlKSB7XG4gICAgICBjb25zdCBwYXJlbnRzID0gc2VjdGlvbkpzb24ucGFyZW50W3NpemVNb2RlXVxuICAgICAgY29uc3QgbmV3UGFyZW50cyA9IHRoaXMucmVtb3ZlUGFyZW50RnJvbUxpc3QocGFyZW50cywgbGF5b3V0SW5mbylcbiAgICAgIGlmIChuZXdQYXJlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gYXBwQ29uZmlnLnNldEluKFsnc2VjdGlvbnMnLCBjb250ZW50SWQsICdwYXJlbnQnXSwgc2VjdGlvbkpzb24ucGFyZW50LndpdGhvdXQoc2l6ZU1vZGUpKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgY29udGVudElkLCAncGFyZW50Jywgc2l6ZU1vZGVdLCBuZXdQYXJlbnRzKVxuICAgIH1cblxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgT2JqZWN0LmtleXMoc2VjdGlvbkpzb24ucGFyZW50KS5mb3JFYWNoKChzKSA9PiB7XG4gICAgICBjb25zdCBwYXJlbnRzID0gc2VjdGlvbkpzb24ucGFyZW50W3NdXG4gICAgICBjb25zdCBuZXdQYXJlbnRzID0gdGhpcy5yZW1vdmVQYXJlbnRGcm9tTGlzdChwYXJlbnRzLCBsYXlvdXRJbmZvKVxuICAgICAgaWYgKG5ld1BhcmVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnc2VjdGlvbnMnLCBjb250ZW50SWQsICdwYXJlbnQnXSwgc2VjdGlvbkpzb24ucGFyZW50LndpdGhvdXQocykpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgY29udGVudElkLCAncGFyZW50Jywgc10sIG5ld1BhcmVudHMpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiB1cGRhdGVkQXBwQ29uZmlnXG4gIH1cblxuICBjbGVhclBhcmVudCAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSBhcHBDb25maWcuc2VjdGlvbnNbY29udGVudElkXVxuICAgIGlmICghc2VjdGlvbkpzb24gfHwgc2VjdGlvbkpzb24ucGFyZW50ID09IG51bGwpIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG4gICAgcmV0dXJuIGFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgY29udGVudElkXSwgc2VjdGlvbkpzb24ud2l0aG91dCgncGFyZW50JykpXG4gIH1cblxuICByZW1vdmVTaXplTW9kZVBhcmVudCAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZVxuICApOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSBhcHBDb25maWcuc2VjdGlvbnNbY29udGVudElkXVxuICAgIGlmICghc2VjdGlvbkpzb24gfHwgc2VjdGlvbkpzb24ucGFyZW50Py5bYnJvd3NlclNpemVNb2RlXSA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIHJldHVybiBhcHBDb25maWcuc2V0SW4oWydzZWN0aW9ucycsIGNvbnRlbnRJZCwgJ3BhcmVudCddLCBzZWN0aW9uSnNvbi5wYXJlbnQud2l0aG91dChicm93c2VyU2l6ZU1vZGUpKVxuICB9XG5cbiAgLyoqXG4gICAqIEZpbmQgdGhlIHBhcmVudCBvZiBhIHNlY3Rpb24gaW4gdGhlIHNpemUgbW9kZVxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBjb250ZW50SWRcbiAgICogQHBhcmFtIHNpemVNb2RlXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBmaW5kUGFyZW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IExheW91dEluZm8ge1xuICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gYXBwQ29uZmlnLnNlY3Rpb25zW2NvbnRlbnRJZF1cbiAgICBpZiAoIXNlY3Rpb25Kc29uLnBhcmVudCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICAvLyBicm93c2VyU2l6ZU1vZGUgbWF5IGJlIG5vdCBhIGN1c3RvbSBsYXlvdXQsIGl0IGlzIHRyYW5zZm9ybWVkIGZyb20gbWFpblNpemVNb2RlXG4gICAgY29uc3Qgc2VjdGlvblBhcmVudCA9IHNlY3Rpb25Kc29uLnBhcmVudFtzaXplTW9kZV0gPz8gc2VjdGlvbkpzb24ucGFyZW50W2FwcENvbmZpZy5tYWluU2l6ZU1vZGVdXG4gICAgaWYgKCFzZWN0aW9uUGFyZW50KSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICBpZiAoc2VjdGlvblBhcmVudC5sZW5ndGggPT09IDEpIHtcbiAgICAgIHJldHVybiBzZWN0aW9uUGFyZW50WzBdXG4gICAgfVxuICAgIC8vIG11bHRpcGxlIHBhcmVudCwgZ28gdG8gdGhlIHRoZWlyIGNvbW1vbiBwYXJlbnQuXG4gICAgY29uc3QgbGF5b3V0SWQgPSBzZWN0aW9uUGFyZW50WzBdLmxheW91dElkXG4gICAgY29uc3QgbGF5b3V0ID0gYXBwQ29uZmlnLmxheW91dHNbbGF5b3V0SWRdXG5cbiAgICAvLyB0aGUgcGFyZW50IG9mIHRoZSBsYXlvdXQgbXVzdCBiZSBhIHdpZGdldCwgaS5lLiBMaXN0IG9yIENhcmRcbiAgICByZXR1cm4gd2lkZ2V0U2VydmljZS5maW5kUGFyZW50KGFwcENvbmZpZywgbGF5b3V0LnBhcmVudD8uaWQsIHNpemVNb2RlKVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBzZWN0aW9uLiBUaGUgc2l6ZSBtb2RlIGxpc3QgaXMgdXNlZCB0byBnZW5lcmF0ZSB0aGUgbGF5b3V0IG9mIHRoZSB2aWV3LlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBzaXplTW9kZUxpc3RcbiAgICogQHJldHVybnNcbiAgICovXG4gIGNyZWF0ZVNlY3Rpb24gKGFwcENvbmZpZzogSU1BcHBDb25maWcsIHNpemVNb2RlTGlzdDogQnJvd3NlclNpemVNb2RlW10pOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgc2VjdGlvbklkOiBzdHJpbmddIHtcbiAgICBjb25zb2xlLmRlYnVnKCdjcmVhdGUgYSBibGFuayBzZWN0aW9uJywgc2l6ZU1vZGVMaXN0KVxuICAgIC8vIENyZWF0ZSBhIG5ldyBzZWN0aW9uSnNvblxuICAgIGNvbnN0IHNlY3Rpb25JZCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3NlY3Rpb24nKVxuICAgIGNvbnN0IHNlY3Rpb25MYWJlbCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUxhYmVsKFxuICAgICAgYXBwQ29uZmlnLFxuICAgICAgJ3NlY3Rpb24nLFxuICAgICAgaTE4bi5nZXRJbnRsKCkuZm9ybWF0TWVzc2FnZSh7IGlkOiAnc2VjdGlvbicgfSlcbiAgICApXG4gICAgY29uc3Qgc2VjdGlvbkpzb24gPSB7XG4gICAgICBpZDogc2VjdGlvbklkLFxuICAgICAgbGFiZWw6IHNlY3Rpb25MYWJlbCxcbiAgICAgIHZpZXdzOiBbXVxuICAgIH0gYXMgU2VjdGlvbkpzb25cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgc2VjdGlvbkpzb24uaWRdLCBzZWN0aW9uSnNvbilcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmFkZFZpZXcodXBkYXRlZEFwcENvbmZpZywgc2VjdGlvbklkLCBzaXplTW9kZUxpc3QpXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBzZWN0aW9uSWRdXG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgYmxhbmsgdmlldy4gT25seSB1bmlxdWUgaWQgYW5kIHBhcmVudCBzZXQuXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIHNlY3Rpb25JZFxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgY3JlYXRlQmxhbmtWaWV3IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBzZWN0aW9uSWQ6IHN0cmluZyk6IFZpZXdKc29uIHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3ZpZXcnKSxcbiAgICAgIHBhcmVudDogc2VjdGlvbklkLFxuICAgICAgbGFiZWw6IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUxhYmVsKGFwcENvbmZpZywgJ3ZpZXcnLCBpMThuLmdldEludGwoKS5mb3JtYXRNZXNzYWdlKHsgaWQ6ICd2aWV3JyB9KSlcbiAgICB9IGFzIFZpZXdKc29uXG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgYW5kIGFkZCBhIG5ldyB2aWV3IHRvIHRoZSBzZWN0aW9uLlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBzZWN0aW9uSWRcbiAgICogQHBhcmFtIHNpemVNb2RlTGlzdFxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgYWRkVmlldyAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBzZWN0aW9uSWQ6IHN0cmluZyxcbiAgICBzaXplTW9kZUxpc3Q6IEJyb3dzZXJTaXplTW9kZVtdXG4gICk6IFthcHBDb25maWc6IElNQXBwQ29uZmlnLCB2aWV3SWQ6IHN0cmluZ10ge1xuICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gYXBwQ29uZmlnLnNlY3Rpb25zPy5bc2VjdGlvbklkXVxuICAgIGlmICghc2VjdGlvbkpzb24pIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgIH1cbiAgICAvLyBjcmVhdGUgdmlldyBqc29uXG4gICAgbGV0IHZpZXdzXG4gICAgY29uc3Qgdmlld0pzb24gPSB0aGlzLmNyZWF0ZUJsYW5rVmlldyhhcHBDb25maWcsIHNlY3Rpb25JZClcblxuICAgIGlmIChzZWN0aW9uSnNvbi52aWV3cykge1xuICAgICAgdmlld3MgPSBzZWN0aW9uSnNvbi52aWV3cy5hc011dGFibGUoKVxuICAgICAgdmlld3MucHVzaCh2aWV3SnNvbi5pZClcbiAgICB9IGVsc2Uge1xuICAgICAgdmlld3MgPSBbdmlld0pzb24uaWRdXG4gICAgfVxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgICAuc2V0SW4oWyd2aWV3cycsIHZpZXdKc29uLmlkXSwgdmlld0pzb24pXG4gICAgICAuc2V0SW4oWydzZWN0aW9ucycsIHNlY3Rpb25JZCwgJ3ZpZXdzJ10sIHZpZXdzKVxuXG4gICAgc2l6ZU1vZGVMaXN0LmZvckVhY2goKG1vZGUpID0+IHtcbiAgICAgIGNvbnN0IGxheW91dEpzb24gPSB7XG4gICAgICAgIGlkOiBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVJZCh1cGRhdGVkQXBwQ29uZmlnLCAnbGF5b3V0JyksXG4gICAgICAgIHR5cGU6IExheW91dFR5cGUuRml4ZWRMYXlvdXQsXG4gICAgICAgIGNvbnRlbnQ6IHt9LFxuICAgICAgICBwYXJlbnQ6IHsgaWQ6IHZpZXdKc29uLmlkLCB0eXBlOiBMYXlvdXRQYXJlbnRUeXBlLlZpZXcgfVxuICAgICAgfVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIGxheW91dEpzb24uaWRdLCBsYXlvdXRKc29uKVxuICAgICAgICAuc2V0SW4oWyd2aWV3cycsIHZpZXdKc29uLmlkLCAnbGF5b3V0JywgbW9kZV0sIGxheW91dEpzb24uaWQpXG4gICAgfSlcblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgdmlld0pzb24uaWRdXG4gIH1cblxuICAvKipcbiAgICogRHVwbGljYXRlIGFuIGV4aXN0aW5nIHZpZXcuIE9ubHkgZHVwbGljYXRlIHRoZSBjb250ZW50IGluIHNwZWNpZmllZCBicm93c2VyIHNpemUgbW9kZXMuXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIHNlY3Rpb25JZFxuICAgKiBAcGFyYW0gdmlld0lkXG4gICAqIEBwYXJhbSBzaXplTW9kZUxpc3RcbiAgICogQHBhcmFtIHRhcmdldEJyb3dzZXJTaXplXG4gICAqIEBwYXJhbSBhZGRUb1NlY3Rpb25cbiAgICogQHBhcmFtIGNvbnRleHRcbiAgICogQHJldHVybnNcbiAgICovXG4gIGR1cGxpY2F0ZVZpZXcgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgc2VjdGlvbklkOiBzdHJpbmcsXG4gICAgdmlld0lkOiBzdHJpbmcsXG4gICAgc2l6ZU1vZGVMaXN0OiBCcm93c2VyU2l6ZU1vZGVbXSxcbiAgICBhZGRUb1NlY3Rpb246IGJvb2xlYW4sXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dFxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgdmlld0lkOiBzdHJpbmddIHtcbiAgICBpZiAoIWFwcENvbmZpZy52aWV3cyB8fCAhYXBwQ29uZmlnLnZpZXdzW3ZpZXdJZF0pIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgIH1cbiAgICBjb25zb2xlLmRlYnVnKCdkdXBsaWNhdGUgYSB2aWV3Jywgdmlld0lkLCAnaW4nLCBzaXplTW9kZUxpc3QpXG4gICAgbGV0IHZpZXdKc29uID0gYXBwQ29uZmlnLnZpZXdzW3ZpZXdJZF0uc2V0KCdpZCcsIGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3ZpZXcnKSlcbiAgICB2aWV3SnNvbiA9IHZpZXdKc29uLnNldCgnbGFiZWwnLCBnZXREdXBsaWNhdGVMYWJlbChhcHBDb25maWcsICd2aWV3Jywgdmlld0pzb24ubGFiZWwpKVxuICAgIGlmICghYWRkVG9TZWN0aW9uKSB7XG4gICAgICB2aWV3SnNvbiA9IHZpZXdKc29uLndpdGhvdXQoJ3BhcmVudCcpXG4gICAgfVxuICAgIC8vIG11c3Qgc2F2ZSBpbnRvIGFwcGNvbmZpZyBiZWZvcmUgZHVwbGljYXRlIGl0ZXJhdGlvbiwgb3IgaXQncyBjb250ZW50IHNlY3Rpb24gd2lsbCBnZXQgc2FtZSBzZWN0aW9uIGlkIHRvIGl0c2VsZiBieSBnZXRVbmlxdWVJZC5cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ3ZpZXdzJywgdmlld0pzb24uaWRdLCB2aWV3SnNvbilcblxuICAgIGNvbnN0IHNpemVNb2RlTGF5b3V0cyA9IHt9XG4gICAgc2l6ZU1vZGVMaXN0LmZvckVhY2gobW9kZSA9PiB7IHNpemVNb2RlTGF5b3V0c1ttb2RlXSA9IHZpZXdKc29uLmxheW91dFttb2RlXSB9KVxuICAgIC8vIGR1cGxpY2F0ZSB2aWV3IGxheW91dFxuICAgIGNvbnN0IGR1cGxpY2F0ZUNvbnRleHQgPSBjb250ZXh0ID8/IHt9XG4gICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlRnJvbVNpemVNb2RlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIHNpemVNb2RlTGF5b3V0cyBhcyBhbnkpXG4gICAgY29uc3QgZHVwbGljYXRlUmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGVTaXplTW9kZUxheW91dHMoXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgc2l6ZU1vZGVMYXlvdXRzIGFzIGFueSxcbiAgICAgIExheW91dFBhcmVudFR5cGUuVmlldyxcbiAgICAgIHZpZXdKc29uLmlkLFxuICAgICAgZHVwbGljYXRlQ29udGV4dFxuICAgIClcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gZHVwbGljYXRlUmVzdWx0WzBdXG4gICAgdmlld0pzb24gPSB2aWV3SnNvbi5zZXQoJ2xheW91dCcsIGR1cGxpY2F0ZVJlc3VsdFsxXSlcblxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsndmlld3MnLCB2aWV3SnNvbi5pZF0sIHZpZXdKc29uKVxuXG4gICAgaWYgKGFkZFRvU2VjdGlvbikge1xuICAgICAgY29uc3Qgdmlld3MgPSB1cGRhdGVkQXBwQ29uZmlnLnNlY3Rpb25zW3NlY3Rpb25JZF0udmlld3MuYXNNdXRhYmxlKClcbiAgICAgIGNvbnN0IGluZGV4ID0gdmlld3MuaW5kZXhPZih2aWV3SWQpXG4gICAgICB2aWV3cy5zcGxpY2UoaW5kZXgsIDEsIHZpZXdJZCwgdmlld0pzb24uaWQpXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3NlY3Rpb25zJywgc2VjdGlvbklkLCAndmlld3MnXSwgdmlld3MpXG4gICAgfVxuXG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgIGNvbnRleHRbdmlld0lkXSA9IHZpZXdKc29uLmlkXG4gICAgfVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCB2aWV3SnNvbi5pZF1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYSB2aWV3LlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBzZWN0aW9uSWRcbiAgICogQHBhcmFtIHZpZXdJZFxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgcmVtb3ZlVmlldyAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgc2VjdGlvbklkOiBzdHJpbmcsIHZpZXdJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHNlY3Rpb25Kc29uID0gYXBwQ29uZmlnLnNlY3Rpb25zPy5bc2VjdGlvbklkXVxuICAgIGNvbnN0IHZpZXdKc29uID0gYXBwQ29uZmlnLnZpZXdzPy5bdmlld0lkXVxuICAgIC8vIHNlY3Rpb24gc2hvdWxkIGNvbnRhaW4gYXQgbGVhc3Qgb25lIHZpZXdcbiAgICBpZiAoIXZpZXdKc29uIHx8ICFzZWN0aW9uSnNvbiB8fCBzZWN0aW9uSnNvbi52aWV3cy5sZW5ndGggPT09IDEgfHwgIXNlY3Rpb25Kc29uLnZpZXdzLmluY2x1ZGVzKHZpZXdJZCkpIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG5cbiAgICBjb25zb2xlLmRlYnVnKCdyZW1vdmUgYSB2aWV3Jywgdmlld0lkLCAnZnJvbScsIHNlY3Rpb25JZClcbiAgICAvLyByZW1vdmUgZnJvbSBzZWN0aW9uLnZpZXdzXG4gICAgY29uc3Qgdmlld3MgPSBzZWN0aW9uSnNvbi52aWV3cy5maWx0ZXIoKHZJZCkgPT4gdklkICE9PSB2aWV3SWQpXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWcuc2V0SW4oWydzZWN0aW9ucycsIHNlY3Rpb25JZCwgJ3ZpZXdzJ10sIHZpZXdzKVxuXG4gICAgLy8gcmVtb3ZlIHZpZXcgbGF5b3V0XG4gICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlRnJvbVNpemVNb2RlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIHZpZXdKc29uLmxheW91dClcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZS5yZW1vdmVTaXplTW9kZUxheW91dHModXBkYXRlZEFwcENvbmZpZywgdmlld0pzb24ubGF5b3V0KVxuXG4gICAgLy8gcmVtb3ZlIGZyb20gdmlldyBsaXN0XG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0KCd2aWV3cycsIHVwZGF0ZWRBcHBDb25maWcudmlld3Mud2l0aG91dCh2aWV3SWQpKVxuXG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgU2VjdGlvblNlcnZpY2UoKVxuIiwiaW1wb3J0IHtcbiAgYXBwQ29uZmlnVXRpbHMsXG4gIEltbXV0YWJsZSxcbiAgaTE4bixcbiAgdXRpbHMsXG4gIExheW91dFBhcmVudFR5cGUsXG4gIHR5cGUgSU1BcHBDb25maWcsXG4gIHR5cGUgQXBwQ29uZmlnLFxuICB0eXBlIEJyb3dzZXJTaXplTW9kZSxcbiAgTGF5b3V0VHlwZVxufSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgdHlwZSB7IFRlbXBsYXRlIH0gZnJvbSAnLi4vdGVtcGxhdGVzL3R5cGUnXG5pbXBvcnQgeyBnZXRUZW1wbGF0ZUNvbmZpZyB9IGZyb20gJ2ppbXUtZm9yLWJ1aWxkZXIvdGVtcGxhdGVzJ1xuaW1wb3J0IGRlZmF1bHRNZXNzYWdlcyBmcm9tICcuLi90cmFuc2xhdGlvbnMvZGVmYXVsdCdcbmltcG9ydCB7IExheW91dFNlcnZpY2VQcm92aWRlciB9IGZyb20gJy4vbGF5b3V0LXNlcnZpY2UtcHJvdmlkZXInXG5pbXBvcnQgeyBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnIH0gZnJvbSAnLi91dGlsJ1xuaW1wb3J0IHsgdHlwZSBEdXBsaWNhdGVDb250ZXh0IH0gZnJvbSAnLi9iYXNlLWNvbnRlbnQtc2VydmljZSdcblxuZXhwb3J0IGNsYXNzIFRlbXBsYXRlU2VydmljZSB7XG4gIGFzeW5jIGNyZWF0ZVBhZ2VGcm9tVGVtcGxhdGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgdGVtcGxhdGVKc29uOiBUZW1wbGF0ZSxcbiAgICBjb250ZW50TWFwcGluZzogRHVwbGljYXRlQ29udGV4dFxuICApOiBQcm9taXNlPFthcHBDb25maWc6IElNQXBwQ29uZmlnLCBuZXdQYWdlSWQ6IHN0cmluZ10+IHtcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuXG4gICAgYXdhaXQgbWFrZVN1cmVUZW1wbGF0ZUNvbmZpZyh0ZW1wbGF0ZUpzb24pXG5cbiAgICBjb25zdCB0ZW1wbGF0ZUNvbmZpZyA9IHRlbXBsYXRlSnNvbi5jb25maWdcbiAgICBjb25zdCBwYWdlSWQgPSBPYmplY3Qua2V5cyh0ZW1wbGF0ZUNvbmZpZy5wYWdlcylbMF1cbiAgICBjb25zdCB0ZW1wbGF0ZVBhZ2UgPSB0ZW1wbGF0ZUNvbmZpZy5wYWdlc1twYWdlSWRdXG4gICAgY29uc3QgbmV4dFBhZ2VJZCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3BhZ2UnKVxuICAgIGNvbnN0IGxhYmVsID0gYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlTGFiZWwoYXBwQ29uZmlnLCAncGFnZScsIGkxOG4uZ2V0SW50bCgpLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ3BhZ2UnIH0pKVxuICAgIGNvbnN0IHNpemVNb2RlTGlzdCA9IE9iamVjdC5rZXlzKHRlbXBsYXRlUGFnZS5sYXlvdXQgPz8ge30pIGFzIEJyb3dzZXJTaXplTW9kZVtdXG5cbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3BhZ2VzJywgbmV4dFBhZ2VJZF0sIHRlbXBsYXRlUGFnZSlcbiAgICAgIC5zZXRJbihbJ3BhZ2VzJywgbmV4dFBhZ2VJZCwgJ2lkJ10sIG5leHRQYWdlSWQpXG4gICAgICAuc2V0SW4oWydwYWdlcycsIG5leHRQYWdlSWQsICdpc1Zpc2libGUnXSwgdHJ1ZSlcbiAgICAgIC5zZXRJbihbJ3BhZ2VzJywgbmV4dFBhZ2VJZCwgJ2lzRGVmYXVsdCddLCBmYWxzZSlcbiAgICAgIC5zZXRJbihbJ3BhZ2VzJywgbmV4dFBhZ2VJZCwgJ2xhYmVsJ10sIGxhYmVsKVxuICAgICAgLnNldEluKFsncGFnZXMnLCBuZXh0UGFnZUlkLCAnaGVhZGVyJ10sIGZhbHNlKVxuICAgICAgLnNldEluKFsncGFnZXMnLCBuZXh0UGFnZUlkLCAnZm9vdGVyJ10sIGZhbHNlKVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplTW9kZUxpc3QubGVuZ3RoOyBpICs9IDEpIHsgLy8gYXdhaXRzIGluIGEgZm9yLWxvb3Agc2hvdWxkIGdldCBleGVjdXRlZCBpbiBzZXJpZXNcbiAgICAgIGNvbnN0IHNpemVNb2RlID0gc2l6ZU1vZGVMaXN0W2ldXG4gICAgICBjb25zdCBsYXlvdXRJZCA9IHRlbXBsYXRlUGFnZS5sYXlvdXRbc2l6ZU1vZGVdXG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGVtcGxhdGVDb25maWcgYXMgYW55LCBsYXlvdXRJZClcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlTGF5b3V0RnJvbVRlbXBsYXRlKFxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgICB0ZW1wbGF0ZUpzb24sXG4gICAgICAgIGxheW91dElkLFxuICAgICAgICBzaXplTW9kZSxcbiAgICAgICAgTGF5b3V0UGFyZW50VHlwZS5QYWdlLFxuICAgICAgICBuZXh0UGFnZUlkLFxuICAgICAgICBjb250ZW50TWFwcGluZ1xuICAgICAgKVxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgY29uc3QgbmV3TGF5b3V0SWQgPSByZXN1bHRbMV1cblxuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgLnNldEluKFsncGFnZXMnLCBuZXh0UGFnZUlkLCAnbGF5b3V0Jywgc2l6ZU1vZGVdLCBuZXdMYXlvdXRJZClcbiAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIG5ld0xheW91dElkLCAncGFyZW50J10sIHsgaWQ6IG5leHRQYWdlSWQsIHR5cGU6IExheW91dFBhcmVudFR5cGUuUGFnZSB9KVxuICAgIH1cblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV4dFBhZ2VJZF1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZURpYWxvZ0Zyb21UZW1wbGF0ZSAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLFxuICAgIGNvbnRlbnRNYXBwaW5nOiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFByb21pc2U8W2FwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld0RpYWxvZ0lkOiBzdHJpbmddPiB7XG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIGF3YWl0IG1ha2VTdXJlVGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uKVxuICAgIGNvbnN0IHRlbXBsYXRlQ29uZmlnID0gdGVtcGxhdGVKc29uLmNvbmZpZ1xuICAgIGNvbnN0IGRsZ0lkID0gT2JqZWN0LmtleXModGVtcGxhdGVDb25maWcuZGlhbG9ncylbMF1cbiAgICBjb25zdCB0ZW1wbGF0ZURsZyA9IHRlbXBsYXRlQ29uZmlnLmRpYWxvZ3NbZGxnSWRdXG4gICAgY29uc3QgbmV4dERsZ0lkID0gYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnZGlhbG9nJylcbiAgICBjb25zdCBsYWJlbCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUxhYmVsKGFwcENvbmZpZywgJ2RpYWxvZycsIGkxOG4uZ2V0SW50bCgpLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2RpYWxvZycgfSkpXG4gICAgY29uc3Qgc2l6ZU1vZGVMaXN0ID0gT2JqZWN0LmtleXModGVtcGxhdGVEbGcubGF5b3V0ID8/IHt9KSBhcyBCcm93c2VyU2l6ZU1vZGVbXVxuXG4gICAgY29uc3QgZGxnSW5kZXggPSBPYmplY3Qua2V5cyhPYmplY3Qua2V5cyh1cGRhdGVkQXBwQ29uZmlnLmRpYWxvZ3MpLmZpbHRlcihkbGdJZCA9PiB1cGRhdGVkQXBwQ29uZmlnLmRpYWxvZ3NbZGxnSWRdLm1vZGUgPT09IHRlbXBsYXRlRGxnLm1vZGUpKS5sZW5ndGhcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2RpYWxvZ3MnLCBuZXh0RGxnSWRdLCB0ZW1wbGF0ZURsZylcbiAgICAgIC5zZXRJbihbJ2RpYWxvZ3MnLCBuZXh0RGxnSWQsICdpZCddLCBuZXh0RGxnSWQpXG4gICAgICAuc2V0SW4oWydkaWFsb2dzJywgbmV4dERsZ0lkLCAnbGFiZWwnXSwgbGFiZWwpXG4gICAgICAuc2V0SW4oWydkaWFsb2dzJywgbmV4dERsZ0lkLCAnaW5kZXgnXSwgZGxnSW5kZXgpXG4gICAgICAuc2V0SW4oWydkaWFsb2dzJywgbmV4dERsZ0lkLCAnaXNTcGxhc2gnXSwgZmFsc2UpXG4gICAgICAuc2V0SW4oWydkaWFsb2dzJywgbmV4dERsZ0lkLCAnY2xvc2VXaGVuQ2xpY2tPdmVybGF5J10sIHRlbXBsYXRlRGxnLmNsb3NlV2hlbkNsaWNrT3ZlcmxheSlcbiAgICAgIC5zZXRJbihbJ2RpYWxvZ3MnLCBuZXh0RGxnSWQsICdzaXplTW9kZSddLCB0ZW1wbGF0ZURsZy5zaXplTW9kZSlcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZU1vZGVMaXN0Lmxlbmd0aDsgaSArPSAxKSB7IC8vIGF3YWl0cyBpbiBhIGZvci1sb29wIHNob3VsZCBnZXQgZXhlY3V0ZWQgaW4gc2VyaWVzXG4gICAgICBjb25zdCBzaXplTW9kZSA9IHNpemVNb2RlTGlzdFtpXVxuICAgICAgY29uc3QgbGF5b3V0SWQgPSB0ZW1wbGF0ZURsZy5sYXlvdXRbc2l6ZU1vZGVdXG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGVtcGxhdGVDb25maWcgYXMgYW55LCBsYXlvdXRJZClcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlTGF5b3V0RnJvbVRlbXBsYXRlKFxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgICB0ZW1wbGF0ZUpzb24sXG4gICAgICAgIGxheW91dElkLFxuICAgICAgICBzaXplTW9kZSxcbiAgICAgICAgTGF5b3V0UGFyZW50VHlwZS5EaWFsb2csXG4gICAgICAgIG5leHREbGdJZCxcbiAgICAgICAgY29udGVudE1hcHBpbmdcbiAgICAgIClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgIGNvbnN0IG5ld0xheW91dElkID0gcmVzdWx0WzFdXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgICAuc2V0SW4oWydkaWFsb2dzJywgbmV4dERsZ0lkLCAnbGF5b3V0Jywgc2l6ZU1vZGVdLCBuZXdMYXlvdXRJZClcbiAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIG5ld0xheW91dElkLCAncGFyZW50J10sIHsgaWQ6IG5leHREbGdJZCwgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5EaWFsb2cgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIG5leHREbGdJZF1cbiAgfVxuXG4gIGFzeW5jIGFwcGx5VGVtcGxhdGVUb0hlYWRlciAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLFxuICAgIGN1cnJlbnRTaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogUHJvbWlzZTxJTUFwcENvbmZpZz4ge1xuICAgIGF3YWl0IG1ha2VTdXJlVGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uKVxuXG4gICAgaWYgKCF0ZW1wbGF0ZUpzb24/LmNvbmZpZz8uaGVhZGVyKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIGNvbnN0IHRlbXBsYXRlSGVhZGVyTGF5b3V0ID0gdGVtcGxhdGVKc29uLmNvbmZpZy5oZWFkZXIubGF5b3V0XG4gICAgY29uc3QgdGVtcGxhdGVIZWFkZXJMYXlvdXRJZCA9IE9iamVjdC52YWx1ZXModGVtcGxhdGVIZWFkZXJMYXlvdXQpWzBdXG4gICAgY29uc3QgaGVhZGVyTGF5b3V0ID0gYXBwQ29uZmlnPy5oZWFkZXI/LmxheW91dFxuICAgIGlmIChoZWFkZXJMYXlvdXQpIHtcbiAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0ZW1wbGF0ZUpzb24uY29uZmlnIGFzIGFueSwgdGVtcGxhdGVIZWFkZXJMYXlvdXRJZClcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucmVwbGFjZVNpemVNb2RlTGF5b3V0KFxuICAgICAgICBhcHBDb25maWcsXG4gICAgICAgIGhlYWRlckxheW91dCxcbiAgICAgICAgdGVtcGxhdGVKc29uLFxuICAgICAgICBJbW11dGFibGUodGVtcGxhdGVKc29uPy5jb25maWc/LmhlYWRlcj8ubGF5b3V0KSxcbiAgICAgICAgY3VycmVudFNpemVNb2RlLFxuICAgICAgICBMYXlvdXRQYXJlbnRUeXBlLkhlYWRlcixcbiAgICAgICAgJ2hlYWRlcicsXG4gICAgICAgIGNvbnRleHRcbiAgICAgIClcbiAgICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gcmVzdWx0WzBdXG5cbiAgICAgIE9iamVjdC5rZXlzKHJlc3VsdFsxXSkuZm9yRWFjaChtb2RlID0+IHtcbiAgICAgICAgY29uc3QgbGF5b3V0SWQgPSByZXN1bHRbMV1bbW9kZV1cbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAuc2V0SW4oWydoZWFkZXInLCAnbGF5b3V0JywgbW9kZV0sIGxheW91dElkKVxuICAgICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ3BhcmVudCddLCB7IGlkOiAnaGVhZGVyJywgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5IZWFkZXIgfSlcbiAgICAgIH0pXG5cbiAgICAgIC8vIHVwZGF0ZSBvdGhlciBwcm9wcyBpbiBoZWFkZXIgdGVtcGxhdGVcbiAgICAgIE9iamVjdC5rZXlzKHRlbXBsYXRlSnNvbi5jb25maWcuaGVhZGVyKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgaWYgKGtleSAhPT0gJ2xheW91dCcgJiYgdGVtcGxhdGVKc29uLmNvbmZpZy5oZWFkZXJba2V5XSAhPSBudWxsKSB7XG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydoZWFkZXInLCBrZXldLCB0ZW1wbGF0ZUpzb24uY29uZmlnLmhlYWRlcltrZXldKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICAgIH1cbiAgICByZXR1cm4gYXBwQ29uZmlnXG4gIH1cblxuICBhc3luYyBhcHBseVRlbXBsYXRlVG9Gb290ZXIgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgdGVtcGxhdGVKc29uOiBUZW1wbGF0ZSxcbiAgICBjdXJyZW50U2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFByb21pc2U8SU1BcHBDb25maWc+IHtcbiAgICBhd2FpdCBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnKHRlbXBsYXRlSnNvbilcbiAgICBpZiAoIXRlbXBsYXRlSnNvbj8uY29uZmlnPy5mb290ZXIpIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG5cbiAgICBjb25zdCB0ZW1wbGF0ZUZvb3RlckxheW91dCA9IHRlbXBsYXRlSnNvbi5jb25maWcuZm9vdGVyLmxheW91dFxuICAgIGNvbnN0IHRlbXBsYXRlRm9vdGVyTGF5b3V0SWQgPSBPYmplY3QudmFsdWVzKHRlbXBsYXRlRm9vdGVyTGF5b3V0KVswXVxuICAgIGNvbnN0IGZvb3RlckxheW91dCA9IGFwcENvbmZpZz8uZm9vdGVyPy5sYXlvdXRcbiAgICBpZiAoZm9vdGVyTGF5b3V0KSB7XG4gICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodGVtcGxhdGVKc29uLmNvbmZpZyBhcyBhbnksIHRlbXBsYXRlRm9vdGVyTGF5b3V0SWQpXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnJlcGxhY2VTaXplTW9kZUxheW91dChcbiAgICAgICAgYXBwQ29uZmlnLFxuICAgICAgICBmb290ZXJMYXlvdXQsXG4gICAgICAgIHRlbXBsYXRlSnNvbixcbiAgICAgICAgSW1tdXRhYmxlKHRlbXBsYXRlSnNvbj8uY29uZmlnPy5mb290ZXI/LmxheW91dCksXG4gICAgICAgIGN1cnJlbnRTaXplTW9kZSxcbiAgICAgICAgTGF5b3V0UGFyZW50VHlwZS5Gb290ZXIsXG4gICAgICAgICdmb290ZXInLFxuICAgICAgICBjb250ZXh0XG4gICAgICApXG4gICAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuXG4gICAgICBPYmplY3Qua2V5cyhyZXN1bHRbMV0pLmZvckVhY2gobW9kZSA9PiB7XG4gICAgICAgIGNvbnN0IGxheW91dElkID0gcmVzdWx0WzFdW21vZGVdXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnXG4gICAgICAgICAgLnNldEluKFsnZm9vdGVyJywgJ2xheW91dCcsIG1vZGVdLCBsYXlvdXRJZClcbiAgICAgICAgICAuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SWQsICdwYXJlbnQnXSwgeyBpZDogJ2Zvb3RlcicsIHR5cGU6IExheW91dFBhcmVudFR5cGUuRm9vdGVyIH0pXG4gICAgICB9KVxuXG4gICAgICAvLyB1cGRhdGUgb3RoZXIgcHJvcHMgaW4gZm9vdGVyIHRlbXBsYXRlXG4gICAgICBPYmplY3Qua2V5cyh0ZW1wbGF0ZUpzb24uY29uZmlnLmZvb3RlcikuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgIGlmIChrZXkgIT09ICdsYXlvdXQnICYmIHRlbXBsYXRlSnNvbi5jb25maWcuZm9vdGVyW2tleV0gIT0gbnVsbCkge1xuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnZm9vdGVyJywga2V5XSwgdGVtcGxhdGVKc29uLmNvbmZpZy5mb290ZXJba2V5XSlcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgICB9XG4gICAgcmV0dXJuIGFwcENvbmZpZ1xuICB9XG5cbiAgYXN5bmMgYXBwbHlUZW1wbGF0ZVRvQm9keSAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBwYWdlSWQ6IHN0cmluZyxcbiAgICB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLFxuICAgIGN1cnJlbnRTaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogUHJvbWlzZTxJTUFwcENvbmZpZz4ge1xuICAgIGF3YWl0IG1ha2VTdXJlVGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uKVxuICAgIGlmICghdGVtcGxhdGVKc29uLmNvbmZpZykge1xuICAgICAgY29uc3QgdGVtcGxhdGVDb250ZW50ID0gYXdhaXQgZ2V0VGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uLnR5cGUsIHRlbXBsYXRlSnNvbi5uYW1lKVxuICAgICAgdGVtcGxhdGVKc29uLmNvbmZpZyA9IHRlbXBsYXRlQ29udGVudFxuICAgICAgaWYgKCF0ZW1wbGF0ZUpzb24uY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFwcENvbmZpZ1V0aWxzLmZpeExheW91dElkcyh0ZW1wbGF0ZUpzb24uY29uZmlnIGFzIEFwcENvbmZpZylcbiAgICAgICAgdXRpbHMucmVwbGFjZUkxOG5QbGFjZWhvbGRlcnNJbk9iamVjdCh0ZW1wbGF0ZUpzb24uY29uZmlnLCBpMThuLmdldEludGwoKSwgZGVmYXVsdE1lc3NhZ2VzKVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHRlbXBsYXRlUGFnZUlkID0gT2JqZWN0LmtleXModGVtcGxhdGVKc29uLmNvbmZpZy5wYWdlcylbMF1cbiAgICBjb25zdCB0ZW1wbGF0ZVBhZ2VMYXlvdXQgPSB0ZW1wbGF0ZUpzb24uY29uZmlnLnBhZ2VzW3RlbXBsYXRlUGFnZUlkXS5sYXlvdXRcbiAgICBjb25zdCB0ZW1wbGF0ZVBhZ2VMYXlvdXRJZCA9IE9iamVjdC52YWx1ZXModGVtcGxhdGVQYWdlTGF5b3V0KVswXVxuXG4gICAgY29uc3QgcGFnZUxheW91dCA9IGFwcENvbmZpZz8ucGFnZXM/LltwYWdlSWRdPy5sYXlvdXRcbiAgICBpZiAocGFnZUxheW91dCkge1xuICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55LCB0ZW1wbGF0ZVBhZ2VMYXlvdXRJZClcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UucmVwbGFjZVNpemVNb2RlTGF5b3V0KFxuICAgICAgICBhcHBDb25maWcsXG4gICAgICAgIHBhZ2VMYXlvdXQsXG4gICAgICAgIHRlbXBsYXRlSnNvbixcbiAgICAgICAgSW1tdXRhYmxlKHRlbXBsYXRlUGFnZUxheW91dCksXG4gICAgICAgIGN1cnJlbnRTaXplTW9kZSxcbiAgICAgICAgTGF5b3V0UGFyZW50VHlwZS5QYWdlLFxuICAgICAgICBwYWdlSWQsXG4gICAgICAgIGNvbnRleHRcbiAgICAgIClcbiAgICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gcmVzdWx0WzBdXG5cbiAgICAgIE9iamVjdC5rZXlzKHJlc3VsdFsxXSkuZm9yRWFjaChtb2RlID0+IHtcbiAgICAgICAgY29uc3QgbGF5b3V0SWQgPSByZXN1bHRbMV1bbW9kZV1cbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAuc2V0SW4oWydwYWdlcycsIHBhZ2VJZCwgJ2xheW91dCcsIG1vZGVdLCBsYXlvdXRJZClcbiAgICAgICAgICAuc2V0SW4oWydsYXlvdXRzJywgbGF5b3V0SWQsICdwYXJlbnQnXSwgeyBpZDogcGFnZUlkLCB0eXBlOiBMYXlvdXRQYXJlbnRUeXBlLlBhZ2UgfSlcbiAgICAgIH0pXG5cbiAgICAgIC8vIHVwZGF0ZSBvdGhlciBwcm9wcyBpbiBwYWdlIHRlbXBsYXRlXG4gICAgICBjb25zdCBwcm9wcyA9IFsnbW9kZScsICdtYXhXaWR0aCcsICdib2R5QmFja2dyb3VuZENvbG9yJywgJ2JvZHlCYWNrZ3JvdW5kSU1hZ2UnLCAnYm9keUJhY2tncm91bmRQb3NpdGlvbiddXG4gICAgICBwcm9wcy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0ZW1wbGF0ZUpzb24uY29uZmlnLnBhZ2VzW3RlbXBsYXRlUGFnZUlkXVtrZXldXG4gICAgICAgIGlmIChrZXkgIT09ICdsYXlvdXQnICYmIHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3BhZ2VzJywgcGFnZUlkLCBrZXldLCB2YWx1ZSlcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgICB9XG4gICAgcmV0dXJuIGFwcENvbmZpZ1xuICB9XG5cbiAgYXN5bmMgYXBwbHlUZW1wbGF0ZVRvRGlhbG9nIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGRpYWxvZ0lkOiBzdHJpbmcsXG4gICAgdGVtcGxhdGVKc29uOiBUZW1wbGF0ZSxcbiAgICBjdXJyZW50U2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFByb21pc2U8SU1BcHBDb25maWc+IHtcbiAgICBhd2FpdCBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnKHRlbXBsYXRlSnNvbilcbiAgICBjb25zdCB0ZW1wbGF0ZURsZ0lkID0gT2JqZWN0LmtleXModGVtcGxhdGVKc29uLmNvbmZpZy5kaWFsb2dzKVswXVxuXG4gICAgY29uc3QgZGlhbG9nID0gYXBwQ29uZmlnPy5kaWFsb2dzPy5bZGlhbG9nSWRdXG4gICAgY29uc3QgZGlhbG9nTGF5b3V0ID0gZGlhbG9nPy5sYXlvdXRcbiAgICBjb25zdCB0ZW1wbGF0ZURsZyA9IHRlbXBsYXRlSnNvbj8uY29uZmlnPy5kaWFsb2dzPy5bdGVtcGxhdGVEbGdJZF1cbiAgICBpZiAoZGlhbG9nTGF5b3V0ICYmIHRlbXBsYXRlRGxnPy5sYXlvdXQpIHtcbiAgICAgIGNvbnN0IHRlbXBsYXRlRGxnTGF5b3V0ID0gdGVtcGxhdGVEbGcubGF5b3V0XG4gICAgICBjb25zdCB0ZW1wbGF0ZURsZ0xheW91dElkID0gT2JqZWN0LnZhbHVlcyh0ZW1wbGF0ZURsZ0xheW91dClbMF1cblxuICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55LCB0ZW1wbGF0ZURsZ0xheW91dElkKVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnJlcGxhY2VTaXplTW9kZUxheW91dChcbiAgICAgICAgYXBwQ29uZmlnLFxuICAgICAgICBkaWFsb2dMYXlvdXQsXG4gICAgICAgIHRlbXBsYXRlSnNvbixcbiAgICAgICAgSW1tdXRhYmxlKHRlbXBsYXRlRGxnTGF5b3V0KSxcbiAgICAgICAgY3VycmVudFNpemVNb2RlLFxuICAgICAgICBMYXlvdXRQYXJlbnRUeXBlLkRpYWxvZyxcbiAgICAgICAgZGlhbG9nSWQsXG4gICAgICAgIGNvbnRleHRcbiAgICAgIClcblxuICAgICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cblxuICAgICAgY29uc3QgaXNTYW1lTW9kZSA9IGRpYWxvZy5tb2RlID09PSB0ZW1wbGF0ZURsZy5tb2RlXG4gICAgICBjb25zdCBkbGdJbmRleCA9IGlzU2FtZU1vZGVcbiAgICAgICAgPyBkaWFsb2cuaW5kZXhcbiAgICAgICAgOiBPYmplY3Qua2V5cyhPYmplY3Qua2V5cyh1cGRhdGVkQXBwQ29uZmlnLmRpYWxvZ3MpLmZpbHRlcihkbGdJZCA9PiB1cGRhdGVkQXBwQ29uZmlnLmRpYWxvZ3NbZGxnSWRdLm1vZGUgPT09IHRlbXBsYXRlRGxnLm1vZGUpKS5sZW5ndGhcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnZGlhbG9ncycsIGRpYWxvZ0lkLCAnaW5kZXgnXSwgZGxnSW5kZXgpXG5cbiAgICAgIE9iamVjdC5rZXlzKHJlc3VsdFsxXSkuZm9yRWFjaChtb2RlID0+IHtcbiAgICAgICAgY29uc3QgbGF5b3V0SWQgPSByZXN1bHRbMV1bbW9kZV1cbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAuc2V0SW4oWydkaWFsb2dzJywgZGlhbG9nSWQsICdsYXlvdXQnLCBtb2RlXSwgbGF5b3V0SWQpXG4gICAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIGxheW91dElkLCAncGFyZW50J10sIHsgaWQ6IGRpYWxvZ0lkLCB0eXBlOiBMYXlvdXRQYXJlbnRUeXBlLkRpYWxvZyB9KVxuICAgICAgfSlcblxuICAgICAgLy8gdXBkYXRlIG90aGVyIHByb3BzIGluIGRpYWxvZyB0ZW1wbGF0ZVxuICAgICAgY29uc3QgcHJvcHMgPSBbXG4gICAgICAgICdzaXplTW9kZScsICdtb2RlJywgJ292ZXJsYXlDb2xvcicsICdkaWFsb2dCYWNrZ3JvdW5kJyxcbiAgICAgICAgJ2ludGVyYWN0aW9uVHlwZScsICdpbnRlcmFjdGlvblN0eWxlcycsICdjb25maXJtQmVmb3JlQ2xvc2UnLCAnYWx3YXlzU2hvd0NvbmZpcm1hdGlvbicsICdjbG9zZVdoZW5DbGlja092ZXJsYXknXG4gICAgICBdXG4gICAgICBwcm9wcy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWydkaWFsb2dzJywgZGlhbG9nSWQsIGtleV0sIHRlbXBsYXRlRGxnW2tleV0pXG4gICAgICB9KVxuXG4gICAgICAvLyB1cGRhdGUgaW5kZXggZm9yIG90aGVyIGRpYWxvZ3Mgd2hpY2ggaGFzIHNhbWUgbW9kZSB3aGVuIGN1cnJlbnQgZGlhbG9nJ3MgbW9kZSBpcyBjaGFuZ2VkLlxuICAgICAgaWYgKCFpc1NhbWVNb2RlKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKHVwZGF0ZWRBcHBDb25maWcuZGlhbG9ncykuZm9yRWFjaChkbGdJZCA9PiB7XG4gICAgICAgICAgY29uc3QgZGxnID0gdXBkYXRlZEFwcENvbmZpZy5kaWFsb2dzW2RsZ0lkXVxuICAgICAgICAgIGlmIChkbGcubW9kZSA9PT0gZGlhbG9nLm1vZGUgJiYgZGxnLmluZGV4ID4gZGlhbG9nLmluZGV4KSB7XG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ2RpYWxvZ3MnLCBkbGcuaWQsICdpbmRleCddLCBkbGcuaW5kZXggLSAxKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgICB9XG4gICAgcmV0dXJuIGFwcENvbmZpZ1xuICB9XG5cbiAgYXN5bmMgYXBwbHlHcmlkVGVtcGxhdGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgd2lkZ2V0SWQ6IHN0cmluZyxcbiAgICB0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLFxuICAgIGN1cnJlbnRTaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogUHJvbWlzZTxJTUFwcENvbmZpZz4ge1xuICAgIGF3YWl0IG1ha2VTdXJlVGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uKVxuXG4gICAgY29uc3Qgd2lkZ2V0TGF5b3V0ID0gYXBwQ29uZmlnPy53aWRnZXRzPy5bd2lkZ2V0SWRdPy5sYXlvdXRzXG5cbiAgICBjb25zdCB0ZW1wbGF0ZUdyaWRXaWRnZXQgPSBPYmplY3QudmFsdWVzKHRlbXBsYXRlSnNvbi5jb25maWcud2lkZ2V0cykuZmluZCh3aWRnZXRKc29uID0+IHdpZGdldEpzb24udXJpID09PSAnd2lkZ2V0cy9sYXlvdXQvZ3JpZC8nKVxuICAgIGNvbnN0IG5hbWUgPSAnREVGQVVMVCdcbiAgICBjb25zdCBzaXplTW9kZUxheW91dHMgPSB3aWRnZXRMYXlvdXRbbmFtZV1cbiAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldEluc3RhbmNlKCkuZ2V0U2VydmljZUJ5VHlwZShMYXlvdXRUeXBlLkdyaWRMYXlvdXQpXG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXJ2aWNlLnJlcGxhY2VTaXplTW9kZUxheW91dChcbiAgICAgIGFwcENvbmZpZyxcbiAgICAgIHNpemVNb2RlTGF5b3V0cyxcbiAgICAgIHRlbXBsYXRlSnNvbixcbiAgICAgIEltbXV0YWJsZSh0ZW1wbGF0ZUdyaWRXaWRnZXQubGF5b3V0c1tuYW1lXSksXG4gICAgICBjdXJyZW50U2l6ZU1vZGUsXG4gICAgICBMYXlvdXRQYXJlbnRUeXBlLldpZGdldCxcbiAgICAgIHdpZGdldElkLFxuICAgICAgY29udGV4dFxuICAgIClcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuXG4gICAgT2JqZWN0LmtleXMocmVzdWx0WzFdKS5mb3JFYWNoKG1vZGUgPT4ge1xuICAgICAgY29uc3QgbGF5b3V0SWQgPSByZXN1bHRbMV1bbW9kZV1cbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnXG4gICAgICAgIC5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZCwgJ2xheW91dHMnLCBuYW1lLCBtb2RlXSwgbGF5b3V0SWQpXG4gICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ3BhcmVudCddLCB7IGlkOiB3aWRnZXRJZCwgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5XaWRnZXQgfSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgVGVtcGxhdGVTZXJ2aWNlKClcbiIsImltcG9ydCB7IHR5cGUgSU1BcHBDb25maWcsIHR5cGUgRWxlbWVudFR5cGUsIGkxOG4sIHV0aWxzLCBhcHBDb25maWdVdGlscyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB0eXBlIHsgVGVtcGxhdGUgfSBmcm9tICcuLi90ZW1wbGF0ZXMvdHlwZSdcbmltcG9ydCB7IGdldFRlbXBsYXRlQ29uZmlnIH0gZnJvbSAnamltdS1mb3ItYnVpbGRlci90ZW1wbGF0ZXMnXG5pbXBvcnQgZGVmYXVsdE1lc3NhZ2VzIGZyb20gJy4uL3RyYW5zbGF0aW9ucy9kZWZhdWx0J1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RHVwbGljYXRlTGFiZWwgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIHR5cGU6IEVsZW1lbnRUeXBlLCBsYWJlbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgW3ByZWZpeF0gPSBhcHBDb25maWdVdGlscy5wYXJzZVVuaXF1ZUxhYmVsKGxhYmVsKVxuICBsZXQgbmV3TGFiZWwgPSBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVMYWJlbChhcHBDb25maWcsIHR5cGUsIHByZWZpeClcbiAgaWYgKG5ld0xhYmVsID09PSBwcmVmaXgpIHtcbiAgICBuZXdMYWJlbCA9IGAke3ByZWZpeH0gMWBcbiAgfVxuICByZXR1cm4gbmV3TGFiZWxcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1ha2VTdXJlVGVtcGxhdGVDb25maWcgKHRlbXBsYXRlSnNvbjogVGVtcGxhdGUpIHtcbiAgaWYgKCF0ZW1wbGF0ZUpzb24uY29uZmlnKSB7XG4gICAgY29uc3QgdGVtcGxhdGVDb250ZW50ID0gYXdhaXQgZ2V0VGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uLnR5cGUsIHRlbXBsYXRlSnNvbi5uYW1lKVxuICAgIGFwcENvbmZpZ1V0aWxzLmZpeExheW91dElkcyh0ZW1wbGF0ZUNvbnRlbnQpXG4gICAgdXRpbHMucmVwbGFjZUkxOG5QbGFjZWhvbGRlcnNJbk9iamVjdCh0ZW1wbGF0ZUNvbnRlbnQsIGkxOG4uZ2V0SW50bCgpLCBkZWZhdWx0TWVzc2FnZXMpXG5cbiAgICB0ZW1wbGF0ZUpzb24uY29uZmlnID0gdGVtcGxhdGVDb250ZW50XG4gIH1cbn1cbiIsImltcG9ydCB7IHR5cGUgSU1BcHBDb25maWcgfSBmcm9tICdqaW11LWNvcmUnXG5cbmV4cG9ydCBjbGFzcyBEYXRhQWN0aW9uU2VydmljZSB7XG4gIHJlbW92ZUZyb21XaWRnZXQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIHdpZGdldElkOiBzdHJpbmcpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgd2lkZ2V0ID0gYXBwQ29uZmlnLndpZGdldHNbd2lkZ2V0SWRdXG4gICAgaWYgKCF3aWRnZXQubWFuaWZlc3Q/LmRhdGFBY3Rpb25zIHx8IHdpZGdldC5tYW5pZmVzdC5kYXRhQWN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG5cbiAgICBjb25zb2xlLmRlYnVnKCdyZW1vdmUgZGF0YSBhY3Rpb24gaW4nLCB3aWRnZXRJZClcbiAgICBjb25zdCBhY3Rpb25OYW1lcyA9IHdpZGdldC5tYW5pZmVzdC5kYXRhQWN0aW9ucy5tYXAoZGF0YUFjdGlvbiA9PiBkYXRhQWN0aW9uLm5hbWUpXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIE9iamVjdC5rZXlzKGFwcENvbmZpZy53aWRnZXRzKS5mb3JFYWNoKGlkID0+IHtcbiAgICAgIGxldCB3aWRnZXRJdGVtID0gYXBwQ29uZmlnLndpZGdldHNbaWRdXG4gICAgICBpZiAod2lkZ2V0SXRlbS5kYXRhQWN0aW9ucykge1xuICAgICAgICBhY3Rpb25OYW1lcy5mb3JFYWNoKGFjdGlvbk5hbWUgPT4ge1xuICAgICAgICAgIGNvbnN0IGRhdGFBY3Rpb25Db25maWcgPSB3aWRnZXRJdGVtLmRhdGFBY3Rpb25zPy5bYWN0aW9uTmFtZV1cbiAgICAgICAgICBpZiAoZGF0YUFjdGlvbkNvbmZpZykge1xuICAgICAgICAgICAgY29uc3QgbmV3QWN0aW9ucyA9IGRhdGFBY3Rpb25Db25maWcuYWN0aW9ucz8ud2l0aG91dCh3aWRnZXRJZClcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhuZXdBY3Rpb25zIHx8IHt9KS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoaXMgdHlwZSBvZiBkYXRhIGFjdGlvblxuICAgICAgICAgICAgICB3aWRnZXRJdGVtID0gd2lkZ2V0SXRlbS5zZXQoJ2RhdGFBY3Rpb25zJywgd2lkZ2V0SXRlbS5kYXRhQWN0aW9ucy53aXRob3V0KGFjdGlvbk5hbWUpKVxuICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMod2lkZ2V0SXRlbS5kYXRhQWN0aW9ucykubGVuZ3RoID09PSAwKSB7IC8vIG5vIGFjdGlvbiBsZWZ0IGluIGRhdGFBY3Rpb25zXG4gICAgICAgICAgICAgICAgd2lkZ2V0SXRlbSA9IHdpZGdldEl0ZW0ud2l0aG91dCgnZGF0YUFjdGlvbnMnKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB3aWRnZXRJdGVtID0gd2lkZ2V0SXRlbS5zZXRJbihbJ2RhdGFBY3Rpb25zJywgYWN0aW9uTmFtZSwgJ2FjdGlvbnMnXSwgbmV3QWN0aW9ucylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIGlkXSwgd2lkZ2V0SXRlbSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBEYXRhQWN0aW9uU2VydmljZSgpXG4iLCJpbXBvcnQgeyB0eXBlIElNQXBwQ29uZmlnLCB0eXBlIElNV2lkZ2V0SnNvbiwgdHlwZSBVc2VEYXRhU291cmNlLCB0eXBlIElNVXNlRGF0YVNvdXJjZSwgdHlwZSBJTURhdGFTb3VyY2VKc29uIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgc2VhcmNoVXRpbHMgfSBmcm9tICdqaW11LWxheW91dHMvbGF5b3V0LXJ1bnRpbWUnXG5pbXBvcnQgKiBhcyBhcHBDb25maWdVdGlscyBmcm9tICcuLi8uLi91dGlscy9hcHAtY29uZmlnLXV0aWxzJ1xuaW1wb3J0IHsgZ2V0RHVwbGljYXRlTGFiZWwgfSBmcm9tICcuLi91dGlsJ1xuXG5leHBvcnQgY2xhc3MgRGF0YVNvdXJjZVNlcnZpY2Uge1xuICByZW1vdmVEYXRhU291cmNlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBkYXRhU291cmNlSWQ6IHN0cmluZyk6IElNQXBwQ29uZmlnIHtcbiAgICBpZiAoIWFwcENvbmZpZy5kYXRhU291cmNlcyB8fCAhYXBwQ29uZmlnLmRhdGFTb3VyY2VzW2RhdGFTb3VyY2VJZF0pIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG4gICAgY29uc29sZS5kZWJ1ZygncmVtb3ZlRGF0YVNvdXJjZScsIGRhdGFTb3VyY2VJZClcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXQoJ2RhdGFTb3VyY2VzJywgYXBwQ29uZmlnLmRhdGFTb3VyY2VzLndpdGhvdXQoZGF0YVNvdXJjZUlkKSlcblxuICAgIE9iamVjdC5lbnRyaWVzKHVwZGF0ZWRBcHBDb25maWcud2lkZ2V0cyA/PyB7fSkuZm9yRWFjaCgoW3dJZCwgd0pzb25dKSA9PiB7XG4gICAgICAvLyB1cGRhdGUgd2lkZ2V0IHVzZSBkYXRhIHNvdXJjZVxuICAgICAgaWYgKFxuICAgICAgICB3SnNvbi51c2VEYXRhU291cmNlcyAmJlxuICAgICAgICB3SnNvbi51c2VEYXRhU291cmNlcy5maW5kKCh1c2VEcykgPT4gdGhpcy5zaG91bGRCZVJlbW92ZWQodXNlRHMsIGRhdGFTb3VyY2VJZCkpXG4gICAgICApIHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oXG4gICAgICAgICAgWyd3aWRnZXRzJywgd0lkLCAndXNlRGF0YVNvdXJjZXMnXSxcbiAgICAgICAgICB3SnNvbi51c2VEYXRhU291cmNlcy5maWx0ZXIoKHVzZURzKSA9PiAhdGhpcy5zaG91bGRCZVJlbW92ZWQodXNlRHMsIGRhdGFTb3VyY2VJZCkpXG4gICAgICAgIClcbiAgICAgIH1cbiAgICAgIC8vIHVwZGF0ZSB3aWRnZXQgb3V0cHV0IGRhdGEgc291cmNlXG4gICAgICBpZiAod0pzb24ub3V0cHV0RGF0YVNvdXJjZXMgJiYgd0pzb24ub3V0cHV0RGF0YVNvdXJjZXMuZmluZCgob3V0RHNJZCkgPT4gb3V0RHNJZCA9PT0gZGF0YVNvdXJjZUlkKSkge1xuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihcbiAgICAgICAgICBbJ3dpZGdldHMnLCB3SWQsICdvdXRwdXREYXRhU291cmNlcyddLFxuICAgICAgICAgIHdKc29uLm91dHB1dERhdGFTb3VyY2VzLmZpbHRlcigob3V0RHNJZCkgPT4gb3V0RHNJZCAhPT0gZGF0YVNvdXJjZUlkKVxuICAgICAgICApXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIHVwZGF0ZSBtZXNzYWdlIHVzZSBkYXRhIHNvdXJjZVxuICAgIE9iamVjdC5rZXlzKHVwZGF0ZWRBcHBDb25maWcubWVzc2FnZUNvbmZpZ3MgPz8ge30pLmZvckVhY2goKG1jSWQpID0+IHtcbiAgICAgIGNvbnN0IG1Kc29uID0gdXBkYXRlZEFwcENvbmZpZy5tZXNzYWdlQ29uZmlnc1ttY0lkXVxuICAgICAgY29uc3QgYWN0aW9ucyA9IG1Kc29uLmFjdGlvbnM/LmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSlcbiAgICAgIGFjdGlvbnM/LmZvckVhY2goKGFjdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKGFjdGlvbj8udXNlRGF0YVNvdXJjZXM/LmZpbmQoKHVzZURzKSA9PiB0aGlzLnNob3VsZEJlUmVtb3ZlZCh1c2VEcywgZGF0YVNvdXJjZUlkKSkpIHtcbiAgICAgICAgICBhY3Rpb25zW2luZGV4XS51c2VEYXRhU291cmNlcyA9IGFjdGlvbi51c2VEYXRhU291cmNlcy5maWx0ZXIoXG4gICAgICAgICAgICAodXNlRHMpID0+ICF0aGlzLnNob3VsZEJlUmVtb3ZlZCh1c2VEcywgZGF0YVNvdXJjZUlkKVxuICAgICAgICAgIClcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ21lc3NhZ2VDb25maWdzJywgbWNJZCwgJ2FjdGlvbnMnXSwgYWN0aW9ucylcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgLy8gcmVtb3ZlIG91dHB1dCBkYXRhIHNvdXJjZVxuICAgIE9iamVjdC5lbnRyaWVzKHVwZGF0ZWRBcHBDb25maWcuZGF0YVNvdXJjZXMpLmZvckVhY2goKFtkc0lkLCBkc0pzb25dKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGRzSnNvbi5vcmlnaW5EYXRhU291cmNlcyAmJlxuICAgICAgICAhIWRzSnNvbi5vcmlnaW5EYXRhU291cmNlcy5maW5kKCh1c2VEcykgPT4gdGhpcy5zaG91bGRCZVJlbW92ZWQodXNlRHMsIGRhdGFTb3VyY2VJZCkpXG4gICAgICApIHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMucmVtb3ZlRGF0YVNvdXJjZSh1cGRhdGVkQXBwQ29uZmlnLCBkc0lkKVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxuXG4gIGR1cGxpY2F0ZURhdGFTb3VyY2UgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGRhdGFTb3VyY2VJZDogc3RyaW5nKTogW0lNQXBwQ29uZmlnLCBJTURhdGFTb3VyY2VKc29uXSB7XG4gICAgaWYgKCFhcHBDb25maWcuZGF0YVNvdXJjZXMgfHwgIWFwcENvbmZpZy5kYXRhU291cmNlc1tkYXRhU291cmNlSWRdKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ2R1cGxpY2F0ZSBkYXRhIHNvdXJjZScsIGRhdGFTb3VyY2VJZClcbiAgICBjb25zdCBkc0pzb24gPSBhcHBDb25maWcuZGF0YVNvdXJjZXNbZGF0YVNvdXJjZUlkXVxuICAgIGNvbnN0IG5ld0RzSnNvbiA9IGRzSnNvbi5zZXQoJ2lkJywgYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnZGF0YVNvdXJjZScpKVxuICAgICAgLnNldCgnbGFiZWwnLCBnZXREdXBsaWNhdGVMYWJlbChhcHBDb25maWcsICdkYXRhU291cmNlJywgZHNKc29uLmxhYmVsKSlcbiAgICBjb25zdCB1cGRhdGVkQXBwQ29uZmlnID0gdGhpcy5hZGREYXRhU291cmNlKGFwcENvbmZpZywgbmV3RHNKc29uKVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCBuZXdEc0pzb25dXG4gIH1cblxuICBhZGREYXRhU291cmNlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBkYXRhU291cmNlSnNvbjogSU1EYXRhU291cmNlSnNvbik6IElNQXBwQ29uZmlnIHtcbiAgICBpZiAoYXBwQ29uZmlnLmRhdGFTb3VyY2VzICYmIGFwcENvbmZpZy5kYXRhU291cmNlc1tkYXRhU291cmNlSnNvbi5pZF0pIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG5cbiAgICByZXR1cm4gYXBwQ29uZmlnLnNldEluKFsnZGF0YVNvdXJjZXMnLCBkYXRhU291cmNlSnNvbi5pZF0sIGRhdGFTb3VyY2VKc29uKVxuICB9XG5cbiAgdXBkYXRlQWZ0ZXJDaGFuZ2luZ0xheW91dCAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgd2lkZ2V0SWQ6IHN0cmluZywgdG9MYXlvdXRJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIGlmICghYXBwQ29uZmlnLndpZGdldHNbd2lkZ2V0SWRdKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIGNvbnNvbGUuZGVidWcod2lkZ2V0SWQsICd1cGRhdGUgZGF0YSBzb3VyY2UgYWZ0ZXIgbW92ZSB0bycsIHRvTGF5b3V0SWQpXG4gICAgbGV0IHdpZGdldEpzb24gPSBhcHBDb25maWcud2lkZ2V0c1t3aWRnZXRJZF1cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICAgIGNvbnN0IHBhcmVudFdpZGdldElkID0gc2VhcmNoVXRpbHMuZ2V0V2lkZ2V0SWRUaGF0VXNlVGhlTGF5b3V0SWQodXBkYXRlZEFwcENvbmZpZywgdG9MYXlvdXRJZClcbiAgICBpZiAocGFyZW50V2lkZ2V0SWQpIHtcbiAgICAgIGNvbnN0IHBhcmVudFdpZGdldEpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLndpZGdldHNbcGFyZW50V2lkZ2V0SWRdXG4gICAgICBpZiAocGFyZW50V2lkZ2V0SnNvbi5tYW5pZmVzdC5wcm9wZXJ0aWVzLnBhc3NEYXRhU291cmNlVG9DaGlsZHJlbikge1xuICAgICAgICB3aWRnZXRKc29uID0gdGhpcy5tZXJnZVVzZURhdGFTb3VyY2UocGFyZW50V2lkZ2V0SnNvbiwgd2lkZ2V0SnNvbilcblxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRKc29uLmlkXSwgd2lkZ2V0SnNvbilcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxuXG4gIHByaXZhdGUgbWVyZ2VVc2VEYXRhU291cmNlIChmcm9tV2lkZ2V0SnNvbjogSU1XaWRnZXRKc29uLCB0b1dpZGdldEpzb246IElNV2lkZ2V0SnNvbik6IElNV2lkZ2V0SnNvbiB7XG4gICAgaWYgKCFmcm9tV2lkZ2V0SnNvbi51c2VEYXRhU291cmNlcykge1xuICAgICAgcmV0dXJuIHRvV2lkZ2V0SnNvblxuICAgIH1cblxuICAgIGNvbnN0IGZyb21Vc2VEcyA9IGZyb21XaWRnZXRKc29uLnVzZURhdGFTb3VyY2VzLm1hcCh1c2VEcyA9PiB7XG4gICAgICByZXR1cm4gdXNlRHMud2l0aG91dCgnZmllbGRzJylcbiAgICB9KVxuXG4gICAgaWYgKCF0b1dpZGdldEpzb24udXNlRGF0YVNvdXJjZXMpIHtcbiAgICAgIHJldHVybiB0b1dpZGdldEpzb24uc2V0KCd1c2VEYXRhU291cmNlcycsIGZyb21Vc2VEcykuc2V0KCd1c2VEYXRhU291cmNlc0VuYWJsZWQnLCB0cnVlKVxuICAgIH1cblxuICAgIGZyb21Vc2VEcy5mb3JFYWNoKHVzZURzID0+IHtcbiAgICAgIGlmICh1c2VEcy5kYXRhVmlld0lkKSB7XG4gICAgICAgIGlmICghdG9XaWRnZXRKc29uLnVzZURhdGFTb3VyY2VzLmZpbmQoZHMgPT4gZHMuZGF0YVNvdXJjZUlkID09PSB1c2VEcy5kYXRhU291cmNlSWQgJiYgZHMuZGF0YVZpZXdJZCA9PT0gdXNlRHMuZGF0YVZpZXdJZCkpIHtcbiAgICAgICAgICB0b1dpZGdldEpzb24gPSB0b1dpZGdldEpzb24uc2V0KCd1c2VEYXRhU291cmNlcycsIHRvV2lkZ2V0SnNvbi51c2VEYXRhU291cmNlcy5jb25jYXQoW3VzZURzXSkpXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghdG9XaWRnZXRKc29uLnVzZURhdGFTb3VyY2VzLmZpbmQoZHMgPT4gZHMuZGF0YVNvdXJjZUlkID09PSB1c2VEcy5kYXRhU291cmNlSWQpKSB7XG4gICAgICAgICAgdG9XaWRnZXRKc29uID0gdG9XaWRnZXRKc29uLnNldCgndXNlRGF0YVNvdXJjZXMnLCB0b1dpZGdldEpzb24udXNlRGF0YVNvdXJjZXMuY29uY2F0KFt1c2VEc10pKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiB0b1dpZGdldEpzb24uc2V0KCd1c2VEYXRhU291cmNlc0VuYWJsZWQnLCB0cnVlKVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBkYXRhIHNvdXJjZSB3aGljaCBpczpcbiAgICogIDEuIHRoZSBkYXRhIHNvdXJjZSB0byBiZSByZW1vdmVkLCBvcixcbiAgICogIDIuIGRlcml2ZWQgZnJvbSB0aGUgZGF0YSBzb3VyY2UgdG8gYmUgcmVtb3ZlZCAoZGF0YSB2aWV3cyBhbmQgbG9jYWwgZGF0YSBzb3VyY2VzKSwgb3IsXG4gICAqICAzLiBkZXNjZW5kYW50IGRhdGEgc291cmNlIG9mIHRoZSBkYXRhIHNvdXJjZSB0byBiZSByZW1vdmVkIChlLmcuIGNoaWxkIGRhdGEgc291cmNlIGFuZCBncmFuZGNoaWxkIGRhdGEgc291cmNlKSwgb3IsXG4gICAqICA0LiBkZXJpdmVkIGZyb20gdGhlIGRlc2NlbmRhbnQgZGF0YSBzb3VyY2Ugb2YgdGhlIGRhdGEgc291cmNlIHRvIGJlIHJlbW92ZWQgKGUuZy4gZGF0YSB2aWV3cyBvZiBjaGlsZCBkYXRhIHNvdXJjZSkuXG4gICAqL1xuICBwcml2YXRlIHNob3VsZEJlUmVtb3ZlZCAoXG4gICAgdXNlRHM6IFVzZURhdGFTb3VyY2UgfCBJTVVzZURhdGFTb3VyY2UsXG4gICAgcmVhbFRvQmVSZW1vdmVkRHNJZDogc3RyaW5nXG4gICk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAoXG4gICAgICAhdXNlRHMgfHxcbiAgICAgIHVzZURzLmRhdGFTb3VyY2VJZCA9PT0gcmVhbFRvQmVSZW1vdmVkRHNJZCB8fFxuICAgICAgdXNlRHMubWFpbkRhdGFTb3VyY2VJZCA9PT0gcmVhbFRvQmVSZW1vdmVkRHNJZCB8fFxuICAgICAgdXNlRHMucm9vdERhdGFTb3VyY2VJZCA9PT0gcmVhbFRvQmVSZW1vdmVkRHNJZFxuICAgIClcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgRGF0YVNvdXJjZVNlcnZpY2UoKVxuIiwiaW1wb3J0IHsgdHlwZSBJTUFwcENvbmZpZywgdHlwZSBJbW11dGFibGVPYmplY3QsIHR5cGUgTWVzc2FnZUpzb24sIEltbXV0YWJsZSB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCAqIGFzIGFwcENvbmZpZ1V0aWxzIGZyb20gJy4uLy4uL3V0aWxzL2FwcC1jb25maWctdXRpbHMnXG5cbmludGVyZmFjZSBNZXNzYWdlQ29uZmlnIHtcbiAgW21lc3NhZ2VDb25maWdJZDogc3RyaW5nXTogTWVzc2FnZUpzb25cbn1cblxuZXhwb3J0IGNsYXNzIE1lc3NhZ2VBY3Rpb25TZXJ2aWNlIHtcbiAgLyoqXG4gICAqIER1cGxpY2F0ZSBhIHdpZGdldCdzIG1lc3NhZ2UgYWN0aW9uIGNvbmZpZy4gSW5jbHVkaW5nOlxuICAgKiAxLiBkdXBsaWNhdGUgdGhlIGl0ZW0gdGhhdCBtYXRjaGVzIHdpZGdldElkXG4gICAqIDIuIGR1cGxpY2F0ZSBhY3Rpb25zIHRoYXQgbWF0Y2hlcyB3aWRnZXRJZFxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSB3aWRnZXRJZFxuICAgKiBAcGFyYW0gbmV3V2lkZ2V0SWRcbiAgICogQHJldHVybnNcbiAgICovXG4gIGR1cGxpY2F0ZSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgd2lkZ2V0SWQ6IHN0cmluZywgbmV3V2lkZ2V0SWQ6IHN0cmluZyk6IFtJTUFwcENvbmZpZywgc3RyaW5nXSB7XG4gICAgY29uc3QgbWVzc2FnZUNvbmZpZ3MgPSBhcHBDb25maWcubWVzc2FnZUNvbmZpZ3NcbiAgICBpZiAoIW1lc3NhZ2VDb25maWdzKSB7XG4gICAgICByZXR1cm4gW2FwcENvbmZpZywgbnVsbF1cbiAgICB9XG4gICAgY29uc29sZS5kZWJ1ZygnZHVwbGljYXRlIG1lc3NhZ2UgY29uZmlncyBmcm9tJywgd2lkZ2V0SWQsICd0bycsIG5ld1dpZGdldElkKVxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgbGV0IG5ld01jSWQgPSBudWxsXG5cbiAgICBPYmplY3Qua2V5cyhtZXNzYWdlQ29uZmlncykuZm9yRWFjaChtY0lkID0+IHtcbiAgICAgIGlmIChtZXNzYWdlQ29uZmlnc1ttY0lkXS53aWRnZXRJZCA9PT0gd2lkZ2V0SWQpIHtcbiAgICAgICAgY29uc3QgbmV3TUpzb24gPSBtZXNzYWdlQ29uZmlnc1ttY0lkXVxuICAgICAgICAgIC5zZXQoJ2lkJywgYXBwQ29uZmlnVXRpbHMuZ2V0VW5pcXVlSWQoYXBwQ29uZmlnLCAnbWVzc2FnZUNvbmZpZycpKVxuICAgICAgICAgIC5zZXQoJ3dpZGdldElkJywgbmV3V2lkZ2V0SWQpXG4gICAgICAgIG5ld01jSWQgPSBuZXdNSnNvbi5pZFxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ21lc3NhZ2VDb25maWdzJywgbmV3TUpzb24uaWRdLCBuZXdNSnNvbilcbiAgICAgIH1cblxuICAgICAgaWYgKG1lc3NhZ2VDb25maWdzW21jSWRdLmFjdGlvbnMpIHtcbiAgICAgICAgY29uc3QgdG9BZGQgPSBbXVxuICAgICAgICBtZXNzYWdlQ29uZmlnc1ttY0lkXS5hY3Rpb25zLmZvckVhY2goYWN0aW9uSnNvbiA9PiB7XG4gICAgICAgICAgaWYgKGFjdGlvbkpzb24ud2lkZ2V0SWQgPT09IHdpZGdldElkKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdBY3Rpb25Kc29uID0gYWN0aW9uSnNvbi5zZXQoJ3dpZGdldElkJywgbmV3V2lkZ2V0SWQpXG4gICAgICAgICAgICB0b0FkZC5wdXNoKG5ld0FjdGlvbkpzb24pXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBpZiAodG9BZGQubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnbWVzc2FnZUNvbmZpZ3MnLCBtZXNzYWdlQ29uZmlnc1ttY0lkXS5pZCwgJ2FjdGlvbnMnXSwgbWVzc2FnZUNvbmZpZ3NbbWNJZF0uYWN0aW9ucy5jb25jYXQodG9BZGQpKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV3TWNJZF1cbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiB0aGUgbWVzc2FnZUNvbmZpZ3MsIHJlbW92ZSBhbnl0aGluZyB0aGF0IHJlbGF0ZWQgdG8gdGhlIHdpZGdldElkXG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIHdpZGdldElkXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICByZW1vdmVGcm9tV2lkZ2V0IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCB3aWRnZXRJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IG1lc3NhZ2VDb25maWdzID0gYXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzXG4gICAgaWYgKCFtZXNzYWdlQ29uZmlncykge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBtZXNzYWdlIGFuZCBhY3Rpb24gaW4nLCB3aWRnZXRJZClcbiAgICBjb25zdCBtZXNzYWdlQ29uZmlnc0tleXMgPSBPYmplY3Qua2V5cyhtZXNzYWdlQ29uZmlncylcbiAgICBsZXQgbWVzc2FnZUNvbmZpZ3NXaXRob3V0V2lkZ2V0SWQ6IEltbXV0YWJsZU9iamVjdDxNZXNzYWdlQ29uZmlnPiA9IEltbXV0YWJsZSh7fSkgYXMgSW1tdXRhYmxlT2JqZWN0PE1lc3NhZ2VDb25maWc+XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlQ29uZmlnc0tleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChtZXNzYWdlQ29uZmlnc1ttZXNzYWdlQ29uZmlnc0tleXNbaV1dLndpZGdldElkICE9PSB3aWRnZXRJZCkge1xuICAgICAgICBtZXNzYWdlQ29uZmlnc1dpdGhvdXRXaWRnZXRJZCA9IG1lc3NhZ2VDb25maWdzV2l0aG91dFdpZGdldElkLnNldEluKFxuICAgICAgICAgIFttZXNzYWdlQ29uZmlnc1ttZXNzYWdlQ29uZmlnc0tleXNbaV1dLmlkXSxcbiAgICAgICAgICBtZXNzYWdlQ29uZmlnc1ttZXNzYWdlQ29uZmlnc0tleXNbaV1dXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBuZXdNZXNzYWdlQ29uZmlnc0tleXMgPSBPYmplY3Qua2V5cyhtZXNzYWdlQ29uZmlnc1dpdGhvdXRXaWRnZXRJZClcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5ld01lc3NhZ2VDb25maWdzS2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgbmV3TWVzc2FnZUNvbmZpZyA9IG1lc3NhZ2VDb25maWdzV2l0aG91dFdpZGdldElkW25ld01lc3NhZ2VDb25maWdzS2V5c1tpXV1cbiAgICAgIGNvbnN0IGFjdGlvbnMgPSBuZXdNZXNzYWdlQ29uZmlnLmFjdGlvbnNcbiAgICAgIGlmIChhY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgY29uc3QgYWN0aW9uc1dpdGhvdXRXaWRnZXRJZCA9IGFjdGlvbnMuZmlsdGVyKChhY3Rpb24pID0+IGFjdGlvbi53aWRnZXRJZCAhPT0gd2lkZ2V0SWQpXG4gICAgICBjb25zdCB0ZW1wQWN0aW9ucyA9IE9iamVjdC5hc3NpZ24oW10sIGFjdGlvbnNXaXRob3V0V2lkZ2V0SWQpXG4gICAgICBtZXNzYWdlQ29uZmlnc1dpdGhvdXRXaWRnZXRJZCA9IG1lc3NhZ2VDb25maWdzV2l0aG91dFdpZGdldElkLnNldEluKFxuICAgICAgICBbbWVzc2FnZUNvbmZpZ3NbbmV3TWVzc2FnZUNvbmZpZ3NLZXlzW2ldXS5pZCwgJ2FjdGlvbnMnXSxcbiAgICAgICAgdGVtcEFjdGlvbnNcbiAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gYXBwQ29uZmlnLnNldCgnbWVzc2FnZUNvbmZpZ3MnLCBtZXNzYWdlQ29uZmlnc1dpdGhvdXRXaWRnZXRJZClcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgTWVzc2FnZUFjdGlvblNlcnZpY2UoKVxuIiwiaW1wb3J0IHsgdHlwZSBJTUFwcENvbmZpZyB9IGZyb20gJ2ppbXUtY29yZSdcblxuZXhwb3J0IGNsYXNzIFVzZU1hcFNlcnZpY2Uge1xuICByZW1vdmUgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIG1hcFdpZGdldElkOiBzdHJpbmcpIHtcbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuXG4gICAgY29uc29sZS5kZWJ1ZygncmVtb3ZlIHVzZWQgbWFwIHdpZGdldHMnLCBtYXBXaWRnZXRJZClcbiAgICBPYmplY3Qua2V5cyh1cGRhdGVkQXBwQ29uZmlnLndpZGdldHMpLmZvckVhY2goKHdpZGdldElkKSA9PiB7XG4gICAgICBjb25zdCB3aWRnZXRKc29uID0gdXBkYXRlZEFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXVxuICAgICAgaWYgKHdpZGdldEpzb24udXNlTWFwV2lkZ2V0SWRzPy5pbmNsdWRlcyhtYXBXaWRnZXRJZCkpIHtcbiAgICAgICAgY29uc3QgdXNlTWFwV2lkZ2V0SWRzID0gd2lkZ2V0SnNvbi51c2VNYXBXaWRnZXRJZHMuZmlsdGVyKChpZCkgPT4gaWQgIT09IG1hcFdpZGdldElkKVxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZCwgJ3VzZU1hcFdpZGdldElkcyddLCB1c2VNYXBXaWRnZXRJZHMpXG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBVc2VNYXBTZXJ2aWNlKClcbiIsImltcG9ydCB7XG4gIFdpZGdldFR5cGUsXG4gIExheW91dFBhcmVudFR5cGUsXG4gIGV4dGVuc2lvblNwZWMsXG4gIHR5cGUgV2lkZ2V0TWFuaWZlc3QsXG4gIHR5cGUgSU1XaWRnZXRNYW5pZmVzdCxcbiAgdHlwZSBJTUFwcENvbmZpZyxcbiAgdHlwZSBXaWRnZXRKc29uLFxuICB0eXBlIElNV2lkZ2V0SnNvbixcbiAgdHlwZSBMYXlvdXRJbmZvLFxuICBCcm93c2VyU2l6ZU1vZGUsXG4gIGkxOG4sXG4gIExheW91dFR5cGVcbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgQmFzZUNvbnRlbnRTZXJ2aWNlLCB0eXBlIER1cGxpY2F0ZUNvbnRleHQgfSBmcm9tICcuL2Jhc2UtY29udGVudC1zZXJ2aWNlJ1xuaW1wb3J0ICogYXMgYXBwQ29uZmlnVXRpbHMgZnJvbSAnLi4vdXRpbHMvYXBwLWNvbmZpZy11dGlscydcbmltcG9ydCB7IExheW91dFNlcnZpY2VQcm92aWRlciB9IGZyb20gJy4vbGF5b3V0LXNlcnZpY2UtcHJvdmlkZXInXG5pbXBvcnQgeyBnZXREdXBsaWNhdGVMYWJlbCwgbWFrZVN1cmVUZW1wbGF0ZUNvbmZpZyB9IGZyb20gJy4vdXRpbCdcbmltcG9ydCBkYXRhU291cmNlU2VydmljZSwgeyB0eXBlIERhdGFTb3VyY2VTZXJ2aWNlIH0gZnJvbSAnLi93aWRnZXQtcmVzb3VyY2UvZGF0YS1zb3VyY2Utc2VydmljZSdcbmltcG9ydCBtZXNzYWdlQWN0aW9uU2VydmljZSwgeyB0eXBlIE1lc3NhZ2VBY3Rpb25TZXJ2aWNlIH0gZnJvbSAnLi93aWRnZXQtcmVzb3VyY2UvbWVzc2FnZS1hY3Rpb24tc2VydmljZSdcbmltcG9ydCBkYXRhQWN0aW9uU2VydmljZSwgeyB0eXBlIERhdGFBY3Rpb25TZXJ2aWNlIH0gZnJvbSAnLi93aWRnZXQtcmVzb3VyY2UvZGF0YS1hY3Rpb24tc2VydmljZSdcbmltcG9ydCB1c2VNYXBTZXJ2aWNlLCB7IHR5cGUgVXNlTWFwU2VydmljZSB9IGZyb20gJy4vd2lkZ2V0LXJlc291cmNlL3VzZW1hcC1zZXJ2aWNlJ1xuaW1wb3J0IHsgdHlwZSBUb2NOb2RlIH0gZnJvbSAnLi9iYXNlLWxheW91dC1zZXJ2aWNlJ1xuaW1wb3J0IHsgdHlwZSBUZW1wbGF0ZSB9IGZyb20gJy4uL3RlbXBsYXRlcydcbmltcG9ydCBBcHBXaWRnZXRNYW5hZ2VyIGZyb20gJy4uL2FwcC13aWRnZXQtbWFuYWdlcidcbmltcG9ydCBwbGFjZUhvbGRlck91dGxpbmVkIGZyb20gJ2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3dpZGdldC1wbGFjZS1ob2xkZXIuc3ZnJ1xuaW1wb3J0IGZpeGVkUGFuZWxPdXRsaW5lZCBmcm9tICdqaW11LWljb25zL3N2Zy9vdXRsaW5lZC9icmFuZC93aWRnZXQtZml4ZWQtcGFuZWwuc3ZnJ1xuaW1wb3J0IHJvd091dGxpbmVkIGZyb20gJ2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3dpZGdldC1yb3cuc3ZnJ1xuaW1wb3J0IGNvbHVtbk91dGxpbmVkIGZyb20gJ2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2JyYW5kL3dpZGdldC1jb2x1bW4uc3ZnJ1xuXG5mdW5jdGlvbiBoYXNFbWJlZGRlZExheW91dEluV2lkZ2V0IChtYW5pZmVzdDogV2lkZ2V0TWFuaWZlc3QgfCBJTVdpZGdldE1hbmlmZXN0KSB7XG4gIHJldHVybiBtYW5pZmVzdD8ud2lkZ2V0VHlwZSA9PT0gV2lkZ2V0VHlwZS5MYXlvdXQgfHwgKG1hbmlmZXN0Py5wcm9wZXJ0aWVzPy5oYXNFbWJlZGRlZExheW91dCA/PyBmYWxzZSlcbn1cblxuZnVuY3Rpb24gZ2V0TGF5b3V0SWNvbiAobGF5b3V0VHlwZTogTGF5b3V0VHlwZSkge1xuICBzd2l0Y2ggKGxheW91dFR5cGUpIHtcbiAgICBjYXNlIExheW91dFR5cGUuRml4ZWRMYXlvdXQ6XG4gICAgICByZXR1cm4gZml4ZWRQYW5lbE91dGxpbmVkXG4gICAgY2FzZSBMYXlvdXRUeXBlLlJvd0xheW91dDpcbiAgICAgIHJldHVybiByb3dPdXRsaW5lZFxuICAgIGNhc2UgTGF5b3V0VHlwZS5Db2x1bW5MYXlvdXQ6XG4gICAgICByZXR1cm4gY29sdW1uT3V0bGluZWRcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG4vKipcbiAqIFdpZGdldCBtYW5hZ2VzIHNvbWUgcmVzb3VyY2VzLCBlLmcuIGxheW91dCwgZGF0YSBzb3VyY2UsIGRhdGEgYWN0aW9uLCBldGMuXG4gKiBXaWxsIGhhbmRsZSBhbGwgcHJvcGVydGllcyBsaXN0ZWQgaW4gdGhlIFdpZGdldEpzb24gZXhjZXB0IHRoZSBjb25maWdcbiAqL1xuZXhwb3J0IGNsYXNzIFdpZGdldFNlcnZpY2UgZXh0ZW5kcyBCYXNlQ29udGVudFNlcnZpY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IGRzU2VydmljZTogRGF0YVNvdXJjZVNlcnZpY2VcbiAgcHJpdmF0ZSByZWFkb25seSBtZXNzYWdlQWN0aW9uU2VydmljZTogTWVzc2FnZUFjdGlvblNlcnZpY2VcbiAgcHJpdmF0ZSByZWFkb25seSBkYXRhQWN0aW9uU2VydmljZTogRGF0YUFjdGlvblNlcnZpY2VcbiAgcHJpdmF0ZSByZWFkb25seSB1c2VNYXBTZXJ2aWNlOiBVc2VNYXBTZXJ2aWNlXG5cbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLmRzU2VydmljZSA9IGRhdGFTb3VyY2VTZXJ2aWNlXG4gICAgdGhpcy5tZXNzYWdlQWN0aW9uU2VydmljZSA9IG1lc3NhZ2VBY3Rpb25TZXJ2aWNlXG4gICAgdGhpcy5kYXRhQWN0aW9uU2VydmljZSA9IGRhdGFBY3Rpb25TZXJ2aWNlXG4gICAgdGhpcy51c2VNYXBTZXJ2aWNlID0gdXNlTWFwU2VydmljZVxuICB9XG5cbiAgYXN5bmMgY3JlYXRlRnJvbVRlbXBsYXRlIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIHRlbXBsYXRlSnNvbjogVGVtcGxhdGUsXG4gICAgd2lkZ2V0SWQ6IHN0cmluZyxcbiAgICBzaXplTW9kZUxpc3Q6IEJyb3dzZXJTaXplTW9kZVtdLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHQsXG4gICAgb3B0aW9uczogYW55XG4gICk6IFByb21pc2U8W2FwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld0lkOiBzdHJpbmddPiB7XG4gICAgaWYgKGNvbnRleHRbd2lkZ2V0SWRdKSB7XG4gICAgICAvLyBhbHJlYWR5IGR1cGxpY2F0ZCBpbiBhIHN0YWNrIG9mIGZ1bmN0aW9uIGludm9rYXRpb25zLlxuICAgICAgLy8gVXNlIGNhc2U6IEEgQ2FyZCB3aWRnZXQgaXMgc2hhcmVkIGluIGEgcGFnZSdzIExhcmdlIGFuZCBTbWFsbCBzaXplIG1vZGUsIGFuZCB0aGUgcGFnZSBpcyBkdXBsaWNhdGVkLlxuICAgICAgLy8gMS4gY2FyZCBpcyBkdXBsaWNhdGVkIGluIExhcmdlIHNpemUgbW9kZSwgaXRzIGVtYmVkIGxheW91dHMgaXMgZHVwbGljYXRlZCBpbiBMYXJnZSBzaXplIG1vZGUgdG9vLlxuICAgICAgLy8gMi4gd2hlbiBkdXBsaWNhdGUgdGhlIHNtYWxsIHNpemUgbW9kZSwgdGhlIGNhcmQgZG9lcyBub3QgbmVlZCB0byBiZSBkdXBsaWNhdGVkIGFnYWluLCBidXQgdGhlIGVtYmVkIGxheW91dHMgbmVlZHMgdG8gYmUgZHVwbGljYXRlZC5cblxuICAgICAgLy8gY2hlY2sgdGhlIGR1cGxpY2F0ZWQgd2lkZ2V0IGhhcyB0aGUgdGFyZ2V0IGJyb3dzZXIgc2l6ZSBtb2RlIGxheW91dFxuICAgICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZy53aWRnZXRzW2NvbnRleHRbd2lkZ2V0SWRdXVxuICAgICAgaWYgKCF3aWRnZXRKc29uLmxheW91dHMpIHtcbiAgICAgICAgcmV0dXJuIFthcHBDb25maWcsIGNvbnRleHRbd2lkZ2V0SWRdXVxuICAgICAgfVxuXG4gICAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuICAgICAgY29uc3Qgb3JpZ2luV2lkZ2V0ID0gdGVtcGxhdGVKc29uLmNvbmZpZy53aWRnZXRzW3dpZGdldElkXVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemVNb2RlTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBzaXplTW9kZSA9IHNpemVNb2RlTGlzdFtpXVxuICAgICAgICAvLyBjcmVhdGUgZW1iZWQgbGF5b3V0IGluIHRhcmdldCBicm93c2VyIHNpemUgbW9kZSBmcm9tIHRlbXBsYXRlLCBvbmx5IHNlbGVjdCBub24tZW1wdHkgbGF5b3V0TmFtZVxuICAgICAgICBjb25zdCBsYXlvdXROYW1lcyA9IE9iamVjdC5rZXlzKG9yaWdpbldpZGdldC5sYXlvdXRzKS5maWx0ZXIobGF5b3V0TmFtZSA9PiBPYmplY3Qua2V5cyhvcmlnaW5XaWRnZXQubGF5b3V0c1tsYXlvdXROYW1lXSA/PyB7fSkubGVuZ3RoID4gMClcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBsYXlvdXROYW1lcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGNvbnN0IG5hbWUgPSBsYXlvdXROYW1lc1tqXVxuICAgICAgICAgIGlmICh3aWRnZXRKc29uLmxheW91dHNbbmFtZV1bc2l6ZU1vZGVdKSB7XG4gICAgICAgICAgICBjb250aW51ZVxuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBsYXlvdXRJZCA9IG9yaWdpbldpZGdldC5sYXlvdXRzW25hbWVdW3NpemVNb2RlXVxuICAgICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0ZW1wbGF0ZUpzb24uY29uZmlnIGFzIGFueSwgbGF5b3V0SWQpXG4gICAgICAgICAgY29uc3QgZHVwUmVzdWx0ID0gYXdhaXQgc2VydmljZS5jcmVhdGVMYXlvdXRGcm9tVGVtcGxhdGUoXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgICAgICAgdGVtcGxhdGVKc29uLFxuICAgICAgICAgICAgbGF5b3V0SWQsXG4gICAgICAgICAgICBzaXplTW9kZSxcbiAgICAgICAgICAgIExheW91dFBhcmVudFR5cGUuV2lkZ2V0LFxuICAgICAgICAgICAgY29udGV4dFt3aWRnZXRJZF0sXG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgICAgKVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBkdXBSZXN1bHRbMF1cbiAgICAgICAgICBjb25zdCBuZXdMYXlvdXRJZCA9IGR1cFJlc3VsdFsxXVxuICAgICAgICAgIGlmIChuZXdMYXlvdXRJZCAhPSBudWxsKSB7XG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCBjb250ZXh0W3dpZGdldElkXSwgJ2xheW91dHMnLCBuYW1lLCBzaXplTW9kZV0sIG5ld0xheW91dElkKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIGNvbnRleHRbd2lkZ2V0SWRdXVxuICAgIH1cblxuICAgIGNvbnN0IGlzQmxvY2sgPSBvcHRpb25zPy5pc0Jsb2NrID8/IGZhbHNlXG5cbiAgICBhd2FpdCBtYWtlU3VyZVRlbXBsYXRlQ29uZmlnKHRlbXBsYXRlSnNvbilcblxuICAgIGNvbnN0IHRlbXBsYXRlQ29uZmlnID0gdGVtcGxhdGVKc29uLmNvbmZpZ1xuICAgIGNvbnN0IGJsb2NrV2lkZ2V0SWQgPSBPYmplY3Qua2V5cyh0ZW1wbGF0ZUNvbmZpZy53aWRnZXRzKS5maW5kKHdJZCA9PiB0ZW1wbGF0ZUNvbmZpZy53aWRnZXRzW3dJZF0udXJpID09PSAnd2lkZ2V0cy9sYXlvdXQvcm93LycpXG4gICAgd2lkZ2V0SWQgPSB3aWRnZXRJZCA/PyBibG9ja1dpZGdldElkXG4gICAgY29uc3QgdGVtcGxhdGVXaWRnZXQgPSB0ZW1wbGF0ZUNvbmZpZy53aWRnZXRzW3dpZGdldElkXVxuICAgIGNvbnN0IHVzZU1hcFdpZGdldElkcyA9IFtdXG5cbiAgICBjb25zdCBsb2FkZWRKc29uID0gYXdhaXQgQXBwV2lkZ2V0TWFuYWdlci5nZXRJbnN0YW5jZSgpLmhhbmRsZU5ld1dpZGdldEpzb24oe1xuICAgICAgdXJpOiB0ZW1wbGF0ZVdpZGdldC51cmlcbiAgICB9IGFzIFdpZGdldEpzb24pXG4gICAgLy8gdXBkYXRlIGxhYmVsLCBzaW5jZSB0aGUgYXBwQ29uZmlnIGRvZXNub3QgdXBkYXRlZCwgdGhlIGxhYmVsIHdpbGwgYWx3YXlzIGJlIHRoZSBzYW1lXG4gICAgbG9hZGVkSnNvbi5sYWJlbCA9IGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUxhYmVsKFxuICAgICAgYXBwQ29uZmlnLFxuICAgICAgJ3dpZGdldCcsXG4gICAgICBsb2FkZWRKc29uLm1hbmlmZXN0ID8gbG9hZGVkSnNvbi5tYW5pZmVzdC5pMThuTWVzc2FnZXMuX3dpZGdldExhYmVsIHx8IGxvYWRlZEpzb24ubWFuaWZlc3QubGFiZWwgfHwgbG9hZGVkSnNvbi5tYW5pZmVzdC5uYW1lIDogJydcbiAgICApXG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jcmVhdGVXaWRnZXQoYXBwQ29uZmlnLCBsb2FkZWRKc29uLCBzaXplTW9kZUxpc3QsIGZhbHNlKSAvLyBlbWJlZCBsYXlvdXQgd2lsbCBiZSB1cGRhdGVkIGxhdGVyXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICBjb25zdCBuZXdXaWRnZXRJZCA9IHJlc3VsdFsxXVxuXG4gICAgLy8gcmVnaXN0ZXIgZXh0ZW5zaW9uc1xuICAgIGF3YWl0IEFwcFdpZGdldE1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5yZWdpc3Rlck1hbmlmZXN0UHJvcHModXBkYXRlZEFwcENvbmZpZy53aWRnZXRzW25ld1dpZGdldElkXSlcblxuICAgIGlmIChpc0Jsb2NrKSB7XG4gICAgICAvLyB1cGRhdGUgdGhlIHdpZGdldCBsYWJlbCB1c2luZyBibG9ja1xuICAgICAgY29uc3QgYmxvY2tMYWJlbCA9IGkxOG4uZ2V0SW50bCgpLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2Jsb2NrJyB9KVxuICAgICAgY29uc3QgbmV3TGFiZWwgPSBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVMYWJlbCh1cGRhdGVkQXBwQ29uZmlnLCAnd2lkZ2V0JywgYmxvY2tMYWJlbClcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIG5ld1dpZGdldElkLCAnbGFiZWwnXSwgbmV3TGFiZWwpXG4gICAgfVxuXG4gICAgY29udGV4dFt3aWRnZXRJZF0gPSBuZXdXaWRnZXRJZFxuXG4gICAgLy8gVE9ETyBtb3ZlIHRoaXMgbG9naWMgYWZ0ZXIgY3JlYXRpbmcgcGFnZS9kaWFsb2cvaGVhZGVyL2Zvb3RlciBmcm9tIHRlbXBsYXRlXG4gICAgLy8gY3JlYXRlIG1hcCB3aWRnZXRzIHRoYXQgdGhpcyB3aWRnZXQgZGVwZW5kIG9uXG4gICAgaWYgKHRlbXBsYXRlV2lkZ2V0LnVzZU1hcFdpZGdldElkcz8ubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZW1wbGF0ZVdpZGdldC51c2VNYXBXaWRnZXRJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgLy8gY29udGVudE1hcHBpbmcgaXMgdXNlZCB0byBhdm9pZCBjcmVhdGluZyBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgYSB3aWRnZXRcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jcmVhdGVGcm9tVGVtcGxhdGUodXBkYXRlZEFwcENvbmZpZywgdGVtcGxhdGVKc29uLCB0ZW1wbGF0ZVdpZGdldC51c2VNYXBXaWRnZXRJZHNbaV0sIHNpemVNb2RlTGlzdCwgY29udGV4dCwgb3B0aW9ucylcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgICB1c2VNYXBXaWRnZXRJZHMucHVzaChyZXN1bHRbMV0pXG4gICAgICB9XG4gICAgfVxuICAgIGlmICh1c2VNYXBXaWRnZXRJZHMubGVuZ3RoID4gMCkge1xuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgbmV3V2lkZ2V0SWQsICd1c2VNYXBXaWRnZXRJZHMnXSwgdXNlTWFwV2lkZ2V0SWRzKVxuICAgIH1cblxuICAgIHVwZGF0ZWRBcHBDb25maWcgPSBhd2FpdCB0aGlzLnVwZGF0ZVdpZGdldEJ5VGVtcGxhdGUodXBkYXRlZEFwcENvbmZpZywgdGVtcGxhdGVKc29uLCBuZXdXaWRnZXRJZCwgd2lkZ2V0SWQsIHNpemVNb2RlTGlzdCwgY29udGV4dClcblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV3V2lkZ2V0SWRdXG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgd2lkZ2V0IGNvbmZpZ3MgYW5kIG90aGVyIHJlc291cmNlcyBmcm9tIHRlbXBsYXRlLlxuICAgKiBVc2VkIGluIGNhcmQsIGJvb2ttYXJrIHdoaWNoIGhhdmUgdGVtcGxhdGUgbGF5b3V0LlxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSB0ZW1wbGF0ZUpzb25cbiAgICogQHBhcmFtIHdpZGdldElkXG4gICAqIEBwYXJhbSB0ZW1wbGF0ZVdpZGdldElkXG4gICAqIEBwYXJhbSBjb250ZXh0XG4gICAqIEBwYXJhbSBzZXR0aW5nRGVmYXVsdE1lc3NhZ2VzXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBhc3luYyB1cGRhdGVXaWRnZXRCeVRlbXBsYXRlIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIHRlbXBsYXRlSnNvbjogVGVtcGxhdGUsXG4gICAgd2lkZ2V0SWQ6IHN0cmluZyxcbiAgICB0ZW1wbGF0ZVdpZGdldElkOiBzdHJpbmcsXG4gICAgc2l6ZU1vZGVMaXN0OiBCcm93c2VyU2l6ZU1vZGVbXSxcbiAgICBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0XG4gICk6IFByb21pc2U8SU1BcHBDb25maWc+IHtcbiAgICBjb25zdCBvbGRXaWRnZXRKc29uID0gYXBwQ29uZmlnPy53aWRnZXRzPy5bd2lkZ2V0SWRdXG4gICAgaWYgKCFvbGRXaWRnZXRKc29uKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIGF3YWl0IG1ha2VTdXJlVGVtcGxhdGVDb25maWcodGVtcGxhdGVKc29uKVxuXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIC8vIHJlbW92ZSBsYXlvdXRzIG9mIHRoZSBvbGQgd2lkZ2V0IGlmIGFueVxuICAgIG9sZFdpZGdldEpzb24ubGF5b3V0cyAmJiBPYmplY3Qua2V5cyhvbGRXaWRnZXRKc29uLmxheW91dHMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGNvbnN0IGRldmljZXMgPSBvbGRXaWRnZXRKc29uLmxheW91dHNba2V5XVxuICAgICAgT2JqZWN0LmtleXMoZGV2aWNlcykuZm9yRWFjaChkZXZpY2UgPT4ge1xuICAgICAgICBjb25zdCBsYXlvdXRJZCA9IGRldmljZXNbZGV2aWNlXVxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2UodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SWQpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBzZXJ2aWNlLnJlbW92ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRJZCwgZGV2aWNlIGFzIEJyb3dzZXJTaXplTW9kZSlcbiAgICAgIH0pXG4gICAgfSlcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZF0sIG9sZFdpZGdldEpzb24ud2l0aG91dCgnbGF5b3V0cycpKVxuXG4gICAgY29uc3QgdGVtcGxhdGVDb25maWcgPSB0ZW1wbGF0ZUpzb24/LmNvbmZpZ1xuICAgIGNvbnN0IHRlbXBsYXRlV2lkZ2V0ID0gdGVtcGxhdGVDb25maWc/LndpZGdldHM/Llt0ZW1wbGF0ZVdpZGdldElkXVxuICAgIGNvbnN0IG5ld0xheW91dElkcyA9IFtdXG4gICAgaWYgKHRlbXBsYXRlV2lkZ2V0KSB7IC8vIEl0J3Mgbm90IGEgZW1wdHkgdGVtcGxhdGVcbiAgICAgIGlmICh0ZW1wbGF0ZVdpZGdldC5jb25maWcpIHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgd2lkZ2V0SWQsICdjb25maWcnXSwgdGVtcGxhdGVXaWRnZXQuY29uZmlnKVxuICAgICAgfVxuICAgICAgaWYgKHRlbXBsYXRlV2lkZ2V0LnN0eWxlKSB7XG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIHdpZGdldElkLCAnc3R5bGUnXSwgdGVtcGxhdGVXaWRnZXQuc3R5bGUpXG4gICAgICB9XG5cbiAgICAgIGlmICh0ZW1wbGF0ZVdpZGdldC5sYXlvdXRzKSB7XG4gICAgICAgIGNvbnN0IGxheW91dHMgPSB0ZW1wbGF0ZVdpZGdldC5sYXlvdXRzXG4gICAgICAgIGNvbnN0IGxheW91dElkcyA9IFtdIC8vIHdpZGdldCBsYXlvdXRzIG5lZWQgdG8gYmUgYXNzaWduZWRcbiAgICAgICAgT2JqZWN0LmtleXMobGF5b3V0cykuZm9yRWFjaCgobGF5b3V0TmFtZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHNpemVNb2RlTGF5b3V0cyA9IGxheW91dHNbbGF5b3V0TmFtZV0gfHwge31cbiAgICAgICAgICBjb25zdCBsYXlvdXRJbk1hbmlmZXN0ID0gKG9sZFdpZGdldEpzb24ubWFuaWZlc3Q/LmxheW91dHMgPz8gW10pLmZpbmQoaXRlbSA9PiBpdGVtLm5hbWUgPT09IGxheW91dE5hbWUpXG4gICAgICAgICAgc2l6ZU1vZGVMaXN0LmZvckVhY2goc2l6ZU1vZGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbGF5b3V0SWQgPSBzaXplTW9kZUxheW91dHNbc2l6ZU1vZGVdID8/IHNpemVNb2RlTGF5b3V0c1thcHBDb25maWcubWFpblNpemVNb2RlXVxuICAgICAgICAgICAgaWYgKGxheW91dElkKSB7XG4gICAgICAgICAgICAgIGxheW91dElkcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBsYXlvdXROYW1lLFxuICAgICAgICAgICAgICAgIHNpemVNb2RlLFxuICAgICAgICAgICAgICAgIGxheW91dElkLFxuICAgICAgICAgICAgICAgIGxheW91dExhYmVsOiBsYXlvdXRJbk1hbmlmZXN0Py5sYWJlbFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXlvdXRJZHMubGVuZ3RoOyBpICs9IDEpIHsgLy8gYXdhaXRzIGluIGEgZm9yLWxvb3Agc2hvdWxkIGdldCBleGVjdXRlZCBpbiBzZXJpZXNcbiAgICAgICAgICBjb25zdCB7IGxheW91dE5hbWUsIHNpemVNb2RlLCBsYXlvdXRJZCwgbGF5b3V0TGFiZWwgfSA9IGxheW91dElkc1tpXVxuICAgICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh0ZW1wbGF0ZUNvbmZpZyBhcyBhbnksIGxheW91dElkKVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlTGF5b3V0RnJvbVRlbXBsYXRlKFxuICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyxcbiAgICAgICAgICAgIHRlbXBsYXRlSnNvbixcbiAgICAgICAgICAgIGxheW91dElkLFxuICAgICAgICAgICAgc2l6ZU1vZGUsXG4gICAgICAgICAgICBMYXlvdXRQYXJlbnRUeXBlLldpZGdldCxcbiAgICAgICAgICAgIG9sZFdpZGdldEpzb24uaWQsXG4gICAgICAgICAgICBjb250ZXh0XG4gICAgICAgICAgKVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgICBjb25zdCBuZXdMYXlvdXRJZCA9IHJlc3VsdFsxXVxuICAgICAgICAgIG5ld0xheW91dElkcy5wdXNoKG5ld0xheW91dElkKVxuXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAgIC5zZXRJbihcbiAgICAgICAgICAgICAgWyd3aWRnZXRzJywgb2xkV2lkZ2V0SnNvbi5pZCwgJ2xheW91dHMnLCBsYXlvdXROYW1lLCBzaXplTW9kZV0sXG4gICAgICAgICAgICAgIG5ld0xheW91dElkXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuc2V0SW4oXG4gICAgICAgICAgICAgIFsnbGF5b3V0cycsIG5ld0xheW91dElkLCAnbGFiZWwnXSxcbiAgICAgICAgICAgICAgb2xkV2lkZ2V0SnNvbj8ubWFuaWZlc3Q/LmkxOG5NZXNzYWdlc1tgX2xheW91dF8ke2xheW91dE5hbWV9X2xhYmVsYF0gfHwgbGF5b3V0TGFiZWwgfHwgbGF5b3V0TmFtZVxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgd2lkZ2V0SnNvbiBzaG91bGQgaGF2ZSBiZWVuIHByb2Nlc3NlZCBieSBBcHBXaWRnZXRNYW5hZ2VyLmdldEluc3RhbmNlKCkuaGFuZGxlTmV3V2lkZ2V0SnNvbih3aWRnZXRKc29uKVxuICAgKiBhbmQgaXQncyByZWFkeSB0byBiZSBhZGRlZCBpbnRvIGFwcENvbmZpZ1xuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSB3aWRnZXRKc29uXG4gICAqIEBwYXJhbSBzaXplTW9kZUxpc3RcbiAgICogQHBhcmFtIGNyZWF0ZUVtYmVkTGF5b3V0XG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBjcmVhdGVXaWRnZXQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgd2lkZ2V0SnNvbjogV2lkZ2V0SnNvbiB8IElNV2lkZ2V0SnNvbixcbiAgICBzaXplTW9kZUxpc3Q6IEJyb3dzZXJTaXplTW9kZVtdLFxuICAgIGNyZWF0ZUVtYmVkTGF5b3V0ID0gdHJ1ZVxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgd2lkZ2V0SWQ6IHN0cmluZ10ge1xuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgY29uc3Qgd2lkZ2V0SWQgPSBhcHBDb25maWdVdGlscy5nZXRVbmlxdWVJZChhcHBDb25maWcsICd3aWRnZXQnKVxuXG4gICAgY29uc29sZS5kZWJ1ZygnY3JlYXRlV2lkZ2V0Jywgd2lkZ2V0SnNvbilcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgLnNldEluKFsnd2lkZ2V0cycsIHdpZGdldElkXSwgd2lkZ2V0SnNvbilcbiAgICAgIC5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZCwgJ2lkJ10sIHdpZGdldElkKVxuXG4gICAgaWYgKGNyZWF0ZUVtYmVkTGF5b3V0ICYmIGhhc0VtYmVkZGVkTGF5b3V0SW5XaWRnZXQod2lkZ2V0SnNvbi5tYW5pZmVzdCkpIHtcbiAgICAgIGNvbnN0IGxheW91dHMgPSB3aWRnZXRKc29uLm1hbmlmZXN0LmxheW91dHMgfHwgW11cblxuICAgICAgbGF5b3V0cy5mb3JFYWNoKChsYXlvdXQpID0+IHtcbiAgICAgICAgc2l6ZU1vZGVMaXN0LmZvckVhY2goc2l6ZU1vZGUgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0SW5zdGFuY2UoKS5nZXRTZXJ2aWNlQnlUeXBlKGxheW91dC50eXBlKVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHNlcnZpY2UuY3JlYXRlQmxhbmtMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0LnR5cGUpXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHJlc3VsdFswXVxuICAgICAgICAgIGNvbnN0IGxheW91dElkID0gcmVzdWx0WzFdXG5cbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCdlbWJlZCBsYXlvdXQnLCBsYXlvdXQubmFtZSwgbGF5b3V0SWQsIGxheW91dC50eXBlLCAnY3JlYXRlZCBpbicsIHNpemVNb2RlKVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnXG4gICAgICAgICAgICAuc2V0SW4oXG4gICAgICAgICAgICAgIFsnbGF5b3V0cycsIGxheW91dElkLCAnbGFiZWwnXSxcbiAgICAgICAgICAgICAgd2lkZ2V0SnNvbi5tYW5pZmVzdC5pMThuTWVzc2FnZXNbYF9sYXlvdXRfJHtsYXlvdXQubmFtZX1fbGFiZWxgXSB8fCBsYXlvdXQubGFiZWxcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ3BhcmVudCddLCB7IGlkOiB3aWRnZXRJZCwgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5XaWRnZXQgfSlcbiAgICAgICAgICAgIC5zZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZCwgJ2xheW91dHMnLCBsYXlvdXQubmFtZSwgc2l6ZU1vZGVdLCBsYXlvdXRJZClcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIFt1cGRhdGVkQXBwQ29uZmlnLCB3aWRnZXRJZF1cbiAgfVxuXG4gIGR1cGxpY2F0ZUVtYmVkTGF5b3V0IChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIGZyb21TaXplTW9kZTogQnJvd3NlclNpemVNb2RlLFxuICAgIHRvU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZVxuICApOiBbYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgbmV3Q29udGVudElkOiBzdHJpbmddIHtcbiAgICBjb25zdCB3aWRnZXRKc29uID0gYXBwQ29uZmlnLndpZGdldHNbY29udGVudElkXVxuICAgIGlmICghd2lkZ2V0SnNvbiB8fCAhd2lkZ2V0SnNvbi5sYXlvdXRzKSB7XG4gICAgICByZXR1cm4gW2FwcENvbmZpZywgbnVsbF1cbiAgICB9XG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIGNvbnNvbGUuZGVidWcoJ2R1cGxpY2F0ZSBsYXlvdXQgb2Ygd2lkZ2V0JywgY29udGVudElkKVxuICAgIGlmICh3aWRnZXRKc29uLm1hbmlmZXN0Py53aWRnZXRUeXBlID09PSBXaWRnZXRUeXBlLkxheW91dCAmJiBmcm9tU2l6ZU1vZGUgIT09IHRvU2l6ZU1vZGUpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ2RldXBsaWNhdGUgbGF5b3V0IHdpZGdldCBhbmQgaXRzIGxheW91dCBmcm9tJywgZnJvbVNpemVNb2RlLCAndG8nLCB0b1NpemVNb2RlKVxuICAgICAgLy8gYSBsYXlvdXQgd2lkZ2V0IHNob3VsZCBkdXBsaWNhdGUgaXRzZWxmIGluc3RlYWQgb2YgZHVwbGljYXRlIGl0cyBsYXlvdXQgY29udGVudFxuICAgICAgY29uc3QgbmV3V2lkZ2V0SnNvbiA9IHdpZGdldEpzb24uc2V0KCdpZCcsIGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3dpZGdldCcpKS53aXRob3V0KCdsYXlvdXRzJykud2l0aG91dCgncGFyZW50JylcbiAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIG5ld1dpZGdldEpzb24uaWRdLCBuZXdXaWRnZXRKc29uKVxuXG4gICAgICBPYmplY3Qua2V5cyh3aWRnZXRKc29uLmxheW91dHMpLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgIGNvbnN0IGxheW91dHMgPSB3aWRnZXRKc29uLmxheW91dHNbbmFtZV1cbiAgICAgICAgaWYgKGxheW91dHNbZnJvbVNpemVNb2RlXSkge1xuICAgICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRzW2Zyb21TaXplTW9kZV0pXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0c1tmcm9tU2l6ZU1vZGVdLCBmcm9tU2l6ZU1vZGUsIHRvU2l6ZU1vZGUsIG51bGwsIGZhbHNlKVxuICAgICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgICBjb25zdCBuZXdMYXlvdXRJZCA9IHJlc3VsdFsxXVxuICAgICAgICAgIGlmIChuZXdMYXlvdXRJZCAhPSBudWxsKSB7XG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgICAgICAgICAuc2V0SW4oWydsYXlvdXRzJywgbmV3TGF5b3V0SWQsICdwYXJlbnQnXSwgeyB0eXBlOiBMYXlvdXRQYXJlbnRUeXBlLldpZGdldCwgaWQ6IG5ld1dpZGdldEpzb24uaWQgfSlcbiAgICAgICAgICAgICAgLnNldEluKFsnd2lkZ2V0cycsIG5ld1dpZGdldEpzb24uaWQsICdsYXlvdXRzJywgbmFtZSwgdG9TaXplTW9kZV0sIG5ld0xheW91dElkKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbmV3V2lkZ2V0SnNvbi5pZF1cbiAgICB9XG5cbiAgICBjb25zb2xlLmRlYnVnKCdkdXBsaWNhdGUgd2lkZ2V0IGxheW91dCBvbmx5IGZyb20nLCBmcm9tU2l6ZU1vZGUsICd0bycsIHRvU2l6ZU1vZGUpXG4gICAgLy8gYSBmdW5jdGlvbmFsIHdpZGdldCBsaWtlIGNhcmQgb3IgbGlzdCBzaG91bGQgb25seSBkdXBsaWNhdGUgYSBzaXplIG1vZGUgbGF5b3V0LiBUaGUgd2lkZ2V0IGl0c2VsZiByZW1haW5zIHRoZSBzYW1lLlxuICAgIE9iamVjdC5rZXlzKHdpZGdldEpzb24ubGF5b3V0cykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgIGNvbnN0IGxheW91dHMgPSB3aWRnZXRKc29uLmxheW91dHNbbmFtZV1cbiAgICAgIGlmIChsYXlvdXRzW2Zyb21TaXplTW9kZV0pIHtcbiAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHVwZGF0ZWRBcHBDb25maWcsIGxheW91dHNbZnJvbVNpemVNb2RlXSlcblxuICAgICAgICBpZiAobGF5b3V0c1t0b1NpemVNb2RlXSkgeyAvLyByZW1vdmUgdGhlIGV4aXN0aW5nIGxheW91dCBpbiB0YXJnZXQgc2l6ZSBtb2RlXG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHNlcnZpY2UucmVtb3ZlTGF5b3V0KHVwZGF0ZWRBcHBDb25maWcsIGxheW91dHNbdG9TaXplTW9kZV0sIHRvU2l6ZU1vZGUpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRzW2Zyb21TaXplTW9kZV0sIGZyb21TaXplTW9kZSwgdG9TaXplTW9kZSwgbnVsbCwgZmFsc2UpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgY29uc3QgbmV3TGF5b3V0SWQgPSByZXN1bHRbMV1cbiAgICAgICAgaWYgKG5ld0xheW91dElkICE9IG51bGwpIHtcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZ1xuICAgICAgICAgICAgLnNldEluKFsnbGF5b3V0cycsIG5ld0xheW91dElkLCAncGFyZW50J10sIHsgdHlwZTogTGF5b3V0UGFyZW50VHlwZS5XaWRnZXQsIGlkOiBjb250ZW50SWQgfSlcbiAgICAgICAgICAgIC5zZXRJbihbJ3dpZGdldHMnLCBjb250ZW50SWQsICdsYXlvdXRzJywgbmFtZSwgdG9TaXplTW9kZV0sIG5ld0xheW91dElkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBbdXBkYXRlZEFwcENvbmZpZywgbnVsbF1cbiAgfVxuXG4gIGR1cGxpY2F0ZSAoXG4gICAgYXBwQ29uZmlnOiBJTUFwcENvbmZpZyxcbiAgICBjb250ZW50SWQ6IHN0cmluZyxcbiAgICB0YXJnZXRCcm93c2VyU2l6ZTogQnJvd3NlclNpemVNb2RlLFxuICAgIGNvbnRleHQ6IER1cGxpY2F0ZUNvbnRleHRcbiAgKTogW2FwcENvbmZpZzogSU1BcHBDb25maWcsIG5ld0lkOiBzdHJpbmddIHtcbiAgICBjb25zb2xlLmRlYnVnKCdkdXBsaWNhdGUgYSB3aWRnZXQnLCBjb250ZW50SWQpXG4gICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZy53aWRnZXRzW2NvbnRlbnRJZF1cbiAgICBpZiAoIXdpZGdldEpzb24pIHtcbiAgICAgIHJldHVybiBbYXBwQ29uZmlnLCBudWxsXVxuICAgIH1cbiAgICBpZiAoY29udGV4dD8uW2NvbnRlbnRJZF0pIHtcbiAgICAgIC8vIGFscmVhZHkgZHVwbGljYXRkIGluIGEgc3RhY2sgb2YgZnVuY3Rpb24gaW52b2thdGlvbnMuXG4gICAgICAvLyBVc2UgY2FzZTogQSBDYXJkIHdpZGdldCBpcyBzaGFyZWQgaW4gYSBwYWdlJ3MgTGFyZ2UgYW5kIFNtYWxsIHNpemUgbW9kZSwgYW5kIHRoZSBwYWdlIGlzIGR1cGxpY2F0ZWQuXG4gICAgICAvLyAxLiBjYXJkIGlzIGR1cGxpY2F0ZWQgaW4gTGFyZ2Ugc2l6ZSBtb2RlLCBpdHMgZW1iZWQgbGF5b3V0cyBpcyBkdXBsaWNhdGVkIGluIExhcmdlIHNpemUgbW9kZSB0b28uXG4gICAgICAvLyAyLiB3aGVuIGR1cGxpY2F0ZSB0aGUgc21hbGwgc2l6ZSBtb2RlLCB0aGUgY2FyZCBkb2VzIG5vdCBuZWVkIHRvIGJlIGR1cGxpY2F0ZWQgYWdhaW4sIGJ1dCB0aGUgZW1iZWQgbGF5b3V0cyBuZWVkcyB0byBiZSBkdXBsaWNhdGVkLlxuXG4gICAgICAvLyBjaGVjayB0aGUgZHVwbGljYXRlZCB3aWRnZXQgaGFzIHRoZSB0YXJnZXQgYnJvd3NlciBzaXplIG1vZGUgbGF5b3V0XG4gICAgICBjb25zdCB3aWRnZXRKc29uID0gYXBwQ29uZmlnLndpZGdldHNbY29udGV4dFtjb250ZW50SWRdXVxuICAgICAgaWYgKCF3aWRnZXRKc29uLmxheW91dHMpIHtcbiAgICAgICAgcmV0dXJuIFthcHBDb25maWcsIGNvbnRleHRbY29udGVudElkXV1cbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpcnN0TmFtZSA9IE9iamVjdC5rZXlzKHdpZGdldEpzb24ubGF5b3V0cylbMF1cbiAgICAgIGNvbnN0IHNpemVtb2RlTGF5b3V0cyA9IHdpZGdldEpzb24ubGF5b3V0c1tmaXJzdE5hbWVdXG4gICAgICBpZiAoc2l6ZW1vZGVMYXlvdXRzW3RhcmdldEJyb3dzZXJTaXplXSkge1xuICAgICAgICByZXR1cm4gW2FwcENvbmZpZywgY29udGV4dFtjb250ZW50SWRdXVxuICAgICAgfVxuICAgICAgLy8gZHVwbGljYXRlIGVtYmVkIGxheW91dCBpbiB0YXJnZXQgYnJvd3NlciBzaXplIG1vZGUgZnJvbSBvcmlnaW5hbCB3aWRnZXQgdG8gZHVwbGljYXRlZCB3aWRnZXRcbiAgICAgIGNvbnN0IG9yaWdpbldpZGdldCA9IGFwcENvbmZpZy53aWRnZXRzW2NvbnRlbnRJZF1cbiAgICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgICBPYmplY3Qua2V5cyhvcmlnaW5XaWRnZXQubGF5b3V0cykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgY29uc3QgbGF5b3V0SWQgPSBvcmlnaW5XaWRnZXQubGF5b3V0c1tuYW1lXVt0YXJnZXRCcm93c2VyU2l6ZV1cbiAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHVwZGF0ZWRBcHBDb25maWcsIGxheW91dElkKVxuICAgICAgICBjb25zdCBkdXBSZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRJZCwgdGFyZ2V0QnJvd3NlclNpemUsIHRhcmdldEJyb3dzZXJTaXplLCBjb250ZXh0LCB0cnVlKVxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gZHVwUmVzdWx0WzBdXG4gICAgICAgIGNvbnN0IG5ld0xheW91dElkID0gZHVwUmVzdWx0WzFdXG4gICAgICAgIGlmIChuZXdMYXlvdXRJZCAhPSBudWxsKSB7XG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAgIC5zZXRJbihbJ3dpZGdldHMnLCBjb250ZXh0W2NvbnRlbnRJZF0sICdsYXlvdXRzJywgbmFtZSwgdGFyZ2V0QnJvd3NlclNpemVdLCBuZXdMYXlvdXRJZClcbiAgICAgICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBuZXdMYXlvdXRJZCwgJ3BhcmVudCddLCB7IHR5cGU6IExheW91dFBhcmVudFR5cGUuV2lkZ2V0LCBpZDogY29udGV4dFtjb250ZW50SWRdIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIGNvbnRleHRbY29udGVudElkXV1cbiAgICB9XG5cbiAgICBjb25zdCBuZXdXSnNvbiA9IHdpZGdldEpzb24uc2V0KCdpZCcsIGFwcENvbmZpZ1V0aWxzLmdldFVuaXF1ZUlkKGFwcENvbmZpZywgJ3dpZGdldCcpKVxuICAgICAgLnNldCgnbGFiZWwnLCBnZXREdXBsaWNhdGVMYWJlbChhcHBDb25maWcsICd3aWRnZXQnLCB3aWRnZXRKc29uLmxhYmVsKSlcblxuICAgIGNvbnN0IHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLmJlZm9yZUR1cGxpY2F0ZWQoYXBwQ29uZmlnLCBjb250ZW50SWQsIG5ld1dKc29uLCB0YXJnZXRCcm93c2VyU2l6ZSwgY29udGV4dClcblxuICAgIGlmIChjb250ZXh0KSB7XG4gICAgICBjb250ZXh0W2NvbnRlbnRJZF0gPSBuZXdXSnNvbi5pZFxuICAgIH1cbiAgICByZXR1cm4gW3VwZGF0ZWRBcHBDb25maWcsIG5ld1dKc29uLmlkXVxuICB9XG5cbiAgdHJ5UmVtb3ZlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgbGF5b3V0SW5mbzogTGF5b3V0SW5mbywgc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCB3aWRnZXRKc29uID0gYXBwQ29uZmlnLndpZGdldHM/Lltjb250ZW50SWRdXG4gICAgaWYgKCF3aWRnZXRKc29uKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuXG4gICAgLy8gMS4gY3VycmVudCBzaXplIG1vZGUgcGFzc2VkLCBjaGVjayBvdGhlciBzaXplIG1vZGVcbiAgICBjb25zdCBoYXNPdGhlck1vZGVzID0gW0Jyb3dzZXJTaXplTW9kZS5MYXJnZSwgQnJvd3NlclNpemVNb2RlLk1lZGl1bSwgQnJvd3NlclNpemVNb2RlLlNtYWxsXVxuICAgICAgLmZpbHRlcihtb2RlID0+IG1vZGUgIT09IHNpemVNb2RlKVxuICAgICAgLnNvbWUobW9kZSA9PiB3aWRnZXRKc29uLnBhcmVudD8uW21vZGVdPy5sZW5ndGggPiAwKVxuICAgIGNvbnN0IGlzTXVsdGlwbGVQYXJlbnRzID0gd2lkZ2V0SnNvbi5wYXJlbnQ/LltzaXplTW9kZV0/Lmxlbmd0aCA+IDFcblxuICAgIGlmICghaGFzT3RoZXJNb2RlcyAmJiAhaXNNdWx0aXBsZVBhcmVudHMpIHsgLy8gY2FuIGJlIHJlbW92ZWRcbiAgICAgIHJldHVybiB0aGlzLnJlbW92ZShhcHBDb25maWcsIGNvbnRlbnRJZClcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gMS4gcmVtb3ZlIHBhcmVudCBmb3IgdGhpcyBzaXplIG1vZGVcbiAgICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gdGhpcy5yZW1vdmVQYXJlbnQoYXBwQ29uZmlnLCBjb250ZW50SWQsIGxheW91dEluZm8sIHNpemVNb2RlKVxuICAgICAgLy8gMi4gcmVtb3ZlIGVtYmVkIGxheW91dCBvZiB0aGlzIHNpemUgbW9kZSBpZiBhbnlcbiAgICAgIGlmICh3aWRnZXRKc29uLmxheW91dHMpIHtcbiAgICAgICAgT2JqZWN0LmtleXMod2lkZ2V0SnNvbi5sYXlvdXRzKS5mb3JFYWNoKChuYW1lKSA9PiB7XG4gICAgICAgICAgY29uc3Qgc2l6ZU1vZGVMYXlvdXQgPSB3aWRnZXRKc29uLmxheW91dHNbbmFtZV1cbiAgICAgICAgICBpZiAoc2l6ZU1vZGVMYXlvdXRbc2l6ZU1vZGVdKSB7XG4gICAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgc2l6ZU1vZGVMYXlvdXQpXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZS5yZW1vdmVTaXplTW9kZUxheW91dHModXBkYXRlZEFwcENvbmZpZywgeyBbc2l6ZU1vZGVdOiBzaXplTW9kZUxheW91dFtzaXplTW9kZV0gfSBhcyBhbnkpXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCBjb250ZW50SWQsICdsYXlvdXRzJywgbmFtZV0sIHNpemVNb2RlTGF5b3V0LndpdGhvdXQoc2l6ZU1vZGUpKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIHJldHVybiB1cGRhdGVkQXBwQ29uZmlnXG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZyk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCB3aWRnZXRKc29uID0gYXBwQ29uZmlnLndpZGdldHM/Lltjb250ZW50SWRdXG4gICAgaWYgKCF3aWRnZXRKc29uKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuXG4gICAgY29uc29sZS5kZWJ1ZygncmVtb3ZlIGEgd2lkZ2V0JywgY29udGVudElkKVxuICAgIGNvbnN0IHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLmJlZm9yZVJlbW92ZWQoYXBwQ29uZmlnLCBjb250ZW50SWQpXG5cbiAgICAvLyByZW1vdmUgdGhlIHdpZGdldFxuICAgIHJldHVybiB1cGRhdGVkQXBwQ29uZmlnLnNldCgnd2lkZ2V0cycsIHVwZGF0ZWRBcHBDb25maWcud2lkZ2V0cy53aXRob3V0KGNvbnRlbnRJZCkpXG4gIH1cblxuICB0b1RvY05vZGUgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgcGFyZW50OiBMYXlvdXRJbmZvLFxuICAgIGJyb3dzZXJTaXplTW9kZTogQnJvd3NlclNpemVNb2RlXG4gICk6IFRvY05vZGUge1xuICAgIGNvbnN0IHsgbGF5b3V0SWQsIGxheW91dEl0ZW1JZCB9ID0gcGFyZW50XG4gICAgY29uc3QgcmVzdWx0OiBUb2NOb2RlID0ge1xuICAgICAgbGFiZWw6ICcnLFxuICAgICAgbGF5b3V0SWQsXG4gICAgICBsYXlvdXRJdGVtSWQsXG4gICAgICB0eXBlOiAnd2lkZ2V0JyxcbiAgICAgIGlkOiBjb250ZW50SWRcbiAgICB9XG4gICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZy53aWRnZXRzPy5bY29udGVudElkXVxuICAgIGlmICghd2lkZ2V0SnNvbikge1xuICAgICAgaWYgKGNvbnRlbnRJZCA9PSBudWxsKSB7XG4gICAgICAgIHJlc3VsdC5sYWJlbCA9IGkxOG4uZ2V0SW50bCgpLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ3BsYWNlaG9sZGVyJyB9KVxuICAgICAgICByZXN1bHQuaWNvbiA9IHBsYWNlSG9sZGVyT3V0bGluZWRcbiAgICAgICAgcmVzdWx0LmZsaXBJY29uID0gZmFsc2VcbiAgICAgICAgcmVzdWx0LmlzTGFiZWxSZWFkT25seSA9IHRydWVcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9XG4gICAgcmVzdWx0LmxhYmVsID0gd2lkZ2V0SnNvbi5sYWJlbFxuICAgIHJlc3VsdC5pY29uID0gd2lkZ2V0SnNvbi5pY29uXG4gICAgcmVzdWx0LmZsaXBJY29uID0gd2lkZ2V0SnNvbi5tYW5pZmVzdD8ucHJvcGVydGllcz8uZmxpcEljb24gPz8gZmFsc2VcblxuICAgIGlmICghd2lkZ2V0SnNvbj8ubGF5b3V0cykge1xuICAgICAgcmV0dXJuIHJlc3VsdFxuICAgIH1cblxuICAgIGNvbnN0IGNoaWxkcmVuID0gW11cbiAgICBjb25zdCBpc1NvbG8gPSBPYmplY3Qua2V5cyh3aWRnZXRKc29uLmxheW91dHMpLmxlbmd0aCA9PT0gMVxuICAgIE9iamVjdC5rZXlzKHdpZGdldEpzb24ubGF5b3V0cykuZm9yRWFjaCgobmFtZSkgPT4ge1xuICAgICAgY29uc3QgbGF5b3V0SWQgPSB3aWRnZXRKc29uLmxheW91dHNbbmFtZV1bYnJvd3NlclNpemVNb2RlXSA/PyB3aWRnZXRKc29uLmxheW91dHNbbmFtZV1bYXBwQ29uZmlnLm1haW5TaXplTW9kZV1cbiAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZShhcHBDb25maWcsIGxheW91dElkKVxuICAgICAgY29uc3QgZW1iZWRDaGlsZHJlbiA9IHNlcnZpY2UuZ2V0VG9jU3RydWN0dXJlKGFwcENvbmZpZywgbGF5b3V0SWQpXG4gICAgICBpZiAoZW1iZWRDaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IGxheW91dFR5cGUgPSBhcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF0udHlwZVxuICAgICAgICBjb25zdCBtYW5pZmVzdExheW91dCA9IHdpZGdldEpzb24ubWFuaWZlc3Q/LmxheW91dHM/LmZpbmQoaXRlbSA9PiBpdGVtLm5hbWUgPT09IG5hbWUpXG4gICAgICAgIGNoaWxkcmVuLnB1c2goe1xuICAgICAgICAgIGxhYmVsOiBpc1NvbG8gPyAnJyA6IChtYW5pZmVzdExheW91dCAhPSBudWxsID8gKHdpZGdldEpzb24ubWFuaWZlc3QuaTE4bk1lc3NhZ2VzW2BfbGF5b3V0XyR7bmFtZX1fbGFiZWxgXSA/PyBtYW5pZmVzdExheW91dC5sYWJlbCkgOiBuYW1lKSxcbiAgICAgICAgICBpY29uOiBnZXRMYXlvdXRJY29uKGxheW91dFR5cGUpLFxuICAgICAgICAgIHR5cGU6ICdsYXlvdXQnLFxuICAgICAgICAgIGlkOiBsYXlvdXRJZCxcbiAgICAgICAgICBpc0xhYmVsUmVhZE9ubHk6IHRydWUsXG4gICAgICAgICAgY2hpbGRyZW46IGVtYmVkQ2hpbGRyZW5cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICAgIGlmIChjaGlsZHJlbi5sZW5ndGggPT09IDEpIHtcbiAgICAgIHJlc3VsdC5jaGlsZHJlbiA9IGNoaWxkcmVuWzBdLmNoaWxkcmVuXG4gICAgfSBlbHNlIGlmIChjaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICByZXN1bHQuY2hpbGRyZW4gPSBjaGlsZHJlblxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIGFmdGVyTW92ZWQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGNvbnRlbnRJZDogc3RyaW5nLCBmcm9tTGF5b3V0OiBzdHJpbmcsIHRvTGF5b3V0OiBzdHJpbmcpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZy53aWRnZXRzW2NvbnRlbnRJZF1cbiAgICBpZiAoIXdpZGdldEpzb24pIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG4gICAgY29uc29sZS5kZWJ1ZygndXBkYXRlIHdpZGdldCcsIGNvbnRlbnRJZCwgJ2RzIGFmdGVyIG1vdmVkIHRvIGEgbmV3IGxheW91dCcsIHRvTGF5b3V0KVxuICAgIHJldHVybiB0aGlzLmRzU2VydmljZS51cGRhdGVBZnRlckNoYW5naW5nTGF5b3V0KGFwcENvbmZpZywgY29udGVudElkLCB0b0xheW91dClcbiAgfVxuXG4gIC8qKlxuICAgKiAxLiBhZGQgbmV3IHdpZGdldFxuICAgKiAyLiBhZGQgcGVuZGluZyBpdGVtIGJhY2sgdG8gdGhlIGxheW91dCwgbWF5IGJlIGZyb20gZGlmZmVyZW50IHNpemUgbW9kZVxuICAgKiBAcGFyYW0gYXBwQ29uZmlnXG4gICAqIEBwYXJhbSBjb250ZW50SWRcbiAgICogQHBhcmFtIHRvTGF5b3V0XG4gICAqIEBwYXJhbSBmcm9tU2l6ZU1vZGVcbiAgICogQHBhcmFtIHRvU2l6ZU1vZGVcbiAgICogQHJldHVybnNcbiAgICovXG4gIGFmdGVyQWRkZWQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgdG9MYXlvdXQ6IHN0cmluZyxcbiAgICBmcm9tU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSxcbiAgICB0b1NpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGVcbiAgKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHdpZGdldEpzb24gPSBhcHBDb25maWcud2lkZ2V0c1tjb250ZW50SWRdXG4gICAgaWYgKCF3aWRnZXRKc29uKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuXG4gICAgY29uc29sZS5kZWJ1ZygnYWZ0ZXIgYWRkZWQsIHVwZGF0ZSB3aWRnZXQnLCBjb250ZW50SWQsICdhZGRlZCB0byBhIG5ldyBsYXlvdXQnLCB0b0xheW91dCwgJ2Zyb20nLCBmcm9tU2l6ZU1vZGUsICd0bycsIHRvU2l6ZU1vZGUpXG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSB0aGlzLmRzU2VydmljZS51cGRhdGVBZnRlckNoYW5naW5nTGF5b3V0KGFwcENvbmZpZywgY29udGVudElkLCB0b0xheW91dClcblxuICAgIC8vIElmIHRoZSB3aWRnZXQgaGFzIGVtYmVkIGxheW91dCwgYW5kIHRoZSBsYXlvdXQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGN1cnJlbnQgc2l6ZU1vZGUsIHdlJ2xsIGNyZWF0ZSBhIG5ldyBvbmUgZm9yIHRoZW0uXG4gICAgT2JqZWN0LmtleXMod2lkZ2V0SnNvbi5sYXlvdXRzID8/IHt9KS5mb3JFYWNoKGxheW91dE5hbWUgPT4ge1xuICAgICAgY29uc3Qgc2l6ZU1vZGVMYXlvdXRzID0gd2lkZ2V0SnNvbi5sYXlvdXRzW2xheW91dE5hbWVdXG5cbiAgICAgIGlmIChzaXplTW9kZUxheW91dHNbZnJvbVNpemVNb2RlXSAmJiAhc2l6ZU1vZGVMYXlvdXRzW3RvU2l6ZU1vZGVdKSB7XG4gICAgICAgIGNvbnN0IGxheW91dEpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLmxheW91dHNbc2l6ZU1vZGVMYXlvdXRzW2Zyb21TaXplTW9kZV1dXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZSh1cGRhdGVkQXBwQ29uZmlnLCBzaXplTW9kZUxheW91dHNbZnJvbVNpemVNb2RlXSlcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VydmljZS5kdXBsaWNhdGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgbGF5b3V0SnNvbi5pZCwgZnJvbVNpemVNb2RlLCB0b1NpemVNb2RlLCBudWxsKVxuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gcmVzdWx0WzBdXG4gICAgICAgIGNvbnN0IGxheW91dElkID0gcmVzdWx0WzFdXG4gICAgICAgIGlmIChsYXlvdXRJZCAhPSBudWxsKSB7XG4gICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWdcbiAgICAgICAgICAgIC5zZXRJbihbJ2xheW91dHMnLCBsYXlvdXRJZCwgJ3BhcmVudCddLCB7IHR5cGU6IExheW91dFBhcmVudFR5cGUuV2lkZ2V0LCBpZDogY29udGVudElkIH0pXG4gICAgICAgICAgICAuc2V0SW4oWyd3aWRnZXRzJywgY29udGVudElkLCAnbGF5b3V0cycsIGxheW91dE5hbWUsIHRvU2l6ZU1vZGVdLCBsYXlvdXRJZClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHVwZGF0ZWRBcHBDb25maWdcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhciByZXNvdXJjZSByZWxhdGVkIHRvIHRoaXMgd2lkZ2V0XG4gICAqIEBwYXJhbSBhcHBDb25maWdcbiAgICogQHBhcmFtIGNvbnRlbnRJZFxuICAgKi9cbiAgYmVmb3JlUmVtb3ZlZCAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgY29udGVudElkOiBzdHJpbmcpOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZy53aWRnZXRzW2NvbnRlbnRJZF1cbiAgICBsZXQgdXBkYXRlZEFwcENvbmZpZyA9IGFwcENvbmZpZ1xuXG4gICAgY29uc29sZS5kZWJ1ZygnY2xlYXIgd2lkZ2V0IHJlc291cmNlIGJlZm9yZSByZW1vdmluZycsIGNvbnRlbnRJZClcbiAgICAvLyByZW1vdmUgYWxsIHBhcmVudCBsYXlvdXQgaW5mb3NcbiAgICBPYmplY3Qua2V5cyh3aWRnZXRKc29uLnBhcmVudCA/PyB7fSkuZm9yRWFjaCgoc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSkgPT4ge1xuICAgICAgaWYgKHdpZGdldEpzb24ucGFyZW50W3NpemVNb2RlXS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHdpZGdldEpzb24ucGFyZW50W3NpemVNb2RlXS5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgIGNvbnN0IGxheW91dEpzb24gPSB1cGRhdGVkQXBwQ29uZmlnLmxheW91dHNbaXRlbS5sYXlvdXRJZF1cbiAgICAgICAgICBpZiAobGF5b3V0SnNvbikge1xuICAgICAgICAgICAgY29uc3Qgc2VydmljZSA9IExheW91dFNlcnZpY2VQcm92aWRlci5nZXRTZXJ2aWNlKHVwZGF0ZWRBcHBDb25maWcsIGl0ZW0ubGF5b3V0SWQpXG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gc2VydmljZS5yZW1vdmVJdGVtKHVwZGF0ZWRBcHBDb25maWcsIGl0ZW0sIHNpemVNb2RlLCBmYWxzZSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIGRhdGEgc291cmNlXG4gICAgaWYgKHdpZGdldEpzb24ub3V0cHV0RGF0YVNvdXJjZXMpIHtcbiAgICAgIHdpZGdldEpzb24ub3V0cHV0RGF0YVNvdXJjZXMuZm9yRWFjaCgob2RzSWQpID0+IHtcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMuZHNTZXJ2aWNlLnJlbW92ZURhdGFTb3VyY2UodXBkYXRlZEFwcENvbmZpZywgb2RzSWQpXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIG1lc3NhZ2UvYWN0aW9uXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMubWVzc2FnZUFjdGlvblNlcnZpY2UucmVtb3ZlRnJvbVdpZGdldCh1cGRhdGVkQXBwQ29uZmlnLCBjb250ZW50SWQpXG5cbiAgICAvLyByZW1vdmUgZGF0YSBhY3Rpb24gb2YgdGhpcyB3aWRnZXQgaWYgYW55XG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMuZGF0YUFjdGlvblNlcnZpY2UucmVtb3ZlRnJvbVdpZGdldCh1cGRhdGVkQXBwQ29uZmlnLCBjb250ZW50SWQpXG5cbiAgICAvLyByZW12b2UgbGF5b3V0IGlmIGFueVxuICAgIGlmICh3aWRnZXRKc29uLmxheW91dHMpIHtcbiAgICAgIE9iamVjdC5rZXlzKHdpZGdldEpzb24ubGF5b3V0cykuZm9yRWFjaCgobmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBzaXplTW9kZUxheW91dCA9IHdpZGdldEpzb24ubGF5b3V0c1tuYW1lXVxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gTGF5b3V0U2VydmljZVByb3ZpZGVyLmdldFNlcnZpY2VGcm9tU2l6ZU1vZGVMYXlvdXQodXBkYXRlZEFwcENvbmZpZywgc2l6ZU1vZGVMYXlvdXQpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSBzZXJ2aWNlLnJlbW92ZVNpemVNb2RlTGF5b3V0cyh1cGRhdGVkQXBwQ29uZmlnLCBzaXplTW9kZUxheW91dClcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gVE9ETyBzaG91bGQgYmUgaGFuZGxlZCBiZWZvcmUgcmVtb3ZlIG9wZXJhdGlvbiBzdGFydHNcbiAgICAvLyByZW1vdmUgdXNlTWFwV2lkZ2V0SWRzIGlmIHRoZSByZW1vdmVkIHdpZGdldCBpcyBtYXBcbiAgICBpZiAod2lkZ2V0SnNvbi5tYW5pZmVzdD8ucHJvcGVydGllcz8uY2FuQ3JlYXRlTWFwVmlldykge1xuICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IHRoaXMudXNlTWFwU2VydmljZS5yZW1vdmUodXBkYXRlZEFwcENvbmZpZywgd2lkZ2V0SnNvbi5pZClcbiAgICB9XG5cbiAgICAvLyBEbyBvdGhlciBjbGVhbiBhY3Rpb25zIGJlZm9yZSByZW1vdmluZyB0aGUgd2lkZ2V0XG4gICAgY29uc3QgZXh0ID0gdGhpcy5maW5kQXBwQ29uZmlnT3BlcmF0aW9uRXh0ZW5zaW9uKGNvbnRlbnRJZClcbiAgICBpZiAoZXh0KSB7XG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gZXh0LndpZGdldFdpbGxSZW1vdmUodXBkYXRlZEFwcENvbmZpZylcbiAgICB9XG5cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgcHJpdmF0ZSBiZWZvcmVEdXBsaWNhdGVkIChcbiAgICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICAgIGNvbnRlbnRJZDogc3RyaW5nLFxuICAgIG5ld1dpZGdldEpzb246IElNV2lkZ2V0SnNvbixcbiAgICB0b1NpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsXG4gICAgY29udGV4dDogRHVwbGljYXRlQ29udGV4dFxuICApOiBJTUFwcENvbmZpZyB7XG4gICAgbGV0IHVwZGF0ZWRBcHBDb25maWcgPSBhcHBDb25maWdcblxuICAgIGNvbnNvbGUuZGVidWcoJ3Byb2Nlc3MgYmVmb3JlIGR1cGxpY2F0ZSB3aWRnZXQnLCBjb250ZW50SWQpXG4gICAgLy8gZHVwbGljYXRlIGxheW91dHMgaW4gdGhlIHdpZGdldFxuICAgIGlmIChoYXNFbWJlZGRlZExheW91dEluV2lkZ2V0KG5ld1dpZGdldEpzb24ubWFuaWZlc3QpKSB7XG4gICAgICAvLyBhZGQgaW50byBhcHBjb25maWcgZmlyc3QgZm9yIGdlbmVyYXRlIGEgZGlmZmVyZW50IHVuaXF1ZSBpZCBvZiBpdCdzIHN1YiB3aWRnZXRzXG4gICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCBuZXdXaWRnZXRKc29uLmlkXSwgbmV3V2lkZ2V0SnNvbilcblxuICAgICAgT2JqZWN0LmtleXMobmV3V2lkZ2V0SnNvbi5sYXlvdXRzID8/IHt9KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGNvbnN0IGxheW91dHMgPSBuZXdXaWRnZXRKc29uLmxheW91dHNba2V5XVxuICAgICAgICAvLyBzaG91bGQgaGF2ZSBkdXBsaWNhdGUgY29udGV4dCBpbiBkdXBsaWNhdGluZyBzaXplIG1vZGUgbGF5b3V0XG4gICAgICAgIGNvbnN0IGR1cGxpY2F0ZUNvbnRleHQgPSBjb250ZXh0ID8/IHt9XG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBMYXlvdXRTZXJ2aWNlUHJvdmlkZXIuZ2V0U2VydmljZUZyb21TaXplTW9kZUxheW91dCh1cGRhdGVkQXBwQ29uZmlnLCBsYXlvdXRzKVxuICAgICAgICBjb25zdCBkdXBsaWNhdGVSZXN1bHQgPSBzZXJ2aWNlLmR1cGxpY2F0ZVNpemVNb2RlTGF5b3V0cyhcbiAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnLFxuICAgICAgICAgIHsgW3RvU2l6ZU1vZGVdOiBsYXlvdXRzW3RvU2l6ZU1vZGVdID8/IGxheW91dHNbYXBwQ29uZmlnLm1haW5TaXplTW9kZV0gfSBhcyBhbnksIC8vIG9ubHkgZHVwbGljYXRlIHRoZSB0YXJnZXQgc2l6ZSBtb2RlXG4gICAgICAgICAgTGF5b3V0UGFyZW50VHlwZS5XaWRnZXQsXG4gICAgICAgICAgbmV3V2lkZ2V0SnNvbi5pZCxcbiAgICAgICAgICBkdXBsaWNhdGVDb250ZXh0XG4gICAgICAgIClcbiAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IGR1cGxpY2F0ZVJlc3VsdFswXVxuICAgICAgICBuZXdXaWRnZXRKc29uID0gbmV3V2lkZ2V0SnNvbi5zZXRJbihbJ2xheW91dHMnLCBrZXldLCBkdXBsaWNhdGVSZXN1bHRbMV0pXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIGR1cGxpY2F0ZSBtZXNzYWdlL2FjdGlvbnNcbiAgICB1cGRhdGVkQXBwQ29uZmlnID0gdGhpcy5tZXNzYWdlQWN0aW9uU2VydmljZS5kdXBsaWNhdGUodXBkYXRlZEFwcENvbmZpZywgY29udGVudElkLCBuZXdXaWRnZXRKc29uLmlkKVswXVxuXG4gICAgLy8gZHVwbGljYXRlIG91dHB1dCBkc1xuICAgIGlmIChuZXdXaWRnZXRKc29uLm91dHB1dERhdGFTb3VyY2VzPy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBuZXdEc0lkcyA9IG5ld1dpZGdldEpzb24ub3V0cHV0RGF0YVNvdXJjZXMubWFwKGRzSWQgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmRzU2VydmljZS5kdXBsaWNhdGVEYXRhU291cmNlKHVwZGF0ZWRBcHBDb25maWcsIGRzSWQpXG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSByZXN1bHRbMF1cbiAgICAgICAgY29uc3QgbmV3RHNKc29uID0gcmVzdWx0WzFdXG4gICAgICAgIHJldHVybiBuZXdEc0pzb24uaWRcbiAgICAgIH0pXG4gICAgICBuZXdXaWRnZXRKc29uID0gbmV3V2lkZ2V0SnNvbi5zZXQoJ291dHB1dERhdGFTb3VyY2VzJywgbmV3RHNJZHMpXG4gICAgICAvLyB1cGRhdGUgZGF0YXNvdXJjZSBpZCB1c2VkIGluIHRoZSB3aWRnZXQgY29uZmlnXG4gICAgICAvLyBUT0RPIGltcHJvdmUgdGhpcyBsb2dpYywgbW92ZSBpbnRvIHdpZGdldCB0aGF0IGhhcyBsaWZlY3ljbGUgb3BlcmF0aW9uc1xuICAgICAgbGV0IHN0cldDb25maWcgPSBKU09OLnN0cmluZ2lmeShuZXdXaWRnZXRKc29uLmNvbmZpZylcbiAgICAgIG5ld0RzSWRzLmZvckVhY2goKGlkLCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBvbGRJZCA9IG5ld1dpZGdldEpzb24ub3V0cHV0RGF0YVNvdXJjZXNbaW5kZXhdXG4gICAgICAgIGNvbnN0IHJlID0gbmV3IFJlZ0V4cChvbGRJZCwgJ2cnKVxuICAgICAgICBzdHJXQ29uZmlnID0gc3RyV0NvbmZpZy5yZXBsYWNlKHJlLCBpZClcbiAgICAgIH0pXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBuZXdXQ29uZmlnID0gSlNPTi5wYXJzZShzdHJXQ29uZmlnKVxuICAgICAgICBuZXdXaWRnZXRKc29uID0gbmV3V2lkZ2V0SnNvbi5zZXQoJ2NvbmZpZycsIG5ld1dDb25maWcpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04gZm9ybWF0IGVycm9yJywgbmV3V2lkZ2V0SnNvbilcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUT0RPIHNob3VsZCBiZSBoYW5kbGVkIGFmdGVyIGR1cGxpY2F0aW9uIG9wZXJhdGlvbiBmaW5pc2hlZFxuICAgIC8vIGhhbmRsZSB1c2VNYXBXaWRnZXRJZHNcbiAgICBpZiAobmV3V2lkZ2V0SnNvbi51c2VNYXBXaWRnZXRJZHM/Lmxlbmd0aCA+IDApIHtcbiAgICAgIG5ld1dpZGdldEpzb24udXNlTWFwV2lkZ2V0SWRzLmZvckVhY2goKG1hcFdpZGdldElkLCBpKSA9PiB7XG4gICAgICAgIGlmIChjb250ZXh0Py5bbWFwV2lkZ2V0SWRdKSB7XG4gICAgICAgICAgbmV3V2lkZ2V0SnNvbiA9IG5ld1dpZGdldEpzb24uc2V0SW4oWyd1c2VNYXBXaWRnZXRJZHMnLCBpXSwgY29udGV4dFttYXBXaWRnZXRJZF0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgdXBkYXRlZEFwcENvbmZpZyA9IHVwZGF0ZWRBcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgbmV3V2lkZ2V0SnNvbi5pZF0sIG5ld1dpZGdldEpzb24pXG5cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGUgYWZ0ZXJXaWRnZXRDb3BpZWQgd2hlbiBhIHNpemUgbW9kZSBsYXlvdXRzIGlzIGR1cGxpY2F0ZS5cbiAgICogQHBhcmFtIGRlc3RBcHBDb25maWdcbiAgICogQHBhcmFtIGNvbnRleHRcbiAgICovXG4gIGFmdGVyQmF0Y2hDb3BpZWQgKGRlc3RBcHBDb25maWc6IElNQXBwQ29uZmlnLCBzb3VyY2VBcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZXh0OiBEdXBsaWNhdGVDb250ZXh0KTogSU1BcHBDb25maWcge1xuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gZGVzdEFwcENvbmZpZ1xuICAgIE9iamVjdC5rZXlzKGNvbnRleHQgPz8ge30pLmZvckVhY2goY29udGVudElkID0+IHtcbiAgICAgIGNvbnN0IGRlc3RXaWRnZXRJZCA9IGNvbnRleHRbY29udGVudElkXVxuICAgICAgaWYgKHNvdXJjZUFwcENvbmZpZy53aWRnZXRzW2NvbnRlbnRJZF0gJiYgdXBkYXRlZEFwcENvbmZpZy53aWRnZXRzW2Rlc3RXaWRnZXRJZF0pIHsgLy8gdGhlIGNvbnRlbnQgaXMgYSB3aWRnZXRcbiAgICAgICAgbGV0IGV4dDogZXh0ZW5zaW9uU3BlYy5BcHBDb25maWdPcGVyYXRpb25zRXh0ZW5zaW9uXG4gICAgICAgIGlmIChkZXN0QXBwQ29uZmlnID09PSBzb3VyY2VBcHBDb25maWcpIHtcbiAgICAgICAgICAvLyBvcGVyYXRpb24gaW4gdGhlIHNhbWUgZW52aXJvbm1lbnQsIGV4dGVuc2lvbiBzaG91bGQgaGF2ZSBiZWVuIHJlZ2lzdGVyZWQgYnkgdGhlIGNvbnRlbnRJZFxuICAgICAgICAgIGV4dCA9IHRoaXMuZmluZEFwcENvbmZpZ09wZXJhdGlvbkV4dGVuc2lvbihjb250ZW50SWQpXG4gICAgICAgICAgaWYgKGV4dCkge1xuICAgICAgICAgICAgdXBkYXRlZEFwcENvbmZpZyA9IGV4dC5hZnRlcldpZGdldENvcGllZChjb250ZW50SWQsIHNvdXJjZUFwcENvbmZpZywgZGVzdFdpZGdldElkLCB1cGRhdGVkQXBwQ29uZmlnLCBjb250ZXh0KVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBleHQgPSB0aGlzLmZpbmRBcHBDb25maWdPcGVyYXRpb25FeHRlbnNpb24oZGVzdFdpZGdldElkKSAvLyB0aGUgY29waWVkIHdpZGdldCBpcyByZWdpc3RlcmVkIGluIHRoZSBleHRlbnNpb25cbiAgICAgICAgICBpZiAoZXh0KSB7XG4gICAgICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gZXh0LmFmdGVyV2lkZ2V0Q29waWVkKGNvbnRlbnRJZCwgc291cmNlQXBwQ29uZmlnLCBkZXN0V2lkZ2V0SWQsIHVwZGF0ZWRBcHBDb25maWcsIGNvbnRleHQpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgYWRkUGFyZW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBjb250ZW50SWQ6IHN0cmluZywgbGF5b3V0SW5mbzogTGF5b3V0SW5mbywgc2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IElNQXBwQ29uZmlnIHtcbiAgICBjb25zdCB3aWRnZXRKc29uID0gYXBwQ29uZmlnLndpZGdldHNbY29udGVudElkXVxuICAgIGlmICghd2lkZ2V0SnNvbikge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cbiAgICBjb25zb2xlLmRlYnVnKCdhZGQgcGFyZW50JywgbGF5b3V0SW5mby5sYXlvdXRJZCwgbGF5b3V0SW5mby5sYXlvdXRJdGVtSWQsICd0byB3aWRnZXQnLCBjb250ZW50SWQsICdpbicsIHNpemVNb2RlKVxuXG4gICAgY29uc3QgbGlzdCA9IHRoaXMuYWRkUGFyZW50VG9MaXN0KGFwcENvbmZpZywgd2lkZ2V0SnNvbi5wYXJlbnQ/LltzaXplTW9kZV0sIGxheW91dEluZm8pXG4gICAgcmV0dXJuIGFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCBjb250ZW50SWQsICdwYXJlbnQnLCBzaXplTW9kZV0sIGxpc3QpXG4gIH1cblxuICByZW1vdmVQYXJlbnQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgbGF5b3V0SW5mbzogTGF5b3V0SW5mbyxcbiAgICBzaXplTW9kZT86IEJyb3dzZXJTaXplTW9kZVxuICApOiBJTUFwcENvbmZpZyB7XG4gICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZy53aWRnZXRzW2NvbnRlbnRJZF1cbiAgICBpZiAoIXdpZGdldEpzb24gfHwgd2lkZ2V0SnNvbi5wYXJlbnQgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGFwcENvbmZpZ1xuICAgIH1cblxuICAgIGNvbnNvbGUuZGVidWcoJ3JlbW92ZSBwYXJlbnQnLCBsYXlvdXRJbmZvLmxheW91dElkLCBsYXlvdXRJbmZvLmxheW91dEl0ZW1JZCwgJ2Zyb20gd2lkZ2V0JywgY29udGVudElkLCAnaW4nLCBzaXplTW9kZSlcblxuICAgIGlmIChzaXplTW9kZSkge1xuICAgICAgY29uc3QgcGFyZW50cyA9IHdpZGdldEpzb24ucGFyZW50W3NpemVNb2RlXVxuICAgICAgY29uc3QgbmV3UGFyZW50cyA9IHRoaXMucmVtb3ZlUGFyZW50RnJvbUxpc3QocGFyZW50cywgbGF5b3V0SW5mbylcbiAgICAgIGlmIChuZXdQYXJlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gYXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIGNvbnRlbnRJZCwgJ3BhcmVudCddLCB3aWRnZXRKc29uLnBhcmVudC53aXRob3V0KHNpemVNb2RlKSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgY29udGVudElkLCAncGFyZW50Jywgc2l6ZU1vZGVdLCBuZXdQYXJlbnRzKVxuICAgIH1cblxuICAgIGxldCB1cGRhdGVkQXBwQ29uZmlnID0gYXBwQ29uZmlnXG4gICAgT2JqZWN0LmtleXMod2lkZ2V0SnNvbi5wYXJlbnQpLmZvckVhY2goKHMpID0+IHtcbiAgICAgIGNvbnN0IHBhcmVudHMgPSB3aWRnZXRKc29uLnBhcmVudFtzXVxuICAgICAgY29uc3QgbmV3UGFyZW50cyA9IHRoaXMucmVtb3ZlUGFyZW50RnJvbUxpc3QocGFyZW50cywgbGF5b3V0SW5mbylcbiAgICAgIGlmIChuZXdQYXJlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB1cGRhdGVkQXBwQ29uZmlnID0gdXBkYXRlZEFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCBjb250ZW50SWQsICdwYXJlbnQnXSwgd2lkZ2V0SnNvbi5wYXJlbnQud2l0aG91dChzKSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVwZGF0ZWRBcHBDb25maWcgPSB1cGRhdGVkQXBwQ29uZmlnLnNldEluKFsnd2lkZ2V0cycsIGNvbnRlbnRJZCwgJ3BhcmVudCcsIHNdLCBuZXdQYXJlbnRzKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gdXBkYXRlZEFwcENvbmZpZ1xuICB9XG5cbiAgY2xlYXJQYXJlbnQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGNvbnRlbnRJZDogc3RyaW5nKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHdpZGdldEpzb24gPSBhcHBDb25maWcud2lkZ2V0c1tjb250ZW50SWRdXG4gICAgaWYgKCF3aWRnZXRKc29uIHx8IHdpZGdldEpzb24ucGFyZW50ID09IG51bGwpIHtcbiAgICAgIHJldHVybiBhcHBDb25maWdcbiAgICB9XG4gICAgcmV0dXJuIGFwcENvbmZpZy5zZXRJbihbJ3dpZGdldHMnLCBjb250ZW50SWRdLCB3aWRnZXRKc29uLndpdGhvdXQoJ3BhcmVudCcpKVxuICB9XG5cbiAgcmVtb3ZlU2l6ZU1vZGVQYXJlbnQgKFxuICAgIGFwcENvbmZpZzogSU1BcHBDb25maWcsXG4gICAgY29udGVudElkOiBzdHJpbmcsXG4gICAgYnJvd3NlclNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGVcbiAgKTogSU1BcHBDb25maWcge1xuICAgIGNvbnN0IHdpZGdldEpzb24gPSBhcHBDb25maWcud2lkZ2V0c1tjb250ZW50SWRdXG4gICAgaWYgKCF3aWRnZXRKc29uIHx8IHdpZGdldEpzb24ucGFyZW50Py5bYnJvd3NlclNpemVNb2RlXSA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gYXBwQ29uZmlnXG4gICAgfVxuICAgIHJldHVybiBhcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgY29udGVudElkLCAncGFyZW50J10sIHdpZGdldEpzb24ucGFyZW50LndpdGhvdXQoYnJvd3NlclNpemVNb2RlKSlcbiAgfVxuXG4gIGZpbmRQYXJlbnQgKGFwcENvbmZpZzogSU1BcHBDb25maWcsIGNvbnRlbnRJZDogc3RyaW5nLCBicm93c2VyU2l6ZU1vZGU6IEJyb3dzZXJTaXplTW9kZSk6IExheW91dEluZm8ge1xuICAgIGNvbnN0IHdpZGdldEpzb24gPSBhcHBDb25maWcud2lkZ2V0c1tjb250ZW50SWRdXG4gICAgaWYgKCF3aWRnZXRKc29uIHx8ICF3aWRnZXRKc29uLnBhcmVudCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICAvLyBicm93c2VyU2l6ZU1vZGUgbWF5IGJlIG5vdCBhIGN1c3RvbSBsYXlvdXQsIGl0IGlzIHRyYW5zZm9ybWVkIGZyb20gbWFpblNpemVNb2RlXG4gICAgY29uc3Qgd2lkZ2V0UGFyZW50ID0gd2lkZ2V0SnNvbi5wYXJlbnRbYnJvd3NlclNpemVNb2RlXSA/PyB3aWRnZXRKc29uLnBhcmVudFthcHBDb25maWcubWFpblNpemVNb2RlXVxuICAgIGlmICghd2lkZ2V0UGFyZW50KSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGlmICh3aWRnZXRQYXJlbnQubGVuZ3RoID09PSAxKSB7XG4gICAgICByZXR1cm4gd2lkZ2V0UGFyZW50WzBdXG4gICAgfVxuICAgIC8vIG11bHRpcGxlIHBhcmVudCwgZ28gdG8gdGhlIHRoZWlyIGNvbW1vbiBwYXJlbnQuXG4gICAgY29uc3QgbGF5b3V0SWQgPSB3aWRnZXRQYXJlbnRbMF0ubGF5b3V0SWRcbiAgICBjb25zdCBsYXlvdXQgPSBhcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cblxuICAgIC8vIHRoZSBwYXJlbnQgb2YgdGhlIGxheW91dCBtdXN0IGJlIGEgd2lkZ2V0LCBpLmUuIExpc3Qgb3IgQ2FyZFxuICAgIHJldHVybiB0aGlzLmZpbmRQYXJlbnQoYXBwQ29uZmlnLCBsYXlvdXQucGFyZW50Py5pZCwgYnJvd3NlclNpemVNb2RlKVxuICB9XG5cbiAgcHJpdmF0ZSBmaW5kQXBwQ29uZmlnT3BlcmF0aW9uRXh0ZW5zaW9uICh3aWRnZXRJZDogc3RyaW5nKTogZXh0ZW5zaW9uU3BlYy5BcHBDb25maWdPcGVyYXRpb25zRXh0ZW5zaW9uIHtcbiAgICAvLyBzaG91bGQgdXNlIHRoZSBleHRlbnNpb25NYW5hZ2VyIG9mIHRoZSBhcHBcbiAgICBsZXQgZXh0ZW5zaW9uTWFuYWdlclxuICAgIGlmICh3aW5kb3cuamltdUNvbmZpZy5pc0J1aWxkZXIpIHtcbiAgICAgIGV4dGVuc2lvbk1hbmFnZXIgPSB3aW5kb3cuX2FwcFdpbmRvdy5fZXh0ZW5zaW9uTWFuYWdlclxuICAgIH0gZWxzZSB7XG4gICAgICBleHRlbnNpb25NYW5hZ2VyID0gd2luZG93Ll9leHRlbnNpb25NYW5hZ2VyXG4gICAgfVxuICAgIGNvbnN0IGV4dHMgPSBleHRlbnNpb25NYW5hZ2VyPy5nZXRFeHRlbnNpb25zKGAke2V4dGVuc2lvblNwZWMuRXh0ZW5zaW9uUG9pbnRzLkFwcENvbmZpZ09wZXJhdGlvbnN9YClcblxuICAgIHJldHVybiBleHRzPy5maW5kKChpdGVtKSA9PiBpdGVtLndpZGdldElkID09PSB3aWRnZXRJZCkgYXMgZXh0ZW5zaW9uU3BlYy5BcHBDb25maWdPcGVyYXRpb25zRXh0ZW5zaW9uXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IFdpZGdldFNlcnZpY2UoKVxuIiwiaW1wb3J0IHsgbW9kdWxlTG9hZGVyLCB0eXBlIERhdGFBY3Rpb25TZXR0aW5nUHJvcHMsIFJlYWN0LCBpbmplY3RJbnRsLCBnZXRBcHBTdG9yZSwgSW50bFByb3ZpZGVyLCBpMThuIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgZ2V0QXBwQ29uZmlnQWN0aW9uIH0gZnJvbSAnLi9hcHAtY29uZmlnLWFjdGlvbnMnXG5pbXBvcnQgV2lkZ2V0U2V0dGluZ01hbmFnZXIgZnJvbSAnLi93aWRnZXQtc2V0dGluZy1tYW5hZ2VyJ1xuXG5jb25zdCB7IGdldFRyYW5zbGF0ZWRMb2NhbGU6IGdldFN1cHBvcnRlZExvY2FsZSB9ID0gaTE4blxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcHBEYXRhQWN0aW9uTWFuYWdlciB7XG4gIHN0YXRpYyBpbnN0YW5jZTogQXBwRGF0YUFjdGlvbk1hbmFnZXJcbiAgc3RhdGljIGdldEluc3RhbmNlICgpIHtcbiAgICBpZiAoIUFwcERhdGFBY3Rpb25NYW5hZ2VyLmluc3RhbmNlKSB7XG4gICAgICBBcHBEYXRhQWN0aW9uTWFuYWdlci5pbnN0YW5jZSA9IG5ldyBBcHBEYXRhQWN0aW9uTWFuYWdlcigpXG4gICAgfVxuICAgIHJldHVybiBBcHBEYXRhQWN0aW9uTWFuYWdlci5pbnN0YW5jZVxuICB9XG5cbiAgcHJpdmF0ZSBhY3Rpb25TZXR0aW5nczoge1xuICAgIFt1cmk6IHN0cmluZ106IFByb21pc2U8XG4gICAgUmVhY3QuQ29tcG9uZW50Q2xhc3M8RGF0YUFjdGlvblNldHRpbmdQcm9wczx1bmtub3duPj5cbiAgICA+XG4gIH0gPSB7fVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhpcy5hY3Rpb25TZXR0aW5ncyBpZiB0aGVyZSBpcyBuZXcgd2lkZ2V0IHdpdGggZGF0YSBhY3Rpb24gaXMgYWRkZWQuXG4gICAqL1xuICBsb2FkQWxsQWN0aW9uU2V0dGluZ0NsYXNzZXMgKCk6IHtcbiAgICBbdXJpOiBzdHJpbmddOiBQcm9taXNlPFxuICAgIFJlYWN0LkNvbXBvbmVudENsYXNzPERhdGFBY3Rpb25TZXR0aW5nUHJvcHM8dW5rbm93bj4+XG4gICAgPlxuICB9IHtcbiAgICBjb25zdCBhcHBDb25maWdBY3Rpb24gPSBnZXRBcHBDb25maWdBY3Rpb24oKVxuICAgIE9iamVjdC5rZXlzKGFwcENvbmZpZ0FjdGlvbi5hcHBDb25maWc/LndpZGdldHMgfHwge30pLmZvckVhY2god2lkZ2V0SWQgPT4ge1xuICAgICAgY29uc3Qgd2lkZ2V0ID0gYXBwQ29uZmlnQWN0aW9uLmFwcENvbmZpZy53aWRnZXRzW3dpZGdldElkXVxuICAgICAgY29uc3QgYWN0aW9uSnNvbnMgPSBbXS5jb25jYXQod2lkZ2V0Lm1hbmlmZXN0Py5kYXRhQWN0aW9ucykuZmlsdGVyKGFjdGlvbiA9PiBhY3Rpb24pXG4gICAgICBpZiAoYWN0aW9uSnNvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBhY3Rpb25Kc29ucy5mb3JFYWNoKGFjdGlvbiA9PiB7XG4gICAgICAgICAgaWYgKGFjdGlvbi5zZXR0aW5nVXJpKSB7XG4gICAgICAgICAgICBjb25zdCB1cmkgPSBgJHt3aWRnZXQudXJpfWRpc3QvJHthY3Rpb24uc2V0dGluZ1VyaX1gXG4gICAgICAgICAgICBpZiAoIXRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXSkge1xuICAgICAgICAgICAgICB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0gPSBtb2R1bGVMb2FkZXJcbiAgICAgICAgICAgICAgICAubG9hZE1vZHVsZSh1cmksIFsnZGVmYXVsdCddKVxuICAgICAgICAgICAgICAgIC50aGVuKEFjdGlvbkNsYXNzID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHJhd0NsYXp6ID0gQWN0aW9uQ2xhc3MuZGVmYXVsdFxuICAgICAgICAgICAgICAgICAgcmV0dXJuIFdpZGdldFNldHRpbmdNYW5hZ2VyLmdldEluc3RhbmNlKCkubG9hZEkxOG5NZXNzYWdlc0ZvclNldHRpbmcod2lkZ2V0LnVyaSkudGhlbihpMThuTWVzc2FnZXMgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbmplY3RBY3Rpb25TZXR0aW5nUHJvcHMocmF3Q2xhenosIGkxOG5NZXNzYWdlcywgd2lkZ2V0LmlkKVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiB0aGlzLmFjdGlvblNldHRpbmdzXG4gIH1cblxuICBwcml2YXRlIGluamVjdEFjdGlvblNldHRpbmdQcm9wcyAoV3JhcHBlZENvbXBvbmVudCwgaTE4bk1lc3NhZ2VzLCBhY3Rpb25XaWRnZXRJZDogc3RyaW5nKTogUmVhY3QuQ29tcG9uZW50Q2xhc3M8RGF0YUFjdGlvblNldHRpbmdQcm9wczx1bmtub3duPj4ge1xuICAgIGNvbnN0IEludGxJbmplY3RlZENvbXBvbmVudCA9IGluamVjdEludGwoV3JhcHBlZENvbXBvbmVudClcbiAgICBjb25zdCBhY3Rpb25XaWRnZXRKc29uID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyLmFwcENvbmZpZy53aWRnZXRzW2FjdGlvbldpZGdldElkXVxuICAgIGxldCB3aWRnZXROYW1lID0gbnVsbFxuXG4gICAgaWYgKGFjdGlvbldpZGdldElkICYmIGFjdGlvbldpZGdldEpzb24pIHtcbiAgICAgIHdpZGdldE5hbWUgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXIuYXBwQ29uZmlnLndpZGdldHNbYWN0aW9uV2lkZ2V0SWRdLm1hbmlmZXN0Lm5hbWVcbiAgICB9IGVsc2Uge1xuICAgICAgd2lkZ2V0TmFtZSA9ICdGcmFtZXdvcmsnXG4gICAgfVxuXG4gICAgY2xhc3MgV2lkZ2V0V3JhcHBlciBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8RGF0YUFjdGlvblNldHRpbmdQcm9wczx1bmtub3duPj4ge1xuICAgICAgc3RhdGljIGRpc3BsYXlOYW1lID0gYEFjdGlvblNldHRpbmdXcmFwcGVyKCR7d2lkZ2V0TmFtZX0pYFxuXG4gICAgICByZW5kZXIgKCkge1xuICAgICAgICBjb25zdCBpbmplY3RQcm9wczogYW55ID0ge1xuICAgICAgICAgIG1lc3NhZ2VzOiBpMThuTWVzc2FnZXNcbiAgICAgICAgfVxuICAgICAgICAvLyBtZXJnZSBpbiB0aGUgYXBwJ3MgbWVzc2FnZXMgYmVmb3JlIGNyZWF0aW5nIHRoZSBjb250ZXh0IHNvIHRoYXRcbiAgICAgICAgLy8gYW55IGppbXUtdWkgY29tcG9uZW50cyBpbiB0aGlzIGNvbXBvbmVudCBjYW4gaGF2ZSBhY2Nlc3MgdG8gdGhlaXIgb3duIG1lc3NhZ2VzXG4gICAgICAgIC8vIE5PVEU6IG1lc3NhZ2VzIHdpdGggdGhlIHNhbWUga2V5IHdpbGwgYmUgb3ZlcnJpZGRlbiwgc28gcGxlYXNlIG1ha2Ugc3VyZSB3aWRnZXQgZG8gbm90IHVzZSB0aGUgc2FtZSBrZXkgd2l0aCBqaW11LlxuICAgICAgICBjb25zdCBhcHBJMThuTWVzc2FnZXMgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwSTE4bk1lc3NhZ2VzXG5cbiAgICAgICAgbGV0IGxvY2FsZSA9IG51bGxcbiAgICAgICAgaWYgKGFjdGlvbldpZGdldElkICYmIGFjdGlvbldpZGdldEpzb24pIHtcbiAgICAgICAgICBsb2NhbGUgPSBnZXRTdXBwb3J0ZWRMb2NhbGUoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbnRleHQubG9jYWxlLCBhY3Rpb25XaWRnZXRKc29uLm1hbmlmZXN0LnRyYW5zbGF0ZWRMb2NhbGVzLmFzTXV0YWJsZSgpKVxuICAgICAgICAgIGlmICghbG9jYWxlKSB7XG4gICAgICAgICAgICAvLyB3aWRnZXQgZG9lcyBub3Qgc3VwcG9ydCB1c2VyJ3MgbG9jYWxlLCB1c2UgdGhlIGRlZmF1bHQgbG9jYWxlXG4gICAgICAgICAgICBsb2NhbGUgPSBhY3Rpb25XaWRnZXRKc29uLm1hbmlmZXN0LnRyYW5zbGF0ZWRMb2NhbGVzICYmIGFjdGlvbldpZGdldEpzb24ubWFuaWZlc3QudHJhbnNsYXRlZExvY2FsZXNbMF1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFsb2NhbGUpIHtcbiAgICAgICAgICAgIGxvY2FsZSA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBDb250ZXh0LmxvY2FsZVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2NhbGUgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwQ29udGV4dC5sb2NhbGVcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFsbE1lc3NhZ2VzID0gT2JqZWN0LmFzc2lnbih7fSwgaTE4bk1lc3NhZ2VzLCBhcHBJMThuTWVzc2FnZXMpXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPEludGxQcm92aWRlciBsb2NhbGU9e2xvY2FsZX0gbWVzc2FnZXM9e2FsbE1lc3NhZ2VzfT5cbiAgICAgICAgICAgIDxJbnRsSW5qZWN0ZWRDb21wb25lbnQgey4uLnRoaXMucHJvcHN9IHsuLi5pbmplY3RQcm9wc30gLz5cbiAgICAgICAgICA8L0ludGxQcm92aWRlcj5cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNvcHkgc3RhdGljIHByb3Blcml0ZXNcbiAgICBmb3IgKGNvbnN0IHAgaW4gV3JhcHBlZENvbXBvbmVudCkge1xuICAgICAgaWYgKCFXaWRnZXRXcmFwcGVyW3BdKSB7XG4gICAgICAgIFdpZGdldFdyYXBwZXJbcF0gPSBXcmFwcGVkQ29tcG9uZW50W3BdXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFdpZGdldFdyYXBwZXJcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgUmVhY3QsIHR5cGUgTWVzc2FnZU1hbmFnZXIsIHR5cGUgTWVzc2FnZVR5cGUsIHR5cGUgTWVzc2FnZUFjdGlvbiwgdHlwZSBBY3Rpb25TZXR0aW5nUHJvcHMsIHR5cGUgSU1NZXNzYWdlQWN0aW9uSnNvbixcbiAgbW9kdWxlTG9hZGVyLCBpbmplY3RJbnRsLCBnZXRBcHBTdG9yZSwgdHlwZSBNZXNzYWdlQWN0aW9uUHJvcGVydHksIGkxOG4sIEludGxQcm92aWRlciwgdHlwZSBNZXNzYWdlRGVzY3JpcHRpb25cbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IFdpZGdldFNldHRpbmdNYW5hZ2VyIGZyb20gJy4vd2lkZ2V0LXNldHRpbmctbWFuYWdlcidcbmNvbnN0IHsgZ2V0VHJhbnNsYXRlZExvY2FsZTogZ2V0U3VwcG9ydGVkTG9jYWxlIH0gPSBpMThuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcE1lc3NhZ2VNYW5hZ2VyIHtcbiAgc3RhdGljIGluc3RhbmNlOiBBcHBNZXNzYWdlTWFuYWdlclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UgKCkge1xuICAgIGlmICghQXBwTWVzc2FnZU1hbmFnZXIuaW5zdGFuY2UpIHtcbiAgICAgIEFwcE1lc3NhZ2VNYW5hZ2VyLmluc3RhbmNlID0gbmV3IEFwcE1lc3NhZ2VNYW5hZ2VyKClcbiAgICB9XG4gICAgcmV0dXJuIEFwcE1lc3NhZ2VNYW5hZ2VyLmluc3RhbmNlXG4gIH1cblxuICBwcml2YXRlIGFjdGlvblNldHRpbmdzOiB7IFt1cmk6IHN0cmluZ106IHtcbiAgICBjbGF6ejogUmVhY3QuQ29tcG9uZW50Q2xhc3M8QWN0aW9uU2V0dGluZ1Byb3BzPHVua25vd24+PlxuICAgIGNsYXp6UHJvbWlzZTogUHJvbWlzZTxSZWFjdC5Db21wb25lbnRDbGFzczxBY3Rpb25TZXR0aW5nUHJvcHM8dW5rbm93bj4+PlxuXG4gICAgcmF3Q2xheno6IFJlYWN0LkNvbXBvbmVudENsYXNzPEFjdGlvblNldHRpbmdQcm9wczx1bmtub3duPj5cbiAgICByYXdDbGF6elByb21pc2U6IFByb21pc2U8UmVhY3QuQ29tcG9uZW50Q2xhc3M8QWN0aW9uU2V0dGluZ1Byb3BzPHVua25vd24+Pj5cblxuICAgIHNldHRpbmdJMThuTWVzc2FnZXM6IGkxOG4uSTE4bk1lc3NhZ2VzXG4gICAgc2V0dGluZ0kxOG5NZXNzYWdlc1Byb21pc2U6IFByb21pc2U8aTE4bi5JMThuTWVzc2FnZXM+XG4gIH0gfSA9IHt9XG5cbiAgZ2V0QWxsQWN0aW9ucyAoKTogTWVzc2FnZUFjdGlvbltdIHtcbiAgICBjb25zdCBhcHBNTSA9IHRoaXMuZ2V0QXBwTWVzc2FnZU1hbmFnZXIoKVxuICAgIGlmIChhcHBNTSkge1xuICAgICAgcmV0dXJuIGFwcE1NLmdldEFjdGlvbnMoKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gIH1cblxuICBnZXRBY3Rpb24gKHdpZGdldElkOiBzdHJpbmcsIGFjdGlvbk5hbWU6IHN0cmluZyk6IE1lc3NhZ2VBY3Rpb24ge1xuICAgIGNvbnN0IGFwcE1NID0gdGhpcy5nZXRBcHBNZXNzYWdlTWFuYWdlcigpXG4gICAgaWYgKGFwcE1NKSB7XG4gICAgICByZXR1cm4gYXBwTU0uZ2V0QWN0aW9uKHdpZGdldElkLCBhY3Rpb25OYW1lKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgfVxuXG4gIGdldEFwcE1lc3NhZ2VNYW5hZ2VyICgpOiBNZXNzYWdlTWFuYWdlciB7XG4gICAgaWYgKHdpbmRvdy5qaW11Q29uZmlnLmlzQnVpbGRlcikge1xuICAgICAgaWYgKHdpbmRvdy5fYXBwV2luZG93Ll9tZXNzYWdlTWFuYWdlcikge1xuICAgICAgICByZXR1cm4gd2luZG93Ll9hcHBXaW5kb3cuX21lc3NhZ2VNYW5hZ2VyIGFzIE1lc3NhZ2VNYW5hZ2VyXG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh3aW5kb3cuX21lc3NhZ2VNYW5hZ2VyKSB7XG4gICAgICByZXR1cm4gd2luZG93Ll9tZXNzYWdlTWFuYWdlciBhcyBNZXNzYWdlTWFuYWdlclxuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgYWN0aW9uIHNldHRpbmcgY29tcG9uZW50IHVyaSwgbnVsbCBtZWFucyBubyBzZXR0aW5nLlxuICAgKi9cbiAgZ2V0QWN0aW9uU2V0dGluZ0NvbXBvbmVudFVyaSAoYWN0aW9uOiBNZXNzYWdlQWN0aW9uLCBtZXNzYWdlVHlwZTogTWVzc2FnZVR5cGUsIG1lc3NhZ2VXaWRnZXRJZD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKGFjdGlvbi5nZXRTZXR0aW5nQ29tcG9uZW50VXJpKSB7XG4gICAgICByZXR1cm4gYWN0aW9uLmdldFNldHRpbmdDb21wb25lbnRVcmkobWVzc2FnZVR5cGUsIG1lc3NhZ2VXaWRnZXRJZClcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGFjdGlvbi53aWRnZXRJZCkge1xuICAgICAgICBjb25zdCB3aWRnZXRKc29uID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyLmFwcENvbmZpZy53aWRnZXRzW2FjdGlvbi53aWRnZXRJZF1cbiAgICAgICAgY29uc3QgYWN0aW9uSW5NYW5pZmVzdCA9IHdpZGdldEpzb24ubWFuaWZlc3QubWVzc2FnZUFjdGlvbnMuZmluZChhID0+IGEubmFtZSA9PT0gYWN0aW9uLm5hbWUpXG4gICAgICAgIGlmICghYWN0aW9uSW5NYW5pZmVzdCkge1xuICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGFjdGlvbkluTWFuaWZlc3Quc2V0dGluZ1VyaVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldEZpbHRlcmVkQWN0aW9ucyAobWVzc2FnZVR5cGU6IE1lc3NhZ2VUeXBlLCBtZXNzYWdlV2lkZ2V0SWQ/OiBzdHJpbmcpOiBNZXNzYWdlQWN0aW9uW10ge1xuICAgIGlmICh3aW5kb3cuX2FwcFdpbmRvdy5fbWVzc2FnZU1hbmFnZXIpIHtcbiAgICAgIGNvbnN0IGFjdGlvbnMgPSAod2luZG93Ll9hcHBXaW5kb3cuX21lc3NhZ2VNYW5hZ2VyIGFzIE1lc3NhZ2VNYW5hZ2VyKS5nZXRBY3Rpb25zKClcbiAgICAgIGNvbnN0IGZpbHRlcmVkQWN0aW9uczogTWVzc2FnZUFjdGlvbltdID0gW11cbiAgICAgIGNvbnN0IG1lc3NhZ2VEZXNjcmlwdGlvbjogTWVzc2FnZURlc2NyaXB0aW9uID0ge1xuICAgICAgICBtZXNzYWdlVHlwZSxcbiAgICAgICAgd2lkZ2V0SWQ6IG1lc3NhZ2VXaWRnZXRJZFxuICAgICAgfVxuICAgICAgY29uc3Qgc3RhdGUgPSB3aW5kb3cuamltdUNvbmZpZy5pc0J1aWxkZXIgPyBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXIgOiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKClcbiAgICAgIGNvbnN0IHdpZGdldEpzb24gPSBzdGF0ZS5hcHBDb25maWcud2lkZ2V0c1ttZXNzYWdlV2lkZ2V0SWRdXG4gICAgICBjb25zdCBwbSA9IHdpZGdldEpzb24ubWFuaWZlc3QucHVibGlzaE1lc3NhZ2VzLmZpbmQocG0gPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHBtID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiBwbSA9PT0gbWVzc2FnZVR5cGVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gcG0ubWVzc2FnZVR5cGUgPT09IG1lc3NhZ2VUeXBlXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBpZiAocG0gJiYgdHlwZW9mIHBtICE9PSAnc3RyaW5nJykge1xuICAgICAgICBtZXNzYWdlRGVzY3JpcHRpb24ubWVzc2FnZUNhcnJ5RGF0YSA9IHBtLm1lc3NhZ2VDYXJyeURhdGFcbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYWN0aW9uc1tpXS5maWx0ZXJNZXNzYWdlRGVzY3JpcHRpb24obWVzc2FnZURlc2NyaXB0aW9uKSkge1xuICAgICAgICAgIGZpbHRlcmVkQWN0aW9ucy5wdXNoKGFjdGlvbnNbaV0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmaWx0ZXJlZEFjdGlvbnNcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDb252ZXJ0ZWRTZXR0aW5nVXJpIChhY3Rpb25JZDogc3RyaW5nLCBzZXR0aW5nVXJpOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGFsbEFjdGlvbnMgPSB0aGlzLmdldEFsbEFjdGlvbnMoKVxuICAgIGxldCByZXN1bHRVcmkgPSBudWxsXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxBY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoYWN0aW9uSWQuaW5jbHVkZXMoYWxsQWN0aW9uc1tpXS5pZCkpIHtcbiAgICAgICAgY29uc3QgYWN0aW9uV2lkZ2V0SWQgPSBhbGxBY3Rpb25zW2ldLndpZGdldElkXG4gICAgICAgIGlmIChhY3Rpb25XaWRnZXRJZCkge1xuICAgICAgICAgIC8vIHRoZSBhY3Rpb24gdGFyZ2V0IGlzIHdpZGdldFxuICAgICAgICAgIGNvbnN0IHdpZGdldEpzb24gPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXIuYXBwQ29uZmlnLndpZGdldHNbYWN0aW9uV2lkZ2V0SWRdXG4gICAgICAgICAgY29uc3QgbWVzc2FnZUFjdGlvbnMgPSB3aWRnZXRKc29uLm1hbmlmZXN0Lm1lc3NhZ2VBY3Rpb25zXG4gICAgICAgICAgbGV0IGFjdGlvblByb3BlcnR5OiBNZXNzYWdlQWN0aW9uUHJvcGVydHkgPSBudWxsXG5cbiAgICAgICAgICBpZiAobWVzc2FnZUFjdGlvbnMpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgbWVzc2FnZUFjdGlvbnMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VBY3Rpb25zW2tdLm5hbWUgPT09IGFsbEFjdGlvbnNbaV0ubmFtZSkge1xuICAgICAgICAgICAgICAgIGFjdGlvblByb3BlcnR5ID0gbWVzc2FnZUFjdGlvbnNba11cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChhY3Rpb25Qcm9wZXJ0eSAmJiBzZXR0aW5nVXJpKSB7XG4gICAgICAgICAgICByZXN1bHRVcmkgPSB3aWRnZXRKc29uLnVyaSArICdkaXN0LycgKyBzZXR0aW5nVXJpXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0VXJpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHRoZSBhY3Rpb24gdGFyZ2V0IGlzIGZyYW1ld29ya1xuICAgICAgICAgIHJldHVybiBzZXR0aW5nVXJpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdFVyaVxuICB9XG5cbiAgYXN5bmMgbG9hZEFjdGlvblNldHRpbmdDbGFzcyAoYWN0aW9uSnNvbjogSU1NZXNzYWdlQWN0aW9uSnNvbiwgYWN0aW9uU2V0dGluZ1VyaTogc3RyaW5nKTogUHJvbWlzZTxSZWFjdC5Db21wb25lbnRDbGFzczxBY3Rpb25TZXR0aW5nUHJvcHM8dW5rbm93bj4+PiB7XG4gICAgY29uc3QgdXJpID0gYWN0aW9uU2V0dGluZ1VyaSA/IHRoaXMuZ2V0Q29udmVydGVkU2V0dGluZ1VyaShhY3Rpb25Kc29uLmFjdGlvbklkLCBhY3Rpb25TZXR0aW5nVXJpKSA6IG51bGxcblxuICAgIGlmICghdXJpKSB7XG4gICAgICBQcm9taXNlLnJlc29sdmUobnVsbClcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXSkge1xuICAgICAgdGhpcy5hY3Rpb25TZXR0aW5nc1t1cmldID0ge30gYXMgYW55XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXT8uY2xhenpQcm9taXNlKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5hY3Rpb25TZXR0aW5nc1t1cmldLmNsYXp6UHJvbWlzZVxuICAgIH1cblxuICAgIGNvbnN0IGFjdGlvbldpZGdldElkID0gYWN0aW9uSnNvbi53aWRnZXRJZFxuICAgIGNvbnN0IGFjdGlvbldpZGdldEpzb24gPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXIuYXBwQ29uZmlnLndpZGdldHNbYWN0aW9uV2lkZ2V0SWRdXG5cbiAgICB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0uY2xhenpQcm9taXNlID0gdGhpcy5sb2FkUmF3U2V0dGluZ0NsYXNzKHVyaSkudGhlbihhc3luYyByYXdDbGF6eiA9PiB7XG4gICAgICByZXR1cm4gV2lkZ2V0U2V0dGluZ01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5sb2FkSTE4bk1lc3NhZ2VzRm9yU2V0dGluZyhhY3Rpb25XaWRnZXRKc29uICYmIGFjdGlvbldpZGdldEpzb24udXJpKS50aGVuKGkxOG5NZXNzYWdlcyA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmluamVjdEFjdGlvblNldHRpbmdQcm9wcyhyYXdDbGF6eiwgaTE4bk1lc3NhZ2VzLCBhY3Rpb25XaWRnZXRKc29uICYmIGFjdGlvbldpZGdldEpzb24uaWQpXG4gICAgICB9KVxuICAgIH0pLnRoZW4oKHdyYXBlZENsYXNzOiBSZWFjdC5Db21wb25lbnRDbGFzczxBY3Rpb25TZXR0aW5nUHJvcHM8dW5rbm93bj4+KSA9PiB7XG4gICAgICB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0uY2xhenogPSB3cmFwZWRDbGFzc1xuICAgICAgcmV0dXJuIHdyYXBlZENsYXNzXG4gICAgfSlcblxuICAgIHJldHVybiB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0uY2xhenpQcm9taXNlXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxvYWRSYXdTZXR0aW5nQ2xhc3MgKHVyaTogc3RyaW5nKTogUHJvbWlzZTxSZWFjdC5Db21wb25lbnRDbGFzczxBY3Rpb25TZXR0aW5nUHJvcHM8dW5rbm93bj4+PiB7XG4gICAgaWYgKHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXS5yYXdDbGF6elByb21pc2UpIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0ucmF3Q2xhenpQcm9taXNlXG4gICAgfVxuICAgIHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXS5yYXdDbGF6elByb21pc2UgPSBtb2R1bGVMb2FkZXIubG9hZE1vZHVsZSh1cmkpLnRoZW4ocmF3Q2xhenogPT4ge1xuICAgICAgcmF3Q2xhenogPSByYXdDbGF6ei5kZWZhdWx0ID8gcmF3Q2xhenouZGVmYXVsdCA6IHJhd0NsYXp6XG4gICAgICB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0ucmF3Q2xhenogPSByYXdDbGF6elxuICAgICAgcmV0dXJuIHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXS5yYXdDbGF6elxuICAgIH0pXG4gICAgcmV0dXJuIHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXS5yYXdDbGF6elByb21pc2VcbiAgfVxuXG4gIHByaXZhdGUgaW5qZWN0QWN0aW9uU2V0dGluZ1Byb3BzIChXcmFwcGVkQ29tcG9uZW50LCBpMThuTWVzc2FnZXMsIGFjdGlvbldpZGdldElkOiBzdHJpbmcpOiBSZWFjdC5Db21wb25lbnRDbGFzczxBY3Rpb25TZXR0aW5nUHJvcHM8dW5rbm93bj4+IHtcbiAgICBjb25zdCBJbnRsSW5qZWN0ZWRDb21wb25lbnQgPSBpbmplY3RJbnRsKFdyYXBwZWRDb21wb25lbnQpXG4gICAgY29uc3QgYWN0aW9uV2lkZ2V0SnNvbiA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBTdGF0ZUluQnVpbGRlci5hcHBDb25maWcud2lkZ2V0c1thY3Rpb25XaWRnZXRJZF1cbiAgICBsZXQgd2lkZ2V0TmFtZSA9IG51bGxcblxuICAgIGlmIChhY3Rpb25XaWRnZXRJZCAmJiBhY3Rpb25XaWRnZXRKc29uKSB7XG4gICAgICB3aWRnZXROYW1lID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyLmFwcENvbmZpZy53aWRnZXRzW2FjdGlvbldpZGdldElkXS5tYW5pZmVzdC5uYW1lXG4gICAgfSBlbHNlIHtcbiAgICAgIHdpZGdldE5hbWUgPSAnRnJhbWV3b3JrJ1xuICAgIH1cblxuICAgIGNsYXNzIFdpZGdldFdyYXBwZXIgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PEFjdGlvblNldHRpbmdQcm9wczx1bmtub3duPj4ge1xuICAgICAgc3RhdGljIGRpc3BsYXlOYW1lID0gYEFjdGlvblNldHRpbmdXcmFwcGVyKCR7d2lkZ2V0TmFtZX0pYFxuXG4gICAgICByZW5kZXIgKCkge1xuICAgICAgICBjb25zdCBpbmplY3RQcm9wczogYW55ID0ge1xuICAgICAgICAgIG1lc3NhZ2VzOiBpMThuTWVzc2FnZXNcbiAgICAgICAgfVxuICAgICAgICAvLyBtZXJnZSBpbiB0aGUgYXBwJ3MgbWVzc2FnZXMgYmVmb3JlIGNyZWF0aW5nIHRoZSBjb250ZXh0IHNvIHRoYXRcbiAgICAgICAgLy8gYW55IGppbXUtdWkgY29tcG9uZW50cyBpbiB0aGlzIGNvbXBvbmVudCBjYW4gaGF2ZSBhY2Nlc3MgdG8gdGhlaXIgb3duIG1lc3NhZ2VzXG4gICAgICAgIC8vIE5PVEU6IG1lc3NhZ2VzIHdpdGggdGhlIHNhbWUga2V5IHdpbGwgYmUgb3ZlcnJpZGRlbiwgc28gcGxlYXNlIG1ha2Ugc3VyZSB3aWRnZXQgZG8gbm90IHVzZSB0aGUgc2FtZSBrZXkgd2l0aCBqaW11LlxuICAgICAgICBjb25zdCBhcHBJMThuTWVzc2FnZXMgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwSTE4bk1lc3NhZ2VzXG5cbiAgICAgICAgbGV0IGxvY2FsZSA9IG51bGxcbiAgICAgICAgaWYgKGFjdGlvbldpZGdldElkICYmIGFjdGlvbldpZGdldEpzb24pIHtcbiAgICAgICAgICBsb2NhbGUgPSBnZXRTdXBwb3J0ZWRMb2NhbGUoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbnRleHQubG9jYWxlLCBhY3Rpb25XaWRnZXRKc29uLm1hbmlmZXN0LnRyYW5zbGF0ZWRMb2NhbGVzLmFzTXV0YWJsZSgpKVxuICAgICAgICAgIGlmICghbG9jYWxlKSB7XG4gICAgICAgICAgICAvLyB3aWRnZXQgZG9lcyBub3Qgc3VwcG9ydCB1c2VyJ3MgbG9jYWxlLCB1c2UgdGhlIGRlZmF1bHQgbG9jYWxlXG4gICAgICAgICAgICBsb2NhbGUgPSBhY3Rpb25XaWRnZXRKc29uLm1hbmlmZXN0LnRyYW5zbGF0ZWRMb2NhbGVzICYmIGFjdGlvbldpZGdldEpzb24ubWFuaWZlc3QudHJhbnNsYXRlZExvY2FsZXNbMF1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFsb2NhbGUpIHtcbiAgICAgICAgICAgIGxvY2FsZSA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBDb250ZXh0LmxvY2FsZVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2NhbGUgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwQ29udGV4dC5sb2NhbGVcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFsbE1lc3NhZ2VzID0gT2JqZWN0LmFzc2lnbih7fSwgaTE4bk1lc3NhZ2VzLCBhcHBJMThuTWVzc2FnZXMpXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPEludGxQcm92aWRlciBsb2NhbGU9e2xvY2FsZX0gbWVzc2FnZXM9e2FsbE1lc3NhZ2VzfT5cbiAgICAgICAgICAgIDxJbnRsSW5qZWN0ZWRDb21wb25lbnQgey4uLnRoaXMucHJvcHN9IHsuLi5pbmplY3RQcm9wc30gLz5cbiAgICAgICAgICA8L0ludGxQcm92aWRlcj5cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNvcHkgc3RhdGljIHByb3Blcml0ZXNcbiAgICBmb3IgKGNvbnN0IHAgaW4gV3JhcHBlZENvbXBvbmVudCkge1xuICAgICAgaWYgKCFXaWRnZXRXcmFwcGVyW3BdKSB7XG4gICAgICAgIFdpZGdldFdyYXBwZXJbcF0gPSBXcmFwcGVkQ29tcG9uZW50W3BdXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFdpZGdldFdyYXBwZXJcbiAgfVxuXG4gIHJlZ2lzdGVyQWN0aW9uUmF3U2V0dGluZ0NsYXNzICh1cmk6IHN0cmluZywgcmF3U2V0dGluZ0NsYXNzKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0pIHtcbiAgICAgIHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXSA9IHt9IGFzIGFueVxuICAgIH1cbiAgICB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0ucmF3Q2xhenogPSByYXdTZXR0aW5nQ2xhc3NcbiAgICB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0ucmF3Q2xhenpQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKHJhd1NldHRpbmdDbGFzcylcblxuICAgIHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXS5zZXR0aW5nSTE4bk1lc3NhZ2VzID0ge31cbiAgICB0aGlzLmFjdGlvblNldHRpbmdzW3VyaV0uc2V0dGluZ0kxOG5NZXNzYWdlc1Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoe30pXG4gIH1cblxuICBnZXRBY3Rpb25SYXdTZXR0aW5nQ2xhc3MgKHVyaTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuYWN0aW9uU2V0dGluZ3NbdXJpXS5yYXdDbGF6elxuICB9XG59XG4iLCJpbXBvcnQgeyB0eXBlIEFwcENvbmZpZywgU2Vzc2lvbk1hbmFnZXIsIGdldEFwcFN0b3JlLCB1dWlkdjEsIFJlc291cmNlVHlwZSwgQWpheFN0YXRlLCB1dGlscywgdHlwZSBJY29uUmVzdWx0LCBhcHBDb25maWdVdGlscyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgSVJlcXVlc3RPcHRpb25zIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtcmVxdWVzdCdcbmltcG9ydCB7IHR5cGUgSUdldEl0ZW1SZXNvdXJjZU9wdGlvbnMsIHR5cGUgSUl0ZW1SZXNvdXJjZVJlc3BvbnNlIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtcG9ydGFsJ1xuaW1wb3J0IHsgYnVpbGRlclN0YXRlUmVzb3VyY2VBY3Rpb25zIH0gZnJvbSAnLi9idWlsZGVyLXN0YXRlLXJlc291cmNlLWV4dGVuc2lvbidcbmltcG9ydCB7IHR5cGUgQXBwSW5mbyB9IGZyb20gJy4vc2VydmljZS90eXBlJ1xuaW1wb3J0IHsgZ2V0U2Vzc2lvbiB9IGZyb20gJy4vc2VydmljZS9hcHAtc2VydmljZS91dGlsJ1xuaW1wb3J0IHtcbiAgZ2V0SXRlbSxcbiAgcmVtb3ZlSXRlbVJlc291cmNlLFxuICBhZGRJdGVtUmVzb3VyY2UsXG4gIGdldEl0ZW1SZXNvdXJjZXMsXG4gIGdldEl0ZW1SZXNvdXJjZSxcbiAgdXBkYXRlSXRlbVJlc291cmNlLFxuICBnZXRSZXNvdXJjZU9yaWdpblxufSBmcm9tICcuL3NlcnZpY2UvcmVzdC1zZXJ2aWNlJ1xuaW1wb3J0IHsgZ2V0Q2xlYW5BcHBDb25maWcgfSBmcm9tICcuL3V0aWxzL2FwcC1jb25maWctdXRpbHMnXG5pbXBvcnQgeyBpbWFnZVV0aWxzIH0gZnJvbSAnamltdS11aSdcbmltcG9ydCB7IHR5cGUgVXNlclNlc3Npb24gfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1hdXRoJ1xuXG4vLyBBcHAgcmVzb3VyY2VzIHRoYXQgYXJlIG1hbmFnZWQgYnkgbWFuYWdlbWVudCByZXNvdXJjZXMgYXJlIGNhbGxlZCBpdGVtIHJlc291cmNlLlxuZXhwb3J0IGludGVyZmFjZSBSZXNvdXJjZUl0ZW1JbmZvIHtcbiAgLyoqXG4gICAqIFRoZSBmaW5hbCBVUkwgb2YgdGhlIHJlc291cmNlLCB3aWRnZXQgc2hvdWxkIHVzZSB0aGlzIFVSTCB0byBkaXNwbGF5IHJlc291cmNlLlxuICAgKiBUaGUgVVJMIGhhcyB0d28gZm9ybXMsIG9uZSBpcyB0aGUgYmxvYlVybCwgdGhlIG90aGVyIGlzIHRoZSB1cmwgd2l0aCBwb3J0YWwgYW5kIHRva2VuLlxuICAgKlxuICAgKiAqIFdoZW4gdGhlIHJlc291cmNlIGlzIGp1c3QgdXBsb2FkZWQsIGl0IGlzIGJsb2JVcmwsIGxpa2UgdGhpczogJ2Jsb2I6aHR0cHM6Ly8uLi4uLi4nXG4gICAqICogV2hlbiB0aGUgcmVzb3VyY2UgaXMgZmV0Y2hlZCBmcm9tIHNlcnZlciwgaXQgaXMgcmVzb3VyY2VVUkwsIGxpa2UgdGhpczogJ2h0dHBzOi8vd3d3LmFyY2dpcy5jb20vc2hhcmluZy9yZXN0L2NvbnRlbnQvaXRlbXMvYWxza2RoZm9hdWcvcmVzb3VyY2VzL2ltYWdlcy93aWRnZXRfMS8xNjQxNTM1ODk3NDk2LnBuZz90b2tlbj0uLi4nXG4gICAqXG4gICAqXG4gICAqIEhvd2V2ZXIsIHdoZW4gdGhlIHJlc291cmNlIGl0ZW0gaXMgc2F2ZWQgaW4gdGhlIG1hbmFnZW1lbnQgcmVzb3VyY2UsIHRoZSBVUkwgaXMgbGlrZSB0aGlzOiAnJHthcHBSZXNvdXJjZVVybH0vaW1hZ2VzL3dpZGdldF8xLzE2NDE1MzU4OTc0OTYucG5nJy5cbiAgICogQWZ0ZXIgdGhlIHJlc291cmNlIGZldGNoZWQgdG8gY2xpZW50LCB0aGUgJyR7YXBwUmVzb3VyY2VVcmx9JyBpcyByZXBsYWNlZCB3aXRoIHRoZSBwb3J0YWxVcmwgYW5kIHRva2VuIGlzIGFwcGVuZGVkLiBTbywgd2lkZ2V0IHdpbGwgbmV2ZXIgcmVhZCB0aGlzIGtpbmQgb2YgVVJMLlxuICAgKi9cbiAgdXJsPzogc3RyaW5nIC8vIFRoZSBpbWFnZSByZXNvdXJjZSB1cmwuIFRoaXMgbWF5IGJlIGEgbG9jYWwgY2FjaGVkIGJsb2IgdXJsIChlZzogYmxvYjpodHRwczovLy4uLi4uLikgb3IgYSB1cmwgd2l0aCBwb3J0YWwgYW5kIHRva2VuIChlZzogaHR0cHM6Ly93d3cuYXJjZ2lzLmNvbS9zaGFyaW5nL3Jlc3QvY29udGVudC9pdGVtcy83ODczODFhMjFmNy9yZXNvdXJjZXMvaW1hZ2VzL3dpZGdldF8xLzE2NDE1MzU4OTc0OTYucG5nP3Rva2VuPS4uLikuXG5cbiAgY3JlYXRlZD86IG51bWJlciAvLyBlZzogMTY0MTUzNTg5NzQ5NiwgaXQgYWxzbyBpcyBpZC5cbiAgZmlsZUZvcm1hdD86IHN0cmluZyAvLyBmaWxlRm9ybWF0LCBlZzogJ2ltYWdlL3BuZydcbiAgZmlsZU5hbWU/OiBzdHJpbmcgLy8gcG9ydGFsIGZpbGVOYW1lLCBlZzogJzE2NDE1MzU4OTc0OTYucG5nJ1xuICBvcmlnaW5hbE5hbWU/OiBzdHJpbmcgLy8gb3JpZ2luYWwgZmlsZU5hbWUsIGVnOiAnMTIzNDU0NS5wbmcnXG4gIHJlc291cmNlc1ByZWZpeD86IHN0cmluZyAvLyByZXNvdXJjZXNQcmVmaXgsIGVnOiAnaW1hZ2VzL3dpZGdldF8xJ1xuICBzaXplPzogbnVtYmVyIC8vIHRoZSBzaXplIG9mIHRoZSByZXNvdXJjZSwgZWc6IDc0NzkxXG4gIG9yaWdpbmFsV2lkdGg/OiBudW1iZXIgLy8gb3JpZ2luYWwgd2lkdGggb2YgaW1hZ2UgZmlsZVxuICBvcmlnaW5hbEhlaWdodD86IG51bWJlciAvLyBvcmlnaW5hbCBoZWlnaHQgb2YgaW1hZ2UgZmlsZVxuXG4gIC8vIEJlbG93IHByb3BlcnRpZXMgYXJlIHVzZWQgaW4gdGhlIHVwbG9hZC9zYXZlIHByb2dyZXNzLlxuICBpZD86IHN0cmluZyAvLyB0aGUgdW5pcXVlIGtleSBmb3IgcmVzb3VyY2UsIGdlbmVyYXRlZCBieSB1dWlkdjEoKVxuICBhcHBJZD86IHN0cmluZyAvLyBhcHBJRCBmb3IgcmVzb3VyY2VcbiAgd2lkZ2V0SWQ/OiBzdHJpbmcgLy8gdGhlIHdpZGdldElkIG9mIHVwbG9hZGluZyB0aGUgZmlsZVxuICBibG9iVXJsPzogc3RyaW5nIC8vIHRoZSBsb2NhbCBjYWNoZSB1cmwgZm9yIHJlc291cmNlXG4gIGZpbGU/OiBCbG9iIHwgc3RyaW5nIC8vIHRoZSBsb2NhbCBCbG9iIGZpbGUgZm9yIHJlc291cmNlXG4gIHJlc291cmNlVXJsPzogc3RyaW5nIC8vIHRoZSB1cmwgb2YgcmVzb3VyY2UgaW4gcG9ydGFsOiBlZy4nJHthcHBSZXNvdXJjZVVybH0vaW1hZ2VzL3dpZGdldF8xLzE2NDE1MzU4OTc0OTYucG5nJ1xuICB0eXBlPzogUmVzb3VyY2VUeXBlIC8vIHRoZSB0eXBlIG9mIHJlc291cmNlLCBlZzogcmVzb3VyY2VzICdpbWFnZXMvd2lkZ2V0XzEvMTIzNDU2LmpwZycsICdpbWFnZXMvaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbicsICdpbWFnZXMvaWNvbi1yZXNvdXJjZXMtbGlzdC5qc29uJyBiZWxvbmcgdG8gUmVzb3VyY2VUeXBlLkltYWdlLCAgcmVzb3VyY2UgJ2NvbmZpZy9jb25maWcuanNvbicgYmVsb25ncyB0byBSZXNvdXJjZVR5cGUuQ29uZmlnLlxuICBzdGF0dXM/OiBBamF4U3RhdGUgLy8gdGhlIHN0YXR1cyBvZiBhamF4IHJlcXVlc3RcbiAgcHJvbWlzZT86IFByb21pc2U8YW55PiAvLyB0aGUgcHJvbWlzZSBmb3IgcmVzb3VyY2UgdXBsb2FkXG4gIG93bmVyPzogc3RyaW5nIC8vIHRoZSBvd25lciBvZiB0aGUgYXBwIG9yIHRoZSB1c2VybmFtZSBvZiBzZXNzaW9uXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2VSZXNvdXJjZUl0ZW1JbmZvIGV4dGVuZHMgUmVzb3VyY2VJdGVtSW5mbyB7XG4gIHdpZHRoPzogbnVtYmVyXG4gIGhlaWdodD86IG51bWJlclxuICByZWZlcmVkSWRzPzogc3RyaW5nW11cbiAgb3JpZ2luSWQ/OiBzdHJpbmdcbiAgaXNVc2VDb21wcmVzcz86IGJvb2xlYW5cbn1cblxuZXhwb3J0IGVudW0gQXBwUmVzb3VyY2VGaWxlUGF0aCB7XG4gIENvbmZpZyA9ICdjb25maWcvY29uZmlnLmpzb24nLFxuICBJbWFnZSA9ICdpbWFnZXMvaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbicsXG4gIEljb24gPSAnaW1hZ2VzL2ljb24tcmVzb3VyY2VzLWxpc3QuanNvbidcbn1cblxuLy9BbGwgcmVzb3VyY2VzIGluIGFuIGFwcCBhcmUgY2FsbGVkIGFwcCByZXNvdXJjZSwgbGlrZTogY29uZmlnLmpzb24gb3IgaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbiBvciBpY29uLXJlc291cmNlcy1saXN0Lmpzb24gb3IgaW1hZ2UgaXRlbXMuXG4vLyBUaGUgYXBwIHJlc291cmNlcyBhcmUgc29ydGVkIGludG8gdHdvIGNhdGVnb3JpZXM6IG1hbmFnZW1lbnQgcmVzb3VyY2VzIGFuZCBpdGVtIHJlc291cmNlcywgc2VlIGBBcHBSZXNvdXJjZU1hbmFnZXJgLlxuZXhwb3J0IGludGVyZmFjZSBBcHBSZXNvdXJjZUluZm8ge1xuICBhY2Nlc3M6IHN0cmluZ1xuICBjcmVhdGVkOiBudW1iZXJcbiAgcmVzb3VyY2U6IHN0cmluZyAvLyBUaGlzIGlzIHRoZSByZXNvdXJjZSBmaWxlIHBhdGguIExpa2U6ICdjb25maWcvY29uZmlnLmpzb24nLCAnaW1hZ2VzL2ltYWdlLXJlc291cmNlcy1saXN0Lmpzb24nLCAnaW1hZ2VzL2ljb24tcmVzb3VyY2VzLWxpc3QuanNvbicsICdpbWFnZXMvd2lkZ2V0XzEvMTIzNDU2LmpwZydcbiAgc2l6ZTogbnVtYmVyXG59XG5cbi8vVGhlIGxpc3QgaW5jbHVkZXMgdGhlIGNvbGxlY3Rpb24gb2YgYWxsIGtpbmRzIG9mIGFwcCByZXNvdXJjZSBpbmZvLlxuZXhwb3J0IGludGVyZmFjZSBBcHBSZXNvdXJjZUluZm9MaXN0IHtcbiAgcmVzb3VyY2VzOiBBcHBSZXNvdXJjZUluZm9bXSAvLyBXZSBvbmx5IHVzZSB0aGlzIHByb3BlcnR5LlxuICBuZXh0U3RhcnQ/OiBudW1iZXJcbiAgbnVtPzogbnVtYmVyXG4gIHN0YXJ0PzogbnVtYmVyXG4gIHRvdGFsPzogbnVtYmVyXG59XG5cbi8vIEltYWdlIHJlc291cmNlIGxpc3QgZGF0YS5cbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2VSZXNvdXJjZUxpc3Qge1xuICBbaWQ6IHN0cmluZ106IEltYWdlUmVzb3VyY2VJdGVtSW5mb1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEljb25SZXNvdXJjZSBleHRlbmRzIEljb25SZXN1bHQge31cblxuZXhwb3J0IGludGVyZmFjZSBJY29uUmVzb3VyY2VMaXN0IHtcbiAgW2lkOiBzdHJpbmddOiBJY29uUmVzb3VyY2Vcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXNvdXJjZXMge1xuICBpbWFnZVJlc291cmNlcz86IEltYWdlUmVzb3VyY2VMaXN0XG4gIGljb25SZXNvdXJjZXM/OiBJY29uUmVzb3VyY2VMaXN0XG59XG5cbmludGVyZmFjZSBSZXNvdXJjZUlkQW5kUmVzb3VyY2VVcmwge1xuICBpZDogc3RyaW5nXG4gIHJlc291cmNlVXJsOiBzdHJpbmdcbn1cblxuLyoqXG4gKiBUaGUgcmVzb3VyY2UgbWFuYWdlciBpcyB1c2VkIHRvIHByb2Nlc3MgdGhlIHJlc291cmNlcyBpbiB0aGUgYXBwLiBJdCBjYW4gYmUgdXNlZCB0byB1cGxvYWQgcmVzb3VyY2VzIHRvIHRoZSBzZXJ2ZXIsIHVwZGF0ZSB0aGUgY29uZmlnLCBhbmQgdG8gZmV0Y2ggcmVzb3VyY2VzIGZyb20gdGhlIHNlcnZlci5cbiAqXG4gKiBBcHAgcmVzb3VyY2VzIHJlZmVyIHRvIGZpbGVzIHVzZWQgYnkgdGhlIGFwcCwgc3VjaCBhcyBpbWFnZXMsIGljb25zLCBhbmQgY29uZmlnLmpzb24uIFRoZXkgYXJlIHN0b3JlZCBvbiB0aGUgQXJjR0lTIHJlc3Qgc2VydmVyIGFzc29jaWF0ZWQgd2l0aCB0aGUgYXBwIGl0ZW0uXG4gKiBUaGUgc3RvcmFnZSBzdHJ1Y3R1cmUgb2YgdGhlIHJlc291cmNlcyBhcmUgYXMgZm9sbG93czpcbiAqIHtcbiAqICAgIHJlc291cmNlczogW1xuICogICAgICAgIHsgcmVzb3VyY2U6ICdjb25maWcvY29uZmlnLmpzb24nICwgLi4ufSwgLy8gVGhpcyBmaWxlIGlzIHRoZSBkcmFmdCB2ZXJzaW9uIGFwcENvbmZpZ1xuICogICAgICAgIHsgcmVzb3VyY2U6ICdpbWFnZXMvaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbicgLCAuLi59LCAvLyBUaGlzIGZpbGUgaXMgc3RvcmVkIGltYWdlUmVzb3VyY2VzLlxuICogICAgICAgIHsgcmVzb3VyY2U6ICdpbWFnZXMvaWNvbi1yZXNvdXJjZXMtbGlzdC5qc29uJyAsIC4uLn0sIC8vIFRoaXMgZmlsZSBpcyBzdG9yZWQgaWNvblJlc291cmNlcy5cbiAqICAgICAgICB7IHJlc291cmNlOiAnaW1hZ2VzL3dpZGdldF8xLzEyMzQ1Ni5qcGcnICwgLi4ufSwgLy8gVGhpcyBmaWxlIGlzIHN0b3JlZCBpbWFnZSBpdGVtLlxuICogICAgICAgIC4uLlxuICogICAgXVxuICogfVxuICpcbiAqIFRoZXNlIGZpcnN0IDMgYXBwIHJlc291cmNlcyBhcmUgc3BlY2lhbC4gVGhlIGNvbmZpZy5qc29uIGlzIHRoZSBkcmFmdCB2ZXJzaW9uIGFwcENvbmZpZy5cbiAqIFRoZSBpbWFnZS1yZXNvdXJjZXMtbGlzdC5qc29uIGFuZCBpY29uLXJlc291cmNlcy1saXN0Lmpzb24gYXJlIHVzZWQgdG8gbWFuYWdlIG90aGVyIHJlc291cmNlcywgd2UgY2FsbCB0aGVtIG1hbmFnZW1lbnQgcmVzb3VyY2VzLCB0aGV5IGRvbid0IGhhdmUgYFJlc291cmNlSXRlbUluZm9gIGJ1dCB0aGVpciBjb250ZW50IGhhdmUgYFJlc291cmNlSXRlbUluZm9gIHRvIG1hbmFnZSB0aGUgaXRlbSByZXNvdXJjZXMuXG4gKiBBbGwgb3RoZXIgcmVzb3VyY2VzIGFyZSBjYWxsZWQgcmVzb3VyY2UgaXRlbXMsIHRoZXkgaGF2ZSBgUmVzb3VyY2VJdGVtSW5mb2AuXG4gKlxuICogVGhlIG1hbmFnZXIgaGFuZGxlcyBtYXBwaW5nIGFwcCByZXNvdXJjZSBVUkxzIHRvIHRoZSB1bmRlcmx5aW5nIHN0b3JhZ2UgbG9jYXRpb24uIFNvIGNvZGUgY2FuIHJlZmVyIHRvIGEgbm9ybWFsaXplZCBVUkwgbGlrZSAke2FwcFJlc291cmNlVXJsfS9pbWFnZXMvd2lkZ2V0MS9pbWFnZS5wbmcuIEFuZCB0aGUgbWFuYWdlciB3aWxsIGhhbmRsZSB1cGxvYWRpbmcgcmVzb3VyY2VzIHRvIHRoZSBwcm9wZXIgL2ltYWdlcy93aWRnZXQxL2xvY2F0aW9uLlxuICpcbiAqIEhlcmUgaXMgaG93IHRoZSByZXNvdXJjZXMgYXJlIHByb2Nlc3NlZDpcbiAqICAqIFdoZW4gdXBsb2FkaW5nIHJlc291cmNlcywgaXQgY29udmVydHMgZmlsZXMgdG8gYmxvYnMgYW5kIGdlbmVyYXRlcyBibG9iIFVSTHMuXG4gKiAgKiBXaGVuIHNhdmluZyBhbmQgdXBkYXRpbmcgdGhlIGFwcCBjb25maWcsIGl0IHJlcGxhY2VzIGJsb2IgVVJMcyB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIHJlc291cmNlIFVSTHMuXG4gKiAgKiBXaGVuIGZldGNoaW5nIHJlc291cmNlcyBmcm9tIHNlcnZlciwgaXQgcmVwbGFjZXMgYCR7YXBwUmVzb3VyY2VVcmx9YCB3aXRoIHBvcnRhbFVybCBhbmQgYWRkIHRva2VuIHRvIHRoZSBlbmQgb2YgdGhlIHVybC5cbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBBcHBSZXNvdXJjZU1hbmFnZXIge1xuICBzdGF0aWMgX2luc3RhbmNlOiBBcHBSZXNvdXJjZU1hbmFnZXJcbiAgc3RhdGljIGdldEluc3RhbmNlICgpIHtcbiAgICBpZiAoIUFwcFJlc291cmNlTWFuYWdlci5faW5zdGFuY2UpIHtcbiAgICAgIEFwcFJlc291cmNlTWFuYWdlci5faW5zdGFuY2UgPSBuZXcgQXBwUmVzb3VyY2VNYW5hZ2VyKClcbiAgICAgIHdpbmRvdy5fYXBwUmVzb3VyY2VNYW5hZ2VyID0gQXBwUmVzb3VyY2VNYW5hZ2VyLl9pbnN0YW5jZVxuICAgIH1cbiAgICByZXR1cm4gd2luZG93Ll9hcHBSZXNvdXJjZU1hbmFnZXJcbiAgfVxuXG4gIC8vIENhY2hlIGFwcCByZXNvdXJjZXMgZGF0YSBpbiBsb2NhbCB3ZWIgYXBwIGJ5IHVwbG9hZGVkLlxuICBwcml2YXRlIHJlc291cmNlTWFwOiB7IFtyZXNvdXJjZUtleTogc3RyaW5nXTogUmVzb3VyY2VJdGVtSW5mbyB9ID0ge31cbiAgcHJpdmF0ZSBibG9iVG9SZXNvdXJjZU1hcDogeyBbYmxvYlVybDogc3RyaW5nXTogUmVzb3VyY2VJZEFuZFJlc291cmNlVXJsIH0gPSB7fVxuXG4gIC8vIEFsbCBhcHAgcmVzb3VyY2VzLCBpbmNsdWRlcyB0aGUgcmVzb3VyY2VzIHRoYXQgYXJlIHVwbG9hZGVkIGJ1dCBoYXZlIG5vdCBiZWVuIHNhdmVkIHlldC5cbiAgcHJpdmF0ZSByZXNvdXJjZXM6IFJlc291cmNlcyA9IHt9XG5cbiAgLy8gQ2hhbmdlIHRoZSBmaWxlIHRvIGJsb2JVcmwuIENhbGN1bGF0ZSB3aWR0aCBhbmQgaGVpZ2h0IGZyb20gYmxvYlVybC4gRmluYWxseSBhc3NpZ24gdGhlc2UgdmFyaWFibGVzIHRvIHJlc291cmNlSXRlbUluZm8uXG4gIHN0YXRpYyBhc3luYyBhc3NpZ25CbG9iVXJsVG9SZXNvdXJjZUl0ZW0gKHJlc291cmNlSXRlbUluZm86IFJlc291cmNlSXRlbUluZm8pOiBQcm9taXNlPFJlc291cmNlSXRlbUluZm8+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYmxvYlVybCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHJlc291cmNlSXRlbUluZm8uZmlsZSBhcyBCbG9iKVxuICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBhd2FpdCBpbWFnZVV0aWxzLmdldEltYWdlT3JpZ2luYWxTaXplQnlVcmwoYmxvYlVybCkuY2F0Y2goKCkgPT4gKHsgd2lkdGg6IDAsIGhlaWdodDogMCB9KSlcbiAgICAgIHJlc291cmNlSXRlbUluZm8udXJsID0gYmxvYlVybFxuICAgICAgcmVzb3VyY2VJdGVtSW5mby5ibG9iVXJsID0gYmxvYlVybFxuICAgICAgcmVzb3VyY2VJdGVtSW5mby5vcmlnaW5hbFdpZHRoID0gd2lkdGhcbiAgICAgIHJlc291cmNlSXRlbUluZm8ub3JpZ2luYWxIZWlnaHQgPSBoZWlnaHRcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVzb3VyY2VJdGVtSW5mbylcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBnZXRCbG9iQnlCbG9iVXJsIChibG9iVXJsOiBzdHJpbmcpOiBQcm9taXNlPEJsb2I+IHtcbiAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KClcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYidcbiAgICAgIHhoci5vcGVuKCdHRVQnLCBibG9iVXJsLCB0cnVlKVxuICAgICAgeGhyLm9uZXJyb3IgPSByZWplY3RcbiAgICAgIHhoci5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWplY3QoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB4aHIuc2VuZCgpXG4gICAgfSlcbiAgfVxuXG4gIHN0YXRpYyBnZXRSZXNvdXJjZVByZWZpeCAoeyByZXNvdXJjZXNQcmVmaXgsIHdpZGdldElkLCB0eXBlIH0pOiBzdHJpbmcge1xuICAgIGlmIChyZXNvdXJjZXNQcmVmaXgpIHJldHVybiByZXNvdXJjZXNQcmVmaXhcblxuICAgIGNvbnN0IHJlc291cmNlc1ByZWZpeE1hcCA9IG5ldyBNYXAoW1xuICAgICAgW1Jlc291cmNlVHlwZS5Db25maWcsICdjb25maWcnXSxcbiAgICAgIFtSZXNvdXJjZVR5cGUuSW1hZ2UsIHdpZGdldElkID8gYGltYWdlcy8ke3dpZGdldElkfWAgOiAnaW1hZ2VzL3RlbXBsYXRlcyddXG4gICAgXSlcblxuICAgIHJldHVybiByZXNvdXJjZXNQcmVmaXhNYXAuZ2V0KHR5cGUpIHx8ICd0ZW1wbGF0ZXMnXG4gIH1cblxuICBwdWJsaWMgZ2V0UmVzb3VyY2VzSW5EcmFmdCA9ICgpOiBSZXNvdXJjZXMgPT4gdGhpcy5yZXNvdXJjZXNcblxuICBwdWJsaWMgc2V0UmVzb3VyY2VzSW5EcmFmdCA9IChyZXNvdXJjZXM6IFJlc291cmNlcyk6IHZvaWQgPT4ge1xuICAgIHRoaXMucmVzb3VyY2VzID0geyAuLi50aGlzLmdldFJlc291cmNlc0luRHJhZnQoKSwgLi4ucmVzb3VyY2VzIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGltYWdlIHJlc291cmNlIGxpc3QgZnJvbSB0aGUgZHJhZnQuIFRoZSBkcmFmdCByZXNvdXJjZXMgY29udGFpbnMgdGhlIHJlc291cmNlcyB0aGF0IGhhdmUgYmVlbiB1cGxvYWRlZCBvciBmZXRjaGVkIGZyb20gdGhlIHNlcnZlci5cbiAgICogSWYgdGhlIHJlc291cmNlIGlzIGFscmVhZHkgY2FjaGVkIGluIHRoZSBkcmFmdCwgcmV0dXJuIHRoZSBpbWFnZSByZXNvdXJjZXMgaW4gdGhlIGRyYWZ0LlxuICAgKiBJZiBub3QsIHdpbGwgZmV0Y2ggdGhlIGltYWdlIHJlc291cmNlcyBmcm9tIHRoZSBzZXJ2ZXIgYW5kIHJlcGxhY2UgYCR7YXBwUmVzb3VyY2VVcmx9YCB3aXRoIHBvcnRhbFVybCBhbmQgYWRkIHRva2VuLlxuICAgKi9cbiAgcHVibGljIGdldEltYWdlUmVzb3VyY2VMaXN0RnJvbURyYWZ0ID0gYXN5bmMgKGFwcElkOiBzdHJpbmcpOiBQcm9taXNlPEltYWdlUmVzb3VyY2VMaXN0PiA9PiB7XG4gICAgY29uc3QgcmVzb3VyY2VzSW5EcmFmdCA9IHRoaXMuZ2V0UmVzb3VyY2VzSW5EcmFmdCgpXG4gICAgaWYgKHJlc291cmNlc0luRHJhZnQuaW1hZ2VSZXNvdXJjZXMpIHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVzb3VyY2VzSW5EcmFmdC5pbWFnZVJlc291cmNlcylcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0U2Vzc2lvbigpXG4gICAgICBjb25zdCBwb3J0YWxVcmxXaXRoRnVsbCA9IHRoaXMuZ2V0UG9ydGFsVXJsV2l0aEZ1bGwoYXBwSWQpXG5cbiAgICAgIGNvbnN0IHsgcmVzb3VyY2VzIH0gPSBhd2FpdCB0aGlzLmZldGNoQXBwUmVzb3VyY2VJbmZvTGlzdChhcHBJZClcbiAgICAgIGNvbnN0IGlzRXhpc3RJbWFnZVJlc291cmNlc0xpc3RGaWxlOiBib29sZWFuID0gcmVzb3VyY2VzPy5zb21lKCh7IHJlc291cmNlIH0pID0+IHJlc291cmNlID09PSBBcHBSZXNvdXJjZUZpbGVQYXRoLkltYWdlKSB8fCBmYWxzZVxuXG4gICAgICBpZiAoaXNFeGlzdEltYWdlUmVzb3VyY2VzTGlzdEZpbGUpIHtcbiAgICAgICAgY29uc3QgaW1hZ2VSZXNvdXJjZUxpc3Q6IEltYWdlUmVzb3VyY2VMaXN0ID0gYXdhaXQgdGhpcy5mZXRjaEFwcFJlc291cmNlKGFwcElkLCB7IGZpbGVOYW1lOiBBcHBSZXNvdXJjZUZpbGVQYXRoLkltYWdlLCByZWFkQXM6ICdqc29uJyB9KSB8fCB7fVxuICAgICAgICBPYmplY3QudmFsdWVzKGltYWdlUmVzb3VyY2VMaXN0KS5mb3JFYWNoKHJlc291cmNlID0+IHtcbiAgICAgICAgICBpZiAocmVzb3VyY2UudXJsLmluY2x1ZGVzKCc/dG9rZW49JykpIHtcbiAgICAgICAgICAgIHJlc291cmNlLnVybCA9IHJlc291cmNlLnVybC5zbGljZSgwLCByZXNvdXJjZS51cmwuaW5kZXhPZignP3Rva2VuPScpKVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXNvdXJjZS51cmwgPSByZXNvdXJjZS51cmwucmVwbGFjZSgnJHthcHBSZXNvdXJjZVVybH0nLCBwb3J0YWxVcmxXaXRoRnVsbCkgKyAnP3Rva2VuPScgKyBzZXNzaW9uPy50b2tlblxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGltYWdlUmVzb3VyY2VMaXN0KVxuICAgICAgfVxuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudXBMb2FkSW1hZ2VSZXNvdXJjZUxpc3Qoe30pXG4gICAgfVxuICB9XG5cbiAgcHVibGljIGdldEljb25SZXNvdXJjZUxpc3RGcm9tRHJhZnQgPSBhc3luYyAoKTogUHJvbWlzZTxJY29uUmVzb3VyY2VMaXN0PiA9PiB7XG4gICAgY29uc3QgeyBpY29uUmVzb3VyY2VzIH0gPSB0aGlzLmdldFJlc291cmNlc0luRHJhZnQoKVxuXG4gICAgaWYgKGljb25SZXNvdXJjZXMpIHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoaWNvblJlc291cmNlcylcbiAgICB9XG5cbiAgICBjb25zdCBhcHBJZCA9IHRoaXMuZ2V0QXBwSWQoKVxuICAgIGNvbnN0IHNlc3Npb24gPSB0aGlzLmdldFNlc3Npb24oKVxuICAgIGNvbnN0IHBvcnRhbFVybFdpdGhGdWxsID0gdGhpcy5nZXRQb3J0YWxVcmxXaXRoRnVsbChhcHBJZClcbiAgICBjb25zdCB7IHJlc291cmNlcyB9ID0gYXdhaXQgdGhpcy5mZXRjaEFwcFJlc291cmNlSW5mb0xpc3QoYXBwSWQpXG5cbiAgICBjb25zdCBpc0V4aXN0SWNvblJlc291cmNlTGlzdEZpbGU6IGJvb2xlYW4gPSByZXNvdXJjZXM/LnNvbWUoKHsgcmVzb3VyY2UgfSkgPT4gcmVzb3VyY2UgPT09IEFwcFJlc291cmNlRmlsZVBhdGguSWNvbikgfHwgZmFsc2VcbiAgICBpZiAoaXNFeGlzdEljb25SZXNvdXJjZUxpc3RGaWxlKSB7XG4gICAgICBjb25zdCBpY29uUmVzb3VyY2VMaXN0OiBJY29uUmVzb3VyY2VMaXN0ID0gYXdhaXQgdGhpcy5mZXRjaEFwcFJlc291cmNlKGFwcElkLCB7IGZpbGVOYW1lOiBBcHBSZXNvdXJjZUZpbGVQYXRoLkljb24sIHJlYWRBczogJ2pzb24nIH0pXG5cbiAgICAgIGlmIChpY29uUmVzb3VyY2VMaXN0KSB7XG4gICAgICAgIE9iamVjdC52YWx1ZXMoaWNvblJlc291cmNlTGlzdCkuZm9yRWFjaChyZXNvdXJjZSA9PiB7XG4gICAgICAgICAgcmVzb3VyY2Uuc3ZnID0gcmVzb3VyY2Uuc3ZnLnJlcGxhY2UoJyR7YXBwUmVzb3VyY2VVcmx9JywgcG9ydGFsVXJsV2l0aEZ1bGwpICsgJz90b2tlbj0nICsgc2Vzc2lvbj8udG9rZW5cbiAgICAgICAgICBpZiAodHlwZW9mIHJlc291cmNlLnByb3BlcnRpZXMucGF0aCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJlc291cmNlLnByb3BlcnRpZXMucGF0aCA9IHJlc291cmNlLnByb3BlcnRpZXMucGF0aC5yZXBsYWNlKCcke2FwcFJlc291cmNlVXJsfScsIHBvcnRhbFVybFdpdGhGdWxsKSArICc/dG9rZW49JyArIHNlc3Npb24/LnRva2VuXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoaWNvblJlc291cmNlTGlzdClcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYXdhaXQgdGhpcy51cExvYWRJY29uUmVzb3VyY2VMaXN0KHt9KVxuICB9XG5cbiAgLyoqXG4gICAqIEZpbHRlciBvdXQgdGhlIGltYWdlIHJlc291cmNlcyBiZWluZyB1c2VkIGJ5IHdpZGdldHMgb3IgY29tcG9uZW50cyBpbiB0aGUgYXBwIGZyb20gdGhlIGltYWdlIHJlc291cmNlIGxpc3QuXG4gICAqIEl0IGNoZWNrcyB0aGUgYXBwIGNvbmZpZyBmb3IgbWF0Y2hlcy4gQW5kIGl0IHdpbGwgcmVwbGFjZSB0aGUgbG9jYWwgaW1hZ2UgYmxvYiB1cmwgb3IgcG9ydGFsIHVybCB0byBgJHthcHBSZXNvdXJjZVVybH1gIHNvIHRoYXQgaXQgY2FuIGJlIG1hdGNoZWQuIFRoZSByZXN1bHQgd2lsbCBiZSBjYWNoZWQgaW50byBjb25maWdTb3VyY2VNYXAuXG4gICAqL1xuICBwdWJsaWMgZ2V0SW5Vc2VJbWFnZVJlc291cmNlcyA9IChpbWFnZVJlc291cmNlTGlzdDogSW1hZ2VSZXNvdXJjZUxpc3QpOiBJbWFnZVJlc291cmNlSXRlbUluZm9bXSA9PiB7XG4gICAgY29uc3QgYXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBDb25maWdcblxuICAgIC8vIE1vZGlmeSB0aGUgdXJsIGluIGFwcENvbmZpZyB0byAke2FwcFJlc291cmNlVXJsfS8uLi5cbiAgICBsZXQgY2xlYW5BcHBDb25maWcgPSBnZXRDbGVhbkFwcENvbmZpZyhhcHBDb25maWcpXG5cbiAgICAvLyBSZXBsYWNlIGxvY2FsIGltYWdlIGJsb2IgdXJsIHRvICR7YXBwUmVzb3VyY2VVcmx9Ly4uLiBpbiBhcHBDb25maWcuXG4gICAgY2xlYW5BcHBDb25maWcgPSB1dGlscy5yZXBsYWNlU3RyaW5nSW5PYmplY3QoeyAuLi5jbGVhbkFwcENvbmZpZyB9LCB7XG4gICAgICBtYXRjaGVyOiAodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4gPT4gL15ibG9iOlxcaHR0cChzPyk6XFwvXFwvKC4pLy50ZXN0KHZhbHVlKSxcbiAgICAgIGhhbmRsZXI6ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHRoaXMuYmxvYlRvUmVzb3VyY2VNYXBbdmFsdWVdPy5yZXNvdXJjZVVybCB8fCB2YWx1ZVxuICAgIH0pXG5cbiAgICAvLyBNYXRjaGVyICR7YXBwUmVzb3VyY2VVcmx9Ly4uLiBmcm9tIGFwcENvbmZpZywgYW5kIGNhY2hlIGludG8gY29uZmlnU291cmNlTWFwLlxuICAgIGNvbnN0IGNvbmZpZ1NvdXJjZU1hcCA9IHt9XG4gICAgdXRpbHMucmVwbGFjZVN0cmluZ0luT2JqZWN0KHsgLi4uY2xlYW5BcHBDb25maWcgfSwge1xuICAgICAgbWF0Y2hlcjogKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuID0+IC9eXFwkXFx7YXBwUmVzb3VyY2VVcmxcXH0rKC4pLy50ZXN0KHZhbHVlKSxcbiAgICAgIGhhbmRsZXI6ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IChjb25maWdTb3VyY2VNYXBbdmFsdWVdID0gdmFsdWUpXG4gICAgfSlcblxuICAgIC8vIEZpbHRlciByZWxhdGVkIGltYWdlIHJlc291cmNlcyBpbiBkcmFmdC5cbiAgICBjb25zdCByZWxhdGVkSW1hZ2VSZXNvdXJjZXMgPSBbXVxuICAgIE9iamVjdC52YWx1ZXMoaW1hZ2VSZXNvdXJjZUxpc3QpLmZvckVhY2goKGltYWdlUmVzb3VyY2UpID0+IHtcbiAgICAgIGNvbnN0IHJlc291cmNlVXJsID0gYFxcJHthcHBSZXNvdXJjZVVybH0vJHtpbWFnZVJlc291cmNlLnJlc291cmNlc1ByZWZpeH0vJHtpbWFnZVJlc291cmNlLmZpbGVOYW1lfWBcbiAgICAgIGNvbmZpZ1NvdXJjZU1hcFtyZXNvdXJjZVVybF0gJiYgcmVsYXRlZEltYWdlUmVzb3VyY2VzLnB1c2goaW1hZ2VSZXNvdXJjZSlcbiAgICB9KVxuXG4gICAgY29uc3QgaW1hZ2VSZXNvdXJjZXNJblVzZSA9IHRoaXMuZm9ybWF0UmVsYXRlZEltYWdlUmVzb3VyY2VzKGltYWdlUmVzb3VyY2VMaXN0LCByZWxhdGVkSW1hZ2VSZXNvdXJjZXMpXG4gICAgcmV0dXJuIGltYWdlUmVzb3VyY2VzSW5Vc2VcbiAgfVxuXG4gIHB1YmxpYyBnZXRJblVzZUljb25SZXNvdXJjZXMgPSAoaWNvblJlc291cmNlTGlzdDogSWNvblJlc291cmNlTGlzdCk6IEljb25SZXN1bHRbXSA9PiB7XG4gICAgY29uc3QgYXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBDb25maWdcblxuICAgIC8vIE1vZGlmeSB0aGUgdXJsIGluIGFwcENvbmZpZyB0byAke2FwcFJlc291cmNlVXJsfS8uLi5cbiAgICBsZXQgY2xlYW5BcHBDb25maWcgPSBnZXRDbGVhbkFwcENvbmZpZyhhcHBDb25maWcpXG5cbiAgICAvLyBSZXBsYWNlIGxvY2FsIGltYWdlIGJsb2IgdXJsIHRvICR7YXBwUmVzb3VyY2VVcmx9Ly4uLiBpbiBhcHBDb25maWcuXG4gICAgY2xlYW5BcHBDb25maWcgPSB1dGlscy5yZXBsYWNlU3RyaW5nSW5PYmplY3QoeyAuLi5jbGVhbkFwcENvbmZpZyB9LCB7XG4gICAgICBtYXRjaGVyOiAodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4gPT4gL15ibG9iOlxcaHR0cChzPyk6XFwvXFwvKC4pLy50ZXN0KHZhbHVlKSxcbiAgICAgIGhhbmRsZXI6ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHRoaXMuYmxvYlRvUmVzb3VyY2VNYXBbdmFsdWVdPy5yZXNvdXJjZVVybCB8fCB2YWx1ZVxuICAgIH0pXG5cbiAgICAvLyBNYXRjaGVyICR7YXBwUmVzb3VyY2VVcmx9Ly4uLiBmcm9tIGFwcENvbmZpZywgYW5kIGNhY2hlIGludG8gY29uZmlnU291cmNlTWFwLlxuICAgIGNvbnN0IGNvbmZpZ1NvdXJjZU1hcCA9IHt9XG4gICAgdXRpbHMucmVwbGFjZVN0cmluZ0luT2JqZWN0KHsgLi4uY2xlYW5BcHBDb25maWcgfSwge1xuICAgICAgbWF0Y2hlcjogKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuID0+IC9eXFwkXFx7YXBwUmVzb3VyY2VVcmxcXH0rKC4pLy50ZXN0KHZhbHVlKSxcbiAgICAgIGhhbmRsZXI6ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IChjb25maWdTb3VyY2VNYXBbdmFsdWVdID0gdmFsdWUpXG4gICAgfSlcblxuICAgIC8vIEZpbHRlciByZWxhdGVkIGljb24gcmVzb3VyY2VzIGluIGRyYWZ0LlxuICAgIGNvbnN0IGluVXNlSWNvblJlc291cmNlcyA9IFtdXG4gICAgT2JqZWN0LnZhbHVlcyhpY29uUmVzb3VyY2VMaXN0KS5mb3JFYWNoKChpY29uUmVzb3VyY2UpID0+IHtcbiAgICAgIGNvbnN0IHJlc291cmNlVXJsID0gYFxcJHthcHBSZXNvdXJjZVVybH0vaW1hZ2VzL2ljb25fcGlja2VyX2luX3NldHRpbmcvJHtpY29uUmVzb3VyY2UucHJvcGVydGllcy5maWxlbmFtZX1gXG4gICAgICBjb25maWdTb3VyY2VNYXBbcmVzb3VyY2VVcmxdICYmIGluVXNlSWNvblJlc291cmNlcy5wdXNoKGljb25SZXNvdXJjZSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIGluVXNlSWNvblJlc291cmNlc1xuICB9XG5cbiAgLyoqXG4gICAqIFVwbG9hZCBjb25maWcuanNvbiAoQXBwQ29uZmlnKSB0byB0aGUgYXBwIHJlc291cmNlcywgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgc2F2ZSBhcHAgYnV0dG9uIGlzIGNsaWNrZWQuXG4gICAqL1xuICBwdWJsaWMgdXBMb2FkQXBwQ29uZmlnID0gYXN5bmMgKGFwcElkOiBzdHJpbmcsIGNvbmZpZzogQXBwQ29uZmlnLCBvd25lcjogc3RyaW5nKTogUHJvbWlzZTxBcHBDb25maWc+ID0+IHtcbiAgICBjb25zdCBub0xvY2FsRmlsZUNvbmZpZyA9IGF3YWl0IHRoaXMudXBMb2FkTG9jYWxSZXNvdXJjZShjb25maWcpXG4gICAgY29uc3QgZmlsZTogQmxvYiA9IG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShub0xvY2FsRmlsZUNvbmZpZyldLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyB9KVxuICAgIGNvbnN0IHJlc291cmNlSXRlbUluZm86IFJlc291cmNlSXRlbUluZm8gPSB7XG4gICAgICBhcHBJZCxcbiAgICAgIGZpbGUsXG4gICAgICBmaWxlTmFtZTogJ2NvbmZpZy5qc29uJyxcbiAgICAgIHR5cGU6IFJlc291cmNlVHlwZS5Db25maWcsXG4gICAgICBvd25lclxuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCB0aGlzLnVwTG9hZEFwcFJlc291cmNlKHJlc291cmNlSXRlbUluZm8pXG4gICAgICAudGhlbihhc3luYyAoKSA9PiBhd2FpdCBQcm9taXNlLnJlc29sdmUoY29uZmlnKSlcbiAgICAgIC5jYXRjaChhc3luYyAoZXJyKSA9PiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnIpKVxuICB9XG5cbiAgLyoqXG4gICAqIFVwbG9hZCB0aGUgaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbiB0byBhcHAgcmVzb3VyY2VzIGxpc3QuXG4gICAqL1xuICBwdWJsaWMgdXBMb2FkSW1hZ2VSZXNvdXJjZUxpc3QgPSBhc3luYyAocmVzb3VyY2VMaXN0OiBJbWFnZVJlc291cmNlTGlzdCwgbmV3QXBwSWQ/OiBzdHJpbmcpOiBQcm9taXNlPEltYWdlUmVzb3VyY2VMaXN0PiA9PiB7XG4gICAgY29uc3QgcmVzb3VyY2VMaXN0VG9VcGxvYWQgPSB7IC4uLnJlc291cmNlTGlzdCB9XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMudXBMb2FkUmVzb3VyY2VMaXN0KEFwcFJlc291cmNlRmlsZVBhdGguSW1hZ2UsIHJlc291cmNlTGlzdFRvVXBsb2FkLCBuZXdBcHBJZClcbiAgfVxuXG4gIHB1YmxpYyB1cExvYWRJY29uUmVzb3VyY2VMaXN0ID0gYXN5bmMgKHJlc291cmNlTGlzdDogSWNvblJlc291cmNlTGlzdCwgbmV3QXBwSWQ/OiBzdHJpbmcpOiBQcm9taXNlPEljb25SZXNvdXJjZUxpc3Q+ID0+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy51cExvYWRSZXNvdXJjZUxpc3QoQXBwUmVzb3VyY2VGaWxlUGF0aC5JY29uLCByZXNvdXJjZUxpc3QsIG5ld0FwcElkKVxuICB9XG5cbiAgLyoqXG4gICAqIFVwbG9hZCBhIHJlc291cmNlIGZpbGUgdG8gdGhlIHNlcnZlciB2aWEgcmVzdCBhcGkuXG4gICAqIEl0IHdpbGwgY2hlY2sgaWYgdGhlIHJlc291cmNlIGFscmVhZHkgZXhpc3RzIG9uIHRoZSBzZXJ2ZXIuIElmIGl0IGRvZXMsIHdpbGwgdXBkYXRlIHRoZSByZXNvdXJjZS4gSWYgbm90LCB3aWxsIGFkZCB0aGUgcmVzb3VyY2UuXG4gICAqXG4gICAqIFRoZSByZXNvdXJjZSBmaWxlIGNhbiBiZSBhIGNvbmZpZy9jb25maWcuanNvbiwgaW1hZ2VzL2ltYWdlLXJlc291cmNlcy1saXN0Lmpzb24sIGltYWdlcy9pY29uLXJlc291cmNlcy1saXN0Lmpzb24sIGFuZCB0aGUgaW1hZ2UgaXRlbXMgbGlrZSBpbWFnZXMvd2lkZ2V0XzEvMTY4OTgxODEyOTY1MS5wbmdcbiAgICovXG4gIHB1YmxpYyB1cExvYWRBcHBSZXNvdXJjZSA9IGFzeW5jIChyZXNvdXJjZUl0ZW1JbmZvOiBSZXNvdXJjZUl0ZW1JbmZvKTogUHJvbWlzZTxhbnk+ID0+IHtcbiAgICByZXNvdXJjZUl0ZW1JbmZvLnJlc291cmNlc1ByZWZpeCA9IEFwcFJlc291cmNlTWFuYWdlci5nZXRSZXNvdXJjZVByZWZpeChyZXNvdXJjZUl0ZW1JbmZvIGFzIGFueSlcbiAgICBjb25zdCB7IGFwcElkID0gdGhpcy5nZXRBcHBJZCgpLCBmaWxlTmFtZSwgb3JpZ2luYWxOYW1lLCByZXNvdXJjZXNQcmVmaXggfSA9IHJlc291cmNlSXRlbUluZm9cbiAgICBjb25zdCByZXNvdXJjZVBhdGggPSAocmVzb3VyY2VzUHJlZml4ID8gcmVzb3VyY2VzUHJlZml4ICsgJy8nIDogJycpICsgZmlsZU5hbWVcbiAgICBjb25zdCByZXNvdXJjZVVybCA9ICcke2FwcFJlc291cmNlVXJsfS8nICsgcmVzb3VyY2VQYXRoXG4gICAgY29uc3QgcmVzb3VyY2VLZXkgPSB1dWlkdjEoKVxuXG4gICAgY29uc3QgcmVzb3VyY2VJbmZvSW5CdWlsZGVyOiBSZXNvdXJjZUl0ZW1JbmZvID0ge1xuICAgICAgaWQ6IHJlc291cmNlS2V5LFxuICAgICAgYXBwSWQ6IGFwcElkLFxuICAgICAgZmlsZU5hbWU6IGZpbGVOYW1lLFxuICAgICAgb3JpZ2luYWxOYW1lOiBvcmlnaW5hbE5hbWUsXG4gICAgICByZXNvdXJjZXNQcmVmaXg6IHJlc291cmNlc1ByZWZpeCxcbiAgICAgIHVybDogcmVzb3VyY2VJdGVtSW5mby51cmwsXG4gICAgICBibG9iVXJsOiByZXNvdXJjZUl0ZW1JbmZvLmJsb2JVcmwsXG4gICAgICByZXNvdXJjZVVybDogcmVzb3VyY2VVcmwsXG4gICAgICB0eXBlOiByZXNvdXJjZUl0ZW1JbmZvLnR5cGUsXG4gICAgICBzdGF0dXM6IEFqYXhTdGF0ZS5GZXRjaGluZyxcbiAgICAgIHdpZGdldElkOiByZXNvdXJjZUl0ZW1JbmZvLndpZGdldElkLFxuICAgICAgb3duZXI6IHJlc291cmNlSXRlbUluZm8ub3duZXJcbiAgICB9XG5cbiAgICBjb25zdCB0ZW1wUmVzb3VyY2VJbmZvRm9yVXBsb2FkID0gT2JqZWN0LmFzc2lnbih7fSwgcmVzb3VyY2VJbmZvSW5CdWlsZGVyKVxuICAgIHRlbXBSZXNvdXJjZUluZm9Gb3JVcGxvYWQuZmlsZSA9IHJlc291cmNlSXRlbUluZm8uZmlsZVxuXG4gICAgY29uc3QgcmVzb3VyY2VQcm9taXNlID0gdGhpcy5mZXRjaEFwcFJlc291cmNlSW5mb0xpc3QoYXBwSWQpXG4gICAgICAudGhlbihhc3luYyAoeyByZXNvdXJjZXMgfSkgPT4ge1xuICAgICAgICBpZiAocmVzb3VyY2VzPy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hZGRBcHBSZXNvdXJjZSh0ZW1wUmVzb3VyY2VJbmZvRm9yVXBsb2FkKVxuICAgICAgICB9IGVsc2UgaWYgKHJlc291cmNlcz8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiByZXNvdXJjZXMuc29tZSgoeyByZXNvdXJjZSB9KSA9PiByZXNvdXJjZSA9PT0gcmVzb3VyY2VQYXRoKVxuICAgICAgICAgICAgPyBhd2FpdCB0aGlzLnVwZGF0ZUFwcFJlc291cmNlKHRlbXBSZXNvdXJjZUluZm9Gb3JVcGxvYWQpXG4gICAgICAgICAgICA6IGF3YWl0IHRoaXMuYWRkQXBwUmVzb3VyY2UodGVtcFJlc291cmNlSW5mb0ZvclVwbG9hZClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3JldHVybiB2YWx1ZSBmcm9tIGZldGNoQXBwUmVzb3VyY2VJbmZvTGlzdCBpcyBub3QgcmlnaHQnKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGFzeW5jIGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcilcbiAgICAgICAgdGhpcy5zZXRSZXNvdXJjZUl0ZW1JbmZvU3RhdHVzKHRlbXBSZXNvdXJjZUluZm9Gb3JVcGxvYWQsIEFqYXhTdGF0ZS5FcnJvcilcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgICAgfSlcblxuICAgIHRlbXBSZXNvdXJjZUluZm9Gb3JVcGxvYWQucHJvbWlzZSA9IHJlc291cmNlUHJvbWlzZVxuICAgIHRoaXMuc2V0UmVzb3VyY2VNYXAocmVzb3VyY2VLZXksIHJlc291cmNlSW5mb0luQnVpbGRlcilcbiAgICByZXR1cm4gYXdhaXQgcmVzb3VyY2VQcm9taXNlXG4gIH1cblxuICAvKipcbiAgICogVXBsb2FkIHRoZSBsb2NhbCBibG9iIHJlc291cmNlcy4gSXQgd2lsbCByZXBsYWNlcyB0aGUgYmxvYlVybCB3aXRoIHJlc291cmNlIHVybCAnJHthcHBSZXNvdXJjZX0vLi4uJyBpbiB0aGUgY29uZmlnLlxuICAgKiBUaGlzIGhlbHBzIHBlcnNpc3QgbG9jYWwgZHJhZnQgcmVzb3VyY2VzIHRvIHRoZSBzZXJ2ZXIuXG4gICAqL1xuICBwdWJsaWMgdXBMb2FkTG9jYWxSZXNvdXJjZSA9IGFzeW5jIChjb25maWc6IGFueSk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgY29uc3QgYmxvYlRvUmVzb3VyY2VNYXAgPSB0aGlzLmJsb2JUb1Jlc291cmNlTWFwXG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICBjb25zdCBpc0Jsb2JDYWNoZVJlc291cmNlRXhwID0gbmV3IFJlZ0V4cCgnXmJsb2I6XFxodHRwKHM/KTovLyguKScpXG4gICAgLy8gdGhlIGxvY2FsUmVzb3VyY2VzSW5Db25maWcgdmFyaWFibGUgaXMgdXNlZCBmb3IgY2hlY2sgcmVzb3VyY2Ugc3RhdHVzIGluIGNvbmZpZ1xuICAgIGNvbnN0IGxvY2FsUmVzb3VyY2VzSW5Db25maWc6IHN0cmluZ1tdID0gW11cblxuICAgIGZ1bmN0aW9uIGlzTmVlZFVwZGF0ZVJlc291cmNlICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGlzQmxvYkNhY2hlUmVzb3VyY2VFeHAudGVzdCh2YWx1ZSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVSZXNvdXJjZVVybCAodmFsdWUpOiBhbnkge1xuICAgICAgbGV0IG5ld1ZhbHVlID0gdmFsdWVcbiAgICAgIG5ld1ZhbHVlID0gYmxvYlRvUmVzb3VyY2VNYXBbdmFsdWVdXG4gICAgICAhbG9jYWxSZXNvdXJjZXNJbkNvbmZpZy5pbmNsdWRlcyhuZXdWYWx1ZS5pZCkgJiYgbG9jYWxSZXNvdXJjZXNJbkNvbmZpZy5wdXNoKG5ld1ZhbHVlLmlkKVxuICAgICAgcmV0dXJuIG5ld1ZhbHVlLnJlc291cmNlVXJsXG4gICAgfVxuXG4gICAgY29uc3QgcmVwbGFjZU9wZXJhdG9yID0ge1xuICAgICAgbWF0Y2hlcjogaXNOZWVkVXBkYXRlUmVzb3VyY2UsXG4gICAgICBoYW5kbGVyOiB1cGRhdGVSZXNvdXJjZVVybFxuICAgIH1cblxuICAgIGNvbnN0IGFwcENvbmZpZyA9IHV0aWxzLnJlcGxhY2VTdHJpbmdJbk9iamVjdChjb25maWcsIHJlcGxhY2VPcGVyYXRvcilcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5jaGVja1Jlc291cmNlc1VwbG9hZFN0YXR1cyhsb2NhbFJlc291cmNlc0luQ29uZmlnKS50aGVuKGFzeW5jIHJlc291cmNlVXBsb2FkU3RhdHVzID0+IHtcbiAgICAgIGlmIChyZXNvdXJjZVVwbG9hZFN0YXR1cyA9PT0gQWpheFN0YXRlLlN1Y2Nlc3MpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShhcHBDb25maWcpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogRmV0Y2ggYXBwIHJlc291cmNlIGxpc3QgZGF0YSBmcm9tIGFyY2dpcyByZXN0IGFwaS5cbiAgICogVGhlIGxpc3QgaW5jbHVkZXMgdGhlIGZpbGVzIG9mIGNvbmZpZy5qc29uLCBpbWFnZS1yZXNvdXJjZXMtbGlzdC5qc29uLCBpY29uLXJlc291cmNlcy1saXN0Lmpzb24sIGFuZCBpbWFnZSBpdGVtcyBpbmNsdWRpbmcgdGhlIGltYWdlcyB0aGF0IGp1c3QgdXBsb2FkZWQgd2l0aG91dCBzYXZlZC5cbiAgICovXG4gIHB1YmxpYyBmZXRjaEFwcFJlc291cmNlSW5mb0xpc3QgPSBhc3luYyAoYXBwSWQ6IHN0cmluZywgb3B0aW9uPzogSVJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxBcHBSZXNvdXJjZUluZm9MaXN0PiA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0U2Vzc2lvbigpXG4gICAgcmV0dXJuIGF3YWl0IGdldEl0ZW1SZXNvdXJjZXMoeyBpZDogYXBwSWQsIGlzTG9jYWxBcHA6IHdpbmRvdy5qaW11Q29uZmlnLmlzRGV2RWRpdGlvbiB9IGFzIEFwcEluZm8sIHsgYXV0aGVudGljYXRpb246IHNlc3Npb24sIC4uLm9wdGlvbiB9KVxuICAgICAgLmNhdGNoKGFzeW5jIGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycilcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycilcbiAgICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogRmV0Y2ggYXBwIHJlc291cmNlIGl0ZW0gZGF0YSBmcm9tIGFyY2dpcyByZXN0IGFwaS4gTGlrZSBpbWFnZS1yZXNvdXJjZXMtbGlzdC5qc29uLlxuICAgKlxuICAgKiBOb3RlOiBpbWFnZS1yZXNvdXJjZXMtbGlzdC5qc29uIG9ubHkgaW5jbHVkZXMgdGhlIGltYWdlcyB0aGF0IGhhdmUgYmVlbiBzYXZlZC4gQmVjYXVzZSBvbmx5IGNhbGwgYXBwUmVzb3VyY2VNYW5hZ2VySW5zdGFuY2UudXBMb2FkSW1hZ2VSZXNvdXJjZUxpc3QoY2xvbmVPYmooaW1hZ2VSZXNvdXJjZXMpKSBhZnRlciB1cExvYWRBcHBDb25maWcgUHJvbWlzZSBpbiBzYXZlQXBwKCkgZnVuY3Rpb24gaW4gamltdS1mb3ItYnVpbGRlclxcbGliXFxzZXJ2aWNlXFxhcHAtc2VydmljZVxcaW5kZXgudHMuXG4gICAqL1xuICBwdWJsaWMgZmV0Y2hBcHBSZXNvdXJjZSA9IGFzeW5jIChhcHBJZDogc3RyaW5nLCBvcHRpb24/OiBJR2V0SXRlbVJlc291cmNlT3B0aW9ucyk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0U2Vzc2lvbigpXG4gICAgcmV0dXJuIGF3YWl0IGdldEl0ZW1SZXNvdXJjZSh7IGlkOiBhcHBJZCwgaXNMb2NhbEFwcDogd2luZG93LmppbXVDb25maWcuaXNEZXZFZGl0aW9uIH0gYXMgQXBwSW5mbywgeyBhdXRoZW50aWNhdGlvbjogc2Vzc2lvbiwgLi4ub3B0aW9uIH0pXG4gICAgICAuY2F0Y2goYXN5bmMgZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QobnVsbClcbiAgICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgb3V0IHVudXNlZCByZXNvdXJjZXMgZnJvbSB0aGUgYXBwLlxuICAgKiBJdCB3aWxsIGNsZWFuIHJlc291cmNlTWFwIGFuZCBibG9iVG9SZXNvdXJjZU1hcCBhbmQgcmVsZWFzZSB0aGUgYmxvYiB1cmwgY2FjaGVkIGluIG1lbW9yeS5cbiAgICogSXQgd2lsbCBhbHNvIHJlbW92ZSB0aGUgdW5zYXZlZCByZXNvdXJjZXMuXG4gICAqIEBwYXJhbSBhcHBJZFxuICAgKi9cbiAgcHVibGljIGNsZWFyUmVzb3VyY2VzID0gKGFwcElkOiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgICAvLyBDbGVhciByZXNvdXJjZU1hcCBhbmQgYmxvYlRvUmVzb3VyY2VNYXAuXG4gICAgdGhpcy5jbGVhclJlc291cmNlTWFwKClcbiAgICAvLyBDbGVhciByZXNvdXJjZXMgd2l0aG91dCBzYXZlZC5cbiAgICB0aGlzLmNsZWFyUmVzb3VyY2VzV2l0aG91dFNhdmVkKGFwcElkKVxuICAgIC8vIERpc3BhdGNoIGNsZWFyUmVzb3VyY2VzIGFjdGlvbi5cbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGJ1aWxkZXJTdGF0ZVJlc291cmNlQWN0aW9ucy5DbGVhclJlc291cmNlcygpKVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgaW1hZ2UgcmVzb3VyY2UgaXRlbSBpbmZvLlxuICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGltYWdlIHJlc291cmNlIGl0ZW0gaXMgdXBkYXRlZCwgbGlrZSBhZnRlciBjcm9wcGluZyBpbWFnZS5cbiAgICovXG4gIHB1YmxpYyB1cGRhdGVJbWFnZVJlc291cmNlSXRlbUluZm8gPSAoaW1hZ2VSZXNvdXJjZUl0ZW1JbmZvOiBJbWFnZVJlc291cmNlSXRlbUluZm8pOiB2b2lkID0+IHtcbiAgICBjb25zdCBhcHBJZCA9IHRoaXMuZ2V0QXBwSWQoKVxuICAgIHRoaXMuZ2V0SW1hZ2VSZXNvdXJjZUxpc3RGcm9tRHJhZnQoYXBwSWQpLnRoZW4oKGltYWdlUmVzb3VyY2VMaXN0OiBJbWFnZVJlc291cmNlTGlzdCkgPT4ge1xuICAgICAgY29uc3QgdGVtcEltYWdlUmVzb3VyY2VJdGVtSW5mbyA9IE9iamVjdC5hc3NpZ24oe30sIGltYWdlUmVzb3VyY2VJdGVtSW5mbylcbiAgICAgIGRlbGV0ZSB0ZW1wSW1hZ2VSZXNvdXJjZUl0ZW1JbmZvLmJsb2JVcmxcbiAgICAgIGRlbGV0ZSB0ZW1wSW1hZ2VSZXNvdXJjZUl0ZW1JbmZvLnR5cGVcblxuICAgICAgaW1hZ2VSZXNvdXJjZUxpc3RbdGVtcEltYWdlUmVzb3VyY2VJdGVtSW5mby5maWxlTmFtZS5zcGxpdCgnLicpWzBdXSA9IHRlbXBJbWFnZVJlc291cmNlSXRlbUluZm9cbiAgICAgIHRoaXMuc2V0UmVzb3VyY2VzSW5EcmFmdCh7IGltYWdlUmVzb3VyY2VzOiBpbWFnZVJlc291cmNlTGlzdCB9KVxuICAgIH0pXG4gIH1cblxuICAvLyBBZGQgcmVzb3VyY2UgaXRlbSBkYXRhIGJ5IGFyY2dpcyByZXN0IGFwaS5cbiAgcHJpdmF0ZSBhc3luYyBhZGRBcHBSZXNvdXJjZSAocmVzb3VyY2VJdGVtSW5mbzogUmVzb3VyY2VJdGVtSW5mbyk6IFByb21pc2U8SUl0ZW1SZXNvdXJjZVJlc3BvbnNlPiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0U2Vzc2lvbigpXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QXBwSW5mbyh7IGlkOiByZXNvdXJjZUl0ZW1JbmZvLmFwcElkLCBpc0xvY2FsQXBwOiB3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24gfSBhcyBBcHBJbmZvKS50aGVuKGFzeW5jIHJlcyA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgYWRkSXRlbVJlc291cmNlKHtcbiAgICAgICAgaWQ6IHJlc291cmNlSXRlbUluZm8uYXBwSWQsXG4gICAgICAgIHJlc291cmNlOiByZXNvdXJjZUl0ZW1JbmZvLmZpbGUsXG4gICAgICAgIG5hbWU6IHJlc291cmNlSXRlbUluZm8uZmlsZU5hbWUsXG4gICAgICAgIG93bmVyOiByZXMub3duZXIsXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHJlc291cmNlc1ByZWZpeDogcmVzb3VyY2VJdGVtSW5mby5yZXNvdXJjZXNQcmVmaXhcbiAgICAgICAgfSxcbiAgICAgICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgICAgIH1cbiAgICAgICkudGhlbihhc3luYyByZXN1bHQgPT4ge1xuICAgICAgICB0aGlzLnNldFJlc291cmNlSXRlbUluZm9TdGF0dXMocmVzb3VyY2VJdGVtSW5mbywgQWpheFN0YXRlLlN1Y2Nlc3MpXG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVzdWx0KVxuICAgICAgfSwgYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgICB0aGlzLnNldFJlc291cmNlSXRlbUluZm9TdGF0dXMocmVzb3VyY2VJdGVtSW5mbywgQWpheFN0YXRlLkVycm9yKVxuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoZXJyb3IpXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICAvLyBVcGRhdGUgcmVzb3VyY2UgaXRlbSBkYXRhIGJ5IGFyY2dpcyByZXN0IGFwaS5cbiAgcHJpdmF0ZSBhc3luYyB1cGRhdGVBcHBSZXNvdXJjZSAocmVzb3VyY2VJdGVtSW5mbzogUmVzb3VyY2VJdGVtSW5mbyk6IFByb21pc2U8SUl0ZW1SZXNvdXJjZVJlc3BvbnNlPiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0U2Vzc2lvbigpXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QXBwSW5mbyh7IGlkOiByZXNvdXJjZUl0ZW1JbmZvLmFwcElkLCBpc0xvY2FsQXBwOiB3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24gfSBhcyBBcHBJbmZvKS50aGVuKGFzeW5jIHJlcyA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgdXBkYXRlSXRlbVJlc291cmNlKHtcbiAgICAgICAgaWQ6IHJlc291cmNlSXRlbUluZm8uYXBwSWQsXG4gICAgICAgIHJlc291cmNlOiByZXNvdXJjZUl0ZW1JbmZvLmZpbGUsXG4gICAgICAgIG5hbWU6IHJlc291cmNlSXRlbUluZm8uZmlsZU5hbWUsXG4gICAgICAgIG93bmVyOiByZXMub3duZXIsXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHJlc291cmNlc1ByZWZpeDogcmVzb3VyY2VJdGVtSW5mby5yZXNvdXJjZXNQcmVmaXhcbiAgICAgICAgfSxcbiAgICAgICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgICAgIH1cbiAgICAgICkudGhlbihhc3luYyByZXN1bHQgPT4ge1xuICAgICAgICB0aGlzLnNldFJlc291cmNlSXRlbUluZm9TdGF0dXMocmVzb3VyY2VJdGVtSW5mbywgQWpheFN0YXRlLlN1Y2Nlc3MpXG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVzdWx0KVxuICAgICAgfSwgYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgICB0aGlzLnNldFJlc291cmNlSXRlbUluZm9TdGF0dXMocmVzb3VyY2VJdGVtSW5mbywgQWpheFN0YXRlLkVycm9yKVxuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoZXJyb3IpXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICAvLyBSZW1vdmUgcmVzb3VyY2UgaXRlbSBkYXRhIGJ5IGFyY2dpcyByZXN0IGFwaS5cbiAgcHJpdmF0ZSBhc3luYyByZW1vdmVBcHBSZXNvdXJjZSAocmVzb3VyY2VJdGVtSW5mbzogUmVzb3VyY2VJdGVtSW5mbyk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0U2Vzc2lvbigpXG4gICAgY29uc3QgYXBwSWQgPSByZXNvdXJjZUl0ZW1JbmZvLmFwcElkID8gcmVzb3VyY2VJdGVtSW5mby5hcHBJZCA6IHRoaXMuZ2V0QXBwSWQoKVxuICAgIHJldHVybiBhd2FpdCB0aGlzLmdldEFwcEluZm8oeyBpZDogYXBwSWQsIGlzTG9jYWxBcHA6IHdpbmRvdy5qaW11Q29uZmlnLmlzRGV2RWRpdGlvbiB9IGFzIEFwcEluZm8pLnRoZW4oYXN5bmMgcmVzID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCByZW1vdmVJdGVtUmVzb3VyY2Uoe1xuICAgICAgICBpZDogYXBwSWQsXG4gICAgICAgIG93bmVyOiByZXMub3duZXIsXG4gICAgICAgIHJlc291cmNlOiByZXNvdXJjZUl0ZW1JbmZvLmZpbGVOYW1lLFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgICAgfSkudGhlbihhc3luYyByZXN1bHQgPT4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdClcbiAgICAgIH0sIGFzeW5jIGVycm9yID0+IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRBcHBJZCAoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBJZFxuICB9XG5cbiAgcHJpdmF0ZSBnZXRTZXNzaW9uICgpOiBVc2VyU2Vzc2lvbiB7XG4gICAgcmV0dXJuIFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRQb3J0YWxVcmxXaXRoVGVtcGxhdGUgKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICcke2FwcFJlc291cmNlVXJsfS8nXG4gIH1cblxuICBwcml2YXRlIGdldFBvcnRhbFVybFdpdGhGdWxsIChhcHBJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZ2V0UmVzb3VyY2VPcmlnaW4oeyBpc0xvY2FsQXBwOiB3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24gfSBhcyBBcHBJbmZvKSArIGFwcElkICsgJy9yZXNvdXJjZXMnXG4gIH1cblxuICBwcml2YXRlIHNldFJlc291cmNlTWFwIChyZXNvdXJjZUtleTogc3RyaW5nLCByZXNvdXJjZUl0ZW1JbmZvOiBSZXNvdXJjZUl0ZW1JbmZvKTogdm9pZCB7XG4gICAgY29uc3QgeyBpZCwgcmVzb3VyY2VVcmwgfSA9IHJlc291cmNlSXRlbUluZm9cbiAgICB0aGlzLnJlc291cmNlTWFwW3Jlc291cmNlS2V5XSA9IHsgLi4udGhpcy5yZXNvdXJjZU1hcFtyZXNvdXJjZUtleV0sIC4uLnJlc291cmNlSXRlbUluZm8gfVxuICAgIHRoaXMuYmxvYlRvUmVzb3VyY2VNYXBbcmVzb3VyY2VJdGVtSW5mby5ibG9iVXJsXSA9IHsgaWQsIHJlc291cmNlVXJsIH1cblxuICAgIC8vIERpc3BhdGNoIGFkZFJlc291cmNlIGFjdGlvbi5cbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGJ1aWxkZXJTdGF0ZVJlc291cmNlQWN0aW9ucy5BZGRSZXNvdXJjZShyZXNvdXJjZUtleSwgdGhpcy5yZXNvdXJjZU1hcFtyZXNvdXJjZUtleV0pKVxuICB9XG5cbiAgcHJpdmF0ZSBzZXRSZXNvdXJjZUl0ZW1JbmZvU3RhdHVzIChyZXNvdXJjZUl0ZW1JbmZvOiBSZXNvdXJjZUl0ZW1JbmZvLCBzdGF0dXM6IEFqYXhTdGF0ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlc291cmNlTWFwICYmIHRoaXMucmVzb3VyY2VNYXBbcmVzb3VyY2VJdGVtSW5mby5pZF0pIHtcbiAgICAgIHJlc291cmNlSXRlbUluZm8uc3RhdHVzID0gc3RhdHVzXG4gICAgICBkZWxldGUgcmVzb3VyY2VJdGVtSW5mby5maWxlXG4gICAgICB0aGlzLnNldFJlc291cmNlTWFwKHJlc291cmNlSXRlbUluZm8uaWQsIHJlc291cmNlSXRlbUluZm8pXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBjbGVhclJlc291cmNlTWFwICgpOiB2b2lkIHtcbiAgICAvLyBSZWxlYXNlIHRoZSBibG9iVXJsIHdoaWNoIHdhcyBwcmV2aW91c2x5IGNyZWF0ZWQgYnkgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoKSwgdG8gbGV0IHRoZSBicm93c2VyIGtub3cgbm90IHRvIGtlZXAgdGhlIHJlZmVyZW5jZSB0byB0aGUgZmlsZSBhbnkgbG9uZ2VyLlxuICAgIGZvciAoY29uc3QgcmVzb3VyY2VLZXkgaW4gdGhpcy5yZXNvdXJjZU1hcCkge1xuICAgICAgdGhpcy5yZXNvdXJjZU1hcFtyZXNvdXJjZUtleV0gJiYgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5yZXNvdXJjZU1hcFtyZXNvdXJjZUtleV0uYmxvYlVybClcbiAgICB9XG5cbiAgICAvLyBDbGVhbiByZXNvdXJjZU1hcCBhbmQgYmxvYlRvUmVzb3VyY2VNYXAuXG4gICAgdGhpcy5yZXNvdXJjZU1hcCA9IHt9XG4gICAgdGhpcy5ibG9iVG9SZXNvdXJjZU1hcCA9IHt9XG4gIH1cblxuICAvKipcbiAgICogRmlsdGVyIG91dCB0aGUgcmVzb3VyY2VzIHRoYXQgaGF2ZSBiZWVuIHVwbG9hZGVkIHdpdGhvdXQgc2F2ZWQgZnJvbSB0aGUgJ3Jlc291cmNlVXJsTGlzdCcuIFJldHVybiB0aGUgcmVtYWluaW5nIHJlc291cmNlIGl0ZW1zLlxuICAgKiBUaGUgcmVzb3VyY2VVcmxMaXN0IGlzIHRoZSAnc2hvdWxkQ2xlYXJSZXNvdXJjZXMnIGxpc3Qgd2hpY2ggY29udGFpbnMgYWxsIHRoZSByZXNvdXJjZSBsaXN0ICh1cGxvYWQgKyBzYXZlZCkgYW5kIG5vdCBpbiB0aGUgY29uZmlnIGJlaW5nIHVzZWQuXG4gICAqIEBwYXJhbSBhcHBJZCBNYXkgYmUgbm90IGVxdWFsIHdpdGggY3VycmVudCBhcHAgaWQuXG4gICAqIEBwYXJhbSByZXNvdXJjZVVybExpc3QgRm9yIGV4YW1wbGU6IFtpbWFnZXMvd2lkZ2V0XzEvMTIzNDU2LmpwZywgLi4uXS4gSW5jbHVkZSByZXNvdXJjZSB1cmwgc3VjaCBhcyBpbWFnZXMgb3IgaWNvbnMuXG4gICAqIEByZXR1cm5zXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNsZWFyVmFsdWVXaXRob3V0SW5SZXNvdXJjZXNJbkRyYWZ0IChhcHBJZDogc3RyaW5nLCByZXNvdXJjZVVybExpc3Q6IHN0cmluZ1tdKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IGN1cnJlbnRBcHBJZCA9IHRoaXMuZ2V0QXBwSWQoKVxuXG4gICAgaWYgKGN1cnJlbnRBcHBJZCAhPT0gYXBwSWQpIHtcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMucmVzb3VyY2VzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIHRoaXMucmVzb3VyY2VzW2tleV0gPSBudWxsXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmIChyZXNvdXJjZVVybExpc3QubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgaW1hZ2VSZXNvdXJjZUxpc3Q6IEltYWdlUmVzb3VyY2VMaXN0ID0gYXdhaXQgdGhpcy5nZXRJbWFnZVJlc291cmNlTGlzdEZyb21EcmFmdChhcHBJZClcbiAgICAgIGNvbnN0IGljb25SZXNvdXJjZUxpc3Q6IEljb25SZXNvdXJjZUxpc3QgPSBhd2FpdCB0aGlzLmdldEljb25SZXNvdXJjZUxpc3RGcm9tRHJhZnQoKVxuICAgICAgY29uc3QgaW1hZ2VSZXNvdXJjZXNVcmxMaXN0OiBzdHJpbmdbXSA9IE9iamVjdC52YWx1ZXMoaW1hZ2VSZXNvdXJjZUxpc3QpXG4gICAgICAgIC5tYXAoKHsgcmVzb3VyY2VzUHJlZml4LCBmaWxlTmFtZSB9KSA9PiBgJHtyZXNvdXJjZXNQcmVmaXh9LyR7ZmlsZU5hbWV9YClcbiAgICAgIGNvbnN0IGljb25SZXNvdXJjZXNVcmxMaXN0OiBzdHJpbmdbXSA9IE9iamVjdC52YWx1ZXMoaWNvblJlc291cmNlTGlzdClcbiAgICAgICAgLm1hcCgoeyBwcm9wZXJ0aWVzOiB7IGZpbGVuYW1lIH0gfSkgPT4gYGltYWdlcy9pY29uX3BpY2tlcl9pbl9zZXR0aW5nLyR7ZmlsZW5hbWV9YClcblxuICAgICAgY29uc3QgcmVzb3VyY2VVcmxMaXN0SW5EcmFmdCA9IFsuLi5pbWFnZVJlc291cmNlc1VybExpc3QsIC4uLmljb25SZXNvdXJjZXNVcmxMaXN0XVxuICAgICAgY29uc3Qgc2hvdWxkQ2xlYW5SZXNvdXJjZVVybExpc3QgPSByZXNvdXJjZVVybExpc3QuZmlsdGVyKHJlc291cmNlID0+IHtcbiAgICAgICAgcmV0dXJuICFyZXNvdXJjZVVybExpc3RJbkRyYWZ0LmluY2x1ZGVzKHJlc291cmNlKVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShzaG91bGRDbGVhblJlc291cmNlVXJsTGlzdClcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShyZXNvdXJjZVVybExpc3QpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFyIHJlc291cmNlcyB0aGF0IGhhdmUgbm90IGJlZW4gc2F2ZWQgYXMgd2VsbCBhcyBub3QgaW4gdGhlIGNvbmZpZy5cbiAgICogQW55IHJlc291cmNlcyBvbiB0aGUgZHJhZnQgbm90IHJlZmVyZW5jZWQgb24gc2VydmVyIHJlc291cmNlIGxpc3Qgd2lsbCBiZSBkZWxldGVkLlxuICAgKiBAcGFyYW0gYXBwSWRcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY2xlYXJSZXNvdXJjZXNXaXRob3V0U2F2ZWQgKGFwcElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIWFwcElkKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcG9ydGFsVXJsV2l0aEZ1bGwgPSB0aGlzLmdldFBvcnRhbFVybFdpdGhGdWxsKGFwcElkKVxuICAgICAgY29uc3QgcG9ydGFsVXJsV2l0aFRlbXBsYXRlID0gdGhpcy5nZXRQb3J0YWxVcmxXaXRoVGVtcGxhdGUoKVxuXG4gICAgICBjb25zdCB7IHJlc291cmNlczogcG9ydGFsUmVzb3VyY2VzIH0gPSBhd2FpdCB0aGlzLmZldGNoQXBwUmVzb3VyY2VJbmZvTGlzdChhcHBJZCwgeyBodHRwTWV0aG9kOiAnR0VUJyB9KVxuICAgICAgY29uc3QgaXNFeGlzdENvbmZpZzogYm9vbGVhbiA9IHBvcnRhbFJlc291cmNlcz8uc29tZSgoeyByZXNvdXJjZSB9KSA9PiByZXNvdXJjZSA9PT0gQXBwUmVzb3VyY2VGaWxlUGF0aC5Db25maWcpIHx8IGZhbHNlXG4gICAgICBjb25zdCBhcHBDb25maWc6IEFwcENvbmZpZyA9IGlzRXhpc3RDb25maWdcbiAgICAgICAgPyBhd2FpdCB0aGlzLmZldGNoQXBwUmVzb3VyY2UoYXBwSWQsIHsgZmlsZU5hbWU6IEFwcFJlc291cmNlRmlsZVBhdGguQ29uZmlnLCByZWFkQXM6ICdqc29uJyB9KVxuICAgICAgICA6IHt9XG5cbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgY29uc3QgaXNQb3J0YWxVcmxXaXRoVGVtcGxhdGVFeHAgPSBuZXcgUmVnRXhwKCdeXFxcXCRcXFxce2FwcFJlc291cmNlVXJsXFxcXH0rKC4pJylcbiAgICAgIGNvbnN0IGlzUG9ydGFsVXJsV2l0aEZ1bGxFeHAgPSBuZXcgUmVnRXhwKCdeJyArIHBvcnRhbFVybFdpdGhGdWxsKVxuICAgICAgY29uc3QgcmVzb3VyY2VzTWFwID0ge31cbiAgICAgIHV0aWxzLnJlcGxhY2VTdHJpbmdJbk9iamVjdChhcHBDb25maWcsIHtcbiAgICAgICAgbWF0Y2hlcjogKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuID0+IChpc1BvcnRhbFVybFdpdGhUZW1wbGF0ZUV4cC50ZXN0KHZhbHVlKSB8fCBpc1BvcnRhbFVybFdpdGhGdWxsRXhwLnRlc3QodmFsdWUpKSxcbiAgICAgICAgaGFuZGxlcjogKHZhbHVlOiBzdHJpbmcpOiBzdHJpbmcgPT4gKHJlc291cmNlc01hcFt2YWx1ZV0gPSB2YWx1ZSlcbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IHNob3VsZENsZWFyUmVzb3VyY2VzOiBzdHJpbmdbXSA9IFtdXG4gICAgICBwb3J0YWxSZXNvdXJjZXM/LmZvckVhY2goKHsgcmVzb3VyY2UgfSkgPT4ge1xuICAgICAgICAvL05vdCBjb25maWcuanNvbiwgaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbiwgaWNvbi1yZXNvdXJjZXMtbGlzdC5qc29uIG5vciB0aGUgcmVzb3VyY2UgaXRlbSB0aGF0IGlzIGluIGFwcCBjb25maWcuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAhKHJlc291cmNlID09PSBBcHBSZXNvdXJjZUZpbGVQYXRoLkNvbmZpZykgJiZcbiAgICAgICAgICAhKHJlc291cmNlID09PSBBcHBSZXNvdXJjZUZpbGVQYXRoLkltYWdlKSAmJlxuICAgICAgICAgICEocmVzb3VyY2UgPT09IEFwcFJlc291cmNlRmlsZVBhdGguSWNvbikgJiZcbiAgICAgICAgICAhcmVzb3VyY2VzTWFwW3BvcnRhbFVybFdpdGhUZW1wbGF0ZSArIHJlc291cmNlLnJlcGxhY2UoJ19jb21wcmVzcycsICcnKV0gJiZcbiAgICAgICAgICAhcmVzb3VyY2VzTWFwW3BvcnRhbFVybFdpdGhGdWxsICsgcmVzb3VyY2UucmVwbGFjZSgnX2NvbXByZXNzJywgJycpXVxuICAgICAgICApIHtcbiAgICAgICAgICBzaG91bGRDbGVhclJlc291cmNlcy5wdXNoKHJlc291cmNlKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBjb25zdCBuZXdTaG91bGRDbGVhclJlc291cmNlczogc3RyaW5nW10gPSBhd2FpdCB0aGlzLmNsZWFyVmFsdWVXaXRob3V0SW5SZXNvdXJjZXNJbkRyYWZ0KGFwcElkLCBzaG91bGRDbGVhclJlc291cmNlcylcbiAgICAgIGNvbnN0IHByb21pc2VMaXN0ID0gbmV3U2hvdWxkQ2xlYXJSZXNvdXJjZXMubWFwKGZpbGVOYW1lID0+IHRoaXMucmVtb3ZlQXBwUmVzb3VyY2UoeyBhcHBJZCwgZmlsZU5hbWUgfSkpXG4gICAgICBQcm9taXNlLmFsbChwcm9taXNlTGlzdClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcilcbiAgICB9XG4gIH1cblxuICAvLyBGaWx0ZXIgb3V0IHRoZSBpbWFnZSBSZXNvdXJjZXMgYmVpbmcgdXNlZC5cbiAgcHJpdmF0ZSBmb3JtYXRSZWxhdGVkSW1hZ2VSZXNvdXJjZXMgKFxuICAgIGltYWdlUmVzb3VyY2VMaXN0OiBJbWFnZVJlc291cmNlTGlzdCxcbiAgICByZWxhdGVkSW1hZ2VSZXNvdXJjZUxpc3Q6IEltYWdlUmVzb3VyY2VJdGVtSW5mb1tdXG4gICk6IGFueSB7XG4gICAgY29uc3QgdGVtcE1hcDogSW1hZ2VSZXNvdXJjZUxpc3QgPSB7fVxuICAgIGNvbnN0IHJlbGF0ZWRJbWFnZVJlc291cmNlc0NvbmZpZyA9IHt9XG4gICAgY29uc3QgcmVzb3VyY2VJZHNJbkFwcENvbmZpZyA9IFtdXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbGF0ZWRJbWFnZVJlc291cmNlTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgcmVzb3VyY2VJZCA9IHJlbGF0ZWRJbWFnZVJlc291cmNlTGlzdFtpXS5maWxlTmFtZS5zcGxpdCgnLicpWzBdXG4gICAgICByZXNvdXJjZUlkc0luQXBwQ29uZmlnLnB1c2gocmVzb3VyY2VJZClcbiAgICB9XG5cbiAgICBPYmplY3Qua2V5cyhpbWFnZVJlc291cmNlTGlzdCkuZm9yRWFjaChpZCA9PiB7XG4gICAgICBpbWFnZVJlc291cmNlTGlzdFtpZF0ucmVmZXJlZElkcyA9IFtdXG4gICAgICBjb25zdCBvcmlnaW5JZCA9IGltYWdlUmVzb3VyY2VMaXN0W2lkXS5vcmlnaW5JZFxuICAgICAgaWYgKHJlc291cmNlSWRzSW5BcHBDb25maWcuaW5jbHVkZXMob3JpZ2luSWQpIHx8IHJlc291cmNlSWRzSW5BcHBDb25maWcuaW5jbHVkZXMoaWQpKSB7XG4gICAgICAgIHJlbGF0ZWRJbWFnZVJlc291cmNlc0NvbmZpZ1tpZF0gPSBpbWFnZVJlc291cmNlTGlzdFtpZF1cbiAgICAgICAgcmVsYXRlZEltYWdlUmVzb3VyY2VzQ29uZmlnW29yaWdpbklkXSA9IGltYWdlUmVzb3VyY2VMaXN0W29yaWdpbklkXVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBPYmplY3Qua2V5cyhyZWxhdGVkSW1hZ2VSZXNvdXJjZXNDb25maWcpLmZvckVhY2goaWQgPT4ge1xuICAgICAgcmVsYXRlZEltYWdlUmVzb3VyY2VzQ29uZmlnW2lkXS5yZWZlcmVkSWRzID0gW11cbiAgICAgIGNvbnN0IG9yaWdpbklkID0gcmVsYXRlZEltYWdlUmVzb3VyY2VzQ29uZmlnW2lkXS5vcmlnaW5JZFxuICAgICAgaWYgKG9yaWdpbklkICE9PSBpZCkge1xuICAgICAgICBpZiAoIXRlbXBNYXBbb3JpZ2luSWRdKSB7XG4gICAgICAgICAgdGVtcE1hcFtvcmlnaW5JZF0gPSB7IC4uLnJlbGF0ZWRJbWFnZVJlc291cmNlc0NvbmZpZ1tvcmlnaW5JZF0gfVxuICAgICAgICAgIHRlbXBNYXBbb3JpZ2luSWRdLnJlZmVyZWRJZHMgPSBbaWRdXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGVtcE1hcFtvcmlnaW5JZF0ucmVmZXJlZElkcy5wdXNoKGlkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcblxuICAgIE9iamVjdC5rZXlzKHRlbXBNYXApLmZvckVhY2goaWQgPT4ge1xuICAgICAgaWYgKHJlbGF0ZWRJbWFnZVJlc291cmNlc0NvbmZpZ1tpZF0pIHtcbiAgICAgICAgcmVsYXRlZEltYWdlUmVzb3VyY2VzQ29uZmlnW2lkXS5yZWZlcmVkSWRzID0gdGVtcE1hcFtpZF0ucmVmZXJlZElkc1xuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gcmVsYXRlZEltYWdlUmVzb3VyY2VzQ29uZmlnXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNoZWNrUmVzb3VyY2VzVXBsb2FkU3RhdHVzIChjaGVja1Jlc291cmNlczogc3RyaW5nW10pOiBQcm9taXNlPEFqYXhTdGF0ZT4ge1xuICAgIGlmIChjaGVja1Jlc291cmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBjaGVja1Jlc291cmNlc1Byb21pc2VBcnI6IEFycmF5PFByb21pc2U8YW55Pj4gPSBjaGVja1Jlc291cmNlcy5tYXAoY2hlY2tSZXNvdXJjZSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc291cmNlTWFwW2NoZWNrUmVzb3VyY2VdLnByb21pc2VcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChjaGVja1Jlc291cmNlc1Byb21pc2VBcnIpLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKEFqYXhTdGF0ZS5TdWNjZXNzKVxuICAgICAgfSwgYXN5bmMgKCkgPT4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKEFqYXhTdGF0ZS5FcnJvcilcbiAgICAgIH0pLmNhdGNoKGFzeW5jIGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcilcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KClcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoQWpheFN0YXRlLlN1Y2Nlc3MpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwbG9hZCBpbWFnZSByZXNvdXJjZXMgbGlzdCAoaW1hZ2VzL2ltYWdlLXJlc291cmNlcy1saXN0Lmpzb24pIG9yIGljb24gcmVzb3VyY2VzIGxpc3QgKGltYWdlcy9pY29uLXJlc291cmNlcy1saXN0Lmpzb24pLlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyB1cExvYWRSZXNvdXJjZUxpc3QgKFxuICAgIGFwcFJlc291cmNlRmlsZVBhdGg6IEFwcFJlc291cmNlRmlsZVBhdGgsXG4gICAgcmVzb3VyY2VMaXN0OiBJbWFnZVJlc291cmNlTGlzdCB8IEljb25SZXNvdXJjZUxpc3QgPSB7fSxcbiAgICBuZXdBcHBJZD86IHN0cmluZ1xuICApOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IGFwcElkOiBzdHJpbmcgPSBuZXdBcHBJZCB8fCB0aGlzLmdldEFwcElkKClcbiAgICBjb25zdCBub0xvY2FsRmlsZUljb25SZXNvdXJjZUxpc3QgPSBhd2FpdCB0aGlzLnVwTG9hZExvY2FsUmVzb3VyY2UocmVzb3VyY2VMaXN0KVxuICAgIGNvbnN0IGNsZWFuZWRQb3J0YWxSZXNvdXJjZUxpc3QgPSBhcHBDb25maWdVdGlscy5jbGVhblBvcnRhbEluZm9Gcm9tUmVzb3VyY2Uobm9Mb2NhbEZpbGVJY29uUmVzb3VyY2VMaXN0KVxuICAgIGNvbnN0IGZpbGU6IEJsb2IgPSBuZXcgQmxvYihbSlNPTi5zdHJpbmdpZnkoY2xlYW5lZFBvcnRhbFJlc291cmNlTGlzdCldLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyB9KVxuICAgIGNvbnN0IFtyZXNvdXJjZXNQcmVmaXgsIGZpbGVOYW1lXSA9IGFwcFJlc291cmNlRmlsZVBhdGguc3BsaXQoJy8nKVxuXG4gICAgY29uc3QgcmVzb3VyY2VJdGVtSW5mbzogUmVzb3VyY2VJdGVtSW5mbyA9IHtcbiAgICAgIGFwcElkLFxuICAgICAgZmlsZSxcbiAgICAgIHJlc291cmNlc1ByZWZpeCxcbiAgICAgIGZpbGVOYW1lLFxuICAgICAgdHlwZTogUmVzb3VyY2VUeXBlLkltYWdlXG4gICAgfVxuXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMudXBMb2FkQXBwUmVzb3VyY2UocmVzb3VyY2VJdGVtSW5mbylcbiAgICAgIC50aGVuKGFzeW5jICgpID0+IGF3YWl0IFByb21pc2UucmVzb2x2ZShjbGVhbmVkUG9ydGFsUmVzb3VyY2VMaXN0KSlcbiAgICAgIC5jYXRjaChhc3luYyAoZXJyKSA9PiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnIpKVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRBcHBJbmZvIChcbiAgICBhcHBJbmZvOiBBcHBJbmZvXG4gICk6IFByb21pc2U8QXBwSW5mbz4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uKGFwcEluZm8pXG4gICAgcmV0dXJuIGF3YWl0IGdldEl0ZW0oXG4gICAgICBhcHBJbmZvLFxuICAgICAge1xuICAgICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgICAgfVxuICAgICkudGhlbihhc3luYyByZXN1bHQgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShyZXN1bHQpXG4gICAgfSlcbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJTVN0YXRlLCBsb2Rhc2gsIHR5cGUgZXh0ZW5zaW9uU3BlYywgdHlwZSBJTUhpc3RvcnlTdGF0ZSB9IGZyb20gJ2ppbXUtY29yZSdcblxuaW1wb3J0IHsgcHVibGlzaEFwcENvbmZpZ0NoYW5nZVRvQXBwLCBwdWJsaXNoQXBwSW5mb0NoYW5nZVRvQXBwIH0gZnJvbSAnLi9idWlsZGVyLWFwcC1zeW5jJ1xuXG5lbnVtIEFjdGlvbktleXMge1xuICBJbkJ1aWxkZXJQdXRBcHBDb25maWdJbnRvSGlzdG9yeSA9ICdJTl9CVUlMREVSX1BVVF9BUFBDT05GSUdfSU5UT19ISVNUT1JZJyxcbiAgSW5CdWlsZGVyUmVtb3ZlTGFzdEFwcENvbmZpZ0Zyb21IaXN0b3J5ID0gJ0lOX0JVSUxERVJfUkVNT1ZFX0xBU1RfQVBQQ09ORklHX0ZST01fSElTVE9SWScsXG5cbiAgSW5CdWlsZGVyQXBwQ29uZmlnVW5kbyA9ICdJTl9CVUlMREVSX0FQUENPTkZJR19VTkRPJyxcbiAgSW5CdWlsZGVyQXBwQ29uZmlnUmVkbyA9ICdJTl9CVUlMREVSX0FQUENPTkZJR19SRURPJyxcbiAgSW5CdWlsZGVyQXBwQ29uZmlnUmVkb0NsZWFyID0gJ0lOX0JVSUxERVJfQVBQQ09ORklHX1JFRE9DTEVBUicsXG4gIEluQnVpbGRlckFwcENvbmZpZ0NsZWFyID0gJ0lOX0JVSUxERVJfQVBQQ09ORklHX0NMRUFSJyxcbn1cblxuZGVjbGFyZSBtb2R1bGUgJ2ppbXUtY29yZS9saWIvdHlwZXMvc3RhdGUne1xuICBpbnRlcmZhY2UgU3RhdGUge1xuICAgIGFwcFN0YXRlSGlzdG9yeT86IElNSGlzdG9yeVN0YXRlXG4gIH1cbn1cblxuZGVjbGFyZSBtb2R1bGUgJ2ppbXUtY29yZSd7XG4gIGludGVyZmFjZSBTdGF0ZSB7XG4gICAgYXBwU3RhdGVIaXN0b3J5PzogSU1IaXN0b3J5U3RhdGVcbiAgfVxufVxuXG5jb25zdCBhY3Rpb25zID0ge1xuXG4gIEluQnVpbGRlckFwcENvbmZpZ1VuZG86ICgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogQWN0aW9uS2V5cy5JbkJ1aWxkZXJBcHBDb25maWdVbmRvXG4gICAgfVxuICB9LFxuXG4gIEluQnVpbGRlckFwcENvbmZpZ1JlZG86ICgpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogQWN0aW9uS2V5cy5JbkJ1aWxkZXJBcHBDb25maWdSZWRvXG4gICAgfVxuICB9LFxuICBJbkJ1aWxkZXJQdXRBcHBDb25maWdJbnRvSGlzdG9yeTogKGFwcFN0YXRlKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuSW5CdWlsZGVyUHV0QXBwQ29uZmlnSW50b0hpc3RvcnksXG4gICAgICBhcHBTdGF0ZTogYXBwU3RhdGVcbiAgICB9XG4gIH0sXG5cbiAgSW5CdWlsZGVyUmVtb3ZlTGFzdEFwcENvbmZpZ0Zyb21IaXN0b3J5OiAoKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuSW5CdWlsZGVyUmVtb3ZlTGFzdEFwcENvbmZpZ0Zyb21IaXN0b3J5XG4gICAgfVxuICB9LFxuXG4gIEluQnVpbGRlckFwcENvbmZpZ1JlZG9DbGVhcjogKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLkluQnVpbGRlckFwcENvbmZpZ1JlZG9DbGVhclxuICAgIH1cbiAgfSxcblxuICBJbkJ1aWxkZXJBcHBDb25maWdDbGVhcjogKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLkluQnVpbGRlckFwcENvbmZpZ0NsZWFyXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB7IGFjdGlvbnMgYXMgYXBwU3RhdGVIaXN0b3J5QWN0aW9ucywgQWN0aW9uS2V5cyBhcyBBcHBTdGF0ZUhpc3RvcnlBY3Rpb25LZXlzIH1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwU3RhdGVIaXN0b3J5RXh0ZW5zaW9uIGltcGxlbWVudHMgZXh0ZW5zaW9uU3BlYy5SZWR1eFN0b3JlRXh0ZW5zaW9uIHtcbiAgaWQgPSAnYXBwLXN0YXRlLWhpc3RvcnktZXh0ZW5zaW9uJ1xuXG4gIGdldEFjdGlvbnMgKCkge1xuICAgIHJldHVybiBbXG4gICAgICBBY3Rpb25LZXlzLkluQnVpbGRlclB1dEFwcENvbmZpZ0ludG9IaXN0b3J5LFxuICAgICAgQWN0aW9uS2V5cy5JbkJ1aWxkZXJSZW1vdmVMYXN0QXBwQ29uZmlnRnJvbUhpc3RvcnksXG4gICAgICBBY3Rpb25LZXlzLkluQnVpbGRlckFwcENvbmZpZ1VuZG8sXG4gICAgICBBY3Rpb25LZXlzLkluQnVpbGRlckFwcENvbmZpZ1JlZG8sXG4gICAgICBBY3Rpb25LZXlzLkluQnVpbGRlckFwcENvbmZpZ1JlZG9DbGVhcixcbiAgICAgIEFjdGlvbktleXMuSW5CdWlsZGVyQXBwQ29uZmlnQ2xlYXJcbiAgICBdXG4gIH1cblxuICBnZXRJbml0TG9jYWxTdGF0ZSAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhc3Q6IFtdLFxuICAgICAgZnV0dXJlOiBbXVxuICAgIH1cbiAgfVxuXG4gIGdldFJlZHVjZXIgKCkge1xuICAgIHJldHVybiAoaGlzdG9yeVN0YXRlOiBJTUhpc3RvcnlTdGF0ZSwgYWN0aW9uLCBidWlsZGVyU3RhdGU6IElNU3RhdGUpID0+IHtcbiAgICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLkluQnVpbGRlckFwcENvbmZpZ1VuZG86XG4gICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlQXBwU3RhdGVVbmRvKGhpc3RvcnlTdGF0ZSlcbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLkluQnVpbGRlckFwcENvbmZpZ1JlZG86XG4gICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlQXBwU3RhdGVSZWRvKGhpc3RvcnlTdGF0ZSlcbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLkluQnVpbGRlclB1dEFwcENvbmZpZ0ludG9IaXN0b3J5OlxuICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZUFwcFN0YXRlQWRkKGhpc3RvcnlTdGF0ZSwgYWN0aW9uLmFwcFN0YXRlKVxuICAgICAgICBjYXNlIEFjdGlvbktleXMuSW5CdWlsZGVyUmVtb3ZlTGFzdEFwcENvbmZpZ0Zyb21IaXN0b3J5OlxuICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZUFwcFN0YXRlUmVtb3ZlTGFzdChoaXN0b3J5U3RhdGUpXG4gICAgICAgIGNhc2UgQWN0aW9uS2V5cy5JbkJ1aWxkZXJBcHBDb25maWdSZWRvQ2xlYXI6XG4gICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlQXBwU3RhdGVSZWRvQ2xlYXIoaGlzdG9yeVN0YXRlKVxuICAgICAgICBjYXNlIEFjdGlvbktleXMuSW5CdWlsZGVyQXBwQ29uZmlnQ2xlYXI6XG4gICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlQXBwU3RhdGVDbGVhcihoaXN0b3J5U3RhdGUpXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIGhpc3RvcnlTdGF0ZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUFwcFN0YXRlVW5kbyAoc3RhdGUpIHtcbiAgICAvLyBsYXN0IG1lbWJlciBpbiBgcGFzdGAgYXJyYXkgaXMgdGhlIGN1cnJlbnQgYXBwU3RhdGVcbiAgICBpZiAoc3RhdGUucGFzdC5sZW5ndGggPCAyKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NhbiBub3QgdW5kbyBzaW5jZSBubyBoaXN0b3J5IHRoZXJlJylcbiAgICAgIHJldHVybiBzdGF0ZVxuICAgIH1cbiAgICBjb25zdCBwcmV2aW91cyA9IHN0YXRlLnBhc3Rbc3RhdGUucGFzdC5sZW5ndGggLSAyXVxuICAgIGNvbnN0IGN1cnJlbnQgPSBzdGF0ZS5wYXN0W3N0YXRlLnBhc3QubGVuZ3RoIC0gMV1cbiAgICBjb25zdCBwYXN0ID0gc3RhdGUucGFzdC5zbGljZSgwLCBzdGF0ZS5wYXN0Lmxlbmd0aCAtIDEpXG4gICAgY29uc3QgZnV0dXJlID0gW2N1cnJlbnRdLmNvbmNhdChzdGF0ZS5mdXR1cmUpXG5cbiAgICBsb2Rhc2guZGVmZXIoKCkgPT4ge1xuICAgICAgcHVibGlzaEFwcENvbmZpZ0NoYW5nZVRvQXBwKHByZXZpb3VzLmFwcENvbmZpZylcbiAgICAgIHB1Ymxpc2hBcHBJbmZvQ2hhbmdlVG9BcHAocHJldmlvdXMuYXBwSW5mbylcbiAgICB9KVxuXG4gICAgcmV0dXJuIHN0YXRlLm1lcmdlKHtcbiAgICAgIHBhc3Q6IHBhc3QsXG4gICAgICBmdXR1cmU6IGZ1dHVyZVxuICAgIH0pXG4gIH1cblxuICBoYW5kbGVBcHBTdGF0ZVJlZG8gKHN0YXRlKSB7XG4gICAgLy8gbGFzdCBtZW1iZXIgaW4gYHBhc3RgIGFycmF5IGlzIHRoZSBjdXJyZW50IGFwcFN0YXRlXG4gICAgaWYgKHN0YXRlLmZ1dHVyZS5sZW5ndGggPCAxKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0NhbiBub3QgcmVkbyBzaW5jZSBubyBoaXN0b3J5IHRoZXJlJylcbiAgICAgIHJldHVybiBzdGF0ZVxuICAgIH1cbiAgICBjb25zdCBuZXh0ID0gc3RhdGUuZnV0dXJlWzBdXG4gICAgY29uc3QgZnV0dXJlID0gc3RhdGUuZnV0dXJlLnNsaWNlKDEpXG4gICAgY29uc3QgcGFzdCA9IHN0YXRlLnBhc3QuY29uY2F0KFtuZXh0XSlcblxuICAgIGxvZGFzaC5kZWZlcigoKSA9PiB7XG4gICAgICBwdWJsaXNoQXBwQ29uZmlnQ2hhbmdlVG9BcHAobmV4dC5hcHBDb25maWcpXG4gICAgICBwdWJsaXNoQXBwSW5mb0NoYW5nZVRvQXBwKG5leHQuYXBwSW5mbylcbiAgICB9KVxuXG4gICAgcmV0dXJuIHN0YXRlLm1lcmdlKHtcbiAgICAgIHBhc3Q6IHBhc3QsXG4gICAgICBmdXR1cmU6IGZ1dHVyZVxuICAgIH0pXG4gIH1cblxuICBoYW5kbGVBcHBTdGF0ZUFkZCAoc3RhdGUsIGFwcFN0YXRlKSB7XG4gICAgLy8gaWYgYXBwU3RhdGUgaXMgbm90IGdlbmVyYXRlZCBieSByZWRvIG9yIHVuZG8gb3IgYHBhc3RgIGlzIGVtcGVydHlcbiAgICBjb25zdCBsYXN0U3RhdGVJblBhc3QgPSBzdGF0ZS5wYXN0W3N0YXRlLnBhc3QubGVuZ3RoIC0gMV1cbiAgICBpZiAoYXBwU3RhdGUgIT09IG51bGwgJiYgKChzdGF0ZS5wYXN0Lmxlbmd0aCA+IDAgJiYgKGxhc3RTdGF0ZUluUGFzdC5hcHBDb25maWcgIT09IGFwcFN0YXRlLmFwcENvbmZpZyB8fCBsYXN0U3RhdGVJblBhc3QuYXBwSW5mbyAhPT0gYXBwU3RhdGUuYXBwSW5mbykpIHx8IHN0YXRlLnBhc3QubGVuZ3RoID09PSAwKSkge1xuICAgICAgY29uc3QgcGFzdCA9IHN0YXRlLnBhc3QuY29uY2F0KFthcHBTdGF0ZV0pXG4gICAgICByZXR1cm4gc3RhdGUuc2V0KCdwYXN0JywgcGFzdCkuc2V0KCdmdXR1cmUnLCBbXSlcbiAgICB9XG4gICAgcmV0dXJuIHN0YXRlXG4gIH1cblxuICBoYW5kbGVBcHBTdGF0ZVJlbW92ZUxhc3QgKHN0YXRlOiBJTUhpc3RvcnlTdGF0ZSkge1xuICAgIC8vIGlmIGFwcFN0YXRlIGlzIG5vdCBnZW5lcmF0ZWQgYnkgcmVkbyBvciB1bmRvIG9yIGBwYXN0YCBpcyBlbXBlcnR5XG4gICAgaWYgKHN0YXRlLnBhc3QubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcGFzdCA9IHN0YXRlLnBhc3Quc2xpY2UoMCwgc3RhdGUucGFzdC5sZW5ndGggLSAxKVxuICAgICAgcmV0dXJuIHN0YXRlLnNldCgncGFzdCcsIHBhc3QpXG4gICAgfVxuICAgIHJldHVybiBzdGF0ZVxuICB9XG5cbiAgaGFuZGxlQXBwU3RhdGVSZWRvQ2xlYXIgKHN0YXRlKSB7XG4gICAgcmV0dXJuIHN0YXRlLnNldCgnZnV0dXJlJywgW10pXG4gIH1cblxuICBoYW5kbGVBcHBTdGF0ZUNsZWFyIChzdGF0ZSkge1xuICAgIHJldHVybiBzdGF0ZS5zZXQoJ2Z1dHVyZScsIFtdKS5zZXQoJ3Bhc3QnLCBbXSlcbiAgfVxuXG4gIGdldFN0b3JlS2V5ICgpIHtcbiAgICByZXR1cm4gJ2FwcFN0YXRlSGlzdG9yeSdcbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBleHRlbnNpb25TcGVjLCB0eXBlIElNQXBwQ29uZmlnLCBhcHBDb25maWdVdGlscywgdHlwZSBJTVN0YXRlIH0gZnJvbSAnamltdS1jb3JlJ1xuXG5kZWNsYXJlIG1vZHVsZSAnamltdS1jb3JlL2xpYi90eXBlcy9zdGF0ZSd7XG4gIGludGVyZmFjZSBTdGF0ZSB7XG4gICAgYXBwU3RhdGVJbkJ1aWxkZXI/OiBJTVN0YXRlXG4gIH1cbn1cblxuZGVjbGFyZSBtb2R1bGUgJ2ppbXUtY29yZSd7XG4gIGludGVyZmFjZSBTdGF0ZSB7XG4gICAgYXBwU3RhdGVJbkJ1aWxkZXI/OiBJTVN0YXRlXG4gIH1cbn1cblxuZXhwb3J0IGVudW0gRXh0QWN0aW9uS2V5cyB7XG4gIC8vIGFjdGlvbnMgZnJvbSBhcHBcbiAgSW5BcHBBcHBTdGF0ZUNoYW5nZWQgPSAnSU5fQVBQX0FQUF9TVEFURV9DSEFOR0VEJyxcblxuICBJbkJ1aWxkZXJBcHBDb25maWdDaGFuZ2VkID0gJ0lOX0JVSUxERVJfQVBQX0NPTkZJR19DSEFOR0VEJyxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbkFwcEFwcFN0YXRlQ2hhbmdlQWN0aW9uIHtcbiAgdHlwZTogRXh0QWN0aW9uS2V5cy5JbkFwcEFwcFN0YXRlQ2hhbmdlZFxuICBhcHBTdGF0ZTogSU1TdGF0ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEluQnVpbGRlckFwcENvbmZpZ0NoYW5nZUFjdGlvbiB7XG4gIHR5cGU6IEV4dEFjdGlvbktleXMuSW5CdWlsZGVyQXBwQ29uZmlnQ2hhbmdlZFxuICBhcHBDb25maWc6IElNQXBwQ29uZmlnXG59XG5cbmNvbnN0IGFjdGlvbnMgPSB7XG4gIGluQXBwQXBwU3RhdGVDaGFuZ2VkOiAoYXBwU3RhdGU6IElNU3RhdGUpOiBJbkFwcEFwcFN0YXRlQ2hhbmdlQWN0aW9uID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogRXh0QWN0aW9uS2V5cy5JbkFwcEFwcFN0YXRlQ2hhbmdlZCxcbiAgICAgIGFwcFN0YXRlOiBhcHBTdGF0ZVxuICAgIH1cbiAgfSxcblxuICBpbkJ1aWxkZXJBcHBDb25maWdDaGFuZ2VkOiAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZyk6IEluQnVpbGRlckFwcENvbmZpZ0NoYW5nZUFjdGlvbiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEV4dEFjdGlvbktleXMuSW5CdWlsZGVyQXBwQ29uZmlnQ2hhbmdlZCxcbiAgICAgIGFwcENvbmZpZ1xuICAgIH1cbiAgfVxufVxuXG50eXBlIEFjdGlvblR5cGVzID0gSW5BcHBBcHBTdGF0ZUNoYW5nZUFjdGlvbiB8IEluQnVpbGRlckFwcENvbmZpZ0NoYW5nZUFjdGlvblxuXG5leHBvcnQgeyB0eXBlIEFjdGlvblR5cGVzIGFzIEFwcFN0YXRlQWN0aW9uVHlwZXMsIGFjdGlvbnMgYXMgYXBwU3RhdGVBY3Rpb25zIH1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQnVpbGRlckFwcFN0YXRlUmVkdXhTdG9yZUV4dGVuc2lvbiBpbXBsZW1lbnRzIGV4dGVuc2lvblNwZWMuUmVkdXhTdG9yZUV4dGVuc2lvbiB7XG4gIGlkID0gJ2J1aWxkZXItYXBwLXN0YXRlLXJlZHV4LXN0b3JlLWV4dGVuc2lvbidcblxuICBnZXRBY3Rpb25zICgpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoRXh0QWN0aW9uS2V5cykubWFwKGsgPT4gRXh0QWN0aW9uS2V5c1trXSlcbiAgfVxuXG4gIGdldEluaXRMb2NhbFN0YXRlICgpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgZ2V0UmVkdWNlciAoKSB7XG4gICAgcmV0dXJuIChhcHBTdGF0ZTogSU1TdGF0ZSwgYWN0aW9uOiBBY3Rpb25UeXBlcywgYnVpbGRlclN0YXRlOiBJTVN0YXRlKTogSU1TdGF0ZSA9PiB7XG4gICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgRXh0QWN0aW9uS2V5cy5JbkFwcEFwcFN0YXRlQ2hhbmdlZDpcbiAgICAgICAgICByZXR1cm4gYWN0aW9uLmFwcFN0YXRlXG4gICAgICAgIGNhc2UgRXh0QWN0aW9uS2V5cy5JbkJ1aWxkZXJBcHBDb25maWdDaGFuZ2VkOlxuICAgICAgICAgIHJldHVybiBhcHBDb25maWdVdGlscy51cGRhdGVTdGF0ZVdoZW5BcHBDb25maWdDaGFuZ2UoYXBwU3RhdGUsIGFjdGlvbi5hcHBDb25maWcpXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIGFwcFN0YXRlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0U3RvcmVLZXkgKCkge1xuICAgIHJldHVybiAnYXBwU3RhdGVJbkJ1aWxkZXInXG4gIH1cbn1cbiIsImltcG9ydCB7IFdpZGdldE1hbmFnZXIgfSBmcm9tICdqaW11LWNvcmUnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcFdpZGdldE1hbmFnZXIgZXh0ZW5kcyBXaWRnZXRNYW5hZ2VyIHtcbiAgc3RhdGljIGdldEluc3RhbmNlICgpOiBXaWRnZXRNYW5hZ2VyIHtcbiAgICBpZiAod2luZG93LmppbXVDb25maWcuaXNCdWlsZGVyKSB7XG4gICAgICByZXR1cm4gd2luZG93Ll9hcHBXaW5kb3cgJiYgd2luZG93Ll9hcHBXaW5kb3cuX3dpZGdldE1hbmFnZXJcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFdpZGdldE1hbmFnZXIuZ2V0SW5zdGFuY2UoKVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgUmVhY3QsIHR5cGUgSU1TdGF0ZSB9IGZyb20gJ2ppbXUtY29yZSdcblxuaW1wb3J0IHsgdHlwZSBBbGxXaWRnZXRTZXR0aW5nUHJvcHMsIHR5cGUgV2lkZ2V0U2V0dGluZ1Byb3BzIH0gZnJvbSAnLi9wcm9wcydcblxuY2xhc3MgQmFzZVdpZGdldFNldHRpbmc8UCBleHRlbmRzIEFsbFdpZGdldFNldHRpbmdQcm9wczx1bmtub3duPiA9IEFsbFdpZGdldFNldHRpbmdQcm9wczx1bmtub3duPiwgUyA9IHVua25vd24+IGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxQLCBTPiB7XG4gIC8qKlxuICAgKiBCeSBkZWZhdWx0LCB0aGUgcHJvcHMgaW4gXCJXaWRnZXRTZXR0aW5nSW5qZWN0ZWRQcm9wc1wiIHdpbGwgYmUgaW5qZWN0ZWQgaW50byB3aWRnZXQgc2V0dGluZyBwcm9wcy4gVG8gbWFwIG1vcmUgcHJvcHMsIHBsZWFzZSB1c2UgdGhpcyBmdW5jdGlvbi5cbiAgICovXG4gIHN0YXRpYyBtYXBFeHRyYVN0YXRlUHJvcHM6IChzdGF0ZTogSU1TdGF0ZSwgb3duUHJvcHM6IFBhcnRpYWw8QWxsV2lkZ2V0U2V0dGluZ1Byb3BzPHVua25vd24+PikgPT4gYW55XG59XG5cbmV4cG9ydCBkZWZhdWx0IEJhc2VXaWRnZXRTZXR0aW5nXG5cbmV4cG9ydCBpbnRlcmZhY2UgV2lkZ2V0U2V0dGluZ1N0YXRpY01ldGhvZHMge1xuICBtYXBFeHRyYVN0YXRlUHJvcHM/OiAoc3RhdGU6IElNU3RhdGUsIG93blByb3BzOiBQYXJ0aWFsPEFsbFdpZGdldFNldHRpbmdQcm9wczxhbnk+PikgPT4gYW55XG59XG5cbmV4cG9ydCB0eXBlIFJhd1dpZGdldFNldHRpbmdUeXBlID0gKFJlYWN0LkNvbXBvbmVudENsYXNzPEFsbFdpZGdldFNldHRpbmdQcm9wczxhbnk+PiB8IFJlYWN0LkZ1bmN0aW9uQ29tcG9uZW50PEFsbFdpZGdldFNldHRpbmdQcm9wczxhbnk+PikgJiBXaWRnZXRTZXR0aW5nU3RhdGljTWV0aG9kc1xuZXhwb3J0IHR5cGUgV3JhcHBlZFdpZGdldFNldHRpbmdUeXBlID0gKFJlYWN0LkNvbXBvbmVudENsYXNzPFdpZGdldFNldHRpbmdQcm9wcz4gfCBSZWFjdC5GdW5jdGlvbkNvbXBvbmVudDxXaWRnZXRTZXR0aW5nUHJvcHM+KSAmIFdpZGdldFNldHRpbmdTdGF0aWNNZXRob2RzXG4iLCJpbXBvcnQge1xuICB0eXBlIElNQXBwQ29uZmlnLFxuICB0eXBlIEFwcE1vZGUsXG4gIGdldEFwcFN0b3JlLFxuICB0eXBlIFNlbGVjdGlvbixcbiAga2V5Ym9hcmRVdGlscyxcbiAgdHlwZSBCcm93c2VyU2l6ZU1vZGUsXG4gIFNlc3Npb25NYW5hZ2VyLFxuICB0eXBlIEFwcEluZm8sXG4gIGFwcEFjdGlvbnMsXG4gIHR5cGUgUGFnZVBhcnQsXG4gIHR5cGUgTGF5b3V0SW5mbyxcbiAgUmVzb3VyY2VUeXBlLFxuICB0eXBlIFNlY3Rpb25OYXZJbmZvLFxuICB0eXBlIEFuaW1hdGlvblBsYXlNb2RlLFxuICB0eXBlIElNU3RhdGUsXG4gIHBvcnRhbFV0aWxzLFxuICB0eXBlIERpYWxvZ0luZm9zLFxuICB0eXBlIFBvcnRhbE5lZWRUb1JlZ2lzdGVyQ2xpbmV0SWQsXG4gIHR5cGUgUG9ydGFsSW5mbyxcbiAgdHlwZSBOb1Blcm1pc3Npb25SZXNvdXJjZUluZm9MaXN0LFxuICBvYnNlcnZlU3RvcmUsXG4gIGppbXVIaXN0b3J5XG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IGFwcFN0YXRlQWN0aW9ucyB9IGZyb20gJy4vYXBwLXN0YXRlLXJlZHV4LXN0b3JlLWV4dGVuc2lvbidcbmltcG9ydCB7IGFwcFN0YXRlSGlzdG9yeUFjdGlvbnMgfSBmcm9tICcuL2FwcC1zdGF0ZS1oaXN0b3J5LWV4dGVuc2lvbidcbmltcG9ydCB7IGJ1aWxkZXJBY3Rpb25zIH0gZnJvbSAnLi9idWlsZGVyLXN0YXRlLXN0b3JlLWV4dGVuc2lvbidcbmltcG9ydCB7IFRvQXBwTWVzc2FnZSwgVG9CdWlsZGVyTWVzc2FnZSB9IGZyb20gJy4vc3luYy10eXBlJ1xuaW1wb3J0IHsgQXBwUmVzb3VyY2VNYW5hZ2VyLCB0eXBlIFJlc291cmNlSXRlbUluZm8sIHR5cGUgSW1hZ2VSZXNvdXJjZUl0ZW1JbmZvIH0gZnJvbSAnLi9hcHAtcmVzb3VyY2UtbWFuYWdlcidcbmltcG9ydCB7IHR5cGUgVG9vbGJhckNvbmZpZyB9IGZyb20gJ2ppbXUtbGF5b3V0cy9sYXlvdXQtcnVudGltZSdcbmltcG9ydCB7IHR5cGUgVXNlclNlc3Npb24gfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1hdXRoJ1xuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaEFwcENvbmZpZ0NoYW5nZVRvQXBwIChhcHBDb25maWc6IElNQXBwQ29uZmlnKSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQXBwQ29uZmlnQ2hhbmdlZH1gLCBhcHBDb25maWcpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoQXBwSW5mb0NoYW5nZVRvQXBwIChhcHBJbmZvOiBBcHBJbmZvKSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQXBwSW5mb0NoYW5nZWR9YCwgYXBwSW5mbylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hEaWFsb2dJbmZvc0NoYW5nZVRvQXBwIChkaWFsb2dJbmZvczogRGlhbG9nSW5mb3MpIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5EaWFsb2dJbmZvc0NoYW5nZWR9YCwgZGlhbG9nSW5mb3MpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoQXBwTW9kZUNoYW5nZVRvQXBwIChhcHBNb2RlOiBBcHBNb2RlKSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQ2hhbmdlQXBwTW9kZX1gLCBhcHBNb2RlKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaFBhZ2VDaGFuZ2VUb0FwcCAocGFnZUlkOiBzdHJpbmcpIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VQYWdlfWAsIHBhZ2VJZClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hEaWFsb2dDaGFuZ2VUb0FwcCAoZGlhbG9nSWQ6IHN0cmluZykge1xuICBwdWJsaXNoRXZlbnRUb0FwcChgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLkNoYW5nZURpYWxvZ31gLCBkaWFsb2dJZClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hDaGFuZ2VTZWxlY3Rpb25Ub0FwcCAoc2VsZWN0aW9uOiBTZWxlY3Rpb24pIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VTZWxlY3Rpb259YCwgc2VsZWN0aW9uKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaENoYW5nZVdpZGdldFN0YXRlUHJvcFRvQXBwIChhbHRlclN0YXRlOiB7IHdpZGdldElkOiBzdHJpbmcsIHByb3BLZXk6IHN0cmluZywgdmFsdWU6IGFueSB9KSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQ2hhbmdlV2lkZ2V0U3RhdGVQcm9wfWAsIGFsdGVyU3RhdGUpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaWNoVXRpbGl0eVN0YXRlQ2hhbmdlVG9BcHAgKHV0aWxpdHlJZDogc3RyaW5nLCBzdGF0ZTogYm9vbGVhbikge1xuICBwdWJsaXNoRXZlbnRUb0FwcChgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLlV0aWxpdHlTdGF0ZUNoYW5nZWR9YCwgeyB1dGlsaXR5SWQsIHN0YXRlIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoQ2hhbmdlV2lkZ2V0TXV0YWJsZVN0YXRlUHJvcFRvQXBwIChhbHRlclN0YXRlOiB7XG4gIHdpZGdldElkOiBzdHJpbmdcbiAgcHJvcEtleTogc3RyaW5nXG4gIHZhbHVlOiBhbnlcbn0pIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VXaWRnZXRNdXRhYmxlU3RhdGVQcm9wfWAsIGFsdGVyU3RhdGUpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoS2V5Ym9hcmRUb0FwcCAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5CdWlsZGVyVHJpZ2dlcktleWJvYXJkfWAsIGV2ZW50KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaENoYW5nZUJyb3dzZXJTaXplTW9kZVRvQXBwIChtb2RlOiBCcm93c2VyU2l6ZU1vZGUpIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5DaGFuZ2VCcm93c2VyU2l6ZU1vZGV9YCwgbW9kZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hDaGFuZ2VTZXNzaW9uVG9BcHAgKCkge1xuICBwdWJsaXNoRXZlbnRUb0FwcChgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLkJ1aWxkZXJTZXNzaW9uQ2hhbmdlZH1gLCBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldFNlc3Npb25zKCkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdENoYW5nZVRvQXBwICgpIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5CdWlsZGVyTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdENoYW5nZWR9YCwgU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXROb1Blcm1pc3Npb25SZXNvdXJjZUluZm9MaXN0KCkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaWNoQ2hhbmdlWm9vbVNjYWxlVG9BcHAgKHpvb21TY2FsZTogbnVtYmVyKSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuQ2hhbmdlWm9vbVNjYWxlfWAsIHpvb21TY2FsZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1YmxpY2hBY3RpdmVQYWdlUGFydENoYW5nZVRvQXBwIChwYWdlUGFydDogUGFnZVBhcnQpIHtcbiAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5BY3RpdmVQYWdlUGFydENoYW5nZWR9YCwgcGFnZVBhcnQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoQW5pbWF0aW9uUHJldmlld1RvQXBwIChkYXRhOiB7IGxheW91dEluZm8/OiBMYXlvdXRJbmZvLCBwYWdlSWQ/OiBzdHJpbmcsIGRpYWxvZ0lkPzogc3RyaW5nLCBjb250cm9sbGVySWQ/OiBzdHJpbmcsIHBsYXlNb2RlPzogQW5pbWF0aW9uUGxheU1vZGUsIGlkOiBudW1iZXIgfSkge1xuICBwdWJsaXNoRXZlbnRUb0FwcChgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLkFuaW1hdGlvblByZXZpZXd9YCwgZGF0YSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hIb3ZlclByZXZpZXdUb0FwcCAoZGF0YTogeyBsYXlvdXRJbmZvPzogTGF5b3V0SW5mbywgcGFnZUlkPzogc3RyaW5nLCBkaWFsb2dJZD86IHN0cmluZywgaWQ6IG51bWJlciB9KSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuSG92ZXJQcmV2aWV3fWAsIGRhdGEpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoU2VjdGlvbk5hdkluZm9Ub0FwcCAoc2VjdGlvbklkOiBzdHJpbmcsIG5hdkluZm86IFNlY3Rpb25OYXZJbmZvKSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuU2VjdGlvbk5hdkluZm9DaGFuZ2VkfWAsIHsgc2VjdGlvbklkLCBuYXZJbmZvIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwdWJsaXNoU2NyZWVuR3JvdXBOYXZJbmZvVG9BcHAgKHNjcmVlbkdyb3VwSWQ6IHN0cmluZywgYWN0aXZlSW5kZXg6IG51bWJlcikge1xuICBwdWJsaXNoRXZlbnRUb0FwcChgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLlNjcmVlbkdyb3VwTmF2SW5mb0NoYW5nZWR9YCwgeyBzY3JlZW5Hcm91cElkLCBhY3RpdmVJbmRleCB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaFRvY0hvdmVySW5mb1RvQXBwIChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCBob3ZlcmVkOiBib29sZWFuKSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuVG9jSG92ZXJJbmZvQ2hhbmdlZH1gLCB7IGxheW91dEluZm8sIGhvdmVyZWQgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1Ymxpc2hTZXRDbGllbnRJZEFsZXJ0SXNDYW5jZWxsZWQgKHBvcnRhbFVybDogc3RyaW5nKSB7XG4gIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuU2V0Q2xpZW50SWRBbGVydElzQ2FuY2VsbGVkfWAsIHsgcG9ydGFsVXJsIH0pXG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2hFdmVudFRvQXBwIChhY3Rpb24sIGRhdGE/KSB7XG4gIHdpbmRvdy5fYnVpbGRlclB1YnN1Yi5wdWJsaXNoU3luYyhhY3Rpb24sIGRhdGEpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5BcHBFdmVudHMgKCkge1xuICB3aW5kb3cuX2J1aWxkZXJQdWJzdWIuc3Vic2NyaWJlKFxuICAgIGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5BcHBTZXNzaW9uQ2hhbmdlZH1gLFxuICAgIChldnQsIHNlc3Npb25zOiBVc2VyU2Vzc2lvbltdKSA9PiB7XG4gICAgICAvLyBjb25zb2xlLmxvZygndG9fYnVpbGRlcicgKyBKU09OLnN0cmluZ2lmeShzZXNzaW9ucykpO1xuICAgICAgU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5zeW5jU2Vzc2lvbnNGcm9tT3RoZXJXaW5kb3coc2Vzc2lvbnMpXG4gICAgfVxuICApXG5cbiAgd2luZG93Ll9idWlsZGVyUHVic3ViLnN1YnNjcmliZShgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuQXBwTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdENoYW5nZWR9YCwgKGV2dCwgbm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdDogTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdCkgPT4ge1xuICAgIFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuc3luY05vUGVybWlzc2lvblJlc291cmNlSW5mb0xpc3RGcm9tT3RoZXJXaW5kb3cobm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdClcbiAgfSlcblxuICB3aW5kb3cuX2J1aWxkZXJQdWJzdWIuc3Vic2NyaWJlKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5OZWVkVG9DaGVjazQ5OEVycm9yfWAsIChldnQsIHVybDogc3RyaW5nKSA9PiB7XG4gICAgU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5oYW5kbGVJbnZhbGlkVG9rZW4odXJsKVxuICB9KVxuXG4gIHdpbmRvdy5fYnVpbGRlclB1YnN1Yi5zdWJzY3JpYmUoJ3RvX2J1aWxkZXInLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7XG4gICAgY29uc29sZS5kZWJ1ZyhldnQsIGRhdGEpXG4gIH0pXG5cbiAgd2luZG93Ll9idWlsZGVyUHVic3ViLnN1YnNjcmliZShgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuQXBwU3RhdGVDaGFuZ2VkfWAsIChldnQsIGFwcFN0YXRlOiBJTVN0YXRlKSA9PiB7XG4gICAgaWYgKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5idWlsZGVyLmN1cnJlbnRBcHBJZCAhPT0gYXBwU3RhdGUuYXBwSWQpIHtcbiAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYnVpbGRlckFjdGlvbnMuY2hhbmdlQ3VycmVudEFwcChhcHBTdGF0ZS5hcHBJZCkpXG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcFN0YXRlSGlzdG9yeUFjdGlvbnMuSW5CdWlsZGVyQXBwQ29uZmlnQ2xlYXIoKSlcblxuICAgICAgLyoqXG4gICAgICAgKiBCZWNhdXNlIG9mIHRoZSBoaXN0b3J5IEFQSSwgd2hlbiB1c2VyIGNsaWNrIHRoZSBicm93c2VyIGJhY2sgYnV0dG9uLCB0aGUgYXBwSWQgaW4gVVJMIG1heSBpcyBub3QgdGhlIHNhbWUgYXMgdGhlIGludGVybmFsIGFwcElkLCB3ZSBuZWVkIHRvIHN5bmMgdGhlbSBoZXJlLlxuICAgICAgICpcbiAgICAgICAqIE5vdGU6IENoYW5naW5nIHRoZSBpZnJhbWUuc3JjIHdpbGwgdXBkYXRlIHRoZSBob3N0IHBhcmVudCB3aW5kb3cncyBoaXN0b3J5ICh0ZXN0ZWQgaW4gY2hyb21lLilcbiAgICAgICAqL1xuICAgICAgaWYgKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5xdWVyeU9iamVjdC5pZCAhPT0gYXBwU3RhdGUuYXBwSWQpIHtcbiAgICAgICAgamltdUhpc3RvcnkuY2hhbmdlUXVlcnlPYmplY3QoeyBpZDogYXBwU3RhdGUuYXBwSWQgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICAhZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyIHx8XG4gICAgICBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXIuYXBwQ29uZmlnICE9PSBhcHBTdGF0ZS5hcHBDb25maWdcbiAgICApIHtcbiAgICAgIGNvbnN0IG5ld0FwcENvbmZpZyA9IGFwcFN0YXRlLmFwcENvbmZpZ1xuICAgICAgY29uc3Qgb2xkQXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBDb25maWdcbiAgICAgIGlmIChuZXdBcHBDb25maWcgJiYgb2xkQXBwQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGlzV2lkZ2V0VmVyc2lvbkNoYW5nZSA9IE9iamVjdC5rZXlzKG5ld0FwcENvbmZpZy53aWRnZXRzIHx8IHt9KVxuICAgICAgICAgIC5maW5kKHdJZCA9PiBuZXdBcHBDb25maWcud2lkZ2V0c1t3SWRdICYmIG9sZEFwcENvbmZpZy53aWRnZXRzW3dJZF0gJiYgbmV3QXBwQ29uZmlnLndpZGdldHNbd0lkXS52ZXJzaW9uICE9PSBvbGRBcHBDb25maWcud2lkZ2V0c1t3SWRdLnZlcnNpb24pXG4gICAgICAgIC8vIHRoZSBhcHBDb25maWcgY2hhbmdlIGlzIGNhdXNlZCBieSB3aWRnZXQgdmVyc2lvbiBjaGFuZ2UsIHdoaWNoIG1lYW5zIGxvYWQgYW4gb2xkIGFwcCBhbmQgZG8gdXBncmFkZVxuICAgICAgICAvLyBmb3IgdGhpcyBjYXNlLCB3ZSBkb24ndCB0cmlnZ2VyIHNhdmUgYnV0dG9uLlxuICAgICAgICBpZiAoaXNXaWRnZXRWZXJzaW9uQ2hhbmdlKSB7XG4gICAgICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBTdGF0ZUFjdGlvbnMuaW5BcHBBcHBTdGF0ZUNoYW5nZWQoYXBwU3RhdGUpKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVtb3ZlZFdpZGdldHMgPSBPYmplY3Qua2V5cyhvbGRBcHBDb25maWcud2lkZ2V0cykuZmlsdGVyKHdJZCA9PiAhbmV3QXBwQ29uZmlnLndpZGdldHNbd0lkXSlcbiAgICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChidWlsZGVyQWN0aW9ucy53aWRnZXRzUmVtb3ZlZChyZW1vdmVkV2lkZ2V0cykpXG5cbiAgICAgICAgY29uc3QgbmV3V2lkZ2V0cyA9IE9iamVjdC5rZXlzKG5ld0FwcENvbmZpZy53aWRnZXRzKS5maWx0ZXIod0lkID0+ICFvbGRBcHBDb25maWcud2lkZ2V0c1t3SWRdKS5tYXAod0lkID0+ICh7XG4gICAgICAgICAgd2lkZ2V0SWQ6IHdJZCxcbiAgICAgICAgICB3aWRnZXRVcmk6IG5ld0FwcENvbmZpZy53aWRnZXRzW3dJZF0udXJpXG4gICAgICAgIH0pKVxuICAgICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGJ1aWxkZXJBY3Rpb25zLndpZGdldHNBZGRlZChuZXdXaWRnZXRzKSlcbiAgICAgIH1cbiAgICAgIGFwcFN0YXRlLmFwcENvbmZpZyAmJiBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcFN0YXRlSGlzdG9yeUFjdGlvbnMuSW5CdWlsZGVyUHV0QXBwQ29uZmlnSW50b0hpc3RvcnkoeyBhcHBDb25maWc6IGFwcFN0YXRlLmFwcENvbmZpZywgYXBwSW5mbzogYXBwU3RhdGUuYXBwSW5mbyB9KSlcbiAgICB9XG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBTdGF0ZUFjdGlvbnMuaW5BcHBBcHBTdGF0ZUNoYW5nZWQoYXBwU3RhdGUpKVxuICB9KVxuXG4gIHdpbmRvdy5fYnVpbGRlclB1YnN1Yi5zdWJzY3JpYmUoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLlBvcHVwQ2hvb3NlV2lkZ2V0fWAsIChldnQsIGxheW91dCkgPT4ge1xuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYnVpbGRlckFjdGlvbnMub3BlbkNob29zZVdpZGdldFBvcHVwKGxheW91dC5sYXlvdXRJZCwgbGF5b3V0LmxheW91dEl0ZW1JZCkpXG4gIH0pXG5cbiAgd2luZG93Ll9idWlsZGVyUHVic3ViLnN1YnNjcmliZShgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuQXBwQWRkUmVzb3VyY2V9YCwgKGV2dCwgcmVzb3VyY2U6IFJlc291cmNlSXRlbUluZm8pID0+IHtcbiAgICBjb25zdCBhcHBSZXNvdXJjZU1hbmFnZXIgPSBBcHBSZXNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKVxuICAgIEFwcFJlc291cmNlTWFuYWdlci5nZXRCbG9iQnlCbG9iVXJsKHJlc291cmNlLmZpbGUgYXMgc3RyaW5nKS50aGVuKGFzeW5jIChibG9iKSA9PiB7XG4gICAgICByZXNvdXJjZS5maWxlID0gYmxvYlxuICAgICAgYXBwUmVzb3VyY2VNYW5hZ2VyLnVwTG9hZEFwcFJlc291cmNlKHJlc291cmNlKVxuXG4gICAgICBpZiAocmVzb3VyY2UudHlwZSA9PT0gUmVzb3VyY2VUeXBlLkltYWdlICYmIChyZXNvdXJjZSBhcyBJbWFnZVJlc291cmNlSXRlbUluZm8pLm9yaWdpbklkKSB7XG4gICAgICAgIEFwcFJlc291cmNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLnVwZGF0ZUltYWdlUmVzb3VyY2VJdGVtSW5mbyhyZXNvdXJjZSlcbiAgICAgIH1cbiAgICB9KVxuICB9KVxuXG4gIHdpbmRvdy5fYnVpbGRlclB1YnN1Yi5zdWJzY3JpYmUoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLkFwcENsZWFyUmVzb3VyY2VzfWAsIChldnQsIGFwcElkKSA9PiB7XG4gICAgY29uc3QgYXBwUmVzb3VyY2VNYW5hZ2VyID0gQXBwUmVzb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKClcbiAgICBhcHBSZXNvdXJjZU1hbmFnZXIuY2xlYXJSZXNvdXJjZXMoYXBwSWQpXG4gIH0pXG5cbiAgd2luZG93Ll9idWlsZGVyUHVic3ViLnN1YnNjcmliZShgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuQXBwVHJpZ2dlcktleWJvYXJkfWAsIChldnQsIGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAga2V5Ym9hcmRVdGlscy50cmlnZ2VyRXZlbnQoZXZlbnQpXG4gIH0pXG5cbiAgd2luZG93Ll9idWlsZGVyUHVic3ViLnN1YnNjcmliZShgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuU2V0TGF5b3V0VG9vbHN9YCwgKGV2dCwgdG9vbHM6IFRvb2xiYXJDb25maWcpID0+IHtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGJ1aWxkZXJBY3Rpb25zLnNldExheW91dFRvb2xzKHRvb2xzKSlcbiAgfSlcblxuICB3aW5kb3cuX2J1aWxkZXJQdWJzdWIuc3Vic2NyaWJlKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5DbGVhckxhc3RBcHBDb25maWdGcm9tSGlzdG9yeX1gLCBldnQgPT4ge1xuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwU3RhdGVIaXN0b3J5QWN0aW9ucy5JbkJ1aWxkZXJSZW1vdmVMYXN0QXBwQ29uZmlnRnJvbUhpc3RvcnkoKSlcbiAgfSlcblxuICB3aW5kb3cuX2J1aWxkZXJQdWJzdWIuc3Vic2NyaWJlKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5TZXRJc0J1c3l9YCwgKGV2dCwgaXNCdXN5KSA9PiB7XG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLnNldElzQnVzeShpc0J1c3kpKVxuICB9KVxuXG4gIHdpbmRvdy5fYnVpbGRlclB1YnN1Yi5zdWJzY3JpYmUoYHRvX2J1aWxkZXIuJHtUb0J1aWxkZXJNZXNzYWdlLkNvbmZpcm1EZWxldGV9YCwgKGV2dCwgaXRlbVRvRGVsZXRlOiBMYXlvdXRJbmZvKSA9PiB7XG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChidWlsZGVyQWN0aW9ucy5jb25maXJtRGVsZXRlQ29udGVudENoYW5nZWQoaXRlbVRvRGVsZXRlKSlcbiAgfSlcblxuICB3aW5kb3cuX2J1aWxkZXJQdWJzdWIuc3Vic2NyaWJlKGB0b19idWlsZGVyLiR7VG9CdWlsZGVyTWVzc2FnZS5OZWVkVG9SZWdpc3RlckNsaW5ldElkfWAsIChldnQsIHBvcnRhbEluZm86IFBvcnRhbE5lZWRUb1JlZ2lzdGVyQ2xpbmV0SWQpID0+IHtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuYWRkVG9SZWdpc3RlckNsaWVudElkTGlzdChwb3J0YWxJbmZvLnBvcnRhbFVybCwgcG9ydGFsSW5mby5uZWVkVG9TaWduSW4sIHBvcnRhbEluZm8uc2VydmljZVVybCkpXG4gIH0pXG5cbiAgd2luZG93Ll9idWlsZGVyUHVic3ViLnN1YnNjcmliZShgdG9fYnVpbGRlci4ke1RvQnVpbGRlck1lc3NhZ2UuQXBwSXNMb2FkZWR9YCwgKGV2dCwgaXNCdXN5KSA9PiB7XG4gICAgLy8gc3luYyBtYWluUG9ydGFsSW5mb1xuICAgIGNvbnN0IHN0YXRlID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpXG5cbiAgICBjb25zdCBtYWluUG9ydGFsSW5mbzogUG9ydGFsSW5mbyA9IHtcbiAgICAgIHBvcnRhbFVybDogc3RhdGUucG9ydGFsVXJsLFxuICAgICAgY2xpZW50SWQ6IHN0YXRlLmNsaWVudElkLFxuICAgICAgaXNXZWJUaWVyOiBzdGF0ZS5pc1dlYlRpZXJcbiAgICB9XG4gICAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5TZXRNYWluUG9ydGFsfWAsIG1haW5Qb3J0YWxJbmZvKVxuXG4gICAgLypcbiAgICAqIEFmdGVyIGFwcCBsb2FkZWQsIHRoZSBwb3J0YWxVcmwgYW5kIHBvcnRhbFNlbGYgbWF5IHN0aWxsIGNoYW5nZSwgYmVjYXVzZSBpZiB3ZSB1c2UgcGxhdGZvcm0gdXJsIGluIGJ1aWxkZXIsXG4gICAgKiB0aGUgdXJsIHdpbGwgYmUgY2hhbmdlZCB0byBvcmcgdXJsIGxhdGVyIGlmIGFwcCBsb2FkcyBmYXN0LiBTbywgbGlzdGVuIHRvIGNoYW5nZSBoZXJlLlxuICAgICovXG4gICAgb2JzZXJ2ZVN0b3JlKChwcmVQb3J0YWxVcmwsIHBvcnRhbFVybCkgPT4ge1xuICAgICAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5TZXRNYWluUG9ydGFsfWAsIHsgcG9ydGFsVXJsIH0pXG4gICAgfSwgWydwb3J0YWxVcmwnXSlcblxuICAgIGlmIChnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsU2VsZikge1xuICAgICAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5Qb3J0YWxTZWxmQ2hhbmdlZH1gLCBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsU2VsZilcbiAgICB9XG4gICAgb2JzZXJ2ZVN0b3JlKChwcmVQb3J0YWxTZWxmLCBwb3J0YWxTZWxmKSA9PiB7XG4gICAgICBwdWJsaXNoRXZlbnRUb0FwcChgdG9fYXBwLiR7VG9BcHBNZXNzYWdlLlBvcnRhbFNlbGZDaGFuZ2VkfWAsIHBvcnRhbFNlbGYpXG4gICAgfSwgWydwb3J0YWxTZWxmJ10pXG5cbiAgICAvLyBzeW5jIGFwcEluZm8uXG4gICAgcG9ydGFsVXRpbHMuZ2V0QXBwSW5mbyhnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucXVlcnlPYmplY3Q/LmlkKS50aGVuKGFwcEluZm8gPT4ge1xuICAgICAgcHVibGlzaEV2ZW50VG9BcHAoYHRvX2FwcC4ke1RvQXBwTWVzc2FnZS5BcHBJbmZvQ2hhbmdlZH1gLCBhcHBJbmZvKVxuICAgIH0pXG4gICAgLy8gc3luYyB1c2VyIGluZm9cbiAgICBpZiAoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnVzZXIpIHtcbiAgICAgIHB1Ymxpc2hFdmVudFRvQXBwKGB0b19hcHAuJHtUb0FwcE1lc3NhZ2UuVXNlclNpZ25Jbn1gLCBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkudXNlcilcbiAgICB9XG5cbiAgICAvLyBzeW5jIHNlc3Npb25zXG4gICAgcHVibGlzaENoYW5nZVNlc3Npb25Ub0FwcCgpXG4gIH0pXG59XG4iLCJpbXBvcnQgeyBSZWFjdCwgdHlwZSBJTVN0YXRlLCBLZXlib2FyZCwgUmVhY3RSZWR1eCwgZ2V0QXBwU3RvcmUsIEFwcE1vZGUsIHR5cGUgSU1IaXN0b3J5U3RhdGUgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgKiBhcyBidWlsZGVyQXBwU3luYyBmcm9tICcuLi9saWIvYnVpbGRlci1hcHAtc3luYydcbmltcG9ydCB7IGFwcFN0YXRlSGlzdG9yeUFjdGlvbnMgfSBmcm9tICcuLi9saWIvYXBwLXN0YXRlLWhpc3RvcnktZXh0ZW5zaW9uJ1xuXG5pbnRlcmZhY2UgRXh0cmFQcm9wcyB7XG4gIGN1cnJlbnRQYWdlSWQ6IHN0cmluZ1xuICBzdGF0ZUhpc3Rvcnk/OiBJTUhpc3RvcnlTdGF0ZVxufVxuXG5jbGFzcyBCdWlsZGVyS2V5Ym9hcmRDb21wb25lbnRJbm5lciBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8RXh0cmFQcm9wcywgdW5rbm93bj4ge1xuICBpc1N1cHBvcnRLZXlib2FyZCA9ICgpID0+IHtcbiAgICBsZXQgaXNTdXBwb3J0S2V5Ym9hcmQgPSBmYWxzZVxuXG4gICAgLy8gZm9yIGJ1aWxkZXIgZXhjZXB0IGhvbWUsIHRlbXBsYXRlIHBhZ2VcbiAgICBpZiAod2luZG93LmppbXVDb25maWcuaXNCdWlsZGVyICYmIHRoaXMucHJvcHMuY3VycmVudFBhZ2VJZCAhPT0gJ2hvbWUnICYmIHRoaXMucHJvcHMuY3VycmVudFBhZ2VJZCAhPT0gJ3RlbXBsYXRlJykge1xuICAgICAgaXNTdXBwb3J0S2V5Ym9hcmQgPSB0cnVlXG4gICAgICByZXR1cm4gaXNTdXBwb3J0S2V5Ym9hcmRcbiAgICB9XG5cbiAgICByZXR1cm4gaXNTdXBwb3J0S2V5Ym9hcmRcbiAgfVxuXG4gIHN3aXRjaEFwcE1vZGUgPSAoKSA9PiB7XG4gICAgLy8gd2hlbiBldmVudCBpcyB0cmlnZ2VyZWQgaW4gYnVpbGRlclxuICAgIGNvbnN0IGFwcE1vZGUgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXI/LmFwcFJ1bnRpbWVJbmZvPy5hcHBNb2RlXG4gICAgaWYgKGFwcE1vZGUgPT09IEFwcE1vZGUuUnVuKSB7XG4gICAgICBidWlsZGVyQXBwU3luYy5wdWJsaXNoQXBwTW9kZUNoYW5nZVRvQXBwKEFwcE1vZGUuRGVzaWduKVxuICAgIH0gZWxzZSB7XG4gICAgICBidWlsZGVyQXBwU3luYy5wdWJsaXNoQXBwTW9kZUNoYW5nZVRvQXBwKEFwcE1vZGUuUnVuKVxuICAgIH1cbiAgfVxuXG4gIHVuZG8gPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMuc3RhdGVIaXN0b3J5LnBhc3QubGVuZ3RoIDw9IDEpIHtcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcFN0YXRlSGlzdG9yeUFjdGlvbnMuSW5CdWlsZGVyQXBwQ29uZmlnVW5kbygpKVxuICB9XG5cbiAgcmVkbyA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5wcm9wcy5zdGF0ZUhpc3RvcnkuZnV0dXJlLmxlbmd0aCA8PSAwKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBTdGF0ZUhpc3RvcnlBY3Rpb25zLkluQnVpbGRlckFwcENvbmZpZ1JlZG8oKSlcbiAgfVxuXG4gIG9uS2V5Ym9hcmRUcmlnZ2VyID0gKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgaWYgKCFldmVudC5rZXkuaW5jbHVkZXMoJy1tYW51YWwnKSkge1xuICAgICAgYnVpbGRlckFwcFN5bmMucHVibGlzaEtleWJvYXJkVG9BcHAoZXZlbnQpXG4gICAgfVxuICB9XG5cbiAgaXNNYWMgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHdpbmRvdy5qaW11VUE/Lm9zPy5uYW1lID09PSAnbWFjT1MnXG4gIH1cblxuICByZW5kZXIgKCkge1xuICAgIGlmICh0aGlzLmlzTWFjKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzU3VwcG9ydEtleWJvYXJkKClcbiAgICAgICAgPyA8S2V5Ym9hcmRcbiAgICAgICAgICBvbktleWJvYXJkVHJpZ2dlcj17dGhpcy5vbktleWJvYXJkVHJpZ2dlcn1cbiAgICAgICAgICBiaW5kaW5ncz17e1xuICAgICAgICAgICAgJ3NoaWZ0K2FsdCtrZXl4JzogKCkgPT4geyB0aGlzLnN3aXRjaEFwcE1vZGUoKSB9LFxuICAgICAgICAgICAgJ2NvbW1hbmQra2V5eic6ICgpID0+IHsgdGhpcy51bmRvKCkgfSxcbiAgICAgICAgICAgICdjb21tYW5kK3NoaWZ0K2tleXonOiAoKSA9PiB7IHRoaXMucmVkbygpIH1cbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgICA6IG51bGxcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuaXNTdXBwb3J0S2V5Ym9hcmQoKVxuICAgICAgICA/IDxLZXlib2FyZFxuICAgICAgICAgIG9uS2V5Ym9hcmRUcmlnZ2VyPXt0aGlzLm9uS2V5Ym9hcmRUcmlnZ2VyfVxuICAgICAgICAgIGJpbmRpbmdzPXt7XG4gICAgICAgICAgICAnc2hpZnQrYWx0K2tleXgnOiAoKSA9PiB7IHRoaXMuc3dpdGNoQXBwTW9kZSgpIH0sXG4gICAgICAgICAgICAnY3RybCtrZXl6JzogKCkgPT4geyB0aGlzLnVuZG8oKSB9LFxuICAgICAgICAgICAgJ2N0cmwrc2hpZnQra2V5eic6ICgpID0+IHsgdGhpcy5yZWRvKCkgfVxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICAgIDogbnVsbFxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGU6IElNU3RhdGUpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBjdXJyZW50UGFnZUlkOiBzdGF0ZS5hcHBSdW50aW1lSW5mby5jdXJyZW50UGFnZUlkLFxuICAgIHN0YXRlSGlzdG9yeTogc3RhdGUuYXBwU3RhdGVIaXN0b3J5XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUmVhY3RSZWR1eC5jb25uZWN0PEV4dHJhUHJvcHMsIHVua25vd24sIHVua25vd24+KG1hcFN0YXRlVG9Qcm9wcykoQnVpbGRlcktleWJvYXJkQ29tcG9uZW50SW5uZXIpXG4iLCJpbXBvcnQgeyBpMThuLCBnZXRBcHBTdG9yZSwgYXBwQWN0aW9ucywgdHJhbnNsYXRlZExvY2FsZXMgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgZGVmYXVsdE1lc3NhZ2VzIGZyb20gJy4vdHJhbnNsYXRpb25zL2RlZmF1bHQnXG5cbmFzeW5jIGZ1bmN0aW9uIGxvYWRMb2NhbGVNZXNzYWdlc0ZvckppbXVCdWlsZGVyIChsb2NhbGU6IHN0cmluZywgc3VwcG9ydGVkTG9jYWxlczogc3RyaW5nW10pOiBQcm9taXNlPGFueT4ge1xuICBsb2NhbGUgPSBpMThuLmdldExvY2FsZVRvTG9hZChsb2NhbGUsIHN1cHBvcnRlZExvY2FsZXMpXG4gIGlmIChsb2NhbGUpIHtcbiAgICByZXR1cm4gYXdhaXQgaTE4bi5sb2FkTG9jYWxlTWVzc2FnZXMoJ2ppbXUtZm9yLWJ1aWxkZXIvbGliL3RyYW5zbGF0aW9ucycsIGxvY2FsZSkudGhlbihtZXNzYWdlcyA9PiB7XG4gICAgICByZXR1cm4gbWVzc2FnZXNcbiAgICB9KVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVmYXVsdE1lc3NhZ2VzKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkSTE4bk1lc3NhZ2UgKCk6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IGxvY2FsZSA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBDb250ZXh0LmxvY2FsZVxuICByZXR1cm4gYXdhaXQgbG9hZExvY2FsZU1lc3NhZ2VzRm9ySmltdUJ1aWxkZXIobG9jYWxlLCB0cmFuc2xhdGVkTG9jYWxlcykudGhlbigobWVzc2FnZXMpID0+IHtcbiAgICBtZXNzYWdlcyAmJiBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuaTE4bk1lc3NhZ2VzTG9hZGVkKCdqaW11LWZvci1idWlsZGVyJywgbWVzc2FnZXMpKVxuICAgIGkxOG4ucmVzZXRJbnRscygpXG4gICAgcmV0dXJuIG1lc3NhZ2VzXG4gIH0pXG59XG4iLCJpbXBvcnQgeyB0eXBlIEltbXV0YWJsZU9iamVjdCwgSW1tdXRhYmxlLCB0eXBlIElNU3RhdGUsIHR5cGUgZXh0ZW5zaW9uU3BlYyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgUmVzb3VyY2VJdGVtSW5mbyB9IGZyb20gJy4vYXBwLXJlc291cmNlLW1hbmFnZXInXG5cbnR5cGUgSU1SZXNvdXJjZXNJbmZvID0gSW1tdXRhYmxlT2JqZWN0PHsgW3Jlc291cmNlS2V5OiBzdHJpbmddOiBJbW11dGFibGVPYmplY3Q8UmVzb3VyY2VJdGVtSW5mbz4gfT5cblxuZGVjbGFyZSBtb2R1bGUgJ2ppbXUtY29yZS9saWIvdHlwZXMvc3RhdGUne1xuICBpbnRlcmZhY2UgU3RhdGUge1xuICAgIHJlc291cmNlc0luZm8/OiBJTVJlc291cmNlc0luZm9cbiAgfVxufVxuZGVjbGFyZSBtb2R1bGUgJ2ppbXUtY29yZSd7XG4gIGludGVyZmFjZSBTdGF0ZSB7XG4gICAgcmVzb3VyY2VzSW5mbz86IElNUmVzb3VyY2VzSW5mb1xuICB9XG59XG5cbmVudW0gQWN0aW9uS2V5cyB7XG4gIEFkZFJlc291cmNlID0gJ0FERF9SRVNPVVJDRScsXG4gIFVwZGF0ZVJlc291cmNlID0gJ1VQREFURV9SRVNPVVJDRScsXG4gIENsZWFyUmVzb3VyY2VzID0gJ0NMRUFSX1JFU09VUkNFUydcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBZGRSZXNvdXJjZUFjdGlvbiB7XG4gIHR5cGU6IEFjdGlvbktleXMuQWRkUmVzb3VyY2VcbiAgcmVzb3VyY2VLZXk6IHN0cmluZ1xuICByZXNvdXJjZUl0ZW1JbmZvOiBSZXNvdXJjZUl0ZW1JbmZvXG59XG5leHBvcnQgaW50ZXJmYWNlIFVwZGF0ZVJlc291cmNlQWN0aW9uIHtcbiAgdHlwZTogQWN0aW9uS2V5cy5VcGRhdGVSZXNvdXJjZVxuICByZXNvdXJjZUtleTogc3RyaW5nXG4gIHJlc291cmNlSXRlbUluZm86IFJlc291cmNlSXRlbUluZm9cbn1cbmV4cG9ydCBpbnRlcmZhY2UgQ2xlYXJSZXNvdXJjZXNBY3Rpb24ge1xuICB0eXBlOiBBY3Rpb25LZXlzLkNsZWFyUmVzb3VyY2VzXG59XG5cbnR5cGUgQWN0aW9uVHlwZXMgPSBBZGRSZXNvdXJjZUFjdGlvbiB8IFVwZGF0ZVJlc291cmNlQWN0aW9uIHwgQ2xlYXJSZXNvdXJjZXNBY3Rpb25cblxuY29uc3QgYWN0aW9ucyA9IHtcblxuICBBZGRSZXNvdXJjZTogKHJlc291cmNlS2V5OiBzdHJpbmcsIHJlc291cmNlSXRlbUluZm86IFJlc291cmNlSXRlbUluZm8pOiBBZGRSZXNvdXJjZUFjdGlvbiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuQWRkUmVzb3VyY2UsXG4gICAgICByZXNvdXJjZUtleTogcmVzb3VyY2VLZXksXG4gICAgICByZXNvdXJjZUl0ZW1JbmZvOiByZXNvdXJjZUl0ZW1JbmZvXG4gICAgfVxuICB9LFxuXG4gIFVwZGF0ZVJlc291cmNlOiAocmVzb3VyY2VLZXk6IHN0cmluZywgcmVzb3VyY2VJdGVtSW5mbzogUmVzb3VyY2VJdGVtSW5mbyk6IFVwZGF0ZVJlc291cmNlQWN0aW9uID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogQWN0aW9uS2V5cy5VcGRhdGVSZXNvdXJjZSxcbiAgICAgIHJlc291cmNlS2V5OiByZXNvdXJjZUtleSxcbiAgICAgIHJlc291cmNlSXRlbUluZm86IHJlc291cmNlSXRlbUluZm9cbiAgICB9XG4gIH0sXG5cbiAgQ2xlYXJSZXNvdXJjZXM6ICgpOiBDbGVhclJlc291cmNlc0FjdGlvbiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuQ2xlYXJSZXNvdXJjZXNcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IHsgYWN0aW9ucyBhcyBidWlsZGVyU3RhdGVSZXNvdXJjZUFjdGlvbnMsIEFjdGlvbktleXMgYXMgQnVpbGRlclN0YXRlUmVzb3VyY2VBY3Rpb25LZXlzIH1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQnVpbGRlclN0YXRlUmVzb3VyY2VFeHRlbnNpb24gaW1wbGVtZW50cyBleHRlbnNpb25TcGVjLlJlZHV4U3RvcmVFeHRlbnNpb24ge1xuICBpZCA9ICdidWlsZGVyLXN0YXRlLXJlc291cmNlLWV4dGVuc2lvbidcblxuICBnZXRBY3Rpb25zICgpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoQWN0aW9uS2V5cykubWFwKGsgPT4gQWN0aW9uS2V5c1trXSlcbiAgfVxuXG4gIGdldEluaXRMb2NhbFN0YXRlICgpOiBJTVJlc291cmNlc0luZm8ge1xuICAgIHJldHVybiBJbW11dGFibGUoe30gYXMgYW55KVxuICB9XG5cbiAgZ2V0UmVkdWNlciAoKSB7XG4gICAgcmV0dXJuIChyZXNvdXJjZXNJbmZvOiBJTVJlc291cmNlc0luZm8sIGFjdGlvbjogQWN0aW9uVHlwZXMsIGJ1aWxkZXJGdWxsU3RhdGU6IElNU3RhdGUpID0+IHtcbiAgICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLkFkZFJlc291cmNlOlxuICAgICAgICAgIHJldHVybiByZXNvdXJjZXNJbmZvLnNldChhY3Rpb24ucmVzb3VyY2VLZXksIGFjdGlvbi5yZXNvdXJjZUl0ZW1JbmZvKVxuICAgICAgICBjYXNlIEFjdGlvbktleXMuVXBkYXRlUmVzb3VyY2U6XG4gICAgICAgICAgcmV0dXJuIHJlc291cmNlc0luZm8uc2V0KGFjdGlvbi5yZXNvdXJjZUtleSwgYWN0aW9uLnJlc291cmNlSXRlbUluZm8pXG4gICAgICAgIGNhc2UgQWN0aW9uS2V5cy5DbGVhclJlc291cmNlczpcbiAgICAgICAgICBjb25zdCB0ZW1wUmVzb3VyY2VJbmZvID0gSW1tdXRhYmxlKHt9IGFzIGFueSlcbiAgICAgICAgICByZXR1cm4gdGVtcFJlc291cmNlSW5mb1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiByZXNvdXJjZXNJbmZvXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0U3RvcmVLZXkgKCkge1xuICAgIHJldHVybiAncmVzb3VyY2VzSW5mbydcbiAgfVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJTVJ1bnRpbWVJbmZvcywgdHlwZSBJbW11dGFibGVPYmplY3QsIEltbXV0YWJsZSwgdHlwZSBMYXlvdXRJbmZvLCB0eXBlIElNU3RhdGUsIHR5cGUgZXh0ZW5zaW9uU3BlYyB9IGZyb20gJ2ppbXUtY29yZSdcblxuaW1wb3J0IHsgdHlwZSBUb29sYmFyQ29uZmlnIH0gZnJvbSAnamltdS1sYXlvdXRzL2xheW91dC1ydW50aW1lJ1xuXG5pbnRlcmZhY2UgQnVpbGRlclN0YXRlIHtcbiAgdGVtcGxhdGVOYW1lOiBzdHJpbmdcbiAgc2hvd0Nob29zZVdpZGdldFBvcHVwOiBib29sZWFuXG5cbiAgY3VycmVudEFwcElkOiBzdHJpbmcgLy8gYXBwIGlkIG9yIGFwcCBjb25maWcgdXJsXG5cbiAgd2lkZ2V0c1NldHRpbmdSdW50aW1lSW5mbz86IElNUnVudGltZUluZm9zXG4gIHdpZGdldHNTZXR0aW5nQ2xhc3NTdGF0dXM6IEltbXV0YWJsZU9iamVjdDx7IFt3aWRnZXRVcmk6IHN0cmluZ106IGJvb2xlYW4gfT5cblxuICB3aWRnZXRTZXR0aW5nSTE4bk1lc3NhZ2VzOiBJbW11dGFibGVPYmplY3Q8eyBbd2lkZ2V0TmFtZTogc3RyaW5nXTogYW55IH0+XG5cbiAgcmVmcmVzaEFwcExpc3Q6IGJvb2xlYW5cblxuICB0b29sYmFyQ29uZmlnPzogVG9vbGJhckNvbmZpZ1xuXG4gIGN1cnJlbnRHdWlkZUlkPzogc3RyaW5nIC8vIGd1aWRlIGlkIChjb21tb24gZ3VpZGUpIG9yIHVybCB3aWRnZXQgdXJsICh3aWRnZXQgZ3VpZGUpXG5cbiAgLy8gTmVlZCB0byBjb25maXJtIGJlZm9yZSBkZWxldGluZyB3aWRnZXQgb3Igc2VjdGlvbiBpbiBjdXN0b20gbGF5b3V0IG9mIGEgc2l6ZSBtb2RlXG4gIGNvbnRlbnRUb0RlbGV0ZT86IExheW91dEluZm9cbn1cbnR5cGUgSU1CdWlsZGVyU3RhdGUgPSBJbW11dGFibGVPYmplY3Q8QnVpbGRlclN0YXRlPlxuLyoqXG4gKiBUbyBzaW1wbGlmeSB0aGUgYnVpbGRlciB3aWRnZXRzIGNvbW11bmljYXRpb24sIHdlIHN0b3JlIGEgc2hhcmVkIHN0YXRlIGluIHN0b3JlXG4gKi9cbmRlY2xhcmUgbW9kdWxlICdqaW11LWNvcmUvbGliL3R5cGVzL3N0YXRlJ3tcbiAgaW50ZXJmYWNlIFN0YXRlIHtcbiAgICBidWlsZGVyPzogSU1CdWlsZGVyU3RhdGVcbiAgfVxufVxuZGVjbGFyZSBtb2R1bGUgJ2ppbXUtY29yZSd7XG4gIGludGVyZmFjZSBTdGF0ZSB7XG4gICAgYnVpbGRlcj86IElNQnVpbGRlclN0YXRlXG4gIH1cbn1cblxuZW51bSBBY3Rpb25LZXlzIHtcbiAgU2VsZWN0VGVtcGxhdGUgPSAnU0VMRUNUX1RFTVBMQVRFJyxcbiAgT3BlbkNob29zZVdpZGdldFBvcHVwID0gJ09QRU5fQ0hPT1NFX1dJREdFVF9QT1BVUCcsXG4gIENsb3NlQ2hvb3NlV2lkZ2V0UG9wdXAgPSAnQ0xPU0VfQ0hPT1NFX1dJREdFVF9QT1BVUCcsXG5cbiAgV2lkZ2V0U2V0dGluZ0NsYXNzTG9hZGVkID0gJ1dJREdFVF9TRVRUSU5HX0NMQVNTX0xPQURFRCcsXG4gIFdpZGdldHNSZW1vdmVkID0gJ1dJREdFVFNfUkVNT1ZFRCcsXG4gIFdpZGdldHNBZGRlZCA9ICdXSURHRVRTX0FEREVEJyxcblxuICBDaGFuZ2VDdXJyZW50QXBwID0gJ0NIQU5HRV9DVVJSRU5UX0FQUCcsXG4gIFJlZnJlc2hBcHBMaXN0ID0gJ1JFRlJTSF9BUFBMSVNUJyxcbiAgU2V0TGF5b3V0VG9vbHMgPSAnU0VUX0xBWU9VVF9UT09MUycsXG5cbiAgU3RhcnRHdWlkZSA9ICdTVEFSVF9HVUlERScsXG4gIFN0b3BHdWlkZSA9ICdTVE9QX0dVSURFJyxcblxuICBXaWRnZXRTZXR0aW5nSTE4bk1lc3NhZ2VMb2FkZWQgPSAnV0lER0VUX1NFVFRJTkdfSTE4Tl9NRVNTQUdFX0xPQURFRCcsXG5cbiAgQ29uZmlybURlbGV0ZUNvbnRlbnRDaGFuZ2VkID0gJ0NPTkZJUk1fREVMRVRFX0NPTlRFTlRfQ0hBTkdFRCcsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0VGVtcGxhdGVBY3Rpb24ge1xuICB0eXBlOiBBY3Rpb25LZXlzLlNlbGVjdFRlbXBsYXRlXG4gIHRlbXBsYXRlTmFtZTogc3RyaW5nXG59XG5leHBvcnQgaW50ZXJmYWNlIFNob3dDaG9vc2VXaWRnZXRQb3B1cEFjdGlvbiB7XG4gIHR5cGU6IEFjdGlvbktleXMuT3BlbkNob29zZVdpZGdldFBvcHVwXG4gIGxheW91dElkOiBzdHJpbmdcbiAgbGF5b3V0SXRlbUlkOiBzdHJpbmdcbn1cbmV4cG9ydCBpbnRlcmZhY2UgQ2xvc2VDaG9vc2VXaWRnZXRQb3B1cEFjdGlvbiB7XG4gIHR5cGU6IEFjdGlvbktleXMuQ2xvc2VDaG9vc2VXaWRnZXRQb3B1cFxufVxuZXhwb3J0IGludGVyZmFjZSBXaWRnZXRTZXR0aW5nQ2xhc3NMb2FkZWRBY3Rpb24ge1xuICB0eXBlOiBBY3Rpb25LZXlzLldpZGdldFNldHRpbmdDbGFzc0xvYWRlZFxuICB3aWdldFVyaTogc3RyaW5nXG59XG5leHBvcnQgaW50ZXJmYWNlIFdpZGdldHNBZGRlZEFjdGlvbiB7XG4gIHR5cGU6IEFjdGlvbktleXMuV2lkZ2V0c0FkZGVkXG4gIHdpZGdldHM6IEFycmF5PHsgd2lkZ2V0SWQ6IHN0cmluZywgd2lkZ2V0VXJpOiBzdHJpbmcgfT5cbn1cbmV4cG9ydCBpbnRlcmZhY2UgV2lkZ2V0c1JlbW92ZWRBY3Rpb24ge1xuICB0eXBlOiBBY3Rpb25LZXlzLldpZGdldHNSZW1vdmVkXG4gIHdpZGdldElkczogc3RyaW5nW11cbn1cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhbmdlQ3VycmVudEFwcEFjdGlvbiB7XG4gIHR5cGU6IEFjdGlvbktleXMuQ2hhbmdlQ3VycmVudEFwcFxuICBhcHBJZDogc3RyaW5nXG59XG5leHBvcnQgaW50ZXJmYWNlIFJlZnJlc2hBcHBMaXN0QWN0aW9uIHtcbiAgdHlwZTogQWN0aW9uS2V5cy5SZWZyZXNoQXBwTGlzdFxuICBpc1JlZnJlc2g6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXRMYXlvdXRUb29sc0FjdGlvbiB7XG4gIHR5cGU6IEFjdGlvbktleXMuU2V0TGF5b3V0VG9vbHNcbiAgdG9vbHM6IFRvb2xiYXJDb25maWdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFydEd1aWRlQWN0aW9uIHtcbiAgdHlwZTogQWN0aW9uS2V5cy5TdGFydEd1aWRlXG4gIGd1aWRlSWQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0b3BHdWlkZUFjdGlvbiB7XG4gIHR5cGU6IEFjdGlvbktleXMuU3RvcEd1aWRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2lkZ2V0U2V0dGluZ0kxOG5NZXNzYWdlTG9hZGVkQWN0aW9uIHtcbiAgdHlwZTogQWN0aW9uS2V5cy5XaWRnZXRTZXR0aW5nSTE4bk1lc3NhZ2VMb2FkZWRcbiAgd2lkZ2V0TmFtZTogc3RyaW5nXG4gIGkxOG5NZXNzYWdlczogYW55XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlybURlbGV0ZUNvbnRlbnRDaGFuZ2VkQWN0aW9uIHtcbiAgdHlwZTogQWN0aW9uS2V5cy5Db25maXJtRGVsZXRlQ29udGVudENoYW5nZWRcbiAgaXRlbVRvRGVsZXRlOiBMYXlvdXRJbmZvXG59XG5cbnR5cGUgQWN0aW9uVHlwZXMgPSBTZWxlY3RUZW1wbGF0ZUFjdGlvbiB8IFNob3dDaG9vc2VXaWRnZXRQb3B1cEFjdGlvbiB8IENsb3NlQ2hvb3NlV2lkZ2V0UG9wdXBBY3Rpb24gfCBXaWRnZXRTZXR0aW5nQ2xhc3NMb2FkZWRBY3Rpb24gfFxuV2lkZ2V0c0FkZGVkQWN0aW9uIHwgV2lkZ2V0c1JlbW92ZWRBY3Rpb24gfCBSZWZyZXNoQXBwTGlzdEFjdGlvbiB8IENoYW5nZUN1cnJlbnRBcHBBY3Rpb24gfCBTZXRMYXlvdXRUb29sc0FjdGlvbiB8XG5TdGFydEd1aWRlQWN0aW9uIHwgU3RvcEd1aWRlQWN0aW9uIHwgV2lkZ2V0U2V0dGluZ0kxOG5NZXNzYWdlTG9hZGVkQWN0aW9uIHwgQ29uZmlybURlbGV0ZUNvbnRlbnRDaGFuZ2VkQWN0aW9uXG5cbmV4cG9ydCB7IEFjdGlvbktleXMgYXMgQnVpbGRlclN0YXRlQWN0aW9uVHlwZXMgfVxuXG5jb25zdCBhY3Rpb25zID0ge1xuICBzZWxlY3RUZW1wbGF0ZTogKHRlbXBsYXRlTmFtZTogc3RyaW5nKTogU2VsZWN0VGVtcGxhdGVBY3Rpb24gPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLlNlbGVjdFRlbXBsYXRlLFxuICAgICAgdGVtcGxhdGVOYW1lOiB0ZW1wbGF0ZU5hbWVcbiAgICB9XG4gIH0sXG5cbiAgcmVmcmVzaEFwcExpc3RBY3Rpb246IChpc1JlZnJlc2g6IGJvb2xlYW4pOiBSZWZyZXNoQXBwTGlzdEFjdGlvbiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuUmVmcmVzaEFwcExpc3QsXG4gICAgICBpc1JlZnJlc2g6IGlzUmVmcmVzaFxuICAgIH1cbiAgfSxcblxuICBvcGVuQ2hvb3NlV2lkZ2V0UG9wdXA6IChsYXlvdXRJZDogc3RyaW5nLCBsYXlvdXRJdGVtSWQ6IHN0cmluZyk6IFNob3dDaG9vc2VXaWRnZXRQb3B1cEFjdGlvbiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuT3BlbkNob29zZVdpZGdldFBvcHVwLFxuICAgICAgbGF5b3V0SWQ6IGxheW91dElkLFxuICAgICAgbGF5b3V0SXRlbUlkOiBsYXlvdXRJdGVtSWRcbiAgICB9XG4gIH0sXG5cbiAgY2xvc2VDaG9vc2VXaWRnZXRQb3B1cDogKCk6IENsb3NlQ2hvb3NlV2lkZ2V0UG9wdXBBY3Rpb24gPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLkNsb3NlQ2hvb3NlV2lkZ2V0UG9wdXBcbiAgICB9XG4gIH0sXG5cbiAgd2lkZ2V0U2V0dGluZ0NsYXNzTG9hZGVkOiAod2lnZXRVcmk6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLldpZGdldFNldHRpbmdDbGFzc0xvYWRlZCxcbiAgICAgIHdpZ2V0VXJpXG4gICAgfVxuICB9LFxuXG4gIHdpZGdldHNBZGRlZDogKHdpZGdldHM6IEFycmF5PHsgd2lkZ2V0SWQ6IHN0cmluZywgd2lkZ2V0VXJpOiBzdHJpbmcgfT4pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogQWN0aW9uS2V5cy5XaWRnZXRzQWRkZWQsXG4gICAgICB3aWRnZXRzXG4gICAgfVxuICB9LFxuXG4gIHdpZGdldHNSZW1vdmVkOiAod2lkZ2V0SWRzOiBzdHJpbmdbXSkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLldpZGdldHNSZW1vdmVkLFxuICAgICAgd2lkZ2V0SWRzXG4gICAgfVxuICB9LFxuXG4gIGNoYW5nZUN1cnJlbnRBcHA6IChhcHBJZDogc3RyaW5nKTogQ2hhbmdlQ3VycmVudEFwcEFjdGlvbiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuQ2hhbmdlQ3VycmVudEFwcCxcbiAgICAgIGFwcElkOiBhcHBJZFxuICAgIH1cbiAgfSxcblxuICBzZXRMYXlvdXRUb29sczogKHRvb2xzOiBUb29sYmFyQ29uZmlnKTogU2V0TGF5b3V0VG9vbHNBY3Rpb24gPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLlNldExheW91dFRvb2xzLFxuICAgICAgdG9vbHM6IHRvb2xzXG4gICAgfVxuICB9LFxuXG4gIHN0YXJ0R3VpZGU6IChndWlkZUlkOiBzdHJpbmcpOiBTdGFydEd1aWRlQWN0aW9uID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogQWN0aW9uS2V5cy5TdGFydEd1aWRlLFxuICAgICAgZ3VpZGVJZDogZ3VpZGVJZFxuICAgIH1cbiAgfSxcblxuICBzdG9wR3VpZGU6ICgpOiBTdG9wR3VpZGVBY3Rpb24gPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLlN0b3BHdWlkZVxuICAgIH1cbiAgfSxcblxuICB3aWRnZXRTZXR0aW5nSTE4bk1lc3NhZ2VMb2FkZWQ6ICh3aWRnZXROYW1lOiBzdHJpbmcsIGkxOG5NZXNzYWdlcyk6IFdpZGdldFNldHRpbmdJMThuTWVzc2FnZUxvYWRlZEFjdGlvbiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IEFjdGlvbktleXMuV2lkZ2V0U2V0dGluZ0kxOG5NZXNzYWdlTG9hZGVkLFxuICAgICAgd2lkZ2V0TmFtZSxcbiAgICAgIGkxOG5NZXNzYWdlc1xuICAgIH1cbiAgfSxcblxuICBjb25maXJtRGVsZXRlQ29udGVudENoYW5nZWQ6IChpdGVtVG9EZWxldGU6IExheW91dEluZm8pOiBDb25maXJtRGVsZXRlQ29udGVudENoYW5nZWRBY3Rpb24gPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBBY3Rpb25LZXlzLkNvbmZpcm1EZWxldGVDb250ZW50Q2hhbmdlZCxcbiAgICAgIGl0ZW1Ub0RlbGV0ZVxuICAgIH1cbiAgfVxuXG59XG5cbmV4cG9ydCB7IGFjdGlvbnMgYXMgYnVpbGRlckFjdGlvbnMsIEFjdGlvbktleXMgYXMgYnVpbGRlckFjdGlvbktleXMgfVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCdWlsZGVyU3RhdGVSZWR1eFN0b3JlRXh0ZW5zaW9uIGltcGxlbWVudHMgZXh0ZW5zaW9uU3BlYy5SZWR1eFN0b3JlRXh0ZW5zaW9uIHtcbiAgaWQgPSAnYnVpbGRlci1zdGF0ZS1yZWR1eC1zdG9yZS1leHRlbnNpb24nXG5cbiAgZ2V0QWN0aW9ucyAoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKEFjdGlvbktleXMpLm1hcChrID0+IEFjdGlvbktleXNba10pXG4gIH1cblxuICBnZXRJbml0TG9jYWxTdGF0ZSAoKTogSU1CdWlsZGVyU3RhdGUge1xuICAgIHJldHVybiBJbW11dGFibGUoe1xuICAgICAgdGVtcGxhdGVOYW1lOiBudWxsLFxuICAgICAgc2hvd0Nob29zZVdpZGdldFBvcHVwOiBmYWxzZSxcbiAgICAgIGN1cnJlbnRBcHBJZDogbnVsbCxcbiAgICAgIHJlZnJlc2hBcHBMaXN0OiBmYWxzZSxcbiAgICAgIGlzTW9iaWxlOiBmYWxzZSxcbiAgICAgIGN1cnJlbnRHdWlkZUlkOiBudWxsLFxuICAgICAgd2lkZ2V0U2V0dGluZ0kxOG5NZXNzYWdlczogSW1tdXRhYmxlKHt9KSxcbiAgICAgIHdpZGdldHNTZXR0aW5nQ2xhc3NTdGF0dXM6IEltbXV0YWJsZSh7fSBhcyBhbnkpXG4gICAgfSlcbiAgfVxuXG4gIGdldFJlZHVjZXIgKCkge1xuICAgIHJldHVybiAoYnVpbGRlclN0YXRlOiBJTUJ1aWxkZXJTdGF0ZSwgYWN0aW9uOiBBY3Rpb25UeXBlcywgYnVpbGRlckZ1bGxTdGF0ZTogSU1TdGF0ZSkgPT4ge1xuICAgICAgLy8gbGV0IHM7XG4gICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgQWN0aW9uS2V5cy5TZWxlY3RUZW1wbGF0ZTpcbiAgICAgICAgICByZXR1cm4gYnVpbGRlclN0YXRlLnNldCgndGVtcGxhdGVOYW1lJywgYWN0aW9uLnRlbXBsYXRlTmFtZSlcbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLk9wZW5DaG9vc2VXaWRnZXRQb3B1cDpcbiAgICAgICAgICByZXR1cm4gYnVpbGRlclN0YXRlLnNldCgnc2hvd0Nob29zZVdpZGdldFBvcHVwJywgdHJ1ZSlcbiAgICAgICAgICAgIC5zZXQoJ2N1cnJlbnRMYXlvdXQnLCBJbW11dGFibGUoe1xuICAgICAgICAgICAgICBsYXlvdXRJZDogYWN0aW9uLmxheW91dElkLFxuICAgICAgICAgICAgICBsYXlvdXRJdGVtSWQ6IGFjdGlvbi5sYXlvdXRJdGVtSWRcbiAgICAgICAgICAgIH0pKVxuICAgICAgICBjYXNlIEFjdGlvbktleXMuQ2xvc2VDaG9vc2VXaWRnZXRQb3B1cDpcbiAgICAgICAgICByZXR1cm4gYnVpbGRlclN0YXRlLnNldCgnc2hvd0Nob29zZVdpZGdldFBvcHVwJywgZmFsc2UpXG5cbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLldpZGdldFNldHRpbmdDbGFzc0xvYWRlZDpcbiAgICAgICAgICBidWlsZGVyU3RhdGUgPSBidWlsZGVyU3RhdGUuc2V0SW4oWyd3aWRnZXRzU2V0dGluZ0NsYXNzU3RhdHVzJywgYWN0aW9uLndpZ2V0VXJpXSwgdHJ1ZSlcbiAgICAgICAgICBnZXRXaWRnZXRJZHNCeVVyaShidWlsZGVyRnVsbFN0YXRlLCBhY3Rpb24ud2lnZXRVcmkpLmZvckVhY2god0lkID0+IHtcbiAgICAgICAgICAgIGJ1aWxkZXJTdGF0ZSA9IGJ1aWxkZXJTdGF0ZS5zZXRJbihbJ3dpZGdldHNTZXR0aW5nUnVudGltZUluZm8nLCB3SWQsICdpc0NsYXNzTG9hZGVkJ10sIHRydWUpXG4gICAgICAgICAgfSlcbiAgICAgICAgICByZXR1cm4gYnVpbGRlclN0YXRlXG5cbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLldpZGdldHNBZGRlZDpcbiAgICAgICAgICBhY3Rpb24ud2lkZ2V0cy5mb3JFYWNoKHcgPT4ge1xuICAgICAgICAgICAgaWYgKGJ1aWxkZXJTdGF0ZS53aWRnZXRzU2V0dGluZ0NsYXNzU3RhdHVzW3cud2lkZ2V0VXJpXSkge1xuICAgICAgICAgICAgICBidWlsZGVyU3RhdGUgPSBidWlsZGVyU3RhdGUuc2V0SW4oWyd3aWRnZXRzU2V0dGluZ1J1bnRpbWVJbmZvJywgdy53aWRnZXRJZCwgJ2lzQ2xhc3NMb2FkZWQnXSwgdHJ1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICAgIHJldHVybiBidWlsZGVyU3RhdGVcblxuICAgICAgICBjYXNlIEFjdGlvbktleXMuV2lkZ2V0c1JlbW92ZWQ6XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkZXJTdGF0ZS5zZXQoJ3dpZGdldHNTZXR0aW5nUnVudGltZUluZm8nLCBidWlsZGVyU3RhdGUud2lkZ2V0c1NldHRpbmdSdW50aW1lSW5mby53aXRob3V0KC4uLmFjdGlvbi53aWRnZXRJZHMpKVxuXG4gICAgICAgIGNhc2UgQWN0aW9uS2V5cy5DaGFuZ2VDdXJyZW50QXBwOlxuICAgICAgICAgIGJ1aWxkZXJTdGF0ZSA9IHRoaXMuZ2V0SW5pdExvY2FsU3RhdGUoKVxuICAgICAgICAgIHJldHVybiBidWlsZGVyU3RhdGUuc2V0KCdjdXJyZW50QXBwSWQnLCBhY3Rpb24uYXBwSWQpLnNldCgnd2lkZ2V0c1NldHRpbmdSdW50aW1lSW5mbycsIHt9KVxuICAgICAgICBjYXNlIEFjdGlvbktleXMuUmVmcmVzaEFwcExpc3Q6XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkZXJTdGF0ZS5zZXQoJ3JlZnJlc2hBcHBMaXN0JywgYWN0aW9uLmlzUmVmcmVzaClcblxuICAgICAgICBjYXNlIEFjdGlvbktleXMuU2V0TGF5b3V0VG9vbHM6XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkZXJTdGF0ZS5zZXQoJ3Rvb2xiYXJDb25maWcnLCBhY3Rpb24udG9vbHMpXG5cbiAgICAgICAgY2FzZSBBY3Rpb25LZXlzLlN0YXJ0R3VpZGU6XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkZXJTdGF0ZS5zZXQoJ2N1cnJlbnRHdWlkZUlkJywgYWN0aW9uLmd1aWRlSWQpXG4gICAgICAgIGNhc2UgQWN0aW9uS2V5cy5TdG9wR3VpZGU6XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkZXJTdGF0ZS5zZXQoJ2N1cnJlbnRHdWlkZUlkJywgbnVsbClcblxuICAgICAgICBjYXNlIEFjdGlvbktleXMuV2lkZ2V0U2V0dGluZ0kxOG5NZXNzYWdlTG9hZGVkOlxuICAgICAgICAgIHJldHVybiBidWlsZGVyU3RhdGUuc2V0SW4oWyd3aWRnZXRTZXR0aW5nSTE4bk1lc3NhZ2VzJywgYWN0aW9uLndpZGdldE5hbWVdLCBhY3Rpb24uaTE4bk1lc3NhZ2VzKVxuXG4gICAgICAgIGNhc2UgQWN0aW9uS2V5cy5Db25maXJtRGVsZXRlQ29udGVudENoYW5nZWQ6IHtcbiAgICAgICAgICBjb25zdCB7IGl0ZW1Ub0RlbGV0ZSB9ID0gYWN0aW9uXG4gICAgICAgICAgcmV0dXJuIGJ1aWxkZXJTdGF0ZS5zZXQoJ2NvbnRlbnRUb0RlbGV0ZScsIGl0ZW1Ub0RlbGV0ZSlcbiAgICAgICAgfVxuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIGJ1aWxkZXJTdGF0ZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldFN0b3JlS2V5ICgpIHtcbiAgICByZXR1cm4gJ2J1aWxkZXInXG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0V2lkZ2V0SWRzQnlVcmkgKGJ1aWxkZXJGdWxsU3RhdGU6IElNU3RhdGUsIHdpZ2V0VXJpOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHdpZGdldHMgPSBidWlsZGVyRnVsbFN0YXRlLmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBDb25maWc/LndpZGdldHMgfHwge31cbiAgY29uc3Qgd2lkZ2V0SWRzID0gT2JqZWN0LmtleXMod2lkZ2V0cykuZmlsdGVyKHdJZCA9PiB3aWRnZXRzW3dJZF0udXJpID09PSB3aWdldFVyaSlcbiAgcmV0dXJuIHdpZGdldElkc1xufVxuIiwiaW1wb3J0IEFwcE1lc3NhZ2VNYW5hZ2VyIGZyb20gJy4uL2xpYi9hcHAtbWVzc2FnZS1tYW5hZ2VyJ1xuaW1wb3J0IEZpbHRlckRhdGFSZWNvcmRBY3Rpb25TZXR0aW5nIGZyb20gJy4uL2xpYi9tZXNzYWdlLWFjdGlvbnMvZmlsdGVyLWRhdGEtcmVjb3JkLWFjdGlvbi1zZXR0aW5nJ1xuaW1wb3J0IFNlbGVjdERhdGFSZWNvcmRBY3Rpb25TZXR0aW5nIGZyb20gJy4uL2xpYi9tZXNzYWdlLWFjdGlvbnMvc2VsZWN0LWRhdGEtcmVjb3JkLWFjdGlvbi1zZXR0aW5nJ1xuaW1wb3J0IHsgbG9hZEkxOG5NZXNzYWdlIH0gZnJvbSAnLi9idWlsZGVyLWxvY2FsZSdcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXQgKCk6IFByb21pc2U8YW55PiB7XG4gIHJlZ2lzdGVyQWN0aW9uU2V0dGluZ0NsYXNzSW5mb0ZvckJ1aWxkZXIoKVxuICBhd2FpdCBsb2FkSTE4bk1lc3NhZ2UoKVxuICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHt9KVxufVxuXG5mdW5jdGlvbiByZWdpc3RlckFjdGlvblNldHRpbmdDbGFzc0luZm9Gb3JCdWlsZGVyICgpOiB2b2lkIHtcbiAgQXBwTWVzc2FnZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5yZWdpc3RlckFjdGlvblJhd1NldHRpbmdDbGFzcygnZmlsdGVyLWRhdGEtcmVjb3JkLWFjdGlvbicsIEZpbHRlckRhdGFSZWNvcmRBY3Rpb25TZXR0aW5nKVxuICBBcHBNZXNzYWdlTWFuYWdlci5nZXRJbnN0YW5jZSgpLnJlZ2lzdGVyQWN0aW9uUmF3U2V0dGluZ0NsYXNzKCdzZWxlY3QtZGF0YS1yZWNvcmQtYWN0aW9uJywgU2VsZWN0RGF0YVJlY29yZEFjdGlvblNldHRpbmcpXG59XG4iLCIvKiogQGpzeCBqc3ggKi9cbmltcG9ydCB7XG4gIFJlYWN0LCBjc3MsIGpzeCwgdHlwZSBBY3Rpb25TZXR0aW5nUHJvcHMsIHR5cGUgU2VyaWFsaXplZFN0eWxlcywgdHlwZSBJbW11dGFibGVPYmplY3QsIHR5cGUgRGF0YVNvdXJjZSwgdHlwZSBEYXRhU291cmNlSW5mbyxcbiAgdHlwZSBJTVRoZW1lVmFyaWFibGVzLCBwb2xpc2hlZCwgZ2V0QXBwU3RvcmUsIEltbXV0YWJsZSwgdHlwZSBEYXRhU291cmNlSnNvbixcbiAgdHlwZSBVc2VEYXRhU291cmNlLCBEYXRhU291cmNlQ29tcG9uZW50LCB0eXBlIElNVXNlRGF0YVNvdXJjZSwgdHlwZSBJTUZpZWxkU2NoZW1hLCB0eXBlIElNU3RhdGUsIFJlYWN0UmVkdXgsIHR5cGUgSU1TcWxFeHByZXNzaW9uLFxuICBkYXRhU291cmNlVXRpbHMsIERhdGFTb3VyY2VNYW5hZ2VyLCBtb2R1bGVMb2FkZXIsIE1lc3NhZ2VUeXBlLCBTcWxFeHByZXNzaW9uTW9kZSwgdHlwZSBTcWxFeHByZXNzaW9uLCBBbGxEYXRhU291cmNlVHlwZXNcbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgd2l0aFRoZW1lIH0gZnJvbSAnamltdS10aGVtZSdcbmltcG9ydCBkZWZhdWx0TWVzc2FnZXMgZnJvbSAnLi4vdHJhbnNsYXRpb25zL2RlZmF1bHQnXG5pbXBvcnQgeyBnZXREc1NlbGVjdG9yU291cmNlRGF0YSwgY2hlY2tBbmRHZXRJbml0VXNlRGF0YVNvdXJjZSwgY2hlY2tUcmlnZXJMYXllcklzU2FtZVRvQWN0aW9uTGF5ZXIsIGdldERzQnlXaWRnZXRJZCB9IGZyb20gJy4vaW5pdCdcbmltcG9ydCB7IHR5cGUgSU1Db25maWcgfSBmcm9tICcuL3R5cGUnXG5pbXBvcnQgeyBMaW5rQ29tYmluZWRPdXRsaW5lZCB9IGZyb20gJ2ppbXUtaWNvbnMvb3V0bGluZWQvZGF0YS9saW5rLWNvbWJpbmVkJ1xuaW50ZXJmYWNlIFN0YXRlRXh0cmFQcm9wcyB7XG4gIGRhdGFTb3VyY2VzOiBJbW11dGFibGVPYmplY3Q8eyBbZHNJZDogc3RyaW5nXTogRGF0YVNvdXJjZUpzb24gfT5cbiAgZGF0YVNvdXJjZXNJbmZvOiBJbW11dGFibGVPYmplY3Q8eyBbZHNJZDogc3RyaW5nXTogRGF0YVNvdXJjZUluZm8gfT5cbn1cblxuaW50ZXJmYWNlIEV4dHJhUHJvcHMge1xuICB0aGVtZT86IElNVGhlbWVWYXJpYWJsZXNcbn1cblxuaW50ZXJmYWNlIEluaXRDb25maWcge1xuICBtZXNzYWdlVXNlRGF0YVNvdXJjZTogSW1tdXRhYmxlT2JqZWN0PFVzZURhdGFTb3VyY2U+XG4gIGFjdGlvblVzZURhdGFTb3VyY2U6IEltbXV0YWJsZU9iamVjdDxVc2VEYXRhU291cmNlPlxuICBzcWxFeHByT2JqOiBJbW11dGFibGVPYmplY3Q8U3FsRXhwcmVzc2lvbj5cbiAgZW5hYmxlUXVlcnlXaXRoQ3VycmVudEV4dGVudDogYm9vbGVhblxufVxuXG5pbnRlcmZhY2UgU3RhdGVzIHtcbiAgaXNTaG93TGF5ZXJMaXN0OiBib29sZWFuXG4gIGN1cnJlbnRMYXllclR5cGU6ICd0cmlnZ2VyJyB8ICdhY3Rpb24nXG4gIGlzU3FsRXhwclNob3c6IGJvb2xlYW5cblxuICBCdXR0b246IGFueVxuICBJY29uOiBhbnlcbiAgU3dpdGNoOiBhbnlcbiAgQ29sbGFwc2U6IGFueVxuICBTZXR0aW5nU2VjdGlvbjogYW55XG4gIFNldHRpbmdSb3c6IGFueVxuICBGaWVsZFNlbGVjdG9yOiBhbnlcbiAgRGF0YVNvdXJjZVNlbGVjdG9yOiBhbnlcbiAgQXJjR0lTRGF0YVNvdXJjZVR5cGVzOiBhbnlcbiAgU3FsRXhwcmVzc2lvbkJ1aWxkZXJQb3B1cDogYW55XG4gIERTU2VsZWN0b3JUeXBlczogYW55XG59XG5cbmNsYXNzIF9GaWx0ZXJEYXRhUmVjb3JkQWN0aW9uU2V0dGluZyBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8QWN0aW9uU2V0dGluZ1Byb3BzPElNQ29uZmlnPiAmIEV4dHJhUHJvcHMgJiBTdGF0ZUV4dHJhUHJvcHMsIFN0YXRlcz4ge1xuICBtb2RhbFN0eWxlOiBhbnkgPSB7XG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgdG9wOiAnMCcsXG4gICAgYm90dG9tOiAnMCcsXG4gICAgd2lkdGg6ICcyNTlweCcsXG4gICAgaGVpZ2h0OiAnYXV0bycsXG4gICAgYm9yZGVyUmlnaHQ6ICcnLFxuICAgIGJvcmRlckJvdHRvbTogJycsXG4gICAgcGFkZGluZ0JvdHRvbTogJzFweCdcbiAgfVxuXG4gIGNvbnN0cnVjdG9yIChwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKVxuXG4gICAgdGhpcy5tb2RhbFN0eWxlLmJvcmRlclJpZ2h0ID0gJzFweCBzb2xpZCBibGFjaydcbiAgICB0aGlzLm1vZGFsU3R5bGUuYm9yZGVyQm90dG9tID0gJzFweCBzb2xpZCBibGFjaydcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc1Nob3dMYXllckxpc3Q6IGZhbHNlLFxuICAgICAgY3VycmVudExheWVyVHlwZTogbnVsbCxcbiAgICAgIGlzU3FsRXhwclNob3c6IGZhbHNlXG4gICAgfSBhcyBhbnlcbiAgfVxuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgY29uZmlnOiBJbW11dGFibGUoe1xuICAgICAgbWVzc2FnZVVzZURhdGFTb3VyY2U6IG51bGwsXG4gICAgICBhY3Rpb25Vc2VEYXRhU291cmNlOiBudWxsLFxuICAgICAgc3FsRXhwck9iajogbnVsbCxcbiAgICAgIGVuYWJsZWREYXRhUmVsYXRpb25TaGlwOiB0cnVlLFxuICAgICAgZW5hYmxlUXVlcnlXaXRoQ3VycmVudEV4dGVudDogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBnZXRJbml0Q29uZmlnID0gKCk6IEluaXRDb25maWcgPT4ge1xuICAgIGNvbnN0IHsgbWVzc2FnZVdpZGdldElkLCBtZXNzYWdlVHlwZSB9ID0gdGhpcy5wcm9wc1xuICAgIGNvbnN0IGRzTSA9IERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKClcblxuICAgIGxldCBtZXNzYWdlVXNlRGF0YVNvdXJjZTogSU1Vc2VEYXRhU291cmNlID0gbnVsbFxuICAgIGxldCBhY3Rpb25Vc2VEYXRhU291cmNlOiBJTVVzZURhdGFTb3VyY2UgPSBudWxsXG4gICAgbGV0IGVuYWJsZVF1ZXJ5V2l0aEN1cnJlbnRFeHRlbnQgPSB0cnVlXG5cbiAgICBpZiAoIXRoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlKSB7XG4gICAgICBjb25zdCBkcyA9IGdldERzQnlXaWRnZXRJZChtZXNzYWdlV2lkZ2V0SWQsIG1lc3NhZ2VUeXBlKVxuICAgICAgaWYgKGRzPy5bMF0gJiYgZHM/Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBjb25zdCBkc0pzb24gPSBkc00uZ2V0RGF0YVNvdXJjZShkcz8uWzBdLmRhdGFTb3VyY2VJZCk/LmdldERhdGFTb3VyY2VKc29uKClcbiAgICAgICAgaWYgKGRzSnNvbiAmJiAoKGRzSnNvbi50eXBlID09PSB0aGlzLnN0YXRlLkFyY0dJU0RhdGFTb3VyY2VUeXBlcy5XZWJNYXApIHx8IChkc0pzb24udHlwZSA9PT0gdGhpcy5zdGF0ZS5BcmNHSVNEYXRhU291cmNlVHlwZXMuV2ViU2NlbmUpKSkge1xuICAgICAgICAgIG1lc3NhZ2VVc2VEYXRhU291cmNlID0gbnVsbFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1lc3NhZ2VVc2VEYXRhU291cmNlID0gSW1tdXRhYmxlKHtcbiAgICAgICAgICAgIGRhdGFTb3VyY2VJZDogZHM/LlswXT8uZGF0YVNvdXJjZUlkLFxuICAgICAgICAgICAgbWFpbkRhdGFTb3VyY2VJZDogZHM/LlswXT8ubWFpbkRhdGFTb3VyY2VJZCxcbiAgICAgICAgICAgIGRhdGFWaWV3SWQ6IGRzPy5bMF0/LmRhdGFWaWV3SWQsXG4gICAgICAgICAgICByb290RGF0YVNvdXJjZUlkOiBkcz8uWzBdPy5yb290RGF0YVNvdXJjZUlkXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBtZXNzYWdlVXNlRGF0YVNvdXJjZSA9IGNoZWNrQW5kR2V0SW5pdFVzZURhdGFTb3VyY2Uoe1xuICAgICAgICB3aWRnZXRJZDogbWVzc2FnZVdpZGdldElkLFxuICAgICAgICBvbGRVc2VEYXRhU291cmNlOiB0aGlzLnByb3BzLmNvbmZpZy5tZXNzYWdlVXNlRGF0YVNvdXJjZSxcbiAgICAgICAgbWVzc2FnZVR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICBhcmNHSVNEYXRhU291cmNlVHlwZXM6IHRoaXMuc3RhdGUuQXJjR0lTRGF0YVNvdXJjZVR5cGVzXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmICh0aGlzLnByb3BzLmNvbmZpZy5lbmFibGVRdWVyeVdpdGhDdXJyZW50RXh0ZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGVuYWJsZVF1ZXJ5V2l0aEN1cnJlbnRFeHRlbnQgPSB0aGlzLnByb3BzLmNvbmZpZy5lbmFibGVRdWVyeVdpdGhDdXJyZW50RXh0ZW50XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlKSB7XG4gICAgICBhY3Rpb25Vc2VEYXRhU291cmNlID0gbnVsbFxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBhY3Rpb25EYXRhU291cmNlSWQgPSB0aGlzLnByb3BzLmNvbmZpZz8uYWN0aW9uVXNlRGF0YVNvdXJjZT8uZGF0YVNvdXJjZUlkXG4gICAgICBjb25zdCBhY3Rpb25Sb290RGF0YVNvdXJjZUlkID0gdGhpcy5wcm9wcy5jb25maWc/LmFjdGlvblVzZURhdGFTb3VyY2U/LnJvb3REYXRhU291cmNlSWRcbiAgICAgIGNvbnN0IGRzSnNvbiA9IGRzTS5nZXREYXRhU291cmNlKGFjdGlvbkRhdGFTb3VyY2VJZCk/LmdldERhdGFTb3VyY2VKc29uKCkgfHxcbiAgICAgIGRzTS5nZXREYXRhU291cmNlKGFjdGlvblJvb3REYXRhU291cmNlSWQpPy5nZXREYXRhU291cmNlSnNvbigpXG4gICAgICBpZiAoZHNKc29uKSB7XG4gICAgICAgIGFjdGlvblVzZURhdGFTb3VyY2UgPSB0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhY3Rpb25Vc2VEYXRhU291cmNlID0gbnVsbFxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChhY3Rpb25Vc2VEYXRhU291cmNlICYmIGFjdGlvblVzZURhdGFTb3VyY2UuZGF0YVNvdXJjZUlkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlVXNlRGF0YVNvdXJjZTogbWVzc2FnZVVzZURhdGFTb3VyY2UsXG4gICAgICAgIGFjdGlvblVzZURhdGFTb3VyY2U6IGFjdGlvblVzZURhdGFTb3VyY2UsXG4gICAgICAgIHNxbEV4cHJPYmo6IHRoaXMucHJvcHMuY29uZmlnLnNxbEV4cHJPYmosXG4gICAgICAgIGVuYWJsZVF1ZXJ5V2l0aEN1cnJlbnRFeHRlbnQ6IGVuYWJsZVF1ZXJ5V2l0aEN1cnJlbnRFeHRlbnRcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZVVzZURhdGFTb3VyY2U6IG1lc3NhZ2VVc2VEYXRhU291cmNlLFxuICAgICAgICBhY3Rpb25Vc2VEYXRhU291cmNlOiBhY3Rpb25Vc2VEYXRhU291cmNlLFxuICAgICAgICBzcWxFeHByT2JqOiBudWxsLFxuICAgICAgICBlbmFibGVRdWVyeVdpdGhDdXJyZW50RXh0ZW50OiBlbmFibGVRdWVyeVdpdGhDdXJyZW50RXh0ZW50XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQgKCkge1xuICAgIG1vZHVsZUxvYWRlci5sb2FkTW9kdWxlcyhbXG4gICAgICAnamltdS11aScsXG4gICAgICAnamltdS11aS9hZHZhbmNlZC9zZXR0aW5nLWNvbXBvbmVudHMnLFxuICAgICAgJ2ppbXUtdWkvYWR2YW5jZWQvZGF0YS1zb3VyY2Utc2VsZWN0b3InLFxuICAgICAgJ2ppbXUtYXJjZ2lzJyxcbiAgICAgICdqaW11LXVpL2FkdmFuY2VkL3NxbC1leHByZXNzaW9uLWJ1aWxkZXInXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBCdXR0b246IG1vZHVsZXNbMF0uQnV0dG9uLFxuICAgICAgICBJY29uOiBtb2R1bGVzWzBdLkljb24sXG4gICAgICAgIFN3aXRjaDogbW9kdWxlc1swXS5Td2l0Y2gsXG4gICAgICAgIENvbGxhcHNlOiBtb2R1bGVzWzBdLkNvbGxhcHNlLFxuICAgICAgICBTZXR0aW5nU2VjdGlvbjogbW9kdWxlc1sxXS5TZXR0aW5nU2VjdGlvbixcbiAgICAgICAgU2V0dGluZ1JvdzogbW9kdWxlc1sxXS5TZXR0aW5nUm93LFxuICAgICAgICBGaWVsZFNlbGVjdG9yOiBtb2R1bGVzWzJdLkZpZWxkU2VsZWN0b3IsXG4gICAgICAgIERhdGFTb3VyY2VTZWxlY3RvcjogbW9kdWxlc1syXS5EYXRhU291cmNlU2VsZWN0b3IsXG4gICAgICAgIEFyY0dJU0RhdGFTb3VyY2VUeXBlczogbW9kdWxlc1szXS5BcmNHSVNEYXRhU291cmNlVHlwZXMsXG4gICAgICAgIFNxbEV4cHJlc3Npb25CdWlsZGVyUG9wdXA6IG1vZHVsZXNbNF0uU3FsRXhwcmVzc2lvbkJ1aWxkZXJQb3B1cCxcbiAgICAgICAgRFNTZWxlY3RvclR5cGVzOiBJbW11dGFibGUoW0FsbERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlTGF5ZXIsIEFsbERhdGFTb3VyY2VUeXBlcy5TY2VuZUxheWVyXSlcbiAgICAgIH0sICgpID0+IHtcbiAgICAgICAgY29uc3QgaW5pdENvbmZpZyA9IHRoaXMuZ2V0SW5pdENvbmZpZygpXG5cbiAgICAgICAgdGhpcy5wcm9wcy5vblNldHRpbmdDaGFuZ2Uoe1xuICAgICAgICAgIGFjdGlvbklkOiB0aGlzLnByb3BzLmFjdGlvbklkLFxuICAgICAgICAgIGNvbmZpZzogdGhpcy5wcm9wcy5jb25maWcuc2V0KCdtZXNzYWdlVXNlRGF0YVNvdXJjZScsIGluaXRDb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2UpXG4gICAgICAgICAgICAuc2V0KCdhY3Rpb25Vc2VEYXRhU291cmNlJywgaW5pdENvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlKS5zZXQoJ3NxbEV4cHJPYmonLCBpbml0Q29uZmlnLnNxbEV4cHJPYmopXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICBnZXRTdHlsZSAodGhlbWU6IElNVGhlbWVWYXJpYWJsZXMpOiBTZXJpYWxpemVkU3R5bGVzIHtcbiAgICByZXR1cm4gY3NzYFxuICAgICAgLnNldHRpbmctaGVhZGVyIHtcbiAgICAgICAgcGFkZGluZzogJHtwb2xpc2hlZC5yZW0oMTApfSAke3BvbGlzaGVkLnJlbSgxNil9ICR7cG9saXNoZWQucmVtKDApfSAke3BvbGlzaGVkLnJlbSgxNil9XG4gICAgICB9XG5cbiAgICAgIC5kZWxldGVJY29uIHtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBvcGFjaXR5OiAuODtcbiAgICAgIH1cblxuICAgICAgLmRlbGV0ZUljb246aG92ZXIge1xuICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgfVxuXG4gICAgICAuc3FsLWV4cHItZGlzcGxheSB7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICAgIG1pbi1oZWlnaHQ6IDYwcHg7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiAyNXB4O1xuICAgICAgICBwYWRkaW5nOiAzcHggNXB4O1xuICAgICAgICBjb2xvcjogJHt0aGVtZS5jb2xvcnMucGFsZXR0ZS5kYXJrWzMwMF19O1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAke3RoZW1lLmNvbG9ycy5wYWxldHRlLmxpZ2h0WzUwMF19O1xuICAgICAgfVxuXG4gICAgICAucmVsYXRlLXBhbmVsLWxlZnQge1xuICAgICAgICBmbGV4OiBhdXRvO1xuICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAuYWN0aW9uLXNlbGVjdC1jaG9vc2VyIHtcbiAgICAgICAgICBtYXJnaW4tdG9wOiAke3BvbGlzaGVkLnJlbSgxMil9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgYFxuICB9XG5cbiAgaGFuZGxlVHJpZ2dlckxheWVyQ2hhbmdlID0gKHVzZURhdGFTb3VyY2VzOiBVc2VEYXRhU291cmNlW10pID0+IHtcbiAgICBpZiAodXNlRGF0YVNvdXJjZXMgJiYgdXNlRGF0YVNvdXJjZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5oYW5kbGVUcmlnZ2VyTGF5ZXJTZWxlY3RlZCh1c2VEYXRhU291cmNlc1swXSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oYW5kbGVSZW1vdmVMYXllckZvclRyaWdnZXJMYXllcigpXG4gICAgfVxuICB9XG5cbiAgaGFuZGxlQWN0aW9uTGF5ZXJDaGFuZ2UgPSAodXNlRGF0YVNvdXJjZXM6IFVzZURhdGFTb3VyY2VbXSkgPT4ge1xuICAgIGlmICh1c2VEYXRhU291cmNlcyAmJiB1c2VEYXRhU291cmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmhhbmRsZUFjdGlvbkxheWVyU2VsZWN0ZWQodXNlRGF0YVNvdXJjZXNbMF0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGFuZGxlUmVtb3ZlTGF5ZXJGb3JBY3Rpb25MYXllcigpXG4gICAgfVxuICB9XG5cbiAgaGFuZGxlVHJpZ2dlckxheWVyU2VsZWN0ZWQgPSAoY3VycmVudFNlbGVjdGVkRHM6IFVzZURhdGFTb3VyY2UpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uU2V0dGluZ0NoYW5nZSh7XG4gICAgICBhY3Rpb25JZDogdGhpcy5wcm9wcy5hY3Rpb25JZCxcbiAgICAgIGNvbmZpZzogdGhpcy5wcm9wcy5jb25maWcuc2V0KCdtZXNzYWdlVXNlRGF0YVNvdXJjZScsIGN1cnJlbnRTZWxlY3RlZERzKVxuICAgIH0pXG4gIH1cblxuICBoYW5kbGVBY3Rpb25MYXllclNlbGVjdGVkID0gKGN1cnJlbnRTZWxlY3RlZERzOiBVc2VEYXRhU291cmNlKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vblNldHRpbmdDaGFuZ2Uoe1xuICAgICAgYWN0aW9uSWQ6IHRoaXMucHJvcHMuYWN0aW9uSWQsXG4gICAgICBjb25maWc6IHRoaXMucHJvcHMuY29uZmlnLnNldCgnYWN0aW9uVXNlRGF0YVNvdXJjZScsIGN1cnJlbnRTZWxlY3RlZERzKS5zZXQoJ3NxbEV4cHJPYmonLCBudWxsKVxuICAgIH0pXG4gIH1cblxuICBoYW5kbGVSZW1vdmVMYXllckZvclRyaWdnZXJMYXllciA9ICgpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uU2V0dGluZ0NoYW5nZSh7XG4gICAgICBhY3Rpb25JZDogdGhpcy5wcm9wcy5hY3Rpb25JZCxcbiAgICAgIGNvbmZpZzogdGhpcy5wcm9wcy5jb25maWcuc2V0KCdtZXNzYWdlVXNlRGF0YVNvdXJjZScsIG51bGwpXG4gICAgfSlcbiAgfVxuXG4gIGhhbmRsZVJlbW92ZUxheWVyRm9yQWN0aW9uTGF5ZXIgPSAoKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vblNldHRpbmdDaGFuZ2Uoe1xuICAgICAgYWN0aW9uSWQ6IHRoaXMucHJvcHMuYWN0aW9uSWQsXG4gICAgICBjb25maWc6IHRoaXMucHJvcHMuY29uZmlnLnNldCgnYWN0aW9uVXNlRGF0YVNvdXJjZScsIG51bGwpLnNldCgnc3FsRXhwck9iaicsIG51bGwpXG4gICAgfSlcbiAgfVxuXG4gIHNob3dTcWxFeHByUG9wdXAgPSAoKSA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGlzU3FsRXhwclNob3c6IHRydWUgfSlcbiAgfVxuXG4gIHRvZ2dsZVNxbEV4cHJQb3B1cCA9ICgpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgaXNTcWxFeHByU2hvdzogIXRoaXMuc3RhdGUuaXNTcWxFeHByU2hvdyB9KVxuICB9XG5cbiAgb25TcWxFeHByQnVpbGRlckNoYW5nZSA9IChzcWxFeHByT2JqOiBJTVNxbEV4cHJlc3Npb24pID0+IHtcbiAgICB0aGlzLnByb3BzLm9uU2V0dGluZ0NoYW5nZSh7XG4gICAgICBhY3Rpb25JZDogdGhpcy5wcm9wcy5hY3Rpb25JZCxcbiAgICAgIGNvbmZpZzogdGhpcy5wcm9wcy5jb25maWcuc2V0KCdzcWxFeHByT2JqJywgc3FsRXhwck9iailcbiAgICB9KVxuICB9XG5cbiAgb25NZXNzYWdlRmllbGRTZWxlY3RlZCA9IChhbGxTZWxlY3RlZEZpZWxkczogSU1GaWVsZFNjaGVtYVtdLCBkczogRGF0YVNvdXJjZSkgPT4ge1xuICAgIHRoaXMucHJvcHMub25TZXR0aW5nQ2hhbmdlKHtcbiAgICAgIGFjdGlvbklkOiB0aGlzLnByb3BzLmFjdGlvbklkLFxuICAgICAgY29uZmlnOiB0aGlzLnByb3BzLmNvbmZpZy5zZXQoJ21lc3NhZ2VVc2VEYXRhU291cmNlJywge1xuICAgICAgICBkYXRhU291cmNlSWQ6IHRoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLmRhdGFTb3VyY2VJZCxcbiAgICAgICAgbWFpbkRhdGFTb3VyY2VJZDogdGhpcy5wcm9wcy5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2UubWFpbkRhdGFTb3VyY2VJZCxcbiAgICAgICAgZGF0YVZpZXdJZDogdGhpcy5wcm9wcy5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2UuZGF0YVZpZXdJZCxcbiAgICAgICAgcm9vdERhdGFTb3VyY2VJZDogdGhpcy5wcm9wcy5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2Uucm9vdERhdGFTb3VyY2VJZCxcbiAgICAgICAgZmllbGRzOiBhbGxTZWxlY3RlZEZpZWxkcy5tYXAoZiA9PiBmLmppbXVOYW1lKVxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgb25BY3Rpb25GaWVsZFNlbGVjdGVkID0gKGFsbFNlbGVjdGVkRmllbGRzOiBJTUZpZWxkU2NoZW1hW10sIGRzOiBEYXRhU291cmNlKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vblNldHRpbmdDaGFuZ2Uoe1xuICAgICAgYWN0aW9uSWQ6IHRoaXMucHJvcHMuYWN0aW9uSWQsXG4gICAgICBjb25maWc6IHRoaXMucHJvcHMuY29uZmlnLnNldCgnYWN0aW9uVXNlRGF0YVNvdXJjZScsIHtcbiAgICAgICAgZGF0YVNvdXJjZUlkOiB0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlLmRhdGFTb3VyY2VJZCxcbiAgICAgICAgbWFpbkRhdGFTb3VyY2VJZDogdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZS5tYWluRGF0YVNvdXJjZUlkLFxuICAgICAgICBkYXRhVmlld0lkOiB0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlLmRhdGFWaWV3SWQsXG4gICAgICAgIHJvb3REYXRhU291cmNlSWQ6IHRoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2Uucm9vdERhdGFTb3VyY2VJZCxcbiAgICAgICAgZmllbGRzOiBhbGxTZWxlY3RlZEZpZWxkcy5tYXAoZiA9PiBmLmppbXVOYW1lKVxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgc3dpY3RoRW5hYmxlZERhdGFSZWxhdGlvblNoaXAgPSAoY2hlY2tlZCkgPT4ge1xuICAgIHRoaXMucHJvcHMub25TZXR0aW5nQ2hhbmdlKHtcbiAgICAgIGFjdGlvbklkOiB0aGlzLnByb3BzLmFjdGlvbklkLFxuICAgICAgY29uZmlnOiB0aGlzLnByb3BzLmNvbmZpZy5zZXQoJ2VuYWJsZWREYXRhUmVsYXRpb25TaGlwJywgY2hlY2tlZClcbiAgICB9KVxuICB9XG5cbiAgc3dpY3RoRW5hYmxlZFF1ZXJ5V2l0aEN1cnJlbnRFeHRlbnQgPSAoY2hlY2tlZCkgPT4ge1xuICAgIHRoaXMucHJvcHMub25TZXR0aW5nQ2hhbmdlKHtcbiAgICAgIGFjdGlvbklkOiB0aGlzLnByb3BzLmFjdGlvbklkLFxuICAgICAgY29uZmlnOiB0aGlzLnByb3BzLmNvbmZpZy5zZXQoJ2VuYWJsZVF1ZXJ5V2l0aEN1cnJlbnRFeHRlbnQnLCBjaGVja2VkKVxuICAgIH0pXG4gIH1cblxuICBjaGVja0lzRGlzYWJsZURhdGFWaWV3ID0gKHdpZGdldElkOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICBpZiAodGhpcy5wcm9wcy5tZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2UpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgY29uc3QgYXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpPy5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwQ29uZmlnXG4gICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZz8ud2lkZ2V0cz8uW3dpZGdldElkXVxuICAgIGlmICh3aWRnZXRKc29uKSB7XG4gICAgICBjb25zdCB3aWRnZXRMYWJlbCA9IHdpZGdldEpzb24/Lm1hbmlmZXN0Py5sYWJlbFxuICAgICAgaWYgKHdpZGdldExhYmVsID09PSAnTWFwJykge1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuXG4gIHJlbmRlciAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgQnV0dG9uLCBJY29uLCBTd2l0Y2gsIENvbGxhcHNlLCBTZXR0aW5nU2VjdGlvbiwgU2V0dGluZ1JvdywgRmllbGRTZWxlY3RvciwgRGF0YVNvdXJjZVNlbGVjdG9yLFxuICAgICAgQXJjR0lTRGF0YVNvdXJjZVR5cGVzLCBTcWxFeHByZXNzaW9uQnVpbGRlclBvcHVwXG4gICAgfSA9IHRoaXMuc3RhdGVcbiAgICBjb25zdCB7IG1lc3NhZ2VXaWRnZXRJZCwgbWVzc2FnZVR5cGUsIGNvbmZpZywgdGhlbWUgfSA9IHRoaXMucHJvcHNcbiAgICBpZiAoIUJ1dHRvbiB8fCAhSWNvbiB8fCAhU3dpdGNoIHx8ICFDb2xsYXBzZSB8fCAhU2V0dGluZ1NlY3Rpb24gfHwgIVNldHRpbmdSb3cgfHwgIUZpZWxkU2VsZWN0b3IgfHxcbiAgICAgICFEYXRhU291cmNlU2VsZWN0b3IgfHwgIUFyY0dJU0RhdGFTb3VyY2VUeXBlcyB8fCAhU3FsRXhwcmVzc2lvbkJ1aWxkZXJQb3B1cCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCB0cmlnZ2VyRHNTZWxlY3RvclNvdXJjZURhdGEgPSBnZXREc1NlbGVjdG9yU291cmNlRGF0YSh7XG4gICAgICB3aWRnZXRJZDogbWVzc2FnZVdpZGdldElkLFxuICAgICAgdXNlRGF0YVNvdXJjZTogY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLFxuICAgICAgbWVzc2FnZVR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgYXJjR0lTRGF0YVNvdXJjZVR5cGVzOiBBcmNHSVNEYXRhU291cmNlVHlwZXNcbiAgICB9KVxuICAgIGNvbnN0IGFjdGlvblVzZURhdGFTb3VyY2VJbnN0YW5jZSA9IGNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlICYmXG4gICAgICBEYXRhU291cmNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldERhdGFTb3VyY2UoY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2UuZGF0YVNvdXJjZUlkKVxuXG4gICAgaWYgKHRoaXMucHJvcHMubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkV4dGVudENoYW5nZSkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjc3M9e3RoaXMuZ2V0U3R5bGUodGhpcy5wcm9wcy50aGVtZSl9PlxuICAgICAgICAgIDxTZXR0aW5nU2VjdGlvbiB0aXRsZT17dGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2ZyYW1ld29ya0FjdGlvbl9BY3Rpb25MYXllcicsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXMuZnJhbWV3b3JrQWN0aW9uX0FjdGlvbkxheWVyIH0pfT5cbiAgICAgICAgICAgIDxEYXRhU291cmNlU2VsZWN0b3JcbiAgICAgICAgICAgICAgdHlwZXM9e3RoaXMuc3RhdGUuRFNTZWxlY3RvclR5cGVzfVxuICAgICAgICAgICAgICB1c2VEYXRhU291cmNlcz17dGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZSA/IEltbXV0YWJsZShbdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZV0pIDogSW1tdXRhYmxlKFtdKX1cbiAgICAgICAgICAgICAgY2xvc2VEYXRhU291cmNlTGlzdE9uQ2hhbmdlXG4gICAgICAgICAgICAgIGhpZGVBZGREYXRhQnV0dG9uXG4gICAgICAgICAgICAgIGhpZGVUeXBlRHJvcGRvd25cbiAgICAgICAgICAgICAgbXVzdFVzZURhdGFTb3VyY2VcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlQWN0aW9uTGF5ZXJDaGFuZ2V9XG4gICAgICAgICAgICAgIHdpZGdldElkPXt0aGlzLnByb3BzLndpZGdldElkfVxuICAgICAgICAgICAgICBlbmFibGVUb1NlbGVjdE91dHB1dERzRnJvbVNlbGY9e3RydWV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvU2V0dGluZ1NlY3Rpb24+XG4gICAgICAgICAgPFNldHRpbmdTZWN0aW9uIHRpdGxlPXt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX0NvbmRpdGlvbnMnLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9Db25kaXRpb25zIH0pfT5cbiAgICAgICAgICAgIDxTZXR0aW5nUm93IGxhYmVsPXt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX1F1ZXJ5QnlFeHRlbnQnLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9RdWVyeUJ5RXh0ZW50IH0pfT5cbiAgICAgICAgICAgICAgPFN3aXRjaCBjaGVja2VkPXt0aGlzLnByb3BzLmNvbmZpZy5lbmFibGVRdWVyeVdpdGhDdXJyZW50RXh0ZW50fSBvbkNoYW5nZT17ZXZ0ID0+IHsgdGhpcy5zd2ljdGhFbmFibGVkUXVlcnlXaXRoQ3VycmVudEV4dGVudChldnQudGFyZ2V0LmNoZWNrZWQpIH19IC8+XG4gICAgICAgICAgICA8L1NldHRpbmdSb3c+XG4gICAgICAgICAgICA8U2V0dGluZ1Jvdz5cbiAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0ncC0wIHRleHQtbGVmdCcgdHlwZT0nbGluaycgZGlzYWJsZWQ9eyF0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuc2hvd1NxbEV4cHJQb3B1cH1cbiAgICAgICAgICAgICAgICB0aXRsZT17dGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2ZyYW1ld29ya0FjdGlvbl9Nb3JlQ29uZGl0aW9ucycsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXMuZnJhbWV3b3JrQWN0aW9uX01vcmVDb25kaXRpb25zIH0pfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdmcmFtZXdvcmtBY3Rpb25fTW9yZUNvbmRpdGlvbnMnLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9Nb3JlQ29uZGl0aW9ucyB9KX1cbiAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICA8L1NldHRpbmdSb3c+XG4gICAgICAgICAgICA8U2V0dGluZ1Jvdz5cbiAgICAgICAgICAgICAge3RoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2UgJiYgPERhdGFTb3VyY2VDb21wb25lbnQgdXNlRGF0YVNvdXJjZT17dGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZX0+eyhkcykgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8U3FsRXhwcmVzc2lvbkJ1aWxkZXJQb3B1cFxuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlPXtkc30gbW9kZT17U3FsRXhwcmVzc2lvbk1vZGUuU2ltcGxlfVxuICAgICAgICAgICAgICAgICAgICBpc09wZW49e3RoaXMuc3RhdGUuaXNTcWxFeHByU2hvd30gdG9nZ2xlPXt0aGlzLnRvZ2dsZVNxbEV4cHJQb3B1cH1cbiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbj17dGhpcy5wcm9wcy5jb25maWcuc3FsRXhwck9ian0gb25DaGFuZ2U9eyhzcWxFeHByT2JqKSA9PiB7IHRoaXMub25TcWxFeHByQnVpbGRlckNoYW5nZShzcWxFeHByT2JqKSB9fVxuICAgICAgICAgICAgICAgICAgICBpZD0nZmlsdGVyLXdpZGdldC1zcWwtZXhwcmVzc2lvbi1idWlsZGVyLXBvcHVwJ1xuICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIDwvRGF0YVNvdXJjZUNvbXBvbmVudD59XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdzcWwtZXhwci1kaXNwbGF5IGJvZHktMSc+XG4gICAgICAgICAgICAgICAge3RoaXMucHJvcHMuY29uZmlnLnNxbEV4cHJPYmogJiYgYWN0aW9uVXNlRGF0YVNvdXJjZUluc3RhbmNlXG4gICAgICAgICAgICAgICAgICA/IGRhdGFTb3VyY2VVdGlscy5nZXRBcmNHSVNTUUwodGhpcy5wcm9wcy5jb25maWcuc3FsRXhwck9iaiwgYWN0aW9uVXNlRGF0YVNvdXJjZUluc3RhbmNlKS5kaXNwbGF5U1FMXG4gICAgICAgICAgICAgICAgICA6IHRoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdmcmFtZXdvcmtBY3Rpb25fU2V0RXhwcmVzc2lvbicsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXMuZnJhbWV3b3JrQWN0aW9uX1NldEV4cHJlc3Npb24gfSl9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9TZXR0aW5nUm93PlxuICAgICAgICAgIDwvU2V0dGluZ1NlY3Rpb24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8ZGl2IGNzcz17dGhpcy5nZXRTdHlsZSh0aGlzLnByb3BzLnRoZW1lKX0+XG4gICAgICAgICAgPFNldHRpbmdTZWN0aW9uIHRpdGxlPXt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX1RyaWdnZXJMYXllcicsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXMuZnJhbWV3b3JrQWN0aW9uX1RyaWdnZXJMYXllciB9KX0+XG4gICAgICAgICAgICA8RGF0YVNvdXJjZVNlbGVjdG9yXG4gICAgICAgICAgICAgIHR5cGVzPXt0aGlzLnN0YXRlLkRTU2VsZWN0b3JUeXBlc31cbiAgICAgICAgICAgICAgdXNlRGF0YVNvdXJjZXM9e3RyaWdnZXJEc1NlbGVjdG9yU291cmNlRGF0YS51c2VEYXRhU291cmNlc31cbiAgICAgICAgICAgICAgZnJvbVJvb3REc0lkcz17dHJpZ2dlckRzU2VsZWN0b3JTb3VyY2VEYXRhLmZyb21Sb290RHNJZHN9XG4gICAgICAgICAgICAgIGZyb21Ec0lkcz17dHJpZ2dlckRzU2VsZWN0b3JTb3VyY2VEYXRhLmZyb21Ec0lkc31cbiAgICAgICAgICAgICAgY2xvc2VEYXRhU291cmNlTGlzdE9uQ2hhbmdlXG4gICAgICAgICAgICAgIGRpc2FibGVSZW1vdmU9eygpID0+IHRyaWdnZXJEc1NlbGVjdG9yU291cmNlRGF0YS5pc1JlYWRPbmx5fVxuICAgICAgICAgICAgICBkaXNhYmxlRGF0YVNvdXJjZUxpc3Q9e3RyaWdnZXJEc1NlbGVjdG9yU291cmNlRGF0YS5pc1JlYWRPbmx5fVxuICAgICAgICAgICAgICBoaWRlQWRkRGF0YUJ1dHRvblxuICAgICAgICAgICAgICBoaWRlVHlwZURyb3Bkb3duXG4gICAgICAgICAgICAgIG11c3RVc2VEYXRhU291cmNlXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZVRyaWdnZXJMYXllckNoYW5nZX1cbiAgICAgICAgICAgICAgd2lkZ2V0SWQ9e3RoaXMucHJvcHMubWVzc2FnZVdpZGdldElkfVxuICAgICAgICAgICAgICBkaXNhYmxlRGF0YVZpZXdcbiAgICAgICAgICAgICAgaGlkZURhdGFWaWV3PXt0aGlzLmNoZWNrSXNEaXNhYmxlRGF0YVZpZXcodGhpcy5wcm9wcy5tZXNzYWdlV2lkZ2V0SWQpfVxuICAgICAgICAgICAgICBlbmFibGVUb1NlbGVjdE91dHB1dERzRnJvbVNlbGY9e3RydWV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvU2V0dGluZ1NlY3Rpb24+XG4gICAgICAgICAgPFNldHRpbmdTZWN0aW9uIHRpdGxlPXt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX0FjdGlvbkxheWVyJywgZGVmYXVsdE1lc3NhZ2U6IGRlZmF1bHRNZXNzYWdlcy5mcmFtZXdvcmtBY3Rpb25fQWN0aW9uTGF5ZXIgfSl9PlxuICAgICAgICAgICAgPERhdGFTb3VyY2VTZWxlY3RvclxuICAgICAgICAgICAgICB0eXBlcz17dGhpcy5zdGF0ZS5EU1NlbGVjdG9yVHlwZXN9XG4gICAgICAgICAgICAgIHVzZURhdGFTb3VyY2VzPXt0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlID8gSW1tdXRhYmxlKFt0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlXSkgOiBJbW11dGFibGUoW10pfVxuICAgICAgICAgICAgICBjbG9zZURhdGFTb3VyY2VMaXN0T25DaGFuZ2VcbiAgICAgICAgICAgICAgaGlkZUFkZERhdGFCdXR0b25cbiAgICAgICAgICAgICAgaGlkZVR5cGVEcm9wZG93blxuICAgICAgICAgICAgICBtdXN0VXNlRGF0YVNvdXJjZVxuICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVBY3Rpb25MYXllckNoYW5nZX1cbiAgICAgICAgICAgICAgd2lkZ2V0SWQ9e3RoaXMucHJvcHMud2lkZ2V0SWR9XG4gICAgICAgICAgICAgIGVuYWJsZVRvU2VsZWN0T3V0cHV0RHNGcm9tU2VsZj17dHJ1ZX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9TZXR0aW5nU2VjdGlvbj5cbiAgICAgICAgICB7dGhpcy5wcm9wcy5jb25maWcgJiYgdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZSAmJiB0aGlzLnByb3BzLmNvbmZpZy5tZXNzYWdlVXNlRGF0YVNvdXJjZSAmJlxuICAgICAgICAgICAgPFNldHRpbmdTZWN0aW9uIHRpdGxlPXt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX0NvbmRpdGlvbnMnLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9Db25kaXRpb25zIH0pfT5cbiAgICAgICAgICAgICAgPFNldHRpbmdSb3cgbGFiZWw9e3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdmcmFtZXdvcmtBY3Rpb25fUmVsYXRlTWVzc2FnZScsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXMuZnJhbWV3b3JrQWN0aW9uX1JlbGF0ZU1lc3NhZ2UgfSl9PlxuICAgICAgICAgICAgICAgIDxTd2l0Y2ggY2hlY2tlZD17dGhpcy5wcm9wcy5jb25maWcuZW5hYmxlZERhdGFSZWxhdGlvblNoaXB9IG9uQ2hhbmdlPXtldnQgPT4geyB0aGlzLnN3aWN0aEVuYWJsZWREYXRhUmVsYXRpb25TaGlwKGV2dC50YXJnZXQuY2hlY2tlZCkgfX0gLz5cbiAgICAgICAgICAgICAgPC9TZXR0aW5nUm93PlxuICAgICAgICAgICAgICA8U2V0dGluZ1Jvdz5cbiAgICAgICAgICAgICAgICA8Q29sbGFwc2UgaXNPcGVuPXt0aGlzLnByb3BzLmNvbmZpZy5lbmFibGVkRGF0YVJlbGF0aW9uU2hpcH0gY2xhc3NOYW1lPSd3LTEwMCc+XG4gICAgICAgICAgICAgICAgICB7Y2hlY2tUcmlnZXJMYXllcklzU2FtZVRvQWN0aW9uTGF5ZXIoY29uZmlnKSAmJlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ndy0xMDAgYm9yZGVyIHAtMSBtci0yJz57dGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2ZyYW1ld29ya0FjdGlvbl9BdXRvQmluZCcsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXMuZnJhbWV3b3JrQWN0aW9uX0F1dG9CaW5kIH0pfTwvZGl2Pn1cbiAgICAgICAgICAgICAgICAgIHshY2hlY2tUcmlnZXJMYXllcklzU2FtZVRvQWN0aW9uTGF5ZXIoY29uZmlnKSAmJiA8ZGl2IGNsYXNzTmFtZT0ndy0xMDAgZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlcic+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdkLWZsZXggZmxleC1jb2x1bW4gcmVsYXRlLXBhbmVsLWxlZnQnPlxuICAgICAgICAgICAgICAgICAgICAgIDxGaWVsZFNlbGVjdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3ctMTAwJ1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlRGF0YVNvdXJjZXM9e0ltbXV0YWJsZShbdGhpcy5wcm9wcy5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2U/LmFzTXV0YWJsZSh7IGRlZXA6IHRydWUgfSldKX0gaXNEYXRhU291cmNlRHJvcERvd25IaWRkZW5cbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX1RyaWdnZXJMYXllckZpZWxkJywgZGVmYXVsdE1lc3NhZ2U6IGRlZmF1bHRNZXNzYWdlcy5mcmFtZXdvcmtBY3Rpb25fVHJpZ2dlckxheWVyRmllbGQgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbk1lc3NhZ2VGaWVsZFNlbGVjdGVkfSB1c2VEcm9wZG93biBpc1NlYXJjaElucHV0SGlkZGVuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpZWxkcz17dGhpcy5wcm9wcy5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2UgJiYgdGhpcy5wcm9wcy5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2UuZmllbGRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5wcm9wcy5jb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2UuZmllbGRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogSW1tdXRhYmxlKFtdKX1cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgIDxGaWVsZFNlbGVjdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3ctMTAwIGFjdGlvbi1zZWxlY3QtY2hvb3NlcidcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX0FjdGlvbkxheWVyRmllbGQnLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9BY3Rpb25MYXllckZpZWxkIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlRGF0YVNvdXJjZXM9e0ltbXV0YWJsZShbdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZT8uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KV0pfSBpc0RhdGFTb3VyY2VEcm9wRG93bkhpZGRlblxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25BY3Rpb25GaWVsZFNlbGVjdGVkfSB1c2VEcm9wZG93biBpc1NlYXJjaElucHV0SGlkZGVuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpZWxkcz17dGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZSAmJiB0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlLmZpZWxkc1xuICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2UuZmllbGRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogSW1tdXRhYmxlKFtdKX1cbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPExpbmtDb21iaW5lZE91dGxpbmVkIGF1dG9GbGlwIGNsYXNzTmFtZT0nZmxleC1ub25lJyB3aWR0aD17MTJ9IGhlaWdodD17NDB9IGNvbG9yPXt0aGVtZS5jb2xvcnMuZGFya1s0MDBdfS8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj59XG4gICAgICAgICAgICAgICAgPC9Db2xsYXBzZT5cbiAgICAgICAgICAgICAgPC9TZXR0aW5nUm93PlxuICAgICAgICAgICAgICA8U2V0dGluZ1Jvdz5cbiAgICAgICAgICAgICAgICA8QnV0dG9uIHR5cGU9J2xpbmsnIGRpc2FibGVkPXshdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZX0gY2xhc3NOYW1lPSd3LTEwMCBkLWZsZXgganVzdGlmeS1jb250ZW50LXN0YXJ0JyBvbkNsaWNrPXt0aGlzLnNob3dTcWxFeHByUG9wdXB9PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3ctMTAwIHRleHQtdHJ1bmNhdGUnIHN0eWxlPXt7IHRleHRBbGlnbjogJ3N0YXJ0JyB9fT5cbiAgICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdmcmFtZXdvcmtBY3Rpb25fTW9yZUNvbmRpdGlvbnMnLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9Nb3JlQ29uZGl0aW9ucyB9KX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlICYmIDxEYXRhU291cmNlQ29tcG9uZW50IHVzZURhdGFTb3VyY2U9e3RoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2V9PnsoZHMpID0+IHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIDxTcWxFeHByZXNzaW9uQnVpbGRlclBvcHVwXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZT17ZHN9IG1vZGU9e1NxbEV4cHJlc3Npb25Nb2RlLlNpbXBsZX1cbiAgICAgICAgICAgICAgICAgICAgICBpc09wZW49e3RoaXMuc3RhdGUuaXNTcWxFeHByU2hvd30gdG9nZ2xlPXt0aGlzLnRvZ2dsZVNxbEV4cHJQb3B1cH1cbiAgICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uPXt0aGlzLnByb3BzLmNvbmZpZy5zcWxFeHByT2JqfSBvbkNoYW5nZT17KHNxbEV4cHJPYmopID0+IHsgdGhpcy5vblNxbEV4cHJCdWlsZGVyQ2hhbmdlKHNxbEV4cHJPYmopIH19XG4gICAgICAgICAgICAgICAgICAgICAgaWQ9J2ZpbHRlci13aWRnZXQtc3FsLWV4cHJlc3Npb24tYnVpbGRlci1wb3B1cCdcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgIDwvRGF0YVNvdXJjZUNvbXBvbmVudD59XG4gICAgICAgICAgICAgIDwvU2V0dGluZ1Jvdz5cbiAgICAgICAgICAgICAgPFNldHRpbmdSb3c+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3NxbC1leHByLWRpc3BsYXknPlxuICAgICAgICAgICAgICAgICAge3RoaXMucHJvcHMuY29uZmlnLnNxbEV4cHJPYmogJiYgYWN0aW9uVXNlRGF0YVNvdXJjZUluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgID8gZGF0YVNvdXJjZVV0aWxzLmdldEFyY0dJU1NRTCh0aGlzLnByb3BzLmNvbmZpZy5zcWxFeHByT2JqLCBhY3Rpb25Vc2VEYXRhU291cmNlSW5zdGFuY2UpLmRpc3BsYXlTUUxcbiAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX1NldEV4cHJlc3Npb24nLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9TZXRFeHByZXNzaW9uIH0pfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L1NldHRpbmdSb3c+XG4gICAgICAgICAgICA8L1NldHRpbmdTZWN0aW9uPn1cbiAgICAgICAgPC9kaXY+XG4gICAgICApXG4gICAgfVxuICB9XG59XG5cbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9IChzdGF0ZTogSU1TdGF0ZSk6IFN0YXRlRXh0cmFQcm9wcyA9PiB7XG4gIHJldHVybiB7XG4gICAgZGF0YVNvdXJjZXM6IHN0YXRlLmFwcFN0YXRlSW5CdWlsZGVyICYmIHN0YXRlLmFwcFN0YXRlSW5CdWlsZGVyLmFwcENvbmZpZyAmJiBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlci5hcHBDb25maWcuZGF0YVNvdXJjZXMsXG4gICAgZGF0YVNvdXJjZXNJbmZvOiBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlciAmJiBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlci5kYXRhU291cmNlc0luZm9cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBSZWFjdFJlZHV4LmNvbm5lY3Q8U3RhdGVFeHRyYVByb3BzLCB1bmtub3duLCBBY3Rpb25TZXR0aW5nUHJvcHM8SU1Db25maWc+PihtYXBTdGF0ZVRvUHJvcHMpKHdpdGhUaGVtZShfRmlsdGVyRGF0YVJlY29yZEFjdGlvblNldHRpbmcpKVxuIiwiLyoqIEBqc3gganN4ICovXG5pbXBvcnQgeyB0eXBlIEltbXV0YWJsZU9iamVjdCwgZ2V0QXBwU3RvcmUsIEltbXV0YWJsZSwgdHlwZSBVc2VEYXRhU291cmNlLCBEYXRhU291cmNlTWFuYWdlciwgdHlwZSBNZXNzYWdlVHlwZSwgTWVzc2FnZUNhcnJ5RGF0YSwgdHlwZSBJbW11dGFibGVBcnJheSwgdHlwZSBJTVdpZGdldEpzb24gfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIElNQ29uZmlnIH0gZnJvbSAnLi90eXBlJ1xuZXhwb3J0IGludGVyZmFjZSBnZXREc1NlbGVjdG9yU291cmNlRGF0YVBhcmFtcyB7XG4gIHdpZGdldElkOiBzdHJpbmdcbiAgdXNlRGF0YVNvdXJjZTogSW1tdXRhYmxlLkltbXV0YWJsZU9iamVjdDxVc2VEYXRhU291cmNlPlxuICBtZXNzYWdlVHlwZTogTWVzc2FnZVR5cGVcbiAgYXJjR0lTRGF0YVNvdXJjZVR5cGVzOiBhbnlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbml0VXNlRGF0YVNvdXJjZVBhcmFtIHtcbiAgd2lkZ2V0SWQ6IHN0cmluZ1xuICBvbGRVc2VEYXRhU291cmNlOiBJbW11dGFibGUuSW1tdXRhYmxlT2JqZWN0PFVzZURhdGFTb3VyY2U+XG4gIG1lc3NhZ2VUeXBlOiBNZXNzYWdlVHlwZVxuICBhcmNHSVNEYXRhU291cmNlVHlwZXM6IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIERzU2VsZWN0b3JTb3VyY2Uge1xuICBpc1JlYWRPbmx5OiBib29sZWFuXG4gIHVzZURhdGFTb3VyY2VzOiBJbW11dGFibGVBcnJheTxVc2VEYXRhU291cmNlPlxuICBmcm9tUm9vdERzSWRzOiBJbW11dGFibGVBcnJheTxzdHJpbmc+XG4gIGZyb21Ec0lkczogSW1tdXRhYmxlQXJyYXk8c3RyaW5nPlxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RHNTZWxlY3RvclNvdXJjZURhdGEgKHByb3BzOiBnZXREc1NlbGVjdG9yU291cmNlRGF0YVBhcmFtcyk6IERzU2VsZWN0b3JTb3VyY2Uge1xuICBjb25zdCB7IHdpZGdldElkLCB1c2VEYXRhU291cmNlLCBtZXNzYWdlVHlwZSwgYXJjR0lTRGF0YVNvdXJjZVR5cGVzIH0gPSBwcm9wc1xuICBjb25zdCBhcHBDb25maWcgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCk/LmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBDb25maWdcbiAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZz8ud2lkZ2V0cz8uW3dpZGdldElkXVxuICBjb25zdCBkc1Jvb3RJZHMgPSBnZXREc1Jvb3RJZHNCeVdpZGdldElkKHdpZGdldElkLCBhcmNHSVNEYXRhU291cmNlVHlwZXMpXG4gIGNvbnN0IG1lc3NhZ2VDYXJyeURhdGEgPSBnZXRNZXNzYWdlQ2FycnlEYXRhKHdpZGdldElkLCBtZXNzYWdlVHlwZSlcbiAgY29uc3QgaXNSZWFkT25seSA9IGNoZWNrSXNPbmx5T25lRHMod2lkZ2V0SnNvbiwgbWVzc2FnZUNhcnJ5RGF0YSwgZHNSb290SWRzKVxuXG4gIGNvbnN0IHVzZURhdGFTb3VyY2VzID0gKHVzZURhdGFTb3VyY2UgJiYgdXNlRGF0YVNvdXJjZS5kYXRhU291cmNlSWQpXG4gICAgPyBJbW11dGFibGUoW3VzZURhdGFTb3VyY2UuYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KV0pXG4gICAgOiBudWxsXG5cbiAgY29uc3QgZnJvbURzSWRzID0gZHNSb290SWRzID8gbnVsbCA6IGdldERzSWRzQnlXaWRnZXRJZCh3aWRnZXRJZCwgbWVzc2FnZVR5cGUpXG4gIGNvbnN0IGRzU2VsZWN0b3JTb3VyY2UgPSB7XG4gICAgaXNSZWFkT25seTogaXNSZWFkT25seSxcbiAgICB1c2VEYXRhU291cmNlczogdXNlRGF0YVNvdXJjZXMsXG4gICAgZnJvbVJvb3REc0lkczogZHNSb290SWRzLFxuICAgIGZyb21Ec0lkczogZnJvbURzSWRzXG4gIH1cblxuICByZXR1cm4gZHNTZWxlY3RvclNvdXJjZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tJc09ubHlPbmVEcyAod2lkZ2V0SnNvbjogSU1XaWRnZXRKc29uLCBtZXNzYWdlQ2FycnlEYXRhOiBNZXNzYWdlQ2FycnlEYXRhLCBkc1Jvb3RJZHM6IEltbXV0YWJsZUFycmF5PHN0cmluZz4pOiBib29sZWFuIHtcbiAgY29uc3Qgb3V0cHV0RHMgPSB3aWRnZXRKc29uPy5vdXRwdXREYXRhU291cmNlcyB8fCBbXVxuICBjb25zdCB1c2VEcyA9IHdpZGdldEpzb24/LnVzZURhdGFTb3VyY2VzIHx8IFtdXG4gIGlmIChkc1Jvb3RJZHMpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBzd2l0Y2ggKG1lc3NhZ2VDYXJyeURhdGEpIHtcbiAgICBjYXNlIE1lc3NhZ2VDYXJyeURhdGEuT3V0cHV0RGF0YVNvdXJjZTpcbiAgICAgIHJldHVybiBvdXRwdXREcz8ubGVuZ3RoID09PSAxXG4gICAgY2FzZSBNZXNzYWdlQ2FycnlEYXRhLlVzZURhdGFTb3VyY2U6XG4gICAgICByZXR1cm4gdXNlRHM/Lmxlbmd0aCA9PT0gMVxuICAgIGNhc2UgTWVzc2FnZUNhcnJ5RGF0YS5Cb3RoRGF0YVNvdXJjZTpcbiAgICAgIGNvbnN0IGRzTGVuZ3RoID0gb3V0cHV0RHMubGVuZ3RoICsgdXNlRHMubGVuZ3RoXG4gICAgICByZXR1cm4gZHNMZW5ndGggPT09IDFcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RHNSb290SWRzQnlXaWRnZXRJZCAod0lkOiBzdHJpbmcsIGFyY0dJU0RhdGFTb3VyY2VUeXBlcyk6IEltbXV0YWJsZUFycmF5PHN0cmluZz4ge1xuICBjb25zdCBhcHBDb25maWcgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCk/LmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBDb25maWdcbiAgY29uc3Qgd2lkZ2V0SnNvbiA9IGFwcENvbmZpZz8ud2lkZ2V0cz8uW3dJZF1cbiAgY29uc3Qgcm9vdElkcyA9IFtdXG4gIGNvbnN0IGRzTSA9IERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKClcbiAgd2lkZ2V0SnNvbj8udXNlRGF0YVNvdXJjZXM/LmZvckVhY2goKHVzZURTOiBJbW11dGFibGVPYmplY3Q8VXNlRGF0YVNvdXJjZT4pID0+IHtcbiAgICBjb25zdCBkcyA9IGRzTS5nZXREYXRhU291cmNlKHVzZURTLmRhdGFTb3VyY2VJZClcbiAgICBpZiAoZHM/LnR5cGUgPT09IGFyY0dJU0RhdGFTb3VyY2VUeXBlcy5XZWJNYXAgfHwgZHM/LnR5cGUgPT09IGFyY0dJU0RhdGFTb3VyY2VUeXBlcy5XZWJTY2VuZSkgeyAvLyBpcyByb290IGRzXG4gICAgICByb290SWRzLnB1c2godXNlRFMuZGF0YVNvdXJjZUlkKVxuICAgIH1cbiAgfSlcbiAgcmV0dXJuIHJvb3RJZHMubGVuZ3RoID4gMCA/IEltbXV0YWJsZShyb290SWRzKSA6IG51bGxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERzSWRzQnlXaWRnZXRJZCAod0lkOiBzdHJpbmcsIG1lc3NhZ2VUeXBlOiBNZXNzYWdlVHlwZSk6IEltbXV0YWJsZUFycmF5PHN0cmluZz4ge1xuICBjb25zdCBkcyA9IGdldERzQnlXaWRnZXRJZCh3SWQsIG1lc3NhZ2VUeXBlKVxuICByZXR1cm4gSW1tdXRhYmxlKGRzPy5tYXAoKHVzZURTOiBJbW11dGFibGVPYmplY3Q8VXNlRGF0YVNvdXJjZT4pID0+IHVzZURTPy5tYWluRGF0YVNvdXJjZUlkKSA/PyBbXSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERzQnlXaWRnZXRJZCAod0lkOiBzdHJpbmcsIG1lc3NhZ2VUeXBlOiBNZXNzYWdlVHlwZSk6IEltbXV0YWJsZUFycmF5PFVzZURhdGFTb3VyY2U+IHtcbiAgY29uc3QgbWVzc2FnZUNhcnJ5RGF0YSA9IGdldE1lc3NhZ2VDYXJyeURhdGEod0lkLCBtZXNzYWdlVHlwZSlcbiAgY29uc3QgYXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpPy5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwQ29uZmlnXG4gIGNvbnN0IHdpZGdldEpzb24gPSBhcHBDb25maWc/LndpZGdldHM/Llt3SWRdXG4gIGNvbnN0IHVzZURhdGFTb3VyY2VzID0gd2lkZ2V0SnNvbj8udXNlRGF0YVNvdXJjZXMgfHwgSW1tdXRhYmxlKFtdKVxuICBjb25zdCBvdXRwdXREYXRhU291cmNlcyA9IGluaXRPdXRwdXREYXRhU291cmNlcyh3aWRnZXRKc29uPy5vdXRwdXREYXRhU291cmNlcykgfHwgSW1tdXRhYmxlKFtdKVxuICBjb25zdCBib3RoRGF0YXNvdXJjZSA9IHVzZURhdGFTb3VyY2VzPy5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pLmNvbmNhdChvdXRwdXREYXRhU291cmNlcz8uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KSlcbiAgc3dpdGNoIChtZXNzYWdlQ2FycnlEYXRhKSB7XG4gICAgY2FzZSBNZXNzYWdlQ2FycnlEYXRhLk91dHB1dERhdGFTb3VyY2U6XG4gICAgICByZXR1cm4gb3V0cHV0RGF0YVNvdXJjZXNcbiAgICBjYXNlIE1lc3NhZ2VDYXJyeURhdGEuVXNlRGF0YVNvdXJjZTpcbiAgICAgIHJldHVybiB1c2VEYXRhU291cmNlc1xuICAgIGNhc2UgTWVzc2FnZUNhcnJ5RGF0YS5Cb3RoRGF0YVNvdXJjZTpcbiAgICAgIHJldHVybiBJbW11dGFibGUoYm90aERhdGFzb3VyY2UpXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVXNlT3V0cHV0RHMgKHdJZDogc3RyaW5nLCBtZXNzYWdlVHlwZTogTWVzc2FnZVR5cGUpOiBib29sZWFuIHtcbiAgY29uc3QgbWVzc2FnZUNhcnJ5RGF0YSA9IGdldE1lc3NhZ2VDYXJyeURhdGFCeVdpZGdldElkKHdJZCwgbWVzc2FnZVR5cGUpXG4gIHJldHVybiBtZXNzYWdlQ2FycnlEYXRhID09PSBNZXNzYWdlQ2FycnlEYXRhLk91dHB1dERhdGFTb3VyY2Vcbn1cblxuLyoqXG4gKiBHZXQgTWVzc2FnZUNhcnJ5RGF0YSBieSB3aWRnZXQgaWQgYW5kIG1lc3NhZ2VUeXBlXG4qL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1lc3NhZ2VDYXJyeURhdGEgKHdJZDogc3RyaW5nLCBtZXNzYWdlVHlwZTogTWVzc2FnZVR5cGUpOiBNZXNzYWdlQ2FycnlEYXRhIHtcbiAgY29uc3QgbWVzc2FnZUNhcnJ5RGF0YSA9IGdldE1lc3NhZ2VDYXJyeURhdGFCeVdpZGdldElkKHdJZCwgbWVzc2FnZVR5cGUpXG4gIGlmICghbWVzc2FnZUNhcnJ5RGF0YSkge1xuICAgIHJldHVybiBNZXNzYWdlQ2FycnlEYXRhLlVzZURhdGFTb3VyY2VcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbWVzc2FnZUNhcnJ5RGF0YVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0T3V0cHV0RGF0YVNvdXJjZXMgKG91dHB1dERhdGFTb3VyY2VzKTogSW1tdXRhYmxlQXJyYXk8VXNlRGF0YVNvdXJjZT4ge1xuICBjb25zdCBkcyA9IG91dHB1dERhdGFTb3VyY2VzPy5tYXAoZHNJZCA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGFTb3VyY2VJZDogZHNJZCxcbiAgICAgIG1haW5EYXRhU291cmNlSWQ6IGRzSWQsXG4gICAgICByb290RGF0YVNvdXJjZUlkOiBudWxsXG4gICAgfVxuICB9KSA/PyBbXVxuICByZXR1cm4gSW1tdXRhYmxlKGRzKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWVzc2FnZUNhcnJ5RGF0YUJ5V2lkZ2V0SWQgKHdJZDogc3RyaW5nLCBtZXNzYWdlVHlwZTogTWVzc2FnZVR5cGUpOiBNZXNzYWdlQ2FycnlEYXRhIHtcbiAgY29uc3QgYXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpPy5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwQ29uZmlnXG4gIGNvbnN0IHdpZGdldEpzb24gPSBhcHBDb25maWc/LndpZGdldHM/Llt3SWRdXG4gIGNvbnN0IHB1Ymxpc2hNZXNzYWdlcyA9IHdpZGdldEpzb24/Lm1hbmlmZXN0Py5wdWJsaXNoTWVzc2FnZXNcbiAgbGV0IG1lc3NhZ2VDYXJyeURhdGEgPSBudWxsXG4gIHB1Ymxpc2hNZXNzYWdlcy5mb3JFYWNoKGVsID0+IHtcbiAgICBjb25zdCBwdWJsaXNoTWVzc2FnZVByb3BlcnR5ID0gZWwgYXMgYW55XG4gICAgaWYgKHB1Ymxpc2hNZXNzYWdlUHJvcGVydHk/Lm1lc3NhZ2VDYXJyeURhdGEgJiYgcHVibGlzaE1lc3NhZ2VQcm9wZXJ0eT8ubWVzc2FnZVR5cGUgPT09IG1lc3NhZ2VUeXBlKSB7XG4gICAgICBtZXNzYWdlQ2FycnlEYXRhID0gcHVibGlzaE1lc3NhZ2VQcm9wZXJ0eT8ubWVzc2FnZUNhcnJ5RGF0YVxuICAgIH1cbiAgfSlcbiAgcmV0dXJuIG1lc3NhZ2VDYXJyeURhdGFcbn1cblxuLyoqXG4gKiBJbml0aWFsaXplIHRoZSB1c2VEYXRhU291cmNlIGJ5IGNvbXBhcmluZyB0aGUgY3VycmVudCB1c2VEYXRhc291cmNlcyBhbmQgb2xkVXNlRGF0YXNvdXJjZXMgb2YgdGhlIHdpZGdldCxcbiAqIGlmIHRoZXkgYXJlIHRoZSBzYW1lLCB1c2Ugb2xkRGF0YXNvdXJjZXMsIG90aGVyd2lzZSB1cGRhdGUgdG8gbnVsbFxuKi9cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0FuZEdldEluaXRVc2VEYXRhU291cmNlIChwcm9wczogSW5pdFVzZURhdGFTb3VyY2VQYXJhbSk6IEltbXV0YWJsZS5JbW11dGFibGVPYmplY3Q8VXNlRGF0YVNvdXJjZT4ge1xuICBjb25zdCB7IHdpZGdldElkLCBvbGRVc2VEYXRhU291cmNlLCBtZXNzYWdlVHlwZSwgYXJjR0lTRGF0YVNvdXJjZVR5cGVzIH0gPSBwcm9wc1xuICBjb25zdCBjb25maWcgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXIuYXBwQ29uZmlnXG4gIGNvbnN0IGRzTSA9IERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKClcbiAgY29uc3Qgd2lkZ2V0SnNvbiA9IGNvbmZpZy53aWRnZXRzW3dpZGdldElkXVxuICBsZXQgaW5pdFVzZURhdGFTb3VyY2UgPSBudWxsXG4gIGxldCBpc01hcERzID0gZmFsc2VcbiAgY29uc3QgaXNvbGRVc2VEYXRhU291cmNlSXNPdXRwdXREcyA9IGRzTS5nZXREYXRhU291cmNlKG9sZFVzZURhdGFTb3VyY2UuZGF0YVNvdXJjZUlkKT8uZ2V0RGF0YVNvdXJjZUpzb24oKT8uaXNPdXRwdXRGcm9tV2lkZ2V0XG4gIGNvbnN0IGRzID0gZ2V0RHNCeVdpZGdldElkKHdpZGdldElkLCBtZXNzYWdlVHlwZSlcbiAgY29uc3QgZHNJZCA9IGRzPy5bMF0gJiYgZHM/LlswXT8uZGF0YVNvdXJjZUlkXG4gIGlmICghZHNJZCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBjb25zdCBkc0pzb24gPSBkc00uZ2V0RGF0YVNvdXJjZShkc0lkKT8uZ2V0RGF0YVNvdXJjZUpzb24oKVxuICBpZiAoZHNKc29uICYmICgoZHNKc29uLnR5cGUgPT09IGFyY0dJU0RhdGFTb3VyY2VUeXBlcy5XZWJNYXApIHx8IChkc0pzb24udHlwZSA9PT0gYXJjR0lTRGF0YVNvdXJjZVR5cGVzLldlYlNjZW5lKSkpIHtcbiAgICBpc01hcERzID0gdHJ1ZVxuICB9XG5cbiAgaWYgKGlzTWFwRHMpIHtcbiAgICAvLyB3ZWJtYXAgb3Igd2Vic2NlbmUgZHNcbiAgICBsZXQgaXNVc2VPbGREcyA9IGZhbHNlXG4gICAgaWYgKHdpZGdldEpzb24gJiYgd2lkZ2V0SnNvbi51c2VEYXRhU291cmNlcykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3aWRnZXRKc29uLnVzZURhdGFTb3VyY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh3aWRnZXRKc29uLnVzZURhdGFTb3VyY2VzW2ldLmRhdGFTb3VyY2VJZCA9PT0gb2xkVXNlRGF0YVNvdXJjZS5yb290RGF0YVNvdXJjZUlkKSB7XG4gICAgICAgICAgaXNVc2VPbGREcyA9IHRydWVcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGlzVXNlT2xkRHMpIHtcbiAgICAgIGluaXRVc2VEYXRhU291cmNlID0gb2xkVXNlRGF0YVNvdXJjZVxuICAgIH0gZWxzZSB7XG4gICAgICBpbml0VXNlRGF0YVNvdXJjZSA9IG51bGxcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gZmVhdHVyZWxheWVyIGRzXG4gICAgbGV0IGlzVXNlT2xkRHMgPSBmYWxzZVxuICAgIGlmIChkcykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkcz8ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgb2xkVXNlRGF0YVNvdXJjZUlkID0gaXNvbGRVc2VEYXRhU291cmNlSXNPdXRwdXREcyA/IGRzTS5nZXREYXRhU291cmNlKG9sZFVzZURhdGFTb3VyY2UuZGF0YVNvdXJjZUlkKT8uZ2V0TWFpbkRhdGFTb3VyY2UoKT8uaWQgOiBvbGRVc2VEYXRhU291cmNlLmRhdGFTb3VyY2VJZFxuICAgICAgICBjb25zdCB3aWRnZXREc0lkID0gaXNvbGRVc2VEYXRhU291cmNlSXNPdXRwdXREcyA/IGRzTS5nZXREYXRhU291cmNlKGRzPy5baV0/LmRhdGFTb3VyY2VJZCk/LmdldE1haW5EYXRhU291cmNlKCk/LmlkIDogZHM/LltpXT8uZGF0YVNvdXJjZUlkXG4gICAgICAgIGlmICh3aWRnZXREc0lkID09PSBvbGRVc2VEYXRhU291cmNlSWQpIHtcbiAgICAgICAgICBpc1VzZU9sZERzID0gdHJ1ZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaXNVc2VPbGREcykge1xuICAgICAgaW5pdFVzZURhdGFTb3VyY2UgPSBvbGRVc2VEYXRhU291cmNlXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChkcz8ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGluaXRVc2VEYXRhU291cmNlID0gSW1tdXRhYmxlKHtcbiAgICAgICAgICBkYXRhU291cmNlSWQ6IGRzPy5bMF0/LmRhdGFTb3VyY2VJZCxcbiAgICAgICAgICBtYWluRGF0YVNvdXJjZUlkOiBkcz8uWzBdPy5tYWluRGF0YVNvdXJjZUlkLFxuICAgICAgICAgIGRhdGFWaWV3SWQ6IGRzPy5bMF0/LmRhdGFWaWV3SWQsXG4gICAgICAgICAgcm9vdERhdGFTb3VyY2VJZDogZHM/LlswXT8ucm9vdERhdGFTb3VyY2VJZFxuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5pdFVzZURhdGFTb3VyY2UgPSBudWxsXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGluaXRVc2VEYXRhU291cmNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja1RyaWdlckxheWVySXNTYW1lVG9BY3Rpb25MYXllciAoY29uZmlnOiBJTUNvbmZpZyk6IGJvb2xlYW4ge1xuICBpZiAoY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlICYmIGNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlKSB7XG4gICAgaWYgKGNvbmZpZy5tZXNzYWdlVXNlRGF0YVNvdXJjZS5tYWluRGF0YVNvdXJjZUlkID09PSBjb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZS5tYWluRGF0YVNvdXJjZUlkICYmIGNoZWNrSXNTYW1lUm9vdERhdGFTb3VyY2VJZChjb25maWcpKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrSXNTYW1lUm9vdERhdGFTb3VyY2VJZCAoY29uZmlnOiBJTUNvbmZpZyk6IGJvb2xlYW4ge1xuICBpZiAoY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLnJvb3REYXRhU291cmNlSWQgfHwgY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2Uucm9vdERhdGFTb3VyY2VJZCkge1xuICAgIHJldHVybiBjb25maWcubWVzc2FnZVVzZURhdGFTb3VyY2Uucm9vdERhdGFTb3VyY2VJZCA9PT0gY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2Uucm9vdERhdGFTb3VyY2VJZFxuICB9IGVsc2Uge1xuICAgIHJldHVybiB0cnVlXG4gIH1cbn1cbiIsIi8qKiBAanN4IGpzeCAqL1xuaW1wb3J0IHtcbiAgUmVhY3QsIGNzcywganN4LCB0eXBlIEFjdGlvblNldHRpbmdQcm9wcywgdHlwZSBTZXJpYWxpemVkU3R5bGVzLCB0eXBlIEltbXV0YWJsZU9iamVjdCwgdHlwZSBEYXRhU291cmNlLCB0eXBlIERhdGFTb3VyY2VJbmZvLFxuICB0eXBlIElNVGhlbWVWYXJpYWJsZXMsIHBvbGlzaGVkLCBJbW11dGFibGUsIHR5cGUgRGF0YVNvdXJjZUpzb24sXG4gIHR5cGUgVXNlRGF0YVNvdXJjZSwgRGF0YVNvdXJjZUNvbXBvbmVudCwgdHlwZSBJTVVzZURhdGFTb3VyY2UsIHR5cGUgSU1GaWVsZFNjaGVtYSwgdHlwZSBJTVN0YXRlLCBSZWFjdFJlZHV4LCB0eXBlIElNU3FsRXhwcmVzc2lvbixcbiAgZGF0YVNvdXJjZVV0aWxzLCBEYXRhU291cmNlTWFuYWdlciwgbW9kdWxlTG9hZGVyLCBTcWxFeHByZXNzaW9uTW9kZSwgdHlwZSBTcWxFeHByZXNzaW9uLCBBbGxEYXRhU291cmNlVHlwZXNcbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgd2l0aFRoZW1lIH0gZnJvbSAnamltdS10aGVtZSdcbmltcG9ydCBkZWZhdWx0TWVzc2FnZXMgZnJvbSAnLi4vdHJhbnNsYXRpb25zL2RlZmF1bHQnXG5pbXBvcnQgeyBnZXREc1NlbGVjdG9yU291cmNlRGF0YSwgZ2V0RHNCeVdpZGdldElkLCBjaGVja0FuZEdldEluaXRVc2VEYXRhU291cmNlLCBjaGVja1RyaWdlckxheWVySXNTYW1lVG9BY3Rpb25MYXllciB9IGZyb20gJy4vaW5pdCdcbmltcG9ydCB7IHR5cGUgSU1Db25maWcgfSBmcm9tICcuL3R5cGUnXG5pbXBvcnQgeyBMaW5rQ29tYmluZWRPdXRsaW5lZCB9IGZyb20gJ2ppbXUtaWNvbnMvb3V0bGluZWQvZGF0YS9saW5rLWNvbWJpbmVkJ1xuaW50ZXJmYWNlIFN0YXRlRXh0cmFQcm9wcyB7XG4gIGRhdGFTb3VyY2VzOiBJbW11dGFibGVPYmplY3Q8eyBbZHNJZDogc3RyaW5nXTogRGF0YVNvdXJjZUpzb24gfT5cbiAgZGF0YVNvdXJjZXNJbmZvOiBJbW11dGFibGVPYmplY3Q8eyBbZHNJZDogc3RyaW5nXTogRGF0YVNvdXJjZUluZm8gfT5cbn1cblxuaW50ZXJmYWNlIEV4dHJhUHJvcHMge1xuICB0aGVtZT86IElNVGhlbWVWYXJpYWJsZXNcbn1cblxuaW50ZXJmYWNlIFN0YXRlcyB7XG4gIGlzU2hvd0xheWVyTGlzdDogYm9vbGVhblxuICBjdXJyZW50TGF5ZXJUeXBlOiAndHJpZ2dlcicgfCAnYWN0aW9uJ1xuICBpc1NxbEV4cHJTaG93OiBib29sZWFuXG5cbiAgQnV0dG9uOiBhbnlcbiAgSWNvbjogYW55XG4gIFN3aXRjaDogYW55XG4gIENvbGxhcHNlOiBhbnlcbiAgU2V0dGluZ1NlY3Rpb246IGFueVxuICBTZXR0aW5nUm93OiBhbnlcbiAgRmllbGRTZWxlY3RvcjogYW55XG4gIERhdGFTb3VyY2VTZWxlY3RvcjogYW55XG4gIEFyY0dJU0RhdGFTb3VyY2VUeXBlczogYW55XG4gIFNxbEV4cHJlc3Npb25CdWlsZGVyUG9wdXA6IGFueVxuICBEU1NlbGVjdG9yVHlwZXM6IGFueVxufVxuXG5pbnRlcmZhY2UgSW5pdENvbmZpZyB7XG4gIG1lc3NhZ2VVc2VEYXRhU291cmNlOiBJbW11dGFibGVPYmplY3Q8VXNlRGF0YVNvdXJjZT5cbiAgYWN0aW9uVXNlRGF0YVNvdXJjZTogSW1tdXRhYmxlT2JqZWN0PFVzZURhdGFTb3VyY2U+XG4gIHNxbEV4cHJPYmo6IEltbXV0YWJsZU9iamVjdDxTcWxFeHByZXNzaW9uPlxufVxuXG5jbGFzcyBfU2VsZWN0RGF0YVJlY29yZEFjdGlvblNldHRpbmcgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PEFjdGlvblNldHRpbmdQcm9wczxJTUNvbmZpZz4gJiBFeHRyYVByb3BzICYgU3RhdGVFeHRyYVByb3BzLCBTdGF0ZXM+IHtcbiAgbW9kYWxTdHlsZTogYW55ID0ge1xuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHRvcDogJzAnLFxuICAgIGJvdHRvbTogJzAnLFxuICAgIHdpZHRoOiAnMjU5cHgnLFxuICAgIGhlaWdodDogJ2F1dG8nLFxuICAgIGJvcmRlclJpZ2h0OiAnJyxcbiAgICBib3JkZXJCb3R0b206ICcnLFxuICAgIHBhZGRpbmdCb3R0b206ICcxcHgnXG4gIH1cblxuICBjb25zdHJ1Y3RvciAocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcylcblxuICAgIHRoaXMubW9kYWxTdHlsZS5ib3JkZXJSaWdodCA9ICcxcHggc29saWQgYmxhY2snXG4gICAgdGhpcy5tb2RhbFN0eWxlLmJvcmRlckJvdHRvbSA9ICcxcHggc29saWQgYmxhY2snXG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgaXNTaG93TGF5ZXJMaXN0OiBmYWxzZSxcbiAgICAgIGN1cnJlbnRMYXllclR5cGU6IG51bGwsXG4gICAgICBpc1NxbEV4cHJTaG93OiBmYWxzZVxuICAgIH0gYXMgYW55XG4gIH1cblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIGNvbmZpZzogSW1tdXRhYmxlKHtcbiAgICAgIG1lc3NhZ2VVc2VEYXRhU291cmNlOiBudWxsLFxuICAgICAgYWN0aW9uVXNlRGF0YVNvdXJjZTogbnVsbCxcbiAgICAgIHNxbEV4cHJPYmo6IG51bGwsXG4gICAgICBlbmFibGVkRGF0YVJlbGF0aW9uU2hpcDogdHJ1ZVxuICAgIH0pXG4gIH1cblxuICBnZXRJbml0Q29uZmlnID0gKCk6IEluaXRDb25maWcgPT4ge1xuICAgIGNvbnN0IHsgbWVzc2FnZVdpZGdldElkLCBtZXNzYWdlVHlwZSB9ID0gdGhpcy5wcm9wc1xuICAgIGNvbnN0IGRzTSA9IERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKClcblxuICAgIGxldCBtZXNzYWdlVXNlRGF0YVNvdXJjZTogSU1Vc2VEYXRhU291cmNlID0gbnVsbFxuICAgIGxldCBhY3Rpb25Vc2VEYXRhU291cmNlOiBJTVVzZURhdGFTb3VyY2UgPSBudWxsXG5cbiAgICBpZiAoIXRoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlKSB7XG4gICAgICBjb25zdCBkcyA9IGdldERzQnlXaWRnZXRJZChtZXNzYWdlV2lkZ2V0SWQsIG1lc3NhZ2VUeXBlKVxuICAgICAgaWYgKGRzPy5bMF0gJiYgZHM/Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBjb25zdCBkc0pzb24gPSBkc00uZ2V0RGF0YVNvdXJjZShkcz8uWzBdLmRhdGFTb3VyY2VJZCk/LmdldERhdGFTb3VyY2VKc29uKClcbiAgICAgICAgaWYgKGRzSnNvbiAmJiAoKGRzSnNvbi50eXBlID09PSB0aGlzLnN0YXRlLkFyY0dJU0RhdGFTb3VyY2VUeXBlcy5XZWJNYXApIHx8IChkc0pzb24udHlwZSA9PT0gdGhpcy5zdGF0ZS5BcmNHSVNEYXRhU291cmNlVHlwZXMuV2ViU2NlbmUpKSkge1xuICAgICAgICAgIG1lc3NhZ2VVc2VEYXRhU291cmNlID0gbnVsbFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1lc3NhZ2VVc2VEYXRhU291cmNlID0gSW1tdXRhYmxlKHtcbiAgICAgICAgICAgIGRhdGFTb3VyY2VJZDogZHM/LlswXT8uZGF0YVNvdXJjZUlkLFxuICAgICAgICAgICAgbWFpbkRhdGFTb3VyY2VJZDogZHM/LlswXT8ubWFpbkRhdGFTb3VyY2VJZCxcbiAgICAgICAgICAgIGRhdGFWaWV3SWQ6IGRzPy5bMF0/LmRhdGFWaWV3SWQsXG4gICAgICAgICAgICByb290RGF0YVNvdXJjZUlkOiBkcz8uWzBdPy5yb290RGF0YVNvdXJjZUlkXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBtZXNzYWdlVXNlRGF0YVNvdXJjZSA9IGNoZWNrQW5kR2V0SW5pdFVzZURhdGFTb3VyY2Uoe1xuICAgICAgICB3aWRnZXRJZDogbWVzc2FnZVdpZGdldElkLFxuICAgICAgICBvbGRVc2VEYXRhU291cmNlOiB0aGlzLnByb3BzLmNvbmZpZy5tZXNzYWdlVXNlRGF0YVNvdXJjZSxcbiAgICAgICAgbWVzc2FnZVR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICBhcmNHSVNEYXRhU291cmNlVHlwZXM6IHRoaXMuc3RhdGUuQXJjR0lTRGF0YVNvdXJjZVR5cGVzXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmICghdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZSkge1xuICAgICAgYWN0aW9uVXNlRGF0YVNvdXJjZSA9IG51bGxcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgYWN0aW9uRGF0YVNvdXJjZUlkID0gdGhpcy5wcm9wcy5jb25maWc/LmFjdGlvblVzZURhdGFTb3VyY2U/LmRhdGFTb3VyY2VJZFxuICAgICAgY29uc3QgYWN0aW9uUm9vdERhdGFTb3VyY2VJZCA9IHRoaXMucHJvcHMuY29uZmlnPy5hY3Rpb25Vc2VEYXRhU291cmNlPy5yb290RGF0YVNvdXJjZUlkXG4gICAgICBjb25zdCBkc0pzb24gPSBkc00uZ2V0RGF0YVNvdXJjZShhY3Rpb25EYXRhU291cmNlSWQpPy5nZXREYXRhU291cmNlSnNvbigpIHx8XG4gICAgICBkc00uZ2V0RGF0YVNvdXJjZShhY3Rpb25Sb290RGF0YVNvdXJjZUlkKT8uZ2V0RGF0YVNvdXJjZUpzb24oKVxuICAgICAgaWYgKGRzSnNvbikge1xuICAgICAgICBhY3Rpb25Vc2VEYXRhU291cmNlID0gdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWN0aW9uVXNlRGF0YVNvdXJjZSA9IG51bGxcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoYWN0aW9uVXNlRGF0YVNvdXJjZSAmJiBhY3Rpb25Vc2VEYXRhU291cmNlLmRhdGFTb3VyY2VJZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZVVzZURhdGFTb3VyY2U6IG1lc3NhZ2VVc2VEYXRhU291cmNlLFxuICAgICAgICBhY3Rpb25Vc2VEYXRhU291cmNlOiBhY3Rpb25Vc2VEYXRhU291cmNlLFxuICAgICAgICBzcWxFeHByT2JqOiB0aGlzLnByb3BzLmNvbmZpZy5zcWxFeHByT2JqXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2VVc2VEYXRhU291cmNlOiBtZXNzYWdlVXNlRGF0YVNvdXJjZSxcbiAgICAgICAgYWN0aW9uVXNlRGF0YVNvdXJjZTogYWN0aW9uVXNlRGF0YVNvdXJjZSxcbiAgICAgICAgc3FsRXhwck9iajogbnVsbFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50ICgpIHtcbiAgICBtb2R1bGVMb2FkZXIubG9hZE1vZHVsZXMoW1xuICAgICAgJ2ppbXUtdWknLFxuICAgICAgJ2ppbXUtdWkvYWR2YW5jZWQvc2V0dGluZy1jb21wb25lbnRzJyxcbiAgICAgICdqaW11LXVpL2FkdmFuY2VkL2RhdGEtc291cmNlLXNlbGVjdG9yJyxcbiAgICAgICdqaW11LWFyY2dpcycsXG4gICAgICAnamltdS11aS9hZHZhbmNlZC9zcWwtZXhwcmVzc2lvbi1idWlsZGVyJ10pLnRoZW4obW9kdWxlcyA9PiB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgQnV0dG9uOiBtb2R1bGVzWzBdLkJ1dHRvbixcbiAgICAgICAgSWNvbjogbW9kdWxlc1swXS5JY29uLFxuICAgICAgICBTd2l0Y2g6IG1vZHVsZXNbMF0uU3dpdGNoLFxuICAgICAgICBDb2xsYXBzZTogbW9kdWxlc1swXS5Db2xsYXBzZSxcbiAgICAgICAgU2V0dGluZ1NlY3Rpb246IG1vZHVsZXNbMV0uU2V0dGluZ1NlY3Rpb24sXG4gICAgICAgIFNldHRpbmdSb3c6IG1vZHVsZXNbMV0uU2V0dGluZ1JvdyxcbiAgICAgICAgRmllbGRTZWxlY3RvcjogbW9kdWxlc1syXS5GaWVsZFNlbGVjdG9yLFxuICAgICAgICBEYXRhU291cmNlU2VsZWN0b3I6IG1vZHVsZXNbMl0uRGF0YVNvdXJjZVNlbGVjdG9yLFxuICAgICAgICBBcmNHSVNEYXRhU291cmNlVHlwZXM6IG1vZHVsZXNbM10uQXJjR0lTRGF0YVNvdXJjZVR5cGVzLFxuICAgICAgICBTcWxFeHByZXNzaW9uQnVpbGRlclBvcHVwOiBtb2R1bGVzWzRdLlNxbEV4cHJlc3Npb25CdWlsZGVyUG9wdXAsXG4gICAgICAgIERTU2VsZWN0b3JUeXBlczogSW1tdXRhYmxlKFtBbGxEYXRhU291cmNlVHlwZXMuRmVhdHVyZUxheWVyLCBBbGxEYXRhU291cmNlVHlwZXMuU2NlbmVMYXllcl0pXG4gICAgICB9LCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGluaXRDb25maWcgPSB0aGlzLmdldEluaXRDb25maWcoKVxuXG4gICAgICAgIHRoaXMucHJvcHMub25TZXR0aW5nQ2hhbmdlKHtcbiAgICAgICAgICBhY3Rpb25JZDogdGhpcy5wcm9wcy5hY3Rpb25JZCxcbiAgICAgICAgICBjb25maWc6IHRoaXMucHJvcHMuY29uZmlnLnNldCgnbWVzc2FnZVVzZURhdGFTb3VyY2UnLCBpbml0Q29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlKVxuICAgICAgICAgICAgLnNldCgnYWN0aW9uVXNlRGF0YVNvdXJjZScsIGluaXRDb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZSkuc2V0KCdzcWxFeHByT2JqJywgaW5pdENvbmZpZy5zcWxFeHByT2JqKVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgZ2V0U3R5bGUgKHRoZW1lOiBJTVRoZW1lVmFyaWFibGVzKTogU2VyaWFsaXplZFN0eWxlcyB7XG4gICAgcmV0dXJuIGNzc2BcbiAgICAgIC5zZXR0aW5nLWhlYWRlciB7XG4gICAgICAgIHBhZGRpbmc6ICR7cG9saXNoZWQucmVtKDEwKX0gJHtwb2xpc2hlZC5yZW0oMTYpfSAke3BvbGlzaGVkLnJlbSgwKX0gJHtwb2xpc2hlZC5yZW0oMTYpfVxuICAgICAgfVxuXG4gICAgICAuZGVsZXRlSWNvbiB7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgb3BhY2l0eTogLjg7XG4gICAgICB9XG5cbiAgICAgIC5kZWxldGVJY29uOmhvdmVyIHtcbiAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgIH1cblxuICAgICAgLnNxbC1leHByLWRpc3BsYXkge1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgICBtaW4taGVpZ2h0OiA2MHB4O1xuICAgICAgICBsaW5lLWhlaWdodDogMjVweDtcbiAgICAgICAgcGFkZGluZzogM3B4IDVweDtcbiAgICAgICAgY29sb3I6ICR7dGhlbWUuY29sb3JzLnBhbGV0dGUuZGFya1szMDBdfTtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgJHt0aGVtZS5jb2xvcnMucGFsZXR0ZS5saWdodFs1MDBdfTtcbiAgICAgIH1cblxuICAgICAgLnJlbGF0ZS1wYW5lbC1sZWZ0IHtcbiAgICAgICAgZmxleDogYXV0bztcbiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgLmFjdGlvbi1zZWxlY3QtY2hvb3NlciB7XG4gICAgICAgICAgbWFyZ2luLXRvcDogJHtwb2xpc2hlZC5yZW0oMTIpfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIGBcbiAgfVxuXG4gIGhhbmRsZVRyaWdnZXJMYXllckNoYW5nZSA9ICh1c2VEYXRhU291cmNlczogVXNlRGF0YVNvdXJjZVtdKSA9PiB7XG4gICAgaWYgKHVzZURhdGFTb3VyY2VzICYmIHVzZURhdGFTb3VyY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuaGFuZGxlVHJpZ2dlckxheWVyU2VsZWN0ZWQodXNlRGF0YVNvdXJjZXNbMF0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGFuZGxlUmVtb3ZlTGF5ZXJGb3JUcmlnZ2VyTGF5ZXIoKVxuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUFjdGlvbkxheWVyQ2hhbmdlID0gKHVzZURhdGFTb3VyY2VzOiBVc2VEYXRhU291cmNlW10pID0+IHtcbiAgICBpZiAodXNlRGF0YVNvdXJjZXMgJiYgdXNlRGF0YVNvdXJjZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5oYW5kbGVBY3Rpb25MYXllclNlbGVjdGVkKHVzZURhdGFTb3VyY2VzWzBdKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhhbmRsZVJlbW92ZUxheWVyRm9yQWN0aW9uTGF5ZXIoKVxuICAgIH1cbiAgfVxuXG4gIGhhbmRsZVRyaWdnZXJMYXllclNlbGVjdGVkID0gKGN1cnJlbnRTZWxlY3RlZERzOiBVc2VEYXRhU291cmNlKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vblNldHRpbmdDaGFuZ2Uoe1xuICAgICAgYWN0aW9uSWQ6IHRoaXMucHJvcHMuYWN0aW9uSWQsXG4gICAgICBjb25maWc6IHRoaXMucHJvcHMuY29uZmlnLnNldCgnbWVzc2FnZVVzZURhdGFTb3VyY2UnLCBjdXJyZW50U2VsZWN0ZWREcylcbiAgICB9KVxuICB9XG5cbiAgaGFuZGxlQWN0aW9uTGF5ZXJTZWxlY3RlZCA9IChjdXJyZW50U2VsZWN0ZWREczogVXNlRGF0YVNvdXJjZSkgPT4ge1xuICAgIHRoaXMucHJvcHMub25TZXR0aW5nQ2hhbmdlKHtcbiAgICAgIGFjdGlvbklkOiB0aGlzLnByb3BzLmFjdGlvbklkLFxuICAgICAgY29uZmlnOiB0aGlzLnByb3BzLmNvbmZpZy5zZXQoJ2FjdGlvblVzZURhdGFTb3VyY2UnLCBjdXJyZW50U2VsZWN0ZWREcykuc2V0KCdzcWxFeHByT2JqJywgbnVsbClcbiAgICB9KVxuICB9XG5cbiAgaGFuZGxlUmVtb3ZlTGF5ZXJGb3JUcmlnZ2VyTGF5ZXIgPSAoKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vblNldHRpbmdDaGFuZ2Uoe1xuICAgICAgYWN0aW9uSWQ6IHRoaXMucHJvcHMuYWN0aW9uSWQsXG4gICAgICBjb25maWc6IHRoaXMucHJvcHMuY29uZmlnLnNldCgnbWVzc2FnZVVzZURhdGFTb3VyY2UnLCBudWxsKVxuICAgIH0pXG4gIH1cblxuICBoYW5kbGVSZW1vdmVMYXllckZvckFjdGlvbkxheWVyID0gKCkgPT4ge1xuICAgIHRoaXMucHJvcHMub25TZXR0aW5nQ2hhbmdlKHtcbiAgICAgIGFjdGlvbklkOiB0aGlzLnByb3BzLmFjdGlvbklkLFxuICAgICAgY29uZmlnOiB0aGlzLnByb3BzLmNvbmZpZy5zZXQoJ2FjdGlvblVzZURhdGFTb3VyY2UnLCBudWxsKS5zZXQoJ3NxbEV4cHJPYmonLCBudWxsKVxuICAgIH0pXG4gIH1cblxuICBzaG93U3FsRXhwclBvcHVwID0gKCkgPT4ge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBpc1NxbEV4cHJTaG93OiB0cnVlIH0pXG4gIH1cblxuICB0b2dnbGVTcWxFeHByUG9wdXAgPSAoKSA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGlzU3FsRXhwclNob3c6ICF0aGlzLnN0YXRlLmlzU3FsRXhwclNob3cgfSlcbiAgfVxuXG4gIG9uU3FsRXhwckJ1aWxkZXJDaGFuZ2UgPSAoc3FsRXhwck9iajogSU1TcWxFeHByZXNzaW9uKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5vblNldHRpbmdDaGFuZ2Uoe1xuICAgICAgYWN0aW9uSWQ6IHRoaXMucHJvcHMuYWN0aW9uSWQsXG4gICAgICBjb25maWc6IHRoaXMucHJvcHMuY29uZmlnLnNldCgnc3FsRXhwck9iaicsIHNxbEV4cHJPYmopXG4gICAgfSlcbiAgfVxuXG4gIG9uTWVzc2FnZUZpZWxkU2VsZWN0ZWQgPSAoYWxsU2VsZWN0ZWRGaWVsZHM6IElNRmllbGRTY2hlbWFbXSwgZHM6IERhdGFTb3VyY2UpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uU2V0dGluZ0NoYW5nZSh7XG4gICAgICBhY3Rpb25JZDogdGhpcy5wcm9wcy5hY3Rpb25JZCxcbiAgICAgIGNvbmZpZzogdGhpcy5wcm9wcy5jb25maWcuc2V0KCdtZXNzYWdlVXNlRGF0YVNvdXJjZScsIHtcbiAgICAgICAgZGF0YVNvdXJjZUlkOiB0aGlzLnByb3BzLmNvbmZpZy5tZXNzYWdlVXNlRGF0YVNvdXJjZS5kYXRhU291cmNlSWQsXG4gICAgICAgIG1haW5EYXRhU291cmNlSWQ6IHRoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLm1haW5EYXRhU291cmNlSWQsXG4gICAgICAgIGRhdGFWaWV3SWQ6IHRoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLmRhdGFWaWV3SWQsXG4gICAgICAgIHJvb3REYXRhU291cmNlSWQ6IHRoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLnJvb3REYXRhU291cmNlSWQsXG4gICAgICAgIGZpZWxkczogYWxsU2VsZWN0ZWRGaWVsZHMubWFwKGYgPT4gZi5qaW11TmFtZSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIG9uQWN0aW9uRmllbGRTZWxlY3RlZCA9IChhbGxTZWxlY3RlZEZpZWxkczogSU1GaWVsZFNjaGVtYVtdLCBkczogRGF0YVNvdXJjZSkgPT4ge1xuICAgIHRoaXMucHJvcHMub25TZXR0aW5nQ2hhbmdlKHtcbiAgICAgIGFjdGlvbklkOiB0aGlzLnByb3BzLmFjdGlvbklkLFxuICAgICAgY29uZmlnOiB0aGlzLnByb3BzLmNvbmZpZy5zZXQoJ2FjdGlvblVzZURhdGFTb3VyY2UnLCB7XG4gICAgICAgIGRhdGFTb3VyY2VJZDogdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZS5kYXRhU291cmNlSWQsXG4gICAgICAgIG1haW5EYXRhU291cmNlSWQ6IHRoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2UubWFpbkRhdGFTb3VyY2VJZCxcbiAgICAgICAgZGF0YVZpZXdJZDogdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZS5kYXRhVmlld0lkLFxuICAgICAgICByb290RGF0YVNvdXJjZUlkOiB0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlLnJvb3REYXRhU291cmNlSWQsXG4gICAgICAgIGZpZWxkczogYWxsU2VsZWN0ZWRGaWVsZHMubWFwKGYgPT4gZi5qaW11TmFtZSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIHN3aWN0aEVuYWJsZWREYXRhUmVsYXRpb25TaGlwID0gKGNoZWNrZWQpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uU2V0dGluZ0NoYW5nZSh7XG4gICAgICBhY3Rpb25JZDogdGhpcy5wcm9wcy5hY3Rpb25JZCxcbiAgICAgIGNvbmZpZzogdGhpcy5wcm9wcy5jb25maWcuc2V0KCdlbmFibGVkRGF0YVJlbGF0aW9uU2hpcCcsIGNoZWNrZWQpXG4gICAgfSlcbiAgfVxuXG4gIHJlbmRlciAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgQnV0dG9uLCBJY29uLCBTd2l0Y2gsIENvbGxhcHNlLCBTZXR0aW5nU2VjdGlvbiwgU2V0dGluZ1JvdywgRmllbGRTZWxlY3RvciwgRGF0YVNvdXJjZVNlbGVjdG9yLFxuICAgICAgQXJjR0lTRGF0YVNvdXJjZVR5cGVzLCBTcWxFeHByZXNzaW9uQnVpbGRlclBvcHVwXG4gICAgfSA9IHRoaXMuc3RhdGVcbiAgICBjb25zdCB7IG1lc3NhZ2VXaWRnZXRJZCwgbWVzc2FnZVR5cGUsIGNvbmZpZywgdGhlbWUgfSA9IHRoaXMucHJvcHNcbiAgICBpZiAoIUJ1dHRvbiB8fCAhSWNvbiB8fCAhU3dpdGNoIHx8ICFDb2xsYXBzZSB8fCAhU2V0dGluZ1NlY3Rpb24gfHwgIVNldHRpbmdSb3cgfHwgIUZpZWxkU2VsZWN0b3IgfHxcbiAgICAgICFEYXRhU291cmNlU2VsZWN0b3IgfHwgIUFyY0dJU0RhdGFTb3VyY2VUeXBlcyB8fCAhU3FsRXhwcmVzc2lvbkJ1aWxkZXJQb3B1cCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG5cbiAgICBjb25zdCB0cmlnZ2VyRHNTZWxlY3RvclNvdXJjZURhdGEgPSBnZXREc1NlbGVjdG9yU291cmNlRGF0YSh7XG4gICAgICB3aWRnZXRJZDogbWVzc2FnZVdpZGdldElkLFxuICAgICAgdXNlRGF0YVNvdXJjZTogY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLFxuICAgICAgbWVzc2FnZVR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgYXJjR0lTRGF0YVNvdXJjZVR5cGVzOiBBcmNHSVNEYXRhU291cmNlVHlwZXNcbiAgICB9KVxuICAgIGNvbnN0IGFjdGlvblVzZURhdGFTb3VyY2VJbnN0YW5jZSA9IHRoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2UgJiZcbiAgICAgIERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0RGF0YVNvdXJjZSh0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlLmRhdGFTb3VyY2VJZClcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNzcz17dGhpcy5nZXRTdHlsZSh0aGlzLnByb3BzLnRoZW1lKX0+XG4gICAgICAgIDxTZXR0aW5nU2VjdGlvbiB0aXRsZT17dGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2ZyYW1ld29ya0FjdGlvbl9UcmlnZ2VyTGF5ZXInLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9UcmlnZ2VyTGF5ZXIgfSl9PlxuICAgICAgICAgIDxEYXRhU291cmNlU2VsZWN0b3JcbiAgICAgICAgICAgIHR5cGVzPXt0aGlzLnN0YXRlLkRTU2VsZWN0b3JUeXBlc31cbiAgICAgICAgICAgIHVzZURhdGFTb3VyY2VzPXt0cmlnZ2VyRHNTZWxlY3RvclNvdXJjZURhdGEudXNlRGF0YVNvdXJjZXN9XG4gICAgICAgICAgICBmcm9tUm9vdERzSWRzPXt0cmlnZ2VyRHNTZWxlY3RvclNvdXJjZURhdGEuZnJvbVJvb3REc0lkc31cbiAgICAgICAgICAgIGZyb21Ec0lkcz17dHJpZ2dlckRzU2VsZWN0b3JTb3VyY2VEYXRhLmZyb21Ec0lkc31cbiAgICAgICAgICAgIGNsb3NlRGF0YVNvdXJjZUxpc3RPbkNoYW5nZVxuICAgICAgICAgICAgZGlzYWJsZVJlbW92ZT17KCkgPT4gdHJpZ2dlckRzU2VsZWN0b3JTb3VyY2VEYXRhLmlzUmVhZE9ubHl9XG4gICAgICAgICAgICBkaXNhYmxlRGF0YVNvdXJjZUxpc3Q9e3RyaWdnZXJEc1NlbGVjdG9yU291cmNlRGF0YS5pc1JlYWRPbmx5fVxuICAgICAgICAgICAgaGlkZUFkZERhdGFCdXR0b25cbiAgICAgICAgICAgIGhpZGVUeXBlRHJvcGRvd25cbiAgICAgICAgICAgIG11c3RVc2VEYXRhU291cmNlXG4gICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVUcmlnZ2VyTGF5ZXJDaGFuZ2V9XG4gICAgICAgICAgICB3aWRnZXRJZD17dGhpcy5wcm9wcy5tZXNzYWdlV2lkZ2V0SWR9XG4gICAgICAgICAgICBoaWRlRGF0YVZpZXdcbiAgICAgICAgICAgIGVuYWJsZVRvU2VsZWN0T3V0cHV0RHNGcm9tU2VsZj17dHJ1ZX1cbiAgICAgICAgICAvLyBvblNlbGVjdD17dGhpcy5oYW5kbGVUcmlnZ2VyTGF5ZXJTZWxlY3RlZH1cbiAgICAgICAgICAvLyBvblJlbW92ZT17dGhpcy5oYW5kbGVSZW1vdmVMYXllckZvclRyaWdnZXJMYXllcn1cbiAgICAgICAgICAvPlxuICAgICAgICA8L1NldHRpbmdTZWN0aW9uPlxuICAgICAgICA8U2V0dGluZ1NlY3Rpb24gdGl0bGU9e3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdmcmFtZXdvcmtBY3Rpb25fQWN0aW9uTGF5ZXInLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9BY3Rpb25MYXllciB9KX0+XG4gICAgICAgICAgPERhdGFTb3VyY2VTZWxlY3RvclxuICAgICAgICAgICAgdHlwZXM9e3RoaXMuc3RhdGUuRFNTZWxlY3RvclR5cGVzfVxuICAgICAgICAgICAgdXNlRGF0YVNvdXJjZXM9e3RoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2UgPyBJbW11dGFibGUoW3RoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2VdKSA6IEltbXV0YWJsZShbXSl9XG4gICAgICAgICAgICBjbG9zZURhdGFTb3VyY2VMaXN0T25DaGFuZ2VcbiAgICAgICAgICAgIGhpZGVBZGREYXRhQnV0dG9uXG4gICAgICAgICAgICBoaWRlVHlwZURyb3Bkb3duXG4gICAgICAgICAgICBtdXN0VXNlRGF0YVNvdXJjZVxuICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlQWN0aW9uTGF5ZXJDaGFuZ2V9XG4gICAgICAgICAgICB3aWRnZXRJZD17dGhpcy5wcm9wcy53aWRnZXRJZH1cbiAgICAgICAgICAgIGhpZGVEYXRhVmlld1xuICAgICAgICAgICAgZW5hYmxlVG9TZWxlY3RPdXRwdXREc0Zyb21TZWxmPXt0cnVlfVxuICAgICAgICAgIC8vIG9uU2VsZWN0PXt0aGlzLmhhbmRsZUFjdGlvbkxheWVyU2VsZWN0ZWR9XG4gICAgICAgICAgLy8gb25SZW1vdmU9e3RoaXMuaGFuZGxlUmVtb3ZlTGF5ZXJGb3JBY3Rpb25MYXllcn1cbiAgICAgICAgICAvPlxuICAgICAgICA8L1NldHRpbmdTZWN0aW9uPlxuICAgICAgICB7dGhpcy5wcm9wcy5jb25maWcgJiYgdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZSAmJiB0aGlzLnByb3BzLmNvbmZpZy5tZXNzYWdlVXNlRGF0YVNvdXJjZSAmJlxuICAgICAgICAgIDxTZXR0aW5nU2VjdGlvbiB0aXRsZT17dGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2ZyYW1ld29ya0FjdGlvbl9Db25kaXRpb25zJywgZGVmYXVsdE1lc3NhZ2U6IGRlZmF1bHRNZXNzYWdlcy5mcmFtZXdvcmtBY3Rpb25fQ29uZGl0aW9ucyB9KX0+XG4gICAgICAgICAgICA8U2V0dGluZ1JvdyBsYWJlbD17dGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2ZyYW1ld29ya0FjdGlvbl9SZWxhdGVNZXNzYWdlJywgZGVmYXVsdE1lc3NhZ2U6IGRlZmF1bHRNZXNzYWdlcy5mcmFtZXdvcmtBY3Rpb25fUmVsYXRlTWVzc2FnZSB9KX0+XG4gICAgICAgICAgICAgIDxTd2l0Y2ggY2hlY2tlZD17dGhpcy5wcm9wcy5jb25maWcuZW5hYmxlZERhdGFSZWxhdGlvblNoaXB9IG9uQ2hhbmdlPXtldnQgPT4geyB0aGlzLnN3aWN0aEVuYWJsZWREYXRhUmVsYXRpb25TaGlwKGV2dC50YXJnZXQuY2hlY2tlZCkgfX0gLz5cbiAgICAgICAgICAgIDwvU2V0dGluZ1Jvdz5cbiAgICAgICAgICAgIDxTZXR0aW5nUm93PlxuICAgICAgICAgICAgICA8Q29sbGFwc2UgaXNPcGVuPXt0aGlzLnByb3BzLmNvbmZpZy5lbmFibGVkRGF0YVJlbGF0aW9uU2hpcH0gY2xhc3NOYW1lPSd3LTEwMCc+XG4gICAgICAgICAgICAgICAge2NoZWNrVHJpZ2VyTGF5ZXJJc1NhbWVUb0FjdGlvbkxheWVyKGNvbmZpZykgJiZcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd3LTEwMCBib3JkZXIgcC0xIG1yLTInPnt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX0F1dG9CaW5kJywgZGVmYXVsdE1lc3NhZ2U6IGRlZmF1bHRNZXNzYWdlcy5mcmFtZXdvcmtBY3Rpb25fQXV0b0JpbmQgfSl9PC9kaXY+fVxuICAgICAgICAgICAgICAgIHshY2hlY2tUcmlnZXJMYXllcklzU2FtZVRvQWN0aW9uTGF5ZXIoY29uZmlnKSAmJiA8ZGl2IGNsYXNzTmFtZT0ndy0xMDAgZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlcic+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nZC1mbGV4IGZsZXgtY29sdW1uIHJlbGF0ZS1wYW5lbC1sZWZ0Jz5cbiAgICAgICAgICAgICAgICAgICAgPEZpZWxkU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3ctMTAwJ1xuICAgICAgICAgICAgICAgICAgICAgIHVzZURhdGFTb3VyY2VzPXtJbW11dGFibGUoW3RoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlPy5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pXSl9IGlzRGF0YVNvdXJjZURyb3BEb3duSGlkZGVuXG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdmcmFtZXdvcmtBY3Rpb25fVHJpZ2dlckxheWVyRmllbGQnLCBkZWZhdWx0TWVzc2FnZTogZGVmYXVsdE1lc3NhZ2VzLmZyYW1ld29ya0FjdGlvbl9UcmlnZ2VyTGF5ZXJGaWVsZCB9KX1cbiAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbk1lc3NhZ2VGaWVsZFNlbGVjdGVkfSB1c2VEcm9wZG93biBpc1NlYXJjaElucHV0SGlkZGVuXG4gICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWVsZHM9e3RoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlICYmIHRoaXMucHJvcHMuY29uZmlnLm1lc3NhZ2VVc2VEYXRhU291cmNlLmZpZWxkc1xuICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLnByb3BzLmNvbmZpZy5tZXNzYWdlVXNlRGF0YVNvdXJjZS5maWVsZHNcbiAgICAgICAgICAgICAgICAgICAgICAgIDogSW1tdXRhYmxlKFtdKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPEZpZWxkU2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J3ctMTAwIGFjdGlvbi1zZWxlY3QtY2hvb3NlcidcbiAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5pbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2ZyYW1ld29ya0FjdGlvbl9BY3Rpb25MYXllckZpZWxkJywgZGVmYXVsdE1lc3NhZ2U6IGRlZmF1bHRNZXNzYWdlcy5mcmFtZXdvcmtBY3Rpb25fQWN0aW9uTGF5ZXJGaWVsZCB9KX1cbiAgICAgICAgICAgICAgICAgICAgICB1c2VEYXRhU291cmNlcz17SW1tdXRhYmxlKFt0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlPy5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pXSl9IGlzRGF0YVNvdXJjZURyb3BEb3duSGlkZGVuXG4gICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25BY3Rpb25GaWVsZFNlbGVjdGVkfSB1c2VEcm9wZG93biBpc1NlYXJjaElucHV0SGlkZGVuXG4gICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWVsZHM9e3RoaXMucHJvcHMuY29uZmlnLmFjdGlvblVzZURhdGFTb3VyY2UgJiYgdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZS5maWVsZHNcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZS5maWVsZHNcbiAgICAgICAgICAgICAgICAgICAgICAgIDogSW1tdXRhYmxlKFtdKX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPExpbmtDb21iaW5lZE91dGxpbmVkIGF1dG9GbGlwIGNsYXNzTmFtZT0nZmxleC1ub25lJyB3aWR0aD17MTJ9IGhlaWdodD17NDB9IGNvbG9yPXt0aGVtZS5jb2xvcnMuZGFya1s0MDBdfS8+XG4gICAgICAgICAgICAgICAgPC9kaXY+fVxuICAgICAgICAgICAgICA8L0NvbGxhcHNlPlxuICAgICAgICAgICAgPC9TZXR0aW5nUm93PlxuICAgICAgICAgICAgPFNldHRpbmdSb3c+XG4gICAgICAgICAgICAgIDxCdXR0b24gdHlwZT0nbGluaycgZGlzYWJsZWQ9eyF0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlfSBjbGFzc05hbWU9J3ctMTAwIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtc3RhcnQnIG9uQ2xpY2s9e3RoaXMuc2hvd1NxbEV4cHJQb3B1cH0+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3ctMTAwIHRleHQtdHJ1bmNhdGUnIHN0eWxlPXt7IHRleHRBbGlnbjogJ3N0YXJ0JyB9fT5cbiAgICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLmludGwuZm9ybWF0TWVzc2FnZSh7IGlkOiAnZnJhbWV3b3JrQWN0aW9uX01vcmVDb25kaXRpb25zJywgZGVmYXVsdE1lc3NhZ2U6IGRlZmF1bHRNZXNzYWdlcy5mcmFtZXdvcmtBY3Rpb25fTW9yZUNvbmRpdGlvbnMgfSl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICB7dGhpcy5wcm9wcy5jb25maWcuYWN0aW9uVXNlRGF0YVNvdXJjZSAmJiA8RGF0YVNvdXJjZUNvbXBvbmVudCB1c2VEYXRhU291cmNlPXt0aGlzLnByb3BzLmNvbmZpZy5hY3Rpb25Vc2VEYXRhU291cmNlfT57KGRzKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgIDxTcWxFeHByZXNzaW9uQnVpbGRlclBvcHVwXG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2U9e2RzfSBtb2RlPXtTcWxFeHByZXNzaW9uTW9kZS5TaW1wbGV9XG4gICAgICAgICAgICAgICAgICAgIGlzT3Blbj17dGhpcy5zdGF0ZS5pc1NxbEV4cHJTaG93fSB0b2dnbGU9e3RoaXMudG9nZ2xlU3FsRXhwclBvcHVwfVxuICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uPXt0aGlzLnByb3BzLmNvbmZpZy5zcWxFeHByT2JqfSBvbkNoYW5nZT17KHNxbEV4cHJPYmopID0+IHsgdGhpcy5vblNxbEV4cHJCdWlsZGVyQ2hhbmdlKHNxbEV4cHJPYmopIH19XG4gICAgICAgICAgICAgICAgICAgIGlkPSdmaWx0ZXItd2lkZ2V0LXNxbC1leHByZXNzaW9uLWJ1aWxkZXItcG9wdXAnXG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgPC9EYXRhU291cmNlQ29tcG9uZW50Pn1cbiAgICAgICAgICAgIDwvU2V0dGluZ1Jvdz5cbiAgICAgICAgICAgIDxTZXR0aW5nUm93PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0nc3FsLWV4cHItZGlzcGxheSc+XG4gICAgICAgICAgICAgICAge3RoaXMucHJvcHMuY29uZmlnLnNxbEV4cHJPYmogJiYgYWN0aW9uVXNlRGF0YVNvdXJjZUluc3RhbmNlXG4gICAgICAgICAgICAgICAgICA/IGRhdGFTb3VyY2VVdGlscy5nZXRBcmNHSVNTUUwodGhpcy5wcm9wcy5jb25maWcuc3FsRXhwck9iaiwgYWN0aW9uVXNlRGF0YVNvdXJjZUluc3RhbmNlKS5kaXNwbGF5U1FMXG4gICAgICAgICAgICAgICAgICA6IHRoaXMucHJvcHMuaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICdmcmFtZXdvcmtBY3Rpb25fU2V0RXhwcmVzc2lvbicsIGRlZmF1bHRNZXNzYWdlOiBkZWZhdWx0TWVzc2FnZXMuZnJhbWV3b3JrQWN0aW9uX1NldEV4cHJlc3Npb24gfSl9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9TZXR0aW5nUm93PlxuICAgICAgICAgIDwvU2V0dGluZ1NlY3Rpb24+fVxuICAgICAgPC9kaXY+XG4gICAgKVxuICB9XG59XG5cbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9IChzdGF0ZTogSU1TdGF0ZSk6IFN0YXRlRXh0cmFQcm9wcyA9PiB7XG4gIHJldHVybiB7XG4gICAgZGF0YVNvdXJjZXM6IHN0YXRlLmFwcFN0YXRlSW5CdWlsZGVyICYmIHN0YXRlLmFwcFN0YXRlSW5CdWlsZGVyLmFwcENvbmZpZyAmJiBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlci5hcHBDb25maWcuZGF0YVNvdXJjZXMsXG4gICAgZGF0YVNvdXJjZXNJbmZvOiBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlciAmJiBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlci5kYXRhU291cmNlc0luZm9cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBSZWFjdFJlZHV4LmNvbm5lY3Q8U3RhdGVFeHRyYVByb3BzLCB1bmtub3duLCBBY3Rpb25TZXR0aW5nUHJvcHM8SU1Db25maWc+PihtYXBTdGF0ZVRvUHJvcHMpKHdpdGhUaGVtZShfU2VsZWN0RGF0YVJlY29yZEFjdGlvblNldHRpbmcpKVxuIiwiaW1wb3J0IHtcbiAgdHlwZSBJbW11dGFibGVPYmplY3QsIHR5cGUgVXJsUGFyYW1ldGVycywgdHlwZSBJTVVzZXIsXG4gIHR5cGUgSW50bFNoYXBlLCB0eXBlIElNVGhlbWVWYXJpYWJsZXMsIHR5cGUgSU1MYXlvdXRJdGVtSnNvbiwgdHlwZSBMYXlvdXRJbmZvLCB0eXBlIEJvdW5kaW5nQm94LCB0eXBlIERhdGFTb3VyY2VKc29uLCB0eXBlIElNV2lkZ2V0SnNvbiwgdHlwZSBXaWRnZXRKc29uXG59IGZyb20gJ2ppbXUtY29yZSdcblxuLyoqIFRoZSB3aWRnZXQgc2V0dGluZyBjb21wb25lbnQgcHJvcHMgKi9cbmV4cG9ydCB0eXBlIEFsbFdpZGdldFNldHRpbmdQcm9wczxUPiA9IFdpZGdldFNldHRpbmdQcm9wcyAmIFdpZGdldFNldHRpbmdJbmplY3RlZFByb3BzPFQ+XG5cbi8qKlxuICogVGhlIGBvblNldHRpbmdDaGFuZ2VgIGNhbGxiYWNrIGZ1bmN0aW9uLlxuICpcbiAqIFVwZGF0ZWQgc2V0dGluZyB2YWx1ZXMgY2FuIGJlIHBhc3NlZCBpbiB0aGUgZmlyc3QgcGFyYW1ldGVyIChgd2lkZ2V0SnNvbmApIGFzIGFuIG9iamVjdC4gT25seSBjaGFuZ2VkIHByb3BlcnRpZXMgbmVlZCB0byBiZSBpbmNsdWRlZC5cbiAqIFRvIGRlbGV0ZSBhbiBleGlzdGluZyBwcm9wZXJ0eSwgc2V0IGl0IHRvIGBudWxsYC5cbiAqIElmIHRoZSB3aWRnZXQgZ2VuZXJhdGVzIGFuIG91dHB1dCBkYXRhIHNvdXJjZSwgaW5jbHVkZSBpdCBhcyB0aGUgc2Vjb25kIHBhcmFtZXRlciAob3B0aW9uYWwpLlxuICpcbiAqL1xuZXhwb3J0IHR5cGUgU2V0dGluZ0NoYW5nZUZ1bmN0aW9uID0gKHdpZGdldEpzb246IFBhcnRpYWw8V2lkZ2V0SnNvbj4sIG91dHB1dERhdGFTb3VyY2VzSnNvbj86IERhdGFTb3VyY2VKc29uW10pID0+IHZvaWRcblxuLyoqIFRoZSB3aWRnZXQgc2V0dGluZyBwcm9wcy4gSW5jbHVkZWQgaW4gQWxsV2lkZ2V0U2V0dGluZ1Byb3BzLiAqL1xuZXhwb3J0IGludGVyZmFjZSBXaWRnZXRTZXR0aW5nUHJvcHMgZXh0ZW5kcyBPbWl0PFJlYWN0LkhUTUxBdHRyaWJ1dGVzPEhUTUxEaXZFbGVtZW50PiwgJ3N0eWxlJz4ge1xuICB3aWRnZXRJZDogc3RyaW5nXG4gIC8qKlxuICAgKlxuICAgKiBXaGVuIGEgc2V0dGluZyBpcyBjaGFuZ2VkIHZpYSB1c2VyIGlucHV0LCBjYWxsIHRoaXMgZnVuY3Rpb24gdG8gc2F2ZSB0aGF0IGNoYW5nZWQgdmFsdWUgaW50byB0aGUgd2lkZ2V0IGNvbmZpZ3VyYXRpb24uXG4gICAqL1xuICBvblNldHRpbmdDaGFuZ2U6IFNldHRpbmdDaGFuZ2VGdW5jdGlvblxufVxuXG4vKiogQGlnbm9yZSAqL1xuZXhwb3J0IGludGVyZmFjZSBXaWRnZXRJdGVtU2V0dGluZ1Byb3BzIHtcbiAgbGF5b3V0OiBJTUxheW91dEl0ZW1Kc29uXG4gIG9uU2V0dGluZ0NoYW5nZTogKGxheW91dEluZm86IExheW91dEluZm8sIHNldHRpbmcpID0+IHZvaWRcbiAgb25Qb3NDaGFuZ2U6IChsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLCBiYm94OiBCb3VuZGluZ0JveCkgPT4gdm9pZFxufVxuXG4vKiogVGhlIHdpZGdldCBzZXR0aW5nIGNvbXBvbmVudCBwcm9wcyBpbmplY3RlZCBieSBmcmFtZXdvcmsuIEluY2x1ZGVkIGluIEFsbFdpZGdldFByb3BzLiAqL1xuZXhwb3J0IHR5cGUgV2lkZ2V0U2V0dGluZ0luamVjdGVkUHJvcHM8VD4gPSBPbWl0PElNV2lkZ2V0SnNvbiwgJ2NvbmZpZyc+ICYge1xuICBkaXNwYXRjaDogYW55XG4gIHF1ZXJ5T2JqZWN0OiBJbW11dGFibGVPYmplY3Q8VXJsUGFyYW1ldGVycz5cbiAgY29uZmlnOiBUXG5cbiAgbG9jYWxlOiBzdHJpbmdcbiAgYXBwSTE4bk1lc3NhZ2VzOiBhbnlcbiAgaW50bDogSW50bFNoYXBlXG5cbiAgdG9rZW4/OiBzdHJpbmdcbiAgdXNlcj86IElNVXNlclxuICB0aGVtZTogSU1UaGVtZVZhcmlhYmxlc1xuICB0aGVtZTI6IElNVGhlbWVWYXJpYWJsZXNcblxuICBwb3J0YWxVcmw/OiBzdHJpbmdcbiAgcG9ydGFsU2VsZj86IGFueVxufVxuIiwiaW1wb3J0IHsgdHlwZSBBcHBSZXNvdXJjZU1hbmFnZXIgfSBmcm9tICdqaW11LWZvci1idWlsZGVyJ1xuLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlICovXG5pbXBvcnQgeyB0eXBlIElQYXJhbXMgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuaW1wb3J0IHtcbiAgdHlwZSBBcHBDcmVhdGlvbkluZm8sXG4gIGdldEFwcFN0b3JlLFxuICBtb2R1bGVMb2FkZXIsXG4gIHR5cGUgQXBwQ29uZmlnLFxuICB0eXBlIElNQXBwQ29uZmlnLFxuICBTZXNzaW9uTWFuYWdlcixcbiAgaTE4bixcbiAgSW1tdXRhYmxlLFxuICBhcHBBY3Rpb25zXG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7XG4gIHR5cGUgSVNlYXJjaE9wdGlvbnMsXG4gIHR5cGUgSVNoYXJpbmdSZXNwb25zZSxcbiAgdHlwZSBJQ3JlYXRlSXRlbVJlc3BvbnNlLFxuICB0eXBlIElNb3ZlSXRlbU9wdGlvbnMsXG4gIHR5cGUgSU1vdmVJdGVtUmVzcG9uc2UsXG4gIHR5cGUgSUdldFVzZXJUYWdzUmVzcG9uc2UsXG4gIHR5cGUgSUdyb3VwLFxuICB0eXBlIFNlYXJjaFF1ZXJ5QnVpbGRlcixcbiAgdHlwZSBJU2VhcmNoUmVzdWx0XG59IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXBvcnRhbCdcbmltcG9ydCB7XG4gIHNlYXJjaEl0ZW1zLFxuICByZW1vdmVJdGVtLFxuICB1cGRhdGVJdGVtLFxuICB1cGRhdGVBcHBzVGh1bWJuYWlsLFxuICBnZXRJdGVtLFxuICBnZXRJdGVtRGF0YSxcbiAgZ2V0VXNlckNvbnRlbnQsXG4gIHNoYXJlSXRlbVdpdGhHcm91cCxcbiAgdW5zaGFyZUl0ZW1XaXRoR3JvdXAsXG4gIGdldEl0ZW1zR3JvdXBzLFxuICBtb3ZlSXRlbSxcbiAgZ2V0VXNlcnNUYWdzLFxuICBzZWFyY2hHcm91cCxcbiAgaW1wb3J0QXBwLFxuICBjaGVja0FwcFZlcnNpb24sXG4gIGdldEdyb3VwQ2F0ZWdvcnlTY2hlbWEgYXMgZ2V0R3JvdXBDYXRlZ29yeVNjaGVtYVNlcnZpY2UsXG4gIGdldE9yZ0NhdGVnb3J5U2NoZW1hIGFzIGdldE9yZ0NhdGVnb3J5U2NoZW1hU2VydmljZSxcbiAgZ2V0R3JvdXBDb250ZW50cyxcbiAgc2VhcmNoSXRlbXNCeVBvcnRhbFVybFxufSBmcm9tICcuLi9yZXN0LXNlcnZpY2UnXG5pbXBvcnQge1xuICBnZXRTZXNzaW9uLCBjcmF0ZUFwcEJ5QXBwLCBnZXROZXdBcHBUaXRsZVdpdGhJbmRleCwgY3JlYXRlQXBwRm9yRHVwbGljYXRlLCBnZXRTZXNzaW9uQnlTZWFyY2hUeXBlLCBnZXRQcmV2aWV3VXJsLCBnZXRBcHBDb25maWdJblJlc291cmNlcywgZ2V0Q3JlYXRlQXBwUGFyYW1zQnlBcHBJZCwgZHVwbGljYXRlUmVzb3VyY2VzRm9yRHVwbGljYXRlLFxuICB0b0NyZWF0ZUFwcEJ5RGVmYXVsdFRlbXBsYXRlLCBjcmVhdGVBcHBDYWxsQmFjaywgdXBkYXRlVGh1bWJuYWlsLCB1cGRhdGVUeXBlS2V5d29yZHMsIGR1cGxpY2F0ZVJlbGF0ZWREYXRhSW5BcHAsIG9wdGltaXplV2lkZ2V0c0NvbmZpZywgdXBkYXRlSGlzdG9yeUxhYmVscywgdXBkYXRlVGh1bWJuYWlsRm9yU2F2ZUFzQXBwLCBjbG9uZU9iaiwgcmVwbGFjZUV4YlZlcnNpb25JbkFwcENvbmZpZyxcbiAgdXBkYXRlSXRlbURhdGFJbkFwcCwgaW5pdEFwcENvbmZpZ09mTmV3QXBwXG59IGZyb20gJy4vdXRpbCdcbmltcG9ydCB7IHR5cGUgQXBwSW5mbywgU2VhcmNoVHlwZSwgQXBwVHlwZSwgdHlwZSBJbXBvcnRBcHBPcHRpb24sIHR5cGUgU2F2ZUFzUmVzcG9uc2UgfSBmcm9tICcuLi90eXBlJ1xuaW1wb3J0IHsgdHlwZSBJSXRlbVVwZGF0ZSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXR5cGVzJ1xuaW1wb3J0IHsgZ2V0VGVtcGxhdGVDb25maWcsIFRlbXBsYXRlVHlwZSB9IGZyb20gJ2ppbXUtZm9yLWJ1aWxkZXIvdGVtcGxhdGVzJ1xuXG4vKipcbiAqIENyZWF0ZSBhcHAgYnkgcG9ydGFsIHRlbXBsYXRlL0FHT0wgdGVtcGxhdGUvbG9jYWwgdGVtcGxhdGVcbiAqIGZvbGRlcklkOiBJZiB0aGUgZm9sZGVySWQgaGFzIGEgdmFsdWUsIHRoZSBhcHAgd2lsbCBiZSBjcmVhdGVkIGluIHRoZSBmb2xkZXIgY29ycmVzcG9uZGluZyB0byB0aGUgZm9sZGVySWRcbiovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXBwQnlJdGVtVGVtcGxhdGUgKFxuICBhcHBJbmZvOiBBcHBJbmZvLFxuICBmb2xkZXJJZD86IHN0cmluZ1xuKSB7XG4gIHJldHVybiBhd2FpdCBjcmF0ZUFwcEJ5QXBwKGFwcEluZm8sIGZhbHNlLCBmb2xkZXJJZClcbn1cblxuLyoqXG4gKiBDcmVhdGUgYXBwIHdpdGggdGVtcGxhdGUgaWQsIHN1Y2ggYXM6IHh4eC5jb20vYnVpbGRlci8/dGVtcGxhdGU9aWRcbiovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXBwQnlUZW1wbGF0ZUlkICh0ZW1wbGF0ZUlkOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGF3YWl0IGdldENyZWF0ZUFwcFBhcmFtc0J5QXBwSWQodGVtcGxhdGVJZCkudGhlbihhc3luYyBhcHBJbmZvID0+IHtcbiAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXBwQnlJdGVtVGVtcGxhdGUoYXBwSW5mbylcbiAgfSlcbn1cblxuLyoqXG4gKkNyZWF0ZSBhcHAgYnkgZGVmYXVsdCB0ZW1wbGF0ZSBkZWZpbmVkIGluIHRoZSBjb2RlXG4gKnRpdGxlOiBUaGUgdHJhbnNsYXRlZCBzdHJpbmcgb2YgJ1VudGl0bGVkIGV4cGVyaWVuY2UnXG4gKmxhYmxlOiBUaGUgZGVmYXVsdCB0ZW1wbGF0ZSdzIG5hbWVcbiAqZm9sZGVySWQ6IElmIHRoZSBmb2xkZXJJZCBoYXMgYSB2YWx1ZSwgdGhlIGFwcCB3aWxsIGJlIGNyZWF0ZWQgaW4gdGhlIGZvbGRlciBjb3JyZXNwb25kaW5nIHRvIHRoZSBmb2xkZXJJZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXBwQnlEZWZhdWx0VGVtcGxhdGUgKFxuICB0aXRsZTogc3RyaW5nLFxuICB0ZW1wbGF0ZU5hbWU6IHN0cmluZyxcbiAgZm9sZGVySWQ/OiBzdHJpbmcsXG4gIHdlYm1hcElkPzogc3RyaW5nLFxuICB3ZWJzY2VuZUlkPzogc3RyaW5nXG4pOiBQcm9taXNlPEFwcEluZm8+IHtcbiAgcmV0dXJuIGF3YWl0IGdldE5ld0FwcFRpdGxlV2l0aEluZGV4KHRpdGxlKS50aGVuKGFzeW5jIG5ld1RpdGxlID0+IHtcbiAgICBpZiAobmV3VGl0bGUpIHtcbiAgICAgIGNvbnN0IGFwcEluZm8gPSB7XG4gICAgICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZU5hbWUsXG4gICAgICAgIG5hbWU6IG5ld1RpdGxlLFxuICAgICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICAgIHR5cGU6IEFwcFR5cGUuRXhwZXJpZW5jZVR5cGVcbiAgICAgIH0gYXMgQXBwQ3JlYXRpb25JbmZvXG5cbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChbZ2V0RGVmYXVsdFRlbXBsYXRlQ29uZmlnKGFwcEluZm8pXSlcbiAgICAgICAgLnRoZW4oYXN5bmMgZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICBsZXQgZGVmYXVsdEFwcENvbmZpZyA9IHJlc3VsdHNbMF1cblxuICAgICAgICAgIGRlZmF1bHRBcHBDb25maWcudGVtcGxhdGUgPSBhcHBJbmZvLnRlbXBsYXRlXG4gICAgICAgICAgZGVmYXVsdEFwcENvbmZpZyA9IGluaXRBcHBDb25maWdPZk5ld0FwcChkZWZhdWx0QXBwQ29uZmlnKVxuXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRvQ3JlYXRlQXBwQnlEZWZhdWx0VGVtcGxhdGUoYXBwSW5mbywgZm9sZGVySWQpLnRoZW4oXG4gICAgICAgICAgICBhc3luYyAoaXRlbTogSUNyZWF0ZUl0ZW1SZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXBwQ2FsbEJhY2soZGVmYXVsdEFwcENvbmZpZywgaXRlbSwgd2VibWFwSWQsIHdlYnNjZW5lSWQpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QobnVsbClcbiAgICB9XG4gIH0pXG59XG5cbi8qKlxuICogZm9sZGVySWQ6IElmIHRoZSBmb2xkZXJJZCBoYXMgYSB2YWx1ZSwgdGhlIHRlbXBsYXRlIHdpbGwgYmUgY3JlYXRlZCBpbiB0aGUgZm9sZGVyIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGZvbGRlcklkXG4qL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRlbXBsYXRlQnlBcHAgKFxuICBhcHBJbmZvOiBBcHBJbmZvLFxuICBmb2xkZXJJZD86IHN0cmluZ1xuKSB7XG4gIHJldHVybiBhd2FpdCBjcmF0ZUFwcEJ5QXBwKGFwcEluZm8sIHRydWUsIGZvbGRlcklkKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW1wb3J0SXRlbSAoaW1wb3J0QXBwT3B0aW9uOiBJbXBvcnRBcHBPcHRpb24pIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICByZXR1cm4gYXdhaXQgaW1wb3J0QXBwKGltcG9ydEFwcE9wdGlvbiwgeyBhdXRoZW50aWNhdGlvbjogc2Vzc2lvbiB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tJbXBvcnRBcHBWZXJzaW9uIChpbXBvcnRBcHBPcHRpb246IEltcG9ydEFwcE9wdGlvbikge1xuICBjb25zdCBzZXNzaW9uID0gU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gIHJldHVybiBhd2FpdCBjaGVja0FwcFZlcnNpb24oaW1wb3J0QXBwT3B0aW9uLCB7IGF1dGhlbnRpY2F0aW9uOiBzZXNzaW9uIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbXBvcnRBcHBGcm9tUG9ydGFsIChwb3J0YWxBcHBJbmZvOiBBcHBJbmZvKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIGR1cGxpY2F0ZUFwcChwb3J0YWxBcHBJbmZvLCBudWxsLCB0cnVlKVxufVxuXG4vKipcbiAqIGZvbGRlcklkOiBJZiB0aGUgZm9sZGVySWQgaGFzIGEgdmFsdWUsIHRoZSBhcHAgd2lsbCBiZSBjcmVhdGVkIGluIHRoZSBmb2xkZXIgY29ycmVzcG9uZGluZyB0byB0aGUgZm9sZGVySWRcbiovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZHVwbGljYXRlQXBwIChcbiAgYXBwSW5mbzogQXBwSW5mbyxcbiAgZm9sZGVySWQ/OiBzdHJpbmcsXG4gIGlzTm90VXBkYXRlTmV3QXBwVGl0bGU/OiBib29sZWFuXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gYXdhaXQgZ2V0QXBwSW5mbyhhcHBJbmZvKS50aGVuKFxuICAgIGFzeW5jIGFwcEl0ZW0gPT4ge1xuICAgICAgaWYgKGFwcEl0ZW0pIHtcbiAgICAgICAgY29uc3QgY29weSA9IGkxOG4uZ2V0SW50bCgpLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ2NvcHknIH0pIHx8ICdjb3B5J1xuICAgICAgICBjb25zdCB0aXRsZSA9IGlzTm90VXBkYXRlTmV3QXBwVGl0bGUgPyBhcHBJdGVtLnRpdGxlIDogYCR7YXBwSXRlbS50aXRsZX0gJHtjb3B5fWBcbiAgICAgICAgcmV0dXJuIGF3YWl0IGdldE5ld0FwcFRpdGxlV2l0aEluZGV4KFxuICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgIHRydWUsXG4gICAgICAgICAgYXBwSW5mby50eXBlXG4gICAgICAgICkudGhlbihhc3luYyBuZXdUaXRsZSA9PiB7XG4gICAgICAgICAgaWYgKG5ld1RpdGxlKSB7XG4gICAgICAgICAgICBjb25zdCBkdXBsaWNhdGVBcHBJbmZvID0ge1xuICAgICAgICAgICAgICBuYW1lOiBuZXdUaXRsZSxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGFwcEl0ZW0/LmRlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgICAgICAgICBzbmlwcGV0OiBhcHBJdGVtPy5zbmlwcGV0IHx8ICcnLFxuICAgICAgICAgICAgICB0eXBlS2V5d29yZHM6IGFwcEl0ZW0/LnR5cGVLZXl3b3JkcyB8fCBbXSxcbiAgICAgICAgICAgICAgdGFnczogYXBwSXRlbS50YWdzLFxuICAgICAgICAgICAgICB0aHVtYm5haWw6IGFwcEl0ZW0udGh1bWJuYWlsLFxuICAgICAgICAgICAgICB0eXBlOiBhcHBJbmZvLnR5cGUgfHwgYXBwSXRlbS50eXBlXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBcHBGb3JEdXBsaWNhdGUoZHVwbGljYXRlQXBwSW5mbyBhcyBhbnksIGZvbGRlcklkKS50aGVuKFxuICAgICAgICAgICAgICBhc3luYyBuZXdBcHBJdGVtID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobmV3QXBwSXRlbSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHVwZGF0ZVRodW1ibmFpbChcbiAgICAgICAgICAgICAgICAgICAgbmV3QXBwSXRlbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgYXBwSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgYXBwSXRlbS50aHVtYm5haWxcbiAgICAgICAgICAgICAgICAgICkudGhlbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBkdXBsaWNhdGVSZWxhdGVkRGF0YUluQXBwKFxuICAgICAgICAgICAgICAgICAgICAgIG5ld0FwcEl0ZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgYXBwSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgICAgICAgICApLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShuZXdBcHBJdGVtLmlkKVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZUFwcChuZXdBcHBJdGVtLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KG51bGwpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChudWxsKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChudWxsKVxuICAgICAgfVxuICAgIH1cbiAgKVxufVxuXG4vKipcbiAqIGZvbGRlcklkOiBJZiB0aGUgZm9sZGVySWQgaGFzIGEgdmFsdWUsIHRoZSBhcHAgd2lsbCBiZSBjcmVhdGVkIGluIHRoZSBmb2xkZXIgY29ycmVzcG9uZGluZyB0byB0aGUgZm9sZGVySWRcbiovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUFzQXBwIChcbiAgb3JpZ2luQXBwSW5mbzogQXBwSW5mbyxcbiAgbmV3QXBwVXBkYXRlSW5mbzogQXBwSW5mbyxcbiAgZm9sZGVySWQ/OiBzdHJpbmcsXG4gIHRodW1ibmFpbEZpbGVzPzogYW55XG4pOiBQcm9taXNlPFNhdmVBc1Jlc3BvbnNlPiB7XG4gIHJldHVybiBhd2FpdCBnZXROZXdBcHBUaXRsZVdpdGhJbmRleChgJHtuZXdBcHBVcGRhdGVJbmZvLnRpdGxlfWAsIHRydWUsIG5ld0FwcFVwZGF0ZUluZm8udHlwZSkudGhlbihhc3luYyBuZXdUaXRsZSA9PiB7XG4gICAgaWYgKG5ld1RpdGxlKSB7XG4gICAgICBjb25zdCBkdXBsaWNhdGVBcHBJbmZvID0ge1xuICAgICAgICBuYW1lOiBuZXdBcHBVcGRhdGVJbmZvLnRpdGxlLFxuICAgICAgICBkZXNjcmlwdGlvbjogbmV3QXBwVXBkYXRlSW5mbz8uZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIHNuaXBwZXQ6IG5ld0FwcFVwZGF0ZUluZm8/LnNuaXBwZXQgfHwgJycsXG4gICAgICAgIHR5cGVLZXl3b3JkczogbmV3QXBwVXBkYXRlSW5mbz8udHlwZUtleXdvcmRzIHx8IFtdLFxuICAgICAgICB0YWdzOiBuZXdBcHBVcGRhdGVJbmZvLnRhZ3MsXG4gICAgICAgIHRodW1ibmFpbDogbmV3QXBwVXBkYXRlSW5mby50aHVtYm5haWwsXG4gICAgICAgIHR5cGU6IG9yaWdpbkFwcEluZm8udHlwZSB8fCBvcmlnaW5BcHBJbmZvLnR5cGVcbiAgICAgIH1cblxuICAgICAgLy9DcmVhdGUgbmV3IGFwcFxuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUFwcEZvckR1cGxpY2F0ZShkdXBsaWNhdGVBcHBJbmZvIGFzIGFueSwgZm9sZGVySWQpLnRoZW4oXG4gICAgICAgIGFzeW5jIG5ld0FwcEl0ZW0gPT4ge1xuICAgICAgICAgIGlmIChuZXdBcHBJdGVtKSB7XG4gICAgICAgICAgICBuZXdBcHBVcGRhdGVJbmZvLmlkID0gbmV3QXBwSXRlbS5pZFxuICAgICAgICAgICAgLy9VcGRhdGUgdGh1bWJuYWlsIG9mIG5ldyBpdGVtXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdXBkYXRlVGh1bWJuYWlsRm9yU2F2ZUFzQXBwKG9yaWdpbkFwcEluZm8sIG5ld0FwcFVwZGF0ZUluZm8sIHRodW1ibmFpbEZpbGVzKS50aGVuKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHVwZGF0ZUl0ZW1EYXRhSW5BcHAobmV3QXBwSXRlbS5pZCkudGhlbihcbiAgICAgICAgICAgICAgICBhc3luYyByZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KG51bGwpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAvL1VwZGF0ZSByZXNvdXJjZXMgb2YgbmV3IGl0ZW1cbiAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBkdXBsaWNhdGVSZXNvdXJjZXNGb3JEdXBsaWNhdGUobmV3QXBwSXRlbS5pZCwgb3JpZ2luQXBwSW5mbywgdHJ1ZSkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIC8vU2F2ZSBjdXJyZW50IG5ldyBjb25maWdcbiAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3QXBwQ29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyLmFwcENvbmZpZ1xuICAgICAgICAgICAgICAgICAgICAgIG5ld0FwcENvbmZpZyA9IHJlcGxhY2VFeGJWZXJzaW9uSW5BcHBDb25maWcobmV3QXBwQ29uZmlnKVxuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IG5ld0FwcENvbmZpZz8uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KVxuICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAqIFByb3h5IGlzIGNvbm5lY3RlZCB0byBpdGVtIGlkLCBwcm94eSBjcmVhdGVkIGluIGl0ZW0gQSBjYW5ub3QgYmUgdXNlZCBpbiBpdGVtIEIuXG4gICAgICAgICAgICAgICAgICAgICAgICogU28gZGVsZXRlIGFwcCBwcm94aWVzIHdoZW4gZHVwbGljYXRlIGl0ZW1zLlxuICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjb25maWcuYXBwUHJveGllc1xuXG4gICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbmZpZy5oaXN0b3J5TGFiZWxzXG5cbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2F2ZUFwcChuZXdBcHBVcGRhdGVJbmZvLCBJbW11dGFibGUoY29uZmlnKSwgbmV3QXBwSXRlbS5pZCkudGhlbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JldHVybiBpZCBhbmQgY29uZmlnIG9mIG5ldyBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0QXBwQ29uZmlnSW5SZXNvdXJjZXMobmV3QXBwSXRlbS5pZCkudGhlbihhc3luYyBjb25maWcgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogbmV3QXBwSXRlbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBDb25maWc6IGNvbmZpZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBhc3luYyBlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgLy9EZWxldGUgbmV3IGFwcCB3aGVuIHNhdmUgYXMgZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZUFwcChuZXdBcHBJdGVtLmlkKVxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYXN5bmMgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgIC8vRGVsZXRlIG5ldyBhcHAgd2hlbiBzYXZlIGFzIGVycm9yXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycilcbiAgICAgICAgICAgICAgICAgIGRlbGV0ZUFwcChuZXdBcHBJdGVtLmlkKVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChudWxsKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QobnVsbClcbiAgICB9XG4gIH0sIGVyciA9PiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycilcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFwcENvbmZpZyAoXG4gIGFwcEluZm86IEFwcEluZm9cbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uKGFwcEluZm8pXG4gIHJldHVybiBhd2FpdCBnZXRJdGVtRGF0YShcbiAgICBhcHBJbmZvLFxuICAgIHsgYXV0aGVudGljYXRpb246IHNlc3Npb24gfVxuICApLnRoZW4oXG4gICAgYXN5bmMgcmVzdWx0ID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVzdWx0KVxuICAgIH0sXG4gICAgYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgIH1cbiAgKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoQXBwIChcbiAgc2VhcmNoT3B0aW9uOiBJU2VhcmNoT3B0aW9ucyxcbiAgc2VhcmNoVHlwZTogU2VhcmNoVHlwZVxuKTogUHJvbWlzZTxJU2VhcmNoUmVzdWx0PEFwcEluZm8+PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uQnlTZWFyY2hUeXBlKHNlYXJjaFR5cGUpXG4gIHJldHVybiBhd2FpdCBzZWFyY2hJdGVtcyhcbiAgICB7XG4gICAgICAuLi5zZWFyY2hPcHRpb24sXG4gICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgIH0sXG4gICAgc2VhcmNoVHlwZVxuICApLnRoZW4oYXN5bmMgcmVzdWx0ID0+IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdClcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEFwcEJ5UG9ydGFsVXJsIChcbiAgc2VhcmNoT3B0aW9uOiBJU2VhcmNoT3B0aW9ucyxcbiAgcG9ydGFsVXJsOiBzdHJpbmdcbik6IFByb21pc2U8SVNlYXJjaFJlc3VsdDxBcHBJbmZvPj4ge1xuICBjb25zdCBjdXJyZW50UG9ydGFsVXJsID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBjb25zdCBpc1VzZUN1cnJlbnRQb3J0YWwgPSBwb3J0YWxVcmwgPT09IGN1cnJlbnRQb3J0YWxVcmxcbiAgaWYgKGlzVXNlQ3VycmVudFBvcnRhbCkge1xuICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uQnlTZWFyY2hUeXBlKFNlYXJjaFR5cGUuUG9ydGFsKVxuICAgIHNlYXJjaE9wdGlvbi5hdXRoZW50aWNhdGlvbiA9IHNlc3Npb25cbiAgfVxuXG4gIHJldHVybiBhd2FpdCBzZWFyY2hJdGVtc0J5UG9ydGFsVXJsKFxuICAgIHNlYXJjaE9wdGlvbixcbiAgICBwb3J0YWxVcmxcbiAgKS50aGVuKGFzeW5jIHJlc3VsdCA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShyZXN1bHQpXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBcHBJbmZvIChcbiAgYXBwSW5mbzogQXBwSW5mb1xuKTogUHJvbWlzZTxBcHBJbmZvPiB7XG4gIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uKGFwcEluZm8pXG4gIHJldHVybiBhd2FpdCBnZXRJdGVtKFxuICAgIGFwcEluZm8sXG4gICAge1xuICAgICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgICB9XG4gICkudGhlbihhc3luYyByZXN1bHQgPT4ge1xuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVzdWx0KVxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0R3JvdXBDYXRlZ29yeVNjaGVtYSAoXG4gIGdyb3VwSWQ6IHN0cmluZyxcbiAgaXNHZXRBR09MQ2F0ZWdvcnlTY2hlbWE/OiBib29sZWFuXG4pOiBQcm9taXNlPEFwcEluZm8+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICByZXR1cm4gYXdhaXQgZ2V0R3JvdXBDYXRlZ29yeVNjaGVtYVNlcnZpY2UoXG4gICAgZ3JvdXBJZCxcbiAgICB7XG4gICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgIH0sXG4gICAgaXNHZXRBR09MQ2F0ZWdvcnlTY2hlbWFcbiAgKS50aGVuKGFzeW5jIHJlc3VsdCA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShyZXN1bHQpXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcmdDYXRlZ29yeVNjaGVtYSAoXG4gIGlzR2V0QUdPTENhdGVnb3J5U2NoZW1hPzogYm9vbGVhblxuKTogUHJvbWlzZTxBcHBJbmZvPiB7XG4gIGNvbnN0IHNlc3Npb24gPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgcmV0dXJuIGF3YWl0IGdldE9yZ0NhdGVnb3J5U2NoZW1hU2VydmljZShcbiAgICB7XG4gICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgIH0sXG4gICAgaXNHZXRBR09MQ2F0ZWdvcnlTY2hlbWFcbiAgKS50aGVuKGFzeW5jIHJlc3VsdCA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShyZXN1bHQpXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHcm91cENvbnRlbnQgKFxuICBncm91cElkOiBzdHJpbmcsXG4gIHBhcmFtcz86IElQYXJhbXMsXG4gIGlzR2V0QUdPTEdyb3VwQ29udGVudD86IGJvb2xlYW5cbik6IFByb21pc2U8QXBwSW5mbz4ge1xuICBjb25zdCBzZXNzaW9uID0gU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gIHJldHVybiBhd2FpdCBnZXRHcm91cENvbnRlbnRzKFxuICAgIGdyb3VwSWQsXG4gICAge1xuICAgICAgcGFyYW1zLFxuICAgICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgICB9LFxuICAgIGlzR2V0QUdPTEdyb3VwQ29udGVudFxuICApLnRoZW4oYXN5bmMgcmVzdWx0ID0+IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdClcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUFwcEluZm8gKGl0ZW1QYXJhbTogSUl0ZW1VcGRhdGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICBjb25zdCBwb3J0YWxVcmwgPSB3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24gPyAnbG9jYWxob3N0OicgOiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsVXJsXG5cbiAgY29uc3QgZ2V0QXBwSW5mb1BhcmFtcyA9IHtcbiAgICBpZDogaXRlbVBhcmFtLmlkLFxuICAgIHBvcnRhbFVybDogcG9ydGFsVXJsXG4gIH0gYXMgQXBwSW5mb1xuICByZXR1cm4gYXdhaXQgZ2V0SXRlbShnZXRBcHBJbmZvUGFyYW1zLCB7XG4gICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgfSkudGhlbihhc3luYyByZXMgPT4ge1xuICAgIHJldHVybiBhd2FpdCB1cGRhdGVJdGVtKHtcbiAgICAgIGl0ZW06IGl0ZW1QYXJhbSxcbiAgICAgIG93bmVyOiByZXMub3duZXIsXG4gICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9KVxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQXBwSW5mb1doZW5TYXZlQXBwIChhcHBJbmZvOiBBcHBJbmZvKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIHVwZGF0ZUFwcEluZm8oeyAuLi5hcHBJbmZvLCB0aHVtYm5haWx1cmw6IHVuZGVmaW5lZCB9KS50aGVuKHJlcyA9PiB7XG4gICAgY29uc3QgdGh1bWJuYWlsdXJsID0gYXBwSW5mbz8udGh1bWJuYWlsdXJsXG4gICAgY29uc3Qgc2F2ZVRodW1ibmFpbFVybCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBSdW50aW1lSW5mbz8uc2F2ZVRodW1ibmFpbFVybFxuICAgIGlmICh0aHVtYm5haWx1cmwgJiYgdGh1bWJuYWlsdXJsICE9PSBzYXZlVGh1bWJuYWlsVXJsKSB7XG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuc2F2ZVRodW1ibmFpbFVybCh0aHVtYm5haWx1cmwpKVxuICAgICAgcmV0dXJuIHVwZGF0ZVRodW1ibmFpbChhcHBJbmZvLmlkLCBhcHBJbmZvLCB0aHVtYm5haWx1cmwpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgICB9XG4gIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdVcGRhdGUgYXBwSW5mbyBlcnJvcicpXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBcHBUaHVtYm5haWwgKFxuICBpdGVtUGFyYW06IElJdGVtVXBkYXRlLFxuICBvd25lcjogc3RyaW5nID0gJydcbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBzZXNzaW9uID0gU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gIHJldHVybiBhd2FpdCB1cGRhdGVBcHBzVGh1bWJuYWlsKHtcbiAgICBpdGVtOiBpdGVtUGFyYW0sXG4gICAgYXV0aGVudGljYXRpb246IHNlc3Npb24sXG4gICAgb3duZXJcbiAgfSkudGhlbigoKSA9PiB7XG4gICAgcmV0dXJuIG51bGxcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUFwcCAoXG4gIGFwcElkOiBzdHJpbmdcbik6IFByb21pc2U8eyBpdGVtSWQ6IHN0cmluZywgc3VjY2VzczogYm9vbGVhbiB9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgcmV0dXJuIGF3YWl0IGdldEl0ZW0oeyBpZDogYXBwSWQgfSBhcyBBcHBJbmZvLCB7XG4gICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgfSkudGhlbihhc3luYyByZXMgPT4ge1xuICAgIHJldHVybiBhd2FpdCByZW1vdmVJdGVtKHtcbiAgICAgIGlkOiBhcHBJZCxcbiAgICAgIG93bmVyOiByZXMub3duZXIsXG4gICAgICBhdXRoZW50aWNhdGlvbjogU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gICAgfSlcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVBcHAgKFxuICBhcHBJbmZvOiBBcHBJbmZvLFxuICBhcHBDb25maWc6IElNQXBwQ29uZmlnLFxuICBuZXdBcHBJZD86IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHNlc3Npb24gPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgY29uc3QgQXBwUmVzb3VyY2VNYW5hZ2VyID0gbW9kdWxlTG9hZGVyLmdldE1vZHVsZVN5bmMoJ2ppbXUtZm9yLWJ1aWxkZXInKS5BcHBSZXNvdXJjZU1hbmFnZXJcbiAgY29uc3QgYXBwQ29uZmlnVXRpbHNGb3JCdWlsZGVyID0gbW9kdWxlTG9hZGVyLmdldE1vZHVsZVN5bmMoJ2ppbXUtZm9yLWJ1aWxkZXInKS5hcHBDb25maWdVdGlsc1xuXG4gIGNvbnN0IG93bmVycyA9IGFwcEluZm8/Lm93bmVyIHx8IHNlc3Npb24udXNlcm5hbWVcbiAgY29uc3QgY29uZmlnID0geyAuLi5hcHBDb25maWdVdGlsc0ZvckJ1aWxkZXIuZ2V0Q2xlYW5BcHBDb25maWcoYXBwQ29uZmlnKSB9XG4gIGNvbnN0IGFwcFJlc291cmNlTWFuYWdlckluc3RhbmNlOiBBcHBSZXNvdXJjZU1hbmFnZXIgPSBBcHBSZXNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKVxuXG4gIGlmICghY29uZmlnKSB7XG4gICAgYXdhaXQgUHJvbWlzZS5yZWplY3QoKTsgcmV0dXJuXG4gIH1cbiAgdHJ5IHtcbiAgICBhd2FpdCBhcHBSZXNvdXJjZU1hbmFnZXJJbnN0YW5jZS51cExvYWRBcHBDb25maWcoYXBwSW5mby5pZCwgY29uZmlnLCBvd25lcnMpXG4gICAgY29uc3QgcHJvbWlzZXMgPSBbXVxuICAgIGNvbnN0IHsgaW1hZ2VSZXNvdXJjZXMsIGljb25SZXNvdXJjZXMgfSA9IGFwcFJlc291cmNlTWFuYWdlckluc3RhbmNlLmdldFJlc291cmNlc0luRHJhZnQoKVxuICAgIGltYWdlUmVzb3VyY2VzICYmIHByb21pc2VzLnB1c2goYXBwUmVzb3VyY2VNYW5hZ2VySW5zdGFuY2UudXBMb2FkSW1hZ2VSZXNvdXJjZUxpc3QoY2xvbmVPYmooaW1hZ2VSZXNvdXJjZXMpLCBuZXdBcHBJZCkpXG4gICAgaWNvblJlc291cmNlcyAmJiBwcm9taXNlcy5wdXNoKGFwcFJlc291cmNlTWFuYWdlckluc3RhbmNlLnVwTG9hZEljb25SZXNvdXJjZUxpc3QoY2xvbmVPYmooaWNvblJlc291cmNlcyksIG5ld0FwcElkKSlcbiAgICBwcm9taXNlcy5wdXNoKHVwZGF0ZUFwcEluZm9XaGVuU2F2ZUFwcChhcHBJbmZvKSlcbiAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcylcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBhd2FpdCBQcm9taXNlLnJlamVjdChlcnJvcilcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHVibGlzaEFwcCAoXG4gIGFwcEluZm86IEFwcEluZm9cbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBkcmFmdEFwcENvbmZpZyA9IGF3YWl0IGdldEFwcENvbmZpZ0luUmVzb3VyY2VzKGFwcEluZm8uaWQpXG4gIGNvbnN0IHB1Ymxpc2hlZEFwcENvbmZpZyA9IGF3YWl0IGdldEFwcENvbmZpZyhhcHBJbmZvKVxuXG4gIGNvbnN0IHNlc3Npb24gPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgaWYgKGRyYWZ0QXBwQ29uZmlnICYmIHB1Ymxpc2hlZEFwcENvbmZpZykge1xuICAgIGNvbnN0IG5ld1R5cGVLZXl3b3JkcyA9IHVwZGF0ZVR5cGVLZXl3b3JkcyhhcHBJbmZvPy50eXBlS2V5d29yZHMsIHB1Ymxpc2hlZEFwcENvbmZpZz8uZXhiVmVyc2lvbilcbiAgICBjb25zdCBBcHBSZXNvdXJjZU1hbmFnZXIgPSBtb2R1bGVMb2FkZXIuZ2V0TW9kdWxlU3luYygnamltdS1mb3ItYnVpbGRlcicpXG4gICAgICAuQXBwUmVzb3VyY2VNYW5hZ2VyXG4gICAgY29uc3QgYXBwUmVzb3VyY2VNYW5hZ2VySW5zdGFuY2UgPSBBcHBSZXNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKVxuICAgIHJldHVybiBhcHBSZXNvdXJjZU1hbmFnZXJJbnN0YW5jZVxuICAgICAgLnVwTG9hZExvY2FsUmVzb3VyY2UoZHJhZnRBcHBDb25maWcpXG4gICAgICAudGhlbihhc3luYyBkcmFmdEFwcENvbmZpZyA9PiB7XG4gICAgICAgIGlmICghZHJhZnRBcHBDb25maWcpIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoKVxuICAgICAgICB9XG5cbiAgICAgICAgZHJhZnRBcHBDb25maWcgPSBvcHRpbWl6ZVdpZGdldHNDb25maWcoZHJhZnRBcHBDb25maWcsIGFwcEluZm8pXG4gICAgICAgIGRyYWZ0QXBwQ29uZmlnID0gdXBkYXRlSGlzdG9yeUxhYmVscyhkcmFmdEFwcENvbmZpZywgcHVibGlzaGVkQXBwQ29uZmlnKVxuXG4gICAgICAgIGNvbnN0IHByZXZpZXdVcmwgPSBnZXRQcmV2aWV3VXJsKGFwcEluZm8pXG4gICAgICAgIGF3YWl0IHVwZGF0ZUl0ZW0oe1xuICAgICAgICAgIGl0ZW06IHtcbiAgICAgICAgICAgIGlkOiBhcHBJbmZvLmlkLFxuICAgICAgICAgICAgb3duZXI6IGFwcEluZm8ub3duZXIgfHwgc2Vzc2lvbj8udXNlcm5hbWUsXG4gICAgICAgICAgICBkYXRhOiBkcmFmdEFwcENvbmZpZyxcbiAgICAgICAgICAgIHR5cGVLZXl3b3JkczogbmV3VHlwZUtleXdvcmRzLFxuICAgICAgICAgICAgdXJsOiBwcmV2aWV3VXJsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhdXRoZW50aWNhdGlvbjogU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gICAgICAgIH0pLnRoZW4oXG4gICAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKClcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgpXG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICB9LFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoKVxuICAgICAgfVxuICAgICAgKVxuICAgICAgLmNhdGNoKGFzeW5jIGVycm9yID0+IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgICAgfSlcbiAgfSBlbHNlIHtcbiAgICBhd2FpdCBQcm9taXNlLnJlamVjdCgpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEZvbGRlcnMgKHJlcXVlc3RPcHRpb246IElQYXJhbXMpOiBQcm9taXNlPGFueT4ge1xuICByZXR1cm4gZ2V0VXNlckNvbnRlbnQocmVxdWVzdE9wdGlvbikudGhlbihcbiAgICBhc3luYyByZXN1bHQgPT4ge1xuICAgICAgY29uc3QgZm9sZGVycyA9IHJlc3VsdD8uZm9sZGVycyB8fCBbXVxuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShmb2xkZXJzKVxuICAgIH0sXG4gICAgYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgIH1cbiAgKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkVG9GYXZvcml0ZXMgKHBhcmFtczogSVBhcmFtcyk6IFByb21pc2U8SVNoYXJpbmdSZXNwb25zZT4ge1xuICByZXR1cm4gYXdhaXQgc2hhcmVJdGVtV2l0aEdyb3VwKHBhcmFtcykudGhlbihhc3luYyByZXN1bHQgPT4ge1xuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocmVzdWx0KVxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVtb3ZlRnJvbUZhdm9yaXRlcyAoXG4gIHBhcmFtczogSVBhcmFtc1xuKTogUHJvbWlzZTxJU2hhcmluZ1Jlc3BvbnNlPiB7XG4gIHJldHVybiBhd2FpdCB1bnNoYXJlSXRlbVdpdGhHcm91cChwYXJhbXMpLnRoZW4oYXN5bmMgcmVzdWx0ID0+IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdClcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFwcEdyb3VwcyAocGFyYW1zOiBJUGFyYW1zKTogUHJvbWlzZTxJU2hhcmluZ1Jlc3BvbnNlPiB7XG4gIHJldHVybiBhd2FpdCBnZXRJdGVtc0dyb3VwcyhwYXJhbXMpLnRoZW4oYXN5bmMgcmVzdWx0ID0+IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdClcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoYW5nZUFwcEZvbGRlciAoXG4gIHBhcmFtczogSU1vdmVJdGVtT3B0aW9uc1xuKTogUHJvbWlzZTxJTW92ZUl0ZW1SZXNwb25zZT4ge1xuICByZXR1cm4gYXdhaXQgbW92ZUl0ZW0oe1xuICAgIC4uLnBhcmFtcyxcbiAgICBhdXRoZW50aWNhdGlvbjogU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyVGFncyAodXNlcm5hbWU6IHN0cmluZyk6IFByb21pc2U8SUdldFVzZXJUYWdzUmVzcG9uc2U+IHtcbiAgcmV0dXJuIGF3YWl0IGdldFVzZXJzVGFncyh7XG4gICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgIGF1dGhlbnRpY2F0aW9uOiBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEdyb3VwcyAoXG4gIHJlcXVlc3RPcHRpb25zOiBJU2VhcmNoT3B0aW9ucyB8IFNlYXJjaFF1ZXJ5QnVpbGRlclxuKTogUHJvbWlzZTxJU2VhcmNoUmVzdWx0PElHcm91cD4+IHtcbiAgcmV0dXJuIGF3YWl0IHNlYXJjaEdyb3VwKHJlcXVlc3RPcHRpb25zKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RGVmYXVsdFRlbXBsYXRlQ29uZmlnIChcbiAgYXBwSW5mbzogQXBwQ3JlYXRpb25JbmZvXG4pOiBQcm9taXNlPEFwcENvbmZpZz4ge1xuICByZXR1cm4gZ2V0VGVtcGxhdGVDb25maWcoVGVtcGxhdGVUeXBlLkFwcCwgYXBwSW5mby50ZW1wbGF0ZSlcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSAqL1xuaW1wb3J0IHtcbiAgdHlwZSBBcHBDcmVhdGlvbkluZm8sXG4gIGdldEFwcFN0b3JlLFxuICBtb2R1bGVMb2FkZXIsXG4gIHR5cGUgQXBwQ29uZmlnLFxuICBhcHBDb25maWdVdGlscyxcbiAgU2Vzc2lvbk1hbmFnZXIsXG4gIGkxOG4sXG4gIHZlcnNpb24sXG4gIHV0aWxzLFxuICBwb3J0YWxVcmxVdGlscyxcbiAgc2VtdmVyLFxuICB1cmxVdGlscyxcbiAgZXNyaSxcbiAgdHlwZSBJTUFwcENvbmZpZyxcbiAgSW1tdXRhYmxlLFxuICBzaGFyZWRUaGVtZVV0aWxzXG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgSUl0ZW1BZGQgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcydcbmltcG9ydCB7IHR5cGUgSUNyZWF0ZUl0ZW1SZXNwb25zZSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXBvcnRhbCdcbmltcG9ydCB7XG4gIHVwZGF0ZUl0ZW0sXG4gIGNyZWF0ZUl0ZW0sXG4gIGdldEl0ZW1SZXNvdXJjZXMsXG4gIGFkZEl0ZW1SZXNvdXJjZSxcbiAgY3JlYXRlQXBwSW5Gb2xkZXJcbn0gZnJvbSAnLi4vcmVzdC1zZXJ2aWNlJ1xuaW1wb3J0IGRlZmF1bHRNZXNzYWdlcyBmcm9tICcuLi8uLi90cmFuc2xhdGlvbnMvZGVmYXVsdCdcbmltcG9ydCB7IHR5cGUgQXBwSW5mbywgU2VhcmNoVHlwZSwgQXBwVHlwZSwgUHVibGlzaFN0YXR1cyB9IGZyb20gJy4uL3R5cGUnXG5pbXBvcnQgeyBzZWFyY2hBcHAsIGdldEFwcENvbmZpZywgdXBkYXRlQXBwVGh1bWJuYWlsLCBnZXRBcHBJbmZvLCBkZWxldGVBcHAgfSBmcm9tICcuL2luZGV4J1xuaW1wb3J0IHsgdHlwZSBVc2VyU2Vzc2lvbiB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LWF1dGgnXG5pbXBvcnQgKiBhcyBsb2NhbFJlc3RTZXJ2aWNlIGZyb20gJy4uL2xvY2FsLXJlc3Qtc2VydmljZSdcblxuY29uc3QgcmVxdWVzdCA9IGVzcmkucmVzdFJlcXVlc3QucmVxdWVzdFxuXG5leHBvcnQgZnVuY3Rpb24gaXNQb3J0YWxBcHAgKGFwcEluZm86IEFwcEluZm8pIHtcbiAgaWYgKCFhcHBJbmZvPy5wb3J0YWxVcmwpIHtcbiAgICByZXR1cm4gIXdpbmRvdy5qaW11Q29uZmlnLmlzRGV2RWRpdGlvblxuICB9XG4gIGNvbnN0IGFwcFBvcnRhbFVybCA9IGFwcEluZm8/LnBvcnRhbFVybCB8fCAnJ1xuICBjb25zdCBwb3J0YWxVcmwgPSBnZXRBcHBTdG9yZSgpPy5nZXRTdGF0ZSgpPy5wb3J0YWxVcmwgfHwgJydcbiAgY29uc3QgaXNTYW1lUG9ydGFsID0gcG9ydGFsVXJsPy5pbmNsdWRlcyhhcHBQb3J0YWxVcmwpIHx8IGFwcFBvcnRhbFVybD8uaW5jbHVkZXMocG9ydGFsVXJsKVxuICBpZiAocG9ydGFsVXJsVXRpbHMuaXNBR09MRG9tYWluKGFwcFBvcnRhbFVybCkgJiYgcG9ydGFsVXJsVXRpbHMuaXNBR09MRG9tYWluKHBvcnRhbFVybCkpIHtcbiAgICByZXR1cm4gIWlzTG9jYWxBcHAoYXBwSW5mbylcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gaXNTYW1lUG9ydGFsICYmICFpc0xvY2FsQXBwKGFwcEluZm8pXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQUdPTEFwcCAoYXBwSW5mbzogQXBwSW5mbykge1xuICBpZiAoIWFwcEluZm8/LnBvcnRhbFVybCkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIGNvbnN0IGFwcFBvcnRhbFVybCA9IGFwcEluZm8/LnBvcnRhbFVybCB8fCAnJ1xuICBjb25zdCBpc1BvcnRhbEFHT0wgPSBwb3J0YWxVcmxVdGlscy5pc0FHT0xEb21haW4oYXBwUG9ydGFsVXJsKVxuICBjb25zdCBpc05vdFBvcnRhbEFwcCA9ICFpc1BvcnRhbEFwcChhcHBJbmZvKVxuICBjb25zdCBpc05vdExvY2FsQXBwID0gIWlzTG9jYWxBcHAoYXBwSW5mbylcbiAgcmV0dXJuIGlzTm90UG9ydGFsQXBwICYmIGlzTm90TG9jYWxBcHAgJiYgaXNQb3J0YWxBR09MXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0xvY2FsQXBwIChhcHBJbmZvOiBBcHBJbmZvKSB7XG4gIGNvbnN0IGFwcFBvcnRhbFVybCA9IGFwcEluZm8/LnBvcnRhbFVybCB8fCAnJ1xuICBpZiAoYXBwUG9ydGFsVXJsLmVuZHNXaXRoKCdsb2NhbGhvc3Q6JykpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBhcHBJbmZvLmlzTG9jYWxBcHBcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlc3Npb24gKGFwcEluZm86IEFwcEluZm8pOiBVc2VyU2Vzc2lvbiB7XG4gIGlmIChpc0xvY2FsQXBwKGFwcEluZm8pKSB7XG4gICAgcmV0dXJuIHt9IGFzIFVzZXJTZXNzaW9uXG4gIH1cbiAgY29uc3QgcG9ydGFsU2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICBjb25zdCBzZXNzaW9uID0gaXNQb3J0YWxBcHAoYXBwSW5mbykgPyBwb3J0YWxTZXNzaW9uIDogKHt9IGFzIFVzZXJTZXNzaW9uKVxuICByZXR1cm4gc2Vzc2lvblxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2Vzc2lvbkJ5U2VhcmNoVHlwZSAoc2VhcmNoVHlwZTogU2VhcmNoVHlwZSk6IFVzZXJTZXNzaW9uIHtcbiAgbGV0IHNlc3Npb246IFVzZXJTZXNzaW9uXG4gIGNvbnN0IHBvcnRhbFVybCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmxcbiAgY29uc3QgcG9ydGFsU2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICBjb25zdCBpc0FHT0xEb21haW4gPSBwb3J0YWxVcmxVdGlscy5pc0FHT0xEb21haW4ocG9ydGFsVXJsKVxuICBzd2l0Y2ggKHNlYXJjaFR5cGUpIHtcbiAgICBjYXNlIFNlYXJjaFR5cGUuUG9ydGFsOlxuICAgICAgc2Vzc2lvbiA9IHBvcnRhbFNlc3Npb25cbiAgICAgIGJyZWFrXG4gICAgY2FzZSBTZWFyY2hUeXBlLkFHT0w6XG4gICAgICBzZXNzaW9uID0gaXNBR09MRG9tYWluID8gcG9ydGFsU2Vzc2lvbiA6IHt9IGFzIFVzZXJTZXNzaW9uXG4gICAgICBicmVha1xuICAgIGNhc2UgU2VhcmNoVHlwZS5PdGhlcjpcbiAgICAgIHNlc3Npb24gPSB3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24gPyB7fSBhcyBVc2VyU2Vzc2lvbiA6IHBvcnRhbFNlc3Npb25cbiAgICAgIGJyZWFrXG4gIH1cbiAgcmV0dXJuIHNlc3Npb25cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE5ld0FwcFRpdGxlV2l0aEluZGV4IChcbiAgdGl0bGU6IHN0cmluZyxcbiAgaXNDb3B5OiBib29sZWFuID0gZmFsc2UsXG4gIHR5cGU6IHN0cmluZyA9ICcnXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBzZXNzaW9uID0gU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gIGxldCBuZXdUaXRsZSA9IG51bGxcbiAgY29uc3QgYXBwVHlwZTogc3RyaW5nID1cbiAgICAhdHlwZT8uaW5jbHVkZXMoJ1RlbXBsYXRlJylcbiAgICAgID8gQXBwVHlwZS5FeHBlcmllbmNlVHlwZVxuICAgICAgOiBBcHBUeXBlLlRlbXBsYXRlVHlwZVxuICByZXR1cm4gYXdhaXQgc2VhcmNoQXBwKHtcbiAgICBxOiBgdHlwZTogXCIke2FwcFR5cGV9XCIgQU5EIG93bmVyOiR7c2Vzc2lvbj8udXNlcm5hbWV9IEFORCAgdGl0bGU6XCIke3RpdGxlfVwiYCxcbiAgICBzb3J0RmllbGQ6ICdtb2RpZmllZCcsXG4gICAgc29ydE9yZGVyOiAnZGVzYydcbiAgfSwgU2VhcmNoVHlwZS5PdGhlcilcbiAgICAudGhlbihhc3luYyByZXN1bHQgPT4ge1xuICAgICAgY29uc3QgYXBwcyA9IHJlc3VsdC5yZXN1bHRzXG4gICAgICBpZiAoYXBwcyAmJiBhcHBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSBnZXRNYXhJbmRleChhcHBzLCB0aXRsZSlcbiAgICAgICAgbmV3VGl0bGUgPSBnZXRBcHBOYW1lKHRpdGxlLCBhcHBzLCBpbmRleCwgaXNDb3B5KVxuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG5ld1RpdGxlKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3VGl0bGUgPSBpc0NvcHkgPyB0aXRsZSA6IGAke3RpdGxlfSAxYFxuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG5ld1RpdGxlKVxuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKGFzeW5jIGVyciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycilcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnIpXG4gICAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGR1cGxpY2F0ZVJlbGF0ZWREYXRhSW5BcHAgKFxuICBuZXdBcHBJZCxcbiAgb3JpZ2luYWxBcHBJbmZvOiBBcHBJbmZvLFxuICBpc0NyZWF0ZU5ldyA9IGZhbHNlXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGF3YWl0IHVwZGF0ZUl0ZW1EYXRhSW5BcHAobmV3QXBwSWQpLnRoZW4oXG4gICAgYXN5bmMgcmVzdWx0ID0+IHtcbiAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChudWxsKVxuICAgICAgfVxuICAgICAgaWYgKGlzQ3JlYXRlTmV3KSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBkdXBsaWNhdGVSZXNvdXJjZXNGb3JDcmVhdGVOZXcoXG4gICAgICAgICAgbmV3QXBwSWQsXG4gICAgICAgICAgb3JpZ2luYWxBcHBJbmZvXG4gICAgICAgIClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBkdXBsaWNhdGVSZXNvdXJjZXNGb3JEdXBsaWNhdGUoXG4gICAgICAgICAgbmV3QXBwSWQsXG4gICAgICAgICAgb3JpZ2luYWxBcHBJbmZvXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIGVyciA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoZXJyKVxuICAgIH1cbiAgKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlVHlwZUtleXdvcmRzICh0eXBlS2V5d29yZHM6IHN0cmluZ1tdLCBhcHBDb25maWdWZXJzaW9uOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gIGxldCBpc0hhdmVQdWJsaXNoU3RhdHVzID0gZmFsc2VcbiAgbGV0IGhhdmVVcGRhdGVQdWJsaXNoVmVyc2lvbiA9IGZhbHNlXG4gIGNvbnN0IG5ld1R5cGVLZXl3b3JkcyA9IHR5cGVLZXl3b3Jkcy5tYXAoZWwgPT4ge1xuICAgIGlmIChlbC5pbmNsdWRlcygnc3RhdHVzOicpKSB7XG4gICAgICBpc0hhdmVQdWJsaXNoU3RhdHVzID0gdHJ1ZVxuICAgICAgcmV0dXJuIGBzdGF0dXM6ICR7UHVibGlzaFN0YXR1cy5QdWJsaXNoZWR9YFxuICAgIH1cbiAgICBpZiAoZWwuaW5jbHVkZXMoJ3B1Ymxpc2hWZXJzaW9uOicpICYmIGFwcENvbmZpZ1ZlcnNpb24pIHtcbiAgICAgIGhhdmVVcGRhdGVQdWJsaXNoVmVyc2lvbiA9IHRydWVcbiAgICAgIHJldHVybiBgcHVibGlzaFZlcnNpb246JHthcHBDb25maWdWZXJzaW9ufWBcbiAgICB9XG4gICAgcmV0dXJuIGVsXG4gIH0pXG5cbiAgaWYgKCFpc0hhdmVQdWJsaXNoU3RhdHVzKSB7XG4gICAgY29uc3Qga2V5d29ybGRzID0gYHN0YXR1czogJHtQdWJsaXNoU3RhdHVzLlB1Ymxpc2hlZH1gXG4gICAgbmV3VHlwZUtleXdvcmRzLnB1c2goa2V5d29ybGRzKVxuICB9XG4gIGlmICghaGF2ZVVwZGF0ZVB1Ymxpc2hWZXJzaW9uICYmIGFwcENvbmZpZ1ZlcnNpb24pIHtcbiAgICBuZXdUeXBlS2V5d29yZHMucHVzaChgcHVibGlzaFZlcnNpb246JHthcHBDb25maWdWZXJzaW9ufWApXG4gIH1cbiAgcmV0dXJuIG5ld1R5cGVLZXl3b3Jkc1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdG9DcmVhdGVBcHBCeURlZmF1bHRUZW1wbGF0ZSAoXG4gIGFwcEluZm86IEFwcENyZWF0aW9uSW5mbyxcbiAgZm9sZGVySWQ/OiBzdHJpbmdcbik6IFByb21pc2U8SUNyZWF0ZUl0ZW1SZXNwb25zZT4ge1xuICBjb25zdCBpdGVtSW5mbyA9IHtcbiAgICB0aXRsZTogYXBwSW5mbz8ubmFtZSxcbiAgICB0eXBlOiBhcHBJbmZvPy50eXBlIHx8ICdXZWIgRXhwZXJpZW5jZScsXG4gICAgdHlwZUtleXdvcmRzOiBbXG4gICAgICAnRVhCIEV4cGVyaWVuY2UnLFxuICAgICAgJ1JlYWR5IFRvIFVzZScsXG4gICAgICAnSmF2YVNjcmlwdCcsXG4gICAgICAnc3RhdHVzOiBEcmFmdCcsXG4gICAgICBgdmVyc2lvbjoke3ZlcnNpb259YFxuICAgIF0sXG4gICAgc25pcHBldDogYXBwSW5mbz8uc25pcHBldCB8fCAnJyxcbiAgICBkZXNjcmlwdGlvbjogYXBwSW5mbz8uZGVzY3JpcHRpb24gfHwgJycsXG4gICAgdGFnczogYXBwSW5mbz8udGFncyB8fCBbXSxcbiAgICBkYXRhOiB7IF9fbm90X3B1Ymxpc2g6IHRydWUgfVxuICAgIC8vIHRodW1ibmFpbFVybDphcHBJbmZvLnRodW1ibmFpbFVybFxuICB9XG4gIGNvbnN0IGNoZWNrRXhpc3QgPSBhc3luYyAoKSA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShmYWxzZSlcbiAgfVxuICByZXR1cm4gYXdhaXQgY2hlY2tFeGlzdCgpLnRoZW4oYXN5bmMgZnVuY3Rpb24gKGV4aXN0KSB7XG4gICAgaWYgKGV4aXN0KSB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoJ2FwcCBleGlzdGVkLicpXG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBjcmVhdGVBcHAoaXRlbUluZm8sIGZvbGRlcklkKVxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSXRlbURhdGFJbkFwcCAobmV3QXBwSWQpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICByZXR1cm4gYXdhaXQgdXBkYXRlSXRlbSh7XG4gICAgaXRlbToge1xuICAgICAgaWQ6IG5ld0FwcElkLFxuICAgICAgb3duZXI6IHNlc3Npb24/LnVzZXJuYW1lLFxuICAgICAgdGV4dDogJycsXG4gICAgICBkYXRhOiB7IF9fbm90X3B1Ymxpc2g6IHRydWUgfVxuICAgICAgLy8gZGF0YTogbmV3RGF0YVxuICAgIH0sXG4gICAgYXV0aGVudGljYXRpb246IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICB9KS50aGVuKFxuICAgIGFzeW5jICgpID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgICB9LFxuICAgIGFzeW5jIGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoZXJyb3IpXG4gICAgfVxuICApXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkdXBsaWNhdGVSZXNvdXJjZXNJbkFwcCAoXG4gIG5ld0FwcElkLFxuICBvcmlnaW5hbEFwcEluZm86IEFwcEluZm8sXG4gIGlzQ3JlYXRlTmV3ID0gZmFsc2UsXG4gIHVwZGF0ZUFwcENvbmZpZ1ZlcnNpb24gPSBmYWxzZVxuKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGdldFNlc3Npb24ob3JpZ2luYWxBcHBJbmZvKVxuICByZXR1cm4gYXdhaXQgZ2V0SXRlbVJlc291cmNlcyhcbiAgICBvcmlnaW5hbEFwcEluZm8sXG4gICAge1xuICAgICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgICB9XG4gICkudGhlbihcbiAgICBhc3luYyByZXNvdXJjZVJlc3VsdHMgPT4ge1xuICAgICAgY29uc3QgcmVzb3VyY2VQcm9taXNlcyA9IFtdXG4gICAgICBjb25zdCBwb3J0YWxSZXNvdXJjZXMgPSByZXNvdXJjZVJlc3VsdHMgJiYgcmVzb3VyY2VSZXN1bHRzLnJlc291cmNlc1xuICAgICAgbGV0IGlzQXBwSGFzQ29uZmlnID0gZmFsc2VcbiAgICAgIGlmIChwb3J0YWxSZXNvdXJjZXMpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3J0YWxSZXNvdXJjZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBpc0NvbmZpZyA9IHBvcnRhbFJlc291cmNlc1tpXS5yZXNvdXJjZSA9PT0gJ2NvbmZpZy9jb25maWcuanNvbidcbiAgICAgICAgICAvLyBVc2UgcHVibGlzaGVkIHZlcnNpb24gb2YgYSB0ZW1wbGF0ZSB3aGVuIGNyZWF0ZSBhbiBhcHAgZnJvbSBhIHRlbXBsYXRlXG4gICAgICAgICAgaWYgKGlzQ3JlYXRlTmV3ICYmIGlzQ29uZmlnKSB7XG4gICAgICAgICAgICBjb250aW51ZVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBJZiBhbiBhcHAgaGFzIG5vIGNvbmZpZywgaXQgY2Fubm90IGJlIGR1cGxpY2F0ZVxuICAgICAgICAgIGlmIChpc0NvbmZpZykge1xuICAgICAgICAgICAgaXNBcHBIYXNDb25maWcgPSB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICAgIHJlc291cmNlUHJvbWlzZXMucHVzaCh1cGxvYWRSZXNvdXJjZShuZXdBcHBJZCwgb3JpZ2luYWxBcHBJbmZvLCBwb3J0YWxSZXNvdXJjZXNbaV0sIHVwZGF0ZUFwcENvbmZpZ1ZlcnNpb24pKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChpc0FwcEhhc0NvbmZpZyB8fCBpc0NyZWF0ZU5ldykge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwocmVzb3VyY2VQcm9taXNlcylcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUobnVsbClcbiAgICAgIH1cbiAgICB9LFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIGFzeW5jIGVyciA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG51bGwpXG4gICAgfVxuICApXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkdXBsaWNhdGVSZXNvdXJjZXNGb3JDcmVhdGVOZXcgKFxuICBuZXdBcHBJZCxcbiAgb3JpZ2luYWxBcHBJbmZvOiBBcHBJbmZvXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGF3YWl0IGR1cGxpY2F0ZVB1Ymxpc2hlZEFwcHNDb25maWcoXG4gICAgbmV3QXBwSWQsXG4gICAgb3JpZ2luYWxBcHBJbmZvXG4gICkudGhlbihhc3luYyByZXMgPT4ge1xuICAgIHJldHVybiBhd2FpdCBkdXBsaWNhdGVSZXNvdXJjZXNJbkFwcChcbiAgICAgIG5ld0FwcElkLFxuICAgICAgb3JpZ2luYWxBcHBJbmZvLFxuICAgICAgdHJ1ZVxuICAgICkudGhlbihcbiAgICAgIGFzeW5jIHJlc291cmNlUmVzdWx0ID0+IHtcbiAgICAgICAgaWYgKHJlc291cmNlUmVzdWx0KSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZSh0cnVlKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgnUmVzb3VyY2UgZG9lcyBub3QgZXhpc3Qgb3IgaXMgaW5hY2Nlc3NpYmxlJylcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGVyciA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnIpXG4gICAgICB9XG4gICAgKVxuICB9KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZHVwbGljYXRlUmVzb3VyY2VzRm9yRHVwbGljYXRlIChcbiAgbmV3QXBwSWQsXG4gIG9yaWdpbmFsQXBwSW5mbzogQXBwSW5mbyxcbiAgdXBkYXRlQXBwQ29uZmlnVmVyc2lvbiA9IGZhbHNlXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGF3YWl0IGR1cGxpY2F0ZVJlc291cmNlc0luQXBwKG5ld0FwcElkLCBvcmlnaW5hbEFwcEluZm8sIGZhbHNlLCB1cGRhdGVBcHBDb25maWdWZXJzaW9uKS50aGVuKFxuICAgIGFzeW5jIHJlc291cmNlUmVzdWx0ID0+IHtcbiAgICAgIGlmIChyZXNvdXJjZVJlc3VsdCkge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHRydWUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoJ1Jlc291cmNlIGRvZXMgbm90IGV4aXN0IG9yIGlzIGluYWNjZXNzaWJsZScpXG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyBlcnIgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycilcbiAgICB9XG4gIClcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGR1cGxpY2F0ZVB1Ymxpc2hlZEFwcHNDb25maWcgKFxuICBuZXdBcHBJZCxcbiAgb3JpZ2luYWxBcHBJbmZvOiBBcHBJbmZvXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGF3YWl0IGdldEFwcENvbmZpZyhcbiAgICBvcmlnaW5hbEFwcEluZm9cbiAgKS50aGVuKFxuICAgIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgbmV3Q29uZmlnRGF0YSA9IGluaXRBcHBDb25maWdQb3J0YWxVcmwoZGF0YSwgb3JpZ2luYWxBcHBJbmZvKVxuICAgICAgbmV3Q29uZmlnRGF0YS50ZW1wbGF0ZSA9IG9yaWdpbmFsQXBwSW5mbz8uaWRcbiAgICAgIC8qKlxuICAgICAgICogUHJveHkgaXMgY29ubmVjdGVkIHRvIGl0ZW0gaWQsIHByb3h5IGNyZWF0ZWQgaW4gaXRlbSBBIGNhbm5vdCBiZSB1c2VkIGluIGl0ZW0gQi5cbiAgICAgICAqIFNvIGRlbGV0ZSBhcHAgcHJveGllcyB3aGVuIGR1cGxpY2F0ZSBpdGVtcy5cbiAgICAgICAqL1xuICAgICAgZGVsZXRlIG5ld0NvbmZpZ0RhdGEuYXBwUHJveGllc1xuXG4gICAgICBkZWxldGUgbmV3Q29uZmlnRGF0YS5oaXN0b3J5TGFiZWxzXG5cbiAgICAgIGNvbnN0IHBvcnRhbFVybCA9IHdpbmRvdy5qaW11Q29uZmlnLmlzRGV2RWRpdGlvbiA/ICdsb2NhbGhvc3Q6JyA6IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmxcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTZXNzaW9uKHsgcG9ydGFsVXJsOiBwb3J0YWxVcmwgfSBhcyBBcHBJbmZvKVxuICAgICAgaWYgKGRhdGE/Ll9fbm90X3B1Ymxpc2gpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KCdUaGlzIGl0ZW0gaXMgbm90IHB1Ymxpc2hlZCcpXG4gICAgICB9XG4gICAgICBjb25zdCBmaWxlID0gbmV3IEJsb2IoW0pTT04uc3RyaW5naWZ5KG5ld0NvbmZpZ0RhdGEpXSwge1xuICAgICAgICB0eXBlOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgIH0pXG4gICAgICByZXR1cm4gYXdhaXQgYWRkSXRlbVJlc291cmNlKHtcbiAgICAgICAgaWQ6IG5ld0FwcElkLFxuICAgICAgICByZXNvdXJjZTogZmlsZSxcbiAgICAgICAgbmFtZTogJ2NvbmZpZy5qc29uJyxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgcmVzb3VyY2VzUHJlZml4OiAnY29uZmlnJ1xuICAgICAgICB9LFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgICAgfSkudGhlbihcbiAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgICAgICB9XG4gICAgICApXG4gICAgfSxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICBhc3luYyBlcnIgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KCdSZXNvdXJjZSBkb2VzIG5vdCBleGlzdCBvciBpcyBpbmFjY2Vzc2libGUnKVxuICAgIH1cbiAgKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGh1bWJuYWlsIChcbiAgbmV3QXBwSWQsXG4gIG9yaWdpbmFsQXBwSW5mbzogQXBwSW5mbyxcbiAgdGh1bWJuYWlsXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgcG9ydGFsVXJsID0gd2luZG93LmppbXVDb25maWcuaXNEZXZFZGl0aW9uID8gJ2xvY2FsaG9zdDonIDogZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBjb25zdCBzZXNzaW9uID0gZ2V0U2Vzc2lvbih7IHBvcnRhbFVybDogcG9ydGFsVXJsIH0gYXMgQXBwSW5mbylcbiAgY29uc3Qgb3JpZ2luYWxBcHBTZXNzaW9uID0gZ2V0U2Vzc2lvbihvcmlnaW5hbEFwcEluZm8pXG4gIGlmICh0aHVtYm5haWwpIHtcbiAgICBjb25zdCBwb3J0YWxUaHVtYm5haWxVcmwgPSBgJHtnZXRSZXNvdXJjZU9yaWdpbihvcmlnaW5hbEFwcEluZm8pfSR7b3JpZ2luYWxBcHBJbmZvLmlkfS9pbmZvLyR7dGh1bWJuYWlsfT90b2tlbj0ke29yaWdpbmFsQXBwU2Vzc2lvbj8udG9rZW59YFxuICAgIGNvbnN0IGRldlRodW1ibmFpbFVybCA9IGAke2dldFJlc291cmNlT3JpZ2luKG9yaWdpbmFsQXBwSW5mbyl9JHtvcmlnaW5hbEFwcEluZm8uaWR9LyR7dGh1bWJuYWlsfWBcbiAgICBsZXQgdGh1bWJuYWlsVXJsXG4gICAgaWYgKHRodW1ibmFpbD8uc3RhcnRzV2l0aCgnYmxvYjonKSkge1xuICAgICAgdGh1bWJuYWlsVXJsID0gdGh1bWJuYWlsXG4gICAgfSBlbHNlIGlmICh0aHVtYm5haWw/LmluY2x1ZGVzKCdodHRwJykpIHtcbiAgICAgIHRodW1ibmFpbFVybCA9IGAke3RodW1ibmFpbH0/dG9rZW49JHtvcmlnaW5hbEFwcFNlc3Npb24/LnRva2VufWBcbiAgICB9IGVsc2Uge1xuICAgICAgdGh1bWJuYWlsVXJsID0gaXNQb3J0YWxBcHAob3JpZ2luYWxBcHBJbmZvKSA/IHBvcnRhbFRodW1ibmFpbFVybCA6IGRldlRodW1ibmFpbFVybFxuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuICAgICAgeGhyLm9wZW4oJ0dFVCcsIHRodW1ibmFpbFVybCwgdHJ1ZSlcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYidcbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgIGNvbnN0IGJsb2IgPSB0aGlzLnJlc3BvbnNlXG4gICAgICAgICAgcmV0dXJuIHVwZGF0ZUFwcFRodW1ibmFpbCh7XG4gICAgICAgICAgICBpZDogbmV3QXBwSWQsXG4gICAgICAgICAgICB0aHVtYm5haWw6IGJsb2IsXG4gICAgICAgICAgICBmOiAnanNvbicsXG4gICAgICAgICAgICB0b2tlbjogc2Vzc2lvbj8udG9rZW5cbiAgICAgICAgICB9KS50aGVuKFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICByZXNvbHZlKHRydWUpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICByZWplY3QoZmFsc2UpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlamVjdChmYWxzZSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB4aHIub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHJlamVjdCgpXG4gICAgICB9XG4gICAgICB4aHIuc2VuZCgpXG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwbG9hZFJlc291cmNlIChcbiAgbmV3QXBwSWQsXG4gIG9yaWdpbmFsQXBwSW5mbzogQXBwSW5mbyxcbiAgcmVzb3VyY2VJbmZvLFxuICB1cGRhdGVBcHBDb25maWdWZXJzaW9uID0gZmFsc2Vcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBvcmlnaW5hbEFwcFNlc3Npb24gPSBnZXRTZXNzaW9uKG9yaWdpbmFsQXBwSW5mbylcbiAgY29uc3QgdG9rZW4gPSBpc1BvcnRhbEFwcChvcmlnaW5hbEFwcEluZm8pID8gYD90b2tlbj0ke29yaWdpbmFsQXBwU2Vzc2lvbj8udG9rZW59YCA6ICcnXG4gIGNvbnN0IHBvcnRhbFVybFByZWZpeCA9IGAke2dldFJlc291cmNlT3JpZ2luKG9yaWdpbmFsQXBwSW5mbyl9JHtvcmlnaW5hbEFwcEluZm8uaWR9L3Jlc291cmNlcy9gXG5cbiAgY29uc3QgcG9ydGFsVXJsID0gd2luZG93LmppbXVDb25maWcuaXNEZXZFZGl0aW9uID8gJ2xvY2FsaG9zdDonIDogZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBjb25zdCBzZXNzaW9uID0gZ2V0U2Vzc2lvbih7IHBvcnRhbFVybDogcG9ydGFsVXJsIH0gYXMgQXBwSW5mbylcbiAgaWYgKFxuICAgIHJlc291cmNlSW5mby5yZXNvdXJjZSA9PT0gJ2NvbmZpZy9jb25maWcuanNvbicgfHxcbiAgICByZXNvdXJjZUluZm8ucmVzb3VyY2UgPT09ICdpbWFnZXMvaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbidcbiAgKSB7XG4gICAgY29uc3QgcmVzb3VyY2VVcmwgPSBwb3J0YWxVcmxQcmVmaXggKyByZXNvdXJjZUluZm8ucmVzb3VyY2UgKyB0b2tlblxuICAgIHJldHVybiBhd2FpdCBmZXRjaChyZXNvdXJjZVVybCwgeyBjYWNoZTogJ25vLWNhY2hlJyB9KVxuICAgICAgLnRoZW4oYXN5bmMgcmVzID0+IGF3YWl0IHJlcy5qc29uKCkpXG4gICAgICAudGhlbihhc3luYyBkYXRhID0+IHtcbiAgICAgICAgLy8gSWYgYW4gYXBwJ3MgY29uZmlnLmpzb24gb3IgaW1hZ2UtcmVzb3VyY2VzLWxpc3QuanNvbiBpcyBub3Qgb2J0YWluZWQgc3VjY2Vzc2Z1bGx5LCBpdCBjYW5ub3QgYmUgZHVwbGljYXRlXG4gICAgICAgIGNvbnN0IGlzQ29uZmlnID0gcmVzb3VyY2VJbmZvLnJlc291cmNlID09PSAnY29uZmlnL2NvbmZpZy5qc29uJ1xuICAgICAgICBjb25zdCBuZXdBcHBEYXRhID0gaXNDb25maWcgPyBpbml0QXBwQ29uZmlnUG9ydGFsVXJsKGRhdGEsIG9yaWdpbmFsQXBwSW5mbykgOiBkYXRhXG4gICAgICAgIHJldHVybiBhd2FpdCByZXBsYWNlQ29uZmlnV2l0aE5ld0FwcElEKFxuICAgICAgICAgIG5ld0FwcElkLFxuICAgICAgICAgIG9yaWdpbmFsQXBwSW5mby5pZCxcbiAgICAgICAgICBuZXdBcHBEYXRhXG4gICAgICAgICkudGhlbihhc3luYyBuZXdEYXRhID0+IHtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBQcm94eSBpcyBjb25uZWN0ZWQgdG8gaXRlbSBpZCwgcHJveHkgY3JlYXRlZCBpbiBpdGVtIEEgY2Fubm90IGJlIHVzZWQgaW4gaXRlbSBCLlxuICAgICAgICAgICAqIFNvIGRlbGV0ZSBhcHAgcHJveGllcyB3aGVuIGR1cGxpY2F0ZSBpdGVtcy5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBkZWxldGUgbmV3RGF0YS5hcHBQcm94aWVzXG5cbiAgICAgICAgICBkZWxldGUgbmV3RGF0YS5oaXN0b3J5TGFiZWxzXG5cbiAgICAgICAgICBpZiAoaXNDb25maWcpIHtcbiAgICAgICAgICAgIGlmICh1cGRhdGVBcHBDb25maWdWZXJzaW9uKSB7XG4gICAgICAgICAgICAgIC8vVXBkYXRlIGFwcCB2ZXJzaW9uIGFuZCB3aWRnZXQgdmVyc2lvbiB0byBjdXJyZW50IEV4YlZlcnNpb25cbiAgICAgICAgICAgICAgbmV3RGF0YSA9IHJlcGxhY2VFeGJWZXJzaW9uSW5BcHBDb25maWcoSW1tdXRhYmxlKG5ld0RhdGEpKT8uYXNNdXRhYmxlKHsgZGVlcDogdHJ1ZSB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKClcbiAgICAgICAgICAgIGNvbnN0IHV0Y1RpbWVTdGFtcCA9IGRhdGUuZ2V0VGltZSgpXG4gICAgICAgICAgICBuZXdEYXRhLnRpbWVzdGFtcCA9IGAke3V0Y1RpbWVTdGFtcH1gXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZmlsZSA9IG5ldyBCbG9iKFtKU09OLnN0cmluZ2lmeShuZXdEYXRhKV0sIHtcbiAgICAgICAgICAgIHR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgIH0pXG5cbiAgICAgICAgICByZXR1cm4gYXdhaXQgYWRkSXRlbVJlc291cmNlKHtcbiAgICAgICAgICAgIGlkOiBuZXdBcHBJZCxcbiAgICAgICAgICAgIHJlc291cmNlOiBmaWxlLFxuICAgICAgICAgICAgbmFtZTogcmVzb3VyY2VJbmZvLnJlc291cmNlLnNwbGl0KCcvJylbXG4gICAgICAgICAgICAgIHJlc291cmNlSW5mby5yZXNvdXJjZS5zcGxpdCgnLycpLmxlbmd0aCAtIDFcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgcmVzb3VyY2VzUHJlZml4OiByZXNvdXJjZUluZm8ucmVzb3VyY2VcbiAgICAgICAgICAgICAgICAuc3BsaXQoJy8nKVxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCByZXNvdXJjZUluZm8ucmVzb3VyY2Uuc3BsaXQoJy8nKS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgICAgIC5qb2luKCcvJylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgICAgICAgIH0pLnRoZW4oXG4gICAgICAgICAgICBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYyBlcnJvciA9PiB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnJvcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgLmNhdGNoKGFzeW5jIGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcilcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KGVycm9yKVxuICAgICAgfSlcbiAgfSBlbHNlIHtcbiAgICBjb25zdCByZXNvdXJjZVVybCA9IHBvcnRhbFVybFByZWZpeCArIHJlc291cmNlSW5mby5yZXNvdXJjZSArIHRva2VuXG5cbiAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KClcbiAgICAgIHhoci5vcGVuKCdHRVQnLCByZXNvdXJjZVVybCwgdHJ1ZSlcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYidcbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgIGNvbnN0IGJsb2IgPSB0aGlzLnJlc3BvbnNlXG5cbiAgICAgICAgICByZXR1cm4gYWRkSXRlbVJlc291cmNlKHtcbiAgICAgICAgICAgIGlkOiBuZXdBcHBJZCxcbiAgICAgICAgICAgIHJlc291cmNlOiBibG9iLFxuICAgICAgICAgICAgbmFtZTogcmVzb3VyY2VJbmZvLnJlc291cmNlLnNwbGl0KCcvJylbXG4gICAgICAgICAgICAgIHJlc291cmNlSW5mby5yZXNvdXJjZS5zcGxpdCgnLycpLmxlbmd0aCAtIDFcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgcmVzb3VyY2VzUHJlZml4OiByZXNvdXJjZUluZm8ucmVzb3VyY2VcbiAgICAgICAgICAgICAgICAuc3BsaXQoJy8nKVxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCByZXNvdXJjZUluZm8ucmVzb3VyY2Uuc3BsaXQoJy8nKS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgICAgIC5qb2luKCcvJylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgICAgICAgIH0pLnRoZW4oXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgIHJlc29sdmUoZmFsc2UpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUoZmFsc2UpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXNvbHZlKGZhbHNlKVxuICAgICAgfVxuICAgICAgeGhyLnNlbmQoKVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRBcHBDb25maWdQb3J0YWxVcmwgKGFwcENvbmZpZywgb3JpZ2luYWxBcHBJbmZvOiBBcHBJbmZvKSB7XG4gIGNvbnN0IHBvcnRhbFVybCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmxcbiAgYXBwQ29uZmlnLmF0dHJpYnV0ZXMgJiYgKGFwcENvbmZpZy5hdHRyaWJ1dGVzLnBvcnRhbFVybCA9IHBvcnRhbFVybClcbiAgY29uc3QgZGF0YVNvdXJjZXMgPSBhcHBDb25maWc/LmRhdGFTb3VyY2VzXG4gIGlmIChkYXRhU291cmNlcyAmJiBpc0FHT0xBcHAob3JpZ2luYWxBcHBJbmZvKSkge1xuICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGFTb3VyY2VzKSB7XG4gICAgICBjb25zdCBkYXRhU291cmNlc1BvcnRhbFVybCA9IGRhdGFTb3VyY2VzW2tleV0/LnBvcnRhbFVybFxuICAgICAgaWYgKGlzVXBkYXRlRGF0YVNvdXJjZXNQb3J0YWxVcmwoZGF0YVNvdXJjZXNQb3J0YWxVcmwpKSB7XG4gICAgICAgIGRhdGFTb3VyY2VzW2tleV0ucG9ydGFsVXJsID0gcG9ydGFsVXJsXG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBhcHBDb25maWdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVXBkYXRlRGF0YVNvdXJjZXNQb3J0YWxVcmwgKGRhdGFTb3VyY2VzUG9ydGFsVXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgbGV0IGlzQ2FuVXBkYXRlID0gZmFsc2VcbiAgY29uc3QgcG9ydGFsVXJsID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBpZiAoXG4gICAgaXNTYW1lUG9ydGFsKHBvcnRhbFVybCwgZGF0YVNvdXJjZXNQb3J0YWxVcmwsICdtYXBzZGV2ZXh0LmFyY2dpcy5jb20nKSB8fFxuICAgIGlzU2FtZVBvcnRhbChwb3J0YWxVcmwsIGRhdGFTb3VyY2VzUG9ydGFsVXJsLCAnbWFwc3FhLmFyY2dpcy5jb20nKSB8fFxuICAgIGlzU2FtZVBvcnRhbChwb3J0YWxVcmwsIGRhdGFTb3VyY2VzUG9ydGFsVXJsLCAnbWFwcy5hcmNnaXMuY29tJylcbiAgKSB7XG4gICAgaXNDYW5VcGRhdGUgPSB0cnVlXG4gIH1cbiAgcmV0dXJuIGlzQ2FuVXBkYXRlXG59XG5cbmZ1bmN0aW9uIGlzU2FtZVBvcnRhbCAoXG4gIHBvcnRhbFVybDogc3RyaW5nLFxuICBkYXRhU291cmNlc1BvcnRhbFVybDogc3RyaW5nLFxuICB1cmxFbmRTdHJpbmc6IHN0cmluZ1xuKTogYm9vbGVhbiB7XG4gIGNvbnN0IGlzU2FtZVBvcnRhbCA9XG4gICAgKHBvcnRhbFVybD8uZW5kc1dpdGgodXJsRW5kU3RyaW5nKSB8fFxuICAgICAgcG9ydGFsVXJsPy5lbmRzV2l0aChgJHt1cmxFbmRTdHJpbmd9L2ApKSAmJlxuICAgIChkYXRhU291cmNlc1BvcnRhbFVybD8uZW5kc1dpdGgodXJsRW5kU3RyaW5nKSB8fFxuICAgICAgZGF0YVNvdXJjZXNQb3J0YWxVcmw/LmVuZHNXaXRoKGAke3VybEVuZFN0cmluZ30vYCkpXG4gIHJldHVybiBpc1NhbWVQb3J0YWxcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyYXRlQXBwQnlBcHAgKFxuICBhcHBJbmZvOiBBcHBJbmZvLFxuICBpc0NyZWF0ZVRlbXBsYXRlPzogYm9vbGVhbixcbiAgZm9sZGVySWQ/OiBzdHJpbmdcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIHJldHVybiBhd2FpdCBnZXRBcHBJbmZvKGFwcEluZm8pLnRoZW4oXG4gICAgYXN5bmMgYXBwSXRlbSA9PiB7XG4gICAgICBpZiAoYXBwSXRlbSkge1xuICAgICAgICBjb25zdCB0eXBlID0gaXNDcmVhdGVUZW1wbGF0ZVxuICAgICAgICAgID8gQXBwVHlwZS5UZW1wbGF0ZVR5cGVcbiAgICAgICAgICA6IEFwcFR5cGUuRXhwZXJpZW5jZVR5cGVcbiAgICAgICAgcmV0dXJuIGF3YWl0IGdldE5ld0FwcFRpdGxlV2l0aEluZGV4KGFwcEl0ZW0udGl0bGUpLnRoZW4oYXN5bmMgbmV3VGl0bGUgPT4ge1xuICAgICAgICAgIGlmIChuZXdUaXRsZSkge1xuICAgICAgICAgICAgY29uc3QgZHVwbGljYXRlQXBwSW5mbyA9IHtcbiAgICAgICAgICAgICAgbmFtZTogbmV3VGl0bGUsXG4gICAgICAgICAgICAgIHRhZ3M6IGFwcEl0ZW0udGFncyxcbiAgICAgICAgICAgICAgdGh1bWJuYWlsOiBhcHBJdGVtLnRodW1ibmFpbCxcbiAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgdHlwZUtleXdvcmRzOiBhcHBJbmZvPy50eXBlS2V5d29yZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBcHBGb3JEdXBsaWNhdGUoZHVwbGljYXRlQXBwSW5mbyBhcyBhbnksIGZvbGRlcklkKS50aGVuKFxuICAgICAgICAgICAgICBhc3luYyBuZXdBcHBJdGVtID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobmV3QXBwSXRlbSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGR1cGxpY2F0ZVJlbGF0ZWREYXRhSW5BcHAoXG4gICAgICAgICAgICAgICAgICAgIG5ld0FwcEl0ZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgIGFwcEluZm8sXG4gICAgICAgICAgICAgICAgICAgICFpc0NyZWF0ZVRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICApLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG5ld0FwcEl0ZW0uaWQpXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZUFwcChuZXdBcHBJdGVtLmlkKVxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QobnVsbClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KG51bGwpXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KG51bGwpXG4gICAgICB9XG4gICAgfVxuICApXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0RHVwbGljYXRlZFR5cGVLZXl3b3JkcyAodHlwZUtleXdvcmRzPzogc3RyaW5nW10pIHtcbiAgY29uc3QgaXRlbVZlcnNpb24gPSBgdmVyc2lvbjoke3ZlcnNpb259YFxuICBpZiAoIXR5cGVLZXl3b3JkcyB8fCB0eXBlS2V5d29yZHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIFtcbiAgICAgICdFWEIgRXhwZXJpZW5jZScsXG4gICAgICAnUmVhZHkgVG8gVXNlJyxcbiAgICAgICdKYXZhU2NyaXB0JyxcbiAgICAgICdzdGF0dXM6IERyYWZ0JyxcbiAgICAgIGl0ZW1WZXJzaW9uXG4gICAgXVxuICB9XG4gIGxldCBpc0hhc1N0YXR1cyA9IGZhbHNlXG4gIGxldCBpc0hhc1ZlcnNpb24gPSBmYWxzZVxuICBjb25zdCBuZXdUeXBlS2V5d29yZHMgPSB0eXBlS2V5d29yZHMubWFwKGVsID0+IHtcbiAgICBpZiAoZWwuaW5jbHVkZXMoJ3ZlcnNpb246JykpIHtcbiAgICAgIGlzSGFzVmVyc2lvbiA9IHRydWVcbiAgICB9XG4gICAgaWYgKCFlbC5pbmNsdWRlcygnc3RhdHVzOicpKSB7XG4gICAgICByZXR1cm4gZWxcbiAgICB9IGVsc2Uge1xuICAgICAgaXNIYXNTdGF0dXMgPSB0cnVlXG4gICAgICByZXR1cm4gJ3N0YXR1czogRHJhZnQnXG4gICAgfVxuICB9KVxuICAhaXNIYXNTdGF0dXMgJiYgbmV3VHlwZUtleXdvcmRzLnB1c2goJ3N0YXR1czogRHJhZnQnKVxuICAhaXNIYXNWZXJzaW9uICYmIG5ld1R5cGVLZXl3b3Jkcy5wdXNoKGl0ZW1WZXJzaW9uKVxuICByZXR1cm4gbmV3VHlwZUtleXdvcmRzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXhJbmRleCAoYXBwTGlzdDogYW55W10sIG5hbWU6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IGluZGV4RGF0YSA9IFtdXG4gIGNvbnN0IHJlZyA9IC9eW1xcZF0rJC9cbiAgYXBwTGlzdC5mb3JFYWNoKGVsID0+IHtcbiAgICBjb25zdCBpbmRleCA9IGVsLnRpdGxlPy5zcGxpdChgJHtuYW1lfSBgKVsxXT8uc3BsaXQoJyAnKVswXVxuICAgIGlmIChyZWcudGVzdChpbmRleCkpIHtcbiAgICAgIGluZGV4RGF0YS5wdXNoKE51bWJlcihpbmRleCkpXG4gICAgfVxuICB9KVxuICBpbmRleERhdGEuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBhIDwgYiA/IDEgOiAtMVxuICB9KVxuICByZXR1cm4gaW5kZXhEYXRhWzBdIHx8IDFcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFwcE5hbWUgKFxuICBuYW1lOiBzdHJpbmcsXG4gIGFwcExpc3Q6IGFueVtdLFxuICBpbmRleDogbnVtYmVyID0gMSxcbiAgaXNDb3B5OiBib29sZWFuID0gZmFsc2Vcbik6IHN0cmluZyB7XG4gIGNvbnN0IGFwcE5hbWUgPSBpbmRleCA9PT0gMSAmJiBpc0NvcHkgPyBuYW1lIDogYCR7bmFtZX0gJHtpbmRleH1gXG4gIGlmICghaXNBcHBOYW1lUmVwZWF0KGFwcE5hbWUsIGFwcExpc3QpKSB7XG4gICAgcmV0dXJuIGFwcE5hbWVcbiAgfVxuICBjb25zdCBfaW5kZXggPSBpbmRleCArIDFcbiAgcmV0dXJuIGdldEFwcE5hbWUobmFtZSwgYXBwTGlzdCwgX2luZGV4KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNBcHBOYW1lUmVwZWF0IChuYW1lOiBzdHJpbmcsIGFwcExpc3Q6IGFueVtdKTogYm9vbGVhbiB7XG4gIGxldCBpc0hhc05hbWUgPSBmYWxzZVxuICBhcHBMaXN0LmZvckVhY2goZWwgPT4ge1xuICAgIGlmIChuYW1lID09PSBlbC50aXRsZSkge1xuICAgICAgaXNIYXNOYW1lID0gdHJ1ZVxuICAgIH1cbiAgfSlcbiAgcmV0dXJuIGlzSGFzTmFtZVxufVxuXG5hc3luYyBmdW5jdGlvbiByZXBsYWNlQ29uZmlnV2l0aE5ld0FwcElEIChcbiAgbmV3QXBwSWQsXG4gIG9yaWdpbmFsQXBwSWQsXG4gIGNvbmZpZ1xuKTogUHJvbWlzZTxBcHBDb25maWc+IHtcbiAgY29uc3QgcG9ydGFsVXJsUHJlZml4ID0gZ2V0UmVzb3VyY2VPcmlnaW4ob3JpZ2luYWxBcHBJZCkgKyBvcmlnaW5hbEFwcElkICsgJy9yZXNvdXJjZXMvJ1xuXG4gIGNvbnN0IGlzUG9ydGFsUmVzb3VyY2VFeHAgPSBuZXcgUmVnRXhwKCdeJyArIHBvcnRhbFVybFByZWZpeClcbiAgZnVuY3Rpb24gaXNQb3J0YWxSZXNvdXJjZXMgKHZhbHVlKSB7XG4gICAgcmV0dXJuIGlzUG9ydGFsUmVzb3VyY2VFeHAudGVzdCh2YWx1ZSlcbiAgfVxuXG4gIGZ1bmN0aW9uIG1hdGNoSGFuZGxlICh2YWx1ZSkge1xuICAgIGNvbnN0IG5ld1ZhbHVlID0gdmFsdWUucmVwbGFjZShcbiAgICAgICcvJyArIG9yaWdpbmFsQXBwSWQgKyAnLycsXG4gICAgICAnLycgKyBuZXdBcHBJZCArICcvJ1xuICAgIClcbiAgICByZXR1cm4gbmV3VmFsdWVcbiAgfVxuXG4gIGNvbnN0IHJlcGxhY2VPcGVyYXRvciA9IHtcbiAgICBtYXRjaGVyOiBpc1BvcnRhbFJlc291cmNlcyxcbiAgICBoYW5kbGVyOiBtYXRjaEhhbmRsZVxuICB9XG5cbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1dGlscy5yZXBsYWNlU3RyaW5nSW5PYmplY3QoY29uZmlnLCByZXBsYWNlT3BlcmF0b3IpKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXBwQ2FsbEJhY2sgKFxuICBkZWZhdWx0QXBwQ29uZmlnczogQXBwQ29uZmlnLFxuICBpdGVtOiBJQ3JlYXRlSXRlbVJlc3BvbnNlLFxuICB3ZWJtYXBJZD86IHN0cmluZyxcbiAgd2Vic2NlbmVJZD86IHN0cmluZ1xuKTogUHJvbWlzZTxBcHBJbmZvPiB7XG4gIGNvbnN0IEFwcFJlc291cmNlTWFuYWdlciA9IG1vZHVsZUxvYWRlci5nZXRNb2R1bGVTeW5jKCdqaW11LWZvci1idWlsZGVyJylcbiAgICAuQXBwUmVzb3VyY2VNYW5hZ2VyXG4gIGNvbnN0IGFwcFJlc291cmNlTWFuYWdlckluc3RhbmNlID0gQXBwUmVzb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKClcblxuICBjb25zdCBpdGVtSWQgPSBpdGVtLmlkXG4gIGxldCBkZWZhdWx0QXBwQ29uZmlnID0gdXRpbHMucmVwbGFjZUkxOG5QbGFjZWhvbGRlcnNJbk9iamVjdChcbiAgICBkZWZhdWx0QXBwQ29uZmlncyxcbiAgICBpMThuLmdldEludGwoKSxcbiAgICBkZWZhdWx0TWVzc2FnZXNcbiAgKVxuICBkZWZhdWx0QXBwQ29uZmlnID0gaW5pdEFwcENvbmZpZyhkZWZhdWx0QXBwQ29uZmlnKVxuICBhcHBDb25maWdVdGlscy5hZGRXZWJtYXBPcldlYnNjZW5lVG9BcHBDb25maWcoZGVmYXVsdEFwcENvbmZpZywgd2VibWFwSWQsIHdlYnNjZW5lSWQpXG5cbiAgcmV0dXJuIGFwcFJlc291cmNlTWFuYWdlckluc3RhbmNlXG4gICAgLnVwTG9hZEFwcENvbmZpZyhpdGVtSWQudG9TdHJpbmcoKSwgZGVmYXVsdEFwcENvbmZpZylcbiAgICAudGhlbihhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGl0ZW0pXG4gICAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFwcEZvckR1cGxpY2F0ZSAoXG4gIGFwcEluZm86IEFwcENyZWF0aW9uSW5mbyxcbiAgZm9sZGVySWQ/OiBzdHJpbmdcbik6IFByb21pc2U8SUNyZWF0ZUl0ZW1SZXNwb25zZT4ge1xuICBjb25zdCBpdGVtSW5mbyA9IHtcbiAgICB0aXRsZTogYXBwSW5mby5uYW1lLFxuICAgIHR5cGU6IGFwcEluZm8udHlwZSB8fCAnV2ViIEV4cGVyaWVuY2UnLFxuICAgIHR5cGVLZXl3b3JkczogaW5pdER1cGxpY2F0ZWRUeXBlS2V5d29yZHMoYXBwSW5mbz8udHlwZUtleXdvcmRzKSxcbiAgICBzbmlwcGV0OiBhcHBJbmZvPy5zbmlwcGV0IHx8ICcnLFxuICAgIGRlc2NyaXB0aW9uOiBhcHBJbmZvPy5kZXNjcmlwdGlvbiB8fCAnJyxcbiAgICB0YWdzOiBhcHBJbmZvLnRhZ3MsXG4gICAgdGh1bWJuYWlsOiAoYXBwSW5mbyBhcyBhbnkpLnRodW1ibmFpbFxuICAgIC8vIHRodW1ibmFpbFVybDphcHBJbmZvLnRodW1ibmFpbFVybFxuICB9XG4gIHJldHVybiBhd2FpdCBjcmVhdGVBcHAoaXRlbUluZm8sIGZvbGRlcklkKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJldmlld1VybCAoYXBwSW5mbzogQXBwSW5mbykge1xuICBjb25zdCB7IHR5cGUsIGlkIH0gPSBhcHBJbmZvXG4gIGNvbnN0IHsgaXNEZXZFZGl0aW9uLCBpc0luUG9ydGFsLCBob3N0RW52IH0gPSB3aW5kb3cuamltdUNvbmZpZ1xuICBjb25zdCBpc1RlbXBsYXRlID0gdHlwZSA9PT0gQXBwVHlwZS5UZW1wbGF0ZVR5cGVcbiAgY29uc3QgaXNBcmNHaXNPbmxpbmVBcHAgPSAhaXNEZXZFZGl0aW9uICYmICFpc0luUG9ydGFsXG4gIGlmIChpc0RldkVkaXRpb24pIHsgcmV0dXJuIG51bGwgfVxuICBsZXQgcHJldmlld1VybCA9IHVybFV0aWxzLmdldEFwcFVybCh7IGFwcElkOiBpZCwgaXNUZW1wbGF0ZTogaXNUZW1wbGF0ZSB9KVxuICBpZiAoaXNBcmNHaXNPbmxpbmVBcHApIHtcbiAgICBzd2l0Y2ggKGhvc3RFbnYpIHtcbiAgICAgIGNhc2UgJ3Byb2QnOlxuICAgICAgICBwcmV2aWV3VXJsID0gYGh0dHBzOi8vZXhwZXJpZW5jZS5hcmNnaXMuY29tJHtwcmV2aWV3VXJsfWBcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2Rldic6XG4gICAgICAgIHByZXZpZXdVcmwgPSBgaHR0cHM6Ly9leHBlcmllbmNlZGV2LmFyY2dpcy5jb20ke3ByZXZpZXdVcmx9YFxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAncWEnOlxuICAgICAgICBwcmV2aWV3VXJsID0gYGh0dHBzOi8vZXhwZXJpZW5jZXFhLmFyY2dpcy5jb20ke3ByZXZpZXdVcmx9YFxuICAgICAgICBicmVha1xuICAgIH1cbiAgfVxuICBpZiAoaXNJblBvcnRhbCkge1xuICAgIHByZXZpZXdVcmwgPSBgJHt3aW5kb3cubG9jYXRpb24ub3JpZ2lufSR7cHJldmlld1VybH1gXG4gIH1cbiAgcmV0dXJuIHByZXZpZXdVcmxcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFwcENvbmZpZ0luUmVzb3VyY2VzIChhcHBJZDogc3RyaW5nKTogUHJvbWlzZTxBcHBDb25maWc+IHtcbiAgY29uc3Qgc2Vzc2lvbk1hbmFnZXIgPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpXG4gIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG4gIGlmICh3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24pIHtcbiAgICByZXR1cm4gYXdhaXQgd2luZG93LmZldGNoKGAvYXBwcy8ke2FwcElkfS9yZXNvdXJjZXMvY29uZmlnL2NvbmZpZy5qc29uYCkudGhlbihhc3luYyByZXMgPT4gYXdhaXQgcmVzLmpzb24oKSlcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYXdhaXQgcmVxdWVzdChgJHtwb3J0YWxVcmxVdGlscy5nZXRQb3J0YWxSZXN0VXJsKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmwpfS9jb250ZW50L2l0ZW1zLyR7YXBwSWR9L3Jlc291cmNlcy9jb25maWcvY29uZmlnLmpzb25gLCB7XG4gICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvbk1hbmFnZXIuZ2V0U2Vzc2lvbkJ5VXJsKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmwpLFxuICAgICAgaHR0cE1ldGhvZDogJ0dFVCcsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXBcbiAgICAgIH1cbiAgICB9KS5jYXRjaChhc3luYyBlcnIgPT4ge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycilcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDcmVhdGVBcHBQYXJhbXNCeUFwcElkICh0ZW1wbGF0ZUlkOiBzdHJpbmcpOiBQcm9taXNlPEFwcEluZm8+IHtcbiAgcmV0dXJuIGF3YWl0IGNoZWNrSXNQb3J0YWxBcHAodGVtcGxhdGVJZCkudGhlbihhc3luYyBwb3J0YWxBcHBJbmZvID0+IHtcbiAgICAvLyBDaGVjayBpcyBwb3J0YWwgYXBwXG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShwb3J0YWxBcHBJbmZvKVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgfSkuY2F0Y2goYXN5bmMgZXJyID0+IHtcbiAgICAvLyBDaGVjayBpcyBBR09MIGFwcFxuICAgIHJldHVybiBhd2FpdCBjaGVja0lzQUdPTEFwcCh0ZW1wbGF0ZUlkKS50aGVuKGFzeW5jIEFHT0xBcHBJbmZvID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoQUdPTEFwcEluZm8pXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgfSkuY2F0Y2goYXN5bmMgZXJyID0+IHtcbiAgICAgIC8vIENoZWNrIGlzIGxvY2FsIGFwcFxuICAgICAgcmV0dXJuIGF3YWl0IGNoZWNrSXNMb2NhbEFwcCh0ZW1wbGF0ZUlkKVxuICAgIH0pXG4gIH0pXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrSXNQb3J0YWxBcHAgKHRlbXBsYXRlSWQ6IHN0cmluZyk6IFByb21pc2U8QXBwSW5mbz4ge1xuICBjb25zdCBwb3J0YWxVcmwgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsVXJsXG4gIGNvbnN0IGdldEFwcEluZm9QYXJhbXMgPSB7XG4gICAgaWQ6IHRlbXBsYXRlSWQsXG4gICAgcG9ydGFsVXJsOiBwb3J0YWxVcmwsXG4gICAgaXNMb2NhbEFwcDogZmFsc2VcbiAgfSBhcyBBcHBJbmZvXG4gIHJldHVybiBhd2FpdCBnZXRBcHBJbmZvKGdldEFwcEluZm9QYXJhbXMpLnRoZW4oYXN5bmMgYXBwSW5mbyA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShnZXRBcHBJbmZvUGFyYW1zKVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgfSkuY2F0Y2goYXN5bmMgZXJyID0+IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoJ0l0ZW0gZG9lcyBub3QgZXhpc3Qgb3IgaXMgaW5hY2Nlc3NpYmxlLicpXG4gIH0pXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrSXNMb2NhbEFwcCAodGVtcGxhdGVJZDogc3RyaW5nKTogUHJvbWlzZTxBcHBJbmZvPiB7XG4gIGlmICghd2luZG93LmppbXVDb25maWcuaXNEZXZFZGl0aW9uKSB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KCdJdGVtIGRvZXMgbm90IGV4aXN0IG9yIGlzIGluYWNjZXNzaWJsZS4nKVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IHBvcnRhbFVybCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmxcbiAgICBjb25zdCBnZXRBcHBJbmZvUGFyYW1zID0ge1xuICAgICAgaWQ6IHRlbXBsYXRlSWQsXG4gICAgICBwb3J0YWxVcmw6IHBvcnRhbFVybCxcbiAgICAgIGlzTG9jYWxBcHA6IHRydWVcbiAgICB9IGFzIEFwcEluZm9cbiAgICByZXR1cm4gYXdhaXQgZ2V0QXBwSW5mbyhnZXRBcHBJbmZvUGFyYW1zKS50aGVuKGFzeW5jIGxvY2FsQXBwSW5mbyA9PiB7XG4gICAgICBpZiAoIWxvY2FsQXBwSW5mbz8uc3VjY2Vzcykge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoJ0l0ZW0gZG9lcyBub3QgZXhpc3Qgb3IgaXMgaW5hY2Nlc3NpYmxlLicpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGdldEFwcEluZm9QYXJhbXMpXG4gICAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgfSkuY2F0Y2goYXN5bmMgZXJyID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgnSXRlbSBkb2VzIG5vdCBleGlzdCBvciBpcyBpbmFjY2Vzc2libGUuJylcbiAgICB9KVxuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrSXNBR09MQXBwICh0ZW1wbGF0ZUlkOiBzdHJpbmcpOiBQcm9taXNlPEFwcEluZm8+IHtcbiAgY29uc3QgcG9ydGFsVXJsID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBpZiAocG9ydGFsVXJsVXRpbHMuaXNBR09MRG9tYWluKHBvcnRhbFVybCkpIHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QoZmFsc2UpXG4gIH1cbiAgY29uc3QgZ2V0QXBwSW5mb1BhcmFtcyA9IHtcbiAgICBpZDogdGVtcGxhdGVJZCxcbiAgICBwb3J0YWxVcmw6ICdodHRwczovL21hcHMuYXJjZ2lzLmNvbScsXG4gICAgaXNMb2NhbEFwcDogZmFsc2VcbiAgfSBhcyBBcHBJbmZvXG4gIHJldHVybiBhd2FpdCBnZXRBcHBJbmZvKGdldEFwcEluZm9QYXJhbXMpLnRoZW4oYXN5bmMgbG9jYWxBcHBJbmZvID0+IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGdldEFwcEluZm9QYXJhbXMpXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICB9KS5jYXRjaChhc3luYyBlcnIgPT4ge1xuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdCgnSXRlbSBkb2VzIG5vdCBleGlzdCBvciBpcyBpbmFjY2Vzc2libGUuJylcbiAgfSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbmZpZ0Zyb21Qb3J0YWxJdGVtUmVzb3VyY2UgKGFwcElEOiBzdHJpbmcpOiBQcm9taXNlPEFwcENvbmZpZz4ge1xuICBjb25zdCBzZXNzaW9uTWFuYWdlciA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKClcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QoYCR7cG9ydGFsVXJsVXRpbHMuZ2V0UG9ydGFsUmVzdFVybChnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsVXJsKX0vY29udGVudC9pdGVtcy8ke2FwcElEfS9yZXNvdXJjZXMvY29uZmlnL2NvbmZpZy5qc29uYCwge1xuICAgIGF1dGhlbnRpY2F0aW9uOiBzZXNzaW9uTWFuYWdlci5nZXRTZXNzaW9uQnlVcmwoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybCksXG4gICAgaHR0cE1ldGhvZDogJ0dFVCcsXG4gICAgcGFyYW1zOiB7XG4gICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcFxuICAgIH1cbiAgfSkuY2F0Y2goYXN5bmMgZXJyID0+IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZWplY3QobnVsbClcbiAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlc291cmNlT3JpZ2luIChcbiAgb3JpZ2luYWxBcHBJbmZvOiBBcHBJbmZvXG4pOiBzdHJpbmcge1xuICBjb25zdCBwb3J0YWxVcmwgPSBpc0FHT0xBcHAob3JpZ2luYWxBcHBJbmZvKSA/IHVybFV0aWxzLmdldEFyY2dpc09ubGluZVVybCgpIDogZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBjb25zdCBpc0xvY2FsQXBwUmVzb3VyY2VPcmlnaW4gPSBvcmlnaW5hbEFwcEluZm8/LmlzTG9jYWxBcHBcbiAgaWYgKGlzTG9jYWxBcHBSZXNvdXJjZU9yaWdpbikge1xuICAgIC8vIGxvY2FsIGFwcGBzIHJlc291cmNlIG9yaWdpbiBpbiBkZXZFZHRpb25cbiAgICByZXR1cm4gbG9jYWxSZXN0U2VydmljZS5nZXRPcmlnaW5VcmwoKSArICcvYXBwcy8nXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHBvcnRhbFVybFV0aWxzLmdldFBsYXRmb3JtVXJsQnlPcmdVcmwocG9ydGFsVXJsKSArXG4gICAgICAnL3NoYXJpbmcvcmVzdC9jb250ZW50L2l0ZW1zLydcbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUFwcCAoYXBwSW5mbzogSUl0ZW1BZGQsIGZvbGRlcklkPzogc3RyaW5nKSB7XG4gIGlmIChmb2xkZXJJZCkge1xuICAgIHJldHVybiBhd2FpdCBjcmVhdGVBcHBJbkZvbGRlcih7XG4gICAgICBpdGVtOiBhcHBJbmZvLFxuICAgICAgZm9sZGVySWQ6IGZvbGRlcklkLFxuICAgICAgYXV0aGVudGljYXRpb246IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICAgIH0pXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUl0ZW0oe1xuICAgICAgaXRlbTogYXBwSW5mbyxcbiAgICAgIGF1dGhlbnRpY2F0aW9uOiBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgICB9KVxuICB9XG59XG5cbmZ1bmN0aW9uIGluaXRBcHBDb25maWcgKGFwcENvbmZpZzogQXBwQ29uZmlnKSB7XG4gIGlmICghYXBwQ29uZmlnLmF0dHJpYnV0ZXMpIHtcbiAgICBhcHBDb25maWcuYXR0cmlidXRlcyA9IHt9IGFzIGFueVxuICB9XG4gIGlmICghYXBwQ29uZmlnLndpZGdldHMpIHtcbiAgICBhcHBDb25maWcud2lkZ2V0cyA9IHt9IGFzIGFueVxuICB9XG4gIGlmICghYXBwQ29uZmlnLndpZGdldHNNYW5pZmVzdCkge1xuICAgIGFwcENvbmZpZy53aWRnZXRzTWFuaWZlc3QgPSB7fSBhcyBhbnlcbiAgfVxuICBpZiAoIWFwcENvbmZpZy52aWV3cykge1xuICAgIGFwcENvbmZpZy52aWV3cyA9IHt9IGFzIGFueVxuICB9XG4gIGlmICghYXBwQ29uZmlnLnNlY3Rpb25zKSB7XG4gICAgYXBwQ29uZmlnLnNlY3Rpb25zID0ge30gYXMgYW55XG4gIH1cbiAgaWYgKCFhcHBDb25maWcuZGlhbG9ncykge1xuICAgIGFwcENvbmZpZy5kaWFsb2dzID0ge30gYXMgYW55XG4gIH1cbiAgaWYgKCFhcHBDb25maWcucGFnZXMpIHtcbiAgICBhcHBDb25maWcucGFnZXMgPSB7fSBhcyBhbnlcbiAgfVxuICBpZiAoIWFwcENvbmZpZy5sYXlvdXRzKSB7XG4gICAgYXBwQ29uZmlnLmxheW91dHMgPSB7fSBhcyBhbnlcbiAgfVxuICBpZiAoIWFwcENvbmZpZy5kYXRhU291cmNlcykge1xuICAgIGFwcENvbmZpZy5kYXRhU291cmNlcyA9IHt9IGFzIGFueVxuICB9XG4gIGlmICghYXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzKSB7XG4gICAgYXBwQ29uZmlnLm1lc3NhZ2VDb25maWdzID0ge30gYXMgYW55XG4gIH1cblxuICByZXR1cm4gYXBwQ29uZmlnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBvcHRpbWl6ZVdpZGdldHNDb25maWcgKGFwcENvbmZpZzogQXBwQ29uZmlnLCBhcHBJbmZvOiBBcHBJbmZvKTogQXBwQ29uZmlnIHtcbiAgT2JqZWN0LnZhbHVlcyhhcHBDb25maWcud2lkZ2V0cykuZm9yRWFjaCgoanNvbikgPT4ge1xuICAgIGlmIChqc29uLnVyaSA9PT0gJ3dpZGdldHMvY29tbW9uL3RleHQvJykge1xuICAgICAgb3B0aW1pemVUZXh0V2lkZ2V0Q29uZmlnKGpzb24uY29uZmlnLCBhcHBJbmZvKVxuICAgIH1cbiAgfSlcbiAgcmV0dXJuIGFwcENvbmZpZ1xufVxuXG5leHBvcnQgZnVuY3Rpb24gb3B0aW1pemVUZXh0V2lkZ2V0Q29uZmlnIChjb25maWc6IHsgdGV4dDogc3RyaW5nLCBwbGFjZWhvbGRlcj86IHN0cmluZyB9LCBhcHBJbmZvOiBBcHBJbmZvKSB7XG4gIGNvbnN0IGlzVGVtcGxhdGUgPSBhcHBJbmZvLnR5cGUgPT09IEFwcFR5cGUuVGVtcGxhdGVUeXBlXG4gIC8vRG8gbm90IHJlbW92ZSBwbGFjZWhvbGRlciBmb3IgdGVtcGxhdGUgdHlwZSBhcHBcbiAgaWYgKGlzVGVtcGxhdGUpIHJldHVybiBjb25maWdcbiAgLy9QbGFjZWhvbGRlciBhcmUgdXNlbGVzcyBhdCBydW4gdGltZSBpZiBkaXNwbGF5IHRleHQgaXMgY29uZmlndXJlZC5cbiAgaWYgKCFpc0JsYW5rUmljaFRleHQoY29uZmlnPy50ZXh0KSkge1xuICAgIGRlbGV0ZSBjb25maWcucGxhY2Vob2xkZXJcbiAgfVxuICByZXR1cm4gY29uZmlnXG59XG5cbi8qKlxuICogVXBkYXRlIHRoZSBoaXN0b3J5IGxhYmVscyBpbiBkcmFmdCBhcHAgY29uZmlnLCB0aGVuIHJldHVybiB0aGUgZHJhZnQgYXBwIGNvbmZpZ1xuICogQHBhcmFtIGRyYWZ0QXBwQ29uZmlnXG4gKiBAcGFyYW0gcHVibGlzaGVkQXBwQ29uZmlnXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVIaXN0b3J5TGFiZWxzIChkcmFmdEFwcENvbmZpZzogQXBwQ29uZmlnLCBwdWJsaXNoZWRBcHBDb25maWc6IEFwcENvbmZpZyk6IEFwcENvbmZpZyB7XG4gIGlmIChwdWJsaXNoZWRBcHBDb25maWcuX19ub3RfcHVibGlzaCkge1xuICAgIHJldHVybiBkcmFmdEFwcENvbmZpZ1xuICB9XG4gIC8vIHJlbW92ZSBpZHMgdGhhdCBhcmUgbm90IGV4aXN0ZWRcbiAgaWYgKGRyYWZ0QXBwQ29uZmlnLmhpc3RvcnlMYWJlbHMpIHtcbiAgICByZW1vdmVOb25FeGlzdElkcyhkcmFmdEFwcENvbmZpZywgJ3BhZ2VzJylcbiAgICByZW1vdmVOb25FeGlzdElkcyhkcmFmdEFwcENvbmZpZywgJ3ZpZXdzJylcbiAgICByZW1vdmVOb25FeGlzdElkcyhkcmFmdEFwcENvbmZpZywgJ2RpYWxvZ3MnKVxuICB9XG5cbiAgYWRkSGlzTGFiZWxzKGRyYWZ0QXBwQ29uZmlnLCBwdWJsaXNoZWRBcHBDb25maWcsICdwYWdlcycpXG4gIGFkZEhpc0xhYmVscyhkcmFmdEFwcENvbmZpZywgcHVibGlzaGVkQXBwQ29uZmlnLCAndmlld3MnKVxuICBhZGRIaXNMYWJlbHMoZHJhZnRBcHBDb25maWcsIHB1Ymxpc2hlZEFwcENvbmZpZywgJ2RpYWxvZ3MnKVxuXG4gIHJldHVybiBkcmFmdEFwcENvbmZpZ1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGh1bWJuYWlsRm9yU2F2ZUFzQXBwIChvcmlnaW5BcHBJbmZvOiBBcHBJbmZvLCBuZXdBcHBJbmZvOiBBcHBJbmZvLCB0aHVtYm5haWxGaWxlcz86IGFueSk6IFByb21pc2U8YW55PiB7XG4gIGlmICh0aHVtYm5haWxGaWxlcykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgICBjb25zdCBsb2NhbEFwcEl0ZW0gPSB7XG4gICAgICBpZDogbmV3QXBwSW5mby5pZCxcbiAgICAgIGY6ICdqc29uJyxcbiAgICAgIHRva2VuOiBzZXNzaW9uPy50b2tlbixcbiAgICAgIHRodW1ibmFpbDogdGh1bWJuYWlsRmlsZXNcbiAgICB9XG4gICAgYXdhaXQgdXBkYXRlQXBwVGh1bWJuYWlsKGxvY2FsQXBwSXRlbSwgbmV3QXBwSW5mby5vd25lcilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYXdhaXQgdXBkYXRlVGh1bWJuYWlsKG5ld0FwcEluZm8uaWQsIG9yaWdpbkFwcEluZm8sIG9yaWdpbkFwcEluZm8/LnRodW1ibmFpbHVybCB8fCBvcmlnaW5BcHBJbmZvLnRodW1ibmFpbClcbiAgfVxufVxuXG4vKipcbiAqIERlZXAgY2xvbmUuIEJ1dCBvbmx5IGNsb25lIHR3byBsZXZlbHMuXG4gKiBBbmQgcGFyYW0gbXVzdCBiZSBPYmplY3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbG9uZU9iaiAob2JqOiBhbnkpOiBhbnkge1xuICBjb25zdCByZXN1bHQgPSB7fSBhcyBhbnlcbiAgT2JqZWN0LmtleXMob2JqKS5mb3JFYWNoKGlkID0+IHtcbiAgICByZXN1bHRbaWRdID0geyAuLi5vYmpbaWRdIH1cbiAgfSlcbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5mdW5jdGlvbiByZW1vdmVOb25FeGlzdElkcyAoYXBwQ29uZmlnOiBBcHBDb25maWcsIHR5cGU6ICdwYWdlcycgfCAndmlld3MnIHwgJ2RpYWxvZ3MnKSB7XG4gIGNvbnN0IGhpcyA9IGFwcENvbmZpZy5oaXN0b3J5TGFiZWxzXG4gIE9iamVjdC5rZXlzKGhpc1t0eXBlXSB8fCB7fSkuZm9yRWFjaChoaXNJZCA9PiB7XG4gICAgaWYgKCFhcHBDb25maWdbdHlwZV0/LltoaXNJZF0pIHtcbiAgICAgIGRlbGV0ZSBoaXNbdHlwZV1baGlzSWRdXG4gICAgfVxuICB9KVxufVxuXG5mdW5jdGlvbiBhZGRIaXNMYWJlbHMgKGRyYWZ0QXBwQ29uZmlnOiBBcHBDb25maWcsIHB1Ymxpc2hlZEFwcENvbmZpZzogQXBwQ29uZmlnLCB0eXBlOiAncGFnZXMnIHwgJ3ZpZXdzJyB8ICdkaWFsb2dzJykge1xuICBjb25zdCBkcmFmdE9iaiA9IGRyYWZ0QXBwQ29uZmlnW3R5cGVdXG4gIGNvbnN0IHB1Ymxpc2hlZE9iaiA9IHB1Ymxpc2hlZEFwcENvbmZpZ1t0eXBlXVxuXG4gIGlmICghZHJhZnRPYmogfHwgIXB1Ymxpc2hlZE9iaikge1xuICAgIHJldHVyblxuICB9XG5cbiAgT2JqZWN0LmtleXMoZHJhZnRPYmopLmZvckVhY2goaWQgPT4ge1xuICAgIGNvbnN0IGhpc0xhYmVscyA9IHB1Ymxpc2hlZEFwcENvbmZpZy5oaXN0b3J5TGFiZWxzPy5bdHlwZV0/LltpZF0gfHwgW11cbiAgICBpZiAocHVibGlzaGVkT2JqW2lkXSAmJiBkcmFmdE9ialtpZF0ubGFiZWwgIT09IHB1Ymxpc2hlZE9ialtpZF0ubGFiZWwpIHtcbiAgICAgIGlmICghaGlzTGFiZWxzLmluY2x1ZGVzKHB1Ymxpc2hlZE9ialtpZF0ubGFiZWwpKSB7XG4gICAgICAgIGhpc0xhYmVscy5wdXNoKHB1Ymxpc2hlZE9ialtpZF0ubGFiZWwpXG4gICAgICB9XG4gICAgfVxuICAgIGlmIChoaXNMYWJlbHMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKCFkcmFmdEFwcENvbmZpZy5oaXN0b3J5TGFiZWxzKSB7XG4gICAgICAgIGRyYWZ0QXBwQ29uZmlnLmhpc3RvcnlMYWJlbHMgPSB7XG4gICAgICAgICAgW3R5cGVdOiB7XG4gICAgICAgICAgICBbaWRdOiBoaXNMYWJlbHNcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIWRyYWZ0QXBwQ29uZmlnLmhpc3RvcnlMYWJlbHNbdHlwZV0pIHtcbiAgICAgICAgZHJhZnRBcHBDb25maWcuaGlzdG9yeUxhYmVsc1t0eXBlXSA9IHtcbiAgICAgICAgICBbaWRdOiBoaXNMYWJlbHNcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZHJhZnRBcHBDb25maWcuaGlzdG9yeUxhYmVsc1t0eXBlXVtpZF0gPSBoaXNMYWJlbHNcbiAgICAgIH1cbiAgICB9XG4gIH0pXG59XG5cbmNvbnN0IEhUTUxfVEFHX1JFR0VYUCA9IC88W14+XSo+L21nXG4vKipcbiAqIENoZWNrIHdoZXRoZXIgaXMgcmljaCB0ZXh0IHdpdGggZW1wdHkgY29udGVudC5cbiAqL1xuY29uc3QgaXNCbGFua1JpY2hUZXh0ID0gKGh0bWw6IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xuICBpZiAoIWh0bWwpIHJldHVybiB0cnVlXG4gIGlmIChodG1sID09PSAnPHA+PC9wPicgfHwgaHRtbCA9PT0gJzxwPjxicj48L3A+JykgcmV0dXJuIHRydWVcbiAgbGV0IHBsYWluVGV4dCA9ICcnXG4gIGlmICghaHRtbC5pbmNsdWRlcygnPCcpKSB7XG4gICAgcGxhaW5UZXh0ID0gaHRtbFxuICB9IGVsc2Uge1xuICAgIHBsYWluVGV4dCA9IGh0bWwucmVwbGFjZShIVE1MX1RBR19SRUdFWFAsICcnKVxuICB9XG4gIHBsYWluVGV4dCA9IHBsYWluVGV4dD8udHJpbSgpXG4gIHJldHVybiAhcGxhaW5UZXh0XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlRXhiVmVyc2lvbkluQXBwQ29uZmlnIChhcHBDb25maWc6IElNQXBwQ29uZmlnKTogSU1BcHBDb25maWcge1xuICBpZiAoIWFwcENvbmZpZykgcmV0dXJuIG51bGxcbiAgY29uc3QgaXNIaWdoZXJWZXJzaW9uQXBwID0gc2VtdmVyLmx0KHZlcnNpb24sIGFwcENvbmZpZz8uZXhiVmVyc2lvbilcbiAgaWYgKGlzSGlnaGVyVmVyc2lvbkFwcCkge1xuICAgIC8vZG93bmdyYWRlIGFwcCB2ZXJzaW9uXG4gICAgYXBwQ29uZmlnID0gYXBwQ29uZmlnLnNldCgnZXhiVmVyc2lvbicsIHZlcnNpb24pXG4gIH1cbiAgY29uc3QgY29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcFN0YXRlSW5CdWlsZGVyPy5hcHBDb25maWdcbiAgY29uc3Qgd2lkZ2V0cyA9IGNvbmZpZy53aWRnZXRzIHx8IHt9XG4gIE9iamVjdC5rZXlzKHdpZGdldHMpLmZvckVhY2god2lkZ2V0SWQgPT4ge1xuICAgIC8vTWFuaWZlc3QudmVyc2lvbiBpcyB0aGUgdmVyc2lvbiBvZiB0aGUgY3VycmVudCB3aWRnZXQgY29kZSxcbiAgICAvL1doZW4gdGhlIHZlcnNpb24gb2YgdGhlIHdpZGdldCBpcyBoaWdoZXIgdGhhbiB0aGUgY3VycmVudCBjb2RlIHZlcnNpb24sIGl0IG5lZWRzIHRvIGJlIGRvd25ncmFkZWQgdG8gYmUgY29uc2lzdGVudCB3aXRoIHRoZSBtYW5pZmVzdC52ZXJzaW9uXG4gICAgLy9Gb3IgY3VzdG9tIHdpZGdldHMsIGlmIHRoZSB2ZXJzaW9uIHRoZXkgdXNlIGlzIG5vdCBjb25zaXN0ZW50IHdpdGggRXhiQnVpbGRlciwgaXQgbmVlZHMgZnVydGhlciBkaXNjdXNzaW9uIG9uIGhvdyB0byBkZWFsIHdpdGggaXRcbiAgICBjb25zdCBpc0hpZ2hlclZlcnNpb25XaWRnZXQgPSBzZW12ZXIubHQod2lkZ2V0c1t3aWRnZXRJZF0/Lm1hbmlmZXN0Py52ZXJzaW9uLCB3aWRnZXRzW3dpZGdldElkXT8udmVyc2lvbilcbiAgICBpZiAoaXNIaWdoZXJWZXJzaW9uV2lkZ2V0KSB7XG4gICAgICBhcHBDb25maWcgPSBhcHBDb25maWcuc2V0SW4oWyd3aWRnZXRzJywgd2lkZ2V0SWQsICd2ZXJzaW9uJ10sIHdpZGdldHNbd2lkZ2V0SWRdPy5tYW5pZmVzdD8udmVyc2lvbilcbiAgICB9XG4gIH0pXG4gIHJldHVybiBhcHBDb25maWdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRBcHBDb25maWdPZk5ld0FwcCAoYXBwQ29uZmlnOiBBcHBDb25maWcpOiBBcHBDb25maWcge1xuICBpZiAoYXBwQ29uZmlnLmF0dHJpYnV0ZXMpIHtcbiAgICBhcHBDb25maWcuYXR0cmlidXRlcy5wb3J0YWxVcmwgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsVXJsXG4gIH0gZWxzZSB7XG4gICAgYXBwQ29uZmlnLmF0dHJpYnV0ZXMgPSB7XG4gICAgICBwb3J0YWxVcmw6IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmxcbiAgICB9XG4gIH1cblxuICBjb25zdCBzaGFyZWRUaGVtZUpzb24gPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsU2VsZj8ucG9ydGFsUHJvcGVydGllcz8uc2hhcmVkVGhlbWVcbiAgYXBwQ29uZmlnLnNoYXJlZFRoZW1lVmFyaWFibGVzID0gc2hhcmVkVGhlbWVVdGlscy5jcmVhdGVTaGFyZWRUaGVtZVZhcmlhYmxlcyhzaGFyZWRUaGVtZUpzb24pXG4gIHJldHVybiBhcHBDb25maWdcbn1cbiIsImV4cG9ydCAqIGZyb20gJy4vaXRlbXMvdXBkYXRlLXRodW1ibmFpbCdcbmV4cG9ydCAqIGZyb20gJy4vaXRlbXMvZ2V0LXVzZXItY29udGVudCdcbmV4cG9ydCAqIGZyb20gJy4vaXRlbXMvc2hhcmUtaXRlbXMnXG5leHBvcnQgKiBmcm9tICcuL2l0ZW1zL3Vuc2hhcmUtaXRlbXMnXG5leHBvcnQgKiBmcm9tICcuL2l0ZW1zL2l0ZW1zZ3JvdXBzJ1xuZXhwb3J0ICogZnJvbSAnLi9pdGVtcy9nZXQtY2F0ZWdvcnktc2NoZW1hJ1xuIiwiaW1wb3J0IHsgdHlwZSBJUmVxdWVzdE9wdGlvbnMsIHR5cGUgSFRUUE1ldGhvZHMgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuaW1wb3J0IHsgZ2V0T3JpZ2luVXJsLCBnZXRPcmlnaW5JZCB9IGZyb20gJy4uL3V0aWwnXG5pbXBvcnQgeyBnZXRBcHBTdG9yZSwgcG9ydGFsVXJsVXRpbHMsIGVzcmkgfSBmcm9tICdqaW11LWNvcmUnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHcm91cENhdGVnb3J5U2NoZW1hIChcbiAgZ3JvdXBJZDogc3RyaW5nLFxuICByZXF1ZXN0T3B0aW9ucz86IElSZXF1ZXN0T3B0aW9ucyxcbiAgaXNBcmNHaXNPbmxpbmVSZXF1ZXN0ID0gZmFsc2Vcbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IHVybCA9IGAke2dldE9yaWdpblVybChpc0FyY0dpc09ubGluZVJlcXVlc3QpfS9zaGFyaW5nL3Jlc3QvY29tbXVuaXR5L2dyb3Vwcy8ke2dyb3VwSWR9L2NhdGVnb3J5U2NoZW1hYFxuICBpZiAoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0ICYmICFpc1BvcnRhbEFHT0woKSkge1xuICAgIGRlbGV0ZSByZXF1ZXN0T3B0aW9ucy5hdXRoZW50aWNhdGlvblxuICB9XG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMsXG4gICAgcGFyYW1zOiB7XG4gICAgICBpZDogZ3JvdXBJZFxuICAgIH0sXG4gICAgaHR0cE1ldGhvZDogJ0dFVCcgYXMgSFRUUE1ldGhvZHNcbiAgfVxuICBjb25zdCByZXF1ZXN0ID0gZXNyaS5yZXN0UmVxdWVzdC5yZXF1ZXN0XG4gIHJldHVybiBhd2FpdCByZXF1ZXN0KHVybCwgb3B0aW9ucylcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yZ0NhdGVnb3J5U2NoZW1hIChcbiAgcmVxdWVzdE9wdGlvbnM/OiBJUmVxdWVzdE9wdGlvbnMsXG4gIGlzQXJjR2lzT25saW5lUmVxdWVzdCA9IGZhbHNlXG4pOiBQcm9taXNlPGFueT4ge1xuICBjb25zdCBvcmdJZCA9IGdldE9yaWdpbklkKGlzQXJjR2lzT25saW5lUmVxdWVzdClcbiAgY29uc3QgdXJsID0gYCR7Z2V0T3JpZ2luVXJsKGlzQXJjR2lzT25saW5lUmVxdWVzdCl9L3NoYXJpbmcvcmVzdC9wb3J0YWxzLyR7b3JnSWR9L2NhdGVnb3J5U2NoZW1hYFxuICBpZiAoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0ICYmICFpc1BvcnRhbEFHT0woKSkge1xuICAgIGRlbGV0ZSByZXF1ZXN0T3B0aW9ucy5hdXRoZW50aWNhdGlvblxuICB9XG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMsXG4gICAgaHR0cE1ldGhvZDogJ0dFVCcgYXMgSFRUUE1ldGhvZHNcbiAgfVxuICBjb25zdCByZXF1ZXN0ID0gZXNyaS5yZXN0UmVxdWVzdC5yZXF1ZXN0XG4gIHJldHVybiBhd2FpdCByZXF1ZXN0KHVybCwgb3B0aW9ucylcbn1cblxuZnVuY3Rpb24gaXNQb3J0YWxBR09MICgpIHtcbiAgY29uc3QgcG9ydGFsVXJsID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICByZXR1cm4gcG9ydGFsVXJsVXRpbHMuaXNBR09MRG9tYWluKHBvcnRhbFVybClcbn1cbiIsImltcG9ydCB7IGdldEFwcFN0b3JlLCBTZXNzaW9uTWFuYWdlciwgZXNyaSB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgSVBhcmFtcywgdHlwZSBIVFRQTWV0aG9kcywgdHlwZSBJUmVxdWVzdE9wdGlvbnMgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uL3JlcXVlc3QnXG5pbXBvcnQgeyBnZXRPcmlnaW5VcmwsIGlzUG9ydGFsQUdPTCB9IGZyb20gJy4uL3V0aWwnXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlckNvbnRlbnQgKFxuICByZXF1ZXN0T3B0aW9uczogSVBhcmFtc1xuKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICBjb25zdCB1cmwgPSBgJHtnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsVXJsfS9zaGFyaW5nL3Jlc3QvY29udGVudC91c2Vycy8ke3Nlc3Npb24/LnVzZXJuYW1lfWBcbiAgY29uc3QgcmVxdWVzdE9wdGlvbiA9IHtcbiAgICAuLi5yZXF1ZXN0T3B0aW9ucy5wYXJhbXMsXG4gICAgZjogJ2pzb24nLFxuICAgIHRva2VuOiBzZXNzaW9uPy50b2tlblxuICB9XG4gIHJldHVybiBhd2FpdCByZXF1ZXN0KHVybCwgcmVxdWVzdE9wdGlvbiwgJ0dFVCcpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHcm91cENvbnRlbnQgKFxuICBncm91cElkOiBzdHJpbmcsXG4gIHJlcXVlc3RPcHRpb25zPzogSVJlcXVlc3RPcHRpb25zLFxuICBpc0dldEFHT0xDb250ZW50ID0gZmFsc2Vcbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IHVybCA9IGAke2dldE9yaWdpblVybChpc0dldEFHT0xDb250ZW50KX0vc2hhcmluZy9yZXN0L2NvbnRlbnQvZ3JvdXBzLyR7Z3JvdXBJZH0vc2VhcmNoYFxuICBpZiAoaXNHZXRBR09MQ29udGVudCAmJiAhaXNQb3J0YWxBR09MKCkpIHtcbiAgICBkZWxldGUgcmVxdWVzdE9wdGlvbnMuYXV0aGVudGljYXRpb25cbiAgfVxuICBjb25zdCBvcHRpb25zID0ge1xuICAgIC4uLnJlcXVlc3RPcHRpb25zLFxuICAgIGh0dHBNZXRob2Q6ICdHRVQnIGFzIEhUVFBNZXRob2RzXG4gIH1cbiAgY29uc3QgcmVxdWVzdCA9IGVzcmkucmVzdFJlcXVlc3QucmVxdWVzdFxuICByZXR1cm4gYXdhaXQgcmVxdWVzdCh1cmwsIG9wdGlvbnMpXG59XG4iLCJpbXBvcnQgeyBnZXRBcHBTdG9yZSwgU2Vzc2lvbk1hbmFnZXIsIGVzcmkgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIElQYXJhbXMsIHR5cGUgSFRUUE1ldGhvZHMgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGl0ZW1zZ3JvdXBzIChcbiAgcmVxdWVzdE9wdGlvbnM6IElQYXJhbXNcbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgY29uc3QgdXJsID0gYCR7Z2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybH0vc2hhcmluZy9yZXN0L2NvbnRlbnQvaXRlbXNncm91cHNgXG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgcGFyYW1zOiByZXF1ZXN0T3B0aW9ucyxcbiAgICBodHRwTWV0aG9kOiAnR0VUJyBhcyBIVFRQTWV0aG9kcyxcbiAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICB9XG5cbiAgcmV0dXJuIGF3YWl0IGVzcmkucmVzdFJlcXVlc3QucmVxdWVzdCh1cmwsIG9wdGlvbnMpXG59XG4iLCJpbXBvcnQgeyBnZXRBcHBTdG9yZSwgU2Vzc2lvbk1hbmFnZXIgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIElQYXJhbXMgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uL3JlcXVlc3QnXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2hhcmVJdGVtcyAoXG4gIHJlcXVlc3RPcHRpb25zOiBJUGFyYW1zXG4pOiBQcm9taXNlPGFueT4ge1xuICBjb25zdCBzZXNzaW9uID0gU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRNYWluU2Vzc2lvbigpXG4gIGNvbnN0IHVybCA9IGAke2dldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmx9L3NoYXJpbmcvcmVzdC9jb250ZW50L2l0ZW1zLyR7cmVxdWVzdE9wdGlvbnMuaXRlbXN9L3NoYXJlYFxuICByZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICAuLi5yZXF1ZXN0T3B0aW9ucyxcbiAgICBmOiAnanNvbicsXG4gICAgdG9rZW46IHNlc3Npb24/LnRva2VuXG4gIH1cblxuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocmVxdWVzdE9wdGlvbnMpXG4gIGNvbnN0IGRhdGE6IEZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKClcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgZGF0YS5hcHBlbmQoa2V5c1tpXSwgcmVxdWVzdE9wdGlvbnNba2V5c1tpXV0pXG4gIH1cbiAgcmVxdWVzdE9wdGlvbnMgPSBkYXRhXG4gIHJldHVybiBhd2FpdCByZXF1ZXN0KHVybCwgcmVxdWVzdE9wdGlvbnMpXG59XG4iLCJpbXBvcnQgeyBnZXRBcHBTdG9yZSwgU2Vzc2lvbk1hbmFnZXIgfSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB0eXBlIElQYXJhbXMgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uL3JlcXVlc3QnXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdW5TaGFyZUl0ZW1zIChcbiAgcmVxdWVzdE9wdGlvbnM6IElQYXJhbXNcbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldE1haW5TZXNzaW9uKClcbiAgY29uc3QgdXJsID0gYCR7Z2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybH0vc2hhcmluZy9yZXN0L2NvbnRlbnQvaXRlbXMvJHtyZXF1ZXN0T3B0aW9ucy5pdGVtc30vdW5zaGFyZWBcbiAgcmVxdWVzdE9wdGlvbnMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMsXG4gICAgZjogJ2pzb24nLFxuICAgIHRva2VuOiBzZXNzaW9uPy50b2tlblxuICB9XG5cbiAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHJlcXVlc3RPcHRpb25zKVxuICBjb25zdCBkYXRhOiBGb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpXG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGRhdGEuYXBwZW5kKGtleXNbaV0sIHJlcXVlc3RPcHRpb25zW2tleXNbaV1dKVxuICB9XG4gIHJlcXVlc3RPcHRpb25zID0gZGF0YVxuICByZXR1cm4gYXdhaXQgcmVxdWVzdCh1cmwsIHJlcXVlc3RPcHRpb25zKVxufVxuIiwiaW1wb3J0IHsgZ2V0QXBwU3RvcmUsIFNlc3Npb25NYW5hZ2VyIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBJVXBkYXRlSXRlbU9wdGlvbnMsIHR5cGUgSVVwZGF0ZUl0ZW1SZXNwb25zZSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXBvcnRhbCdcbmltcG9ydCB7IHJlcXVlc3QgfSBmcm9tICcuLi9yZXF1ZXN0J1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUl0ZW0gKFxuICByZXF1ZXN0T3B0aW9uczogSVVwZGF0ZUl0ZW1PcHRpb25zXG4pOiBQcm9taXNlPElVcGRhdGVJdGVtUmVzcG9uc2U+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0TWFpblNlc3Npb24oKVxuICBjb25zdCBvd25lciA9IHJlcXVlc3RPcHRpb25zLm93bmVyID8gcmVxdWVzdE9wdGlvbnMub3duZXIgOiBzZXNzaW9uPy51c2VybmFtZVxuICBjb25zdCB1cmwgPSBgJHtnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucG9ydGFsVXJsfS9zaGFyaW5nL3Jlc3QvY29udGVudC91c2Vycy8ke293bmVyfS9pdGVtcy8ke3JlcXVlc3RPcHRpb25zLml0ZW0uaWR9L3VwZGF0ZWBcblxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMucGFyYW1zLFxuICAgIC4uLnJlcXVlc3RPcHRpb25zLml0ZW1cbiAgfVxuXG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhyZXF1ZXN0T3B0aW9ucy5wYXJhbXMpXG4gIGNvbnN0IGRhdGE6IEZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKClcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgZGF0YS5hcHBlbmQoa2V5c1tpXSwgcmVxdWVzdE9wdGlvbnMucGFyYW1zW2tleXNbaV1dKVxuICB9XG4gIHJlcXVlc3RPcHRpb25zLnBhcmFtcyA9IGRhdGFcbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCBkYXRhKVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJUGFyYW1zIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtcmVxdWVzdCdcbmltcG9ydCB7IGdldEFwcFN0b3JlLCBTZXNzaW9uTWFuYWdlciB9IGZyb20gJ2ppbXUtY29yZSdcbmNvbnN0IGlzV2ViVGllciA9IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuaXNUcnVzdGVkU2VydmVyKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmwpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWVzdCAoXG4gIHVybDogc3RyaW5nLFxuICByZXF1ZXN0T3B0aW9uczogSVBhcmFtcyA9IHsgZjogJ2pzb24nIH0sXG4gIHJlcXVlc3RUeXBlOiAnR0VUJyB8ICdQT1NUJyA9ICdQT1NUJ1xuKTogUHJvbWlzZTxhbnk+IHtcbiAgaWYgKHJlcXVlc3RUeXBlID09PSAnR0VUJykge1xuICAgIGNvbnN0IHJlcXVlc3RVcmwgPSB1cmwgKyBlbmNvZGVRdWVyeVN0cmluZyhyZXF1ZXN0T3B0aW9ucylcbiAgICByZXR1cm4gYXdhaXQgZmV0Y2gocmVxdWVzdFVybCwge1xuICAgICAgY3JlZGVudGlhbHM6IGlzV2ViVGllciA/ICdpbmNsdWRlJyA6ICdzYW1lLW9yaWdpbicsXG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICB9XG4gICAgfSkudGhlbihhc3luYyAocmVzcG9uc2UpID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICB9KS50aGVuKGFzeW5jIGRhdGEgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShkYXRhKVxuICAgIH0pXG4gIH1cblxuICBpZiAocmVxdWVzdFR5cGUgPT09ICdQT1NUJykge1xuICAgIGlmIChyZXF1ZXN0T3B0aW9ucyAmJiByZXF1ZXN0T3B0aW9ucy5jb25zdHJ1Y3Rvci5uYW1lID09PSAnRm9ybURhdGEnKSB7XG4gICAgICByZXR1cm4gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIGNyZWRlbnRpYWxzOiBpc1dlYlRpZXIgPyAnaW5jbHVkZScgOiAnc2FtZS1vcmlnaW4nLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogcmVxdWVzdE9wdGlvbnMgYXMgRm9ybURhdGFcbiAgICAgIH0pLnRoZW4oYXN5bmMgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgIH0pLnRoZW4oYXN5bmMgZGF0YSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgY3JlZGVudGlhbHM6IGlzV2ViVGllciA/ICdpbmNsdWRlJyA6ICdzYW1lLW9yaWdpbicsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0T3B0aW9ucylcbiAgICAgIH0pLnRoZW4oYXN5bmMgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgIH0pLnRoZW4oYXN5bmMgZGF0YSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KG51bGwpXG59XG5cbmZ1bmN0aW9uIGVuY29kZVF1ZXJ5U3RyaW5nIChwYXJhbXMpIHtcbiAgaWYgKCFwYXJhbXMpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhwYXJhbXMpXG4gIHJldHVybiBrZXlzLmxlbmd0aFxuICAgID8gJz8nICsga2V5c1xuICAgICAgLm1hcChrZXkgPT4gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgK1xuICAgICAgICAgICAgICAnPScgKyBlbmNvZGVVUklDb21wb25lbnQocGFyYW1zW2tleV0pKVxuICAgICAgLmpvaW4oJyYnKVxuICAgIDogJydcbn1cbiIsImltcG9ydCB7IGdldEFwcFN0b3JlLCB1cmxVdGlscywgcG9ydGFsVXJsVXRpbHMgfSBmcm9tICdqaW11LWNvcmUnXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPcmlnaW5VcmwgKGlzQXJjR2lzT25saW5lUmVxdWVzdCA9IGZhbHNlKSB7XG4gIGlmIChpc0FyY0dpc09ubGluZVJlcXVlc3QpIHtcbiAgICByZXR1cm4gdXJsVXRpbHMuZ2V0QXJjZ2lzT25saW5lVXJsKClcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLm9yaWdpblxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyQ29udGVudFVybCAoaXNOb3RDb250YWluVXNlcnMgPSBmYWxzZSkge1xuICBpZiAoaXNOb3RDb250YWluVXNlcnMpIHtcbiAgICByZXR1cm4gJy9zaGFyaW5nL3Jlc3QvY29udGVudC8nXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICcvc2hhcmluZy9yZXN0L2NvbnRlbnQvdXNlcnMvJ1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyTmFtZSAoKSB7XG4gIHJldHVybiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkudXNlcj8udXNlcm5hbWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE9yaWdpbklkIChpc0FyY0dpc09ubGluZVJlcXVlc3QgPSBmYWxzZSkge1xuICBpZiAoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHVybFV0aWxzLmdldEFyY2dpc09ubGluZU9yZ0lkKClcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnVzZXI/Lm9yZ0lkXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUG9ydGFsQUdPTCAoKSB7XG4gIGNvbnN0IHBvcnRhbFVybCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmxcbiAgcmV0dXJuIHBvcnRhbFVybFV0aWxzLmlzQUdPTERvbWFpbihwb3J0YWxVcmwpXG59XG4iLCJleHBvcnQgKiBmcm9tICcuL2l0ZW1zL3NlYXJjaCdcbmV4cG9ydCAqIGZyb20gJy4vaXRlbXMvY3JlYXRlJ1xuZXhwb3J0ICogZnJvbSAnLi9pdGVtcy9nZXQnXG5leHBvcnQgKiBmcm9tICcuL2l0ZW1zL3JlbW92ZSdcbmV4cG9ydCAqIGZyb20gJy4vaXRlbXMvdXBkYXRlJ1xuZXhwb3J0ICogZnJvbSAnLi9pdGVtcy9hZGQnXG5leHBvcnQgKiBmcm9tICcuL3JlcXVlc3QnXG5leHBvcnQgKiBmcm9tICcuL3V0aWwnXG4iLCJpbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAnLi4vcmVxdWVzdCdcbmltcG9ydCB7IGdldE9yaWdpblVybCwgZ2V0VXNlckNvbnRlbnRVcmwgfSBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IHsgdHlwZSBJSXRlbVJlc291cmNlT3B0aW9ucywgdHlwZSBJSXRlbVJlc291cmNlUmVzcG9uc2UgfSBmcm9tICcuL2hlbHBlcnMnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRJdGVtUmVzb3VyY2UgKFxuICByZXF1ZXN0T3B0aW9uczogSUl0ZW1SZXNvdXJjZU9wdGlvbnNcbik6IFByb21pc2U8SUl0ZW1SZXNvdXJjZVJlc3BvbnNlPiB7XG4gIGNvbnN0IHVybCA9IGAke2dldE9yaWdpblVybCgpfSR7Z2V0VXNlckNvbnRlbnRVcmwoKX1pdGVtcy8ke1xuICAgIHJlcXVlc3RPcHRpb25zLmlkXG4gIH0vYWRkUmVzb3VyY2VzYFxuXG4gIHJlcXVlc3RPcHRpb25zLnBhcmFtcyA9IHtcbiAgICBmaWxlTmFtZTogcmVxdWVzdE9wdGlvbnMubmFtZSxcbiAgICB0ZXh0OiByZXF1ZXN0T3B0aW9ucy5jb250ZW50LFxuICAgIGFjY2VzczogcmVxdWVzdE9wdGlvbnMucHJpdmF0ZSA/ICdwcml2YXRlJyA6ICdpbmhlcml0JyxcbiAgICAuLi5yZXF1ZXN0T3B0aW9ucy5wYXJhbXMsXG4gICAgZmlsZTogcmVxdWVzdE9wdGlvbnMucmVzb3VyY2VcbiAgfVxuXG4gIGRlbGV0ZSByZXF1ZXN0T3B0aW9ucy5wYXJhbXMuZmlsZVxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMuZmlsZSA9IHJlcXVlc3RPcHRpb25zLnJlc291cmNlXG5cbiAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHJlcXVlc3RPcHRpb25zLnBhcmFtcylcbiAgY29uc3QgZGF0YTogRm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGRhdGEuYXBwZW5kKGtleXNbaV0sIHJlcXVlc3RPcHRpb25zLnBhcmFtc1trZXlzW2ldXSlcbiAgfVxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSBkYXRhXG5cbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCByZXF1ZXN0T3B0aW9ucylcbn1cbiIsImltcG9ydCB7IGVzcmksIGdldEFwcFN0b3JlIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBJQ3JlYXRlSXRlbU9wdGlvbnMsIHR5cGUgSUNyZWF0ZUl0ZW1SZXNwb25zZSwgdHlwZSBJSXRlbURhdGFPcHRpb25zIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtcG9ydGFsJ1xuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uL3JlcXVlc3QnXG5pbXBvcnQgeyBnZXRPcmlnaW5VcmwsIGdldFVzZXJDb250ZW50VXJsLCBnZXRVc2VyTmFtZSB9IGZyb20gJy4uL3V0aWwnXG5pbXBvcnQgeyBzZXJpYWxpemVJdGVtIH0gZnJvbSAnLi9oZWxwZXJzJ1xuaW1wb3J0IHsgdHlwZSBJbXBvcnRBcHBPcHRpb24gfSBmcm9tICcuLi8uLi90eXBlJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlSXRlbSAoXG4gIHJlcXVlc3RPcHRpb25zOiBJQ3JlYXRlSXRlbU9wdGlvbnNcbik6IFByb21pc2U8SUNyZWF0ZUl0ZW1SZXNwb25zZT4ge1xuICAvLyBkZWxlZ2F0ZSB0byBjcmVhdGVJdGVtSW5Gb2xkZXIgcGxhY2luZyBpbiB0aGUgcm9vdCBvZiB0aGUgZmlsZXN0b3JlXG4gIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgZm9sZGVySWQ6IG51bGwsXG4gICAgLi4ucmVxdWVzdE9wdGlvbnNcbiAgfSBhcyBJQ3JlYXRlSXRlbU9wdGlvbnNcbiAgcmV0dXJuIGF3YWl0IGNyZWF0ZUl0ZW1JbkZvbGRlcihvcHRpb25zKVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVJdGVtSW5Gb2xkZXIgKFxuICByZXF1ZXN0T3B0aW9uczogSUNyZWF0ZUl0ZW1PcHRpb25zXG4pOiBQcm9taXNlPElDcmVhdGVJdGVtUmVzcG9uc2U+IHtcbiAgaWYgKHJlcXVlc3RPcHRpb25zLmZpbGUgJiYgIXJlcXVlc3RPcHRpb25zLm11bHRpcGFydCkge1xuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlamVjdChcbiAgICAgIG5ldyBFcnJvcignVGhlIHJlcXVlc3QgbXVzdCBiZSBhIG11bHRpcGFydCByZXF1ZXN0IGZvciBmaWxlIHVwbG9hZGluZy4nKVxuICAgIClcbiAgfVxuXG4gIGlmIChyZXF1ZXN0T3B0aW9ucy5tdWx0aXBhcnQgJiYgIXJlcXVlc3RPcHRpb25zLmZpbGVuYW1lKSB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KFxuICAgICAgbmV3IEVycm9yKCdUaGUgZmlsZSBuYW1lIGlzIHJlcXVpcmVkIGZvciBhIG11bHRpcGFydCByZXF1ZXN0LicpXG4gICAgKVxuICB9XG5cbiAgY29uc3QgdXNlck5hbWUgPSBnZXRVc2VyTmFtZSgpXG5cbiAgY29uc3Qgb3duZXIgPSB1c2VyTmFtZVxuICBjb25zdCBiYXNlVXJsID0gZ2V0T3JpZ2luVXJsKClcbiAgY29uc3QgdXJsID0gYCR7YmFzZVVybH0ke2dldFVzZXJDb250ZW50VXJsKCl9YWRkSXRlbWBcblxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMucGFyYW1zLFxuICAgIC4uLnNlcmlhbGl6ZUl0ZW0ocmVxdWVzdE9wdGlvbnMuaXRlbSksXG4gICAgcG9ydGFsVXJsOiBnZXRBcHBTdG9yZSgpPy5nZXRTdGF0ZSgpPy5wb3J0YWxVcmxcbiAgfVxuXG4gIC8vIHNlcmlhbGl6ZSB0aGUgaXRlbSBpbnRvIHNvbWV0aGluZyBQb3J0YWwgd2lsbCBhY2NlcHRcbiAgY29uc3Qgb3B0aW9ucyA9IGVzcmkucmVzdFJlcXVlc3QuYXBwZW5kQ3VzdG9tUGFyYW1zPElDcmVhdGVJdGVtT3B0aW9ucz4oXG4gICAgcmVxdWVzdE9wdGlvbnMsXG4gICAgW1xuICAgICAgJ293bmVyJyxcbiAgICAgICdmb2xkZXJJZCcsXG4gICAgICAnZmlsZScsXG4gICAgICAnZGF0YVVybCcsXG4gICAgICAndGV4dCcsXG4gICAgICAnYXN5bmMnLFxuICAgICAgJ211bHRpcGFydCcsXG4gICAgICAnZmlsZW5hbWUnLFxuICAgICAgJ292ZXJ3cml0ZSdcbiAgICBdLFxuICAgIHtcbiAgICAgIHBhcmFtczogeyAuLi5yZXF1ZXN0T3B0aW9ucy5wYXJhbXMgfVxuICAgIH1cbiAgKVxuXG4gIG9wdGlvbnMucGFyYW1zLnVzZXJuYW1lID0gb3duZXJcblxuICByZXR1cm4gYXdhaXQgcmVxdWVzdCh1cmwsIG9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbXBvcnRJdGVtIChcbiAgaXRlbTogSW1wb3J0QXBwT3B0aW9uLFxuICByZXF1ZXN0T3B0aW9uczogSUl0ZW1EYXRhT3B0aW9uc1xuKTogUHJvbWlzZTxJQ3JlYXRlSXRlbVJlc3BvbnNlPiB7XG4gIGNvbnN0IGJhc2VVcmwgPSBnZXRPcmlnaW5VcmwoKVxuXG4gIGNvbnN0IHVybCA9IGAke2Jhc2VVcmx9JHtnZXRVc2VyQ29udGVudFVybCgpfWltcG9ydEl0ZW1gXG5cbiAgaWYgKCFpdGVtPy5hcHBaaXApIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ05vIGFwcCBmaWxlcycpXG4gIH1cblxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMucGFyYW1zLFxuICAgIC4uLml0ZW1cbiAgfVxuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocmVxdWVzdE9wdGlvbnMucGFyYW1zKVxuICBjb25zdCBkYXRhOiBGb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpXG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGRhdGEuYXBwZW5kKGtleXNbaV0sIHJlcXVlc3RPcHRpb25zLnBhcmFtc1trZXlzW2ldXSlcbiAgfVxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSBkYXRhXG5cbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCByZXF1ZXN0T3B0aW9ucyBhcyBhbnkpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0l0ZW1WZXJzaW9uIChcbiAgaXRlbTogSW1wb3J0QXBwT3B0aW9uLFxuICByZXF1ZXN0T3B0aW9uczogSUl0ZW1EYXRhT3B0aW9uc1xuKTogUHJvbWlzZTxJQ3JlYXRlSXRlbVJlc3BvbnNlPiB7XG4gIGNvbnN0IGJhc2VVcmwgPSBnZXRPcmlnaW5VcmwoKVxuXG4gIGNvbnN0IHVybCA9IGAke2Jhc2VVcmx9JHtnZXRVc2VyQ29udGVudFVybCgpfWNoZWNrSXRlbVZlcnNpb25gXG5cbiAgaWYgKCFpdGVtPy5hcHBaaXApIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ05vIGFwcCBmaWxlcycpXG4gIH1cblxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMucGFyYW1zLFxuICAgIC4uLml0ZW1cbiAgfVxuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocmVxdWVzdE9wdGlvbnMucGFyYW1zKVxuICBjb25zdCBkYXRhOiBGb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpXG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGRhdGEuYXBwZW5kKGtleXNbaV0sIHJlcXVlc3RPcHRpb25zLnBhcmFtc1trZXlzW2ldXSlcbiAgfVxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSBkYXRhXG5cbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCByZXF1ZXN0T3B0aW9ucyBhcyBhbnkpXG59XG4iLCJpbXBvcnQgeyB0eXBlIElSZXF1ZXN0T3B0aW9ucyB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXJlcXVlc3QnXG5pbXBvcnQgeyB0eXBlIElJdGVtIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnXG5pbXBvcnQgeyB0eXBlIElJdGVtRGF0YU9wdGlvbnMgfSBmcm9tICcuL2hlbHBlcnMnXG5pbXBvcnQgeyBnZXRPcmlnaW5VcmwsIGdldFVzZXJDb250ZW50VXJsLCBnZXRSZXF1ZXN0TWV0aG9kIH0gZnJvbSAnLi4vdXRpbCdcbmltcG9ydCB7IGdldEFwcFN0b3JlLCBwb3J0YWxVcmxVdGlscyB9IGZyb20gJ2ppbXUtY29yZSdcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRJdGVtRGF0YSAoXG4gIGlkOiBzdHJpbmcsXG4gIHJlcXVlc3RPcHRpb25zPzogSUl0ZW1EYXRhT3B0aW9ucyxcbiAgaXNBcmNHaXNPbmxpbmVSZXF1ZXN0ID0gZmFsc2Vcbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IGJhc2VVcmwgPSBnZXRPcmlnaW5VcmwoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KVxuICBjb25zdCB1cmwgPSBgJHtiYXNlVXJsfSR7Z2V0VXNlckNvbnRlbnRVcmwoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KX1pdGVtcy8ke2lkfS9kYXRhYFxuICAvLyBkZWZhdWx0IHRvIGEgR0VUIHJlcXVlc3RcbiAgY29uc3Qgb3B0aW9uczogSUl0ZW1EYXRhT3B0aW9ucyA9IHtcbiAgICAuLi57IHBhcmFtczoge30gfSxcbiAgICAuLi5yZXF1ZXN0T3B0aW9uc1xuICB9XG5cbiAgaWYgKG9wdGlvbnMuZmlsZSkge1xuICAgIG9wdGlvbnMucGFyYW1zLmYgPSBudWxsXG4gIH1cbiAgaWYgKGlzQXJjR2lzT25saW5lUmVxdWVzdCAmJiAhaXNQb3J0YWxBR09MKCkpIHtcbiAgICBkZWxldGUgb3B0aW9ucy5hdXRoZW50aWNhdGlvblxuICB9XG4gIGNvbnN0IHJlcXVlc3QgPSBnZXRSZXF1ZXN0TWV0aG9kKGlzQXJjR2lzT25saW5lUmVxdWVzdClcbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCBvcHRpb25zKS5jYXRjaChlcnIgPT4ge1xuICAgIC8qIGlmIHRoZSBpdGVtIGRvZXNuJ3QgaW5jbHVkZSBkYXRhLCB0aGUgcmVzcG9uc2Ugd2lsbCBiZSBlbXB0eVxuICAgICAgIGFuZCB0aGUgaW50ZXJuYWwgY2FsbCB0byByZXNwb25zZS5qc29uKCkgd2lsbCBmYWlsICovXG4gICAgY29uc3QgZW1wdHlSZXNwb25zZUVyciA9IC9VbmV4cGVjdGVkIGVuZCBvZiAoSlNPTiBpbnB1dHxkYXRhIGF0IGxpbmUgMSBjb2x1bW4gMSkvaVxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgaWYgKCFlbXB0eVJlc3BvbnNlRXJyLnRlc3QoZXJyLm1lc3NhZ2UpKSB7XG4gICAgICB0aHJvdyBlcnJcbiAgICB9XG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRJdGVtIChcbiAgaWQ6IHN0cmluZyxcbiAgcmVxdWVzdE9wdGlvbnM/OiBJUmVxdWVzdE9wdGlvbnMsXG4gIGlzQXJjR2lzT25saW5lUmVxdWVzdCA9IGZhbHNlXG4pOiBQcm9taXNlPElJdGVtPiB7XG4gIGNvbnN0IGJhc2VVcmwgPSBnZXRPcmlnaW5VcmwoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KVxuICAvLyBjb25zdCB1c2VycyA9IGlzQXJjR2lzT25saW5lUmVxdWVzdCA/ICcnIDogJ3VzZXJzLydcblxuICBjb25zdCB1cmwgPSBgJHtiYXNlVXJsfSR7Z2V0VXNlckNvbnRlbnRVcmwoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KX1pdGVtcy8ke2lkfWBcblxuICAvLyBkZWZhdWx0IHRvIGEgR0VUIHJlcXVlc3RcbiAgY29uc3Qgb3B0aW9uczogSVJlcXVlc3RPcHRpb25zID0ge1xuICAgIC4uLnJlcXVlc3RPcHRpb25zXG4gIH1cbiAgaWYgKGlzQXJjR2lzT25saW5lUmVxdWVzdCAmJiAhaXNQb3J0YWxBR09MKCkpIHtcbiAgICBkZWxldGUgb3B0aW9ucy5hdXRoZW50aWNhdGlvblxuICB9XG4gIGNvbnN0IHJlcXVlc3QgPSBnZXRSZXF1ZXN0TWV0aG9kKGlzQXJjR2lzT25saW5lUmVxdWVzdClcbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCBvcHRpb25zKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SXRlbVJlc291cmNlcyAoXG4gIGlkOiBzdHJpbmcsXG4gIHJlcXVlc3RPcHRpb25zPzogSVJlcXVlc3RPcHRpb25zLFxuICBpc0FyY0dpc09ubGluZVJlcXVlc3QgPSBmYWxzZVxuKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgdXJsID0gYCR7Z2V0T3JpZ2luVXJsKGlzQXJjR2lzT25saW5lUmVxdWVzdCl9JHtnZXRVc2VyQ29udGVudFVybChpc0FyY0dpc09ubGluZVJlcXVlc3QpfWl0ZW1zLyR7aWR9L3Jlc291cmNlc2BcblxuICAvLyBtaXggaW4gdXNlciBzdXBwbGllZCBwYXJhbXNcbiAgcmVxdWVzdE9wdGlvbnMucGFyYW1zID0ge1xuICAgIC4uLnJlcXVlc3RPcHRpb25zLnBhcmFtcyxcbiAgICBudW06IDEwMDBcbiAgfVxuICBpZiAoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0ICYmICFpc1BvcnRhbEFHT0woKSkge1xuICAgIGRlbGV0ZSByZXF1ZXN0T3B0aW9ucy5hdXRoZW50aWNhdGlvblxuICB9XG4gIGNvbnN0IHJlcXVlc3QgPSBnZXRSZXF1ZXN0TWV0aG9kKGlzQXJjR2lzT25saW5lUmVxdWVzdClcbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCByZXF1ZXN0T3B0aW9ucywgJ0dFVCcpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRJdGVtUmVzb3VyY2UgKFxuICBpZDogc3RyaW5nLFxuICByZXF1ZXN0T3B0aW9ucz86IElSZXF1ZXN0T3B0aW9ucyxcbiAgaXNBcmNHaXNPbmxpbmVSZXF1ZXN0ID0gZmFsc2Vcbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IHJlc291cmNlTmFtZSA9IChyZXF1ZXN0T3B0aW9ucyBhcyBhbnkpLmZpbGVOYW1lXG4gIGNvbnN0IHVybCA9IGAke2dldE9yaWdpblVybChpc0FyY0dpc09ubGluZVJlcXVlc3QpfSR7Z2V0VXNlckNvbnRlbnRVcmwoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KX1pdGVtcy8ke2lkfS9yZXNvdXJjZXMvJHtyZXNvdXJjZU5hbWV9YFxuXG4gIGlmIChpc0FyY0dpc09ubGluZVJlcXVlc3QgJiYgIWlzUG9ydGFsQUdPTCgpKSB7XG4gICAgZGVsZXRlIHJlcXVlc3RPcHRpb25zLmF1dGhlbnRpY2F0aW9uXG4gIH1cbiAgY29uc3QgcmVxdWVzdCA9IGdldFJlcXVlc3RNZXRob2QoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KVxuICByZXR1cm4gYXdhaXQgcmVxdWVzdCh1cmwsIHJlcXVlc3RPcHRpb25zLCAnR0VUJylcbn1cblxuZnVuY3Rpb24gaXNQb3J0YWxBR09MICgpIHtcbiAgY29uc3QgcG9ydGFsVXJsID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICByZXR1cm4gcG9ydGFsVXJsVXRpbHMuaXNBR09MRG9tYWluKHBvcnRhbFVybClcbn1cbiIsIi8qIENvcHlyaWdodCAoYykgMjAxNy0yMDE4IEVudmlyb25tZW50YWwgU3lzdGVtcyBSZXNlYXJjaCBJbnN0aXR1dGUsIEluYy5cbiAqIEFwYWNoZS0yLjAgKi9cblxuaW1wb3J0IHsgdHlwZSBJUmVxdWVzdE9wdGlvbnMgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuaW1wb3J0IHsgdHlwZSBJSXRlbUFkZCwgdHlwZSBJSXRlbVVwZGF0ZSwgdHlwZSBJSXRlbSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXR5cGVzJ1xuaW1wb3J0IHsgdHlwZSBJVXNlclJlcXVlc3RPcHRpb25zIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtYXV0aCdcblxuLyoqXG4gKiBCYXNlIG9wdGlvbnMgaW50ZXJmYWNlIGZvciBtYWtpbmcgYXV0aGVudGljYXRlZCByZXF1ZXN0cyBmb3IgaXRlbXMuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVVzZXJJdGVtT3B0aW9ucyBleHRlbmRzIElVc2VyUmVxdWVzdE9wdGlvbnMge1xuICAvKipcbiAgICogVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGl0ZW0uXG4gICAqL1xuICBpZDogc3RyaW5nXG4gIC8qKlxuICAgKiBJdGVtIG93bmVyIHVzZXJuYW1lLiBJZiBub3QgcHJlc2VudCwgYGF1dGhlbnRpY2F0aW9uLnVzZXJuYW1lYCBpcyB1dGlsaXplZC5cbiAgICovXG4gIG93bmVyPzogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUZvbGRlcklkT3B0aW9ucyBleHRlbmRzIElVc2VyUmVxdWVzdE9wdGlvbnMge1xuICAvKipcbiAgICogVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGZvbGRlci5cbiAgICovXG4gIGZvbGRlcklkOiBzdHJpbmdcbiAgLyoqXG4gICAqIEl0ZW0gb3duZXIgdXNlcm5hbWUuIElmIG5vdCBwcmVzZW50LCBgYXV0aGVudGljYXRpb24udXNlcm5hbWVgIGlzIHV0aWxpemVkLlxuICAgKi9cbiAgb3duZXI/OiBzdHJpbmdcbn1cblxuZXhwb3J0IHR5cGUgSXRlbVJlbGF0aW9uc2hpcFR5cGUgPVxuICB8ICdNYXAyU2VydmljZSdcbiAgfCAnV01BMkNvZGUnXG4gIHwgJ01hcDJGZWF0dXJlQ29sbGVjdGlvbidcbiAgfCAnTW9iaWxlQXBwMkNvZGUnXG4gIHwgJ1NlcnZpY2UyRGF0YSdcbiAgfCAnU2VydmljZTJTZXJ2aWNlJ1xuICB8ICdNYXAyQXBwQ29uZmlnJ1xuICB8ICdJdGVtMkF0dGFjaG1lbnQnXG4gIHwgJ0l0ZW0yUmVwb3J0J1xuICB8ICdMaXN0ZWQyUHJvdmlzaW9uZWQnXG4gIHwgJ1N0eWxlMlN0eWxlJ1xuICB8ICdTZXJ2aWNlMlN0eWxlJ1xuICB8ICdTdXJ2ZXkyU2VydmljZSdcbiAgfCAnU3VydmV5MkRhdGEnXG4gIHwgJ1NlcnZpY2UyUm91dGUnXG4gIHwgJ0FyZWEyUGFja2FnZSdcbiAgfCAnTWFwMkFyZWEnXG4gIHwgJ1NlcnZpY2UyTGF5ZXInXG4gIHwgJ0FyZWEyQ3VzdG9tUGFja2FnZSdcblxuZXhwb3J0IGludGVyZmFjZSBJSXRlbVJlbGF0aW9uc2hpcE9wdGlvbnMgZXh0ZW5kcyBJUmVxdWVzdE9wdGlvbnMge1xuICAvKipcbiAgICogVW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIGl0ZW0uXG4gICAqL1xuICBpZDogc3RyaW5nXG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiByZWxhdGlvbnNoaXAgYmV0d2VlbiB0aGUgdHdvIGl0ZW1zLlxuICAgKi9cbiAgcmVsYXRpb25zaGlwVHlwZTogSXRlbVJlbGF0aW9uc2hpcFR5cGUgfCBJdGVtUmVsYXRpb25zaGlwVHlwZVtdXG4gIC8qKlxuICAgKiBUaGUgZGlyZWN0aW9uIG9mIHRoZSByZWxhdGlvbnNoaXAuIEVpdGhlciBmb3J3YXJkIChmcm9tIG9yaWdpbiAtPiBkZXN0aW5hdGlvbikgb3IgcmV2ZXJzZSAoZnJvbSBkZXN0aW5hdGlvbiAtPiBvcmlnaW4pLlxuICAgKi9cbiAgZGlyZWN0aW9uPzogJ2ZvcndhcmQnIHwgJ3JldmVyc2UnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1hbmFnZUl0ZW1SZWxhdGlvbnNoaXBPcHRpb25zIGV4dGVuZHMgSVVzZXJSZXF1ZXN0T3B0aW9ucyB7XG4gIG9yaWdpbkl0ZW1JZDogc3RyaW5nXG4gIGRlc3RpbmF0aW9uSXRlbUlkOiBzdHJpbmdcbiAgcmVsYXRpb25zaGlwVHlwZTogSXRlbVJlbGF0aW9uc2hpcFR5cGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJSXRlbVJlc291cmNlT3B0aW9ucyBleHRlbmRzIElVc2VySXRlbU9wdGlvbnMge1xuICAvKipcbiAgICogTmV3IHJlc291cmNlIGZpbGVuYW1lLlxuICAgKi9cbiAgbmFtZT86IHN0cmluZ1xuICAvKipcbiAgICogVGV4dCBpbnB1dCB0byBiZSBhZGRlZCBhcyBhIGZpbGUgcmVzb3VyY2UuXG4gICAqL1xuICBjb250ZW50Pzogc3RyaW5nXG4gIC8qKlxuICAgKiBDb250cm9scyB3aGV0aGVyIGFjY2VzcyB0byB0aGUgZmlsZSByZXNvdXJjZSBpcyByZXN0cmljdGVkIHRvIHRoZSBvd25lciBvciBpbmhlcml0ZWQgZnJvbSB0aGUgc2hhcmluZyBwZXJtaXNzaW9ucyBzZXQgZm9yIHRoZSBhc3NvY2lhdGVkIGl0ZW0uXG4gICAqL1xuICBwcml2YXRlPzogYm9vbGVhblxuICAvKipcbiAgICogT2JqZWN0IHRvIHN0b3JlXG4gICAqL1xuICByZXNvdXJjZT86IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElDcmVhdGVVcGRhdGVJdGVtT3B0aW9ucyBleHRlbmRzIElVc2VyUmVxdWVzdE9wdGlvbnMge1xuICAvKipcbiAgICogVGhlIG93bmVyIG9mIHRoZSBpdGVtLiBJZiB0aGlzIHByb3BlcnR5IGlzIG5vdCBwcmVzZW50LCBgaXRlbS5vd25lcmAgd2lsbCBiZSBwYXNzZWQsIG9yIGxhc3RseSBgYXV0aGVudGljYXRpb24udXNlcm5hbWVgLlxuICAgKi9cbiAgb3duZXI/OiBzdHJpbmdcbiAgLyoqXG4gICAqIElkIG9mIHRoZSBmb2xkZXIgdG8gaG91c2UgdGhlIGl0ZW0uXG4gICAqL1xuICBmb2xkZXJJZD86IHN0cmluZ1xuICAvKipcbiAgICogVGhlIGZpbGUgdG8gYmUgdXBsb2FkZWQuIElmIHVwbG9hZGluZyBhIGZpbGUsIHRoZSByZXF1ZXN0IG11c3QgYmUgYSBtdWx0aXBhcnQgcmVxdWVzdC5cbiAgICovXG4gIGZpbGU/OiBhbnlcbiAgZGF0YVVybD86IHN0cmluZ1xuICAvKipcbiAgICogVGhlIHRleHQgY29udGVudCBmb3IgdGhlIGl0ZW0gdG8gYmUgc3VibWl0dGVkLlxuICAgKi9cbiAgdGV4dD86IHN0cmluZ1xuICAvKipcbiAgICogSWYgdHJ1ZSwgdGhlIGZpbGUgaXMgdXBsb2FkZWQgYXN5bmNocm9ub3VzbHkuIElmIGZhbHNlLCB0aGUgZmlsZSBpcyB1cGxvYWRlZCBzeW5jaHJvbm91c2x5LlxuICAgKi9cbiAgYXN5bmM/OiBib29sZWFuXG4gIC8qKlxuICAgKiBJZiB0cnVlLCB0aGUgZmlsZSBpcyB1cGxvYWRlZCBpbiBtdWx0aXBsZSBwYXJ0cy5cbiAgICovXG4gIG11bHRpcGFydD86IGJvb2xlYW5cbiAgLyoqXG4gICAqIFRoZSBmaWxlbmFtZSBiZWluZyB1cGxvYWRlZCBpbiBtdWx0aXBhcnQgbW9kZS4gUmVxdWlyZWQgaWYgbXVsdGlwYXJ0PXRydWUuXG4gICAqL1xuICBmaWxlbmFtZT86IHN0cmluZ1xuICAvKipcbiAgICogSWYgdHJ1ZSwgb3ZlcndyaXRlIHRoZSBleGlzdGluZyBmaWxlLlxuICAgKi9cbiAgb3ZlcndyaXRlPzogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElJdGVtRGF0YU9wdGlvbnMgZXh0ZW5kcyBJUmVxdWVzdE9wdGlvbnMge1xuICAvKipcbiAgICogVXNlZCB0byByZXF1ZXN0IGJpbmFyeSBkYXRhLlxuICAgKi9cbiAgZmlsZT86IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJSXRlbVBhcnRPcHRpb25zIGV4dGVuZHMgSVVzZXJJdGVtT3B0aW9ucyB7XG4gIC8qKlxuICAgKiBUaGUgZmlsZSBwYXJ0IHRvIGJlIHVwbG9hZGVkLlxuICAgKi9cbiAgZmlsZTogYW55XG4gIHBhcnROdW06IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElVcGRhdGVJdGVtUmVzcG9uc2Uge1xuICBzdWNjZXNzOiBib29sZWFuXG4gIGlkOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJSXRlbVJlc291cmNlUmVzcG9uc2Uge1xuICBzdWNjZXNzOiBib29sZWFuXG4gIGl0ZW1JZDogc3RyaW5nXG4gIG93bmVyOiBzdHJpbmdcbiAgZm9sZGVyOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQWRkRm9sZGVyUmVzcG9uc2Uge1xuICAvKipcbiAgICogU3VjY2VzcyBvciBmYWlsdXJlIG9mIHJlcXVlc3QuXG4gICAqL1xuICBzdWNjZXNzOiBib29sZWFuXG4gIC8qKlxuICAgKiBJbmZvcm1hdGlvbiBhYm91dCBjcmVhdGVkIGZvbGRlcjogaXRzIGFscGhhbnVtZXJpYyBpZCwgbmFtZSwgYW5kIG93bmVyJ3MgbmFtZS5cbiAgICovXG4gIGZvbGRlcjoge1xuICAgIGlkOiBzdHJpbmdcbiAgICB0aXRsZTogc3RyaW5nXG4gICAgdXNlcm5hbWU6IHN0cmluZ1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1vdmVJdGVtUmVzcG9uc2Uge1xuICAvKipcbiAgICogU3VjY2VzcyBvciBmYWlsdXJlIG9mIHJlcXVlc3QuXG4gICAqL1xuICBzdWNjZXNzOiBib29sZWFuXG4gIC8qKlxuICAgKiBBbHBoYW51bWVyaWMgaWQgb2YgbW92ZWQgaXRlbS5cbiAgICovXG4gIGl0ZW1JZDogc3RyaW5nXG4gIC8qKlxuICAgKiBOYW1lIG9mIG93bmVyIG9mIGl0ZW0uXG4gICAqL1xuICBvd25lcjogc3RyaW5nXG4gIC8qKlxuICAgKiBBbHBoYW51bWVyaWMgaWQgb2YgZm9sZGVyIG5vdyBob3VzaW5nIGl0ZW0uXG4gICAqL1xuICBmb2xkZXI6IHN0cmluZ1xufVxuXG4vKipcbiAqIFNlcmlhbGl6ZSBhbiBpdGVtIGFuZCBpdHMgZGF0YSBpbnRvIGEganNvbiBmb3JtYXQgYWNjZXB0ZWQgYnkgdGhlIFBvcnRhbCBBUEkgZm9yIGNyZWF0ZSBhbmQgdXBkYXRlIG9wZXJhdGlvbnNcbiAqXG4gKiBAcGFyYW0gaXRlbSBJdGVtIHRvIGJlIHNlcmlhbGl6ZWRcbiAqIEByZXR1cm5zIGEgZm9ybWF0dGVkIGpzb24gb2JqZWN0IHRvIGJlIHNlbnQgdG8gUG9ydGFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVJdGVtIChpdGVtOiBJSXRlbUFkZCB8IElJdGVtVXBkYXRlIHwgSUl0ZW0pOiBhbnkge1xuICAvLyBjcmVhdGUgYSBjbG9uZSBzbyB3ZSdyZSBub3QgbWVzc2luZyB3aXRoIHRoZSBvcmlnaW5hbFxuICBjb25zdCBjbG9uZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaXRlbSkpXG5cbiAgLy8gYmluYXJ5IGRhdGEgbmVlZHMgUE9TVGVkIGFzIGEgYGZpbGVgXG4gIC8vIEpTT04gb2JqZWN0IGxpdGVyYWxzIHNob3VsZCBiZSBwYXNzZWQgYXMgYHRleHRgLlxuICBpZiAoY2xvbmUuZGF0YSkge1xuICAgICh0eXBlb2YgQmxvYiAhPT0gJ3VuZGVmaW5lZCcgJiYgaXRlbS5kYXRhIGluc3RhbmNlb2YgQmxvYikgfHxcbiAgICAvLyBOb2RlLmpzIGRvZXNuJ3QgaW1wbGVtZW50IEJsb2JcbiAgICBpdGVtLmRhdGEuY29uc3RydWN0b3IubmFtZSA9PT0gJ1JlYWRTdHJlYW0nXG4gICAgICA/IChjbG9uZS5maWxlID0gaXRlbS5kYXRhKVxuICAgICAgOiAoY2xvbmUudGV4dCA9IGl0ZW0uZGF0YSlcbiAgICBkZWxldGUgY2xvbmUuZGF0YVxuICB9XG4gIHJldHVybiBjbG9uZVxufVxuXG4vKipcbiAqIHJlcXVlc3RPcHRpb25zLm93bmVyIGlzIGdpdmVuIHByaW9yaXR5LCByZXF1ZXN0T3B0aW9ucy5pdGVtLm93bmVyIHdpbGwgYmUgY2hlY2tlZCBuZXh0LiBJZiBuZWl0aGVyIGFyZSBwcmVzZW50LCBhdXRoZW50aWNhdGlvbi51c2VybmFtZSB3aWxsIGJlIGFzc3VtZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXRlcm1pbmVPd25lciAocmVxdWVzdE9wdGlvbnM6IGFueSk6IHN0cmluZyB7XG4gIGlmIChyZXF1ZXN0T3B0aW9ucy5vd25lcikge1xuICAgIHJldHVybiByZXF1ZXN0T3B0aW9ucy5vd25lclxuICB9XG4gIGlmIChyZXF1ZXN0T3B0aW9ucy5pdGVtICYmIHJlcXVlc3RPcHRpb25zLml0ZW0ub3duZXIpIHtcbiAgICByZXR1cm4gcmVxdWVzdE9wdGlvbnMuaXRlbS5vd25lclxuICB9IGVsc2Uge1xuICAgIHJldHVybiByZXF1ZXN0T3B0aW9ucy5hdXRoZW50aWNhdGlvbi51c2VybmFtZVxuICB9XG59XG4iLCJpbXBvcnQge1xuICB0eXBlIElVc2VySXRlbU9wdGlvbnMsIHR5cGUgSUl0ZW1SZXNvdXJjZU9wdGlvbnNcbn0gZnJvbSAnLi9oZWxwZXJzJ1xuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uL3JlcXVlc3QnXG5pbXBvcnQgeyBnZXRPcmlnaW5VcmwsIGdldFVzZXJDb250ZW50VXJsLCBnZXRVc2VyTmFtZSB9IGZyb20gJy4uL3V0aWwnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVJdGVtIChcbiAgcmVxdWVzdE9wdGlvbnM6IElVc2VySXRlbU9wdGlvbnNcbik6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuLCBpdGVtSWQ6IHN0cmluZyB9PiB7XG4gIGNvbnN0IHVzZXJOYW1lID0gZ2V0VXNlck5hbWUoKVxuICBjb25zdCBiYXNlVXJsID0gZ2V0T3JpZ2luVXJsKCk7XG4gIChyZXF1ZXN0T3B0aW9ucyBhcyBhbnkpLnVzZXJOYW1lID0gdXNlck5hbWVcblxuICBjb25zdCB1cmwgPSBgJHtiYXNlVXJsfSR7Z2V0VXNlckNvbnRlbnRVcmwoKX1pdGVtcy8ke1xuICAgIHJlcXVlc3RPcHRpb25zLmlkXG4gIH0vZGVsZXRlYFxuXG4gIHJldHVybiBhd2FpdCByZXF1ZXN0KHVybCwgcmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVJdGVtUmVzb3VyY2UgKFxuICByZXF1ZXN0T3B0aW9uczogSUl0ZW1SZXNvdXJjZU9wdGlvbnNcbik6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuIH0+IHtcbiAgY29uc3QgdXJsID0gYCR7Z2V0T3JpZ2luVXJsKCl9JHtnZXRVc2VyQ29udGVudFVybCgpfWl0ZW1zLyR7XG4gICAgcmVxdWVzdE9wdGlvbnMuaWRcbiAgfS9yZW1vdmVSZXNvdXJjZXNgXG5cbiAgLy8gbWl4IGluIHVzZXIgc3VwcGxpZWQgcGFyYW1zXG4gIHJlcXVlc3RPcHRpb25zLnBhcmFtcyA9IHtcbiAgICAuLi5yZXF1ZXN0T3B0aW9ucy5wYXJhbXMsXG4gICAgcmVzb3VyY2U6IHJlcXVlc3RPcHRpb25zLnJlc291cmNlXG4gIH1cbiAgcmV0dXJuIGF3YWl0IHJlcXVlc3QodXJsLCByZXF1ZXN0T3B0aW9ucylcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIHByZWZlci1jb25zdCAqL1xuaW1wb3J0IHsgZXNyaSB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHR5cGUgSVJlcXVlc3RPcHRpb25zIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtcmVxdWVzdCdcbmltcG9ydCB7IHR5cGUgSUl0ZW0sIHR5cGUgSUdyb3VwLCB0eXBlIElVc2VyIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnXG5pbXBvcnQgeyB0eXBlIElTZWFyY2hPcHRpb25zLCB0eXBlIFNlYXJjaFF1ZXJ5QnVpbGRlciwgdHlwZSBJU2VhcmNoUmVzdWx0IH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtcG9ydGFsJ1xuaW1wb3J0IHsgU2VhcmNoVHlwZSB9IGZyb20gJy4uLy4uL3R5cGUnXG5pbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAnLi4vaW5kZXgnXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoSXRlbXMgKFxuICBzZWFyY2g6IHN0cmluZyB8IElTZWFyY2hPcHRpb25zIHwgU2VhcmNoUXVlcnlCdWlsZGVyLFxuICBzZWFyY2hUeXBlID0gU2VhcmNoVHlwZS5PdGhlclxuKTogUHJvbWlzZTxJU2VhcmNoUmVzdWx0PElJdGVtPj4ge1xuICByZXR1cm4gYXdhaXQgZ2VuZXJpY1NlYXJjaDxJSXRlbT4oc2VhcmNoLCAnaXRlbScsIHNlYXJjaFR5cGUpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyaWNTZWFyY2g8VCBleHRlbmRzIElJdGVtIHwgSUdyb3VwIHwgSVVzZXI+IChcbiAgc2VhcmNoOiBzdHJpbmcgfCBJU2VhcmNoT3B0aW9ucyB8IFNlYXJjaFF1ZXJ5QnVpbGRlcixcbiAgc2VhcmNoUmVxdWVzdFR5cGU6ICdpdGVtJyB8ICdncm91cCcgfCAndXNlcicsXG4gIHNlYXJjaFR5cGUgPSBTZWFyY2hUeXBlLk90aGVyXG4pOiBQcm9taXNlPElTZWFyY2hSZXN1bHQ8YW55Pj4ge1xuICBsZXQgdXJsOiBzdHJpbmdcbiAgbGV0IG9wdGlvbnM6IElSZXF1ZXN0T3B0aW9uc1xuICBjb25zdCBvcmlnaW5VcmwgPSBzZWFyY2hUeXBlID09PSBTZWFyY2hUeXBlLkFHT0wgPyAnaHR0cHM6Ly93d3cuYXJjZ2lzLmNvbScgOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luXG4gIHVybCA9IGAke29yaWdpblVybH0vc2hhcmluZy9yZXN0L3NlYXJjaGBcbiAgaWYgKHR5cGVvZiBzZWFyY2ggPT09ICdzdHJpbmcnIHx8IHNlYXJjaCBpbnN0YW5jZW9mIGVzcmkucmVzdFBvcnRhbC5TZWFyY2hRdWVyeUJ1aWxkZXIpIHtcbiAgICBvcHRpb25zID0ge1xuICAgICAgcGFyYW1zOiB7XG4gICAgICAgIHE6IHNlYXJjaFxuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBvcHRpb25zID0gZXNyaS5yZXN0UmVxdWVzdC5hcHBlbmRDdXN0b21QYXJhbXM8SVNlYXJjaE9wdGlvbnM+KFxuICAgICAgeyAuLi5zZWFyY2gsIGY6ICdqc29uJyB9LFxuICAgICAgWydxJywgJ251bScsICdzdGFydCcsICdzb3J0RmllbGQnLCAnc29ydE9yZGVyJywgJ3BvcnRhbFVybCcsICdmJ11cbiAgICApXG4gIH1cblxuICAvLyBzZW5kIHRoZSByZXF1ZXN0XG4gIHJldHVybiByZXF1ZXN0KHVybCwgb3B0aW9ucywgJ0dFVCcpLnRoZW4ociA9PiB7XG4gICAgaWYgKHIubmV4dFN0YXJ0ICYmIHIubmV4dFN0YXJ0ICE9PSAtMSkge1xuICAgICAgci5uZXh0UGFnZSA9IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IG5ld09wdGlvbnM6IElTZWFyY2hPcHRpb25zXG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIHR5cGVvZiBzZWFyY2ggPT09ICdzdHJpbmcnIHx8XG4gICAgICAgICAgc2VhcmNoIGluc3RhbmNlb2YgZXNyaS5yZXN0UG9ydGFsLlNlYXJjaFF1ZXJ5QnVpbGRlclxuICAgICAgICApIHtcbiAgICAgICAgICBuZXdPcHRpb25zID0ge1xuICAgICAgICAgICAgcTogc2VhcmNoLFxuICAgICAgICAgICAgc3RhcnQ6IHIubmV4dFN0YXJ0XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld09wdGlvbnMgPSBzZWFyY2hcbiAgICAgICAgICBuZXdPcHRpb25zLnN0YXJ0ID0gci5uZXh0U3RhcnRcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhd2FpdCBnZW5lcmljU2VhcmNoPFQ+KG5ld09wdGlvbnMsIHNlYXJjaFJlcXVlc3RUeXBlKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hJdGVtc0J5UG9ydGFsVXJsIChcbiAgc2VhcmNoOiBzdHJpbmcgfCBJU2VhcmNoT3B0aW9ucyB8IFNlYXJjaFF1ZXJ5QnVpbGRlcixcbiAgcG9ydGFsVXJsOiBzdHJpbmdcbik6IFByb21pc2U8SVNlYXJjaFJlc3VsdDxJSXRlbT4+IHtcbiAgcmV0dXJuIGF3YWl0IGdlbmVyaWNTZWFyY2hCeVBvcnRhbFVybDxJSXRlbT4oc2VhcmNoLCBwb3J0YWxVcmwpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyaWNTZWFyY2hCeVBvcnRhbFVybDxUIGV4dGVuZHMgSUl0ZW0gfCBJR3JvdXAgfCBJVXNlcj4gKFxuICBzZWFyY2g6IHN0cmluZyB8IElTZWFyY2hPcHRpb25zIHwgU2VhcmNoUXVlcnlCdWlsZGVyLFxuICBwb3J0YWxVcmw6IHN0cmluZ1xuKTogUHJvbWlzZTxJU2VhcmNoUmVzdWx0PGFueT4+IHtcbiAgbGV0IHVybDogc3RyaW5nXG4gIGxldCBvcHRpb25zOiBJUmVxdWVzdE9wdGlvbnNcbiAgaWYgKCF1cmwpIFByb21pc2UucmVzb2x2ZShudWxsKVxuICB1cmwgPSBgJHtwb3J0YWxVcmx9L3NoYXJpbmcvcmVzdC9zZWFyY2hgXG4gIGlmICh0eXBlb2Ygc2VhcmNoID09PSAnc3RyaW5nJyB8fCBzZWFyY2ggaW5zdGFuY2VvZiBlc3JpLnJlc3RQb3J0YWwuU2VhcmNoUXVlcnlCdWlsZGVyKSB7XG4gICAgb3B0aW9ucyA9IHtcbiAgICAgIHBhcmFtczoge1xuICAgICAgICBxOiBzZWFyY2hcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgb3B0aW9ucyA9IGVzcmkucmVzdFJlcXVlc3QuYXBwZW5kQ3VzdG9tUGFyYW1zPElTZWFyY2hPcHRpb25zPihcbiAgICAgIHsgLi4uc2VhcmNoLCBmOiAnanNvbicgfSxcbiAgICAgIFsncScsICdudW0nLCAnc3RhcnQnLCAnc29ydEZpZWxkJywgJ3NvcnRPcmRlcicsICdwb3J0YWxVcmwnLCAnZiddXG4gICAgKVxuICB9XG5cbiAgLy8gc2VuZCB0aGUgcmVxdWVzdFxuICByZXR1cm4gcmVxdWVzdCh1cmwsIG9wdGlvbnMsICdHRVQnKS50aGVuKHIgPT4ge1xuICAgIGlmIChyLm5leHRTdGFydCAmJiByLm5leHRTdGFydCAhPT0gLTEpIHtcbiAgICAgIHIubmV4dFBhZ2UgPSBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBuZXdPcHRpb25zOiBJU2VhcmNoT3B0aW9uc1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICB0eXBlb2Ygc2VhcmNoID09PSAnc3RyaW5nJyB8fFxuICAgICAgICAgIHNlYXJjaCBpbnN0YW5jZW9mIGVzcmkucmVzdFBvcnRhbC5TZWFyY2hRdWVyeUJ1aWxkZXJcbiAgICAgICAgKSB7XG4gICAgICAgICAgbmV3T3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHE6IHNlYXJjaCxcbiAgICAgICAgICAgIHN0YXJ0OiByLm5leHRTdGFydFxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdPcHRpb25zID0gc2VhcmNoXG4gICAgICAgICAgbmV3T3B0aW9ucy5zdGFydCA9IHIubmV4dFN0YXJ0XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXdhaXQgZ2VuZXJpY1NlYXJjaEJ5UG9ydGFsVXJsPFQ+KG5ld09wdGlvbnMsICdpdGVtJylcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gclxuICB9KVxufVxuIiwiaW1wb3J0IHsgdHlwZSBJVXBkYXRlSXRlbU9wdGlvbnMsIHR5cGUgSVVwZGF0ZUl0ZW1SZXNwb25zZSwgdHlwZSBJSXRlbVJlc291cmNlT3B0aW9ucywgdHlwZSBJSXRlbVJlc291cmNlUmVzcG9uc2UgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1wb3J0YWwnXG5pbXBvcnQgeyBzZXJpYWxpemVJdGVtIH0gZnJvbSAnLi9oZWxwZXJzJ1xuaW1wb3J0IHsgcmVxdWVzdCB9IGZyb20gJy4uL3JlcXVlc3QnXG5pbXBvcnQgeyBnZXRPcmlnaW5VcmwsIGdldFVzZXJDb250ZW50VXJsLCBnZXRVc2VyTmFtZSB9IGZyb20gJy4uL3V0aWwnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJdGVtIChcbiAgcmVxdWVzdE9wdGlvbnM6IElVcGRhdGVJdGVtT3B0aW9uc1xuKTogUHJvbWlzZTxJVXBkYXRlSXRlbVJlc3BvbnNlPiB7XG4gIGNvbnN0IHVzZXJOYW1lID0gZ2V0VXNlck5hbWUoKVxuICBjb25zdCBiYXNlVXJsID0gZ2V0T3JpZ2luVXJsKCk7XG4gIChyZXF1ZXN0T3B0aW9ucyBhcyBhbnkpLnVzZXJOYW1lID0gdXNlck5hbWVcblxuICBjb25zdCB1cmwgPSBgJHtiYXNlVXJsfSR7Z2V0VXNlckNvbnRlbnRVcmwoKX1pdGVtcy8ke1xuICAgIHJlcXVlc3RPcHRpb25zLml0ZW0uaWRcbiAgfS91cGRhdGVgXG5cbiAgLy8gc2VyaWFsaXplIHRoZSBpdGVtIGludG8gc29tZXRoaW5nIFBvcnRhbCB3aWxsIGFjY2VwdFxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgLi4ucmVxdWVzdE9wdGlvbnMucGFyYW1zLFxuICAgIC4uLnNlcmlhbGl6ZUl0ZW0ocmVxdWVzdE9wdGlvbnMuaXRlbSlcbiAgfVxuXG4gIGlmIChyZXF1ZXN0T3B0aW9ucy5pdGVtLnRodW1ibmFpbCAmJiB0eXBlb2YgKHJlcXVlc3RPcHRpb25zLml0ZW0udGh1bWJuYWlsKSAhPT0gJ3N0cmluZycpIHtcbiAgICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgICAuLi5yZXF1ZXN0T3B0aW9ucy5wYXJhbXMsXG4gICAgICAuLi5yZXF1ZXN0T3B0aW9ucy5pdGVtXG4gICAgfVxuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhyZXF1ZXN0T3B0aW9ucy5wYXJhbXMpXG4gICAgY29uc3QgZGF0YTogRm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgZGF0YS5hcHBlbmQoa2V5c1tpXSwgcmVxdWVzdE9wdGlvbnMucGFyYW1zW2tleXNbaV1dKVxuICAgIH1cbiAgICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSBkYXRhXG4gIH1cblxuICByZXR1cm4gYXdhaXQgcmVxdWVzdCh1cmwsIHJlcXVlc3RPcHRpb25zKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSXRlbVJlc291cmNlIChcbiAgcmVxdWVzdE9wdGlvbnM6IElJdGVtUmVzb3VyY2VPcHRpb25zXG4pOiBQcm9taXNlPElJdGVtUmVzb3VyY2VSZXNwb25zZT4ge1xuICBjb25zdCB1cmwgPSBgJHtnZXRPcmlnaW5VcmwoKX0ke2dldFVzZXJDb250ZW50VXJsKCl9aXRlbXMvJHtyZXF1ZXN0T3B0aW9ucy5pZH0vdXBkYXRlUmVzb3VyY2VzYFxuXG4gIC8vIG1peCBpbiB1c2VyIHN1cHBsaWVkIHBhcmFtc1xuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSB7XG4gICAgZmlsZU5hbWU6IHJlcXVlc3RPcHRpb25zLm5hbWUsXG4gICAgdGV4dDogcmVxdWVzdE9wdGlvbnMuY29udGVudCxcbiAgICAuLi5yZXF1ZXN0T3B0aW9ucy5wYXJhbXMsXG4gICAgZmlsZTogcmVxdWVzdE9wdGlvbnMucmVzb3VyY2VcbiAgfVxuXG4gIGRlbGV0ZSByZXF1ZXN0T3B0aW9ucy5wYXJhbXMuZmlsZVxuICByZXF1ZXN0T3B0aW9ucy5wYXJhbXMuZmlsZSA9IHJlcXVlc3RPcHRpb25zLnJlc291cmNlXG5cbiAgLy8gb25seSBvdmVycmlkZSB0aGUgYWNjZXNzIHNwZWNpZmllZCBwcmV2aW91c2x5IGlmICdwcml2YXRlJyBpcyBwYXNzZWQgZXhwbGljaXRseVxuICBpZiAodHlwZW9mIHJlcXVlc3RPcHRpb25zLnByaXZhdGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmVxdWVzdE9wdGlvbnMucGFyYW1zLmFjY2VzcyA9IHJlcXVlc3RPcHRpb25zLnByaXZhdGVcbiAgICAgID8gJ3ByaXZhdGUnXG4gICAgICA6ICdpbmhlcml0J1xuICB9XG5cbiAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHJlcXVlc3RPcHRpb25zLnBhcmFtcylcbiAgY29uc3QgZGF0YTogRm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICBkYXRhLmFwcGVuZChrZXlzW2ldLCByZXF1ZXN0T3B0aW9ucy5wYXJhbXNba2V5c1tpXV0pXG4gIH1cbiAgcmVxdWVzdE9wdGlvbnMucGFyYW1zID0gZGF0YVxuXG4gIHJldHVybiBhd2FpdCByZXF1ZXN0KHVybCwgcmVxdWVzdE9wdGlvbnMpXG59XG4iLCJpbXBvcnQge1xuICB0eXBlIElSZXF1ZXN0T3B0aW9uc1xufSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1yZXF1ZXN0J1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWVzdCAoXG4gIHVybDogc3RyaW5nLFxuICByZXF1ZXN0T3B0aW9uczogSVJlcXVlc3RPcHRpb25zID0geyBwYXJhbXM6IHsgZjogJ2pzb24nIH0gfSxcbiAgcmVxdWVzdFR5cGU6ICdHRVQnIHwgJ1BPU1QnID0gJ1BPU1QnXG4pOiBQcm9taXNlPGFueT4ge1xuICBpZiAocmVxdWVzdFR5cGUgPT09ICdHRVQnKSB7XG4gICAgY29uc3QgcmVxdWVzdFVybCA9IHVybCArIGVuY29kZVF1ZXJ5U3RyaW5nKHJlcXVlc3RPcHRpb25zLnBhcmFtcylcbiAgICByZXR1cm4gYXdhaXQgZmV0Y2gocmVxdWVzdFVybCwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfVxuICAgIH0pLnRoZW4oYXN5bmMgKHJlc3BvbnNlKSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgfSkudGhlbihhc3luYyBkYXRhID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgICB9KVxuICB9XG5cbiAgaWYgKHJlcXVlc3RUeXBlID09PSAnUE9TVCcpIHtcbiAgICBpZiAocmVxdWVzdE9wdGlvbnMucGFyYW1zICYmIHJlcXVlc3RPcHRpb25zLnBhcmFtcy5jb25zdHJ1Y3Rvci5uYW1lID09PSAnRm9ybURhdGEnKSB7XG4gICAgICByZXR1cm4gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgYXMgRm9ybURhdGFcbiAgICAgIH0pLnRoZW4oYXN5bmMgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgIH0pLnRoZW4oYXN5bmMgZGF0YSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RPcHRpb25zLnBhcmFtcylcbiAgICAgIH0pLnRoZW4oYXN5bmMgKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgIH0pLnRoZW4oYXN5bmMgZGF0YSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVqZWN0KG51bGwpXG59XG5cbmZ1bmN0aW9uIGVuY29kZVF1ZXJ5U3RyaW5nIChwYXJhbXMpIHtcbiAgaWYgKCFwYXJhbXMpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhwYXJhbXMpXG4gIHJldHVybiBrZXlzLmxlbmd0aFxuICAgID8gJz8nICsga2V5c1xuICAgICAgLm1hcChrZXkgPT4gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgK1xuICAgICAgICAgICAgICAnPScgKyBlbmNvZGVVUklDb21wb25lbnQocGFyYW1zW2tleV0pKVxuICAgICAgLmpvaW4oJyYnKVxuICAgIDogJydcbn1cbiIsImltcG9ydCB7IGdldEFwcFN0b3JlLCB1cmxVdGlscywgZXNyaSB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IHJlcXVlc3QgfSBmcm9tICcuL2luZGV4J1xuXG5jb25zdCByZXN0UmVxdWVzdCA9IGVzcmkucmVzdFJlcXVlc3QucmVxdWVzdFxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3JpZ2luVXJsIChpc0FyY0dpc09ubGluZVJlcXVlc3QgPSBmYWxzZSkge1xuICBpZiAoaXNBcmNHaXNPbmxpbmVSZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHVybFV0aWxzLmdldEFyY2dpc09ubGluZVVybCgpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW5cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlckNvbnRlbnRVcmwgKGlzTm90Q29udGFpblVzZXJzID0gZmFsc2UpIHtcbiAgaWYgKGlzTm90Q29udGFpblVzZXJzKSB7XG4gICAgcmV0dXJuICcvc2hhcmluZy9yZXN0L2NvbnRlbnQvJ1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAnL3NoYXJpbmcvcmVzdC9jb250ZW50L3VzZXJzLydcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlck5hbWUgKCkge1xuICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnVzZXI/LnVzZXJuYW1lXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZXF1ZXN0TWV0aG9kIChpc0FyY0dpc09ubGluZVJlcXVlc3QgPSBmYWxzZSkge1xuICByZXR1cm4gaXNBcmNHaXNPbmxpbmVSZXF1ZXN0ID8gcmVzdFJlcXVlc3QgOiByZXF1ZXN0XG59XG4iLCJpbXBvcnQgeyBlc3JpLCBnZXRBcHBTdG9yZSwgcG9ydGFsVXJsVXRpbHMsIHVybFV0aWxzIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBJUmVxdWVzdE9wdGlvbnMsIHR5cGUgSVBhcmFtcyB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXJlcXVlc3QnXG5pbXBvcnQge1xuICB0eXBlIElTZWFyY2hPcHRpb25zLFxuICB0eXBlIFNlYXJjaFF1ZXJ5QnVpbGRlcixcbiAgdHlwZSBJU2VhcmNoUmVzdWx0LFxuICB0eXBlIElVc2VySXRlbU9wdGlvbnMsXG4gIHR5cGUgSVVwZGF0ZUl0ZW1PcHRpb25zLFxuICB0eXBlIElVcGRhdGVJdGVtUmVzcG9uc2UsXG4gIHR5cGUgSUNyZWF0ZUl0ZW1PcHRpb25zLFxuICB0eXBlIElDcmVhdGVJdGVtUmVzcG9uc2UsXG4gIHR5cGUgSUl0ZW1EYXRhT3B0aW9ucyxcbiAgdHlwZSBJSXRlbVJlc291cmNlT3B0aW9ucyxcbiAgdHlwZSBJSXRlbVJlc291cmNlUmVzcG9uc2UsXG4gIHR5cGUgSVNoYXJpbmdSZXNwb25zZSxcbiAgdHlwZSBJTW92ZUl0ZW1PcHRpb25zLFxuICB0eXBlIElNb3ZlSXRlbVJlc3BvbnNlLFxuICB0eXBlIElHZXRVc2VyT3B0aW9ucyxcbiAgdHlwZSBJR2V0VXNlclRhZ3NSZXNwb25zZSxcbiAgdHlwZSBJR2V0SXRlbVJlc291cmNlT3B0aW9ucyxcbiAgdHlwZSBJR3JvdXBcbn0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtcG9ydGFsJ1xuaW1wb3J0ICogYXMgbG9jYWxSZXN0U2VydmljZSBmcm9tICcuL2xvY2FsLXJlc3Qtc2VydmljZSdcbmltcG9ydCAqIGFzIGppbXVSZXF1ZXN0IGZyb20gJy4vamltdS1yZXF1ZXN0J1xuaW1wb3J0IHsgaXNBR09MQXBwLCBpc1BvcnRhbEFwcCB9IGZyb20gJy4vYXBwLXNlcnZpY2UvdXRpbCdcbmltcG9ydCB7IHR5cGUgQXBwSW5mbywgU2VhcmNoVHlwZSwgdHlwZSBJbXBvcnRBcHBPcHRpb24gfSBmcm9tICcuL3R5cGUnXG5jb25zdCB7IGltcG9ydEl0ZW0sIGNoZWNrSXRlbVZlcnNpb24gfSA9IGxvY2FsUmVzdFNlcnZpY2VcblxuZnVuY3Rpb24gcmVxdWVzdE1ldGhvZFByb3ZpZGVyIChcbiAgcmVzdFBvcnRhbFJlcXVlc3ROYW1lOiBzdHJpbmcsXG4gIGFwcEluZm8/OiBBcHBJbmZvLFxuICBsb2NhbFJlcXVlc3ROYW1lPzogc3RyaW5nXG4pIHtcbiAgY29uc3QgbG9jYWxSZXF1ZXN0TWV0aG9kID0gbG9jYWxSZXF1ZXN0TmFtZSA/IGxvY2FsUmVzdFNlcnZpY2VbbG9jYWxSZXF1ZXN0TmFtZV0gOiBsb2NhbFJlc3RTZXJ2aWNlW3Jlc3RQb3J0YWxSZXF1ZXN0TmFtZV1cbiAgY29uc3QgcmVzdFBvcnRhbFJlcXVlc3RNZXRob2QgPSBlc3JpLnJlc3RQb3J0YWxbcmVzdFBvcnRhbFJlcXVlc3ROYW1lXVxuICBpZiAoIWFwcEluZm8pIHtcbiAgICBpZiAod2luZG93LmppbXVDb25maWcuaXNEZXZFZGl0aW9uKSB7XG4gICAgICByZXR1cm4gbG9jYWxSZXF1ZXN0TWV0aG9kXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXN0UG9ydGFsUmVxdWVzdE1ldGhvZFxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoaXNQb3J0YWxBcHAoYXBwSW5mbykpIHtcbiAgICAgIHJldHVybiByZXN0UG9ydGFsUmVxdWVzdE1ldGhvZFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbG9jYWxSZXF1ZXN0TWV0aG9kXG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHNlYXJjaE1ldGhvZFByb3ZpZGVyIChcbiAgc2VhcmNoVHlwZTogU2VhcmNoVHlwZVxuKSB7XG4gIGxldCBtZXRob2RcbiAgY29uc3QgcG9ydGFsVXJsID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBjb25zdCBpc0FHT0xEb21haW4gPSBwb3J0YWxVcmxVdGlscy5pc0FHT0xEb21haW4ocG9ydGFsVXJsKVxuICBzd2l0Y2ggKHNlYXJjaFR5cGUpIHtcbiAgICBjYXNlIFNlYXJjaFR5cGUuUG9ydGFsOlxuICAgICAgbWV0aG9kID0gZXNyaS5yZXN0UG9ydGFsLnNlYXJjaEl0ZW1zXG4gICAgICBicmVha1xuICAgIGNhc2UgU2VhcmNoVHlwZS5BR09MOlxuICAgICAgbWV0aG9kID0gaXNBR09MRG9tYWluID8gZXNyaS5yZXN0UG9ydGFsLnNlYXJjaEl0ZW1zIDogbG9jYWxSZXN0U2VydmljZS5zZWFyY2hJdGVtc1xuICAgICAgYnJlYWtcbiAgICBjYXNlIFNlYXJjaFR5cGUuT3RoZXI6XG4gICAgICBtZXRob2QgPSB3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24gPyBsb2NhbFJlc3RTZXJ2aWNlLnNlYXJjaEl0ZW1zIDogZXNyaS5yZXN0UG9ydGFsLnNlYXJjaEl0ZW1zXG4gICAgICBicmVha1xuICB9XG4gIHJldHVybiBtZXRob2Rcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaEl0ZW1zIChcbiAgc2VhcmNoOiBzdHJpbmcgfCBJU2VhcmNoT3B0aW9ucyB8IFNlYXJjaFF1ZXJ5QnVpbGRlcixcbiAgc2VhcmNoVHlwZTogU2VhcmNoVHlwZVxuKTogUHJvbWlzZTxJU2VhcmNoUmVzdWx0PEFwcEluZm8+PiB7XG4gIHJldHVybiBzZWFyY2hNZXRob2RQcm92aWRlcihzZWFyY2hUeXBlKShzZWFyY2gsIHNlYXJjaFR5cGUpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hJdGVtc0J5UG9ydGFsVXJsIChcbiAgc2VhcmNoOiBzdHJpbmcgfCBJU2VhcmNoT3B0aW9ucyB8IFNlYXJjaFF1ZXJ5QnVpbGRlcixcbiAgcG9ydGFsVXJsOiBzdHJpbmdcbik6IFByb21pc2U8SVNlYXJjaFJlc3VsdDxBcHBJbmZvPj4ge1xuICByZXR1cm4gbG9jYWxSZXN0U2VydmljZS5zZWFyY2hJdGVtc0J5UG9ydGFsVXJsKHNlYXJjaCwgcG9ydGFsVXJsKSBhcyBhbnlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUl0ZW0gKFxuICByZXF1ZXN0T3B0aW9uczogSVVzZXJJdGVtT3B0aW9uc1xuKTogUHJvbWlzZTx7XG4gICAgc3VjY2VzczogYm9vbGVhblxuICAgIGl0ZW1JZDogc3RyaW5nXG4gIH0+IHtcbiAgcmV0dXJuIHJlcXVlc3RNZXRob2RQcm92aWRlcigncmVtb3ZlSXRlbScpKHJlcXVlc3RPcHRpb25zKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlSXRlbSAoXG4gIHJlcXVlc3RPcHRpb25zOiBJVXBkYXRlSXRlbU9wdGlvbnNcbik6IFByb21pc2U8SVVwZGF0ZUl0ZW1SZXNwb25zZT4ge1xuICByZXR1cm4gcmVxdWVzdE1ldGhvZFByb3ZpZGVyKCd1cGRhdGVJdGVtJykocmVxdWVzdE9wdGlvbnMpXG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW1wb3J0QXBwIChcbiAgaXRlbTogSW1wb3J0QXBwT3B0aW9uLFxuICByZXF1ZXN0T3B0aW9ucz86IElJdGVtRGF0YU9wdGlvbnNcbik6IFByb21pc2U8SVVwZGF0ZUl0ZW1SZXNwb25zZT4ge1xuICByZXR1cm4gaW1wb3J0SXRlbShpdGVtLCByZXF1ZXN0T3B0aW9ucylcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrQXBwVmVyc2lvbiAoXG4gIGl0ZW06IEltcG9ydEFwcE9wdGlvbixcbiAgcmVxdWVzdE9wdGlvbnM/OiBJSXRlbURhdGFPcHRpb25zXG4pOiBQcm9taXNlPElVcGRhdGVJdGVtUmVzcG9uc2U+IHtcbiAgcmV0dXJuIGNoZWNrSXRlbVZlcnNpb24oaXRlbSwgcmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBcHBzVGh1bWJuYWlsIChcbiAgcmVxdWVzdE9wdGlvbnM6IElVcGRhdGVJdGVtT3B0aW9uc1xuKTogUHJvbWlzZTxJVXBkYXRlSXRlbVJlc3BvbnNlPiB7XG4gIGlmICh3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24pIHtcbiAgICByZXR1cm4gYXdhaXQgbG9jYWxSZXN0U2VydmljZS51cGRhdGVJdGVtKHJlcXVlc3RPcHRpb25zKVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBhd2FpdCBqaW11UmVxdWVzdC51cGRhdGVJdGVtKHJlcXVlc3RPcHRpb25zKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJdGVtIChcbiAgcmVxdWVzdE9wdGlvbnM6IElDcmVhdGVJdGVtT3B0aW9uc1xuKTogUHJvbWlzZTxJQ3JlYXRlSXRlbVJlc3BvbnNlPiB7XG4gIHJldHVybiByZXF1ZXN0TWV0aG9kUHJvdmlkZXIoJ2NyZWF0ZUl0ZW0nKShyZXF1ZXN0T3B0aW9ucylcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEl0ZW0gKFxuICBhcHBJbmZvOiBBcHBJbmZvLFxuICByZXF1ZXN0T3B0aW9ucz86IElSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxBcHBJbmZvPiB7XG4gIHJldHVybiByZXF1ZXN0TWV0aG9kUHJvdmlkZXIoXG4gICAgJ2dldEl0ZW0nLFxuICAgIGFwcEluZm9cbiAgKShhcHBJbmZvLmlkLCByZXF1ZXN0T3B0aW9ucywgaXNBR09MQXBwKGFwcEluZm8pKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SXRlbURhdGEgKFxuICBhcHBJbmZvOiBBcHBJbmZvLFxuICByZXF1ZXN0T3B0aW9ucz86IElJdGVtRGF0YU9wdGlvbnNcbik6IFByb21pc2U8YW55PiB7XG4gIHJldHVybiByZXF1ZXN0TWV0aG9kUHJvdmlkZXIoXG4gICAgJ2dldEl0ZW1EYXRhJyxcbiAgICBhcHBJbmZvXG4gICkoYXBwSW5mby5pZCwgcmVxdWVzdE9wdGlvbnMsIGlzQUdPTEFwcChhcHBJbmZvKSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEl0ZW1SZXNvdXJjZXMgKFxuICBhcHBJbmZvOiBBcHBJbmZvLFxuICByZXF1ZXN0T3B0aW9ucz86IElSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIHJlcXVlc3RNZXRob2RQcm92aWRlcihcbiAgICAnZ2V0SXRlbVJlc291cmNlcycsXG4gICAgYXBwSW5mb1xuICApKGFwcEluZm8uaWQsIHJlcXVlc3RPcHRpb25zLCBpc0FHT0xBcHAoYXBwSW5mbykpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcmdDYXRlZ29yeVNjaGVtYSAoXG4gIHJlcXVlc3RPcHRpb25zPzogSVJlcXVlc3RPcHRpb25zLFxuICBpc0dldEFHT0xDYXRlZ29yeVNjaGVtYT86IGJvb2xlYW5cbik6IFByb21pc2U8YW55PiB7XG4gIHJldHVybiBhd2FpdCBqaW11UmVxdWVzdC5nZXRPcmdDYXRlZ29yeVNjaGVtYShyZXF1ZXN0T3B0aW9ucywgaXNHZXRBR09MQ2F0ZWdvcnlTY2hlbWEpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHcm91cENhdGVnb3J5U2NoZW1hIChcbiAgZ3JvdXBJZDogc3RyaW5nLFxuICByZXF1ZXN0T3B0aW9ucz86IElSZXF1ZXN0T3B0aW9ucyxcbiAgaXNHZXRBR09MQ2F0ZWdvcnlTY2hlbWE/OiBib29sZWFuXG4pOiBQcm9taXNlPGFueT4ge1xuICByZXR1cm4gYXdhaXQgamltdVJlcXVlc3QuZ2V0R3JvdXBDYXRlZ29yeVNjaGVtYShncm91cElkLCByZXF1ZXN0T3B0aW9ucywgaXNHZXRBR09MQ2F0ZWdvcnlTY2hlbWEpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHcm91cENvbnRlbnRzIChcbiAgZ3JvdXBJZDogc3RyaW5nLFxuICByZXF1ZXN0T3B0aW9ucz86IElSZXF1ZXN0T3B0aW9ucyxcbiAgaXNHZXRBR09MR3JvdXBDb250ZW50PzogYm9vbGVhblxuKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIGF3YWl0IGppbXVSZXF1ZXN0LmdldEdyb3VwQ29udGVudChncm91cElkLCByZXF1ZXN0T3B0aW9ucywgaXNHZXRBR09MR3JvdXBDb250ZW50KVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SXRlbVJlc291cmNlIChcbiAgYXBwSW5mbzogQXBwSW5mbyxcbiAgcmVxdWVzdE9wdGlvbnM/OiBJR2V0SXRlbVJlc291cmNlT3B0aW9uc1xuKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIHJlcXVlc3RNZXRob2RQcm92aWRlcihcbiAgICAnZ2V0SXRlbVJlc291cmNlJyxcbiAgICBhcHBJbmZvXG4gICkoYXBwSW5mby5pZCwgcmVxdWVzdE9wdGlvbnMsIGlzQUdPTEFwcChhcHBJbmZvKSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZEl0ZW1SZXNvdXJjZSAoXG4gIHJlcXVlc3RPcHRpb25zOiBJSXRlbVJlc291cmNlT3B0aW9uc1xuKTogUHJvbWlzZTxJSXRlbVJlc291cmNlUmVzcG9uc2U+IHtcbiAgcmV0dXJuIHJlcXVlc3RNZXRob2RQcm92aWRlcignYWRkSXRlbVJlc291cmNlJykocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJdGVtUmVzb3VyY2UgKFxuICByZXF1ZXN0T3B0aW9uczogSUl0ZW1SZXNvdXJjZU9wdGlvbnNcbik6IFByb21pc2U8SUl0ZW1SZXNvdXJjZVJlc3BvbnNlPiB7XG4gIHJldHVybiByZXF1ZXN0TWV0aG9kUHJvdmlkZXIoJ3VwZGF0ZUl0ZW1SZXNvdXJjZScpKHJlcXVlc3RPcHRpb25zKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2hhcmVJdGVtV2l0aEdyb3VwIChcbiAgcmVxdWVzdE9wdGlvbnM6IElQYXJhbXNcbik6IFByb21pc2U8SVNoYXJpbmdSZXNwb25zZT4ge1xuICAvLyByZXR1cm4gZXNyaS5yZXN0UG9ydGFsLnNoYXJlSXRlbVdpdGhHcm91cChyZXF1ZXN0T3B0aW9ucylcbiAgcmV0dXJuIGF3YWl0IGppbXVSZXF1ZXN0LnNoYXJlSXRlbXMocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bnNoYXJlSXRlbVdpdGhHcm91cCAoXG4gIHJlcXVlc3RPcHRpb25zOiBJUGFyYW1zXG4pOiBQcm9taXNlPElTaGFyaW5nUmVzcG9uc2U+IHtcbiAgLy8gcmV0dXJuIGVzcmkucmVzdFBvcnRhbC51bnNoYXJlSXRlbVdpdGhHcm91cChyZXF1ZXN0T3B0aW9ucylcbiAgcmV0dXJuIGF3YWl0IGppbXVSZXF1ZXN0LnVuU2hhcmVJdGVtcyhyZXF1ZXN0T3B0aW9ucylcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGl0ZW1zZ3JvdXBzIChcbiAgcmVxdWVzdE9wdGlvbnM6IElQYXJhbXNcbik6IFByb21pc2U8SVNoYXJpbmdSZXNwb25zZT4ge1xuICAvLyByZXR1cm4gZXNyaS5yZXN0UG9ydGFsLnVuc2hhcmVJdGVtV2l0aEdyb3VwKHJlcXVlc3RPcHRpb25zKVxuICByZXR1cm4gYXdhaXQgamltdVJlcXVlc3QuaXRlbXNncm91cHMocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVJdGVtUmVzb3VyY2UgKFxuICByZXF1ZXN0T3B0aW9uczogSUl0ZW1SZXNvdXJjZU9wdGlvbnNcbik6IFByb21pc2U8e1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgfT4ge1xuICByZXR1cm4gcmVxdWVzdE1ldGhvZFByb3ZpZGVyKCdyZW1vdmVJdGVtUmVzb3VyY2UnKShyZXF1ZXN0T3B0aW9ucylcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEl0ZW1zR3JvdXBzIChcbiAgcmVxdWVzdE9wdGlvbnM6IElQYXJhbXNcbik6IFByb21pc2U8SVNoYXJpbmdSZXNwb25zZT4ge1xuICByZXR1cm4gYXdhaXQgamltdVJlcXVlc3QuaXRlbXNncm91cHMocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtb3ZlSXRlbSAoXG4gIHJlcXVlc3RPcHRpb25zOiBJTW92ZUl0ZW1PcHRpb25zXG4pOiBQcm9taXNlPElNb3ZlSXRlbVJlc3BvbnNlPiB7XG4gIHJldHVybiBhd2FpdCBlc3JpLnJlc3RQb3J0YWwubW92ZUl0ZW0ocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2Vyc1RhZ3MgKFxuICByZXF1ZXN0T3B0aW9uczogSUdldFVzZXJPcHRpb25zXG4pOiBQcm9taXNlPElHZXRVc2VyVGFnc1Jlc3BvbnNlPiB7XG4gIHJldHVybiBhd2FpdCBlc3JpLnJlc3RQb3J0YWwuZ2V0VXNlclRhZ3MocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hHcm91cCAoXG4gIHJlcXVlc3RPcHRpb25zOiBJU2VhcmNoT3B0aW9ucyB8IFNlYXJjaFF1ZXJ5QnVpbGRlclxuKTogUHJvbWlzZTxJU2VhcmNoUmVzdWx0PElHcm91cD4+IHtcbiAgcmV0dXJuIGF3YWl0IGVzcmkucmVzdFBvcnRhbC5zZWFyY2hHcm91cHMocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyQ29udGVudCAocmVxdWVzdE9wdGlvbnM6IElQYXJhbXMpOiBhbnkge1xuICByZXR1cm4gamltdVJlcXVlc3QuZ2V0VXNlckNvbnRlbnQocmVxdWVzdE9wdGlvbnMpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBcHBJbkZvbGRlciAocmVxdWVzdE9wdGlvbnM6IElDcmVhdGVJdGVtT3B0aW9ucyk6IFByb21pc2U8SUNyZWF0ZUl0ZW1SZXNwb25zZT4ge1xuICByZXR1cm4gZXNyaS5yZXN0UG9ydGFsLmNyZWF0ZUl0ZW1JbkZvbGRlcihyZXF1ZXN0T3B0aW9ucylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlc291cmNlT3JpZ2luIChcbiAgb3JpZ2luYWxBcHBJbmZvOiBBcHBJbmZvXG4pOiBzdHJpbmcge1xuICBjb25zdCBwb3J0YWxVcmwgPSBpc0FHT0xBcHAob3JpZ2luYWxBcHBJbmZvKSA/IHVybFV0aWxzLmdldEFyY2dpc09ubGluZVVybCgpIDogZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnBvcnRhbFVybFxuICBjb25zdCBpc0xvY2FsQXBwUmVzb3VyY2VPcmlnaW4gPSBvcmlnaW5hbEFwcEluZm8/LmlzTG9jYWxBcHBcbiAgaWYgKGlzTG9jYWxBcHBSZXNvdXJjZU9yaWdpbikge1xuICAgIC8vIGxvY2FsIGFwcGBzIHJlc291cmNlIG9yaWdpbiBpbiBkZXZFZHRpb25cbiAgICByZXR1cm4gbG9jYWxSZXN0U2VydmljZS5nZXRPcmlnaW5VcmwoKSArICcvYXBwcy8nXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHBvcnRhbFVybFV0aWxzLmdldFBsYXRmb3JtVXJsQnlPcmdVcmwocG9ydGFsVXJsKSArXG4gICAgICAnL3NoYXJpbmcvcmVzdC9jb250ZW50L2l0ZW1zLydcbiAgICApXG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSUl0ZW0gfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcydcbmltcG9ydCB0eXBlIHsgSUl0ZW1BZGQgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1wb3J0YWwnXG5pbXBvcnQgeyB0eXBlIEFwcENvbmZpZyB9IGZyb20gJ2ppbXUtY29yZSdcblxuZXhwb3J0IGludGVyZmFjZSByZXF1ZXN0TWV0aG9kUHJvdmlkZXIge1xuICByZXF1ZXN0TWV0aG9kUHJvdmlkZXI6IChyZXN0UG9ydGFsUmVxdWVzdE5hbWU6IHN0cmluZywgbG9jYWxSZXF1ZXN0TmFtZT86IHN0cmluZywgYXBwSW5mbz86IEFwcEluZm8pID0+IGFueVxufVxuXG5leHBvcnQgZW51bSBTZWFyY2hUeXBlIHtcbiAgQUdPTCA9ICdBR09MJywgLy8gU2VhcmNoIEFHT0wgYXBwXG4gIFBvcnRhbCA9ICdQb3J0YWwnLCAvLyBTZWFyY2ggcG9ydGFsIGFwcFxuICBPdGhlciA9ICdPdGhlcicsXG59XG5cbmV4cG9ydCBlbnVtIEFwcFR5cGUge1xuICBUZW1wbGF0ZVR5cGUgPSAnV2ViIEV4cGVyaWVuY2UgVGVtcGxhdGUnLFxuICBFeHBlcmllbmNlVHlwZSA9ICdXZWIgRXhwZXJpZW5jZSdcbn1cblxuZXhwb3J0IGVudW0gUHVibGlzaFN0YXR1cyB7XG4gIFB1Ymxpc2hlZCA9ICdQdWJsaXNoZWQnLFxuICBEcmFmdCA9ICdEcmFmdCcsIC8vIEl0ZW0gaXMgbm90IHB1Ymxpc2hlZFxuICBDaGFuZ2VkID0gJ0NoYW5nZWQnIC8vIFRoZXJlIGFyZSB1bnB1Ymxpc2hlZCBjaGFuZ2VzIHNpbmNlIGxhc3QgcHVibGlzaGluZy5cbn1cbmV4cG9ydCBpbnRlcmZhY2UgQXBwSW5mbyBleHRlbmRzIElJdGVtIHtcbiAgaWQ6IHN0cmluZ1xuICB0eXBlOiBBcHBUeXBlXG5cbiAgbmFtZT86IHN0cmluZ1xuICB0ZXh0PzogYW55XG4gIHVzZXJuYW1lPzogc3RyaW5nXG4gIHRodW1ibmFpbD86IHN0cmluZ1xuICBpc0xvY2FsQXBwPzogYm9vbGVhblxuICBwb3J0YWxVcmw/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbXBvcnRBcHBPcHRpb24gZXh0ZW5kcyBJSXRlbUFkZCB7XG4gIGFwcFppcDogYW55XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2F2ZUFzUmVzcG9uc2Uge1xuICBpZDogc3RyaW5nXG4gIGFwcENvbmZpZzogQXBwQ29uZmlnXG59XG4iLCJleHBvcnQgZW51bSBUb0FwcE1lc3NhZ2Uge1xuICBBcHBDb25maWdDaGFuZ2VkID0gJ2FwcF9jb25maWdfY2hhbmdlZCcsXG4gIEFwcEluZm9DaGFuZ2VkID0gJ2FwcF9pbmZvX2NoYW5nZWQnLFxuICBQb3J0YWxTZWxmQ2hhbmdlZCA9ICdwb3J0YWxfc2VsZl9jaGFuZ2VkJyxcbiAgRGlhbG9nSW5mb3NDaGFuZ2VkID0gJ2RpYWxvZ19pbmZvc19jaGFuZ2VkJyxcbiAgVXNlclNpZ25JbiA9ICd1c2VyX3NpZ25faW4nLFxuICBTZXRNYWluUG9ydGFsID0gJ3NldF9tYWluX3BvcnRhbCcsXG5cbiAgQ2hhbmdlQXBwTW9kZSA9ICdjaGFuZ2VfYXBwX21vZGUnLFxuICBDaGFuZ2VQYWdlID0gJ2NoYW5nZV9wYWdlJyxcbiAgQ2hhbmdlRGlhbG9nID0gJ2NoYW5nZV9kaWFsb2cnLFxuICBDaGFuZ2VTZWxlY3Rpb24gPSAnY2hhbmdlX3NlbGVjdGlvbicsXG4gIENoYW5nZVdpZGdldFN0YXRlUHJvcCA9ICdjaGFuZ2Vfd2lkZ2V0X3N0YXRlX3Byb3AnLFxuICBDaGFuZ2VXaWRnZXRNdXRhYmxlU3RhdGVQcm9wID0gJ2NoYW5nZV93aWRnZXRfbXV0YWJsZV9zdGF0ZV9wcm9wJyxcbiAgQ2hhbmdlWm9vbVNjYWxlID0gJ2NoYW5nZV96b29tX3NjYWxlJyxcblxuICBCdWlsZGVyVHJpZ2dlcktleWJvYXJkID0gJ2J1aWxkZXJfdHJpZ2dlcl9rZXlib2FyZCcsXG4gIENoYW5nZUJyb3dzZXJTaXplTW9kZSA9ICdjaGFuZ2VfYnJvd3Nlcl9zaXplX21vZGUnLFxuICBCdWlsZGVyU2Vzc2lvbkNoYW5nZWQgPSAnYnVpbGRlcl9zZXNzaW9uX2NoYW5nZWQnLFxuICBCdWlsZGVyTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdENoYW5nZWQgPSAnYnVpbGRlcl9ub19wZXJtaXNzaW9uX3Jlc291cmNlX2luZm9fbGlzdF9jaGFuZ2VkJyxcbiAgQWN0aXZlUGFnZVBhcnRDaGFuZ2VkID0gJ2FjdGl2ZV9wYWdlX3BhcnRfY2hhbmdlZCcsXG4gIEFuaW1hdGlvblByZXZpZXcgPSAnYW5pbWF0aW9uX3ByZXZpZXcnLFxuICBIb3ZlclByZXZpZXcgPSAnaG92ZXJfcHJldmlldycsXG4gIFNlY3Rpb25OYXZJbmZvQ2hhbmdlZCA9ICdzZWN0aW9uX25hdmluZm9fY2hhbmdlZCcsXG4gIFNjcmVlbkdyb3VwTmF2SW5mb0NoYW5nZWQgPSAnc2NyZWVuZ3JvdXBfbmF2aW5mb19jaGFuZ2VkJyxcbiAgVG9jSG92ZXJJbmZvQ2hhbmdlZCA9ICd0b2NfaG92ZXJfaW5mb19jaGFuZ2VkJyxcbiAgU2V0Q2xpZW50SWRBbGVydElzQ2FuY2VsbGVkID0gJ3NldF9jbGllbnRfaWRfYWxlcnRfaXNfY2FuY2VsbGVkJyxcbiAgVXRpbGl0eVN0YXRlQ2hhbmdlZCA9ICd1dGlsaXR5X3N0YXRlX2NoYW5nZWQnXG59XG5cbmV4cG9ydCBlbnVtIFRvQnVpbGRlck1lc3NhZ2Uge1xuICBBcHBTdGF0ZUNoYW5nZWQgPSAnYXBwX3N0YXRlX2NoYW5nZWQnLFxuICBBcHBTZXNzaW9uQ2hhbmdlZCA9ICdhcHBfc2Vzc2lvbl9jaGFuZ2VkJyxcbiAgQXBwTm9QZXJtaXNzaW9uUmVzb3VyY2VJbmZvTGlzdENoYW5nZWQgPSAnYXBwX25vX3Blcm1pc3Npb25fcmVzb3VyY2VfaW5mb19saXN0X2NoYW5nZWQnLFxuICBOZWVkVG9DaGVjazQ5OEVycm9yID0gJ25lZWRfdG9fY2hlY2tfNDk4X2Vycm9yJyxcbiAgUG9wdXBDaG9vc2VXaWRnZXQgPSAncG9wdXBfY2hvb3NlX3dpZGdldCcsXG4gIEFwcEFkZFJlc291cmNlID0gJ2FwcF9hZGRfcmVzb3VyY2UnLFxuICBBcHBDbGVhclJlc291cmNlcyA9ICdhcHBfY2xlYXJfcmVzb3VyY2VzJyxcbiAgQXBwVHJpZ2dlcktleWJvYXJkID0gJ2FwcF90cmlnZ2VyX2tleWJvYXJkJyxcbiAgU2V0TGF5b3V0VG9vbHMgPSAnYXBwX3NldF9sYXlvdXRfdG9vbHMnLFxuICBDbGVhckxhc3RBcHBDb25maWdGcm9tSGlzdG9yeSA9ICdjbGVhcl9sYXN0X2FwcF9jb25maWdfZnJvbV9oaXN0b3J5JyxcbiAgU2V0SXNCdXN5ID0gJ2FwcF9zZXRfaXNidXN5JyxcbiAgQXBwSXNMb2FkZWQgPSAnYXBwX2lzX2xvYWRlZCcsIC8vIGFwcCBpcyByZWFkeSBmb3IgYnVpbGRlciBldmVudFxuICBDb25maXJtRGVsZXRlID0gJ2NvbmZpcm1fZGVsZXRlJyxcbiAgTmVlZFRvUmVnaXN0ZXJDbGluZXRJZCA9ICduZWVkX3RvX3JlZ2lzdGVyX2NsaWVudF9pZCcsXG4gIFNldFNpZGVQYW5lbCA9ICdhcHBfc2lkZV9wYW5lbCdcbn1cbiIsImV4cG9ydCBkZWZhdWx0IHtcbiAgZnJhbWV3b3JrQWN0aW9uX1RyaWdnZXJMYXllcjogJ1RyaWdnZXIgZGF0YScsXG4gIGZyYW1ld29ya0FjdGlvbl9TZXREYXRhOiAnU2VsZWN0IGRhdGEnLFxuICBmcmFtZXdvcmtBY3Rpb25fQWN0aW9uTGF5ZXI6ICdBY3Rpb24gZGF0YScsXG4gIGZyYW1ld29ya0FjdGlvbl9Db25kaXRpb25zOiAnQ29uZGl0aW9ucycsXG4gIGZyYW1ld29ya0FjdGlvbl9SZWxhdGVNZXNzYWdlOiAnVHJpZ2dlciAvIGFjdGlvbiBjb25uZWN0aW9uJyxcbiAgZnJhbWV3b3JrQWN0aW9uX1RyaWdnZXJMYXllckZpZWxkOiAnU2VsZWN0IGEgdHJpZ2dlciBmaWVsZCcsXG4gIGZyYW1ld29ya0FjdGlvbl9Ob25lOiAnbm9uZScsXG4gIGZyYW1ld29ya0FjdGlvbl9FcXVhbHM6ICdlcXVhbHMnLFxuICBmcmFtZXdvcmtBY3Rpb25fQWN0aW9uTGF5ZXJGaWVsZDogJ1NlbGVjdCBhbiBhY3Rpb24gZmllbGQnLFxuICBmcmFtZXdvcmtBY3Rpb25fTW9yZUNvbmRpdGlvbnM6ICdNb3JlIGNvbmRpdGlvbnMnLFxuICBmcmFtZXdvcmtBY3Rpb25fU2V0RXhwcmVzc2lvbjogJ1BsZWFzZSBzZXQgeW91ciBleHByZXNzaW9uIGZpcnN0LicsXG4gIGZyYW1ld29ya0FjdGlvbl9DaG9vc2VMYXllcjogJ1NlbGVjdCBkYXRhJyxcbiAgZnJhbWV3b3JrQWN0aW9uX0F1dG9CaW5kOiAnQXV0byBib3VuZC4nLFxuICBmcmFtZXdvcmtBY3Rpb25fTm9MYXllcjogJ05vIGRhdGEuJyxcbiAgZnJhbWV3b3JrQWN0aW9uX1F1ZXJ5QnlFeHRlbnQ6ICdRdWVyeSBieSBjdXJyZW50IGV4dGVudCcsXG5cbiAgLy8gY29tbW9uIHRlbXBsYXRlIHN0cmluZ3NcbiAgZGVmYXVsdFRleHRQbGFjZWhvbGRlcjogJ0RvdWJsZSBjbGljayB0byBlZGl0IHRleHQnLFxuICB0aXRsZVBsYWNlaG9sZGVyOiAnSGVyZSBpcyB0aGUgdGl0bGUnLFxuICBzdWJUaXRsZVBsYWNlaG9sZGVyOiAnSGVyZSBpcyB0aGUgc3VidGl0bGUnLFxuICBzaG9ydFRpdGxlUGxhY2Vob2xkZXI6ICdUaXRsZScsXG4gIHNob3J0U3ViVGl0bGVQbGFjZWhvbGRlcjogJ1N1YnRpdGxlJyxcbiAgY29weXJpZ2h0UGxhY2Vob2xkZXI6ICdDb3B5cmlnaHQgaW5mbycsXG4gIGNhcmRUaXRsZTogJ0NhcmQgdGl0bGUnLFxuICBib29rbWFyazogJ0Jvb2ttYXJrJyxcbiAgbnVtYmVyOiAnTnVtYmVyJyxcbiAgdGVtcGxhdGVTZWFyY2hSZXN1bHQ6ICdTZWFyY2ggcmVzdWx0JyxcbiAgbG9nbzogJ0xvZ28nLFxuICBhcHBJdGVtQ29weTogJ0NvcHknXG59XG4iLCJpbXBvcnQge1xuICBJbW11dGFibGUsIHR5cGUgSW1tdXRhYmxlT2JqZWN0LCB0eXBlIFdpZGdldHNKc29uLCB0eXBlIEFwcENvbmZpZywgdHlwZSBVcmxHZW5lcmFsQ29uZmlnLFxuICB0eXBlIFVybFBhcmFtc0NvbmZpZywgdHlwZSBVcmxQYXJhbXNXaWRnZXRzQ29uZmlnLCB1cmxNYW5hZ2VyVXRpbHMsXG4gIHR5cGUgQ29udGFpbmVySW5mbywgQ29udGFpbmVyVHlwZSwgTGF5b3V0SXRlbVR5cGUsIHR5cGUgQnJvd3NlclNpemVNb2RlXG59IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IGdldEFwcENvbmZpZ0FjdGlvbiwgdHlwZSBBcHBDb25maWdBY3Rpb24gfSBmcm9tICdqaW11LWZvci1idWlsZGVyJ1xuaW1wb3J0IHsgc2VhcmNoVXRpbHMgfSBmcm9tICdqaW11LWxheW91dHMvbGF5b3V0LXJ1bnRpbWUnXG5cbmV4cG9ydCBpbnRlcmZhY2UgV2lkZ2V0c0luZm9JblBhZ2VzIHtcbiAgcGFnZUluZm86IHtcbiAgICBpZDogc3RyaW5nXG4gICAgbGFiZWw6IHN0cmluZ1xuICB9XG4gIHdpZGdldHNJbmZvOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZ1xuICAgIGxhYmVsOiBzdHJpbmdcbiAgfT5cbn1cblxuY2xhc3MgVXJsQ29uZmlnTWFuYWdlciB7XG4gIHN0YXRpYyBpbnN0YW5jZTogVXJsQ29uZmlnTWFuYWdlclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UgKCkge1xuICAgIGlmICghVXJsQ29uZmlnTWFuYWdlci5pbnN0YW5jZSkge1xuICAgICAgVXJsQ29uZmlnTWFuYWdlci5pbnN0YW5jZSA9IG5ldyBVcmxDb25maWdNYW5hZ2VyKClcbiAgICB9XG4gICAgcmV0dXJuIFVybENvbmZpZ01hbmFnZXIuaW5zdGFuY2VcbiAgfVxuXG4gIC8vIE1hbmlmZXN0XG4gIGdldFdpZGdldHNVc2VVcmxQYXJhbXNJbk1hbmlmZXN0ICgpIHtcbiAgICBjb25zdCBhcHBDb25maWcgPSB1cmxNYW5hZ2VyVXRpbHMuZ2V0QXBwQ29uZmlnKClcbiAgICBsZXQgd2lkZ2V0c1dpdGhVcmxQYXJhbWV0ZXJzOiBJbW11dGFibGVPYmplY3Q8V2lkZ2V0c0pzb24+ID0gbnVsbFxuXG4gICAgaWYgKGFwcENvbmZpZz8ud2lkZ2V0cykge1xuICAgICAgd2lkZ2V0c1dpdGhVcmxQYXJhbWV0ZXJzID0gSW1tdXRhYmxlLmZyb20oe30pIGFzIGFueVxuXG4gICAgICBmb3IgKGNvbnN0IHdpZGdldElkIG9mIE9iamVjdC5rZXlzKGFwcENvbmZpZy53aWRnZXRzKSkge1xuICAgICAgICBjb25zdCB3aWRnZXQgPSBhcHBDb25maWcud2lkZ2V0c1t3aWRnZXRJZF1cbiAgICAgICAgY29uc3QgdXJsUGFyYW1ldGVyc0luTWFuaWZlc3QgPSB3aWRnZXQubWFuaWZlc3QudXJsUGFyYW1ldGVyc1xuXG4gICAgICAgIC8vIHNldCB1cmxQYXJhbWV0ZXJzIGRhdGFcbiAgICAgICAgaWYgKHVybFBhcmFtZXRlcnNJbk1hbmlmZXN0Py5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgd2lkZ2V0c1dpdGhVcmxQYXJhbWV0ZXJzID0gd2lkZ2V0c1dpdGhVcmxQYXJhbWV0ZXJzLnNldCh3aWRnZXRJZCwgd2lkZ2V0KVxuICAgICAgICAgIC8vIHVzZSBpMThuIGxhYmVsLCBrZXk6IF91cmxfcGFyYW1zX3t9X2xhYmVsXG4gICAgICAgICAgY29uc3QgdXJsUGFyYW1ldGVyc1dpdGhJMThuTGFiZWwgPSB1cmxQYXJhbWV0ZXJzSW5NYW5pZmVzdC5tYXAodXJsUGFyYW1ldGVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gd2lkZ2V0Lm1hbmlmZXN0LmkxOG5NZXNzYWdlc1tgX3VybF9wYXJhbXNfJHt1cmxQYXJhbWV0ZXIubmFtZX1fbGFiZWxgXSA/PyB1cmxQYXJhbWV0ZXIubGFiZWxcbiAgICAgICAgICAgIHJldHVybiB1cmxQYXJhbWV0ZXIuc2V0KCdsYWJlbCcsIGxhYmVsKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgd2lkZ2V0c1dpdGhVcmxQYXJhbWV0ZXJzID0gd2lkZ2V0c1dpdGhVcmxQYXJhbWV0ZXJzLnNldEluKFt3aWRnZXRJZCwgJ21hbmlmZXN0JywgJ3VybFBhcmFtZXRlcnMnXSwgdXJsUGFyYW1ldGVyc1dpdGhJMThuTGFiZWwpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gd2lkZ2V0c1dpdGhVcmxQYXJhbWV0ZXJzXG4gIH1cblxuICAvLyBnZW5lcmFsIHNldHRpbmdzXG4gIGlzR2VuZXJhbFVybENvbmZpZ0VuYWJsZSA9IChnZW5lcmFsQ29uZmlnOiBVcmxHZW5lcmFsQ29uZmlnKTogYm9vbGVhbiA9PiB7XG4gICAgY29uc3QgYXBwQ29uZmlnID0gdXJsTWFuYWdlclV0aWxzLmdldEFwcENvbmZpZygpXG4gICAgY29uc3QgdXJsQ29uZmlnID0gYXBwQ29uZmlnPy51cmxQYXJhbXM/LmdldEluKFsnZ2VuZXJhbCcsIGdlbmVyYWxDb25maWddKVxuICAgIGxldCBpc0VuYWJsZSA9IHVybENvbmZpZz8uaXNFbmFibGVcblxuICAgIGlmICh0eXBlb2YgaXNFbmFibGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBpc0VuYWJsZSA9IHRydWUgLy8gZGVmYXVsdCBpcyBvcGVuXG4gICAgfVxuXG4gICAgcmV0dXJuIGlzRW5hYmxlXG4gIH1cblxuICB1cGRhdGVHZW5lcmFsVXJsQ29uZmlnRW5hYmxlIChnZW5lcmFsVXJsQ29uZmlnOiBVcmxHZW5lcmFsQ29uZmlnLCBpc0VuYWJsZTogYm9vbGVhbikge1xuICAgIGxldCBhcHBDb25maWcgPSB1cmxNYW5hZ2VyVXRpbHMuZ2V0QXBwQ29uZmlnKClcbiAgICBsZXQgZ2VuZXJhbFVybENvbmZpZ3MvKjogVXJsUGFyYW1zQ29uZmlnICovID0gYXBwQ29uZmlnLnVybFBhcmFtcz8uZ2V0SW4oWydnZW5lcmFsJywgZ2VuZXJhbFVybENvbmZpZ10pXG5cbiAgICBpZiAoIWdlbmVyYWxVcmxDb25maWdzKSB7XG4gICAgICBnZW5lcmFsVXJsQ29uZmlncyA9IEltbXV0YWJsZS5mcm9tKHsgaXNFbmFibGU6IGZhbHNlIH0pXG4gICAgfVxuICAgIGdlbmVyYWxVcmxDb25maWdzID0gZ2VuZXJhbFVybENvbmZpZ3M/Lm1lcmdlKHsgaXNFbmFibGU6IGlzRW5hYmxlIH0pXG5cbiAgICBpZiAoIWFwcENvbmZpZy51cmxQYXJhbXMpIHtcbiAgICAgIGFwcENvbmZpZyA9IGFwcENvbmZpZy5zZXRJbihbJ3VybFBhcmFtcyddLCBJbW11dGFibGUuZnJvbSh7IGdlbmVyYWw6IHt9IH0pKVxuICAgIH1cbiAgICBjb25zdCB1cmxQYXJhbXM6IFVybFBhcmFtc0NvbmZpZyA9IGFwcENvbmZpZy51cmxQYXJhbXM/LnNldEluKFsnZ2VuZXJhbCcsIGdlbmVyYWxVcmxDb25maWddLCBnZW5lcmFsVXJsQ29uZmlncylcblxuICAgIC8vIHVwZGF0ZVxuICAgIHRoaXMudXBkYXRlVXJsUGFyYW1zQ29uZmlnKHVybFBhcmFtcylcbiAgfVxuXG4gIC8vIHdpZGdldHNcbiAgaXNXaWRnZXRQYXJhbUVuYWJsZSAod2lkZ2V0SWQ6IHN0cmluZywgcGFyYW1OYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBhcHBDb25maWcgPSB1cmxNYW5hZ2VyVXRpbHMuZ2V0QXBwQ29uZmlnKClcblxuICAgIGxldCBpc0NoZWNrZWQgPSB0cnVlXG4gICAgY29uc3Qgd2lkZ2V0ID0gYXBwQ29uZmlnLnVybFBhcmFtcz8uZ2V0SW4oWyd3aWRnZXRzJywgd2lkZ2V0SWRdKVxuICAgIGlzQ2hlY2tlZCA9IHdpZGdldD8uZ2V0SW4oWydwYXJhbXMnLCBwYXJhbU5hbWVdKVxuXG4gICAgaWYgKHR5cGVvZiBpc0NoZWNrZWQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBpc0NoZWNrZWQgPSB0cnVlIC8vIGRlZmF1bHQgaXMgb3BlblxuICAgIH1cblxuICAgIHJldHVybiBpc0NoZWNrZWRcbiAgfVxuXG4gIHVwZGF0ZVdpZGdldEVuYWJsZSAod2lkZ2V0SWQ6IHN0cmluZywgaXNFbmFibGU6IGJvb2xlYW4pIHtcbiAgICBsZXQgeyBhcHBDb25maWcsIHdpZGdldFVybENvbmZpZyB9ID0gdGhpcy5nZXRXaWRnZXRzVXJsUGFyYW1zQ29uZmlnKHdpZGdldElkKVxuXG4gICAgd2lkZ2V0VXJsQ29uZmlnID0gd2lkZ2V0VXJsQ29uZmlnPy5tZXJnZSh7IGlzRW5hYmxlOiBpc0VuYWJsZSB9KVxuXG4gICAgdGhpcy5fc2V0V2lkZ2V0VXJsQ29uZmlnKHdpZGdldElkLCB3aWRnZXRVcmxDb25maWcsIGFwcENvbmZpZywgZ2V0QXBwQ29uZmlnQWN0aW9uKCkpXG4gIH1cblxuICB1cGRhdGVXaWRnZXRQYXJhbUVuYWJsZSAod2lkZ2V0SWQ6IHN0cmluZywgcGFyYW1OYW1lOiBzdHJpbmcsIGlzRW5hYmxlOiBib29sZWFuKSB7XG4gICAgbGV0IHsgYXBwQ29uZmlnLCB3aWRnZXRVcmxDb25maWcgfSA9IHRoaXMuZ2V0V2lkZ2V0c1VybFBhcmFtc0NvbmZpZyh3aWRnZXRJZClcblxuICAgIHdpZGdldFVybENvbmZpZyA9IHdpZGdldFVybENvbmZpZy5zZXRJbihbJ3BhcmFtcycsIHBhcmFtTmFtZV0sIGlzRW5hYmxlKVxuICAgIC8vIGVuYWJsZSB3aWRnZXQsIHdoZW4gb25jZSBpdG1lIGJlY29tZSBlbmFibGVcbiAgICBpZiAoaXNFbmFibGUpIHtcbiAgICAgIHdpZGdldFVybENvbmZpZyA9IHdpZGdldFVybENvbmZpZz8ubWVyZ2UoeyBpc0VuYWJsZTogdHJ1ZSB9KVxuICAgIH1cblxuICAgIHRoaXMuX3NldFdpZGdldFVybENvbmZpZyh3aWRnZXRJZCwgd2lkZ2V0VXJsQ29uZmlnLCBhcHBDb25maWcsIGdldEFwcENvbmZpZ0FjdGlvbigpKVxuICB9XG5cbiAgLy8gd2lkZ2V0cyBmaWx0ZXIgZm9yIHBhZ2VzXG4gIGdldFdpZGdldHNJblBhZ2VzIChjdXJyZW50QnJvd3NlclNpemVNb2RlOiBCcm93c2VyU2l6ZU1vZGUsIGZpbHRlclN0cmluZzogc3RyaW5nKTogV2lkZ2V0c0luZm9JblBhZ2VzW10ge1xuICAgIGNvbnN0IGFwcENvbmZpZyA9IHVybE1hbmFnZXJVdGlscy5nZXRBcHBDb25maWcoKVxuXG4gICAgY29uc3QgaW5mb3M6IFdpZGdldHNJbmZvSW5QYWdlc1tdID0gW11cbiAgICBmb3IgKGNvbnN0IHBhZ2VJZCBvZiBPYmplY3Qua2V5cyhhcHBDb25maWcucGFnZXMpKSB7XG4gICAgICBjb25zdCBjb250YWluZXJJbmZvOiBDb250YWluZXJJbmZvID0ge1xuICAgICAgICB0eXBlOiBDb250YWluZXJUeXBlLlBhZ2UsXG4gICAgICAgIGlkOiBwYWdlSWRcbiAgICAgIH1cbiAgICAgIGNvbnN0IHdpZGdldElkc0luUGFnZSA9IHNlYXJjaFV0aWxzLmdldENvbnRlbnRzSW5Db250YWluZXJSZWN1cnNpdmUoYXBwQ29uZmlnLCBjb250YWluZXJJbmZvLCBMYXlvdXRJdGVtVHlwZS5XaWRnZXQsIGN1cnJlbnRCcm93c2VyU2l6ZU1vZGUpXG4gICAgICBjb25zdCB3aWRnZXRJZHMgPSB0aGlzLl9maW5kQ29tbW9uV2lkZ2V0c0luTWFuaWZlc3Qod2lkZ2V0SWRzSW5QYWdlKVxuXG4gICAgICAvLyAxLnBhZ2VJbmZvXG4gICAgICBjb25zdCBwYWdlSW5mbyA9IHtcbiAgICAgICAgaWQ6IHBhZ2VJZCxcbiAgICAgICAgbGFiZWw6IHRoaXMuX2dldFBhZ2VMYWJlbChwYWdlSWQpXG4gICAgICB9XG4gICAgICAvLyAyLndpZGdldHNJbmZvXG4gICAgICBsZXQgd2lkZ2V0c0luZm8gPSBbXVxuICAgICAgd2lkZ2V0SWRzLmZvckVhY2goKHdpZGdldElkKSA9PiB7XG4gICAgICAgIHdpZGdldHNJbmZvLnB1c2goe1xuICAgICAgICAgIGlkOiB3aWRnZXRJZCxcbiAgICAgICAgICBsYWJlbDogdGhpcy5fZ2V0V2lkZ2V0TGFiZWwod2lkZ2V0SWQpXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgLy8gMy5maWx0ZXJcbiAgICAgIGlmIChmaWx0ZXJTdHJpbmcpIHtcbiAgICAgICAgd2lkZ2V0c0luZm8gPSB3aWRnZXRzSW5mby5maWx0ZXIoKHdpZGdldEluZm8pID0+IHtcbiAgICAgICAgICByZXR1cm4gd2lkZ2V0SW5mby5sYWJlbD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXJTdHJpbmcudG9Mb3dlckNhc2UoKSkgLy8gaWdub3JlIGNhc2VcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgLy8gMSsyKzMgcmVzdWx0XG4gICAgICBpbmZvcy5wdXNoKHtcbiAgICAgICAgcGFnZUluZm86IHBhZ2VJbmZvLFxuICAgICAgICB3aWRnZXRzSW5mbzogd2lkZ2V0c0luZm9cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIGluZm9zXG4gIH1cblxuICBwcml2YXRlIF9maW5kQ29tbW9uV2lkZ2V0c0luTWFuaWZlc3QgKHdpZGdldElkc0luUGFnZTogc3RyaW5nW10pIHtcbiAgICBjb25zdCB1cmxQYXJhbXNXaWRnZXRzSW5NYW5pZmVzdCA9IHRoaXMuZ2V0V2lkZ2V0c1VzZVVybFBhcmFtc0luTWFuaWZlc3QoKVxuICAgIGNvbnN0IHdpZGdldHNJbk1hbmlmZXN0ID0gT2JqZWN0LmtleXModXJsUGFyYW1zV2lkZ2V0c0luTWFuaWZlc3QpXG5cbiAgICBjb25zdCBjb21tb25FbGVtZW50cyA9IFtdXG4gICAgd2lkZ2V0SWRzSW5QYWdlLmZvckVhY2goKHdpZGdldElkKSA9PiB7XG4gICAgICBpZiAod2lkZ2V0c0luTWFuaWZlc3QuaW5jbHVkZXMod2lkZ2V0SWQpKSB7XG4gICAgICAgIGNvbW1vbkVsZW1lbnRzLnB1c2god2lkZ2V0SWQpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBjb21tb25FbGVtZW50c1xuICB9XG5cbiAgcHJpdmF0ZSBfZ2V0V2lkZ2V0TGFiZWwgKHdpZGdldElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGFwcENvbmZpZyA9IHVybE1hbmFnZXJVdGlscy5nZXRBcHBDb25maWcoKVxuICAgIGNvbnN0IHdpZGdldEluZm8gPSBhcHBDb25maWcud2lkZ2V0cy5nZXRJbihbd2lkZ2V0SWRdKVxuXG4gICAgcmV0dXJuIHdpZGdldEluZm8/LmxhYmVsIHx8IHdpZGdldElkXG4gIH1cblxuICBwcml2YXRlIF9nZXRQYWdlTGFiZWwgKHBhZ2VJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBhcHBDb25maWcgPSB1cmxNYW5hZ2VyVXRpbHMuZ2V0QXBwQ29uZmlnKClcbiAgICBjb25zdCBwYWdlSW5mbyA9IGFwcENvbmZpZy5wYWdlcy5nZXRJbihbcGFnZUlkXSlcblxuICAgIHJldHVybiBwYWdlSW5mbz8ubGFiZWwgfHwgcGFnZUlkXG4gIH1cblxuICAvLyBzZXR0aW5nICYgZ2V0dGVyXG4gIGdldFdpZGdldHNVcmxQYXJhbXNDb25maWcgKHdpZGdldElkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBhcHBDb25maWcgPSB1cmxNYW5hZ2VyVXRpbHMuZ2V0QXBwQ29uZmlnKClcbiAgICBsZXQgd2lkZ2V0VXJsQ29uZmlnOiBJbW11dGFibGVPYmplY3Q8VXJsUGFyYW1zV2lkZ2V0c0NvbmZpZz4gPSBhcHBDb25maWcudXJsUGFyYW1zPy5nZXRJbihbJ3dpZGdldHMnLCB3aWRnZXRJZF0pXG5cbiAgICBpZiAoIXdpZGdldFVybENvbmZpZykge1xuICAgICAgd2lkZ2V0VXJsQ29uZmlnID0gSW1tdXRhYmxlLmZyb20oeyBpc0VuYWJsZTogdHJ1ZSB9KVxuICAgIH1cblxuICAgIHJldHVybiB7IGFwcENvbmZpZywgd2lkZ2V0VXJsQ29uZmlnIH1cbiAgfVxuXG4gIHByaXZhdGUgX3NldFdpZGdldFVybENvbmZpZyAod2lkZ2V0SWQ6IHN0cmluZywgd2lkZ2V0VXJsQ29uZmlnOiBVcmxQYXJhbXNXaWRnZXRzQ29uZmlnLCBhcHBDb25maWc6IEltbXV0YWJsZU9iamVjdDxBcHBDb25maWc+LCBhcHBDb25maWdBY3Rpb246IEFwcENvbmZpZ0FjdGlvbikge1xuICAgIGlmICghYXBwQ29uZmlnLnVybFBhcmFtcykge1xuICAgICAgYXBwQ29uZmlnID0gYXBwQ29uZmlnLnNldEluKFsndXJsUGFyYW1zJ10sIEltbXV0YWJsZS5mcm9tKHsgd2lkZ2V0czoge30gfSkpXG4gICAgfVxuICAgIGNvbnN0IHdpZGdldFVybFBhcmFtczogVXJsUGFyYW1zQ29uZmlnID0gYXBwQ29uZmlnLnVybFBhcmFtcz8uc2V0SW4oWyd3aWRnZXRzJywgd2lkZ2V0SWRdLCB3aWRnZXRVcmxDb25maWcpXG4gICAgLy8gdXBkYXRlXG4gICAgdGhpcy51cGRhdGVVcmxQYXJhbXNDb25maWcod2lkZ2V0VXJsUGFyYW1zKVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVVcmxQYXJhbXNDb25maWcgKHVybFBhcmFtczogVXJsUGFyYW1zQ29uZmlnKSB7XG4gICAgZ2V0QXBwQ29uZmlnQWN0aW9uKCkudXBkYXRlVXJsUGFyYW1zQ29uZmlnKHVybFBhcmFtcykuZXhlYygpXG4gIH1cbn1cblxuLyoqXG4gKiBUaGUgYFVybENvbmZpZ01hbmFnZXJgIGlzIHVzZWQgdG8gbWFuYWdlIHVybCBwYXJhbXMgY29uZmlnLCBpbiBhcHAtc2V0dGluZy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgVXJsQ29uZmlnTWFuYWdlclxuIiwiaW1wb3J0IHsgdHlwZSBJTUFwcENvbmZpZywgYXBwQ29uZmlnVXRpbHMsIFBhZ2VUeXBlLCB0eXBlIEFwcENvbmZpZyB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCAqIGFzIGxheW91dFdyaXRlVXRpbHMgZnJvbSAnLi9sYXlvdXQtd3JpdGUtdXRpbHMnXG5cbmNvbnN0IHtcbiAgZ2V0VW5pcXVlSWQsIGdldFVuaXF1ZUxhYmVsLCBwYXJzZVVuaXF1ZUxhYmVsLCBnZXRTaXplTW9kZU9mQUxheW91dFxufSA9IGFwcENvbmZpZ1V0aWxzXG5cbmV4cG9ydCB7IGdldFVuaXF1ZUlkLCBnZXRVbmlxdWVMYWJlbCwgcGFyc2VVbmlxdWVMYWJlbCwgZ2V0U2l6ZU1vZGVPZkFMYXlvdXQgfVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGaXJzdExldmVsUGFnZSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgcGFnZUlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuICEhYXBwQ29uZmlnLnBhZ2VTdHJ1Y3R1cmUuZmluZChwcyA9PiAhIXBzW3BhZ2VJZF0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1BhZ2VIYXNTdWJQYWdlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBwYWdlSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBwcyA9IGFwcENvbmZpZy5wYWdlU3RydWN0dXJlLmZpbmQocHMgPT4gISFwc1twYWdlSWRdKVxuICByZXR1cm4gcHMgJiYgcHNbcGFnZUlkXS5sZW5ndGggPiAwXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWFsUGFnZUNvdW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnKTogbnVtYmVyIHtcbiAgbGV0IGNvdW50ID0gMFxuICBPYmplY3Qua2V5cyhhcHBDb25maWcucGFnZXMpLmZvckVhY2goKHBJZCwgaSkgPT4ge1xuICAgIGlmIChpc1JlYWxQYWdlKGFwcENvbmZpZywgcElkKSkge1xuICAgICAgY291bnQrK1xuICAgIH1cbiAgfSlcbiAgcmV0dXJuIGNvdW50XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdWJSZWFsUGFnZUNvdW50IChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBwYXJlbnRQYWdlSWQ6IHN0cmluZyk6IG51bWJlciB7XG4gIGlmICghaXNGaXJzdExldmVsUGFnZShhcHBDb25maWcsIHBhcmVudFBhZ2VJZCkpIHJldHVybiAwXG4gIGxldCBjb3VudCA9IDBcbiAgYXBwQ29uZmlnLnBhZ2VTdHJ1Y3R1cmUuZm9yRWFjaCgocHMsIGkpID0+IHtcbiAgICBjb25zdCBwSWQgPSBPYmplY3Qua2V5cyhwcylbMF1cbiAgICBpZiAocElkID09PSBwYXJlbnRQYWdlSWQpIHtcbiAgICAgIHBzW3BJZF0uZm9yRWFjaCgoc3ViUElkKSA9PiB7XG4gICAgICAgIGlmIChpc1JlYWxQYWdlKGFwcENvbmZpZywgc3ViUElkKSkge1xuICAgICAgICAgIGNvdW50KytcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH0pXG4gIHJldHVybiBjb3VudFxufVxuXG4vKipcbiAqIEV4Y2x1ZGUgdGhlIHBhc3NlZCBpbiBwYWdlIGFuZCBpdCdzIHN1YiBwYWdlcy5cbiAqIEBwYXJhbSBhcHBDb25maWdcbiAqIEBwYXJhbSBwYWdlSWQgdGhlIHBhZ2UgdGhhdCBpcyBleGNsdWRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVhbFBhZ2VDb3VudEV4Y2x1ZGVPbmVQYWdlIChhcHBDb25maWc6IElNQXBwQ29uZmlnLCBwYWdlSWQ6IHN0cmluZyk6IG51bWJlciB7XG4gIGxldCBjb3VudCA9IDBcbiAgaWYgKGlzUmVhbFBhZ2UoYXBwQ29uZmlnLCBwYWdlSWQpKSBjb3VudCA9IDFcblxuICByZXR1cm4gZ2V0UmVhbFBhZ2VDb3VudChhcHBDb25maWcpIC0gZ2V0U3ViUmVhbFBhZ2VDb3VudChhcHBDb25maWcsIHBhZ2VJZCkgLSBjb3VudFxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNSZWFsUGFnZSAoYXBwQ29uZmlnOiBJTUFwcENvbmZpZywgcGFnZUlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3QgcGFnZUpzb24gPSBhcHBDb25maWcucGFnZXNbcGFnZUlkXVxuICBpZiAoIXBhZ2VKc29uKSByZXR1cm4gZmFsc2VcbiAgaWYgKHBhZ2VKc29uLnR5cGUgPT09IFBhZ2VUeXBlLk5vcm1hbCkge1xuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhbkFwcFN0cnVjdHVyZSAoY29uZmlnOiBBcHBDb25maWcpOiBBcHBDb25maWcge1xuICBPYmplY3QudmFsdWVzKGNvbmZpZy5wYWdlcyA/PyB7fSkuZm9yRWFjaChwYWdlSnNvbiA9PiB7XG4gICAgY29uZmlnID0gbGF5b3V0V3JpdGVVdGlscy5jbGVhbnVwU2l6ZW1vZGVMYXlvdXRTdHJ1Y3R1cmUoY29uZmlnLCBwYWdlSnNvbi5sYXlvdXQpXG4gIH0pXG5cbiAgT2JqZWN0LnZhbHVlcyhjb25maWcuZGlhbG9ncyA/PyB7fSkuZm9yRWFjaChkaWFsb2dKc29uID0+IHtcbiAgICBjb25maWcgPSBsYXlvdXRXcml0ZVV0aWxzLmNsZWFudXBTaXplbW9kZUxheW91dFN0cnVjdHVyZShjb25maWcsIGRpYWxvZ0pzb24ubGF5b3V0KVxuICB9KVxuXG4gIGlmIChjb25maWcuaGVhZGVyPy5sYXlvdXQpIHtcbiAgICBjb25maWcgPSBsYXlvdXRXcml0ZVV0aWxzLmNsZWFudXBTaXplbW9kZUxheW91dFN0cnVjdHVyZShjb25maWcsIGNvbmZpZy5oZWFkZXIubGF5b3V0KVxuICB9XG4gIGlmIChjb25maWcuZm9vdGVyPy5sYXlvdXQpIHtcbiAgICBjb25maWcgPSBsYXlvdXRXcml0ZVV0aWxzLmNsZWFudXBTaXplbW9kZUxheW91dFN0cnVjdHVyZShjb25maWcsIGNvbmZpZy5mb290ZXIubGF5b3V0KVxuICB9XG4gIHJldHVybiBjb25maWdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENsZWFuQXBwQ29uZmlnIChhcHBDb25maWc6IElNQXBwQ29uZmlnKTogQXBwQ29uZmlnIHtcbiAgbGV0IGNvbmZpZyA9IGFwcENvbmZpZy5hc011dGFibGUoeyBkZWVwOiB0cnVlIH0pXG4gIC8vIGNvbmZpZyA9IHJlbW92ZU9ycGhhbkl0ZW1zKGNvbmZpZywgdHJ1ZSlcbiAgT2JqZWN0LmtleXMoY29uZmlnLndpZGdldHMpLmZvckVhY2god2lkID0+IHtcbiAgICBjb25zdCB3ID0gY29uZmlnLndpZGdldHNbd2lkXVxuICAgIGlmICh3LmxhYmVsID09PSB3Lm1hbmlmZXN0Py5uYW1lKSB7XG4gICAgICBkZWxldGUgdy5sYWJlbFxuICAgIH1cbiAgICBpZiAody5pY29uID09PSB3LmNvbnRleHQuZm9sZGVyVXJsICsgJ2ljb24uc3ZnJykge1xuICAgICAgZGVsZXRlIHcuaWNvblxuICAgIH1cbiAgICBpZiAodHlwZW9mIHcuaWNvbiA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGlmICgody5pY29uKS5zdmcgPT09IHcuY29udGV4dC5mb2xkZXJVcmwgKyAnaWNvbi5zdmcnICYmXG4gICAgICAoKHcuaWNvbikucHJvcGVydGllcz8uY29sb3IgPT09ICcjZmZmJyB8fCAhKHcuaWNvbikucHJvcGVydGllcz8uY29sb3IpKSB7XG4gICAgICAgIGRlbGV0ZSB3Lmljb25cbiAgICAgIH1cbiAgICB9XG4gICAgZGVsZXRlIHcuY29udGV4dFxuICAgIGRlbGV0ZSB3Lm1hbmlmZXN0XG4gICAgZGVsZXRlIHcuX29yaWdpbk1hbmlmZXN0XG4gIH0pXG4gIGNvbmZpZy5sYXlvdXRzID0gbGF5b3V0V3JpdGVVdGlscy5jbGVhbnVwUnVudGltZUxheW91dHMoY29uZmlnLmxheW91dHMpIGFzIGFueVxuICBjb25maWcgPSBhcHBDb25maWdVdGlscy5jbGVhblBvcnRhbEluZm9Gcm9tUmVzb3VyY2UoY29uZmlnKVxuICBjb25maWcgPSBjbGVhbkFwcFN0cnVjdHVyZShjb25maWcpXG4gIHJldHVybiBjb25maWdcbn1cblxuLy8gY2hlY2sgaWYgdGhlIGxhYmVsIGlzIGR1cGxpY2F0ZWQgd2l0aCBpdHMgc2libGluZ3NcbmV4cG9ydCBmdW5jdGlvbiBpc0xhYmVsRHVwbGljYXRlZCAoYXBwQ29uZmlnOiBBcHBDb25maWcgfCBJTUFwcENvbmZpZywgdHlwZTogJ3BhZ2UnIHwgJ3ZpZXcnIHwgJ2RpYWxvZycsIGlkOiBzdHJpbmcsIGxhYmVsOiBzdHJpbmcpIHtcbiAgbGV0IGNvbnRlbnRzXG4gIGlmICh0eXBlID09PSAncGFnZScpIHtcbiAgICBjb250ZW50cyA9IGFwcENvbmZpZy5wYWdlc1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICd2aWV3Jykge1xuICAgIGNvbnRlbnRzID0gYXBwQ29uZmlnLnZpZXdzXG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2RpYWxvZycpIHtcbiAgICBjb250ZW50cyA9IGFwcENvbmZpZy5kaWFsb2dzXG4gIH1cbiAgaWYgKCFjb250ZW50cykge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIHJldHVybiBPYmplY3Qua2V5cyhjb250ZW50cykuc29tZShjb250ZW50SWQgPT4ge1xuICAgIGlmIChjb250ZW50SWQgPT09IGlkKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgcmV0dXJuIGNvbnRlbnRzW2NvbnRlbnRJZF0ubGFiZWwgPT09IGxhYmVsXG4gIH0pXG59XG5cbndpbmRvdy5fZ2V0Q2xlYW5BcHBDb25maWcgPSBnZXRDbGVhbkFwcENvbmZpZ1xuIiwiaW1wb3J0IHsgcG9ydGFsVXJsVXRpbHMsIGdldEFwcFN0b3JlLCBpMThuIH0gZnJvbSAnamltdS1jb3JlJ1xuY29uc3QgaGVscERvY0pzb24gPSByZXF1aXJlKCdidWlsZGVyL2hlbHAtZG9jLmpzb24nKVxuXG5jb25zdCBzdXBwb3J0TGFuZ3VhZ2VzID0gWydlbicsICdkZScsICdlcycsICdmcicsICdqYScsICdydScsXG4gICd6aC1jbiddIC8vIFRPRE86IGFkZCBgYmdgIG9uY2UgaXQncyBzdXBwb3J0ZWQgaW4gb25saW5lIDkuNC5cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3VwcG9ydExhbmd1YWdlICgpOiBib29sZWFuIHtcbiAgY29uc3QgbG9jYWxlID0gd2luZG93LmxvY2FsZS50b0xvd2VyQ2FzZSgpXG4gIGxldCBzdXBwb3J0ID0gZmFsc2VcbiAgaWYgKHN1cHBvcnRMYW5ndWFnZXMuaW5jbHVkZXMobG9jYWxlKSkge1xuICAgIHN1cHBvcnQgPSB0cnVlXG4gIH0gZWxzZSB7XG4gICAgY29uc3Qgc3BsaXRMb2NhbGUgPSBsb2NhbGUuc3BsaXQoJy0nKVswXVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3VwcG9ydExhbmd1YWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHNwbGl0TG9jYWxlID09PSBzdXBwb3J0TGFuZ3VhZ2VzW2ldLnNwbGl0KCctJylbMF0pIHtcbiAgICAgICAgc3VwcG9ydCA9IHRydWVcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN1cHBvcnRcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIGhlbHBLZXkgcmVmZXJlbmNlIGhlbG9wLWRvYyBidWlsZC1hcHBzIHBhcnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEJ1aWxkQXBwc0hlbHBMaW5rIChoZWxwS2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gYXdhaXQgX2dldEhlbHBMaW5rVXJsKCdidWlsZC1hcHBzJywgaGVscEtleSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEhvbWVIZWxwTGluayAoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgaWYgKHdpbmRvdy5qaW11Q29uZmlnLmlzRGV2RWRpdGlvbikge1xuICAgIHJldHVybiBhd2FpdCBfZ2V0SGVscExpbmtVcmwodW5kZWZpbmVkLCAnaG9tZScsIHRydWUpXG4gIH1cbiAgcmV0dXJuIGF3YWl0IF9nZXRIZWxwTGlua1VybCgnZ2V0LXN0YXJ0ZWQnLCAnd2hhdC1pcy1hcmNnaXMtZXhwZXJpZW5jZS1idWlsZGVyJywgdHJ1ZSlcbiAgLy8gcmV0dXJuIF9nZXRIZWxwTGlua1VybCh1bmRlZmluZWQsICdob21lJylcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFdoYXRzTmV3TGluayAoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgcmV0dXJuIGF3YWl0IF9nZXRIZWxwTGlua1VybCgnZ2V0LXN0YXJ0ZWQnLCAnd2hhdHMtbmV3JywgdHJ1ZSlcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIGhlbHBLZXkgdGhlIG5hbWUgcHJvcCBpbiB0aGUgd2lkZ2V0IG1hbmlmZXN0XG4gKiBpbmNsdWRlIHNlY3Rpb24gYW5kIGxheW91dCB3aWRnZXRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFdpZGdldEhlbHBMaW5rIChoZWxwS2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gYXdhaXQgX2dldEhlbHBMaW5rVXJsKCd3aWRnZXRzJywgaGVscEtleSlcbn1cblxuYXN5bmMgZnVuY3Rpb24gX2dldEhlbHBMaW5rVXJsICh0eXBlOiAnd2lkZ2V0cycgfCAnYnVpbGQtYXBwcycgfCAnZ2V0LXN0YXJ0ZWQnLCBoZWxwS2V5OiBzdHJpbmcsIGlzSG9tZT86IGJvb2xlYW4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBsZXQgaGVscElkID0gbnVsbFxuICBoZWxwS2V5ID0gaGVscEtleS50b0xvd2VyQ2FzZSgpXG4gIGxldCBiYXNlVXJsXG4gIGlmICh3aW5kb3cuamltdUNvbmZpZy5pc0RldkVkaXRpb24pIHsgLy8gbWFzdGVyLWRldi5cbiAgICBiYXNlVXJsID0gJ2h0dHBzOi8vZGV2ZWxvcGVycy5hcmNnaXMuY29tL2V4cGVyaWVuY2UtYnVpbGRlci8nXG5cbiAgICBjb25zdCBoZWxwRG9jID0gaGVscERvY0pzb24uZGV2XG4gICAgaWYgKHR5cGUpIHtcbiAgICAgIGhlbHBJZCA9IGAke2hlbHBEb2NbdHlwZV0ucHJlZml4fSR7aGVscERvY1t0eXBlXVtoZWxwS2V5XX1gXG4gICAgfSBlbHNlIHtcbiAgICAgIGhlbHBJZCA9IGAke2hlbHBEb2NbaGVscEtleV19YFxuICAgIH1cblxuICAgIGxldCBvbmxpbmVIZWxwID0gYmFzZVVybCArICcjJ1xuICAgIGlmICghaGVscElkKSB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG9ubGluZUhlbHApXG4gICAgfVxuICAgIG9ubGluZUhlbHAgPSBiYXNlVXJsICsgaGVscElkXG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShvbmxpbmVIZWxwKVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IHBvcnRhbFVybCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmxcbiAgICBpZiAoIXdpbmRvdy5qaW11Q29uZmlnLmlzSW5Qb3J0YWwpIHtcbiAgICAgIGNvbnN0IGhlbHBEb2MgPSBoZWxwRG9jSnNvbi5vbmxpbmVcbiAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgIGhlbHBJZCA9IGAke2hlbHBEb2NbdHlwZV0ucHJlZml4fSR7aGVscERvY1t0eXBlXVtoZWxwS2V5XX1gXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoZWxwSWQgPSBgJHtoZWxwRG9jW2hlbHBLZXldfWBcbiAgICAgIH1cbiAgICAgIGNvbnN0IGlzUHJvZCA9IHBvcnRhbFVybC5pbmNsdWRlcygnbWFwcy5hcmNnaXMuY29tJykgfHwgcG9ydGFsVXJsLmluY2x1ZGVzKCd3d3cuYXJjZ2lzLmNvbScpXG4gICAgICBjb25zdCBsZWFkID0gaXNQcm9kID8gJ2RvYycgOiAnZG9jZGV2J1xuICAgICAgYmFzZVVybCA9ICdodHRwczovLycgKyBsZWFkICsgJy5hcmNnaXMuY29tL2VuJyArICcvZXhwZXJpZW5jZS1idWlsZGVyLydcbiAgICAgIGxldCBvbmxpbmVIZWxwID0gYmFzZVVybCArICcjJ1xuICAgICAgaWYgKCFoZWxwSWQpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShvbmxpbmVIZWxwKVxuICAgICAgfVxuICAgICAgb25saW5lSGVscCA9IGJhc2VVcmwgKyBoZWxwSWRcbiAgICAgIGlmICghaXNTdXBwb3J0TGFuZ3VhZ2UoKSkge1xuICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG9ubGluZUhlbHApXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzZWxmVXJsID0gcG9ydGFsVXJsVXRpbHMuZ2V0UG9ydGFsU2VsZkluZm9VcmwocG9ydGFsVXJsKVxuICAgICAgICBjb25zdCBoZWxwVXJsID0gX2dldEhlbHBMaW5rRm9yQUdPTChzZWxmVXJsLCBoZWxwSWQsIG9ubGluZUhlbHApXG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoaGVscFVybClcbiAgICAgIH1cbiAgICB9IGVsc2UgeyAvLyBmb3IgcG9ydGFsXG4gICAgICBjb25zdCBwb3J0YWxMb2NhbGUgPSB3aW5kb3cubG9jYWxlIHx8ICdlbidcbiAgICAgIGNvbnN0IGhlbHBEb2MgPSBoZWxwRG9jSnNvbi5wb3J0YWxcbiAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgIGhlbHBJZCA9IGAke2hlbHBEb2NbdHlwZV1baGVscEtleV19YFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGVscElkID0gYCR7aGVscERvY1toZWxwS2V5XX1gXG4gICAgICB9XG4gICAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvanNvbidcbiAgICAgIH1cbiAgICAgIGNvbnN0IGhlbHBCYXNlID0gX2dldEhlbHBCYXNlRm9yUG9ydGFsKHBvcnRhbFVybCwgcG9ydGFsTG9jYWxlKVxuICAgICAgY29uc3QgaGVscEhvbWUgPSBoZWxwQmFzZS5pbmNsdWRlcygnaHR0cHM6JykgPyBoZWxwQmFzZSArICcvZXhwZXJpZW5jZS1idWlsZGVyJyA6IGhlbHBCYXNlXG4gICAgICByZXR1cm4gYXdhaXQgZmV0Y2gocG9ydGFsVXJsICsgJy9zaGFyaW5nL3Jlc3QvcG9ydGFscy9oZWxwbWFwP2Y9anNvbicsIHtcbiAgICAgICAgbWV0aG9kOiAnZ2V0JyxcbiAgICAgICAgaGVhZGVyczogaGVhZGVyc1xuICAgICAgfSlcbiAgICAgICAgLnRoZW4oYXN5bmMgcmVzID0+IGF3YWl0IHJlcy5qc29uKCkpXG4gICAgICAgIC50aGVuKGFzeW5jIGhlbHAgPT4ge1xuICAgICAgICAgIGlmIChoZWxwICYmIGhlbHAuaGVscE1hcCAmJiBoZWxwLmhlbHBNYXAubSAmJiBoZWxwSWQgJiYgaGVscC5oZWxwTWFwLm1baGVscElkXSkge1xuICAgICAgICAgICAgLy8gUG9ydGFsIHdpbGwgcmVkaXJlY3QgZW4gaGVscCBkb2MsIGlmIHBvcnRhbExvY2FsZSBoZWxwIGRvYyBkb2Vzbid0IGJlIGluc3RhbGxlZC5cbiAgICAgICAgICAgIGNvbnN0IHBvcnRhbEhlbHAgPSBoZWxwQmFzZSArICcvJyArIGhlbHAuaGVscE1hcC5tW2hlbHBJZF1cbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUocG9ydGFsSGVscClcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGlzSG9tZSA/IGF3YWl0IFByb21pc2UucmVzb2x2ZShoZWxwSG9tZSkgOiBhd2FpdCBnZXRIb21lSGVscExpbmsoKVxuICAgICAgICAgIH1cbiAgICAgICAgfSkuY2F0Y2goYXN5bmMgZXJyID0+IHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oZXJyKVxuICAgICAgICAgIHJldHVybiBpc0hvbWUgPyBhd2FpdCBQcm9taXNlLnJlc29sdmUoaGVscEhvbWUpIDogYXdhaXQgZ2V0SG9tZUhlbHBMaW5rKClcbiAgICAgICAgfSlcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gX2dldEhlbHBCYXNlRm9yUG9ydGFsIChwb3J0YWxVcmwsIHBvcnRhbExvY2FsZSk6IHN0cmluZyB7XG4gIGxldCBiYXNlVXJsID0gJydcbiAgY29uc3QgcG9ydGFsU2VsZiA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxTZWxmXG4gIGNvbnN0IHBhcnRzID0gcG9ydGFsU2VsZj8uaGVscEJhc2Uuc3BsaXQoJy8nKVxuXG4gIGlmIChwYXJ0cz8uaW5jbHVkZXMoJ2h0dHBzOicpKSB7IC8vIG9ubGluZTogJ2h0dHBzOi8vZW50ZXJwcmlzZS5hcmNnaXMuY29tL2VuLycsICdodHRwczovL2VudGVycHJpc2UtazhzLmFyY2dpcy5jb20vZW4vJ1xuICAgIGNvbnN0IGxvY2FsZSA9IGlzU3VwcG9ydExhbmd1YWdlKCkgPyBpMThuLmZpbmRMb2NhbGUod2luZG93LmxvY2FsZSwgc3VwcG9ydExhbmd1YWdlcykgOiAnZW4nXG4gICAgYmFzZVVybCA9IHBhcnRzLnNsaWNlKDAsIDMpLmpvaW4oJy8nKSArICcvJyArIGxvY2FsZVxuICB9IGVsc2UgeyAvLyBsb2NhbDogJy9naXMvcG9ydGFsaGVscC9lbicgKFdpbmRvd3MgJiBMaW51eDogJ3BvcnRhbGhlbHAnLCBLdWJlcm5ldGVzOiAnaGVscCcpXG4gICAgYmFzZVVybCA9IHBvcnRhbFVybCArICcvJyArIHBhcnRzPy5bMl0gKyAnLycgKyBwb3J0YWxMb2NhbGVcbiAgfVxuICByZXR1cm4gYmFzZVVybFxufVxuXG5mdW5jdGlvbiBfZ2V0SGVscExpbmtGb3JBR09MIChzZWxmVXJsOiBzdHJpbmcsIGhlbHBJZCwgZGVmYXVsdEhlbHBMaW5rOiBzdHJpbmcpIHtcbiAgbGV0IGJhc2VVcmxcbiAgY29uc3QgcG9ydGFsU2VsZiA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxTZWxmXG4gIGlmIChwb3J0YWxTZWxmICYmIHBvcnRhbFNlbGYuaGVscEJhc2UpIHtcbiAgICB0cnkge1xuICAgICAgLy8gVGhlIHJldHVybmVkIGxvY2FsZSBvZiBoZWxwQmFzZSBpcyBhbHJlYWR5IGluIHRoZSBzdXBwb3J0TGFuZ3VhZ2VzIGJ5IHJlcXVlc3Qgd2l0aCB3aW5kb3cubGNvYWxlLiBTbyBubyBuZWVkIHRvIGV4dHJhIGNoZWNrLlxuICAgICAgY29uc3QgcGFydHMgPSBwb3J0YWxTZWxmLmhlbHBCYXNlLnNwbGl0KCcvJykuc2xpY2UoMCwgNClcbiAgICAgIGJhc2VVcmwgPSBwYXJ0cy5qb2luKCcvJykgK1xuICAgICAgICAnL2V4cGVyaWVuY2UtYnVpbGRlci8nXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gZGVmYXVsdEhlbHBMaW5rXG4gICAgfVxuICAgIHJldHVybiBiYXNlVXJsID8gKGJhc2VVcmwgKyBoZWxwSWQpIDogZGVmYXVsdEhlbHBMaW5rXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGRlZmF1bHRIZWxwTGlua1xuICB9XG59XG4iLCJpbXBvcnQge1xuICBJbW11dGFibGUsXG4gIHR5cGUgTGF5b3V0SW5mbyxcbiAgdHlwZSBJTUFwcExheW91dHMsXG4gIHR5cGUgQXBwTGF5b3V0cyxcbiAgdHlwZSBBcHBDb25maWcsXG4gIHR5cGUgU2l6ZU1vZGVMYXlvdXRKc29uLFxuICBMYXlvdXRJdGVtVHlwZVxufSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyB1dGlscyB9IGZyb20gJ2ppbXUtbGF5b3V0cy9sYXlvdXQtcnVudGltZSdcblxuLyoqXG4gKiBSZW1vdmUgdGhlIGl0ZW0gaWQgZnJvbSBpdHMgcGFyZW50J3MgY29udGVudFxuICogQHBhcmFtIGxheW91dEluZm9cbiAqIEBwYXJhbSBkZWxldGVGcm9tTGF5b3V0XG4gKiBAcGFyYW0gbGF5b3V0c1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlSXRlbUZyb21QYXJlbnQgKFxuICBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvLFxuICBkZWxldGVGcm9tTGF5b3V0OiBib29sZWFuLFxuICBsYXlvdXRzOiBJTUFwcExheW91dHNcbik6IElNQXBwTGF5b3V0cyB7XG4gIGNvbnN0IHsgbGF5b3V0SWQsIGxheW91dEl0ZW1JZCB9ID0gbGF5b3V0SW5mb1xuICBpZiAoIWxheW91dHNbbGF5b3V0SWRdKSB7XG4gICAgcmV0dXJuIGxheW91dHNcbiAgfVxuICBjb25zdCBsYXlvdXRJdGVtID0gbGF5b3V0c1tsYXlvdXRJZF0uY29udGVudFtsYXlvdXRJdGVtSWRdXG4gIGlmICghbGF5b3V0SXRlbSkge1xuICAgIHJldHVybiBsYXlvdXRzXG4gIH1cbiAgY29uc3QgbGF5b3V0ID0gbGF5b3V0c1tsYXlvdXRJZF1cbiAgbGV0IHVwZGF0ZWRMYXlvdXRzID0gSW1tdXRhYmxlKGxheW91dHMpXG4gIGlmIChsYXlvdXQub3JkZXIgJiYgbGF5b3V0Lm9yZGVyLmluY2x1ZGVzKGxheW91dEl0ZW1JZCkpIHtcbiAgICBjb25zdCBmaWx0ZXJDb250ZW50ID0gW11cbiAgICBsYXlvdXQub3JkZXIuZm9yRWFjaChpZCA9PiB7XG4gICAgICBpZiAoaWQgIT09IGxheW91dEl0ZW1JZCkge1xuICAgICAgICBmaWx0ZXJDb250ZW50LnB1c2goaWQpXG4gICAgICB9XG4gICAgfSlcbiAgICB1cGRhdGVkTGF5b3V0cyA9IHVwZGF0ZWRMYXlvdXRzLnNldEluKFtsYXlvdXRJZCwgJ29yZGVyJ10sIGZpbHRlckNvbnRlbnQpXG4gIH1cbiAgaWYgKGRlbGV0ZUZyb21MYXlvdXQpIHtcbiAgICB1cGRhdGVkTGF5b3V0cyA9IHVwZGF0ZWRMYXlvdXRzLnNldEluKFxuICAgICAgW2xheW91dElkLCAnY29udGVudCddLFxuICAgICAgKHVwZGF0ZWRMYXlvdXRzW2xheW91dElkXS5jb250ZW50IGFzIGFueSkud2l0aG91dChsYXlvdXRJdGVtSWQpXG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIHVwZGF0ZWRMYXlvdXRzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbXB0eUxheW91dEl0ZW0gKFxuICBsYXlvdXRJZDogc3RyaW5nLFxuICBsYXlvdXRzOiBJTUFwcExheW91dHNcbik6IHtcbiAgICBsYXlvdXRJbmZvOiBMYXlvdXRJbmZvXG4gICAgbGF5b3V0czogSU1BcHBMYXlvdXRzXG4gIH0ge1xuICBjb25zdCBuZXh0SWQgPSB1dGlscy5nZXRNYXhpbXVtSWQobGF5b3V0c1tsYXlvdXRJZF0pICsgMVxuICBsZXQgdXBkYXRlZExheW91dHM6IElNQXBwTGF5b3V0cyA9IEltbXV0YWJsZShsYXlvdXRzKVxuXG4gIGNvbnN0IG5ld0l0ZW0gPSB7XG4gICAgaWQ6IGAke25leHRJZH1gXG4gIH1cblxuICB1cGRhdGVkTGF5b3V0cyA9IHVwZGF0ZWRMYXlvdXRzLnNldEluKFtsYXlvdXRJZCwgJ2NvbnRlbnQnLCBuZXdJdGVtLmlkXSwgbmV3SXRlbSlcblxuICByZXR1cm4ge1xuICAgIGxheW91dEluZm86IHtcbiAgICAgIGxheW91dElkOiBsYXlvdXRJZCxcbiAgICAgIGxheW91dEl0ZW1JZDogbmV3SXRlbS5pZFxuICAgIH0sXG4gICAgbGF5b3V0czogdXBkYXRlZExheW91dHNcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYW51cFJ1bnRpbWVMYXlvdXRzIChsYXlvdXRzOiBBcHBMYXlvdXRzKTogQXBwTGF5b3V0cyB7XG4gIE9iamVjdC5rZXlzKGxheW91dHMpLmZvckVhY2gobGF5b3V0SWQgPT4ge1xuICAgIGNvbnN0IGxheW91dCA9IGxheW91dHNbbGF5b3V0SWRdXG4gICAgZGVsZXRlIGxheW91dC5pZFxuXG4gICAgaWYgKGxheW91dC5jb250ZW50KSB7XG4gICAgICBPYmplY3Qua2V5cyhsYXlvdXQuY29udGVudCkuZm9yRWFjaChpZCA9PiB7XG4gICAgICAgIGNvbnN0IGxheW91dEl0ZW0gPSBsYXlvdXQuY29udGVudFtpZF1cbiAgICAgICAgZGVsZXRlIGxheW91dEl0ZW0uaWRcbiAgICAgIH0pXG4gICAgfVxuICB9KVxuICByZXR1cm4gbGF5b3V0c1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYW51cExheW91dFN0cnVjdHVyZSAoYXBwQ29uZmlnOiBBcHBDb25maWcsIGxheW91dElkOiBzdHJpbmcpOiBBcHBDb25maWcge1xuICBjb25zdCBsYXlvdXQgPSBhcHBDb25maWcubGF5b3V0c1tsYXlvdXRJZF1cbiAgaWYgKCFsYXlvdXQpIHtcbiAgICByZXR1cm4gYXBwQ29uZmlnXG4gIH1cblxuICBkZWxldGUgbGF5b3V0LnBhcmVudFxuXG4gIE9iamVjdC5rZXlzKGxheW91dC5jb250ZW50ID8/IHt9KS5mb3JFYWNoKChpdGVtSWQpID0+IHtcbiAgICBjb25zdCBsYXlvdXRJdGVtID0gbGF5b3V0LmNvbnRlbnRbaXRlbUlkXVxuXG4gICAgc3dpdGNoIChsYXlvdXRJdGVtLnR5cGUpIHtcbiAgICAgIGNhc2UgTGF5b3V0SXRlbVR5cGUuV2lkZ2V0OlxuICAgICAge1xuICAgICAgICBjb25zdCB3aWRnZXRKc29uID0gYXBwQ29uZmlnLndpZGdldHNbbGF5b3V0SXRlbS53aWRnZXRJZF1cbiAgICAgICAgaWYgKHdpZGdldEpzb24pIHtcbiAgICAgICAgICBkZWxldGUgd2lkZ2V0SnNvbi5wYXJlbnRcblxuICAgICAgICAgIGlmICh3aWRnZXRKc29uLmxheW91dHMpIHtcbiAgICAgICAgICAgIE9iamVjdC52YWx1ZXMod2lkZ2V0SnNvbi5sYXlvdXRzKS5mb3JFYWNoKChsYXlvdXRzKSA9PiB7XG4gICAgICAgICAgICAgIGFwcENvbmZpZyA9IGNsZWFudXBTaXplbW9kZUxheW91dFN0cnVjdHVyZShhcHBDb25maWcsIGxheW91dHMpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSBMYXlvdXRJdGVtVHlwZS5TZWN0aW9uOlxuICAgICAge1xuICAgICAgICBjb25zdCBzZWN0aW9uSnNvbiA9IGFwcENvbmZpZy5zZWN0aW9uc1tsYXlvdXRJdGVtLnNlY3Rpb25JZF1cbiAgICAgICAgZGVsZXRlIHNlY3Rpb25Kc29uLnBhcmVudFxuXG4gICAgICAgIHNlY3Rpb25Kc29uLnZpZXdzLmZvckVhY2godmlld0lkID0+IHtcbiAgICAgICAgICBjb25zdCB2aWV3SnNvbiA9IGFwcENvbmZpZy52aWV3c1t2aWV3SWRdXG4gICAgICAgICAgZGVsZXRlIHZpZXdKc29uLnBhcmVudFxuICAgICAgICAgIGFwcENvbmZpZyA9IGNsZWFudXBTaXplbW9kZUxheW91dFN0cnVjdHVyZShhcHBDb25maWcsIHZpZXdKc29uLmxheW91dClcbiAgICAgICAgfSlcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgTGF5b3V0SXRlbVR5cGUuU2NyZWVuR3JvdXA6XG4gICAgICB7XG4gICAgICAgIGNvbnN0IHNnSnNvbiA9IGFwcENvbmZpZy5zY3JlZW5Hcm91cHNbbGF5b3V0SXRlbS5zY3JlZW5Hcm91cElkXVxuICAgICAgICBkZWxldGUgc2dKc29uLnBhcmVudFxuXG4gICAgICAgIHNnSnNvbi5zY3JlZW5zLmZvckVhY2goc2NyZWVuSWQgPT4ge1xuICAgICAgICAgIGNvbnN0IHNjcmVlbkpzb24gPSBhcHBDb25maWcuc2NyZWVuc1tzY3JlZW5JZF1cbiAgICAgICAgICBkZWxldGUgc2NyZWVuSnNvbi5wYXJlbnRcbiAgICAgICAgICBhcHBDb25maWcgPSBjbGVhbnVwU2l6ZW1vZGVMYXlvdXRTdHJ1Y3R1cmUoYXBwQ29uZmlnLCBzY3JlZW5Kc29uLm1haW4ubGF5b3V0KVxuICAgICAgICAgIGlmIChzY3JlZW5Kc29uLnBhbmVsPy5sYXlvdXQpIHtcbiAgICAgICAgICAgIGFwcENvbmZpZyA9IGNsZWFudXBTaXplbW9kZUxheW91dFN0cnVjdHVyZShhcHBDb25maWcsIHNjcmVlbkpzb24ucGFuZWwubGF5b3V0KVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gIH0pXG4gIHJldHVybiBhcHBDb25maWdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFudXBTaXplbW9kZUxheW91dFN0cnVjdHVyZSAoYXBwQ29uZmlnOiBBcHBDb25maWcsIHNpemVNb2RlTGF5b3V0OiBTaXplTW9kZUxheW91dEpzb24pOiBBcHBDb25maWcge1xuICBPYmplY3QudmFsdWVzKHNpemVNb2RlTGF5b3V0ID8/IHt9KS5mb3JFYWNoKGxheW91dElkID0+IHtcbiAgICBhcHBDb25maWcgPSBjbGVhbnVwTGF5b3V0U3RydWN0dXJlKGFwcENvbmZpZywgbGF5b3V0SWQpXG4gIH0pXG4gIHJldHVybiBhcHBDb25maWdcbn1cbiIsImltcG9ydCB7XG4gIGFwcENvbmZpZ1V0aWxzLFxuICBpMThuLFxuICB1dGlsc1xufSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgdHlwZSB7IFRlbXBsYXRlIH0gZnJvbSAnLi4vdGVtcGxhdGVzL3R5cGUnXG5cbi8qKlxuICpcbiAqIEBwYXJhbSB0ZW1wbGF0ZUpzb25cbiAqIEBwYXJhbSB3aWRnZXRJZCB3aWRnZXQgbmFtZSBpcyB1c2VkIHRvIGdldCB0cmFuc2xhdGlvbi4gVGhpcyBpcyBmb3IgdGhlIGNhc2UgdGhhdCB3aWRnZXQgaGFzIGludGVybmFsIHRlbXBsYXRlcyBzdWNoIGFzIGxpc3QsIGNhcmQsIGV0Yy5cbiAqICAgIGZvciBvdGhlciB0ZW1wbGF0ZXMsIHBhc3MgbnVsbFxuICogQHBhcmFtIGRlZmF1bHRNZXNzYWdlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcHJvY2Vzc0ZvclRlbXBsYXRlICh0ZW1wbGF0ZUpzb246IFRlbXBsYXRlLCB3aWRnZXRJZDogc3RyaW5nLCBkZWZhdWx0TWVzc2FnZXM6IGFueSk6IFRlbXBsYXRlIHtcbiAgdGVtcGxhdGVKc29uPy5jb25maWcgJiYgYXBwQ29uZmlnVXRpbHMuZml4TGF5b3V0SWRzKHRlbXBsYXRlSnNvbi5jb25maWcgYXMgYW55KVxuICBjb25zdCBpbnRsID0gd2lkZ2V0SWQgPyBpMThuLmdldEludGwod2lkZ2V0SWQsICdzZXR0aW5nJykgOiBpMThuLmdldEludGwoKVxuICB0ZW1wbGF0ZUpzb24gPSB1dGlscy5yZXBsYWNlSTE4blBsYWNlaG9sZGVyc0luT2JqZWN0KHRlbXBsYXRlSnNvbiwgaW50bCwgZGVmYXVsdE1lc3NhZ2VzKVxuICByZXR1cm4gdGVtcGxhdGVKc29uXG59XG4iLCJpbXBvcnQge1xuICBhcHBDb25maWdVdGlscywgZXNyaSwgZ2V0QXBwU3RvcmUsIGkxOG4sIHR5cGUgSU1QYWdlSnNvbixcbiAgdHlwZSBMYXlvdXRJdGVtQ29uc3RydWN0b3JQcm9wcywgTGF5b3V0SXRlbVR5cGUsIG1vZHVsZUxvYWRlciwgUGFnZVR5cGUsIFNlc3Npb25NYW5hZ2VyLCB0eXBlIEljb25SZXN1bHRcbn0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHBhZ2VJY29uIGZyb20gJ2ppbXUtaWNvbnMvc3ZnL291dGxpbmVkL2RhdGEvcGFnZS5zdmcnXG5pbXBvcnQgbGlua0ljb24gZnJvbSAnamltdS1pY29ucy9zdmcvb3V0bGluZWQvZGF0YS9saW5rLXRpbHRlZC5zdmcnXG5pbXBvcnQgZm9sZGVySWNvbiBmcm9tICdqaW11LWljb25zL3N2Zy9vdXRsaW5lZC9hcHBsaWNhdGlvbi9mb2xkZXIuc3ZnJ1xuaW1wb3J0IGRpYWxvZ0ljb24gZnJvbSAnamltdS1pY29ucy9zdmcvb3V0bGluZWQvYXBwbGljYXRpb24vZGlhbG9nLnN2ZydcbmltcG9ydCBzZWN0aW9uSWNvbiBmcm9tICdqaW11LWljb25zL3N2Zy9vdXRsaW5lZC9icmFuZC93aWRnZXQtc2VjdGlvbi5zdmcnXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0VG9jUGFnZUljb24gKHBhZ2VKc29uOiBJTVBhZ2VKc29uLCBmb3JtYXRNZXNzYWdlPywgcGFnZWxhYmVsPzogc3RyaW5nKTogSWNvblJlc3VsdCB7XG4gIGxldCBpY29uXG4gIGlmIChwYWdlSnNvbi50eXBlID09PSBQYWdlVHlwZS5Gb2xkZXIpIHtcbiAgICBpY29uID0ge1xuICAgICAgc3ZnOiBmb2xkZXJJY29uLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBmaWxlbmFtZTogJ2ZvbGRlcicsXG4gICAgICAgIG9yaWdpbmFsTmFtZTogJ291dGxpbmVkL2FwcGxpY2F0aW9uL2ZvbGRlci5zdmcnLFxuICAgICAgICBwYXRoOiBbJ2dlbmVyYWwnLCAnZm9sZGVyJ10sXG4gICAgICAgIGNvbG9yOiAndmFyKC0tZGFyay04MDApJyxcbiAgICAgICAgaW5saW5lU3ZnOiB0cnVlXG4gICAgICB9XG4gICAgfVxuICB9IGVsc2UgaWYgKHBhZ2VKc29uLnR5cGUgPT09IFBhZ2VUeXBlLkxpbmspIHtcbiAgICBpY29uID0ge1xuICAgICAgc3ZnOiBsaW5rSWNvbixcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZmlsZW5hbWU6ICdsaW5rJyxcbiAgICAgICAgb3JpZ2luYWxOYW1lOiAnb3V0bGluZWQvZGF0YS9saW5rLXRpbHRlZC5zdmcnLFxuICAgICAgICBwYXRoOiBbJ2dlbmVyYWwnLCAnbGluayddLFxuICAgICAgICBjb2xvcjogJ3ZhcigtLWRhcmstODAwKScsXG4gICAgICAgIGlubGluZVN2ZzogdHJ1ZVxuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpY29uID0ge1xuICAgICAgc3ZnOiBwYWdlSWNvbixcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZmlsZW5hbWU6IHBhZ2VsYWJlbCB8fCBmb3JtYXRNZXNzYWdlPy4oJ3BhZ2UnKSB8fCAnJyxcbiAgICAgICAgb3JpZ2luYWxOYW1lOiAnb3V0bGluZWQvZGF0YS9wYWdlLnN2ZycsXG4gICAgICAgIGNvbG9yOiAndmFyKC0tZGFyay04MDApJyxcbiAgICAgICAgaW5saW5lU3ZnOiB0cnVlXG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBpY29uXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0VG9jRGlhbG9nSWNvbiAoKTogUmVhY3QuQ29tcG9uZW50Q2xhc3M8UmVhY3QuU1ZHQXR0cmlidXRlczxTVkdFbGVtZW50Pj4ge1xuICByZXR1cm4gZGlhbG9nSWNvblxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdFNlY3Rpb25JY29uICgpOiBSZWFjdC5Db21wb25lbnRDbGFzczxSZWFjdC5TVkdBdHRyaWJ1dGVzPFNWR0VsZW1lbnQ+PiB7XG4gIHJldHVybiBzZWN0aW9uSWNvblxufVxuXG4vKipcbiAqIEdldCByZWxhdGVkIHBhZ2UgaWQgYnkgZGlhbG9nJ3MgaWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYWdlTGlzdEJ5RGlhbG9nSWQgKHBhZ2VzLCBkaWFsb2dJZDogc3RyaW5nKTogYW55W10ge1xuICBpZiAoIXBhZ2VzKSB7XG4gICAgcmV0dXJuIFtdXG4gIH1cbiAgY29uc3QgcGFnZUxpc3QgPSBbXVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgT2JqZWN0LmtleXMocGFnZXMpLnNvbWUoaWQgPT4ge1xuICAgIGlmIChwYWdlc1tpZF0uYXV0b09wZW5EaWFsb2dJZCA9PT0gZGlhbG9nSWQpIHtcbiAgICAgIHBhZ2VMaXN0LnB1c2goeyBpZDogaWQsIGxhYmVsOiBwYWdlc1tpZF0ubGFiZWwgfSlcbiAgICB9XG4gIH0pXG4gIHJldHVybiBwYWdlTGlzdFxufVxuXG5sZXQgZmV0Y2hDb21tb25XaWRnZXRMaXN0UHJvbWlzZTogUHJvbWlzZTxMYXlvdXRJdGVtQ29uc3RydWN0b3JQcm9wc1tdPiA9IG51bGxcbmV4cG9ydCBmdW5jdGlvbiBmZXRjaENvbW1vbldpZGdldExpc3QgKCk6IFByb21pc2U8TGF5b3V0SXRlbUNvbnN0cnVjdG9yUHJvcHNbXT4ge1xuICBpZiAoIWZldGNoQ29tbW9uV2lkZ2V0TGlzdFByb21pc2UpIHtcbiAgICBmZXRjaENvbW1vbldpZGdldExpc3RQcm9taXNlID0gZmV0Y2goYCR7bW9kdWxlTG9hZGVyLnJlc29sdmVNb2R1bGVGdWxsUGF0aCgnd2lkZ2V0cy8nKX0vd2lkZ2V0cy1pbmZvLmpzb25gKS50aGVuKGFzeW5jIHJlcyA9PiBhd2FpdCByZXMuanNvbigpKS50aGVuKCh3aWRnZXRJbmZvOiBhbnlbXSkgPT4ge1xuICAgICAgY29uc3QgbGlzdCA9IHdpZGdldEluZm8ubWFwKHcgPT4ge1xuICAgICAgICB3Lm1hbmlmZXN0ID0gYXBwQ29uZmlnVXRpbHMuYWRkV2lkZ2V0TWFuaWZlc3RQcm9wZXJ0aWVzKHcubWFuaWZlc3QpXG4gICAgICAgIGNvbnN0IGxvY2FsZSA9IGkxOG4uZmluZExvY2FsZShnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwQ29udGV4dC5sb2NhbGUsIHcubWFuaWZlc3QudHJhbnNsYXRlZExvY2FsZXMpXG4gICAgICAgIGNvbnN0IGxpc3RJdGVtVGVtcGxhdGU6IExheW91dEl0ZW1Db25zdHJ1Y3RvclByb3BzID0ge1xuICAgICAgICAgIGl0ZW1UeXBlOiBMYXlvdXRJdGVtVHlwZS5XaWRnZXQsXG4gICAgICAgICAgbmFtZTogdy5uYW1lLFxuICAgICAgICAgIGxhYmVsOiB3LmkxOG5MYWJlbD8uW2xvY2FsZV0gfHwgdy5tYW5pZmVzdC5sYWJlbCB8fCB3Lm5hbWUsXG4gICAgICAgICAgZGVzcmlwdGlvbjogdy5pMThuRGVzY3JpcHRpb24/Lltsb2NhbGVdIHx8IHcubWFuaWZlc3QuZGVzcmlwdGlvbiB8fCB3Lm5hbWUsXG4gICAgICAgICAgdXJpOiB3LnVyaSxcbiAgICAgICAgICBtYW5pZmVzdDogdy5tYW5pZmVzdCxcbiAgICAgICAgICBpY29uOiAnLi4vJyArIHcuaWNvbixcbiAgICAgICAgICBncm91cDogdy5ncm91cCxcbiAgICAgICAgICBvcmRlcjogdy5vcmRlclxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0SXRlbVRlbXBsYXRlXG4gICAgICB9KVxuICAgICAgcmV0dXJuIGxpc3RcbiAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIGNvbW1vbiB3aWRnZXQgbGlzdC4gJywgZXJyKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiBmZXRjaENvbW1vbldpZGdldExpc3RQcm9taXNlXG59XG5cbmxldCBmZXRjaFJlbW90ZUN1c3RvbVdpZGdldExpc3RQcm9taXNlOiBQcm9taXNlPExheW91dEl0ZW1Db25zdHJ1Y3RvclByb3BzW10+ID0gbnVsbFxuLyoqXG4gKiBGZXRjaCByZW1vdGUgY3VzdG9tIHdpZGdldHMgZnJvbSBBR09MIG9yIHBvcnRhbC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZldGNoUmVtb3RlQ3VzdG9tV2lkZ2V0TGlzdCAoKTogUHJvbWlzZTxMYXlvdXRJdGVtQ29uc3RydWN0b3JQcm9wc1tdPiB7XG4gIGlmICghc2hvd1JlbW90ZUN1c3RvbVdpZGdldHMoKSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW10pXG4gIH1cblxuICBpZiAoIWZldGNoUmVtb3RlQ3VzdG9tV2lkZ2V0TGlzdFByb21pc2UpIHtcbiAgICAvLyBjb25zdCBpc1BvcnRhbCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxTZWxmPy5pc1BvcnRhbFxuICAgIGNvbnN0IHEgPSAndHlwZTpcIkV4cGVyaWVuY2UgQnVpbGRlciBXaWRnZXRcIiBBTkQgdHlwZWtleXdvcmRzOlwiV2lkZ2V0XCInIC8vICd0eXBlOlwiRXhwZXJpZW5jZSBCdWlsZGVyIFdpZGdldFwiIEFORCB0eXBla2V5d29yZHM6XCJIb3N0ZWQgV2lkZ2V0XCInXG4gICAgZmV0Y2hSZW1vdGVDdXN0b21XaWRnZXRMaXN0UHJvbWlzZSA9IGVzcmkucmVzdFBvcnRhbC5zZWFyY2hJdGVtcyh7IHEsIG51bTogMTAwLCBzdGFydDogMCwgYXV0aGVudGljYXRpb246IFNlc3Npb25NYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0U2Vzc2lvbkJ5VXJsKGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxVcmwpIH0pLnRoZW4ocmVzID0+IHJlcy5yZXN1bHRzKS50aGVuKGl0ZW1zID0+IHtcbiAgICAgIGxldCBsaXN0OiBMYXlvdXRJdGVtQ29uc3RydWN0b3JQcm9wc1tdID0gW11cbiAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgIGlmICghaXRlbS51cmwpIHtcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1cmkgPSBnZXRDdXN0b21VcmlCeUl0ZW1VcmwoaXRlbS51cmwpXG4gICAgICAgIGNvbnN0IHdpZGdldENvbnRleHQgPSBhcHBDb25maWdVdGlscy5nZXRXaWRnZXRDb250ZXh0KHVyaSlcbiAgICAgICAgY29uc3QgbGlzdEl0ZW1UZW1wbGF0ZTogTGF5b3V0SXRlbUNvbnN0cnVjdG9yUHJvcHMgPSB7XG4gICAgICAgICAgaXRlbVR5cGU6IExheW91dEl0ZW1UeXBlLldpZGdldCxcbiAgICAgICAgICBuYW1lOiBpdGVtLnVybCwgLy8gVE9ETyBwYXJzZSB1cmxcbiAgICAgICAgICBsYWJlbDogaXRlbS50aXRsZSxcbiAgICAgICAgICBpdGVtSWQ6IGl0ZW0uaWQsXG4gICAgICAgICAgbWFuaWZlc3Q6IHt9LFxuICAgICAgICAgIGljb246IGAke3dpZGdldENvbnRleHQuZm9sZGVyVXJsfWljb24uc3ZnYCxcbiAgICAgICAgICB1cmk6IHdpZGdldENvbnRleHQuZm9sZGVyVXJsLFxuICAgICAgICAgIGdyb3VwOiBDVVNUT01fR1JPVVAsXG4gICAgICAgICAgb3JkZXI6IGluZGV4XG4gICAgICAgIH1cbiAgICAgICAgbGlzdCA9IGxpc3QuY29uY2F0KGxpc3RJdGVtVGVtcGxhdGUpXG4gICAgICB9KVxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZChsaXN0Lm1hcChsID0+IGZldGNoKGAke2wudXJpfW1hbmlmZXN0Lmpzb25gKS50aGVuKHJlcyA9PiByZXMuanNvbigpKSkpLnRoZW4ocmVzID0+IHJlcy5tYXAociA9PiByLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyByLnZhbHVlIDogbnVsbCkpLnRoZW4obWFuaWZlc3RzID0+IHtcbiAgICAgICAgcmV0dXJuIGxpc3QubWFwKChsLCBpKSA9PiAoeyAuLi5sLCBtYW5pZmVzdDogbWFuaWZlc3RzW2ldIHx8IHsgZGVmYXVsdFNpemU6IHsgd2lkdGg6IDQwMCwgaGVpZ2h0OiA0MDAgfSB9IH0pKVxuICAgICAgfSlcbiAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIGN1c3RvbSB3aWRnZXQgbGlzdC4gJywgZXJyKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiBmZXRjaFJlbW90ZUN1c3RvbVdpZGdldExpc3RQcm9taXNlXG59XG5cbmZ1bmN0aW9uIGdldEN1c3RvbVVyaUJ5SXRlbVVybCAoaXRlbVVybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgbGV0IHVyaVxuICBpZiAoL21hbmlmZXN0XFwuanNvbiQvLnRlc3QoaXRlbVVybCkpIHtcbiAgICB1cmkgPSBpdGVtVXJsLnN1YnN0cmluZygwLCBpdGVtVXJsLmxlbmd0aCAtICdtYW5pZmVzdC5qc29uJy5sZW5ndGgpXG4gIH0gZWxzZSBpZiAoL1xcLyQvLnRlc3QoaXRlbVVybCkpIHtcbiAgICB1cmkgPSBpdGVtVXJsXG4gIH0gZWxzZSB7XG4gICAgdXJpID0gaXRlbVVybCArICcvJ1xuICB9XG5cbiAgdXJpID0gdXJpLnJlcGxhY2UoL15odHRwOlxcL1xcLy8sICdodHRwczovLycpXG5cbiAgcmV0dXJuIHVyaVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvd1JlbW90ZUN1c3RvbVdpZGdldHMgKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbnRleHQ/LmppbXVDb25maWc/LmlzSW5Qb3J0YWxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dDdXN0b21XaWRnZXRzIChjb21tb25XaWRnZXRMaXN0OiBMYXlvdXRJdGVtQ29uc3RydWN0b3JQcm9wc1tdKTogYm9vbGVhbiB7XG4gIHJldHVybiBzaG93UmVtb3RlQ3VzdG9tV2lkZ2V0cygpIHx8IGNvbW1vbldpZGdldExpc3Q/LnNvbWUodyA9PiB3Lmdyb3VwID09PSBDVVNUT01fR1JPVVApXG59XG5cbmV4cG9ydCBjb25zdCBDVVNUT01fR1JPVVAgPSA3XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHdpdGhUaGVtZSB9IGZyb20gJ2ppbXUtdGhlbWUnXG5pbXBvcnQgeyB0eXBlIElNV2lkZ2V0SnNvbiwgZ2V0QXBwU3RvcmUsIG1vZHVsZUxvYWRlciwgdHlwZSBJTVN0YXRlLCB0eXBlIEltbXV0YWJsZU9iamVjdCwgUmVhY3RSZWR1eCwgb2JzZXJ2ZVN0b3JlLCB0eXBlIElNV2lkZ2V0TWFuaWZlc3QsIGxvYWREZXBlbmRlbmNpZXMsIGkxOG4sIEludGxQcm92aWRlciwgaW5qZWN0SW50bCB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IGJ1aWxkZXJBY3Rpb25zIH0gZnJvbSAnLi9idWlsZGVyLXN0YXRlLXN0b3JlLWV4dGVuc2lvbidcbmltcG9ydCB7IHR5cGUgV2lkZ2V0U2V0dGluZ1Byb3BzLCB0eXBlIFdpZGdldEl0ZW1TZXR0aW5nUHJvcHMsIHR5cGUgV2lkZ2V0U2V0dGluZ0luamVjdGVkUHJvcHMsIHR5cGUgQWxsV2lkZ2V0U2V0dGluZ1Byb3BzIH0gZnJvbSAnLi9wcm9wcydcblxuaW1wb3J0IHsgdHlwZSBSYXdXaWRnZXRTZXR0aW5nVHlwZSwgdHlwZSBXcmFwcGVkV2lkZ2V0U2V0dGluZ1R5cGUgfSBmcm9tICcuL2Jhc2Utd2lkZ2V0LXNldHRpbmcnXG5cbmNvbnN0IHsgZ2V0TG9jYWxlVG9Mb2FkLCBsb2FkTG9jYWxlTWVzc2FnZXMgfSA9IGkxOG5cblxuZXhwb3J0IGNsYXNzIFdpZGdldFNldHRpbmdNYW5hZ2VyIHtcbiAgc3RhdGljIGluc3RhbmNlOiBXaWRnZXRTZXR0aW5nTWFuYWdlclxuXG4gIC8qKiBSZXR1cm4gdGhlIHNpbmdsZXRvbiBgV2lkZ2V0U2V0dGluZ01hbmFnZXJgIGluc3RhbmNlLiAqL1xuICBzdGF0aWMgZ2V0SW5zdGFuY2UgKCkge1xuICAgIGlmICghV2lkZ2V0U2V0dGluZ01hbmFnZXIuaW5zdGFuY2UpIHtcbiAgICAgIFdpZGdldFNldHRpbmdNYW5hZ2VyLmluc3RhbmNlID0gbmV3IFdpZGdldFNldHRpbmdNYW5hZ2VyKClcbiAgICAgIHdpbmRvdy5fd2lkZ2V0U2V0dGluZ01hbmFnZXIgPSBXaWRnZXRTZXR0aW5nTWFuYWdlci5pbnN0YW5jZVxuICAgIH1cbiAgICByZXR1cm4gV2lkZ2V0U2V0dGluZ01hbmFnZXIuaW5zdGFuY2VcbiAgfVxuXG4gIGNvbnN0cnVjdG9yICgpIHtcbiAgICBvYnNlcnZlU3RvcmUodGhpcy5vblN0b3JlQ2hhbmdlLmJpbmQodGhpcyksIFsnYXBwU3RhdGVJbkJ1aWxkZXInLCAnYXBwQ29uZmlnJywgJ3dpZGdldHMnXSlcbiAgfVxuXG4gIHByaXZhdGUgc2V0dGluZ3M6IHtcbiAgICAvLyB1c2Ugd2lkZ2V0IHVyaSB0byBpZGVudGlmeSB3aWRnZXRzXG4gICAgW3dpZGdldFVyaTogc3RyaW5nXToge1xuICAgICAgcmF3U2V0dGluZ0NsYXp6OiBSYXdXaWRnZXRTZXR0aW5nVHlwZVxuICAgICAgc2V0dGluZ0NsYXp6OiBXcmFwcGVkV2lkZ2V0U2V0dGluZ1R5cGVcbiAgICAgIHNldHRpbmdDbGF6elByb21pc2U6IFByb21pc2U8V3JhcHBlZFdpZGdldFNldHRpbmdUeXBlPlxuXG4gICAgICBzZXR0aW5nSTE4bk1lc3NhZ2U6IGkxOG4uSTE4bk1lc3NhZ2VzXG4gICAgICBzZXR0aW5nSTE4bk1lc3NhZ2VQcm9taXNlOiBQcm9taXNlPGkxOG4uSTE4bk1lc3NhZ2VzPlxuXG4gICAgICByYXdJdGVtU2V0dGluZ0NsYXp6OiBSZWFjdC5Db21wb25lbnRDbGFzczxXaWRnZXRJdGVtU2V0dGluZ1Byb3BzPlxuICAgICAgaXRlbVNldHRpbmdDbGF6ejogUmVhY3QuQ29tcG9uZW50Q2xhc3M8V2lkZ2V0SXRlbVNldHRpbmdQcm9wcz5cbiAgICAgIGl0ZW1TZXR0aW5nQ2xhenpQcm9taXNlOiBQcm9taXNlPFJlYWN0LkNvbXBvbmVudENsYXNzPFdpZGdldEl0ZW1TZXR0aW5nUHJvcHM+PlxuICAgIH1cbiAgfSA9IHt9XG5cbiAgcHJpdmF0ZSBnZXRXaWRnZXRVcmkgKHdpZGdldElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGFwcENvbmZpZyA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwQ29uZmlnXG4gICAgcmV0dXJuIGFwcENvbmZpZz8ud2lkZ2V0cz8uW3dpZGdldElkXT8udXJpXG4gIH1cblxuICBwcml2YXRlIGdldFdpZGdldE1hbmlmZXN0QnlVcmkgKHVyaTogc3RyaW5nKTogSU1XaWRnZXRNYW5pZmVzdCB7XG4gICAgY29uc3Qgd2lkZ2V0cyA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwQ29uZmlnPy53aWRnZXRzXG4gICAgY29uc3Qgd2lkZ2V0SWQgPSBPYmplY3Qua2V5cyh3aWRnZXRzIHx8IHt9KS5maW5kKHdJZCA9PiB3aWRnZXRzW3dJZF0udXJpID09PSB1cmkpXG4gICAgcmV0dXJuIHdpZGdldHNbd2lkZ2V0SWRdPy5tYW5pZmVzdFxuICB9XG5cbiAgLy8gZm9yIGVhc3kgdGVzdFxuICB1cGRhdGVXaWRnZXRDYWNoZSAodXJpOiBzdHJpbmcsIG9iaikge1xuICAgIGlmICghdGhpcy5zZXR0aW5nc1t1cmldKSB7XG4gICAgICB0aGlzLnNldHRpbmdzW3VyaV0gPSB7fSBhcyBhbnlcbiAgICB9XG4gICAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgICAgdGhpcy5zZXR0aW5nc1t1cmldW2tdID0gb2JqW2tdXG4gICAgfVxuICB9XG5cbiAgZ2V0V2lkZ2V0U2V0dGluZ0NsYXNzICh3aWRnZXRJZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0dGluZ3NbdGhpcy5nZXRXaWRnZXRVcmkod2lkZ2V0SWQpXT8uc2V0dGluZ0NsYXp6XG4gIH1cblxuICBkZXN0cm95V2lkZ2V0U2V0dGluZ0NsYXNzICh3aWRnZXRJZDogc3RyaW5nKSB7XG4gICAgY29uc3QgdXJpID0gdGhpcy5nZXRXaWRnZXRVcmkod2lkZ2V0SWQpXG4gICAgaWYgKHVyaSkge1xuICAgICAgZGVsZXRlIHRoaXMuc2V0dGluZ3NbdXJpXVxuICAgIH1cbiAgfVxuXG4gIGRlc3Ryb3lXaWRnZXRTZXR0aW5nQ2xhc3NCeVVyaSAodXJpOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5jaGVja1dpZGdldFVyaUluQ29uZmlnKHVyaSkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBkZWxldGUgdGhpcy5zZXR0aW5nc1t1cmldXG4gIH1cblxuICBnZXRJdGVtU2V0dGluZ0NsYXNzICh3aWRnZXRJZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0dGluZ3NbdGhpcy5nZXRXaWRnZXRVcmkod2lkZ2V0SWQpXT8uaXRlbVNldHRpbmdDbGF6elxuICB9XG5cbiAgZ2V0U2V0dGluZ0kxOG5NZXNzYWdlc0J5VXJpICh3aWRnZXRVcmk6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLnNldHRpbmdzW3dpZGdldFVyaV0/LnNldHRpbmdJMThuTWVzc2FnZVxuICB9XG5cbiAgZGVzdG9yeUFsbFdpZGdldFNldHRpbmdDbGFzc2VzICgpIHtcbiAgICB0aGlzLnNldHRpbmdzID0ge31cbiAgfVxuXG4gIC8qKiBMb2FkIHRoZSB3aWRnZXQgc2V0dGluZyBjbGFzcyBieSB3aWRnZXQgaWQuIEEgd2lkZ2V0IHNldHRpbmcgY2xhc3MgaXMgbG9hZGVkIG9ubHkgb25lIHRpbWUuICovXG4gIGFzeW5jIGxvYWRXaWRnZXRTZXR0aW5nQ2xhc3MgKHdpZGdldElkOiBzdHJpbmcpOiBQcm9taXNlPFdyYXBwZWRXaWRnZXRTZXR0aW5nVHlwZT4ge1xuICAgIGNvbnN0IHdpZGdldEpzb24gPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwU3RhdGVJbkJ1aWxkZXI/LmFwcENvbmZpZz8ud2lkZ2V0cz8uW3dpZGdldElkXVxuICAgIGlmICghd2lkZ2V0SnNvbikge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShudWxsKVxuICAgIH1cblxuICAgIGlmICghd2lkZ2V0SnNvbi5tYW5pZmVzdCkge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShudWxsKVxuICAgIH1cblxuICAgIGNvbnN0IHdpZGdldFVyaSA9IHRoaXMuZ2V0V2lkZ2V0VXJpKHdpZGdldElkKVxuICAgIHJldHVybiB0aGlzLmxvYWRXaWRnZXRTZXR0aW5nQ2xhc3NCeVVyaSh3aWRnZXRVcmkpXG4gIH1cblxuICBwcml2YXRlIGNoZWNrV2lkZ2V0VXJpSW5Db25maWcgKHdpZGdldFVyaTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3Qgd2lkZ2V0cyA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwQ29uZmlnPy53aWRnZXRzIHx8IHt9XG4gICAgcmV0dXJuICEhT2JqZWN0LmtleXMod2lkZ2V0cykuZmluZCh3SWQgPT4gd2lkZ2V0c1t3SWRdLnVyaSA9PT0gd2lkZ2V0VXJpKVxuICB9XG5cbiAgcHJpdmF0ZSBsb2FkV2lkZ2V0U2V0dGluZ0NsYXNzQnlVcmkgKHVyaSk6IGFueSB7XG4gICAgaWYgKCF0aGlzLnNldHRpbmdzW3VyaV0pIHtcbiAgICAgIHRoaXMuc2V0dGluZ3NbdXJpXSA9IHt9IGFzIGFueVxuICAgIH1cblxuICAgIGlmICh0aGlzLnNldHRpbmdzW3VyaV0uc2V0dGluZ0NsYXp6UHJvbWlzZSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3NbdXJpXS5zZXR0aW5nQ2xhenpQcm9taXNlXG4gICAgfVxuXG4gICAgdGhpcy5zZXR0aW5nc1t1cmldLnNldHRpbmdDbGF6elByb21pc2UgPSB0aGlzLmxvYWRSYXdTZXR0aW5nQ2xhc3ModXJpKS50aGVuKGFzeW5jICgpID0+IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmxvYWRJMThuTWVzc2FnZXNGb3JTZXR0aW5nKHVyaSlcbiAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgIGNvbnN0IHdyYXBwZWRTZXR0aW5nID0gdGhpcy5pbmplY3RXaWRnZXRTZXR0aW5nUHJvcHModXJpKVxuICAgICAgaWYgKCF3cmFwcGVkU2V0dGluZykge1xuICAgICAgICBkZWxldGUgdGhpcy5zZXR0aW5nc1t1cmldXG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICB9XG4gICAgICB0aGlzLnNldHRpbmdzW3VyaV0uc2V0dGluZ0NsYXp6ID0gd3JhcHBlZFNldHRpbmdcbiAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYnVpbGRlckFjdGlvbnMud2lkZ2V0U2V0dGluZ0NsYXNzTG9hZGVkKHVyaSkpXG4gICAgICByZXR1cm4gd3JhcHBlZFNldHRpbmdcbiAgICB9KVxuXG4gICAgcmV0dXJuIHRoaXMuc2V0dGluZ3NbdXJpXS5zZXR0aW5nQ2xhenpQcm9taXNlXG4gIH1cblxuICBhc3luYyBsb2FkUmF3U2V0dGluZ0NsYXNzICh1cmk6IHN0cmluZyk6IFByb21pc2U8UmF3V2lkZ2V0U2V0dGluZ1R5cGU+IHtcbiAgICBjb25zdCBtYW5pZmVzdCA9IHRoaXMuZ2V0V2lkZ2V0TWFuaWZlc3RCeVVyaSh1cmkpXG5cbiAgICBsZXQgc2V0dGluZ1VyaSA9IGAke3VyaX1kaXN0L3NldHRpbmcvc2V0dGluZ2BcbiAgICBpZiAoIW1hbmlmZXN0LnByb3BlcnRpZXMuaGFzU2V0dGluZ1BhZ2UpIHtcbiAgICAgIHNldHRpbmdVcmkgPSAnamltdS1mb3ItYnVpbGRlci9qc29uLWVkaXRvci1zZXR0aW5nJ1xuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCB0aGlzLmxvYWRXaWRnZXRTZXR0aW5nRGVwZW5kZW5jeSh1cmkpLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IG1vZHVsZUxvYWRlci5sb2FkTW9kdWxlKHNldHRpbmdVcmkpXG4gICAgfSkudGhlbihjbGF6eiA9PiB7XG4gICAgICBjb25zdCByYXdTZXR0aW5nQ2xhc3M6IFJhd1dpZGdldFNldHRpbmdUeXBlID0gY2xhenouZGVmYXVsdCA/IGNsYXp6LmRlZmF1bHQgOiBjbGF6elxuICAgICAgdGhpcy5zZXR0aW5nc1t1cmldLnJhd1NldHRpbmdDbGF6eiA9IHJhd1NldHRpbmdDbGFzc1xuICAgICAgcmV0dXJuIHJhd1NldHRpbmdDbGFzc1xuICAgIH0pXG4gIH1cblxuICBhc3luYyBsb2FkSTE4bk1lc3NhZ2VzRm9yU2V0dGluZyAodXJpOiBzdHJpbmcpOiBQcm9taXNlPGkxOG4uSTE4bk1lc3NhZ2VzPiB7XG4gICAgaWYgKCF0aGlzLnNldHRpbmdzW3VyaV0pIHtcbiAgICAgIHRoaXMuc2V0dGluZ3NbdXJpXSA9IHt9IGFzIGFueVxuICAgIH1cblxuICAgIGlmICh0aGlzLnNldHRpbmdzW3VyaV0uc2V0dGluZ0kxOG5NZXNzYWdlUHJvbWlzZSkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuc2V0dGluZ3NbdXJpXS5zZXR0aW5nSTE4bk1lc3NhZ2VQcm9taXNlXG4gICAgfVxuXG4gICAgY29uc3QgbWFuaWZlc3QgPSB0aGlzLmdldFdpZGdldE1hbmlmZXN0QnlVcmkodXJpKVxuXG4gICAgaWYgKCFtYW5pZmVzdCkge1xuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZSh7fSlcbiAgICB9XG5cbiAgICBpZiAobWFuaWZlc3QudHJhbnNsYXRlZExvY2FsZXMpIHtcbiAgICAgIGxldCBsb2NhbGUgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwQ29udGV4dC5sb2NhbGVcbiAgICAgIGxvY2FsZSA9IGdldExvY2FsZVRvTG9hZChsb2NhbGUsIG1hbmlmZXN0LnRyYW5zbGF0ZWRMb2NhbGVzKVxuICAgICAgaWYgKGxvY2FsZSkge1xuICAgICAgICB0aGlzLnNldHRpbmdzW3VyaV0uc2V0dGluZ0kxOG5NZXNzYWdlUHJvbWlzZSA9IGxvYWRMb2NhbGVNZXNzYWdlcyhgJHt1cml9ZGlzdC9zZXR0aW5nL3RyYW5zbGF0aW9uc2AsIGxvY2FsZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3NbdXJpXS5zZXR0aW5nSTE4bk1lc3NhZ2VQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKHt9KVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldHRpbmdzW3VyaV0uc2V0dGluZ0kxOG5NZXNzYWdlUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh7fSlcbiAgICB9XG5cbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zZXR0aW5nc1t1cmldLnNldHRpbmdJMThuTWVzc2FnZVByb21pc2UudGhlbigoaTE4bk1lc3NhZ2VzID0ge30pID0+IHtcbiAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYnVpbGRlckFjdGlvbnMud2lkZ2V0U2V0dGluZ0kxOG5NZXNzYWdlTG9hZGVkKG1hbmlmZXN0Lm5hbWUsIGkxOG5NZXNzYWdlcykpXG4gICAgICB0aGlzLnNldHRpbmdzW3VyaV0uc2V0dGluZ0kxOG5NZXNzYWdlID0gaTE4bk1lc3NhZ2VzXG4gICAgICByZXR1cm4gaTE4bk1lc3NhZ2VzXG4gICAgfSlcbiAgfVxuXG4gIGFzeW5jIGxvYWRXaWRnZXRTZXR0aW5nRGVwZW5kZW5jeSAodXJpOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBtYW5pZmVzdCA9IHRoaXMuZ2V0V2lkZ2V0TWFuaWZlc3RCeVVyaSh1cmkpXG4gICAgaWYgKCFtYW5pZmVzdC5zZXR0aW5nRGVwZW5kZW5jeSkge1xuICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCk7IHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHdpZGdldERlcGVuZGVuY2llczogc3RyaW5nW10gPSAodHlwZW9mIG1hbmlmZXN0LnNldHRpbmdEZXBlbmRlbmN5ID09PSAnc3RyaW5nJyA/IFttYW5pZmVzdC5zZXR0aW5nRGVwZW5kZW5jeV0gOiBtYW5pZmVzdC5zZXR0aW5nRGVwZW5kZW5jeSkgYXMgc3RyaW5nW11cblxuICAgIGF3YWl0IGxvYWREZXBlbmRlbmNpZXMod2lkZ2V0RGVwZW5kZW5jaWVzKVxuICB9XG5cbiAgYXN5bmMgbG9hZEl0ZW1TZXR0aW5nQ2xhc3MgKHdpZGdldElkOiBzdHJpbmcpOiBQcm9taXNlPFJlYWN0LkNvbXBvbmVudENsYXNzPFdpZGdldEl0ZW1TZXR0aW5nUHJvcHM+PiB7XG4gICAgY29uc3Qgd2lkZ2V0SnNvbiA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBTdGF0ZUluQnVpbGRlcj8uYXBwQ29uZmlnPy53aWRnZXRzPy5bd2lkZ2V0SWRdXG4gICAgaWYgKCF3aWRnZXRKc29uKSB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG51bGwpXG4gICAgfVxuXG4gICAgaWYgKCF3aWRnZXRKc29uLm1hbmlmZXN0KSB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG51bGwpXG4gICAgfVxuXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMubG9hZEl0ZW1TZXR0aW5nQ2xhc3NCeVVyaSh0aGlzLmdldFdpZGdldFVyaSh3aWRnZXRJZCkpXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxvYWRJdGVtU2V0dGluZ0NsYXNzQnlVcmkgKHVyaTogc3RyaW5nKTogUHJvbWlzZTxSZWFjdC5Db21wb25lbnRDbGFzczxXaWRnZXRJdGVtU2V0dGluZ1Byb3BzPj4ge1xuICAgIGlmICghdGhpcy5zZXR0aW5nc1t1cmldKSB7XG4gICAgICB0aGlzLnNldHRpbmdzW3VyaV0gPSB7fSBhcyBhbnlcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zZXR0aW5nc1t1cmldLml0ZW1TZXR0aW5nQ2xhenpQcm9taXNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXR0aW5nc1t1cmldLml0ZW1TZXR0aW5nQ2xhenpQcm9taXNlXG4gICAgfVxuXG4gICAgdGhpcy5zZXR0aW5nc1t1cmldLml0ZW1TZXR0aW5nQ2xhenpQcm9taXNlID0gdGhpcy5sb2FkUmF3SXRlbVNldHRpbmdDbGFzcyh1cmkpLnRoZW4oKGl0ZW1DbGF6ejogUmVhY3QuQ29tcG9uZW50Q2xhc3M8V2lkZ2V0SXRlbVNldHRpbmdQcm9wcz4pID0+IHtcbiAgICAgIHRoaXMuc2V0dGluZ3NbdXJpXS5pdGVtU2V0dGluZ0NsYXp6ID0gaXRlbUNsYXp6XG4gICAgICByZXR1cm4gaXRlbUNsYXp6XG4gICAgfSlcblxuICAgIHJldHVybiB0aGlzLnNldHRpbmdzW3VyaV0uaXRlbVNldHRpbmdDbGF6elByb21pc2VcbiAgfVxuXG4gIGFzeW5jIGxvYWRSYXdJdGVtU2V0dGluZ0NsYXNzICh1cmkpOiBQcm9taXNlPFJlYWN0LkNvbXBvbmVudENsYXNzPFdpZGdldEl0ZW1TZXR0aW5nUHJvcHM+PiB7XG4gICAgY29uc3QgaXRlbVVyaSA9IGAke3VyaX1kaXN0L3NldHRpbmcvaXRlbS1zZXR0aW5nYFxuICAgIHJldHVybiBhd2FpdCBtb2R1bGVMb2FkZXIubG9hZE1vZHVsZShpdGVtVXJpKS50aGVuKGNsYXp6ID0+IHtcbiAgICAgIHJldHVybiBjbGF6ei5kZWZhdWx0ID8gY2xhenouZGVmYXVsdCA6IGNsYXp6XG4gICAgfSlcbiAgfVxuXG4gIGluamVjdFdpZGdldFNldHRpbmdQcm9wcyAodXJpOiBzdHJpbmcpOiBXcmFwcGVkV2lkZ2V0U2V0dGluZ1R5cGUge1xuICAgIGlmICghdGhpcy5jaGVja1dpZGdldFVyaUluQ29uZmlnKHVyaSkpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgY29uc3QgcmF3U2V0dGluZ0NsYXp6ID0gdGhpcy5zZXR0aW5nc1t1cmldLnJhd1NldHRpbmdDbGF6elxuICAgIGNvbnN0IEludGxJbmplY3RlZENvbXBvbmVudCA9IGluamVjdEludGwocmF3U2V0dGluZ0NsYXp6KVxuICAgIGNvbnN0IFRoZW1lZFdpZGdldFdyYXBwZXIgPSB3aXRoVGhlbWUoSW50bEluamVjdGVkQ29tcG9uZW50LCB0cnVlKVxuICAgIGNvbnN0IG1hbmlmZXN0ID0gdGhpcy5nZXRXaWRnZXRNYW5pZmVzdEJ5VXJpKHVyaSlcbiAgICBjb25zdCB3aWRnZXROYW1lID0gbWFuaWZlc3QubmFtZVxuICAgIGNvbnN0IGkxOG5NZXNzYWdlcyA9IHRoaXMuc2V0dGluZ3NbdXJpXS5zZXR0aW5nSTE4bk1lc3NhZ2VcblxuICAgIGNsYXNzIFdpZGdldFNldHRpbmdXcmFwcGVyIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxBbGxXaWRnZXRTZXR0aW5nUHJvcHM8YW55PiwgYW55PiB7XG4gICAgICBzdGF0aWMgZGlzcGxheU5hbWUgPSBgV2lkZ2V0U2V0dGluZ1dyYXBwZXIoJHt3aWRnZXROYW1lfSlgXG5cbiAgICAgIHJlbmRlciAoKSB7XG4gICAgICAgIGlmIChtYW5pZmVzdC52ZXJzaW9uICE9PSB0aGlzLnByb3BzLnZlcnNpb24pIHtcbiAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluamVjdFByb3BzOiBhbnkgPSB7XG4gICAgICAgICAgbWVzc2FnZXM6IGkxOG5NZXNzYWdlc1xuICAgICAgICB9XG4gICAgICAgIC8vIG1lcmdlIGluIHRoZSBhcHAncyBtZXNzYWdlcyBiZWZvcmUgY3JlYXRpbmcgdGhlIGNvbnRleHQgc28gdGhhdFxuICAgICAgICAvLyBhbnkgamltdS11aSBjb21wb25lbnRzIGluIHRoaXMgY29tcG9uZW50IGNhbiBoYXZlIGFjY2VzcyB0byB0aGVpciBvd24gbWVzc2FnZXNcbiAgICAgICAgLy8gTk9URTogbWVzc2FnZXMgd2l0aCB0aGUgc2FtZSBrZXkgd2lsbCBiZSBvdmVycmlkZGVuLCBzbyBwbGVhc2UgbWFrZSBzdXJlIHdpZGdldCBkbyBub3QgdXNlIHRoZSBzYW1lIGtleSB3aXRoIGppbXUuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgY29uc3QgayA9IGkxOG5NZXNzYWdlcyAmJiBPYmplY3Qua2V5cyhpMThuTWVzc2FnZXMpLmZpbmQoayA9PiAhIXRoaXMucHJvcHMuYXBwSTE4bk1lc3NhZ2VzW2tdKVxuICAgICAgICAgIGlmIChrKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdXaWRnZXQgdHJhbnNsYXRpb24ga2V5IGNvbmZsaWN0LicsIGBXaWRnZXQ6ICR7d2lkZ2V0TmFtZX0sIGtleTogJHtrfWApXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFsbE1lc3NhZ2VzID0gT2JqZWN0LmFzc2lnbih7fSwgaTE4bk1lc3NhZ2VzLCB0aGlzLnByb3BzLmFwcEkxOG5NZXNzYWdlcylcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxJbnRsUHJvdmlkZXIgbG9jYWxlPXt0aGlzLnByb3BzLmxvY2FsZX0gZGVmYXVsdExvY2FsZT17dGhpcy5wcm9wcy5sb2NhbGV9IG1lc3NhZ2VzPXthbGxNZXNzYWdlc30+XG4gICAgICAgICAgICA8VGhlbWVkV2lkZ2V0V3JhcHBlciB7Li4udGhpcy5wcm9wc30gey4uLmluamVjdFByb3BzfSAvPlxuICAgICAgICAgIDwvSW50bFByb3ZpZGVyPlxuICAgICAgICApXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbWFwU3RhdGVUb1Byb3BzID0gKHN0YXRlOiBJTVN0YXRlLCBvd25Qcm9wczogV2lkZ2V0U2V0dGluZ1Byb3BzKTogV2lkZ2V0U2V0dGluZ0luamVjdGVkUHJvcHM8YW55PiA9PiB7XG4gICAgICBjb25zdCBwcm9wczogUGFydGlhbDxXaWRnZXRTZXR0aW5nSW5qZWN0ZWRQcm9wczxhbnk+PiA9IHtcbiAgICAgICAgcXVlcnlPYmplY3Q6IHN0YXRlLnF1ZXJ5T2JqZWN0LFxuICAgICAgICB1c2VyOiBzdGF0ZS51c2VyLFxuICAgICAgICB0b2tlbjogc3RhdGUudG9rZW4sXG4gICAgICAgIHBvcnRhbFVybDogc3RhdGUucG9ydGFsVXJsLFxuICAgICAgICBwb3J0YWxTZWxmOiBzdGF0ZS5wb3J0YWxTZWxmLFxuICAgICAgICBsb2NhbGU6IHN0YXRlLmFwcENvbnRleHQubG9jYWxlLFxuICAgICAgICBhcHBJMThuTWVzc2FnZXM6IHN0YXRlLmFwcEkxOG5NZXNzYWdlc1xuICAgICAgfVxuXG4gICAgICBjb25zdCB3aWRnZXRJZCA9IG93blByb3BzLndpZGdldElkXG4gICAgICBjb25zdCB3aWRnZXRKc29uID0gc3RhdGUuYXBwU3RhdGVJbkJ1aWxkZXIuYXBwQ29uZmlnLndpZGdldHNbd2lkZ2V0SWRdXG4gICAgICBpZiAoIXdpZGdldEpzb24pIHtcbiAgICAgICAgcmV0dXJuIHt9IGFzIGFueVxuICAgICAgfVxuXG4gICAgICBjb25zdCBhbGxPd25Qcm9wcyA9IE9iamVjdC5hc3NpZ24ocHJvcHMsIHdpZGdldEpzb24sIG93blByb3BzKVxuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oYWxsT3duUHJvcHMsIHJhd1NldHRpbmdDbGF6ei5tYXBFeHRyYVN0YXRlUHJvcHMgPyByYXdTZXR0aW5nQ2xhenoubWFwRXh0cmFTdGF0ZVByb3BzKHN0YXRlLCBhbGxPd25Qcm9wcykgOiB7fSlcbiAgICB9XG5cbiAgICByZXR1cm4gUmVhY3RSZWR1eC5jb25uZWN0KG1hcFN0YXRlVG9Qcm9wcykoV2lkZ2V0U2V0dGluZ1dyYXBwZXIpIGFzIHVua25vd24gYXMgV3JhcHBlZFdpZGdldFNldHRpbmdUeXBlXG4gIH1cblxuICBwcml2YXRlIG9uU3RvcmVDaGFuZ2UgKHByZVdpZGdldHM6IEltbXV0YWJsZU9iamVjdDx7IFt3aWRnZXRJZDogc3RyaW5nXTogSU1XaWRnZXRKc29uIH0+LCB3aWRnZXRzOiBJbW11dGFibGVPYmplY3Q8eyBbd2lkZ2V0SWQ6IHN0cmluZ106IElNV2lkZ2V0SnNvbiB9Pikge1xuICAgIHByZVdpZGdldHMgJiYgd2lkZ2V0cyAmJiBPYmplY3Qua2V5cyhwcmVXaWRnZXRzKS5mb3JFYWNoKHByZVdJZCA9PiB7XG4gICAgICBpZiAoIXdpZGdldHNbcHJlV0lkXSkgeyAvLyB3aWRnZXQgaXMgcmVtb3ZlZFxuICAgICAgICAvLyB0aGlzLmRlc3Ryb3lXaWRnZXRTZXR0aW5nQ2xhc3NCeVVyaShwcmVXaWRnZXRzW3ByZVdJZF0udXJpKSAvLyBEbyBub3QgcmVtb3ZlIGZvciBwZXJmb3JtYW5jZSByZWFzb24uXG4gICAgICB9XG4gICAgfSlcbiAgfVxufVxuXG4vKipcbiAqIFRoZSBgV2lkZ2V0U2V0dGluZ01hbmFnZXJgIGlzIHVzZWQgdG8gbWFuYWdlIHRoZSB3aWRnZXQgc2V0dGluZy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgV2lkZ2V0U2V0dGluZ01hbmFnZXJcbiIsImltcG9ydCB7IFJlYWN0LCBjbGFzc05hbWVzIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IHsgdHlwZSBTVkdDb21wb25lbnRQcm9wcyB9IGZyb20gJ2ppbXUtdWknXG5pbXBvcnQgc3JjIGZyb20gJy4uLy4uL3N2Zy9vdXRsaW5lZC9kYXRhL2xpbmstY29tYmluZWQuc3ZnJ1xuXG5leHBvcnQgY29uc3QgTGlua0NvbWJpbmVkT3V0bGluZWQgPSAocHJvcHM6IFNWR0NvbXBvbmVudFByb3BzKSA9PiB7XG4gIGNvbnN0IFNWRyA9IHdpbmRvdy5TVkdcbiAgY29uc3QgeyBjbGFzc05hbWUsIC4uLm90aGVycyB9ID0gcHJvcHNcblxuICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcygnamltdS1pY29uIGppbXUtaWNvbi1jb21wb25lbnQnLCBjbGFzc05hbWUpXG4gIGlmICghU1ZHKSByZXR1cm4gPHN2ZyBjbGFzc05hbWU9e2NsYXNzZXN9IHsuLi5vdGhlcnMgYXMgYW55fSAvPlxuICByZXR1cm4gPFNWRyBjbGFzc05hbWU9e2NsYXNzZXN9IHNyYz17c3JjfSB7Li4ub3RoZXJzfSAvPlxufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX2ppbXVfY29yZV9fOyIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9yZWFjdF9fOyIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9qaW11X2Zvcl9idWlsZGVyX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX2ppbXVfZm9yX2J1aWxkZXJfdGVtcGxhdGVzX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX2ppbXVfbGF5b3V0c19sYXlvdXRfcnVudGltZV9fOyIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9qaW11X3RoZW1lX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX2ppbXVfdWlfXzsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwiLi9qaW11LWZvci1idWlsZGVyL2luZGV4LnRzeFwiKTtcbiIsIiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==