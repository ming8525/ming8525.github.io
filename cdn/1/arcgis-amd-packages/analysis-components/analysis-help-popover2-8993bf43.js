define(["exports","./index-ef555910","./index2-588b02d9","./helpmap-fb1ea8ef","./helpmap_enterprise-7a3381f0","./get-4ace6219"],(function(exports,index,index2,helpmap,helpmap_enterprise,get){"use strict";const AnalysisEngine={Standard:"standard",GeoAnalytics:"geoanalytics",Raster:"raster",Pipelines:"pipelines",Session:"session"};const HTMLClasses={analysisPopover:"analysis-popover",jsAppFlyout:"js-app-flyout",iframeSmall:"help-iframe-s",iframeMedium:"help-iframe-m",learnMore:"learn-more",onlineOnly:"OnlineOnly",portalOnly:"PortalOnly",customToolParam:"help-custom-tool-param"};const analysisHelpPopoverCss=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}:host{display:flex;background-color:var(--calcite-color-foreground-1)}.help-iframe-s{padding:var(--analysis-quarter-spacing);min-height:var(--analysis-popover-content-min-height-s);max-height:var(--analysis-popover-content-max-height);border:0px}.help-iframe-m{padding:var(--analysis-quarter-spacing);min-height:var(--analysis-popover-content-min-height-m);max-height:var(--analysis-popover-content-max-height);border:0px}.help-custom-tool-param{font-size:12px;font-family:Verdana, Helvetica, sans-serif;overflow-y:auto;padding:var(--analysis-quarter-spacing);min-height:var(--analysis-popover-content-min-height-s);max-height:var(--analysis-popover-content-max-height);width:300px}.help-custom-tool-param p{margin:var(--analysis-half-spacing)}.learn-more{margin:var(--analysis-full-spacing)}";const AnalysisHelpPopover=index.proxyCustomElement(class AnalysisHelpPopover extends index.H{constructor(){super();this.__registerHost();this.__attachShadow();this.analysisHelpPopoverClose=index.createEvent(this,"analysisHelpPopoverClose",7);this.analysisHelpPopoverSelectionChange=index.createEvent(this,"analysisHelpPopoverSelectionChange",7);this.environmentModifierClass=HTMLClasses.onlineOnly;this.referenceElement=undefined;this.helpUrl=undefined;this.helpId=undefined;this.heading=undefined;this.isHelpFileExternalAsset=false;this.portal=undefined;this.portalHelpMap=undefined;this.placement="auto";this.open=undefined;this.helpFileName=undefined;this.externalHelpMap=undefined;this.helpSrcdoc=undefined;this.learnMoreBaseUrl=undefined;this.learnMoreUrl=undefined;this.analysisEngine=AnalysisEngine.Standard;this.offsetDistance=20;this.offsetSkidding=0;this.triggerDisabled=false}async portalChange(newPortal){if(newPortal!==undefined&&newPortal.isPortal&&this.portalHelpMap===undefined){this.portalHelpMap=await index2.getPortalHelpMap(newPortal)}this.environmentModifierClass=newPortal?.isPortal===true?HTMLClasses.portalOnly:HTMLClasses.onlineOnly}async componentWillLoad(){({strings:this.strings,dir:this.dir,locale:this.locale}=await index2.fetchComponentLocaleStrings(this.hostElement,index.getAssetPath(`.`)));if(this.portal!==undefined){await this.portalChange(this.portal)}}componentDidLoad(){try{setTimeout((()=>requestAnimationFrame((()=>this.popoverElement?.setFocus()))),1);setTimeout((()=>{this.popoverElement?.reposition?.()}),index2.UIDefaults.PopoverTimer)}catch(e){}}async reposition(){await(this.popoverElement?.reposition?.())}getContentStyleClass(helpId){let className=HTMLClasses.iframeSmall;if(helpId.indexOf("Category")!==-1){className=HTMLClasses.iframeMedium}else if(helpId.indexOf("Tool")!==-1){className=HTMLClasses.iframeMedium}else if(helpId.indexOf("toolDescription")!==-1){className=HTMLClasses.iframeMedium}return className}getLocalizedLearnMoreUrl(){let learnMoreBaseUrl;if(this.learnMoreBaseUrl!==undefined){learnMoreBaseUrl=this.learnMoreBaseUrl.charAt(this.learnMoreBaseUrl.length-1)!=="/"?this.learnMoreBaseUrl+"/":this.learnMoreBaseUrl;const localeInLowerCase=this.locale.toLocaleLowerCase();if(index2.SupportedOnlineHelpLocales.includes(localeInLowerCase)===true){learnMoreBaseUrl=learnMoreBaseUrl.replace(/(\/|^)(en)(\/|$)/,`$1${localeInLowerCase}$3`)}}return learnMoreBaseUrl}getLearnMoreUrlForWebAnalysis(){let learnMoreUrl;if(this.learnMoreBaseUrl!==undefined){const helpMapData=this.portal?.isPortal===true?helpmap_enterprise.helpMapEnterprise.map:helpmap.helpMap.map;const learnMorePath=get.get(helpMapData,`${this.helpFileName}${index2.formatAnalysisEngineSuffix(this.analysisEngine)}.${this.helpId}`);if(learnMorePath!==undefined&&this.learnMoreBaseUrl!==undefined){const localizedLearnMoreBaseUrl=this.getLocalizedLearnMoreUrl();if(this.portal?.isPortal===true&&this.portalHelpMap?.m!==undefined){learnMoreUrl=`${localizedLearnMoreBaseUrl}${this.portalHelpMap.m[learnMorePath]}`;const{restUrl}=this.portal;learnMoreUrl=index2.fixUrlForDemoApp(learnMoreUrl,restUrl)}else if(this.portal===undefined||this.portal?.isPortal===false){learnMoreUrl=`${localizedLearnMoreBaseUrl}analyze/${learnMorePath}`}}}return learnMoreUrl}getLearnMoreForCustomHelpMap(){let learnMoreUrl;if(this.externalHelpMap!==undefined&&this.helpId!==undefined&&this.helpFileName!==undefined){learnMoreUrl=get.get(this.externalHelpMap.map,`${this.helpFileName}.${this.helpId}`);if(learnMoreUrl!==undefined&&this.learnMoreBaseUrl!==undefined){const learnMoreBaseUrl=this.learnMoreBaseUrl.charAt(this.learnMoreBaseUrl.length-1)!=="/"?this.learnMoreBaseUrl+"/":this.learnMoreBaseUrl;const localizedLearnMoreBaseUrl=this.isHelpFileExternalAsset===true?learnMoreBaseUrl:this.getLocalizedLearnMoreUrl();learnMoreUrl=`${localizedLearnMoreBaseUrl}${learnMoreUrl}`}}return learnMoreUrl}getLearnMoreUrl(){let learnMoreUrl;if(this.learnMoreBaseUrl!==undefined){if(this.externalHelpMap!==undefined){learnMoreUrl=this.getLearnMoreForCustomHelpMap()}else{learnMoreUrl=this.getLearnMoreUrlForWebAnalysis()}}else if(this.learnMoreUrl!==undefined){learnMoreUrl=this.learnMoreUrl}return learnMoreUrl}renderIframeUsingSrcDoc(){return index.h("iframe",{class:this.getContentStyleClass(this.helpId),id:this.helpId,title:this.heading??this.helpId,srcdoc:this.helpSrcdoc})}renderIframeUsingHelpUrl(){const helpUrl=this.isHelpFileExternalAsset===false?index.getAssetPath(this.helpUrl):this.helpUrl;const helpPath=helpUrl!==undefined?`${helpUrl}#${this.helpId}-${this.environmentModifierClass}`:"";return index.h("iframe",{class:this.getContentStyleClass(this.helpId),id:this.helpId,title:this.heading??this.helpId,src:helpPath})}render(){let helpContent;let learnMoreUrl;if(this.helpUrl!==undefined){helpContent=this.helpSrcdoc!==undefined?this.renderIframeUsingSrcDoc():this.renderIframeUsingHelpUrl();learnMoreUrl=this.getLearnMoreUrl()}else{const description=this.helpId==="toolDescription"?get.get(this.referenceElement?.getRootNode(),"host.webToolJSON.description"):this.referenceElement?.getAttribute("description");helpContent=index.h("div",{class:HTMLClasses.customToolParam},index.h("p",null,description??""));learnMoreUrl=get.get(this.referenceElement?.getRootNode(),"host.webToolJSON.helpUrl")}return index.h(index.Host,{class:`${HTMLClasses.analysisPopover} ${HTMLClasses.jsAppFlyout}`,dir:this.dir},index.h("calcite-popover",{overlayPositioning:"fixed",autoClose:true,ref:el=>this.popoverElement=el,referenceElement:this.referenceElement??"analysis-tool",placement:this.placement,open:this.open,closable:true,heading:this.heading??this.helpId,headingLevel:4,triggerDisabled:this.triggerDisabled,focusTrapDisabled:true,label:this.heading??this.helpId??"",offsetDistance:this.offsetDistance,offsetSkidding:this.offsetSkidding,onCalcitePopoverClose:()=>this.analysisHelpPopoverClose.emit()},helpContent,learnMoreUrl!==undefined&&index.h("calcite-link",{rel:"help",target:"_blank",href:learnMoreUrl,class:HTMLClasses.learnMore},this.strings.learnMoreLabel)))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{portal:["portalChange"]}}static get style(){return analysisHelpPopoverCss}},[1,"analysis-help-popover",{referenceElement:[16],helpUrl:[513,"help-url"],helpId:[513,"help-id"],heading:[513],isHelpFileExternalAsset:[516,"is-help-file-external-asset"],portal:[16],portalHelpMap:[16],placement:[513],open:[1540],helpFileName:[513,"help-file-name"],externalHelpMap:[16],helpSrcdoc:[513,"help-srcdoc"],learnMoreBaseUrl:[513,"learn-more-base-url"],learnMoreUrl:[513,"learn-more-url"],analysisEngine:[513,"analysis-engine"],offsetDistance:[514,"offset-distance"],offsetSkidding:[514,"offset-skidding"],triggerDisabled:[516,"trigger-disabled"],reposition:[64]},undefined,{portal:["portalChange"]}]);function defineCustomElement(){if(typeof customElements==="undefined"){return}const components=["analysis-help-popover"];components.forEach((tagName=>{switch(tagName){case"analysis-help-popover":if(!customElements.get(tagName)){customElements.define(tagName,AnalysisHelpPopover)}break}}))}defineCustomElement();exports.AnalysisEngine=AnalysisEngine;exports.AnalysisHelpPopover=AnalysisHelpPopover;exports.defineCustomElement=defineCustomElement}));
