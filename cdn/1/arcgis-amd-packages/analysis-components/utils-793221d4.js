define(["exports","./index2-588b02d9"],(function(e,a){"use strict";const r={Feature_All:"feature",Feature_Extract:"extract",Feature_Point:"feature_point",Feature_MultiPoint:"feature_multiPoint",Feature_Line:"feature_line",Feature_Polygon:"feature_polygon",Feature_Table:"table",Imagery_All:"imagery",Imagery_SingleBand:"imagery_singleBand",Imagery_MultiBand:"imagery_multiBand",Imagery_Integer:"imagery_integer",Imagery_Float:"imagery_float",Imagery_Multidimension:"imagery_multidimension",Imagery_Trend:"imagery_trend",Tile:"tile",Imagery_Change:"imagery_change"},t="invalidIntegerMessage";async function i(e,r){let t=!1;try{const i=await a.request(`${e}/keyProperties?f=json`,{responseType:"json"});t=void 0!==i.data&&void 0!==i.data[r]&&void 0!==i.data[r].DimensionName}catch(e){await a.throwError(a.ErrorKeywords.KeyPropertiesError)}return t}async function s(e){const{layer:t,layerFilterType:s,user:n}=e;let l=!1;switch(s){case r.Imagery_All:l=a.isImageryLayer(t)||a.isImageryTileLayer(t);break;case r.Imagery_SingleBand:l=a.isImageryLayer(t)?1===t.serviceRasterInfo.bandCount:!!a.isImageryTileLayer(t)&&1===t.rasterInfo.bandCount;break;case r.Imagery_MultiBand:l=a.isImageryLayer(t)?t.serviceRasterInfo.bandCount>1:!!a.isImageryTileLayer(t)&&t.rasterInfo.bandCount>1;break;case r.Imagery_Integer:const e=a.isImageryLayer(t)?t.pixelType:a.isImageryTileLayer(t)?t.rasterInfo.pixelType:"";l=e.startsWith("u")||e.startsWith("s");break;case r.Imagery_Float:l=(a.isImageryLayer(t)?t.pixelType:a.isImageryTileLayer(t)?t.rasterInfo.pixelType:"").startsWith("f");break;case r.Imagery_Multidimension:l=a.isImageryLayer(t)&&t.hasMultidimensions||a.isImageryTileLayer(t)&&t.multidimensionalDefinition?.length>0;break;case r.Imagery_Trend:(a.isImageryLayer(t)||a.isImageryTileLayer(t))&&(l=await i(t.url,"TrendParameters"));break;case r.Imagery_Change:(a.isImageryLayer(t)||a.isImageryTileLayer(t))&&(l=await i(t.url,"ChangeAnalysisParameters"));break;case r.Tile:l=a.isTileLayer(t);break;case r.Feature_All:l=a.isFeatureLayer(t)&&!a.isTableLayer(t);break;case r.Feature_Point:l=a.isFeatureLayer(t)&&!a.isTableLayer(t)&&"point"===t.geometryType;break;case r.Feature_MultiPoint:l=a.isFeatureLayer(t)&&!a.isTableLayer(t)&&"multipoint"===t.geometryType;break;case r.Feature_Line:l=a.isFeatureLayer(t)&&!a.isTableLayer(t)&&"polyline"===t.geometryType;break;case r.Feature_Polygon:l=a.isFeatureLayer(t)&&!a.isTableLayer(t)&&"polygon"===t.geometryType;break;case r.Feature_Table:l=a.isTableLayer(t);break;case r.Feature_Extract:l=await a.canExtractLayer(t,n)}return l}function n(e,a){const r=e.map((e=>`type:"${e}"`)).join(" OR ");return void 0!==a?`${a} (${r})`:`(${r})`}const l={esriGeometryPoint:r.Feature_Point,esriGeometryPolyline:r.Feature_Line,esriGeometryPolygon:r.Feature_Polygon,esriGeometryMultipoint:r.Feature_MultiPoint};function o(e){switch(e){case"esriFieldTypeSingle":return"single";case"esriFieldTypeDouble":return"double";case"esriFieldTypeGeometry":return"geometry";case"esriFieldTypeInteger":return["long","integer","big-integer"];case"esriFieldTypeSmallInteger":return"small-integer";case"esriFieldTypeString":return"string";case"esriFieldTypeDate":return"date";default:return}}e.LayerFilterType=r,e.LayerInputActions={Select:"select",Filter:"filter",Reset:"reset",Remove:"remove"},e.StatisticType={Any:"any",Count:"count",First:"first",Last:"last",Maximum:"max",Mean:"mean",Minimum:"min",Range:"range",StdDev:"stddev",Sum:"sum",Variance:"variance"},e.UIDefaults={DebounceTimer:400,HelpDebounceTimer:1500,PopoverTimer:60,Scale:"s",MediumScale:"m"},e.addOpenableDomElement=function(e,a){!1===e.body.contains(a)&&(e.body.appendChild(a),a.open=!0)},e.convertParameterFilter=function(e){const a={};switch(e?.type){case"range":a.min=e.minimum,a.max=e.maximum;break;case"featureClass":void 0!==e.list&&(a.layerFilterType=e.list.map((e=>l[e])).filter((e=>void 0!==e)));break;case"field":void 0!==e.list&&(a.fieldTypes=e.list.flatMap(o).filter((e=>void 0!==e)));break;case"file":a.accept=e.list?.filter((e=>void 0!==e))}return a},e.filterLayersByType=async function(e){const{layers:a,layerFilterTypes:r,user:t}=e;let i=a,n=[];if(void 0!==r){let e;e=Array.isArray(r)?a.map((e=>(async()=>{for(const a of r)if(await s({layer:e,layerFilterType:a,user:t}))return!0;return!1})())):a.map((e=>s({layer:e,layerFilterType:r,user:t})));const l=await Promise.all(e);i=a.filter(((e,a)=>l[a])),n=a.filter(((e,a)=>!l[a]))}return{validLayers:i,filteredLayers:n}},e.formatLayerUrlAndId=function(e){return`${e.url}/${e.layerId}`},e.getBaseUrl=function(e){const{customBaseUrl:a,portalHostname:r,urlKey:t}=e,{protocol:i}=window.location;return`${i}//${t?`${t}.${a}`:r}`},e.isValidFileExtension=function(e,a){if(void 0===a||0===a.length)return!0;const r=e.split(".").pop();return void 0!==r&&a.includes(r)},e.isValidProtocol=function(e){return new RegExp(/^(http|https|ftp):\/\//i).test(e)},e.makeAllowedGeometriesByType=function(e){const a=Array.isArray(e)?e:[e],t=new Set;return a.forEach((e=>{switch(e){case r.Feature_All:t.add("point"),t.add("multipoint"),t.add("polyline"),t.add("polygon");break;case r.Feature_Point:t.add("point");break;case r.Feature_MultiPoint:t.add("multipoint");break;case r.Feature_Line:t.add("polyline");break;case r.Feature_Polygon:t.add("polygon");break;case r.Feature_Table:t.add("nonspatial");break;case r.Feature_Extract:t.add("point"),t.add("multipoint"),t.add("polyline"),t.add("polygon"),t.add("nonspatial")}})),0===t.size?void 0:Array.from(t)},e.makePortalSearchFilter=n,e.makePortalSearchFilterByType=function(e){const a=Array.isArray(e)?e:[e],t=new Set;return a.forEach((e=>{switch(e){case r.Feature_Extract:case r.Feature_All:case r.Feature_Point:case r.Feature_MultiPoint:case r.Feature_Line:case r.Feature_Polygon:case r.Feature_Table:t.add("Feature Service"),t.add("Map Service");break;case r.Imagery_All:case r.Imagery_SingleBand:case r.Imagery_MultiBand:case r.Imagery_Integer:case r.Imagery_Float:case r.Imagery_Multidimension:case r.Imagery_Trend:case r.Imagery_Change:t.add("Image Service");break;default:t.add("Feature Service"),t.add("Image Service"),t.add("Map Service")}})),n(Array.from(t))},e.makePortalSearchQByType=function(e,a){const t=Array.isArray(e)?e:[e],i=void 0===a?'(-typekeywords: "Hosted Service" AND type: "Image Service") OR (servicetags: "allowAnalysis"':`(-typekeywords: "Hosted Service" AND type: "Image Service") OR ((servicetags: "allowAnalysis" OR orgid: ${a}) AND type: "Image Service"`;let s="";const n=[];if(t.forEach((e=>{switch(e){case r.Imagery_SingleBand:n.push("(bandcount: 1)");break;case r.Imagery_MultiBand:n.push("(bandcount: [2 TO 65536])");break;case r.Imagery_Integer:n.push('(NOT (servicetags: "PixelTypeF32" OR servicetags: "PixelTypeF64"))');break;case r.Imagery_Float:n.push('(servicetags: "PixelTypeF32" OR servicetags: "PixelTypeF64")');break;case r.Imagery_Multidimension:n.push('(servicetags: "hasMultidimensions")');break;case r.Imagery_All:case r.Imagery_Trend:case r.Imagery_Change:n.push("i");break;case r.Feature_All:case r.Feature_Point:case r.Feature_MultiPoint:case r.Feature_Line:case r.Feature_Polygon:case r.Feature_Table:case r.Feature_Extract:n.push("f")}})),n.length>0&&!n.every((e=>"f"===e))){const e=n.filter((e=>e.length>1));s=e.length>0?`${i} AND (${e.join(" OR ")}))`:`${i})`,s=n.indexOf("f")>-1?`(${s} OR (type: "Feature Service"))`:`(${s})`}return s},e.removeOpenableDomElement=function(e){void 0!==e&&(e.open=!1,e.remove())},e.validateNumber=(e,r)=>{const{required:i,isFloatType:s,excludeMinValue:n,excludeMaxValue:l,min:o,max:y}=r;let u;return a.isValidNumber(e)?!1!==s||Number.isInteger(e)?void 0!==o&&void 0!==e&&(e<o||!0===n&&e<=o)?u=!0===n?"strictlyMinimumMessage":"belowMinimumMessage":void 0!==y&&void 0!==e&&(e>y||!0===l&&e>=y)&&(u=!0===l?"strictlyMaximumMessage":"aboveMaximumMessage"):u=t:void 0!==e?u=!0===s?"invalidDoubleMessage":t:!0===i&&(u="requiredInputMessage"),u}}));