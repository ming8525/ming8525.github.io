define(["exports","./index-ef555910","./index2-588b02d9","./primitiveFactory-d8ce40e4","./analysis-attribute-expression2-a90d2a8c","./analysis-boolean-input2-096997f6","./analysis-chip-group2-097fb4b1","./analysis-data-file-input2-34f8bb3a","./analysis-dataset-input2-9534a23f","./analysis-dataset-input-popover2-b6dcb32a","./analysis-date-input2-1f634ecb","./analysis-expression-group2-ce4cdcfd","./analysis-field-input2-e1115e33","./analysis-field-select2-eb77dd22","./analysis-folder-input2-5bb22688","./analysis-geoenrichment-databrowser2-6a737015","./analysis-geoenrichment-input2-4eb9195c","./analysis-item-browser2-508c9cf3","./analysis-item-input2-3709ada5","./analysis-label2-f17c360a","./analysis-layer-input2-f52c4db0","./analysis-layer-input-popover2-13f7974d","./analysis-linear-unit-input2-62802ce9","./analysis-multiple-input2-31e7ea23","./analysis-number-input2-ee81e720","./analysis-query-builder2-59ad1897","./analysis-query-entry2-a97f8d18","./analysis-query-input2-4bacfecd","./analysis-query-modal2-5e925cce","./analysis-query-target-select2-1308b9a9","./analysis-spatial-expression2-5e7137a9","./analysis-spatial-reference-input2-68aa634b","./analysis-spatial-reference-selector2-197bdd55","./analysis-string-input2-61f7c630","./analysis-summary-fields2-732adae8","./analysis-summary-fields-popover2-3708aecb","./analysis-traffic-time-input2-944df8cc","./analysis-tree2-21de4d9f","./analysis-unsupported-input2-606583a1","./analysis-workflow-select2-60915450","./analysis-workflow-select-popover2-a6a5c39c","./get-4ace6219","./set-91d835d2","./_baseGet-9bd467fe","./isEqual-7dac7fee"],(function(exports,index,index2,primitiveFactory,analysisAttributeExpression2,analysisBooleanInput2,analysisChipGroup2,analysisDataFileInput2,analysisDatasetInput2,analysisDatasetInputPopover2,analysisDateInput2,analysisExpressionGroup2,analysisFieldInput2,analysisFieldSelect2,analysisFolderInput2,analysisGeoenrichmentDatabrowser2,analysisGeoenrichmentInput2,analysisItemBrowser2,analysisItemInput2,analysisLabel2,analysisLayerInput2,analysisLayerInputPopover2,analysisLinearUnitInput2,analysisMultipleInput2,analysisNumberInput2,analysisQueryBuilder2,analysisQueryEntry2,analysisQueryInput2,analysisQueryModal2,analysisQueryTargetSelect2,analysisSpatialExpression2,analysisSpatialReferenceInput2,analysisSpatialReferenceSelector2,analysisStringInput2,analysisSummaryFields2,analysisSummaryFieldsPopover2,analysisTrafficTimeInput2,analysisTree2,analysisUnsupportedInput2,analysisWorkflowSelect2,analysisWorkflowSelectPopover2,get,set,_baseGet,isEqual){"use strict";const AnalysisToolUILayout={Vertical:"vertical",Horizontal:"horizontal"};function basePickBy(object,paths,predicate){var index=-1,length=paths.length,result={};while(++index<length){var path=paths[index],value=_baseGet.baseGet(object,path);if(predicate(value,path)){set.baseSet(result,_baseGet.castPath(path,object),value)}}return result}function basePick(object,paths){return basePickBy(object,paths,(function(value,path){return analysisLayerInputPopover2.hasIn(object,path)}))}var pick=analysisExpressionGroup2.flatRest((function(object,paths){return object==null?{}:basePick(object,paths)}));const component="key-value";const HTMLClasses={groupContainer:`${component}__group-container`,groupLabel:`${component}__group-label-text`,groupHorizontal:`${component}__horizontal-layout`,groupAction:`${component}__group-action`,groupActionHorizontal:`${component}__group-action-horizontal`};const analysisKeyValueCss=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}:host{height:100%;margin-bottom:var(--analysis-half-spacing)}.key-value__group-container{display:flex;flex-direction:column;border:1px var(--calcite-color-border-1) solid;border-radius:var(--calcite-border-radius);padding:var(--analysis-half-spacing) var(--analysis-half-spacing) 0 var(--analysis-half-spacing);margin-bottom:var(--analysis-half-spacing)}.key-value__group-label-text{margin-bottom:var(--analysis-quarter-spacing);align-self:center;width:48%;font-size:var(--calcite-font-size--2)}.key-value__group-action{align-self:flex-end;width:100%}.key-value__group-action-horizontal{align-self:flex-end;width:50%}.key-value__horizontal-layout{display:flex;width:var(--analysis-component-default-width);justify-content:space-between}";function isNamedParam(param){return param.name!==undefined}const AnalysisKeyValue=index.proxyCustomElement(class AnalysisKeyValue extends index.H{constructor(){super();this.__registerHost();this.__attachShadow();this.analysisKeyValueChange=index.createEvent(this,"analysisKeyValueChange",7);this.analysisHelpClick=index.createEvent(this,"analysisHelpClick",7);this.mappedElementMap=new Map;this.updateValue=(key,value)=>{const referenceElement=this.mappedElementMap.get(key);const previousValue=get.get(this.value,key);const newValue=value;if(previousValue!==newValue){this.value={...this.value};set.set(this.value,key,newValue);if(referenceElement!==undefined){referenceElement.value=newValue;this.validateParameter(key)}this.analysisKeyValueChange.emit({path:key,value:this.value})}};this.parameterValueChanged=key=>{const referenceElement=this.mappedElementMap.get(key);if(referenceElement!==undefined){this.value={...this.value};set.set(this.value,key,referenceElement.value);this.validate()}this.analysisKeyValueChange.emit({path:key,value:this.value})};this.setAnalysisRef=(key,ref)=>{if(ref!==undefined&&ref!==null){this.mappedElementMap.set(key,ref)}else{this.mappedElementMap.delete(key)}};this.value=undefined;this.parameterInfos=undefined;this.UIparameterInfos=undefined;this.label=undefined;this.required=undefined;this.layout=undefined}parameterInfosChange(_newValue,oldValue){const paramNames=[];this.combinedParameterInfos?.forEach((param=>{if(typeof param==="object"){paramNames.push(param.name);if(oldValue===undefined&&!index2.isEmptyDataItem(this.value)){param.value=this.value[param.name]??param.value}else{this.updateValue(param.name,param.value)}}}));this.value=pick(this.value,paramNames);this.analysisKeyValueChange.emit({path:"init",value:this.value})}UIparameterInfosChange(newValue,oldValue){if(isEqual.isEqual(newValue,oldValue))return;if(index2.isEmptyDataItem(this.value)){this.value={}}this.combinedParameterInfos?.forEach((param=>{if(param.name!==undefined&&typeof this.value==="object"){if(param.visible===false){delete this.value[param.name]}else{const newParameterValue=this.value[param.name]??param.value??param.defaultValue;this.updateValue(param.name,newParameterValue)}}}))}get combinedParameterInfos(){let combinedParameterInfos=this.parameterInfos??[];if(this.UIparameterInfos!==undefined){combinedParameterInfos=this.UIparameterInfos.filter(isNamedParam).map((uiParam=>{const matchingParam=this.parameterInfos?.find((param=>param.name===uiParam.name));return{...matchingParam,...uiParam}}))}return combinedParameterInfos}componentWillLoad(){this.UIparameterInfosChange(this.UIparameterInfos);this.analysisKeyValueChange.emit({path:"init",value:this.value})}render(){return index.h(index.Host,null,index.h("analysis-label",{label:this.label,required:false,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}),this.renderParameters(this.combinedParameterInfos))}renderParameters(parameterInfo,parentKey,title){return parameterInfo?.length>0&&index.h("div",null,parentKey!==undefined?index.h("div",{class:HTMLClasses.groupLabel},title):null,index.h("div",{class:HTMLClasses.groupContainer},parameterInfo?.map((param=>{const key=parentKey!==undefined?`${parentKey}[${param.name}]`:`${param.name}`;const visible=param.visible??true;if(param?.parameterInfos&&!param.dataType.includes("MultiValue")){return this.renderParameters(param.parameterInfos,key,param.label??param.displayName??param.name)}else{return visible&&index.h("div",{class:this.layout===AnalysisToolUILayout.Horizontal?HTMLClasses.groupHorizontal:""},index.h("analysis-label",{class:HTMLClasses.groupLabel,label:param.label??param.displayName??param.name,hideHelp:true,required:this.required===true||"required"in param&&param.required===true}),index.h("div",{class:this.layout===AnalysisToolUILayout.Horizontal?HTMLClasses.groupActionHorizontal:HTMLClasses.groupAction},this.renderDefaultComponent(param,key)))}}))))}renderDefaultComponent(parameterInfo,parentKey){const paramValue=get.get(this.value,parentKey);return index.h(primitiveFactory.AnalysisPrimitiveParameter,{key:parentKey,required:this.required,...parameterInfo,label:"",onValueChange:()=>this.parameterValueChanged(`${parentKey}`),onSetRef:ref=>this.setAnalysisRef(`${parentKey}`,ref),value:paramValue})}async checkValidity(){return Promise.resolve(this.validate())}async validate(){const mappedElementKeys=Array.from(this.mappedElementMap.keys());const mappedElementValidations=mappedElementKeys.map((async mappedElementKey=>this.validateParameter(mappedElementKey)));return(await Promise.all(mappedElementValidations)).every((valid=>valid===true))}async validateParameter(paramName){const mappedElement=this.mappedElementMap.get(paramName);const mappedElementParameterInfo=this.combinedParameterInfos.find((param=>param.name===paramName))??{};let mappedElementIsValid=true;if(mappedElement!==undefined){if("checkValidity"in mappedElement){mappedElementIsValid=await mappedElement.checkValidity()}else{const isParamRequired="required"in mappedElementParameterInfo?mappedElementParameterInfo.required:false;const isComponentOrParamRequired=this.required===true||isParamRequired===true;mappedElementIsValid=isComponentOrParamRequired===false||mappedElement.value!==undefined}}return mappedElementIsValid}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{parameterInfos:["parameterInfosChange"],UIparameterInfos:["UIparameterInfosChange"]}}static get style(){return analysisKeyValueCss}},[1,"analysis-key-value",{value:[1040],parameterInfos:[16],UIparameterInfos:[16],label:[513],required:[516],layout:[1],checkValidity:[64]},undefined,{parameterInfos:["parameterInfosChange"],UIparameterInfos:["UIparameterInfosChange"]}]);function defineCustomElement(){if(typeof customElements==="undefined"){return}const components=["analysis-key-value","analysis-attribute-expression","analysis-boolean-input","analysis-chip-group","analysis-data-file-input","analysis-dataset-input","analysis-dataset-input-popover","analysis-date-input","analysis-expression-group","analysis-field-input","analysis-field-select","analysis-folder-input","analysis-geoenrichment-databrowser","analysis-geoenrichment-input","analysis-item-browser","analysis-item-input","analysis-label","analysis-layer-input","analysis-layer-input-popover","analysis-linear-unit-input","analysis-multiple-input","analysis-number-input","analysis-query-builder","analysis-query-entry","analysis-query-input","analysis-query-modal","analysis-query-target-select","analysis-spatial-expression","analysis-spatial-reference-input","analysis-spatial-reference-selector","analysis-string-input","analysis-summary-fields","analysis-summary-fields-popover","analysis-traffic-time-input","analysis-tree","analysis-unsupported-input","analysis-workflow-select","analysis-workflow-select-popover"];components.forEach((tagName=>{switch(tagName){case"analysis-key-value":if(!customElements.get(tagName)){customElements.define(tagName,AnalysisKeyValue)}break;case"analysis-attribute-expression":if(!customElements.get(tagName)){analysisAttributeExpression2.defineCustomElement()}break;case"analysis-boolean-input":if(!customElements.get(tagName)){analysisBooleanInput2.defineCustomElement()}break;case"analysis-chip-group":if(!customElements.get(tagName)){analysisChipGroup2.defineCustomElement()}break;case"analysis-data-file-input":if(!customElements.get(tagName)){analysisDataFileInput2.defineCustomElement()}break;case"analysis-dataset-input":if(!customElements.get(tagName)){analysisDatasetInput2.defineCustomElement()}break;case"analysis-dataset-input-popover":if(!customElements.get(tagName)){analysisDatasetInputPopover2.defineCustomElement()}break;case"analysis-date-input":if(!customElements.get(tagName)){analysisDateInput2.defineCustomElement()}break;case"analysis-expression-group":if(!customElements.get(tagName)){analysisExpressionGroup2.defineCustomElement()}break;case"analysis-field-input":if(!customElements.get(tagName)){analysisFieldInput2.defineCustomElement()}break;case"analysis-field-select":if(!customElements.get(tagName)){analysisFieldSelect2.defineCustomElement()}break;case"analysis-folder-input":if(!customElements.get(tagName)){analysisFolderInput2.defineCustomElement()}break;case"analysis-geoenrichment-databrowser":if(!customElements.get(tagName)){analysisGeoenrichmentDatabrowser2.defineCustomElement()}break;case"analysis-geoenrichment-input":if(!customElements.get(tagName)){analysisGeoenrichmentInput2.defineCustomElement()}break;case"analysis-item-browser":if(!customElements.get(tagName)){analysisItemBrowser2.defineCustomElement()}break;case"analysis-item-input":if(!customElements.get(tagName)){analysisItemInput2.defineCustomElement()}break;case"analysis-label":if(!customElements.get(tagName)){analysisLabel2.defineCustomElement()}break;case"analysis-layer-input":if(!customElements.get(tagName)){analysisLayerInput2.defineCustomElement()}break;case"analysis-layer-input-popover":if(!customElements.get(tagName)){analysisLayerInputPopover2.defineCustomElement()}break;case"analysis-linear-unit-input":if(!customElements.get(tagName)){analysisLinearUnitInput2.defineCustomElement()}break;case"analysis-multiple-input":if(!customElements.get(tagName)){analysisMultipleInput2.defineCustomElement()}break;case"analysis-number-input":if(!customElements.get(tagName)){analysisNumberInput2.defineCustomElement()}break;case"analysis-query-builder":if(!customElements.get(tagName)){analysisQueryBuilder2.defineCustomElement()}break;case"analysis-query-entry":if(!customElements.get(tagName)){analysisQueryEntry2.defineCustomElement()}break;case"analysis-query-input":if(!customElements.get(tagName)){analysisQueryInput2.defineCustomElement()}break;case"analysis-query-modal":if(!customElements.get(tagName)){analysisQueryModal2.defineCustomElement()}break;case"analysis-query-target-select":if(!customElements.get(tagName)){analysisQueryTargetSelect2.defineCustomElement()}break;case"analysis-spatial-expression":if(!customElements.get(tagName)){analysisSpatialExpression2.defineCustomElement()}break;case"analysis-spatial-reference-input":if(!customElements.get(tagName)){analysisSpatialReferenceInput2.defineCustomElement()}break;case"analysis-spatial-reference-selector":if(!customElements.get(tagName)){analysisSpatialReferenceSelector2.defineCustomElement()}break;case"analysis-string-input":if(!customElements.get(tagName)){analysisStringInput2.defineCustomElement()}break;case"analysis-summary-fields":if(!customElements.get(tagName)){analysisSummaryFields2.defineCustomElement()}break;case"analysis-summary-fields-popover":if(!customElements.get(tagName)){analysisSummaryFieldsPopover2.defineCustomElement()}break;case"analysis-traffic-time-input":if(!customElements.get(tagName)){analysisTrafficTimeInput2.defineCustomElement()}break;case"analysis-tree":if(!customElements.get(tagName)){analysisTree2.defineCustomElement()}break;case"analysis-unsupported-input":if(!customElements.get(tagName)){analysisUnsupportedInput2.defineCustomElement()}break;case"analysis-workflow-select":if(!customElements.get(tagName)){analysisWorkflowSelect2.defineCustomElement()}break;case"analysis-workflow-select-popover":if(!customElements.get(tagName)){analysisWorkflowSelectPopover2.defineCustomElement()}break}}))}defineCustomElement();exports.AnalysisKeyValue=AnalysisKeyValue;exports.AnalysisToolUILayout=AnalysisToolUILayout;exports.defineCustomElement=defineCustomElement;exports.pick=pick}));
