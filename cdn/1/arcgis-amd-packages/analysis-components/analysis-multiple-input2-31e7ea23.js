define(["exports","./index-ef555910","./index2-588b02d9","./utils-793221d4"],(function(exports,index,index2,utils){"use strict";const HTMLClasses={chipContainer:"chip-container",customInputLabel:"custom-input-label"};const analysisMultipleInputCss=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}:host{--calcite-color-border-input:var(--analysis-ui-border-input)}.chip-container{display:flex;flex-wrap:wrap;gap:0.25rem}.custom-input-label{margin-bottom:var(--analysis-quarter-spacing)/2}";const AnalysisMultipleInput=index.proxyCustomElement(class AnalysisMultipleInput extends index.H{constructor(){super();this.__registerHost();this.__attachShadow();this.analysisMultipleInputChange=index.createEvent(this,"analysisMultipleInputChange",7);this.renderCombobox=()=>{const{choiceList,errorMessage,value,scale,placeholderText}=this;const hasError=typeof this.errorMessage!=="undefined";const comboBoxItems=choiceList?.map((choice=>{const selected=value!==undefined&&value.includes(choice);return this.buildComboBoxItem(choice,selected)}));const validationParamsMessage=index2.formatValidationParamsMessage(this.validationParams);const showInputMessage=index2.isEmptyDataItem(validationParamsMessage)===false||hasError===true;const uiInputStatus=hasError?index2.UIInputStatus.INVALID:index2.getUIInputStatusFromMessageType(this.validationParams?.type);return index.h("calcite-label",{scale},index.h("calcite-combobox",{label:this.label,scale,selectionMode:"multiple",placeholder:placeholderText??this.strings.defaultPlaceholder,onCalciteComboboxChange:this.handleComboboxChange},comboBoxItems),index.h("calcite-input-message",{status:uiInputStatus,scale:utils.UIDefaults.Scale,hidden:!showInputMessage,icon:"exclamationMarkTriangle"},errorMessage??validationParamsMessage))};this.buildComboBoxItem=(choice,selected)=>index.h("calcite-combobox-item",{key:choice,value:choice,textLabel:choice,selected});this.buildChip=value=>index.h("calcite-chip",{closable:true,scale:utils.UIDefaults.Scale,value,key:value,onCalciteChipClose:this.handleChipClose},index2.formatNumberToLocale(value));this.handleComboboxChange=event=>{const selectedItems=event.target?.selectedItems;const newValues=selectedItems?.map((item=>item.value));if(!(Array.isArray(newValues)&&newValues.length!==0)&&this.required===true){this.errorMessage=this.strings.requiredInputMessage;return}this.value=newValues;this.analysisMultipleInputChange.emit(this.value);this.errorMessage=this.validate(this.value);this.checkUnderMinValues()};this.handleNewChip=()=>{if(this.isAtMaxValues)return;const value=this.inputElement?.value;if(value!==undefined&&value!==""){this.errorMessage=this.validate([value]);if(this.isValid){const valuesUnique=new Set([...this.value??[],value]);this.value=Array.from(valuesUnique);this.analysisMultipleInputChange.emit(this.value);if(this.inputElement!==undefined)this.inputElement.value="";this.errorMessage=this.validate(this.value);this.checkUnderMinValues()}}};this.handleKeyDown=event=>{if(event?.key==="Tab"&&this.inputElement?.value!==""){event.preventDefault();this.handleNewChip()}};this.handleChipClose=async event=>{const chipToRemove=event?.target;const valueToRemove=chipToRemove?.value;const previousSibling=chipToRemove?.previousElementSibling;const filteredValues=this.value.filter((value=>value!==valueToRemove));this.value=filteredValues;this.analysisMultipleInputChange.emit(this.value);this.errorMessage=this.validate(this.value);this.checkUnderMinValues();await(previousSibling?.setFocus())};this.checkUnderMinValues=()=>{const minValues=this.validationOptions?.minValues;if(minValues!==undefined){this.errorMessage=this.isUnderMinValues?index2.formatMessage(this.strings.minValuesMessage,{minValues:index2.formatNumberToLocale(minValues)}):this.errorMessage}};this.value=undefined;this.label=undefined;this.placeholderText=undefined;this.dataType="number";this.choiceList=undefined;this.scale=utils.UIDefaults.Scale;this.required=undefined;this.validationParams=undefined;this.validationOptions=undefined;this.errorMessage=undefined}get isValid(){return this.errorMessage===undefined||this.errorMessage===""}get isOverMaxValues(){const maxValues=this.validationOptions?.maxValues??Number.MAX_SAFE_INTEGER;return this.value?.length>maxValues}get isAtMaxValues(){const maxValues=this.validationOptions?.maxValues??Number.MAX_SAFE_INTEGER;return this.value?.length===maxValues}get isUnderMinValues(){const minValues=this.validationOptions?.minValues??0;return this.value?.length<minValues}async checkValidity(){if(this.isOverMaxValues){this.errorMessage=index2.formatMessage(this.strings.maxValuesMessage,{maxValues:index2.formatNumberToLocale(this.validationOptions?.maxValues)})}if(this.value?.length!==0&&this.isUnderMinValues){this.errorMessage=index2.formatMessage(this.strings.minValuesMessage,{minValues:index2.formatNumberToLocale(this.validationOptions?.minValues)})}const hasErrorValidationMessage=this.validationParams?.type!=="informative";this.errorMessage=this.validate(this.value)??this.errorMessage??(hasErrorValidationMessage?this.validationParams?.message:undefined);return Promise.resolve(this.isValid)}async componentWillLoad(){({strings:this.strings}=await index2.fetchComponentLocaleStrings(this.hostElement,index.getAssetPath(`.`)))}render(){return this.choiceList!==undefined&&this.choiceList.length>0?this.renderCombobox():this.renderNoChoiceList()}renderNoChoiceList(){const hasError=typeof this.errorMessage!=="undefined";let hasWarning=false;let warningMessage=undefined;if(this.validationOptions?.maxValues!==undefined){hasWarning=!hasError&&this.isAtMaxValues;warningMessage=index2.formatMessage(this.strings.maxValuesMessage,{maxValues:index2.formatNumberToLocale(this.validationOptions.maxValues)})}const validationParamsMessage=index2.formatValidationParamsMessage(this.validationParams);const hasErrorOrWarning=hasError===true||hasWarning===true;const showInputMessage=index2.isEmptyDataItem(validationParamsMessage)===false||hasErrorOrWarning;const uiInputStatus=hasErrorOrWarning?index2.UIInputStatus.INVALID:index2.getUIInputStatusFromMessageType(this.validationParams?.type);const borderInputStatus=hasErrorOrWarning?index2.UIInputStatus.INVALID:index2.isEmptyDataItem(this.validationParams)?index2.UIInputStatus.IDLE:index2.getUIInputStatusFromMessageType(this.validationParams?.type);return index.h(index.Host,null,index.h("calcite-label",{scale:this.scale,class:HTMLClasses.customInputLabel},this.label,index.h("calcite-input",{disabled:this.isAtMaxValues,type:this.dataType,placeholder:this.placeholderText??this.strings.defaultPlaceholder,scale:this.scale,status:borderInputStatus,numberButtonType:"none",max:this.validationOptions?.max,min:this.validationOptions?.min,step:this.validationOptions?.isFloatType===true?"any":1,onCalciteInputChange:this.handleNewChip,onKeyDown:this.handleKeyDown,ref:input=>this.inputElement=input},index.h("calcite-button",{disabled:this.isAtMaxValues,scale:this.scale,slot:"action",onClick:this.handleNewChip,"icon-start":"plus"},this.strings.add)),index.h("calcite-input-message",{class:HTMLClasses.customInputLabel,status:uiInputStatus,scale:utils.UIDefaults.Scale,hidden:!showInputMessage,icon:"exclamationMarkTriangle"},this.errorMessage??warningMessage??validationParamsMessage)),index.h("div",{class:HTMLClasses.chipContainer},this.value?.map((value=>this.buildChip(value)))))}validate(values=this.value){let errorMessage;if(this.required===true&&(values===undefined||values?.length===0)){errorMessage=this.strings.requiredInputMessage}else{if(this.dataType==="number"){const combinedValidationOptions={...{required:false},...this.validationOptions};const mapCallback=value=>utils.validateNumber(index2.parseNumber(value),combinedValidationOptions);const errorKey=values?.map(mapCallback).find((message=>message!==undefined));const{min,max}=combinedValidationOptions;const formatOptions={min:index2.formatNumberToLocale(min),max:index2.formatNumberToLocale(max)};errorMessage=errorKey!==undefined?index2.formatMessage(this.strings[errorKey],formatOptions):undefined}else{errorMessage=undefined}}return errorMessage}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get style(){return analysisMultipleInputCss}},[1,"analysis-multiple-input",{value:[1040],label:[513],placeholderText:[513,"placeholder-text"],dataType:[513,"data-type"],choiceList:[16],scale:[1],required:[516],validationParams:[16],validationOptions:[16],errorMessage:[1025,"error-message"],checkValidity:[64]}]);function defineCustomElement(){if(typeof customElements==="undefined"){return}const components=["analysis-multiple-input"];components.forEach((tagName=>{switch(tagName){case"analysis-multiple-input":if(!customElements.get(tagName)){customElements.define(tagName,AnalysisMultipleInput)}break}}))}defineCustomElement();exports.AnalysisMultipleInput=AnalysisMultipleInput;exports.defineCustomElement=defineCustomElement}));
