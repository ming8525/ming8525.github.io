define(["exports","./index-ef555910","./index2-588b02d9","./utils-793221d4","./analysis-dataset-input-popover2-b6dcb32a","./analysis-label2-f17c360a"],(function(exports,index,index2,utils,analysisDatasetInputPopover2,analysisLabel2){"use strict";const component="dataset-input";const HTMLClasses={border:`${component}__border`,container:`${component}__container`};const analysisDatasetInputCss=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}:host{display:flex;flex-direction:column;width:var(--analysis-component-default-width)}.dataset-input__border{border:1px solid var(--analysis-ui-border-input)}.dataset-input__container{margin-bottom:var(--analysis-half-spacing)}";const AnalysisDatasetInput=index.proxyCustomElement(class AnalysisDatasetInput extends index.H{constructor(){super();this.__registerHost();this.analysisDatasetInputChange=index.createEvent(this,"analysisDatasetInputChange",7);this.analysisHelpClick=index.createEvent(this,"analysisHelpClick",7);this.renderInitialMode=()=>index.h("section",null,index.h("calcite-label",{scale:utils.UIDefaults.Scale},this.label!==undefined&&this.label!==""?index.h("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,this.renderAddButton(),this.renderErrorMessage()));this.renderListMode=()=>{const datasetElements=this.valueArray?.map((dataset=>index.h("calcite-value-list-item",{key:dataset.id,value:dataset.id,label:dataset.name,description:dataset.description},index.h("calcite-action",{text:this.strings.remove,slot:"actions-end",label:this.strings.remove,appearance:"transparent",icon:"x",onClick:this.onValueListItemRemoveClicked}))));return index.h("section",{class:HTMLClasses.container},index.h("calcite-label",{scale:utils.UIDefaults.Scale},index.h("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}),index.h("calcite-value-list",{class:HTMLClasses.border,onMouseOver:this.onValueListMouseOver,onMouseOut:this.onValueListMouseOut,onClick:this.onValueListClicked},datasetElements),this.renderErrorMessage()),this.isMultiSelect&&this.renderAddButton())};this.renderErrorMessage=()=>{const hasError=this.errorMessage!==undefined;return index.h("calcite-input-message",{hidden:!hasError,icon:"exclamationMarkTriangle",status:index2.UIInputStatus.INVALID,scale:utils.UIDefaults.Scale},this.errorMessage)};this.renderAddButton=()=>index.h("calcite-button",{appearance:"outline",kind:"neutral",round:true,"icon-start":"plus",onClick:this.onAddButtonClicked,width:"full",scale:utils.UIDefaults.Scale},this.strings.dataset);this.onAddButtonClicked=e=>{this.createDatasetInputPopover(e.target)};this.onValueListMouseOver=e=>{const targetElement=e.target;if(targetElement?.localName==="calcite-value-list-item"){if(this.replaceTooltip===undefined){this.replaceTooltip=document.createElement("calcite-tooltip");this.replaceTooltip.placement="bottom";this.replaceTooltip.innerText=this.strings.replaceDataset}this.replaceTooltip.referenceElement=targetElement;utils.addOpenableDomElement(document,this.replaceTooltip)}};this.onValueListMouseOut=()=>{utils.removeOpenableDomElement(this.replaceTooltip)};this.onValueListClicked=e=>{const targetElement=e.target;if(targetElement?.localName==="calcite-value-list-item"){this.createDatasetInputPopover(e.target)}};this.onValueListItemRemoveClicked=e=>{const target=e.target;const listItem=target.parentNode;const datasetId=listItem.value;const newValueArray=this.valueArray?.filter((dataset=>dataset.id!==datasetId));this.updateValueFromArray(newValueArray)};this.createDatasetInputPopover=referenceElement=>{if(this.datasetInputPopover===undefined){this.datasetInputPopover=document.createElement("analysis-dataset-input-popover");this.datasetInputPopover.addEventListener("analysisDatasetInputPopoverClose",this.onDatasetPopoverClose);this.datasetInputPopover.addEventListener("analysisDatasetInputPopoverSelectionChange",this.onDatasetInputPopoverChange)}this.datasetInputPopover.selectedDatasetIds=this.valueArray?.map((dataset=>dataset.id));this.datasetInputPopover.selectionMode=this.selectionMode;this.datasetInputPopover.analysisDatasets=this.analysisDatasets;this.datasetInputPopover.placement="leading";this.datasetInputPopover.referenceElement=referenceElement.parentElement??referenceElement;utils.addOpenableDomElement(document,this.datasetInputPopover)};this.onDatasetPopoverClose=()=>{utils.removeOpenableDomElement(this.datasetInputPopover);this.datasetInputPopover=undefined;this.validate()};this.onDatasetInputPopoverChange=event=>{const selectedDatasetIds=event.detail.selectedDatasetIds;const selectedDatasetIdsSet=new Set(selectedDatasetIds);const newValueArray=this.analysisDatasets?.filter((dataset=>selectedDatasetIdsSet.has(dataset.id)));this.updateValueFromArray(newValueArray)};this.updateValueFromArray=newValueArray=>{if(this.isMultiSelect){this.value=newValueArray}else{const isUndefinedOrEmpty=newValueArray===undefined||newValueArray.length<1;this.value=isUndefinedOrEmpty?undefined:newValueArray[0]}this.analysisDatasetInputChange.emit()};this.validate=()=>{if(this.required&&!this.hasValue){this.errorMessage=index2.formatMessage(this.strings.isRequired,{label:this.label})}else{this.errorMessage=undefined}};this.label=undefined;this.required=false;this.selectionMode=undefined;this.analysisDatasets=undefined;this.value=undefined;this.errorMessage=undefined}onValueChange(){this.validate()}get isMultiSelect(){return this.selectionMode==="multi"}get hasValue(){return this.isMultiSelect?this.value!==undefined&&this.value.length>0:this.value!==undefined}get valueArray(){let valueArray;if(this.value!==undefined){valueArray=this.isMultiSelect?this.value:[this.value]}return valueArray}async componentWillLoad(){({strings:this.strings}=await index2.fetchComponentLocaleStrings(this.hostElement,index.getAssetPath(`.`)))}disconnectedCallback(){utils.removeOpenableDomElement(this.datasetInputPopover);utils.removeOpenableDomElement(this.replaceTooltip)}render(){return index.h(index.Host,null,this.hasValue?this.renderListMode():this.renderInitialMode())}async checkValidity(){this.validate();const validity=this.errorMessage===undefined||this.errorMessage==="";return Promise.resolve(validity)}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{value:["onValueChange"]}}static get style(){return analysisDatasetInputCss}},[0,"analysis-dataset-input",{label:[513],required:[516],selectionMode:[513,"selection-mode"],analysisDatasets:[16],value:[1040],errorMessage:[32],checkValidity:[64]},undefined,{value:["onValueChange"]}]);function defineCustomElement(){if(typeof customElements==="undefined"){return}const components=["analysis-dataset-input","analysis-dataset-input-popover","analysis-label"];components.forEach((tagName=>{switch(tagName){case"analysis-dataset-input":if(!customElements.get(tagName)){customElements.define(tagName,AnalysisDatasetInput)}break;case"analysis-dataset-input-popover":if(!customElements.get(tagName)){analysisDatasetInputPopover2.defineCustomElement()}break;case"analysis-label":if(!customElements.get(tagName)){analysisLabel2.defineCustomElement()}break}}))}defineCustomElement();exports.AnalysisDatasetInput=AnalysisDatasetInput;exports.defineCustomElement=defineCustomElement}));
