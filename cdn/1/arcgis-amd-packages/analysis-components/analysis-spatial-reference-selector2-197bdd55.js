define(["exports","./index-ef555910","./index2-588b02d9","./utils-793221d4","./analysis-tree2-21de4d9f","./isObject-072a0200","./isSymbol-765de845"],(function(e,t,s,i,a,r,n){"use strict";var l=/\s/,o=/^\s+/;var c=NaN,h=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,d=/^0o[0-7]+$/i,f=parseInt;function p(e){if("number"==typeof e)return e;if(n.isSymbol(e))return c;if(r.isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r.isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;var s;e=(s=e)?s.slice(0,function(e){for(var t=e.length;t--&&l.test(e.charAt(t)););return t}(s)+1).replace(o,""):s;var i=u.test(e);return i||d.test(e)?f(e.slice(2),i?2:8):h.test(e)?c:+e}var m=function(){return r.root.Date.now()},v=Math.max,g=Math.min;const y=t.proxyCustomElement(class extends t.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.analysisSpatialReferenceValueChange=t.createEvent(this,"analysisSpatialReferenceValueChange",7),this.analysisSpatialReferenceSelectorDismissed=t.createEvent(this,"analysisSpatialReferenceSelectorDismissed",7),this.searchText="",this.performantFilterSpatialReferences=function(e,t,s){var i,a,n,l,o,c,h=0,u=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var s=i,r=a;return i=a=void 0,h=t,l=e.apply(r,s)}function S(e){var s=e-c;return void 0===c||s>=t||s<0||d&&e-h>=n}function R(){var e=m();if(S(e))return C(e);o=setTimeout(R,function(e){var s=t-(e-c);return d?g(s,n-(e-h)):s}(e))}function C(e){return o=void 0,f&&i?y(e):(i=a=void 0,l)}function b(){var e=m(),s=S(e);if(i=arguments,a=this,c=e,s){if(void 0===o)return function(e){return h=e,o=setTimeout(R,t),u?y(e):l}(c);if(d)return clearTimeout(o),o=setTimeout(R,t),y(c)}return void 0===o&&(o=setTimeout(R,t)),l}return t=p(t)||0,r.isObject(s)&&(u=!!s.leading,n=(d="maxWait"in s)?v(p(s.maxWait)||0,t):n,f="trailing"in s?!!s.trailing:f),b.cancel=function(){void 0!==o&&clearTimeout(o),h=0,i=c=a=o=void 0},b.flush=function(){return void 0===o?l:C(m())},b}((e=>{this.updateSearchResults(e)}),250,{leading:!1,trailing:!0}),this.defaultWkid=4326,this.value=void 0,this.hideCategories=void 0,this.searchResults=void 0}async getSRDescription(){return void 0!==this.value?.latestWkid?Promise.resolve(s.getSpatialReferenceDescription(this.value?.latestWkid)):Promise.resolve(void 0)}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await s.fetchComponentLocaleStrings(this.hostElement,t.getAssetPath("."))),this.value=this.value??{latestWkid:this.defaultWkid};const e=this.filterSrCategories(s.srCategories);this.visibleSrCategories=this.translateSrCategories(e)}translateSrCategories(e){const t={};return this.recursiveTranslate(e,t),t}recursiveTranslate(e,t){Object.keys(e).forEach((s=>{const i=this.getTranslatedKey(s);"object"==typeof e[s]?(t[i]={},this.recursiveTranslate(e[s],t[i])):t[i]=e[s]}))}getTranslatedKey(e){return e in this.strings?this.strings[e]:e}filterSrCategories(e){const t={};return Object.keys(e).forEach((s=>{void 0!==this.hideCategories&&!1!==this.hideCategories?.includes(s)||("object"==typeof e[s]?t[s]=this.filterSrCategories(e[s]):t[s]=e[s])})),t}setSpatialRef(e){this.value={latestWkid:Number(e)},this.analysisSpatialReferenceValueChange.emit(this.value)}inputKeyDown(e){"Enter"===e.key&&this.selectFirstChild(!0)}selectFirstChild(e){const t=this.treeElement,s=t?.shadowRoot?.querySelector("calcite-tree-item:not([has-children]):not([data-key='placeholder'])")||void 0;void 0!==t&&void 0!==s&&(s.selected=!0,this.setSpatialRef(s.dataset.key??""),e&&s.focus())}updateSearchResults(e){this.searchResults=s.filterSpatialReferences(e)}searchSpatialReferences(e){null!==e.target&&(this.searchText=e.target.value??"",this.searchText.length>1?this.performantFilterSpatialReferences(this.searchText):this.searchResults=void 0)}render(){const e=s.formatMessage(this.strings.noMatchesFound,{searchTerm:this.searchText??""});return t.h(t.Host,{dir:this.dir},t.h("calcite-panel",{closable:!1,closed:!1,onCalcitePanelClose:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},t.h("calcite-input",{onCalciteInputInput:e=>this.searchSpatialReferences(e),onKeyDown:e=>this.inputKeyDown(e),placeholder:this.strings.searchPlaceholder,scale:i.UIDefaults.Scale,type:"search",icon:!0,autofocus:!0}),this.searchText.length>1&&s.isEmptyDataItem(this.searchResults)&&t.h("p",{class:"no-matches-found-msg"},e),t.h("analysis-tree",{key:"tree",ref:e=>this.treeElement=e,data:void 0!==this.searchResults&&this.searchText.length>0?this.searchResults:this.visibleSrCategories,value:this.value&&`${this.value?.latestWkid}`,onAnalysisTreeValueChange:()=>{this.setSpatialRef(this.treeElement.value)}}),t.h("calcite-button",{appearance:"solid",scale:i.UIDefaults.Scale,width:"full",slot:"footer-actions",onClick:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},this.strings.done)))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get style(){return":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}:host{overflow-y:hidden;display:flex;flex-direction:column;--calcite-color-border-input:var(--analysis-ui-border-input);height:var(--analysis-popover-content-height);min-width:20rem;max-width:27rem}.no-matches-found-msg{margin:var(--analysis-half-spacing);font-size:var(--calcite-font-size--2)}analysis-tree{flex:1}"}},[1,"analysis-spatial-reference-selector",{defaultWkid:[1538,"default-wkid"],value:[1040],hideCategories:[16],searchResults:[32],getSRDescription:[64]}]);function S(){"undefined"!=typeof customElements&&["analysis-spatial-reference-selector","analysis-tree"].forEach((e=>{switch(e){case"analysis-spatial-reference-selector":customElements.get(e)||customElements.define(e,y);break;case"analysis-tree":customElements.get(e)||a.defineCustomElement()}}))}S(),e.AnalysisSpatialReferenceSelector=y,e.defineCustomElement=S}));