define(["exports","./index-ef555910","./index2-588b02d9","./utils-793221d4","./analysis-geoenrichment-databrowser2-6a737015","./analysis-label2-f17c360a"],(function(exports,index,index2,utils,analysisGeoenrichmentDatabrowser2,analysisLabel2){"use strict";const HTMLClasses={buttonContainer:`button-container`,border:`list-item-border`};const analysisGeoenrichmentInputCss=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:#d4d4d4;--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}.list-item-border{border:1px solid var(--analysis-ui-border-input);box-shadow:none}";const AnalysisGeoenrichmentInput=index.proxyCustomElement(class AnalysisGeoenrichmentInput extends index.H{constructor(){super();this.__registerHost();this.__attachShadow();this.analysisGeoenrichmentInputChange=index.createEvent(this,"analysisGeoenrichmentInputChange",7);this.analysisHelpClick=index.createEvent(this,"analysisHelpClick",7);this.doValidate=false;this.renderAddVariable=()=>index.h("calcite-button",{width:"full",appearance:"outline",kind:"neutral","icon-start":"plus",scale:utils.UIDefaults.Scale,round:true,onClick:this.openDataBrowser},this.strings.addVariableLabel);this.renderSelectedVariables=()=>{const listItems=this.value?.analysisVariables?.map(((variable,i)=>index.h("calcite-value-list-item",{key:variable,label:this.value?.labels?.[i]??variable,value:variable,class:HTMLClasses.border,removable:true,onCalciteListItemRemove:this.onListItemRemove})));return index.h("calcite-value-list",null,listItems)};this.onListItemRemove=e=>{const listItem=e.target;const removedValue=listItem?.value;if(this.value!==undefined){let{analysisVariables,labels}=this.value;analysisVariables=analysisVariables?.filter((item=>item!==removedValue));labels=labels?.filter((item=>item!==listItem?.label));this.doValidate=true;if(analysisVariables?.length===0){this.value=undefined}else{this.value=Object.assign({},this.value,{analysisVariables,labels})}}this.analysisGeoenrichmentInputChange.emit()};this.openDataBrowser=()=>{this.dataBrowserElement=document.createElement("analysis-geoenrichment-databrowser");this.dataBrowserElement.addEventListener("analysisDataBrowserSelectionChange",this.onSelectedVariables);this.dataBrowserElement.addEventListener("analysisDataBrowserClose",this.closeModal);document.body.appendChild(this.dataBrowserElement);this.dataBrowserElement.value=this.value?.analysisVariables;this.dataBrowserElement.portal=this.portal;this.dataBrowserElement.countryId=this.countryId;this.dataBrowserElement.hierarchyId=this.hierarchyId};this.closeModal=()=>{if(this.dataBrowserElement!==undefined){this.dataBrowserElement.removeEventListener("analysisDataBrowserSelectionChange",this.onSelectedVariables);this.dataBrowserElement.removeEventListener("analysisDataBrowserClose",this.closeModal);this.dataBrowserElement.remove();this.dataBrowserElement=undefined}};this.onSelectedVariables=event=>{const{selectedValues,countryId,hierarchyId,countryAlias,hierarchyAlias}=event.detail;this.countryId=countryId;this.hierarchyId=hierarchyId;const[analysisVariables,labels]=selectedValues.reduce(((accumulator,currentValue)=>{const[variables,labelStrings]=accumulator;variables.push(currentValue.value);labelStrings.push(currentValue.label);return[variables,labelStrings]}),[[],[]]);this.doValidate=true;this.value={country:this.countryId,hierarchy:this.hierarchyId,countryAlias,hierarchyAlias,analysisVariables,labels};this.analysisGeoenrichmentInputChange.emit();this.closeModal()};this.validate=()=>{let isValid;if(this.required&&index2.isEmptyDataItem(this.value?.analysisVariables)===true){isValid=false;this.error=this.strings.requiredInputMessage}else{isValid=true;this.error=undefined}return isValid};this.error=undefined;this.value=undefined;this.required=false;this.label=undefined;this.portal=undefined}valueChange(newValue){this.countryId=newValue?.country??undefined;this.hierarchyId=newValue?.hierarchy??undefined;if(this.doValidate===true)this.validate()}get hasError(){return this.error!==undefined}async componentWillLoad(){({strings:this.strings}=await index2.fetchComponentLocaleStrings(this.hostElement,index.getAssetPath(`.`)));const hasAnalysisVariables=this.value?.analysisVariables?.length??0;if(hasAnalysisVariables>0){this.doValidate=true}if(this.value!==undefined){this.valueChange(this.value)}}disconnectedCallback(){this.closeModal()}async checkValidity(){const isValid=this.validate();return Promise.resolve(isValid)}render(){const analysisVariablesLength=this.value?.analysisVariables?.length??0;const selectedVariablesList=analysisVariablesLength>0?this.renderSelectedVariables():null;return index.h(index.Host,null,index2.isEmptyDataItem(this.label)===false?index.h("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,selectedVariablesList,this.renderAddVariable(),index.h("calcite-input-message",{status:"invalid",scale:utils.UIDefaults.Scale,hidden:!this.hasError,icon:"exclamationMarkTriangle"},this.error))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{value:["valueChange"]}}static get style(){return analysisGeoenrichmentInputCss}},[1,"analysis-geoenrichment-input",{value:[1040],required:[516],label:[513],portal:[16],error:[32],checkValidity:[64]},undefined,{value:["valueChange"]}]);function defineCustomElement(){if(typeof customElements==="undefined"){return}const components=["analysis-geoenrichment-input","analysis-geoenrichment-databrowser","analysis-label"];components.forEach((tagName=>{switch(tagName){case"analysis-geoenrichment-input":if(!customElements.get(tagName)){customElements.define(tagName,AnalysisGeoenrichmentInput)}break;case"analysis-geoenrichment-databrowser":if(!customElements.get(tagName)){analysisGeoenrichmentDatabrowser2.defineCustomElement()}break;case"analysis-label":if(!customElements.get(tagName)){analysisLabel2.defineCustomElement()}break}}))}defineCustomElement();exports.AnalysisGeoenrichmentInput=AnalysisGeoenrichmentInput;exports.defineCustomElement=defineCustomElement}));
