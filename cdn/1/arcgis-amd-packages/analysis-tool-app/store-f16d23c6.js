define(["exports","./index2-0f07feca","./shared-components-e09cc192"],(function(exports,index2,sharedComponents){"use strict";var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal||freeSelf||Function("return this")();var Symbol=root.Symbol;var objectProto$5=Object.prototype;var hasOwnProperty$4=objectProto$5.hasOwnProperty;var nativeObjectToString$1=objectProto$5.toString;var symToStringTag$1=Symbol?Symbol.toStringTag:undefined;function getRawTag(value){var isOwn=hasOwnProperty$4.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=undefined;var unmasked=true}catch(e){}var result=nativeObjectToString$1.call(value);if(unmasked){if(isOwn){value[symToStringTag$1]=tag}else{delete value[symToStringTag$1]}}return result}var objectProto$4=Object.prototype;var nativeObjectToString=objectProto$4.toString;function objectToString(value){return nativeObjectToString.call(value)}var nullTag="[object Null]",undefinedTag="[object Undefined]";var symToStringTag=Symbol?Symbol.toStringTag:undefined;function baseGetTag(value){if(value==null){return value===undefined?undefinedTag:nullTag}return symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function isObjectLike(value){return value!=null&&typeof value=="object"}var symbolTag="[object Symbol]";function isSymbol(value){return typeof value=="symbol"||isObjectLike(value)&&baseGetTag(value)==symbolTag}function arrayMap(array,iteratee){var index=-1,length=array==null?0:array.length,result=Array(length);while(++index<length){result[index]=iteratee(array[index],index,array)}return result}var isArray=Array.isArray;var INFINITY$1=1/0;var symbolProto=Symbol?Symbol.prototype:undefined,symbolToString=symbolProto?symbolProto.toString:undefined;function baseToString(value){if(typeof value=="string"){return value}if(isArray(value)){return arrayMap(value,baseToString)+""}if(isSymbol(value)){return symbolToString?symbolToString.call(value):""}var result=value+"";return result=="0"&&1/value==-INFINITY$1?"-0":result}function isObject(value){var type=typeof value;return value!=null&&(type=="object"||type=="function")}var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(value){if(!isObject(value)){return false}var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}var coreJsData=root["__core-js_shared__"];var maskSrcKey=function(){var uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return uid?"Symbol(src)_1."+uid:""}();function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}var funcProto$1=Function.prototype;var funcToString$1=funcProto$1.toString;function toSource(func){if(func!=null){try{return funcToString$1.call(func)}catch(e){}try{return func+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g;var reIsHostCtor=/^\[object .+?Constructor\]$/;var funcProto=Function.prototype,objectProto$3=Object.prototype;var funcToString=funcProto.toString;var hasOwnProperty$3=objectProto$3.hasOwnProperty;var reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$3).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(value){if(!isObject(value)||isMasked(value)){return false}var pattern=isFunction(value)?reIsNative:reIsHostCtor;return pattern.test(toSource(value))}function getValue(object,key){return object==null?undefined:object[key]}function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:undefined}var defineProperty=function(){try{var func=getNative(Object,"defineProperty");func({},"",{});return func}catch(e){}}();var MAX_SAFE_INTEGER=9007199254740991;var reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(value,length){var type=typeof value;length=length==null?MAX_SAFE_INTEGER:length;return!!length&&(type=="number"||type!="symbol"&&reIsUint.test(value))&&(value>-1&&value%1==0&&value<length)}function baseAssignValue(object,key,value){if(key=="__proto__"&&defineProperty){defineProperty(object,key,{configurable:true,enumerable:true,value,writable:true})}else{object[key]=value}}function eq(value,other){return value===other||value!==value&&other!==other}var objectProto$2=Object.prototype;var hasOwnProperty$2=objectProto$2.hasOwnProperty;function assignValue(object,key,value){var objValue=object[key];if(!(hasOwnProperty$2.call(object,key)&&eq(objValue,value))||value===undefined&&!(key in object)){baseAssignValue(object,key,value)}}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(value,object){if(isArray(value)){return false}var type=typeof value;if(type=="number"||type=="symbol"||type=="boolean"||value==null||isSymbol(value)){return true}return reIsPlainProp.test(value)||!reIsDeepProp.test(value)||object!=null&&value in Object(object)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{};this.size=0}function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];this.size-=result?1:0;return result}var HASH_UNDEFINED$1="__lodash_hash_undefined__";var objectProto$1=Object.prototype;var hasOwnProperty$1=objectProto$1.hasOwnProperty;function hashGet(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED$1?undefined:result}return hasOwnProperty$1.call(data,key)?data[key]:undefined}var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;function hashHas(key){var data=this.__data__;return nativeCreate?data[key]!==undefined:hasOwnProperty.call(data,key)}var HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(key,value){var data=this.__data__;this.size+=this.has(key)?0:1;data[key]=nativeCreate&&value===undefined?HASH_UNDEFINED:value;return this}function Hash(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear;Hash.prototype["delete"]=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[];this.size=0}function assocIndexOf(array,key){var length=array.length;while(length--){if(eq(array[length][0],key)){return length}}return-1}var arrayProto=Array.prototype;var splice=arrayProto.splice;function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){return false}var lastIndex=data.length-1;if(index==lastIndex){data.pop()}else{splice.call(data,index,1)}--this.size;return true}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){++this.size;data.push([key,value])}else{data[index][1]=value}return this}function ListCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype["delete"]=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0;this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(value){var type=typeof value;return type=="string"||type=="number"||type=="symbol"||type=="boolean"?value!=="__proto__":value===null}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data[typeof key=="string"?"string":"hash"]:data.map}function mapCacheDelete(key){var result=getMapData(this,key)["delete"](key);this.size-=result?1:0;return result}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){var data=getMapData(this,key),size=data.size;data.set(key,value);this.size+=data.size==size?0:1;return this}function MapCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype["delete"]=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT="Expected a function";function memoize(func,resolver){if(typeof func!="function"||resolver!=null&&typeof resolver!="function"){throw new TypeError(FUNC_ERROR_TEXT)}var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key)}var result=func.apply(this,args);memoized.cache=cache.set(key,result)||cache;return result};memoized.cache=new(memoize.Cache||MapCache);return memoized}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(func){var result=memoize(func,(function(key){if(cache.size===MAX_MEMOIZE_SIZE){cache.clear()}return key}));var cache=result.cache;return result}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=memoizeCapped((function(string){var result=[];if(string.charCodeAt(0)===46){result.push("")}string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}));return result}));function toString(value){return value==null?"":baseToString(value)}function castPath(value,object){if(isArray(value)){return value}return isKey(value,object)?[value]:stringToPath(toString(value))}var INFINITY=1/0;function toKey(value){if(typeof value=="string"||isSymbol(value)){return value}var result=value+"";return result=="0"&&1/value==-INFINITY?"-0":result}function baseSet(object,path,value,customizer){if(!isObject(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key==="__proto__"||key==="constructor"||key==="prototype"){return object}if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}function set(object,path,value){return object==null?object:baseSet(object,path,value)}const appendToMap=(map,propName,value)=>{const items=map.get(propName);if(!items){map.set(propName,[value])}else if(!items.includes(value)){items.push(value)}};const debounce=(fn,ms)=>{let timeoutId;return(...args)=>{if(timeoutId){clearTimeout(timeoutId)}timeoutId=setTimeout((()=>{timeoutId=0;fn(...args)}),ms)}};const isConnected=maybeElement=>!("isConnected"in maybeElement)||maybeElement.isConnected;const cleanupElements=debounce((map=>{for(let key of map.keys()){map.set(key,map.get(key).filter(isConnected))}}),2e3);const stencilSubscription=()=>{if(typeof index2.getRenderingRef!=="function"){return{}}const elmsToUpdate=new Map;return{dispose:()=>elmsToUpdate.clear(),get:propName=>{const elm=index2.getRenderingRef();if(elm){appendToMap(elmsToUpdate,propName,elm)}},set:propName=>{const elements=elmsToUpdate.get(propName);if(elements){elmsToUpdate.set(propName,elements.filter(index2.forceUpdate))}cleanupElements(elmsToUpdate)},reset:()=>{elmsToUpdate.forEach((elms=>elms.forEach(index2.forceUpdate)));cleanupElements(elmsToUpdate)}}};const unwrap=val=>typeof val==="function"?val():val;const createObservableMap=(defaultState,shouldUpdate=((a,b)=>a!==b))=>{const unwrappedState=unwrap(defaultState);let states=new Map(Object.entries(unwrappedState!==null&&unwrappedState!==void 0?unwrappedState:{}));const handlers={dispose:[],get:[],set:[],reset:[]};const reset=()=>{var _a;states=new Map(Object.entries((_a=unwrap(defaultState))!==null&&_a!==void 0?_a:{}));handlers.reset.forEach((cb=>cb()))};const dispose=()=>{handlers.dispose.forEach((cb=>cb()));reset()};const get=propName=>{handlers.get.forEach((cb=>cb(propName)));return states.get(propName)};const set=(propName,value)=>{const oldValue=states.get(propName);if(shouldUpdate(value,oldValue,propName)){states.set(propName,value);handlers.set.forEach((cb=>cb(propName,value,oldValue)))}};const state=typeof Proxy==="undefined"?{}:new Proxy(unwrappedState,{get(_,propName){return get(propName)},ownKeys(_){return Array.from(states.keys())},getOwnPropertyDescriptor(){return{enumerable:true,configurable:true}},has(_,propName){return states.has(propName)},set(_,propName,value){set(propName,value);return true}});const on=(eventName,callback)=>{handlers[eventName].push(callback);return()=>{removeFromArray(handlers[eventName],callback)}};const onChange=(propName,cb)=>{const unSet=on("set",((key,newValue)=>{if(key===propName){cb(newValue)}}));const unReset=on("reset",(()=>cb(unwrap(defaultState)[propName])));return()=>{unSet();unReset()}};const use=(...subscriptions)=>{const unsubs=subscriptions.reduce(((unsubs,subscription)=>{if(subscription.set){unsubs.push(on("set",subscription.set))}if(subscription.get){unsubs.push(on("get",subscription.get))}if(subscription.reset){unsubs.push(on("reset",subscription.reset))}if(subscription.dispose){unsubs.push(on("dispose",subscription.dispose))}return unsubs}),[]);return()=>unsubs.forEach((unsub=>unsub()))};const forceUpdate=key=>{const oldValue=states.get(key);handlers.set.forEach((cb=>cb(key,oldValue,oldValue)))};return{state,get,set,on,onChange,use,dispose,reset,forceUpdate}};const removeFromArray=(array,item)=>{const index=array.indexOf(item);if(index>=0){array[index]=array[array.length-1];array.length--}};const createStore=(defaultState,shouldUpdate)=>{const map=createObservableMap(defaultState,shouldUpdate);map.use(stencilSubscription());return map};const DEFAULT_CREDIT_THRESHOLD=100;const context={};const creditUsageSettings={askConfirmation:true,creditThreshold:DEFAULT_CREDIT_THRESHOLD};const mapLevelContext={};const mapLayers=[];const locale=index2.getLocaleInfo().locale;const settingsSelectedExtentOption=sharedComponents.ExtentOptions.Default;const settingsSelectedOutSpatialRefOption=sharedComponents.OutSROptions.SameAsInput;let analysisToolRef;let mapView;let portal;let portalHelpMap;const store=createStore({analysisToolRef,context,creditUsageSettings,mapLevelContext,settingsSelectedExtentOption,settingsSelectedOutSpatialRefOption,mapLayers,mapView,portal,portalHelpMap,locale});const state=store.state;store.onChange("settingsSelectedOutSpatialRefOption",(()=>{delete state.context.outSR;state.context={...state.context}}));store.onChange("settingsSelectedExtentOption",(newValue=>{switch(newValue){case sharedComponents.ExtentOptions.Default:case sharedComponents.ExtentOptions.Layer:case sharedComponents.ExtentOptions.Coordinates:delete state.context.extent;state.context={...state.context};break;case sharedComponents.ExtentOptions.MapExtent:state.context.extent=sharedComponents.ExtentOptions.MapExtent;state.context={...state.context};break}}));store.onChange("context",(()=>{if(state.analysisToolRef!==undefined){state.analysisToolRef.environmentSettings=state.context}}));function addContextToJobParams(jobParams,toolName,toolUiParameters,removeParameters){const contextParam={...state.context};if(contextParam.extent===sharedComponents.ExtentOptions.MapExtent&&state.mapView?.extent!==undefined){let mapExtent=state.mapView?.extent.clone();mapExtent=mapExtent.shiftCentralMeridian();const{xmin,ymin,xmax,ymax,spatialReference}=mapExtent;const{wkid,latestWkid,wkt}=spatialReference;contextParam.extent={xmin,ymin,xmax,ymax};if(!index2.isEmptyDataItem(wkid)){set(contextParam.extent,"spatialReference.wkid",wkid)}if(!index2.isEmptyDataItem(latestWkid)){set(contextParam.extent,"spatialReference.latestWkid",latestWkid)}if(!index2.isEmptyDataItem(wkt)){set(contextParam.extent,"spatialReference.wkt",wkt)}}if(removeParameters!==undefined&&removeParameters?.length>0){removeParameters.forEach((param=>{delete contextParam[param]}))}const jobParamsWithContext=index2.isEmptyDataItem(contextParam)?jobParams:{...jobParams,context:contextParam};const allToolContext=jobParamsWithContext.context;if(toolName==="Sample"){const sampleToolContext={...allToolContext,...{processAsMultidimensional:toolUiParameters?.processMultidimension}};jobParamsWithContext.context=sampleToolContext}else if(toolName==="FindOutliers"){const randomGeneratorContextParam=`${toolUiParameters?.randomGenerator} MERSENNE_TWISTER`;const findOutliersToolContext={...allToolContext,...{randomGenerator:randomGeneratorContextParam}};jobParamsWithContext.context=findOutliersToolContext}return jobParamsWithContext}function findExistingLayer(searchValue){const foundLayer=state.mapLayers.find((layer=>{let layerUrl=layer.url;if("layerId"in layer){layerUrl+=`/${layer.layerId??0}`}return layerUrl===searchValue||layer.title===searchValue}));return foundLayer}async function getEnvSettingsLayer(gpLayerObject){let layerObject;const foundLayer=findExistingLayer(gpLayerObject?.url??gpLayerObject?.layerDefinition?.name);if(foundLayer===undefined){try{const supportedLayer=await index2.getLayerObject(gpLayerObject);if(supportedLayer!==undefined){layerObject=supportedLayer}}catch{layerObject=layerObject??gpLayerObject}}else{layerObject=foundLayer}return layerObject}function getEnvSettingsLayerForStorage(value){let storageValue;if("layerDefinition"in value&&value.layerDefinition!==undefined){storageValue=index2.getFeatureCollectionValueForStorage(value)}else if("url"in value&&value.url!==undefined){storageValue={url:index2.sanitizeUrl(value.url)}}else{storageValue=value}return storageValue}exports.DEFAULT_CREDIT_THRESHOLD=DEFAULT_CREDIT_THRESHOLD;exports.ListCache=ListCache;exports.Map$1=Map$1;exports.MapCache=MapCache;exports.Symbol=Symbol;exports.addContextToJobParams=addContextToJobParams;exports.assignValue=assignValue;exports.baseAssignValue=baseAssignValue;exports.baseGetTag=baseGetTag;exports.baseSet=baseSet;exports.castPath=castPath;exports.defineProperty=defineProperty;exports.eq=eq;exports.findExistingLayer=findExistingLayer;exports.freeGlobal=freeGlobal;exports.getEnvSettingsLayer=getEnvSettingsLayer;exports.getEnvSettingsLayerForStorage=getEnvSettingsLayerForStorage;exports.getNative=getNative;exports.isArray=isArray;exports.isFunction=isFunction;exports.isIndex=isIndex;exports.isObject=isObject;exports.isObjectLike=isObjectLike;exports.root=root;exports.set=set;exports.state=state;exports.toKey=toKey;exports.toSource=toSource}));
