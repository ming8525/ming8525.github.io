define(["exports","./index2-0f07feca","./popover-utils-2688c7fd","./store-f16d23c6","./shared-components-e09cc192","./analysis-tool-credit-settings2-cbb7654d","./analysis-tool-geoanalytics-settings2-d8860ef0","./analysis-tool-raster-settings2-e152563c","./analysis-tool-standard-settings2-432e1840","./analysis-tool-context-b1931181"],(function(exports,index2,popoverUtils,store,sharedComponents,analysisToolCreditSettings2,analysisToolGeoanalyticsSettings2,analysisToolRasterSettings2,analysisToolStandardSettings2,analysisToolContext){"use strict";var WeakMap=store.getNative(store.root,"WeakMap");var objectCreate=Object.create;var baseCreate=function(){function object(){}return function(proto){if(!store.isObject(proto)){return{}}if(objectCreate){return objectCreate(proto)}object.prototype=proto;var result=new object;object.prototype=undefined;return result}}();function copyArray(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index]}return array}function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];var newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;if(newValue===undefined){newValue=source[key]}if(isNew){store.baseAssignValue(object,key,newValue)}else{store.assignValue(object,key,newValue)}}return object}var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isArrayLike(value){return value!=null&&isLength(value.length)&&!store.isFunction(value)}var objectProto$6=Object.prototype;function isPrototype(value){var Ctor=value&&value.constructor,proto=typeof Ctor=="function"&&Ctor.prototype||objectProto$6;return value===proto}function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index)}return result}var argsTag$2="[object Arguments]";function baseIsArguments(value){return store.isObjectLike(value)&&store.baseGetTag(value)==argsTag$2}var objectProto$5=Object.prototype;var hasOwnProperty$4=objectProto$5.hasOwnProperty;var propertyIsEnumerable$1=objectProto$5.propertyIsEnumerable;var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return store.isObjectLike(value)&&hasOwnProperty$4.call(value,"callee")&&!propertyIsEnumerable$1.call(value,"callee")};function stubFalse(){return false}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2;var Buffer$1=moduleExports$2?store.root.Buffer:undefined;var nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:undefined;var isBuffer=nativeIsBuffer||stubFalse;var argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$1="[object Function]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$2="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",weakMapTag$2="[object WeakMap]";var arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=true;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$2]=typedArrayTags[boolTag$2]=typedArrayTags[dataViewTag$3]=typedArrayTags[dateTag$2]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$4]=typedArrayTags[numberTag$2]=typedArrayTags[objectTag$2]=typedArrayTags[regexpTag$2]=typedArrayTags[setTag$4]=typedArrayTags[stringTag$2]=typedArrayTags[weakMapTag$2]=false;function baseIsTypedArray(value){return store.isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[store.baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1;var freeProcess=moduleExports$1&&store.freeGlobal.process;var nodeUtil=function(){try{var types=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;if(types){return types}return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();var nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;var objectProto$4=Object.prototype;var hasOwnProperty$3=objectProto$4.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=store.isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty$3.call(value,key))&&!(skipIndexes&&(key=="length"||isBuff&&(key=="offset"||key=="parent")||isType&&(key=="buffer"||key=="byteLength"||key=="byteOffset")||store.isIndex(key,length)))){result.push(key)}}return result}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object);var objectProto$3=Object.prototype;var hasOwnProperty$2=objectProto$3.hasOwnProperty;function baseKeys(object){if(!isPrototype(object)){return nativeKeys(object)}var result=[];for(var key in Object(object)){if(hasOwnProperty$2.call(object,key)&&key!="constructor"){result.push(key)}}return result}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function nativeKeysIn(object){var result=[];if(object!=null){for(var key in Object(object)){result.push(key)}}return result}var objectProto$2=Object.prototype;var hasOwnProperty$1=objectProto$2.hasOwnProperty;function baseKeysIn(object){if(!store.isObject(object)){return nativeKeysIn(object)}var isProto=isPrototype(object),result=[];for(var key in object){if(!(key=="constructor"&&(isProto||!hasOwnProperty$1.call(object,key)))){result.push(key)}}return result}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,true):baseKeysIn(object)}function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length){array[offset+index]=values[index]}return array}var getPrototype=overArg(Object.getPrototypeOf,Object);function stackClear(){this.__data__=new store.ListCache;this.size=0}function stackDelete(key){var data=this.__data__,result=data["delete"](key);this.size=data.size;return result}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}var LARGE_ARRAY_SIZE=200;function stackSet(key,value){var data=this.__data__;if(data instanceof store.ListCache){var pairs=data.__data__;if(!store.Map$1||pairs.length<LARGE_ARRAY_SIZE-1){pairs.push([key,value]);this.size=++data.size;return this}data=this.__data__=new store.MapCache(pairs)}data.set(key,value);this.size=data.size;return this}function Stack(entries){var data=this.__data__=new store.ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear;Stack.prototype["delete"]=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(object,source){return object&&copyObject(source,keys(source),object)}function baseAssignIn(object,source){return object&&copyObject(source,keysIn(source),object)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports;var Buffer=moduleExports?store.root.Buffer:undefined,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined;function cloneBuffer(buffer,isDeep){if(isDeep){return buffer.slice()}var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);buffer.copy(result);return result}function arrayFilter(array,predicate){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(predicate(value,index,array)){result[resIndex++]=value}}return result}function stubArray(){return[]}var objectProto$1=Object.prototype;var propertyIsEnumerable=objectProto$1.propertyIsEnumerable;var nativeGetSymbols$1=Object.getOwnPropertySymbols;var getSymbols=!nativeGetSymbols$1?stubArray:function(object){if(object==null){return[]}object=Object(object);return arrayFilter(nativeGetSymbols$1(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)}))};function copySymbols(source,object){return copyObject(source,getSymbols(source),object)}var nativeGetSymbols=Object.getOwnPropertySymbols;var getSymbolsIn=!nativeGetSymbols?stubArray:function(object){var result=[];while(object){arrayPush(result,getSymbols(object));object=getPrototype(object)}return result};function copySymbolsIn(source,object){return copyObject(source,getSymbolsIn(source),object)}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return store.isArray(object)?result:arrayPush(result,symbolsFunc(object))}function getAllKeys(object){return baseGetAllKeys(object,keys,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}var DataView=store.getNative(store.root,"DataView");var Promise$1=store.getNative(store.root,"Promise");var Set=store.getNative(store.root,"Set");var mapTag$3="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$3="[object Set]",weakMapTag$1="[object WeakMap]";var dataViewTag$2="[object DataView]";var dataViewCtorString=store.toSource(DataView),mapCtorString=store.toSource(store.Map$1),promiseCtorString=store.toSource(Promise$1),setCtorString=store.toSource(Set),weakMapCtorString=store.toSource(WeakMap);var getTag=store.baseGetTag;if(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$2||store.Map$1&&getTag(new store.Map$1)!=mapTag$3||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag$3||WeakMap&&getTag(new WeakMap)!=weakMapTag$1){getTag=function(value){var result=store.baseGetTag(value),Ctor=result==objectTag$1?value.constructor:undefined,ctorString=Ctor?store.toSource(Ctor):"";if(ctorString){switch(ctorString){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$3;case promiseCtorString:return promiseTag;case setCtorString:return setTag$3;case weakMapCtorString:return weakMapTag$1}}return result}}const getTag$1=getTag;var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;function initCloneArray(array){var length=array.length,result=new array.constructor(length);if(length&&typeof array[0]=="string"&&hasOwnProperty.call(array,"index")){result.index=array.index;result.input=array.input}return result}var Uint8Array=store.root.Uint8Array;function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);new Uint8Array(result).set(new Uint8Array(arrayBuffer));return result}function cloneDataView(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}var reFlags=/\w*$/;function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));result.lastIndex=regexp.lastIndex;return result}var symbolProto=store.Symbol?store.Symbol.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined;function cloneSymbol(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}}function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}var boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]";var arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag$1:return cloneArrayBuffer(object);case boolTag$1:case dateTag$1:return new Ctor(+object);case dataViewTag$1:return cloneDataView(object,isDeep);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(object,isDeep);case mapTag$2:return new Ctor;case numberTag$1:case stringTag$1:return new Ctor(object);case regexpTag$1:return cloneRegExp(object);case setTag$2:return new Ctor;case symbolTag$1:return cloneSymbol(object)}}function initCloneObject(object){return typeof object.constructor=="function"&&!isPrototype(object)?baseCreate(getPrototype(object)):{}}var mapTag$1="[object Map]";function baseIsMap(value){return store.isObjectLike(value)&&getTag$1(value)==mapTag$1}var nodeIsMap=nodeUtil&&nodeUtil.isMap;var isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;var setTag$1="[object Set]";function baseIsSet(value){return store.isObjectLike(value)&&getTag$1(value)==setTag$1}var nodeIsSet=nodeUtil&&nodeUtil.isSet;var isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4;var argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=true;cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=false;function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG,isFlat=bitmask&CLONE_FLAT_FLAG,isFull=bitmask&CLONE_SYMBOLS_FLAG$1;if(customizer){result=object?customizer(value,key,object,stack):customizer(value)}if(result!==undefined){return result}if(!store.isObject(value)){return value}var isArr=store.isArray(value);if(isArr){result=initCloneArray(value);if(!isDeep){return copyArray(value,result)}}else{var tag=getTag$1(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value)){return cloneBuffer(value,isDeep)}if(tag==objectTag||tag==argsTag||isFunc&&!object){result=isFlat||isFunc?{}:initCloneObject(value);if(!isDeep){return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}}else{if(!cloneableTags[tag]){return object?value:{}}result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked){return stacked}stack.set(value,result);if(isSet(value)){value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}))}else if(isMap(value)){value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}))}var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys;var props=isArr?undefined:keysFunc(value);arrayEach(props||value,(function(subValue,key){if(props){key=subValue;subValue=value[key]}store.assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}));return result}var CLONE_SYMBOLS_FLAG=4;function clone(value){return baseClone(value,CLONE_SYMBOLS_FLAG)}const HTMLClasses={border:"border",blockContent:"block-content",labelContainer:"label-container",controlSpacing:"control-spacing",fullWidth:"full-width",halfMarginTop:"half-margin-top"};const analysisToolSettingsCss=":root{display:flex}.control-spacing{margin-bottom:var(--analysis-three-quarter-spacing)}.label-container{display:flex;margin-bottom:var(--analysis-quarter-spacing);gap:var(--analysis-quarter-spacing)}.analysis-border{border:1px solid var(--analysis-ui-border-input)}:host{display:flex;flex-direction:column}:host([mode=global]){display:flex;flex:1 1 auto;overflow:hidden}:host([hidden]){display:none}.full-width{width:100%}.half-margin-top{margin-top:0.5rem}";const AnalysisToolSettings=index2.proxyCustomElement(class AnalysisToolSettings extends index2.H{constructor(){super();this.__registerHost();this.__attachShadow();this.analysisSettingsMapLevelSave=index2.createEvent(this,"analysisSettingsMapLevelSave",7);this.analysisSettingsMapLevelCancel=index2.createEvent(this,"analysisSettingsMapLevelCancel",7);this.analysisSettingsHelpPopoverChange=index2.createEvent(this,"analysisSettingsHelpPopoverChange",7);this.openBlockInitially=false;this.handleBlockToggle=e=>{popoverUtils.removeOpenableDomElement(this.toolHelpPopover);const toggledBlock=e.target;const parentPanel=toggledBlock.offsetParent;const xPositionTop=toggledBlock?.offsetTop-42-parentPanel?.offsetTop;setTimeout((async()=>{await parentPanel.scrollContentTo({top:xPositionTop,behavior:"smooth"})}),100)};this.resetDefaults=resetRasterUi=>{store.state.settingsSelectedExtentOption=sharedComponents.ExtentOptions.Default;store.state.settingsSelectedOutSpatialRefOption=sharedComponents.OutSROptions.SameAsInput;store.state.context={};store.state.creditUsageSettings={askConfirmation:true,creditThreshold:store.DEFAULT_CREDIT_THRESHOLD};if(resetRasterUi===true)this.rasterSettingsRef?.resetUI()};this.handleCancelClick=()=>{this.resetDefaults(true);this.analysisSettingsMapLevelCancel.emit()};this.handleSaveClick=async()=>{const{valid}=await this.validateSettings();if(valid===true){store.state.mapLevelContext.settingsSelectedExtentOption=store.state.settingsSelectedExtentOption;store.state.mapLevelContext.settingsSelectedOutSpatialRefOption=store.state.settingsSelectedOutSpatialRefOption;store.state.mapLevelContext.context={...index2.sanitizeTokensFromJobParams(store.state.context)};if(store.state.mapLevelContext.settingsSelectedExtentOption==="layer"){const layerInputRef=this.standardSettingsRef?.shadowRoot?.querySelector(".extent");const layerInputValue=layerInputRef?.value;store.state.mapLevelContext.extentLayer=store.getEnvSettingsLayerForStorage(layerInputValue)}else{delete store.state.mapLevelContext.extentLayer}if(store.state.mapLevelContext.settingsSelectedOutSpatialRefOption==="sameAsLayer"){const layerInputRef=this.standardSettingsRef?.shadowRoot?.querySelector(".spatialReference");const layerInputValue=layerInputRef?.value;store.state.mapLevelContext.spatialRefLayer=store.getEnvSettingsLayerForStorage(layerInputValue)}else{delete store.state.mapLevelContext.spatialRefLayer}if(index2.isEmptyDataItem(store.state.mapLevelContext.context.mask)===false){store.state.mapLevelContext.maskLayer=store.getEnvSettingsLayerForStorage(store.state.mapLevelContext.context.mask);delete store.state.mapLevelContext.context.mask}else{delete store.state.mapLevelContext.maskLayer}store.state.mapLevelContext.creditUsageSettings=store.state.creditUsageSettings;store.state.mapLevelContext=clone(store.state.mapLevelContext);this.resetDefaults(false);this.analysisSettingsMapLevelSave.emit(store.state.mapLevelContext)}};this.toolHelpPopover=undefined;this.mapLayers=undefined;this.mapView=undefined;this.readEnvironmentSettings=undefined;this.hideGlobalSettings=false;this.hideRasterSettings=false;this.hideGeoanalyticsSettings=false;this.hideCreditSettings=false;this.mode=undefined;this.environmentSettingsFlags=undefined;this.portal=undefined;this.toolHelpFilePath=undefined;this.mapLevelHeading=undefined}toolHelpPopoverChange(){this.analysisSettingsHelpPopoverChange.emit()}onMapLayersChange(newValue){store.state.mapLayers=newValue}onMapViewChange(newValue){store.state.mapView=newValue}onPortalChange(newValue){store.state.portal=newValue}async validateSettings(){let standardSettingsValidity=true,rasterSettingsValidity=true,creditUsageSettingsValidity=true;const standardSettingsElement=this.hostElement.shadowRoot?.querySelector("analysis-tool-standard-settings");const rasterSettingsElement=this.hostElement.shadowRoot?.querySelector("analysis-tool-raster-settings");const creditSettingsElement=this.hostElement.shadowRoot?.querySelector("analysis-tool-credit-settings");if(standardSettingsElement!==null&&standardSettingsElement!==undefined){standardSettingsValidity=await standardSettingsElement.validateStandardSettings()}if(rasterSettingsElement!==null&&rasterSettingsElement!==undefined){rasterSettingsValidity=await rasterSettingsElement.validateRasterSettings()}if(creditSettingsElement!==null&&creditSettingsElement!==undefined){creditUsageSettingsValidity=await creditSettingsElement.checkValidity()}const settingsValidity=standardSettingsValidity&&rasterSettingsValidity&&creditUsageSettingsValidity;return{valid:settingsValidity,errorKeys:settingsValidity===false?[index2.DEFAULT_ERROR_KEY]:[]}}async componentWillLoad(){let locale="";({strings:this.strings,locale}=await index2.fetchComponentLocaleStrings(this.hostElement,index2.getAssetPath(`.`)));if(this.mapLayers!==undefined)store.state.mapLayers=this.mapLayers;if(this.mapView!==undefined)store.state.mapView=this.mapView;if(this.portal!==undefined)store.state.portal=this.portal;this.openBlockInitially=index2.isEmptyDataItem(store.state.context)===false;if(this.mode==="global"&&this.toolHelpFilePath===undefined){let helpLocale=locale;if(locale===index2.SupportedLocales.English||locale===index2.SupportedLocales.EnglishUSA){helpLocale=""}else if(helpLocale===index2.SupportedLocales.NorwegianBokml){helpLocale="no"}this.toolHelpFilePath=`${index2.getAssetPath("assets")}/help/${helpLocale!==""?helpLocale+"/":""}AnalysisEnvironments.html`}}connectedCallback(){const{readEnvironmentSettings,mode}=this;if(readEnvironmentSettings!==undefined){store.state.mapLevelContext=readEnvironmentSettings}if(mode===analysisToolContext.AnalysisSettingsMode.Global){const{settingsSelectedExtentOption,settingsSelectedOutSpatialRefOption,context,creditUsageSettings}=store.state.mapLevelContext;if(creditUsageSettings!==undefined){store.state.creditUsageSettings=clone(creditUsageSettings)}if(settingsSelectedExtentOption!==undefined)store.state.settingsSelectedExtentOption=settingsSelectedExtentOption;if(settingsSelectedOutSpatialRefOption!==undefined)store.state.settingsSelectedOutSpatialRefOption=settingsSelectedOutSpatialRefOption;store.state.context=clone(context??{})}}disconnectedCallback(){popoverUtils.removeOpenableDomElement(this.toolHelpPopover);this.resetDefaults(false)}renderGlobalBlock(){const{strings}=this;return index2.h("calcite-block",{collapsible:true,open:true,heading:strings.generalSettings},index2.h("div",{class:HTMLClasses.blockContent},index2.h("analysis-tool-standard-settings",{ref:el=>this.standardSettingsRef=el,onAnalysisToolStandardSettingsHelpClick:e=>{this.toolHelpPopover=popoverUtils.showHelp(this.toolHelpPopover,{heading:e.detail.parameterName,helpFileName:"AnalysisEnvironments",helpId:e.detail.key,helpUrl:this.toolHelpFilePath,isHelpFileExternalAsset:true,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase??undefined,portal:this.portal,portalHelpMap:store.state.portalHelpMap,referenceElement:e.detail.refElement,triggerDisabled:true})}})))}renderRABlock(){const{strings}=this;return index2.h("calcite-block",{collapsible:true,open:true,heading:strings.rasterAnalysis},index2.h("div",{class:HTMLClasses.blockContent},index2.h("analysis-tool-raster-settings",{hideParallelProcessingFactor:this.portal===undefined||this.portal?.isPortal===false,hideProcessorType:this.portal===undefined||this.portal?.isPortal===false,ref:el=>this.rasterSettingsRef=el,onAnalysisToolRasterSettingsHelpClick:e=>{this.toolHelpPopover=popoverUtils.showHelp(this.toolHelpPopover,{heading:e.detail.parameterName,helpFileName:"AnalysisEnvironments",helpId:e.detail.key,helpUrl:this.toolHelpFilePath,isHelpFileExternalAsset:true,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase??undefined,portal:this.portal,portalHelpMap:store.state.portalHelpMap,referenceElement:e.detail.refElement,triggerDisabled:true})}})))}renderGABlock(){const{strings}=this;return index2.h("calcite-block",{collapsible:true,open:true,heading:strings.geoanalytics},index2.h("div",{class:HTMLClasses.blockContent},index2.h("analysis-tool-geoanalytics-settings",null)))}renderCreditBlock(){const{strings}=this;return index2.h("calcite-block",{collapsible:true,open:true,heading:strings.creditUsage},index2.h("div",{class:HTMLClasses.blockContent},index2.h("analysis-tool-credit-settings",{onAnalysisToolCreditSettingsHelpClick:e=>{this.toolHelpPopover=popoverUtils.showHelp(this.toolHelpPopover,{heading:e.detail.parameterName,helpFileName:"AnalysisEnvironments",helpId:e.detail.key,helpUrl:this.toolHelpFilePath,isHelpFileExternalAsset:true,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase??undefined,portal:this.portal,portalHelpMap:store.state.portalHelpMap,referenceElement:e.detail.refElement,triggerDisabled:true})}})))}renderToolMode(){const{environmentSettingsFlags,hideGlobalSettings,hideRasterSettings,hideGeoanalyticsSettings,openBlockInitially,strings}=this;const{raster,standard}=environmentSettingsFlags??{};return index2.h("calcite-block",{collapsible:true,heading:strings.envSettings,description:strings.envSettingsDescription,open:openBlockInitially,onCalciteBlockToggle:this.handleBlockToggle},hideGlobalSettings===false&&standard?.length!==0?index2.h("analysis-tool-standard-settings",{hideOutSR:standard?.includes(analysisToolContext.AnalysisToolContextKeys.OutSR)===false,hideExtent:standard?.includes(analysisToolContext.AnalysisToolContextKeys.Extent)===false,onAnalysisToolStandardSettingsHelpClick:e=>{this.toolHelpPopover=popoverUtils.showHelp(this.toolHelpPopover,{heading:e.detail.parameterName,helpFileName:"AnalysisEnvironments",helpId:e.detail.key,helpUrl:this.toolHelpFilePath,isHelpFileExternalAsset:true,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase??undefined,portal:this.portal,portalHelpMap:store.state.portalHelpMap,referenceElement:e.detail.refElement,triggerDisabled:true})}}):null,hideRasterSettings===false&&raster?.length!==0?index2.h("analysis-tool-raster-settings",{hideCellSize:raster?.includes(analysisToolContext.AnalysisToolContextKeys.CellSize)===false,hideMask:raster?.includes(analysisToolContext.AnalysisToolContextKeys.Mask)===false,hideSnapRaster:raster?.includes(analysisToolContext.AnalysisToolContextKeys.SnapRaster)===false,hideResamplingMethod:raster?.includes(analysisToolContext.AnalysisToolContextKeys.ResamplingMethod)===false,hideParallelProcessingFactor:raster?.includes(analysisToolContext.AnalysisToolContextKeys.ParallelProcessingFactor)===false||this.portal===undefined||this.portal?.isPortal===false,hideProcessorType:raster?.includes(analysisToolContext.AnalysisToolContextKeys.ProcessorType)===false||this.portal===undefined||this.portal?.isPortal===false,onAnalysisToolRasterSettingsHelpClick:e=>{this.toolHelpPopover=popoverUtils.showHelp(this.toolHelpPopover,{heading:e.detail.parameterName,helpFileName:"AnalysisEnvironments",helpId:e.detail.key,helpUrl:this.toolHelpFilePath,isHelpFileExternalAsset:true,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase??undefined,portal:this.portal,portalHelpMap:store.state.portalHelpMap,referenceElement:e.detail.refElement,triggerDisabled:true})}}):null,standard?.length===0&&raster?.length===0?index2.h("calcite-notice",{open:true,scale:"s"},index2.h("div",{slot:"title"},this.strings.noEnvSettings)):null,hideGeoanalyticsSettings===false?index2.h("analysis-tool-geoanalytics-settings",null):null)}renderGlobalMode(){const{hideCreditSettings,hideGlobalSettings,hideRasterSettings,hideGeoanalyticsSettings,strings}=this;return index2.h("calcite-flow-item",{heading:this.mapLevelHeading,"show-back-button":true,onCalciteFlowItemBack:this.handleCancelClick},index2.h("slot",{name:"info-action",slot:"header-actions-end"}),index2.h("slot",{name:"notice"}),!hideGlobalSettings&&this.renderGlobalBlock(),!hideRasterSettings&&this.renderRABlock(),!hideGeoanalyticsSettings&&this.renderGABlock(),!hideCreditSettings&&this.renderCreditBlock(),index2.h("div",{slot:"footer",class:HTMLClasses.fullWidth},index2.h("calcite-button",{appearance:"transparent","icon-start":"undo",label:strings.resetDefaults,width:"full",onClick:()=>this.resetDefaults(true)},strings.resetDefaults),index2.h("div",{class:HTMLClasses.halfMarginTop},index2.h("calcite-button",{appearance:"solid",label:strings.save,width:"half",onClick:this.handleSaveClick},strings.save),index2.h("calcite-button",{appearance:"outline",label:strings.cancel,width:"half",onClick:this.handleCancelClick},strings.cancel))))}render(){return index2.h(index2.Host,null,this.mode===analysisToolContext.AnalysisSettingsMode.Global?this.renderGlobalMode():this.renderToolMode())}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{toolHelpPopover:["toolHelpPopoverChange"],mapLayers:["onMapLayersChange"],mapView:["onMapViewChange"]}}static get style(){return analysisToolSettingsCss}},[1,"analysis-tool-settings",{toolHelpPopover:[1040],mapLayers:[16],mapView:[16],readEnvironmentSettings:[16],hideGlobalSettings:[516,"hide-global-settings"],hideRasterSettings:[516,"hide-raster-settings"],hideGeoanalyticsSettings:[516,"hide-geoanalytics-settings"],hideCreditSettings:[516,"hide-credit-settings"],mode:[513],environmentSettingsFlags:[16],portal:[16],toolHelpFilePath:[1537,"tool-help-file-path"],mapLevelHeading:[513,"map-level-heading"],validateSettings:[64]},undefined,{toolHelpPopover:["toolHelpPopoverChange"],mapLayers:["onMapLayersChange"],mapView:["onMapViewChange"]}]);function defineCustomElement(){if(typeof customElements==="undefined"){return}const components=["analysis-tool-settings","analysis-tool-credit-settings","analysis-tool-geoanalytics-settings","analysis-tool-raster-settings","analysis-tool-standard-settings"];components.forEach((tagName=>{switch(tagName){case"analysis-tool-settings":if(!customElements.get(tagName)){customElements.define(tagName,AnalysisToolSettings)}break;case"analysis-tool-credit-settings":if(!customElements.get(tagName)){analysisToolCreditSettings2.defineCustomElement()}break;case"analysis-tool-geoanalytics-settings":if(!customElements.get(tagName)){analysisToolGeoanalyticsSettings2.defineCustomElement()}break;case"analysis-tool-raster-settings":if(!customElements.get(tagName)){analysisToolRasterSettings2.defineCustomElement()}break;case"analysis-tool-standard-settings":if(!customElements.get(tagName)){analysisToolStandardSettings2.defineCustomElement()}break}}))}defineCustomElement();exports.AnalysisToolSettings=AnalysisToolSettings;exports.Stack=Stack;exports.Uint8Array=Uint8Array;exports.arrayPush=arrayPush;exports.baseClone=baseClone;exports.defineCustomElement=defineCustomElement;exports.getAllKeys=getAllKeys;exports.getTag$1=getTag$1;exports.isArguments=isArguments;exports.isBuffer=isBuffer;exports.isLength=isLength;exports.isTypedArray=isTypedArray}));
