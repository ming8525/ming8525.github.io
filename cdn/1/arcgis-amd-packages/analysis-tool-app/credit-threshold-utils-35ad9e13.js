define(["exports","./analysis-tool-settings2-598af182","./store-f16d23c6","./index2-0f07feca","./shared-components-e09cc192","./analysis-tool-context-b1931181","./popover-utils-2688c7fd"],(function(exports,analysisToolSettings2,store,index2,sharedComponents,analysisToolContext,popoverUtils){"use strict";function identity(value){return value}function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}var HOT_COUNT=800,HOT_SPAN=16;var nativeNow=Date.now;function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=HOT_SPAN-(stamp-lastCalled);lastCalled=stamp;if(remaining>0){if(++count>=HOT_COUNT){return arguments[0]}}else{count=0}return func.apply(undefined,arguments)}}function constant(value){return function(){return value}}var baseSetToString=!store.defineProperty?identity:function(func,string){return store.defineProperty(func,"toString",{configurable:true,enumerable:false,value:constant(string),writable:true})};var setToString=shortOut(baseSetToString);var nativeMax=Math.max;function overRest(func,start,transform){start=nativeMax(start===undefined?func.length-1:start,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);while(++index<length){array[index]=args[start+index]}index=-1;var otherArgs=Array(start+1);while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=transform(array);return apply(func,this,otherArgs)}}function baseGet(object,path){path=store.castPath(path,object);var index=0,length=path.length;while(object!=null&&index<length){object=object[store.toKey(path[index++])]}return index&&index==length?object:undefined}var spreadableSymbol=store.Symbol?store.Symbol.isConcatSpreadable:undefined;function isFlattenable(value){return store.isArray(value)||analysisToolSettings2.isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;predicate||(predicate=isFlattenable);result||(result=[]);while(++index<length){var value=array[index];if(depth>0&&predicate(value)){if(depth>1){baseFlatten(value,depth-1,predicate,isStrict,result)}else{analysisToolSettings2.arrayPush(result,value)}}else if(!isStrict){result[result.length]=value}}return result}function flatten(array){var length=array==null?0:array.length;return length?baseFlatten(array,1):[]}function flatRest(func){return setToString(overRest(func,undefined,flatten),func+"")}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(value){return analysisToolSettings2.baseClone(value,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(value){this.__data__.set(value,HASH_UNDEFINED);return this}function setCacheHas(value){return this.__data__.has(value)}function SetCache(values){var index=-1,length=values==null?0:values.length;this.__data__=new store.MapCache;while(++index<length){this.add(values[index])}}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(array,predicate){var index=-1,length=array==null?0:array.length;while(++index<length){if(predicate(array[index],index,array)){return true}}return false}function cacheHas(cache,key){return cache.has(key)}var COMPARE_PARTIAL_FLAG$3=1,COMPARE_UNORDERED_FLAG$1=2;function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$3,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength)){return false}var arrStacked=stack.get(array);var othStacked=stack.get(other);if(arrStacked&&othStacked){return arrStacked==other&&othStacked==array}var index=-1,result=true,seen=bitmask&COMPARE_UNORDERED_FLAG$1?new SetCache:undefined;stack.set(array,other);stack.set(other,array);while(++index<arrLength){var arrValue=array[index],othValue=other[index];if(customizer){var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack)}if(compared!==undefined){if(compared){continue}result=false;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){return seen.push(othIndex)}}))){result=false;break}}else if(!(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){result=false;break}}stack["delete"](array);stack["delete"](other);return result}function mapToArray(map){var index=-1,result=Array(map.size);map.forEach((function(value,key){result[++index]=[key,value]}));return result}function setToArray(set){var index=-1,result=Array(set.size);set.forEach((function(value){result[++index]=value}));return result}var COMPARE_PARTIAL_FLAG$2=1,COMPARE_UNORDERED_FLAG=2;var boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]";var arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]";var symbolProto=store.Symbol?store.Symbol.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined;function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset){return false}object=object.buffer;other=other.buffer;case arrayBufferTag:if(object.byteLength!=other.byteLength||!equalFunc(new analysisToolSettings2.Uint8Array(object),new analysisToolSettings2.Uint8Array(other))){return false}return true;case boolTag:case dateTag:case numberTag:return store.eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=bitmask&COMPARE_PARTIAL_FLAG$2;convert||(convert=setToArray);if(object.size!=other.size&&!isPartial){return false}var stacked=stack.get(object);if(stacked){return stacked==other}bitmask|=COMPARE_UNORDERED_FLAG;stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);stack["delete"](object);return result;case symbolTag:if(symbolValueOf){return symbolValueOf.call(object)==symbolValueOf.call(other)}}return false}var COMPARE_PARTIAL_FLAG$1=1;var objectProto$1=Object.prototype;var hasOwnProperty$1=objectProto$1.hasOwnProperty;function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$1,objProps=analysisToolSettings2.getAllKeys(object),objLength=objProps.length,othProps=analysisToolSettings2.getAllKeys(other),othLength=othProps.length;if(objLength!=othLength&&!isPartial){return false}var index=objLength;while(index--){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty$1.call(other,key))){return false}}var objStacked=stack.get(object);var othStacked=stack.get(other);if(objStacked&&othStacked){return objStacked==other&&othStacked==object}var result=true;stack.set(object,other);stack.set(other,object);var skipCtor=isPartial;while(++index<objLength){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer){var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack)}if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=false;break}skipCtor||(skipCtor=key=="constructor")}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&("constructor"in object&&"constructor"in other)&&!(typeof objCtor=="function"&&objCtor instanceof objCtor&&typeof othCtor=="function"&&othCtor instanceof othCtor)){result=false}}stack["delete"](object);stack["delete"](other);return result}var COMPARE_PARTIAL_FLAG=1;var argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]";var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=store.isArray(object),othIsArr=store.isArray(other),objTag=objIsArr?arrayTag:analysisToolSettings2.getTag$1(object),othTag=othIsArr?arrayTag:analysisToolSettings2.getTag$1(other);objTag=objTag==argsTag?objectTag:objTag;othTag=othTag==argsTag?objectTag:othTag;var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&analysisToolSettings2.isBuffer(object)){if(!analysisToolSettings2.isBuffer(other)){return false}objIsArr=true;objIsObj=false}if(isSameTag&&!objIsObj){stack||(stack=new analysisToolSettings2.Stack);return objIsArr||analysisToolSettings2.isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack)}if(!(bitmask&COMPARE_PARTIAL_FLAG)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;stack||(stack=new analysisToolSettings2.Stack);return equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}if(!isSameTag){return false}stack||(stack=new analysisToolSettings2.Stack);return equalObjects(object,other,bitmask,customizer,equalFunc,stack)}function baseIsEqual(value,other,bitmask,customizer,stack){if(value===other){return true}if(value==null||other==null||!store.isObjectLike(value)&&!store.isObjectLike(other)){return value!==value&&other!==other}return baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack)}function baseHasIn(object,key){return object!=null&&key in Object(object)}function hasPath(object,path,hasFunc){path=store.castPath(path,object);var index=-1,length=path.length,result=false;while(++index<length){var key=store.toKey(path[index]);if(!(result=object!=null&&hasFunc(object,key))){break}object=object[key]}if(result||++index!=length){return result}length=object==null?0:object.length;return!!length&&analysisToolSettings2.isLength(length)&&store.isIndex(key,length)&&(store.isArray(object)||analysisToolSettings2.isArguments(object))}function hasIn(object,path){return object!=null&&hasPath(object,path,baseHasIn)}function isEqual(value,other){return baseIsEqual(value,other)}function basePickBy(object,paths,predicate){var index=-1,length=paths.length,result={};while(++index<length){var path=paths[index],value=baseGet(object,path);if(predicate(value,path)){store.baseSet(result,store.castPath(path,object),value)}}return result}function basePick(object,paths){return basePickBy(object,paths,(function(value,path){return hasIn(object,path)}))}var pick=flatRest((function(object,paths){return object==null?{}:basePick(object,paths)}));function setContextFromHistory(contextFromHistory){if(!index2.isEmptyDataItem(contextFromHistory)){if(!index2.isEmptyDataItem(contextFromHistory?.outSR)){store.state.settingsSelectedOutSpatialRefOption=sharedComponents.OutSROptions.BrowseCS}else{store.state.settingsSelectedOutSpatialRefOption=sharedComponents.OutSROptions.SameAsInput}if(!index2.isEmptyDataItem(contextFromHistory?.extent)){store.state.settingsSelectedExtentOption=sharedComponents.ExtentOptions.Coordinates}else{store.state.settingsSelectedExtentOption=sharedComponents.ExtentOptions.Default}store.state.context=contextFromHistory??{}}else{store.state.context={};store.state.settingsSelectedOutSpatialRefOption=sharedComponents.OutSROptions.SameAsInput;store.state.settingsSelectedExtentOption=sharedComponents.ExtentOptions.Default}}function setContextFromMapLevel(toolUIJson,engine,readEnvironmentSettings){if(readEnvironmentSettings!==undefined)store.state.mapLevelContext=readEnvironmentSettings;const{settingsSelectedExtentOption,settingsSelectedOutSpatialRefOption,context}=store.state.mapLevelContext;if(settingsSelectedExtentOption!==undefined)store.state.settingsSelectedExtentOption=settingsSelectedExtentOption;if(settingsSelectedOutSpatialRefOption!==undefined)store.state.settingsSelectedOutSpatialRefOption=settingsSelectedOutSpatialRefOption;const environmentSettingsFlags=toolUIJson?.environmentSettings;const keepKeys=[];if(environmentSettingsFlags!==undefined){if(environmentSettingsFlags.standard!==undefined){keepKeys.push(...environmentSettingsFlags.standard)}else{keepKeys.push(...analysisToolContext.AnalysisStandardContextKeys)}if(environmentSettingsFlags.raster!==undefined){keepKeys.push(...environmentSettingsFlags.raster)}else{if(engine==="raster"){keepKeys.push(...analysisToolContext.AnalysisRasterContextKeys)}}}else{keepKeys.push(...analysisToolContext.AnalysisStandardContextKeys);if(engine==="raster"){keepKeys.push(...analysisToolContext.AnalysisRasterContextKeys)}}store.state.context=pick(context??{},keepKeys)}const creditThresholdModalAttributes={modal:{width:"s",kind:"warning"},buttonPrimary:{slot:"primary"},buttonSecondary:{slot:"secondary",appearance:"outline"},header:{slot:"header",style:`\n      display: flex;\n      align-items: center;\n      justify-content: flex-start;\n    `},headerIcon:{icon:"exclamation-mark-triangle-f",style:`\n      margin: 0 1rem;\n      --calcite-ui-icon-color: var(--calcite-color-status-warning);\n    `},content:{slot:"content"}};const applyAttributes=(el,attributes)=>{Object.keys(attributes).forEach((key=>{el.setAttribute(key,attributes[key])}))};const createElementWithTextAndAttrs=(type,text,attrs)=>{const element=document.createElement(type);applyAttributes(element,attrs);element.innerText=text;return element};function createCreditThresholdModalElement(creditThresholdModalStrings,learnMoreUrl){const{modal,buttonPrimary,buttonSecondary,header,headerIcon,content}=creditThresholdModalAttributes;const{continueRun,cancelRun,thresholdExceeded,creditEstimate,creditThreshold,confirmationPrompt,learnMore,heading}=creditThresholdModalStrings;const modalElement=createElementWithTextAndAttrs("calcite-modal","",modal);const headerElement=createElementWithTextAndAttrs("div","",header);const headerTitleElement=createElementWithTextAndAttrs("div",heading,{});const headerIconElement=createElementWithTextAndAttrs("calcite-icon","",headerIcon);headerElement.appendChild(headerIconElement);headerElement.appendChild(headerTitleElement);const primaryButtonElement=createElementWithTextAndAttrs("calcite-button",continueRun,buttonPrimary);const secondaryButtonElement=createElementWithTextAndAttrs("calcite-button",cancelRun,buttonSecondary);const contentElement=createElementWithTextAndAttrs("div","",content);contentElement.appendChild(createElementWithTextAndAttrs("p",thresholdExceeded,{}));contentElement.appendChild(createElementWithTextAndAttrs("p",creditEstimate+"\n"+creditThreshold,{}));contentElement.appendChild(createElementWithTextAndAttrs("p",confirmationPrompt,{}));const learnMoreLinkAttributes={href:learnMoreUrl,target:"_blank"};const learnMoreLink=createElementWithTextAndAttrs("calcite-link",learnMore,learnMoreLinkAttributes);contentElement.appendChild(learnMoreLink);modalElement.appendChild(headerElement);modalElement.appendChild(contentElement);modalElement.appendChild(primaryButtonElement);modalElement.appendChild(secondaryButtonElement);const modalResult=new Promise((resolve=>{const cleanupModal=event=>{const target=event.target;let modalClosedWithPrimaryAction=false;if(target.getAttribute("slot")===creditThresholdModalAttributes.buttonPrimary.slot){modalClosedWithPrimaryAction=true}else{modalClosedWithPrimaryAction=false}modalElement.removeEventListener("calciteModalClose",cleanupModal);primaryButtonElement.removeEventListener("click",cleanupModal);secondaryButtonElement.removeEventListener("click",cleanupModal);modalElement.open=false;popoverUtils.removeOpenableDomElement(modalElement);resolve(modalClosedWithPrimaryAction)};modalElement.addEventListener("calciteModalClose",cleanupModal);primaryButtonElement.addEventListener("click",cleanupModal);secondaryButtonElement.addEventListener("click",cleanupModal)}));return{modalElement,modalResult}}exports.cloneDeep=cloneDeep;exports.createCreditThresholdModalElement=createCreditThresholdModalElement;exports.isEqual=isEqual;exports.setContextFromHistory=setContextFromHistory;exports.setContextFromMapLevel=setContextFromMapLevel}));
