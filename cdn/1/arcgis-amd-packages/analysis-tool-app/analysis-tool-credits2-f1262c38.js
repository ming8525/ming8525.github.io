define(["require","exports","./index2-0f07feca","esri/rest/support/JobInfo","esri/rest/geoprocessor","esri/request","esri/rest/support/ParameterValue","esri/core/urlUtils","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/identity/IdentityManager","esri/core/reactiveUtils","esri/rest/support/Query","esri/core/promiseUtils","esri/portal/PortalItemResource","esri/layers/FeatureLayer","esri/geometry/support/jsonUtils","esri/layers/Layer","esri/portal/PortalItem","esri/layers/support/Field","esri/renderers/Renderer","esri/rest/support/FeatureSet","esri/config","esri/smartMapping/statistics/uniqueValues","esri/core/sql","./store-f16d23c6","./analysis-tool-credits-popover2-de3db736"],(function(require,exports,index2,JobInfo,geoprocessor,request$1,ParameterValue,urlUtils,Point,Polyline,Polygon,esriId,reactiveUtils,Query,promiseUtils,PortalItemResource,FeatureLayer,geometryJsonUtils,Layer,PortalItem,Field,Renderer,FeatureSet,esriConfig,uniqueValues,sql,store,analysisToolCreditsPopover2){"use strict";function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var n=Object.create(null);if(e){Object.keys(e).forEach((function(k){if(k!=="default"){var d=Object.getOwnPropertyDescriptor(e,k);Object.defineProperty(n,k,d.get?d:{enumerable:true,get:function(){return e[k]}})}}))}n["default"]=e;return Object.freeze(n)}var JobInfo__default=_interopDefaultLegacy(JobInfo);var geoprocessor__namespace=_interopNamespace(geoprocessor);var request$1__default=_interopDefaultLegacy(request$1);var esriId__default=_interopDefaultLegacy(esriId);var FeatureLayer__default=_interopDefaultLegacy(FeatureLayer);var PortalItem__default=_interopDefaultLegacy(PortalItem);var Field__default=_interopDefaultLegacy(Field);var Renderer__default=_interopDefaultLegacy(Renderer);var FeatureSet__default=_interopDefaultLegacy(FeatureSet);var esriConfig__default=_interopDefaultLegacy(esriConfig);var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;var freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal$1||freeSelf||Function("return this")();var root$1=root;var Symbol$1=root$1.Symbol;var Symbol$2=Symbol$1;var objectProto$j=Object.prototype;var hasOwnProperty$h=objectProto$j.hasOwnProperty;var nativeObjectToString$1=objectProto$j.toString;var symToStringTag$1=Symbol$2?Symbol$2.toStringTag:undefined;function getRawTag(value){var isOwn=hasOwnProperty$h.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=undefined;var unmasked=true}catch(e){}var result=nativeObjectToString$1.call(value);if(unmasked){if(isOwn){value[symToStringTag$1]=tag}else{delete value[symToStringTag$1]}}return result}var objectProto$i=Object.prototype;var nativeObjectToString=objectProto$i.toString;function objectToString(value){return nativeObjectToString.call(value)}var nullTag="[object Null]",undefinedTag="[object Undefined]";var symToStringTag=Symbol$2?Symbol$2.toStringTag:undefined;function baseGetTag(value){if(value==null){return value===undefined?undefinedTag:nullTag}return symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function isObjectLike(value){return value!=null&&typeof value=="object"}var symbolTag$3="[object Symbol]";function isSymbol$2(value){return typeof value=="symbol"||isObjectLike(value)&&baseGetTag(value)==symbolTag$3}function arrayMap(array,iteratee){var index=-1,length=array==null?0:array.length,result=Array(length);while(++index<length){result[index]=iteratee(array[index],index,array)}return result}var isArray=Array.isArray;var isArray$1=isArray;var INFINITY$2=1/0;var symbolProto$2=Symbol$2?Symbol$2.prototype:undefined,symbolToString=symbolProto$2?symbolProto$2.toString:undefined;function baseToString(value){if(typeof value=="string"){return value}if(isArray$1(value)){return arrayMap(value,baseToString)+""}if(isSymbol$2(value)){return symbolToString?symbolToString.call(value):""}var result=value+"";return result=="0"&&1/value==-INFINITY$2?"-0":result}function isObject$1(value){var type=typeof value;return value!=null&&(type=="object"||type=="function")}function identity(value){return value}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(value){if(!isObject$1(value)){return false}var tag=baseGetTag(value);return tag==funcTag$2||tag==genTag$1||tag==asyncTag||tag==proxyTag}var coreJsData=root$1["__core-js_shared__"];var coreJsData$1=coreJsData;var maskSrcKey=function(){var uid=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return uid?"Symbol(src)_1."+uid:""}();function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}var funcProto$2=Function.prototype;var funcToString$2=funcProto$2.toString;function toSource(func){if(func!=null){try{return funcToString$2.call(func)}catch(e){}try{return func+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g;var reIsHostCtor=/^\[object .+?Constructor\]$/;var funcProto$1=Function.prototype,objectProto$h=Object.prototype;var funcToString$1=funcProto$1.toString;var hasOwnProperty$g=objectProto$h.hasOwnProperty;var reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$g).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(value){if(!isObject$1(value)||isMasked(value)){return false}var pattern=isFunction$1(value)?reIsNative:reIsHostCtor;return pattern.test(toSource(value))}function getValue$1(object,key){return object==null?undefined:object[key]}function getNative(object,key){var value=getValue$1(object,key);return baseIsNative(value)?value:undefined}var WeakMap=getNative(root$1,"WeakMap");var WeakMap$1=WeakMap;var objectCreate=Object.create;var baseCreate=function(){function object(){}return function(proto){if(!isObject$1(proto)){return{}}if(objectCreate){return objectCreate(proto)}object.prototype=proto;var result=new object;object.prototype=undefined;return result}}();var baseCreate$1=baseCreate;function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function noop$1(){}function copyArray(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index]}return array}var HOT_COUNT=800,HOT_SPAN=16;var nativeNow=Date.now;function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=HOT_SPAN-(stamp-lastCalled);lastCalled=stamp;if(remaining>0){if(++count>=HOT_COUNT){return arguments[0]}}else{count=0}return func.apply(undefined,arguments)}}function constant(value){return function(){return value}}var defineProperty$2=function(){try{var func=getNative(Object,"defineProperty");func({},"",{});return func}catch(e){}}();var defineProperty$3=defineProperty$2;var baseSetToString=!defineProperty$3?identity:function(func,string){return defineProperty$3(func,"toString",{configurable:true,enumerable:false,value:constant(string),writable:true})};var baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);var setToString$1=setToString;function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}function baseFindIndex(array,predicate,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?1:-1);while(fromRight?index--:++index<length){if(predicate(array[index],index,array)){return index}}return-1}function baseIsNaN(value){return value!==value}function strictIndexOf(array,value,fromIndex){var index=fromIndex-1,length=array.length;while(++index<length){if(array[index]===value){return index}}return-1}function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}function arrayIncludes(array,value){var length=array==null?0:array.length;return!!length&&baseIndexOf(array,value,0)>-1}var MAX_SAFE_INTEGER$1=9007199254740991;var reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(value,length){var type=typeof value;length=length==null?MAX_SAFE_INTEGER$1:length;return!!length&&(type=="number"||type!="symbol"&&reIsUint.test(value))&&(value>-1&&value%1==0&&value<length)}function baseAssignValue(object,key,value){if(key=="__proto__"&&defineProperty$3){defineProperty$3(object,key,{configurable:true,enumerable:true,value,writable:true})}else{object[key]=value}}function eq(value,other){return value===other||value!==value&&other!==other}var objectProto$g=Object.prototype;var hasOwnProperty$f=objectProto$g.hasOwnProperty;function assignValue(object,key,value){var objValue=object[key];if(!(hasOwnProperty$f.call(object,key)&&eq(objValue,value))||value===undefined&&!(key in object)){baseAssignValue(object,key,value)}}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];var newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;if(newValue===undefined){newValue=source[key]}if(isNew){baseAssignValue(object,key,newValue)}else{assignValue(object,key,newValue)}}return object}var nativeMax=Math.max;function overRest(func,start,transform){start=nativeMax(start===undefined?func.length-1:start,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);while(++index<length){array[index]=args[start+index]}index=-1;var otherArgs=Array(start+1);while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=transform(array);return apply(func,this,otherArgs)}}function baseRest(func,start){return setToString$1(overRest(func,start,identity),func+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isArrayLike(value){return value!=null&&isLength(value.length)&&!isFunction$1(value)}function isIterateeCall(value,index,object){if(!isObject$1(object)){return false}var type=typeof index;if(type=="number"?isArrayLike(object)&&isIndex(index,object.length):type=="string"&&index in object){return eq(object[index],value)}return false}function createAssigner(assigner){return baseRest((function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:undefined,guard=length>2?sources[2]:undefined;customizer=assigner.length>3&&typeof customizer=="function"?(length--,customizer):undefined;if(guard&&isIterateeCall(sources[0],sources[1],guard)){customizer=length<3?undefined:customizer;length=1}object=Object(object);while(++index<length){var source=sources[index];if(source){assigner(object,source,index,customizer)}}return object}))}var objectProto$f=Object.prototype;function isPrototype$1(value){var Ctor=value&&value.constructor,proto=typeof Ctor=="function"&&Ctor.prototype||objectProto$f;return value===proto}function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index)}return result}var argsTag$3="[object Arguments]";function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag$3}var objectProto$e=Object.prototype;var hasOwnProperty$e=objectProto$e.hasOwnProperty;var propertyIsEnumerable$1=objectProto$e.propertyIsEnumerable;var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$e.call(value,"callee")&&!propertyIsEnumerable$1.call(value,"callee")};var isArguments$1=isArguments;function stubFalse(){return false}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2;var Buffer$1=moduleExports$2?root$1.Buffer:undefined;var nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:undefined;var isBuffer=nativeIsBuffer||stubFalse;var isBuffer$1=isBuffer;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$3="[object Error]",funcTag$1="[object Function]",mapTag$6="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$6="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]";var arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=true;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$3]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$6]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$6]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=false;function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1;var freeProcess=moduleExports$1&&freeGlobal$1.process;var nodeUtil=function(){try{var types=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;if(types){return types}return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();var nodeUtil$1=nodeUtil;var nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray;var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;var isTypedArray$1=isTypedArray;var objectProto$d=Object.prototype;var hasOwnProperty$d=objectProto$d.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=isArray$1(value),isArg=!isArr&&isArguments$1(value),isBuff=!isArr&&!isArg&&isBuffer$1(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray$1(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty$d.call(value,key))&&!(skipIndexes&&(key=="length"||isBuff&&(key=="offset"||key=="parent")||isType&&(key=="buffer"||key=="byteLength"||key=="byteOffset")||isIndex(key,length)))){result.push(key)}}return result}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object);var nativeKeys$1=nativeKeys;var objectProto$c=Object.prototype;var hasOwnProperty$c=objectProto$c.hasOwnProperty;function baseKeys(object){if(!isPrototype$1(object)){return nativeKeys$1(object)}var result=[];for(var key in Object(object)){if(hasOwnProperty$c.call(object,key)&&key!="constructor"){result.push(key)}}return result}function keys$3(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}var objectProto$b=Object.prototype;var hasOwnProperty$b=objectProto$b.hasOwnProperty;createAssigner((function(object,source){if(isPrototype$1(source)||isArrayLike(source)){copyObject(source,keys$3(source),object);return}for(var key in source){if(hasOwnProperty$b.call(source,key)){assignValue(object,key,source[key])}}}));function nativeKeysIn(object){var result=[];if(object!=null){for(var key in Object(object)){result.push(key)}}return result}var objectProto$a=Object.prototype;var hasOwnProperty$a=objectProto$a.hasOwnProperty;function baseKeysIn(object){if(!isObject$1(object)){return nativeKeysIn(object)}var isProto=isPrototype$1(object),result=[];for(var key in object){if(!(key=="constructor"&&(isProto||!hasOwnProperty$a.call(object,key)))){result.push(key)}}return result}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,true):baseKeysIn(object)}var assignInWith=createAssigner((function(object,source,srcIndex,customizer){copyObject(source,keysIn(source),object,customizer)}));var extendWith=assignInWith;var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(value,object){if(isArray$1(value)){return false}var type=typeof value;if(type=="number"||type=="symbol"||type=="boolean"||value==null||isSymbol$2(value)){return true}return reIsPlainProp.test(value)||!reIsDeepProp.test(value)||object!=null&&value in Object(object)}var nativeCreate=getNative(Object,"create");var nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{};this.size=0}function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];this.size-=result?1:0;return result}var HASH_UNDEFINED$2="__lodash_hash_undefined__";var objectProto$9=Object.prototype;var hasOwnProperty$9=objectProto$9.hasOwnProperty;function hashGet(key){var data=this.__data__;if(nativeCreate$1){var result=data[key];return result===HASH_UNDEFINED$2?undefined:result}return hasOwnProperty$9.call(data,key)?data[key]:undefined}var objectProto$8=Object.prototype;var hasOwnProperty$8=objectProto$8.hasOwnProperty;function hashHas(key){var data=this.__data__;return nativeCreate$1?data[key]!==undefined:hasOwnProperty$8.call(data,key)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(key,value){var data=this.__data__;this.size+=this.has(key)?0:1;data[key]=nativeCreate$1&&value===undefined?HASH_UNDEFINED$1:value;return this}function Hash(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear;Hash.prototype["delete"]=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[];this.size=0}function assocIndexOf(array,key){var length=array.length;while(length--){if(eq(array[length][0],key)){return length}}return-1}var arrayProto=Array.prototype;var splice=arrayProto.splice;function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){return false}var lastIndex=data.length-1;if(index==lastIndex){data.pop()}else{splice.call(data,index,1)}--this.size;return true}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){++this.size;data.push([key,value])}else{data[index][1]=value}return this}function ListCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype["delete"]=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map");var Map$2=Map$1;function mapCacheClear(){this.size=0;this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(value){var type=typeof value;return type=="string"||type=="number"||type=="symbol"||type=="boolean"?value!=="__proto__":value===null}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data[typeof key=="string"?"string":"hash"]:data.map}function mapCacheDelete(key){var result=getMapData(this,key)["delete"](key);this.size-=result?1:0;return result}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){var data=getMapData(this,key),size=data.size;data.set(key,value);this.size+=data.size==size?0:1;return this}function MapCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype["delete"]=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$1="Expected a function";function memoize$2(func,resolver){if(typeof func!="function"||resolver!=null&&typeof resolver!="function"){throw new TypeError(FUNC_ERROR_TEXT$1)}var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key)}var result=func.apply(this,args);memoized.cache=cache.set(key,result)||cache;return result};memoized.cache=new(memoize$2.Cache||MapCache);return memoized}memoize$2.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(func){var result=memoize$2(func,(function(key){if(cache.size===MAX_MEMOIZE_SIZE){cache.clear()}return key}));var cache=result.cache;return result}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=memoizeCapped((function(string){var result=[];if(string.charCodeAt(0)===46){result.push("")}string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}));return result}));var stringToPath$1=stringToPath;function toString(value){return value==null?"":baseToString(value)}function castPath(value,object){if(isArray$1(value)){return value}return isKey(value,object)?[value]:stringToPath$1(toString(value))}var INFINITY$1=1/0;function toKey(value){if(typeof value=="string"||isSymbol$2(value)){return value}var result=value+"";return result=="0"&&1/value==-INFINITY$1?"-0":result}function baseGet(object,path){path=castPath(path,object);var index=0,length=path.length;while(object!=null&&index<length){object=object[toKey(path[index++])]}return index&&index==length?object:undefined}function get(object,path,defaultValue){var result=object==null?undefined:baseGet(object,path);return result===undefined?defaultValue:result}function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length){array[offset+index]=values[index]}return array}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:undefined;function isFlattenable(value){return isArray$1(value)||isArguments$1(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;predicate||(predicate=isFlattenable);result||(result=[]);while(++index<length){var value=array[index];if(depth>0&&predicate(value)){if(depth>1){baseFlatten(value,depth-1,predicate,isStrict,result)}else{arrayPush(result,value)}}else if(!isStrict){result[result.length]=value}}return result}function flatten(array){var length=array==null?0:array.length;return length?baseFlatten(array,1):[]}function flatRest(func){return setToString$1(overRest(func,undefined,flatten),func+"")}var getPrototype=overArg(Object.getPrototypeOf,Object);var getPrototype$1=getPrototype;var objectTag$3="[object Object]";var funcProto=Function.prototype,objectProto$7=Object.prototype;var funcToString=funcProto.toString;var hasOwnProperty$7=objectProto$7.hasOwnProperty;var objectCtorString=funcToString.call(Object);function isPlainObject(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag$3){return false}var proto=getPrototype$1(value);if(proto===null){return true}var Ctor=hasOwnProperty$7.call(proto,"constructor")&&proto.constructor;return typeof Ctor=="function"&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}var domExcTag="[object DOMException]",errorTag$2="[object Error]";function isError(value){if(!isObjectLike(value)){return false}var tag=baseGetTag(value);return tag==errorTag$2||tag==domExcTag||typeof value.message=="string"&&typeof value.name=="string"&&!isPlainObject(value)}var attempt=baseRest((function(func,args){try{return apply(func,undefined,args)}catch(e){return isError(e)?e:new Error(e)}}));var attempt$1=attempt;function baseSlice(array,start,end){var index=-1,length=array.length;if(start<0){start=-start>length?0:length+start}end=end>length?length:end;if(end<0){end+=length}length=start>end?0:end-start>>>0;start>>>=0;var result=Array(length);while(++index<length){result[index]=array[index+start]}return result}function basePropertyOf(object){return function(key){return object==null?undefined:object[key]}}function stackClear(){this.__data__=new ListCache;this.size=0}function stackDelete(key){var data=this.__data__,result=data["delete"](key);this.size=data.size;return result}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}var LARGE_ARRAY_SIZE$1=200;function stackSet(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map$2||pairs.length<LARGE_ARRAY_SIZE$1-1){pairs.push([key,value]);this.size=++data.size;return this}data=this.__data__=new MapCache(pairs)}data.set(key,value);this.size=data.size;return this}function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear;Stack.prototype["delete"]=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(object,source){return object&&copyObject(source,keys$3(source),object)}function baseAssignIn(object,source){return object&&copyObject(source,keysIn(source),object)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports;var Buffer=moduleExports?root$1.Buffer:undefined,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined;function cloneBuffer(buffer,isDeep){if(isDeep){return buffer.slice()}var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);buffer.copy(result);return result}function arrayFilter(array,predicate){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(predicate(value,index,array)){result[resIndex++]=value}}return result}function stubArray(){return[]}var objectProto$6=Object.prototype;var propertyIsEnumerable=objectProto$6.propertyIsEnumerable;var nativeGetSymbols$1=Object.getOwnPropertySymbols;var getSymbols=!nativeGetSymbols$1?stubArray:function(object){if(object==null){return[]}object=Object(object);return arrayFilter(nativeGetSymbols$1(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)}))};var getSymbols$1=getSymbols;function copySymbols(source,object){return copyObject(source,getSymbols$1(source),object)}var nativeGetSymbols=Object.getOwnPropertySymbols;var getSymbolsIn=!nativeGetSymbols?stubArray:function(object){var result=[];while(object){arrayPush(result,getSymbols$1(object));object=getPrototype$1(object)}return result};var getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(source,object){return copyObject(source,getSymbolsIn$1(source),object)}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray$1(object)?result:arrayPush(result,symbolsFunc(object))}function getAllKeys(object){return baseGetAllKeys(object,keys$3,getSymbols$1)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn$1)}var DataView=getNative(root$1,"DataView");var DataView$1=DataView;var Promise$1=getNative(root$1,"Promise");var Promise$2=Promise$1;var Set$1=getNative(root$1,"Set");var Set$2=Set$1;var mapTag$5="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$5="[object Set]",weakMapTag$1="[object WeakMap]";var dataViewTag$3="[object DataView]";var dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$1);var getTag=baseGetTag;if(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$5||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$5||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1){getTag=function(value){var result=baseGetTag(value),Ctor=result==objectTag$2?value.constructor:undefined,ctorString=Ctor?toSource(Ctor):"";if(ctorString){switch(ctorString){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$5;case promiseCtorString:return promiseTag;case setCtorString:return setTag$5;case weakMapCtorString:return weakMapTag$1}}return result}}var getTag$1=getTag;var objectProto$5=Object.prototype;var hasOwnProperty$6=objectProto$5.hasOwnProperty;function initCloneArray(array){var length=array.length,result=new array.constructor(length);if(length&&typeof array[0]=="string"&&hasOwnProperty$6.call(array,"index")){result.index=array.index;result.input=array.input}return result}var Uint8Array=root$1.Uint8Array;var Uint8Array$1=Uint8Array;function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);new Uint8Array$1(result).set(new Uint8Array$1(arrayBuffer));return result}function cloneDataView(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}var reFlags=/\w*$/;function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));result.lastIndex=regexp.lastIndex;return result}var symbolProto$1=Symbol$2?Symbol$2.prototype:undefined,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:undefined;function cloneSymbol(symbol){return symbolValueOf$1?Object(symbolValueOf$1.call(symbol)):{}}function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$4="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]";var arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag$2:return cloneArrayBuffer(object);case boolTag$2:case dateTag$2:return new Ctor(+object);case dataViewTag$2:return cloneDataView(object,isDeep);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(object,isDeep);case mapTag$4:return new Ctor;case numberTag$2:case stringTag$2:return new Ctor(object);case regexpTag$2:return cloneRegExp(object);case setTag$4:return new Ctor;case symbolTag$2:return cloneSymbol(object)}}function initCloneObject(object){return typeof object.constructor=="function"&&!isPrototype$1(object)?baseCreate$1(getPrototype$1(object)):{}}var mapTag$3="[object Map]";function baseIsMap(value){return isObjectLike(value)&&getTag$1(value)==mapTag$3}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap;var isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;var isMap$1=isMap;var setTag$3="[object Set]";function baseIsSet(value){return isObjectLike(value)&&getTag$1(value)==setTag$3}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet;var isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;var isSet$1=isSet;var CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$2=4;var argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$2="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]";var arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$2]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$2]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=true;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=false;function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG$2,isFlat=bitmask&CLONE_FLAT_FLAG$1,isFull=bitmask&CLONE_SYMBOLS_FLAG$2;if(customizer){result=object?customizer(value,key,object,stack):customizer(value)}if(result!==undefined){return result}if(!isObject$1(value)){return value}var isArr=isArray$1(value);if(isArr){result=initCloneArray(value);if(!isDeep){return copyArray(value,result)}}else{var tag=getTag$1(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer$1(value)){return cloneBuffer(value,isDeep)}if(tag==objectTag$1||tag==argsTag$1||isFunc&&!object){result=isFlat||isFunc?{}:initCloneObject(value);if(!isDeep){return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}}else{if(!cloneableTags[tag]){return object?value:{}}result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked){return stacked}stack.set(value,result);if(isSet$1(value)){value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}))}else if(isMap$1(value)){value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}))}var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys$3;var props=isArr?undefined:keysFunc(value);arrayEach(props||value,(function(subValue,key){if(props){key=subValue;subValue=value[key]}assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}));return result}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(value){this.__data__.set(value,HASH_UNDEFINED);return this}function setCacheHas(value){return this.__data__.has(value)}function SetCache(values){var index=-1,length=values==null?0:values.length;this.__data__=new MapCache;while(++index<length){this.add(values[index])}}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(array,predicate){var index=-1,length=array==null?0:array.length;while(++index<length){if(predicate(array[index],index,array)){return true}}return false}function cacheHas(cache,key){return cache.has(key)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$5,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength)){return false}var arrStacked=stack.get(array);var othStacked=stack.get(other);if(arrStacked&&othStacked){return arrStacked==other&&othStacked==array}var index=-1,result=true,seen=bitmask&COMPARE_UNORDERED_FLAG$3?new SetCache:undefined;stack.set(array,other);stack.set(other,array);while(++index<arrLength){var arrValue=array[index],othValue=other[index];if(customizer){var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack)}if(compared!==undefined){if(compared){continue}result=false;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){return seen.push(othIndex)}}))){result=false;break}}else if(!(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){result=false;break}}stack["delete"](array);stack["delete"](other);return result}function mapToArray(map){var index=-1,result=Array(map.size);map.forEach((function(value,key){result[++index]=[key,value]}));return result}function setToArray(set){var index=-1,result=Array(set.size);set.forEach((function(value){result[++index]=value}));return result}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;var boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag$1="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag$1="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]";var arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]";var symbolProto=Symbol$2?Symbol$2.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined;function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset){return false}object=object.buffer;other=other.buffer;case arrayBufferTag:if(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array$1(object),new Uint8Array$1(other))){return false}return true;case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag$1:var convert=mapToArray;case setTag$1:var isPartial=bitmask&COMPARE_PARTIAL_FLAG$4;convert||(convert=setToArray);if(object.size!=other.size&&!isPartial){return false}var stacked=stack.get(object);if(stacked){return stacked==other}bitmask|=COMPARE_UNORDERED_FLAG$2;stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);stack["delete"](object);return result;case symbolTag:if(symbolValueOf){return symbolValueOf.call(object)==symbolValueOf.call(other)}}return false}var COMPARE_PARTIAL_FLAG$3=1;var objectProto$4=Object.prototype;var hasOwnProperty$5=objectProto$4.hasOwnProperty;function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$3,objProps=getAllKeys(object),objLength=objProps.length,othProps=getAllKeys(other),othLength=othProps.length;if(objLength!=othLength&&!isPartial){return false}var index=objLength;while(index--){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty$5.call(other,key))){return false}}var objStacked=stack.get(object);var othStacked=stack.get(other);if(objStacked&&othStacked){return objStacked==other&&othStacked==object}var result=true;stack.set(object,other);stack.set(other,object);var skipCtor=isPartial;while(++index<objLength){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer){var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack)}if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=false;break}skipCtor||(skipCtor=key=="constructor")}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&("constructor"in object&&"constructor"in other)&&!(typeof objCtor=="function"&&objCtor instanceof objCtor&&typeof othCtor=="function"&&othCtor instanceof othCtor)){result=false}}stack["delete"](object);stack["delete"](other);return result}var COMPARE_PARTIAL_FLAG$2=1;var argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]";var objectProto$3=Object.prototype;var hasOwnProperty$4=objectProto$3.hasOwnProperty;function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray$1(object),othIsArr=isArray$1(other),objTag=objIsArr?arrayTag:getTag$1(object),othTag=othIsArr?arrayTag:getTag$1(other);objTag=objTag==argsTag?objectTag:objTag;othTag=othTag==argsTag?objectTag:othTag;var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer$1(object)){if(!isBuffer$1(other)){return false}objIsArr=true;objIsObj=false}if(isSameTag&&!objIsObj){stack||(stack=new Stack);return objIsArr||isTypedArray$1(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack)}if(!(bitmask&COMPARE_PARTIAL_FLAG$2)){var objIsWrapped=objIsObj&&hasOwnProperty$4.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty$4.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;stack||(stack=new Stack);return equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}if(!isSameTag){return false}stack||(stack=new Stack);return equalObjects(object,other,bitmask,customizer,equalFunc,stack)}function baseIsEqual(value,other,bitmask,customizer,stack){if(value===other){return true}if(value==null||other==null||!isObjectLike(value)&&!isObjectLike(other)){return value!==value&&other!==other}return baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(object==null){return!length}object=Object(object);while(index--){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object)){return false}}while(++index<length){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object)){return false}}else{var stack=new Stack;if(customizer){var result=customizer(objValue,srcValue,key,object,source,stack)}if(!(result===undefined?baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,customizer,stack):result)){return false}}}return true}function isStrictComparable(value){return value===value&&!isObject$1(value)}function getMatchData(object){var result=keys$3(object),length=result.length;while(length--){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function matchesStrictComparable(key,srcValue){return function(object){if(object==null){return false}return object[key]===srcValue&&(srcValue!==undefined||key in Object(object))}}function baseMatches(source){var matchData=getMatchData(source);if(matchData.length==1&&matchData[0][2]){return matchesStrictComparable(matchData[0][0],matchData[0][1])}return function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseHasIn(object,key){return object!=null&&key in Object(object)}function hasPath(object,path,hasFunc){path=castPath(path,object);var index=-1,length=path.length,result=false;while(++index<length){var key=toKey(path[index]);if(!(result=object!=null&&hasFunc(object,key))){break}object=object[key]}if(result||++index!=length){return result}length=object==null?0:object.length;return!!length&&isLength(length)&&isIndex(key,length)&&(isArray$1(object)||isArguments$1(object))}function hasIn(object,path){return object!=null&&hasPath(object,path,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(path,srcValue){if(isKey(path)&&isStrictComparable(srcValue)){return matchesStrictComparable(toKey(path),srcValue)}return function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(key){return function(object){return object==null?undefined:object[key]}}function basePropertyDeep(path){return function(object){return baseGet(object,path)}}function property(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}function baseIteratee(value){if(typeof value=="function"){return value}if(value==null){return identity}if(typeof value=="object"){return isArray$1(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value)}return property(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function arrayIncludesWith(array,value,comparator){var index=-1,length=array==null?0:array.length;while(++index<length){if(comparator(value,array[index])){return true}}return false}function last(array){var length=array==null?0:array.length;return length?array[length-1]:undefined}var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var escapeHtmlChar=basePropertyOf(htmlEscapes);var escapeHtmlChar$1=escapeHtmlChar;var reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape(string){string=toString(string);return string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar$1):string}function baseValues(object,props){return arrayMap(props,(function(key){return object[key]}))}var nativeMin=Math.min;function baseIntersection(arrays,iteratee,comparator){var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=Infinity,result=[];while(othIndex--){var array=arrays[othIndex];if(othIndex&&iteratee){array=arrayMap(array,baseUnary(iteratee))}maxLength=nativeMin(array.length,maxLength);caches[othIndex]=!comparator&&(iteratee||length>=120&&array.length>=120)?new SetCache(othIndex&&array):undefined}array=arrays[0];var index=-1,seen=caches[0];outer:while(++index<length&&result.length<maxLength){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){othIndex=othLength;while(--othIndex){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator))){continue outer}}if(seen){seen.push(computed)}result.push(value)}}return result}function castArrayLikeObject(value){return isArrayLikeObject(value)?value:[]}baseRest((function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);if(iteratee===last(mapped)){iteratee=undefined}else{mapped.pop()}return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,baseIteratee(iteratee)):[]}));function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}var mapTag="[object Map]",setTag="[object Set]";var objectProto$2=Object.prototype;var hasOwnProperty$3=objectProto$2.hasOwnProperty;function isEmpty(value){if(value==null){return true}if(isArrayLike(value)&&(isArray$1(value)||typeof value=="string"||typeof value.splice=="function"||isBuffer$1(value)||isTypedArray$1(value)||isArguments$1(value))){return!value.length}var tag=getTag$1(value);if(tag==mapTag||tag==setTag){return!value.size}if(isPrototype$1(value)){return!baseKeys(value).length}for(var key in value){if(hasOwnProperty$3.call(value,key)){return false}}return true}function baseUnset(object,path){path=castPath(path,object);object=parent(object,path);return object==null||delete object[toKey(last(path))]}function customOmitClone(value){return isPlainObject(value)?undefined:value}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4;var omit=flatRest((function(object,paths){var result={};if(object==null){return result}var isDeep=false;paths=arrayMap(paths,(function(path){path=castPath(path,object);isDeep||(isDeep=path.length>1);return path}));copyObject(object,getAllKeysIn(object),result);if(isDeep){result=baseClone(result,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone)}var length=paths.length;while(length--){baseUnset(result,paths[length])}return result}));var omit$1=omit;function baseSet(object,path,value,customizer){if(!isObject$1(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key==="__proto__"||key==="constructor"||key==="prototype"){return object}if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject$1(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}function basePickBy(object,paths,predicate){var index=-1,length=paths.length,result={};while(++index<length){var path=paths[index],value=baseGet(object,path);if(predicate(value,path)){baseSet(result,castPath(path,object),value)}}return result}function basePick(object,paths){return basePickBy(object,paths,(function(value,path){return hasIn(object,path)}))}flatRest((function(object,paths){return object==null?{}:basePick(object,paths)}));var objectProto$1=Object.prototype;var hasOwnProperty$2=objectProto$1.hasOwnProperty;function customDefaultsAssignIn(objValue,srcValue,key,object){if(objValue===undefined||eq(objValue,objectProto$1[key])&&!hasOwnProperty$2.call(object,key)){return srcValue}return objValue}var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function escapeStringChar(chr){return"\\"+stringEscapes[chr]}var reInterpolate=/<%=([\s\S]+?)%>/g;var reInterpolate$1=reInterpolate;var reEscape=/<%-([\s\S]+?)%>/g;var reEscape$1=reEscape;var reEvaluate=/<%([\s\S]+?)%>/g;var reEvaluate$1=reEvaluate;var templateSettings={escape:reEscape$1,evaluate:reEvaluate$1,interpolate:reInterpolate$1,variable:"",imports:{_:{escape}}};var templateSettings$1=templateSettings;var INVALID_TEMPL_VAR_ERROR_TEXT="Invalid `variable` option passed into `_.template`";var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reNoMatch=/($^)/;var reUnescapedString=/['\n\r\u2028\u2029\\]/g;var objectProto=Object.prototype;var hasOwnProperty$1=objectProto.hasOwnProperty;function template(string,options,guard){var settings=templateSettings$1.imports._.templateSettings||templateSettings$1;if(guard&&isIterateeCall(string,options,guard)){options=undefined}string=toString(string);options=extendWith({},options,settings,customDefaultsAssignIn);var imports=extendWith({},options.imports,settings.imports,customDefaultsAssignIn),importsKeys=keys$3(imports),importsValues=baseValues(imports,importsKeys);var isEscaping,isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate$1?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");var sourceURL=hasOwnProperty$1.call(options,"sourceURL")?"//# sourceURL="+(options.sourceURL+"").replace(/\s/g," ")+"\n":"";string.replace(reDelimiters,(function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){isEscaping=true;source+="' +\n__e("+escapeValue+") +\n'"}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '"}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}index=offset+match.length;return match}));source+="';\n";var variable=hasOwnProperty$1.call(options,"variable")&&options.variable;if(!variable){source="with (obj) {\n"+source+"\n}\n"}else if(reForbiddenIdentifierChars.test(variable)){throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT)}source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt$1((function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)}));result.source=source;if(isError(result)){throw result}return result}var INFINITY=1/0;var createSet=!(Set$2&&1/setToArray(new Set$2([,-0]))[1]==INFINITY)?noop$1:function(values){return new Set$2(values)};var createSet$1=createSet;var LARGE_ARRAY_SIZE=200;function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=true,result=[],seen=result;if(comparator){isCommon=false;includes=arrayIncludesWith}else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet$1(array);if(set){return setToArray(set)}isCommon=false;includes=cacheHas;seen=new SetCache}else{seen=iteratee?[]:result}outer:while(++index<length){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(isCommon&&computed===computed){var seenIndex=seen.length;while(seenIndex--){if(seen[seenIndex]===computed){continue outer}}if(iteratee){seen.push(computed)}result.push(value)}else if(!includes(seen,computed,comparator)){if(seen!==result){seen.push(computed)}result.push(value)}}return result}baseRest((function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee=undefined}return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true),baseIteratee(iteratee))}));function isEveryPropertyEmpty(value){let isAllPropsEmpty=true;if(typeof value==="object"&&isArray$1(value)===false){for(const prop in value){const propValue=value?.[prop];if(value.hasOwnProperty(prop)===true&&propValue!==undefined&&propValue!==null&&propValue!==""){isAllPropsEmpty=false;break}}}return isAllPropsEmpty}function isEmptyDataItem(value){return value===undefined||value===null||typeof value==="string"&&value===""||isPlainObject(value)&&isEmpty(value)||Array.isArray(value)&&value.length<1||typeof value==="object"&&isArray$1(value)===false&&isEveryPropertyEmpty(value)}async function request(url,options){return request$1__default["default"](url,options)}const SupportedLocales={Arabic:"ar",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Czech:"cs",Danish:"da",German:"de",Greek:"el",English:"en",EnglishUSA:"en-US",Spanish:"es",Estonian:"et",Finnish:"fi",French:"fr",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Italian:"it",Japanese:"ja",Korean:"ko",Lithuanian:"lt",Latvian:"lv",NorwegianBokml:"nb",Dutch:"nl",Polish:"pl",PortugueseBrazil:"pt-BR",PortuguesePortugal:"pt-PT",Romanian:"ro",Russian:"ru",Serbian:"sr",Slovenian:"sl",Slovak:"sk",Swedish:"sv",Thai:"th",Turkish:"tr",Ukrainian:"uk",Vietnamese:"vi",ChineseChina:"zh-CN",ChineseHongKong:"zh-HK",ChineseTaiwan:"zh-TW"};const SupportedLocalesForFormats=[...Object.values(SupportedLocales),"ar-u-nu-latn","en-AU","en-GB","es-ES","es-MX","de-AT","de-CH","de-DE","it-CH","it-IT"];const RTLLocales=[SupportedLocales.Arabic,SupportedLocales.Hebrew];function formatMessage(statement,parameters){const templateFn=template(statement);return templateFn(parameters)}function extractLanguageTag(locale){const localeCodeRegex=/^([a-z]{2})-([A-Z]{1,2})$/;const match=locale?.match(localeCodeRegex);let output=SupportedLocales.English;if(match!==null&&match!==undefined&&match?.length>1){output=match[1]}else if(locale?.length===2&&locale.toLowerCase()===locale){output=locale}return output}function convertToSupportedLocale(locale){let output=SupportedLocales.English;if(locale!==undefined){const supportedLocales=Object.values(SupportedLocales);const hyphenatedSupportedLocales=supportedLocales.filter((ele=>ele.indexOf("-")!==-1));if(locale.indexOf("-")!==-1){const[lang,region]=locale.split("-");locale=`${lang}-${region.toUpperCase()}`}if(hyphenatedSupportedLocales.includes(locale)===true){output=locale}else{const languageTag=extractLanguageTag(locale);if(supportedLocales.includes(languageTag)===true){output=languageTag}}}return output}function convertToSupportedFormatLocale(locale){let formatLocale=SupportedLocalesForFormats.find((item=>item===locale));if(formatLocale===undefined){formatLocale=locale}if(formatLocale!==undefined&&formatLocale.indexOf("-")!==-1){const[lang,region]=formatLocale.split("-");formatLocale=`${lang}-${region.toUpperCase()}`}if(formatLocale==="ar"){formatLocale="ar-u-nu-latn"}return formatLocale}function getClosestElement(selector,base){function closestFrom(el){let element;if(el===undefined||el===document||el===window)element=null;else{const found=el.closest(selector);element=found||closestFrom(el.getRootNode().host)}return element}return closestFrom(base)}function getLocaleInfo(element=document.documentElement){const closestElement=getClosestElement("[lang]",element);const locale=closestElement?.lang??window.navigator.language;const convertedLocale=convertToSupportedLocale(locale);const formatLocale=convertToSupportedFormatLocale(locale);return{locale:convertedLocale,rtl:RTLLocales.includes(convertedLocale),formatLocale}}class ArcgisWebAnalysisError extends Error{constructor(name,message,details,cause){super(message);this.name=name;this.details=details;this.cause=cause}}const ErrorKeywords={Default:"defaultError",CannotReopenTool:"cannotReopenTool",CannotReopenWebTool:"cannotReopenWebTool",CreditEstimationError:"creditEstimationError",CreditThresholdExceededError:"creditThresholdExceededError",CreditEstimationExecutionFailure:"failedToExecuteEstimate",InsufficientCreditsError:"InsufficientCreditsError",KeyPropertiesError:"keyPropertiesError",LayerLoadFailure:"layerLoadFailure",LayerUnavailable:"layerUnavailable",NetworkError:"networkError",PortalLoadError:"portalLoadError",QueryFeaturesError:"queryFeaturesError",ServiceNameExistsError:"serviceNameExistsError",SpecialCharactersInServiceNameError:"specialCharactersInServiceNameError",ToolValidationError:"toolValidationError",WebToolFailedFetch:"webToolFailedFetch",WebToolJSONChanged:"webToolJSONChanged",WebToolPermissionsError:"missingPermissionForWebTool"};var isImplemented$4=function(){if(typeof globalThis!=="object")return false;if(!globalThis)return false;return globalThis.Array===Array};var naiveFallback=function(){if(typeof self==="object"&&self)return self;if(typeof window==="object"&&window)return window;throw new Error("Unable to resolve global `this`")};var implementation=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:true})}catch(error){return naiveFallback()}try{if(!__global__)return naiveFallback();return __global__}finally{delete Object.prototype.__global__}}();var globalThis_1=isImplemented$4()?globalThis:implementation;var global$1=globalThis_1,validTypes={object:true,symbol:true};var isImplemented$3=function(){var Symbol=global$1.Symbol;if(typeof Symbol!=="function")return false;Symbol("test symbol");if(!validTypes[typeof Symbol.iterator])return false;if(!validTypes[typeof Symbol.toPrimitive])return false;if(!validTypes[typeof Symbol.toStringTag])return false;return true};var d$5={exports:{}};var _undefined$1=void 0;var is$4=function(value){return value!==_undefined$1&&value!==null};var isValue$5=is$4;var possibleTypes={object:true,function:true,undefined:true};var is$3=function(value){if(!isValue$5(value))return false;return hasOwnProperty.call(possibleTypes,typeof value)};var isObject=is$3;var is$2=function(value){if(!isObject(value))return false;try{if(!value.constructor)return false;return value.constructor.prototype===value}catch(error){return false}};var isPrototype=is$2;var is$1=function(value){if(typeof value!=="function")return false;if(!hasOwnProperty.call(value,"length"))return false;try{if(typeof value.length!=="number")return false;if(typeof value.call!=="function")return false;if(typeof value.apply!=="function")return false}catch(error){return false}return!isPrototype(value)};var isFunction=is$1;var classRe=/^\s*class[\s{/}]/,functionToString=Function.prototype.toString;var is=function(value){if(!isFunction(value))return false;if(classRe.test(functionToString.call(value)))return false;return true};var isImplemented$2=function(){var assign=Object.assign,obj;if(typeof assign!=="function")return false;obj={foo:"raz"};assign(obj,{bar:"dwa"},{trzy:"trzy"});return obj.foo+obj.bar+obj.trzy==="razdwatrzy"};var isImplemented$1=function(){try{return true}catch(e){return false}};var noop=function(){};var _undefined=noop();var isValue$4=function(val){return val!==_undefined&&val!==null};var isValue$3=isValue$4;var keys$2=Object.keys;var shim$2=function(object){return keys$2(isValue$3(object)?Object(object):object)};var keys$1=isImplemented$1()?Object.keys:shim$2;var isValue$2=isValue$4;var validValue=function(value){if(!isValue$2(value))throw new TypeError("Cannot use null or undefined");return value};var keys=keys$1,value=validValue,max=Math.max;var shim$1=function(dest,src){var error,i,length=max(arguments.length,2),assign;dest=Object(value(dest));assign=function(key){try{dest[key]=src[key]}catch(e){if(!error)error=e}};for(i=1;i<length;++i){src=arguments[i];keys(src).forEach(assign)}if(error!==undefined)throw error;return dest};var assign$1=isImplemented$2()?Object.assign:shim$1;var isValue$1=isValue$4;var forEach=Array.prototype.forEach,create$2=Object.create;var process=function(src,obj){var key;for(key in src)obj[key]=src[key]};var normalizeOptions=function(opts1){var result=create$2(null);forEach.call(arguments,(function(options){if(!isValue$1(options))return;process(Object(options),result)}));return result};var str="razdwatrzy";var isImplemented=function(){if(typeof str.contains!=="function")return false;return str.contains("dwa")===true&&str.contains("foo")===false};var indexOf=String.prototype.indexOf;var shim=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1};var contains$1=isImplemented()?String.prototype.contains:shim;var isValue=is$4,isPlainFunction=is,assign=assign$1,normalizeOpts=normalizeOptions,contains=contains$1;var d$4=d$5.exports=function(dscr,value){var c,e,w,options,desc;if(arguments.length<2||typeof dscr!=="string"){options=value;value=dscr;dscr=null}else{options=arguments[2]}if(isValue(dscr)){c=contains.call(dscr,"c");e=contains.call(dscr,"e");w=contains.call(dscr,"w")}else{c=w=true;e=false}desc={value,configurable:c,enumerable:e,writable:w};return!options?desc:assign(normalizeOpts(options),desc)};d$4.gs=function(dscr,get,set){var c,e,options,desc;if(typeof dscr!=="string"){options=set;set=get;get=dscr;dscr=null}else{options=arguments[3]}if(!isValue(get)){get=undefined}else if(!isPlainFunction(get)){options=get;get=set=undefined}else if(!isValue(set)){set=undefined}else if(!isPlainFunction(set)){options=set;set=undefined}if(isValue(dscr)){c=contains.call(dscr,"c");e=contains.call(dscr,"e")}else{c=true;e=false}desc={get,set,configurable:c,enumerable:e};return!options?desc:assign(normalizeOpts(options),desc)};var isSymbol$1=function(value){if(!value)return false;if(typeof value==="symbol")return true;if(!value.constructor)return false;if(value.constructor.name!=="Symbol")return false;return value[value.constructor.toStringTag]==="Symbol"};var isSymbol=isSymbol$1;var validateSymbol$2=function(value){if(!isSymbol(value))throw new TypeError(value+" is not a symbol");return value};var d$3=d$5.exports;var create$1=Object.create,defineProperty$1=Object.defineProperty,objPrototype=Object.prototype;var created=create$1(null);var generateName$1=function(desc){var postfix=0,name,ie11BugWorkaround;while(created[desc+(postfix||"")])++postfix;desc+=postfix||"";created[desc]=true;name="@@"+desc;defineProperty$1(objPrototype,name,d$3.gs(null,(function(value){if(ie11BugWorkaround)return;ie11BugWorkaround=true;defineProperty$1(this,name,d$3(value));ie11BugWorkaround=false})));return name};var d$2=d$5.exports,NativeSymbol$1=globalThis_1.Symbol;var standardSymbols=function(SymbolPolyfill){return Object.defineProperties(SymbolPolyfill,{hasInstance:d$2("",NativeSymbol$1&&NativeSymbol$1.hasInstance||SymbolPolyfill("hasInstance")),isConcatSpreadable:d$2("",NativeSymbol$1&&NativeSymbol$1.isConcatSpreadable||SymbolPolyfill("isConcatSpreadable")),iterator:d$2("",NativeSymbol$1&&NativeSymbol$1.iterator||SymbolPolyfill("iterator")),match:d$2("",NativeSymbol$1&&NativeSymbol$1.match||SymbolPolyfill("match")),replace:d$2("",NativeSymbol$1&&NativeSymbol$1.replace||SymbolPolyfill("replace")),search:d$2("",NativeSymbol$1&&NativeSymbol$1.search||SymbolPolyfill("search")),species:d$2("",NativeSymbol$1&&NativeSymbol$1.species||SymbolPolyfill("species")),split:d$2("",NativeSymbol$1&&NativeSymbol$1.split||SymbolPolyfill("split")),toPrimitive:d$2("",NativeSymbol$1&&NativeSymbol$1.toPrimitive||SymbolPolyfill("toPrimitive")),toStringTag:d$2("",NativeSymbol$1&&NativeSymbol$1.toStringTag||SymbolPolyfill("toStringTag")),unscopables:d$2("",NativeSymbol$1&&NativeSymbol$1.unscopables||SymbolPolyfill("unscopables"))})};var d$1=d$5.exports,validateSymbol$1=validateSymbol$2;var registry=Object.create(null);var symbolRegistry=function(SymbolPolyfill){return Object.defineProperties(SymbolPolyfill,{for:d$1((function(key){if(registry[key])return registry[key];return registry[key]=SymbolPolyfill(String(key))})),keyFor:d$1((function(symbol){var key;validateSymbol$1(symbol);for(key in registry){if(registry[key]===symbol)return key}return undefined}))})};var d=d$5.exports,validateSymbol=validateSymbol$2,NativeSymbol=globalThis_1.Symbol,generateName=generateName$1,setupStandardSymbols=standardSymbols,setupSymbolRegistry=symbolRegistry;var create=Object.create,defineProperties=Object.defineProperties,defineProperty=Object.defineProperty;var SymbolPolyfill,HiddenSymbol,isNativeSafe;if(typeof NativeSymbol==="function"){try{String(NativeSymbol());isNativeSafe=true}catch(ignore){}}else{NativeSymbol=null}HiddenSymbol=function Symbol(description){if(this instanceof HiddenSymbol)throw new TypeError("Symbol is not a constructor");return SymbolPolyfill(description)};var polyfill=SymbolPolyfill=function Symbol(description){var symbol;if(this instanceof Symbol)throw new TypeError("Symbol is not a constructor");if(isNativeSafe)return NativeSymbol(description);symbol=create(HiddenSymbol.prototype);description=description===undefined?"":String(description);return defineProperties(symbol,{__description__:d("",description),__name__:d("",generateName(description))})};setupStandardSymbols(SymbolPolyfill);setupSymbolRegistry(SymbolPolyfill);defineProperties(HiddenSymbol.prototype,{constructor:d(SymbolPolyfill),toString:d("",(function(){return this.__name__}))});defineProperties(SymbolPolyfill.prototype,{toString:d((function(){return"Symbol ("+validateSymbol(this).__description__+")"})),valueOf:d((function(){return validateSymbol(this)}))});defineProperty(SymbolPolyfill.prototype,SymbolPolyfill.toPrimitive,d("",(function(){var symbol=validateSymbol(this);if(typeof symbol==="symbol")return symbol;return symbol.toString()})));defineProperty(SymbolPolyfill.prototype,SymbolPolyfill.toStringTag,d("c","Symbol"));defineProperty(HiddenSymbol.prototype,SymbolPolyfill.toStringTag,d("c",SymbolPolyfill.prototype[SymbolPolyfill.toStringTag]));defineProperty(HiddenSymbol.prototype,SymbolPolyfill.toPrimitive,d("c",SymbolPolyfill.prototype[SymbolPolyfill.toPrimitive]));var es6Symbol=isImplemented$3()?globalThis_1.Symbol:polyfill;const Symbol=es6Symbol;Symbol("-");const AnalysisEngine$1={Standard:"standard",GeoAnalytics:"geoanalytics",Raster:"raster",Pipelines:"pipelines",Session:"session"};const AnalysisSupportedItemTypes={ImageService:"Image Service",FeatureService:"Feature Service",BigData:"Big Data File Share",Csv:"CSV",Xls:"Microsoft Excel",MapService:"Map Service",FeatureLayer:"Feature Layer",BigDataFeature:"featureClass",Table:"Table",BigDataTable:"table",MultiValueGrid:"Multi-Variable Grid",GeoprocessingService:"Geoprocessing Service",RasterFunctionTemplate:"Raster function template",BdfsTemplate:"bdfstemplate",DeepLearningPackage:"Deep Learning Package",File:"files",Doc:"documents",Image:"images",PDF:"pdfs",Csvs:"csvs"};var src$1={exports:{}};function memoize$3(fn,options){var cache=options&&options.cache?options.cache:cacheDefault$1;var serializer=options&&options.serializer?options.serializer:serializerDefault$1;var strategy=options&&options.strategy?options.strategy:strategyDefault$1;return strategy(fn,{cache,serializer})}function isPrimitive$1(value){return value==null||typeof value==="number"||typeof value==="boolean"}function monadic$1(fn,cache,serializer,arg){var cacheKey=isPrimitive$1(arg)?arg:serializer(arg);var computedValue=cache.get(cacheKey);if(typeof computedValue==="undefined"){computedValue=fn.call(this,arg);cache.set(cacheKey,computedValue)}return computedValue}function variadic$1(fn,cache,serializer){var args=Array.prototype.slice.call(arguments,3);var cacheKey=serializer(args);var computedValue=cache.get(cacheKey);if(typeof computedValue==="undefined"){computedValue=fn.apply(this,args);cache.set(cacheKey,computedValue)}return computedValue}function assemble$1(fn,context,strategy,cache,serialize){return strategy.bind(context,fn,cache,serialize)}function strategyDefault$1(fn,options){var strategy=fn.length===1?monadic$1:variadic$1;return assemble$1(fn,this,strategy,options.cache.create(),options.serializer)}function strategyVariadic$1(fn,options){var strategy=variadic$1;return assemble$1(fn,this,strategy,options.cache.create(),options.serializer)}function strategyMonadic$1(fn,options){var strategy=monadic$1;return assemble$1(fn,this,strategy,options.cache.create(),options.serializer)}function serializerDefault$1(){return JSON.stringify(arguments)}function ObjectWithoutPrototypeCache$1(){this.cache=Object.create(null)}ObjectWithoutPrototypeCache$1.prototype.has=function(key){return key in this.cache};ObjectWithoutPrototypeCache$1.prototype.get=function(key){return this.cache[key]};ObjectWithoutPrototypeCache$1.prototype.set=function(key,value){this.cache[key]=value};var cacheDefault$1={create:function create(){return new ObjectWithoutPrototypeCache$1}};src$1.exports=memoize$3;src$1.exports.strategies={variadic:strategyVariadic$1,monadic:strategyMonadic$1};var memoize$1$1=src$1.exports;const addressFields=["SingleLine","Address","Address2","Address3","Neighborhood","City","Subregion","Region","Postal","PostalExt","CountryCode"];const countrySerializerFn=args=>{const{geocodeServiceURL}=args;return geocodeServiceURL??"EMPTY_KEY"};const addressFieldsSerializerFn=args=>{const{geocodeServiceURL,inputFileItem,inputTable}=args;const itemid=inputFileItem?.itemid;const url=inputTable?.url;return!isEmptyDataItem(geocodeServiceURL)&&(!isEmptyDataItem(itemid)||!isEmptyDataItem(url))?`${geocodeServiceURL}${itemid}${url}`:"EMPTY_KEY"};memoize$1$1((async params=>{const{geocodeServiceURL,locale}=params;let countryRule;if(isEmptyDataItem(geocodeServiceURL)){countryRule={ruleType:"expression",expression:"$[Data].geocodeServiceURL = NULL",destination:"sourceCountry",effectParams:{visible:false}}}else{let countries;let detailedCountries;try{({data:{countries,detailedCountries}}=await request(`${geocodeServiceURL}?f=json`,{responseType:"json"}))}catch(err){console.error("Failed to get Locator info");throw err}const labels={};detailedCountries.forEach((country=>{const localizedNames=country.localizedNames;const fourLetterLocale=locale.length>2&&locale;let localizedName;if(typeof fourLetterLocale!=="boolean"){localizedName=localizedNames[fourLetterLocale]}if(localizedName===undefined){const twoLetterLocale=locale.length===2?locale.slice(0,2):locale;localizedName=localizedNames[twoLetterLocale];if(localizedName===undefined){const lang=Object.keys(localizedNames).find((key=>key.startsWith(twoLetterLocale)));if(lang!==undefined){localizedName=localizedNames[lang]}}}if(localizedName===null||localizedName===undefined||localizedName===""){localizedName=localizedNames[SupportedLocales.English]??localizedNames[SupportedLocales.EnglishUSA]}labels[country.name]=localizedName}));countryRule={ruleType:"expression",expression:"$[Data].geocodeServiceURL NOT null",destination:"sourceCountry",effectParams:{visible:true,choiceList:countries,choiceListLabels:labels}}}return countryRule}),{serializer:countrySerializerFn});memoize$1$1((async params=>{const{geocodeServiceURL,inputFileItem,inputTable}=params;let addressFieldsRule;let geocodeParameters;if(!isEmptyDataItem(geocodeServiceURL)&&(!isEmptyDataItem(inputFileItem)||!isEmptyDataItem(inputTable))){let fieldInfo;let fieldMapping;geocodeParameters=await analyzeGeocodeInput(params);try{fieldInfo=JSON.parse(geocodeParameters.field_info);fieldMapping=JSON.parse(geocodeParameters.field_mapping)}catch(err){console.error("Failed to parse result of AnalyzeGeocodeInput");throw err}const choiceList=fieldInfo.map((field=>field[0]));const choiceListLabels=choiceList.reduce(((acc,curr)=>({...acc,[curr]:curr})),{});addressFieldsRule={ruleType:"expression",expression:"($[Data].geocodeServiceURL NOT null) AND (($[Data].inputTable NOT null) OR ($[Data].inputFileItem NOT null))",destination:`geocodeUIParameters`,effectParams:addressFields.reduce(((acc,curr,i)=>{const value=fieldMapping.find((mapping=>mapping[1]===curr))?.[0];return{...acc,[`UIparameterInfos[${i}].choiceList`]:choiceList,[`UIparameterInfos[${i}].choiceListLabels`]:choiceListLabels,[`UIparameterInfos[${i}].defaultValue`]:value}}),{})}}return{addressFieldsRule,geocodeParameters}}),{serializer:addressFieldsSerializerFn});const CLIENT_THROWN_ERROR="analysis_ui";async function fetchErrorsStrings(locale=getLocaleInfo().locale){let strings=await new Promise((function(resolve,reject){require(["./errors.t9n.en-6cb15d51-6b6d9a9f-9eae65b2"],resolve,reject)}));switch(locale){case SupportedLocales.Arabic:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ar-1b9d7225-1ecdb6c0-53c31cde"],resolve,reject)}));break;case SupportedLocales.Bosnian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.bs-377a5410-cdbaf960-2083c5aa"],resolve,reject)}));break;case SupportedLocales.Bulgarian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.bg-89d094b5-977ecfea-6e721500"],resolve,reject)}));break;case SupportedLocales.Catalan:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ca-b4c83c33-1bc59588-9b30d03c"],resolve,reject)}));break;case SupportedLocales.Czech:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.cs-96fcf27d-9b9ab191-015cf419"],resolve,reject)}));break;case SupportedLocales.Danish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.da-cefe0c47-a25d4108-76cf0587"],resolve,reject)}));break;case SupportedLocales.German:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.de-a1b0ae17-398646ca-11fa189f"],resolve,reject)}));break;case SupportedLocales.Greek:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.el-0a20e1cc-d2dff5c0-e061784f"],resolve,reject)}));break;case SupportedLocales.EnglishUSA:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.en-US-c9f50f19-f32c2d3b-dee2c6fc"],resolve,reject)}));break;case SupportedLocales.Spanish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.es-0dd138a7-69747b34-977f59d5"],resolve,reject)}));break;case SupportedLocales.Estonian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.et-57cc3980-1bdd9c2d-73dacf77"],resolve,reject)}));break;case SupportedLocales.Finnish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.fi-7d2525cb-4b956ccb-79dd28cb"],resolve,reject)}));break;case SupportedLocales.French:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.fr-b2186e48-5ce9dd13-ebc56b4e"],resolve,reject)}));break;case SupportedLocales.Hebrew:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.he-f487411b-0d58dc1d-e52105cd"],resolve,reject)}));break;case SupportedLocales.Croatian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.hr-61ca76d9-ddadf0d2-601d957e"],resolve,reject)}));break;case SupportedLocales.Hungarian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.hu-7fa01d3c-a864095a-7b6aabdf"],resolve,reject)}));break;case SupportedLocales.Indonesian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.id-6801fef5-56d34b5e-e913b9cd"],resolve,reject)}));break;case SupportedLocales.Italian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.it-568c2b04-817f6e26-f940078a"],resolve,reject)}));break;case SupportedLocales.Japanese:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ja-6042d3af-c76450b2-4ded7c57"],resolve,reject)}));break;case SupportedLocales.Korean:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ko-4d01f228-fa522d19-dae6bec2"],resolve,reject)}));break;case SupportedLocales.Lithuanian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.lt-7f94cd9d-a8765c78-e6a8521e"],resolve,reject)}));break;case SupportedLocales.Latvian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.lv-0223c6ae-e87e5f50-ce5ed667"],resolve,reject)}));break;case SupportedLocales.NorwegianBokml:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.nb-1f800b8b-560eaaa6-bee8de21"],resolve,reject)}));break;case SupportedLocales.Dutch:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.nl-dd20c6e1-25d5f4a6-42e7aba2"],resolve,reject)}));break;case SupportedLocales.Polish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.pl-e71d8c8e-00ab0f1d-72b9eca5"],resolve,reject)}));break;case SupportedLocales.PortugueseBrazil:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.pt-BR-6cdb50a3-a18ab931-a4763035"],resolve,reject)}));break;case SupportedLocales.PortuguesePortugal:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.pt-PT-6b3866f5-ebf06039-4facc845"],resolve,reject)}));break;case SupportedLocales.Romanian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ro-86e7cba9-d4c8d6a2-06349efc"],resolve,reject)}));break;case SupportedLocales.Russian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ru-23cdd703-c3cdda0a-de688fc7"],resolve,reject)}));break;case SupportedLocales.Serbian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sr-fad84a78-d22f27be-956451e2"],resolve,reject)}));break;case SupportedLocales.Slovak:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sk-3b14f765-25690031-b3624a0c"],resolve,reject)}));break;case SupportedLocales.Slovenian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sl-e900baaf-eca6555a-55e071c1"],resolve,reject)}));break;case SupportedLocales.Swedish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sv-4613eae2-34db6f33-68d400f1"],resolve,reject)}));break;case SupportedLocales.Thai:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.th-5732c8a4-9920e4e0-b3888374"],resolve,reject)}));break;case SupportedLocales.Turkish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.tr-ccd64dcc-b4db56b1-9da4a030"],resolve,reject)}));break;case SupportedLocales.Ukrainian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.uk-e6c5f2f4-f9b80043-bfe92819"],resolve,reject)}));break;case SupportedLocales.Vietnamese:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.vi-3f1e30b4-091aee60-2ffe0b4a"],resolve,reject)}));break;case SupportedLocales.ChineseChina:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.zh-CN-8e563d8f-16f78c33-252bc1bf"],resolve,reject)}));break;case SupportedLocales.ChineseHongKong:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.zh-HK-23eb2505-deff0e0d-be89713e"],resolve,reject)}));break;case SupportedLocales.ChineseTaiwan:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.zh-TW-4017c011-d5202fc0-2e785921"],resolve,reject)}));break}return strings}async function throwError(errorKey,cause){const errorStrings=await fetchErrorsStrings();const errorMessage=errorStrings[errorKey];throw new ArcgisWebAnalysisError(errorKey,errorMessage??errorStrings.defaultError,{type:CLIENT_THROWN_ERROR},cause)}memoize$2((featColl=>{const inputArgument={};let layerDefinition;if(featColl.featureSet!==undefined){inputArgument.source=FeatureSet__default["default"].fromJSON(featColl.featureSet).features;layerDefinition=featColl.layerDefinition;if(layerDefinition.fields!==undefined){inputArgument.fields=layerDefinition.fields.map((field=>Field__default["default"].fromJSON(field)))}if(layerDefinition.objectIdField!==undefined)inputArgument.objectIdField=layerDefinition.objectIdField;if(layerDefinition.geometryType!==undefined){let type="point";switch(layerDefinition.geometryType){case"esriGeometryMultipoint":type="multipoint";break;case"esriGeometryPoint":type="point";break;case"esriGeometryPolygon":type="polygon";break;case"esriGeometryPolyline":type="polyline";break}inputArgument.geometryType=type}if(layerDefinition.spatialReference!==undefined)inputArgument.spatialReference=layerDefinition.spatialReference;if(layerDefinition.drawingInfo?.renderer!==undefined)inputArgument.renderer=Renderer__default["default"].fromJSON(layerDefinition.drawingInfo.renderer)}return new FeatureLayer__default["default"](inputArgument)}));memoize$2((async(serverUrl,portalUrl)=>{let status=false;const url=window.location.href;if(url.includes("://localhost:")===true||portalUrl===undefined){status=true}else{const serviceUrl=`${serverUrl}${serverUrl.indexOf("?")>-1?"&":"?"}f=json`;esriConfig__default["default"].request.proxyUrl=`${portalUrl}/sharing/proxy`;try{const response=await request(serviceUrl,{useProxy:true});status=isEmptyDataItem(response.data)===false}catch(exception){status=false}}return status===true?serverUrl:undefined}));function formatAnalysisEngineSuffix(analysisEngine){analysisEngine??(analysisEngine=AnalysisEngine$1.Standard);let analysisEngineSuffix="";switch(analysisEngine){case AnalysisEngine$1.Raster:analysisEngineSuffix="_ra";break;default:case AnalysisEngine$1.GeoAnalytics:case AnalysisEngine$1.Standard:analysisEngineSuffix="";break}return analysisEngineSuffix}memoize$2((async path=>{const{locale,name,assetPrefix,analysisEngine,memoizedHelper}=path;const lowercaseToolName=`${name.toLowerCase()}${formatAnalysisEngineSuffix(analysisEngine)}`;let toolUIJson;let toolT9n;let commonT9n;let toolJson;const toolPath=`${assetPrefix}/tool-ui-json/${lowercaseToolName}.tool.ui.json`;const toolJSONPath=`${assetPrefix}/tool-json/${lowercaseToolName}.tool.json`;const t9nPath=`${assetPrefix}/t9n/${lowercaseToolName}/${lowercaseToolName}.t9n.${locale}.json`;const commonT9nPath=`${assetPrefix}/t9n/common.t9n.${locale}.json`;let helpLocale=locale;if(locale===SupportedLocales.English||locale===SupportedLocales.EnglishUSA){helpLocale=""}else if(helpLocale===SupportedLocales.NorwegianBokml){helpLocale="no"}const toolHelpFilePath=`${assetPrefix}/help/${helpLocale!==""?helpLocale+"/":""}${name}${formatAnalysisEngineSuffix(analysisEngine)}.html`;try{toolJson=await memoizedHelper(toolJSONPath);toolUIJson=await memoizedHelper(toolPath);toolT9n=await memoizedHelper(t9nPath);commonT9n=await memoizedHelper(commonT9nPath);toolT9n={...commonT9n,...toolT9n}}catch{toolUIJson=undefined}return{toolJson,toolUIJson,toolT9n,toolHelpFilePath}}));function replaceSpacesWithUnderscores(value){return value.replace(/\s/g,"_")}function replaceTag(tag){const tagsToReplace={"&":"&amp;","<":"&lt;",">":"&gt;"};return tagsToReplace[tag]||tag}function safeTagsReplace(str){return str.replace(/[<>]/g,replaceTag)}function buildProcessInfoReport(messagesArray,t9nMessageCodes={}){let formattedReport="";messagesArray.forEach((report=>{const messageObject=JSON.parse(report);const{message,messageCode,params,style}=messageObject;if(Array.isArray(message)){const substitutionKeys={};let currentMessage=style;message.forEach(((singleMessage,index)=>{const messageCodeKey=`${messageCode}_${index}`;currentMessage=currentMessage.replace("></",">${"+messageCodeKey+"}</");let localizedMessage=t9nMessageCodes[messageCodeKey]!==undefined?t9nMessageCodes[messageCodeKey]:singleMessage;localizedMessage=formatMessage(localizedMessage,params);localizedMessage=safeTagsReplace(localizedMessage);substitutionKeys[messageCodeKey]=`${localizedMessage}`}));formattedReport+=formatMessage(currentMessage,substitutionKeys)}else{let localizedMessage=t9nMessageCodes[messageCode]!==undefined?t9nMessageCodes[messageCode]:message;localizedMessage=formatMessage(localizedMessage,params);const firstClosingTag=style.indexOf("</");formattedReport+=`${style.substring(0,firstClosingTag)}${localizedMessage}${style.substring(firstClosingTag)}`}}));return formattedReport}function isAdmin(user){return user.role?.includes("admin")??false}function isPublisher(user){return user.role?.includes("publisher")??false}function checkUserAccess(user){let hasAccess=true;if(isEmptyDataItem(user?.orgId)===true){hasAccess=false}else{hasAccess=isAdmin(user)||isPublisher(user)}return hasAccess}memoize$1$1((async portal=>{const{url:portalUrl}=portal;const url=`${portalUrl}/sharing/rest/community/self`;const credential=esriId__default["default"].findCredential(url);let token;if(credential!==undefined){token=credential.token}const options={query:{returnUserLicensedItems:true,token,f:"json"}};try{const{data:{userLicensedItems}}=await request(url,options);return[...userLicensedItems.map((({entitlements})=>entitlements))].flat()}catch(e){await throwError(ErrorKeywords.NetworkError)}return[]}),{serializer:args=>`${args.user.username}`});memoize$1$1((async layer=>{let processedProperties={isMultidimensional:false};const mutlidimensionalInfo=layer.type==="imagery-tile"?layer.rasterInfo.multidimensionalInfo:layer.multidimensionalInfo;const multidimensionalSubset=layer.multidimensionalSubset;if(mutlidimensionalInfo!==undefined&&mutlidimensionalInfo!==null){const variables=multidimensionalSubset!==null&&multidimensionalSubset!==undefined?layer.getMultidimensionalSubsetVariables():mutlidimensionalInfo.variables;if(variables!==undefined&&variables.length>0){const dimensions=[];const variableFields=[];const dimensionVariables={};const dimensionValues={};const dimensionVariableDatasets={};const dimensionMinValues={};const dimensionMaxValues={};const dimensionMinValuesWithLabels={};const dimensionMaxValuesWithLabels={};variables.forEach(((variable,vidx)=>{let dimensionsDescription="";const variableName=variable.name;variable.dimensions.forEach(((dimension,index)=>{const dimensionName=dimension.name;if(dimensions.indexOf(dimensionName)===-1){dimensions.push(dimensionName)}const dimensionDescription=index>0?`,${dimensionName}=${dimension.values?.length}`:`${dimensionName}=${dimension.values?.length}`;dimensionsDescription=dimensionsDescription.concat(dimensionDescription);if(index===0){dimensionValues[variableName]={}}if(dimensionVariables[dimensionName]===undefined){dimensionVariables[dimensionName]=[]}dimensionValues[variableName][dimensionName]=dimension.values;if(vidx===0){const values=dimension.values;if(values!==undefined){if(dimensionName==="StdTime"&&(dimension.unit===undefined||dimension.unit==="ISO8601")){const dimMinValues=[];const dimMaxValues=[];const dimMinValuesWithLabels={};const dimMaxValuesWithLabels={};values.forEach((value=>{if(typeof value==="number"){const date=new Date(value);const label=date.toLocaleString();const val=date.toISOString();dimMinValues.push(val);dimMaxValues.push(val);dimMinValuesWithLabels[val]=label;dimMaxValuesWithLabels[val]=label}else if(Array.isArray(value)){const d1=new Date(value[0]);const d2=new Date(value[1]);const val1=d1.toISOString();const val2=d2.toISOString();dimMinValues.push(val1);dimMaxValues.push(val2);dimMinValuesWithLabels[val1]=d1.toLocaleString();dimMaxValuesWithLabels[val2]=d2.toLocaleString()}}));dimensionMinValues[dimensionName]=dimMinValues;dimensionMaxValues[dimensionName]=dimMaxValues;dimensionMinValuesWithLabels[dimensionName]=dimMinValuesWithLabels;dimensionMaxValuesWithLabels[dimensionName]=dimMaxValuesWithLabels}else{if(Array.isArray(values)&&typeof values[0]==="number"){dimensionMinValues[dimensionName]=dimensionMaxValues[dimensionName]=values.map(String)}else if(Array.isArray(values[0])&&Array.isArray(values[1])){dimensionMinValues[dimensionName]=values[0].map(String);dimensionMaxValues[dimensionName]=values[1].map(String)}}}}dimensionVariables[dimensionName].push(variableName)}));variableFields.push({name:variableName,alias:`${variableName}[${dimensionsDescription}](${variable.description})`,type:"string"})}));for(const key in dimensionVariables){const filteredFields=variableFields.filter((variableKey=>dimensionVariables[key].indexOf(variableKey.name)>-1));dimensionVariableDatasets[key]={id:"1",name:key,description:"DimensionVariables",getFields:()=>Promise.resolve(filteredFields)}}const variablesDataset={id:"1",name:"Variables",description:"Variables",getFields:()=>Promise.resolve(variableFields)};processedProperties={isMultidimensional:true,dimensions,dimensionVariableDatasets,dimensionValues,variablesDataset,dimensionMinValues,dimensionMaxValues,dimensionMinValuesWithLabels,dimensionMaxValuesWithLabels}}}const rasterInfo=layer.type==="imagery"?await layer.generateRasterInfo(layer.renderingRule):layer.rasterInfo;processedProperties.rasterInfo=rasterInfo;return processedProperties}));const analyzeGeocodeInput=async params=>{const{asyncGeocodeUrl}=params;const jobInfo=await geoprocessor__namespace.submitJob(`${asyncGeocodeUrl}/AnalyzeGeocodeInput`,{...omit$1(params,"asyncGeocodeUrl"),f:"json"});try{await jobInfo.waitForJobCompletion();const result=await jobInfo.fetchResultData("geocodeParameters");return result.value}catch(err){console.error("AnalyzeGeocodeInput failed");throw err}};memoize$1$1(((itemId,portal)=>new PortalItem__default["default"]({id:itemId,portal})),{serializer:args=>`${args[0]}-${args[1]?.url}`});async function updateItemProperties(itemId,newProperties){const resultItem=new PortalItem__default["default"]({id:itemId});const loadedPortalItem=await resultItem.load();let updatedPortalItem=Object.assign(loadedPortalItem,newProperties);updatedPortalItem=await updatedPortalItem.update();return updatedPortalItem}memoize$1$1((async portal=>{const{restUrl}=portal;const url=`${restUrl}/portals/helpmap`;let helpMap;try{const fetchPortalHelpMap=await request$1__default["default"](url,{query:{f:"json"},responseType:"json",method:"auto"});helpMap=await(fetchPortalHelpMap.data?.helpMap)??undefined}catch(e){helpMap=undefined}return helpMap}),{serializer:args=>`${args[0]}-${args[1]?.url}`});const AnalysisToolExecutionType={Asynchronous:"esriExecutionTypeAsynchronous",Synchronous:"esriExecutionTypeSynchronous"};const AnalysisEngine$2={Standard:"standard",GeoAnalytics:"geoanalytics",Raster:"raster",Pipelines:"pipelines",Session:"session"};var src={exports:{}};function memoize(fn,options){var cache=options&&options.cache?options.cache:cacheDefault;var serializer=options&&options.serializer?options.serializer:serializerDefault;var strategy=options&&options.strategy?options.strategy:strategyDefault;return strategy(fn,{cache,serializer})}function isPrimitive(value){return value==null||typeof value==="number"||typeof value==="boolean"}function monadic(fn,cache,serializer,arg){var cacheKey=isPrimitive(arg)?arg:serializer(arg);var computedValue=cache.get(cacheKey);if(typeof computedValue==="undefined"){computedValue=fn.call(this,arg);cache.set(cacheKey,computedValue)}return computedValue}function variadic(fn,cache,serializer){var args=Array.prototype.slice.call(arguments,3);var cacheKey=serializer(args);var computedValue=cache.get(cacheKey);if(typeof computedValue==="undefined"){computedValue=fn.apply(this,args);cache.set(cacheKey,computedValue)}return computedValue}function assemble(fn,context,strategy,cache,serialize){return strategy.bind(context,fn,cache,serialize)}function strategyDefault(fn,options){var strategy=fn.length===1?monadic:variadic;return assemble(fn,this,strategy,options.cache.create(),options.serializer)}function strategyVariadic(fn,options){var strategy=variadic;return assemble(fn,this,strategy,options.cache.create(),options.serializer)}function strategyMonadic(fn,options){var strategy=monadic;return assemble(fn,this,strategy,options.cache.create(),options.serializer)}function serializerDefault(){return JSON.stringify(arguments)}function ObjectWithoutPrototypeCache(){this.cache=Object.create(null)}ObjectWithoutPrototypeCache.prototype.has=function(key){return key in this.cache};ObjectWithoutPrototypeCache.prototype.get=function(key){return this.cache[key]};ObjectWithoutPrototypeCache.prototype.set=function(key,value){this.cache[key]=value};var cacheDefault={create:function create(){return new ObjectWithoutPrototypeCache}};src.exports=memoize;src.exports.strategies={variadic:strategyVariadic,monadic:strategyMonadic};var memoize$1=src.exports;function getAnalysisServer(engine,portal,isGeocode=false){let analysisServer=portal.helperServices.analysis.url;switch(engine){case AnalysisEngine$2.GeoAnalytics:{analysisServer=portal.helperServices.geoanalytics.url;break}case AnalysisEngine$2.Raster:{analysisServer=portal.helperServices.rasterAnalytics.url;break}case AnalysisEngine$2.Standard:{analysisServer=isGeocode?portal.helperServices.asyncGeocode.url:portal.helperServices.analysis.url;break}}return analysisServer}const serializerFunction=args=>{const modifiedArgs=Array.from(args).map((param=>{let modifiedParam;if(typeof param==="object"&&param.id!==undefined){modifiedParam=param.id}else{modifiedParam=param}return modifiedParam}));return JSON.stringify(modifiedArgs)};const getToolInfoJson=memoize$1((async(toolName,engine,portal)=>{const analysisServer=getAnalysisServer(engine,portal,toolName==="BatchGeocode");const toolUrl=`${analysisServer}/${toolName}?f=json`;const response=await request$1__default["default"](toolUrl,{responseType:"json",authMode:"no-prompt"});const toolJson=await response.data;toolJson.parameters?.forEach((param=>{if(param.defaultValue===null){param.defaultValue=undefined}}));return toolJson}),{serializer:serializerFunction});const getToolInfoJsonsByEngine=memoize$1((async(engine,portal)=>{const analysisServer=getAnalysisServer(engine,portal);const response=await request$1__default["default"](`${analysisServer}?f=json`,{responseType:"json"});const{data:{tasks}}=response;const toolPromises=tasks.map((toolName=>getToolInfoJson(toolName,engine,portal)));const toolResponses=await Promise.all(toolPromises);return toolResponses}),{serializer:serializerFunction});memoize$1((async(portal,engine)=>{let toolResponses=[];if(engine!==undefined){toolResponses=await getToolInfoJsonsByEngine(engine,portal)}else{toolResponses=[...await getToolInfoJsonsByEngine(AnalysisEngine$2.Standard,portal),...await getToolInfoJsonsByEngine(AnalysisEngine$2.Raster,portal),...await getToolInfoJsonsByEngine(AnalysisEngine$2.GeoAnalytics,portal)]}return new Map(toolResponses.map((toolJson=>[toolJson.name.toLowerCase(),toolJson])))}),{serializer:serializerFunction});const getTravelModes=memoize$1((async portal=>{const{helperServices}=portal;let travelModeInfo;if(helperServices.routingUtilities!==undefined){const response=await geoprocessor__namespace.execute(`${helperServices.routingUtilities.url}/GetTravelModes?f=json`);const{results:[{value:{features}},{value:defaultTravelModeId}]}=response;const travelModes=features.map((feature=>JSON.parse(feature.attributes.TravelMode)));travelModeInfo={travelModes,defaultTravelModeId}}return travelModeInfo}),{serializer:serializerFunction});const getServiceInfoByUrl=memoize$1((async serviceUrl=>{const response=await request$1__default["default"](`${serviceUrl}?f=json`,{responseType:"json"});return response.data}));const getToolInfoJsonByUrl=memoize$1((async(serverUrl,toolName)=>{const toolUrl=`${serverUrl}/${toolName}?f=json`;const response=await request$1__default["default"](toolUrl,{responseType:"json",authMode:"no-prompt"});const toolJson=await(response?.data);if(toolJson?.parameters!==undefined){toolJson.parameters?.forEach((param=>{if(param.defaultValue===null){param.defaultValue=undefined}}))}return toolJson}));memoize$1((async serverUrl=>{const response=await request$1__default["default"](`${serverUrl}?f=json`,{responseType:"json"});const{data:{tasks}}=response;const toolPromises=tasks.map((toolName=>getToolInfoJsonByUrl(serverUrl,toolName)));const toolResponses=await Promise.all(toolPromises);return toolResponses}));const getWebToolInfo=memoize$1((async(serverUrl,toolName)=>{let toolJson;let serviceInfoJson;try{toolJson=await getToolInfoJsonByUrl(serverUrl,toolName);serviceInfoJson=await getServiceInfoByUrl(serverUrl)}catch(exception){throw new ArcgisWebAnalysisError(ErrorKeywords.WebToolFailedFetch,"WebTool JSON failed to fetch.")}toolJson.serviceInfo=serviceInfoJson;return{...toolJson,...{serviceInfo:serviceInfoJson}}}));const AnalysisCoreEvents={ResultDataComplete:"analysisCoreResultDataComplete",JobStatus:"analysisCoreJobStatus",CreditEstimateComplete:"creditEstimateComplete"};function generateEventInit(eventPayload){return{detail:eventPayload,composed:true,cancelable:true,bubbles:true}}function notifyResultData(htmlContainer,data){htmlContainer.dispatchEvent(new window.CustomEvent(AnalysisCoreEvents.ResultDataComplete,generateEventInit(data)))}function notifyJobStatus(htmlContainer,data){htmlContainer.dispatchEvent(new window.CustomEvent(AnalysisCoreEvents.JobStatus,generateEventInit(data)))}function notifyCreditEstimate(htmlContainer,data){htmlContainer.dispatchEvent(new window.CustomEvent(AnalysisCoreEvents.CreditEstimateComplete,generateEventInit(data)))}const ZeroCreditTools=[{toolName:"CreateViewshed",analysisEngine:AnalysisEngine$2.Standard},{toolName:"CreateWatersheds",analysisEngine:AnalysisEngine$2.Standard},{toolName:"TraceDownstream",analysisEngine:AnalysisEngine$2.Standard}];async function getCreditsEstimate(props){const{portal,jobParams,analysisEngine,toolName:taskName,toolElement:parentComponent}=props;const analysisServer=getAnalysisServer(analysisEngine??AnalysisEngine$2.Standard,portal,taskName==="BatchGeocode");let results=[];const matchingZeroCreditTool=ZeroCreditTools.find((tool=>tool.toolName===taskName&&tool.analysisEngine===analysisEngine));if(matchingZeroCreditTool!==undefined){results=[{dateType:"string",value:{cost:0,totalRecords:0}}]}else{let estimatorUrl="";switch(analysisEngine){case AnalysisEngine$2.Raster:{estimatorUrl=analysisServer+"/EstimateRasterAnalysisCost";break}case AnalysisEngine$2.Standard:{estimatorUrl=analysisServer.replace("tasks/GPServer","Estimate/GPServer/EstimateCredits");break}}const taskParameters={};for(const key in jobParams){if(typeof jobParams[key]==="object"&&jobParams[key]!==undefined){taskParameters[key]=JSON.stringify(jobParams[key])}else{taskParameters[key]=jobParams[key]}}const estimateJobParams=analysisEngine===AnalysisEngine$2.Raster?{inputAnalysisTask:{name:taskName,parameters:taskParameters}}:{taskName,taskParameters};const estimateToolJsonResponse=await request$1__default["default"](`${estimatorUrl}?f=json`,{responseType:"json"});const estimateToolJson=estimateToolJsonResponse.data;const resultParameters=estimateToolJson?.parameters?.filter((param=>param.direction==="esriGPParameterDirectionOutput"));let response;switch(estimateToolJson.executionType){case AnalysisToolExecutionType.Synchronous:{response=await geoprocessor.execute(estimatorUrl,estimateJobParams);results=response.results;break}case AnalysisToolExecutionType.Asynchronous:{const jobInfo=await geoprocessor__namespace.submitJob(estimatorUrl,estimateJobParams);const options={interval:1500,statusCallback:j=>{notifyJobStatus(parentComponent,{jobInfo:j})}};await jobInfo.waitForJobCompletion(options);const resultPromises=resultParameters?.map((param=>jobInfo.fetchResultData(param.name)));results=await Promise.all(resultPromises);break}}}if(parentComponent!==undefined){notifyCreditEstimate(parentComponent,results)}return results}function isAnalysisCreditInfo(parameterValue){const isObject=typeof parameterValue==="object"&&parameterValue!==null;const hasBasicProperties=isObject&&"totalRecords"in parameterValue&&("maximumCost"in parameterValue||"cost"in parameterValue);const hasAdvancedProperties=isObject&&"credits"in parameterValue&&"functions"in parameterValue&&Array.isArray(parameterValue.functions)&&parameterValue.functions.every((func=>{const isFuncObject=typeof func==="object"&&func!==null;return isFuncObject&&"name"in func&&"costFactor"in func&&"gigaPixels"in func}));return isObject&&(hasBasicProperties||hasAdvancedProperties)}function parseCreditEstimate(creditResults){const creditInfo=isAnalysisCreditInfo(creditResults?.[0]?.value)?creditResults[0].value:undefined;const estimatedCredits=creditInfo?.maximumCost??creditInfo?.cost??creditInfo?.credits;const result=Number.isNaN(estimatedCredits)?undefined:estimatedCredits;return result}function creditThresholdCheck(creditEstimate,creditThreshold){const shouldRun=creditThreshold!==undefined&&creditEstimate!==undefined?creditEstimate<=creditThreshold:true;return shouldRun}function hasEnoughCredits(estimatedCredits,user){let hasCredits=true;if(user.sourceJSON.availableCredits!==undefined){if(estimatedCredits!==undefined){hasCredits=user.sourceJSON.availableCredits>estimatedCredits}}return hasCredits}const validOutputNameCharactersPattern=/^[\p{L}\p{N}_][\p{L}\p{N}_\s]*[\p{L}\p{N}_]$/u;function getOutputServiceNames(outputNameParams,jobParams){const serviceNames=[];outputNameParams.forEach((outputNameParam=>{if(outputNameParam in jobParams){const outputName=JSON.parse(jobParams[outputNameParam]);const serviceName=outputName?.serviceProperties?.name??outputName?.itemProperties?.title??undefined;if(serviceName!==undefined){serviceNames.push(serviceName)}}}));if("esri_out_feature_service_name"in jobParams&&typeof jobParams.esri_out_feature_service_name==="string"){serviceNames.push(jobParams.esri_out_feature_service_name)}return serviceNames}async function checkServiceName(props){const{portal:{url:portalUrl,id},itemType}=props;const{serviceName}=props;const url=`${portalUrl}/sharing/rest/portals/${id}/isServiceNameAvailable?f=json`;const options={query:{f:"json",name:serviceName,type:itemType}};let isAvailable=true;try{const response=await request$1__default["default"](url,options);isAvailable=response.data.available}catch(e){await throwError(ErrorKeywords.NetworkError)}return isAvailable}function outputNameValidation(outputServiceNames){const isOutputNameValid=outputServiceNames.every((outputServiceName=>validOutputNameCharactersPattern.test(outputServiceName)));return isOutputNameValid}async function addProcessInfoToItems(results,processInfo){const itemUpdatePromises=[];results.forEach((result=>{const hasItemId=typeof result.value==="object"&&"itemId"in result.value&&!isEmptyDataItem(result.value.itemId);if(hasItemId&&processInfo!==undefined){const itemId=result.value.itemId;itemUpdatePromises.push(updateItemProperties(itemId,{description:processInfo}))}}));await Promise.all(itemUpdatePromises)}async function execute(params){const{portal}=params;const{jobParamsPayload,jobParams,toolUiParameters,toolName,analysisEngine,analysisType,resultParams,containerElement,gpMessages,webToolServerUrl,executionType,creditCheckOptions}=params;let canDoAnalysis=checkUserAccess(portal.user);const hasServiceProperties=Object.keys(jobParamsPayload).some((paramName=>{const paramValue=jobParamsPayload[paramName];return typeof paramValue==="string"&&paramValue.includes("serviceProperties")}));const outputNameParams=Object.keys(jobParamsPayload).filter((paramName=>{const paramValue=jobParamsPayload[paramName];return typeof paramValue==="string"&&(paramValue.includes("serviceProperties")||paramValue.includes("itemProperties"))}));const outputServiceNames=getOutputServiceNames(outputNameParams,jobParamsPayload);const isOutputServiceNameValid=outputNameValidation(outputServiceNames);if(isOutputServiceNameValid===false){await throwError(ErrorKeywords.SpecialCharactersInServiceNameError)}if(hasServiceProperties){const checkServiceNamePromises=outputServiceNames.map((serviceName=>{const formattedServiceName=portal.isPortal?replaceSpacesWithUnderscores(serviceName):serviceName;return checkServiceName({portal,serviceName:formattedServiceName,itemType:analysisEngine===AnalysisEngine$2.Raster&&(toolUiParameters.resultType===undefined||toolUiParameters.resultType!=="FEATURE_LAYER")?AnalysisSupportedItemTypes.ImageService:AnalysisSupportedItemTypes.FeatureService})}));const resolvedServiceNameChecks=await Promise.all(checkServiceNamePromises);canDoAnalysis=!resolvedServiceNameChecks.some((checks=>checks===false));if(canDoAnalysis===false){await throwError(ErrorKeywords.ServiceNameExistsError)}}const{skipCreditChecks=false,creditThreshold}=creditCheckOptions??{};if(skipCreditChecks===false&&webToolServerUrl===undefined&&(params.analysisEngine===AnalysisEngine$2.Standard||params.analysisEngine===AnalysisEngine$2.Raster)){const creditResults=await getCreditsEstimate({toolName:params.toolName,portal,jobParams:params.jobParamsPayload,analysisEngine:params.analysisEngine,toolElement:params.containerElement});const estimatedCredits=parseCreditEstimate(creditResults);canDoAnalysis=hasEnoughCredits(estimatedCredits,portal.user);if(canDoAnalysis===false){await throwError(ErrorKeywords.InsufficientCreditsError)}canDoAnalysis=creditThresholdCheck(estimatedCredits,creditThreshold);if(canDoAnalysis===false){await throwError(ErrorKeywords.CreditThresholdExceededError,{estimatedCredits,creditThreshold})}}if(canDoAnalysis===true){const analysisServer=webToolServerUrl===undefined?getAnalysisServer(analysisEngine,portal,toolName==="BatchGeocode"):webToolServerUrl;const toolUrl=`${analysisServer}/${toolName}?f=json`;if(executionType===AnalysisToolExecutionType.Synchronous){const response=await geoprocessor__namespace.execute(toolUrl,jobParams);const results=response.results;const jobInfoSync=JobInfo__default["default"].fromJSON({messages:response.messages});notifyJobStatus(containerElement,{jobInfo:jobInfoSync,submissionData:{toolName,analysisEngine,analysisType,jobParams,toolUiParameters}});notifyResultData(containerElement,{results,jobInfo:jobInfoSync})}else{const jobInfo=await geoprocessor__namespace.submitJob(toolUrl,jobParamsPayload);notifyJobStatus(containerElement,{jobInfo,submissionData:{toolName,analysisEngine,analysisType,jobParams,toolUiParameters,webToolServerUrl}});const options={interval:1500,statusCallback:j=>{notifyJobStatus(containerElement,{jobInfo:j})}};try{await jobInfo.waitForJobCompletion(options);let processInfo;if(resultParams.includes("processInfo")===true){try{const processInfoParamValue=await jobInfo.fetchResultData("processInfo");processInfo=buildProcessInfoReport(processInfoParamValue.value,gpMessages);const indexToDelete=resultParams.indexOf("processInfo");resultParams.splice(indexToDelete,1)}catch{}}const resultPromises=resultParams.map((resultParam=>jobInfo.fetchResultData(resultParam)));const allResults=await Promise.allSettled(resultPromises);const results=allResults.filter((res=>res.status==="fulfilled")).map((fulfilledRes=>fulfilledRes.value));addProcessInfoToItems(results,processInfo);notifyResultData(containerElement,{results,jobInfo})}catch(e){notifyJobStatus(containerElement,{jobInfo})}}}}const AnalysisEngine={Standard:"standard",GeoAnalytics:"geoanalytics",Raster:"raster",Pipelines:"pipelines",Session:"session"};const AnalysisType={Tool:"tool",RasterFunction:"rft",WebTool:"webTool"};const HTMLClasses={creditBlock:"credit-block",estimateCreditButton:"estimate-credit-button",estimatedCredits:"estimated-credits",credits:"credits",loader:"loader",errorMessage:"error-message",hide:"hide",infoButton:"info-button",rtl:"analysis--rtl"};const ESTIMATE_CREDITS_PARAMETER_ERROR="estimateCreditsCurrentParameters";const analysisToolCreditsCss=":host{display:flex;width:100%}.credit-block{display:flex;justify-content:center;width:100%;margin:0;background-color:var(--calcite-color-foreground-1)}.estimate-credit-button{padding:12px 0}.estimated-credits{width:100%;display:flex;justify-content:space-between;align-items:center}.credits{display:flex;align-items:center}.loader{padding:var(--analysis-quarter-spacing);margin-left:3.75rem;margin-right:0rem;margin-top:0.75rem}.error-message{padding-bottom:1rem}.hide{display:none}.info-button{margin-left:1rem;margin-right:0rem}:host(.analysis--rtl) .loader{margin-left:0rem;margin-right:3.75rem}:host(.analysis--rtl) .info-button{margin-left:0rem;margin-right:1rem}";const AnalysisToolCredits=index2.proxyCustomElement(class AnalysisToolCredits extends index2.H{constructor(){super();this.__registerHost();this.__attachShadow();this.analysisToolCreditsValidationFailure=index2.createEvent(this,"analysisToolCreditsValidationFailure",7);this.estimateCredits=async()=>{this.onCreditsPopoverClose();const toolElement=this.toolElement;const toolValidity=await(toolElement?.validateTool());const toolSettingsElementValidity=await(this.toolSettingsElement?.validateSettings());if(toolValidity?.valid===false||toolSettingsElementValidity?.valid===false){const allErrorKeys=Array.from(new Set([...toolValidity?.errorKeys,...toolSettingsElementValidity?.errorKeys]));allErrorKeys?.forEach(((errorKey,index)=>{if(errorKey===index2.DEFAULT_ERROR_KEY){allErrorKeys[index]=index2.DEFAULT_CREDIT_ERROR_KEY}}));const toolInformation={valid:false,errorKeys:allErrorKeys};this.analysisToolCreditsValidationFailure.emit(toolInformation);this.errorMessage=this.strings.creditsEstimationFailed;return}this.errorMessage=undefined;this.estimatingCredits=true;this.isInformationMessage=false;if(this.toolJson!==undefined){const jobParams=index2.getJobParams(this.toolJson,toolElement?.toolData);const calculatedJobParams=index2.calculateParameterValues(jobParams);const jobParamsWithContext=store.addContextToJobParams(calculatedJobParams,this.toolName,toolElement?.toolData);const jobParamsPayload=index2.prepJobParamsForSubmission({jobParams:jobParamsWithContext,toolData:toolElement?.toolData??{},toolUIJson:toolElement?.toolUIJson?.UIparameters??[],toolName:this.toolName});let validity={valid:true,errorKeys:[]};try{await getCreditsEstimate({toolName:this.toolName,portal:this.portal,jobParams:jobParamsPayload,analysisEngine:this.analysisEngine,toolElement:this.hostElement})}catch(exception){this.errorMessage=this.strings.creditsEstimationFailed;validity={valid:false,errorKeys:[ESTIMATE_CREDITS_PARAMETER_ERROR]}}this.analysisToolCreditsValidationFailure.emit(validity);this.estimatingCredits=false;this.creditsEstimated=true}};this.estimateRFxCredits=async()=>{this.onCreditsPopoverClose();const toolElement=this.toolElement;const toolValidity=await(toolElement?.validateRFx());const toolSettingsElementValidity=await(this.toolSettingsElement?.validateSettings());const toolOutputElementValidity=await(this.toolOutputElement?.validateRFxOutput());if(toolSettingsElementValidity?.valid===false||toolValidity?.valid===false||toolOutputElementValidity?.valid===false){const allErrorKeys=Array.from(new Set([...toolSettingsElementValidity?.errorKeys,...toolValidity?.errorStrings,...toolOutputElementValidity?.errorKeys]));allErrorKeys?.forEach(((errorKey,index)=>{if(errorKey===index2.DEFAULT_ERROR_KEY){allErrorKeys[index]=index2.DEFAULT_CREDIT_ERROR_KEY}}));const toolInformation={valid:false,errorKeys:allErrorKeys};this.analysisToolCreditsValidationFailure.emit(toolInformation);this.errorMessage=this.strings.creditsEstimationFailed;return}this.errorMessage=undefined;this.estimatingCredits=true;this.isInformationMessage=false;const outputRFT=await(toolElement?.getUpdatedRFTWithValues());const outputName=await(this.toolOutputElement?.getOutputParameters());const calculatedJobParams={rasterFunction:outputRFT,outputName};if(calculatedJobParams!==undefined){const jobParamsWithContext=store.addContextToJobParams(calculatedJobParams,this.toolName,undefined);const jobParamsPayload={};Object.keys(jobParamsWithContext).forEach((param=>jobParamsPayload[param]=JSON.stringify(jobParamsWithContext[param])));let validity={valid:true,errorKeys:[]};try{await getCreditsEstimate({toolName:"GenerateRaster",portal:this.portal,jobParams:jobParamsPayload,analysisEngine:this.analysisEngine,toolElement:this.hostElement})}catch(exception){this.errorMessage=this.strings.creditsEstimationFailed;validity={valid:false,errorKeys:[ESTIMATE_CREDITS_PARAMETER_ERROR]}}this.analysisToolCreditsValidationFailure.emit(validity);this.estimatingCredits=false;this.creditsEstimated=true}};this.createCreditsPopover=()=>{if(this.creditsPopover===undefined){this.creditsPopover=document.createElement("analysis-tool-credits-popover");this.creditsPopover.addEventListener("creditsPopoverClose",this.onCreditsPopoverClose)}this.creditsPopover.referenceElement=this.popoverActionElement;this.creditsPopover.numberOfInputFeatures=this.numberOfInputFeatures;this.creditsPopover.creditsPerFeature=this.creditsPerFeature;this.creditsPopover.estimatedCredits=this.estimatedCredits;this.creditsPopover.creditsRemaining=this.creditsRemaining;if(document.body.contains(this.creditsPopover)===false){document.body.appendChild(this.creditsPopover);this.creditsPopover.open=true}};this.onCreditsPopoverClose=()=>{if(this.creditsPopover!==undefined){this.creditsPopover.open=false;this.creditsPopover.remove()}};this.renderErrorMessage=()=>index2.h("calcite-input-message",{status:this.isInformationMessage?index2.UIInputStatus.IDLE:index2.UIInputStatus.INVALID,icon:this.isInformationMessage?"information":"exclamationMarkTriangle",hidden:this.errorMessage===undefined},this.errorMessage);this.numberOfInputFeatures=undefined;this.creditsPerFeature=undefined;this.estimatedCredits=undefined;this.creditsRemaining=undefined;this.estimatingCredits=false;this.creditsEstimated=false;this.errorMessage=undefined;this.isInformationMessage=false;this.analysisEngine=undefined;this.toolJson=undefined;this.toolName=undefined;this.toolSettingsElement=undefined;this.toolElement=undefined;this.portal=undefined;this.analysisType=undefined;this.toolOutputElement=undefined}disconnectedCallback(){this.onCreditsPopoverClose()}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await index2.fetchComponentLocaleStrings(this.hostElement,index2.getAssetPath(`.`)))}async clearCreditsEstimation(){this.numberOfInputFeatures=undefined;this.creditsPerFeature=undefined;this.estimatedCredits=undefined;this.creditsRemaining=undefined;this.errorMessage=undefined;this.estimatingCredits=false;this.creditsEstimated=false;this.isInformationMessage=false;return Promise.resolve()}onCreditEstimateComplete(e){this.creditsPerFeature=undefined;this.creditsRemaining=undefined;if(e.detail!==undefined&&e.detail.length>0){const creditInfo=e.detail[0].value;this.estimatedCredits=creditInfo.maximumCost??creditInfo.cost??creditInfo.credits;const isZeroCreditTool=ZeroCreditTools.find((tool=>tool.toolName===this.toolName&&tool.analysisEngine===this.analysisEngine));if(isZeroCreditTool){creditInfo.totalRecords=0;this.isInformationMessage=true;this.errorMessage=this.strings.zeroCreditsMessage}this.numberOfInputFeatures=creditInfo.totalRecords}this.estimatingCredits=false;this.creditsEstimated=true}renderCreditsEstimated(){return this.creditsEstimated?index2.h("div",null,index2.h("div",{class:HTMLClasses.estimatedCredits},index2.h("div",null,this.strings.estimatedCredits),index2.h("div",{class:HTMLClasses.credits},this.errorMessage===undefined&&this.estimatingCredits===false&&index2.h("calcite-button",{class:HTMLClasses.infoButton,ref:el=>{this.popoverActionElement=el},appearance:"outline","icon-start":"information",round:true,disabled:this.estimatingCredits,onClick:this.createCreditsPopover},index2.formatNumberToLocale(this.estimatedCredits)),index2.h("calcite-action",{class:this.estimatingCredits===true?HTMLClasses.hide:"",onClick:this.analysisType===AnalysisType.RasterFunction?this.estimateRFxCredits:this.estimateCredits,text:"refresh",appearance:"transparent",icon:"refresh"}),index2.h("calcite-loader",{style:{display:this.estimatingCredits===false?"none":undefined},label:this.strings.loader,class:HTMLClasses.loader,inline:true}))),index2.h("div",{class:HTMLClasses.errorMessage},this.errorMessage!==undefined?this.renderErrorMessage():null)):null}render(){return index2.h(index2.Host,{class:{[HTMLClasses.rtl]:this.dir==="rtl"}},index2.h("div",{class:HTMLClasses.creditBlock},!this.creditsEstimated&&index2.h("calcite-button",{alignment:"center",round:true,appearance:"transparent",onClick:this.analysisType===AnalysisType.RasterFunction?this.estimateRFxCredits:this.estimateCredits,loading:this.estimatingCredits,class:HTMLClasses.estimateCreditButton},this.creditsEstimated?this.strings.estimatedCredits:this.strings.estimateCredits),this.renderCreditsEstimated()))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get style(){return analysisToolCreditsCss}},[1,"analysis-tool-credits",{analysisEngine:[513,"analysis-engine"],toolJson:[16],toolName:[513,"tool-name"],toolSettingsElement:[16],toolElement:[16],portal:[16],analysisType:[1,"analysis-type"],toolOutputElement:[16],numberOfInputFeatures:[32],creditsPerFeature:[32],estimatedCredits:[32],creditsRemaining:[32],estimatingCredits:[32],creditsEstimated:[32],errorMessage:[32],isInformationMessage:[32],clearCreditsEstimation:[64]},[[0,"creditEstimateComplete","onCreditEstimateComplete"]]]);function defineCustomElement(){if(typeof customElements==="undefined"){return}const components=["analysis-tool-credits","analysis-tool-credits-popover"];components.forEach((tagName=>{switch(tagName){case"analysis-tool-credits":if(!customElements.get(tagName)){customElements.define(tagName,AnalysisToolCredits)}break;case"analysis-tool-credits-popover":if(!customElements.get(tagName)){analysisToolCreditsPopover2.defineCustomElement()}break}}))}defineCustomElement();exports.AnalysisEngine=AnalysisEngine;exports.AnalysisToolCredits=AnalysisToolCredits;exports.AnalysisType=AnalysisType;exports.defineCustomElement=defineCustomElement;exports.execute=execute;exports.getTravelModes=getTravelModes;exports.getWebToolInfo=getWebToolInfo}));
