define(["require","exports","./index2-0f07feca","esri/rest/support/JobInfo","esri/rest/geoprocessor","esri/request","esri/rest/support/ParameterValue","esri/core/urlUtils","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/identity/IdentityManager","esri/core/reactiveUtils","esri/rest/support/Query","esri/core/promiseUtils","esri/portal/PortalItemResource","esri/layers/FeatureLayer","esri/geometry/support/jsonUtils","esri/layers/Layer","esri/portal/PortalItem","esri/layers/support/Field","esri/renderers/Renderer","esri/rest/support/FeatureSet","esri/config","esri/smartMapping/statistics/uniqueValues","esri/core/sql","./store-f16d23c6","./analysis-tool-credits-popover2-de3db736"],(function(e,t,r,n,o,i,a,s,c,u,l,f,d,p,h,y,b,v,m,g,w,j,_,P,E,S,O,C){"use strict";function T(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var A=T(n),k=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}(o),I=T(i),x=T(f),$=T(b),R=T(g),F=T(w),z=T(j),N=T(_),U=T(P),M="object"==typeof global&&global&&global.Object===Object&&global,L="object"==typeof self&&self&&self.Object===Object&&self,D=M||L||Function("return this")(),J=D.Symbol,V=Object.prototype,G=V.hasOwnProperty,B=V.toString,K=J?J.toStringTag:void 0,H=Object.prototype.toString,W="[object Null]",q="[object Undefined]",Y=J?J.toStringTag:void 0;function Q(e){return null==e?void 0===e?q:W:Y&&Y in Object(e)?function(e){var t=G.call(e,K),r=e[K];try{e[K]=void 0;var n=!0}catch(e){}var o=B.call(e);return n&&(t?e[K]=r:delete e[K]),o}(e):function(e){return H.call(e)}(e)}function X(e){return null!=e&&"object"==typeof e}var Z="[object Symbol]";function ee(e){return"symbol"==typeof e||X(e)&&Q(e)==Z}function te(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var re=Array.isArray,ne=1/0,oe=J?J.prototype:void 0,ie=oe?oe.toString:void 0;function ae(e){if("string"==typeof e)return e;if(re(e))return te(e,ae)+"";if(ee(e))return ie?ie.call(e):"";var t=e+"";return"0"==t&&1/e==-ne?"-0":t}function se(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ce(e){return e}var ue="[object AsyncFunction]",le="[object Function]",fe="[object GeneratorFunction]",de="[object Proxy]";function pe(e){if(!se(e))return!1;var t=Q(e);return t==le||t==fe||t==ue||t==de}var he,ye=D["__core-js_shared__"],be=(he=/[^.]+$/.exec(ye&&ye.keys&&ye.keys.IE_PROTO||""))?"Symbol(src)_1."+he:"",ve=Function.prototype.toString;function me(e){if(null!=e){try{return ve.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ge=/^\[object .+?Constructor\]$/,we=Function.prototype,je=Object.prototype,_e=we.toString,Pe=je.hasOwnProperty,Ee=RegExp("^"+_e.call(Pe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Se(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!se(e)||(t=e,be&&be in t))&&(pe(e)?Ee:ge).test(me(e));var t}(r)?r:void 0}var Oe=Se(D,"WeakMap"),Ce=Object.create,Te=function(){function e(){}return function(t){if(!se(t))return{};if(Ce)return Ce(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Ae=Te;function ke(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Ie=Date.now;function xe(e){return function(){return e}}var $e,Re,Fe,ze=function(){try{var e=Se(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ne=ze,Ue=Ne?function(e,t){return Ne(e,"toString",{configurable:!0,enumerable:!1,value:xe(t),writable:!0})}:ce,Me=($e=Ue,Re=0,Fe=0,function(){var e=Ie(),t=16-(e-Fe);if(Fe=e,t>0){if(++Re>=800)return arguments[0]}else Re=0;return $e.apply(void 0,arguments)}),Le=Me;function De(e){return e!=e}function Je(e,t){return!(null==e||!e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}(e,t):function(e,t,r,n){for(var o=e.length,i=-1;++i<o;)if(t(e[i],i,e))return i;return-1}(e,De)}(e,t)>-1}var Ve=9007199254740991,Ge=/^(?:0|[1-9]\d*)$/;function Be(e,t){var r=typeof e;return!!(t=null==t?Ve:t)&&("number"==r||"symbol"!=r&&Ge.test(e))&&e>-1&&e%1==0&&e<t}function Ke(e,t,r){"__proto__"==t&&Ne?Ne(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function He(e,t){return e===t||e!=e&&t!=t}var We=Object.prototype.hasOwnProperty;function qe(e,t,r){var n=e[t];We.call(e,t)&&He(n,r)&&(void 0!==r||t in e)||Ke(e,t,r)}function Ye(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=n?n(r[s],e[s],s,r,e):void 0;void 0===c&&(c=e[s]),o?Ke(r,s,c):qe(r,s,c)}return r}var Qe=Math.max;function Xe(e,t,r){return t=Qe(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=Qe(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),ke(e,this,s)}}function Ze(e,t){return Le(Xe(e,t,ce),e+"")}var et=9007199254740991;function tt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=et}function rt(e){return null!=e&&tt(e.length)&&!pe(e)}function nt(e,t,r){if(!se(r))return!1;var n=typeof t;return!!("number"==n?rt(r)&&Be(t,r.length):"string"==n&&t in r)&&He(r[t],e)}function ot(e){return Ze((function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&nt(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t}))}var it=Object.prototype;function at(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||it)}function st(e){return X(e)&&"[object Arguments]"==Q(e)}var ct=Object.prototype,ut=ct.hasOwnProperty,lt=ct.propertyIsEnumerable,ft=st(function(){return arguments}())?st:function(e){return X(e)&&ut.call(e,"callee")&&!lt.call(e,"callee")},dt=ft,pt="object"==typeof t&&t&&!t.nodeType&&t,ht=pt&&"object"==typeof module&&module&&!module.nodeType&&module,yt=ht&&ht.exports===pt?D.Buffer:void 0,bt=(yt?yt.isBuffer:void 0)||function(){return!1},vt={};function mt(e){return function(t){return e(t)}}vt["[object Float32Array]"]=vt["[object Float64Array]"]=vt["[object Int8Array]"]=vt["[object Int16Array]"]=vt["[object Int32Array]"]=vt["[object Uint8Array]"]=vt["[object Uint8ClampedArray]"]=vt["[object Uint16Array]"]=vt["[object Uint32Array]"]=!0,vt["[object Arguments]"]=vt["[object Array]"]=vt["[object ArrayBuffer]"]=vt["[object Boolean]"]=vt["[object DataView]"]=vt["[object Date]"]=vt["[object Error]"]=vt["[object Function]"]=vt["[object Map]"]=vt["[object Number]"]=vt["[object Object]"]=vt["[object RegExp]"]=vt["[object Set]"]=vt["[object String]"]=vt["[object WeakMap]"]=!1;var gt="object"==typeof t&&t&&!t.nodeType&&t,wt=gt&&"object"==typeof module&&module&&!module.nodeType&&module,jt=wt&&wt.exports===gt&&M.process,_t=function(){try{return wt&&wt.require&&wt.require("util").types||jt&&jt.binding&&jt.binding("util")}catch(e){}}(),Pt=_t&&_t.isTypedArray,Et=Pt?mt(Pt):function(e){return X(e)&&tt(e.length)&&!!vt[Q(e)]},St=Et,Ot=Object.prototype.hasOwnProperty;function Ct(e,t){var r=re(e),n=!r&&dt(e),o=!r&&!n&&bt(e),i=!r&&!n&&!o&&St(e),a=r||n||o||i,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=s.length;for(var u in e)!t&&!Ot.call(e,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Be(u,c))||s.push(u);return s}function Tt(e,t){return function(r){return e(t(r))}}var At=Tt(Object.keys,Object),kt=Object.prototype.hasOwnProperty;function It(e){if(!at(e))return At(e);var t=[];for(var r in Object(e))kt.call(e,r)&&"constructor"!=r&&t.push(r);return t}function xt(e){return rt(e)?Ct(e):It(e)}var $t=Object.prototype.hasOwnProperty;ot((function(e,t){if(at(t)||rt(t))Ye(t,xt(t),e);else for(var r in t)$t.call(t,r)&&qe(e,r,t[r])}));var Rt=Object.prototype.hasOwnProperty;function Ft(e){return rt(e)?Ct(e,!0):function(e){if(!se(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=at(e),r=[];for(var n in e)("constructor"!=n||!t&&Rt.call(e,n))&&r.push(n);return r}(e)}var zt=ot((function(e,t,r,n){Ye(t,Ft(t),e,n)})),Nt=zt,Ut=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mt=/^\w*$/;function Lt(e,t){if(re(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!ee(e))||Mt.test(e)||!Ut.test(e)||null!=t&&e in Object(t)}var Dt=Se(Object,"create"),Jt=Object.prototype.hasOwnProperty,Vt=Object.prototype.hasOwnProperty;function Gt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Bt(e,t){for(var r=e.length;r--;)if(He(e[r][0],t))return r;return-1}Gt.prototype.clear=function(){this.__data__=Dt?Dt(null):{},this.size=0},Gt.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Gt.prototype.get=function(e){var t=this.__data__;if(Dt){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Jt.call(t,e)?t[e]:void 0},Gt.prototype.has=function(e){var t=this.__data__;return Dt?void 0!==t[e]:Vt.call(t,e)},Gt.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Dt&&void 0===t?"__lodash_hash_undefined__":t,this};var Kt=Array.prototype.splice;function Ht(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ht.prototype.clear=function(){this.__data__=[],this.size=0},Ht.prototype.delete=function(e){var t=this.__data__,r=Bt(t,e);return!(r<0||(r==t.length-1?t.pop():Kt.call(t,r,1),--this.size,0))},Ht.prototype.get=function(e){var t=this.__data__,r=Bt(t,e);return r<0?void 0:t[r][1]},Ht.prototype.has=function(e){return Bt(this.__data__,e)>-1},Ht.prototype.set=function(e,t){var r=this.__data__,n=Bt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var Wt=Se(D,"Map");function qt(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Yt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Yt.prototype.clear=function(){this.size=0,this.__data__={hash:new Gt,map:new(Wt||Ht),string:new Gt}},Yt.prototype.delete=function(e){var t=qt(this,e).delete(e);return this.size-=t?1:0,t},Yt.prototype.get=function(e){return qt(this,e).get(e)},Yt.prototype.has=function(e){return qt(this,e).has(e)},Yt.prototype.set=function(e,t){var r=qt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Qt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Qt.Cache||Yt),r}Qt.Cache=Yt;var Xt,Zt,er=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tr=/\\(\\)?/g,rr=(Xt=Qt((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(er,(function(e,r,n,o){t.push(n?o.replace(tr,"$1"):r||e)})),t}),(function(e){return 500===Zt.size&&Zt.clear(),e})),Zt=Xt.cache,Xt);function nr(e){return null==e?"":ae(e)}function or(e,t){return re(e)?e:Lt(e,t)?[e]:rr(nr(e))}var ir=1/0;function ar(e){if("string"==typeof e||ee(e))return e;var t=e+"";return"0"==t&&1/e==-ir?"-0":t}function sr(e,t){for(var r=0,n=(t=or(t,e)).length;null!=e&&r<n;)e=e[ar(t[r++])];return r&&r==n?e:void 0}function cr(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var ur=J?J.isConcatSpreadable:void 0;function lr(e){return re(e)||dt(e)||!!(ur&&e&&e[ur])}function fr(e,t,r,n,o){var i=-1,a=e.length;for(r||(r=lr),o||(o=[]);++i<a;){var s=e[i];t>0&&r(s)?t>1?fr(s,t-1,r,n,o):cr(o,s):n||(o[o.length]=s)}return o}function dr(e){return null!=e&&e.length?fr(e,1):[]}function pr(e){return Le(Xe(e,void 0,dr),e+"")}var hr=Tt(Object.getPrototypeOf,Object),yr="[object Object]",br=Function.prototype,vr=Object.prototype,mr=br.toString,gr=vr.hasOwnProperty,wr=mr.call(Object);function jr(e){if(!X(e)||Q(e)!=yr)return!1;var t=hr(e);if(null===t)return!0;var r=gr.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&mr.call(r)==wr}var _r="[object DOMException]",Pr="[object Error]";function Er(e){if(!X(e))return!1;var t=Q(e);return t==Pr||t==_r||"string"==typeof e.message&&"string"==typeof e.name&&!jr(e)}var Sr=Ze((function(e,t){try{return ke(e,void 0,t)}catch(e){return Er(e)?e:new Error(e)}})),Or=Sr;function Cr(e){var t=this.__data__=new Ht(e);this.size=t.size}Cr.prototype.clear=function(){this.__data__=new Ht,this.size=0},Cr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Cr.prototype.get=function(e){return this.__data__.get(e)},Cr.prototype.has=function(e){return this.__data__.has(e)},Cr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ht){var n=r.__data__;if(!Wt||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Yt(n)}return r.set(e,t),this.size=r.size,this};var Tr="object"==typeof t&&t&&!t.nodeType&&t,Ar=Tr&&"object"==typeof module&&module&&!module.nodeType&&module,kr=Ar&&Ar.exports===Tr?D.Buffer:void 0,Ir=kr?kr.allocUnsafe:void 0;function xr(){return[]}var $r=Object.prototype.propertyIsEnumerable,Rr=Object.getOwnPropertySymbols,Fr=Rr?function(e){return null==e?[]:(e=Object(e),function(t,r){for(var n=-1,o=null==t?0:t.length,i=0,a=[];++n<o;){var s=t[n];c=s,$r.call(e,c)&&(a[i++]=s)}var c;return a}(Rr(e)))}:xr,zr=Fr,Nr=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)cr(t,zr(e)),e=hr(e);return t}:xr,Ur=Nr;function Mr(e,t,r){var n=t(e);return re(e)?n:cr(n,r(e))}function Lr(e){return Mr(e,xt,zr)}function Dr(e){return Mr(e,Ft,Ur)}var Jr=Se(D,"DataView"),Vr=Se(D,"Promise"),Gr=Se(D,"Set"),Br="[object Map]",Kr="[object Promise]",Hr="[object Set]",Wr="[object WeakMap]",qr="[object DataView]",Yr=me(Jr),Qr=me(Wt),Xr=me(Vr),Zr=me(Gr),en=me(Oe),tn=Q;(Jr&&tn(new Jr(new ArrayBuffer(1)))!=qr||Wt&&tn(new Wt)!=Br||Vr&&tn(Vr.resolve())!=Kr||Gr&&tn(new Gr)!=Hr||Oe&&tn(new Oe)!=Wr)&&(tn=function(e){var t=Q(e),r="[object Object]"==t?e.constructor:void 0,n=r?me(r):"";if(n)switch(n){case Yr:return qr;case Qr:return Br;case Xr:return Kr;case Zr:return Hr;case en:return Wr}return t});var rn=tn,nn=Object.prototype.hasOwnProperty,on=D.Uint8Array;function an(e){var t=new e.constructor(e.byteLength);return new on(t).set(new on(e)),t}var sn=/\w*$/,cn=J?J.prototype:void 0,un=cn?cn.valueOf:void 0,ln="[object Boolean]",fn="[object Date]",dn="[object Map]",pn="[object Number]",hn="[object RegExp]",yn="[object Set]",bn="[object String]",vn="[object Symbol]",mn="[object ArrayBuffer]",gn="[object DataView]",wn="[object Float32Array]",jn="[object Float64Array]",_n="[object Int8Array]",Pn="[object Int16Array]",En="[object Int32Array]",Sn="[object Uint8Array]",On="[object Uint8ClampedArray]",Cn="[object Uint16Array]",Tn="[object Uint32Array]";var An=_t&&_t.isMap,kn=An?mt(An):function(e){return X(e)&&"[object Map]"==rn(e)},In=kn,xn=_t&&_t.isSet,$n=xn?mt(xn):function(e){return X(e)&&"[object Set]"==rn(e)},Rn=$n,Fn="[object Arguments]",zn="[object Function]",Nn="[object Object]",Un={};function Mn(e,t,r,n,o,i){var a,s=1&t,c=2&t,u=4&t;if(r&&(a=o?r(e,n,o,i):r(e)),void 0!==a)return a;if(!se(e))return e;var l=re(e);if(l){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&nn.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!s)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(e,a)}else{var f=rn(e),d=f==zn||"[object GeneratorFunction]"==f;if(bt(e))return function(e,t){if(t)return e.slice();var r=e.length,n=Ir?Ir(r):new e.constructor(r);return e.copy(n),n}(e,s);if(f==Nn||f==Fn||d&&!o){if(a=c||d?{}:function(e){return"function"!=typeof e.constructor||at(e)?{}:Ae(hr(e))}(e),!s)return c?function(e,t){return Ye(e,Ur(e),t)}(e,function(e,t){return e&&Ye(t,Ft(t),e)}(a,e)):function(e,t){return Ye(e,zr(e),t)}(e,function(e,t){return e&&Ye(t,xt(t),e)}(a,e))}else{if(!Un[f])return o?e:{};a=function(e,t,r){var n,o,i,a=e.constructor;switch(t){case mn:return an(e);case ln:case fn:return new a(+e);case gn:return function(e,t){var r=t?an(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case wn:case jn:case _n:case Pn:case En:case Sn:case On:case Cn:case Tn:return function(e,t){var r=t?an(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,r);case dn:return new a;case pn:case bn:return new a(e);case hn:return(i=new(o=e).constructor(o.source,sn.exec(o))).lastIndex=o.lastIndex,i;case yn:return new a;case vn:return n=e,un?Object(un.call(n)):{}}}(e,f,s)}}i||(i=new Cr);var p=i.get(e);if(p)return p;i.set(e,a),Rn(e)?e.forEach((function(n){a.add(Mn(n,t,r,n,e,i))})):In(e)&&e.forEach((function(n,o){a.set(o,Mn(n,t,r,o,e,i))}));var h=l?void 0:(u?c?Dr:Lr:c?Ft:xt)(e);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r););}(h||e,(function(n,o){h&&(n=e[o=n]),qe(a,o,Mn(n,t,r,o,e,i))})),a}function Ln(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Yt;++t<r;)this.add(e[t])}function Dn(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function Jn(e,t){return e.has(t)}Un[Fn]=Un["[object Array]"]=Un["[object ArrayBuffer]"]=Un["[object DataView]"]=Un["[object Boolean]"]=Un["[object Date]"]=Un["[object Float32Array]"]=Un["[object Float64Array]"]=Un["[object Int8Array]"]=Un["[object Int16Array]"]=Un["[object Int32Array]"]=Un["[object Map]"]=Un["[object Number]"]=Un[Nn]=Un["[object RegExp]"]=Un["[object Set]"]=Un["[object String]"]=Un["[object Symbol]"]=Un["[object Uint8Array]"]=Un["[object Uint8ClampedArray]"]=Un["[object Uint16Array]"]=Un["[object Uint32Array]"]=!0,Un["[object Error]"]=Un[zn]=Un["[object WeakMap]"]=!1,Ln.prototype.add=Ln.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ln.prototype.has=function(e){return this.__data__.has(e)};var Vn=1,Gn=2;function Bn(e,t,r,n,o,i){var a=r&Vn,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=i.get(e),l=i.get(t);if(u&&l)return u==t&&l==e;var f=-1,d=!0,p=r&Gn?new Ln:void 0;for(i.set(e,t),i.set(t,e);++f<s;){var h=e[f],y=t[f];if(n)var b=a?n(y,h,f,t,e,i):n(h,y,f,e,t,i);if(void 0!==b){if(b)continue;d=!1;break}if(p){if(!Dn(t,(function(e,t){if(!Jn(p,t)&&(h===e||o(h,e,r,n,i)))return p.push(t)}))){d=!1;break}}else if(h!==y&&!o(h,y,r,n,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function Kn(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function Hn(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var Wn=1,qn=2,Yn="[object Boolean]",Qn="[object Date]",Xn="[object Error]",Zn="[object Map]",eo="[object Number]",to="[object RegExp]",ro="[object Set]",no="[object String]",oo="[object Symbol]",io="[object ArrayBuffer]",ao="[object DataView]",so=J?J.prototype:void 0,co=so?so.valueOf:void 0,uo=1,lo=Object.prototype.hasOwnProperty,fo=1,po="[object Arguments]",ho="[object Array]",yo="[object Object]",bo=Object.prototype.hasOwnProperty;function vo(e,t,r,n,o){return e===t||(null==e||null==t||!X(e)&&!X(t)?e!=e&&t!=t:function(e,t,r,n,o,i){var a=re(e),s=re(t),c=a?ho:rn(e),u=s?ho:rn(t),l=(c=c==po?yo:c)==yo,f=(u=u==po?yo:u)==yo,d=c==u;if(d&&bt(e)){if(!bt(t))return!1;a=!0,l=!1}if(d&&!l)return i||(i=new Cr),a||St(e)?Bn(e,t,r,n,o,i):function(e,t,r,n,o,i,a){switch(r){case ao:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case io:return!(e.byteLength!=t.byteLength||!i(new on(e),new on(t)));case Yn:case Qn:case eo:return He(+e,+t);case Xn:return e.name==t.name&&e.message==t.message;case to:case no:return e==t+"";case Zn:var s=Kn;case ro:var c=n&Wn;if(s||(s=Hn),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;n|=qn,a.set(e,t);var l=Bn(s(e),s(t),n,o,i,a);return a.delete(e),l;case oo:if(co)return co.call(e)==co.call(t)}return!1}(e,t,c,r,n,o,i);if(!(r&fo)){var p=l&&bo.call(e,"__wrapped__"),h=f&&bo.call(t,"__wrapped__");if(p||h){var y=p?e.value():e,b=h?t.value():t;return i||(i=new Cr),o(y,b,r,n,i)}}return!!d&&(i||(i=new Cr),function(e,t,r,n,o,i){var a=r&uo,s=Lr(e),c=s.length;if(c!=Lr(t).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in t:lo.call(t,l)))return!1}var f=i.get(e),d=i.get(t);if(f&&d)return f==t&&d==e;var p=!0;i.set(e,t),i.set(t,e);for(var h=a;++u<c;){var y=e[l=s[u]],b=t[l];if(n)var v=a?n(b,y,l,t,e,i):n(y,b,l,e,t,i);if(!(void 0===v?y===b||o(y,b,r,n,i):v)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var m=e.constructor,g=t.constructor;m==g||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof g&&g instanceof g||(p=!1)}return i.delete(e),i.delete(t),p}(e,t,r,n,o,i))}(e,t,r,n,vo,o))}var mo=1,go=2;function wo(e){return e==e&&!se(e)}function jo(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}function _o(e,t){return null!=e&&t in Object(e)}function Po(e,t){return null!=e&&function(e,t,r){for(var n=-1,o=(t=or(t,e)).length,i=!1;++n<o;){var a=ar(t[n]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&tt(o)&&Be(a,o)&&(re(e)||dt(e))}(e,t,_o)}var Eo=1,So=2;function Oo(e){return"function"==typeof e?e:null==e?ce:"object"==typeof e?re(e)?(n=e[0],o=e[1],Lt(n)&&wo(o)?jo(ar(n),o):function(e){var t=function(e,t,r){var n=null==e?void 0:sr(e,t);return void 0===n?void 0:n}(e,n);return void 0===t&&t===o?Po(e,n):vo(o,t,Eo|So)}):(r=function(e){for(var t=xt(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,wo(o)]}return t}(t=e),1==r.length&&r[0][2]?jo(r[0][0],r[0][1]):function(e){return e===t||function(e,t,r,n){var o=r.length,i=o;if(null==e)return!i;for(e=Object(e);o--;){var a=r[o];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var s=(a=r[o])[0],c=e[s],u=a[1];if(a[2]){if(void 0===c&&!(s in e))return!1}else{var l,f=new Cr;if(!(void 0===l?vo(u,c,mo|go,n,f):l))return!1}}return!0}(e,0,r)}):function(e){return Lt(e)?(t=ar(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return sr(t,e)}}(e);var t}(e);var t,r,n,o}function Co(e){return X(e)&&rt(e)}function To(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Ao,ko=(Ao={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},function(e){return null==Ao?void 0:Ao[e]}),Io=/[&<>"']/g,xo=RegExp(Io.source),$o=Math.min;function Ro(e){return Co(e)?e:[]}Ze((function(e){var t=To(e),r=te(e,Ro);return t===To(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?function(e,t,r){for(var n=Je,o=e[0].length,i=e.length,a=i,s=Array(i),c=1/0,u=[];a--;){var l=e[a];a&&t&&(l=te(l,mt(t))),c=$o(l.length,c),s[a]=t||o>=120&&l.length>=120?new Ln(a&&l):void 0}l=e[0];var f=-1,d=s[0];e:for(;++f<o&&u.length<c;){var p=l[f],h=t?t(p):p;if(p=0!==p?p:0,!(d?Jn(d,h):n(u,h,r))){for(a=i;--a;){var y=s[a];if(!(y?Jn(y,h):n(e[a],h,r)))continue e}d&&d.push(h),u.push(p)}}return u}(r,Oo(t)):[]}));var Fo="[object Map]",zo="[object Set]",No=Object.prototype.hasOwnProperty;function Uo(e,t){return null==(e=function(e,t){return t.length<2?e:sr(e,function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}(t,0,-1))}(e,t=or(t,e)))||delete e[ar(To(t))]}function Mo(e){return jr(e)?void 0:e}var Lo=pr((function(e,t){var r={};if(null==e)return r;var n=!1;t=te(t,(function(t){return t=or(t,e),n||(n=t.length>1),t})),Ye(e,Dr(e),r),n&&(r=Mn(r,7,Mo));for(var o=t.length;o--;)Uo(r,t[o]);return r})),Do=Lo;function Jo(e,t,r,n){if(!se(e))return e;for(var o=-1,i=(t=or(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var c=ar(t[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var l=s[c];void 0===(u=n?n(l,c,s):void 0)&&(u=se(l)?l:Be(t[o+1])?[]:{})}qe(s,c,u),s=s[c]}return e}pr((function(e,t){return null==e?{}:function(e,t){return function(e,t,r){for(var n=-1,o=t.length,i={};++n<o;){var a=t[n],s=sr(e,a);r(0,a)&&Jo(i,or(a,e),s)}return i}(e,t,(function(t,r){return Po(e,r)}))}(e,t)}));var Vo=Object.prototype,Go=Vo.hasOwnProperty;function Bo(e,t,r,n){return void 0===e||He(e,Vo[r])&&!Go.call(n,r)?t:e}var Ko={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Ho(e){return"\\"+Ko[e]}var Wo=/<%=([\s\S]+?)%>/g,qo={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Wo,variable:"",imports:{_:{escape:function(e){return(e=nr(e))&&xo.test(e)?e.replace(Io,ko):e}}}},Yo="Invalid `variable` option passed into `_.template`",Qo=/\b__p \+= '';/g,Xo=/\b(__p \+=) '' \+/g,Zo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ei=/[()=,{}\[\]\/\s]/,ti=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ri=/($^)/,ni=/['\n\r\u2028\u2029\\]/g,oi=Object.prototype.hasOwnProperty;var ii=Gr&&1/Hn(new Gr([,-0]))[1]==1/0?function(e){return new Gr(e)}:function(){};function ai(e){return null==e||"string"==typeof e&&""===e||jr(e)&&function(e){if(null==e)return!0;if(rt(e)&&(re(e)||"string"==typeof e||"function"==typeof e.splice||bt(e)||St(e)||dt(e)))return!e.length;var t=rn(e);if(t==Fo||t==zo)return!e.size;if(at(e))return!It(e).length;for(var r in e)if(No.call(e,r))return!1;return!0}(e)||Array.isArray(e)&&e.length<1||"object"==typeof e&&!1===re(e)&&function(e){let t=!0;if("object"==typeof e&&!1===re(e))for(const r in e){const n=e?.[r];if(!0===e.hasOwnProperty(r)&&null!=n&&""!==n){t=!1;break}}return t}(e)}async function si(e,t){return I.default(e,t)}Ze((function(e){var t=To(e);return Co(t)&&(t=void 0),function(e,t,r){var n=-1,o=Je,i=e.length,a=!0,s=[],c=s;if(i>=200){var u=t?null:ii(e);if(u)return Hn(u);a=!1,o=Jn,c=new Ln}else c=t?[]:s;e:for(;++n<i;){var l=e[n],f=t?t(l):l;if(l=0!==l?l:0,a&&f==f){for(var d=c.length;d--;)if(c[d]===f)continue e;t&&c.push(f),s.push(l)}else o(c,f,r)||(c!==s&&c.push(f),s.push(l))}return s}(fr(e,1,Co,!0),Oo(t))}));const ci={Arabic:"ar",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Czech:"cs",Danish:"da",German:"de",Greek:"el",English:"en",EnglishUSA:"en-US",Spanish:"es",Estonian:"et",Finnish:"fi",French:"fr",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Italian:"it",Japanese:"ja",Korean:"ko",Lithuanian:"lt",Latvian:"lv",NorwegianBokml:"nb",Dutch:"nl",Polish:"pl",PortugueseBrazil:"pt-BR",PortuguesePortugal:"pt-PT",Romanian:"ro",Russian:"ru",Serbian:"sr",Slovenian:"sl",Slovak:"sk",Swedish:"sv",Thai:"th",Turkish:"tr",Ukrainian:"uk",Vietnamese:"vi",ChineseChina:"zh-CN",ChineseHongKong:"zh-HK",ChineseTaiwan:"zh-TW"},ui=[...Object.values(ci),"ar-u-nu-latn","en-AU","en-GB","es-ES","es-MX","de-AT","de-CH","de-DE","it-CH","it-IT"],li=[ci.Arabic,ci.Hebrew];function fi(e,t){return function(e,t,r){var n=qo.imports._.templateSettings||qo;r&&nt(e,t,r)&&(t=void 0),e=nr(e),t=Nt({},t,n,Bo);var o,i,a=Nt({},t.imports,n.imports,Bo),s=xt(a),c=function(e,t){return te(t,(function(t){return e[t]}))}(a,s),u=0,l=t.interpolate||ri,f="__p += '",d=RegExp((t.escape||ri).source+"|"+l.source+"|"+(l===Wo?ti:ri).source+"|"+(t.evaluate||ri).source+"|$","g"),p=oi.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(d,(function(t,r,n,a,s,c){return n||(n=a),f+=e.slice(u,c).replace(ni,Ho),r&&(o=!0,f+="' +\n__e("+r+") +\n'"),s&&(i=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),f+="';\n";var h=oi.call(t,"variable")&&t.variable;if(h){if(ei.test(h))throw new Error(Yo)}else f="with (obj) {\n"+f+"\n}\n";f=(i?f.replace(Qo,""):f).replace(Xo,"$1").replace(Zo,"$1;"),f="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=Or((function(){return Function(s,p+"return "+f).apply(void 0,c)}));if(y.source=f,Er(y))throw y;return y}(e)(t)}function di(e=document.documentElement){const t=("[lang]",function e(t){let r;return r=void 0===t||t===document||t===window?null:t.closest("[lang]")||e(t.getRootNode().host),r}(e));const r=t?.lang??window.navigator.language,n=function(e){let t=ci.English;if(void 0!==e){const r=Object.values(ci),n=r.filter((e=>-1!==e.indexOf("-")));if(-1!==e.indexOf("-")){const[t,r]=e.split("-");e=`${t}-${r.toUpperCase()}`}if(!0===n.includes(e))t=e;else{const n=function(e){const t=e?.match(/^([a-z]{2})-([A-Z]{1,2})$/);let r=ci.English;return null!=t&&t?.length>1?r=t[1]:2===e?.length&&e.toLowerCase()===e&&(r=e),r}(e);!0===r.includes(n)&&(t=n)}}return t}(r),o=function(e){let t=ui.find((t=>t===e));if(void 0===t&&(t=e),void 0!==t&&-1!==t.indexOf("-")){const[e,r]=t.split("-");t=`${e}-${r.toUpperCase()}`}return"ar"===t&&(t="ar-u-nu-latn"),t}(r);return{locale:n,rtl:li.includes(n),formatLocale:o}}class pi extends Error{constructor(e,t,r,n){super(t),this.name=e,this.details=r,this.cause=n}}const hi="creditThresholdExceededError",yi="InsufficientCreditsError",bi="networkError",vi="serviceNameExistsError",mi="specialCharactersInServiceNameError",gi="webToolFailedFetch";var wi=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")},ji=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return wi()}try{return __global__||wi()}finally{delete Object.prototype.__global__}}(),_i="object"==typeof globalThis&&globalThis&&globalThis.Array===Array?globalThis:ji,Pi=_i,Ei={object:!0,symbol:!0},Si={exports:{}},Oi=function(e){return null!=e},Ci=Oi,Ti={object:!0,function:!0,undefined:!0},Ai=function(e){if(!function(e){return!!Ci(e)&&hasOwnProperty.call(Ti,typeof e)}(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}},ki=/^\s*class[\s{/}]/,Ii=Function.prototype.toString,xi=function(e){return null!=e},$i=xi,Ri=Object.keys,Fi=function(){try{return!0}catch(e){return!1}}()?Object.keys:function(e){return Ri($i(e)?Object(e):e)},zi=xi,Ni=Fi,Ui=Math.max,Mi=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}()?Object.assign:function(e,t){var r,n,o,i=Ui(arguments.length,2);for(e=Object(function(e){if(!zi(e))throw new TypeError("Cannot use null or undefined");return e}(e)),o=function(n){try{e[n]=t[n]}catch(e){r||(r=e)}},n=1;n<i;++n)Ni(t=arguments[n]).forEach(o);if(void 0!==r)throw r;return e},Li=xi,Di=Array.prototype.forEach,Ji=Object.create,Vi="razdwatrzy",Gi=String.prototype.indexOf,Bi="function"==typeof Vi.contains&&!0===Vi.contains("dwa")&&!1===Vi.contains("foo")?String.prototype.contains:function(e){return Gi.call(this,e,arguments[1])>-1},Ki=Oi,Hi=function(e){return!!function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!Ai(e)}(e)&&!ki.test(Ii.call(e))},Wi=Mi,qi=function(e){var t=Ji(null);return Di.call(arguments,(function(e){Li(e)&&function(e,t){var r;for(r in e)t[r]=e[r]}(Object(e),t)})),t},Yi=Bi,Qi=Si.exports=function(e,t){var r,n,o,i,a;return arguments.length<2||"string"!=typeof e?(i=t,t=e,e=null):i=arguments[2],Ki(e)?(r=Yi.call(e,"c"),n=Yi.call(e,"e"),o=Yi.call(e,"w")):(r=o=!0,n=!1),a={value:t,configurable:r,enumerable:n,writable:o},i?Wi(qi(i),a):a};Qi.gs=function(e,t,r){var n,o,i,a;return"string"!=typeof e?(i=r,r=t,t=e,e=null):i=arguments[3],Ki(t)?Hi(t)?Ki(r)?Hi(r)||(i=r,r=void 0):r=void 0:(i=t,t=r=void 0):t=void 0,Ki(e)?(n=Yi.call(e,"c"),o=Yi.call(e,"e")):(n=!0,o=!1),a={get:t,set:r,configurable:n,enumerable:o},i?Wi(qi(i),a):a};var Xi,Zi,ea,ta=function(e){if(!function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}(e))throw new TypeError(e+" is not a symbol");return e},ra=Si.exports,na=Object.create,oa=Object.defineProperty,ia=Object.prototype,aa=na(null),sa=Si.exports,ca=_i.Symbol,ua=Si.exports,la=ta,fa=Object.create(null),da=Si.exports,pa=ta,ha=_i.Symbol,ya=function(e){for(var t,r,n=0;aa[e+(n||"")];)++n;return aa[e+=n||""]=!0,oa(ia,t="@@"+e,ra.gs(null,(function(e){r||(r=!0,oa(this,t,ra(e)),r=!1)}))),t},ba=Object.create,va=Object.defineProperties,ma=Object.defineProperty;if("function"==typeof ha)try{String(ha()),ea=!0}catch(e){}else ha=null;Zi=function(e){if(this instanceof Zi)throw new TypeError("Symbol is not a constructor");return Xi(e)};var ga,wa=Xi=function e(t){var r;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return ea?ha(t):(r=ba(Zi.prototype),t=void 0===t?"":String(t),va(r,{__description__:da("",t),__name__:da("",ya(t))}))};(function(e){Object.defineProperties(e,{hasInstance:sa("",ca&&ca.hasInstance||e("hasInstance")),isConcatSpreadable:sa("",ca&&ca.isConcatSpreadable||e("isConcatSpreadable")),iterator:sa("",ca&&ca.iterator||e("iterator")),match:sa("",ca&&ca.match||e("match")),replace:sa("",ca&&ca.replace||e("replace")),search:sa("",ca&&ca.search||e("search")),species:sa("",ca&&ca.species||e("species")),split:sa("",ca&&ca.split||e("split")),toPrimitive:sa("",ca&&ca.toPrimitive||e("toPrimitive")),toStringTag:sa("",ca&&ca.toStringTag||e("toStringTag")),unscopables:sa("",ca&&ca.unscopables||e("unscopables"))})})(Xi),function(e){Object.defineProperties(e,{for:ua((function(t){return fa[t]?fa[t]:fa[t]=e(String(t))})),keyFor:ua((function(e){var t;for(t in la(e),fa)if(fa[t]===e)return t}))})}(Xi),va(Zi.prototype,{constructor:da(Xi),toString:da("",(function(){return this.__name__}))}),va(Xi.prototype,{toString:da((function(){return"Symbol ("+pa(this).__description__+")"})),valueOf:da((function(){return pa(this)}))}),ma(Xi.prototype,Xi.toPrimitive,da("",(function(){var e=pa(this);return"symbol"==typeof e?e:e.toString()}))),ma(Xi.prototype,Xi.toStringTag,da("c","Symbol")),ma(Zi.prototype,Xi.toStringTag,da("c",Xi.prototype[Xi.toStringTag])),ma(Zi.prototype,Xi.toPrimitive,da("c",Xi.prototype[Xi.toPrimitive])),("function"==typeof(ga=Pi.Symbol)&&(ga("test symbol"),Ei[typeof ga.iterator]&&Ei[typeof ga.toPrimitive]&&Ei[typeof ga.toStringTag])?_i.Symbol:wa)("-");var ja={exports:{}};function _a(e,t,r,n){var o=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(n)?n:r(n),i=t.get(o);return void 0===i&&(i=e.call(this,n),t.set(o,i)),i}function Pa(e,t,r){var n=Array.prototype.slice.call(arguments,3),o=r(n),i=t.get(o);return void 0===i&&(i=e.apply(this,n),t.set(o,i)),i}function Ea(e,t,r,n,o){return r.bind(t,e,n,o)}function Sa(e,t){return Ea(e,this,1===e.length?_a:Pa,t.cache.create(),t.serializer)}function Oa(){return JSON.stringify(arguments)}function Ca(){this.cache=Object.create(null)}Ca.prototype.has=function(e){return e in this.cache},Ca.prototype.get=function(e){return this.cache[e]},Ca.prototype.set=function(e,t){this.cache[e]=t};var Ta={create:function(){return new Ca}};ja.exports=function(e,t){var r=t&&t.cache?t.cache:Ta,n=t&&t.serializer?t.serializer:Oa;return(t&&t.strategy?t.strategy:Sa)(e,{cache:r,serializer:n})},ja.exports.strategies={variadic:function(e,t){return Ea(e,this,Pa,t.cache.create(),t.serializer)},monadic:function(e,t){return Ea(e,this,_a,t.cache.create(),t.serializer)}};var Aa=ja.exports;const ka=["SingleLine","Address","Address2","Address3","Neighborhood","City","Subregion","Region","Postal","PostalExt","CountryCode"];Aa((async e=>{const{geocodeServiceURL:t,locale:r}=e;let n;if(ai(t))n={ruleType:"expression",expression:"$[Data].geocodeServiceURL = NULL",destination:"sourceCountry",effectParams:{visible:!1}};else{let e,o;try{({data:{countries:e,detailedCountries:o}}=await si(`${t}?f=json`,{responseType:"json"}))}catch(e){throw console.error("Failed to get Locator info"),e}const i={};o.forEach((e=>{const t=e.localizedNames,n=r.length>2&&r;let o;if("boolean"!=typeof n&&(o=t[n]),void 0===o){const e=2===r.length?r.slice(0,2):r;if(o=t[e],void 0===o){const r=Object.keys(t).find((t=>t.startsWith(e)));void 0!==r&&(o=t[r])}}null!=o&&""!==o||(o=t[ci.English]??t[ci.EnglishUSA]),i[e.name]=o})),n={ruleType:"expression",expression:"$[Data].geocodeServiceURL NOT null",destination:"sourceCountry",effectParams:{visible:!0,choiceList:e,choiceListLabels:i}}}return n}),{serializer:e=>{const{geocodeServiceURL:t}=e;return t??"EMPTY_KEY"}}),Aa((async e=>{const{geocodeServiceURL:t,inputFileItem:r,inputTable:n}=e;let o,i;if(!(ai(t)||ai(r)&&ai(n))){let t,r;i=await Ra(e);try{t=JSON.parse(i.field_info),r=JSON.parse(i.field_mapping)}catch(e){throw console.error("Failed to parse result of AnalyzeGeocodeInput"),e}const n=t.map((e=>e[0])),a=n.reduce(((e,t)=>({...e,[t]:t})),{});o={ruleType:"expression",expression:"($[Data].geocodeServiceURL NOT null) AND (($[Data].inputTable NOT null) OR ($[Data].inputFileItem NOT null))",destination:"geocodeUIParameters",effectParams:ka.reduce(((e,t,o)=>{const i=r.find((e=>e[1]===t))?.[0];return{...e,[`UIparameterInfos[${o}].choiceList`]:n,[`UIparameterInfos[${o}].choiceListLabels`]:a,[`UIparameterInfos[${o}].defaultValue`]:i}}),{})}}return{addressFieldsRule:o,geocodeParameters:i}}),{serializer:e=>{const{geocodeServiceURL:t,inputFileItem:r,inputTable:n}=e,o=r?.itemid,i=n?.url;return ai(t)||ai(o)&&ai(i)?"EMPTY_KEY":`${t}${o}${i}`}});async function Ia(t,r){const n=await async function(t=di().locale){let r=await new Promise((function(t,r){e(["./errors.t9n.en-6cb15d51-6b6d9a9f-9eae65b2"],t,r)}));switch(t){case ci.Arabic:r=await new Promise((function(t,r){e(["./errors.t9n.ar-1b9d7225-1ecdb6c0-53c31cde"],t,r)}));break;case ci.Bosnian:r=await new Promise((function(t,r){e(["./errors.t9n.bs-377a5410-cdbaf960-2083c5aa"],t,r)}));break;case ci.Bulgarian:r=await new Promise((function(t,r){e(["./errors.t9n.bg-89d094b5-977ecfea-6e721500"],t,r)}));break;case ci.Catalan:r=await new Promise((function(t,r){e(["./errors.t9n.ca-b4c83c33-1bc59588-9b30d03c"],t,r)}));break;case ci.Czech:r=await new Promise((function(t,r){e(["./errors.t9n.cs-96fcf27d-9b9ab191-015cf419"],t,r)}));break;case ci.Danish:r=await new Promise((function(t,r){e(["./errors.t9n.da-cefe0c47-a25d4108-76cf0587"],t,r)}));break;case ci.German:r=await new Promise((function(t,r){e(["./errors.t9n.de-a1b0ae17-398646ca-11fa189f"],t,r)}));break;case ci.Greek:r=await new Promise((function(t,r){e(["./errors.t9n.el-0a20e1cc-d2dff5c0-e061784f"],t,r)}));break;case ci.EnglishUSA:r=await new Promise((function(t,r){e(["./errors.t9n.en-US-c9f50f19-f32c2d3b-dee2c6fc"],t,r)}));break;case ci.Spanish:r=await new Promise((function(t,r){e(["./errors.t9n.es-0dd138a7-69747b34-977f59d5"],t,r)}));break;case ci.Estonian:r=await new Promise((function(t,r){e(["./errors.t9n.et-57cc3980-1bdd9c2d-73dacf77"],t,r)}));break;case ci.Finnish:r=await new Promise((function(t,r){e(["./errors.t9n.fi-7d2525cb-4b956ccb-79dd28cb"],t,r)}));break;case ci.French:r=await new Promise((function(t,r){e(["./errors.t9n.fr-b2186e48-5ce9dd13-ebc56b4e"],t,r)}));break;case ci.Hebrew:r=await new Promise((function(t,r){e(["./errors.t9n.he-f487411b-0d58dc1d-e52105cd"],t,r)}));break;case ci.Croatian:r=await new Promise((function(t,r){e(["./errors.t9n.hr-61ca76d9-ddadf0d2-601d957e"],t,r)}));break;case ci.Hungarian:r=await new Promise((function(t,r){e(["./errors.t9n.hu-7fa01d3c-a864095a-7b6aabdf"],t,r)}));break;case ci.Indonesian:r=await new Promise((function(t,r){e(["./errors.t9n.id-6801fef5-56d34b5e-e913b9cd"],t,r)}));break;case ci.Italian:r=await new Promise((function(t,r){e(["./errors.t9n.it-568c2b04-817f6e26-f940078a"],t,r)}));break;case ci.Japanese:r=await new Promise((function(t,r){e(["./errors.t9n.ja-6042d3af-c76450b2-4ded7c57"],t,r)}));break;case ci.Korean:r=await new Promise((function(t,r){e(["./errors.t9n.ko-4d01f228-fa522d19-dae6bec2"],t,r)}));break;case ci.Lithuanian:r=await new Promise((function(t,r){e(["./errors.t9n.lt-7f94cd9d-a8765c78-e6a8521e"],t,r)}));break;case ci.Latvian:r=await new Promise((function(t,r){e(["./errors.t9n.lv-0223c6ae-e87e5f50-ce5ed667"],t,r)}));break;case ci.NorwegianBokml:r=await new Promise((function(t,r){e(["./errors.t9n.nb-1f800b8b-560eaaa6-bee8de21"],t,r)}));break;case ci.Dutch:r=await new Promise((function(t,r){e(["./errors.t9n.nl-dd20c6e1-25d5f4a6-42e7aba2"],t,r)}));break;case ci.Polish:r=await new Promise((function(t,r){e(["./errors.t9n.pl-e71d8c8e-00ab0f1d-72b9eca5"],t,r)}));break;case ci.PortugueseBrazil:r=await new Promise((function(t,r){e(["./errors.t9n.pt-BR-6cdb50a3-a18ab931-a4763035"],t,r)}));break;case ci.PortuguesePortugal:r=await new Promise((function(t,r){e(["./errors.t9n.pt-PT-6b3866f5-ebf06039-4facc845"],t,r)}));break;case ci.Romanian:r=await new Promise((function(t,r){e(["./errors.t9n.ro-86e7cba9-d4c8d6a2-06349efc"],t,r)}));break;case ci.Russian:r=await new Promise((function(t,r){e(["./errors.t9n.ru-23cdd703-c3cdda0a-de688fc7"],t,r)}));break;case ci.Serbian:r=await new Promise((function(t,r){e(["./errors.t9n.sr-fad84a78-d22f27be-956451e2"],t,r)}));break;case ci.Slovak:r=await new Promise((function(t,r){e(["./errors.t9n.sk-3b14f765-25690031-b3624a0c"],t,r)}));break;case ci.Slovenian:r=await new Promise((function(t,r){e(["./errors.t9n.sl-e900baaf-eca6555a-55e071c1"],t,r)}));break;case ci.Swedish:r=await new Promise((function(t,r){e(["./errors.t9n.sv-4613eae2-34db6f33-68d400f1"],t,r)}));break;case ci.Thai:r=await new Promise((function(t,r){e(["./errors.t9n.th-5732c8a4-9920e4e0-b3888374"],t,r)}));break;case ci.Turkish:r=await new Promise((function(t,r){e(["./errors.t9n.tr-ccd64dcc-b4db56b1-9da4a030"],t,r)}));break;case ci.Ukrainian:r=await new Promise((function(t,r){e(["./errors.t9n.uk-e6c5f2f4-f9b80043-bfe92819"],t,r)}));break;case ci.Vietnamese:r=await new Promise((function(t,r){e(["./errors.t9n.vi-3f1e30b4-091aee60-2ffe0b4a"],t,r)}));break;case ci.ChineseChina:r=await new Promise((function(t,r){e(["./errors.t9n.zh-CN-8e563d8f-16f78c33-252bc1bf"],t,r)}));break;case ci.ChineseHongKong:r=await new Promise((function(t,r){e(["./errors.t9n.zh-HK-23eb2505-deff0e0d-be89713e"],t,r)}));break;case ci.ChineseTaiwan:r=await new Promise((function(t,r){e(["./errors.t9n.zh-TW-4017c011-d5202fc0-2e785921"],t,r)}))}return r}(),o=n[t];throw new pi(t,o??n.defaultError,{type:"analysis_ui"},r)}function xa(e){e??(e="standard");let t="";return t="raster"===e?"_ra":"",t}function $a(e){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[e]||e}Qt((e=>{const t={};let r;if(void 0!==e.featureSet){if(t.source=N.default.fromJSON(e.featureSet).features,r=e.layerDefinition,void 0!==r.fields&&(t.fields=r.fields.map((e=>F.default.fromJSON(e)))),void 0!==r.objectIdField&&(t.objectIdField=r.objectIdField),void 0!==r.geometryType){let e="point";switch(r.geometryType){case"esriGeometryMultipoint":e="multipoint";break;case"esriGeometryPoint":e="point";break;case"esriGeometryPolygon":e="polygon";break;case"esriGeometryPolyline":e="polyline"}t.geometryType=e}void 0!==r.spatialReference&&(t.spatialReference=r.spatialReference),void 0!==r.drawingInfo?.renderer&&(t.renderer=z.default.fromJSON(r.drawingInfo.renderer))}return new $.default(t)})),Qt((async(e,t)=>{let r=!1;if(!0===window.location.href.includes("://localhost:")||void 0===t)r=!0;else{const n=`${e}${e.indexOf("?")>-1?"&":"?"}f=json`;U.default.request.proxyUrl=`${t}/sharing/proxy`;try{r=!1===ai((await si(n,{useProxy:!0})).data)}catch(e){r=!1}}return!0===r?e:void 0})),Qt((async e=>{const{locale:t,name:r,assetPrefix:n,analysisEngine:o,memoizedHelper:i}=e,a=`${r.toLowerCase()}${xa(o)}`;let s,c,u,l;const f=`${n}/tool-ui-json/${a}.tool.ui.json`,d=`${n}/tool-json/${a}.tool.json`,p=`${n}/t9n/${a}/${a}.t9n.${t}.json`,h=`${n}/t9n/common.t9n.${t}.json`;let y=t;t===ci.English||t===ci.EnglishUSA?y="":y===ci.NorwegianBokml&&(y="no");const b=`${n}/help/${""!==y?y+"/":""}${r}${xa(o)}.html`;try{l=await i(d),s=await i(f),c=await i(p),u=await i(h),c={...u,...c}}catch{s=void 0}return{toolJson:l,toolUIJson:s,toolT9n:c,toolHelpFilePath:b}})),Aa((async e=>{const{url:t}=e,r=`${t}/sharing/rest/community/self`,n=x.default.findCredential(r);let o;void 0!==n&&(o=n.token);const i={query:{returnUserLicensedItems:!0,token:o,f:"json"}};try{const{data:{userLicensedItems:e}}=await si(r,i);return[...e.map((({entitlements:e})=>e))].flat()}catch(e){await Ia(bi)}return[]}),{serializer:e=>`${e.user.username}`}),Aa((async e=>{let t={isMultidimensional:!1};const r="imagery-tile"===e.type?e.rasterInfo.multidimensionalInfo:e.multidimensionalInfo,n=e.multidimensionalSubset;if(null!=r){const o=null!=n?e.getMultidimensionalSubsetVariables():r.variables;if(void 0!==o&&o.length>0){const e=[],r=[],n={},i={},a={},s={},c={},u={},l={};o.forEach(((t,o)=>{let a="";const f=t.name;t.dimensions.forEach(((t,r)=>{const d=t.name;-1===e.indexOf(d)&&e.push(d);const p=r>0?`,${d}=${t.values?.length}`:`${d}=${t.values?.length}`;if(a=a.concat(p),0===r&&(i[f]={}),void 0===n[d]&&(n[d]=[]),i[f][d]=t.values,0===o){const e=t.values;if(void 0!==e)if("StdTime"!==d||void 0!==t.unit&&"ISO8601"!==t.unit)Array.isArray(e)&&"number"==typeof e[0]?s[d]=c[d]=e.map(String):Array.isArray(e[0])&&Array.isArray(e[1])&&(s[d]=e[0].map(String),c[d]=e[1].map(String));else{const t=[],r=[],n={},o={};e.forEach((e=>{if("number"==typeof e){const i=new Date(e),a=i.toLocaleString(),s=i.toISOString();t.push(s),r.push(s),n[s]=a,o[s]=a}else if(Array.isArray(e)){const i=new Date(e[0]),a=new Date(e[1]),s=i.toISOString(),c=a.toISOString();t.push(s),r.push(c),n[s]=i.toLocaleString(),o[c]=a.toLocaleString()}})),s[d]=t,c[d]=r,u[d]=n,l[d]=o}}n[d].push(f)})),r.push({name:f,alias:`${f}[${a}](${t.description})`,type:"string"})}));for(const e in n){const t=r.filter((t=>n[e].indexOf(t.name)>-1));a[e]={id:"1",name:e,description:"DimensionVariables",getFields:()=>Promise.resolve(t)}}t={isMultidimensional:!0,dimensions:e,dimensionVariableDatasets:a,dimensionValues:i,variablesDataset:{id:"1",name:"Variables",description:"Variables",getFields:()=>Promise.resolve(r)},dimensionMinValues:s,dimensionMaxValues:c,dimensionMinValuesWithLabels:u,dimensionMaxValuesWithLabels:l}}}const o="imagery"===e.type?await e.generateRasterInfo(e.renderingRule):e.rasterInfo;return t.rasterInfo=o,t}));const Ra=async e=>{const{asyncGeocodeUrl:t}=e,r=await k.submitJob(`${t}/AnalyzeGeocodeInput`,{...Do(e,"asyncGeocodeUrl"),f:"json"});try{return await r.waitForJobCompletion(),(await r.fetchResultData("geocodeParameters")).value}catch(e){throw console.error("AnalyzeGeocodeInput failed"),e}};Aa(((e,t)=>new R.default({id:e,portal:t})),{serializer:e=>`${e[0]}-${e[1]?.url}`}),Aa((async e=>{const{restUrl:t}=e,r=`${t}/portals/helpmap`;let n;try{const e=await I.default(r,{query:{f:"json"},responseType:"json",method:"auto"});n=await(e.data?.helpMap)??void 0}catch(e){n=void 0}return n}),{serializer:e=>`${e[0]}-${e[1]?.url}`});const Fa="esriExecutionTypeAsynchronous",za="esriExecutionTypeSynchronous",Na={Standard:"standard",GeoAnalytics:"geoanalytics",Raster:"raster",Pipelines:"pipelines",Session:"session"};var Ua={exports:{}};function Ma(e,t,r,n){var o=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(n)?n:r(n),i=t.get(o);return void 0===i&&(i=e.call(this,n),t.set(o,i)),i}function La(e,t,r){var n=Array.prototype.slice.call(arguments,3),o=r(n),i=t.get(o);return void 0===i&&(i=e.apply(this,n),t.set(o,i)),i}function Da(e,t,r,n,o){return r.bind(t,e,n,o)}function Ja(e,t){return Da(e,this,1===e.length?Ma:La,t.cache.create(),t.serializer)}function Va(){return JSON.stringify(arguments)}function Ga(){this.cache=Object.create(null)}Ga.prototype.has=function(e){return e in this.cache},Ga.prototype.get=function(e){return this.cache[e]},Ga.prototype.set=function(e,t){this.cache[e]=t};var Ba={create:function(){return new Ga}};Ua.exports=function(e,t){var r=t&&t.cache?t.cache:Ba,n=t&&t.serializer?t.serializer:Va;return(t&&t.strategy?t.strategy:Ja)(e,{cache:r,serializer:n})},Ua.exports.strategies={variadic:function(e,t){return Da(e,this,La,t.cache.create(),t.serializer)},monadic:function(e,t){return Da(e,this,Ma,t.cache.create(),t.serializer)}};var Ka=Ua.exports;function Ha(e,t,r=!1){let n=t.helperServices.analysis.url;switch(e){case Na.GeoAnalytics:n=t.helperServices.geoanalytics.url;break;case Na.Raster:n=t.helperServices.rasterAnalytics.url;break;case Na.Standard:n=r?t.helperServices.asyncGeocode.url:t.helperServices.analysis.url}return n}const Wa=e=>{const t=Array.from(e).map((e=>{let t;return t="object"==typeof e&&void 0!==e.id?e.id:e,t}));return JSON.stringify(t)},qa=Ka((async(e,t,r)=>{const n=`${Ha(t,r,"BatchGeocode"===e)}/${e}?f=json`,o=await I.default(n,{responseType:"json",authMode:"no-prompt"}),i=await o.data;return i.parameters?.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),i}),{serializer:Wa}),Ya=Ka((async(e,t)=>{const r=Ha(e,t),n=await I.default(`${r}?f=json`,{responseType:"json"}),{data:{tasks:o}}=n,i=o.map((r=>qa(r,e,t)));return await Promise.all(i)}),{serializer:Wa});Ka((async(e,t)=>{let r=[];return r=void 0!==t?await Ya(t,e):[...await Ya(Na.Standard,e),...await Ya(Na.Raster,e),...await Ya(Na.GeoAnalytics,e)],new Map(r.map((e=>[e.name.toLowerCase(),e])))}),{serializer:Wa});const Qa=Ka((async e=>{const{helperServices:t}=e;let r;if(void 0!==t.routingUtilities){const e=await k.execute(`${t.routingUtilities.url}/GetTravelModes?f=json`),{results:[{value:{features:n}},{value:o}]}=e;r={travelModes:n.map((e=>JSON.parse(e.attributes.TravelMode))),defaultTravelModeId:o}}return r}),{serializer:Wa}),Xa=Ka((async e=>(await I.default(`${e}?f=json`,{responseType:"json"})).data)),Za=Ka((async(e,t)=>{const r=`${e}/${t}?f=json`,n=await I.default(r,{responseType:"json",authMode:"no-prompt"}),o=await(n?.data);return void 0!==o?.parameters&&o.parameters?.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),o}));Ka((async e=>{const t=await I.default(`${e}?f=json`,{responseType:"json"}),{data:{tasks:r}}=t,n=r.map((t=>Za(e,t)));return await Promise.all(n)}));const es=Ka((async(e,t)=>{let r,n;try{r=await Za(e,t),n=await Xa(e)}catch(e){throw new pi(gi,"WebTool JSON failed to fetch.")}return r.serviceInfo=n,{...r,serviceInfo:n}})),ts={ResultDataComplete:"analysisCoreResultDataComplete",JobStatus:"analysisCoreJobStatus",CreditEstimateComplete:"creditEstimateComplete"};function rs(e){return{detail:e,composed:!0,cancelable:!0,bubbles:!0}}function ns(e,t){e.dispatchEvent(new window.CustomEvent(ts.ResultDataComplete,rs(t)))}function os(e,t){e.dispatchEvent(new window.CustomEvent(ts.JobStatus,rs(t)))}const is=[{toolName:"CreateViewshed",analysisEngine:Na.Standard},{toolName:"CreateWatersheds",analysisEngine:Na.Standard},{toolName:"TraceDownstream",analysisEngine:Na.Standard}];async function as(e){const{portal:t,jobParams:r,analysisEngine:n,toolName:i,toolElement:a}=e,s=Ha(n??Na.Standard,t,"BatchGeocode"===i);let c=[];if(void 0!==is.find((e=>e.toolName===i&&e.analysisEngine===n)))c=[{dateType:"string",value:{cost:0,totalRecords:0}}];else{let e="";switch(n){case Na.Raster:e=s+"/EstimateRasterAnalysisCost";break;case Na.Standard:e=s.replace("tasks/GPServer","Estimate/GPServer/EstimateCredits")}const t={};for(const e in r)"object"==typeof r[e]&&void 0!==r[e]?t[e]=JSON.stringify(r[e]):t[e]=r[e];const u=n===Na.Raster?{inputAnalysisTask:{name:i,parameters:t}}:{taskName:i,taskParameters:t},l=(await I.default(`${e}?f=json`,{responseType:"json"})).data,f=l?.parameters?.filter((e=>"esriGPParameterDirectionOutput"===e.direction));let d;switch(l.executionType){case za:d=await o.execute(e,u),c=d.results;break;case Fa:{const t=await k.submitJob(e,u),r={interval:1500,statusCallback:e=>{os(a,{jobInfo:e})}};await t.waitForJobCompletion(r);const n=f?.map((e=>t.fetchResultData(e.name)));c=await Promise.all(n);break}}}var u;return void 0!==a&&(u=c,a.dispatchEvent(new window.CustomEvent(ts.CreditEstimateComplete,rs(u)))),c}const ss=/^[\p{L}\p{N}_][\p{L}\p{N}_\s]*[\p{L}\p{N}_]$/u;const cs={Tool:"tool",RasterFunction:"rft",WebTool:"webTool"},us="estimateCreditsCurrentParameters",ls=r.proxyCustomElement(class extends r.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.analysisToolCreditsValidationFailure=r.createEvent(this,"analysisToolCreditsValidationFailure",7),this.estimateCredits=async()=>{this.onCreditsPopoverClose();const e=this.toolElement,t=await(e?.validateTool()),n=await(this.toolSettingsElement?.validateSettings());if(!1===t?.valid||!1===n?.valid){const e=Array.from(new Set([...t?.errorKeys,...n?.errorKeys]));e?.forEach(((t,n)=>{t===r.DEFAULT_ERROR_KEY&&(e[n]=r.DEFAULT_CREDIT_ERROR_KEY)}));const o={valid:!1,errorKeys:e};return this.analysisToolCreditsValidationFailure.emit(o),void(this.errorMessage=this.strings.creditsEstimationFailed)}if(this.errorMessage=void 0,this.estimatingCredits=!0,this.isInformationMessage=!1,void 0!==this.toolJson){const t=r.getJobParams(this.toolJson,e?.toolData),n=r.calculateParameterValues(t),o=O.addContextToJobParams(n,this.toolName,e?.toolData),i=r.prepJobParamsForSubmission({jobParams:o,toolData:e?.toolData??{},toolUIJson:e?.toolUIJson?.UIparameters??[],toolName:this.toolName});let a={valid:!0,errorKeys:[]};try{await as({toolName:this.toolName,portal:this.portal,jobParams:i,analysisEngine:this.analysisEngine,toolElement:this.hostElement})}catch(e){this.errorMessage=this.strings.creditsEstimationFailed,a={valid:!1,errorKeys:[us]}}this.analysisToolCreditsValidationFailure.emit(a),this.estimatingCredits=!1,this.creditsEstimated=!0}},this.estimateRFxCredits=async()=>{this.onCreditsPopoverClose();const e=this.toolElement,t=await(e?.validateRFx()),n=await(this.toolSettingsElement?.validateSettings()),o=await(this.toolOutputElement?.validateRFxOutput());if(!1===n?.valid||!1===t?.valid||!1===o?.valid){const e=Array.from(new Set([...n?.errorKeys,...t?.errorStrings,...o?.errorKeys]));e?.forEach(((t,n)=>{t===r.DEFAULT_ERROR_KEY&&(e[n]=r.DEFAULT_CREDIT_ERROR_KEY)}));const i={valid:!1,errorKeys:e};return this.analysisToolCreditsValidationFailure.emit(i),void(this.errorMessage=this.strings.creditsEstimationFailed)}this.errorMessage=void 0,this.estimatingCredits=!0,this.isInformationMessage=!1;const i={rasterFunction:await(e?.getUpdatedRFTWithValues()),outputName:await(this.toolOutputElement?.getOutputParameters())};if(void 0!==i){const e=O.addContextToJobParams(i,this.toolName,void 0),t={};Object.keys(e).forEach((r=>t[r]=JSON.stringify(e[r])));let r={valid:!0,errorKeys:[]};try{await as({toolName:"GenerateRaster",portal:this.portal,jobParams:t,analysisEngine:this.analysisEngine,toolElement:this.hostElement})}catch(e){this.errorMessage=this.strings.creditsEstimationFailed,r={valid:!1,errorKeys:[us]}}this.analysisToolCreditsValidationFailure.emit(r),this.estimatingCredits=!1,this.creditsEstimated=!0}},this.createCreditsPopover=()=>{void 0===this.creditsPopover&&(this.creditsPopover=document.createElement("analysis-tool-credits-popover"),this.creditsPopover.addEventListener("creditsPopoverClose",this.onCreditsPopoverClose)),this.creditsPopover.referenceElement=this.popoverActionElement,this.creditsPopover.numberOfInputFeatures=this.numberOfInputFeatures,this.creditsPopover.creditsPerFeature=this.creditsPerFeature,this.creditsPopover.estimatedCredits=this.estimatedCredits,this.creditsPopover.creditsRemaining=this.creditsRemaining,!1===document.body.contains(this.creditsPopover)&&(document.body.appendChild(this.creditsPopover),this.creditsPopover.open=!0)},this.onCreditsPopoverClose=()=>{void 0!==this.creditsPopover&&(this.creditsPopover.open=!1,this.creditsPopover.remove())},this.renderErrorMessage=()=>r.h("calcite-input-message",{status:this.isInformationMessage?r.UIInputStatus.IDLE:r.UIInputStatus.INVALID,icon:this.isInformationMessage?"information":"exclamationMarkTriangle",hidden:void 0===this.errorMessage},this.errorMessage),this.numberOfInputFeatures=void 0,this.creditsPerFeature=void 0,this.estimatedCredits=void 0,this.creditsRemaining=void 0,this.estimatingCredits=!1,this.creditsEstimated=!1,this.errorMessage=void 0,this.isInformationMessage=!1,this.analysisEngine=void 0,this.toolJson=void 0,this.toolName=void 0,this.toolSettingsElement=void 0,this.toolElement=void 0,this.portal=void 0,this.analysisType=void 0,this.toolOutputElement=void 0}disconnectedCallback(){this.onCreditsPopoverClose()}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await r.fetchComponentLocaleStrings(this.hostElement,r.getAssetPath(".")))}async clearCreditsEstimation(){return this.numberOfInputFeatures=void 0,this.creditsPerFeature=void 0,this.estimatedCredits=void 0,this.creditsRemaining=void 0,this.errorMessage=void 0,this.estimatingCredits=!1,this.creditsEstimated=!1,this.isInformationMessage=!1,Promise.resolve()}onCreditEstimateComplete(e){if(this.creditsPerFeature=void 0,this.creditsRemaining=void 0,void 0!==e.detail&&e.detail.length>0){const t=e.detail[0].value;this.estimatedCredits=t.maximumCost??t.cost??t.credits,is.find((e=>e.toolName===this.toolName&&e.analysisEngine===this.analysisEngine))&&(t.totalRecords=0,this.isInformationMessage=!0,this.errorMessage=this.strings.zeroCreditsMessage),this.numberOfInputFeatures=t.totalRecords}this.estimatingCredits=!1,this.creditsEstimated=!0}renderCreditsEstimated(){return this.creditsEstimated?r.h("div",null,r.h("div",{class:"estimated-credits"},r.h("div",null,this.strings.estimatedCredits),r.h("div",{class:"credits"},void 0===this.errorMessage&&!1===this.estimatingCredits&&r.h("calcite-button",{class:"info-button",ref:e=>{this.popoverActionElement=e},appearance:"outline","icon-start":"information",round:!0,disabled:this.estimatingCredits,onClick:this.createCreditsPopover},r.formatNumberToLocale(this.estimatedCredits)),r.h("calcite-action",{class:!0===this.estimatingCredits?"hide":"",onClick:this.analysisType===cs.RasterFunction?this.estimateRFxCredits:this.estimateCredits,text:"refresh",appearance:"transparent",icon:"refresh"}),r.h("calcite-loader",{style:{display:!1===this.estimatingCredits?"none":void 0},label:this.strings.loader,class:"loader",inline:!0}))),r.h("div",{class:"error-message"},void 0!==this.errorMessage?this.renderErrorMessage():null)):null}render(){return r.h(r.Host,{class:{"analysis--rtl":"rtl"===this.dir}},r.h("div",{class:"credit-block"},!this.creditsEstimated&&r.h("calcite-button",{alignment:"center",round:!0,appearance:"transparent",onClick:this.analysisType===cs.RasterFunction?this.estimateRFxCredits:this.estimateCredits,loading:this.estimatingCredits,class:"estimate-credit-button"},this.creditsEstimated?this.strings.estimatedCredits:this.strings.estimateCredits),this.renderCreditsEstimated()))}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get style(){return":host{display:flex;width:100%}.credit-block{display:flex;justify-content:center;width:100%;margin:0;background-color:var(--calcite-color-foreground-1)}.estimate-credit-button{padding:12px 0}.estimated-credits{width:100%;display:flex;justify-content:space-between;align-items:center}.credits{display:flex;align-items:center}.loader{padding:var(--analysis-quarter-spacing);margin-left:3.75rem;margin-right:0rem;margin-top:0.75rem}.error-message{padding-bottom:1rem}.hide{display:none}.info-button{margin-left:1rem;margin-right:0rem}:host(.analysis--rtl) .loader{margin-left:0rem;margin-right:3.75rem}:host(.analysis--rtl) .info-button{margin-left:0rem;margin-right:1rem}"}},[1,"analysis-tool-credits",{analysisEngine:[513,"analysis-engine"],toolJson:[16],toolName:[513,"tool-name"],toolSettingsElement:[16],toolElement:[16],portal:[16],analysisType:[1,"analysis-type"],toolOutputElement:[16],numberOfInputFeatures:[32],creditsPerFeature:[32],estimatedCredits:[32],creditsRemaining:[32],estimatingCredits:[32],creditsEstimated:[32],errorMessage:[32],isInformationMessage:[32],clearCreditsEstimation:[64]},[[0,"creditEstimateComplete","onCreditEstimateComplete"]]]);function fs(){"undefined"!=typeof customElements&&["analysis-tool-credits","analysis-tool-credits-popover"].forEach((e=>{switch(e){case"analysis-tool-credits":customElements.get(e)||customElements.define(e,ls);break;case"analysis-tool-credits-popover":customElements.get(e)||C.defineCustomElement()}}))}fs(),t.AnalysisEngine={Standard:"standard",GeoAnalytics:"geoanalytics",Raster:"raster",Pipelines:"pipelines",Session:"session"},t.AnalysisToolCredits=ls,t.AnalysisType=cs,t.defineCustomElement=fs,t.execute=async function(e){const{portal:t}=e,{jobParamsPayload:r,jobParams:n,toolUiParameters:o,toolName:i,analysisEngine:a,analysisType:s,resultParams:c,containerElement:u,gpMessages:l,webToolServerUrl:f,executionType:d,creditCheckOptions:p}=e;let h=function(e){let t=!0;return t=!0!==ai(e?.orgId)&&(function(e){return e.role?.includes("admin")??!1}(e)||function(e){return e.role?.includes("publisher")??!1}(e)),t}(t.user);const y=Object.keys(r).some((e=>{const t=r[e];return"string"==typeof t&&t.includes("serviceProperties")})),b=function(e,t){const r=[];return e.forEach((e=>{if(e in t){const n=JSON.parse(t[e]),o=n?.serviceProperties?.name??n?.itemProperties?.title??void 0;void 0!==o&&r.push(o)}})),"esri_out_feature_service_name"in t&&"string"==typeof t.esri_out_feature_service_name&&r.push(t.esri_out_feature_service_name),r}(Object.keys(r).filter((e=>{const t=r[e];return"string"==typeof t&&(t.includes("serviceProperties")||t.includes("itemProperties"))})),r);if(!1===function(e){return e.every((e=>ss.test(e)))}(b)&&await Ia(mi),y){const e=b.map((e=>{const r=t.isPortal?function(e){return e.replace(/\s/g,"_")}(e):e;return async function(e){const{portal:{url:t,id:r},itemType:n}=e,{serviceName:o}=e,i=`${t}/sharing/rest/portals/${r}/isServiceNameAvailable?f=json`,a={query:{f:"json",name:o,type:n}};let s=!0;try{s=(await I.default(i,a)).data.available}catch(e){await Ia(bi)}return s}({portal:t,serviceName:r,itemType:a!==Na.Raster||void 0!==o.resultType&&"FEATURE_LAYER"===o.resultType?"Feature Service":"Image Service"})}));h=!(await Promise.all(e)).some((e=>!1===e)),!1===h&&await Ia(vi)}const{skipCreditChecks:v=!1,creditThreshold:m}=p??{};if(!1===v&&void 0===f&&(e.analysisEngine===Na.Standard||e.analysisEngine===Na.Raster)){const r=function(e){const t=function(e){const t="object"==typeof e&&null!==e,r=t&&"totalRecords"in e&&("maximumCost"in e||"cost"in e),n=t&&"credits"in e&&"functions"in e&&Array.isArray(e.functions)&&e.functions.every((e=>"object"==typeof e&&null!==e&&"name"in e&&"costFactor"in e&&"gigaPixels"in e));return t&&(r||n)}(e?.[0]?.value)?e[0].value:void 0,r=t?.maximumCost??t?.cost??t?.credits;return Number.isNaN(r)?void 0:r}(await as({toolName:e.toolName,portal:t,jobParams:e.jobParamsPayload,analysisEngine:e.analysisEngine,toolElement:e.containerElement}));h=function(e,t){let r=!0;return void 0!==t.sourceJSON.availableCredits&&void 0!==e&&(r=t.sourceJSON.availableCredits>e),r}(r,t.user),!1===h&&await Ia(yi),h=function(e,t){return void 0===t||void 0===e||e<=t}(r,m),!1===h&&await Ia(hi,{estimatedCredits:r,creditThreshold:m})}if(!0===h){const e=`${void 0===f?Ha(a,t,"BatchGeocode"===i):f}/${i}?f=json`;if(d===za){const t=await k.execute(e,n),r=t.results,c=A.default.fromJSON({messages:t.messages});os(u,{jobInfo:c,submissionData:{toolName:i,analysisEngine:a,analysisType:s,jobParams:n,toolUiParameters:o}}),ns(u,{results:r,jobInfo:c})}else{const t=await k.submitJob(e,r);os(u,{jobInfo:t,submissionData:{toolName:i,analysisEngine:a,analysisType:s,jobParams:n,toolUiParameters:o,webToolServerUrl:f}});const d={interval:1500,statusCallback:e=>{os(u,{jobInfo:e})}};try{let e;if(await t.waitForJobCompletion(d),!0===c.includes("processInfo"))try{e=function(e,t={}){let r="";return e.forEach((e=>{const n=JSON.parse(e),{message:o,messageCode:i,params:a,style:s}=n;if(Array.isArray(o)){const e={};let n=s;o.forEach(((r,o)=>{const s=`${i}_${o}`;n=n.replace("></",">${"+s+"}</");let c=void 0!==t[s]?t[s]:r;c=fi(c,a),c=function(e){return e.replace(/[<>]/g,$a)}(c),e[s]=`${c}`})),r+=fi(n,e)}else{let e=void 0!==t[i]?t[i]:o;e=fi(e,a);const n=s.indexOf("</");r+=`${s.substring(0,n)}${e}${s.substring(n)}`}})),r}((await t.fetchResultData("processInfo")).value,l);const r=c.indexOf("processInfo");c.splice(r,1)}catch{}const r=c.map((e=>t.fetchResultData(e))),n=(await Promise.allSettled(r)).filter((e=>"fulfilled"===e.status)).map((e=>e.value));(async function(e,t){const r=[];e.forEach((e=>{if("object"==typeof e.value&&"itemId"in e.value&&!ai(e.value.itemId)&&void 0!==t){const n=e.value.itemId;r.push(async function(e,t){const r=new R.default({id:e}),n=await r.load();let o=Object.assign(n,t);return o=await o.update(),o}(n,{description:t}))}})),await Promise.all(r)})(n,e),ns(u,{results:n,jobInfo:t})}catch(e){os(u,{jobInfo:t})}}}},t.getTravelModes=Qa,t.getWebToolInfo=es}));