define(["require","exports","esri/request","esri/rest/support/ParameterValue","esri/core/urlUtils","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/identity/IdentityManager","esri/core/reactiveUtils","esri/rest/support/Query","esri/core/promiseUtils","esri/portal/PortalItemResource","esri/layers/FeatureLayer","esri/geometry/support/jsonUtils","esri/layers/Layer","esri/portal/PortalItem","esri/layers/support/Field","esri/renderers/Renderer","esri/rest/support/FeatureSet","esri/config","esri/smartMapping/statistics/uniqueValues","esri/rest/support/JobInfo","esri/rest/geoprocessor","esri/core/sql"],(function(require,exports,request$1,ParameterValue,urlUtils,Point,Polyline,Polygon,esriId,reactiveUtils,Query,promiseUtils,PortalItemResource,FeatureLayer,geometryJsonUtils,Layer,PortalItem,Field,Renderer,FeatureSet,esriConfig,uniqueValues,JobInfo,geoprocessor,sql){"use strict";function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var n=Object.create(null);if(e){Object.keys(e).forEach((function(k){if(k!=="default"){var d=Object.getOwnPropertyDescriptor(e,k);Object.defineProperty(n,k,d.get?d:{enumerable:true,get:function(){return e[k]}})}}))}n["default"]=e;return Object.freeze(n)}var request$1__default=_interopDefaultLegacy(request$1);var urlUtils__namespace=_interopNamespace(urlUtils);var esriId__default=_interopDefaultLegacy(esriId);var FeatureLayer__default=_interopDefaultLegacy(FeatureLayer);var geometryJsonUtils__namespace=_interopNamespace(geometryJsonUtils);var Layer__default=_interopDefaultLegacy(Layer);var PortalItem__default=_interopDefaultLegacy(PortalItem);var Field__default=_interopDefaultLegacy(Field);var Renderer__default=_interopDefaultLegacy(Renderer);var FeatureSet__default=_interopDefaultLegacy(FeatureSet);var esriConfig__default=_interopDefaultLegacy(esriConfig);var geoprocessor__namespace=_interopNamespace(geoprocessor);const BUILD={allRenderFn:false,cmpDidLoad:true,cmpDidUnload:false,cmpDidUpdate:true,cmpDidRender:true,cmpWillLoad:true,cmpWillUpdate:true,cmpWillRender:true,connectedCallback:true,disconnectedCallback:true,element:true,event:true,hasRenderFn:true,lifecycle:true,hostListener:true,hostListenerTargetWindow:true,hostListenerTargetDocument:true,hostListenerTargetBody:true,hostListenerTargetParent:false,hostListenerTarget:true,member:true,method:true,mode:true,observeAttribute:true,prop:true,propMutable:true,reflect:true,scoped:true,shadowDom:true,slot:true,cssAnnotations:true,state:true,style:true,formAssociated:false,svg:true,updatable:true,vdomAttribute:true,vdomXlink:true,vdomClass:true,vdomFunctional:true,vdomKey:true,vdomListener:true,vdomRef:true,vdomPropOrAttr:true,vdomRender:true,vdomStyle:true,vdomText:true,watchCallback:true,taskQueue:true,hotModuleReplacement:false,isDebug:false,isDev:false,isTesting:false,hydrateServerSide:false,hydrateClientSide:false,lifecycleDOMEvents:false,lazyLoad:false,profile:false,slotRelocation:true,appendChildSlotFix:false,cloneNodeFix:false,hydratedAttribute:false,hydratedClass:true,scriptDataOpts:false,scopedSlotTextContentFix:false,shadowDomShim:false,slotChildNodesFix:false,invisiblePrehydration:true,propBoolean:true,propNumber:true,propString:true,constructableCSS:true,cmpShouldUpdate:true,devTools:false,shadowDelegatesFocus:true,initializeNextTick:false,asyncLoading:false,asyncQueue:false,transformTagName:false,attachStyles:true,experimentalSlotFixes:false};let scopeId;let contentRef;let hostTagName;let useNativeShadowDom=false;let checkSlotFallbackVisibility=false;let checkSlotRelocate=false;let isSvgMode=false;let renderingRef=null;let queuePending=false;({isDev:BUILD.isDev?true:false,isBrowser:true,isServer:false,isTesting:BUILD.isTesting?true:false});const getAssetPath=path=>{const assetUrl=new URL(path,plt.$resourcesUrl$);return assetUrl.origin!==win.location.origin?assetUrl.href:assetUrl.pathname};const setAssetPath=path=>plt.$resourcesUrl$=path;const createTime=(fnName,tagName="")=>{{return()=>{}}};const SLOT_FB_CSS="slot-fb{display:contents}slot-fb[hidden]{display:none}";const XLINK_NS="http://www.w3.org/1999/xlink";const EMPTY_OBJ={};const SVG_NS="http://www.w3.org/2000/svg";const HTML_NS="http://www.w3.org/1999/xhtml";const isDef=v=>v!=null;const isComplexType=o=>{o=typeof o;return o==="object"||o==="function"};function queryNonceMetaTagContent(doc){var _a,_b,_c;return(_c=(_b=(_a=doc.head)===null||_a===void 0?void 0:_a.querySelector('meta[name="csp-nonce"]'))===null||_b===void 0?void 0:_b.getAttribute("content"))!==null&&_c!==void 0?_c:undefined}const h=(nodeName,vnodeData,...children)=>{let child=null;let key=null;let slotName=null;let simple=false;let lastSimple=false;const vNodeChildren=[];const walk=c=>{for(let i=0;i<c.length;i++){child=c[i];if(Array.isArray(child)){walk(child)}else if(child!=null&&typeof child!=="boolean"){if(simple=typeof nodeName!=="function"&&!isComplexType(child)){child=String(child)}if(simple&&lastSimple){vNodeChildren[vNodeChildren.length-1].$text$+=child}else{vNodeChildren.push(simple?newVNode(null,child):child)}lastSimple=simple}}};walk(children);if(vnodeData){if(BUILD.isDev&&nodeName==="input"){validateInputProperties(vnodeData)}if(BUILD.vdomKey&&vnodeData.key){key=vnodeData.key}if(BUILD.slotRelocation&&vnodeData.name){slotName=vnodeData.name}if(BUILD.vdomClass){const classData=vnodeData.className||vnodeData.class;if(classData){vnodeData.class=typeof classData!=="object"?classData:Object.keys(classData).filter((k=>classData[k])).join(" ")}}}if(BUILD.isDev&&vNodeChildren.some(isHost)){consoleDevError(`The <Host> must be the single root component. Make sure:\n- You are NOT using hostData() and <Host> in the same component.\n- <Host> is used once, and it's the single root component of the render() function.`)}if(BUILD.vdomFunctional&&typeof nodeName==="function"){return nodeName(vnodeData===null?{}:vnodeData,vNodeChildren,vdomFnUtils)}const vnode=newVNode(nodeName,null);vnode.$attrs$=vnodeData;if(vNodeChildren.length>0){vnode.$children$=vNodeChildren}if(BUILD.vdomKey){vnode.$key$=key}if(BUILD.slotRelocation){vnode.$name$=slotName}return vnode};const newVNode=(tag,text)=>{const vnode={$flags$:0,$tag$:tag,$text$:text,$elm$:null,$children$:null};if(BUILD.vdomAttribute){vnode.$attrs$=null}if(BUILD.vdomKey){vnode.$key$=null}if(BUILD.slotRelocation){vnode.$name$=null}return vnode};const Host={};const isHost=node=>node&&node.$tag$===Host;const vdomFnUtils={forEach:(children,cb)=>children.map(convertToPublic).forEach(cb),map:(children,cb)=>children.map(convertToPublic).map(cb).map(convertToPrivate)};const convertToPublic=node=>({vattrs:node.$attrs$,vchildren:node.$children$,vkey:node.$key$,vname:node.$name$,vtag:node.$tag$,vtext:node.$text$});const convertToPrivate=node=>{if(typeof node.vtag==="function"){const vnodeData=Object.assign({},node.vattrs);if(node.vkey){vnodeData.key=node.vkey}if(node.vname){vnodeData.name=node.vname}return h(node.vtag,vnodeData,...node.vchildren||[])}const vnode=newVNode(node.vtag,node.vtext);vnode.$attrs$=node.vattrs;vnode.$children$=node.vchildren;vnode.$key$=node.vkey;vnode.$name$=node.vname;return vnode};const validateInputProperties=inputElm=>{const props=Object.keys(inputElm);const value=props.indexOf("value");if(value===-1){return}const typeIndex=props.indexOf("type");const minIndex=props.indexOf("min");const maxIndex=props.indexOf("max");const stepIndex=props.indexOf("step");if(value<typeIndex||value<minIndex||value<maxIndex||value<stepIndex){consoleDevWarn(`The "value" prop of <input> should be set after "min", "max", "type" and "step"`)}};const computeMode=elm=>modeResolutionChain.map((h=>h(elm))).find((m=>!!m));const parsePropertyValue=(propValue,propType)=>{if(propValue!=null&&!isComplexType(propValue)){if(propType&4){return propValue==="false"?false:propValue===""||!!propValue}if(propType&2){return parseFloat(propValue)}if(propType&1){return String(propValue)}return propValue}return propValue};const getElement=ref=>BUILD.lazyLoad?getHostRef(ref).$hostElement$:ref;const createEvent=(ref,name,flags)=>{const elm=getElement(ref);return{emit:detail=>{if(BUILD.isDev&&!elm.isConnected){consoleDevWarn(`The "${name}" event was emitted, but the dispatcher node is no longer connected to the dom.`)}return emitEvent(elm,name,{bubbles:!!(flags&4),composed:!!(flags&2),cancelable:!!(flags&1),detail})}}};const emitEvent=(elm,name,opts)=>{const ev=plt.ce(name,opts);elm.dispatchEvent(ev);return ev};const rootAppliedStyles=new WeakMap;const registerStyle=(scopeId,cssText,allowCS)=>{let style=styles.get(scopeId);if(supportsConstructableStylesheets&&allowCS){style=style||new CSSStyleSheet;if(typeof style==="string"){style=cssText}else{style.replaceSync(cssText)}}else{style=cssText}styles.set(scopeId,style)};const addStyle=(styleContainerNode,cmpMeta,mode)=>{var _a;const scopeId=getScopeId(cmpMeta,mode);const style=styles.get(scopeId);styleContainerNode=styleContainerNode.nodeType===11?styleContainerNode:doc;if(style){if(typeof style==="string"){styleContainerNode=styleContainerNode.head||styleContainerNode;let appliedStyles=rootAppliedStyles.get(styleContainerNode);let styleElm;if(!appliedStyles){rootAppliedStyles.set(styleContainerNode,appliedStyles=new Set)}if(!appliedStyles.has(scopeId)){{styleElm=doc.createElement("style");styleElm.innerHTML=style;const nonce=(_a=plt.$nonce$)!==null&&_a!==void 0?_a:queryNonceMetaTagContent(doc);if(nonce!=null){styleElm.setAttribute("nonce",nonce)}styleContainerNode.insertBefore(styleElm,styleContainerNode.querySelector("link"))}if(cmpMeta.$flags$&4){styleElm.innerHTML+=SLOT_FB_CSS}if(appliedStyles){appliedStyles.add(scopeId)}}}else if(!styleContainerNode.adoptedStyleSheets.includes(style)){styleContainerNode.adoptedStyleSheets=[...styleContainerNode.adoptedStyleSheets,style]}}return scopeId};const attachStyles=hostRef=>{const cmpMeta=hostRef.$cmpMeta$;const elm=hostRef.$hostElement$;const flags=cmpMeta.$flags$;const endAttachStyles=createTime("attachStyles",cmpMeta.$tagName$);const scopeId=addStyle(supportsShadow&&elm.shadowRoot?elm.shadowRoot:elm.getRootNode(),cmpMeta,hostRef.$modeName$);if(flags&10){elm["s-sc"]=scopeId;elm.classList.add(scopeId+"-h");if(flags&2){elm.classList.add(scopeId+"-s")}}endAttachStyles()};const getScopeId=(cmp,mode)=>"sc-"+(mode&&cmp.$flags$&32?cmp.$tagName$+"-"+mode:cmp.$tagName$);const setAccessor=(elm,memberName,oldValue,newValue,isSvg,flags)=>{if(oldValue!==newValue){let isProp=isMemberInElement(elm,memberName);let ln=memberName.toLowerCase();if(memberName==="class"){const classList=elm.classList;const oldClasses=parseClassList(oldValue);const newClasses=parseClassList(newValue);classList.remove(...oldClasses.filter((c=>c&&!newClasses.includes(c))));classList.add(...newClasses.filter((c=>c&&!oldClasses.includes(c))))}else if(memberName==="style"){{for(const prop in oldValue){if(!newValue||newValue[prop]==null){if(prop.includes("-")){elm.style.removeProperty(prop)}else{elm.style[prop]=""}}}}for(const prop in newValue){if(!oldValue||newValue[prop]!==oldValue[prop]){if(prop.includes("-")){elm.style.setProperty(prop,newValue[prop])}else{elm.style[prop]=newValue[prop]}}}}else if(memberName==="key");else if(memberName==="ref"){if(newValue){newValue(elm)}}else if(!elm.__lookupSetter__(memberName)&&memberName[0]==="o"&&memberName[1]==="n"){if(memberName[2]==="-"){memberName=memberName.slice(3)}else if(isMemberInElement(win,ln)){memberName=ln.slice(2)}else{memberName=ln[2]+memberName.slice(3)}if(oldValue||newValue){const capture=memberName.endsWith(CAPTURE_EVENT_SUFFIX);memberName=memberName.replace(CAPTURE_EVENT_REGEX,"");if(oldValue){plt.rel(elm,memberName,oldValue,capture)}if(newValue){plt.ael(elm,memberName,newValue,capture)}}}else{const isComplex=isComplexType(newValue);if((isProp||isComplex&&newValue!==null)&&!isSvg){try{if(!elm.tagName.includes("-")){const n=newValue==null?"":newValue;if(memberName==="list"){isProp=false}else if(oldValue==null||elm[memberName]!=n){elm[memberName]=n}}else{elm[memberName]=newValue}}catch(e){}}let xlink=false;{if(ln!==(ln=ln.replace(/^xlink\:?/,""))){memberName=ln;xlink=true}}if(newValue==null||newValue===false){if(newValue!==false||elm.getAttribute(memberName)===""){if(xlink){elm.removeAttributeNS(XLINK_NS,memberName)}else{elm.removeAttribute(memberName)}}}else if((!isProp||flags&4||isSvg)&&!isComplex){newValue=newValue===true?"":newValue;if(xlink){elm.setAttributeNS(XLINK_NS,memberName,newValue)}else{elm.setAttribute(memberName,newValue)}}}}};const parseClassListRegex=/\s/;const parseClassList=value=>!value?[]:value.split(parseClassListRegex);const CAPTURE_EVENT_SUFFIX="Capture";const CAPTURE_EVENT_REGEX=new RegExp(CAPTURE_EVENT_SUFFIX+"$");const updateElement=(oldVnode,newVnode,isSvgMode,memberName)=>{const elm=newVnode.$elm$.nodeType===11&&newVnode.$elm$.host?newVnode.$elm$.host:newVnode.$elm$;const oldVnodeAttrs=oldVnode&&oldVnode.$attrs$||EMPTY_OBJ;const newVnodeAttrs=newVnode.$attrs$||EMPTY_OBJ;{for(memberName in oldVnodeAttrs){if(!(memberName in newVnodeAttrs)){setAccessor(elm,memberName,oldVnodeAttrs[memberName],undefined,isSvgMode,newVnode.$flags$)}}}for(memberName in newVnodeAttrs){setAccessor(elm,memberName,oldVnodeAttrs[memberName],newVnodeAttrs[memberName],isSvgMode,newVnode.$flags$)}};const createElm=(oldParentVNode,newParentVNode,childIndex,parentElm)=>{var _a;const newVNode=newParentVNode.$children$[childIndex];let i=0;let elm;let childNode;let oldVNode;if(!useNativeShadowDom){checkSlotRelocate=true;if(newVNode.$tag$==="slot"){if(scopeId){parentElm.classList.add(scopeId+"-s")}newVNode.$flags$|=newVNode.$children$?2:1}}if(newVNode.$text$!==null){elm=newVNode.$elm$=doc.createTextNode(newVNode.$text$)}else if(newVNode.$flags$&1){elm=newVNode.$elm$=doc.createTextNode("")}else{if(!isSvgMode){isSvgMode=newVNode.$tag$==="svg"}elm=newVNode.$elm$=doc.createElementNS(isSvgMode?SVG_NS:HTML_NS,newVNode.$flags$&2?"slot-fb":newVNode.$tag$);if(isSvgMode&&newVNode.$tag$==="foreignObject"){isSvgMode=false}{updateElement(null,newVNode,isSvgMode)}if(isDef(scopeId)&&elm["s-si"]!==scopeId){elm.classList.add(elm["s-si"]=scopeId)}if(newVNode.$children$){for(i=0;i<newVNode.$children$.length;++i){childNode=createElm(oldParentVNode,newVNode,i,elm);if(childNode){elm.appendChild(childNode)}}}{if(newVNode.$tag$==="svg"){isSvgMode=false}else if(elm.tagName==="foreignObject"){isSvgMode=true}}}{elm["s-hn"]=hostTagName;if(newVNode.$flags$&(2|1)){elm["s-sr"]=true;elm["s-fs"]=(_a=newVNode.$attrs$)===null||_a===void 0?void 0:_a.slot;elm["s-cr"]=contentRef;elm["s-sn"]=newVNode.$name$||"";oldVNode=oldParentVNode&&oldParentVNode.$children$&&oldParentVNode.$children$[childIndex];if(oldVNode&&oldVNode.$tag$===newVNode.$tag$&&oldParentVNode.$elm$){putBackInOriginalLocation(oldParentVNode.$elm$,false)}}}return elm};const putBackInOriginalLocation=(parentElm,recursive)=>{var _a;plt.$flags$|=1;const oldSlotChildNodes=parentElm.childNodes;for(let i=oldSlotChildNodes.length-1;i>=0;i--){const childNode=oldSlotChildNodes[i];if(childNode["s-hn"]!==hostTagName&&childNode["s-ol"]){parentReferenceNode(childNode).insertBefore(childNode,referenceNode(childNode));childNode["s-ol"].remove();childNode["s-ol"]=undefined;childNode["s-sh"]=undefined;if(childNode.nodeType===1){childNode.setAttribute("slot",(_a=childNode["s-sn"])!==null&&_a!==void 0?_a:"")}checkSlotRelocate=true}if(recursive){putBackInOriginalLocation(childNode,recursive)}}plt.$flags$&=~1};const addVnodes=(parentElm,before,parentVNode,vnodes,startIdx,endIdx)=>{let containerElm=parentElm["s-cr"]&&parentElm["s-cr"].parentNode||parentElm;let childNode;if(containerElm.shadowRoot&&containerElm.tagName===hostTagName){containerElm=containerElm.shadowRoot}for(;startIdx<=endIdx;++startIdx){if(vnodes[startIdx]){childNode=createElm(null,parentVNode,startIdx,parentElm);if(childNode){vnodes[startIdx].$elm$=childNode;containerElm.insertBefore(childNode,referenceNode(before))}}}};const removeVnodes=(vnodes,startIdx,endIdx)=>{for(let index=startIdx;index<=endIdx;++index){const vnode=vnodes[index];if(vnode){const elm=vnode.$elm$;nullifyVNodeRefs(vnode);if(elm){{checkSlotFallbackVisibility=true;if(elm["s-ol"]){elm["s-ol"].remove()}else{putBackInOriginalLocation(elm,true)}}elm.remove()}}}};const updateChildren=(parentElm,oldCh,newVNode,newCh)=>{let oldStartIdx=0;let newStartIdx=0;let idxInOld=0;let i=0;let oldEndIdx=oldCh.length-1;let oldStartVnode=oldCh[0];let oldEndVnode=oldCh[oldEndIdx];let newEndIdx=newCh.length-1;let newStartVnode=newCh[0];let newEndVnode=newCh[newEndIdx];let node;let elmToMove;while(oldStartIdx<=oldEndIdx&&newStartIdx<=newEndIdx){if(oldStartVnode==null){oldStartVnode=oldCh[++oldStartIdx]}else if(oldEndVnode==null){oldEndVnode=oldCh[--oldEndIdx]}else if(newStartVnode==null){newStartVnode=newCh[++newStartIdx]}else if(newEndVnode==null){newEndVnode=newCh[--newEndIdx]}else if(isSameVnode(oldStartVnode,newStartVnode)){patch(oldStartVnode,newStartVnode);oldStartVnode=oldCh[++oldStartIdx];newStartVnode=newCh[++newStartIdx]}else if(isSameVnode(oldEndVnode,newEndVnode)){patch(oldEndVnode,newEndVnode);oldEndVnode=oldCh[--oldEndIdx];newEndVnode=newCh[--newEndIdx]}else if(isSameVnode(oldStartVnode,newEndVnode)){if(oldStartVnode.$tag$==="slot"||newEndVnode.$tag$==="slot"){putBackInOriginalLocation(oldStartVnode.$elm$.parentNode,false)}patch(oldStartVnode,newEndVnode);parentElm.insertBefore(oldStartVnode.$elm$,oldEndVnode.$elm$.nextSibling);oldStartVnode=oldCh[++oldStartIdx];newEndVnode=newCh[--newEndIdx]}else if(isSameVnode(oldEndVnode,newStartVnode)){if(oldStartVnode.$tag$==="slot"||newEndVnode.$tag$==="slot"){putBackInOriginalLocation(oldEndVnode.$elm$.parentNode,false)}patch(oldEndVnode,newStartVnode);parentElm.insertBefore(oldEndVnode.$elm$,oldStartVnode.$elm$);oldEndVnode=oldCh[--oldEndIdx];newStartVnode=newCh[++newStartIdx]}else{idxInOld=-1;{for(i=oldStartIdx;i<=oldEndIdx;++i){if(oldCh[i]&&oldCh[i].$key$!==null&&oldCh[i].$key$===newStartVnode.$key$){idxInOld=i;break}}}if(idxInOld>=0){elmToMove=oldCh[idxInOld];if(elmToMove.$tag$!==newStartVnode.$tag$){node=createElm(oldCh&&oldCh[newStartIdx],newVNode,idxInOld,parentElm)}else{patch(elmToMove,newStartVnode);oldCh[idxInOld]=undefined;node=elmToMove.$elm$}newStartVnode=newCh[++newStartIdx]}else{node=createElm(oldCh&&oldCh[newStartIdx],newVNode,newStartIdx,parentElm);newStartVnode=newCh[++newStartIdx]}if(node){{parentReferenceNode(oldStartVnode.$elm$).insertBefore(node,referenceNode(oldStartVnode.$elm$))}}}}if(oldStartIdx>oldEndIdx){addVnodes(parentElm,newCh[newEndIdx+1]==null?null:newCh[newEndIdx+1].$elm$,newVNode,newCh,newStartIdx,newEndIdx)}else if(newStartIdx>newEndIdx){removeVnodes(oldCh,oldStartIdx,oldEndIdx)}};const isSameVnode=(leftVNode,rightVNode)=>{if(leftVNode.$tag$===rightVNode.$tag$){if(leftVNode.$tag$==="slot"){return leftVNode.$name$===rightVNode.$name$}{return leftVNode.$key$===rightVNode.$key$}}return false};const referenceNode=node=>node&&node["s-ol"]||node;const parentReferenceNode=node=>(node["s-ol"]?node["s-ol"]:node).parentNode;const patch=(oldVNode,newVNode)=>{const elm=newVNode.$elm$=oldVNode.$elm$;const oldChildren=oldVNode.$children$;const newChildren=newVNode.$children$;const tag=newVNode.$tag$;const text=newVNode.$text$;let defaultHolder;if(text===null){{isSvgMode=tag==="svg"?true:tag==="foreignObject"?false:isSvgMode}{if(tag==="slot");else{updateElement(oldVNode,newVNode,isSvgMode)}}if(oldChildren!==null&&newChildren!==null){updateChildren(elm,oldChildren,newVNode,newChildren)}else if(newChildren!==null){if(oldVNode.$text$!==null){elm.textContent=""}addVnodes(elm,null,newVNode,newChildren,0,newChildren.length-1)}else if(oldChildren!==null){removeVnodes(oldChildren,0,oldChildren.length-1)}if(isSvgMode&&tag==="svg"){isSvgMode=false}}else if(defaultHolder=elm["s-cr"]){defaultHolder.parentNode.textContent=text}else if(oldVNode.$text$!==text){elm.data=text}};const updateFallbackSlotVisibility=elm=>{const childNodes=elm.childNodes;for(const childNode of childNodes){if(childNode.nodeType===1){if(childNode["s-sr"]){const slotName=childNode["s-sn"];childNode.hidden=false;for(const siblingNode of childNodes){if(siblingNode!==childNode){if(siblingNode["s-hn"]!==childNode["s-hn"]||slotName!==""){if(siblingNode.nodeType===1&&(slotName===siblingNode.getAttribute("slot")||slotName===siblingNode["s-sn"])){childNode.hidden=true;break}}else{if(siblingNode.nodeType===1||siblingNode.nodeType===3&&siblingNode.textContent.trim()!==""){childNode.hidden=true;break}}}}}updateFallbackSlotVisibility(childNode)}}};const relocateNodes=[];const markSlotContentForRelocation=elm=>{let node;let hostContentNodes;let j;for(const childNode of elm.childNodes){if(childNode["s-sr"]&&(node=childNode["s-cr"])&&node.parentNode){hostContentNodes=node.parentNode.childNodes;const slotName=childNode["s-sn"];for(j=hostContentNodes.length-1;j>=0;j--){node=hostContentNodes[j];if(!node["s-cn"]&&!node["s-nr"]&&node["s-hn"]!==childNode["s-hn"]&&!BUILD.experimentalSlotFixes){if(isNodeLocatedInSlot(node,slotName)){let relocateNodeData=relocateNodes.find((r=>r.$nodeToRelocate$===node));checkSlotFallbackVisibility=true;node["s-sn"]=node["s-sn"]||slotName;if(relocateNodeData){relocateNodeData.$nodeToRelocate$["s-sh"]=childNode["s-hn"];relocateNodeData.$slotRefNode$=childNode}else{node["s-sh"]=childNode["s-hn"];relocateNodes.push({$slotRefNode$:childNode,$nodeToRelocate$:node})}if(node["s-sr"]){relocateNodes.map((relocateNode=>{if(isNodeLocatedInSlot(relocateNode.$nodeToRelocate$,node["s-sn"])){relocateNodeData=relocateNodes.find((r=>r.$nodeToRelocate$===node));if(relocateNodeData&&!relocateNode.$slotRefNode$){relocateNode.$slotRefNode$=relocateNodeData.$slotRefNode$}}}))}}else if(!relocateNodes.some((r=>r.$nodeToRelocate$===node))){relocateNodes.push({$nodeToRelocate$:node})}}}}if(childNode.nodeType===1){markSlotContentForRelocation(childNode)}}};const isNodeLocatedInSlot=(nodeToRelocate,slotName)=>{if(nodeToRelocate.nodeType===1){if(nodeToRelocate.getAttribute("slot")===null&&slotName===""){return true}if(nodeToRelocate.getAttribute("slot")===slotName){return true}return false}if(nodeToRelocate["s-sn"]===slotName){return true}return slotName===""};const nullifyVNodeRefs=vNode=>{{vNode.$attrs$&&vNode.$attrs$.ref&&vNode.$attrs$.ref(null);vNode.$children$&&vNode.$children$.map(nullifyVNodeRefs)}};const renderVdom=(hostRef,renderFnResults,isInitialLoad=false)=>{var _a,_b;const hostElm=hostRef.$hostElement$;const cmpMeta=hostRef.$cmpMeta$;const oldVNode=hostRef.$vnode$||newVNode(null,null);const rootVnode=isHost(renderFnResults)?renderFnResults:h(null,null,renderFnResults);hostTagName=hostElm.tagName;if(cmpMeta.$attrsToReflect$){rootVnode.$attrs$=rootVnode.$attrs$||{};cmpMeta.$attrsToReflect$.map((([propName,attribute])=>rootVnode.$attrs$[attribute]=hostElm[propName]))}if(isInitialLoad&&rootVnode.$attrs$){for(const key of Object.keys(rootVnode.$attrs$)){if(hostElm.hasAttribute(key)&&!["key","ref","style","class"].includes(key)){rootVnode.$attrs$[key]=hostElm[key]}}}rootVnode.$tag$=null;rootVnode.$flags$|=4;hostRef.$vnode$=rootVnode;rootVnode.$elm$=oldVNode.$elm$=hostElm.shadowRoot||hostElm;{scopeId=hostElm["s-sc"]}{contentRef=hostElm["s-cr"];useNativeShadowDom=supportsShadow&&(cmpMeta.$flags$&1)!==0;checkSlotFallbackVisibility=false}patch(oldVNode,rootVnode);{plt.$flags$|=1;if(checkSlotRelocate){markSlotContentForRelocation(rootVnode.$elm$);for(const relocateData of relocateNodes){const nodeToRelocate=relocateData.$nodeToRelocate$;if(!nodeToRelocate["s-ol"]){const orgLocationNode=doc.createTextNode("");orgLocationNode["s-nr"]=nodeToRelocate;nodeToRelocate.parentNode.insertBefore(nodeToRelocate["s-ol"]=orgLocationNode,nodeToRelocate)}}for(const relocateData of relocateNodes){const nodeToRelocate=relocateData.$nodeToRelocate$;const slotRefNode=relocateData.$slotRefNode$;if(slotRefNode){const parentNodeRef=slotRefNode.parentNode;let insertBeforeNode=slotRefNode.nextSibling;{let orgLocationNode=(_a=nodeToRelocate["s-ol"])===null||_a===void 0?void 0:_a.previousSibling;while(orgLocationNode){let refNode=(_b=orgLocationNode["s-nr"])!==null&&_b!==void 0?_b:null;if(refNode&&refNode["s-sn"]===nodeToRelocate["s-sn"]&&parentNodeRef===refNode.parentNode){refNode=refNode.nextSibling;if(!refNode||!refNode["s-nr"]){insertBeforeNode=refNode;break}}orgLocationNode=orgLocationNode.previousSibling}}if(!insertBeforeNode&&parentNodeRef!==nodeToRelocate.parentNode||nodeToRelocate.nextSibling!==insertBeforeNode){if(nodeToRelocate!==insertBeforeNode){if(!nodeToRelocate["s-hn"]&&nodeToRelocate["s-ol"]){nodeToRelocate["s-hn"]=nodeToRelocate["s-ol"].parentNode.nodeName}parentNodeRef.insertBefore(nodeToRelocate,insertBeforeNode)}}}else{if(nodeToRelocate.nodeType===1){nodeToRelocate.hidden=true}}}}if(checkSlotFallbackVisibility){updateFallbackSlotVisibility(rootVnode.$elm$)}plt.$flags$&=~1;relocateNodes.length=0}};const attachToAncestor=(hostRef,ancestorComponent)=>{};const scheduleUpdate=(hostRef,isInitialLoad)=>{{hostRef.$flags$|=16}attachToAncestor(hostRef,hostRef.$ancestorComponent$);const dispatch=()=>dispatchHooks(hostRef,isInitialLoad);return writeTask(dispatch)};const dispatchHooks=(hostRef,isInitialLoad)=>{const elm=hostRef.$hostElement$;const endSchedule=createTime("scheduleUpdate",hostRef.$cmpMeta$.$tagName$);const instance=elm;let maybePromise;if(isInitialLoad){{maybePromise=safeCall(instance,"componentWillLoad")}}else{{maybePromise=safeCall(instance,"componentWillUpdate")}}{maybePromise=enqueue(maybePromise,(()=>safeCall(instance,"componentWillRender")))}endSchedule();return enqueue(maybePromise,(()=>updateComponent(hostRef,instance,isInitialLoad)))};const enqueue=(maybePromise,fn)=>isPromisey(maybePromise)?maybePromise.then(fn):fn();const isPromisey=maybePromise=>maybePromise instanceof Promise||maybePromise&&maybePromise.then&&typeof maybePromise.then==="function";const updateComponent=async(hostRef,instance,isInitialLoad)=>{const elm=hostRef.$hostElement$;const endUpdate=createTime("update",hostRef.$cmpMeta$.$tagName$);elm["s-rc"];if(isInitialLoad){attachStyles(hostRef)}const endRender=createTime("render",hostRef.$cmpMeta$.$tagName$);{callRender(hostRef,instance,elm,isInitialLoad)}endRender();endUpdate();{postUpdateComponent(hostRef)}};const callRender=(hostRef,instance,elm,isInitialLoad)=>{const allRenderFn=false;const lazyLoad=false;const taskQueue=true;const updatable=true;try{renderingRef=instance;instance=allRenderFn?instance.render():instance.render&&instance.render();if(updatable&&taskQueue){hostRef.$flags$&=~16}if(updatable||lazyLoad){hostRef.$flags$|=2}if(BUILD.hasRenderFn||BUILD.reflect){if(BUILD.vdomRender||BUILD.reflect){if(BUILD.hydrateServerSide);else{renderVdom(hostRef,instance,isInitialLoad)}}}}catch(e){consoleError(e,hostRef.$hostElement$)}renderingRef=null;return null};const getRenderingRef=()=>renderingRef;const postUpdateComponent=hostRef=>{const tagName=hostRef.$cmpMeta$.$tagName$;const elm=hostRef.$hostElement$;const endPostUpdate=createTime("postUpdate",tagName);const instance=elm;hostRef.$ancestorComponent$;{safeCall(instance,"componentDidRender")}if(!(hostRef.$flags$&64)){hostRef.$flags$|=64;{safeCall(instance,"componentDidLoad")}endPostUpdate()}else{{safeCall(instance,"componentDidUpdate")}endPostUpdate()}};const forceUpdate=ref=>{{const hostRef=getHostRef(ref);const isConnected=hostRef.$hostElement$.isConnected;if(isConnected&&(hostRef.$flags$&(2|16))===2){scheduleUpdate(hostRef,false)}return isConnected}};const safeCall=(instance,method,arg)=>{if(instance&&instance[method]){try{return instance[method](arg)}catch(e){consoleError(e)}}return undefined};const getValue=(ref,propName)=>getHostRef(ref).$instanceValues$.get(propName);const setValue=(ref,propName,newVal,cmpMeta)=>{const hostRef=getHostRef(ref);const elm=ref;const oldVal=hostRef.$instanceValues$.get(propName);const flags=hostRef.$flags$;const instance=elm;newVal=parsePropertyValue(newVal,cmpMeta.$members$[propName][0]);const areBothNaN=Number.isNaN(oldVal)&&Number.isNaN(newVal);const didValueChange=newVal!==oldVal&&!areBothNaN;if(didValueChange){hostRef.$instanceValues$.set(propName,newVal);{if(cmpMeta.$watchers$&&flags&128){const watchMethods=cmpMeta.$watchers$[propName];if(watchMethods){watchMethods.map((watchMethodName=>{try{instance[watchMethodName](newVal,oldVal,propName)}catch(e){consoleError(e,elm)}}))}}if((flags&(2|16))===2){if(instance.componentShouldUpdate){if(instance.componentShouldUpdate(newVal,oldVal,propName)===false){return}}scheduleUpdate(hostRef,false)}}}};const proxyComponent=(Cstr,cmpMeta,flags)=>{var _a;const prototype=Cstr.prototype;if(cmpMeta.$members$){if(Cstr.watchers){cmpMeta.$watchers$=Cstr.watchers}const members=Object.entries(cmpMeta.$members$);members.map((([memberName,[memberFlags]])=>{if(memberFlags&31||memberFlags&32){Object.defineProperty(prototype,memberName,{get(){return getValue(this,memberName)},set(newValue){setValue(this,memberName,newValue,cmpMeta)},configurable:true,enumerable:true})}}));{const attrNameToPropName=new Map;prototype.attributeChangedCallback=function(attrName,oldValue,newValue){plt.jmp((()=>{var _a;const propName=attrNameToPropName.get(attrName);if(this.hasOwnProperty(propName)){newValue=this[propName];delete this[propName]}else if(prototype.hasOwnProperty(propName)&&typeof this[propName]==="number"&&this[propName]==newValue){return}else if(propName==null){const hostRef=getHostRef(this);const flags=hostRef===null||hostRef===void 0?void 0:hostRef.$flags$;if(flags&&!(flags&8)&&flags&128&&newValue!==oldValue){const elm=this;const instance=elm;const entry=(_a=cmpMeta.$watchers$)===null||_a===void 0?void 0:_a[attrName];entry===null||entry===void 0?void 0:entry.forEach((callbackName=>{if(instance[callbackName]!=null){instance[callbackName].call(instance,newValue,oldValue,attrName)}}))}return}this[propName]=newValue===null&&typeof this[propName]==="boolean"?false:newValue}))};Cstr.observedAttributes=Array.from(new Set([...Object.keys((_a=cmpMeta.$watchers$)!==null&&_a!==void 0?_a:{}),...members.filter((([_,m])=>m[0]&15)).map((([propName,m])=>{var _a;const attrName=m[1]||propName;attrNameToPropName.set(attrName,propName);if(m[0]&512){(_a=cmpMeta.$attrsToReflect$)===null||_a===void 0?void 0:_a.push([propName,attrName])}return attrName}))]))}}return Cstr};const initializeComponent=async(elm,hostRef,cmpMeta,hmrVersionId)=>{let Cstr;if((hostRef.$flags$&32)===0){hostRef.$flags$|=32;{Cstr=elm.constructor;customElements.whenDefined(cmpMeta.$tagName$).then((()=>hostRef.$flags$|=128))}if(Cstr.style){let style=Cstr.style;if(typeof style!=="string"){style=style[hostRef.$modeName$=computeMode(elm)]}const scopeId=getScopeId(cmpMeta,hostRef.$modeName$);if(!styles.has(scopeId)){const endRegisterStyles=createTime("registerStyles",cmpMeta.$tagName$);registerStyle(scopeId,style,!!(cmpMeta.$flags$&1));endRegisterStyles()}}}hostRef.$ancestorComponent$;const schedule=()=>scheduleUpdate(hostRef,true);{schedule()}};const fireConnectedCallback=instance=>{};const connectedCallback=elm=>{if((plt.$flags$&1)===0){const hostRef=getHostRef(elm);const cmpMeta=hostRef.$cmpMeta$;const endConnected=createTime("connectedCallback",cmpMeta.$tagName$);if(!(hostRef.$flags$&1)){hostRef.$flags$|=1;{if(cmpMeta.$flags$&(4|8)){setContentReference(elm)}}if(cmpMeta.$members$){Object.entries(cmpMeta.$members$).map((([memberName,[memberFlags]])=>{if(memberFlags&31&&elm.hasOwnProperty(memberName)){const value=elm[memberName];delete elm[memberName];elm[memberName]=value}}))}{initializeComponent(elm,hostRef,cmpMeta)}}else{addHostEventListeners(elm,hostRef,cmpMeta.$listeners$);if(hostRef===null||hostRef===void 0?void 0:hostRef.$lazyInstance$){fireConnectedCallback(hostRef.$lazyInstance$)}else if(hostRef===null||hostRef===void 0?void 0:hostRef.$onReadyPromise$){hostRef.$onReadyPromise$.then((()=>fireConnectedCallback(hostRef.$lazyInstance$)))}}endConnected()}};const setContentReference=elm=>{const contentRefElm=elm["s-cr"]=doc.createComment("");contentRefElm["s-cn"]=true;elm.insertBefore(contentRefElm,elm.firstChild)};const disconnectedCallback=async elm=>{if((plt.$flags$&1)===0){const hostRef=getHostRef(elm);{if(hostRef.$rmListeners$){hostRef.$rmListeners$.map((rmListener=>rmListener()));hostRef.$rmListeners$=undefined}}}};const patchPseudoShadowDom=(hostElementPrototype,descriptorPrototype)=>{patchCloneNode(hostElementPrototype);patchSlotAppendChild(hostElementPrototype);patchSlotAppend(hostElementPrototype);patchSlotPrepend(hostElementPrototype);patchSlotInsertAdjacentElement(hostElementPrototype);patchSlotInsertAdjacentHTML(hostElementPrototype);patchSlotInsertAdjacentText(hostElementPrototype);patchTextContent(hostElementPrototype,descriptorPrototype);patchChildSlotNodes(hostElementPrototype,descriptorPrototype)};const patchCloneNode=HostElementPrototype=>{const orgCloneNode=HostElementPrototype.cloneNode;HostElementPrototype.cloneNode=function(deep){const srcNode=this;const isShadowDom=srcNode.shadowRoot&&supportsShadow;const clonedNode=orgCloneNode.call(srcNode,isShadowDom?deep:false);if(!isShadowDom&&deep){let i=0;let slotted,nonStencilNode;const stencilPrivates=["s-id","s-cr","s-lr","s-rc","s-sc","s-p","s-cn","s-sr","s-sn","s-hn","s-ol","s-nr","s-si"];for(;i<srcNode.childNodes.length;i++){slotted=srcNode.childNodes[i]["s-nr"];nonStencilNode=stencilPrivates.every((privateField=>!srcNode.childNodes[i][privateField]));if(slotted){{clonedNode.appendChild(slotted.cloneNode(true))}}if(nonStencilNode){clonedNode.appendChild(srcNode.childNodes[i].cloneNode(true))}}}return clonedNode}};const patchSlotAppendChild=HostElementPrototype=>{HostElementPrototype.__appendChild=HostElementPrototype.appendChild;HostElementPrototype.appendChild=function(newChild){const slotName=newChild["s-sn"]=getSlotName(newChild);const slotNode=getHostSlotNode(this.childNodes,slotName);if(slotNode){const slotChildNodes=getHostSlotChildNodes(slotNode,slotName);const appendAfter=slotChildNodes[slotChildNodes.length-1];return appendAfter.parentNode.insertBefore(newChild,appendAfter.nextSibling)}return this.__appendChild(newChild)}};const patchSlotPrepend=HostElementPrototype=>{const originalPrepend=HostElementPrototype.prepend;HostElementPrototype.prepend=function(...newChildren){newChildren.forEach((newChild=>{if(typeof newChild==="string"){newChild=this.ownerDocument.createTextNode(newChild)}const slotName=newChild["s-sn"]=getSlotName(newChild);const slotNode=getHostSlotNode(this.childNodes,slotName);if(slotNode){const slotPlaceholder=document.createTextNode("");slotPlaceholder["s-nr"]=newChild;slotNode["s-cr"].parentNode.__appendChild(slotPlaceholder);newChild["s-ol"]=slotPlaceholder;const slotChildNodes=getHostSlotChildNodes(slotNode,slotName);const appendAfter=slotChildNodes[0];return appendAfter.parentNode.insertBefore(newChild,appendAfter.nextSibling)}if(newChild.nodeType===1&&!!newChild.getAttribute("slot")){newChild.hidden=true}return originalPrepend.call(this,newChild)}))}};const patchSlotAppend=HostElementPrototype=>{HostElementPrototype.append=function(...newChildren){newChildren.forEach((newChild=>{if(typeof newChild==="string"){newChild=this.ownerDocument.createTextNode(newChild)}this.appendChild(newChild)}))}};const patchSlotInsertAdjacentHTML=HostElementPrototype=>{const originalInsertAdjacentHtml=HostElementPrototype.insertAdjacentHTML;HostElementPrototype.insertAdjacentHTML=function(position,text){if(position!=="afterbegin"&&position!=="beforeend"){return originalInsertAdjacentHtml.call(this,position,text)}const container=this.ownerDocument.createElement("_");let node;container.innerHTML=text;if(position==="afterbegin"){while(node=container.firstChild){this.prepend(node)}}else if(position==="beforeend"){while(node=container.firstChild){this.append(node)}}}};const patchSlotInsertAdjacentText=HostElementPrototype=>{HostElementPrototype.insertAdjacentText=function(position,text){this.insertAdjacentHTML(position,text)}};const patchSlotInsertAdjacentElement=HostElementPrototype=>{const originalInsertAdjacentElement=HostElementPrototype.insertAdjacentElement;HostElementPrototype.insertAdjacentElement=function(position,element){if(position!=="afterbegin"&&position!=="beforeend"){return originalInsertAdjacentElement.call(this,position,element)}if(position==="afterbegin"){this.prepend(element);return element}else if(position==="beforeend"){this.append(element);return element}return element}};const patchTextContent=(hostElementPrototype,cmpMeta)=>{if(cmpMeta.$flags$&2){const descriptor=Object.getOwnPropertyDescriptor(Node.prototype,"textContent");Object.defineProperty(hostElementPrototype,"__textContent",descriptor);Object.defineProperty(hostElementPrototype,"textContent",{get(){var _a;const slotNode=getHostSlotNode(this.childNodes,"");if(((_a=slotNode===null||slotNode===void 0?void 0:slotNode.nextSibling)===null||_a===void 0?void 0:_a.nodeType)===3){return slotNode.nextSibling.textContent}else if(slotNode){return slotNode.textContent}else{return this.__textContent}},set(value){var _a;const slotNode=getHostSlotNode(this.childNodes,"");if(((_a=slotNode===null||slotNode===void 0?void 0:slotNode.nextSibling)===null||_a===void 0?void 0:_a.nodeType)===3){slotNode.nextSibling.textContent=value}else if(slotNode){slotNode.textContent=value}else{this.__textContent=value;const contentRefElm=this["s-cr"];if(contentRefElm){this.insertBefore(contentRefElm,this.firstChild)}}}})}};const patchChildSlotNodes=(elm,cmpMeta)=>{class FakeNodeList extends Array{item(n){return this[n]}}if(cmpMeta.$flags$&8){const childNodesFn=elm.__lookupGetter__("childNodes");Object.defineProperty(elm,"children",{get(){return this.childNodes.map((n=>n.nodeType===1))}});Object.defineProperty(elm,"childElementCount",{get(){return elm.children.length}});Object.defineProperty(elm,"childNodes",{get(){const childNodes=childNodesFn.call(this);if((plt.$flags$&1)===0&&getHostRef(this).$flags$&2){const result=new FakeNodeList;for(let i=0;i<childNodes.length;i++){const slot=childNodes[i]["s-nr"];if(slot){result.push(slot)}}return result}return FakeNodeList.from(childNodes)}})}};const getSlotName=node=>node["s-sn"]||node.nodeType===1&&node.getAttribute("slot")||"";const getHostSlotNode=(childNodes,slotName)=>{let i=0;let childNode;for(;i<childNodes.length;i++){childNode=childNodes[i];if(childNode["s-sr"]&&childNode["s-sn"]===slotName){return childNode}childNode=getHostSlotNode(childNode.childNodes,slotName);if(childNode){return childNode}}return null};const getHostSlotChildNodes=(n,slotName)=>{const childNodes=[n];while((n=n.nextSibling)&&n["s-sn"]===slotName){childNodes.push(n)}return childNodes};const proxyCustomElement=(Cstr,compactMeta)=>{const cmpMeta={$flags$:compactMeta[0],$tagName$:compactMeta[1]};if(BUILD.member){cmpMeta.$members$=compactMeta[2]}if(BUILD.hostListener){cmpMeta.$listeners$=compactMeta[3]}if(BUILD.watchCallback){cmpMeta.$watchers$=Cstr.$watchers$}if(BUILD.reflect){cmpMeta.$attrsToReflect$=[]}if(BUILD.shadowDom&&!supportsShadow&&cmpMeta.$flags$&1){cmpMeta.$flags$|=8}if(BUILD.experimentalSlotFixes&&BUILD.scoped){patchPseudoShadowDom(Cstr.prototype,cmpMeta)}else{if(BUILD.slotChildNodesFix){patchChildSlotNodes(Cstr.prototype,cmpMeta)}if(BUILD.cloneNodeFix){patchCloneNode(Cstr.prototype)}if(BUILD.appendChildSlotFix){patchSlotAppendChild(Cstr.prototype)}if(BUILD.scopedSlotTextContentFix){patchTextContent(Cstr.prototype,cmpMeta)}}const originalConnectedCallback=Cstr.prototype.connectedCallback;const originalDisconnectedCallback=Cstr.prototype.disconnectedCallback;Object.assign(Cstr.prototype,{__registerHost(){registerHost(this,cmpMeta)},connectedCallback(){connectedCallback(this);if(BUILD.connectedCallback&&originalConnectedCallback){originalConnectedCallback.call(this)}},disconnectedCallback(){disconnectedCallback(this);if(BUILD.disconnectedCallback&&originalDisconnectedCallback){originalDisconnectedCallback.call(this)}},__attachShadow(){if(supportsShadow){if(BUILD.shadowDelegatesFocus){this.attachShadow({mode:"open",delegatesFocus:!!(cmpMeta.$flags$&16)})}else{this.attachShadow({mode:"open"})}}else{this.shadowRoot=this}}});Cstr.is=cmpMeta.$tagName$;return proxyComponent(Cstr,cmpMeta)};const addHostEventListeners=(elm,hostRef,listeners,attachParentListeners)=>{if(listeners){listeners.map((([flags,name,method])=>{const target=getHostListenerTarget(elm,flags);const handler=hostListenerProxy(hostRef,method);const opts=hostListenerOpts(flags);plt.ael(target,name,handler,opts);(hostRef.$rmListeners$=hostRef.$rmListeners$||[]).push((()=>plt.rel(target,name,handler,opts)))}))}};const hostListenerProxy=(hostRef,methodName)=>ev=>{try{if(BUILD.lazyLoad);else{hostRef.$hostElement$[methodName](ev)}}catch(e){consoleError(e)}};const getHostListenerTarget=(elm,flags)=>{if(flags&4)return doc;if(flags&8)return win;if(flags&16)return doc.body;return elm};const hostListenerOpts=flags=>supportsListenerOptions?{passive:(flags&1)!==0,capture:(flags&2)!==0}:(flags&2)!==0;const setNonce=nonce=>plt.$nonce$=nonce;const setPlatformOptions=opts=>Object.assign(plt,opts);const hostRefs=new WeakMap;const getHostRef=ref=>hostRefs.get(ref);const registerHost=(hostElement,cmpMeta)=>{const hostRef={$flags$:0,$hostElement$:hostElement,$cmpMeta$:cmpMeta,$instanceValues$:new Map};if(BUILD.isDev){hostRef.$renderCount$=0}if(BUILD.method&&BUILD.lazyLoad){hostRef.$onInstancePromise$=new Promise((r=>hostRef.$onInstanceResolve$=r))}if(BUILD.asyncLoading){hostRef.$onReadyPromise$=new Promise((r=>hostRef.$onReadyResolve$=r));hostElement["s-p"]=[];hostElement["s-rc"]=[]}addHostEventListeners(hostElement,hostRef,cmpMeta.$listeners$);return hostRefs.set(hostElement,hostRef)};const isMemberInElement=(elm,memberName)=>memberName in elm;const consoleError=(e,el)=>(0,console.error)(e,el);const STENCIL_DEV_MODE=BUILD.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"];const consoleDevError=(...m)=>console.error(...STENCIL_DEV_MODE,...m);const consoleDevWarn=(...m)=>console.warn(...STENCIL_DEV_MODE,...m);const styles=new Map;const modeResolutionChain=[];const win=typeof window!=="undefined"?window:{};const doc=win.document||{head:{}};const H=win.HTMLElement||class{};const plt={$flags$:0,$resourcesUrl$:"",jmp:h=>h(),raf:h=>requestAnimationFrame(h),ael:(el,eventName,listener,opts)=>el.addEventListener(eventName,listener,opts),rel:(el,eventName,listener,opts)=>el.removeEventListener(eventName,listener,opts),ce:(eventName,opts)=>new CustomEvent(eventName,opts)};const supportsShadow=BUILD.shadowDomShim&&BUILD.shadowDom?(()=>(doc.head.attachShadow+"").indexOf("[native")>-1)():true;const supportsListenerOptions=(()=>{let supportsListenerOptions=false;try{doc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){supportsListenerOptions=true}}))}catch(e){}return supportsListenerOptions})();const promiseResolve=v=>Promise.resolve(v);const supportsConstructableStylesheets=BUILD.constructableCSS?(()=>{try{new CSSStyleSheet;return typeof(new CSSStyleSheet).replaceSync==="function"}catch(e){}return false})():false;const queueDomReads=[];const queueDomWrites=[];const queueTask=(queue,write)=>cb=>{queue.push(cb);if(!queuePending){queuePending=true;if(write&&plt.$flags$&4){nextTick(flush)}else{plt.raf(flush)}}};const consume=queue=>{for(let i=0;i<queue.length;i++){try{queue[i](performance.now())}catch(e){consoleError(e)}}queue.length=0};const flush=()=>{consume(queueDomReads);{consume(queueDomWrites);if(queuePending=queueDomReads.length>0){plt.raf(flush)}}};const nextTick=cb=>promiseResolve().then(cb);const writeTask=queueTask(queueDomWrites,true);var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;var freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal$1||freeSelf||Function("return this")();var root$1=root;var Symbol$1=root$1.Symbol;var Symbol$2=Symbol$1;var objectProto$j=Object.prototype;var hasOwnProperty$h=objectProto$j.hasOwnProperty;var nativeObjectToString$1=objectProto$j.toString;var symToStringTag$1=Symbol$2?Symbol$2.toStringTag:undefined;function getRawTag(value){var isOwn=hasOwnProperty$h.call(value,symToStringTag$1),tag=value[symToStringTag$1];try{value[symToStringTag$1]=undefined;var unmasked=true}catch(e){}var result=nativeObjectToString$1.call(value);if(unmasked){if(isOwn){value[symToStringTag$1]=tag}else{delete value[symToStringTag$1]}}return result}var objectProto$i=Object.prototype;var nativeObjectToString=objectProto$i.toString;function objectToString(value){return nativeObjectToString.call(value)}var nullTag="[object Null]",undefinedTag="[object Undefined]";var symToStringTag=Symbol$2?Symbol$2.toStringTag:undefined;function baseGetTag(value){if(value==null){return value===undefined?undefinedTag:nullTag}return symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function isObjectLike(value){return value!=null&&typeof value=="object"}var symbolTag$3="[object Symbol]";function isSymbol$2(value){return typeof value=="symbol"||isObjectLike(value)&&baseGetTag(value)==symbolTag$3}function arrayMap(array,iteratee){var index=-1,length=array==null?0:array.length,result=Array(length);while(++index<length){result[index]=iteratee(array[index],index,array)}return result}var isArray=Array.isArray;var isArray$1=isArray;var INFINITY$2=1/0;var symbolProto$2=Symbol$2?Symbol$2.prototype:undefined,symbolToString=symbolProto$2?symbolProto$2.toString:undefined;function baseToString(value){if(typeof value=="string"){return value}if(isArray$1(value)){return arrayMap(value,baseToString)+""}if(isSymbol$2(value)){return symbolToString?symbolToString.call(value):""}var result=value+"";return result=="0"&&1/value==-INFINITY$2?"-0":result}function isObject$1(value){var type=typeof value;return value!=null&&(type=="object"||type=="function")}function identity(value){return value}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(value){if(!isObject$1(value)){return false}var tag=baseGetTag(value);return tag==funcTag$2||tag==genTag$1||tag==asyncTag||tag==proxyTag}var coreJsData=root$1["__core-js_shared__"];var coreJsData$1=coreJsData;var maskSrcKey=function(){var uid=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return uid?"Symbol(src)_1."+uid:""}();function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}var funcProto$2=Function.prototype;var funcToString$2=funcProto$2.toString;function toSource(func){if(func!=null){try{return funcToString$2.call(func)}catch(e){}try{return func+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g;var reIsHostCtor=/^\[object .+?Constructor\]$/;var funcProto$1=Function.prototype,objectProto$h=Object.prototype;var funcToString$1=funcProto$1.toString;var hasOwnProperty$g=objectProto$h.hasOwnProperty;var reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$g).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(value){if(!isObject$1(value)||isMasked(value)){return false}var pattern=isFunction$1(value)?reIsNative:reIsHostCtor;return pattern.test(toSource(value))}function getValue$1(object,key){return object==null?undefined:object[key]}function getNative(object,key){var value=getValue$1(object,key);return baseIsNative(value)?value:undefined}var WeakMap$1=getNative(root$1,"WeakMap");var WeakMap$1$1=WeakMap$1;var objectCreate=Object.create;var baseCreate=function(){function object(){}return function(proto){if(!isObject$1(proto)){return{}}if(objectCreate){return objectCreate(proto)}object.prototype=proto;var result=new object;object.prototype=undefined;return result}}();var baseCreate$1=baseCreate;function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function noop$1(){}function copyArray(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index]}return array}var HOT_COUNT=800,HOT_SPAN=16;var nativeNow=Date.now;function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=HOT_SPAN-(stamp-lastCalled);lastCalled=stamp;if(remaining>0){if(++count>=HOT_COUNT){return arguments[0]}}else{count=0}return func.apply(undefined,arguments)}}function constant(value){return function(){return value}}var defineProperty$2=function(){try{var func=getNative(Object,"defineProperty");func({},"",{});return func}catch(e){}}();var defineProperty$3=defineProperty$2;var baseSetToString=!defineProperty$3?identity:function(func,string){return defineProperty$3(func,"toString",{configurable:true,enumerable:false,value:constant(string),writable:true})};var baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);var setToString$1=setToString;function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}function baseFindIndex(array,predicate,fromIndex,fromRight){var length=array.length,index=fromIndex+(fromRight?1:-1);while(fromRight?index--:++index<length){if(predicate(array[index],index,array)){return index}}return-1}function baseIsNaN(value){return value!==value}function strictIndexOf(array,value,fromIndex){var index=fromIndex-1,length=array.length;while(++index<length){if(array[index]===value){return index}}return-1}function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}function arrayIncludes(array,value){var length=array==null?0:array.length;return!!length&&baseIndexOf(array,value,0)>-1}var MAX_SAFE_INTEGER$1=9007199254740991;var reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(value,length){var type=typeof value;length=length==null?MAX_SAFE_INTEGER$1:length;return!!length&&(type=="number"||type!="symbol"&&reIsUint.test(value))&&(value>-1&&value%1==0&&value<length)}function baseAssignValue(object,key,value){if(key=="__proto__"&&defineProperty$3){defineProperty$3(object,key,{configurable:true,enumerable:true,value,writable:true})}else{object[key]=value}}function eq(value,other){return value===other||value!==value&&other!==other}var objectProto$g=Object.prototype;var hasOwnProperty$f=objectProto$g.hasOwnProperty;function assignValue(object,key,value){var objValue=object[key];if(!(hasOwnProperty$f.call(object,key)&&eq(objValue,value))||value===undefined&&!(key in object)){baseAssignValue(object,key,value)}}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];var newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;if(newValue===undefined){newValue=source[key]}if(isNew){baseAssignValue(object,key,newValue)}else{assignValue(object,key,newValue)}}return object}var nativeMax=Math.max;function overRest(func,start,transform){start=nativeMax(start===undefined?func.length-1:start,0);return function(){var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);while(++index<length){array[index]=args[start+index]}index=-1;var otherArgs=Array(start+1);while(++index<start){otherArgs[index]=args[index]}otherArgs[start]=transform(array);return apply(func,this,otherArgs)}}function baseRest(func,start){return setToString$1(overRest(func,start,identity),func+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isArrayLike(value){return value!=null&&isLength(value.length)&&!isFunction$1(value)}function isIterateeCall(value,index,object){if(!isObject$1(object)){return false}var type=typeof index;if(type=="number"?isArrayLike(object)&&isIndex(index,object.length):type=="string"&&index in object){return eq(object[index],value)}return false}function createAssigner(assigner){return baseRest((function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:undefined,guard=length>2?sources[2]:undefined;customizer=assigner.length>3&&typeof customizer=="function"?(length--,customizer):undefined;if(guard&&isIterateeCall(sources[0],sources[1],guard)){customizer=length<3?undefined:customizer;length=1}object=Object(object);while(++index<length){var source=sources[index];if(source){assigner(object,source,index,customizer)}}return object}))}var objectProto$f=Object.prototype;function isPrototype$1(value){var Ctor=value&&value.constructor,proto=typeof Ctor=="function"&&Ctor.prototype||objectProto$f;return value===proto}function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index)}return result}var argsTag$3="[object Arguments]";function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag$3}var objectProto$e=Object.prototype;var hasOwnProperty$e=objectProto$e.hasOwnProperty;var propertyIsEnumerable$1=objectProto$e.propertyIsEnumerable;var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$e.call(value,"callee")&&!propertyIsEnumerable$1.call(value,"callee")};var isArguments$1=isArguments;function stubFalse(){return false}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2;var Buffer$1=moduleExports$2?root$1.Buffer:undefined;var nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:undefined;var isBuffer=nativeIsBuffer||stubFalse;var isBuffer$1=isBuffer;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$3="[object Error]",funcTag$1="[object Function]",mapTag$6="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$6="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]";var arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=true;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$3]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$6]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$6]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=false;function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1;var freeProcess=moduleExports$1&&freeGlobal$1.process;var nodeUtil=function(){try{var types=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;if(types){return types}return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();var nodeUtil$1=nodeUtil;var nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray;var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;var isTypedArray$1=isTypedArray;var objectProto$d=Object.prototype;var hasOwnProperty$d=objectProto$d.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=isArray$1(value),isArg=!isArr&&isArguments$1(value),isBuff=!isArr&&!isArg&&isBuffer$1(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray$1(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty$d.call(value,key))&&!(skipIndexes&&(key=="length"||isBuff&&(key=="offset"||key=="parent")||isType&&(key=="buffer"||key=="byteLength"||key=="byteOffset")||isIndex(key,length)))){result.push(key)}}return result}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object);var nativeKeys$1=nativeKeys;var objectProto$c=Object.prototype;var hasOwnProperty$c=objectProto$c.hasOwnProperty;function baseKeys(object){if(!isPrototype$1(object)){return nativeKeys$1(object)}var result=[];for(var key in Object(object)){if(hasOwnProperty$c.call(object,key)&&key!="constructor"){result.push(key)}}return result}function keys$3(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}var objectProto$b=Object.prototype;var hasOwnProperty$b=objectProto$b.hasOwnProperty;var assign$2=createAssigner((function(object,source){if(isPrototype$1(source)||isArrayLike(source)){copyObject(source,keys$3(source),object);return}for(var key in source){if(hasOwnProperty$b.call(source,key)){assignValue(object,key,source[key])}}}));var assign$3=assign$2;function nativeKeysIn(object){var result=[];if(object!=null){for(var key in Object(object)){result.push(key)}}return result}var objectProto$a=Object.prototype;var hasOwnProperty$a=objectProto$a.hasOwnProperty;function baseKeysIn(object){if(!isObject$1(object)){return nativeKeysIn(object)}var isProto=isPrototype$1(object),result=[];for(var key in object){if(!(key=="constructor"&&(isProto||!hasOwnProperty$a.call(object,key)))){result.push(key)}}return result}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,true):baseKeysIn(object)}var assignInWith=createAssigner((function(object,source,srcIndex,customizer){copyObject(source,keysIn(source),object,customizer)}));var extendWith=assignInWith;var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(value,object){if(isArray$1(value)){return false}var type=typeof value;if(type=="number"||type=="symbol"||type=="boolean"||value==null||isSymbol$2(value)){return true}return reIsPlainProp.test(value)||!reIsDeepProp.test(value)||object!=null&&value in Object(object)}var nativeCreate=getNative(Object,"create");var nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{};this.size=0}function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];this.size-=result?1:0;return result}var HASH_UNDEFINED$2="__lodash_hash_undefined__";var objectProto$9=Object.prototype;var hasOwnProperty$9=objectProto$9.hasOwnProperty;function hashGet(key){var data=this.__data__;if(nativeCreate$1){var result=data[key];return result===HASH_UNDEFINED$2?undefined:result}return hasOwnProperty$9.call(data,key)?data[key]:undefined}var objectProto$8=Object.prototype;var hasOwnProperty$8=objectProto$8.hasOwnProperty;function hashHas(key){var data=this.__data__;return nativeCreate$1?data[key]!==undefined:hasOwnProperty$8.call(data,key)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(key,value){var data=this.__data__;this.size+=this.has(key)?0:1;data[key]=nativeCreate$1&&value===undefined?HASH_UNDEFINED$1:value;return this}function Hash(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear;Hash.prototype["delete"]=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[];this.size=0}function assocIndexOf(array,key){var length=array.length;while(length--){if(eq(array[length][0],key)){return length}}return-1}var arrayProto=Array.prototype;var splice=arrayProto.splice;function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){return false}var lastIndex=data.length-1;if(index==lastIndex){data.pop()}else{splice.call(data,index,1)}--this.size;return true}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){++this.size;data.push([key,value])}else{data[index][1]=value}return this}function ListCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype["delete"]=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map");var Map$2=Map$1;function mapCacheClear(){this.size=0;this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(value){var type=typeof value;return type=="string"||type=="number"||type=="symbol"||type=="boolean"?value!=="__proto__":value===null}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data[typeof key=="string"?"string":"hash"]:data.map}function mapCacheDelete(key){var result=getMapData(this,key)["delete"](key);this.size-=result?1:0;return result}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){var data=getMapData(this,key),size=data.size;data.set(key,value);this.size+=data.size==size?0:1;return this}function MapCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype["delete"]=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$1="Expected a function";function memoize$2(func,resolver){if(typeof func!="function"||resolver!=null&&typeof resolver!="function"){throw new TypeError(FUNC_ERROR_TEXT$1)}var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key)}var result=func.apply(this,args);memoized.cache=cache.set(key,result)||cache;return result};memoized.cache=new(memoize$2.Cache||MapCache);return memoized}memoize$2.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(func){var result=memoize$2(func,(function(key){if(cache.size===MAX_MEMOIZE_SIZE){cache.clear()}return key}));var cache=result.cache;return result}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=memoizeCapped((function(string){var result=[];if(string.charCodeAt(0)===46){result.push("")}string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}));return result}));var stringToPath$1=stringToPath;function toString(value){return value==null?"":baseToString(value)}function castPath(value,object){if(isArray$1(value)){return value}return isKey(value,object)?[value]:stringToPath$1(toString(value))}var INFINITY$1=1/0;function toKey(value){if(typeof value=="string"||isSymbol$2(value)){return value}var result=value+"";return result=="0"&&1/value==-INFINITY$1?"-0":result}function baseGet(object,path){path=castPath(path,object);var index=0,length=path.length;while(object!=null&&index<length){object=object[toKey(path[index++])]}return index&&index==length?object:undefined}function get(object,path,defaultValue){var result=object==null?undefined:baseGet(object,path);return result===undefined?defaultValue:result}function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length){array[offset+index]=values[index]}return array}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:undefined;function isFlattenable(value){return isArray$1(value)||isArguments$1(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;predicate||(predicate=isFlattenable);result||(result=[]);while(++index<length){var value=array[index];if(depth>0&&predicate(value)){if(depth>1){baseFlatten(value,depth-1,predicate,isStrict,result)}else{arrayPush(result,value)}}else if(!isStrict){result[result.length]=value}}return result}function flatten(array){var length=array==null?0:array.length;return length?baseFlatten(array,1):[]}function flatRest(func){return setToString$1(overRest(func,undefined,flatten),func+"")}var getPrototype=overArg(Object.getPrototypeOf,Object);var getPrototype$1=getPrototype;var objectTag$3="[object Object]";var funcProto=Function.prototype,objectProto$7=Object.prototype;var funcToString=funcProto.toString;var hasOwnProperty$7=objectProto$7.hasOwnProperty;var objectCtorString=funcToString.call(Object);function isPlainObject(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag$3){return false}var proto=getPrototype$1(value);if(proto===null){return true}var Ctor=hasOwnProperty$7.call(proto,"constructor")&&proto.constructor;return typeof Ctor=="function"&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}var domExcTag="[object DOMException]",errorTag$2="[object Error]";function isError(value){if(!isObjectLike(value)){return false}var tag=baseGetTag(value);return tag==errorTag$2||tag==domExcTag||typeof value.message=="string"&&typeof value.name=="string"&&!isPlainObject(value)}var attempt=baseRest((function(func,args){try{return apply(func,undefined,args)}catch(e){return isError(e)?e:new Error(e)}}));var attempt$1=attempt;function baseSlice(array,start,end){var index=-1,length=array.length;if(start<0){start=-start>length?0:length+start}end=end>length?length:end;if(end<0){end+=length}length=start>end?0:end-start>>>0;start>>>=0;var result=Array(length);while(++index<length){result[index]=array[index+start]}return result}function basePropertyOf(object){return function(key){return object==null?undefined:object[key]}}function stackClear(){this.__data__=new ListCache;this.size=0}function stackDelete(key){var data=this.__data__,result=data["delete"](key);this.size=data.size;return result}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}var LARGE_ARRAY_SIZE$1=200;function stackSet(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map$2||pairs.length<LARGE_ARRAY_SIZE$1-1){pairs.push([key,value]);this.size=++data.size;return this}data=this.__data__=new MapCache(pairs)}data.set(key,value);this.size=data.size;return this}function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear;Stack.prototype["delete"]=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(object,source){return object&&copyObject(source,keys$3(source),object)}function baseAssignIn(object,source){return object&&copyObject(source,keysIn(source),object)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports;var Buffer=moduleExports?root$1.Buffer:undefined,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined;function cloneBuffer(buffer,isDeep){if(isDeep){return buffer.slice()}var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);buffer.copy(result);return result}function arrayFilter(array,predicate){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(predicate(value,index,array)){result[resIndex++]=value}}return result}function stubArray(){return[]}var objectProto$6=Object.prototype;var propertyIsEnumerable=objectProto$6.propertyIsEnumerable;var nativeGetSymbols$1=Object.getOwnPropertySymbols;var getSymbols=!nativeGetSymbols$1?stubArray:function(object){if(object==null){return[]}object=Object(object);return arrayFilter(nativeGetSymbols$1(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)}))};var getSymbols$1=getSymbols;function copySymbols(source,object){return copyObject(source,getSymbols$1(source),object)}var nativeGetSymbols=Object.getOwnPropertySymbols;var getSymbolsIn=!nativeGetSymbols?stubArray:function(object){var result=[];while(object){arrayPush(result,getSymbols$1(object));object=getPrototype$1(object)}return result};var getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(source,object){return copyObject(source,getSymbolsIn$1(source),object)}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray$1(object)?result:arrayPush(result,symbolsFunc(object))}function getAllKeys(object){return baseGetAllKeys(object,keys$3,getSymbols$1)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn$1)}var DataView=getNative(root$1,"DataView");var DataView$1=DataView;var Promise$1=getNative(root$1,"Promise");var Promise$2=Promise$1;var Set$1=getNative(root$1,"Set");var Set$2=Set$1;var mapTag$5="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$5="[object Set]",weakMapTag$1="[object WeakMap]";var dataViewTag$3="[object DataView]";var dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$1$1);var getTag=baseGetTag;if(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$5||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$5||WeakMap$1$1&&getTag(new WeakMap$1$1)!=weakMapTag$1){getTag=function(value){var result=baseGetTag(value),Ctor=result==objectTag$2?value.constructor:undefined,ctorString=Ctor?toSource(Ctor):"";if(ctorString){switch(ctorString){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$5;case promiseCtorString:return promiseTag;case setCtorString:return setTag$5;case weakMapCtorString:return weakMapTag$1}}return result}}var getTag$1=getTag;var objectProto$5=Object.prototype;var hasOwnProperty$6=objectProto$5.hasOwnProperty;function initCloneArray(array){var length=array.length,result=new array.constructor(length);if(length&&typeof array[0]=="string"&&hasOwnProperty$6.call(array,"index")){result.index=array.index;result.input=array.input}return result}var Uint8Array=root$1.Uint8Array;var Uint8Array$1=Uint8Array;function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);new Uint8Array$1(result).set(new Uint8Array$1(arrayBuffer));return result}function cloneDataView(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}var reFlags=/\w*$/;function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));result.lastIndex=regexp.lastIndex;return result}var symbolProto$1=Symbol$2?Symbol$2.prototype:undefined,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:undefined;function cloneSymbol(symbol){return symbolValueOf$1?Object(symbolValueOf$1.call(symbol)):{}}function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$4="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]";var arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag$2:return cloneArrayBuffer(object);case boolTag$2:case dateTag$2:return new Ctor(+object);case dataViewTag$2:return cloneDataView(object,isDeep);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(object,isDeep);case mapTag$4:return new Ctor;case numberTag$2:case stringTag$2:return new Ctor(object);case regexpTag$2:return cloneRegExp(object);case setTag$4:return new Ctor;case symbolTag$2:return cloneSymbol(object)}}function initCloneObject(object){return typeof object.constructor=="function"&&!isPrototype$1(object)?baseCreate$1(getPrototype$1(object)):{}}var mapTag$3="[object Map]";function baseIsMap(value){return isObjectLike(value)&&getTag$1(value)==mapTag$3}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap;var isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;var isMap$1=isMap;var setTag$3="[object Set]";function baseIsSet(value){return isObjectLike(value)&&getTag$1(value)==setTag$3}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet;var isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;var isSet$1=isSet;var CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$2=4;var argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$2="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]";var arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$2]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$2]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=true;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=false;function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG$2,isFlat=bitmask&CLONE_FLAT_FLAG$1,isFull=bitmask&CLONE_SYMBOLS_FLAG$2;if(customizer){result=object?customizer(value,key,object,stack):customizer(value)}if(result!==undefined){return result}if(!isObject$1(value)){return value}var isArr=isArray$1(value);if(isArr){result=initCloneArray(value);if(!isDeep){return copyArray(value,result)}}else{var tag=getTag$1(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer$1(value)){return cloneBuffer(value,isDeep)}if(tag==objectTag$1||tag==argsTag$1||isFunc&&!object){result=isFlat||isFunc?{}:initCloneObject(value);if(!isDeep){return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}}else{if(!cloneableTags[tag]){return object?value:{}}result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked){return stacked}stack.set(value,result);if(isSet$1(value)){value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}))}else if(isMap$1(value)){value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}))}var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys$3;var props=isArr?undefined:keysFunc(value);arrayEach(props||value,(function(subValue,key){if(props){key=subValue;subValue=value[key]}assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}));return result}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(value){this.__data__.set(value,HASH_UNDEFINED);return this}function setCacheHas(value){return this.__data__.has(value)}function SetCache(values){var index=-1,length=values==null?0:values.length;this.__data__=new MapCache;while(++index<length){this.add(values[index])}}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(array,predicate){var index=-1,length=array==null?0:array.length;while(++index<length){if(predicate(array[index],index,array)){return true}}return false}function cacheHas(cache,key){return cache.has(key)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$5,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength)){return false}var arrStacked=stack.get(array);var othStacked=stack.get(other);if(arrStacked&&othStacked){return arrStacked==other&&othStacked==array}var index=-1,result=true,seen=bitmask&COMPARE_UNORDERED_FLAG$3?new SetCache:undefined;stack.set(array,other);stack.set(other,array);while(++index<arrLength){var arrValue=array[index],othValue=other[index];if(customizer){var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack)}if(compared!==undefined){if(compared){continue}result=false;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){return seen.push(othIndex)}}))){result=false;break}}else if(!(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))){result=false;break}}stack["delete"](array);stack["delete"](other);return result}function mapToArray(map){var index=-1,result=Array(map.size);map.forEach((function(value,key){result[++index]=[key,value]}));return result}function setToArray(set){var index=-1,result=Array(set.size);set.forEach((function(value){result[++index]=value}));return result}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;var boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag$1="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag$1="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]";var arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]";var symbolProto=Symbol$2?Symbol$2.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined;function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset){return false}object=object.buffer;other=other.buffer;case arrayBufferTag:if(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array$1(object),new Uint8Array$1(other))){return false}return true;case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag$1:var convert=mapToArray;case setTag$1:var isPartial=bitmask&COMPARE_PARTIAL_FLAG$4;convert||(convert=setToArray);if(object.size!=other.size&&!isPartial){return false}var stacked=stack.get(object);if(stacked){return stacked==other}bitmask|=COMPARE_UNORDERED_FLAG$2;stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);stack["delete"](object);return result;case symbolTag:if(symbolValueOf){return symbolValueOf.call(object)==symbolValueOf.call(other)}}return false}var COMPARE_PARTIAL_FLAG$3=1;var objectProto$4=Object.prototype;var hasOwnProperty$5=objectProto$4.hasOwnProperty;function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG$3,objProps=getAllKeys(object),objLength=objProps.length,othProps=getAllKeys(other),othLength=othProps.length;if(objLength!=othLength&&!isPartial){return false}var index=objLength;while(index--){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty$5.call(other,key))){return false}}var objStacked=stack.get(object);var othStacked=stack.get(other);if(objStacked&&othStacked){return objStacked==other&&othStacked==object}var result=true;stack.set(object,other);stack.set(other,object);var skipCtor=isPartial;while(++index<objLength){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer){var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack)}if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=false;break}skipCtor||(skipCtor=key=="constructor")}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&("constructor"in object&&"constructor"in other)&&!(typeof objCtor=="function"&&objCtor instanceof objCtor&&typeof othCtor=="function"&&othCtor instanceof othCtor)){result=false}}stack["delete"](object);stack["delete"](other);return result}var COMPARE_PARTIAL_FLAG$2=1;var argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]";var objectProto$3=Object.prototype;var hasOwnProperty$4=objectProto$3.hasOwnProperty;function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray$1(object),othIsArr=isArray$1(other),objTag=objIsArr?arrayTag:getTag$1(object),othTag=othIsArr?arrayTag:getTag$1(other);objTag=objTag==argsTag?objectTag:objTag;othTag=othTag==argsTag?objectTag:othTag;var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer$1(object)){if(!isBuffer$1(other)){return false}objIsArr=true;objIsObj=false}if(isSameTag&&!objIsObj){stack||(stack=new Stack);return objIsArr||isTypedArray$1(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack)}if(!(bitmask&COMPARE_PARTIAL_FLAG$2)){var objIsWrapped=objIsObj&&hasOwnProperty$4.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty$4.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;stack||(stack=new Stack);return equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}if(!isSameTag){return false}stack||(stack=new Stack);return equalObjects(object,other,bitmask,customizer,equalFunc,stack)}function baseIsEqual(value,other,bitmask,customizer,stack){if(value===other){return true}if(value==null||other==null||!isObjectLike(value)&&!isObjectLike(other)){return value!==value&&other!==other}return baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(object==null){return!length}object=Object(object);while(index--){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object)){return false}}while(++index<length){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object)){return false}}else{var stack=new Stack;if(customizer){var result=customizer(objValue,srcValue,key,object,source,stack)}if(!(result===undefined?baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,customizer,stack):result)){return false}}}return true}function isStrictComparable(value){return value===value&&!isObject$1(value)}function getMatchData(object){var result=keys$3(object),length=result.length;while(length--){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function matchesStrictComparable(key,srcValue){return function(object){if(object==null){return false}return object[key]===srcValue&&(srcValue!==undefined||key in Object(object))}}function baseMatches(source){var matchData=getMatchData(source);if(matchData.length==1&&matchData[0][2]){return matchesStrictComparable(matchData[0][0],matchData[0][1])}return function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseHasIn(object,key){return object!=null&&key in Object(object)}function hasPath(object,path,hasFunc){path=castPath(path,object);var index=-1,length=path.length,result=false;while(++index<length){var key=toKey(path[index]);if(!(result=object!=null&&hasFunc(object,key))){break}object=object[key]}if(result||++index!=length){return result}length=object==null?0:object.length;return!!length&&isLength(length)&&isIndex(key,length)&&(isArray$1(object)||isArguments$1(object))}function hasIn(object,path){return object!=null&&hasPath(object,path,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(path,srcValue){if(isKey(path)&&isStrictComparable(srcValue)){return matchesStrictComparable(toKey(path),srcValue)}return function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(key){return function(object){return object==null?undefined:object[key]}}function basePropertyDeep(path){return function(object){return baseGet(object,path)}}function property(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}function baseIteratee(value){if(typeof value=="function"){return value}if(value==null){return identity}if(typeof value=="object"){return isArray$1(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value)}return property(value)}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;while(length--){var key=props[fromRight?length:++index];if(iteratee(iterable[key],key,iterable)===false){break}}return object}}var baseFor=createBaseFor();var baseFor$1=baseFor;function baseForOwn(object,iteratee){return object&&baseFor$1(object,iteratee,keys$3)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function arrayIncludesWith(array,value,comparator){var index=-1,length=array==null?0:array.length;while(++index<length){if(comparator(value,array[index])){return true}}return false}function last(array){var length=array==null?0:array.length;return length?array[length-1]:undefined}var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var escapeHtmlChar=basePropertyOf(htmlEscapes);var escapeHtmlChar$1=escapeHtmlChar;var reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape(string){string=toString(string);return string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar$1):string}function baseValues(object,props){return arrayMap(props,(function(key){return object[key]}))}var nativeMin=Math.min;function baseIntersection(arrays,iteratee,comparator){var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=Infinity,result=[];while(othIndex--){var array=arrays[othIndex];if(othIndex&&iteratee){array=arrayMap(array,baseUnary(iteratee))}maxLength=nativeMin(array.length,maxLength);caches[othIndex]=!comparator&&(iteratee||length>=120&&array.length>=120)?new SetCache(othIndex&&array):undefined}array=arrays[0];var index=-1,seen=caches[0];outer:while(++index<length&&result.length<maxLength){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){othIndex=othLength;while(--othIndex){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator))){continue outer}}if(seen){seen.push(computed)}result.push(value)}}return result}function castArrayLikeObject(value){return isArrayLikeObject(value)?value:[]}baseRest((function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);if(iteratee===last(mapped)){iteratee=undefined}else{mapped.pop()}return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,baseIteratee(iteratee)):[]}));function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}var mapTag="[object Map]",setTag="[object Set]";var objectProto$2=Object.prototype;var hasOwnProperty$3=objectProto$2.hasOwnProperty;function isEmpty(value){if(value==null){return true}if(isArrayLike(value)&&(isArray$1(value)||typeof value=="string"||typeof value.splice=="function"||isBuffer$1(value)||isTypedArray$1(value)||isArguments$1(value))){return!value.length}var tag=getTag$1(value);if(tag==mapTag||tag==setTag){return!value.size}if(isPrototype$1(value)){return!baseKeys(value).length}for(var key in value){if(hasOwnProperty$3.call(value,key)){return false}}return true}function isEqual(value,other){return baseIsEqual(value,other)}function mapValues(object,iteratee){var result={};iteratee=baseIteratee(iteratee);baseForOwn(object,(function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object))}));return result}var FUNC_ERROR_TEXT="Expected a function";function negate(predicate){if(typeof predicate!="function"){throw new TypeError(FUNC_ERROR_TEXT)}return function(){var args=arguments;switch(args.length){case 0:return!predicate.call(this);case 1:return!predicate.call(this,args[0]);case 2:return!predicate.call(this,args[0],args[1]);case 3:return!predicate.call(this,args[0],args[1],args[2])}return!predicate.apply(this,args)}}function baseUnset(object,path){path=castPath(path,object);object=parent(object,path);return object==null||delete object[toKey(last(path))]}function customOmitClone(value){return isPlainObject(value)?undefined:value}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4;var omit=flatRest((function(object,paths){var result={};if(object==null){return result}var isDeep=false;paths=arrayMap(paths,(function(path){path=castPath(path,object);isDeep||(isDeep=path.length>1);return path}));copyObject(object,getAllKeysIn(object),result);if(isDeep){result=baseClone(result,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone)}var length=paths.length;while(length--){baseUnset(result,paths[length])}return result}));var omit$1=omit;function baseSet(object,path,value,customizer){if(!isObject$1(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(key==="__proto__"||key==="constructor"||key==="prototype"){return object}if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject$1(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}function basePickBy(object,paths,predicate){var index=-1,length=paths.length,result={};while(++index<length){var path=paths[index],value=baseGet(object,path);if(predicate(value,path)){baseSet(result,castPath(path,object),value)}}return result}function pickBy(object,predicate){if(object==null){return{}}var props=arrayMap(getAllKeysIn(object),(function(prop){return[prop]}));predicate=baseIteratee(predicate);return basePickBy(object,props,(function(value,path){return predicate(value,path[0])}))}function omitBy(object,predicate){return pickBy(object,negate(baseIteratee(predicate)))}function basePick(object,paths){return basePickBy(object,paths,(function(value,path){return hasIn(object,path)}))}var pick=flatRest((function(object,paths){return object==null?{}:basePick(object,paths)}));var pick$1=pick;function set(object,path,value){return object==null?object:baseSet(object,path,value)}var objectProto$1=Object.prototype;var hasOwnProperty$2=objectProto$1.hasOwnProperty;function customDefaultsAssignIn(objValue,srcValue,key,object){if(objValue===undefined||eq(objValue,objectProto$1[key])&&!hasOwnProperty$2.call(object,key)){return srcValue}return objValue}var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function escapeStringChar(chr){return"\\"+stringEscapes[chr]}var reInterpolate=/<%=([\s\S]+?)%>/g;var reInterpolate$1=reInterpolate;var reEscape=/<%-([\s\S]+?)%>/g;var reEscape$1=reEscape;var reEvaluate=/<%([\s\S]+?)%>/g;var reEvaluate$1=reEvaluate;var templateSettings={escape:reEscape$1,evaluate:reEvaluate$1,interpolate:reInterpolate$1,variable:"",imports:{_:{escape}}};var templateSettings$1=templateSettings;var INVALID_TEMPL_VAR_ERROR_TEXT="Invalid `variable` option passed into `_.template`";var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reNoMatch=/($^)/;var reUnescapedString=/['\n\r\u2028\u2029\\]/g;var objectProto=Object.prototype;var hasOwnProperty$1=objectProto.hasOwnProperty;function template(string,options,guard){var settings=templateSettings$1.imports._.templateSettings||templateSettings$1;if(guard&&isIterateeCall(string,options,guard)){options=undefined}string=toString(string);options=extendWith({},options,settings,customDefaultsAssignIn);var imports=extendWith({},options.imports,settings.imports,customDefaultsAssignIn),importsKeys=keys$3(imports),importsValues=baseValues(imports,importsKeys);var isEscaping,isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate$1?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");var sourceURL=hasOwnProperty$1.call(options,"sourceURL")?"//# sourceURL="+(options.sourceURL+"").replace(/\s/g," ")+"\n":"";string.replace(reDelimiters,(function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){isEscaping=true;source+="' +\n__e("+escapeValue+") +\n'"}if(evaluateValue){isEvaluating=true;source+="';\n"+evaluateValue+";\n__p += '"}if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}index=offset+match.length;return match}));source+="';\n";var variable=hasOwnProperty$1.call(options,"variable")&&options.variable;if(!variable){source="with (obj) {\n"+source+"\n}\n"}else if(reForbiddenIdentifierChars.test(variable)){throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT)}source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;");source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt$1((function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)}));result.source=source;if(isError(result)){throw result}return result}var INFINITY=1/0;var createSet=!(Set$2&&1/setToArray(new Set$2([,-0]))[1]==INFINITY)?noop$1:function(values){return new Set$2(values)};var createSet$1=createSet;var LARGE_ARRAY_SIZE=200;function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=true,result=[],seen=result;if(comparator){isCommon=false;includes=arrayIncludesWith}else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet$1(array);if(set){return setToArray(set)}isCommon=false;includes=cacheHas;seen=new SetCache}else{seen=iteratee?[]:result}outer:while(++index<length){var value=array[index],computed=iteratee?iteratee(value):value;value=comparator||value!==0?value:0;if(isCommon&&computed===computed){var seenIndex=seen.length;while(seenIndex--){if(seen[seenIndex]===computed){continue outer}}if(iteratee){seen.push(computed)}result.push(value)}else if(!includes(seen,computed,comparator)){if(seen!==result){seen.push(computed)}result.push(value)}}return result}baseRest((function(arrays){var iteratee=last(arrays);if(isArrayLikeObject(iteratee)){iteratee=undefined}return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,true),baseIteratee(iteratee))}));function uniqWith(array,comparator){comparator=typeof comparator=="function"?comparator:undefined;return array&&array.length?baseUniq(array,undefined,comparator):[]}const UIInputStatus={IDLE:"idle",VALID:"valid",INVALID:"invalid"};function removeEmptyObjects(obj){let nonEmptyObjects;nonEmptyObjects=pickBy(obj,isPlainObject);nonEmptyObjects=mapValues(nonEmptyObjects,removeEmptyObjects);nonEmptyObjects=omitBy(nonEmptyObjects,isEmpty);nonEmptyObjects=assign$3(omitBy(obj,isPlainObject),nonEmptyObjects);return nonEmptyObjects}function isEveryPropertyEmpty(value){let isAllPropsEmpty=true;if(typeof value==="object"&&isArray$1(value)===false){for(const prop in value){const propValue=value?.[prop];if(value.hasOwnProperty(prop)===true&&propValue!==undefined&&propValue!==null&&propValue!==""){isAllPropsEmpty=false;break}}}return isAllPropsEmpty}function isEmptyDataItem(value){return value===undefined||value===null||typeof value==="string"&&value===""||isPlainObject(value)&&isEmpty(value)||Array.isArray(value)&&value.length<1||typeof value==="object"&&isArray$1(value)===false&&isEveryPropertyEmpty(value)}async function request(url,options){return request$1__default["default"](url,options)}const SupportedLocales={Arabic:"ar",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Czech:"cs",Danish:"da",German:"de",Greek:"el",English:"en",EnglishUSA:"en-US",Spanish:"es",Estonian:"et",Finnish:"fi",French:"fr",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Italian:"it",Japanese:"ja",Korean:"ko",Lithuanian:"lt",Latvian:"lv",NorwegianBokml:"nb",Dutch:"nl",Polish:"pl",PortugueseBrazil:"pt-BR",PortuguesePortugal:"pt-PT",Romanian:"ro",Russian:"ru",Serbian:"sr",Slovenian:"sl",Slovak:"sk",Swedish:"sv",Thai:"th",Turkish:"tr",Ukrainian:"uk",Vietnamese:"vi",ChineseChina:"zh-CN",ChineseHongKong:"zh-HK",ChineseTaiwan:"zh-TW"};const SupportedLocalesForFormats=[...Object.values(SupportedLocales),"ar-u-nu-latn","en-AU","en-GB","es-ES","es-MX","de-AT","de-CH","de-DE","it-CH","it-IT"];const RTLLocales=[SupportedLocales.Arabic,SupportedLocales.Hebrew];const SupportedOnlineHelpLocales=["ar","de","es","fr","it","ja","ko","ru","pl","pt-br","zh-cn"];function formatMessage(statement,parameters){const templateFn=template(statement);return templateFn(parameters)}function extractLanguageTag(locale){const localeCodeRegex=/^([a-z]{2})-([A-Z]{1,2})$/;const match=locale?.match(localeCodeRegex);let output=SupportedLocales.English;if(match!==null&&match!==undefined&&match?.length>1){output=match[1]}else if(locale?.length===2&&locale.toLowerCase()===locale){output=locale}return output}function convertToSupportedLocale(locale){let output=SupportedLocales.English;if(locale!==undefined){const supportedLocales=Object.values(SupportedLocales);const hyphenatedSupportedLocales=supportedLocales.filter((ele=>ele.indexOf("-")!==-1));if(locale.indexOf("-")!==-1){const[lang,region]=locale.split("-");locale=`${lang}-${region.toUpperCase()}`}if(hyphenatedSupportedLocales.includes(locale)===true){output=locale}else{const languageTag=extractLanguageTag(locale);if(supportedLocales.includes(languageTag)===true){output=languageTag}}}return output}function convertToSupportedFormatLocale(locale){let formatLocale=SupportedLocalesForFormats.find((item=>item===locale));if(formatLocale===undefined){formatLocale=locale}if(formatLocale!==undefined&&formatLocale.indexOf("-")!==-1){const[lang,region]=formatLocale.split("-");formatLocale=`${lang}-${region.toUpperCase()}`}if(formatLocale==="ar"){formatLocale="ar-u-nu-latn"}return formatLocale}function getClosestElement(selector,base){function closestFrom(el){let element;if(el===undefined||el===document||el===window)element=null;else{const found=el.closest(selector);element=found||closestFrom(el.getRootNode().host)}return element}return closestFrom(base)}function getLocaleInfo(element=document.documentElement){const closestElement=getClosestElement("[lang]",element);const locale=closestElement?.lang??window.navigator.language;const convertedLocale=convertToSupportedLocale(locale);const formatLocale=convertToSupportedFormatLocale(locale);return{locale:convertedLocale,rtl:RTLLocales.includes(convertedLocale),formatLocale}}async function fetchLocaleStrings(props){const{path,locale,baseURL}=props;let localeData={};try{const response=await fetch(`${baseURL}t9n/${path}.t9n.${locale}.json`);localeData=await response.json()}catch(e){const defaultResponse=await fetch(`${baseURL}t9n/${path}.t9n.${SupportedLocales.English}.json`);localeData=await defaultResponse.json()}return localeData}async function fetchComponentLocaleStrings(element,baseURL){const componentName=element.tagName.toLowerCase();const{locale,rtl}=getLocaleInfo(element);const strings=await fetchLocaleStrings({path:componentName,locale,baseURL});return{strings,dir:rtl===true?"rtl":"ltr",locale}}function fixUrlForDemoApp(learnMoreUrl,portalUrl){const absoluteURLPattern=/^(?:[a-z]+:)?\/\//i;if(absoluteURLPattern.test(learnMoreUrl)===false){const currentUrl=window.location.href;const currentOrigin=new URL(currentUrl).origin;const portalOrigin=new URL(portalUrl).origin;if(currentOrigin!==portalOrigin){learnMoreUrl=`${portalOrigin}${learnMoreUrl}`}}return learnMoreUrl}function formatLearnMoreHelpUrl(params){const{locale="en",portalUrl,url}=params;let{basePath}=params;if(locale==="en-US"){basePath=basePath.replace("/en-US/","/en/")}const localeInLowerCase=locale.toLocaleLowerCase();if(SupportedOnlineHelpLocales.includes(localeInLowerCase)===true){basePath=basePath.replace(/^https?:\/\/[^/]+\/en/,(match=>match.replace("en",localeInLowerCase)))}return portalUrl!==undefined?fixUrlForDemoApp(`${basePath}${url}`,portalUrl):`${basePath}${url}`}function formatNumberToLocale(value,formatOptions){let formattedValue="";if(!isEmptyDataItem(value)&&!Number.isNaN(value)){const localeCode=getLocaleInfo().formatLocale;formattedValue=Intl.NumberFormat(localeCode,formatOptions).format(Number(value))}return formattedValue}class ArcgisWebAnalysisError extends Error{constructor(name,message,details,cause){super(message);this.name=name;this.details=details;this.cause=cause}}const DEFAULT_ERROR_KEY="default";const DEFAULT_CREDIT_ERROR_KEY="creditsDefault";const ErrorKeywords={Default:"defaultError",CannotReopenTool:"cannotReopenTool",CannotReopenWebTool:"cannotReopenWebTool",CreditEstimationError:"creditEstimationError",CreditThresholdExceededError:"creditThresholdExceededError",CreditEstimationExecutionFailure:"failedToExecuteEstimate",InsufficientCreditsError:"InsufficientCreditsError",KeyPropertiesError:"keyPropertiesError",LayerLoadFailure:"layerLoadFailure",LayerUnavailable:"layerUnavailable",NetworkError:"networkError",PortalLoadError:"portalLoadError",QueryFeaturesError:"queryFeaturesError",ServiceNameExistsError:"serviceNameExistsError",SpecialCharactersInServiceNameError:"specialCharactersInServiceNameError",ToolValidationError:"toolValidationError",WebToolFailedFetch:"webToolFailedFetch",WebToolJSONChanged:"webToolJSONChanged",WebToolPermissionsError:"missingPermissionForWebTool"};var isImplemented$4=function(){if(typeof globalThis!=="object")return false;if(!globalThis)return false;return globalThis.Array===Array};var naiveFallback=function(){if(typeof self==="object"&&self)return self;if(typeof window==="object"&&window)return window;throw new Error("Unable to resolve global `this`")};var implementation=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:true})}catch(error){return naiveFallback()}try{if(!__global__)return naiveFallback();return __global__}finally{delete Object.prototype.__global__}}();var globalThis_1=isImplemented$4()?globalThis:implementation;var global$1=globalThis_1,validTypes={object:true,symbol:true};var isImplemented$3=function(){var Symbol=global$1.Symbol;if(typeof Symbol!=="function")return false;Symbol("test symbol");if(!validTypes[typeof Symbol.iterator])return false;if(!validTypes[typeof Symbol.toPrimitive])return false;if(!validTypes[typeof Symbol.toStringTag])return false;return true};var d$5={exports:{}};var _undefined$1=void 0;var is$4=function(value){return value!==_undefined$1&&value!==null};var isValue$5=is$4;var possibleTypes={object:true,function:true,undefined:true};var is$3=function(value){if(!isValue$5(value))return false;return hasOwnProperty.call(possibleTypes,typeof value)};var isObject=is$3;var is$2=function(value){if(!isObject(value))return false;try{if(!value.constructor)return false;return value.constructor.prototype===value}catch(error){return false}};var isPrototype=is$2;var is$1=function(value){if(typeof value!=="function")return false;if(!hasOwnProperty.call(value,"length"))return false;try{if(typeof value.length!=="number")return false;if(typeof value.call!=="function")return false;if(typeof value.apply!=="function")return false}catch(error){return false}return!isPrototype(value)};var isFunction=is$1;var classRe=/^\s*class[\s{/}]/,functionToString=Function.prototype.toString;var is=function(value){if(!isFunction(value))return false;if(classRe.test(functionToString.call(value)))return false;return true};var isImplemented$2=function(){var assign=Object.assign,obj;if(typeof assign!=="function")return false;obj={foo:"raz"};assign(obj,{bar:"dwa"},{trzy:"trzy"});return obj.foo+obj.bar+obj.trzy==="razdwatrzy"};var isImplemented$1=function(){try{return true}catch(e){return false}};var noop=function(){};var _undefined=noop();var isValue$4=function(val){return val!==_undefined&&val!==null};var isValue$3=isValue$4;var keys$2=Object.keys;var shim$2=function(object){return keys$2(isValue$3(object)?Object(object):object)};var keys$1=isImplemented$1()?Object.keys:shim$2;var isValue$2=isValue$4;var validValue=function(value){if(!isValue$2(value))throw new TypeError("Cannot use null or undefined");return value};var keys=keys$1,value=validValue,max=Math.max;var shim$1=function(dest,src){var error,i,length=max(arguments.length,2),assign;dest=Object(value(dest));assign=function(key){try{dest[key]=src[key]}catch(e){if(!error)error=e}};for(i=1;i<length;++i){src=arguments[i];keys(src).forEach(assign)}if(error!==undefined)throw error;return dest};var assign$1=isImplemented$2()?Object.assign:shim$1;var isValue$1=isValue$4;var forEach=Array.prototype.forEach,create$2=Object.create;var process=function(src,obj){var key;for(key in src)obj[key]=src[key]};var normalizeOptions=function(opts1){var result=create$2(null);forEach.call(arguments,(function(options){if(!isValue$1(options))return;process(Object(options),result)}));return result};var str="razdwatrzy";var isImplemented=function(){if(typeof str.contains!=="function")return false;return str.contains("dwa")===true&&str.contains("foo")===false};var indexOf=String.prototype.indexOf;var shim=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1};var contains$1=isImplemented()?String.prototype.contains:shim;var isValue=is$4,isPlainFunction=is,assign=assign$1,normalizeOpts=normalizeOptions,contains=contains$1;var d$4=d$5.exports=function(dscr,value){var c,e,w,options,desc;if(arguments.length<2||typeof dscr!=="string"){options=value;value=dscr;dscr=null}else{options=arguments[2]}if(isValue(dscr)){c=contains.call(dscr,"c");e=contains.call(dscr,"e");w=contains.call(dscr,"w")}else{c=w=true;e=false}desc={value,configurable:c,enumerable:e,writable:w};return!options?desc:assign(normalizeOpts(options),desc)};d$4.gs=function(dscr,get,set){var c,e,options,desc;if(typeof dscr!=="string"){options=set;set=get;get=dscr;dscr=null}else{options=arguments[3]}if(!isValue(get)){get=undefined}else if(!isPlainFunction(get)){options=get;get=set=undefined}else if(!isValue(set)){set=undefined}else if(!isPlainFunction(set)){options=set;set=undefined}if(isValue(dscr)){c=contains.call(dscr,"c");e=contains.call(dscr,"e")}else{c=true;e=false}desc={get,set,configurable:c,enumerable:e};return!options?desc:assign(normalizeOpts(options),desc)};var isSymbol$1=function(value){if(!value)return false;if(typeof value==="symbol")return true;if(!value.constructor)return false;if(value.constructor.name!=="Symbol")return false;return value[value.constructor.toStringTag]==="Symbol"};var isSymbol=isSymbol$1;var validateSymbol$2=function(value){if(!isSymbol(value))throw new TypeError(value+" is not a symbol");return value};var d$3=d$5.exports;var create$1=Object.create,defineProperty$1=Object.defineProperty,objPrototype=Object.prototype;var created=create$1(null);var generateName$1=function(desc){var postfix=0,name,ie11BugWorkaround;while(created[desc+(postfix||"")])++postfix;desc+=postfix||"";created[desc]=true;name="@@"+desc;defineProperty$1(objPrototype,name,d$3.gs(null,(function(value){if(ie11BugWorkaround)return;ie11BugWorkaround=true;defineProperty$1(this,name,d$3(value));ie11BugWorkaround=false})));return name};var d$2=d$5.exports,NativeSymbol$1=globalThis_1.Symbol;var standardSymbols=function(SymbolPolyfill){return Object.defineProperties(SymbolPolyfill,{hasInstance:d$2("",NativeSymbol$1&&NativeSymbol$1.hasInstance||SymbolPolyfill("hasInstance")),isConcatSpreadable:d$2("",NativeSymbol$1&&NativeSymbol$1.isConcatSpreadable||SymbolPolyfill("isConcatSpreadable")),iterator:d$2("",NativeSymbol$1&&NativeSymbol$1.iterator||SymbolPolyfill("iterator")),match:d$2("",NativeSymbol$1&&NativeSymbol$1.match||SymbolPolyfill("match")),replace:d$2("",NativeSymbol$1&&NativeSymbol$1.replace||SymbolPolyfill("replace")),search:d$2("",NativeSymbol$1&&NativeSymbol$1.search||SymbolPolyfill("search")),species:d$2("",NativeSymbol$1&&NativeSymbol$1.species||SymbolPolyfill("species")),split:d$2("",NativeSymbol$1&&NativeSymbol$1.split||SymbolPolyfill("split")),toPrimitive:d$2("",NativeSymbol$1&&NativeSymbol$1.toPrimitive||SymbolPolyfill("toPrimitive")),toStringTag:d$2("",NativeSymbol$1&&NativeSymbol$1.toStringTag||SymbolPolyfill("toStringTag")),unscopables:d$2("",NativeSymbol$1&&NativeSymbol$1.unscopables||SymbolPolyfill("unscopables"))})};var d$1=d$5.exports,validateSymbol$1=validateSymbol$2;var registry=Object.create(null);var symbolRegistry=function(SymbolPolyfill){return Object.defineProperties(SymbolPolyfill,{for:d$1((function(key){if(registry[key])return registry[key];return registry[key]=SymbolPolyfill(String(key))})),keyFor:d$1((function(symbol){var key;validateSymbol$1(symbol);for(key in registry){if(registry[key]===symbol)return key}return undefined}))})};var d=d$5.exports,validateSymbol=validateSymbol$2,NativeSymbol=globalThis_1.Symbol,generateName=generateName$1,setupStandardSymbols=standardSymbols,setupSymbolRegistry=symbolRegistry;var create=Object.create,defineProperties=Object.defineProperties,defineProperty=Object.defineProperty;var SymbolPolyfill,HiddenSymbol,isNativeSafe;if(typeof NativeSymbol==="function"){try{String(NativeSymbol());isNativeSafe=true}catch(ignore){}}else{NativeSymbol=null}HiddenSymbol=function Symbol(description){if(this instanceof HiddenSymbol)throw new TypeError("Symbol is not a constructor");return SymbolPolyfill(description)};var polyfill=SymbolPolyfill=function Symbol(description){var symbol;if(this instanceof Symbol)throw new TypeError("Symbol is not a constructor");if(isNativeSafe)return NativeSymbol(description);symbol=create(HiddenSymbol.prototype);description=description===undefined?"":String(description);return defineProperties(symbol,{__description__:d("",description),__name__:d("",generateName(description))})};setupStandardSymbols(SymbolPolyfill);setupSymbolRegistry(SymbolPolyfill);defineProperties(HiddenSymbol.prototype,{constructor:d(SymbolPolyfill),toString:d("",(function(){return this.__name__}))});defineProperties(SymbolPolyfill.prototype,{toString:d((function(){return"Symbol ("+validateSymbol(this).__description__+")"})),valueOf:d((function(){return validateSymbol(this)}))});defineProperty(SymbolPolyfill.prototype,SymbolPolyfill.toPrimitive,d("",(function(){var symbol=validateSymbol(this);if(typeof symbol==="symbol")return symbol;return symbol.toString()})));defineProperty(SymbolPolyfill.prototype,SymbolPolyfill.toStringTag,d("c","Symbol"));defineProperty(HiddenSymbol.prototype,SymbolPolyfill.toStringTag,d("c",SymbolPolyfill.prototype[SymbolPolyfill.toStringTag]));defineProperty(HiddenSymbol.prototype,SymbolPolyfill.toPrimitive,d("c",SymbolPolyfill.prototype[SymbolPolyfill.toPrimitive]));var es6Symbol=isImplemented$3()?globalThis_1.Symbol:polyfill;const Symbol=es6Symbol;Symbol("-");const AnalysisToolParamDirection={Input:"esriGPParameterDirectionInput",Output:"esriGPParameterDirectionOutput"};const AnalysisEngine={Standard:"standard",GeoAnalytics:"geoanalytics",Raster:"raster",Pipelines:"pipelines",Session:"session"};const AnalysisToolUICurrentVersion="0.1.0";const ParamViewModelKey="parameterViewModel";const SerializationType={default:"default",sequentialValues:"sequentialValues",sequentialValueArray:"sequentialValueArray",arrayValues:"arrayValues",string:"stringValue",wrapInAnArray:"wrapInAnArray"};const AnalysisSupportedItemTypes={ImageService:"Image Service",FeatureService:"Feature Service",BigData:"Big Data File Share",Csv:"CSV",Xls:"Microsoft Excel",MapService:"Map Service",FeatureLayer:"Feature Layer",BigDataFeature:"featureClass",Table:"Table",BigDataTable:"table",MultiValueGrid:"Multi-Variable Grid",GeoprocessingService:"Geoprocessing Service",RasterFunctionTemplate:"Raster function template",BdfsTemplate:"bdfstemplate",DeepLearningPackage:"Deep Learning Package",File:"files",Doc:"documents",Image:"images",PDF:"pdfs",Csvs:"csvs"};const SelectedLayersKey="_SelectedLayers";const ParamGroupDataTypeKey="_ParamGroupDataType";const PortalDeploymentType={Enterprise:"ArcGISEnterprise",Kubernetes:"ArcGISEnterpriseOnKubernetes"};function generateSelectedLayersKey(paramName){return`${paramName}${SelectedLayersKey}`}function generateParamGroupDataTypeKey(paramName){return`${paramName}${ParamGroupDataTypeKey}`}function hasNAPrivilege(user){const privilegesArray=user?.sourceJSON.privileges;return privilegesArray!==undefined&&privilegesArray.includes("premium:user:networkanalysis")}var src={exports:{}};function memoize(fn,options){var cache=options&&options.cache?options.cache:cacheDefault;var serializer=options&&options.serializer?options.serializer:serializerDefault;var strategy=options&&options.strategy?options.strategy:strategyDefault;return strategy(fn,{cache,serializer})}function isPrimitive(value){return value==null||typeof value==="number"||typeof value==="boolean"}function monadic(fn,cache,serializer,arg){var cacheKey=isPrimitive(arg)?arg:serializer(arg);var computedValue=cache.get(cacheKey);if(typeof computedValue==="undefined"){computedValue=fn.call(this,arg);cache.set(cacheKey,computedValue)}return computedValue}function variadic(fn,cache,serializer){var args=Array.prototype.slice.call(arguments,3);var cacheKey=serializer(args);var computedValue=cache.get(cacheKey);if(typeof computedValue==="undefined"){computedValue=fn.apply(this,args);cache.set(cacheKey,computedValue)}return computedValue}function assemble(fn,context,strategy,cache,serialize){return strategy.bind(context,fn,cache,serialize)}function strategyDefault(fn,options){var strategy=fn.length===1?monadic:variadic;return assemble(fn,this,strategy,options.cache.create(),options.serializer)}function strategyVariadic(fn,options){var strategy=variadic;return assemble(fn,this,strategy,options.cache.create(),options.serializer)}function strategyMonadic(fn,options){var strategy=monadic;return assemble(fn,this,strategy,options.cache.create(),options.serializer)}function serializerDefault(){return JSON.stringify(arguments)}function ObjectWithoutPrototypeCache(){this.cache=Object.create(null)}ObjectWithoutPrototypeCache.prototype.has=function(key){return key in this.cache};ObjectWithoutPrototypeCache.prototype.get=function(key){return this.cache[key]};ObjectWithoutPrototypeCache.prototype.set=function(key,value){this.cache[key]=value};var cacheDefault={create:function create(){return new ObjectWithoutPrototypeCache}};src.exports=memoize;src.exports.strategies={variadic:strategyVariadic,monadic:strategyMonadic};var memoize$1=src.exports;const addressFields=["SingleLine","Address","Address2","Address3","Neighborhood","City","Subregion","Region","Postal","PostalExt","CountryCode"];const countrySerializerFn=args=>{const{geocodeServiceURL}=args;return geocodeServiceURL??"EMPTY_KEY"};const addressFieldsSerializerFn=args=>{const{geocodeServiceURL,inputFileItem,inputTable}=args;const itemid=inputFileItem?.itemid;const url=inputTable?.url;return!isEmptyDataItem(geocodeServiceURL)&&(!isEmptyDataItem(itemid)||!isEmptyDataItem(url))?`${geocodeServiceURL}${itemid}${url}`:"EMPTY_KEY"};memoize$1((async params=>{const{geocodeServiceURL,locale}=params;let countryRule;if(isEmptyDataItem(geocodeServiceURL)){countryRule={ruleType:"expression",expression:"$[Data].geocodeServiceURL = NULL",destination:"sourceCountry",effectParams:{visible:false}}}else{let countries;let detailedCountries;try{({data:{countries,detailedCountries}}=await request(`${geocodeServiceURL}?f=json`,{responseType:"json"}))}catch(err){console.error("Failed to get Locator info");throw err}const labels={};detailedCountries.forEach((country=>{const localizedNames=country.localizedNames;const fourLetterLocale=locale.length>2&&locale;let localizedName;if(typeof fourLetterLocale!=="boolean"){localizedName=localizedNames[fourLetterLocale]}if(localizedName===undefined){const twoLetterLocale=locale.length===2?locale.slice(0,2):locale;localizedName=localizedNames[twoLetterLocale];if(localizedName===undefined){const lang=Object.keys(localizedNames).find((key=>key.startsWith(twoLetterLocale)));if(lang!==undefined){localizedName=localizedNames[lang]}}}if(localizedName===null||localizedName===undefined||localizedName===""){localizedName=localizedNames[SupportedLocales.English]??localizedNames[SupportedLocales.EnglishUSA]}labels[country.name]=localizedName}));countryRule={ruleType:"expression",expression:"$[Data].geocodeServiceURL NOT null",destination:"sourceCountry",effectParams:{visible:true,choiceList:countries,choiceListLabels:labels}}}return countryRule}),{serializer:countrySerializerFn});memoize$1((async params=>{const{geocodeServiceURL,inputFileItem,inputTable}=params;let addressFieldsRule;let geocodeParameters;if(!isEmptyDataItem(geocodeServiceURL)&&(!isEmptyDataItem(inputFileItem)||!isEmptyDataItem(inputTable))){let fieldInfo;let fieldMapping;geocodeParameters=await analyzeGeocodeInput(params);try{fieldInfo=JSON.parse(geocodeParameters.field_info);fieldMapping=JSON.parse(geocodeParameters.field_mapping)}catch(err){console.error("Failed to parse result of AnalyzeGeocodeInput");throw err}const choiceList=fieldInfo.map((field=>field[0]));const choiceListLabels=choiceList.reduce(((acc,curr)=>({...acc,[curr]:curr})),{});addressFieldsRule={ruleType:"expression",expression:"($[Data].geocodeServiceURL NOT null) AND (($[Data].inputTable NOT null) OR ($[Data].inputFileItem NOT null))",destination:`geocodeUIParameters`,effectParams:addressFields.reduce(((acc,curr,i)=>{const value=fieldMapping.find((mapping=>mapping[1]===curr))?.[0];return{...acc,[`UIparameterInfos[${i}].choiceList`]:choiceList,[`UIparameterInfos[${i}].choiceListLabels`]:choiceListLabels,[`UIparameterInfos[${i}].defaultValue`]:value}}),{})}}return{addressFieldsRule,geocodeParameters}}),{serializer:addressFieldsSerializerFn});function getServiceType(url){let serviceType="";if(url!==undefined&&url!==""){const urlParts=url.split("/");const services=urlParts.filter((part=>new RegExp("[A-Z]{1}[a-z]+Server").test(part)===true));serviceType=services[services.length-1]}return serviceType}function sanitizeUrl(url){return urlUtils__namespace.urlToObject(url).path}const CLIENT_THROWN_ERROR="analysis_ui";async function fetchErrorsStrings(locale=getLocaleInfo().locale){let strings=await new Promise((function(resolve,reject){require(["./errors.t9n.en-6cb15d51-ec6687ba"],resolve,reject)}));switch(locale){case SupportedLocales.Arabic:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ar-1b9d7225-eec60ef0"],resolve,reject)}));break;case SupportedLocales.Bosnian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.bs-377a5410-36feae22"],resolve,reject)}));break;case SupportedLocales.Bulgarian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.bg-89d094b5-f3a42236"],resolve,reject)}));break;case SupportedLocales.Catalan:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ca-b4c83c33-77badc85"],resolve,reject)}));break;case SupportedLocales.Czech:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.cs-96fcf27d-5a68866c"],resolve,reject)}));break;case SupportedLocales.Danish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.da-cefe0c47-400ac533"],resolve,reject)}));break;case SupportedLocales.German:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.de-a1b0ae17-75bd70bd"],resolve,reject)}));break;case SupportedLocales.Greek:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.el-0a20e1cc-f205fa3c"],resolve,reject)}));break;case SupportedLocales.EnglishUSA:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.en-US-c9f50f19-bfc18c90"],resolve,reject)}));break;case SupportedLocales.Spanish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.es-0dd138a7-685bae6d"],resolve,reject)}));break;case SupportedLocales.Estonian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.et-57cc3980-71d1d3cc"],resolve,reject)}));break;case SupportedLocales.Finnish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.fi-7d2525cb-ee1341ef"],resolve,reject)}));break;case SupportedLocales.French:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.fr-b2186e48-039cdd3b"],resolve,reject)}));break;case SupportedLocales.Hebrew:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.he-f487411b-ce3790da"],resolve,reject)}));break;case SupportedLocales.Croatian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.hr-61ca76d9-0ded7300"],resolve,reject)}));break;case SupportedLocales.Hungarian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.hu-7fa01d3c-3e46d3ff"],resolve,reject)}));break;case SupportedLocales.Indonesian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.id-6801fef5-12a6065a"],resolve,reject)}));break;case SupportedLocales.Italian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.it-568c2b04-f569a426"],resolve,reject)}));break;case SupportedLocales.Japanese:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ja-6042d3af-c4353778"],resolve,reject)}));break;case SupportedLocales.Korean:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ko-4d01f228-4249027d"],resolve,reject)}));break;case SupportedLocales.Lithuanian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.lt-7f94cd9d-e8c5451e"],resolve,reject)}));break;case SupportedLocales.Latvian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.lv-0223c6ae-bc578f6e"],resolve,reject)}));break;case SupportedLocales.NorwegianBokml:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.nb-1f800b8b-d80f86f9"],resolve,reject)}));break;case SupportedLocales.Dutch:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.nl-dd20c6e1-7e8305ea"],resolve,reject)}));break;case SupportedLocales.Polish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.pl-e71d8c8e-90143aa3"],resolve,reject)}));break;case SupportedLocales.PortugueseBrazil:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.pt-BR-6cdb50a3-a30b4c73"],resolve,reject)}));break;case SupportedLocales.PortuguesePortugal:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.pt-PT-6b3866f5-f900ebb9"],resolve,reject)}));break;case SupportedLocales.Romanian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ro-86e7cba9-e05751a7"],resolve,reject)}));break;case SupportedLocales.Russian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.ru-23cdd703-b9a3b092"],resolve,reject)}));break;case SupportedLocales.Serbian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sr-fad84a78-ef8ae32c"],resolve,reject)}));break;case SupportedLocales.Slovak:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sk-3b14f765-561c1ed2"],resolve,reject)}));break;case SupportedLocales.Slovenian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sl-e900baaf-ade630c3"],resolve,reject)}));break;case SupportedLocales.Swedish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.sv-4613eae2-7ca6eb35"],resolve,reject)}));break;case SupportedLocales.Thai:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.th-5732c8a4-354229a2"],resolve,reject)}));break;case SupportedLocales.Turkish:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.tr-ccd64dcc-7c34546a"],resolve,reject)}));break;case SupportedLocales.Ukrainian:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.uk-e6c5f2f4-65cbc527"],resolve,reject)}));break;case SupportedLocales.Vietnamese:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.vi-3f1e30b4-7047265c"],resolve,reject)}));break;case SupportedLocales.ChineseChina:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.zh-CN-8e563d8f-1457d2df"],resolve,reject)}));break;case SupportedLocales.ChineseHongKong:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.zh-HK-23eb2505-8285427c"],resolve,reject)}));break;case SupportedLocales.ChineseTaiwan:strings=await new Promise((function(resolve,reject){require(["./errors.t9n.zh-TW-4017c011-811e3724"],resolve,reject)}));break}return strings}async function throwError(errorKey,cause){const errorStrings=await fetchErrorsStrings();const errorMessage=errorStrings[errorKey];throw new ArcgisWebAnalysisError(errorKey,errorMessage??errorStrings.defaultError,{type:CLIENT_THROWN_ERROR},cause)}function getLayerLabel(layer){const groupSubLayer=layer;const serviceTitle=groupSubLayer.parent?.title??undefined;return serviceTitle!==undefined?`${serviceTitle} - ${layer.title}`:layer.title}function isFeatureLayer(layer){return layer.type==="feature"}function isImageryLayer(layer){return layer.type==="imagery"}function isImageryTileLayer(layer){return layer.type==="imagery-tile"}function isGroupLayer(layer){return layer.type==="group"}function isSketchLayer(layer){return layer.type==="map-notes"}function isMapImageLayer(layer){return layer.type==="map-image"}function isFeatureCollectionJSON(layer){return"featureSet"in layer}const getFeatureLayerFromFeatureCollection=memoize$2((featColl=>{const inputArgument={};let layerDefinition;if(featColl.featureSet!==undefined){inputArgument.source=FeatureSet__default["default"].fromJSON(featColl.featureSet).features;layerDefinition=featColl.layerDefinition;if(layerDefinition.fields!==undefined){inputArgument.fields=layerDefinition.fields.map((field=>Field__default["default"].fromJSON(field)))}if(layerDefinition.objectIdField!==undefined)inputArgument.objectIdField=layerDefinition.objectIdField;if(layerDefinition.geometryType!==undefined){let type="point";switch(layerDefinition.geometryType){case"esriGeometryMultipoint":type="multipoint";break;case"esriGeometryPoint":type="point";break;case"esriGeometryPolygon":type="polygon";break;case"esriGeometryPolyline":type="polyline";break}inputArgument.geometryType=type}if(layerDefinition.spatialReference!==undefined)inputArgument.spatialReference=layerDefinition.spatialReference;if(layerDefinition.drawingInfo?.renderer!==undefined)inputArgument.renderer=Renderer__default["default"].fromJSON(layerDefinition.drawingInfo.renderer)}return new FeatureLayer__default["default"](inputArgument)}));function getLocalizedGeometryType(featureLayer,strings){let geometryTitle;switch(featureLayer.geometryType){case"point":geometryTitle=strings.toolInfoKeys.points;break;case"polygon":geometryTitle=strings.toolInfoKeys.polygons;break;case"polyline":geometryTitle=strings.toolInfoKeys.lines;break}return geometryTitle}async function getFeatureLayersFromSketchLayer(sketchLayer,strings){await sketchLayer.beforeSave();const sketchLayerJson=sketchLayer.toJSON({origin:"web-map"});const nonEmptySketchSubLayers=sketchLayerJson.featureCollection.layers.filter((featColl=>featColl.featureSet.features.length>0&&featColl.layerDefinition.name!=="Text"));const loadingLayers=nonEmptySketchSubLayers.map((async featColl=>{const featureLayer=getFeatureLayerFromFeatureCollection(featColl);const supportedGeometryName=getLocalizedGeometryType(featureLayer,strings);const layerTitle=getLayerLabel(sketchLayer);if(supportedGeometryName!==undefined){featureLayer.title=`${layerTitle} (${supportedGeometryName})`}else{featureLayer.title=layerTitle}await featureLayer.load();return featureLayer}));const featureLayers=await Promise.all(loadingLayers);return featureLayers}async function getFeatureLayersFromMapImageLayer(mapImagelayer){const loadingLayers=mapImagelayer.allSublayers.map((async subLayer=>{const featureLayer=await subLayer.createFeatureLayer();await featureLayer.load();featureLayer.title=getLayerLabel(subLayer);return featureLayer}));const featureLayers=await Promise.all(loadingLayers);return featureLayers}async function getAnalysisLayers(layers,strings){const sketchLayers=[];const mapImageLayers=[];let otherAnalysisLayers=[];layers.forEach((layer=>{if(isSketchLayer(layer)===true){sketchLayers.push(layer)}else if(isMapImageLayer(layer)){mapImageLayers.push(layer)}else{otherAnalysisLayers.push(layer)}}));const analysisLayers=[];if(sketchLayers.length>0){const sketchLayersPromiseResult=await Promise.allSettled(sketchLayers.map((sketchLayer=>getFeatureLayersFromSketchLayer(sketchLayer,strings))));const sketchFeatureLayers=sketchLayersPromiseResult.filter((res=>res.status==="fulfilled")).map((fulfilledRes=>fulfilledRes.value));analysisLayers.push(...sketchFeatureLayers.flat())}if(mapImageLayers.length>0){const mapImageLayersPromiseResult=await Promise.allSettled(mapImageLayers.map((mapImageLayer=>getFeatureLayersFromMapImageLayer(mapImageLayer))));const mapImageFeatureLayers=mapImageLayersPromiseResult.filter((res=>res.status==="fulfilled")).map((fulfilledRes=>fulfilledRes.value));analysisLayers.push(...mapImageFeatureLayers.flat())}const otherAnalysisLayersLoadResults=await Promise.allSettled(otherAnalysisLayers.map((analysisLayer=>analysisLayer.loaded?Promise.resolve(analysisLayer):analysisLayer.load())));otherAnalysisLayers=otherAnalysisLayersLoadResults.filter((loadResults=>loadResults.status==="fulfilled")).map((fulfilledResults=>fulfilledResults.value));return[...otherAnalysisLayers,...analysisLayers]}memoize$2((async(serverUrl,portalUrl)=>{let status=false;const url=window.location.href;if(url.includes("://localhost:")===true||portalUrl===undefined){status=true}else{const serviceUrl=`${serverUrl}${serverUrl.indexOf("?")>-1?"&":"?"}f=json`;esriConfig__default["default"].request.proxyUrl=`${portalUrl}/sharing/proxy`;try{const response=await request(serviceUrl,{useProxy:true});status=isEmptyDataItem(response.data)===false}catch(exception){status=false}}return status===true?serverUrl:undefined}));function getFeatureCollectionJSON(value){const sourceArray=value.source.toArray();const features=sourceArray.map((graphic=>graphic.toJSON()));const geometry=sourceArray[0].geometry;const gpValue={layerDefinition:{id:value.id,drawingInfo:{renderer:value.renderer.toJSON()},name:value.title},featureSet:{features},nextObjectId:sourceArray.length,showLegend:true};if(!isEmptyDataItem(value.objectIdField)){gpValue.layerDefinition.objectIdField=value.objectIdField}if(!isEmptyDataItem(geometry)){gpValue.layerDefinition.geometryType=geometryJsonUtils__namespace.getJsonType(geometry)}if(!isEmptyDataItem(value.spatialReference)){gpValue.layerDefinition.spatialReference=value.spatialReference.toJSON()}if(!isEmptyDataItem(value.fields)){gpValue.layerDefinition.fields=value?.fields.map((field=>{const fieldJson=field.toJSON();if(fieldJson.type==="esriFieldTypeOID"&&fieldJson.length===-1){delete fieldJson.length}if(fieldJson.type==="esriFieldTypeString"&&fieldJson.length===-1){fieldJson.length=255}return fieldJson}))}if(!isEmptyDataItem(value.types)){gpValue.layerDefinition.types=value.types.map((type=>type.toJSON()))}if(!isEmptyDataItem(value.typeIdField)){gpValue.layerDefinition.typeIdField=value.typeIdField}if(!isEmptyDataItem(value.popupTemplate)){gpValue.popupInfo=value.popupTemplate.toJSON()}return gpValue}function getGPFeatureRecordSetLayerValue(value,mapView){let gpValue;if(isEmptyDataItem(value.url)===false){const credential=esriId__default["default"].findCredential(value.url);gpValue={url:`${value.url}/${value.layerId??0}`};if(credential!==undefined){gpValue.serviceToken=credential.token}if(isEmptyDataItem(value.definitionExpression)===false){gpValue.filter=value.definitionExpression}if(isEmptyDataItem(value.sourceJSON?.serviceItemId)===false){gpValue.itemId=value.sourceJSON?.serviceItemId}if(isEmptyDataItem(value.timeInfo)===false&&value.useViewTime===true&&isEmptyDataItem(mapView?.timeExtent)===false){let timeFilter="";if(mapView?.timeExtent.start!==undefined){timeFilter+=mapView?.timeExtent.start.getTime();if(mapView?.timeExtent.end!==undefined){timeFilter+=`, ${mapView?.timeExtent.end.getTime()}`}}else if(mapView?.timeExtent.end!==undefined){timeFilter+=mapView?.timeExtent.end.getTime()}if(timeFilter.length>0){gpValue.time=timeFilter}}}else if(value.source!==undefined){gpValue=getFeatureCollectionJSON(value)}return gpValue}function getServiceName(url){let serviceName="";if(url!==undefined&&url!==""){const urlParts=url.split("/");const serviceType=getServiceType(url);serviceName=urlParts[urlParts.indexOf(serviceType)-1]}return serviceName}function getImageryLayerValue(value){let gpValue;if(isEmptyDataItem(value.url)===false){let url=value.url;if(url&&url.indexOf("?token=")>0){url=url.slice(0,url.indexOf("?token="))}const credential=esriId__default["default"].findCredential(value.url);gpValue={url:`${url}`};if(credential!==undefined){gpValue={url:`${url}?token=${credential.token}`}}if(isImageryLayer(value)&&value.renderingRule!==undefined&&value.renderingRule!==null){gpValue.renderingRule=value.renderingRule.toJSON()}if(isImageryLayer(value)&&value.definitionExpression!==undefined&&value.definitionExpression!==null){let mosaicRule=value.mosaicRule??__esri.MosaicRule.fromJSON(value.sourceJSON);if(mosaicRule!==undefined&&mosaicRule!==null){mosaicRule=mosaicRule.clone();mosaicRule.where=value.definitionExpression;gpValue.mosaicRule=mosaicRule.toJSON()}}else if(isImageryLayer(value)&&value.mosaicRule!==undefined&&value.mosaicRule!==null){gpValue.mosaicRule=value.mosaicRule.toJSON()}}return gpValue}async function getLayerObjectFromUrl(url){let layer=undefined;try{layer=await Layer__default["default"].fromArcGISServerUrl({url:sanitizeUrl(url)})}catch(error){await throwError(ErrorKeywords.LayerUnavailable,error)}return layer}async function getLayerObjectFromItemId(itemId){let layer=undefined;try{layer=await Layer__default["default"].fromPortalItem({portalItem:new PortalItem__default["default"]({id:itemId})})}catch(error){await throwError(ErrorKeywords.LayerUnavailable,error)}return layer}async function loadLayer(layer){let loadedLayer=undefined;try{loadedLayer=await(isGroupLayer(layer)===true?layer.loadAll():layer.load())}catch(error){await throwError(ErrorKeywords.LayerLoadFailure,error)}return loadedLayer}async function getLayerObject(gpResultValue){let layer=undefined;if(typeof gpResultValue==="object"&&"itemId"in gpResultValue&&isEmptyDataItem(gpResultValue.itemId)===false){layer=await getLayerObjectFromItemId(gpResultValue.itemId)}else if(typeof gpResultValue==="object"&&"url"in gpResultValue&&isEmptyDataItem(gpResultValue.url)===false){layer=await getLayerObjectFromUrl(gpResultValue.url)}if(layer!==undefined){layer=await loadLayer(layer)}return layer}async function getInputLayerObject(gpInputValue){let layer=undefined;const errors=[];const{url,itemId}=gpInputValue;if(isEmptyDataItem(url)===false){try{layer=await getLayerObjectFromUrl(url)}catch(error){errors.push(error)}}if(isEmptyDataItem(itemId)===false&&isEmptyDataItem(layer)===true){try{layer=await getLayerObjectFromItemId(itemId)}catch(error){errors.push(error)}}if(isFeatureCollectionJSON(gpInputValue)){layer=new FeatureLayer__default["default"]({title:gpInputValue?.layerDefinition.name??""})}if(isEmptyDataItem(layer)===true&&errors.length>0){await throwError(ErrorKeywords.LayerUnavailable,errors)}return layer}const ValidityState={Valid:"valid",Info:"informative",Warning:"warning",Error:"error"};function isClientThrownError(error){return error!==undefined&&"details"in error&&error.details?.type===CLIENT_THROWN_ERROR}function extractErrorMessage(error,defaultErrorString){return isClientThrownError(error)?error?.message:defaultErrorString}function getValidityStatus(validityStates){const areAllStatesValid=validityStates.every((({valid})=>valid));return areAllStatesValid?ValidityState.Valid:ValidityState.Error}function convertErrorToAnalysisValidationParams({error,errorKey,message,variables={},type="error"}){return{key:error?.name??errorKey??"",type,message:extractErrorMessage(error,message),variables}}function updateToolErrorState(errorState,validityStates,RFxValidityStates=[]){const newErrorState={...errorState,toolAppErrorState:[]};const allStates=[...validityStates,...RFxValidityStates];allStates.forEach((state=>{if(state.valid===false){let newToolErrors=[];if("errorKeys"in state){newToolErrors=state.errorKeys.map((errorKey=>convertErrorToAnalysisValidationParams({errorKey})))}else if("errorStrings"in state){newToolErrors=state.errorStrings.map((errorString=>convertErrorToAnalysisValidationParams({message:errorString})))}newErrorState.toolAppErrorState.push(...newToolErrors)}}));newErrorState.toolAppErrorState=uniqWith(newErrorState.toolAppErrorState,isEqual);return newErrorState}function getParameterErrors(errorList){const parameterErrors={errors:[]};for(const error of errorList){let convertedError=undefined;const errorKey=error.name;switch(errorKey){case ErrorKeywords.LayerUnavailable:const layer="details"in error?error.details?.layer:undefined;convertedError=convertErrorToAnalysisValidationParams({error,errorKey,variables:{title:getServiceName(layer?.url)??""}});break}if(convertedError!==undefined){parameterErrors.errors.push(convertedError)}}return parameterErrors}async function convertJobLayersToMapLayers(jobLayers,availableMapLayers){const layersToAdd=[];const existingLoadedLayers=[];const layerErrors=[];jobLayers.forEach((gpLayer=>{let foundLayer;if("url"in gpLayer){const findCb=availableLayer=>{const hasLayerId="layerId"in availableLayer;const urlId=hasLayerId?`/${availableLayer.layerId??0}`:"";const compareUrl=`${availableLayer.url}${urlId}`;return sanitizeUrl(gpLayer.url)===compareUrl};foundLayer=availableMapLayers.find((availableLayer=>findCb(availableLayer)))}else if("itemId"in gpLayer){foundLayer=availableMapLayers.find((availableLayer=>gpLayer.itemId===availableLayer.portalItem?.id))}else if(isFeatureCollectionJSON(gpLayer)&&gpLayer?.layerDefinition.name!==undefined){foundLayer=availableMapLayers.find((availableLayer=>gpLayer?.layerDefinition.name===availableLayer.title))}if(foundLayer===undefined){layersToAdd.push(gpLayer)}else{existingLoadedLayers.push(foundLayer)}}));const unloadedLayersToAdd=layersToAdd.map((async layer=>{let loadedLayer;try{loadedLayer=await getInputLayerObject(layer)}catch(error){layerErrors.push(new ArcgisWebAnalysisError(error.name,error.message,{...error.details,layer},error.cause))}try{loadedLayer=await loadLayer(loadedLayer)}catch(error){layerErrors.push(new ArcgisWebAnalysisError(error.name,error.message,{...error.details,layer},error.cause))}return loadedLayer}));let loadedLayersToAdd=await Promise.all(unloadedLayersToAdd);loadedLayersToAdd=loadedLayersToAdd.filter((layer=>layer!==undefined))??[];return{existingLayers:existingLoadedLayers,layersToAdd:loadedLayersToAdd,errors:layerErrors}}async function convertJobParamsToToolData(props){const{jobParams,uiOnlyParams,toolName,availableMapLayers,toolJSON,isWebTool}=props;const convertedJobParams={};const resultingErrorState={toolAppErrorState:[],parameterErrorState:{}};let layers=[];const toolUIParamModel=uiOnlyParams?.[ParamViewModelKey];let combinedParams=jobParams;if(toolName==="ChooseBestFacilities"){combinedParams={...jobParams,...uiOnlyParams}}for(const key in combinedParams){const parameterValue=combinedParams[key];const submissionName=get(toolUIParamModel,[key,"submissionName"]);let toolJSONParam=toolJSON?.parameters?.find((param=>param.name===key||param.name===submissionName));const dataTypeKey=generateParamGroupDataTypeKey(key);const dataType=uiOnlyParams[dataTypeKey]??toolJSONParam?.dataType;const isWebToolContext=isWebTool&&key==="context";if(isWebToolContext&&toolJSONParam===undefined){toolJSONParam={name:"context",dataType:"GPString",direction:"esriGPParameterDirectionInput"}}if(parameterValue!==undefined&&parameterValue!==null&&toolJSONParam!==undefined){switch(dataType){case"GPString":if(key==="context"){convertedJobParams[key]=!isEmptyDataItem(parameterValue)?parameterValue:undefined;continue}if(!Array.isArray(parameterValue)){if(typeof parameterValue==="object"&&!Array.isArray(parameterValue)){if(key==="model"||key==="modelArguments"){convertedJobParams[key]=parameterValue}else{const gpLayerValue=parameterValue;const{existingLayers,layersToAdd,errors:layerErrors}=await convertJobLayersToMapLayers([gpLayerValue],availableMapLayers);const selectedLayersKey=generateSelectedLayersKey(key);if(layerErrors.length>0){resultingErrorState.parameterErrorState[key]=getParameterErrors(layerErrors)}convertedJobParams[key]=gpLayerValue;convertedJobParams[selectedLayersKey]=[...existingLayers,...layersToAdd];layers=layers.concat(layersToAdd)}}else{if(typeof parameterValue==="string"&&(parameterValue.includes("serviceProperties")||parameterValue.includes("itemProperties"))){const outputName=JSON.parse(parameterValue);convertedJobParams[key]=outputName?.serviceProperties?.name??outputName.itemProperties?.title??undefined}else{convertedJobParams[key]=String(parameterValue)}}break}else{toolJSONParam.dataType="GPMultiValue:GPString"}case"GPMultiValue:GPString":const multiParameterValue=Array.isArray(parameterValue)?parameterValue:[parameterValue];if(multiParameterValue.every((val=>typeof val==="object"))){const gpLayerValue=multiParameterValue;const{existingLayers,layersToAdd,errors:layerErrors}=await convertJobLayersToMapLayers(gpLayerValue,availableMapLayers);const selectedLayersKey=generateSelectedLayersKey(key);if(layerErrors.length>0){resultingErrorState.parameterErrorState[key]=getParameterErrors(layerErrors)}convertedJobParams[key]=gpLayerValue;convertedJobParams[selectedLayersKey]=[...existingLayers,...layersToAdd];layers=layers.concat(layersToAdd)}else{convertedJobParams[key]=multiParameterValue.map((val=>String(val)))}break;case"GPFeatureRecordSetLayer":case"GPRecordSet":case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":{const gpLayerValue=parameterValue;const{existingLayers,layersToAdd,errors:layerErrors}=await convertJobLayersToMapLayers(Array.isArray(gpLayerValue)?gpLayerValue:[gpLayerValue],availableMapLayers);const selectedLayersKey=generateSelectedLayersKey(key);if(layerErrors.length>0){resultingErrorState.parameterErrorState[key]=getParameterErrors(layerErrors)}convertedJobParams[key]=gpLayerValue;convertedJobParams[selectedLayersKey]=[...existingLayers,...layersToAdd];layers=layers.concat(layersToAdd)}break;case"GPDate":case"GPBoolean":case"GPDouble":case"GPLong":case"GPMultiValue:GPDouble":case"GPLinearUnit":case"Field":default:convertedJobParams[key]=parameterValue;break}}}return{convertedJobParams,layers,resultingErrorState}}function getFeatureCollectionValueForStorage(value){const trimmedFeatureCollection=value.layerDefinition.name!==undefined?{layerDefinition:{name:value.layerDefinition.name??""},featureSet:{}}:undefined;return trimmedFeatureCollection}class AbstractSerializer{prepare(value,_paramConfig){return value}postProcess(value,_paramConfig){return value}}const isNonNullObject=value=>typeof value==="object"&&value!==null;function WithKeys(Base){class AbstractSerializerWithKeys extends Base{getKeys(value,paramConfig){let keys=[];if(Array.isArray(paramConfig.serializationKeys)&&paramConfig.serializationKeys.length>0){keys=paramConfig.serializationKeys}else if(isNonNullObject(value)){const allValueKeys=Array.isArray(value)?value.flatMap((arrayValue=>isNonNullObject(arrayValue)&&!Array.isArray(arrayValue)?Object.keys(arrayValue):[])):Object.keys(value);keys=[...new Set(allValueKeys)]}this.toSerializeKeys=keys;return keys}}return AbstractSerializerWithKeys}function serializeSequentialValues(value){const valueList=Object.values(value).map((item=>!isEmptyDataItem(item)?`${item}`:""));return valueList.join(" ").trim()}function serializeSequentialArrayValues(value,keys){let serializedValue=[];const isValueArray=Array.isArray(value);const hasKeys=keys!==undefined&&keys.length>0;const shouldSerialize=isValueArray&&hasKeys;if(shouldSerialize){value.forEach((item=>{if(typeof item==="object"){const serializedItem=pick$1(item,keys);if(!isEmptyDataItem(serializedItem)){serializedValue.push(serializeSequentialValues(serializedItem))}}}))}else if(isValueArray===true&&hasKeys===false&&value.length>0&&value.every((item=>typeof item==="string"))){serializedValue=value}return serializedValue}function serializeArrayValues(value,keys,name){const serializedValue={};const isValueArray=Array.isArray(value);const hasKeys=keys!==undefined&&keys.length>0;const hasName=name!==undefined;const shouldSerialize=isValueArray&&hasKeys&&hasName;if(shouldSerialize){let serializedValues=[];value.forEach((item=>{if(typeof item==="object"){const serializedItem=pick$1(item,keys);serializedValues=[...serializedValues,...Object.values(serializedItem)]}}));set(serializedValue,name,serializedValues)}return shouldSerialize?serializedValue:value}function serializeWrapInArray(value){return isEmptyDataItem(value)===false?[value].flat():[]}class DefaultSerializer extends AbstractSerializer{serialize(value){return value}}class SequentialValuesSerializer extends(WithKeys(AbstractSerializer)){serialize(value){return serializeSequentialValues(value)}prepare(value,paramConfig){this.originalValue=value;this.getKeys(value,paramConfig);let toSerializeValue=value;toSerializeValue=pick$1(value,this.toSerializeKeys);return toSerializeValue}postProcess(value,paramConfig){let fullyProcessedValue=value;if(paramConfig.serializationParameterName!==undefined){const unSerializedSubset=omit$1(this.originalValue,this.toSerializeKeys);set(unSerializedSubset,paramConfig.serializationParameterName,value);fullyProcessedValue=unSerializedSubset}return fullyProcessedValue}}class SequentialValueArraySerializer extends(WithKeys(AbstractSerializer)){serialize(value){return serializeSequentialArrayValues(value,this.toSerializeKeys)}prepare(value,paramConfig){this.getKeys(value,paramConfig);return value}}class ArrayValuesSerializer extends(WithKeys(AbstractSerializer)){serialize(value){return serializeArrayValues(value,this.toSerializeKeys,this.toSerializeName)}prepare(value,paramConfig){this.toSerializeName=paramConfig.serializationParameterName;this.getKeys(value,paramConfig);return value}}class StringValueSerializer extends(WithKeys(AbstractSerializer)){serialize(value){return typeof value==="string"?value:JSON.stringify(value)}}class WrapInArraySerializer extends(WithKeys(AbstractSerializer)){serialize(value){return serializeWrapInArray(value)}}const serializers={[SerializationType.sequentialValues]:SequentialValuesSerializer,[SerializationType.sequentialValueArray]:SequentialValueArraySerializer,[SerializationType.arrayValues]:ArrayValuesSerializer,[SerializationType.string]:StringValueSerializer,[SerializationType.wrapInAnArray]:WrapInArraySerializer,[SerializationType.default]:DefaultSerializer};const CalculatedParameterValueKeys={CurrentTime:"CALCULATE_CURRENT_TIME"};const DefaultUIOnlyParamKeys={ExcludedUIOnlyParamKeys:["itemProperties","userSettings"],ExcludedUIOnlyParamPartialKeys:[SelectedLayersKey],AlwaysIncludedUIOnlyParamKeys:["saveResultIn"]};function getUIParamsByName(uiParameters){const paramsByName={};for(const uiParameter of uiParameters){if(uiParameter.UIparameters!==undefined){Object.assign(paramsByName,getUIParamsByName(uiParameter.UIparameters))}else if(uiParameter.name!==undefined){if(uiParameter.name!==undefined){paramsByName[uiParameter.name]=uiParameter}}}return paramsByName}function getUIOnlyParams(props){const{toolData,keysToRemove}=props;const isWebTool=props.isWebTool??false;const partialKeysToRemove=props.partialKeysToRemove??[];const{ExcludedUIOnlyParamKeys,ExcludedUIOnlyParamPartialKeys,AlwaysIncludedUIOnlyParamKeys}=DefaultUIOnlyParamKeys;const alwaysIncludedUIOnlyParams={};if(!isWebTool){for(const key of AlwaysIncludedUIOnlyParamKeys){alwaysIncludedUIOnlyParams[key]=toolData[key]}}const allExcludedKeys=[...ExcludedUIOnlyParamKeys,...keysToRemove];const allExcludedPartialKeys=[...ExcludedUIOnlyParamPartialKeys,...partialKeysToRemove];const keySubstringMatches=Object.keys(toolData).filter((key=>allExcludedPartialKeys.some((partialKey=>key.includes(partialKey)))));const allParamKeysToRemove=[...allExcludedKeys,...keySubstringMatches];const toolUIOnlyParams=omit$1(toolData,allParamKeysToRemove);const removeEmptyItem=key=>{if(isEmptyDataItem(toolUIOnlyParams[key]))delete toolUIOnlyParams[key]};Object.keys(toolUIOnlyParams).forEach(removeEmptyItem);return{...toolUIOnlyParams,...alwaysIncludedUIOnlyParams}}const toPascalToolName=toolName=>`${toolName.charAt(0).toUpperCase()}${toolName.slice(1)}`;const toCamelToolName=toolName=>`${toolName.charAt(0).toLowerCase()}${toolName.slice(1)}`;function formatAnalysisEngineSuffix(analysisEngine){analysisEngine??(analysisEngine=AnalysisEngine.Standard);let analysisEngineSuffix="";switch(analysisEngine){case AnalysisEngine.Raster:analysisEngineSuffix="_ra";break;default:case AnalysisEngine.GeoAnalytics:case AnalysisEngine.Standard:analysisEngineSuffix="";break}return analysisEngineSuffix}const getToolJSONs=memoize$2((async path=>{const{locale,name,assetPrefix,analysisEngine,memoizedHelper}=path;const lowercaseToolName=`${name.toLowerCase()}${formatAnalysisEngineSuffix(analysisEngine)}`;let toolUIJson;let toolT9n;let commonT9n;let toolJson;const toolPath=`${assetPrefix}/tool-ui-json/${lowercaseToolName}.tool.ui.json`;const toolJSONPath=`${assetPrefix}/tool-json/${lowercaseToolName}.tool.json`;const t9nPath=`${assetPrefix}/t9n/${lowercaseToolName}/${lowercaseToolName}.t9n.${locale}.json`;const commonT9nPath=`${assetPrefix}/t9n/common.t9n.${locale}.json`;let helpLocale=locale;if(locale===SupportedLocales.English||locale===SupportedLocales.EnglishUSA){helpLocale=""}else if(helpLocale===SupportedLocales.NorwegianBokml){helpLocale="no"}const toolHelpFilePath=`${assetPrefix}/help/${helpLocale!==""?helpLocale+"/":""}${name}${formatAnalysisEngineSuffix(analysisEngine)}.html`;try{toolJson=await memoizedHelper(toolJSONPath);toolUIJson=await memoizedHelper(toolPath);toolT9n=await memoizedHelper(t9nPath);commonT9n=await memoizedHelper(commonT9nPath);toolT9n={...commonT9n,...toolT9n}}catch{toolUIJson=undefined}return{toolJson,toolUIJson,toolT9n,toolHelpFilePath}}));async function getWebToolUIJson(webToolJSON,commonT9nPath,memoizedHelper){let commonT9n;try{commonT9n=await memoizedHelper(commonT9nPath)}catch{throw new Error(`Failed to fetch asset from path: "${commonT9nPath}"`)}const datasetInputParamsMap={};const webToolsUnits=commonT9n.webToolsUnits;const inputParams=[];const inputUIParameters=[];let analysisBlock;for(const param of webToolJSON.parameters??[]){if(param.direction===AnalysisToolParamDirection.Input){const inputUIParam={name:param.name,label:param.displayName??param.name};if(param.name==="esri_out_feature_service_name"&&param.dataType==="GPString"){analysisBlock={componentName:"analysis-block",label:commonT9n.resultLayerGroupLabel,summaryText:commonT9n.resultLayerGroupText,UIparameters:[inputUIParam]}}else{if(param.dataType==="GPFeatureRecordSetLayer"||param.dataType==="GPRecordSet"){datasetInputParamsMap[param.name]=param}else{inputParams.push(param);if(param.dataType==="GPLinearUnit"){inputUIParam.choiceList=Object.keys(webToolsUnits);inputUIParam.choiceListLabels=webToolsUnits}else if(param.dataType==="GPMultiValue:GPLinearUnit"){inputUIParam.UIparameterInfos=[{name:"",choiceList:Object.keys(webToolsUnits),choiceListLabels:webToolsUnits}]}}inputUIParameters.push(inputUIParam)}}}const toolUIJson={toolName:webToolJSON.name,version:AnalysisToolUICurrentVersion,UIparameters:[]};if(!isEmptyDataItem(inputUIParameters)){toolUIJson.UIparameters.push({componentName:"analysis-block",UIparameters:inputUIParameters})}if(analysisBlock!==undefined){toolUIJson.UIparameters.push(analysisBlock)}for(const param of inputParams){let dependsOn;if(param.dependency!==undefined){dependsOn=datasetInputParamsMap[param.dependency]}if((param.dataType==="Field"||param.dataType==="GPMultiValue:Field")&&dependsOn!==undefined){if(toolUIJson.rules===undefined){toolUIJson.rules=[]}toolUIJson.rules.push({ruleType:"expression",expression:`$[Data].${dependsOn.name} NOT null`,destination:param.name,effectParams:{mapLayer:`$[Component].${dependsOn.name}.selectedLayers`}})}}return toolUIJson}function isTravelModeUsedByTool(toolName){const supportedToolNames=["ChooseBestFacilities","ConnectOriginsToDestinations","CreateDriveTimeAreas","EnrichLayer","FindNearest","PlanRoutes","SummarizeNearby"];return supportedToolNames.includes(toolName)}function calculateParameterValues(jobParams){const calculatedJobParams={...jobParams};for(const param in calculatedJobParams){switch(calculatedJobParams[param]){case CalculatedParameterValueKeys.CurrentTime:calculatedJobParams[param]=(new Date).getTime();break}}return calculatedJobParams}function replaceSpacesWithUnderscores(value){return value.replace(/\s/g,"_")}function formatOutputNameForPortal(outputNameValue,isPortal=false){let formattedOutputName=outputNameValue;if(isPortal===true){const outputName=JSON.parse(outputNameValue);const potentialServiceNamePaths={"serviceProperties.name":outputName.serviceProperties?.name,"itemProperties.title":outputName.itemProperties?.title};const[serviceNameSource,serviceName]=Object.entries(potentialServiceNamePaths).find((([_key,value])=>value!==undefined))??[];if(serviceNameSource!==undefined){const formattedServiceName=replaceSpacesWithUnderscores(serviceName);set(outputName,serviceNameSource,formattedServiceName)}formattedOutputName=JSON.stringify(outputName)}return formattedOutputName}function getActualOutputNames(parameterNames){let outputParamNames=["outputName"];if(parameterNames?.includes("aboveGroundLevelOutputName")===true)outputParamNames.push("aboveGroundLevelOutputName");if(parameterNames?.includes("outputName")===false){outputParamNames=parameterNames.filter((name=>name.toLowerCase().includes("output")))}return outputParamNames}function getJobParams(toolJSON,data){const{parameters}=toolJSON;const parameterNames=parameters?.filter((parameter=>parameter.direction!==AnalysisToolParamDirection.Output))?.map((parameter=>parameter.name));let jobParams=pick$1(data,parameterNames);jobParams=removeEmptyObjects(jobParams);return jobParams}function filterAndRenameParams({jobParams,UIOnlyParams,toolUIParamModel,useSubmissionName=true}){const updatedParams={...jobParams};if(isEmptyDataItem(toolUIParamModel)===false){const renamedParams={};for(const[key,value]of Object.entries({...jobParams,...UIOnlyParams})){const inViewModel=toolUIParamModel?.[key]!==undefined;const submissionName=get(toolUIParamModel,[key,"submissionName"]);const isVisible=inViewModel&&get(toolUIParamModel,[key,"visible"],true);if(submissionName!==undefined&&isVisible===true){const newKey=useSubmissionName===true?submissionName:key;const removedKey=useSubmissionName===true?key:submissionName;renamedParams[newKey]=value;delete updatedParams[removedKey]}else if(inViewModel===false&&key!=="context"){delete updatedParams[key]}}Object.assign(updatedParams,renamedParams)}return updatedParams}function serializeOutputName(toolData,jobParams,outParamName){const outputName={};if(toolData!==undefined&&(toolData.resultType===undefined||toolData.resultType!==undefined&&["TILED_IMAGERY_LAYER","DYNAMIC_IMAGERY_LAYER","FEATURE_LAYER",AnalysisSupportedItemTypes.FeatureLayer,AnalysisSupportedItemTypes.FeatureService,AnalysisSupportedItemTypes.ImageService].includes(toolData.resultType))){outputName.serviceProperties={name:jobParams[outParamName]}}if(outputName.serviceProperties!==undefined&&toolData.resultType!==undefined&&toolData.resultType!==null&&["TILED_IMAGERY_LAYER","DYNAMIC_IMAGERY_LAYER"].includes(toolData.resultType)){outputName.serviceProperties.capabilities=toolData.resultType==="TILED_IMAGERY_LAYER"?"Image, TilesOnly":"Image"}if(toolData.itemProperties!==undefined){outputName.itemProperties=toolData.itemProperties;if(outputName.itemProperties!==undefined){outputName.itemProperties.title=jobParams[outParamName];outputName.itemProperties.folderId=toolData.saveResultIn}}return JSON.stringify(outputName)}function serializeGenericParameter(paramConfig,parameterObject){let fullyProcessedValue;const serializationType=paramConfig.serializationType;if(serializationType!==undefined){const serializer=new serializers[serializationType];const preparedData=serializer.prepare(parameterObject,paramConfig);const serializedValue=serializer.serialize(preparedData);fullyProcessedValue=serializer.postProcess(serializedValue,paramConfig)}return fullyProcessedValue}function prepJobParamsForSubmission(options){const{jobParams,toolData,toolUIJson,toolName,toolJSON,isPortal=false}=options;let serializedJobParams={...jobParams};const paramsByName=getUIParamsByName(toolUIJson);const parameterNames=toolJSON?.parameters?.filter((parameter=>parameter.direction!==AnalysisToolParamDirection.Output))?.map((parameter=>parameter.name));const actualOutputNames=getActualOutputNames(parameterNames);if(toolName==="BatchGeocode"&&toolData!==undefined){const geocodeUIParameters=toolData.geocodeUIParameters;const geocodeParameters=toolData.geocodeParameters;const singleLine=toolData.singleOrMultiFieldSwitch==="singleField";const addressFields=paramsByName.geocodeUIParameters.UIparameterInfos.map((addressField=>addressField.name));let fieldMapping;if(singleLine){fieldMapping=addressFields.reduce(((acc,curr)=>{if(curr==="SingleLine"){acc.push([geocodeUIParameters[curr]??"",curr])}else{acc.push([geocodeUIParameters[curr]??"",""])}return acc}),[])}else{fieldMapping=addressFields.reduce(((acc,curr)=>{if(curr!=="SingleLine"){acc.push([geocodeUIParameters[curr]??"",curr])}return acc}),[])}geocodeParameters.field_mapping=JSON.stringify(fieldMapping);serializedJobParams.geocodeParameters=geocodeParameters;if(!isEmptyDataItem(serializedJobParams.inputFileItem)){serializedJobParams.inputFileItem={itemid:serializedJobParams.inputFileItem?.itemId}}}for(const paramName in serializedJobParams){const paramConfig=paramsByName[paramName];const parameterValue=serializedJobParams[paramName];if(isEmptyDataItem(parameterValue)){serializedJobParams[paramName]=undefined}else if(typeof parameterValue==="object"&&paramConfig?.serializationType!==undefined){serializedJobParams[paramName]=serializeGenericParameter(paramConfig,parameterValue)}else if(typeof parameterValue==="string"&&actualOutputNames.includes(paramName)&&toolData!==undefined){const outputNameObjectString=serializeOutputName(toolData,jobParams,paramName);let formattedOutputName=outputNameObjectString;try{formattedOutputName=formatOutputNameForPortal(outputNameObjectString,isPortal)}catch(error){}serializedJobParams[paramName]=formattedOutputName}}if(toolName==="ChooseBestFacilities"){const UIparameterViewModel=toolData?.[ParamViewModelKey];const UIOnlyParams=omit$1(toolData,Object.keys(serializedJobParams));serializedJobParams=filterAndRenameParams({jobParams:serializedJobParams,UIOnlyParams,toolUIParamModel:UIparameterViewModel})}return omitBy(serializedJobParams,isEmptyDataItem)}function sanitizeTokensFromJobParams(jobParams){for(const key of Object.keys(jobParams)){let currentParam=jobParams[key];if(currentParam!==undefined&&currentParam!==null){if(typeof currentParam==="string"&&currentParam.includes("http")){currentParam=sanitizeUrl(currentParam)}else if(Array.isArray(currentParam)){currentParam.forEach((param=>{if(typeof param==="object"&&"url"in param&&param.url!==undefined&&param.url!==null){param.url=sanitizeUrl(param.url);param.serviceToken=undefined}}))}else if(typeof currentParam==="object"&&"url"in currentParam&&currentParam.url!==undefined&&currentParam.url!==null){currentParam.url=sanitizeUrl(currentParam.url);currentParam.serviceToken=undefined}else if(key==="context"&&typeof currentParam==="object"){sanitizeTokensFromJobParams(currentParam)}}jobParams[key]=currentParam}return jobParams}function getResultParams(toolJSON){const{parameters}=toolJSON;const resultParams=parameters?.filter((parameter=>parameter.direction===AnalysisToolParamDirection.Output)).map((parameter=>parameter.name));return resultParams??[]}memoize$1((async portal=>{const{url:portalUrl}=portal;const url=`${portalUrl}/sharing/rest/community/self`;const credential=esriId__default["default"].findCredential(url);let token;if(credential!==undefined){token=credential.token}const options={query:{returnUserLicensedItems:true,token,f:"json"}};try{const{data:{userLicensedItems}}=await request(url,options);return[...userLicensedItems.map((({entitlements})=>entitlements))].flat()}catch(e){await throwError(ErrorKeywords.NetworkError)}return[]}),{serializer:args=>`${args.user.username}`});memoize$1((async layer=>{let processedProperties={isMultidimensional:false};const mutlidimensionalInfo=layer.type==="imagery-tile"?layer.rasterInfo.multidimensionalInfo:layer.multidimensionalInfo;const multidimensionalSubset=layer.multidimensionalSubset;if(mutlidimensionalInfo!==undefined&&mutlidimensionalInfo!==null){const variables=multidimensionalSubset!==null&&multidimensionalSubset!==undefined?layer.getMultidimensionalSubsetVariables():mutlidimensionalInfo.variables;if(variables!==undefined&&variables.length>0){const dimensions=[];const variableFields=[];const dimensionVariables={};const dimensionValues={};const dimensionVariableDatasets={};const dimensionMinValues={};const dimensionMaxValues={};const dimensionMinValuesWithLabels={};const dimensionMaxValuesWithLabels={};variables.forEach(((variable,vidx)=>{let dimensionsDescription="";const variableName=variable.name;variable.dimensions.forEach(((dimension,index)=>{const dimensionName=dimension.name;if(dimensions.indexOf(dimensionName)===-1){dimensions.push(dimensionName)}const dimensionDescription=index>0?`,${dimensionName}=${dimension.values?.length}`:`${dimensionName}=${dimension.values?.length}`;dimensionsDescription=dimensionsDescription.concat(dimensionDescription);if(index===0){dimensionValues[variableName]={}}if(dimensionVariables[dimensionName]===undefined){dimensionVariables[dimensionName]=[]}dimensionValues[variableName][dimensionName]=dimension.values;if(vidx===0){const values=dimension.values;if(values!==undefined){if(dimensionName==="StdTime"&&(dimension.unit===undefined||dimension.unit==="ISO8601")){const dimMinValues=[];const dimMaxValues=[];const dimMinValuesWithLabels={};const dimMaxValuesWithLabels={};values.forEach((value=>{if(typeof value==="number"){const date=new Date(value);const label=date.toLocaleString();const val=date.toISOString();dimMinValues.push(val);dimMaxValues.push(val);dimMinValuesWithLabels[val]=label;dimMaxValuesWithLabels[val]=label}else if(Array.isArray(value)){const d1=new Date(value[0]);const d2=new Date(value[1]);const val1=d1.toISOString();const val2=d2.toISOString();dimMinValues.push(val1);dimMaxValues.push(val2);dimMinValuesWithLabels[val1]=d1.toLocaleString();dimMaxValuesWithLabels[val2]=d2.toLocaleString()}}));dimensionMinValues[dimensionName]=dimMinValues;dimensionMaxValues[dimensionName]=dimMaxValues;dimensionMinValuesWithLabels[dimensionName]=dimMinValuesWithLabels;dimensionMaxValuesWithLabels[dimensionName]=dimMaxValuesWithLabels}else{if(Array.isArray(values)&&typeof values[0]==="number"){dimensionMinValues[dimensionName]=dimensionMaxValues[dimensionName]=values.map(String)}else if(Array.isArray(values[0])&&Array.isArray(values[1])){dimensionMinValues[dimensionName]=values[0].map(String);dimensionMaxValues[dimensionName]=values[1].map(String)}}}}dimensionVariables[dimensionName].push(variableName)}));variableFields.push({name:variableName,alias:`${variableName}[${dimensionsDescription}](${variable.description})`,type:"string"})}));for(const key in dimensionVariables){const filteredFields=variableFields.filter((variableKey=>dimensionVariables[key].indexOf(variableKey.name)>-1));dimensionVariableDatasets[key]={id:"1",name:key,description:"DimensionVariables",getFields:()=>Promise.resolve(filteredFields)}}const variablesDataset={id:"1",name:"Variables",description:"Variables",getFields:()=>Promise.resolve(variableFields)};processedProperties={isMultidimensional:true,dimensions,dimensionVariableDatasets,dimensionValues,variablesDataset,dimensionMinValues,dimensionMaxValues,dimensionMinValuesWithLabels,dimensionMaxValuesWithLabels}}}const rasterInfo=layer.type==="imagery"?await layer.generateRasterInfo(layer.renderingRule):layer.rasterInfo;processedProperties.rasterInfo=rasterInfo;return processedProperties}));const analyzeGeocodeInput=async params=>{const{asyncGeocodeUrl}=params;const jobInfo=await geoprocessor__namespace.submitJob(`${asyncGeocodeUrl}/AnalyzeGeocodeInput`,{...omit$1(params,"asyncGeocodeUrl"),f:"json"});try{await jobInfo.waitForJobCompletion();const result=await jobInfo.fetchResultData("geocodeParameters");return result.value}catch(err){console.error("AnalyzeGeocodeInput failed");throw err}};memoize$1(((itemId,portal)=>new PortalItem__default["default"]({id:itemId,portal})),{serializer:args=>`${args[0]}-${args[1]?.url}`});function getHelpBaseUrl(portal){return portal?.sourceJSON.helpBase??""}memoize$1((async portal=>{const{restUrl}=portal;const url=`${restUrl}/portals/helpmap`;let helpMap;try{const fetchPortalHelpMap=await request$1__default["default"](url,{query:{f:"json"},responseType:"json",method:"auto"});helpMap=await(fetchPortalHelpMap.data?.helpMap)??undefined}catch(e){helpMap=undefined}return helpMap}),{serializer:args=>`${args[0]}-${args[1]?.url}`});const UIDefaults={DebounceTimer:400,HelpDebounceTimer:1500,PopoverTimer:60,Scale:"s"};exports.DEFAULT_CREDIT_ERROR_KEY=DEFAULT_CREDIT_ERROR_KEY;exports.DEFAULT_ERROR_KEY=DEFAULT_ERROR_KEY;exports.ErrorKeywords=ErrorKeywords;exports.H=H;exports.Host=Host;exports.PortalDeploymentType=PortalDeploymentType;exports.SupportedLocales=SupportedLocales;exports.UIDefaults=UIDefaults;exports.UIInputStatus=UIInputStatus;exports.ValidityState=ValidityState;exports.calculateParameterValues=calculateParameterValues;exports.convertErrorToAnalysisValidationParams=convertErrorToAnalysisValidationParams;exports.convertJobParamsToToolData=convertJobParamsToToolData;exports.createEvent=createEvent;exports.fetchComponentLocaleStrings=fetchComponentLocaleStrings;exports.forceUpdate=forceUpdate;exports.formatAnalysisEngineSuffix=formatAnalysisEngineSuffix;exports.formatLearnMoreHelpUrl=formatLearnMoreHelpUrl;exports.formatMessage=formatMessage;exports.formatNumberToLocale=formatNumberToLocale;exports.getAnalysisLayers=getAnalysisLayers;exports.getAssetPath=getAssetPath;exports.getFeatureCollectionValueForStorage=getFeatureCollectionValueForStorage;exports.getGPFeatureRecordSetLayerValue=getGPFeatureRecordSetLayerValue;exports.getHelpBaseUrl=getHelpBaseUrl;exports.getImageryLayerValue=getImageryLayerValue;exports.getJobParams=getJobParams;exports.getLayerObject=getLayerObject;exports.getLocaleInfo=getLocaleInfo;exports.getRenderingRef=getRenderingRef;exports.getResultParams=getResultParams;exports.getToolJSONs=getToolJSONs;exports.getUIOnlyParams=getUIOnlyParams;exports.getValidityStatus=getValidityStatus;exports.getWebToolUIJson=getWebToolUIJson;exports.h=h;exports.hasNAPrivilege=hasNAPrivilege;exports.isEmptyDataItem=isEmptyDataItem;exports.isFeatureLayer=isFeatureLayer;exports.isImageryLayer=isImageryLayer;exports.isImageryTileLayer=isImageryTileLayer;exports.isTravelModeUsedByTool=isTravelModeUsedByTool;exports.prepJobParamsForSubmission=prepJobParamsForSubmission;exports.proxyCustomElement=proxyCustomElement;exports.sanitizeTokensFromJobParams=sanitizeTokensFromJobParams;exports.sanitizeUrl=sanitizeUrl;exports.setAssetPath=setAssetPath;exports.setNonce=setNonce;exports.setPlatformOptions=setPlatformOptions;exports.toCamelToolName=toCamelToolName;exports.toPascalToolName=toPascalToolName;exports.updateToolErrorState=updateToolErrorState}));
