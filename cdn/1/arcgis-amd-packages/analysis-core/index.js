define(["require","exports","esri/rest/support/JobInfo","esri/rest/geoprocessor","esri/request","esri/rest/support/ParameterValue","esri/core/urlUtils","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/identity/IdentityManager","esri/core/reactiveUtils","esri/rest/support/Query","esri/core/promiseUtils","esri/portal/PortalItemResource","esri/layers/FeatureLayer","esri/geometry/support/jsonUtils","esri/layers/Layer","esri/portal/PortalItem","esri/layers/support/Field","esri/renderers/Renderer","esri/rest/support/FeatureSet","esri/config","esri/smartMapping/statistics/uniqueValues","esri/core/sql"],(function(e,t,r,n,o,a,i,s,c,u,l,f,p,d,b,y,v,h,g,m,w,j,_,O,S){"use strict";function P(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function E(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var A=P(r),T=E(n),k=P(o),I=P(l),$=P(y),C=P(g),x=P(m),z=P(w),N=P(j),U=P(_),L="object"==typeof global&&global&&global.Object===Object&&global,F="object"==typeof self&&self&&self.Object===Object&&self,R=L||F||Function("return this")(),D=R.Symbol,M=Object.prototype,J=M.hasOwnProperty,B=M.toString,V=D?D.toStringTag:void 0;var G=Object.prototype.toString;var H=D?D.toStringTag:void 0;function W(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":H&&H in Object(e)?function(e){var t=J.call(e,V),r=e[V];try{e[V]=void 0;var n=!0}catch(e){}var o=B.call(e);return n&&(t?e[V]=r:delete e[V]),o}(e):function(e){return G.call(e)}(e)}function q(e){return null!=e&&"object"==typeof e}function K(e){return"symbol"==typeof e||q(e)&&"[object Symbol]"==W(e)}function Y(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var Z=Array.isArray,Q=D?D.prototype:void 0,X=Q?Q.toString:void 0;function ee(e){if("string"==typeof e)return e;if(Z(e))return Y(e,ee)+"";if(K(e))return X?X.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function te(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function re(e){return e}function ne(e){if(!te(e))return!1;var t=W(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var oe,ae=R["__core-js_shared__"],ie=(oe=/[^.]+$/.exec(ae&&ae.keys&&ae.keys.IE_PROTO||""))?"Symbol(src)_1."+oe:"";var se=Function.prototype.toString;function ce(e){if(null!=e){try{return se.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ue=/^\[object .+?Constructor\]$/,le=Function.prototype,fe=Object.prototype,pe=le.toString,de=fe.hasOwnProperty,be=RegExp("^"+pe.call(de).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ye(e){return!(!te(e)||(t=e,ie&&ie in t))&&(ne(e)?be:ue).test(ce(e));var t}function ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return ye(r)?r:void 0}var he=ve(R,"WeakMap"),ge=Object.create,me=function(){function e(){}return function(t){if(!te(t))return{};if(ge)return ge(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),we=me;function je(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _e=Date.now;function Oe(e){return function(){return e}}var Se,Pe,Ee,Ae=function(){try{var e=ve(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Te=Ae,ke=Te?function(e,t){return Te(e,"toString",{configurable:!0,enumerable:!1,value:Oe(t),writable:!0})}:re,Ie=(Se=ke,Pe=0,Ee=0,function(){var e=_e(),t=16-(e-Ee);if(Ee=e,t>0){if(++Pe>=800)return arguments[0]}else Pe=0;return Se.apply(void 0,arguments)}),$e=Ie;function Ce(e){return e!=e}function xe(e,t){return!!(null==e?0:e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var o=e.length,a=r+(n?1:-1);n?a--:++a<o;)if(t(e[a],a,e))return a;return-1}(e,Ce,r)}(e,t,0)>-1}var ze=/^(?:0|[1-9]\d*)$/;function Ne(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&ze.test(e))&&e>-1&&e%1==0&&e<t}function Ue(e,t,r){"__proto__"==t&&Te?Te(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Le(e,t){return e===t||e!=e&&t!=t}var Fe=Object.prototype.hasOwnProperty;function Re(e,t,r){var n=e[t];Fe.call(e,t)&&Le(n,r)&&(void 0!==r||t in e)||Ue(e,t,r)}function De(e,t,r,n){var o=!r;r||(r={});for(var a=-1,i=t.length;++a<i;){var s=t[a],c=n?n(r[s],e[s],s,r,e):void 0;void 0===c&&(c=e[s]),o?Ue(r,s,c):Re(r,s,c)}return r}var Me=Math.max;function Je(e,t,r){return t=Me(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,a=Me(n.length-t,0),i=Array(a);++o<a;)i[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(i),je(e,this,s)}}function Be(e,t){return $e(Je(e,t,re),e+"")}function Ve(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ge(e){return null!=e&&Ve(e.length)&&!ne(e)}function He(e,t,r){if(!te(r))return!1;var n=typeof t;return!!("number"==n?Ge(r)&&Ne(t,r.length):"string"==n&&t in r)&&Le(r[t],e)}function We(e){return Be((function(t,r){var n=-1,o=r.length,a=o>1?r[o-1]:void 0,i=o>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(o--,a):void 0,i&&He(r[0],r[1],i)&&(a=o<3?void 0:a,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,a)}return t}))}var qe=Object.prototype;function Ke(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||qe)}function Ye(e){return q(e)&&"[object Arguments]"==W(e)}var Ze=Object.prototype,Qe=Ze.hasOwnProperty,Xe=Ze.propertyIsEnumerable,et=Ye(function(){return arguments}())?Ye:function(e){return q(e)&&Qe.call(e,"callee")&&!Xe.call(e,"callee")},tt=et;var rt="object"==typeof t&&t&&!t.nodeType&&t,nt=rt&&"object"==typeof module&&module&&!module.nodeType&&module,ot=nt&&nt.exports===rt?R.Buffer:void 0,at=(ot?ot.isBuffer:void 0)||function(){return!1},it={};function st(e){return function(t){return e(t)}}it["[object Float32Array]"]=it["[object Float64Array]"]=it["[object Int8Array]"]=it["[object Int16Array]"]=it["[object Int32Array]"]=it["[object Uint8Array]"]=it["[object Uint8ClampedArray]"]=it["[object Uint16Array]"]=it["[object Uint32Array]"]=!0,it["[object Arguments]"]=it["[object Array]"]=it["[object ArrayBuffer]"]=it["[object Boolean]"]=it["[object DataView]"]=it["[object Date]"]=it["[object Error]"]=it["[object Function]"]=it["[object Map]"]=it["[object Number]"]=it["[object Object]"]=it["[object RegExp]"]=it["[object Set]"]=it["[object String]"]=it["[object WeakMap]"]=!1;var ct="object"==typeof t&&t&&!t.nodeType&&t,ut=ct&&"object"==typeof module&&module&&!module.nodeType&&module,lt=ut&&ut.exports===ct&&L.process,ft=function(){try{var e=ut&&ut.require&&ut.require("util").types;return e||lt&&lt.binding&&lt.binding("util")}catch(e){}}(),pt=ft&&ft.isTypedArray,dt=pt?st(pt):function(e){return q(e)&&Ve(e.length)&&!!it[W(e)]},bt=dt,yt=Object.prototype.hasOwnProperty;function vt(e,t){var r=Z(e),n=!r&&tt(e),o=!r&&!n&&at(e),a=!r&&!n&&!o&&bt(e),i=r||n||o||a,s=i?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=s.length;for(var u in e)!t&&!yt.call(e,u)||i&&("length"==u||o&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ne(u,c))||s.push(u);return s}function ht(e,t){return function(r){return e(t(r))}}var gt=ht(Object.keys,Object),mt=Object.prototype.hasOwnProperty;function wt(e){if(!Ke(e))return gt(e);var t=[];for(var r in Object(e))mt.call(e,r)&&"constructor"!=r&&t.push(r);return t}function jt(e){return Ge(e)?vt(e):wt(e)}var _t=Object.prototype.hasOwnProperty;We((function(e,t){if(Ke(t)||Ge(t))De(t,jt(t),e);else for(var r in t)_t.call(t,r)&&Re(e,r,t[r])}));var Ot=Object.prototype.hasOwnProperty;function St(e){if(!te(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=Ke(e),r=[];for(var n in e)("constructor"!=n||!t&&Ot.call(e,n))&&r.push(n);return r}function Pt(e){return Ge(e)?vt(e,!0):St(e)}var Et=We((function(e,t,r,n){De(t,Pt(t),e,n)})),At=Et,Tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kt=/^\w*$/;function It(e,t){if(Z(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!K(e))||(kt.test(e)||!Tt.test(e)||null!=t&&e in Object(t))}var $t=ve(Object,"create");var Ct=Object.prototype.hasOwnProperty;var xt=Object.prototype.hasOwnProperty;function zt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Nt(e,t){for(var r=e.length;r--;)if(Le(e[r][0],t))return r;return-1}zt.prototype.clear=function(){this.__data__=$t?$t(null):{},this.size=0},zt.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zt.prototype.get=function(e){var t=this.__data__;if($t){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Ct.call(t,e)?t[e]:void 0},zt.prototype.has=function(e){var t=this.__data__;return $t?void 0!==t[e]:xt.call(t,e)},zt.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=$t&&void 0===t?"__lodash_hash_undefined__":t,this};var Ut=Array.prototype.splice;function Lt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Lt.prototype.clear=function(){this.__data__=[],this.size=0},Lt.prototype.delete=function(e){var t=this.__data__,r=Nt(t,e);return!(r<0)&&(r==t.length-1?t.pop():Ut.call(t,r,1),--this.size,!0)},Lt.prototype.get=function(e){var t=this.__data__,r=Nt(t,e);return r<0?void 0:t[r][1]},Lt.prototype.has=function(e){return Nt(this.__data__,e)>-1},Lt.prototype.set=function(e,t){var r=this.__data__,n=Nt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var Ft=ve(R,"Map");function Rt(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Dt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Dt.prototype.clear=function(){this.size=0,this.__data__={hash:new zt,map:new(Ft||Lt),string:new zt}},Dt.prototype.delete=function(e){var t=Rt(this,e).delete(e);return this.size-=t?1:0,t},Dt.prototype.get=function(e){return Rt(this,e).get(e)},Dt.prototype.has=function(e){return Rt(this,e).has(e)},Dt.prototype.set=function(e,t){var r=Rt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Mt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=e.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(Mt.Cache||Dt),r}Mt.Cache=Dt;var Jt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bt=/\\(\\)?/g,Vt=function(e){var t=Mt(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Jt,(function(e,r,n,o){t.push(n?o.replace(Bt,"$1"):r||e)})),t})),Gt=Vt;function Ht(e){return null==e?"":ee(e)}function Wt(e,t){return Z(e)?e:It(e,t)?[e]:Gt(Ht(e))}function qt(e){if("string"==typeof e||K(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function Kt(e,t){for(var r=0,n=(t=Wt(t,e)).length;null!=e&&r<n;)e=e[qt(t[r++])];return r&&r==n?e:void 0}function Yt(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var Zt=D?D.isConcatSpreadable:void 0;function Qt(e){return Z(e)||tt(e)||!!(Zt&&e&&e[Zt])}function Xt(e,t,r,n,o){var a=-1,i=e.length;for(r||(r=Qt),o||(o=[]);++a<i;){var s=e[a];t>0&&r(s)?t>1?Xt(s,t-1,r,n,o):Yt(o,s):n||(o[o.length]=s)}return o}function er(e){return(null==e?0:e.length)?Xt(e,1):[]}function tr(e){return $e(Je(e,void 0,er),e+"")}var rr=ht(Object.getPrototypeOf,Object),nr=Function.prototype,or=Object.prototype,ar=nr.toString,ir=or.hasOwnProperty,sr=ar.call(Object);function cr(e){if(!q(e)||"[object Object]"!=W(e))return!1;var t=rr(e);if(null===t)return!0;var r=ir.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&ar.call(r)==sr}function ur(e){if(!q(e))return!1;var t=W(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!cr(e)}var lr=Be((function(e,t){try{return je(e,void 0,t)}catch(e){return ur(e)?e:new Error(e)}})),fr=lr;function pr(e){var t=this.__data__=new Lt(e);this.size=t.size}pr.prototype.clear=function(){this.__data__=new Lt,this.size=0},pr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},pr.prototype.get=function(e){return this.__data__.get(e)},pr.prototype.has=function(e){return this.__data__.has(e)},pr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Lt){var n=r.__data__;if(!Ft||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Dt(n)}return r.set(e,t),this.size=r.size,this};var dr="object"==typeof t&&t&&!t.nodeType&&t,br=dr&&"object"==typeof module&&module&&!module.nodeType&&module,yr=br&&br.exports===dr?R.Buffer:void 0,vr=yr?yr.allocUnsafe:void 0;function hr(){return[]}var gr=Object.prototype.propertyIsEnumerable,mr=Object.getOwnPropertySymbols,wr=mr?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var i=e[r];t(i,r,e)&&(a[o++]=i)}return a}(mr(e),(function(t){return gr.call(e,t)})))}:hr,jr=wr;var _r=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Yt(t,jr(e)),e=rr(e);return t}:hr,Or=_r;function Sr(e,t,r){var n=t(e);return Z(e)?n:Yt(n,r(e))}function Pr(e){return Sr(e,jt,jr)}function Er(e){return Sr(e,Pt,Or)}var Ar=ve(R,"DataView"),Tr=ve(R,"Promise"),kr=ve(R,"Set"),Ir="[object Map]",$r="[object Promise]",Cr="[object Set]",xr="[object WeakMap]",zr="[object DataView]",Nr=ce(Ar),Ur=ce(Ft),Lr=ce(Tr),Fr=ce(kr),Rr=ce(he),Dr=W;(Ar&&Dr(new Ar(new ArrayBuffer(1)))!=zr||Ft&&Dr(new Ft)!=Ir||Tr&&Dr(Tr.resolve())!=$r||kr&&Dr(new kr)!=Cr||he&&Dr(new he)!=xr)&&(Dr=function(e){var t=W(e),r="[object Object]"==t?e.constructor:void 0,n=r?ce(r):"";if(n)switch(n){case Nr:return zr;case Ur:return Ir;case Lr:return $r;case Fr:return Cr;case Rr:return xr}return t});var Mr=Dr,Jr=Object.prototype.hasOwnProperty;var Br=R.Uint8Array;function Vr(e){var t=new e.constructor(e.byteLength);return new Br(t).set(new Br(e)),t}var Gr=/\w*$/;var Hr=D?D.prototype:void 0,Wr=Hr?Hr.valueOf:void 0;function qr(e,t,r){var n,o,a,i=e.constructor;switch(t){case"[object ArrayBuffer]":return Vr(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var r=t?Vr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var r=t?Vr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,r);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return(a=new(o=e).constructor(o.source,Gr.exec(o))).lastIndex=o.lastIndex,a;case"[object Symbol]":return n=e,Wr?Object(Wr.call(n)):{}}}var Kr=ft&&ft.isMap,Yr=Kr?st(Kr):function(e){return q(e)&&"[object Map]"==Mr(e)},Zr=Yr;var Qr=ft&&ft.isSet,Xr=Qr?st(Qr):function(e){return q(e)&&"[object Set]"==Mr(e)},en=Xr,tn="[object Arguments]",rn="[object Function]",nn="[object Object]",on={};function an(e,t,r,n,o,a){var i,s=1&t,c=2&t,u=4&t;if(r&&(i=o?r(e,n,o,a):r(e)),void 0!==i)return i;if(!te(e))return e;var l=Z(e);if(l){if(i=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Jr.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!s)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(e,i)}else{var f=Mr(e),p=f==rn||"[object GeneratorFunction]"==f;if(at(e))return function(e,t){if(t)return e.slice();var r=e.length,n=vr?vr(r):new e.constructor(r);return e.copy(n),n}(e,s);if(f==nn||f==tn||p&&!o){if(i=c||p?{}:function(e){return"function"!=typeof e.constructor||Ke(e)?{}:we(rr(e))}(e),!s)return c?function(e,t){return De(e,Or(e),t)}(e,function(e,t){return e&&De(t,Pt(t),e)}(i,e)):function(e,t){return De(e,jr(e),t)}(e,function(e,t){return e&&De(t,jt(t),e)}(i,e))}else{if(!on[f])return o?e:{};i=qr(e,f,s)}}a||(a=new pr);var d=a.get(e);if(d)return d;a.set(e,i),en(e)?e.forEach((function(n){i.add(an(n,t,r,n,e,a))})):Zr(e)&&e.forEach((function(n,o){i.set(o,an(n,t,r,o,e,a))}));var b=l?void 0:(u?c?Er:Pr:c?Pt:jt)(e);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););}(b||e,(function(n,o){b&&(n=e[o=n]),Re(i,o,an(n,t,r,o,e,a))})),i}on[tn]=on["[object Array]"]=on["[object ArrayBuffer]"]=on["[object DataView]"]=on["[object Boolean]"]=on["[object Date]"]=on["[object Float32Array]"]=on["[object Float64Array]"]=on["[object Int8Array]"]=on["[object Int16Array]"]=on["[object Int32Array]"]=on["[object Map]"]=on["[object Number]"]=on[nn]=on["[object RegExp]"]=on["[object Set]"]=on["[object String]"]=on["[object Symbol]"]=on["[object Uint8Array]"]=on["[object Uint8ClampedArray]"]=on["[object Uint16Array]"]=on["[object Uint32Array]"]=!0,on["[object Error]"]=on[rn]=on["[object WeakMap]"]=!1;function sn(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Dt;++t<r;)this.add(e[t])}function cn(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function un(e,t){return e.has(t)}sn.prototype.add=sn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},sn.prototype.has=function(e){return this.__data__.has(e)};function ln(e,t,r,n,o,a){var i=1&r,s=e.length,c=t.length;if(s!=c&&!(i&&c>s))return!1;var u=a.get(e),l=a.get(t);if(u&&l)return u==t&&l==e;var f=-1,p=!0,d=2&r?new sn:void 0;for(a.set(e,t),a.set(t,e);++f<s;){var b=e[f],y=t[f];if(n)var v=i?n(y,b,f,t,e,a):n(b,y,f,e,t,a);if(void 0!==v){if(v)continue;p=!1;break}if(d){if(!cn(t,(function(e,t){if(!un(d,t)&&(b===e||o(b,e,r,n,a)))return d.push(t)}))){p=!1;break}}else if(b!==y&&!o(b,y,r,n,a)){p=!1;break}}return a.delete(e),a.delete(t),p}function fn(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function pn(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var dn=D?D.prototype:void 0,bn=dn?dn.valueOf:void 0;var yn=Object.prototype.hasOwnProperty;var vn="[object Arguments]",hn="[object Array]",gn="[object Object]",mn=Object.prototype.hasOwnProperty;function wn(e,t,r,n,o,a){var i=Z(e),s=Z(t),c=i?hn:Mr(e),u=s?hn:Mr(t),l=(c=c==vn?gn:c)==gn,f=(u=u==vn?gn:u)==gn,p=c==u;if(p&&at(e)){if(!at(t))return!1;i=!0,l=!1}if(p&&!l)return a||(a=new pr),i||bt(e)?ln(e,t,r,n,o,a):function(e,t,r,n,o,a,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new Br(e),new Br(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Le(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=fn;case"[object Set]":var c=1&n;if(s||(s=pn),e.size!=t.size&&!c)return!1;var u=i.get(e);if(u)return u==t;n|=2,i.set(e,t);var l=ln(s(e),s(t),n,o,a,i);return i.delete(e),l;case"[object Symbol]":if(bn)return bn.call(e)==bn.call(t)}return!1}(e,t,c,r,n,o,a);if(!(1&r)){var d=l&&mn.call(e,"__wrapped__"),b=f&&mn.call(t,"__wrapped__");if(d||b){var y=d?e.value():e,v=b?t.value():t;return a||(a=new pr),o(y,v,r,n,a)}}return!!p&&(a||(a=new pr),function(e,t,r,n,o,a){var i=1&r,s=Pr(e),c=s.length;if(c!=Pr(t).length&&!i)return!1;for(var u=c;u--;){var l=s[u];if(!(i?l in t:yn.call(t,l)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var d=!0;a.set(e,t),a.set(t,e);for(var b=i;++u<c;){var y=e[l=s[u]],v=t[l];if(n)var h=i?n(v,y,l,t,e,a):n(y,v,l,e,t,a);if(!(void 0===h?y===v||o(y,v,r,n,a):h)){d=!1;break}b||(b="constructor"==l)}if(d&&!b){var g=e.constructor,m=t.constructor;g==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(d=!1)}return a.delete(e),a.delete(t),d}(e,t,r,n,o,a))}function jn(e,t,r,n,o){return e===t||(null==e||null==t||!q(e)&&!q(t)?e!=e&&t!=t:wn(e,t,r,n,jn,o))}function _n(e){return e==e&&!te(e)}function On(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}function Sn(e){var t=function(e){for(var t=jt(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,_n(o)]}return t}(e);return 1==t.length&&t[0][2]?On(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var o=r.length,a=o,i=!n;if(null==e)return!a;for(e=Object(e);o--;){var s=r[o];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<a;){var c=(s=r[o])[0],u=e[c],l=s[1];if(i&&s[2]){if(void 0===u&&!(c in e))return!1}else{var f=new pr;if(n)var p=n(u,l,c,e,t,f);if(!(void 0===p?jn(l,u,3,n,f):p))return!1}}return!0}(r,e,t)}}function Pn(e,t){return null!=e&&t in Object(e)}function En(e,t){return null!=e&&function(e,t,r){for(var n=-1,o=(t=Wt(t,e)).length,a=!1;++n<o;){var i=qt(t[n]);if(!(a=null!=e&&r(e,i)))break;e=e[i]}return a||++n!=o?a:!!(o=null==e?0:e.length)&&Ve(o)&&Ne(i,o)&&(Z(e)||tt(e))}(e,t,Pn)}function An(e,t){return It(e)&&_n(t)?On(qt(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:Kt(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?En(r,e):jn(t,n,3)}}function Tn(e){return It(e)?(t=qt(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return Kt(t,e)}}(e);var t}function kn(e){return"function"==typeof e?e:null==e?re:"object"==typeof e?Z(e)?An(e[0],e[1]):Sn(e):Tn(e)}function In(e){return q(e)&&Ge(e)}function $n(e,t,r){for(var n=-1,o=null==e?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}function Cn(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var xn,zn=(xn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},function(e){return null==xn?void 0:xn[e]}),Nn=/[&<>"']/g,Un=RegExp(Nn.source);var Ln=Math.min;function Fn(e){return In(e)?e:[]}function Rn(e,t){return t.length<2?e:Kt(e,function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(o);++n<o;)a[n]=e[n+t];return a}(t,0,-1))}Be((function(e){var t=Cn(e),r=Y(e,Fn);return t===Cn(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?function(e,t,r){for(var n=r?$n:xe,o=e[0].length,a=e.length,i=a,s=Array(a),c=1/0,u=[];i--;){var l=e[i];i&&t&&(l=Y(l,st(t))),c=Ln(l.length,c),s[i]=!r&&(t||o>=120&&l.length>=120)?new sn(i&&l):void 0}l=e[0];var f=-1,p=s[0];e:for(;++f<o&&u.length<c;){var d=l[f],b=t?t(d):d;if(d=r||0!==d?d:0,!(p?un(p,b):n(u,b,r))){for(i=a;--i;){var y=s[i];if(!(y?un(y,b):n(e[i],b,r)))continue e}p&&p.push(b),u.push(d)}}return u}(r,kn(t)):[]}));var Dn=Object.prototype.hasOwnProperty;function Mn(e,t){return null==(e=Rn(e,t=Wt(t,e)))||delete e[qt(Cn(t))]}function Jn(e){return cr(e)?void 0:e}var Bn=tr((function(e,t){var r={};if(null==e)return r;var n=!1;t=Y(t,(function(t){return t=Wt(t,e),n||(n=t.length>1),t})),De(e,Er(e),r),n&&(r=an(r,7,Jn));for(var o=t.length;o--;)Mn(r,t[o]);return r})),Vn=Bn;function Gn(e,t,r,n){if(!te(e))return e;for(var o=-1,a=(t=Wt(t,e)).length,i=a-1,s=e;null!=s&&++o<a;){var c=qt(t[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=i){var l=s[c];void 0===(u=n?n(l,c,s):void 0)&&(u=te(l)?l:Ne(t[o+1])?[]:{})}Re(s,c,u),s=s[c]}return e}function Hn(e,t){return function(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var i=t[n],s=Kt(e,i);r(s,i)&&Gn(a,Wt(i,e),s)}return a}(e,t,(function(t,r){return En(e,r)}))}tr((function(e,t){return null==e?{}:Hn(e,t)}));var Wn=Object.prototype,qn=Wn.hasOwnProperty;function Kn(e,t,r,n){return void 0===e||Le(e,Wn[r])&&!qn.call(n,r)?t:e}var Yn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Zn(e){return"\\"+Yn[e]}var Qn=/<%=([\s\S]+?)%>/g,Xn={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Qn,variable:"",imports:{_:{escape:function(e){return(e=Ht(e))&&Un.test(e)?e.replace(Nn,zn):e}}}},eo=/\b__p \+= '';/g,to=/\b(__p \+=) '' \+/g,ro=/(__e\(.*?\)|\b__t\)) \+\n'';/g,no=/[()=,{}\[\]\/\s]/,oo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ao=/($^)/,io=/['\n\r\u2028\u2029\\]/g,so=Object.prototype.hasOwnProperty;function co(e,t,r){var n=Xn.imports._.templateSettings||Xn;r&&He(e,t,r)&&(t=void 0),e=Ht(e),t=At({},t,n,Kn);var o,a,i=At({},t.imports,n.imports,Kn),s=jt(i),c=function(e,t){return Y(t,(function(t){return e[t]}))}(i,s),u=0,l=t.interpolate||ao,f="__p += '",p=RegExp((t.escape||ao).source+"|"+l.source+"|"+(l===Qn?oo:ao).source+"|"+(t.evaluate||ao).source+"|$","g"),d=so.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(p,(function(t,r,n,i,s,c){return n||(n=i),f+=e.slice(u,c).replace(io,Zn),r&&(o=!0,f+="' +\n__e("+r+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),f+="';\n";var b=so.call(t,"variable")&&t.variable;if(b){if(no.test(b))throw new Error("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(a?f.replace(eo,""):f).replace(to,"$1").replace(ro,"$1;"),f="function("+(b||"obj")+") {\n"+(b?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=fr((function(){return Function(s,d+"return "+f).apply(void 0,c)}));if(y.source=f,ur(y))throw y;return y}var uo=kr&&1/pn(new kr([,-0]))[1]==1/0?function(e){return new kr(e)}:function(){};function lo(e){return null==e||"string"==typeof e&&""===e||cr(e)&&function(e){if(null==e)return!0;if(Ge(e)&&(Z(e)||"string"==typeof e||"function"==typeof e.splice||at(e)||bt(e)||tt(e)))return!e.length;var t=Mr(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Ke(e))return!wt(e).length;for(var r in e)if(Dn.call(e,r))return!1;return!0}(e)||Array.isArray(e)&&e.length<1||"object"==typeof e&&!1===Z(e)&&function(e){let t=!0;if("object"==typeof e&&!1===Z(e))for(const r in e){const n=e?.[r];if(!0===e.hasOwnProperty(r)&&null!=n&&""!==n){t=!1;break}}return t}(e)}async function fo(e,t){return k.default(e,t)}Be((function(e){var t=Cn(e);return In(t)&&(t=void 0),function(e,t,r){var n=-1,o=xe,a=e.length,i=!0,s=[],c=s;if(r)i=!1,o=$n;else if(a>=200){var u=t?null:uo(e);if(u)return pn(u);i=!1,o=un,c=new sn}else c=t?[]:s;e:for(;++n<a;){var l=e[n],f=t?t(l):l;if(l=r||0!==l?l:0,i&&f==f){for(var p=c.length;p--;)if(c[p]===f)continue e;t&&c.push(f),s.push(l)}else o(c,f,r)||(c!==s&&c.push(f),s.push(l))}return s}(Xt(e,1,In,!0),kn(t))}));const po={Arabic:"ar",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Czech:"cs",Danish:"da",German:"de",Greek:"el",English:"en",EnglishUSA:"en-US",Spanish:"es",Estonian:"et",Finnish:"fi",French:"fr",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Italian:"it",Japanese:"ja",Korean:"ko",Lithuanian:"lt",Latvian:"lv",NorwegianBokml:"nb",Dutch:"nl",Polish:"pl",PortugueseBrazil:"pt-BR",PortuguesePortugal:"pt-PT",Romanian:"ro",Russian:"ru",Serbian:"sr",Slovenian:"sl",Slovak:"sk",Swedish:"sv",Thai:"th",Turkish:"tr",Ukrainian:"uk",Vietnamese:"vi",ChineseChina:"zh-CN",ChineseHongKong:"zh-HK",ChineseTaiwan:"zh-TW"},bo=[...Object.values(po),"ar-u-nu-latn","en-AU","en-GB","es-ES","es-MX","de-AT","de-CH","de-DE","it-CH","it-IT"],yo=[po.Arabic,po.Hebrew];function vo(e,t){return co(e)(t)}function ho(e){let t=po.English;if(void 0!==e){const r=Object.values(po),n=r.filter((e=>-1!==e.indexOf("-")));if(-1!==e.indexOf("-")){const[t,r]=e.split("-");e=`${t}-${r.toUpperCase()}`}if(!0===n.includes(e))t=e;else{const n=function(e){const t=e?.match(/^([a-z]{2})-([A-Z]{1,2})$/);let r=po.English;return null!=t&&t?.length>1?r=t[1]:2===e?.length&&e.toLowerCase()===e&&(r=e),r}(e);!0===r.includes(n)&&(t=n)}}return t}function go(e=document.documentElement){const t=(r="[lang]",function e(t){let n;return n=void 0===t||t===document||t===window?null:t.closest(r)||e(t.getRootNode().host),n}(e));var r;const n=t?.lang??window.navigator.language,o=ho(n),a=function(e){let t=bo.find((t=>t===e));if(void 0===t&&(t=e),void 0!==t&&-1!==t.indexOf("-")){const[e,r]=t.split("-");t=`${e}-${r.toUpperCase()}`}return"ar"===t&&(t="ar-u-nu-latn"),t}(n);return{locale:o,rtl:yo.includes(o),formatLocale:a}}class mo extends Error{constructor(e,t,r,n){super(t),this.name=e,this.details=r,this.cause=n}}const wo="creditThresholdExceededError",jo="InsufficientCreditsError",_o="networkError",Oo="serviceNameExistsError",So="specialCharactersInServiceNameError",Po="webToolFailedFetch";var Eo=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")},Ao=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return Eo()}try{return __global__||Eo()}finally{delete Object.prototype.__global__}}(),To="object"!=typeof globalThis||!globalThis||globalThis.Array!==Array?Ao:globalThis,ko=To,Io={object:!0,symbol:!0},$o={exports:{}},Co=function(e){return null!=e},xo=Co,zo={object:!0,function:!0,undefined:!0},No=function(e){return!!xo(e)&&hasOwnProperty.call(zo,typeof e)},Uo=function(e){if(!No(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}},Lo=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!Uo(e)},Fo=/^\s*class[\s{/}]/,Ro=Function.prototype.toString,Do=function(e){return null!=e},Mo=Do,Jo=Object.keys,Bo=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}()?Object.keys:function(e){return Jo(Mo(e)?Object(e):e)},Vo=Do,Go=Bo,Ho=function(e){if(!Vo(e))throw new TypeError("Cannot use null or undefined");return e},Wo=Math.max,qo=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}()?Object.assign:function(e,t){var r,n,o,a=Wo(arguments.length,2);for(e=Object(Ho(e)),o=function(n){try{e[n]=t[n]}catch(e){r||(r=e)}},n=1;n<a;++n)Go(t=arguments[n]).forEach(o);if(void 0!==r)throw r;return e},Ko=Do,Yo=Array.prototype.forEach,Zo=Object.create,Qo=function(e,t){var r;for(r in e)t[r]=e[r]},Xo="razdwatrzy",ea=String.prototype.indexOf,ta="function"==typeof Xo.contains&&!0===Xo.contains("dwa")&&!1===Xo.contains("foo")?String.prototype.contains:function(e){return ea.call(this,e,arguments[1])>-1},ra=Co,na=function(e){return!!Lo(e)&&!Fo.test(Ro.call(e))},oa=qo,aa=function(e){var t=Zo(null);return Yo.call(arguments,(function(e){Ko(e)&&Qo(Object(e),t)})),t},ia=ta,sa=$o.exports=function(e,t){var r,n,o,a,i;return arguments.length<2||"string"!=typeof e?(a=t,t=e,e=null):a=arguments[2],ra(e)?(r=ia.call(e,"c"),n=ia.call(e,"e"),o=ia.call(e,"w")):(r=o=!0,n=!1),i={value:t,configurable:r,enumerable:n,writable:o},a?oa(aa(a),i):i};sa.gs=function(e,t,r){var n,o,a,i;return"string"!=typeof e?(a=r,r=t,t=e,e=null):a=arguments[3],ra(t)?na(t)?ra(r)?na(r)||(a=r,r=void 0):r=void 0:(a=t,t=r=void 0):t=void 0,ra(e)?(n=ia.call(e,"c"),o=ia.call(e,"e")):(n=!0,o=!1),i={get:t,set:r,configurable:n,enumerable:o},a?oa(aa(a),i):i};var ca,ua,la,fa=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&("Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag]))},pa=function(e){if(!fa(e))throw new TypeError(e+" is not a symbol");return e},da=$o.exports,ba=Object.create,ya=Object.defineProperty,va=Object.prototype,ha=ba(null),ga=$o.exports,ma=To.Symbol,wa=$o.exports,ja=pa,_a=Object.create(null),Oa=$o.exports,Sa=pa,Pa=To.Symbol,Ea=function(e){for(var t,r,n=0;ha[e+(n||"")];)++n;return ha[e+=n||""]=!0,ya(va,t="@@"+e,da.gs(null,(function(e){r||(r=!0,ya(this,t,da(e)),r=!1)}))),t},Aa=function(e){return Object.defineProperties(e,{hasInstance:ga("",ma&&ma.hasInstance||e("hasInstance")),isConcatSpreadable:ga("",ma&&ma.isConcatSpreadable||e("isConcatSpreadable")),iterator:ga("",ma&&ma.iterator||e("iterator")),match:ga("",ma&&ma.match||e("match")),replace:ga("",ma&&ma.replace||e("replace")),search:ga("",ma&&ma.search||e("search")),species:ga("",ma&&ma.species||e("species")),split:ga("",ma&&ma.split||e("split")),toPrimitive:ga("",ma&&ma.toPrimitive||e("toPrimitive")),toStringTag:ga("",ma&&ma.toStringTag||e("toStringTag")),unscopables:ga("",ma&&ma.unscopables||e("unscopables"))})},Ta=function(e){return Object.defineProperties(e,{for:wa((function(t){return _a[t]?_a[t]:_a[t]=e(String(t))})),keyFor:wa((function(e){var t;for(t in ja(e),_a)if(_a[t]===e)return t}))})},ka=Object.create,Ia=Object.defineProperties,$a=Object.defineProperty;if("function"==typeof Pa)try{String(Pa()),la=!0}catch(e){}else Pa=null;ua=function(e){if(this instanceof ua)throw new TypeError("Symbol is not a constructor");return ca(e)};var Ca=ca=function e(t){var r;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return la?Pa(t):(r=ka(ua.prototype),t=void 0===t?"":String(t),Ia(r,{__description__:Oa("",t),__name__:Oa("",Ea(t))}))};Aa(ca),Ta(ca),Ia(ua.prototype,{constructor:Oa(ca),toString:Oa("",(function(){return this.__name__}))}),Ia(ca.prototype,{toString:Oa((function(){return"Symbol ("+Sa(this).__description__+")"})),valueOf:Oa((function(){return Sa(this)}))}),$a(ca.prototype,ca.toPrimitive,Oa("",(function(){var e=Sa(this);return"symbol"==typeof e?e:e.toString()}))),$a(ca.prototype,ca.toStringTag,Oa("c","Symbol")),$a(ua.prototype,ca.toStringTag,Oa("c",ca.prototype[ca.toStringTag])),$a(ua.prototype,ca.toPrimitive,Oa("c",ca.prototype[ca.toPrimitive]));var xa=function(){var e,t=ko.Symbol;if("function"!=typeof t)return!1;e=t("test symbol");try{String(e)}catch(e){return!1}return!!Io[typeof t.iterator]&&(!!Io[typeof t.toPrimitive]&&!!Io[typeof t.toStringTag])}()?To.Symbol:Ca;xa("-");const za="standard",Na="raster",Ua="Image Service",La="Feature Service",Fa="job-cancelling",Ra="job-executing",Da="job-new",Ma="job-submitted",Ja="job-waiting",Ba=["job-cancelled","job-deleted","job-succeeded","job-timed-out","job-failed"];var Va={exports:{}};function Ga(e,t,r,n){var o=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(n)?n:r(n),a=t.get(o);return void 0===a&&(a=e.call(this,n),t.set(o,a)),a}function Ha(e,t,r){var n=Array.prototype.slice.call(arguments,3),o=r(n),a=t.get(o);return void 0===a&&(a=e.apply(this,n),t.set(o,a)),a}function Wa(e,t,r,n,o){return r.bind(t,e,n,o)}function qa(e,t){return Wa(e,this,1===e.length?Ga:Ha,t.cache.create(),t.serializer)}function Ka(){return JSON.stringify(arguments)}function Ya(){this.cache=Object.create(null)}Ya.prototype.has=function(e){return e in this.cache},Ya.prototype.get=function(e){return this.cache[e]},Ya.prototype.set=function(e,t){this.cache[e]=t};var Za={create:function(){return new Ya}};Va.exports=function(e,t){var r=t&&t.cache?t.cache:Za,n=t&&t.serializer?t.serializer:Ka;return(t&&t.strategy?t.strategy:qa)(e,{cache:r,serializer:n})},Va.exports.strategies={variadic:function(e,t){return Wa(e,this,Ha,t.cache.create(),t.serializer)},monadic:function(e,t){return Wa(e,this,Ga,t.cache.create(),t.serializer)}};var Qa=Va.exports;const Xa=["SingleLine","Address","Address2","Address3","Neighborhood","City","Subregion","Region","Postal","PostalExt","CountryCode"];Qa((async e=>{const{geocodeServiceURL:t,locale:r}=e;let n;if(lo(t))n={ruleType:"expression",expression:"$[Data].geocodeServiceURL = NULL",destination:"sourceCountry",effectParams:{visible:!1}};else{let e,o;try{({data:{countries:e,detailedCountries:o}}=await fo(`${t}?f=json`,{responseType:"json"}))}catch(e){throw console.error("Failed to get Locator info"),e}const a={};o.forEach((e=>{const t=e.localizedNames,n=r.length>2&&r;let o;if("boolean"!=typeof n&&(o=t[n]),void 0===o){const e=2===r.length?r.slice(0,2):r;if(o=t[e],void 0===o){const r=Object.keys(t).find((t=>t.startsWith(e)));void 0!==r&&(o=t[r])}}null!=o&&""!==o||(o=t[po.English]??t[po.EnglishUSA]),a[e.name]=o})),n={ruleType:"expression",expression:"$[Data].geocodeServiceURL NOT null",destination:"sourceCountry",effectParams:{visible:!0,choiceList:e,choiceListLabels:a}}}return n}),{serializer:e=>{const{geocodeServiceURL:t}=e;return t??"EMPTY_KEY"}}),Qa((async e=>{const{geocodeServiceURL:t,inputFileItem:r,inputTable:n}=e;let o,a;if(!(lo(t)||lo(r)&&lo(n))){let t,r;a=await oi(e);try{t=JSON.parse(a.field_info),r=JSON.parse(a.field_mapping)}catch(e){throw console.error("Failed to parse result of AnalyzeGeocodeInput"),e}const n=t.map((e=>e[0])),i=n.reduce(((e,t)=>({...e,[t]:t})),{});o={ruleType:"expression",expression:"($[Data].geocodeServiceURL NOT null) AND (($[Data].inputTable NOT null) OR ($[Data].inputFileItem NOT null))",destination:"geocodeUIParameters",effectParams:Xa.reduce(((e,t,o)=>{const a=r.find((e=>e[1]===t))?.[0];return{...e,[`UIparameterInfos[${o}].choiceList`]:n,[`UIparameterInfos[${o}].choiceListLabels`]:i,[`UIparameterInfos[${o}].defaultValue`]:a}}),{})}}return{addressFieldsRule:o,geocodeParameters:a}}),{serializer:e=>{const{geocodeServiceURL:t,inputFileItem:r,inputTable:n}=e,o=r?.itemid,a=n?.url;return lo(t)||lo(o)&&lo(a)?"EMPTY_KEY":`${t}${o}${a}`}});async function ei(t,r){const n=await async function(t=go().locale){let r=await new Promise((function(t,r){e(["./errors.t9n.en-6cb15d51-af422bd0"],t,r)}));switch(t){case po.Arabic:r=await new Promise((function(t,r){e(["./errors.t9n.ar-1b9d7225-e5ab3e60"],t,r)}));break;case po.Bosnian:r=await new Promise((function(t,r){e(["./errors.t9n.bs-377a5410-21724478"],t,r)}));break;case po.Bulgarian:r=await new Promise((function(t,r){e(["./errors.t9n.bg-89d094b5-313f0e15"],t,r)}));break;case po.Catalan:r=await new Promise((function(t,r){e(["./errors.t9n.ca-b4c83c33-10aafcba"],t,r)}));break;case po.Czech:r=await new Promise((function(t,r){e(["./errors.t9n.cs-96fcf27d-1c5dabcf"],t,r)}));break;case po.Danish:r=await new Promise((function(t,r){e(["./errors.t9n.da-cefe0c47-f5ec85f4"],t,r)}));break;case po.German:r=await new Promise((function(t,r){e(["./errors.t9n.de-a1b0ae17-8f46b75b"],t,r)}));break;case po.Greek:r=await new Promise((function(t,r){e(["./errors.t9n.el-0a20e1cc-26072a22"],t,r)}));break;case po.EnglishUSA:r=await new Promise((function(t,r){e(["./errors.t9n.en-US-c9f50f19-892f088a"],t,r)}));break;case po.Spanish:r=await new Promise((function(t,r){e(["./errors.t9n.es-0dd138a7-c2f1f217"],t,r)}));break;case po.Estonian:r=await new Promise((function(t,r){e(["./errors.t9n.et-57cc3980-ce933e20"],t,r)}));break;case po.Finnish:r=await new Promise((function(t,r){e(["./errors.t9n.fi-7d2525cb-cb5130a0"],t,r)}));break;case po.French:r=await new Promise((function(t,r){e(["./errors.t9n.fr-b2186e48-9ee1405e"],t,r)}));break;case po.Hebrew:r=await new Promise((function(t,r){e(["./errors.t9n.he-f487411b-b0b9c841"],t,r)}));break;case po.Croatian:r=await new Promise((function(t,r){e(["./errors.t9n.hr-61ca76d9-41fe3101"],t,r)}));break;case po.Hungarian:r=await new Promise((function(t,r){e(["./errors.t9n.hu-7fa01d3c-19cdc1ae"],t,r)}));break;case po.Indonesian:r=await new Promise((function(t,r){e(["./errors.t9n.id-6801fef5-0a3210cc"],t,r)}));break;case po.Italian:r=await new Promise((function(t,r){e(["./errors.t9n.it-568c2b04-b6bdfead"],t,r)}));break;case po.Japanese:r=await new Promise((function(t,r){e(["./errors.t9n.ja-6042d3af-348db024"],t,r)}));break;case po.Korean:r=await new Promise((function(t,r){e(["./errors.t9n.ko-4d01f228-c47fac88"],t,r)}));break;case po.Lithuanian:r=await new Promise((function(t,r){e(["./errors.t9n.lt-7f94cd9d-124e3795"],t,r)}));break;case po.Latvian:r=await new Promise((function(t,r){e(["./errors.t9n.lv-0223c6ae-a0cedc5c"],t,r)}));break;case po.NorwegianBokml:r=await new Promise((function(t,r){e(["./errors.t9n.nb-1f800b8b-435a46f2"],t,r)}));break;case po.Dutch:r=await new Promise((function(t,r){e(["./errors.t9n.nl-dd20c6e1-26d44f0d"],t,r)}));break;case po.Polish:r=await new Promise((function(t,r){e(["./errors.t9n.pl-e71d8c8e-f97b1fd7"],t,r)}));break;case po.PortugueseBrazil:r=await new Promise((function(t,r){e(["./errors.t9n.pt-BR-6cdb50a3-6a968f4f"],t,r)}));break;case po.PortuguesePortugal:r=await new Promise((function(t,r){e(["./errors.t9n.pt-PT-6b3866f5-9782cc9c"],t,r)}));break;case po.Romanian:r=await new Promise((function(t,r){e(["./errors.t9n.ro-86e7cba9-3424d72d"],t,r)}));break;case po.Russian:r=await new Promise((function(t,r){e(["./errors.t9n.ru-23cdd703-a95e7cee"],t,r)}));break;case po.Serbian:r=await new Promise((function(t,r){e(["./errors.t9n.sr-fad84a78-fe5653d9"],t,r)}));break;case po.Slovak:r=await new Promise((function(t,r){e(["./errors.t9n.sk-3b14f765-fb44e224"],t,r)}));break;case po.Slovenian:r=await new Promise((function(t,r){e(["./errors.t9n.sl-e900baaf-1ec50095"],t,r)}));break;case po.Swedish:r=await new Promise((function(t,r){e(["./errors.t9n.sv-4613eae2-09baa094"],t,r)}));break;case po.Thai:r=await new Promise((function(t,r){e(["./errors.t9n.th-5732c8a4-b7bc1056"],t,r)}));break;case po.Turkish:r=await new Promise((function(t,r){e(["./errors.t9n.tr-ccd64dcc-19fe7d0d"],t,r)}));break;case po.Ukrainian:r=await new Promise((function(t,r){e(["./errors.t9n.uk-e6c5f2f4-4ae5232d"],t,r)}));break;case po.Vietnamese:r=await new Promise((function(t,r){e(["./errors.t9n.vi-3f1e30b4-589e264b"],t,r)}));break;case po.ChineseChina:r=await new Promise((function(t,r){e(["./errors.t9n.zh-CN-8e563d8f-64030da5"],t,r)}));break;case po.ChineseHongKong:r=await new Promise((function(t,r){e(["./errors.t9n.zh-HK-23eb2505-89e86991"],t,r)}));break;case po.ChineseTaiwan:r=await new Promise((function(t,r){e(["./errors.t9n.zh-TW-4017c011-d4027d56"],t,r)}))}return r}(),o=n[t];throw new mo(t,o??n.defaultError,{type:"analysis_ui"},r)}function ti(e){e??(e=za);let t="";if(e===Na)t="_ra";else t="";return t}function ri(e){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[e]||e}function ni(e,t={}){let r="";return e.forEach((e=>{const n=JSON.parse(e),{message:o,messageCode:a,params:i,style:s}=n;if(Array.isArray(o)){const e={};let n=s;o.forEach(((r,o)=>{const s=`${a}_${o}`;n=n.replace("></",">${"+s+"}</");let c=void 0!==t[s]?t[s]:r;c=vo(c,i),c=function(e){return e.replace(/[<>]/g,ri)}(c),e[s]=`${c}`})),r+=vo(n,e)}else{let e=void 0!==t[a]?t[a]:o;e=vo(e,i);const n=s.indexOf("</");r+=`${s.substring(0,n)}${e}${s.substring(n)}`}})),r}Mt((e=>{const t={};let r;if(void 0!==e.featureSet){if(t.source=N.default.fromJSON(e.featureSet).features,r=e.layerDefinition,void 0!==r.fields&&(t.fields=r.fields.map((e=>x.default.fromJSON(e)))),void 0!==r.objectIdField&&(t.objectIdField=r.objectIdField),void 0!==r.geometryType){let e="point";switch(r.geometryType){case"esriGeometryMultipoint":e="multipoint";break;case"esriGeometryPoint":e="point";break;case"esriGeometryPolygon":e="polygon";break;case"esriGeometryPolyline":e="polyline"}t.geometryType=e}void 0!==r.spatialReference&&(t.spatialReference=r.spatialReference),void 0!==r.drawingInfo?.renderer&&(t.renderer=z.default.fromJSON(r.drawingInfo.renderer))}return new $.default(t)})),Mt((async(e,t)=>{let r=!1;if(!0===window.location.href.includes("://localhost:")||void 0===t)r=!0;else{const n=`${e}${e.indexOf("?")>-1?"&":"?"}f=json`;U.default.request.proxyUrl=`${t}/sharing/proxy`;try{r=!1===lo((await fo(n,{useProxy:!0})).data)}catch(e){r=!1}}return!0===r?e:void 0})),Mt((async e=>{const{locale:t,name:r,assetPrefix:n,analysisEngine:o,memoizedHelper:a}=e,i=`${r.toLowerCase()}${ti(o)}`;let s,c,u,l;const f=`${n}/tool-ui-json/${i}.tool.ui.json`,p=`${n}/tool-json/${i}.tool.json`,d=`${n}/t9n/${i}/${i}.t9n.${t}.json`,b=`${n}/t9n/common.t9n.${t}.json`;let y=t;t===po.English||t===po.EnglishUSA?y="":y===po.NorwegianBokml&&(y="no");const v=`${n}/help/${""!==y?y+"/":""}${r}${ti(o)}.html`;try{l=await a(p),s=await a(f),c=await a(d),u=await a(b),c={...u,...c}}catch{s=void 0}return{toolJson:l,toolUIJson:s,toolT9n:c,toolHelpFilePath:v}})),Qa((async e=>{const{url:t}=e,r=`${t}/sharing/rest/community/self`,n=I.default.findCredential(r);let o;void 0!==n&&(o=n.token);const a={query:{returnUserLicensedItems:!0,token:o,f:"json"}};try{const{data:{userLicensedItems:e}}=await fo(r,a);return[...e.map((({entitlements:e})=>e))].flat()}catch(e){await ei(_o)}return[]}),{serializer:e=>`${e.user.username}`}),Qa((async e=>{let t={isMultidimensional:!1};const r="imagery-tile"===e.type?e.rasterInfo.multidimensionalInfo:e.multidimensionalInfo,n=e.multidimensionalSubset;if(null!=r){const o=null!=n?e.getMultidimensionalSubsetVariables():r.variables;if(void 0!==o&&o.length>0){const e=[],r=[],n={},a={},i={},s={},c={},u={},l={};o.forEach(((t,o)=>{let i="";const f=t.name;t.dimensions.forEach(((t,r)=>{const p=t.name;-1===e.indexOf(p)&&e.push(p);const d=r>0?`,${p}=${t.values?.length}`:`${p}=${t.values?.length}`;if(i=i.concat(d),0===r&&(a[f]={}),void 0===n[p]&&(n[p]=[]),a[f][p]=t.values,0===o){const e=t.values;if(void 0!==e)if("StdTime"!==p||void 0!==t.unit&&"ISO8601"!==t.unit)Array.isArray(e)&&"number"==typeof e[0]?s[p]=c[p]=e.map(String):Array.isArray(e[0])&&Array.isArray(e[1])&&(s[p]=e[0].map(String),c[p]=e[1].map(String));else{const t=[],r=[],n={},o={};e.forEach((e=>{if("number"==typeof e){const a=new Date(e),i=a.toLocaleString(),s=a.toISOString();t.push(s),r.push(s),n[s]=i,o[s]=i}else if(Array.isArray(e)){const a=new Date(e[0]),i=new Date(e[1]),s=a.toISOString(),c=i.toISOString();t.push(s),r.push(c),n[s]=a.toLocaleString(),o[c]=i.toLocaleString()}})),s[p]=t,c[p]=r,u[p]=n,l[p]=o}}n[p].push(f)})),r.push({name:f,alias:`${f}[${i}](${t.description})`,type:"string"})}));for(const e in n){const t=r.filter((t=>n[e].indexOf(t.name)>-1));i[e]={id:"1",name:e,description:"DimensionVariables",getFields:()=>Promise.resolve(t)}}t={isMultidimensional:!0,dimensions:e,dimensionVariableDatasets:i,dimensionValues:a,variablesDataset:{id:"1",name:"Variables",description:"Variables",getFields:()=>Promise.resolve(r)},dimensionMinValues:s,dimensionMaxValues:c,dimensionMinValuesWithLabels:u,dimensionMaxValuesWithLabels:l}}}const o="imagery"===e.type?await e.generateRasterInfo(e.renderingRule):e.rasterInfo;return t.rasterInfo=o,t}));const oi=async e=>{const{asyncGeocodeUrl:t}=e,r=await T.submitJob(`${t}/AnalyzeGeocodeInput`,{...Vn(e,"asyncGeocodeUrl"),f:"json"});try{await r.waitForJobCompletion();return(await r.fetchResultData("geocodeParameters")).value}catch(e){throw console.error("AnalyzeGeocodeInput failed"),e}};Qa(((e,t)=>new C.default({id:e,portal:t})),{serializer:e=>`${e[0]}-${e[1]?.url}`}),Qa((async e=>{const{restUrl:t}=e,r=`${t}/portals/helpmap`;let n;try{const e=await k.default(r,{query:{f:"json"},responseType:"json",method:"auto"});n=await(e.data?.helpMap)??void 0}catch(e){n=void 0}return n}),{serializer:e=>`${e[0]}-${e[1]?.url}`});const ai="esriExecutionTypeAsynchronous",ii="esriExecutionTypeSynchronous",si="standard",ci="geoanalytics",ui="raster";var li={exports:{}};function fi(e,t,r,n){var o=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(n)?n:r(n),a=t.get(o);return void 0===a&&(a=e.call(this,n),t.set(o,a)),a}function pi(e,t,r){var n=Array.prototype.slice.call(arguments,3),o=r(n),a=t.get(o);return void 0===a&&(a=e.apply(this,n),t.set(o,a)),a}function di(e,t,r,n,o){return r.bind(t,e,n,o)}function bi(e,t){return di(e,this,1===e.length?fi:pi,t.cache.create(),t.serializer)}function yi(){return JSON.stringify(arguments)}function vi(){this.cache=Object.create(null)}vi.prototype.has=function(e){return e in this.cache},vi.prototype.get=function(e){return this.cache[e]},vi.prototype.set=function(e,t){this.cache[e]=t};var hi={create:function(){return new vi}};li.exports=function(e,t){var r=t&&t.cache?t.cache:hi,n=t&&t.serializer?t.serializer:yi;return(t&&t.strategy?t.strategy:bi)(e,{cache:r,serializer:n})},li.exports.strategies={variadic:function(e,t){return di(e,this,pi,t.cache.create(),t.serializer)},monadic:function(e,t){return di(e,this,fi,t.cache.create(),t.serializer)}};var gi=li.exports;function mi(e,t,r=!1){let n=t.helperServices.analysis.url;switch(e){case ci:n=t.helperServices.geoanalytics.url;break;case ui:n=t.helperServices.rasterAnalytics.url;break;case si:n=r?t.helperServices.asyncGeocode.url:t.helperServices.analysis.url}return n}const wi=e=>{const t=Array.from(e).map((e=>{let t;return t="object"==typeof e&&void 0!==e.id?e.id:e,t}));return JSON.stringify(t)},ji=gi((async(e,t,r)=>{const n=`${mi(t,r,"BatchGeocode"===e)}/${e}?f=json`,o=await k.default(n,{responseType:"json",authMode:"no-prompt"}),a=await o.data;return a.parameters?.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),a}),{serializer:wi}),_i=gi((async(e,t)=>{const r=mi(e,t),n=await k.default(`${r}?f=json`,{responseType:"json"}),{data:{tasks:o}}=n,a=o.map((r=>ji(r,e,t)));return await Promise.all(a)}),{serializer:wi}),Oi=gi((async(e,t)=>{let r=[];return r=void 0!==t?await _i(t,e):[...await _i(si,e),...await _i(ui,e),...await _i(ci,e)],new Map(r.map((e=>[e.name.toLowerCase(),e])))}),{serializer:wi}),Si=gi((async e=>{const{helperServices:t}=e;let r;if(void 0!==t.routingUtilities){const e=await T.execute(`${t.routingUtilities.url}/GetTravelModes?f=json`),{results:[{value:{features:n}},{value:o}]}=e;r={travelModes:n.map((e=>JSON.parse(e.attributes.TravelMode))),defaultTravelModeId:o}}return r}),{serializer:wi}),Pi=gi((async e=>(await k.default(`${e}?f=json`,{responseType:"json"})).data)),Ei=gi((async(e,t)=>{const r=`${e}/${t}?f=json`,n=await k.default(r,{responseType:"json",authMode:"no-prompt"}),o=await(n?.data);return void 0!==o?.parameters&&o.parameters?.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),o})),Ai=gi((async e=>{const t=await k.default(`${e}?f=json`,{responseType:"json"}),{data:{tasks:r}}=t,n=r.map((t=>Ei(e,t)));return await Promise.all(n)})),Ti=gi((async(e,t)=>{let r,n;try{r=await Ei(e,t),n=await Pi(e)}catch(e){throw new mo(Po,"WebTool JSON failed to fetch.")}return r.serviceInfo=n,{...r,serviceInfo:n}})),ki="analysisCoreResultDataComplete",Ii="analysisCoreJobStatus",$i="creditEstimateComplete";function Ci(e){return{detail:e,composed:!0,cancelable:!0,bubbles:!0}}function xi(e,t){e.dispatchEvent(new window.CustomEvent(ki,Ci(t)))}function zi(e,t){e.dispatchEvent(new window.CustomEvent(Ii,Ci(t)))}const Ni=[{toolName:"CreateViewshed",analysisEngine:si},{toolName:"CreateWatersheds",analysisEngine:si},{toolName:"TraceDownstream",analysisEngine:si}],Ui=[{toolName:"SummarizeNearby",analysisEngine:si},{toolName:"CreateViewshed",analysisEngine:si},{toolName:"CreateWatersheds",analysisEngine:si},{toolName:"TraceDownstream",analysisEngine:si},{toolName:"EnrichLayer",analysisEngine:si},{toolName:"CreateDriveTimeAreas",analysisEngine:si},{toolName:"PlanRoutes",analysisEngine:si},{toolName:"FindNearest",analysisEngine:si},{toolName:"ConnectOriginsToDestinations",analysisEngine:si},{toolName:"ChooseBestFacilities",analysisEngine:si}];async function Li(e){const{portal:t,jobParams:r,analysisEngine:o,toolName:a,toolElement:i}=e,s=mi(o??si,t,"BatchGeocode"===a);let c=[];if(void 0!==Ni.find((e=>e.toolName===a&&e.analysisEngine===o)))c=[{dateType:"string",value:{cost:0,totalRecords:0}}];else{let e="";switch(o){case ui:e=s+"/EstimateRasterAnalysisCost";break;case si:e=s.replace("tasks/GPServer","Estimate/GPServer/EstimateCredits")}const t={};for(const e in r)"object"==typeof r[e]&&void 0!==r[e]?t[e]=JSON.stringify(r[e]):t[e]=r[e];const u=o===ui?{inputAnalysisTask:{name:a,parameters:t}}:{taskName:a,taskParameters:t},l=(await k.default(`${e}?f=json`,{responseType:"json"})).data,f=l?.parameters?.filter((e=>"esriGPParameterDirectionOutput"===e.direction));let p;switch(l.executionType){case ii:p=await n.execute(e,u),c=p.results;break;case ai:{const t=await T.submitJob(e,u),r={interval:1500,statusCallback:e=>{zi(i,{jobInfo:e})}};await t.waitForJobCompletion(r);const n=f?.map((e=>t.fetchResultData(e.name)));c=await Promise.all(n);break}}}var u;return void 0!==i&&(u=c,i.dispatchEvent(new window.CustomEvent($i,Ci(u)))),c}function Fi(e){const t=function(e){const t="object"==typeof e&&null!==e,r=t&&"totalRecords"in e&&("maximumCost"in e||"cost"in e),n=t&&"credits"in e&&"functions"in e&&Array.isArray(e.functions)&&e.functions.every((e=>"object"==typeof e&&null!==e&&"name"in e&&"costFactor"in e&&"gigaPixels"in e));return t&&(r||n)}(e?.[0]?.value)?e[0].value:void 0,r=t?.maximumCost??t?.cost??t?.credits;return Number.isNaN(r)?void 0:r}function Ri(e,t){return void 0===t||void 0===e||e<=t}function Di(e,t){let r=!0;return void 0!==t.sourceJSON.availableCredits&&void 0!==e&&(r=t.sourceJSON.availableCredits>e),r}const Mi=/^[\p{L}\p{N}_][\p{L}\p{N}_\s]*[\p{L}\p{N}_]$/u;function Ji(e,t){const r=[];return e.forEach((e=>{if(e in t){const n=JSON.parse(t[e]),o=n?.serviceProperties?.name??n?.itemProperties?.title??void 0;void 0!==o&&r.push(o)}})),"esri_out_feature_service_name"in t&&"string"==typeof t.esri_out_feature_service_name&&r.push(t.esri_out_feature_service_name),r}async function Bi(e){const{portal:{url:t,id:r},itemType:n}=e,{serviceName:o}=e,a=`${t}/sharing/rest/portals/${r}/isServiceNameAvailable?f=json`,i={query:{f:"json",name:o,type:n}};let s=!0;try{s=(await k.default(a,i)).data.available}catch(e){await ei(_o)}return s}function Vi(e){return e.every((e=>Mi.test(e)))}async function Gi(e,t){const r=[];e.forEach((e=>{if("object"==typeof e.value&&"itemId"in e.value&&!lo(e.value.itemId)&&void 0!==t){const n=e.value.itemId;r.push(async function(e,t){const r=new C.default({id:e}),n=await r.load();let o=Object.assign(n,t);return o=await o.update(),o}(n,{description:t}))}})),await Promise.all(r)}t.UnancelableTools=Ui,t.ZeroCreditTools=Ni,t.cancelJob=async function(e,t){let r=e.jobStatus,n=e.messages;const o=e.jobId;try{if(!0===function(e){return e===Ra||e===Ma||e===Da||e===Ja}((e=await e.cancelJob(o)).jobStatus)||e.jobStatus===Fa)for(;!1===Ba.includes(e.jobStatus);)await new Promise((e=>setTimeout(e,500))),zi(t,{jobInfo:e=await e.checkJobStatus()});r=e.jobStatus,n=e.messages,zi(t,{jobInfo:e})}catch(e){void 0!==e.jobStatus&&void 0!==e.jobId&&void 0!==e.messages&&e.jobId===o&&(r=e.jobStatus,n=e.messages)}return{jobStatus:r,messages:n}},t.checkServiceName=Bi,t.creditThresholdCheck=Ri,t.execute=async function(e){const{portal:t}=e,{jobParamsPayload:r,jobParams:n,toolUiParameters:o,toolName:a,analysisEngine:i,analysisType:s,resultParams:c,containerElement:u,gpMessages:l,webToolServerUrl:f,executionType:p,creditCheckOptions:d}=e;let b=function(e){let t=!0;return t=!0!==lo(e?.orgId)&&(function(e){return e.role?.includes("admin")??!1}(e)||function(e){return e.role?.includes("publisher")??!1}(e)),t}(t.user);const y=Object.keys(r).some((e=>{const t=r[e];return"string"==typeof t&&t.includes("serviceProperties")})),v=Ji(Object.keys(r).filter((e=>{const t=r[e];return"string"==typeof t&&(t.includes("serviceProperties")||t.includes("itemProperties"))})),r);if(!1===Vi(v)&&await ei(So),y){const e=v.map((e=>{const r=t.isPortal?function(e){return e.replace(/\s/g,"_")}(e):e;return Bi({portal:t,serviceName:r,itemType:i!==ui||void 0!==o.resultType&&"FEATURE_LAYER"===o.resultType?La:Ua})}));b=!(await Promise.all(e)).some((e=>!1===e)),!1===b&&await ei(Oo)}const{skipCreditChecks:h=!1,creditThreshold:g}=d??{};if(!1===h&&void 0===f&&(e.analysisEngine===si||e.analysisEngine===ui)){const r=Fi(await Li({toolName:e.toolName,portal:t,jobParams:e.jobParamsPayload,analysisEngine:e.analysisEngine,toolElement:e.containerElement}));b=Di(r,t.user),!1===b&&await ei(jo),b=Ri(r,g),!1===b&&await ei(wo,{estimatedCredits:r,creditThreshold:g})}if(!0===b){const e=`${void 0===f?mi(i,t,"BatchGeocode"===a):f}/${a}?f=json`;if(p===ii){const t=await T.execute(e,n),r=t.results,c=A.default.fromJSON({messages:t.messages});zi(u,{jobInfo:c,submissionData:{toolName:a,analysisEngine:i,analysisType:s,jobParams:n,toolUiParameters:o}}),xi(u,{results:r,jobInfo:c})}else{const t=await T.submitJob(e,r);zi(u,{jobInfo:t,submissionData:{toolName:a,analysisEngine:i,analysisType:s,jobParams:n,toolUiParameters:o,webToolServerUrl:f}});const p={interval:1500,statusCallback:e=>{zi(u,{jobInfo:e})}};try{let e;if(await t.waitForJobCompletion(p),!0===c.includes("processInfo"))try{e=ni((await t.fetchResultData("processInfo")).value,l);const r=c.indexOf("processInfo");c.splice(r,1)}catch{}const r=c.map((e=>t.fetchResultData(e))),n=(await Promise.allSettled(r)).filter((e=>"fulfilled"===e.status)).map((e=>e.value));Gi(n,e),xi(u,{results:n,jobInfo:t})}catch(e){zi(u,{jobInfo:t})}}}},t.getAllToolInfoJsons=Oi,t.getAnalysisServer=mi,t.getCreditsEstimate=Li,t.getOutputServiceNames=Ji,t.getServiceInfoByUrl=Pi,t.getToolInfoJson=ji,t.getToolInfoJsonByUrl=Ei,t.getToolInfoJsonsByEngine=_i,t.getToolInfoJsonsByUrl=Ai,t.getTravelModes=Si,t.getWebToolInfo=Ti,t.hasEnoughCredits=Di,t.outputNameValidation=Vi,t.parseCreditEstimate=Fi,t.validOutputNameCharactersPattern=Mi,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
