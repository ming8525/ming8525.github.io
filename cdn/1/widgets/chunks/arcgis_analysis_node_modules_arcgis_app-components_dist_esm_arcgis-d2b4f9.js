/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d2b4f9.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d2b4f9"],{52787:(e,t,r)=>{r.d(t,{a:()=>i,i:()=>o});const i={FeatureServer:"Feature Service",GeocodeServer:"Geocoding Service",GeoDataServer:"Geodata Service",GeometryServer:"Geometry Service",GeoenrichmentServer:"Geoenrichment Service",GPServer:"Geoprocessing Service",GlobeServer:"Globe Service",ImageServer:"Image Service",MapServer:"Map Service",NAServer:"Network Analysis Service",ElevationServer:"Image Service",VectorTileServer:"Vector Tile Service",SceneServer:"Scene Service",StreamServer:"Stream Service",WMServer:"Workflow Manager Service",TiledImageServer:"Image Service",VideoServer:"Video Service"},o=e=>!!Object.values(i).includes(e)},31932:(e,t,r)=>{r.r(t),r.d(t,{arcgis_layers_and_tables_summary_popup:()=>u});var i=r(81149),o=r(82218),n=r(70464),s=r(49853),a=r(47848),l=r(36238),c=r(97758);r(42577),r(51837),r(69283),r(20164),r(79210),r(25145),r(52787);const d=(0,n.c)({}).state,u=class{constructor(e){(0,i.r)(this,e),this.handleClick=async()=>{var e;const{layers:t,item:r}=this;null===(e=this.button)||void 0===e||e.focus(),t||(this.loading=!0),d[r.id]||(d[r.id]=this.fetchServiceInfo());const i=await d[r.id];i.error&&(this.error=this.i18n.error,"serviceNotExist"===i.error.code&&(this.error.message=this.i18n.error.noServiceMessage)),i.result?this.sublayers=(0,c.s)(i.result,t):this.sublayers=t,this.loading=!1},this.handleWindowClick=({target:e})=>{this.el.contains(e)||(this.popoverNode.open=!1)},this.handleKeyPress=({key:e})=>{switch(e){case"Esc":case"Escape":this.popoverNode&&(this.popoverNode.open=!1)}},this.api=4,this.config=void 0,this.user=void 0,this.item=void 0,this.portal=void 0,this.layers=void 0,this.searchTerm=void 0,this.border=void 0,this.tooltip=void 0,this.telemetry=void 0,this.button=void 0,this.loading=!0,this.error=void 0,this.sublayers=void 0}async componentWillLoad(){const e=await(0,o.g)(this.el);this.i18n=e[0],s.c.api=this.api,s.c.portal=this.portal,s.c.config=this.config,s.c.user=this.user,this.layers||(this.loading=!0)}async fetchServiceInfo(){const{item:e,portal:t,layers:r}=this;return await(0,l.m)((0,c.f)({item:e,portal:t,layers:r,isSecure:!1}),500)}render(){const{i18n:e,portal:t,user:r,item:o,handleClick:n,handleKeyPress:s,loading:c,searchTerm:d,error:u,tooltip:v,telemetry:p}=this,h=this.sublayers||this.layers;return(0,i.h)(i.H,{onFocusout:e=>{e.relatedTarget&&!this.el.contains(e.relatedTarget)&&(this.popoverNode.open=!1)}},(0,i.h)("calcite-popover-manager",{autoClose:!0},(0,i.h)("button",Object.assign({class:{button:!0,"button--border":this.border},ref:e=>this.button=e,onClick:n,onTouchStart:n,onKeyPress:s},v?{title:v}:{}),(0,i.h)("span",{class:"button-text"},(0,i.h)("slot",null),(0,i.h)("calcite-icon",{icon:"caret-down",scale:"s",class:"button--icon"}))),(0,i.h)("calcite-popover",{ref:e=>this.popoverNode=e,label:e.layersAndTables,pointerDisabled:!0,referenceElement:this.button,closable:!0,class:"popover",placement:"bottom",overlayPositioning:"fixed",heading:e.layersAndTables,onCalcitePopoverOpen:()=>{var e;null===(e=this.telemetry)||void 0===e||e.logEvent({category:"preview popup",action:"click",pageName:(0,a.g)(),pageUrl:window.location.href}),window.addEventListener("click",this.handleWindowClick)},onCalcitePopoverClose:(0,l.d)((()=>{var e;null===(e=this.telemetry)||void 0===e||e.logEvent({category:"preview popup",action:"close",pageName:(0,a.g)(),pageUrl:window.location.href}),window.removeEventListener("click",this.handleWindowClick)}),200)},(0,i.h)("div",{class:"popover-content"},c?(0,i.h)("div",{class:"skeleton"},(0,i.h)("div",{class:"skeleton-content"},(0,i.h)("div",{class:"skeleton-left"}),(0,i.h)("div",{class:"skeleton-main"},(0,i.h)("div",{class:"skeleton-title"}),(0,i.h)("div",{class:"skeleton-subtitle"})),(0,i.h)("div",{class:"skeleton-right"}))):(0,i.h)("arcgis-layers-and-tables-summary",{portal:t,user:r,item:o,layers:h,showMatched:d&&!!this.layers,error:u,loading:!this.sublayers,telemetry:p,onLayersAndTablesFocusEnd:()=>{this.popoverNode.open=!1}})))))}get el(){return(0,i.d)(this)}};u.style=":host{max-width:100%}arcgis-layers-and-tables-summary:not(.hydrated){visibility:hidden}.popover-content{width:380px;min-height:6rem;background-color:var(--calcite-color-background)}.skeleton{margin:1rem;margin-bottom:3rem}@keyframes pulse{50%{opacity:.5}}.skeleton{animation:pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;padding:0.5rem;border:1px solid var(--calcite-color-border-2)}.skeleton-content{display:flex}.skeleton-left,.skeleton-right{height:1rem;width:1rem;background-color:var(--calcite-color-border-3)}.skeleton-main{margin-left:1rem;margin-right:1rem;flex:1 1 0%}.skeleton-title{height:1rem;background-color:var(--calcite-color-border-2)}.skeleton-subtitle{margin-top:0.25rem;height:1rem;background-color:var(--calcite-color-border-3)}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}.button{max-width:100%;cursor:pointer;border-style:none;padding:0px;outline:2px solid transparent;outline-offset:2px;transition-property:all;color:inherit;background:transparent;font-family:inherit;font-size:inherit;line-height:1.5}.button:focus{outline:2px solid var(--calcite-color-brand);outline-offset:4px}.button--border{padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border:1px solid var(--calcite-color-foreground-3)}.button--border:focus{outline-offset:0}.button-text{pointer-events:none;display:flex}.button--icon{margin-inline-start:0.25rem;vertical-align:-3px}"},97758:(e,t,r)=>{r.d(t,{a:()=>u,f:()=>h,s:()=>p});var i=r(20164),o=r(49853),n=r(25145);function s(e,t,r){var i,o;return{description:e.description,fieldAliases:null===(i=e.fields)||void 0===i?void 0:i.map((e=>e.alias)),fields:e.fields,geometryType:r?"table":e.geometryType,id:e.id,title:e.name,type:e.type,matched:null===(o=null==t?void 0:t.find((t=>t.id===e.id)))||void 0===o?void 0:o.matched}}function a(e,t){const{config:r}=o.c,s=(0,n.a)(e),a=Object.assign(Object.assign({useProxy:!1,timeout:!1===r.isMultiTenant?6e4:5e3,addSSL:s},t?{}:{addTokenManually:!1}),{usePost:!0,disableIdentityLookup:!0});return(0,i.r)(e,{},a,"post")}function l(e){var t,r;return(null==e?void 0:e.code)||(null===(r=null===(t=null==e?void 0:e.details)||void 0===t?void 0:t.raw)||void 0===r?void 0:r.code)}function c(e){const t=l(e);return[404,500].includes(t)||"Invalid URL"===(null==e?void 0:e.message)}function d(e,t){const r=l(t);return!e&&(499===r&&"Token Required"===(null==t?void 0:t.message)||403===r)&&!!o.c.user}async function u(e,t,r,i){const o={error:{code:"unhandledError"}};try{try{return{result:await a(`${r}/${t}`,i)}}catch(n){return d(i,n)?u(e,t,r,!0):(c(n)&&(o.error.code="serviceNotExist"),o)}}catch(e){return o}}function v(e,t,r,i){var o,n;const a=null==r?void 0:r.tables,l=(null===(o=null==r?void 0:r.layers)||void 0===o?void 0:o.length)>0||a,c=[...((null==r?void 0:r.layers)||[]).map((e=>e.id)),...null===(n=(null==r?void 0:r.tables)||[])||void 0===n?void 0:n.map((e=>e.id))];return(e||[]).filter((({id:e,type:t})=>!l||"Table"===t&&!a||c.includes(e))).map((e=>s(e,t,i)))}function p(e,t){return e.map((e=>{var r;return Object.assign(Object.assign({},e),{matched:null===(r=null==t?void 0:t.find((t=>t.id===e.id)))||void 0===r?void 0:r.matched})}))}async function h({item:e,portal:t,layers:r,isSecure:o,data:n,retry:l}){var u;const p={error:{code:"unhandledError"}};try{if(!n&&!l)try{const r=(0,i.e)(t),o=r?`&token=${r}`:"",s=`${(0,i.g)(t)}content/items/${e.id}/data?f=json${o}`,a=await fetch(s),l=await a.text();if(l&&(n=JSON.parse(l)),(null==n?void 0:n.error)&&403===n.error.code&&"SB_0006"===(null===(u=n.error)||void 0===u?void 0:u.messageCode))return p.error.code="serviceNotExist",p}catch(e){n=null}if("Feature Collection"===e.type&&(null==n?void 0:n.layers))return{result:n.layers.map((({layerDefinition:e},t)=>{var r;return{description:"",fields:e.fields,fieldAliases:null===(r=e.fields)||void 0===r?void 0:r.map((e=>e.alias)),geometryType:e.geometryType,type:e.type,id:t,matched:!1,title:e.name}}))};try{const{url:t}=e;return async function({serviceInfo:e,item:t,layers:r,isSecure:i,data:o}){var n,l;const{url:c}=t;if(!(null===(n=e.layers)||void 0===n?void 0:n.length)&&!(null===(l=e.tables)||void 0===l?void 0:l.length)&&(null==e?void 0:e.fields))return{result:[s(e,r)]};try{const{layers:e,tables:t}=await a(`${c}/layers`,i);return{result:[...v(e,r,o),...v(t,r,o,!0)].sort(((e,t)=>e.id-t.id))}}catch(e){return{error:{code:"unhandledError"}}}}({serviceInfo:await a(t,o),item:e,layers:r,isSecure:o,data:n})}catch(i){return d(o,i)?h({item:e,portal:t,layers:r,data:n,isSecure:!0}):(c(i)&&(p.error.code="serviceNotExist"),p)}}catch(e){return p}}},37963:(e,t,r)=>{r.d(t,{a:()=>l,b:()=>c,c:()=>n,d:()=>o,g:()=>a,s:()=>s});var i=r(36238);function o(e,t,r,i){!function(e,t,r){let i=null==(r=r||{})?void 0:r.expires;if("number"==typeof i){const e=new Date,t=24*i*60*60*1e3;e.setTime(Date.now()+t),i=r.expires=e}"string"!=typeof i&&(null==i?void 0:i.toUTCString)&&(r.expires=i.toUTCString());let o,n=`${e}=${encodeURIComponent(t)}`;for(o in r){n+=`; ${o}`;const e=r[o];!0!==e&&(n+=`=${e}`)}document.cookie=n}(e,i?JSON.stringify(t):t,r)}function n(e,t){const r=function(e){const t=document.cookie,r=new RegExp(`(?:^|; )${(0,i.e)(e)}=([^;]*)`),o=t.match(r);return o?decodeURIComponent(o[1]):void 0}(e);return r&&t?JSON.parse(r):r}function s(e,t,r){window.localStorage.setItem(e,r?JSON.stringify(t):t)}function a(e,t){const r=window.localStorage.getItem(e);return r&&t?JSON.parse(r):r}function l(e,t,r){window.sessionStorage.setItem(e,r?JSON.stringify(t):t)}function c(e,t){const r=window.sessionStorage.getItem(e);return r&&t?JSON.parse(r):r}},47848:(e,t,r)=>{function i(){const{hash:e,pathname:t}=window.location;if(t.includes("group.html"))return"group page";if(t.includes("search.html"))return"search result page";switch(e){case"#favorites":return"favorites";case"#groups":return"my groups content";case"#organization":return"my org content";case"#livingAtlas":return"living atlas";default:return"my content"}}r.d(t,{g:()=>i})},25145:(e,t,r)=>{r.d(t,{a:()=>h,b:()=>p,c:()=>d,d:()=>g,e:()=>f,f:()=>m,g:()=>y,i:()=>b,r:()=>c,s:()=>v,u:()=>u});var i=r(20164),o=r(79210),n=r(49853),s=r(69283),a=r(37963),l=r(52787);function c(e){return"/"===(null==e?void 0:e.slice(-1))?e.slice(0,e.length-1):e}async function d(e){var t;const r=null!==(t=null===n.c||void 0===n.c?void 0:n.c.api)&&void 0!==t?t:4,[i]=await(0,s.l)([4===r?"esri/core/urlUtils":"esri/urlUtils"]);let o=i.urlToObject(e);o.query=o.query||{};for(let e in o.query||{})o.query.hasOwnProperty(e)&&(Array.isArray(o.query[e])||(o.query[e]=o.query[e].replace(/(&lt;|&gt;|<|>|%3C|%3E)/g,"")));return o}function u(e){return(null==e?void 0:e.replace(/^.*\//,"").replace(/.[^.]*$/,""))||""}function v(e){return["WFS","GeoJson","CSV","GeoRSS","KML","OGCFeatureServer","WMS","WMTS"].includes(e)}function p(e){const{config:t,portal:r}=n.c;let i=!1;if(!e)return!1;if((t.httpsDomains||[]).forEach((t=>{(e.indexOf(`.${t}/`)>-1||e.indexOf(`/${t}/`)>-1)&&(i=!0)})),!i){let t=r.portalHostname;t.indexOf("/")>-1&&(t=t.substring(0,t.indexOf("/"))),e.indexOf(t)>-1&&(i=!0)}return i}function h(e){if(!e)return!1;const{config:t,portal:r}=n.c,o=(0,i.g)(r),s=new URL(o).hostname,a=!1===t.isMultiTenant,l=-1!==e.indexOf(".arcgis.com/"),c=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features")||-1!==e.indexOf("//locationservices"),d=r.supportsHostedServices&&-1!==e.indexOf(s)&&!a;return l&&c||!l&&d}function f(){var e;if(-1===window.location.protocol.toLowerCase().indexOf("https")){const t=(0,a.c)("esri_auth",!0);return"web"!==(null===(e=null==t?void 0:t.auth_tier)||void 0===e?void 0:e.toLowerCase())}return!0}function g(e){let t=e.toLowerCase();-1==t.indexOf("http://")&&-1==t.indexOf("https://")&&(t=(e="https://"+e).toLowerCase());let r=t.indexOf("//");r=t.indexOf("/",r+2),-1==r?t=(e+="/arcgis/rest/services").toLowerCase():r==t.length-1&&(t=(e+="arcgis/rest/services").toLowerCase());let i=t.indexOf("/arcgis",r);i==t.length-7?t=(e+="/rest/services").toLowerCase():i==t.length-8&&(t=(e+="rest/services").toLowerCase()),i=t.indexOf("/server",r),t.endsWith("/server")?t=(e+="/rest/services").toLowerCase():t.endsWith("/server/")&&(t=(e+="rest/services").toLowerCase());const o=t.indexOf("/rest/services",r),n=t.indexOf("/services",r),s=t.indexOf("/rest",r);return-1==o&&n>-1?t=(e=`${e.substring(0,n)}/rest/services${e.substring(n+9)}`).toLowerCase():-1==o&&s>-1&&(t=(e=`${e.substring(0,s)}/rest/services${e.substring(s+5)}`).toLowerCase()),t.indexOf("/rest/services"),e}const m=(e,t=!1)=>(e=c(e),/(http|https|ftp):\/\/?/.exec(e)||(e=`https://${e}`),!t&&"https:"!==location.protocol||!h(e)&&!p(e)||(e=e.replace("http:/","https:/")),e.indexOf("/dynamicLayer?")>-1?e.substring(0,e.indexOf("/dynamicLayer?")):e),y=(e,t=!1)=>{var r,i,n;if(!e)return{error:{code:"invalidUrl"}};if(b(e,t))return{error:{code:"httpWarning"}};const s=decodeURIComponent(e),a=s.replace(o.v,"").match(/((\.|\/)*(kml|kmz))/gi),c=s.replace(o.v,"").match(/((\/|\=)(wmts|wms|wfs))/gi),d=s.replace(o.v,"").match(/((\/|\=)(OGC|OGCFeatureServer))/gi),u=s.replace(o.v,"").match(/((\.|\/)*(rss))/gi),v=null===(r=s.replace(o.v,"").match(o.r))||void 0===r?void 0:r[1],p=s.replace(o.v,"").match(o.c),h=s.replace(o.v,"").match(/((\.|\/)*(csv))/gi),f=s.replace(o.v,"").match(/(\.|\/)((\$?{(z|level)})\/*(\$?{(x|col)})\/*(\$?{(y|row)}))/gi);let g=null;if(s.match(o.b))g="GeoJson";else if(!d||c||v)if(v&&!c)g=l.a[v];else if(p)g="Map Service";else if(c){const e="/"===(null==c?void 0:c[0].charAt(0))?"/":"=";g=null===(n=null===(i=null==c?void 0:c[0])||void 0===i?void 0:i.split(e)[1])||void 0===n?void 0:n.toUpperCase()}else a?g="KML":u?g="GeoRSS":h?g="CSV":f&&(g="Tile Layer");else g="OGCFeatureServer";return{result:g}},b=(e,t)=>!t&&e.includes("http://")}}]);