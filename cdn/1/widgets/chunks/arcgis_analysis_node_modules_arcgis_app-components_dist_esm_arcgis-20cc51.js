"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-20cc51"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-data-store-select-server-list.entry.js":
/*!******************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-data-store-select-server-list.entry.js ***!
  \******************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_data_store_select_server_list: () => (/* binding */ ArcgisNewItemPagesDataStoreSelectServerList)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _data_store_e2ae6a67_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data-store-e2ae6a67.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/data-store-e2ae6a67.js");
/* harmony import */ var _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./add-item-dbbe2f57.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-dbbe2f57.js");
/* harmony import */ var _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ui-bca7bcd1.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-bca7bcd1.js");
/* harmony import */ var _data_store_8e83fb7a_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./data-store-8e83fb7a.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/data-store-8e83fb7a.js");
/* harmony import */ var _portal_d518b571_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./portal-d518b571.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-d518b571.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _url_4c3ae54c_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./url-4c3ae54c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/url-4c3ae54c.js");
/* harmony import */ var _functional_44de8fcf_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./functional-44de8fcf.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-44de8fcf.js");
/* harmony import */ var _service_8c2c4241_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./service-8c2c4241.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/service-8c2c4241.js");
/* harmony import */ var _feature_layer_573bb473_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./feature-layer-573bb473.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-573bb473.js");
/* harmony import */ var _item_properties_10491b2e_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./item-properties-10491b2e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-properties-10491b2e.js");
/* harmony import */ var _feature_layer_79fb302c_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./feature-layer-79fb302c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-79fb302c.js");
/* harmony import */ var _guid_aeaed84d_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./guid-aeaed84d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-aeaed84d.js");
/* harmony import */ var _thumbnail_bcb89e69_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./thumbnail-bcb89e69.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/thumbnail-bcb89e69.js");
/* harmony import */ var _user_3ea69c3a_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./user-3ea69c3a.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/user-3ea69c3a.js");
/* harmony import */ var _query_d62660d4_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./query-d62660d4.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/query-d62660d4.js");
/* harmony import */ var _api_2e3a136f_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./api-2e3a136f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/api-2e3a136f.js");
/* harmony import */ var _string_58a5fef3_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./string-58a5fef3.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/string-58a5fef3.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _item_c58ffced_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./item-c58ffced.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-c58ffced.js");
/* harmony import */ var _server_item_8d384796_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./server-item-8d384796.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/server-item-8d384796.js");
/* harmony import */ var _item_3535552d_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./item-3535552d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-3535552d.js");
/* harmony import */ var _functional_81373f6d_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./functional-81373f6d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-81373f6d.js");
/* harmony import */ var _item_types_2029b06b_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./item-types-2029b06b.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-2029b06b.js");
/* harmony import */ var _feature_layer_17b64946_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./feature-layer-17b64946.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-17b64946.js");
/* harmony import */ var _ags_eb458a03_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./ags-eb458a03.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ags-eb458a03.js");
/* harmony import */ var _url_35875a10_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./url-35875a10.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/url-35875a10.js");
/* harmony import */ var _storage_0353a769_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./storage-0353a769.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/storage-0353a769.js");
/* harmony import */ var _file_bf8ab90f_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./file-bf8ab90f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-bf8ab90f.js");
/* harmony import */ var _store_6a88e6c5_js__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./store-6a88e6c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/store-6a88e6c5.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


































const arcgisNewItemPagesDataStoreSelectServerListCss = ".sub-heading{font-weight:400;color:var(--calcite-color-text-3)}.row-wrapper{margin-top:0.5rem;margin-bottom:0.5rem;display:flex;width:100%;padding-top:0.75rem}.row-divider{box-shadow:0 -1px 0 #eaeaea}.title{gap:0.5rem}.status-wrapper{display:flex;gap:0.5rem;line-height:1rem}.success{--calcite-ui-icon-color:var(--calcite-color-status-success)}.failure{--calcite-ui-icon-color:var(--calcite-color-status-danger)}.error{--calcite-ui-icon-color:var(--calcite-color-status-danger)}.validating{--calcite-ui-icon-color:var(--calcite-color-status-info)}.half-row{width:50%;padding-left:0.5rem;padding-right:0.5rem}.requireRestartModal{--calcite-modal-width:500px;--calcite-modal-height:400px}";

const ArcgisNewItemPagesDataStoreSelectServerList = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.newItemUpdatePage = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
        this.loading = true;
        this.noValidServers = true;
        this.serverTypes = [];
        this.item = {
            bdfsType: _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.bdfsType,
            allowServicesRestart: false,
            publisherFolderPath: _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.publisherFolderPath,
            publisherFolderPathHostname: _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.publisherFolderPathHostname,
            serverFolderPath: _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.serverFolderPath,
            newServerFolderPath: _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.newServerFolderPath,
            nfsSharePath: _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.nfsSharePath,
            nfsHostName: _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.nfsHostName
        };
        this.serverStatusIcons = {
            success: "check-circle-f",
            failure: "exclamation-mark-circle-f",
            error: "exclamation-mark-triangle-f",
            validating: "information"
        };
        this.selectedServers = [];
        this.serverList = [];
        this.allBoxesSelected = false;
        this.error = null;
        this.requireRestart = false;
        this.openRequireRestartModal = false;
    }
    async componentWillLoad() {
        this.i18n = _ui_bca7bcd1_js__WEBPACK_IMPORTED_MODULE_3__.u.i18n.serverSelection;
        this.dataStoreType = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.addDataStoreType;
        this.serverList = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.dataStoreSelectServerList || [];
        this.serverList = this.filterServers(false, false, false, false);
    }
    async componentDidLoad() {
        //TODO: catch unhandled errors
        const validatedServers = await (0,_data_store_e2ae6a67_js__WEBPACK_IMPORTED_MODULE_1__.c)(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a, this.serverList, this.dataStoreType);
        this.serverList = [...validatedServers];
        const result = await (0,_data_store_e2ae6a67_js__WEBPACK_IMPORTED_MODULE_1__.d)(this.serverList);
        this.openRequireRestartModal = validatedServers.some((server) => (server === null || server === void 0 ? void 0 : server.error) === "RequiresServicesRestart");
        this.serverList = [...result.servers];
        this.serverTypes = [...result.serverTypes];
        this.renderTable();
        this.appendServerTypes();
        this.loading = false;
    }
    filterServers(isBigDataFileShare, isNoSQL, isHostingServerOnlyForDatabase, isNFS) {
        return (this.serverList || []).filter((server) => {
            const serverRole = (server.serverRole || "").toUpperCase();
            const excludedServerRoles = [
                "ARCGIS_NOTEBOOK_SERVER",
                "ARCGIS_MISSION_SERVER",
                "ARCGIS_VIDEO_SERVER"
            ];
            const serverFunctions = (server.serverFunction && server.serverFunction.replace(/\s+/g, "").split(",")) || [];
            const excludedServerFunctions = [
                "NOTEBOOKSERVER",
                "WORKFLOWMANAGER",
                "MISSIONSERVER",
                "VIDEOSERVER"
            ];
            let isHostingServer = serverRole === "HOSTING_SERVER";
            // only display GeoAnalytics server for BDFS
            if (isBigDataFileShare && serverFunctions.indexOf("GeoAnalytics") === -1) {
                excludedServerRoles.push(serverRole);
                isHostingServer = false;
            }
            if (isNoSQL && serverFunctions.indexOf("KnowledgeServer") === -1) {
                excludedServerRoles.push(serverRole);
                isHostingServer = false;
            }
            if (isNFS && (0,_data_store_8e83fb7a_js__WEBPACK_IMPORTED_MODULE_4__.i)()) {
                isHostingServer = true;
            }
            let allowedServerRole = excludedServerRoles.indexOf(serverRole) === -1;
            // only display hosting servers for Database when client type is bigquery, snowflake or redshift
            if (isHostingServerOnlyForDatabase) {
                allowedServerRole = false;
            }
            return (isHostingServer ||
                (allowedServerRole &&
                    (!serverFunctions.length ||
                        serverFunctions.some(function (func) {
                            return excludedServerFunctions.indexOf(func.toUpperCase()) === -1;
                        }))));
        });
    }
    renderTable() {
        const dataStoreType = this.dataStoreType;
        const isBigDataFileShare = dataStoreType === "bdfs";
        const isNoSQL = dataStoreType === "nosql";
        const isNFS = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.serverFolderPath === "nfsHostAndPath" && dataStoreType === "folder";
        // filter servers and only display hosting servers for database: bigquery, snowflake or redshift
        const isHostingServerOnlyForDatabase = this.checkDatabaseClient();
        // filter servers for bdfs
        this.serverList = this.filterServers(isBigDataFileShare, isNoSQL, isHostingServerOnlyForDatabase, isNFS);
        // filter servers by users input server path - only for folder & file share
        if (!isNFS) {
            if (["folder", "fileshare"].includes(dataStoreType)) {
                this.serverList = this.filterServersByServerPath();
            }
        }
    }
    checkDatabaseClient() {
        const dataStoreType = this.dataStoreType;
        const publisherConnectionString = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.publisherConnectionString;
        let isHostingServerOnly = false;
        if (dataStoreType === "database" && publisherConnectionString) {
            const dbConnectionStringArray = publisherConnectionString.split(";");
            dbConnectionStringArray.forEach(function (keyword) {
                // "DBCLIENT=bigquery"
                if (keyword.indexOf("DBCLIENT") > -1 &&
                    ["bigquery", "snowflake", "redshift"].indexOf(keyword.split("=")[1]) > -1) {
                    isHostingServerOnly = true;
                }
            });
        }
        return isHostingServerOnly;
    }
    filterServersByServerPath() {
        const dataStoreType = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.addDataStoreType;
        const serverPath = dataStoreType === "folder"
            ? _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.newServerFolderPath || _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.publisherFolderPath
            : _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.publisherFileShareFolderPath;
        const serverPathType = serverPath[0].indexOf("/") > -1 ? "Linux" : "Windows";
        const isNFS = _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.serverFolderPath === "nfsHostAndPath" && dataStoreType === "folder";
        return this.serverList.filter((federatedServer) => {
            return !!this.serverTypes.find((serverItem) => {
                return ((serverItem.name === federatedServer.adminUrl ||
                    serverItem.name === `${federatedServer.adminUrl}/admin`) &&
                    (isNFS ? federatedServer.isHosted : serverItem.type === serverPathType));
            });
        });
    }
    appendServerTypes() {
        const { serverList, i18n } = this;
        serverList.map((server) => {
            const serverFunction = (server.serverFunction && server.serverFunction.replace(/\s+/g, "").split(",")) || [];
            let serverType = "";
            if (server.serverRole === "HOSTING_SERVER") {
                serverType += i18n.types.hostedSetting;
            }
            if (serverFunction.indexOf("NotebookServer") > -1) {
                serverType += (serverType && ", ") + i18n.types.notebookServerSetting;
            }
            if (serverFunction.indexOf("GeoAnalytics") > -1) {
                serverType += (serverType && ", ") + i18n.types.geoAnalyticsServerSetting;
            }
            if (serverFunction.indexOf("RasterAnalytics") > -1) {
                serverType += (serverType && ", ") + i18n.types.rasterAnalysisSetting;
            }
            if (serverFunction.indexOf("ImageHosting") > -1) {
                serverType += (serverType && ", ") + i18n.types.imageHostingSetting;
            }
            if (serverFunction.indexOf("MissionServer") > -1) {
                serverType += (serverType && ", ") + i18n.types.missionServerSetting;
            }
            server.serverType = serverType;
        });
    }
    convertStatusDisplayText(server) {
        const i18n = this.i18n;
        const status = server.serverStatus;
        const displayTable = {
            success: i18n.status.success,
            failure: i18n.status.failure,
            error: i18n.status.error,
            validating: i18n.status.validating
        };
        return displayTable[status];
    }
    closeModal() {
        this.openRequireRestartModal = false;
        this.newItemUpdatePage.emit("dataStoreSelectFolder");
    }
    async acceptRequireRestart() {
        this.loading = true;
        this.openRequireRestartModal = false;
        this.item.allowServicesRestart = true;
        this.requireRestart = true;
        const validatedServers = await (0,_data_store_e2ae6a67_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.item, this.serverList, this.dataStoreType);
        this.serverList = [...validatedServers];
        const result = await (0,_data_store_e2ae6a67_js__WEBPACK_IMPORTED_MODULE_1__.d)(this.serverList);
        this.serverList = [...result.servers];
        this.serverTypes = [...result.serverTypes];
        this.renderTable();
        this.appendServerTypes();
        this.loading = false;
    }
    checkValidServers() {
        this.noValidServers = !this.serverList.some((server) => {
            return server.serverStatus === "success";
        });
    }
    checkAllBoxes() {
        this.selectedServers = [...[]];
        if (!this.allBoxesSelected) {
            this.serverList.forEach((server) => {
                this.selectedServers = [...this.selectedServers, server.id];
            });
        }
        this.allBoxesSelected = !this.allBoxesSelected;
    }
    handleNext() {
        const selectedServers = this.selectedServers || [];
        if (selectedServers.length === 0) {
            this.error = "noServerSelected";
            return;
        }
        if (this.requireRestart) {
            _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.allowServicesRestart = true;
        }
        _add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.dataStoreSelectedServers = selectedServers;
        this.newItemUpdatePage.emit("itemProperties");
    }
    render() {
        const { i18n, error, serverList, dataStoreType, loading, allBoxesSelected, noValidServers } = this;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-description", { header: dataStoreType === "bdfs" && ["fileshare", "cloud"].includes(_add_item_dbbe2f57_js__WEBPACK_IMPORTED_MODULE_2__.a.bdfsType)
                ? i18n.dataStoreServerSelect.bdfsHeading
                : i18n.dataStoreServerSelect.heading }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("p", { class: "sub-heading" }, i18n.dataStoreServerSelect.subHeading), loading ? ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-loader", { label: "server-loader", text: i18n.loader.validating })) : ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.F, null, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "row-wrapper" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "half-row" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { layout: "inline" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-checkbox", { disabled: noValidServers, checked: allBoxesSelected, onCalciteCheckboxChange: () => {
                this.checkAllBoxes();
            } }), i18n.list.title)), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "half-row" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { layout: "inline" }, i18n.list.status))), serverList.map((server) => {
            return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "row-wrapper row-divider" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "half-row" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { layout: "inline", class: "server-wrapper" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-checkbox", { disabled: server.serverStatus !== "success", value: server.id, onCalciteCheckboxChange: (e) => {
                    const serverId = e.target.value;
                    if (this.selectedServers.indexOf(serverId) === -1) {
                        this.selectedServers = [...this.selectedServers, serverId];
                    }
                    else {
                        this.selectedServers = this.selectedServers.filter((server) => {
                            return server !== serverId;
                        });
                    }
                }, checked: this.selectedServers.includes(server.id) }), server.url + (server.serverType && ` (${server.serverType})`))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "half-row" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "status-wrapper", title: server.errorMsg || server.serverStatus }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-icon", { class: {
                    success: server.serverStatus === "success",
                    failure: server.serverStatus === "failure",
                    error: server.serverStatus === "error",
                    validating: server.serverStatus === "validating"
                }, scale: "s", icon: this.serverStatusIcons[server.serverStatus] }), this.convertStatusDisplayText(server)))));
        }), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { heading: i18n.dataStoreServerSelect.noServerSelected.heading, description: i18n.dataStoreServerSelect.noServerSelected.description, active: error !== null && !loading, onAlertDismiss: () => {
                this.error = null;
            } }))), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-modal", { open: this.openRequireRestartModal, class: "requireRestartModal", onCalciteModalClose: (e) => e.stopPropagation() }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { slot: "content" }, "You are registering a folder data store that uses a new path and host that has not been registered with ArcGIS Enterprise. This will cause several of your system and utility services to restart. To avoid disruption, consider registering during off-peak hours.", (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("br", null), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("br", null), "Are you sure you want to proceed"), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { slot: "secondary", appearance: "outline", onClick: () => this.closeModal() }, "Cancel"), (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { slot: "primary", onClick: () => this.acceptRequireRestart() }, "OK"))));
    }
    static get watchers() { return {
        "serverList": ["checkValidServers"]
    }; }
};
ArcgisNewItemPagesDataStoreSelectServerList.style = arcgisNewItemPagesDataStoreSelectServerListCss;



//# sourceMappingURL=arcgis-new-item-pages-data-store-select-server-list.entry.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTIwY2M1MS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDZ0c7QUFDRztBQUN4QztBQUNOO0FBQzBCO0FBQ2pEO0FBQ0s7QUFDTDtBQUNEO0FBQ0Y7QUFDTztBQUNIO0FBQ007QUFDRTtBQUNGO0FBQ1Q7QUFDSztBQUNMO0FBQ0M7QUFDRjtBQUNHO0FBQ0g7QUFDQztBQUNPO0FBQ1A7QUFDTTtBQUNBO0FBQ0c7QUFDVjtBQUNBO0FBQ0k7QUFDSDtBQUNDOztBQUU3QixxRUFBcUUsZ0JBQWdCLGtDQUFrQyxhQUFhLGtCQUFrQixxQkFBcUIsYUFBYSxXQUFXLG9CQUFvQixhQUFhLDRCQUE0QixPQUFPLFdBQVcsZ0JBQWdCLGFBQWEsV0FBVyxpQkFBaUIsU0FBUyw0REFBNEQsU0FBUywyREFBMkQsT0FBTywyREFBMkQsWUFBWSx5REFBeUQsVUFBVSxVQUFVLG9CQUFvQixxQkFBcUIscUJBQXFCLDRCQUE0Qiw2QkFBNkI7O0FBRXR1QjtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEIsaUNBQWlDLHFEQUFXO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLG9EQUFZO0FBQ2xDO0FBQ0EsaUNBQWlDLG9EQUFZO0FBQzdDLHlDQUF5QyxvREFBWTtBQUNyRCw4QkFBOEIsb0RBQVk7QUFDMUMsaUNBQWlDLG9EQUFZO0FBQzdDLDBCQUEwQixvREFBWTtBQUN0Qyx5QkFBeUIsb0RBQVk7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDhDQUFZO0FBQ2hDLDZCQUE2QixvREFBWTtBQUN6QywwQkFBMEIsb0RB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aUIsaUVBQWlFO0FBQ2xGLFNBQVMsR0FBRyxxREFBQyw0QkFBNEI7QUFDekM7QUFDQSxlQUFlLEtBQUsscURBQUMsb0JBQW9CLG1IQUFtSCxFQUFFLHFEQUFDLFVBQVUsaUJBQWlCLHlRQUF5USxxREFBQyxjQUFjLHFEQUFDLG1EQUFtRCxxREFBQyxxQkFBcUIsNEVBQTRFLGFBQWEscURBQUMscUJBQXFCLDZEQUE2RDtBQUN4c0I7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7O0FBRThHOztBQUU5RyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1uZXctaXRlbS1wYWdlcy1kYXRhLXN0b3JlLXNlbGVjdC1zZXJ2ZXItbGlzdC5lbnRyeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgRiBhcyBGcmFnbWVudCB9IGZyb20gJy4vaW5kZXgtZTNiZjdkYTcuanMnO1xuaW1wb3J0IHsgYyBhcyB2YWxpZGF0ZURhdGFzdG9yZUZvclNlcnZlcnMsIGQgYXMgY2hlY2tTZXJ2ZXJzVHlwZSB9IGZyb20gJy4vZGF0YS1zdG9yZS1lMmFlNmE2Ny5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tZGJiZTJmNTcuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWJjYTdiY2QxLmpzJztcbmltcG9ydCB7IGkgYXMgaXNBcmNHSVNFbnRlcnByaXNlT25LdWJlcm5ldGVzIH0gZnJvbSAnLi9kYXRhLXN0b3JlLThlODNmYjdhLmpzJztcbmltcG9ydCAnLi9wb3J0YWwtZDUxOGI1NzEuanMnO1xuaW1wb3J0ICcuL2xvYWRNb2R1bGVzLWI0YWMxMjQ3LmpzJztcbmltcG9ydCAnLi9jb25maWctNzVhZGY5NjIuanMnO1xuaW1wb3J0ICcuL2luZGV4LTA1OTU2Y2FiLmpzJztcbmltcG9ydCAnLi91cmwtNGMzYWU1NGMuanMnO1xuaW1wb3J0ICcuL2Z1bmN0aW9uYWwtNDRkZThmY2YuanMnO1xuaW1wb3J0ICcuL3NlcnZpY2UtOGMyYzQyNDEuanMnO1xuaW1wb3J0ICcuL2ZlYXR1cmUtbGF5ZXItNTczYmI0NzMuanMnO1xuaW1wb3J0ICcuL2l0ZW0tcHJvcGVydGllcy0xMDQ5MWIyZS5qcyc7XG5pbXBvcnQgJy4vZmVhdHVyZS1sYXllci03OWZiMzAyYy5qcyc7XG5pbXBvcnQgJy4vZ3VpZC1hZWFlZDg0ZC5qcyc7XG5pbXBvcnQgJy4vdGh1bWJuYWlsLWJjYjg5ZTY5LmpzJztcbmltcG9ydCAnLi91c2VyLTNlYTY5YzNhLmpzJztcbmltcG9ydCAnLi9xdWVyeS1kNjI2NjBkNC5qcyc7XG5pbXBvcnQgJy4vYXBpLTJlM2ExMzZmLmpzJztcbmltcG9ydCAnLi9zdHJpbmctNThhNWZlZjMuanMnO1xuaW1wb3J0ICcuL2RvbS00ZDM2NzY3Ny5qcyc7XG5pbXBvcnQgJy4vaXRlbS1jNThmZmNlZC5qcyc7XG5pbXBvcnQgJy4vc2VydmVyLWl0ZW0tOGQzODQ3OTYuanMnO1xuaW1wb3J0ICcuL2l0ZW0tMzUzNTU1MmQuanMnO1xuaW1wb3J0ICcuL2Z1bmN0aW9uYWwtODEzNzNmNmQuanMnO1xuaW1wb3J0ICcuL2l0ZW0tdHlwZXMtMjAyOWIwNmIuanMnO1xuaW1wb3J0ICcuL2ZlYXR1cmUtbGF5ZXItMTdiNjQ5NDYuanMnO1xuaW1wb3J0ICcuL2Fncy1lYjQ1OGEwMy5qcyc7XG5pbXBvcnQgJy4vdXJsLTM1ODc1YTEwLmpzJztcbmltcG9ydCAnLi9zdG9yYWdlLTAzNTNhNzY5LmpzJztcbmltcG9ydCAnLi9maWxlLWJmOGFiOTBmLmpzJztcbmltcG9ydCAnLi9zdG9yZS02YTg4ZTZjNS5qcyc7XG5cbmNvbnN0IGFyY2dpc05ld0l0ZW1QYWdlc0RhdGFTdG9yZVNlbGVjdFNlcnZlckxpc3RDc3MgPSBcIi5zdWItaGVhZGluZ3tmb250LXdlaWdodDo0MDA7Y29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci10ZXh0LTMpfS5yb3ctd3JhcHBlcnttYXJnaW4tdG9wOjAuNXJlbTttYXJnaW4tYm90dG9tOjAuNXJlbTtkaXNwbGF5OmZsZXg7d2lkdGg6MTAwJTtwYWRkaW5nLXRvcDowLjc1cmVtfS5yb3ctZGl2aWRlcntib3gtc2hhZG93OjAgLTFweCAwICNlYWVhZWF9LnRpdGxle2dhcDowLjVyZW19LnN0YXR1cy13cmFwcGVye2Rpc3BsYXk6ZmxleDtnYXA6MC41cmVtO2xpbmUtaGVpZ2h0OjFyZW19LnN1Y2Nlc3N7LS1jYWxjaXRlLXVpLWljb24tY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtc3VjY2Vzcyl9LmZhaWx1cmV7LS1jYWxjaXRlLXVpLWljb24tY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtZGFuZ2VyKX0uZXJyb3J7LS1jYWxjaXRlLXVpLWljb24tY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtZGFuZ2VyKX0udmFsaWRhdGluZ3stLWNhbGNpdGUtdWktaWNvbi1jb2xvcjp2YXIoLS1jYWxjaXRlLWNvbG9yLXN0YXR1cy1pbmZvKX0uaGFsZi1yb3d7d2lkdGg6NTAlO3BhZGRpbmctbGVmdDowLjVyZW07cGFkZGluZy1yaWdodDowLjVyZW19LnJlcXVpcmVSZXN0YXJ0TW9kYWx7LS1jYWxjaXRlLW1vZGFsLXdpZHRoOjUwMHB4Oy0tY2FsY2l0ZS1tb2RhbC1oZWlnaHQ6NDAwcHh9XCI7XG5cbmNvbnN0IEFyY2dpc05ld0l0ZW1QYWdlc0RhdGFTdG9yZVNlbGVjdFNlcnZlckxpc3QgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJuZXdJdGVtVXBkYXRlUGFnZVwiLCA3KTtcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5ub1ZhbGlkU2VydmVycyA9IHRydWU7XG4gICAgICAgIHRoaXMuc2VydmVyVHlwZXMgPSBbXTtcbiAgICAgICAgdGhpcy5pdGVtID0ge1xuICAgICAgICAgICAgYmRmc1R5cGU6IGFkZEl0ZW1TdGF0ZS5iZGZzVHlwZSxcbiAgICAgICAgICAgIGFsbG93U2VydmljZXNSZXN0YXJ0OiBmYWxzZSxcbiAgICAgICAgICAgIHB1Ymxpc2hlckZvbGRlclBhdGg6IGFkZEl0ZW1TdGF0ZS5wdWJsaXNoZXJGb2xkZXJQYXRoLFxuICAgICAgICAgICAgcHVibGlzaGVyRm9sZGVyUGF0aEhvc3RuYW1lOiBhZGRJdGVtU3RhdGUucHVibGlzaGVyRm9sZGVyUGF0aEhvc3RuYW1lLFxuICAgICAgICAgICAgc2VydmVyRm9sZGVyUGF0aDogYWRkSXRlbVN0YXRlLnNlcnZlckZvbGRlclBhdGgsXG4gICAgICAgICAgICBuZXdTZXJ2ZXJGb2xkZXJQYXRoOiBhZGRJdGVtU3RhdGUubmV3U2VydmVyRm9sZGVyUGF0aCxcbiAgICAgICAgICAgIG5mc1NoYXJlUGF0aDogYWRkSXRlbVN0YXRlLm5mc1NoYXJlUGF0aCxcbiAgICAgICAgICAgIG5mc0hvc3ROYW1lOiBhZGRJdGVtU3RhdGUubmZzSG9zdE5hbWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXJ2ZXJTdGF0dXNJY29ucyA9IHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IFwiY2hlY2stY2lyY2xlLWZcIixcbiAgICAgICAgICAgIGZhaWx1cmU6IFwiZXhjbGFtYXRpb24tbWFyay1jaXJjbGUtZlwiLFxuICAgICAgICAgICAgZXJyb3I6IFwiZXhjbGFtYXRpb24tbWFyay10cmlhbmdsZS1mXCIsXG4gICAgICAgICAgICB2YWxpZGF0aW5nOiBcImluZm9ybWF0aW9uXCJcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFNlcnZlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5zZXJ2ZXJMaXN0ID0gW107XG4gICAgICAgIHRoaXMuYWxsQm94ZXNTZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZXF1aXJlUmVzdGFydCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm9wZW5SZXF1aXJlUmVzdGFydE1vZGFsID0gZmFsc2U7XG4gICAgfVxuICAgIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgICAgICB0aGlzLmkxOG4gPSB1aVN0b3JlU3RhdGUuaTE4bi5zZXJ2ZXJTZWxlY3Rpb247XG4gICAgICAgIHRoaXMuZGF0YVN0b3JlVHlwZSA9IGFkZEl0ZW1TdGF0ZS5hZGREYXRhU3RvcmVUeXBlO1xuICAgICAgICB0aGlzLnNlcnZlckxpc3QgPSBhZGRJdGVtU3RhdGUuZGF0YVN0b3JlU2VsZWN0U2VydmVyTGlzdCB8fCBbXTtcbiAgICAgICAgdGhpcy5zZXJ2ZXJMaXN0ID0gdGhpcy5maWx0ZXJTZXJ2ZXJzKGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICB9XG4gICAgYXN5bmMgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICAgICAgLy9UT0RPOiBjYXRjaCB1bmhhbmRsZWQgZXJyb3JzXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlZFNlcnZlcnMgPSBhd2FpdCB2YWxpZGF0ZURhdGFzdG9yZUZvclNlcnZlcnMoYWRkSXRlbVN0YXRlLCB0aGlzLnNlcnZlckxpc3QsIHRoaXMuZGF0YVN0b3JlVHlwZSk7XG4gICAgICAgIHRoaXMuc2VydmVyTGlzdCA9IFsuLi52YWxpZGF0ZWRTZXJ2ZXJzXTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tTZXJ2ZXJzVHlwZSh0aGlzLnNlcnZlckxpc3QpO1xuICAgICAgICB0aGlzLm9wZW5SZXF1aXJlUmVzdGFydE1vZGFsID0gdmFsaWRhdGVkU2VydmVycy5zb21lKChzZXJ2ZXIpID0+IChzZXJ2ZXIgPT09IG51bGwgfHwgc2VydmVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZXJ2ZXIuZXJyb3IpID09PSBcIlJlcXVpcmVzU2VydmljZXNSZXN0YXJ0XCIpO1xuICAgICAgICB0aGlzLnNlcnZlckxpc3QgPSBbLi4ucmVzdWx0LnNlcnZlcnNdO1xuICAgICAgICB0aGlzLnNlcnZlclR5cGVzID0gWy4uLnJlc3VsdC5zZXJ2ZXJUeXBlc107XG4gICAgICAgIHRoaXMucmVuZGVyVGFibGUoKTtcbiAgICAgICAgdGhpcy5hcHBlbmRTZXJ2ZXJUeXBlcygpO1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgZmlsdGVyU2VydmVycyhpc0JpZ0RhdGFGaWxlU2hhcmUsIGlzTm9TUUwsIGlzSG9zdGluZ1NlcnZlck9ubHlGb3JEYXRhYmFzZSwgaXNORlMpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnNlcnZlckxpc3QgfHwgW10pLmZpbHRlcigoc2VydmVyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZXJ2ZXJSb2xlID0gKHNlcnZlci5zZXJ2ZXJSb2xlIHx8IFwiXCIpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICBjb25zdCBleGNsdWRlZFNlcnZlclJvbGVzID0gW1xuICAgICAgICAgICAgICAgIFwiQVJDR0lTX05PVEVCT09LX1NFUlZFUlwiLFxuICAgICAgICAgICAgICAgIFwiQVJDR0lTX01JU1NJT05fU0VSVkVSXCIsXG4gICAgICAgICAgICAgICAgXCJBUkNHSVNfVklERU9fU0VSVkVSXCJcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBjb25zdCBzZXJ2ZXJGdW5jdGlvbnMgPSAoc2VydmVyLnNlcnZlckZ1bmN0aW9uICYmIHNlcnZlci5zZXJ2ZXJGdW5jdGlvbi5yZXBsYWNlKC9cXHMrL2csIFwiXCIpLnNwbGl0KFwiLFwiKSkgfHwgW107XG4gICAgICAgICAgICBjb25zdCBleGNsdWRlZFNlcnZlckZ1bmN0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICBcIk5PVEVCT09LU0VSVkVSXCIsXG4gICAgICAgICAgICAgICAgXCJXT1JLRkxPV01BTkFHRVJcIixcbiAgICAgICAgICAgICAgICBcIk1JU1NJT05TRVJWRVJcIixcbiAgICAgICAgICAgICAgICBcIlZJREVPU0VSVkVSXCJcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBsZXQgaXNIb3N0aW5nU2VydmVyID0gc2VydmVyUm9sZSA9PT0gXCJIT1NUSU5HX1NFUlZFUlwiO1xuICAgICAgICAgICAgLy8gb25seSBkaXNwbGF5IEdlb0FuYWx5dGljcyBzZXJ2ZXIgZm9yIEJERlNcbiAgICAgICAgICAgIGlmIChpc0JpZ0RhdGFGaWxlU2hhcmUgJiYgc2VydmVyRnVuY3Rpb25zLmluZGV4T2YoXCJHZW9BbmFseXRpY3NcIikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgZXhjbHVkZWRTZXJ2ZXJSb2xlcy5wdXNoKHNlcnZlclJvbGUpO1xuICAgICAgICAgICAgICAgIGlzSG9zdGluZ1NlcnZlciA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzTm9TUUwgJiYgc2VydmVyRnVuY3Rpb25zLmluZGV4T2YoXCJLbm93bGVkZ2VTZXJ2ZXJcIikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgZXhjbHVkZWRTZXJ2ZXJSb2xlcy5wdXNoKHNlcnZlclJvbGUpO1xuICAgICAgICAgICAgICAgIGlzSG9zdGluZ1NlcnZlciA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzTkZTICYmIGlzQXJjR0lTRW50ZXJwcmlzZU9uS3ViZXJuZXRlcygpKSB7XG4gICAgICAgICAgICAgICAgaXNIb3N0aW5nU2VydmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBhbGxvd2VkU2VydmVyUm9sZSA9IGV4Y2x1ZGVkU2VydmVyUm9sZXMuaW5kZXhPZihzZXJ2ZXJSb2xlKSA9PT0gLTE7XG4gICAgICAgICAgICAvLyBvbmx5IGRpc3BsYXkgaG9zdGluZyBzZXJ2ZXJzIGZvciBEYXRhYmFzZSB3aGVuIGNsaWVudCB0eXBlIGlzIGJpZ3F1ZXJ5LCBzbm93Zmxha2Ugb3IgcmVkc2hpZnRcbiAgICAgICAgICAgIGlmIChpc0hvc3RpbmdTZXJ2ZXJPbmx5Rm9yRGF0YWJhc2UpIHtcbiAgICAgICAgICAgICAgICBhbGxvd2VkU2VydmVyUm9sZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIChpc0hvc3RpbmdTZXJ2ZXIgfHxcbiAgICAgICAgICAgICAgICAoYWxsb3dlZFNlcnZlclJvbGUgJiZcbiAgICAgICAgICAgICAgICAgICAgKCFzZXJ2ZXJGdW5jdGlvbnMubGVuZ3RoIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2ZXJGdW5jdGlvbnMuc29tZShmdW5jdGlvbiAoZnVuYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBleGNsdWRlZFNlcnZlckZ1bmN0aW9ucy5pbmRleE9mKGZ1bmMudG9VcHBlckNhc2UoKSkgPT09IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZW5kZXJUYWJsZSgpIHtcbiAgICAgICAgY29uc3QgZGF0YVN0b3JlVHlwZSA9IHRoaXMuZGF0YVN0b3JlVHlwZTtcbiAgICAgICAgY29uc3QgaXNCaWdEYXRhRmlsZVNoYXJlID0gZGF0YVN0b3JlVHlwZSA9PT0gXCJiZGZzXCI7XG4gICAgICAgIGNvbnN0IGlzTm9TUUwgPSBkYXRhU3RvcmVUeXBlID09PSBcIm5vc3FsXCI7XG4gICAgICAgIGNvbnN0IGlzTkZTID0gYWRkSXRlbVN0YXRlLnNlcnZlckZvbGRlclBhdGggPT09IFwibmZzSG9zdEFuZFBhdGhcIiAmJiBkYXRhU3RvcmVUeXBlID09PSBcImZvbGRlclwiO1xuICAgICAgICAvLyBmaWx0ZXIgc2VydmVycyBhbmQgb25seSBkaXNwbGF5IGhvc3Rpbmcgc2VydmVycyBmb3IgZGF0YWJhc2U6IGJpZ3F1ZXJ5LCBzbm93Zmxha2Ugb3IgcmVkc2hpZnRcbiAgICAgICAgY29uc3QgaXNIb3N0aW5nU2VydmVyT25seUZvckRhdGFiYXNlID0gdGhpcy5jaGVja0RhdGFiYXNlQ2xpZW50KCk7XG4gICAgICAgIC8vIGZpbHRlciBzZXJ2ZXJzIGZvciBiZGZzXG4gICAgICAgIHRoaXMuc2VydmVyTGlzdCA9IHRoaXMuZmlsdGVyU2VydmVycyhpc0JpZ0RhdGFGaWxlU2hhcmUsIGlzTm9TUUwsIGlzSG9zdGluZ1NlcnZlck9ubHlGb3JEYXRhYmFzZSwgaXNORlMpO1xuICAgICAgICAvLyBmaWx0ZXIgc2VydmVycyBieSB1c2VycyBpbnB1dCBzZXJ2ZXIgcGF0aCAtIG9ubHkgZm9yIGZvbGRlciAmIGZpbGUgc2hhcmVcbiAgICAgICAgaWYgKCFpc05GUykge1xuICAgICAgICAgICAgaWYgKFtcImZvbGRlclwiLCBcImZpbGVzaGFyZVwiXS5pbmNsdWRlcyhkYXRhU3RvcmVUeXBlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VydmVyTGlzdCA9IHRoaXMuZmlsdGVyU2VydmVyc0J5U2VydmVyUGF0aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNoZWNrRGF0YWJhc2VDbGllbnQoKSB7XG4gICAgICAgIGNvbnN0IGRhdGFTdG9yZVR5cGUgPSB0aGlzLmRhdGFTdG9yZVR5cGU7XG4gICAgICAgIGNvbnN0IHB1Ymxpc2hlckNvbm5lY3Rpb25TdHJpbmcgPSBhZGRJdGVtU3RhdGUucHVibGlzaGVyQ29ubmVjdGlvblN0cmluZztcbiAgICAgICAgbGV0IGlzSG9zdGluZ1NlcnZlck9ubHkgPSBmYWxzZTtcbiAgICAgICAgaWYgKGRhdGFTdG9yZVR5cGUgPT09IFwiZGF0YWJhc2VcIiAmJiBwdWJsaXNoZXJDb25uZWN0aW9uU3RyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCBkYkNvbm5lY3Rpb25TdHJpbmdBcnJheSA9IHB1Ymxpc2hlckNvbm5lY3Rpb25TdHJpbmcuc3BsaXQoXCI7XCIpO1xuICAgICAgICAgICAgZGJDb25uZWN0aW9uU3RyaW5nQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoa2V5d29yZCkge1xuICAgICAgICAgICAgICAgIC8vIFwiREJDTElFTlQ9YmlncXVlcnlcIlxuICAgICAgICAgICAgICAgIGlmIChrZXl3b3JkLmluZGV4T2YoXCJEQkNMSUVOVFwiKSA+IC0xICYmXG4gICAgICAgICAgICAgICAgICAgIFtcImJpZ3F1ZXJ5XCIsIFwic25vd2ZsYWtlXCIsIFwicmVkc2hpZnRcIl0uaW5kZXhPZihrZXl3b3JkLnNwbGl0KFwiPVwiKVsxXSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICBpc0hvc3RpbmdTZXJ2ZXJPbmx5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNIb3N0aW5nU2VydmVyT25seTtcbiAgICB9XG4gICAgZmlsdGVyU2VydmVyc0J5U2VydmVyUGF0aCgpIHtcbiAgICAgICAgY29uc3QgZGF0YVN0b3JlVHlwZSA9IGFkZEl0ZW1TdGF0ZS5hZGREYXRhU3RvcmVUeXBlO1xuICAgICAgICBjb25zdCBzZXJ2ZXJQYXRoID0gZGF0YVN0b3JlVHlwZSA9PT0gXCJmb2xkZXJcIlxuICAgICAgICAgICAgPyBhZGRJdGVtU3RhdGUubmV3U2VydmVyRm9sZGVyUGF0aCB8fCBhZGRJdGVtU3RhdGUucHVibGlzaGVyRm9sZGVyUGF0aFxuICAgICAgICAgICAgOiBhZGRJdGVtU3RhdGUucHVibGlzaGVyRmlsZVNoYXJlRm9sZGVyUGF0aDtcbiAgICAgICAgY29uc3Qgc2VydmVyUGF0aFR5cGUgPSBzZXJ2ZXJQYXRoWzBdLmluZGV4T2YoXCIvXCIpID4gLTEgPyBcIkxpbnV4XCIgOiBcIldpbmRvd3NcIjtcbiAgICAgICAgY29uc3QgaXNORlMgPSBhZGRJdGVtU3RhdGUuc2VydmVyRm9sZGVyUGF0aCA9PT0gXCJuZnNIb3N0QW5kUGF0aFwiICYmIGRhdGFTdG9yZVR5cGUgPT09IFwiZm9sZGVyXCI7XG4gICAgICAgIHJldHVybiB0aGlzLnNlcnZlckxpc3QuZmlsdGVyKChmZWRlcmF0ZWRTZXJ2ZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAhIXRoaXMuc2VydmVyVHlwZXMuZmluZCgoc2VydmVySXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoKHNlcnZlckl0ZW0ubmFtZSA9PT0gZmVkZXJhdGVkU2VydmVyLmFkbWluVXJsIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlcnZlckl0ZW0ubmFtZSA9PT0gYCR7ZmVkZXJhdGVkU2VydmVyLmFkbWluVXJsfS9hZG1pbmApICYmXG4gICAgICAgICAgICAgICAgICAgIChpc05GUyA/IGZlZGVyYXRlZFNlcnZlci5pc0hvc3RlZCA6IHNlcnZlckl0ZW0udHlwZSA9PT0gc2VydmVyUGF0aFR5cGUpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXBwZW5kU2VydmVyVHlwZXMoKSB7XG4gICAgICAgIGNvbnN0IHsgc2VydmVyTGlzdCwgaTE4biB9ID0gdGhpcztcbiAgICAgICAgc2VydmVyTGlzdC5tYXAoKHNlcnZlcikgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2VydmVyRnVuY3Rpb24gPSAoc2VydmVyLnNlcnZlckZ1bmN0aW9uICYmIHNlcnZlci5zZXJ2ZXJGdW5jdGlvbi5yZXBsYWNlKC9cXHMrL2csIFwiXCIpLnNwbGl0KFwiLFwiKSkgfHwgW107XG4gICAgICAgICAgICBsZXQgc2VydmVyVHlwZSA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoc2VydmVyLnNlcnZlclJvbGUgPT09IFwiSE9TVElOR19TRVJWRVJcIikge1xuICAgICAgICAgICAgICAgIHNlcnZlclR5cGUgKz0gaTE4bi50eXBlcy5ob3N0ZWRTZXR0aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlcnZlckZ1bmN0aW9uLmluZGV4T2YoXCJOb3RlYm9va1NlcnZlclwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgc2VydmVyVHlwZSArPSAoc2VydmVyVHlwZSAmJiBcIiwgXCIpICsgaTE4bi50eXBlcy5ub3RlYm9va1NlcnZlclNldHRpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VydmVyRnVuY3Rpb24uaW5kZXhPZihcIkdlb0FuYWx5dGljc1wiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgc2VydmVyVHlwZSArPSAoc2VydmVyVHlwZSAmJiBcIiwgXCIpICsgaTE4bi50eXBlcy5nZW9BbmFseXRpY3NTZXJ2ZXJTZXR0aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlcnZlckZ1bmN0aW9uLmluZGV4T2YoXCJSYXN0ZXJBbmFseXRpY3NcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgIHNlcnZlclR5cGUgKz0gKHNlcnZlclR5cGUgJiYgXCIsIFwiKSArIGkxOG4udHlwZXMucmFzdGVyQW5hbHlzaXNTZXR0aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlcnZlckZ1bmN0aW9uLmluZGV4T2YoXCJJbWFnZUhvc3RpbmdcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgIHNlcnZlclR5cGUgKz0gKHNlcnZlclR5cGUgJiYgXCIsIFwiKSArIGkxOG4udHlwZXMuaW1hZ2VIb3N0aW5nU2V0dGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZXJ2ZXJGdW5jdGlvbi5pbmRleE9mKFwiTWlzc2lvblNlcnZlclwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgc2VydmVyVHlwZSArPSAoc2VydmVyVHlwZSAmJiBcIiwgXCIpICsgaTE4bi50eXBlcy5taXNzaW9uU2VydmVyU2V0dGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlcnZlci5zZXJ2ZXJUeXBlID0gc2VydmVyVHlwZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnZlcnRTdGF0dXNEaXNwbGF5VGV4dChzZXJ2ZXIpIHtcbiAgICAgICAgY29uc3QgaTE4biA9IHRoaXMuaTE4bjtcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gc2VydmVyLnNlcnZlclN0YXR1cztcbiAgICAgICAgY29uc3QgZGlzcGxheVRhYmxlID0ge1xuICAgICAgICAgICAgc3VjY2VzczogaTE4bi5zdGF0dXMuc3VjY2VzcyxcbiAgICAgICAgICAgIGZhaWx1cmU6IGkxOG4uc3RhdHVzLmZhaWx1cmUsXG4gICAgICAgICAgICBlcnJvcjogaTE4bi5zdGF0dXMuZXJyb3IsXG4gICAgICAgICAgICB2YWxpZGF0aW5nOiBpMThuLnN0YXR1cy52YWxpZGF0aW5nXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkaXNwbGF5VGFibGVbc3RhdHVzXTtcbiAgICB9XG4gICAgY2xvc2VNb2RhbCgpIHtcbiAgICAgICAgdGhpcy5vcGVuUmVxdWlyZVJlc3RhcnRNb2RhbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQoXCJkYXRhU3RvcmVTZWxlY3RGb2xkZXJcIik7XG4gICAgfVxuICAgIGFzeW5jIGFjY2VwdFJlcXVpcmVSZXN0YXJ0KCkge1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLm9wZW5SZXF1aXJlUmVzdGFydE1vZGFsID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXRlbS5hbGxvd1NlcnZpY2VzUmVzdGFydCA9IHRydWU7XG4gICAgICAgIHRoaXMucmVxdWlyZVJlc3RhcnQgPSB0cnVlO1xuICAgICAgICBjb25zdCB2YWxpZGF0ZWRTZXJ2ZXJzID0gYXdhaXQgdmFsaWRhdGVEYXRhc3RvcmVGb3JTZXJ2ZXJzKHRoaXMuaXRlbSwgdGhpcy5zZXJ2ZXJMaXN0LCB0aGlzLmRhdGFTdG9yZVR5cGUpO1xuICAgICAgICB0aGlzLnNlcnZlckxpc3QgPSBbLi4udmFsaWRhdGVkU2VydmVyc107XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoZWNrU2VydmVyc1R5cGUodGhpcy5zZXJ2ZXJMaXN0KTtcbiAgICAgICAgdGhpcy5zZXJ2ZXJMaXN0ID0gWy4uLnJlc3VsdC5zZXJ2ZXJzXTtcbiAgICAgICAgdGhpcy5zZXJ2ZXJUeXBlcyA9IFsuLi5yZXN1bHQuc2VydmVyVHlwZXNdO1xuICAgICAgICB0aGlzLnJlbmRlclRhYmxlKCk7XG4gICAgICAgIHRoaXMuYXBwZW5kU2VydmVyVHlwZXMoKTtcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgfVxuICAgIGNoZWNrVmFsaWRTZXJ2ZXJzKCkge1xuICAgICAgICB0aGlzLm5vVmFsaWRTZXJ2ZXJzID0gIXRoaXMuc2VydmVyTGlzdC5zb21lKChzZXJ2ZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBzZXJ2ZXIuc2VydmVyU3RhdHVzID09PSBcInN1Y2Nlc3NcIjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNoZWNrQWxsQm94ZXMoKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTZXJ2ZXJzID0gWy4uLltdXTtcbiAgICAgICAgaWYgKCF0aGlzLmFsbEJveGVzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VydmVyTGlzdC5mb3JFYWNoKChzZXJ2ZXIpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkU2VydmVycyA9IFsuLi50aGlzLnNlbGVjdGVkU2VydmVycywgc2VydmVyLmlkXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWxsQm94ZXNTZWxlY3RlZCA9ICF0aGlzLmFsbEJveGVzU2VsZWN0ZWQ7XG4gICAgfVxuICAgIGhhbmRsZU5leHQoKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkU2VydmVycyA9IHRoaXMuc2VsZWN0ZWRTZXJ2ZXJzIHx8IFtdO1xuICAgICAgICBpZiAoc2VsZWN0ZWRTZXJ2ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5lcnJvciA9IFwibm9TZXJ2ZXJTZWxlY3RlZFwiO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnJlcXVpcmVSZXN0YXJ0KSB7XG4gICAgICAgICAgICBhZGRJdGVtU3RhdGUuYWxsb3dTZXJ2aWNlc1Jlc3RhcnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGFkZEl0ZW1TdGF0ZS5kYXRhU3RvcmVTZWxlY3RlZFNlcnZlcnMgPSBzZWxlY3RlZFNlcnZlcnM7XG4gICAgICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UuZW1pdChcIml0ZW1Qcm9wZXJ0aWVzXCIpO1xuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgaTE4biwgZXJyb3IsIHNlcnZlckxpc3QsIGRhdGFTdG9yZVR5cGUsIGxvYWRpbmcsIGFsbEJveGVzU2VsZWN0ZWQsIG5vVmFsaWRTZXJ2ZXJzIH0gPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgbnVsbCwgaChcImFyY2dpcy1uZXctaXRlbS1kZXNjcmlwdGlvblwiLCB7IGhlYWRlcjogZGF0YVN0b3JlVHlwZSA9PT0gXCJiZGZzXCIgJiYgW1wiZmlsZXNoYXJlXCIsIFwiY2xvdWRcIl0uaW5jbHVkZXMoYWRkSXRlbVN0YXRlLmJkZnNUeXBlKVxuICAgICAgICAgICAgICAgID8gaTE4bi5kYXRhU3RvcmVTZXJ2ZXJTZWxlY3QuYmRmc0hlYWRpbmdcbiAgICAgICAgICAgICAgICA6IGkxOG4uZGF0YVN0b3JlU2VydmVyU2VsZWN0LmhlYWRpbmcgfSksIGgoXCJwXCIsIHsgY2xhc3M6IFwic3ViLWhlYWRpbmdcIiB9LCBpMThuLmRhdGFTdG9yZVNlcnZlclNlbGVjdC5zdWJIZWFkaW5nKSwgbG9hZGluZyA/IChoKFwiY2FsY2l0ZS1sb2FkZXJcIiwgeyBsYWJlbDogXCJzZXJ2ZXItbG9hZGVyXCIsIHRleHQ6IGkxOG4ubG9hZGVyLnZhbGlkYXRpbmcgfSkpIDogKGgoRnJhZ21lbnQsIG51bGwsIGgoXCJkaXZcIiwgeyBjbGFzczogXCJyb3ctd3JhcHBlclwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJoYWxmLXJvd1wiIH0sIGgoXCJjYWxjaXRlLWxhYmVsXCIsIHsgbGF5b3V0OiBcImlubGluZVwiIH0sIGgoXCJjYWxjaXRlLWNoZWNrYm94XCIsIHsgZGlzYWJsZWQ6IG5vVmFsaWRTZXJ2ZXJzLCBjaGVja2VkOiBhbGxCb3hlc1NlbGVjdGVkLCBvbkNhbGNpdGVDaGVja2JveENoYW5nZTogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tBbGxCb3hlcygpO1xuICAgICAgICAgICAgfSB9KSwgaTE4bi5saXN0LnRpdGxlKSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJoYWxmLXJvd1wiIH0sIGgoXCJjYWxjaXRlLWxhYmVsXCIsIHsgbGF5b3V0OiBcImlubGluZVwiIH0sIGkxOG4ubGlzdC5zdGF0dXMpKSksIHNlcnZlckxpc3QubWFwKChzZXJ2ZXIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAoaChcImRpdlwiLCB7IGNsYXNzOiBcInJvdy13cmFwcGVyIHJvdy1kaXZpZGVyXCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImhhbGYtcm93XCIgfSwgaChcImNhbGNpdGUtbGFiZWxcIiwgeyBsYXlvdXQ6IFwiaW5saW5lXCIsIGNsYXNzOiBcInNlcnZlci13cmFwcGVyXCIgfSwgaChcImNhbGNpdGUtY2hlY2tib3hcIiwgeyBkaXNhYmxlZDogc2VydmVyLnNlcnZlclN0YXR1cyAhPT0gXCJzdWNjZXNzXCIsIHZhbHVlOiBzZXJ2ZXIuaWQsIG9uQ2FsY2l0ZUNoZWNrYm94Q2hhbmdlOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZXJ2ZXJJZCA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFNlcnZlcnMuaW5kZXhPZihzZXJ2ZXJJZCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkU2VydmVycyA9IFsuLi50aGlzLnNlbGVjdGVkU2VydmVycywgc2VydmVySWRdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFNlcnZlcnMgPSB0aGlzLnNlbGVjdGVkU2VydmVycy5maWx0ZXIoKHNlcnZlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2ZXIgIT09IHNlcnZlcklkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBjaGVja2VkOiB0aGlzLnNlbGVjdGVkU2VydmVycy5pbmNsdWRlcyhzZXJ2ZXIuaWQpIH0pLCBzZXJ2ZXIudXJsICsgKHNlcnZlci5zZXJ2ZXJUeXBlICYmIGAgKCR7c2VydmVyLnNlcnZlclR5cGV9KWApKSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJoYWxmLXJvd1wiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczogXCJzdGF0dXMtd3JhcHBlclwiLCB0aXRsZTogc2VydmVyLmVycm9yTXNnIHx8IHNlcnZlci5zZXJ2ZXJTdGF0dXMgfSwgaChcImNhbGNpdGUtaWNvblwiLCB7IGNsYXNzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHNlcnZlci5zZXJ2ZXJTdGF0dXMgPT09IFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgICBmYWlsdXJlOiBzZXJ2ZXIuc2VydmVyU3RhdHVzID09PSBcImZhaWx1cmVcIixcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHNlcnZlci5zZXJ2ZXJTdGF0dXMgPT09IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGluZzogc2VydmVyLnNlcnZlclN0YXR1cyA9PT0gXCJ2YWxpZGF0aW5nXCJcbiAgICAgICAgICAgICAgICB9LCBzY2FsZTogXCJzXCIsIGljb246IHRoaXMuc2VydmVyU3RhdHVzSWNvbnNbc2VydmVyLnNlcnZlclN0YXR1c10gfSksIHRoaXMuY29udmVydFN0YXR1c0Rpc3BsYXlUZXh0KHNlcnZlcikpKSkpO1xuICAgICAgICB9KSwgaChcImFyY2dpcy1uZXctaXRlbS1hbGVydFwiLCB7IGhlYWRpbmc6IGkxOG4uZGF0YVN0b3JlU2VydmVyU2VsZWN0Lm5vU2VydmVyU2VsZWN0ZWQuaGVhZGluZywgZGVzY3JpcHRpb246IGkxOG4uZGF0YVN0b3JlU2VydmVyU2VsZWN0Lm5vU2VydmVyU2VsZWN0ZWQuZGVzY3JpcHRpb24sIGFjdGl2ZTogZXJyb3IgIT09IG51bGwgJiYgIWxvYWRpbmcsIG9uQWxlcnREaXNtaXNzOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICAgICAgICB9IH0pKSksIGgoXCJjYWxjaXRlLW1vZGFsXCIsIHsgb3BlbjogdGhpcy5vcGVuUmVxdWlyZVJlc3RhcnRNb2RhbCwgY2xhc3M6IFwicmVxdWlyZVJlc3RhcnRNb2RhbFwiLCBvbkNhbGNpdGVNb2RhbENsb3NlOiAoZSkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSB9LCBoKFwiZGl2XCIsIHsgc2xvdDogXCJjb250ZW50XCIgfSwgXCJZb3UgYXJlIHJlZ2lzdGVyaW5nIGEgZm9sZGVyIGRhdGEgc3RvcmUgdGhhdCB1c2VzIGEgbmV3IHBhdGggYW5kIGhvc3QgdGhhdCBoYXMgbm90IGJlZW4gcmVnaXN0ZXJlZCB3aXRoIEFyY0dJUyBFbnRlcnByaXNlLiBUaGlzIHdpbGwgY2F1c2Ugc2V2ZXJhbCBvZiB5b3VyIHN5c3RlbSBhbmQgdXRpbGl0eSBzZXJ2aWNlcyB0byByZXN0YXJ0LiBUbyBhdm9pZCBkaXNydXB0aW9uLCBjb25zaWRlciByZWdpc3RlcmluZyBkdXJpbmcgb2ZmLXBlYWsgaG91cnMuXCIsIGgoXCJiclwiLCBudWxsKSwgaChcImJyXCIsIG51bGwpLCBcIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBwcm9jZWVkXCIpLCBoKFwiY2FsY2l0ZS1idXR0b25cIiwgeyBzbG90OiBcInNlY29uZGFyeVwiLCBhcHBlYXJhbmNlOiBcIm91dGxpbmVcIiwgb25DbGljazogKCkgPT4gdGhpcy5jbG9zZU1vZGFsKCkgfSwgXCJDYW5jZWxcIiksIGgoXCJjYWxjaXRlLWJ1dHRvblwiLCB7IHNsb3Q6IFwicHJpbWFyeVwiLCBvbkNsaWNrOiAoKSA9PiB0aGlzLmFjY2VwdFJlcXVpcmVSZXN0YXJ0KCkgfSwgXCJPS1wiKSkpKTtcbiAgICB9XG4gICAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICAgICAgXCJzZXJ2ZXJMaXN0XCI6IFtcImNoZWNrVmFsaWRTZXJ2ZXJzXCJdXG4gICAgfTsgfVxufTtcbkFyY2dpc05ld0l0ZW1QYWdlc0RhdGFTdG9yZVNlbGVjdFNlcnZlckxpc3Quc3R5bGUgPSBhcmNnaXNOZXdJdGVtUGFnZXNEYXRhU3RvcmVTZWxlY3RTZXJ2ZXJMaXN0Q3NzO1xuXG5leHBvcnQgeyBBcmNnaXNOZXdJdGVtUGFnZXNEYXRhU3RvcmVTZWxlY3RTZXJ2ZXJMaXN0IGFzIGFyY2dpc19uZXdfaXRlbV9wYWdlc19kYXRhX3N0b3JlX3NlbGVjdF9zZXJ2ZXJfbGlzdCB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcmNnaXMtbmV3LWl0ZW0tcGFnZXMtZGF0YS1zdG9yZS1zZWxlY3Qtc2VydmVyLWxpc3QuZW50cnkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9