/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-b3cd57.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-b3cd57"],{50727:(e,i,t)=>{t.r(i),t.d(i,{arcgis_smart_mapping_age:()=>b,arcgis_smart_mapping_classify:()=>z,arcgis_smart_mapping_divided_by:()=>x,arcgis_smart_mapping_info_popover:()=>I,arcgis_smart_mapping_panels_size:()=>C,arcgis_smart_mapping_size_range_slider:()=>N,arcgis_smart_mapping_size_slider:()=>k,arcgis_smart_mapping_tile:()=>M});var s=t(81149),a=t(9225),l=t(95129),n=t(5996),o=(t(69283),t(49306),t(25902)),r=t(98371),d=t(80046),h=t(36238),c=t(41267),u=t(89),p=t(67214),m=t(70490),g=t(51837),f=t(70616),S=t(86478),v=t(69135),y=t(63723);t(82218),t(42577),t(70464),t(10519),t(81555),t(7659);const b=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingAgeChange=(0,s.c)(this,"arcgisSmartMappingAgeChange",7),this.arcgisSmartMappingAgeError=(0,s.c)(this,"arcgisSmartMappingAgeError",7),this.rendererSubtype=void 0}componentWillLoad(){const{layer:e,fields:i}=a.s,t=(0,a.h)(e),s="color"===this.rendererSubtype?(0,a.p)(t,"color"):(0,a.p)(t,"size"),l=i.filter((e=>e.simpleFieldType===a.w.DATE&&e.layerField.name===s.field));this.restDateFields=i.filter((e=>e.simpleFieldType===a.w.DATE&&e!==l[0])),this.flowItemNode=(0,a.F)(this.hostElement,"calcite-flow-item")}render(){return(0,s.h)(s.H,null,this.renderFrom(),this.renderTo(),this.renderUnits())}renderFrom(){const{layer:e,strings:i}=a.s,t=(0,a.h)(e),l="color"===this.rendererSubtype?(0,a.p)(t,"color"):(0,a.p)(t,"size"),{field:n,startTime:o}=l;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,i.age.from),(0,s.h)("div",{class:"from-field"},n===o?this.rendererStaticField():this.rendererAgeField()))}renderTo(){const{layer:e,strings:i}=a.s,t=(0,a.h)(e),l="color"===this.rendererSubtype?(0,a.p)(t,"color"):(0,a.p)(t,"size"),{field:n,endTime:o}=l;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,(0,s.h)("div",{class:"to-flip-wrapper"},(0,s.h)("div",{class:"to-label"},i.age.to),(0,s.h)("arcgis-smart-mapping-action",{hasOutline:!1,text:i.age.flip,icon:"arrowUpDown",onClick:()=>this.handleFlip()}))),(0,s.h)("div",{class:"to-field"},n===o?this.rendererStaticField():this.rendererAgeField()))}rendererStaticField(){const{layer:e}=a.s,i=(0,a.h)(e),t="color"===this.rendererSubtype?(0,a.p)(i,"color"):(0,a.p)(i,"size"),l=(0,a.u)(t.field);return(0,s.h)("div",{class:"field-select-fixed"},null==l?void 0:l.label)}rendererAgeField(){var e,i;const{strings:t,layer:l}=a.s,n=(0,a.h)(l),o="color"===this.rendererSubtype?(0,a.p)(n,"color"):(0,a.p)(n,"size"),{field:r,startTime:d,endTime:h}=o,c=d===r?h:d,u="string"==typeof c,p=(null===(e=this.restDateFields[0])||void 0===e?void 0:e.layerField.alias)||(null===(i=this.restDateFields[0])||void 0===i?void 0:i.layerField.name);let m;return u&&(m={field:c,simpleFieldType:a.w.DATE}),(0,s.h)("div",null,this.restDateFields.length?(0,s.h)("calcite-radio-button-group",{class:"variable-field-radio",name:"variableType",onCalciteRadioButtonGroupChange:e=>{this.handleTypeChange(e.target.selectedItem.value)}},(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{key:u?`age-variable-radio-field-${Math.random()}`:void 0,checked:u,value:"field"}),t.age.field),(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{key:u?void 0:`age-variable-radio-date-${Math.random()}`,checked:!u,value:"date"}),t.age.customDate)):null,u?this.restDateFields.length>1?(0,s.h)("arcgis-smart-mapping-attribute-input",{fieldList:this.restDateFields,selectedField:m,mode:"simple",hideLabel:!0,popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const i=e.detail.field;this.createRendererUpdateCall(r===d?{endTime:i}:{startTime:i})}},ref:e=>{e&&(this.rendererAgeFieldNode=e)}}):(0,s.h)("div",{class:"field-select-fixed"},p):this.rendererAgeFieldDate())}renderUnits(){const{layer:e,strings:i}=a.s,t=(0,a.h)(e),l="color"===this.rendererSubtype?(0,a.p)(t,"color"):(0,a.p)(t,"size"),{units:n}=l;return(0,s.h)("calcite-label",{class:"units-label"},i.age.units,(0,s.h)("calcite-select",{class:"units-select",width:"full",label:i.age.units,onCalciteSelectChange:e=>this.handleUnitChange(e),value:n,ref:e=>this.unitsNode=e},(0,s.h)("calcite-option",{value:"seconds",label:i.age.seconds,selected:"seconds"===n}),(0,s.h)("calcite-option",{value:"minutes",label:i.age.minutes,selected:"minutes"===n}),(0,s.h)("calcite-option",{value:"hours",label:i.age.hours,selected:"hours"===n}),(0,s.h)("calcite-option",{value:"days",label:i.age.days,selected:"days"===n}),(0,s.h)("calcite-option",{value:"months",label:i.age.months,selected:"months"===n}),(0,s.h)("calcite-option",{value:"years",label:i.age.years,selected:"years"===n})))}rendererAgeFieldDate(){const{layer:e,mapView:i}=a.s,t=(0,a.h)(e),n="color"===this.rendererSubtype?(0,a.p)(t,"color"):(0,a.p)(t,"size"),{units:o,field:r,startTime:d,endTime:c}=n,u=d===r?c:d,p="string"==typeof u,m=p?void 0:(0,l.u)(u,i.timeZone),g=["seconds","minutes","hours"].indexOf(o)>-1,f=!p&&g?(0,l.b)(u,i.timeZone,"seconds"===o):void 0;return(0,s.h)(s.F,null,(0,s.h)("calcite-input-date-picker",{scale:"s",value:m,class:"variable-date-date",ref:e=>{e&&(this.datePickerNode=e)},onCalciteInputDatePickerChange:()=>this.handleDateChange()}),g?(0,s.h)("calcite-input-time-picker",{key:`${o}-${u}`,step:"seconds"===o?1:60,scale:"s",value:f,class:"variable-date-time",ref:e=>{e&&(this.timePickerNode=e)},onCalciteInputTimePickerChange:(0,h.d)((()=>this.handleTimeChange()),750)}):null)}createRendererUpdateCall(e){const{layer:i}=a.s,t=(0,a.g)();let h;h="color-age"===t?o.d:"size-age"===t?r.g:"color-age-size"===t?r.h:"color-size-age"===t?r.i:d.b,(0,n.r)(h(e,this.rendererSubtype),this.flowItemNode).then((e=>{(0,a.e)(e.renderer,i),(0,a.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingAgeChange.emit()}),(e=>{this.rendererAgeFieldNode&&(0,s.f)(this.rendererAgeFieldNode);const{layer:i,mapView:t}=a.s,n=(0,a.h)(i),o="color"===this.rendererSubtype?(0,a.p)(n,"color"):(0,a.p)(n,"size"),{units:r,field:d,startTime:h,endTime:c}=o,u=h===d?c:h,p="string"==typeof u,m=["seconds","minutes","hours"].indexOf(r)>-1,g=p?void 0:(0,l.u)(u,t.timeZone),f=!p&&m?(0,l.b)(u,t.timeZone,"seconds"===r):void 0;this.datePickerNode&&(this.datePickerNode.value=g),this.timePickerNode&&(this.timePickerNode.value=f),this.unitsNode.value=r,(0,s.f)(this.hostElement),this.arcgisSmartMappingAgeError.emit(e)}))}handleUnitChange(e){const i={units:e.target.selectedOption.value};this.createRendererUpdateCall(i)}handleTypeChange(e){const{layer:i}=a.s,t=(0,a.h)(i),s="color"===this.rendererSubtype?(0,a.p)(t,"color"):(0,a.p)(t,"size"),{field:l,startTime:n}=s,o="field"===e?this.restDateFields[0].layerField.name:(new Date).getTime();this.createRendererUpdateCall(l===n?{endTime:o}:{startTime:o})}handleDateChange(){var e;const{layer:i,mapView:t}=a.s,s=(0,a.h)(i),n="color"===this.rendererSubtype?(0,a.p)(s,"color"):(0,a.p)(s,"size"),o=this.datePickerNode.value;if(!o)return;const r=(null===(e=this.timePickerNode)||void 0===e?void 0:e.value)||"00:00:00",d=(0,l.d)(`${o}T${r}`,t.timeZone),{field:h,startTime:c}=n,u={};h===c?u.endTime=d:u.startTime=d,this.createRendererUpdateCall(u)}handleTimeChange(){const{layer:e,mapView:i}=a.s,t=(0,a.h)(e),s="color"===this.rendererSubtype?(0,a.p)(t,"color"):(0,a.p)(t,"size"),{field:n,startTime:o}=s;let r=this.timePickerNode.value;const d=this.datePickerNode.value,h=(0,l.d)(`${d}T${r}`,i.timeZone),c={};n===o?c.endTime=h:c.startTime=h,this.createRendererUpdateCall(c)}handleFlip(){const{layer:e}=a.s,i=(0,a.h)(e),t="color"===this.rendererSubtype?(0,a.p)(i,"color"):(0,a.p)(i,"size"),{startTime:s,endTime:l}=t,n={startTime:l,endTime:s};this.createRendererUpdateCall(n),this.createRendererUpdateCall(n)}get hostElement(){return(0,s.d)(this)}};b.style=".field-select-fixed{background-color:#f6f6f6;padding:6px 6px;justify-content:space-between;align-items:center;color:#333333;margin:0;transition:box-shadow 250ms ease-in-out;box-shadow:0 0 0 1px #e0e0e0;height:auto;line-height:1.25;overflow-wrap:anywhere}.variable-date-date{width:100%}.variable-date-time{width:100%;margin-top:5px}.variable-field-radio{display:flex;justify-content:space-between}.to-flip-wrapper{display:flex;justify-content:space-between}.to-label{display:flex;align-items:center;margin-top:10px}.units-label{margin-top:6px}.to-field{margin-top:-10px}.from-field{margin-top:-8px;margin-bottom:6px}.units-select{margin-bottom:10px}";const z=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingClassifyChange=(0,s.c)(this,"arcgisSmartMappingClassifyChange",7),this.arcgisSmartMappingClassifyError=(0,s.c)(this,"arcgisSmartMappingClassifyError",7),this.inputNodes=[],this.labelNodes=[],this.symbolNodes=[],this.popoversOpen=!1}componentWillLoad(){this.flowItemNode=(0,a.F)(this.hostElement,"calcite-flow-item")}render(){const{strings:e,layer:i,mapImageSublayer:t,supportsArcade:l}=a.s,n=(0,a.h)(i),o=(0,a.a)(n,"color"),r=(0,a.a)(n,"size"),d=o||r;return(0,s.h)("calcite-block-section",{class:"classify-block-section",text:e.classify.classifyData,open:!d,toggleDisplay:t&&!l?"button":"switch",ref:e=>{this.classifyBlockSectionNode=e,t&&!l||e.addEventListener("calciteBlockSectionToggle",(e=>{e.stopImmediatePropagation(),this.handleClassifyToggle(e)}))}},(0,s.h)("div",{class:"block-section-padding"},!d&&this.renderMethod(),!d&&this.renderClasses(),!d&&this.renderStdDev(),!d&&this.renderRoundClasses(),!d&&this.renderValues()))}renderMethod(){const{layer:e}=a.s,i=(0,a.h)(e),t=(0,a.g)();return(0,s.h)("arcgis-smart-mapping-method-button",{key:i.authoringInfo.classificationMethod,showStdDev:!0,onArcgisSmartMappingMethodButtonBeforeOpen:()=>(0,a.E)(),onArcgisSmartMappingMethodButtonChange:i=>{const l=i.target;this.precisionValue=null;const d=(0,a.h)(e);if("manual"===i.detail){const e=d.authoringInfo;"standard-deviation"===e.classificationMethod&&d.classBreakInfos.forEach(((e,i)=>{const t=i>0?"> ":"";e.label=`${t} ${e.minValue.toLocaleString()} - ${e.maxValue.toLocaleString()}`})),e.classificationMethod="manual",(0,a.ab)(),(0,s.f)(this.hostElement),setTimeout((()=>this.methodButtonNode.setFocus()),300)}else{const d="color"===t?o.e:r.k;(0,n.r)(d({classificationMethod:i.detail}),this.flowItemNode).then((i=>{(0,a.e)(i.renderer,e),(0,a.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingClassifyChange.emit(),setTimeout((()=>this.methodButtonNode.setFocus()),300)}),(e=>{(0,s.f)(l),this.arcgisSmartMappingClassifyError.emit(e)}))}},ref:e=>{e&&(this.methodButtonNode=e)}})}renderClasses(){const{strings:e,layer:i}=a.s,t=(0,a.h)(i),l=t.classBreakInfos.length;return"standard-deviation"===t.authoringInfo.classificationMethod?null:(0,s.h)("calcite-label",null,e.classify.classifyClasses,(0,s.h)("calcite-input-number",{tabindex:"0",value:`${l}`,min:1,max:10,step:1,scale:"s",onCalciteInputNumberInput:(0,h.d)((()=>{const e=parseInt(this.classesNode.value);e!==l&&(!e||e<this.classesNode.min||e>this.classesNode.max?this.classesChangeHandle=setTimeout((()=>this.handleClassesChange()),3e3):(clearTimeout(this.classesChangeHandle),this.handleClassesChange()))}),300),ref:e=>{e&&(this.classesNode=e)}}))}renderStdDev(){const{strings:e,layer:i}=a.s,t=(0,a.h)(i).authoringInfo,l=t.standardDeviationInterval||1;return"standard-deviation"!==t.classificationMethod?null:(0,s.h)("calcite-label",null,e.classify.classifyStdDevIntervals,(0,s.h)("calcite-select",{width:"full",tabindex:"0",role:"button",label:e.classify.classifyStdDevIntervals,onCalciteSelectChange:e=>this.handleStdDevChange(e),value:`${l}`,ref:e=>this.stdDevSelectNode=e},(0,s.h)("calcite-option",{value:"0.5",label:"0.5",selected:.5===l}),(0,s.h)("calcite-option",{value:"1",label:"1",selected:1===l})))}renderRoundClasses(){var e;const{strings:i,layer:t,locale:l}=a.s;if("standard-deviation"===(0,a.h)(t).authoringInfo.classificationMethod)return null;const n=(0,c.a)(),o=(0,s.h)("calcite-option",{value:"select",label:i.classify.selectAnOption});this.precisionValue||(this.precisionValue=null===(e=n.toString().split(".")[1])||void 0===e?void 0:e.length);const r=(0,c.b)(this.precisionValue).map((e=>(0,s.h)("calcite-option",{value:`${e}`,label:`${e.toLocaleString(l,{maximumSignificantDigits:15})}`,disabled:n>=e,selected:n===e})));return(0,s.h)("calcite-label",null,i.classify.classifyRoundClasses,(0,s.h)("calcite-select",{width:"full",label:i.classify.classifyRoundClasses,onCalciteSelectChange:e=>this.handleRoundClassesChange(e)},[o,...r]))}renderValues(){const{layer:e}=a.s,i=(0,a.h)(e);return this.labelNodes=[],this.inputNodes=[],(0,s.h)("calcite-list",null,i.classBreakInfos.map(((e,i)=>this.renderValue(e,i))).reverse())}renderValue(e,i){return(0,s.h)("calcite-list-item",null,(0,s.h)("div",{class:"symbol-container",slot:"actions-start"},this.renderSymbolNode(e,i)),this.renderTextNode(e,i))}renderSymbolNode(e,i){const{strings:t,layer:l}=a.s;let n=(0,a.h)(l).classBreakInfos[i].symbol.clone();const o={"symbol-is-white":(0,a.aq)(n),symbol:!0};return(0,s.h)("div",{class:o,tabindex:"0","aria-label":t.classify.accessibility.editSymbolFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&this.symbolNodes.unshift(e)},onClick:()=>{this.popoverNode?(this.symbolNodes[this.selectedPopoverIdx].classList.remove("selected"),this.selectedPopoverIdx===i?((0,a.E)(),this.popoverNode=null,this.selectedPopoverIdx=null):(this.selectedPopoverIdx=i,this.handleValueSymbolClick(i))):(this.selectedPopoverIdx=i,this.handleValueSymbolClick(i))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleValueSymbolClick(i))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateValueSymbol(e,i)}}))}renderTextNode(e,i){const{strings:t}=a.s;return(0,s.h)(s.F,null,(0,s.h)("div",{class:"label",slot:"content",tabindex:"0",ref:e=>{e&&this.labelNodes.unshift(e)},"aria-label":t.classify.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>this.handleLabelEdit(i,e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleLabelEdit(i,e)}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",tabindex:"0",ref:e=>{e&&this.inputNodes.unshift(e)},value:e.label,onCalciteInputChange:e=>{this.inputNodes[i].classList.add("hidden"),this.labelNodes[i].classList.remove("hidden"),this.handleValueTextChange(i,e)},onFocusout:e=>{this.inputNodes[i].classList.add("hidden"),this.labelNodes[i].classList.remove("hidden"),this.handleValueTextChange(i,e)},onKeyDown:t=>{if(t.stopPropagation(),"Escape"===t.key||"Enter"===t.key){this.inputNodes[i].classList.add("hidden");const s=t.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(i,t),this.labelNodes[i].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[i].focus()),300)}}}))}afterCreateValueSymbol(e,i){var t;const{layer:s,modules:l}=a.s;let n=(0,a.h)(s).classBreakInfos[i].symbol.clone();for(;null===(t=null==e?void 0:e.childNodes)||void 0===t?void 0:t.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:o}=l;n&&o.renderPreviewHTML(n,{size:(0,a.ar)(n),symbolConfig:"cim"===n.type&&"CIMPolygonSymbol"===n.data.symbol.type?{isSquareFill:!0}:void 0}).then((i=>null==e?void 0:e.appendChild(i)))}handleClassifyToggle(e){const{layer:i}=a.s,t=(0,a.g)(),l=e.currentTarget.open?"color"===t?o.e:r.k:"color"===t?o.b:r.f;(0,n.r)(l({}),this.flowItemNode).then((e=>{(0,a.e)(e.renderer,i),(0,a.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingClassifyChange.emit({closePopovers:!0,toggle:!0})}),(e=>{this.classifyBlockSectionNode.open=!this.classifyBlockSectionNode.open,this.arcgisSmartMappingClassifyError.emit(e)}))}handleClassesChange(){const{layer:e}=a.s,i=(0,a.g)(),t=Math.min(Math.max(parseInt(this.classesNode.value),1),10)||5;`${t}`!==this.classesNode.value&&(this.classesNode.value=`${t}`);const s="color"===i?o.e:r.k;(0,n.r)(s({numClasses:t}),this.flowItemNode).then((i=>{(0,a.e)(i.renderer,e),(0,a.ab)(),this.arcgisSmartMappingClassifyChange.emit({classesChange:!0})}),(i=>{const t=(0,a.h)(e);this.classesNode.value=`${t.classBreakInfos.length}`,this.arcgisSmartMappingClassifyError.emit(i)}))}handleStdDevChange(e){const i=e.currentTarget,{layer:t}=a.s,l="color"===(0,a.g)()?o.e:r.k;(0,n.r)(l({standardDeviationInterval:parseFloat(i.value)}),this.flowItemNode).then((e=>{(0,a.e)(e.renderer,t),(0,a.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingClassifyChange.emit()}),(e=>{const i=(0,a.h)(t).authoringInfo.standardDeviationInterval||1;this.stdDevSelectNode.value=`${i}`,(0,s.f)(this.hostElement),this.arcgisSmartMappingClassifyError.emit(e)}))}handleRoundClassesChange(e){const{layer:i}=a.s,t=(0,a.h)(i).authoringInfo,s=e.currentTarget;"select"!==s.value&&((0,c.u)(parseFloat(s.value)),t.classificationMethod="manual",(0,a.ab)(),this.arcgisSmartMappingClassifyChange.emit({closePopovers:!0}))}handleLabelEdit(e,i){let t=this.inputNodes[e];t.classList.remove("hidden"),t.setFocus(),i.target.classList.add("hidden")}handleValueSymbolClick(e){(0,a.E)();const{strings:i}=a.s,t=(0,u.c)({referenceElement:this.flowItemNode,heading:i.styler.symbolStyle});t.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,u.r)(t),setTimeout((()=>{this.symbolNodes[e].focus(),this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),t.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,u.r)(t),setTimeout((()=>{this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),a.s.classedSymbolSelectedIdx=e,(0,u.g)({popoverNode:t,onChange:()=>{(0,a.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingClassifyChange.emit({symbolChange:!0})}}),this.popoverNode=t,this.symbolNodes[e].classList.add("selected")}handleValueTextChange(e,i){const t=i.currentTarget,{layer:l}=a.s,n=(0,a.h)(l);if(n.classBreakInfos[e].label=t.value,this.labelNodes[e].textContent=t.value,this.inputNodes[e].value=t.value,""===t.value){const i=n.classBreakInfos[e],t=e>0?"> ":"";i.label=`${t} ${i.minValue.toLocaleString()} - ${i.maxValue.toLocaleString()}`,this.labelNodes[e].textContent=i.label,this.inputNodes[e].value=i.label}(0,a.ab)(),(0,s.f)(this.hostElement)}get hostElement(){return(0,s.d)(this)}};z.style=".classify-block-section{border-top:1px solid #e0e0e0;overflow-wrap:anywhere}.block-section-padding{padding-top:6px}.symbol-is-white{background-color:#f0f0f0}.hidden{display:none}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.label,.symbol-container{padding-top:5px;padding-bottom:5px}.selected{outline:1px solid var(--calcite-color-brand)}.method-button-content{padding-top:8px}";const x=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingDividedByChange=(0,s.c)(this,"arcgisSmartMappingDividedByChange",7),this.arcgisSmartMappingDividedByError=(0,s.c)(this,"arcgisSmartMappingDividedByError",7),this.rendererSubtype=void 0,this.normalizationField=void 0,this.fieldPos=void 0}componentWillLoad(){this.flowItemNode=(0,a.F)(this.hostElement,"calcite-flow-item")}render(){const{layer:e,fields:i,strings:t}=a.s,l=(0,a.h)(e),n=(0,a.g)(),o=l.authoringInfo,r=(0,a.a)(l,this.rendererSubtype),d="relationship"===n||"relationship"===this.rendererSubtype,h=d?0===this.fieldPos?o.field1.field:o.field2.field:r?r.field:l.field,c=d?0===this.fieldPos?o.field1.normalizationField:o.field2.normalizationField:r?r.normalizationField:l.normalizationField;return(0,s.h)("arcgis-smart-mapping-attribute-input",{fieldList:i.filter((e=>e.layerField.name!==h&&e.simpleFieldType===a.w.NUMBER)),popoverReferenceElement:this.flowItemNode,label:t.transparency.dividedBy,mode:"remove",selectedField:c?{field:c,simpleFieldType:a.w.NUMBER}:null,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const i=e.detail;this.normalize(i.field)}else this.normalize(null)}})}normalize(e){const{layer:i}=a.s,t=(0,a.h)(i),l=(0,a.g)(),d=t.authoringInfo,h="univariate-color-size"===(null==d?void 0:d.type),c="class-breaks-color"===(null==d?void 0:d.type),u="class-breaks-size"===(null==d?void 0:d.type),g="relationship"===l||"relationship"===this.rendererSubtype;let f;c?f=o.e:u?f=r.k:h?f=m.a:"color"===this.rendererSubtype?(f=o.b,["color-age","color-age-size"].indexOf(l)>-1&&(f=o.d)):"size"===this.rendererSubtype?(f=r.f,["size-age","color-size-age","type-size-age"].indexOf(l)>-1&&(f=r.g)):g&&(f=p.a);const S={};g?0===this.fieldPos?S.normalizationField1=e:S.normalizationField2=e:S.normalizationField=e,(0,n.r)(f(S,this.rendererSubtype),this.flowItemNode).then((e=>{if(h||c||u||g){if("relationship-size"===l){e.renderer.backgroundFillSymbol=t.backgroundFillSymbol;const i=(0,a.a)(t,"size"),s=(0,a.p)(t,"size");e.renderer.visualVariables=e.renderer.visualVariables||[],e.renderer.visualVariables.push(i),e.renderer.authoringInfo=e.renderer.authoringInfo||{},e.renderer.authoringInfo.visualVariables=e.renderer.authoringInfo.visualVariables||[],e.renderer.authoringInfo.visualVariables.push(s)}(0,a.e)(e.renderer,i)}else"color"===this.rendererSubtype?["color-size","color-age-size","color-size-age"].indexOf(l)>-1?this.switchOutVisualVariable(e):(0,a.e)(e.renderer,i):"size"===this.rendererSubtype&&(["color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size"].indexOf(l)>-1?this.switchOutVisualVariable(e):(0,a.e)(e.renderer,i));(0,a.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingDividedByChange.emit()}),(e=>this.arcgisSmartMappingDividedByError.emit(e)))}switchOutVisualVariable(e){const{layer:i}=a.s,t=(0,a.h)(i);t.visualVariables=(0,a.n)(t,this.rendererSubtype)||[];const s=(0,a.a)(e.renderer,this.rendererSubtype);t.visualVariables.push(s),t.authoringInfo.visualVariables=(0,a.o)(t,this.rendererSubtype)||[];const l=(0,a.p)(e.renderer,this.rendererSubtype);l&&t.authoringInfo.visualVariables.push(l),(0,a.Q)(t)}get hostElement(){return(0,s.d)(this)}},I=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingInfoPopoverClose=(0,s.c)(this,"arcgisSmartMappingInfoPopoverClose",7),this.arcgisSmartMappingInfoPopoverDisconnected=(0,s.c)(this,"arcgisSmartMappingInfoPopoverDisconnected",7),this.documentTabHandler=void 0,this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.onOpen=()=>{requestAnimationFrame((()=>{var e;return null===(e=this.panelNode)||void 0===e?void 0:e.setFocus()}))},this.props=void 0,this.referenceElement=void 0,this.open=!1}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}async setFocus(){var e;null===(e=this.panelNode)||void 0===e||e.setFocus()}async setOpen(e){var i;this.popoverNode&&(this.popoverNode.open=e,e&&(null===(i=this.panelNode)||void 0===i||i.setFocus(),this.popoverNode.reposition()))}disconnectedCallback(){this.arcgisSmartMappingInfoPopoverDisconnected.emit()}render(){const{props:e,referenceElement:i,open:t}=this,{title:l,moreInfo:n,helpId:o}=e,{config:r,strings:d}=a.s,{helpBase:h,helpMap:c}=r,u=d.tile.info.title.replace("${title}",l);return(0,s.h)(s.H,{class:"js-app-flyout arcgis-smart-mapping-popover"},(0,s.h)("calcite-popover",{open:t,placement:"auto",offsetSkidding:5,label:"",referenceElement:i,class:"info-popover",onCalcitePopoverOpen:this.onOpen,ref:e=>this.popoverNode=e},(0,s.h)("calcite-panel",{heading:u,closable:!0,ref:e=>this.panelNode=e,onCalcitePanelClose:()=>{this.arcgisSmartMappingInfoPopoverClose.emit(),setTimeout((()=>i.parentElement.focus()),300)}},(0,s.h)("div",{class:"info"},(0,s.h)("div",null,n),o&&c?(0,s.h)("div",{class:"info-help"},(0,s.h)("calcite-button",{appearance:"solid",label:d.tile.info.learnMore,class:"info-help-button",slot:"footer",onClick:()=>{window.open(`${h}${c[o]}`,"_blank")}},d.tile.info.learnMore)):null))))}get hostElement(){return(0,s.d)(this)}};I.style=".info{padding:10px;background-color:white}.info-popover{max-width:320px}.info-help{padding-top:10px;justify-content:flex-end;display:flex}.info-help-button{display:flex;flex-flow:row-reverse}";const C=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsSizeClose=(0,s.c)(this,"arcgisSmartMappingPanelsSizeClose",7),this.arcgisSmartMappingPanelsSizeBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsSizeBackClick",7),this.arcgisSmartMappingPanelsSizeError=(0,s.c)(this,"arcgisSmartMappingPanelsSizeError",7),this.rangeSliderWatchHandles=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsSizeClose.emit("save")},this.handleCancel=()=>{const{originalRenderer:e,originalFeatureReduction:i}=this;(0,a.j)(e,i),this.arcgisSmartMappingPanelsSizeClose.emit("cancel")},this.hideTransparency=!1,this.hideRotation=!1,this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0,this.visualizationOpen=!1}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){this.visualizationOpen=!0;const{layer:e,modules:i}=a.s,t=(0,a.h)(e);this.originalRenderer=t.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?i.esriLang.clone(e.featureReduction):void 0}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{layer:e,hideLayerTitle:i,isRTL:t,strings:l}=a.s;return(0,s.h)(s.H,{class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{heading:l.panels.styleOptions,description:i?void 0:e.title,class:{"flow-item":!0,[g.C.rtl]:t},closable:(0,a.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>{this.arcgisSmartMappingPanelsSizeBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderDoneButton(),this.renderCancelButton(),this.renderVisualization(),this.renderTransparency(),this.renderRotation()))}renderDoneButton(){const{layer:e,strings:i}=a.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:i.done,onClick:this.handleDone,appearance:"solid",width:"half"},i.done):null}renderCancelButton(){const{layer:e,strings:i}=a.s;return e?(0,s.h)("calcite-button",{slot:"footer",label:i.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},i.cancel):null}renderVisualization(){var e,i;const{visualizationOpen:t,hideTransparency:l,hideRotation:n}=this,{layer:o,strings:r}=a.s,d=(0,a.g)(),h=(0,a.h)(o),c=["size-age","color-size-age","type-size-age"].indexOf(d)>-1,u=["chart-size","predominance-size"].indexOf(d)>-1,p=(0,a.a)(h,"size"),m=p?p.field?null===(e=(0,a.u)(p.field))||void 0===e?void 0:e.label:p.valueExpressionTitle||r.expression:h.field?null===(i=(0,a.u)(h.field))||void 0===i?void 0:i.label:h.valueExpressionTitle||r.expression,g=(0,a.u)((null==p?void 0:p.field)||h.field),f=(null==g?void 0:g.simpleFieldType)===a.w.DATE,S="chart-size"===d;return(0,s.h)("calcite-block",{class:"size-block",key:"size-visualization",heading:c?r.panels.size.sizeAgeStyle:f?r.panels.size.sizeStyleDate:S?r.panels.size.sizeStyleChart:r.panels.size.sizeStyle,collapsible:!l||!n,open:t,onCalciteBlockOpen:()=>this.visualizationOpen=!0,onCalciteBlockClose:()=>this.visualizationOpen=!1},(0,s.h)("div",null,c||u?null:(0,s.h)("calcite-label",{class:"attribute-name"},m),this.renderAge(),this.renderTheme(),this.renderDividedBy(),this.renderSymbol(),this.renderSizeSlider(),this.renderSizeRange(),this.renderBackgroundStyle(),this.renderDefaultSymbol(),this.renderShowInLegend(),this.renderClassify()))}renderAge(){const e=(0,a.g)();return["size-age","color-size-age"].indexOf(e)>-1?(0,s.h)("arcgis-smart-mapping-age",{rendererSubtype:"size",onArcgisSmartMappingAgeChange:()=>this.sliderNode.updateStatistics(),onArcgisSmartMappingAgeError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)}):null}renderTheme(){const{layer:e}=a.s,i=(0,a.h)(e);if(!(0,a.a)(i,"size"))return null;const t=(0,a.g)();return["chart-size","predominance-size"].indexOf(t)>-1?null:(0,s.h)("arcgis-smart-mapping-theme-button",{ref:e=>this.themeButtonNode=e,rendererSubtype:"size",onArcgisSmartMappingThemeButtonBeforeOpen:()=>(0,a.E)(),onArcgisSmartMappingThemeButtonChange:i=>{const l=(0,a.h)(e);let o=r.f;["size-age","color-size-age"].indexOf(t)>-1&&(o=r.g),(0,n.r)(o({theme:i.detail,discardMinMax:!0}),this.flowItemNode).then((e=>{l.visualVariables=(0,a.n)(l,"size")||[],l.visualVariables.push((0,a.a)(e.renderer,"size")),l.authoringInfo.visualVariables=(0,a.o)(l,"size")||[],l.authoringInfo.visualVariables.push((0,a.p)(e.renderer,"size")),(0,a.ab)(),(0,s.f)(this.hostElement),this.themeButtonNode&&(0,s.f)(this.themeButtonNode),this.sliderNode&&((0,s.f)(this.sliderNode),this.sliderNode.updateStatistics())}),(e=>{(0,s.f)(this.themeButtonNode),this.arcgisSmartMappingPanelsSizeError.emit(e)}))}})}renderDividedBy(){const{layer:e,fields:i}=a.s,t=(0,a.h)(e),l=(0,a.g)();if(["size-age","color-size-age"].indexOf(l)>-1)return null;if((0,a.I)(i).number<2)return null;const n=(0,a.a)(t,"size");if(n){const e=(0,a.u)(n.field),i={field:n.field,expression:n.valueExpression,expressionTitle:n.valueExpressionTitle,simpleFieldType:e?e.simpleFieldType:a.w.NUMBER};if(i.expression||i.simpleFieldType!==a.w.NUMBER)return null}return(0,s.h)("arcgis-smart-mapping-divided-by",{rendererSubtype:"size",normalizationField:n?n.normalizationField:t.normalizationField,onArcgisSmartMappingDividedByChange:()=>{(0,s.f)(this.hostElement),this.sliderNode.updateStatistics(),this.classifyNode&&(0,s.f)(this.classifyNode)},onArcgisSmartMappingDividedByError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)})}renderSymbol(){const{layer:e}=a.s;if("pie-chart"===(0,a.h)(e).type)return null;const i=this.getSymbol();return(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:i,type:"size",ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode),this.classifyNode&&(0,s.f)(this.classifyNode),this.rotationNode&&(0,s.f)(this.rotationNode)}})}renderSizeSlider(){return(0,s.h)("arcgis-smart-mapping-size-slider",{ref:e=>{e&&(this.sliderNode=e)},onArcgisSmartMappingSizeSliderChange:()=>{(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode),this.classifyNode&&(0,s.f)(this.classifyNode)},onArcgisSmartMappingSizeSliderError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)})}renderSizeRange(){return(0,s.h)("arcgis-smart-mapping-size-range-slider",{onArcgisSmartMappingSizeRangeSliderError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)})}renderBackgroundStyle(){const{mapImageSublayer:e}=a.s,i=(0,a.g)();return e&&["predominance-size","type-size","relationship-size"].indexOf(i)>-1?null:(0,s.h)("arcgis-smart-mapping-background-symbol",null)}renderDefaultSymbol(){const e=(0,a.g)();return["chart","chart-size"].indexOf(e)>-1?null:(0,s.h)("arcgis-smart-mapping-default-symbol",{ref:e=>{e&&(this.defaultSymbolNode=e)},onArcgisSmartMappingDefaultSymbolBeforeToggle:()=>(0,a.E)(),onArcgisSmartMappingDefaultSymbolChange:()=>(0,s.f)(this.symbolButtonNode)})}renderShowInLegend(){const{layer:e,strings:i}=a.s,t=(0,a.h)(e),l=(0,a.a)(t,"size");if(!l)return null;const n=l.legendOptions,o=!n||!1!==n.showLegend;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"legend-toggle-padding"},i.panels.size.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:o,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderClassify(){const e=(0,a.g)(),i=this.getFieldInfo().simpleFieldType===a.w.DATE,t=["size-age","color-size-age","type-size-age"].indexOf(e)>-1;return"size"!==e||i||t?null:(0,s.h)("arcgis-smart-mapping-classify",{ref:e=>this.classifyNode=e,onArcgisSmartMappingClassifyChange:e=>{const i=e.detail;((null==i?void 0:i.closePopovers)||(null==i?void 0:i.classesChange))&&(0,a.E)(),(0,s.f)(this.hostElement),this.sliderNode&&(0,s.f)(this.sliderNode),((null==i?void 0:i.toggle)||!(null==i?void 0:i.symbolChange)&&!(null==i?void 0:i.closePopovers))&&this.sliderNode.updateStatistics(),this.classifyNode&&(0,s.f)(this.classifyNode),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode),this.defaultSymbolNode&&(0,s.f)(this.defaultSymbolNode)},onArcgisSmartMappingClassifyError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)})}renderTransparency(){const{hideTransparency:e}=this;if(e)return;const{layer:i}=a.s,t=(0,a.h)(i),l=(0,a.a)(t,"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!l,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsSizeError.emit(e)})}renderRotation(){const{hideRotation:e}=this;if(e)return;const{layer:i}=a.s,t=(0,a.h)(i),l=(0,a.a)(t,"opacity"),n=(0,a.a)(t,"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!l&&!!n,ref:e=>this.rotationNode=e,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsSizeError.emit(e)})}getSymbol(){const{layer:e,mapView:i,modules:t}=a.s,s=((0,a.h)(e).type,(0,a.h)(e)),l="class-breaks"===(0,a.h)(e).type?s.classBreakInfos:s.uniqueValueInfos,n=(0,a.g)();let o;return["color-size","color-age-size","color-size-age","type-size","type-size-age","predominance-size","relationship-size"].indexOf(n)>-1?(o=l.length?l[0].symbol.clone():(0,a.S)(e,i,n),(0,a.r)(o,new t.esriColor({r:149,g:149,b:149,a:1}))):o=l.length?l[l.length-1].symbol.clone():(0,a.S)(e,i,n),o}handleIncludeInLegendToggle(){const{layer:e}=a.s,i=(0,a.h)(e),t=(0,a.a)(i,"size"),s=t.legendOptions;s&&!1===s.showLegend?s.title?s.showLegend=!0:t.legendOptions=void 0:(t.legendOptions=s||{},t.legendOptions.showLegend=!1),(0,a.ab)()}getFieldInfo(){const{layer:e}=a.s,i=(0,a.g)(),t=(0,a.f)(e);return["color-size","color-age-size","color-size-age","type-size","type-size-age"].indexOf(i)>-1&&t.length>1?t[1]:"relationship-size"===i?t[2]:t[0]}get hostElement(){return(0,s.d)(this)}};C.style=":host{width:100%}.flow-item{height:100%}.size-block{overflow-x:hidden}.attribute-name{word-break:break-all}.legend-toggle-padding{padding-top:12px;padding-bottom:12px}";const N=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSizeRangeSliderError=(0,s.c)(this,"arcgisSmartMappingSizeRangeSliderError",7),this.rangeSliderWatchHandles=[]}componentDidLoad(){const{config:e}=a.s;this.hostElement.shadowRoot.firstElementChild.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${e.jsapiUrl}/themes/light/main.css" />`),this.flowItemNode=(0,a.F)(this.hostElement,"calcite-flow-item")}render(){const{layer:e,mapImageSublayer:i,modules:t,strings:l}=a.s,n=(0,a.h)(e),o=n.authoringInfo,r=(0,a.a)(n,"size"),d="above-and-below"===(null==o?void 0:o.univariateTheme),h=!!r&&!(0,a.ac)(r.minSize),c=!!r&&"number"==typeof r.minSize,p=!h&&!c;let[m,g]=(0,u.h)();if([m,g]=[Math.round(m/.75),Math.round(g/.75)],m>g&&([m,g]=[g,m]),this.rangeSliderNode){if(m!==this.rangeSliderNode.values[0]||g!==this.rangeSliderNode.values[1]||!(0,a.ac)(this.rangeSliderNode.values[1])){const e={min:Math.max(1,Math.min(1,m-10)),max:Math.min(g+10,100),values:[m,g]};this.rangeSliderNode.set(e)}}else{const e={min:Math.max(1,Math.min(1,m-10)),max:Math.min(g+10,100),values:[m,g],visibleElements:{labels:!0},precision:0,labelInputsEnabled:!0,labelFormatFunction:e=>e.toFixed(0)};this.rangeSliderNode=new t.Slider(e)}return(0,s.h)(s.H,null,(0,s.h)("div",{class:"size-range-block"},(0,s.h)("calcite-label",null,l.sizeRangeSlider.sizeRange),(0,s.h)("div",{class:"range-slider range-slider-bottom-label",ref:e=>{e&&this.afterSizeRangeCreate(e)}}),(0,s.h)("div",{dir:"ltr",class:"size-range"},(0,s.h)("div",{class:"size-range-item"},(0,s.h)("calcite-input-number",{value:`${m}`,min:1,max:100,step:1,scale:"s",suffixText:l.sizeRangeSlider.px,ref:e=>{e&&(this.minRangeNode=e)},onCalciteInputNumberInput:()=>{var e;const i=null===(e=this.rangeSliderNode)||void 0===e?void 0:e.values,t=parseInt(this.minRangeNode.value);if(this.minRangeNode.value&&t>0&&t<i[1]){clearTimeout(this.minWatchHandle);const e=Math.min(t,100);this.minRangeNode.value=`${e}`;const s=[.75*e,.75*i[1]];this.rangeSliderNode.values=[parseInt(this.minRangeNode.value),i[1]],this.handleSizeRangeValuesChange(s)}else this.minWatchHandle=setTimeout((()=>{var e;const i=null===(e=this.rangeSliderNode)||void 0===e?void 0:e.values;this.minRangeNode.value=`${i[0]}`;const t=[.75*i[0],.75*i[1]];this.handleSizeRangeValuesChange(t)}),3e3)},label:l.sizeRangeSlider.min})),(0,s.h)("div",{class:"size-range-item"},(0,s.h)("calcite-input-number",{value:`${g}`,min:1,max:100,step:1,scale:"s",suffixText:l.sizeRangeSlider.px,ref:e=>{e&&(this.maxRangeNode=e)},onCalciteInputNumberInput:()=>{var e;const i=null===(e=this.rangeSliderNode)||void 0===e?void 0:e.values,t=parseInt(this.maxRangeNode.value);if(this.maxRangeNode.value&&t>i[0]&&t<101){clearTimeout(this.maxWatchHandle);const e=Math.min(t,100);this.maxRangeNode.value=`${e}`;const s=[.75*i[0],.75*e];this.rangeSliderNode.values=[i[0],parseInt(this.maxRangeNode.value)],this.handleSizeRangeValuesChange(s)}else this.maxWatchHandle=setTimeout((()=>{var e;const i=null===(e=this.rangeSliderNode)||void 0===e?void 0:e.values;this.maxRangeNode.value=`${i[1]}`;const t=[.75*i[0],.75*i[1]];this.handleSizeRangeValuesChange(t)}),3e3)},label:l.sizeRangeSlider.min}))),r&&!d&&!i&&(0,s.h)("calcite-label",{scale:"s",layout:"inline",class:"size-range-bottom-border"},(0,s.h)("calcite-checkbox",{scale:"s",checked:p,onCalciteCheckboxChange:e=>this.handleSizeRangeChange(e.target.checked?"automatic":"fixed"),ref:e=>this.adjustSizeNode=e}),l.sizeRangeSlider.adjustSizeAutomatically)))}handleSizeRangeValuesChange(e){const{layer:i}=a.s,t=(0,a.h)(i),s=(0,a.a)(t,"size"),l=t.classBreakInfos,n=s?s.minSize/.75:l[0].symbol.size/.75,o=s?s.maxSize/.75:l[l.length-1].symbol.size/.75,r=e[0]/.75,d=e[1]/.75;n===r&&o===d||((0,u.s)(e),this.maxRangeNode.min=r+this.maxRangeNode.step,this.minRangeNode.max=d-this.minRangeNode.step,(0,a.ab)())}afterSizeRangeCreate(e){if(!this.rangeSliderNode.container){const i=document.createElement("div");e.append(i),this.rangeSliderNode.container=i,this.createRangeSliderChangeEvents()}}createRangeSliderChangeEvents(){const{mapView:e}=a.s;this.rangeSliderNode&&(this.rangeSliderNode.on("thumb-change",(e=>{var i;const t=null===(i=this.rangeSliderNode)||void 0===i?void 0:i.values;0===e.index?t[0]>=t[1]&&(t[0]=e.oldValue):1===e.index&&t[1]<=t[0]&&(t[1]=e.oldValue),this.minRangeNode.value=`${t[0]}`,this.maxRangeNode.value=`${t[1]}`;const s=[.75*t[0],.75*t[1]];this.handleSizeRangeValuesChange(s)})),this.rangeSliderNode.on("thumb-drag",(e=>{var i;const t=null===(i=this.rangeSliderNode)||void 0===i?void 0:i.values;if(0===e.index){if(t[0]>=t[1])return void(t[0]=t[0]-1)}else if(1===e.index&&t[1]<=t[0])return void(t[1]=t[1]+1);this.minRangeNode.value=`${t[0]}`,this.maxRangeNode.value=`${t[1]}`;const s=[.75*t[0],.75*t[1]];this.handleSizeRangeValuesChange(s)})),this.rangeSliderNode.on("segment-drag",(()=>{var e;const i=null===(e=this.rangeSliderNode)||void 0===e?void 0:e.values;this.minRangeNode.value=`${i[0]}`,this.maxRangeNode.value=`${i[1]}`;const t=[.75*i[0],.75*i[1]];this.handleSizeRangeValuesChange(t)})),this.rangeSliderWatchHandles.push(e.watch("scale",(()=>{var e;let[i,t]=(0,u.h)();[i,t]=[Math.round(i/.75),Math.round(t/.75)],null===(e=this.rangeSliderNode)||void 0===e||e.set({values:[i,t],min:Math.max(1,Math.min(1,i-10)),max:Math.min(t+10,100)}),this.minRangeNode.value=this.rangeSliderNode.values[0].toString(),this.maxRangeNode.value=this.rangeSliderNode.values[1].toString()}))))}handleSizeRangeChange(e){const{layer:i}=a.s,t=(0,a.h)(i),l=(0,a.a)(t,"size");if("fixed"===e){if(!l.minSize.stops)return;[l.minSize,l.maxSize]=(0,u.h)(),(0,a.ab)(),(0,s.f)(this.hostElement)}else{const e=(0,a.g)();let t=r.f;"predominance-size"===e?t=f.a:"chart-size"===e?t=S.a:["size-age","color-size-age","type-size-age"].indexOf(e)>-1&&(t=r.g),(0,n.r)(t({sizeOptimizationEnabled:!0}),this.flowItemNode).then((e=>{(0,a.e)(e.renderer,i),(0,a.ab)(),(0,s.f)(this.hostElement)}),(e=>{this.adjustSizeNode.checked=!1,this.arcgisSmartMappingSizeRangeSliderError.emit(e)}))}}get hostElement(){return(0,s.d)(this)}};N.style=".size-range-block{border-bottom:1px solid #e0e0e0}.range-slider{height:40px;background-color:transparent;position:relative;width:95%;margin:15px auto 0 auto}.size-range{display:flex;justify-content:space-between;margin-bottom:15px}.size-range-item{width:48%;display:flex;flex-flow:column;justify-content:space-between}.esri-slider__label{text-decoration:underline}.esri-slider__label:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}";const k=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSizeSliderChange=(0,s.c)(this,"arcgisSmartMappingSizeSliderChange",7),this.arcgisSmartMappingSizeSliderError=(0,s.c)(this,"arcgisSmartMappingSizeSliderError",7),this.currentStopValues=[],this.currentBreakValues=[],this.zigzagClick=!1,this.styleSheetStatus="not-loaded",this.histogramStatus=a.b.MISSING,this.statisticsStatus=a.b.MISSING,this.sliderZoomed=!1}async updateStatistics(){var e;this.statisticsStatus=a.b.MISSING,this.statistics=null,this.histogramStatus=a.b.MISSING,this.histogram=null,null===(e=this.sizeSlider)||void 0===e||e.destroy(),this.sizeSlider=void 0,this.sliderZoomed=!1,this.getStatistics()}componentWillLoad(){this.getStatistics()}componentDidLoad(){this.flowItemNode=(0,a.F)(this.hostElement,"calcite-flow-item")}render(){const{config:e}=a.s;return(0,s.h)(s.H,null,(0,s.h)("link",{rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.hostElement)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.hostElement)}}),"loaded"===this.styleSheetStatus?this.renderSizeSlider():"not-loaded"===this.styleSheetStatus?this.renderSizeSliderLoading():null)}renderSizeSlider(){const{statisticsStatus:e,histogramStatus:i,sliderZoomed:t}=this,{layer:l,strings:n}=a.s,o=(0,a.h)(l),r=(0,a.a)(o,"size");if(!(e===a.b.FAILED||e===a.b.MISSING||r&&r.stops&&1===r.stops.length||!r&&1===o.classBreakInfos.length)){if(e===a.b.IN_PROGRESS||i===a.b.IN_PROGRESS&&!this.sizeSlider)return this.renderSizeSliderLoading();{const e=this.prepareSizeSlider();let i=!1;if(r&&!t){const e=(0,a.a)(o,"size"),t=(0,a.p)(o,"size"),s=(0,a.aC)([{value:e.minDataValue},{value:e.maxDataValue}],null==t?void 0:t.minSliderValue,null==t?void 0:t.maxSliderValue);((null==s?void 0:s.minMaxSame)||!(0,a.ac)(null==s?void 0:s.min)&&!(0,a.ac)(null==s?void 0:s.max))&&(i=!0,this.zoomButtonNode&&(this.zoomButtonNode.disabled=!0))}return r?this.currentStopValues=[r.minDataValue,r.maxDataValue]:this.currentBreakValues=o.classBreakInfos.map((e=>({min:e.minValue,max:e.maxValue}))),e||this.sizeSlider?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,n.panels.size.dataRange),(0,s.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),r&&(0,s.h)(s.F,null,(0,s.h)("div",null," "),this.renderZoomButton(i),(0,s.h)("div",null," "),this.renderResetButton())),(0,s.h)("div",{ref:e=>{e&&this.afterSizeSliderCreate(e)}})):this.renderSizeSliderLoading()}}this.sizeSlider&&(this.sizeSlider.destroy(),this.sizeSlider=void 0)}renderSizeSliderLoading(){const{strings:e}=a.s;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=a.s;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.size.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderZoomButton(e){const{strings:i}=a.s,{sliderZoomed:t}=this;return(0,s.h)("arcgis-smart-mapping-action",{text:i.panels.size.zoomSlider,icon:t?"magnifyingGlassMinus":"magnifyingGlassPlus",disabled:e,onClick:()=>this.handleZoomSlider(),ref:e=>this.zoomButtonNode=e})}renderResetButton(){const{strings:e}=a.s;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.size.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareSizeSlider(){var e,i;const{statistics:t,histogram:s,histogramStatus:n,sliderZoomed:o}=this,{layer:d,mapView:h,modules:u}=a.s,p=(0,a.h)(d),m=(0,a.g)(),g=["size-age","color-size-age","type-size-age"].indexOf(m)>-1,f="class-breaks"===p.type?p.classBreakInfos:p.uniqueValueInfos,S=this.getFieldInfo().simpleFieldType===a.w.DATE,v=(0,a.a)(p,"size"),y=(0,a.p)(p,"size"),b=-1===["color-size","color-age-size","color-size-age","type-size","type-size-age","predominance-size","chart-size","relationship-size"].indexOf(m)?(0,a.t)(f[f.length-1].symbol):null;let z,x;if(y?(z=null==y?void 0:y.minSliderValue,x=null==y?void 0:y.maxSliderValue):(z=f[0].minValue,x=f[f.length-1].maxValue),({min:z,max:x}=(0,a.ad)({min:z,max:x})),n===a.b.IN_PROGRESS)return!1;if(!this.sizeSlider||v&&this.sizeSlider.breaks||!v&&this.sizeSlider.stops){null===(e=this.sizeSlider)||void 0===e||e.destroy();const i={histogramConfig:{bins:null==s?void 0:s.bins,average:Math.round(10*t.avg)/10,standardDeviation:t.stddev,standardDeviationCount:1},min:null!=z?z:t.min,max:null!=x?x:t.max,style:b?{trackFillColor:b||null}:null};if(v)S&&!g&&(i.hasTimeData=!0,(0,l.a)(i,h.timeZone)),i.stops=(0,r.l)(),i.precision=(0,c.g)(i.stops),this.sizeSlider=new u.SizeSlider(i);else{const e=(0,a.h)(d);i.histogramConfig.min=e.classBreakInfos[0].minValue,i.histogramConfig.max=e.classBreakInfos[e.classBreakInfos.length-1].maxValue,this.sliderZoomed=!1,i.breaks=(0,r.m)(),i.precision=(0,c.g)(i.breaks),this.sizeSlider=new u.ClassedSizeSlider(i)}this.createSizeSliderChangeEvents()}else{if("dragging"===(null===(i=this.sizeSlider.slider)||void 0===i?void 0:i.state))return!0;const e={histogramConfig:{bins:null==s?void 0:s.bins,average:Math.round(10*t.avg)/10,standardDeviation:t.stddev,standardDeviationCount:1},min:null!=z?z:t.min,max:null!=x?x:t.max,style:b?{trackFillColor:b||null}:null};v?(e.stops=(0,r.l)(),e.precision=(0,c.g)(e.stops),e.hasTimeData=S&&!g,S&&!g&&(0,l.a)(e,h.timeZone),o?this.zigzagClick||(e.zoomOptions=(0,a.aC)([{value:v.minDataValue},{value:v.maxDataValue}],null==y?void 0:y.minSliderValue,null==y?void 0:y.maxSliderValue)):e.zoomOptions=null):(e.breaks=(0,r.m)(),e.precision=(0,c.g)(e.breaks)),this.sliderZoomed&&this.adjustedZoomOptions&&!this.zigzagClick&&(e.zoomOptions=this.adjustedZoomOptions,"min"===this.zoomAdjustment?(this.sizeSlider.slider.min=e.zoomOptions.min,e.zoomOptions.min=null):(this.sizeSlider.slider.max=e.zoomOptions.max,e.zoomOptions.max=null)),this.adjustedZoomOptions=null,this.zoomAdjustment=null,this.sizeSlider.set(e),this.zigzagClick=!1}return(0,a.ac)(this.sizeSlider)}handleInvertSlider(){const{layer:e}=a.s,i=(0,a.h)(e),t=(0,a.a)(i,"size");if(t)[t.minSize,t.maxSize]=[t.maxSize,t.minSize];else{const e=i.classBreakInfos.map((e=>(0,a.T)(e.symbol)));e.reverse(),i.classBreakInfos.forEach(((i,t)=>{const s=i.symbol;(0,a.U)(s,e[t])}))}(0,a.ab)(),this.arcgisSmartMappingSizeSliderChange.emit()}handleZoomSlider(e){var i,t,s,l;if(this.histogramStatus===a.b.IN_PROGRESS)return;const{statistics:n}=this,{layer:o}=a.s,r=(0,a.h)(o);this.sliderZoomed=(0,a.ac)(e)?e:!this.sliderZoomed;const d=(0,a.a)(r,"size");d||(this.sliderZoomed=!1);const h=d?d.normalizationField:r.normalizationField,c=this.getFieldInfo(),u=(0,a.p)(r,"size"),p=this.sliderZoomed?(0,a.aC)([{value:d.minDataValue},{value:d.maxDataValue}],null!==(i=null==u?void 0:u.minSliderValue)&&void 0!==i?i:n.min,null!==(t=null==u?void 0:u.maxSliderValue)&&void 0!==t?t:n.max):null;this.getHistogram(c,h,n,p&&p.min||(null!==(s=null==u?void 0:u.minSliderValue)&&void 0!==s?s:n.min),p&&p.max||(null!==(l=null==u?void 0:u.maxSliderValue)&&void 0!==l?l:n.max))}handleResetSlider(){const{layer:e}=a.s,i=(0,a.h)(e),t=(0,a.g)();this.sliderZoomed=!1;let s=(0,a.a)(i,"size");const l=(0,a.p)(i,"size"),o=null==l?void 0:l.theme,h=this.getFieldInfo(),c=s?s.normalizationField:i.normalizationField;let u;["size","predominance-size","relationship-size","chart-size"].indexOf(t)>-1?u=r.f:"size-age"===t?(h.field=l.field,u=r.g):"color-size-age"===t?(h.field=l.field,u=r.i):"color-age-size"===t?u=r.h:"color-size"===t?u=r.j:"type-size"===t?u=d.d:"type-size-age"===t&&(h.field=l.field,u=d.b),(0,n.r)(u({fieldInfos:(0,a.f)(e),normalizationField:c,sizeOptimizationEnabled:"object"==typeof s.minSize,noReuse:!0,theme:o,discardMinMax:!0},"size"),this.flowItemNode).then((e=>{var i;if(0===(null===(i=e.statistics)||void 0===i?void 0:i.count)){const[i,t]=this.getDefaultDataRange(h),s=(null==l?void 0:l.minSliderValue)||i,n=(null==l?void 0:l.maxSliderValue)||t;e.statistics.min=s,e.statistics.max=n,e.statistics.avg=(n+s)/2,this.statistics=e.statistics,this.statisticsStatus=a.b.SUCCESS}else e.statistics&&(0,a.ac)(e.statistics.min)&&(0,a.ac)(e.statistics.max)&&e.statistics.min<=e.statistics.max?(this.statistics=e.statistics,this.statisticsStatus=a.b.SUCCESS,this.getHistogram(h,c,e.statistics,e.statistics.min,e.statistics.max)):this.statisticsStatus=a.b.FAILED;l.minSliderValue=this.statistics.min,l.maxSliderValue=this.statistics.max,(0,a.ab)()}),(e=>this.arcgisSmartMappingSizeSliderError.emit(e)))}afterSizeSliderCreate(e){if(!this.sizeSlider.container){const i=document.createElement("div");e.append(i),this.sizeSlider.container=i}}getStatistics(){var e;const{layer:i,mapView:t,modules:s}=a.s,l=i,n=(0,a.h)(l);let o,r;const d=(0,a.a)(n,"size"),h=this.getFieldInfo(),c=d?d.normalizationField:n.normalizationField,u=(0,a.p)(n,"size");o=null==u?void 0:u.minSliderValue,r=null==u?void 0:u.maxSliderValue;const p=n.authoringInfo;if("equal-interval"===(null==p?void 0:p.classificationMethod)){const e=n.classBreakInfos;o=e[0].minValue,r=e[e.length-1].maxValue}this.statisticsStatus=a.b.IN_PROGRESS,this.statistics||s.summaryStatistics({layer:l,view:t,field:h.field,valueExpression:h.expression,normalizationField:c,forBinning:"featureReduction"in l&&"binning"===(null===(e=l.featureReduction)||void 0===e?void 0:e.type)}).then((e=>{if(0===e.count){const[i,t]=this.getDefaultDataRange(h),s=(null==u?void 0:u.minSliderValue)||i,l=(null==u?void 0:u.maxSliderValue)||t;e.min=s,e.max=l,e.avg=(l+s)/2,(0,a.ac)(u.minSliderValue)||(u.minSliderValue=s,u.maxSliderValue=l)}else if(!(0,a.ac)(e.avg)||!(0,a.ac)(e.min)||!(0,a.ac)(e.max))return void(this.statisticsStatus=a.b.FAILED);e=(0,a.ad)(e),o=null!=o?o:e.min,r=null!=r?r:e.max,this.statistics=e,this.statisticsStatus=a.b.SUCCESS,this.getHistogram(h,c,e,o,r)}),(e=>{console.log(e),this.statisticsStatus=a.b.FAILED}))}getHistogram(e,i,t,s,l){var n;const{layer:o,mapView:r,modules:d}=a.s,h=o;(t=t||this.statistics)&&0!==t.count&&(this.histogramStatus=a.b.IN_PROGRESS,d.histogram({layer:h,view:r,field:e.field,valueExpression:e.expression,numBins:50,minValue:(0,a.ac)(s)?s:t.min,maxValue:(0,a.ac)(l)?l:t.max,normalizationField:i,forBinning:"featureReduction"in h&&"binning"===(null===(n=h.featureReduction)||void 0===n?void 0:n.type)}).then((e=>{this.histogram=e,this.histogramStatus=a.b.SUCCESS}),(()=>{this.histogramStatus=a.b.FAILED})))}onMinMaxChange(e,i,t){const{statistics:s}=this,{layer:l}=a.s,n=(0,a.h)(l),o=(0,a.a)(n,"size"),r=(0,a.p)(n,"size")||{};if(!o){let t=n.classBreakInfos[0],s=n.classBreakInfos[n.classBreakInfos.length-1];t.minValue=e,t.label=`${t.minValue.toLocaleString({maximumSignificantDigits:15})} - ${t.maxValue.toLocaleString({maximumSignificantDigits:15})}`,s.maxValue=i,s.label=`${s.minValue.toLocaleString({maximumSignificantDigits:15})} - ${s.maxValue.toLocaleString({maximumSignificantDigits:15})}`}"min"===t?r.minSliderValue=e:r.maxSliderValue=i;const d=(0,a.aC)([{value:null==o?void 0:o.minDataValue},{value:null==o?void 0:o.maxDataValue}],null==r?void 0:r.minSliderValue,null==r?void 0:r.maxSliderValue);this.zoomButtonNode&&(this.sliderZoomed?this.zoomButtonNode.disabled=!1:!d||d.minMaxSame||!(0,a.ac)(d.min)&&!(0,a.ac)(d.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1),this.sliderZoomed&&(this.adjustedZoomOptions=this.sizeSlider.zoomOptions,"min"===t?(this.adjustedZoomOptions.min=e,this.zoomAdjustment="min"):(this.adjustedZoomOptions.max=i,this.zoomAdjustment="max"));const h=this.getFieldInfo(),c=o?o.normalizationField:n.normalizationField;this.getHistogram(h,c,s,e,i),e===r.minSliderValue&&i===r.maxSliderValue&&(this.sliderZoomed=!1),n.authoringInfo.classificationMethod="manual",this.arcgisSmartMappingSizeSliderChange.emit()}createSizeSliderChangeEvents(){const{layer:e}=a.s,i=(0,a.h)(e),t=(0,a.g)(),l=(0,a.a)(i,"size"),n=["size-age","color-size-age","type-size-age"].indexOf(t)>-1,o=this.getFieldInfo().simpleFieldType===a.w.DATE;this.sizeSlider&&(this.sizeSlider.watch("zoomOptions",((e,i)=>{this.sliderZoomed&&((null==i?void 0:i.min)&&!(null==e?void 0:e.min)||(null==i?void 0:i.max)&&!(null==e?void 0:e.max))&&(this.zigzagClick=!0,this.handleZigzagClick(e))})),this.sizeSlider.on("min-change",(e=>{l?e.value>this.currentStopValues[0]?(this.sizeSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.currentStopValues[0],this.sizeSlider.slider.max,"min")):this.onMinMaxChange(e.value,this.sizeSlider.slider.max,"min"):e.value>this.currentBreakValues[0].max?this.onMinMaxChange(this.currentBreakValues[0].max,this.sizeSlider.slider.max,"min"):this.onMinMaxChange(e.value,this.sizeSlider.slider.max,"min")})),this.sizeSlider.on("max-change",(e=>{l?e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.sizeSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.sizeSlider.slider.min,this.currentStopValues[this.currentStopValues.length-1],"max")):this.onMinMaxChange(this.sizeSlider.slider.min,e.value,"max"):e.value<this.currentBreakValues[this.currentBreakValues.length-1].min?this.onMinMaxChange(this.sizeSlider.slider.min,this.currentBreakValues[this.currentBreakValues.length-1].min,"max"):this.onMinMaxChange(this.sizeSlider.slider.min,e.value,"max")})),this.sizeSlider.on("thumb-change",(e=>{if(l){const i=this.sizeSlider.stops;if(o&&!n&&0===e.value)return void(0,s.f)(this.hostElement);this.updateRendererStops(i)}else this.updateRendererBreaks(this.sizeSlider.breaks)})),this.sizeSlider.on("thumb-drag",(()=>{if(l){const e=this.sizeSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.sizeSlider.breaks)})),this.sizeSlider.on("segment-drag",(()=>{if((0,a.a)(i,"size")){const e=this.sizeSlider.stops;this.updateRendererStops(e)}})))}updateRendererStops(e){const{layer:i}=a.s,t=(0,a.h)(i),s=(0,a.a)(t,"size"),l=(0,a.p)(t,"size");s.stops?(5===e.length&&(e[0].label=`< ${e[0].value}`,e[1].label=`${e[1].value}`,e[2].label=`${e[2].value}`,e[3].label=`${e[3].value}`,e[4].label=`> ${e[4].value}`),s.stops=e):(s.minDataValue=e[0].value,s.maxDataValue=e[1].value),this.currentStopValues=e.map((e=>e.value));const n=(0,a.aC)([{value:s.minDataValue},{value:s.maxDataValue}],null==l?void 0:l.minSliderValue,null==l?void 0:l.maxSliderValue);this.sliderZoomed?this.zoomButtonNode.disabled=!1:!n||n.minMaxSame||!(0,a.ac)(n.min)&&!(0,a.ac)(n.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1,(0,a.ab)()}updateRendererBreaks(e){const{layer:i}=a.s,t=(0,a.h)(i);t.authoringInfo.classificationMethod="manual",t.classBreakInfos.forEach(((i,t)=>{if(i.minValue!==e[t].min||i.maxValue!==e[t].max){i.minValue=e[t].min,i.maxValue=e[t].max;const s=t>0?"> ":"";i.label=`${s} ${i.minValue.toLocaleString()} - ${i.maxValue.toLocaleString()}`,this.currentBreakValues[t].min=e[t].min,this.currentBreakValues[t].max=e[t].max}})),(0,a.ab)(),this.arcgisSmartMappingSizeSliderChange.emit()}getDefaultDataRange(e){if(e.simpleFieldType===a.w.DATE){const e=(new Date).getFullYear();return[new Date(`1/1/${e}`).getTime(),new Date(`12/31/${e}`).getTime()]}return[0,100]}getFieldInfo(){var e,i;const{layer:t}=a.s,s=(0,a.h)(t),l=(0,a.g)(),n=(0,a.a)(s,"size"),o=(0,a.f)(t),r=["color-size","color-age-size","color-size-age","type-size","type-size-age"].indexOf(l)>-1&&o.length>1?o[1]:"relationship-size"===l?o[2]:o[0];return r.expression=null!==(e=null==n?void 0:n.valueExpression)&&void 0!==e?e:null,r.expressionTitle=null!==(i=null==n?void 0:n.valueExpressionTitle)&&void 0!==i?i:null,r}handleZigzagClick(e){var i,t;const{statistics:s}=this,{layer:l}=a.s,n=(0,a.h)(l),o=(0,a.a)(n,"size"),r=(0,a.p)(n,"size"),d=this.getFieldInfo(),h=o?o.normalizationField:n.normalizationField;this.getHistogram(d,h,s,null!==(i=null==e?void 0:e.min)&&void 0!==i?i:r.minSliderValue,null!==(t=null==e?void 0:e.max)&&void 0!==t?t:r.maxSliderValue),e||(this.sliderZoomed=!1)}get hostElement(){return(0,s.d)(this)}};k.style=".slider-box{height:320px}.slider-box .esri-size-slider,.slider-box .esri-classed-size-slider{min-width:200px}.slider-box .esri-size-slider .esri-slider .esri-slider__content,.slider-box .esri-classed-size-slider .esri-slider .esri-slider__content{height:175px}.slider-box .esri-size-slider__histogram-container,.slider-box .esri-classed-size-slider__histogram-container{width:85px}.slider-box .esri-size-slider .esri-slider .esri-slider__label,.slider-box .esri-size-slider .esri-slider .esri-slider__min,.slider-box .esri-size-slider .esri-slider .esri-slider__max,.slider-box .esri-classed-size-slider .esri-slider .esri-slider__label,.slider-box .esri-classed-size-slider .esri-slider .esri-slider__min,.slider-box .esri-classed-size-slider .esri-slider .esri-slider__max{text-decoration:underline}.slider-box .esri-size-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-size-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-size-slider .esri-slider .esri-slider__max:hover,.slider-box .esri-classed-size-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-classed-size-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-classed-size-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-box-buttons-front{display:flex}";const M=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingTileSelect=(0,s.c)(this,"arcgisSmartMappingTileSelect",7),this.arcgisSmartMappingTileOptions=(0,s.c)(this,"arcgisSmartMappingTileOptions",7),this.arcgisSmartMappingTileError=(0,s.c)(this,"arcgisSmartMappingTileError",7),this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.keyupEventHandler=e=>{const{selected:i}=this;" "!==e.key&&"Enter"!==e.key||(e.stopPropagation(),this.removeInfoPopover(),i?this.arcgisSmartMappingTileOptions.emit():this.arcgisSmartMappingTileSelect.emit(),e.preventDefault())},this.keydownEventHandler=e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())},this.clickEventHandler=e=>{var i,t;const{selected:s}=this;"CALCITE-CHECKBOX"!==(null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.nodeName)&&"ARCGIS-SMART-MAPPING-THEME-BUTTON"!==(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.nodeName)&&(e.stopPropagation(),this.removeInfoPopover(),s?this.arcgisSmartMappingTileOptions.emit():this.arcgisSmartMappingTileSelect.emit(),e.preventDefault())},this.checkboxChangeHandler=e=>{const{selected:i}=this;e.preventDefault();const t=e.target;t.checked?(this.removeInfoPopover(),i?this.arcgisSmartMappingTileOptions.emit():this.arcgisSmartMappingTileSelect.emit()):t.checked=!0},this.tileType=void 0,this.type=void 0,this.selected=void 0}async setFocus(){requestAnimationFrame((()=>{var e;return null===(e=this.tileNode)||void 0===e?void 0:e.focus()}))}componentWillLoad(){this.tileInfo=function(e,i){var t;const{layer:s,selectedFields:l,strings:n}=a.s;let o=(0,a.i)(s)?"raster":(0,a.D)(s);"multipoint"===o&&(o="point");let r=l.length;(0,a.ac)(r)||(r=1);const d=(0,a.i)(s)?(0,y.g)():(0,a.g)();let h=!1,c=!1;switch(l.length&&(h=l[0].simpleFieldType===a.w.DATE||"date-only"===(null===(t=(0,a.u)(l[0].field))||void 0===t?void 0:t.layerField).type,c=h,l.length>1&&(c=l[1].simpleFieldType===a.w.DATE)),e){case"simple":return{title:n.tile.simpleStyle,moreInfo:n.tile.tooltips.location,helpId:"120003675",imageFile:`${o}/Simple.png`};case"color":return{title:h?n.tile.colorStyleDate:n.tile.colorStyle,subText:"gallery"!==i?l[0].expressionTitle||(0,a.u)(l[0].field).label:"",moreInfo:h?n.tile.tooltips.colorDate:n.tile.tooltips.color,helpId:h?"120003262":"120003251",imageFile:`${o}/Color.png`};case"size":return{title:"chart-size"===d&&"gallery"!=i?n.tile.sizeStyleChart:1===r&&h||2===r&&c?n.tile.sizeStyleDate:n.tile.sizeStyle,subText:"gallery"!==i?"chart-size"===d||"predominance-size"===d?n.sumOfCategories:l[1].expressionTitle||(0,a.u)(l[1].field).label:"",moreInfo:"predominance-size"===d?n.tile.tooltips.sizeForPredominance:1===r&&h||2===r&&c?n.tile.tooltips.sizeDate:n.tile.tooltips.size,helpId:1===r&&h||2===r&&c?"120003263":"120003252",imageFile:"chart-size"===d&&"gallery"!=i?`${o}/ChartSizeSize.jpg`:`${o}/Size.png`};case"type":return{title:h?n.tile.typeStyleDate:n.tile.typeStyle,subText:"gallery"!==i&&["type-size","type-size-age"].indexOf(d)>-1?(0,a.u)(l[0].field).label:"",moreInfo:h?n.tile.tooltips.typeDate:n.tile.tooltips.type,helpId:h?"120003266":"120003260",imageFile:`${o}/Type.png`};case"color-age":return{title:n.tile.colorAgeStyle,subText:"gallery"!==i?l[0].expressionTitle||(0,a.u)(l[0].field).label:"",moreInfo:n.tile.tooltips.colorAge,helpId:"120003264",imageFile:`${o}/Color_Age.png`};case"size-age":return{title:n.tile.sizeAgeStyle,subText:"gallery"!==i?l[1].expressionTitle||(0,a.u)(l[1].field).label:"",moreInfo:n.tile.tooltips.sizeAge,helpId:"120003265",imageFile:`${o}/Size_Age.png`};case"color-size":return{title:n.tile.colorSizeStyle,moreInfo:h?c?n.tile.tooltips.colorDate_SizeDate:n.tile.tooltips.colorDate_Size:c?n.tile.tooltips.color_SizeDate:n.tile.tooltips.color_Size,helpId:"120003254",imageFile:`${o}/ColorSize.png`};case"color-age-size":return{title:n.tile.colorAgeSizeStyle,moreInfo:n.tile.tooltips.colorAge_Size,helpId:"120003267",imageFile:`${o}/ColorSize_Age.png`};case"color-size-age":return{title:n.tile.colorSizeAgeStyle,moreInfo:n.tile.tooltips.color_SizeAge,helpId:"120003267",imageFile:`${o}/ColorSize_Age.png`};case"type-size":return{title:n.tile.typeSizeStyle,moreInfo:h?n.tile.tooltips.typeDate_Size:c?n.tile.tooltips.type_SizeDate:n.tile.tooltips.type_Size,helpId:"120003261",imageFile:`${o}/TypeSize.png`};case"type-size-age":return{title:n.tile.typeSizeAgeStyle,moreInfo:n.tile.tooltips.type_SizeAge,helpId:"120003268",imageFile:`${o}/TypeSize_Age.png`};case"dot-density":return{title:n.tile.dotDensityStyle,moreInfo:n.tile.tooltips.dotDensity,helpId:"120003253",imageFile:`${o}/DotDensity.png`};case"heatmap":return{title:n.tile.heatmapStyle,moreInfo:n.tile.tooltips.heatMap,helpId:"120003250",imageFile:`${o}/HeatMap.png`};case"relationship":return{title:n.tile.relationshipStyle,subText:"gallery"!==i&&"relationship-size"===d?[(0,a.u)(l[0].field).label,(0,a.u)(l[1].field).label]:"",moreInfo:n.tile.tooltips.relationship,helpId:"120003258",imageFile:`${o}/Relationship.png`};case"relationship-size":return{title:n.tile.relationshipSizeStyle,moreInfo:n.tile.tooltips.relationshipSize,helpId:"120003259",imageFile:`${o}/RelationshipSize.png`};case"predominance":return{title:n.tile.predominanceStyle,moreInfo:n.tile.tooltips.predominance,helpId:"120003256",imageFile:`${o}/Predominance.png`};case"predominance-size":return{title:n.tile.predominanceSizeStyle,moreInfo:n.tile.tooltips.predominanceSize,helpId:"120003257",imageFile:`${o}/PredominanceSize.png`};case"chart":return{title:"chart-size"===d&&"gallery"!==i?n.tile.chartStyleColor:n.tile.chartStyle,moreInfo:n.tile.tooltips.chart,helpId:"120003729",imageFile:`${o}/Chart.jpg`};case"chart-size":return{title:n.tile.chartSizeStyle,moreInfo:n.tile.tooltips.chartSize,helpId:"120003730",imageFile:`${o}/ChartSize.jpg`};case"compare":return{title:n.tile.compareStyle,moreInfo:n.tile.tooltips.compare,helpId:"120003255",imageFile:`${o}/Ratio.png`};case"raster-stretch":return{title:n.tile.symbologyStretchStyle,moreInfo:n.tile.tooltips.stretch,helpId:"120003269",imageFile:`${o}/stretch.png`};case"raster-rgb":return{title:n.tile.symbologyRGBStyle,moreInfo:n.tile.tooltips.rgb,helpId:"120003270",imageFile:`${o}/rgb.png`};case"raster-unique-value":return{title:n.tile.symbologyUniqueValuesStyle,moreInfo:n.tile.tooltips.uniqueValues,helpId:"120003271",imageFile:`${o}/uniqueValues.png`};case"raster-shaded-relief":return{title:n.tile.symbologyShadedReliefStyle,moreInfo:n.tile.tooltips.shadedRelief,helpId:"120003273",imageFile:`${o}/shadedRelief.png`};case"raster-vector-field":return{title:n.tile.symbologyVectorFieldStyle,moreInfo:n.tile.tooltips.vectorField,helpId:"120003275",imageFile:`${o}/vectorField.png`};case"raster-colormap":return{title:n.tile.symbologyColormapStyle,moreInfo:n.tile.tooltips.colormap,helpId:"120003274",imageFile:`${o}/colormap.png`};case"raster-class-breaks":return{title:n.tile.symbologyClassBreaksStyle,moreInfo:n.tile.tooltips.classify,helpId:"120003272",imageFile:`${o}/classBreaks.png`};case"raster-flow":return{title:n.tile.rasterFlowStyle,moreInfo:n.tile.tooltips.flow,helpId:"120003676",imageFile:`${o}/flow.png`}}}(this.type,this.tileType)}componentDidLoad(){this.flowItemNode=(0,a.F)(this.hostElement,"calcite-flow-item")}disconnectedCallback(){this.removeInfoPopover()}render(){const{selected:e,tileInfo:i,tileType:t}=this,{title:l,imageFile:n}=i,{strings:o}=a.s,r={tile:!0,"tile-selected":e},d={"tile-image":!0,"tile-image-selected":"gallery"===t&&e},h={"tile-check":!0,rtl:"rtl"===(0,g.g)(this.hostElement)};return(0,s.h)(s.H,{"aria-label":`${l} ${e?o.tile.styleOptions:o.tile.selectStyle}`,"aria-selected":e,role:"button",tabindex:"0"},(0,s.h)("div",{class:r,tabindex:"0",ref:e=>{this.tileNode=e,this.addTileListeners(e)}},(0,s.h)("div",{class:d,style:{backgroundImage:`url(${(0,s.a)("./assets/arcgis-smart-mapping-thumbnails/")}${n})`},"aria-hidden":"true"}),"gallery"===t&&(0,s.h)("div",{class:h,"aria-label":"","aria-hidden":"true"},(0,s.h)("calcite-checkbox",{name:"style-tile-check-name",checked:e,tabindex:"-1",ref:e=>this.addCheckboxListener(e)})),this.renderTileLink()))}renderTheme(){const{layer:e}=a.s,{tileType:i,type:t}=this;if("imagery"===e.type||"imagery-tile"===e.type)return null;const l=(0,a.g)();if("chart-size"===l)return null;if(-1===["color","size","color-age","size-age","color-size"].indexOf(t))return null;if(-1===["color","size","color-age","size-age","color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size"].indexOf(l))return null;if("gallery"===i&&["type-size","relationship-size","color-age-size","color-size-age","type-size-age"].indexOf(l)>-1)return null;const n=(0,a.h)(e),o=n.authoringInfo,r="univariate-color-size"===(null==o?void 0:o.type);if("gallery"===i&&"color-size"===l&&!r)return null;const d=(0,a.a)(n,"color");if("gallery"===i&&"color"===l&&!d)return null;const h=(0,a.a)(n,"size");if("gallery"===i&&"size"===l&&!h)return null;const c="color-age"===t?"color":"size-age"===t?"size":"color-size"===t?"colorSize":t;return(0,s.h)("arcgis-smart-mapping-theme-button",{ref:e=>this.themeButtonNode=e,rendererSubtype:c,buttonVersion:"minimal",onArcgisSmartMappingThemeButtonChange:e=>this.changeTheme(e)})}changeTheme(e){const{layer:i}=a.s,t=(0,a.g)(),{type:l}=this,d=(0,a.h)(i).authoringInfo,h="univariate-color-size"===(null==d?void 0:d.type);if(("color"===l||"color-age"===l)&&["color","color-age","color-size","color-age-size","color-size-age"].indexOf(t)>-1){let l=o.b;["color-age","color-age-size"].indexOf(t)>-1&&(l=o.d),(0,n.r)(l({theme:e.detail}),this.flowItemNode).then((e=>{if(["color-size","color-age-size","color-size-age"].indexOf(t)>-1){const t=(0,a.h)(i);t.visualVariables=(0,a.n)(t,"color")||[],t.visualVariables.push((0,a.a)(e.renderer,"color")),t.authoringInfo.visualVariables=(0,a.o)(t,"color")||[],t.authoringInfo.visualVariables.push((0,a.p)(e.renderer,"color"))}else(0,a.e)(e.renderer,i);(0,a.ab)(),(0,s.f)(this.hostElement),(0,s.f)(this.themeButtonNode)}),(e=>this.arcgisSmartMappingTileError.emit(e)))}else if(("size"===l||"size-age"===l)&&["size","size-age","color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size"].indexOf(t)>-1){let l=r.f;["size-age","color-size-age","type-size-age"].indexOf(t)>-1&&(l=r.g),(0,n.r)(l({theme:e.detail}),this.flowItemNode).then((e=>{if(-1===["size","size-age"].indexOf(t)){const t=(0,a.h)(i);t.visualVariables=(0,a.n)(t,"size")||[],t.visualVariables.push((0,a.a)(e.renderer,"size")),t.authoringInfo.visualVariables=(0,a.o)(t,"size")||[],t.authoringInfo.visualVariables.push((0,a.p)(e.renderer,"size"))}else(0,a.e)(e.renderer,i);(0,a.ab)(),(0,s.f)(this.hostElement),(0,s.f)(this.themeButtonNode)}),(e=>this.arcgisSmartMappingTileError.emit(e)))}else"color-size"===l&&h&&(0,n.r)((0,m.a)({theme:e.detail}),this.flowItemNode).then((e=>{(0,a.e)(e.renderer,i),(0,a.ab)(),(0,s.f)(this.hostElement),(0,s.f)(this.themeButtonNode)}),(e=>this.arcgisSmartMappingTileError.emit(e)))}renderTileLink(){const{selected:e,tileInfo:i,tileType:t}=this,{title:l,subText:n}=i,{strings:o}=a.s,r={"style-link-text":!0,rtl:"rtl"===(0,g.g)(this.hostElement)};return(0,s.h)("div",{class:"style-link","aria-label":l},(0,s.h)("div",{class:"style-link-title "+("gallery"===t?"info":"")},(0,s.h)("div",{class:r,"aria-hidden":"true"},l),"gallery"===t&&(0,s.h)("calcite-action",{class:"style-link-info",tabindex:"0",scale:"s",icon:"information",compact:!0,onClick:e=>this.handleInfoClick(e),text:o.tile.moreInfo,ref:e=>{this.infoIconNode=e,e.addEventListener("keyup",(e=>{e.stopPropagation(),(" "===e.key||!this.infoPopoverNode&&"Enter"===e.key)&&this.handleInfoClick(e)})),e.addEventListener("keydown",(e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())}))}}),"gallery"!==t&&n&&(0,s.h)("div",{class:"style-link-sub-text"},"string"==typeof n?n:n.map((e=>(0,s.h)("div",null,e))))),(e||"gallery"!==t)&&this.renderTheme(),(e||"gallery"!==t)&&this.renderStyleOptions())}renderStyleOptions(){const{strings:e}=a.s;return(0,s.h)("calcite-button",{appearance:"outline-fill",width:"full",scale:"s",label:e.tile.styleOptions},e.tile.styleOptions)}handleInfoClick(e){e.stopPropagation();const{tileInfo:i,flowItemNode:t}=this,{title:s,moreInfo:l,helpId:n}=i,{config:o,strings:r}=a.s;this.removeInfoPopover(),this.infoPopoverNode=document.createElement("arcgis-smart-mapping-info-popover"),this.infoPopoverNode.props={title:s,moreInfo:l,helpId:n,config:o,flowItemNode:t,strings:r},this.infoPopoverNode.referenceElement=this.infoIconNode,this.infoPopoverNode.addEventListener("arcgisSmartMappingInfoPopoverClose",(e=>{e.stopPropagation(),this.removeInfoPopover(),setTimeout((()=>this.infoIconNode.setFocus()),200)})),this.infoPopoverNode.addEventListener("arcgisSmartMappingInfoPopoverDisconnected",(e=>{e.stopPropagation(),this.removeInfoPopover()})),document.body.appendChild(this.infoPopoverNode),this.infoPopoverNode.setOpen(!0),setTimeout((()=>this.infoPopoverNode.setFocus()),100),setTimeout((()=>{this.documentClickHandler=e=>{(0,v.i)(e.target)||(this.removeInfoPopover(),setTimeout((()=>this.infoIconNode.setFocus()),200))},document.addEventListener("click",this.documentClickHandler),this.panelScrollHandler=()=>{this.removeInfoPopover()},null==t||t.addEventListener("calciteFlowItemScroll",this.panelScrollHandler)}),100)}removeInfoPopover(){const{flowItemNode:e}=this;document.body.querySelectorAll(".arcgis-smart-mapping-popover").forEach((e=>document.body.removeChild(e))),this.infoPopoverNode=null,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0),this.panelScrollHandler&&(null==e||e.removeEventListener("calciteFlowItemScroll",this.panelScrollHandler),this.panelScrollHandler=void 0)}addTileListeners(e){e.addEventListener("keyup",this.keyupEventHandler),e.addEventListener("keydown",this.keydownEventHandler),e.addEventListener("click",this.clickEventHandler)}addCheckboxListener(e){e.addEventListener("calciteCheckboxChange",this.checkboxChangeHandler)}get hostElement(){return(0,s.d)(this)}};M.style=".tile{background-color:white;position:relative;margin:6px;cursor:pointer;box-shadow:0 1px 10px 2px rgba(0, 0, 0, 0.05), 0 0 0 1px #e0e0e0;transition:box-shadow 125ms ease-in-out}.tile:hover{z-index:5;box-shadow:0 1px 0 2px rgba(0, 0, 0, 0.05), 0 0 0 1px #e0e0e0}.tile:focus{outline:2px solid var(--calcite-color-brand)}.tile-selected{box-shadow:0 1px 10px 2px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--calcite-color-brand)}.tile-selected:focus{box-shadow:0 1px 10px 2px rgba(0, 0, 0, 0.05), 0 0 0 2px var(--calcite-color-brand)}.tile-selected:hover{z-index:5;box-shadow:0 1px 0 2px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--calcite-color-brand)}.tile-check{position:absolute;top:10px;right:10px}.tile-check.rtl{right:auto;left:10px}.style-link{padding:9px 9px}.style-link-icon{margin-top:-1px}.style-link-text{margin-right:10px}.style-link-text.rtl{margin-right:0;margin-left:10px}.style-link-title{font-weight:bold;padding-bottom:5px}.style-link-title.info{display:flex}.style-link-sub-text{font-size:80%;padding:0 0 6px 0;font-weight:normal}.style-link-options{color:#0079c1;display:flex;flex-direction:row nowrap}.style-link-options svg{fill:#0079c1}.tile-image{height:100px;width:100%;background-size:cover;display:flex;align-items:center;justify-content:center}.tile-image-selected{height:68px;background-size:auto 100px}.style-sub-text{font-size:80%;padding:0 0 6px 0}.style-link-info{height:18px}"},95129:(e,i,t)=>{t.d(i,{a:()=>a,b:()=>n,d:()=>o,u:()=>l});var s=t(9225);function a(e,i){e.labelFormatFunction=e=>r(e,i,"short-date"),e.inputFormatFunction=e=>r(e,i,"short-date"),e.inputParseFunction=e=>function(e,i){if(!e)return e;let t;if(i&&"system"!==i)if("unknown"===i)t=e;else{const s=new Date;t=e+(new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime())}else t=e+6e4*(new Date).getTimezoneOffset();return console.log("mapTZToUTC",e," - ",new Date(e).toISOString()," - ",new Date(t).toISOString()),t}(Date.parse(e),i)}function l(e,i){let t;if(i&&"system"!==i)if("unknown"===i)t=new Date(e).toISOString();else{const s=(new Date).getTimezoneOffset(),a=new Date(e).toLocaleString("en-US",{timeZone:i});t=new Date(new Date(a).getTime()-6e4*s).toISOString()}else{const i=(new Date).getTimezoneOffset();t=new Date(e-6e4*i).toISOString()}return t}function n(e,i,t){let s;if(i&&"system"!==i)if("unknown"===i)s=new Date(e).toISOString();else{const t=(new Date).getTimezoneOffset(),a=new Date(e).toLocaleString("en-US",{timeZone:i});s=new Date(new Date(a).getTime()-6e4*t).toISOString()}else{const i=(new Date).getTimezoneOffset();s=new Date(e-6e4*i).toISOString()}return s=t?s.substring(11,19):s.substring(11,16),s}function o(e,i){let t,s=new Date(e);if(s=new Date(s.getTime()-6e4*s.getTimezoneOffset()),i&&"system"!==i)if("unknown"===i)t=s.getTime();else{const e=new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime();t=s.getTime()+e}else t=s.getTime()+6e4*s.getTimezoneOffset();return t}function r(e,i,t){const{modules:a}=s.s;let l;return l="unknown"===i?a.intl.formatDate(e,Object.assign(Object.assign({},a.intl.convertDateFormatToIntlOptions(t||"short-date-short-time")),{timeZone:"utc",timeZoneName:"shortOffset"})):a.intl.formatDate(e,Object.assign(Object.assign({},a.intl.convertDateFormatToIntlOptions(t||"short-date-short-time")),{timeZone:i})),l}t(69283),t(49306)},36238:(e,i,t)=>{t.d(i,{a:()=>d,b:()=>u,c:()=>a,d:()=>s,e:()=>l,f:()=>h,g:()=>p,i:()=>n,m:()=>o,t:()=>r,u:()=>c});const s=(e,i)=>{let t,s="idle";const a=(...a)=>new Promise((l=>{switch(s){case"flushed":s="idle",t?(clearTimeout(t),l(e(...a))):l(null);break;case"invoked":clearTimeout(t),s="idle",l(e(...a));break;case"cancelled":clearTimeout(t),s="idle",l(null);break;default:t&&clearTimeout(t),s="pending",t=setTimeout((()=>(s="idle",l(e(...a)))),i)}}));return a.flush=function(...e){return s="flushed",a(...e)},a.invoke=function(...e){return s="invoked",a(...e)},a.cancel=function(...e){return s="cancelled",a(...e)},a.getStatus=function(){return s},a},a=(e,i)=>{let t;return(...s)=>new Promise((a=>{t||(t=setTimeout((()=>{clearTimeout(t),t=void 0,a(e(...s))}),i))}))};function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return null!=e}async function o(e,i){return await Promise.all([e,r(i)]),e}function r(e){return new Promise((i=>setTimeout(i,e)))}const d=(e,i)=>Object.fromEntries((e||[]).map((e=>{const{key:t,data:s}=i(e);return[t,s]}))),h=(e,i)=>e.length===i.length&&e.reduce(((e,t)=>e&&i.indexOf(t)>-1),!0);function c(e,i){const t=[],s={};return e.forEach((e=>{const a=i(e);null==s[a]&&(s[a]=e,t.push(e))})),t}function u(e){const i={boolean:{},number:{},string:{}},t=[];return e.filter((e=>{let s=typeof e;return s in i?!i[s].hasOwnProperty(e)&&(i[s][e]=!0):!(t.indexOf(e)>=0)&&t.push(e)}))}const p=(e,i)=>[...Array(Math.ceil(e.length/i))].map(((t,s)=>e.slice(i*s,i+i*s)))},69135:(e,i,t)=>{function s(e){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===(null==e?void 0:e.tagName))return!0;{let i=null==e?void 0:e.parentElement;for(;i;){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===i.tagName)return!0;i=i.parentElement}}return!1}t.d(i,{i:()=>s})},41267:(e,i,t)=>{t.d(i,{a:()=>o,b:()=>n,g:()=>c,u:()=>l});var s=t(9225),a=(t(69283),t(10519));function l(e){const{layer:i,modules:t}=s.s,l=(0,s.h)(i),n=t.esriLang.clone(l.classBreakInfos);l.classBreakInfos=[],n.forEach(((i,t)=>{i=function(e,i,t,l){if((0,a.i)(i))if(0===i);else if(i<1){const a=Math.round(1/i);e.minValue="first"===l?Math.floor(e.minValue/i)/a:Math.round(e.minValue/i)/a,e.maxValue="last"===l?Math.ceil(e.maxValue/i)/a:Math.round(e.maxValue/i)/a,e.label=`${t>0?"> ":""}${e.minValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})}`}else e.minValue="first"===l?Math.floor(e.minValue/i)*i:Math.round(e.minValue/i)*i,e.maxValue="last"===l?Math.ceil(e.maxValue/i)*i:Math.round(e.maxValue/i)*i,e.label=(t>0?"> ":"")+e.minValue.toLocaleString()+" - "+e.maxValue.toLocaleString();return e}(i,e,t,0===t?"first":t===n.length-1?"last":void 0),l.addClassBreakInfo({minValue:i.minValue,maxValue:i.maxValue,symbol:i.symbol,label:i.label})}))}function n(e){const{layer:i}=s.s,t=(0,s.h)(i).classBreakInfos;let a=e,l=1/0;t.forEach((e=>{a||(a=Math.max(r(e.minValue),r(e.maxValue))),l=Math.min(l,e.maxValue-e.minValue)}));const n=[];return l>1e7?(n.push(1e7),n.push(1e6),n.push(1e5),n.push(1e4),n.push(1e3),n.push(100),n.push(10),a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01)):l>1e6?(n.push(1e6),n.push(1e5),n.push(1e4),n.push(1e3),n.push(100),n.push(10),a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01)):l>1e5?(n.push(1e5),n.push(1e4),n.push(1e3),n.push(100),n.push(10),a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01)):l>1e4?(n.push(1e4),n.push(1e3),n.push(100),n.push(10),a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01)):l>1e3?(n.push(1e3),n.push(100),n.push(10),a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01),a>3&&n.push(.001)):l>100?(n.push(100),n.push(10),a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01),a>3&&n.push(.001),a>4&&n.push(1e-4),a>5&&n.push(1e-5)):l>10?(n.push(10),a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01),a>3&&n.push(.001),a>4&&n.push(1e-4),a>5&&n.push(1e-5),a>6&&n.push(1e-6)):l>1?(a>0&&n.push(1),a>1&&n.push(.1),a>2&&n.push(.01),a>3&&n.push(.001),a>4&&n.push(1e-4),a>5&&n.push(1e-5),a>6&&n.push(1e-6)):l>.1?(a>1&&n.push(.1),a>2&&n.push(.01),a>3&&n.push(.001),a>4&&n.push(1e-4),a>5&&n.push(1e-5),a>6&&n.push(1e-6)):l>.01?(a>2&&n.push(.01),a>3&&n.push(.001),a>4&&n.push(1e-4),a>5&&n.push(1e-5),a>6&&n.push(1e-6)):l>.001?(a>3&&n.push(.001),a>4&&n.push(1e-4),a>5&&n.push(1e-5),a>6&&n.push(1e-6),a>7&&n.push(1e-7)):l>1e-4?(a>4&&n.push(1e-4),a>5&&n.push(1e-5),a>6&&n.push(1e-6),a>7&&n.push(1e-7),a>8&&n.push(1e-8)):l>1e-5&&(a>5&&n.push(1e-5),a>6&&n.push(1e-6),a>7&&n.push(1e-7),a>8&&n.push(1e-8),a>9&&n.push(1e-9)),n}function o(){const{layer:e}=s.s,i=(0,s.h)(e);let t=1e10;return i.classBreakInfos.forEach((e=>{t=Math.min(t,d(e.minValue)),t=Math.min(t,d(e.maxValue))})),t}function r(e){let i=1;for(;Math.round(e*i)/i!==e;)i*=10;return Math.log(i)/Math.LN10}function d(e){let i=1e-8;for(;h(Math.round(e/i)*i)===e;)i*=10;return i/10}function h(e){return parseFloat(e.toPrecision(12))}function c(e){var i,t,s,l,n,o,d,c;let u=0;e.forEach((e=>{(0,a.i)(e.value)?u=Math.max(r(h(e.value)),u):((0,a.i)(e.minValue)&&(u=Math.max(r(h(e.minValue)),u)),(0,a.i)(e.maxValue)&&(u=Math.max(r(h(e.maxValue)),u)),(0,a.i)(e.min)&&(u=Math.max(r(h(e.min)),u)),(0,a.i)(e.max)&&(u=Math.max(r(h(e.max)),u)))})),u=Math.min(u,3);const p=e[0],m=e[e.length-1],g=Math.min(null!==(t=null!==(i=p.minValue)&&void 0!==i?i:p.min)&&void 0!==t?t:p.value,null!==(l=null!==(s=m.minValue)&&void 0!==s?s:m.min)&&void 0!==l?l:m.value),f=Math.max(null!==(o=null!==(n=p.maxValue)&&void 0!==n?n:p.max)&&void 0!==o?o:p.value,null!==(c=null!==(d=m.maxValue)&&void 0!==d?d:m.max)&&void 0!==c?c:m.value)-g;return f/e.length<2e-7?u=8:f/e.length<2e-6?u=7:f/e.length<2e-5?u=6:f/e.length<2e-4?u=5:f/e.length<.002?u=4:f/e.length<.02?u=3:f/e.length<.2?u=Math.max(u,2):f/e.length<2&&(u=Math.max(u,1)),Math.round(u)}},63723:(e,i,t)=>{t.d(i,{a:()=>l,g:()=>a,n:()=>n});var s=t(9225);function a(){var e,i;const{layer:t}=s.s,a=t;switch(null===(e=null==a?void 0:a.renderer)||void 0===e?void 0:e.type){case"flow":return"raster-flow";case"vector-field":return"raster-vector-field";case"class-breaks":return"raster-class-breaks";case"unique-value":return"raster-unique-value";case"raster-stretch":return(0,s.k)(a)?"raster-rgb":"raster-stretch";case"raster-shaded-relief":return"raster-shaded-relief";default:return null===(i=a.renderer)||void 0===i?void 0:i.type}}function l(e,i){"renderer"in i&&(i.renderer=e)}function n(e){const{modules:i}=s.s;if(!e)return[new i.esriColor([0,0,0,1]),new i.esriColor([50,50,50,1]),new i.esriColor([73,73,73,1]),new i.esriColor([140,140,140,1]),new i.esriColor([255,255,255,1])];if("multipart"!==(null==e?void 0:e.type))return[e.fromColor,e.toColor];const t=e.colorRamps,a=t.map((e=>e.fromColor));return a.push(t[t.length-1].toColor),a}t(69283),t(49306)}}]);