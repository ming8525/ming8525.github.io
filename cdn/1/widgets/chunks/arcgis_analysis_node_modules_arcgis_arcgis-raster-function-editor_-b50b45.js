"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-b50b45"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-879f83d7.js":
/*!*******************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-879f83d7.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   F: () => (/* binding */ FunctionType),
/* harmony export */   R: () => (/* binding */ RFxListViewMode)
/* harmony export */ });
/**
 * Defines how a raster function template is applied on an image service
 */
const FunctionType = {
    Mosaic: 0,
    Item: 1,
    ItemGroup: 2
};
/**
 * CORE: the list is shown in rfx-editor-core -> has an action item in the end of the function list item.
 */
const RFxListViewMode = {
    CORE: "CORE",
    STANDARD: "STANDARD"
};



//# sourceMappingURL=interfaces-879f83d7.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/popover-utils-725493d7.js":
/*!**********************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/popover-utils-725493d7.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createNodeInteractionPopover),
/* harmony export */   r: () => (/* binding */ removeOpenableDomElement),
/* harmony export */   s: () => (/* binding */ showHelp)
/* harmony export */ });
/**
 * @param {OpenableHtmlElement | undefined} element the element to close and remove
 */
function removeOpenableDomElement(element) {
    if (element !== undefined) {
        element.open = false;
        element.remove();
    }
}
/**
 * @param {Document} document used to append
 * @param {OpenableHtmlElement} element the element to add to the dom and open
 */
/**
 *
 * @param document
 * @param element
 */
function addOpenableDomElement(document, element) {
    if (document.body.contains(element) === false) {
        document.body.appendChild(element);
        element.open = true;
    }
}
/**
 * creates  help popover component.
 * @param CreateHelpPopoverParams
 * @param {CreateHelpPopoverParams} params  parameters for creating help popover
 * @returns HTMLRfxHelpPopoverElement
 */
function createHelpPopover(params) {
    const { helpUrl, helpId, heading, referenceElement, portal, helpSrcdoc, learnMoreUrl, placement, offsetDistance, offsetSkidding } = params;
    const popover = document.createElement("rfx-help-popover");
    popover.helpUrl = helpUrl;
    popover.helpId = helpId;
    popover.heading = heading;
    popover.referenceElement = referenceElement;
    popover.placement = placement ?? "leading-start";
    popover.portal = portal;
    popover.helpSrcdoc = helpSrcdoc;
    popover.learnMoreUrl = learnMoreUrl;
    if (offsetDistance !== undefined) {
        popover.offsetDistance = offsetDistance;
    }
    if (offsetSkidding !== undefined) {
        popover.offsetSkidding = offsetSkidding;
    }
    return popover;
}
/**
 *  show help popover for helpId
 *  @param {HTMLRfxHelpPopoverElement} toolHelpPopover
 *  @param {CreateHelpPopoverParams} params needed parameters for help
 *  @returns {HTMLRfxHelpPopoverElement}  helpPopover instance
 */
function showHelp(toolHelpPopover, params) {
    const { helpUrl, helpId, heading, referenceElement, portal, helpSrcdoc, helpFileName, learnMoreUrl, offsetDistance, offsetSkidding } = params;
    if (toolHelpPopover !== undefined) {
        removeOpenableDomElement(toolHelpPopover);
        toolHelpPopover = undefined;
    }
    toolHelpPopover = createHelpPopover({
        helpUrl,
        helpId,
        heading,
        referenceElement,
        portal,
        helpSrcdoc,
        helpFileName,
        learnMoreUrl,
        offsetDistance,
        offsetSkidding
    });
    addOpenableDomElement(document, toolHelpPopover);
    return toolHelpPopover;
}
/**
 * creates  Node Interaction popover component.
 * @param CreateNodeInteractionPopoverParams
 * @param {CreateNodeInteractionPopoverParams} params  parameters for creating node Interaction popover
 * @returns HTMLCalcitePopoverElement
 */
function createNodeInteractionPopover(popover, params) {
    const { referenceElement, label, direction, offsetDistance, offsetSkidding, showPropertiesAction, handleNodeDuplicate, handleNodeRename, handleNodeDelete, handleNodeEditProperties } = params;
    if (popover !== undefined) {
        removeOpenableDomElement(popover);
        popover = undefined;
    }
    popover = document.createElement("calcite-popover");
    const popoverProps = {
        overlayPositioning: "absolute",
        autoClose: true,
        dir: direction,
        focusTrapDisabled: true,
        triggerDisabled: true,
        pointerDisabled: true,
        placement: "top",
        closable: false,
        open: true,
        referenceElement: referenceElement,
        label: label,
        offsetDistance: offsetDistance,
        offsetSkidding: offsetSkidding
    };
    Object.assign(popover, popoverProps);
    const nodeInteractionToolbar = document.createElement("rfx-node-interaction-toolbar");
    const nodeInteractionToolbarProps = {
        showPropertiesAction,
        handleNodeDuplicate,
        handleNodeRename,
        handleNodeDelete,
        handleNodeEditProperties
    };
    Object.assign(nodeInteractionToolbar, nodeInteractionToolbarProps);
    popover.append(nodeInteractionToolbar);
    addOpenableDomElement(document, popover);
    return popover;
}



//# sourceMappingURL=popover-utils-725493d7.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/resources-46b293b2.js":
/*!******************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/resources-46b293b2.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   H: () => (/* binding */ HTMLClasses),
/* harmony export */   R: () => (/* binding */ RFxPanelSlots)
/* harmony export */ });
const HTMLClasses = {
    panel: `panel`
};
const RFxPanelSlots = {
    headerContent: "header-content",
    headerActionsEnd: "header-actions-end"
};



//# sourceMappingURL=resources-46b293b2.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-core-interfaces-87709b62.js":
/*!****************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-core-interfaces-87709b62.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   E: () => (/* binding */ EditorActonBarActions)
/* harmony export */ });
const EditorActonBarActions = {
    newTemplate: "new-template",
    openTemplate: "open-template",
    addFunction: "add-function",
    addConstant: "add-constant",
    addRaster: "add-raster"
};



//# sourceMappingURL=rfx-core-interfaces-87709b62.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-editor-app-f96dc31e.js":
/*!***********************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-editor-app-f96dc31e.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   R: () => (/* binding */ RFxEditorApp)
/* harmony export */ });
/* harmony import */ var _index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-da1b7138.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/index-da1b7138.js");
/* harmony import */ var _rfx_core_interfaces_87709b62_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rfx-core-interfaces-87709b62.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-core-interfaces-87709b62.js");
/* harmony import */ var _functions_f1f2dffd_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./functions-f1f2dffd.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/functions-f1f2dffd.js");
/* harmony import */ var _help_text_34a29835_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./help-text-34a29835.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/help-text-34a29835.js");
/* harmony import */ var _arcgis_core_core_lang_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @arcgis/core/core/lang.js */ "@arcgis/core/core/lang.js");
/* harmony import */ var _localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./localization-helper-4819b67d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/localization-helper-4819b67d.js");
/* harmony import */ var _arcgis_core_identity_IdentityManager_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @arcgis/core/identity/IdentityManager.js */ "@arcgis/core/identity/IdentityManager.js");
/* harmony import */ var _arcgis_core_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @arcgis/core/core/urlUtils.js */ "@arcgis/core/core/urlUtils.js");
/* harmony import */ var _arcgis_core_layers_Layer_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @arcgis/core/layers/Layer.js */ "@arcgis/core/layers/Layer.js");
/* harmony import */ var _arcgis_core_layers_ImageryLayer_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @arcgis/core/layers/ImageryLayer.js */ "@arcgis/core/layers/ImageryLayer.js");
/* harmony import */ var _arcgis_core_smartMapping_raster_renderers_stretch_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @arcgis/core/smartMapping/raster/renderers/stretch.js */ "@arcgis/core/smartMapping/raster/renderers/stretch.js");
/* harmony import */ var _arcgis_core_request_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @arcgis/core/request.js */ "@arcgis/core/request.js");
/* harmony import */ var _arcgis_core_rest_support_AlgorithmicColorRamp_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @arcgis/core/rest/support/AlgorithmicColorRamp.js */ "@arcgis/core/rest/support/AlgorithmicColorRamp.js");
/* harmony import */ var _arcgis_core_rest_support_MultipartColorRamp_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @arcgis/core/rest/support/MultipartColorRamp.js */ "@arcgis/core/rest/support/MultipartColorRamp.js");
/* harmony import */ var _arcgis_core_Color_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @arcgis/core/Color.js */ "@arcgis/core/Color.js");
/* harmony import */ var _colorRampUtils_8bdd46c5_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./colorRampUtils-8bdd46c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/colorRampUtils-8bdd46c5.js");
/* harmony import */ var _arcgis_core_rest_geoprocessor_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @arcgis/core/rest/geoprocessor.js */ "@arcgis/core/rest/geoprocessor.js");
/* harmony import */ var _arcgis_core_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @arcgis/core/portal/PortalItem.js */ "@arcgis/core/portal/PortalItem.js");
/* harmony import */ var _resources_46b293b2_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./resources-46b293b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/resources-46b293b2.js");
/* harmony import */ var _popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./popover-utils-725493d7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/popover-utils-725493d7.js");
/* harmony import */ var _widget_factory_e81c7501_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./widget-factory-e81c7501.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/widget-factory-e81c7501.js");
/* harmony import */ var _interfaces_879f83d7_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./interfaces-879f83d7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-879f83d7.js");























const HTMLClasses = {
    host: "host",
    content: "content",
    actionBar: "action-bar",
    menuActions: "menu-actions",
    headerActions: "header-actions",
    tooltip: "tooltip",
    appContainer: "editor-container",
    overlayElement: "overlay-element",
    overlayPanel: "overlay-panel"
};
const CSS_UTILITY = {
    rtl: "arcgis--rtl"
};
const Slot = {
    actionBar: "action-bar"
};

const DiagramZoomInCommand = (receiver) => {
    return {
        execute: async () => {
            await receiver.zoomIn();
        }
    };
};
const DiagramZoomOutCommand = (receiver) => {
    return {
        execute: async () => {
            await receiver.zoomOut();
        }
    };
};
const DiagramAutoLayoutCommand = (receiver) => {
    return {
        execute: async () => {
            await receiver.autoLayout();
        }
    };
};
const DiagramStretchCommand = (receiver) => {
    return {
        execute: async () => {
            await receiver.stretch();
        }
    };
};
const DiagramPanCommand = (receiver) => {
    return {
        execute: async () => {
            await receiver.pan();
        }
    };
};
const AddRFxFunctionCommand = (receiver) => {
    return {
        execute: async (rfxTemplate) => {
            await receiver.addRFxFunction(rfxTemplate);
        }
    };
};
const AddRasterNodeCommand = (receiver) => {
    return {
        execute: async () => {
            await receiver.addRasterNode();
        }
    };
};
const AddScalarNodeCommand = (receiver) => {
    return {
        execute: async () => {
            await receiver.addScalarNode();
        }
    };
};
const AddRFTPortalItemCommand = (receiver) => {
    return {
        execute: async (portalItemId) => {
            await receiver.addRFTPortalItem(portalItemId);
        }
    };
};

const rightToolBarBuilder = ({ handleRFTLaunch, handleRFTSave, handleRFTSaveAs, handleOpenTemplateEditor, handleRFTShare }) => ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-rft-interaction-toolbar", { handleRFTLaunch: handleRFTLaunch, handleRFTSave: handleRFTSave, handleRFTSaveAs: handleRFTSaveAs, handleOpenTemplateEditor: handleOpenTemplateEditor, handleRFTShare: handleRFTShare }));
const leftToolBarBuilder = ({ handleDiagramZoomIn, handleDiagramZoomOut, handleDiagramAutoLayout, handleDiagramStretch, handleDiagramSelect, handleDiagramPan }) => ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-diagram-interaction-toolbar", { handleDiagramZoomIn: handleDiagramZoomIn, handleDiagramZoomOut: handleDiagramZoomOut, handleDiagramAutoLayout: handleDiagramAutoLayout, handleDiagramStretch: handleDiagramStretch, handleDiagramSelect: handleDiagramSelect, handleDiagramPan: handleDiagramPan }));
const rfxTemplateEditorBuilder = ({ heading, data, handlePanelClose, handlePanelCancel, handlePanelOk }) => ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-panel", { heading: heading, data: data, class: {
        [HTMLClasses.overlayElement]: true,
        [HTMLClasses.overlayPanel]: true
    }, showFooter: true, closable: true, onPanelOkClick: handlePanelOk, onPanelCancelClick: handlePanelCancel, onCalcitePanelClose: handlePanelClose },
    (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-template-editor", null)));
const rfxListViewBuilder = ({ handleTriggerSelectFunction, handlePanelClose, heading }) => ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-panel", { heading: heading, closable: true, showFooter: false, closed: false, class: {
        [HTMLClasses.overlayElement]: true,
        [HTMLClasses.overlayPanel]: true
    }, onCalcitePanelClose: handlePanelClose },
    (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-list-view", { mode: _interfaces_879f83d7_js__WEBPACK_IMPORTED_MODULE_21__.R.CORE, onTriggerSelectFunction: handleTriggerSelectFunction })));
const rfxArgDetailsEditorBuilder = ({ rfxTemplate, handlePanelClose, headerElementComponent, helpActionComponent }) => ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-panel", { heading: rfxTemplate?.name, closable: true, showFooter: true, customHeader: true, customHeaderAction: true, class: {
        [HTMLClasses.overlayElement]: true,
        [HTMLClasses.overlayPanel]: true
    }, onCalcitePanelClose: handlePanelClose },
    headerElementComponent,
    helpActionComponent,
    (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-details-editor", { rfxTemplate: rfxTemplate })));
const rfxBrowseLayersDialogBuilder = ({ heading, handlePanelClose }) => ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-panel", { heading: heading, closable: true, showFooter: true, class: {
        [HTMLClasses.overlayElement]: true,
        [HTMLClasses.overlayPanel]: true
    }, onCalcitePanelClose: handlePanelClose },
    (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-select-layer-panel", null)));

const rfxEditorAppCss = ":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh}.host{height:100%;width:100%}.content{height:100%;display:flex}.action-bar{height:100%;border-width:0 1px 0 0;border-style:solid;border-color:var(--calcite-color-border-2)}.menu-actions{display:inline-flex;justify-self:stretch}.header-actions{height:100%}.tooltip{white-space:nowrap}.arcgis--rtl .action-bar{border-width:0 0 0 1px}.editor-container{position:relative;}.overlay-element{z-index:3;box-shadow:0 0 5px rgba(0, 0, 0, 0.2);border-radius:0.25rem}.overlay-panel{max-height:32rem;max-width:22rem;width:22rem}";

const RFxEditorApp = class {
    constructor(hostRef) {
        (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.analysisRFTLaunch = (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "analysisRFTLaunch", 7);
        this.rfxCoreServices = {
            diagramZoomInCommand: undefined,
            diagramZoomOutCommand: undefined,
            diagramAutoLayoutCommand: undefined,
            diagramStretchCommand: undefined,
            diagramPanCommand: undefined,
            addRFxFunctionCommand: undefined,
            addRasterNodeCommand: undefined,
            addScalarNodeCommand: undefined,
            addRFTPortalItemCommand: undefined
        };
        /**
         * The order in which elements are declared matters, especially for elements that are placed in the "left" slot.
         * In the "left" slot, the first element declared will be positioned on the leftmost side, while in the "right" slot,
         * the first element declared will be on the rightmost side.
         *
         * NOTE that while slots can be used in a generic manner, slots can be generic but will depend on the implemention of
         * the UI we are conforming to, In this context, we are referring to the behavior of slots in esri-core,
         * where there are only two slots available, and they are designed to display elements in the manner described above.
         */
        this.overlayElementsConfig = {
            leftToolBar: {
                slot: "left",
                visible: true,
                builder: () => leftToolBarBuilder({
                    handleDiagramZoomIn: this.handleDiagramZoomIn,
                    handleDiagramZoomOut: this.handleDiagramZoomOut,
                    handleDiagramAutoLayout: this.handleDiagramAutoLayout,
                    handleDiagramStretch: this.handleDiagramStretch,
                    handleDiagramSelect: this.handleDiagramSelect,
                    handleDiagramPan: this.handleDiagramPan
                }),
                type: "static"
            },
            rightToolBar: {
                slot: "right",
                visible: true,
                builder: () => rightToolBarBuilder({
                    handleRFTLaunch: this.handleRFTLaunch,
                    handleRFTSave: this.handleRFTSave,
                    handleRFTSaveAs: this.handleRFTSaveAs,
                    handleOpenTemplateEditor: this.handleOpenTemplateEditor,
                    handleRFTShare: this.handleRFTShare
                }),
                type: "static"
            },
            rfxTemplateEditor: {
                slot: "right",
                visible: false,
                builder: ({ templatePropertiesTitle: heading }) => rfxTemplateEditorBuilder({
                    heading,
                    handlePanelCancel: this.handleRFxTemplateEditorPanelCancel,
                    handlePanelOk: this.handleRFxTemplateEditorPanelOk,
                    handlePanelClose: this.handleRFxTemplateEditorPanelClose,
                    data: {
                        trialData: "trialData"
                    }
                })
            },
            rfxListView: {
                slot: "left",
                visible: false,
                builder: ({ addRasterFunctionTitle: heading }) => rfxListViewBuilder({
                    heading,
                    handleTriggerSelectFunction: this.handleRFxListViewTriggerSelectFunction,
                    handlePanelClose: this.handleRFxListViewPanelClose
                }),
                type: "static"
            },
            rfxArgDetailsEditor: {
                slot: "right",
                visible: false,
                builder: ({ detailsEditorRfxTemplate: rfxTemplate }) => rfxArgDetailsEditorBuilder({
                    rfxTemplate,
                    handlePanelClose: this.handleRFxDetailsEditorPanelClose,
                    headerElementComponent: ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { slot: _resources_46b293b2_js__WEBPACK_IMPORTED_MODULE_18__.R.headerContent, ref: (el) => {
                            // TODO: Fix this in future somehow
                            this.headerElement = el;
                        } }, rfxTemplate?.name)),
                    helpActionComponent: ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-action", { label: "", text: "", icon: "information", slot: _resources_46b293b2_js__WEBPACK_IMPORTED_MODULE_18__.R.headerActionsEnd, class: HTMLClasses.headerActions, onClick: this.handleRFxDetailsEditorHeadingHelpClick }))
                })
            },
            rfxBrowseLayersDialog: {
                slot: "right",
                visible: false,
                builder: ({ browseLayerDialogTitle: heading }) => rfxBrowseLayersDialogBuilder({
                    heading,
                    handlePanelClose: this.handleRFxBrowseLayersPanelClose
                })
            }
        };
        this.initializeRFxEditorCore = (rfxEditorCoreElement) => {
            const rfxEditorCore = rfxEditorCoreElement;
            this.rfxEditorCoreElement = rfxEditorCoreElement;
            // Assign services here
            this.rfxCoreServices.diagramZoomInCommand = DiagramZoomInCommand(rfxEditorCore);
            this.rfxCoreServices.diagramZoomOutCommand = DiagramZoomOutCommand(rfxEditorCore);
            this.rfxCoreServices.diagramAutoLayoutCommand = DiagramAutoLayoutCommand(rfxEditorCore);
            this.rfxCoreServices.diagramStretchCommand = DiagramStretchCommand(rfxEditorCore);
            this.rfxCoreServices.diagramPanCommand = DiagramPanCommand(rfxEditorCore);
            this.rfxCoreServices.addRFxFunctionCommand = AddRFxFunctionCommand(rfxEditorCore);
            this.rfxCoreServices.addRasterNodeCommand = AddRasterNodeCommand(rfxEditorCore);
            this.rfxCoreServices.addScalarNodeCommand = AddScalarNodeCommand(rfxEditorCore);
            this.rfxCoreServices.addRFTPortalItemCommand = AddRFTPortalItemCommand(rfxEditorCore);
        };
        this.afterCreatePanel = (node) => {
            console.log("rfx-editor-app: panel created.", node);
        };
        this.handleNewTemplateClick = () => { };
        this.handleOpenTemplateClick = () => {
            const { portal } = this;
            this.itemBrowserElement = (0,_widget_factory_e81c7501_js__WEBPACK_IMPORTED_MODULE_20__.c)({
                header: this.strings.browseRFT,
                portal,
                user: portal.user,
                onClose: this.closItemBrowser,
                onSelection: this.handleItemBrowserSelection
            });
            document.body.appendChild(this.itemBrowserElement);
        };
        this.handleItemBrowserSelection = async (event) => {
            if (event.detail !== null) {
                const portalItemId = event.detail.id;
                try {
                    await this.rfxCoreServices.addRFTPortalItemCommand.execute(portalItemId);
                }
                catch (error) {
                    console.error("Unable to display selected Raster function template.");
                    // show browse failure alert
                    // this.showFailureAlert({ title: this.strings.rftLoadFail });
                }
            }
        };
        this.handleAddFunctionClick = () => {
            this.visibilityReducer({ key: "rfxListView", visible: true });
        };
        this.handleAddConstantClick = () => {
            this.rfxCoreServices.addScalarNodeCommand.execute();
        };
        this.handleAddRasterClick = () => {
            this.rfxCoreServices.addRasterNodeCommand.execute();
        };
        this.handleRunClick = () => { };
        this.handleSaveClick = () => { };
        this.handleCloseClick = () => { };
        this.handleDiagramZoomIn = () => {
            this.rfxCoreServices.diagramZoomInCommand.execute();
        };
        this.handleDiagramZoomOut = () => {
            this.rfxCoreServices.diagramZoomOutCommand.execute();
        };
        this.handleDiagramAutoLayout = () => {
            this.rfxCoreServices.diagramAutoLayoutCommand.execute();
        };
        this.handleDiagramStretch = () => {
            this.rfxCoreServices.diagramStretchCommand.execute();
        };
        this.handleDiagramPan = () => {
            this.rfxCoreServices.diagramPanCommand.execute();
        };
        this.handleDiagramSelect = () => {
            // FIXME avoid logic to toggle in the same command
            this.rfxCoreServices.diagramPanCommand.execute();
        };
        this.handleRFTLaunch = () => {
            this.analysisRFTLaunch.emit(this.rfxTemplate);
        };
        this.handleRFTSave = () => {
            console.log("handleRFTSave");
        };
        this.closeSaveModal = () => {
            if (this.saveModalElement !== undefined) {
                this.saveModalElement.removeEventListener("cancelClick", this.closeSaveModal);
                this.saveModalElement.remove();
                this.saveModalElement = undefined;
            }
        };
        this.closItemBrowser = () => {
            if (this.itemBrowserElement !== undefined) {
                this.itemBrowserElement.removeEventListener("rfxItemBrowserClose", this.closItemBrowser);
                this.itemBrowserElement.remove();
                this.itemBrowserElement = undefined;
            }
        };
        this.handleRFTSaveAs = () => {
            console.log("handleRFTSaveAs");
            const { portal, portalItem, closeSaveModal } = this;
            this.saveModalElement?.remove();
            this.saveModalElement = (0,_widget_factory_e81c7501_js__WEBPACK_IMPORTED_MODULE_20__.a)({
                portal,
                portalItem,
                onCancel: closeSaveModal
            });
            document.body.appendChild(this.saveModalElement);
        };
        this.handleOpenTemplateEditor = () => {
            this.visibilityReducer({ key: "rfxTemplateEditor", visible: true });
        };
        this.handleRFTShare = () => {
            console.log("handleRFTShare");
        };
        this.handleRFxListViewTriggerSelectFunction = async (event) => {
            event.stopPropagation();
            const { detail: rfxfunctionTitle } = event;
            // TODO: remove when node click is enabled
            const rfxTemplate = await (0,_functions_f1f2dffd_js__WEBPACK_IMPORTED_MODULE_2__.d)(rfxfunctionTitle);
            this.detailsEditorRfxTemplate = rfxTemplate;
            this.rfxCoreServices.addRFxFunctionCommand.execute(rfxTemplate);
            // this.visibilityReducer({ key: "rfxArgDetailsEditor", visible: true });
        };
        this.handleRFxListViewPanelClose = (event) => {
            event.stopPropagation();
            this.visibilityReducer({ key: "rfxListView", visible: false });
        };
        this.handleRFxTemplateEditorPanelClose = (event) => {
            event.stopPropagation();
            this.visibilityReducer({ key: "rfxTemplateEditor", visible: false });
        };
        this.handleRFxTemplateEditorPanelOk = (event) => {
            event.stopPropagation();
            const { detail: value } = event;
            console.log(value);
        };
        this.handleRFxTemplateEditorPanelCancel = (event) => {
            event.stopPropagation();
            const { detail: value } = event;
            console.log(value);
        };
        this.handleRFxDetailsEditorPanelClose = (event) => {
            event.stopPropagation();
            this.visibilityReducer({ key: "rfxArgDetailsEditor", visible: false });
        };
        this.handleRFxBrowseLayersPanelClose = (event) => {
            event.stopPropagation();
            this.visibilityReducer({ key: "rfxBrowseLayersDialog", visible: false });
        };
        /**
         * Handles the change event of Analysis Help Popover close
         * @category Private
         */
        this.handlePopoverClose = () => {
            // Sort of garbage collection, done to ensure toolHelpPopover is dispose correctly once closed.
            (0,_popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_19__.r)(this.toolHelpPopover);
        };
        /**
         * Handles the click event of Heading Help
         * @category Private
         */
        this.handleRFxDetailsEditorHeadingHelpClick = async () => {
            // TODO: remove when node click is enabled
            // TODO: looks like rfxName and rfxTitle are two different things
            // Pass rfxName as identifier, rfxTitle as Panel name
            const rfxTemplate = this.detailsEditorRfxTemplate;
            const rfxIdentifer = (0,_functions_f1f2dffd_js__WEBPACK_IMPORTED_MODULE_2__.h)(rfxTemplate);
            const { helpTemplate: helpSrcdoc, learnMoreUrl } = await (0,_help_text_34a29835_js__WEBPACK_IMPORTED_MODULE_3__.b)({
                rfxName: rfxIdentifer,
                rfxTemplate,
                portal: undefined // this.portal
            });
            this.toolHelpPopover = (0,_popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_19__.s)(this.toolHelpPopover, {
                helpSrcdoc,
                helpId: "toolDescription",
                heading: rfxTemplate.name,
                referenceElement: this.headerElement,
                learnMoreUrl,
                offsetDistance: 25,
                offsetSkidding: 0 // vertical axis
            });
            this.toolHelpPopover.addEventListener("rfxHelpPopoverClose", this.handlePopoverClose);
        };
        this.showRfxList = false;
        this.mapView = undefined;
        this.mapLayers = undefined;
        this.portal = undefined;
        this.portalItem = undefined;
        this.detailsEditorRfxTemplate = undefined;
        this.renderFlag = false;
    }
    // TODO: Since a slot signifies variable components we can't have this mechanism, improve in future
    handleActionBarClick(payload) {
        switch (payload.detail.actionId) {
            case _rfx_core_interfaces_87709b62_js__WEBPACK_IMPORTED_MODULE_1__.E.newTemplate:
                this.handleNewTemplateClick();
                break;
            case _rfx_core_interfaces_87709b62_js__WEBPACK_IMPORTED_MODULE_1__.E.openTemplate:
                this.handleOpenTemplateClick();
                break;
            case _rfx_core_interfaces_87709b62_js__WEBPACK_IMPORTED_MODULE_1__.E.addFunction:
                this.handleAddFunctionClick();
                break;
            case _rfx_core_interfaces_87709b62_js__WEBPACK_IMPORTED_MODULE_1__.E.addConstant:
                this.handleAddConstantClick();
                break;
            case _rfx_core_interfaces_87709b62_js__WEBPACK_IMPORTED_MODULE_1__.E.addRaster:
                this.handleAddRasterClick();
        }
        console.log("actionBar clicked");
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentWillLoad() {
        ({ strings: this.strings, dir: this.direction } = await (0,_localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_5__.b)(this.hostElement, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.g)(`.`)));
    }
    disconnectedCallback() {
        (0,_popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_19__.r)(this.toolHelpPopover);
    }
    // --------------------------------------------------------------------------
    //
    //  Private methods
    //
    // --------------------------------------------------------------------------
    // Reducer to update visibility
    visibilityReducer({ key, visible }) {
        const MAX_ITEMS_VISIBLE_IN_SLOT = 2;
        const element = this.overlayElementsConfig[key];
        // Rule 1: Check if the item is already visible.
        if (element.visible === visible) {
            return; // No change needed
        }
        if (visible === true) {
            // Find all items in the same slot.
            const sameSlotItems = Object.values(this.overlayElementsConfig).filter((item) => item.slot === element.slot);
            // Rule 2: If there are more than one visible items in the same slot, hide all but the first one.
            if (sameSlotItems.length >= MAX_ITEMS_VISIBLE_IN_SLOT) {
                sameSlotItems.slice(1).forEach((item) => {
                    item.visible = false;
                    // Optionally, you can call a close method if it exists.
                    // item.close?.();
                });
            }
        }
        element.visible = visible;
        this.scheduleRenderer();
    }
    scheduleRenderer() {
        this.renderFlag = !this.renderFlag;
    }
    /**
     * Renders overlay elements based on the configuration.
     * @returns An array of components to be rendered in the overlay slots.
     */
    renderOverlayElements() {
        const detailsEditorRfxTemplate = this.detailsEditorRfxTemplate;
        const addRasterFunctionTitle = this.strings.addRasterFunctionTitle;
        const templatePropertiesTitle = this.strings.templatePropertiesTitle;
        const browseLayerDialogTitle = this.strings.browseLayerDialogTitle;
        const dynamicBuilderProps = {
            detailsEditorRfxTemplate,
            addRasterFunctionTitle,
            templatePropertiesTitle,
            browseLayerDialogTitle
        };
        const overlayElementsConfig = this.overlayElementsConfig;
        const overlayElementsKeys = Object.keys(overlayElementsConfig);
        const overlayElements = overlayElementsKeys.map((key) => {
            const elementConfig = overlayElementsConfig[key];
            if (!elementConfig.visible) {
                return [];
            }
            const component = elementConfig?.builder?.(dynamicBuilderProps);
            component.$attrs$.slot = elementConfig.slot;
            return component;
        });
        return overlayElements;
    }
    /**
     * Private method to render the editor core UI
     * @category Private
     */
    _renderEditorCoreUI() {
        return ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-editor-core", { ref: this.initializeRFxEditorCore, onRfxCoreNodeEditProperties: (event) => {
                event.stopPropagation();
                const { detail: value } = event;
                console.log(value);
                switch (value.dataType) {
                    case "Raster" /* ToolArgumentDataType.Raster */:
                        this.visibilityReducer({ key: "rfxBrowseLayersDialog", visible: true });
                        break;
                    case "Tool" /* ToolArgumentDataType.Tool */:
                        this.visibilityReducer({ key: "rfxArgDetailsEditor", visible: true });
                        this.detailsEditorRfxTemplate = value.json;
                        break;
                }
            } }, this.renderOverlayElements()));
    }
    /**
     * @category Lifecycle
     * Render lifecycle method
     */
    render() {
        console.log("rfx-editor-app render");
        return ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.H, { class: HTMLClasses.host }, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: {
                [HTMLClasses.content]: true,
                [CSS_UTILITY.rtl]: this.direction === "rtl"
            } }, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", { name: Slot.actionBar }), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-panel", { heading: "", ref: this.afterCreatePanel }, this._renderEditorCoreUI()))));
    }
    static get assetsDirs() { return ["t9n"]; }
    get hostElement() { return (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.a)(this); }
};
RFxEditorApp.style = rfxEditorAppCss;



//# sourceMappingURL=rfx-editor-app-f96dc31e.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-editor-app.entry.js":
/*!********************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-editor-app.entry.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   rfx_editor_app: () => (/* reexport safe */ _rfx_editor_app_f96dc31e_js__WEBPACK_IMPORTED_MODULE_0__.R)
/* harmony export */ });
/* harmony import */ var _rfx_editor_app_f96dc31e_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rfx-editor-app-f96dc31e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-editor-app-f96dc31e.js");
/* harmony import */ var _index_da1b7138_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-da1b7138.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/index-da1b7138.js");
/* harmony import */ var _rfx_core_interfaces_87709b62_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./rfx-core-interfaces-87709b62.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-core-interfaces-87709b62.js");
/* harmony import */ var _functions_f1f2dffd_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./functions-f1f2dffd.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/functions-f1f2dffd.js");
/* harmony import */ var _arcgis_core_core_lang_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @arcgis/core/core/lang.js */ "@arcgis/core/core/lang.js");
/* harmony import */ var _resources_27c66f5c_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./resources-27c66f5c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/resources-27c66f5c.js");
/* harmony import */ var _localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./localization-helper-4819b67d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/localization-helper-4819b67d.js");
/* harmony import */ var _type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./type-gaurds-1840747f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/type-gaurds-1840747f.js");
/* harmony import */ var _getTag_96af029d_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./_getTag-96af029d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/_getTag-96af029d.js");
/* harmony import */ var _help_text_34a29835_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./help-text-34a29835.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/help-text-34a29835.js");
/* harmony import */ var _rfx_args_helper_ab401543_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./rfx-args-helper-ab401543.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-args-helper-ab401543.js");
/* harmony import */ var _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./interfaces-d0c68944.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-d0c68944.js");
/* harmony import */ var _arcgis_core_identity_IdentityManager_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @arcgis/core/identity/IdentityManager.js */ "@arcgis/core/identity/IdentityManager.js");
/* harmony import */ var _arcgis_core_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @arcgis/core/core/urlUtils.js */ "@arcgis/core/core/urlUtils.js");
/* harmony import */ var _arcgis_core_layers_Layer_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @arcgis/core/layers/Layer.js */ "@arcgis/core/layers/Layer.js");
/* harmony import */ var _arcgis_core_layers_ImageryLayer_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @arcgis/core/layers/ImageryLayer.js */ "@arcgis/core/layers/ImageryLayer.js");
/* harmony import */ var _arcgis_core_smartMapping_raster_renderers_stretch_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @arcgis/core/smartMapping/raster/renderers/stretch.js */ "@arcgis/core/smartMapping/raster/renderers/stretch.js");
/* harmony import */ var _arcgis_core_request_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @arcgis/core/request.js */ "@arcgis/core/request.js");
/* harmony import */ var _arcgis_core_rest_support_AlgorithmicColorRamp_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @arcgis/core/rest/support/AlgorithmicColorRamp.js */ "@arcgis/core/rest/support/AlgorithmicColorRamp.js");
/* harmony import */ var _arcgis_core_rest_support_MultipartColorRamp_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @arcgis/core/rest/support/MultipartColorRamp.js */ "@arcgis/core/rest/support/MultipartColorRamp.js");
/* harmony import */ var _arcgis_core_Color_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @arcgis/core/Color.js */ "@arcgis/core/Color.js");
/* harmony import */ var _colorRampUtils_8bdd46c5_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./colorRampUtils-8bdd46c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/colorRampUtils-8bdd46c5.js");
/* harmony import */ var _arcgis_core_rest_geoprocessor_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @arcgis/core/rest/geoprocessor.js */ "@arcgis/core/rest/geoprocessor.js");
/* harmony import */ var _arcgis_core_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! @arcgis/core/portal/PortalItem.js */ "@arcgis/core/portal/PortalItem.js");
/* harmony import */ var _resources_46b293b2_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./resources-46b293b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/resources-46b293b2.js");
/* harmony import */ var _popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./popover-utils-725493d7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/popover-utils-725493d7.js");
/* harmony import */ var _widget_factory_e81c7501_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./widget-factory-e81c7501.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/widget-factory-e81c7501.js");
/* harmony import */ var _interfaces_879f83d7_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./interfaces-879f83d7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-879f83d7.js");





























//# sourceMappingURL=rfx-editor-app.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/widget-factory-e81c7501.js":
/*!***********************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/widget-factory-e81c7501.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ createRFxSaveModal),
/* harmony export */   b: () => (/* binding */ buildTitlePane),
/* harmony export */   c: () => (/* binding */ createRFxItemBrowser),
/* harmony export */   d: () => (/* binding */ buildRfxSection),
/* harmony export */   e: () => (/* binding */ createRFxLabelWrapper)
/* harmony export */ });
/* harmony import */ var _type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./type-gaurds-1840747f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/type-gaurds-1840747f.js");


/**
 * Rfx section widget
 * @param {RFxWidgetProps['label']} label - label of the section
 * @param {RFxWidgetProps['open']} open whether or not the component is open
 * @returns {HTMLRfxSectionElement} - Rfx section component
 */
const buildRfxSection = ({ label, open }) => {
    const rfxSection = document.createElement("rfx-section");
    rfxSection.label = label;
    rfxSection.open = open;
    return rfxSection;
};
/**
 * Rfx wrapper around calcite-block, used as function panel
 * @param {RFxWidgetProps['content']} content - content of the section
 * @param {RFxWidgetProps['title']} title - title of the section
 * @param {RFxWidgetProps['isFunctionChain']} isFunctionChain whether or not the rfxtemplate being built is Function Chain
 * @param {RFxWidgetProps['unsupportedWarningComponent']} unsupportedWarningComponent HTMLCalciteNoticeElement notice to append to panel incase rfxtemplate has unsupported ui-overrrdies / data/domain types
 * @returns {HTMLCalciteBlockElement} - Rfx section component
 */
const buildTitlePane = ({ content, unsupportedWarningComponent, title, isFunctionChain }) => {
    const titlePane = document.createElement("calcite-block");
    titlePane.open = true;
    // if function chain show Function name as heading
    if (isFunctionChain === true) {
        titlePane.heading = title;
        titlePane.collapsible = true;
        titlePane.headingLevel = 3;
    }
    if (!(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_0__.i)(unsupportedWarningComponent)) {
        titlePane.appendChild(unsupportedWarningComponent);
    }
    titlePane.appendChild(content);
    return titlePane;
};
/**
 * Rfx wrapper around rfx-block, used to display label of function parameters
 * @param {RFxWidgetProps['label']} label - label of the parameter
 * @param {RFxWidgetProps['hideHelp']} hideHelp whether or not to show the help icon next to parameter label
 * @param {RFxWidgetProps['onHelpActionClick']} onHelpActionClick function to be executed when helpAction is clicked
 * @returns {HTMLCalciteBlockElement} - Rfx label component
 */
const createRFxLabelWrapper = ({ label, hideHelp = false, onHelpActionClick }) => {
    const labelWrapper = document.createElement("rfx-label");
    labelWrapper.label = label;
    labelWrapper.hideHelp = hideHelp;
    labelWrapper.addEventListener("rfxLabelHelpActionClick", onHelpActionClick);
    return labelWrapper;
};
/**
 * To create save dialgoue on save or save as click
 * @param {RFxModalProps['portal']} portal - portal to which the item should be saved
 * @param {RFxModalProps['portalItem']} portalItem potal item details to be shown on save dialogue
 * @param {RFxModalProps['onCancelClick']} onCancelClick function to be executed when cancel is clicked
 * @returns {HTMLRFxSaveModalElement} - Rfx save modal element
 */
const createRFxSaveModal = ({ portal, portalItem, onCancel }) => {
    const saveModalElement = document.createElement("rfx-save-modal");
    saveModalElement.portal = portal;
    saveModalElement.portalItem = portalItem;
    saveModalElement.addEventListener("cancelClick", onCancel);
    return saveModalElement;
};
/**
 * To create item broser for RFT browsing
 * @param {RfxSaveModalProps['portal']} portal - portal to which the item should be saved
 * @param {RFxWidgetProps['portalItem']} portalItem potal item details to be shown on save dialogue
 * @param {RFxWidgetProps['onCancelClick']} onCancelClick function to be executed when cancel is clicked
 * @returns {HTMLRFxSaveModalElement} - Rfx save modal element
 */
const createRFxItemBrowser = ({ header, portal, user, onClose, onSelection }) => {
    const itemBrowserElement = document.createElement("rfx-item-browser");
    itemBrowserElement.portal = portal;
    itemBrowserElement.user = user;
    itemBrowserElement.header = header;
    itemBrowserElement.filter = `(type: "Raster function template")`;
    itemBrowserElement.selectionMode = "single";
    itemBrowserElement.addEventListener("rfxItemBrowserClose", onClose);
    itemBrowserElement.addEventListener("rfxItemBrowserSelection", onSelection);
    return itemBrowserElement;
};



//# sourceMappingURL=widget-factory-e81c7501.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3JfLWI1MGI0NS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFbUQ7O0FBRW5EOzs7Ozs7Ozs7Ozs7Ozs7O0FDbEJBO0FBQ0EsV0FBVyxpQ0FBaUM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsVUFBVTtBQUNyQixXQUFXLHFCQUFxQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHlCQUF5QjtBQUNwQztBQUNBO0FBQ0E7QUFDQSxZQUFZLDBIQUEwSDtBQUN0STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkJBQTJCO0FBQ3ZDLFlBQVkseUJBQXlCO0FBQ3JDLGNBQWMsNEJBQTRCO0FBQzFDO0FBQ0E7QUFDQSxZQUFZLDZIQUE2SDtBQUN6STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxvQ0FBb0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4S0FBOEs7QUFDMUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QzNDLGFBQWEseUJBQXlCO0FBQ3RDO0FBQ0EsOEJBQThCLDhCQUE4QjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyw2QkFBNkI7QUFDeEMsV0FBVyw4QkFBOEI7QUFDekMsV0FBVyxpQ0FBaUM7QUFDNUMsYUFBYSx5QkFBeUI7QUFDdEM7QUFDQSxnQ0FBZ0MsNENBQTRDO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVxSTs7QUFFckkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcmNnaXMtcmFzdGVyLWZ1bmN0aW9uLWVkaXRvci9kaXN0L2VzbS9pbnRlcmZhY2VzLTg3OWY4M2Q3LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FyY2dpcy1yYXN0ZXItZnVuY3Rpb24tZWRpdG9yL2Rpc3QvZXNtL3BvcG92ZXItdXRpbHMtNzI1NDkzZDcuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3IvZGlzdC9lc20vcmVzb3VyY2VzLTQ2YjI5M2IyLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FyY2dpcy1yYXN0ZXItZnVuY3Rpb24tZWRpdG9yL2Rpc3QvZXNtL3JmeC1jb3JlLWludGVyZmFjZXMtODc3MDliNjIuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3IvZGlzdC9lc20vcmZ4LWVkaXRvci1hcHAtZjk2ZGMzMWUuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3IvZGlzdC9lc20vcmZ4LWVkaXRvci1hcHAuZW50cnkuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3IvZGlzdC9lc20vd2lkZ2V0LWZhY3RvcnktZTgxYzc1MDEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWZpbmVzIGhvdyBhIHJhc3RlciBmdW5jdGlvbiB0ZW1wbGF0ZSBpcyBhcHBsaWVkIG9uIGFuIGltYWdlIHNlcnZpY2VcbiAqL1xuY29uc3QgRnVuY3Rpb25UeXBlID0ge1xuICAgIE1vc2FpYzogMCxcbiAgICBJdGVtOiAxLFxuICAgIEl0ZW1Hcm91cDogMlxufTtcbi8qKlxuICogQ09SRTogdGhlIGxpc3QgaXMgc2hvd24gaW4gcmZ4LWVkaXRvci1jb3JlIC0+IGhhcyBhbiBhY3Rpb24gaXRlbSBpbiB0aGUgZW5kIG9mIHRoZSBmdW5jdGlvbiBsaXN0IGl0ZW0uXG4gKi9cbmNvbnN0IFJGeExpc3RWaWV3TW9kZSA9IHtcbiAgICBDT1JFOiBcIkNPUkVcIixcbiAgICBTVEFOREFSRDogXCJTVEFOREFSRFwiXG59O1xuXG5leHBvcnQgeyBGdW5jdGlvblR5cGUgYXMgRiwgUkZ4TGlzdFZpZXdNb2RlIGFzIFIgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW50ZXJmYWNlcy04NzlmODNkNy5qcy5tYXAiLCIvKipcbiAqIEBwYXJhbSB7T3BlbmFibGVIdG1sRWxlbWVudCB8IHVuZGVmaW5lZH0gZWxlbWVudCB0aGUgZWxlbWVudCB0byBjbG9zZSBhbmQgcmVtb3ZlXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZU9wZW5hYmxlRG9tRWxlbWVudChlbGVtZW50KSB7XG4gICAgaWYgKGVsZW1lbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBlbGVtZW50Lm9wZW4gPSBmYWxzZTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7RG9jdW1lbnR9IGRvY3VtZW50IHVzZWQgdG8gYXBwZW5kXG4gKiBAcGFyYW0ge09wZW5hYmxlSHRtbEVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdG8gYWRkIHRvIHRoZSBkb20gYW5kIG9wZW5cbiAqL1xuLyoqXG4gKlxuICogQHBhcmFtIGRvY3VtZW50XG4gKiBAcGFyYW0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBhZGRPcGVuYWJsZURvbUVsZW1lbnQoZG9jdW1lbnQsIGVsZW1lbnQpIHtcbiAgICBpZiAoZG9jdW1lbnQuYm9keS5jb250YWlucyhlbGVtZW50KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICAgICAgZWxlbWVudC5vcGVuID0gdHJ1ZTtcbiAgICB9XG59XG4vKipcbiAqIGNyZWF0ZXMgIGhlbHAgcG9wb3ZlciBjb21wb25lbnQuXG4gKiBAcGFyYW0gQ3JlYXRlSGVscFBvcG92ZXJQYXJhbXNcbiAqIEBwYXJhbSB7Q3JlYXRlSGVscFBvcG92ZXJQYXJhbXN9IHBhcmFtcyAgcGFyYW1ldGVycyBmb3IgY3JlYXRpbmcgaGVscCBwb3BvdmVyXG4gKiBAcmV0dXJucyBIVE1MUmZ4SGVscFBvcG92ZXJFbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUhlbHBQb3BvdmVyKHBhcmFtcykge1xuICAgIGNvbnN0IHsgaGVscFVybCwgaGVscElkLCBoZWFkaW5nLCByZWZlcmVuY2VFbGVtZW50LCBwb3J0YWwsIGhlbHBTcmNkb2MsIGxlYXJuTW9yZVVybCwgcGxhY2VtZW50LCBvZmZzZXREaXN0YW5jZSwgb2Zmc2V0U2tpZGRpbmcgfSA9IHBhcmFtcztcbiAgICBjb25zdCBwb3BvdmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInJmeC1oZWxwLXBvcG92ZXJcIik7XG4gICAgcG9wb3Zlci5oZWxwVXJsID0gaGVscFVybDtcbiAgICBwb3BvdmVyLmhlbHBJZCA9IGhlbHBJZDtcbiAgICBwb3BvdmVyLmhlYWRpbmcgPSBoZWFkaW5nO1xuICAgIHBvcG92ZXIucmVmZXJlbmNlRWxlbWVudCA9IHJlZmVyZW5jZUVsZW1lbnQ7XG4gICAgcG9wb3Zlci5wbGFjZW1lbnQgPSBwbGFjZW1lbnQgPz8gXCJsZWFkaW5nLXN0YXJ0XCI7XG4gICAgcG9wb3Zlci5wb3J0YWwgPSBwb3J0YWw7XG4gICAgcG9wb3Zlci5oZWxwU3JjZG9jID0gaGVscFNyY2RvYztcbiAgICBwb3BvdmVyLmxlYXJuTW9yZVVybCA9IGxlYXJuTW9yZVVybDtcbiAgICBpZiAob2Zmc2V0RGlzdGFuY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwb3BvdmVyLm9mZnNldERpc3RhbmNlID0gb2Zmc2V0RGlzdGFuY2U7XG4gICAgfVxuICAgIGlmIChvZmZzZXRTa2lkZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHBvcG92ZXIub2Zmc2V0U2tpZGRpbmcgPSBvZmZzZXRTa2lkZGluZztcbiAgICB9XG4gICAgcmV0dXJuIHBvcG92ZXI7XG59XG4vKipcbiAqICBzaG93IGhlbHAgcG9wb3ZlciBmb3IgaGVscElkXG4gKiAgQHBhcmFtIHtIVE1MUmZ4SGVscFBvcG92ZXJFbGVtZW50fSB0b29sSGVscFBvcG92ZXJcbiAqICBAcGFyYW0ge0NyZWF0ZUhlbHBQb3BvdmVyUGFyYW1zfSBwYXJhbXMgbmVlZGVkIHBhcmFtZXRlcnMgZm9yIGhlbHBcbiAqICBAcmV0dXJucyB7SFRNTFJmeEhlbHBQb3BvdmVyRWxlbWVudH0gIGhlbHBQb3BvdmVyIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIHNob3dIZWxwKHRvb2xIZWxwUG9wb3ZlciwgcGFyYW1zKSB7XG4gICAgY29uc3QgeyBoZWxwVXJsLCBoZWxwSWQsIGhlYWRpbmcsIHJlZmVyZW5jZUVsZW1lbnQsIHBvcnRhbCwgaGVscFNyY2RvYywgaGVscEZpbGVOYW1lLCBsZWFybk1vcmVVcmwsIG9mZnNldERpc3RhbmNlLCBvZmZzZXRTa2lkZGluZyB9ID0gcGFyYW1zO1xuICAgIGlmICh0b29sSGVscFBvcG92ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQodG9vbEhlbHBQb3BvdmVyKTtcbiAgICAgICAgdG9vbEhlbHBQb3BvdmVyID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0b29sSGVscFBvcG92ZXIgPSBjcmVhdGVIZWxwUG9wb3Zlcih7XG4gICAgICAgIGhlbHBVcmwsXG4gICAgICAgIGhlbHBJZCxcbiAgICAgICAgaGVhZGluZyxcbiAgICAgICAgcmVmZXJlbmNlRWxlbWVudCxcbiAgICAgICAgcG9ydGFsLFxuICAgICAgICBoZWxwU3JjZG9jLFxuICAgICAgICBoZWxwRmlsZU5hbWUsXG4gICAgICAgIGxlYXJuTW9yZVVybCxcbiAgICAgICAgb2Zmc2V0RGlzdGFuY2UsXG4gICAgICAgIG9mZnNldFNraWRkaW5nXG4gICAgfSk7XG4gICAgYWRkT3BlbmFibGVEb21FbGVtZW50KGRvY3VtZW50LCB0b29sSGVscFBvcG92ZXIpO1xuICAgIHJldHVybiB0b29sSGVscFBvcG92ZXI7XG59XG4vKipcbiAqIGNyZWF0ZXMgIE5vZGUgSW50ZXJhY3Rpb24gcG9wb3ZlciBjb21wb25lbnQuXG4gKiBAcGFyYW0gQ3JlYXRlTm9kZUludGVyYWN0aW9uUG9wb3ZlclBhcmFtc1xuICogQHBhcmFtIHtDcmVhdGVOb2RlSW50ZXJhY3Rpb25Qb3BvdmVyUGFyYW1zfSBwYXJhbXMgIHBhcmFtZXRlcnMgZm9yIGNyZWF0aW5nIG5vZGUgSW50ZXJhY3Rpb24gcG9wb3ZlclxuICogQHJldHVybnMgSFRNTENhbGNpdGVQb3BvdmVyRWxlbWVudFxuICovXG5mdW5jdGlvbiBjcmVhdGVOb2RlSW50ZXJhY3Rpb25Qb3BvdmVyKHBvcG92ZXIsIHBhcmFtcykge1xuICAgIGNvbnN0IHsgcmVmZXJlbmNlRWxlbWVudCwgbGFiZWwsIGRpcmVjdGlvbiwgb2Zmc2V0RGlzdGFuY2UsIG9mZnNldFNraWRkaW5nLCBzaG93UHJvcGVydGllc0FjdGlvbiwgaGFuZGxlTm9kZUR1cGxpY2F0ZSwgaGFuZGxlTm9kZVJlbmFtZSwgaGFuZGxlTm9kZURlbGV0ZSwgaGFuZGxlTm9kZUVkaXRQcm9wZXJ0aWVzIH0gPSBwYXJhbXM7XG4gICAgaWYgKHBvcG92ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQocG9wb3Zlcik7XG4gICAgICAgIHBvcG92ZXIgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHBvcG92ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FsY2l0ZS1wb3BvdmVyXCIpO1xuICAgIGNvbnN0IHBvcG92ZXJQcm9wcyA9IHtcbiAgICAgICAgb3ZlcmxheVBvc2l0aW9uaW5nOiBcImFic29sdXRlXCIsXG4gICAgICAgIGF1dG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgZGlyOiBkaXJlY3Rpb24sXG4gICAgICAgIGZvY3VzVHJhcERpc2FibGVkOiB0cnVlLFxuICAgICAgICB0cmlnZ2VyRGlzYWJsZWQ6IHRydWUsXG4gICAgICAgIHBvaW50ZXJEaXNhYmxlZDogdHJ1ZSxcbiAgICAgICAgcGxhY2VtZW50OiBcInRvcFwiLFxuICAgICAgICBjbG9zYWJsZTogZmFsc2UsXG4gICAgICAgIG9wZW46IHRydWUsXG4gICAgICAgIHJlZmVyZW5jZUVsZW1lbnQ6IHJlZmVyZW5jZUVsZW1lbnQsXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgb2Zmc2V0RGlzdGFuY2U6IG9mZnNldERpc3RhbmNlLFxuICAgICAgICBvZmZzZXRTa2lkZGluZzogb2Zmc2V0U2tpZGRpbmdcbiAgICB9O1xuICAgIE9iamVjdC5hc3NpZ24ocG9wb3ZlciwgcG9wb3ZlclByb3BzKTtcbiAgICBjb25zdCBub2RlSW50ZXJhY3Rpb25Ub29sYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInJmeC1ub2RlLWludGVyYWN0aW9uLXRvb2xiYXJcIik7XG4gICAgY29uc3Qgbm9kZUludGVyYWN0aW9uVG9vbGJhclByb3BzID0ge1xuICAgICAgICBzaG93UHJvcGVydGllc0FjdGlvbixcbiAgICAgICAgaGFuZGxlTm9kZUR1cGxpY2F0ZSxcbiAgICAgICAgaGFuZGxlTm9kZVJlbmFtZSxcbiAgICAgICAgaGFuZGxlTm9kZURlbGV0ZSxcbiAgICAgICAgaGFuZGxlTm9kZUVkaXRQcm9wZXJ0aWVzXG4gICAgfTtcbiAgICBPYmplY3QuYXNzaWduKG5vZGVJbnRlcmFjdGlvblRvb2xiYXIsIG5vZGVJbnRlcmFjdGlvblRvb2xiYXJQcm9wcyk7XG4gICAgcG9wb3Zlci5hcHBlbmQobm9kZUludGVyYWN0aW9uVG9vbGJhcik7XG4gICAgYWRkT3BlbmFibGVEb21FbGVtZW50KGRvY3VtZW50LCBwb3BvdmVyKTtcbiAgICByZXR1cm4gcG9wb3Zlcjtcbn1cblxuZXhwb3J0IHsgY3JlYXRlTm9kZUludGVyYWN0aW9uUG9wb3ZlciBhcyBjLCByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQgYXMgciwgc2hvd0hlbHAgYXMgcyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wb3BvdmVyLXV0aWxzLTcyNTQ5M2Q3LmpzLm1hcCIsImNvbnN0IEhUTUxDbGFzc2VzID0ge1xuICAgIHBhbmVsOiBgcGFuZWxgXG59O1xuY29uc3QgUkZ4UGFuZWxTbG90cyA9IHtcbiAgICBoZWFkZXJDb250ZW50OiBcImhlYWRlci1jb250ZW50XCIsXG4gICAgaGVhZGVyQWN0aW9uc0VuZDogXCJoZWFkZXItYWN0aW9ucy1lbmRcIlxufTtcblxuZXhwb3J0IHsgSFRNTENsYXNzZXMgYXMgSCwgUkZ4UGFuZWxTbG90cyBhcyBSIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlc291cmNlcy00NmIyOTNiMi5qcy5tYXAiLCJjb25zdCBFZGl0b3JBY3RvbkJhckFjdGlvbnMgPSB7XG4gICAgbmV3VGVtcGxhdGU6IFwibmV3LXRlbXBsYXRlXCIsXG4gICAgb3BlblRlbXBsYXRlOiBcIm9wZW4tdGVtcGxhdGVcIixcbiAgICBhZGRGdW5jdGlvbjogXCJhZGQtZnVuY3Rpb25cIixcbiAgICBhZGRDb25zdGFudDogXCJhZGQtY29uc3RhbnRcIixcbiAgICBhZGRSYXN0ZXI6IFwiYWRkLXJhc3RlclwiXG59O1xuXG5leHBvcnQgeyBFZGl0b3JBY3RvbkJhckFjdGlvbnMgYXMgRSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZngtY29yZS1pbnRlcmZhY2VzLTg3NzA5YjYyLmpzLm1hcCIsImltcG9ydCB7IGgsIHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgZyBhcyBnZXRBc3NldFBhdGgsIEggYXMgSG9zdCwgYSBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC1kYTFiNzEzOC5qcyc7XG5pbXBvcnQgeyBFIGFzIEVkaXRvckFjdG9uQmFyQWN0aW9ucyB9IGZyb20gJy4vcmZ4LWNvcmUtaW50ZXJmYWNlcy04NzcwOWI2Mi5qcyc7XG5pbXBvcnQgeyBkIGFzIGdldEZ1bmN0aW9uVGVtcGxhdGUsIGggYXMgZ2V0UkZURnVuY3Rpb25JZGVudGlmaWVyIH0gZnJvbSAnLi9mdW5jdGlvbnMtZjFmMmRmZmQuanMnO1xuaW1wb3J0IHsgYiBhcyBnZXRGdW5jdGlvbkRlc2NyaXB0aW9uSGVscFRlbXBsYXRlIH0gZnJvbSAnLi9oZWxwLXRleHQtMzRhMjk4MzUuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvY29yZS9sYW5nLmpzJztcbmltcG9ydCB7IGIgYXMgZmV0Y2hDb21wb25lbnRMb2NhbGVTdHJpbmdzIH0gZnJvbSAnLi9sb2NhbGl6YXRpb24taGVscGVyLTQ4MTliNjdkLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2lkZW50aXR5L0lkZW50aXR5TWFuYWdlci5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9jb3JlL3VybFV0aWxzLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2xheWVycy9MYXllci5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9sYXllcnMvSW1hZ2VyeUxheWVyLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL3NtYXJ0TWFwcGluZy9yYXN0ZXIvcmVuZGVyZXJzL3N0cmV0Y2guanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVxdWVzdC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXN0L3N1cHBvcnQvQWxnb3JpdGhtaWNDb2xvclJhbXAuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVzdC9zdXBwb3J0L011bHRpcGFydENvbG9yUmFtcC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9Db2xvci5qcyc7XG5pbXBvcnQgJy4vY29sb3JSYW1wVXRpbHMtOGJkZDQ2YzUuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVzdC9nZW9wcm9jZXNzb3IuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcG9ydGFsL1BvcnRhbEl0ZW0uanMnO1xuaW1wb3J0IHsgUiBhcyBSRnhQYW5lbFNsb3RzIH0gZnJvbSAnLi9yZXNvdXJjZXMtNDZiMjkzYjIuanMnO1xuaW1wb3J0IHsgciBhcyByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQsIHMgYXMgc2hvd0hlbHAgfSBmcm9tICcuL3BvcG92ZXItdXRpbHMtNzI1NDkzZDcuanMnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVSRnhJdGVtQnJvd3NlciwgYSBhcyBjcmVhdGVSRnhTYXZlTW9kYWwgfSBmcm9tICcuL3dpZGdldC1mYWN0b3J5LWU4MWM3NTAxLmpzJztcbmltcG9ydCB7IFIgYXMgUkZ4TGlzdFZpZXdNb2RlIH0gZnJvbSAnLi9pbnRlcmZhY2VzLTg3OWY4M2Q3LmpzJztcblxuY29uc3QgSFRNTENsYXNzZXMgPSB7XG4gICAgaG9zdDogXCJob3N0XCIsXG4gICAgY29udGVudDogXCJjb250ZW50XCIsXG4gICAgYWN0aW9uQmFyOiBcImFjdGlvbi1iYXJcIixcbiAgICBtZW51QWN0aW9uczogXCJtZW51LWFjdGlvbnNcIixcbiAgICBoZWFkZXJBY3Rpb25zOiBcImhlYWRlci1hY3Rpb25zXCIsXG4gICAgdG9vbHRpcDogXCJ0b29sdGlwXCIsXG4gICAgYXBwQ29udGFpbmVyOiBcImVkaXRvci1jb250YWluZXJcIixcbiAgICBvdmVybGF5RWxlbWVudDogXCJvdmVybGF5LWVsZW1lbnRcIixcbiAgICBvdmVybGF5UGFuZWw6IFwib3ZlcmxheS1wYW5lbFwiXG59O1xuY29uc3QgQ1NTX1VUSUxJVFkgPSB7XG4gICAgcnRsOiBcImFyY2dpcy0tcnRsXCJcbn07XG5jb25zdCBTbG90ID0ge1xuICAgIGFjdGlvbkJhcjogXCJhY3Rpb24tYmFyXCJcbn07XG5cbmNvbnN0IERpYWdyYW1ab29tSW5Db21tYW5kID0gKHJlY2VpdmVyKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXhlY3V0ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcmVjZWl2ZXIuem9vbUluKCk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbmNvbnN0IERpYWdyYW1ab29tT3V0Q29tbWFuZCA9IChyZWNlaXZlcikgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIGV4ZWN1dGU6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHJlY2VpdmVyLnpvb21PdXQoKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuY29uc3QgRGlhZ3JhbUF1dG9MYXlvdXRDb21tYW5kID0gKHJlY2VpdmVyKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXhlY3V0ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcmVjZWl2ZXIuYXV0b0xheW91dCgpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5jb25zdCBEaWFncmFtU3RyZXRjaENvbW1hbmQgPSAocmVjZWl2ZXIpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBleGVjdXRlOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCByZWNlaXZlci5zdHJldGNoKCk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbmNvbnN0IERpYWdyYW1QYW5Db21tYW5kID0gKHJlY2VpdmVyKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXhlY3V0ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcmVjZWl2ZXIucGFuKCk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbmNvbnN0IEFkZFJGeEZ1bmN0aW9uQ29tbWFuZCA9IChyZWNlaXZlcikgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIGV4ZWN1dGU6IGFzeW5jIChyZnhUZW1wbGF0ZSkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcmVjZWl2ZXIuYWRkUkZ4RnVuY3Rpb24ocmZ4VGVtcGxhdGUpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5jb25zdCBBZGRSYXN0ZXJOb2RlQ29tbWFuZCA9IChyZWNlaXZlcikgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIGV4ZWN1dGU6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHJlY2VpdmVyLmFkZFJhc3Rlck5vZGUoKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuY29uc3QgQWRkU2NhbGFyTm9kZUNvbW1hbmQgPSAocmVjZWl2ZXIpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBleGVjdXRlOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCByZWNlaXZlci5hZGRTY2FsYXJOb2RlKCk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbmNvbnN0IEFkZFJGVFBvcnRhbEl0ZW1Db21tYW5kID0gKHJlY2VpdmVyKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXhlY3V0ZTogYXN5bmMgKHBvcnRhbEl0ZW1JZCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgcmVjZWl2ZXIuYWRkUkZUUG9ydGFsSXRlbShwb3J0YWxJdGVtSWQpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5cbmNvbnN0IHJpZ2h0VG9vbEJhckJ1aWxkZXIgPSAoeyBoYW5kbGVSRlRMYXVuY2gsIGhhbmRsZVJGVFNhdmUsIGhhbmRsZVJGVFNhdmVBcywgaGFuZGxlT3BlblRlbXBsYXRlRWRpdG9yLCBoYW5kbGVSRlRTaGFyZSB9KSA9PiAoaChcInJmeC1yZnQtaW50ZXJhY3Rpb24tdG9vbGJhclwiLCB7IGhhbmRsZVJGVExhdW5jaDogaGFuZGxlUkZUTGF1bmNoLCBoYW5kbGVSRlRTYXZlOiBoYW5kbGVSRlRTYXZlLCBoYW5kbGVSRlRTYXZlQXM6IGhhbmRsZVJGVFNhdmVBcywgaGFuZGxlT3BlblRlbXBsYXRlRWRpdG9yOiBoYW5kbGVPcGVuVGVtcGxhdGVFZGl0b3IsIGhhbmRsZVJGVFNoYXJlOiBoYW5kbGVSRlRTaGFyZSB9KSk7XG5jb25zdCBsZWZ0VG9vbEJhckJ1aWxkZXIgPSAoeyBoYW5kbGVEaWFncmFtWm9vbUluLCBoYW5kbGVEaWFncmFtWm9vbU91dCwgaGFuZGxlRGlhZ3JhbUF1dG9MYXlvdXQsIGhhbmRsZURpYWdyYW1TdHJldGNoLCBoYW5kbGVEaWFncmFtU2VsZWN0LCBoYW5kbGVEaWFncmFtUGFuIH0pID0+IChoKFwicmZ4LWRpYWdyYW0taW50ZXJhY3Rpb24tdG9vbGJhclwiLCB7IGhhbmRsZURpYWdyYW1ab29tSW46IGhhbmRsZURpYWdyYW1ab29tSW4sIGhhbmRsZURpYWdyYW1ab29tT3V0OiBoYW5kbGVEaWFncmFtWm9vbU91dCwgaGFuZGxlRGlhZ3JhbUF1dG9MYXlvdXQ6IGhhbmRsZURpYWdyYW1BdXRvTGF5b3V0LCBoYW5kbGVEaWFncmFtU3RyZXRjaDogaGFuZGxlRGlhZ3JhbVN0cmV0Y2gsIGhhbmRsZURpYWdyYW1TZWxlY3Q6IGhhbmRsZURpYWdyYW1TZWxlY3QsIGhhbmRsZURpYWdyYW1QYW46IGhhbmRsZURpYWdyYW1QYW4gfSkpO1xuY29uc3QgcmZ4VGVtcGxhdGVFZGl0b3JCdWlsZGVyID0gKHsgaGVhZGluZywgZGF0YSwgaGFuZGxlUGFuZWxDbG9zZSwgaGFuZGxlUGFuZWxDYW5jZWwsIGhhbmRsZVBhbmVsT2sgfSkgPT4gKGgoXCJyZngtcGFuZWxcIiwgeyBoZWFkaW5nOiBoZWFkaW5nLCBkYXRhOiBkYXRhLCBjbGFzczoge1xuICAgICAgICBbSFRNTENsYXNzZXMub3ZlcmxheUVsZW1lbnRdOiB0cnVlLFxuICAgICAgICBbSFRNTENsYXNzZXMub3ZlcmxheVBhbmVsXTogdHJ1ZVxuICAgIH0sIHNob3dGb290ZXI6IHRydWUsIGNsb3NhYmxlOiB0cnVlLCBvblBhbmVsT2tDbGljazogaGFuZGxlUGFuZWxPaywgb25QYW5lbENhbmNlbENsaWNrOiBoYW5kbGVQYW5lbENhbmNlbCwgb25DYWxjaXRlUGFuZWxDbG9zZTogaGFuZGxlUGFuZWxDbG9zZSB9LFxuICAgIGgoXCJyZngtdGVtcGxhdGUtZWRpdG9yXCIsIG51bGwpKSk7XG5jb25zdCByZnhMaXN0Vmlld0J1aWxkZXIgPSAoeyBoYW5kbGVUcmlnZ2VyU2VsZWN0RnVuY3Rpb24sIGhhbmRsZVBhbmVsQ2xvc2UsIGhlYWRpbmcgfSkgPT4gKGgoXCJyZngtcGFuZWxcIiwgeyBoZWFkaW5nOiBoZWFkaW5nLCBjbG9zYWJsZTogdHJ1ZSwgc2hvd0Zvb3RlcjogZmFsc2UsIGNsb3NlZDogZmFsc2UsIGNsYXNzOiB7XG4gICAgICAgIFtIVE1MQ2xhc3Nlcy5vdmVybGF5RWxlbWVudF06IHRydWUsXG4gICAgICAgIFtIVE1MQ2xhc3Nlcy5vdmVybGF5UGFuZWxdOiB0cnVlXG4gICAgfSwgb25DYWxjaXRlUGFuZWxDbG9zZTogaGFuZGxlUGFuZWxDbG9zZSB9LFxuICAgIGgoXCJyZngtbGlzdC12aWV3XCIsIHsgbW9kZTogUkZ4TGlzdFZpZXdNb2RlLkNPUkUsIG9uVHJpZ2dlclNlbGVjdEZ1bmN0aW9uOiBoYW5kbGVUcmlnZ2VyU2VsZWN0RnVuY3Rpb24gfSkpKTtcbmNvbnN0IHJmeEFyZ0RldGFpbHNFZGl0b3JCdWlsZGVyID0gKHsgcmZ4VGVtcGxhdGUsIGhhbmRsZVBhbmVsQ2xvc2UsIGhlYWRlckVsZW1lbnRDb21wb25lbnQsIGhlbHBBY3Rpb25Db21wb25lbnQgfSkgPT4gKGgoXCJyZngtcGFuZWxcIiwgeyBoZWFkaW5nOiByZnhUZW1wbGF0ZT8ubmFtZSwgY2xvc2FibGU6IHRydWUsIHNob3dGb290ZXI6IHRydWUsIGN1c3RvbUhlYWRlcjogdHJ1ZSwgY3VzdG9tSGVhZGVyQWN0aW9uOiB0cnVlLCBjbGFzczoge1xuICAgICAgICBbSFRNTENsYXNzZXMub3ZlcmxheUVsZW1lbnRdOiB0cnVlLFxuICAgICAgICBbSFRNTENsYXNzZXMub3ZlcmxheVBhbmVsXTogdHJ1ZVxuICAgIH0sIG9uQ2FsY2l0ZVBhbmVsQ2xvc2U6IGhhbmRsZVBhbmVsQ2xvc2UgfSxcbiAgICBoZWFkZXJFbGVtZW50Q29tcG9uZW50LFxuICAgIGhlbHBBY3Rpb25Db21wb25lbnQsXG4gICAgaChcInJmeC1kZXRhaWxzLWVkaXRvclwiLCB7IHJmeFRlbXBsYXRlOiByZnhUZW1wbGF0ZSB9KSkpO1xuY29uc3QgcmZ4QnJvd3NlTGF5ZXJzRGlhbG9nQnVpbGRlciA9ICh7IGhlYWRpbmcsIGhhbmRsZVBhbmVsQ2xvc2UgfSkgPT4gKGgoXCJyZngtcGFuZWxcIiwgeyBoZWFkaW5nOiBoZWFkaW5nLCBjbG9zYWJsZTogdHJ1ZSwgc2hvd0Zvb3RlcjogdHJ1ZSwgY2xhc3M6IHtcbiAgICAgICAgW0hUTUxDbGFzc2VzLm92ZXJsYXlFbGVtZW50XTogdHJ1ZSxcbiAgICAgICAgW0hUTUxDbGFzc2VzLm92ZXJsYXlQYW5lbF06IHRydWVcbiAgICB9LCBvbkNhbGNpdGVQYW5lbENsb3NlOiBoYW5kbGVQYW5lbENsb3NlIH0sXG4gICAgaChcInJmeC1zZWxlY3QtbGF5ZXItcGFuZWxcIiwgbnVsbCkpKTtcblxuY29uc3QgcmZ4RWRpdG9yQXBwQ3NzID0gXCI6cm9vdHstLWNhbGNpdGUtY29sb3ItYnJhbmQ6IzAwN2FjMjstLWNhbGNpdGUtY29sb3ItYnJhbmQtaG92ZXI6IzAwNjE5YjstLWNhbGNpdGUtY29sb3ItYnJhbmQtcHJlc3M6IzAwNDg3NDstLWNhbGNpdGUtY29sb3Itc3RhdHVzLWluZm86IzAwNjE5YjstLWNhbGNpdGUtY29sb3Itc3RhdHVzLXN1Y2Nlc3M6IzM1YWM0NjstLWNhbGNpdGUtY29sb3Itc3RhdHVzLXdhcm5pbmc6I2VkZDMxNzstLWNhbGNpdGUtY29sb3Itc3RhdHVzLWRhbmdlcjojZDgzMDIwOy0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtZGFuZ2VyLWhvdmVyOiNhODJiMWU7LS1jYWxjaXRlLWNvbG9yLXN0YXR1cy1kYW5nZXItcHJlc3M6IzdjMWQxMzstLWNhbGNpdGUtY29sb3ItYmFja2dyb3VuZDojZjhmOGY4Oy0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTE6I2ZmZmZmZjstLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0yOiNmM2YzZjM7LS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMzojZWFlYWVhOy0tY2FsY2l0ZS1jb2xvci10ZXh0LTE6IzE1MTUxNTstLWNhbGNpdGUtY29sb3ItdGV4dC0yOiM0YTRhNGE7LS1jYWxjaXRlLWNvbG9yLXRleHQtMzojNmE2YTZhOy0tY2FsY2l0ZS1jb2xvci10ZXh0LWludmVyc2U6I2ZmZmZmZjstLWNhbGNpdGUtY29sb3ItdGV4dC1saW5rOiMwMDYxOWI7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci0xOiNjYWNhY2E7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci0yOiNkNGQ0ZDQ7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci0zOiNkZmRmZGY7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci1pbnB1dDojOTQ5NDk0Oy0tcmZ4LXF1YXJ0ZXItc3BhY2luZzowLjI1cmVtOy0tcmZ4LWhhbGYtc3BhY2luZzowLjVyZW07LS1yZngtdGhyZWUtcXVhcnRlci1zcGFjaW5nOjAuNzVyZW07LS1yZngtZnVsbC1zcGFjaW5nOjFyZW07LS1yZngtY29tcG9uZW50LWRlZmF1bHQtd2lkdGg6MTAwJTstLXJmeC11aS1ib3JkZXItaW5wdXQ6dmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMik7LS1yZngtcG9wb3Zlci1jb250ZW50LW1pbi1oZWlnaHQ6MzB2aDstLXJmeC1wb3BvdmVyLWNvbnRlbnQtbWF4LWhlaWdodDo2MHZoOy0tcmZ4LXBvcG92ZXItY29udGVudC1oZWlnaHQ6NDV2aDstLXJmeC13aWRnZXQtY29udGVudC1oZWlnaHQ6MzB2aH0uaG9zdHtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlfS5jb250ZW50e2hlaWdodDoxMDAlO2Rpc3BsYXk6ZmxleH0uYWN0aW9uLWJhcntoZWlnaHQ6MTAwJTtib3JkZXItd2lkdGg6MCAxcHggMCAwO2JvcmRlci1zdHlsZTpzb2xpZDtib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMil9Lm1lbnUtYWN0aW9uc3tkaXNwbGF5OmlubGluZS1mbGV4O2p1c3RpZnktc2VsZjpzdHJldGNofS5oZWFkZXItYWN0aW9uc3toZWlnaHQ6MTAwJX0udG9vbHRpcHt3aGl0ZS1zcGFjZTpub3dyYXB9LmFyY2dpcy0tcnRsIC5hY3Rpb24tYmFye2JvcmRlci13aWR0aDowIDAgMCAxcHh9LmVkaXRvci1jb250YWluZXJ7cG9zaXRpb246cmVsYXRpdmU7fS5vdmVybGF5LWVsZW1lbnR7ei1pbmRleDozO2JveC1zaGFkb3c6MCAwIDVweCByZ2JhKDAsIDAsIDAsIDAuMik7Ym9yZGVyLXJhZGl1czowLjI1cmVtfS5vdmVybGF5LXBhbmVse21heC1oZWlnaHQ6MzJyZW07bWF4LXdpZHRoOjIycmVtO3dpZHRoOjIycmVtfVwiO1xuXG5jb25zdCBSRnhFZGl0b3JBcHAgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFuYWx5c2lzUkZUTGF1bmNoID0gY3JlYXRlRXZlbnQodGhpcywgXCJhbmFseXNpc1JGVExhdW5jaFwiLCA3KTtcbiAgICAgICAgdGhpcy5yZnhDb3JlU2VydmljZXMgPSB7XG4gICAgICAgICAgICBkaWFncmFtWm9vbUluQ29tbWFuZDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZGlhZ3JhbVpvb21PdXRDb21tYW5kOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkaWFncmFtQXV0b0xheW91dENvbW1hbmQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGRpYWdyYW1TdHJldGNoQ29tbWFuZDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZGlhZ3JhbVBhbkNvbW1hbmQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGFkZFJGeEZ1bmN0aW9uQ29tbWFuZDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgYWRkUmFzdGVyTm9kZUNvbW1hbmQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGFkZFNjYWxhck5vZGVDb21tYW5kOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBhZGRSRlRQb3J0YWxJdGVtQ29tbWFuZDogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgb3JkZXIgaW4gd2hpY2ggZWxlbWVudHMgYXJlIGRlY2xhcmVkIG1hdHRlcnMsIGVzcGVjaWFsbHkgZm9yIGVsZW1lbnRzIHRoYXQgYXJlIHBsYWNlZCBpbiB0aGUgXCJsZWZ0XCIgc2xvdC5cbiAgICAgICAgICogSW4gdGhlIFwibGVmdFwiIHNsb3QsIHRoZSBmaXJzdCBlbGVtZW50IGRlY2xhcmVkIHdpbGwgYmUgcG9zaXRpb25lZCBvbiB0aGUgbGVmdG1vc3Qgc2lkZSwgd2hpbGUgaW4gdGhlIFwicmlnaHRcIiBzbG90LFxuICAgICAgICAgKiB0aGUgZmlyc3QgZWxlbWVudCBkZWNsYXJlZCB3aWxsIGJlIG9uIHRoZSByaWdodG1vc3Qgc2lkZS5cbiAgICAgICAgICpcbiAgICAgICAgICogTk9URSB0aGF0IHdoaWxlIHNsb3RzIGNhbiBiZSB1c2VkIGluIGEgZ2VuZXJpYyBtYW5uZXIsIHNsb3RzIGNhbiBiZSBnZW5lcmljIGJ1dCB3aWxsIGRlcGVuZCBvbiB0aGUgaW1wbGVtZW50aW9uIG9mXG4gICAgICAgICAqIHRoZSBVSSB3ZSBhcmUgY29uZm9ybWluZyB0bywgSW4gdGhpcyBjb250ZXh0LCB3ZSBhcmUgcmVmZXJyaW5nIHRvIHRoZSBiZWhhdmlvciBvZiBzbG90cyBpbiBlc3JpLWNvcmUsXG4gICAgICAgICAqIHdoZXJlIHRoZXJlIGFyZSBvbmx5IHR3byBzbG90cyBhdmFpbGFibGUsIGFuZCB0aGV5IGFyZSBkZXNpZ25lZCB0byBkaXNwbGF5IGVsZW1lbnRzIGluIHRoZSBtYW5uZXIgZGVzY3JpYmVkIGFib3ZlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vdmVybGF5RWxlbWVudHNDb25maWcgPSB7XG4gICAgICAgICAgICBsZWZ0VG9vbEJhcjoge1xuICAgICAgICAgICAgICAgIHNsb3Q6IFwibGVmdFwiLFxuICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsXG4gICAgICAgICAgICAgICAgYnVpbGRlcjogKCkgPT4gbGVmdFRvb2xCYXJCdWlsZGVyKHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlRGlhZ3JhbVpvb21JbjogdGhpcy5oYW5kbGVEaWFncmFtWm9vbUluLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVEaWFncmFtWm9vbU91dDogdGhpcy5oYW5kbGVEaWFncmFtWm9vbU91dCxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlRGlhZ3JhbUF1dG9MYXlvdXQ6IHRoaXMuaGFuZGxlRGlhZ3JhbUF1dG9MYXlvdXQsXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZURpYWdyYW1TdHJldGNoOiB0aGlzLmhhbmRsZURpYWdyYW1TdHJldGNoLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVEaWFncmFtU2VsZWN0OiB0aGlzLmhhbmRsZURpYWdyYW1TZWxlY3QsXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZURpYWdyYW1QYW46IHRoaXMuaGFuZGxlRGlhZ3JhbVBhblxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RhdGljXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByaWdodFRvb2xCYXI6IHtcbiAgICAgICAgICAgICAgICBzbG90OiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgdmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBidWlsZGVyOiAoKSA9PiByaWdodFRvb2xCYXJCdWlsZGVyKHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlUkZUTGF1bmNoOiB0aGlzLmhhbmRsZVJGVExhdW5jaCxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlUkZUU2F2ZTogdGhpcy5oYW5kbGVSRlRTYXZlLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVSRlRTYXZlQXM6IHRoaXMuaGFuZGxlUkZUU2F2ZUFzLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVPcGVuVGVtcGxhdGVFZGl0b3I6IHRoaXMuaGFuZGxlT3BlblRlbXBsYXRlRWRpdG9yLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVSRlRTaGFyZTogdGhpcy5oYW5kbGVSRlRTaGFyZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RhdGljXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZnhUZW1wbGF0ZUVkaXRvcjoge1xuICAgICAgICAgICAgICAgIHNsb3Q6IFwicmlnaHRcIixcbiAgICAgICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBidWlsZGVyOiAoeyB0ZW1wbGF0ZVByb3BlcnRpZXNUaXRsZTogaGVhZGluZyB9KSA9PiByZnhUZW1wbGF0ZUVkaXRvckJ1aWxkZXIoe1xuICAgICAgICAgICAgICAgICAgICBoZWFkaW5nLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVQYW5lbENhbmNlbDogdGhpcy5oYW5kbGVSRnhUZW1wbGF0ZUVkaXRvclBhbmVsQ2FuY2VsLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVQYW5lbE9rOiB0aGlzLmhhbmRsZVJGeFRlbXBsYXRlRWRpdG9yUGFuZWxPayxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlUGFuZWxDbG9zZTogdGhpcy5oYW5kbGVSRnhUZW1wbGF0ZUVkaXRvclBhbmVsQ2xvc2UsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyaWFsRGF0YTogXCJ0cmlhbERhdGFcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZnhMaXN0Vmlldzoge1xuICAgICAgICAgICAgICAgIHNsb3Q6IFwibGVmdFwiLFxuICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGJ1aWxkZXI6ICh7IGFkZFJhc3RlckZ1bmN0aW9uVGl0bGU6IGhlYWRpbmcgfSkgPT4gcmZ4TGlzdFZpZXdCdWlsZGVyKHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZyxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlVHJpZ2dlclNlbGVjdEZ1bmN0aW9uOiB0aGlzLmhhbmRsZVJGeExpc3RWaWV3VHJpZ2dlclNlbGVjdEZ1bmN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVQYW5lbENsb3NlOiB0aGlzLmhhbmRsZVJGeExpc3RWaWV3UGFuZWxDbG9zZVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwic3RhdGljXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZnhBcmdEZXRhaWxzRWRpdG9yOiB7XG4gICAgICAgICAgICAgICAgc2xvdDogXCJyaWdodFwiLFxuICAgICAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGJ1aWxkZXI6ICh7IGRldGFpbHNFZGl0b3JSZnhUZW1wbGF0ZTogcmZ4VGVtcGxhdGUgfSkgPT4gcmZ4QXJnRGV0YWlsc0VkaXRvckJ1aWxkZXIoe1xuICAgICAgICAgICAgICAgICAgICByZnhUZW1wbGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlUGFuZWxDbG9zZTogdGhpcy5oYW5kbGVSRnhEZXRhaWxzRWRpdG9yUGFuZWxDbG9zZSxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyRWxlbWVudENvbXBvbmVudDogKGgoXCJkaXZcIiwgeyBzbG90OiBSRnhQYW5lbFNsb3RzLmhlYWRlckNvbnRlbnQsIHJlZjogKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogRml4IHRoaXMgaW4gZnV0dXJlIHNvbWVob3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlckVsZW1lbnQgPSBlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gfSwgcmZ4VGVtcGxhdGU/Lm5hbWUpKSxcbiAgICAgICAgICAgICAgICAgICAgaGVscEFjdGlvbkNvbXBvbmVudDogKGgoXCJjYWxjaXRlLWFjdGlvblwiLCB7IGxhYmVsOiBcIlwiLCB0ZXh0OiBcIlwiLCBpY29uOiBcImluZm9ybWF0aW9uXCIsIHNsb3Q6IFJGeFBhbmVsU2xvdHMuaGVhZGVyQWN0aW9uc0VuZCwgY2xhc3M6IEhUTUxDbGFzc2VzLmhlYWRlckFjdGlvbnMsIG9uQ2xpY2s6IHRoaXMuaGFuZGxlUkZ4RGV0YWlsc0VkaXRvckhlYWRpbmdIZWxwQ2xpY2sgfSkpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZnhCcm93c2VMYXllcnNEaWFsb2c6IHtcbiAgICAgICAgICAgICAgICBzbG90OiBcInJpZ2h0XCIsXG4gICAgICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgYnVpbGRlcjogKHsgYnJvd3NlTGF5ZXJEaWFsb2dUaXRsZTogaGVhZGluZyB9KSA9PiByZnhCcm93c2VMYXllcnNEaWFsb2dCdWlsZGVyKHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZyxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlUGFuZWxDbG9zZTogdGhpcy5oYW5kbGVSRnhCcm93c2VMYXllcnNQYW5lbENsb3NlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplUkZ4RWRpdG9yQ29yZSA9IChyZnhFZGl0b3JDb3JlRWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmZ4RWRpdG9yQ29yZSA9IHJmeEVkaXRvckNvcmVFbGVtZW50O1xuICAgICAgICAgICAgdGhpcy5yZnhFZGl0b3JDb3JlRWxlbWVudCA9IHJmeEVkaXRvckNvcmVFbGVtZW50O1xuICAgICAgICAgICAgLy8gQXNzaWduIHNlcnZpY2VzIGhlcmVcbiAgICAgICAgICAgIHRoaXMucmZ4Q29yZVNlcnZpY2VzLmRpYWdyYW1ab29tSW5Db21tYW5kID0gRGlhZ3JhbVpvb21JbkNvbW1hbmQocmZ4RWRpdG9yQ29yZSk7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5kaWFncmFtWm9vbU91dENvbW1hbmQgPSBEaWFncmFtWm9vbU91dENvbW1hbmQocmZ4RWRpdG9yQ29yZSk7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5kaWFncmFtQXV0b0xheW91dENvbW1hbmQgPSBEaWFncmFtQXV0b0xheW91dENvbW1hbmQocmZ4RWRpdG9yQ29yZSk7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5kaWFncmFtU3RyZXRjaENvbW1hbmQgPSBEaWFncmFtU3RyZXRjaENvbW1hbmQocmZ4RWRpdG9yQ29yZSk7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5kaWFncmFtUGFuQ29tbWFuZCA9IERpYWdyYW1QYW5Db21tYW5kKHJmeEVkaXRvckNvcmUpO1xuICAgICAgICAgICAgdGhpcy5yZnhDb3JlU2VydmljZXMuYWRkUkZ4RnVuY3Rpb25Db21tYW5kID0gQWRkUkZ4RnVuY3Rpb25Db21tYW5kKHJmeEVkaXRvckNvcmUpO1xuICAgICAgICAgICAgdGhpcy5yZnhDb3JlU2VydmljZXMuYWRkUmFzdGVyTm9kZUNvbW1hbmQgPSBBZGRSYXN0ZXJOb2RlQ29tbWFuZChyZnhFZGl0b3JDb3JlKTtcbiAgICAgICAgICAgIHRoaXMucmZ4Q29yZVNlcnZpY2VzLmFkZFNjYWxhck5vZGVDb21tYW5kID0gQWRkU2NhbGFyTm9kZUNvbW1hbmQocmZ4RWRpdG9yQ29yZSk7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5hZGRSRlRQb3J0YWxJdGVtQ29tbWFuZCA9IEFkZFJGVFBvcnRhbEl0ZW1Db21tYW5kKHJmeEVkaXRvckNvcmUpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmFmdGVyQ3JlYXRlUGFuZWwgPSAobm9kZSkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZngtZWRpdG9yLWFwcDogcGFuZWwgY3JlYXRlZC5cIiwgbm9kZSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlTmV3VGVtcGxhdGVDbGljayA9ICgpID0+IHsgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVPcGVuVGVtcGxhdGVDbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgcG9ydGFsIH0gPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5pdGVtQnJvd3NlckVsZW1lbnQgPSBjcmVhdGVSRnhJdGVtQnJvd3Nlcih7XG4gICAgICAgICAgICAgICAgaGVhZGVyOiB0aGlzLnN0cmluZ3MuYnJvd3NlUkZULFxuICAgICAgICAgICAgICAgIHBvcnRhbCxcbiAgICAgICAgICAgICAgICB1c2VyOiBwb3J0YWwudXNlcixcbiAgICAgICAgICAgICAgICBvbkNsb3NlOiB0aGlzLmNsb3NJdGVtQnJvd3NlcixcbiAgICAgICAgICAgICAgICBvblNlbGVjdGlvbjogdGhpcy5oYW5kbGVJdGVtQnJvd3NlclNlbGVjdGlvblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuaXRlbUJyb3dzZXJFbGVtZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVJdGVtQnJvd3NlclNlbGVjdGlvbiA9IGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmRldGFpbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBvcnRhbEl0ZW1JZCA9IGV2ZW50LmRldGFpbC5pZDtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJmeENvcmVTZXJ2aWNlcy5hZGRSRlRQb3J0YWxJdGVtQ29tbWFuZC5leGVjdXRlKHBvcnRhbEl0ZW1JZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIGRpc3BsYXkgc2VsZWN0ZWQgUmFzdGVyIGZ1bmN0aW9uIHRlbXBsYXRlLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBicm93c2UgZmFpbHVyZSBhbGVydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnNob3dGYWlsdXJlQWxlcnQoeyB0aXRsZTogdGhpcy5zdHJpbmdzLnJmdExvYWRGYWlsIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVBZGRGdW5jdGlvbkNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52aXNpYmlsaXR5UmVkdWNlcih7IGtleTogXCJyZnhMaXN0Vmlld1wiLCB2aXNpYmxlOiB0cnVlIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZUFkZENvbnN0YW50Q2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5hZGRTY2FsYXJOb2RlQ29tbWFuZC5leGVjdXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlQWRkUmFzdGVyQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5hZGRSYXN0ZXJOb2RlQ29tbWFuZC5leGVjdXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlUnVuQ2xpY2sgPSAoKSA9PiB7IH07XG4gICAgICAgIHRoaXMuaGFuZGxlU2F2ZUNsaWNrID0gKCkgPT4geyB9O1xuICAgICAgICB0aGlzLmhhbmRsZUNsb3NlQ2xpY2sgPSAoKSA9PiB7IH07XG4gICAgICAgIHRoaXMuaGFuZGxlRGlhZ3JhbVpvb21JbiA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmZ4Q29yZVNlcnZpY2VzLmRpYWdyYW1ab29tSW5Db21tYW5kLmV4ZWN1dGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVEaWFncmFtWm9vbU91dCA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmZ4Q29yZVNlcnZpY2VzLmRpYWdyYW1ab29tT3V0Q29tbWFuZC5leGVjdXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlRGlhZ3JhbUF1dG9MYXlvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJmeENvcmVTZXJ2aWNlcy5kaWFncmFtQXV0b0xheW91dENvbW1hbmQuZXhlY3V0ZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZURpYWdyYW1TdHJldGNoID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZnhDb3JlU2VydmljZXMuZGlhZ3JhbVN0cmV0Y2hDb21tYW5kLmV4ZWN1dGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVEaWFncmFtUGFuID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZnhDb3JlU2VydmljZXMuZGlhZ3JhbVBhbkNvbW1hbmQuZXhlY3V0ZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZURpYWdyYW1TZWxlY3QgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyBGSVhNRSBhdm9pZCBsb2dpYyB0byB0b2dnbGUgaW4gdGhlIHNhbWUgY29tbWFuZFxuICAgICAgICAgICAgdGhpcy5yZnhDb3JlU2VydmljZXMuZGlhZ3JhbVBhbkNvbW1hbmQuZXhlY3V0ZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVJGVExhdW5jaCA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuYW5hbHlzaXNSRlRMYXVuY2guZW1pdCh0aGlzLnJmeFRlbXBsYXRlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVSRlRTYXZlID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJoYW5kbGVSRlRTYXZlXCIpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNsb3NlU2F2ZU1vZGFsID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2F2ZU1vZGFsRWxlbWVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlTW9kYWxFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjYW5jZWxDbGlja1wiLCB0aGlzLmNsb3NlU2F2ZU1vZGFsKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVNb2RhbEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlTW9kYWxFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNsb3NJdGVtQnJvd3NlciA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLml0ZW1Ccm93c2VyRWxlbWVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtQnJvd3NlckVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJmeEl0ZW1Ccm93c2VyQ2xvc2VcIiwgdGhpcy5jbG9zSXRlbUJyb3dzZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlbUJyb3dzZXJFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlbUJyb3dzZXJFbGVtZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVJGVFNhdmVBcyA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaGFuZGxlUkZUU2F2ZUFzXCIpO1xuICAgICAgICAgICAgY29uc3QgeyBwb3J0YWwsIHBvcnRhbEl0ZW0sIGNsb3NlU2F2ZU1vZGFsIH0gPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5zYXZlTW9kYWxFbGVtZW50Py5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc2F2ZU1vZGFsRWxlbWVudCA9IGNyZWF0ZVJGeFNhdmVNb2RhbCh7XG4gICAgICAgICAgICAgICAgcG9ydGFsLFxuICAgICAgICAgICAgICAgIHBvcnRhbEl0ZW0sXG4gICAgICAgICAgICAgICAgb25DYW5jZWw6IGNsb3NlU2F2ZU1vZGFsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5zYXZlTW9kYWxFbGVtZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVPcGVuVGVtcGxhdGVFZGl0b3IgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnZpc2liaWxpdHlSZWR1Y2VyKHsga2V5OiBcInJmeFRlbXBsYXRlRWRpdG9yXCIsIHZpc2libGU6IHRydWUgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlUkZUU2hhcmUgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImhhbmRsZVJGVFNoYXJlXCIpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVJGeExpc3RWaWV3VHJpZ2dlclNlbGVjdEZ1bmN0aW9uID0gYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHsgZGV0YWlsOiByZnhmdW5jdGlvblRpdGxlIH0gPSBldmVudDtcbiAgICAgICAgICAgIC8vIFRPRE86IHJlbW92ZSB3aGVuIG5vZGUgY2xpY2sgaXMgZW5hYmxlZFxuICAgICAgICAgICAgY29uc3QgcmZ4VGVtcGxhdGUgPSBhd2FpdCBnZXRGdW5jdGlvblRlbXBsYXRlKHJmeGZ1bmN0aW9uVGl0bGUpO1xuICAgICAgICAgICAgdGhpcy5kZXRhaWxzRWRpdG9yUmZ4VGVtcGxhdGUgPSByZnhUZW1wbGF0ZTtcbiAgICAgICAgICAgIHRoaXMucmZ4Q29yZVNlcnZpY2VzLmFkZFJGeEZ1bmN0aW9uQ29tbWFuZC5leGVjdXRlKHJmeFRlbXBsYXRlKTtcbiAgICAgICAgICAgIC8vIHRoaXMudmlzaWJpbGl0eVJlZHVjZXIoeyBrZXk6IFwicmZ4QXJnRGV0YWlsc0VkaXRvclwiLCB2aXNpYmxlOiB0cnVlIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVJGeExpc3RWaWV3UGFuZWxDbG9zZSA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpc2liaWxpdHlSZWR1Y2VyKHsga2V5OiBcInJmeExpc3RWaWV3XCIsIHZpc2libGU6IGZhbHNlIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVJGeFRlbXBsYXRlRWRpdG9yUGFuZWxDbG9zZSA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpc2liaWxpdHlSZWR1Y2VyKHsga2V5OiBcInJmeFRlbXBsYXRlRWRpdG9yXCIsIHZpc2libGU6IGZhbHNlIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVJGeFRlbXBsYXRlRWRpdG9yUGFuZWxPayA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCB7IGRldGFpbDogdmFsdWUgfSA9IGV2ZW50O1xuICAgICAgICAgICAgY29uc29sZS5sb2codmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVJGeFRlbXBsYXRlRWRpdG9yUGFuZWxDYW5jZWwgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgY29uc3QgeyBkZXRhaWw6IHZhbHVlIH0gPSBldmVudDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbHVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVSRnhEZXRhaWxzRWRpdG9yUGFuZWxDbG9zZSA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpc2liaWxpdHlSZWR1Y2VyKHsga2V5OiBcInJmeEFyZ0RldGFpbHNFZGl0b3JcIiwgdmlzaWJsZTogZmFsc2UgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlUkZ4QnJvd3NlTGF5ZXJzUGFuZWxDbG9zZSA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnZpc2liaWxpdHlSZWR1Y2VyKHsga2V5OiBcInJmeEJyb3dzZUxheWVyc0RpYWxvZ1wiLCB2aXNpYmxlOiBmYWxzZSB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhbmRsZXMgdGhlIGNoYW5nZSBldmVudCBvZiBBbmFseXNpcyBIZWxwIFBvcG92ZXIgY2xvc2VcbiAgICAgICAgICogQGNhdGVnb3J5IFByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGFuZGxlUG9wb3ZlckNsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gU29ydCBvZiBnYXJiYWdlIGNvbGxlY3Rpb24sIGRvbmUgdG8gZW5zdXJlIHRvb2xIZWxwUG9wb3ZlciBpcyBkaXNwb3NlIGNvcnJlY3RseSBvbmNlIGNsb3NlZC5cbiAgICAgICAgICAgIHJlbW92ZU9wZW5hYmxlRG9tRWxlbWVudCh0aGlzLnRvb2xIZWxwUG9wb3Zlcik7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIYW5kbGVzIHRoZSBjbGljayBldmVudCBvZiBIZWFkaW5nIEhlbHBcbiAgICAgICAgICogQGNhdGVnb3J5IFByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGFuZGxlUkZ4RGV0YWlsc0VkaXRvckhlYWRpbmdIZWxwQ2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBUT0RPOiByZW1vdmUgd2hlbiBub2RlIGNsaWNrIGlzIGVuYWJsZWRcbiAgICAgICAgICAgIC8vIFRPRE86IGxvb2tzIGxpa2UgcmZ4TmFtZSBhbmQgcmZ4VGl0bGUgYXJlIHR3byBkaWZmZXJlbnQgdGhpbmdzXG4gICAgICAgICAgICAvLyBQYXNzIHJmeE5hbWUgYXMgaWRlbnRpZmllciwgcmZ4VGl0bGUgYXMgUGFuZWwgbmFtZVxuICAgICAgICAgICAgY29uc3QgcmZ4VGVtcGxhdGUgPSB0aGlzLmRldGFpbHNFZGl0b3JSZnhUZW1wbGF0ZTtcbiAgICAgICAgICAgIGNvbnN0IHJmeElkZW50aWZlciA9IGdldFJGVEZ1bmN0aW9uSWRlbnRpZmllcihyZnhUZW1wbGF0ZSk7XG4gICAgICAgICAgICBjb25zdCB7IGhlbHBUZW1wbGF0ZTogaGVscFNyY2RvYywgbGVhcm5Nb3JlVXJsIH0gPSBhd2FpdCBnZXRGdW5jdGlvbkRlc2NyaXB0aW9uSGVscFRlbXBsYXRlKHtcbiAgICAgICAgICAgICAgICByZnhOYW1lOiByZnhJZGVudGlmZXIsXG4gICAgICAgICAgICAgICAgcmZ4VGVtcGxhdGUsXG4gICAgICAgICAgICAgICAgcG9ydGFsOiB1bmRlZmluZWQgLy8gdGhpcy5wb3J0YWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy50b29sSGVscFBvcG92ZXIgPSBzaG93SGVscCh0aGlzLnRvb2xIZWxwUG9wb3Zlciwge1xuICAgICAgICAgICAgICAgIGhlbHBTcmNkb2MsXG4gICAgICAgICAgICAgICAgaGVscElkOiBcInRvb2xEZXNjcmlwdGlvblwiLFxuICAgICAgICAgICAgICAgIGhlYWRpbmc6IHJmeFRlbXBsYXRlLm5hbWUsXG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlRWxlbWVudDogdGhpcy5oZWFkZXJFbGVtZW50LFxuICAgICAgICAgICAgICAgIGxlYXJuTW9yZVVybCxcbiAgICAgICAgICAgICAgICBvZmZzZXREaXN0YW5jZTogMjUsXG4gICAgICAgICAgICAgICAgb2Zmc2V0U2tpZGRpbmc6IDAgLy8gdmVydGljYWwgYXhpc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnRvb2xIZWxwUG9wb3Zlci5hZGRFdmVudExpc3RlbmVyKFwicmZ4SGVscFBvcG92ZXJDbG9zZVwiLCB0aGlzLmhhbmRsZVBvcG92ZXJDbG9zZSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2hvd1JmeExpc3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5tYXBWaWV3ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLm1hcExheWVycyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wb3J0YWwgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucG9ydGFsSXRlbSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5kZXRhaWxzRWRpdG9yUmZ4VGVtcGxhdGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucmVuZGVyRmxhZyA9IGZhbHNlO1xuICAgIH1cbiAgICAvLyBUT0RPOiBTaW5jZSBhIHNsb3Qgc2lnbmlmaWVzIHZhcmlhYmxlIGNvbXBvbmVudHMgd2UgY2FuJ3QgaGF2ZSB0aGlzIG1lY2hhbmlzbSwgaW1wcm92ZSBpbiBmdXR1cmVcbiAgICBoYW5kbGVBY3Rpb25CYXJDbGljayhwYXlsb2FkKSB7XG4gICAgICAgIHN3aXRjaCAocGF5bG9hZC5kZXRhaWwuYWN0aW9uSWQpIHtcbiAgICAgICAgICAgIGNhc2UgRWRpdG9yQWN0b25CYXJBY3Rpb25zLm5ld1RlbXBsYXRlOlxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlTmV3VGVtcGxhdGVDbGljaygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBFZGl0b3JBY3RvbkJhckFjdGlvbnMub3BlblRlbXBsYXRlOlxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlT3BlblRlbXBsYXRlQ2xpY2soKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgRWRpdG9yQWN0b25CYXJBY3Rpb25zLmFkZEZ1bmN0aW9uOlxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQWRkRnVuY3Rpb25DbGljaygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBFZGl0b3JBY3RvbkJhckFjdGlvbnMuYWRkQ29uc3RhbnQ6XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVBZGRDb25zdGFudENsaWNrKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEVkaXRvckFjdG9uQmFyQWN0aW9ucy5hZGRSYXN0ZXI6XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVBZGRSYXN0ZXJDbGljaygpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKFwiYWN0aW9uQmFyIGNsaWNrZWRcIik7XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBMaWZlY3ljbGVcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICAgICAgKHsgc3RyaW5nczogdGhpcy5zdHJpbmdzLCBkaXI6IHRoaXMuZGlyZWN0aW9uIH0gPSBhd2FpdCBmZXRjaENvbXBvbmVudExvY2FsZVN0cmluZ3ModGhpcy5ob3N0RWxlbWVudCwgZ2V0QXNzZXRQYXRoKGAuYCkpKTtcbiAgICB9XG4gICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgIHJlbW92ZU9wZW5hYmxlRG9tRWxlbWVudCh0aGlzLnRvb2xIZWxwUG9wb3Zlcik7XG4gICAgfVxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBtZXRob2RzXG4gICAgLy9cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFJlZHVjZXIgdG8gdXBkYXRlIHZpc2liaWxpdHlcbiAgICB2aXNpYmlsaXR5UmVkdWNlcih7IGtleSwgdmlzaWJsZSB9KSB7XG4gICAgICAgIGNvbnN0IE1BWF9JVEVNU19WSVNJQkxFX0lOX1NMT1QgPSAyO1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5vdmVybGF5RWxlbWVudHNDb25maWdba2V5XTtcbiAgICAgICAgLy8gUnVsZSAxOiBDaGVjayBpZiB0aGUgaXRlbSBpcyBhbHJlYWR5IHZpc2libGUuXG4gICAgICAgIGlmIChlbGVtZW50LnZpc2libGUgPT09IHZpc2libGUpIHtcbiAgICAgICAgICAgIHJldHVybjsgLy8gTm8gY2hhbmdlIG5lZWRlZFxuICAgICAgICB9XG4gICAgICAgIGlmICh2aXNpYmxlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAvLyBGaW5kIGFsbCBpdGVtcyBpbiB0aGUgc2FtZSBzbG90LlxuICAgICAgICAgICAgY29uc3Qgc2FtZVNsb3RJdGVtcyA9IE9iamVjdC52YWx1ZXModGhpcy5vdmVybGF5RWxlbWVudHNDb25maWcpLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5zbG90ID09PSBlbGVtZW50LnNsb3QpO1xuICAgICAgICAgICAgLy8gUnVsZSAyOiBJZiB0aGVyZSBhcmUgbW9yZSB0aGFuIG9uZSB2aXNpYmxlIGl0ZW1zIGluIHRoZSBzYW1lIHNsb3QsIGhpZGUgYWxsIGJ1dCB0aGUgZmlyc3Qgb25lLlxuICAgICAgICAgICAgaWYgKHNhbWVTbG90SXRlbXMubGVuZ3RoID49IE1BWF9JVEVNU19WSVNJQkxFX0lOX1NMT1QpIHtcbiAgICAgICAgICAgICAgICBzYW1lU2xvdEl0ZW1zLnNsaWNlKDEpLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vIE9wdGlvbmFsbHksIHlvdSBjYW4gY2FsbCBhIGNsb3NlIG1ldGhvZCBpZiBpdCBleGlzdHMuXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0ZW0uY2xvc2U/LigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnQudmlzaWJsZSA9IHZpc2libGU7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVSZW5kZXJlcigpO1xuICAgIH1cbiAgICBzY2hlZHVsZVJlbmRlcmVyKCkge1xuICAgICAgICB0aGlzLnJlbmRlckZsYWcgPSAhdGhpcy5yZW5kZXJGbGFnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW5kZXJzIG92ZXJsYXkgZWxlbWVudHMgYmFzZWQgb24gdGhlIGNvbmZpZ3VyYXRpb24uXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2YgY29tcG9uZW50cyB0byBiZSByZW5kZXJlZCBpbiB0aGUgb3ZlcmxheSBzbG90cy5cbiAgICAgKi9cbiAgICByZW5kZXJPdmVybGF5RWxlbWVudHMoKSB7XG4gICAgICAgIGNvbnN0IGRldGFpbHNFZGl0b3JSZnhUZW1wbGF0ZSA9IHRoaXMuZGV0YWlsc0VkaXRvclJmeFRlbXBsYXRlO1xuICAgICAgICBjb25zdCBhZGRSYXN0ZXJGdW5jdGlvblRpdGxlID0gdGhpcy5zdHJpbmdzLmFkZFJhc3RlckZ1bmN0aW9uVGl0bGU7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlUHJvcGVydGllc1RpdGxlID0gdGhpcy5zdHJpbmdzLnRlbXBsYXRlUHJvcGVydGllc1RpdGxlO1xuICAgICAgICBjb25zdCBicm93c2VMYXllckRpYWxvZ1RpdGxlID0gdGhpcy5zdHJpbmdzLmJyb3dzZUxheWVyRGlhbG9nVGl0bGU7XG4gICAgICAgIGNvbnN0IGR5bmFtaWNCdWlsZGVyUHJvcHMgPSB7XG4gICAgICAgICAgICBkZXRhaWxzRWRpdG9yUmZ4VGVtcGxhdGUsXG4gICAgICAgICAgICBhZGRSYXN0ZXJGdW5jdGlvblRpdGxlLFxuICAgICAgICAgICAgdGVtcGxhdGVQcm9wZXJ0aWVzVGl0bGUsXG4gICAgICAgICAgICBicm93c2VMYXllckRpYWxvZ1RpdGxlXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50c0NvbmZpZyA9IHRoaXMub3ZlcmxheUVsZW1lbnRzQ29uZmlnO1xuICAgICAgICBjb25zdCBvdmVybGF5RWxlbWVudHNLZXlzID0gT2JqZWN0LmtleXMob3ZlcmxheUVsZW1lbnRzQ29uZmlnKTtcbiAgICAgICAgY29uc3Qgb3ZlcmxheUVsZW1lbnRzID0gb3ZlcmxheUVsZW1lbnRzS2V5cy5tYXAoKGtleSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudENvbmZpZyA9IG92ZXJsYXlFbGVtZW50c0NvbmZpZ1trZXldO1xuICAgICAgICAgICAgaWYgKCFlbGVtZW50Q29uZmlnLnZpc2libGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBlbGVtZW50Q29uZmlnPy5idWlsZGVyPy4oZHluYW1pY0J1aWxkZXJQcm9wcyk7XG4gICAgICAgICAgICBjb21wb25lbnQuJGF0dHJzJC5zbG90ID0gZWxlbWVudENvbmZpZy5zbG90O1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvdmVybGF5RWxlbWVudHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByaXZhdGUgbWV0aG9kIHRvIHJlbmRlciB0aGUgZWRpdG9yIGNvcmUgVUlcbiAgICAgKiBAY2F0ZWdvcnkgUHJpdmF0ZVxuICAgICAqL1xuICAgIF9yZW5kZXJFZGl0b3JDb3JlVUkoKSB7XG4gICAgICAgIHJldHVybiAoaChcInJmeC1lZGl0b3ItY29yZVwiLCB7IHJlZjogdGhpcy5pbml0aWFsaXplUkZ4RWRpdG9yQ29yZSwgb25SZnhDb3JlTm9kZUVkaXRQcm9wZXJ0aWVzOiAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGRldGFpbDogdmFsdWUgfSA9IGV2ZW50O1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHZhbHVlLmRhdGFUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJSYXN0ZXJcIiAvKiBUb29sQXJndW1lbnREYXRhVHlwZS5SYXN0ZXIgKi86XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpc2liaWxpdHlSZWR1Y2VyKHsga2V5OiBcInJmeEJyb3dzZUxheWVyc0RpYWxvZ1wiLCB2aXNpYmxlOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJUb29sXCIgLyogVG9vbEFyZ3VtZW50RGF0YVR5cGUuVG9vbCAqLzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlzaWJpbGl0eVJlZHVjZXIoeyBrZXk6IFwicmZ4QXJnRGV0YWlsc0VkaXRvclwiLCB2aXNpYmxlOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxzRWRpdG9yUmZ4VGVtcGxhdGUgPSB2YWx1ZS5qc29uO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB9LCB0aGlzLnJlbmRlck92ZXJsYXlFbGVtZW50cygpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBjYXRlZ29yeSBMaWZlY3ljbGVcbiAgICAgKiBSZW5kZXIgbGlmZWN5Y2xlIG1ldGhvZFxuICAgICAqL1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZngtZWRpdG9yLWFwcCByZW5kZXJcIik7XG4gICAgICAgIHJldHVybiAoaChIb3N0LCB7IGNsYXNzOiBIVE1MQ2xhc3Nlcy5ob3N0IH0sIGgoXCJkaXZcIiwgeyBjbGFzczoge1xuICAgICAgICAgICAgICAgIFtIVE1MQ2xhc3Nlcy5jb250ZW50XTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBbQ1NTX1VUSUxJVFkucnRsXTogdGhpcy5kaXJlY3Rpb24gPT09IFwicnRsXCJcbiAgICAgICAgICAgIH0gfSwgaChcInNsb3RcIiwgeyBuYW1lOiBTbG90LmFjdGlvbkJhciB9KSwgaChcImNhbGNpdGUtcGFuZWxcIiwgeyBoZWFkaW5nOiBcIlwiLCByZWY6IHRoaXMuYWZ0ZXJDcmVhdGVQYW5lbCB9LCB0aGlzLl9yZW5kZXJFZGl0b3JDb3JlVUkoKSkpKSk7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgYXNzZXRzRGlycygpIHsgcmV0dXJuIFtcInQ5blwiXTsgfVxuICAgIGdldCBob3N0RWxlbWVudCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5SRnhFZGl0b3JBcHAuc3R5bGUgPSByZnhFZGl0b3JBcHBDc3M7XG5cbmV4cG9ydCB7IFJGeEVkaXRvckFwcCBhcyBSIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJmeC1lZGl0b3ItYXBwLWY5NmRjMzFlLmpzLm1hcCIsImV4cG9ydCB7IFIgYXMgcmZ4X2VkaXRvcl9hcHAgfSBmcm9tICcuL3JmeC1lZGl0b3ItYXBwLWY5NmRjMzFlLmpzJztcbmltcG9ydCAnLi9pbmRleC1kYTFiNzEzOC5qcyc7XG5pbXBvcnQgJy4vcmZ4LWNvcmUtaW50ZXJmYWNlcy04NzcwOWI2Mi5qcyc7XG5pbXBvcnQgJy4vZnVuY3Rpb25zLWYxZjJkZmZkLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2NvcmUvbGFuZy5qcyc7XG5pbXBvcnQgJy4vcmVzb3VyY2VzLTI3YzY2ZjVjLmpzJztcbmltcG9ydCAnLi9sb2NhbGl6YXRpb24taGVscGVyLTQ4MTliNjdkLmpzJztcbmltcG9ydCAnLi90eXBlLWdhdXJkcy0xODQwNzQ3Zi5qcyc7XG5pbXBvcnQgJy4vX2dldFRhZy05NmFmMDI5ZC5qcyc7XG5pbXBvcnQgJy4vaGVscC10ZXh0LTM0YTI5ODM1LmpzJztcbmltcG9ydCAnLi9yZngtYXJncy1oZWxwZXItYWI0MDE1NDMuanMnO1xuaW1wb3J0ICcuL2ludGVyZmFjZXMtZDBjNjg5NDQuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvaWRlbnRpdHkvSWRlbnRpdHlNYW5hZ2VyLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2NvcmUvdXJsVXRpbHMuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvbGF5ZXJzL0xheWVyLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2xheWVycy9JbWFnZXJ5TGF5ZXIuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvc21hcnRNYXBwaW5nL3Jhc3Rlci9yZW5kZXJlcnMvc3RyZXRjaC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXF1ZXN0LmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL3Jlc3Qvc3VwcG9ydC9BbGdvcml0aG1pY0NvbG9yUmFtcC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXN0L3N1cHBvcnQvTXVsdGlwYXJ0Q29sb3JSYW1wLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL0NvbG9yLmpzJztcbmltcG9ydCAnLi9jb2xvclJhbXBVdGlscy04YmRkNDZjNS5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXN0L2dlb3Byb2Nlc3Nvci5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9wb3J0YWwvUG9ydGFsSXRlbS5qcyc7XG5pbXBvcnQgJy4vcmVzb3VyY2VzLTQ2YjI5M2IyLmpzJztcbmltcG9ydCAnLi9wb3BvdmVyLXV0aWxzLTcyNTQ5M2Q3LmpzJztcbmltcG9ydCAnLi93aWRnZXQtZmFjdG9yeS1lODFjNzUwMS5qcyc7XG5pbXBvcnQgJy4vaW50ZXJmYWNlcy04NzlmODNkNy5qcyc7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJmeC1lZGl0b3ItYXBwLmVudHJ5LmpzLm1hcCIsImltcG9ydCB7IGkgYXMgaXNFbXB0eURhdGFJdGVtIH0gZnJvbSAnLi90eXBlLWdhdXJkcy0xODQwNzQ3Zi5qcyc7XG5cbi8qKlxuICogUmZ4IHNlY3Rpb24gd2lkZ2V0XG4gKiBAcGFyYW0ge1JGeFdpZGdldFByb3BzWydsYWJlbCddfSBsYWJlbCAtIGxhYmVsIG9mIHRoZSBzZWN0aW9uXG4gKiBAcGFyYW0ge1JGeFdpZGdldFByb3BzWydvcGVuJ119IG9wZW4gd2hldGhlciBvciBub3QgdGhlIGNvbXBvbmVudCBpcyBvcGVuXG4gKiBAcmV0dXJucyB7SFRNTFJmeFNlY3Rpb25FbGVtZW50fSAtIFJmeCBzZWN0aW9uIGNvbXBvbmVudFxuICovXG5jb25zdCBidWlsZFJmeFNlY3Rpb24gPSAoeyBsYWJlbCwgb3BlbiB9KSA9PiB7XG4gICAgY29uc3QgcmZ4U2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJyZngtc2VjdGlvblwiKTtcbiAgICByZnhTZWN0aW9uLmxhYmVsID0gbGFiZWw7XG4gICAgcmZ4U2VjdGlvbi5vcGVuID0gb3BlbjtcbiAgICByZXR1cm4gcmZ4U2VjdGlvbjtcbn07XG4vKipcbiAqIFJmeCB3cmFwcGVyIGFyb3VuZCBjYWxjaXRlLWJsb2NrLCB1c2VkIGFzIGZ1bmN0aW9uIHBhbmVsXG4gKiBAcGFyYW0ge1JGeFdpZGdldFByb3BzWydjb250ZW50J119IGNvbnRlbnQgLSBjb250ZW50IG9mIHRoZSBzZWN0aW9uXG4gKiBAcGFyYW0ge1JGeFdpZGdldFByb3BzWyd0aXRsZSddfSB0aXRsZSAtIHRpdGxlIG9mIHRoZSBzZWN0aW9uXG4gKiBAcGFyYW0ge1JGeFdpZGdldFByb3BzWydpc0Z1bmN0aW9uQ2hhaW4nXX0gaXNGdW5jdGlvbkNoYWluIHdoZXRoZXIgb3Igbm90IHRoZSByZnh0ZW1wbGF0ZSBiZWluZyBidWlsdCBpcyBGdW5jdGlvbiBDaGFpblxuICogQHBhcmFtIHtSRnhXaWRnZXRQcm9wc1sndW5zdXBwb3J0ZWRXYXJuaW5nQ29tcG9uZW50J119IHVuc3VwcG9ydGVkV2FybmluZ0NvbXBvbmVudCBIVE1MQ2FsY2l0ZU5vdGljZUVsZW1lbnQgbm90aWNlIHRvIGFwcGVuZCB0byBwYW5lbCBpbmNhc2UgcmZ4dGVtcGxhdGUgaGFzIHVuc3VwcG9ydGVkIHVpLW92ZXJycmRpZXMgLyBkYXRhL2RvbWFpbiB0eXBlc1xuICogQHJldHVybnMge0hUTUxDYWxjaXRlQmxvY2tFbGVtZW50fSAtIFJmeCBzZWN0aW9uIGNvbXBvbmVudFxuICovXG5jb25zdCBidWlsZFRpdGxlUGFuZSA9ICh7IGNvbnRlbnQsIHVuc3VwcG9ydGVkV2FybmluZ0NvbXBvbmVudCwgdGl0bGUsIGlzRnVuY3Rpb25DaGFpbiB9KSA9PiB7XG4gICAgY29uc3QgdGl0bGVQYW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbGNpdGUtYmxvY2tcIik7XG4gICAgdGl0bGVQYW5lLm9wZW4gPSB0cnVlO1xuICAgIC8vIGlmIGZ1bmN0aW9uIGNoYWluIHNob3cgRnVuY3Rpb24gbmFtZSBhcyBoZWFkaW5nXG4gICAgaWYgKGlzRnVuY3Rpb25DaGFpbiA9PT0gdHJ1ZSkge1xuICAgICAgICB0aXRsZVBhbmUuaGVhZGluZyA9IHRpdGxlO1xuICAgICAgICB0aXRsZVBhbmUuY29sbGFwc2libGUgPSB0cnVlO1xuICAgICAgICB0aXRsZVBhbmUuaGVhZGluZ0xldmVsID0gMztcbiAgICB9XG4gICAgaWYgKCFpc0VtcHR5RGF0YUl0ZW0odW5zdXBwb3J0ZWRXYXJuaW5nQ29tcG9uZW50KSkge1xuICAgICAgICB0aXRsZVBhbmUuYXBwZW5kQ2hpbGQodW5zdXBwb3J0ZWRXYXJuaW5nQ29tcG9uZW50KTtcbiAgICB9XG4gICAgdGl0bGVQYW5lLmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuICAgIHJldHVybiB0aXRsZVBhbmU7XG59O1xuLyoqXG4gKiBSZnggd3JhcHBlciBhcm91bmQgcmZ4LWJsb2NrLCB1c2VkIHRvIGRpc3BsYXkgbGFiZWwgb2YgZnVuY3Rpb24gcGFyYW1ldGVyc1xuICogQHBhcmFtIHtSRnhXaWRnZXRQcm9wc1snbGFiZWwnXX0gbGFiZWwgLSBsYWJlbCBvZiB0aGUgcGFyYW1ldGVyXG4gKiBAcGFyYW0ge1JGeFdpZGdldFByb3BzWydoaWRlSGVscCddfSBoaWRlSGVscCB3aGV0aGVyIG9yIG5vdCB0byBzaG93IHRoZSBoZWxwIGljb24gbmV4dCB0byBwYXJhbWV0ZXIgbGFiZWxcbiAqIEBwYXJhbSB7UkZ4V2lkZ2V0UHJvcHNbJ29uSGVscEFjdGlvbkNsaWNrJ119IG9uSGVscEFjdGlvbkNsaWNrIGZ1bmN0aW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gaGVscEFjdGlvbiBpcyBjbGlja2VkXG4gKiBAcmV0dXJucyB7SFRNTENhbGNpdGVCbG9ja0VsZW1lbnR9IC0gUmZ4IGxhYmVsIGNvbXBvbmVudFxuICovXG5jb25zdCBjcmVhdGVSRnhMYWJlbFdyYXBwZXIgPSAoeyBsYWJlbCwgaGlkZUhlbHAgPSBmYWxzZSwgb25IZWxwQWN0aW9uQ2xpY2sgfSkgPT4ge1xuICAgIGNvbnN0IGxhYmVsV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJyZngtbGFiZWxcIik7XG4gICAgbGFiZWxXcmFwcGVyLmxhYmVsID0gbGFiZWw7XG4gICAgbGFiZWxXcmFwcGVyLmhpZGVIZWxwID0gaGlkZUhlbHA7XG4gICAgbGFiZWxXcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJyZnhMYWJlbEhlbHBBY3Rpb25DbGlja1wiLCBvbkhlbHBBY3Rpb25DbGljayk7XG4gICAgcmV0dXJuIGxhYmVsV3JhcHBlcjtcbn07XG4vKipcbiAqIFRvIGNyZWF0ZSBzYXZlIGRpYWxnb3VlIG9uIHNhdmUgb3Igc2F2ZSBhcyBjbGlja1xuICogQHBhcmFtIHtSRnhNb2RhbFByb3BzWydwb3J0YWwnXX0gcG9ydGFsIC0gcG9ydGFsIHRvIHdoaWNoIHRoZSBpdGVtIHNob3VsZCBiZSBzYXZlZFxuICogQHBhcmFtIHtSRnhNb2RhbFByb3BzWydwb3J0YWxJdGVtJ119IHBvcnRhbEl0ZW0gcG90YWwgaXRlbSBkZXRhaWxzIHRvIGJlIHNob3duIG9uIHNhdmUgZGlhbG9ndWVcbiAqIEBwYXJhbSB7UkZ4TW9kYWxQcm9wc1snb25DYW5jZWxDbGljayddfSBvbkNhbmNlbENsaWNrIGZ1bmN0aW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gY2FuY2VsIGlzIGNsaWNrZWRcbiAqIEByZXR1cm5zIHtIVE1MUkZ4U2F2ZU1vZGFsRWxlbWVudH0gLSBSZnggc2F2ZSBtb2RhbCBlbGVtZW50XG4gKi9cbmNvbnN0IGNyZWF0ZVJGeFNhdmVNb2RhbCA9ICh7IHBvcnRhbCwgcG9ydGFsSXRlbSwgb25DYW5jZWwgfSkgPT4ge1xuICAgIGNvbnN0IHNhdmVNb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicmZ4LXNhdmUtbW9kYWxcIik7XG4gICAgc2F2ZU1vZGFsRWxlbWVudC5wb3J0YWwgPSBwb3J0YWw7XG4gICAgc2F2ZU1vZGFsRWxlbWVudC5wb3J0YWxJdGVtID0gcG9ydGFsSXRlbTtcbiAgICBzYXZlTW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjYW5jZWxDbGlja1wiLCBvbkNhbmNlbCk7XG4gICAgcmV0dXJuIHNhdmVNb2RhbEVsZW1lbnQ7XG59O1xuLyoqXG4gKiBUbyBjcmVhdGUgaXRlbSBicm9zZXIgZm9yIFJGVCBicm93c2luZ1xuICogQHBhcmFtIHtSZnhTYXZlTW9kYWxQcm9wc1sncG9ydGFsJ119IHBvcnRhbCAtIHBvcnRhbCB0byB3aGljaCB0aGUgaXRlbSBzaG91bGQgYmUgc2F2ZWRcbiAqIEBwYXJhbSB7UkZ4V2lkZ2V0UHJvcHNbJ3BvcnRhbEl0ZW0nXX0gcG9ydGFsSXRlbSBwb3RhbCBpdGVtIGRldGFpbHMgdG8gYmUgc2hvd24gb24gc2F2ZSBkaWFsb2d1ZVxuICogQHBhcmFtIHtSRnhXaWRnZXRQcm9wc1snb25DYW5jZWxDbGljayddfSBvbkNhbmNlbENsaWNrIGZ1bmN0aW9uIHRvIGJlIGV4ZWN1dGVkIHdoZW4gY2FuY2VsIGlzIGNsaWNrZWRcbiAqIEByZXR1cm5zIHtIVE1MUkZ4U2F2ZU1vZGFsRWxlbWVudH0gLSBSZnggc2F2ZSBtb2RhbCBlbGVtZW50XG4gKi9cbmNvbnN0IGNyZWF0ZVJGeEl0ZW1Ccm93c2VyID0gKHsgaGVhZGVyLCBwb3J0YWwsIHVzZXIsIG9uQ2xvc2UsIG9uU2VsZWN0aW9uIH0pID0+IHtcbiAgICBjb25zdCBpdGVtQnJvd3NlckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicmZ4LWl0ZW0tYnJvd3NlclwiKTtcbiAgICBpdGVtQnJvd3NlckVsZW1lbnQucG9ydGFsID0gcG9ydGFsO1xuICAgIGl0ZW1Ccm93c2VyRWxlbWVudC51c2VyID0gdXNlcjtcbiAgICBpdGVtQnJvd3NlckVsZW1lbnQuaGVhZGVyID0gaGVhZGVyO1xuICAgIGl0ZW1Ccm93c2VyRWxlbWVudC5maWx0ZXIgPSBgKHR5cGU6IFwiUmFzdGVyIGZ1bmN0aW9uIHRlbXBsYXRlXCIpYDtcbiAgICBpdGVtQnJvd3NlckVsZW1lbnQuc2VsZWN0aW9uTW9kZSA9IFwic2luZ2xlXCI7XG4gICAgaXRlbUJyb3dzZXJFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyZnhJdGVtQnJvd3NlckNsb3NlXCIsIG9uQ2xvc2UpO1xuICAgIGl0ZW1Ccm93c2VyRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicmZ4SXRlbUJyb3dzZXJTZWxlY3Rpb25cIiwgb25TZWxlY3Rpb24pO1xuICAgIHJldHVybiBpdGVtQnJvd3NlckVsZW1lbnQ7XG59O1xuXG5leHBvcnQgeyBjcmVhdGVSRnhTYXZlTW9kYWwgYXMgYSwgYnVpbGRUaXRsZVBhbmUgYXMgYiwgY3JlYXRlUkZ4SXRlbUJyb3dzZXIgYXMgYywgYnVpbGRSZnhTZWN0aW9uIGFzIGQsIGNyZWF0ZVJGeExhYmVsV3JhcHBlciBhcyBlIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdpZGdldC1mYWN0b3J5LWU4MWM3NTAxLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==