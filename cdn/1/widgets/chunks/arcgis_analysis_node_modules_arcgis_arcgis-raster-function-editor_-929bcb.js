"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-929bcb"],{41642:(e,t,r)=>{r.d(t,{a:()=>p,b:()=>g,c:()=>h,d:()=>m,e:()=>A,f:()=>b});var a=r(99248),n=r(16888),s=r(95323),i=r(43278),l=r(77162);const o={ALGORITHMIC_COLOR_RAMP:"AlgorithmicColorRamp",MULTIPART_COLOR_RAMP:"MultiPartColorRamp"};function c(e){const t=(e.h+360)%360/60,r=e.s/100,a=e.v/100*255,n=a*r,s=n*(1-Math.abs(t%2-1));let i;switch(Math.floor(t)){case 0:i={r:n,g:s,b:0};break;case 1:i={r:s,g:n,b:0};break;case 2:i={r:0,g:n,b:s};break;case 3:i={r:0,g:s,b:n};break;case 4:i={r:s,g:0,b:n};break;case 5:case 6:i={r:n,g:0,b:s};break;default:i={r:0,g:0,b:0}}return i.r=Math.round(i.r+a-n),i.g=Math.round(i.g+a-n),i.b=Math.round(i.b+a-n),i}function u(e){const t=e.algorithm??"esriHSVAlgorithm";let{FromColor:r,ToColor:a}=e;if(!Array.isArray(r)){const{r:e,g:t,b:a}=c({h:r.Hue,s:r.Saturation,v:r.Value});r=[e,t,a,r.AlphaValue]}if(!Array.isArray(a)){const{r:e,g:t,b:r}=c({h:a.Hue,s:a.Saturation,v:a.Value});a=[e,t,r,a.AlphaValue]}return{type:"algorithmic",algorithm:t,fromColor:r,toColor:a}}function d(e){if("multipart"===e?.type){const t=e.colorRamps,r=t.map((e=>e.fromColor));return r.push(t[t.length-1].toColor),r}return[e.fromColor,e.toColor]}function f(e){if((0,l.i)(e))return;if(!(0,l.i)(e.colorRamps)||!(0,l.i)(e.toColor)&&!(0,l.i)(e.fromColor))return e;const t=e?.type===o.MULTIPART_COLOR_RAMP?"multipart":"algorithmic",r="multipart"===t?e.ArrayOfColorRamp.map((e=>u(e))):void 0,a="algorithmic"===t?u(e):void 0;return{type:t,colorRamps:r,fromColor:a?.fromColor,toColor:a?.toColor}}function h(e){return t=d(f(e)),Array.isArray(t)?t.some((e=>!(0,l.i)(e.r)&&!(0,l.i)(e.g)&&!(0,l.i)(e.b)))?t:t.map((e=>({r:e[0],g:e[1],b:e[2],a:1}))):t;var t}function p(e,t){const{portal:r}=e,{extraColorRamps:a=[],defaultColors:n}=t,l={color:n||[new s.default([0,0,0,1]),new s.default([255,255,255,1])]},o={color:new s.default([0,0,0,.5]),size:1,style:"solid"},c=function(){const e=[];return i.P.forEach((t=>{e.push({name:i.a.toJSON(t.id),stops:d(t).reverse().map((e=>new s.default(e))),tags:["raster"]})})),e}();return c.push(...a),c.sort((e=>e.tags.indexOf("raster")>-1?-1:1)),{portal:r,sections:{marker:{parts:{preview:!1,rotation:!1,size:!1}},fill:{type:"color-ramp",style:"continuous",colorRamps:c,open:!0,colorRampsOpen:!0,transparencyOpen:!1,parts:{colorRamps:!0,transparency:!1},extraParts:{autoStrokeAdjust:!1,width:!0}}},stroke:{...o,color:[new s.default([13,38,68,1]),new s.default([56,98,122,1]),new s.default([98,158,176,1]),new s.default([177,205,194,1]),new s.default([255,252,212,1])]},fill:l}}function g(e){const t=f(e);if((0,l.i)(t))return;const r=(0,l.i)(t?.clone),s="multipart"===e?.type||e?.type===o.MULTIPART_COLOR_RAMP,c=r?s?n.default.fromJSON(t):a.default.fromJSON(t):t;return(0,i.g)(c)}function m(e){const t=[];for(let r=0;r<e.length-1;r++)t[r]=new a.default({algorithm:"hsv",fromColor:e[r],toColor:e[r+1]||new s.default({r:255,g:255,b:255,a:1})});return e.length>2?new n.default({colorRamps:t}):t[0]}function A(e,t){return(0,i.c)(e,{numColors:t})}function b(){const e=i.P[0];return n.default.fromJSON(e)}},53248:(e,t,r)=>{r.d(t,{A:()=>l,G:()=>c,J:()=>n,M:()=>s,P:()=>u,U:()=>a,a:()=>o,d:()=>i});const a={IDLE:"idle",VALID:"valid",INVALID:"invalid"},n={RASTER_FUNCTION_TEMPLATE:"RasterFunctionTemplate",RASTER_FUNCTION_VARIABLE:"RasterFunctionVariable",ARGUMENT_ARRAY:"ArgumentArray",RECORD_SET:"RecordSet",ECD_FILE:"ECDFile"},s={MATCH_VARIABLE:"MatchVariable",UNION_DIMENSION:"UnionDimension"},i={name:"Raster",isDataset:!0,isPublic:!1,type:n.RASTER_FUNCTION_VARIABLE},l={RFX_DTEX_COMMON_SELECT:"RFX-DTEX-COMMON-SELECT",RFX_DTE_COMMON_CHECKBOX:"CALCITE-CHECKBOX",RFX_DTE_COMMON_TEXTINPUT:"CALCITE-INPUT-TEXT",RFX_DTE_COMMON_NUMBERINPUT:"CALCITE-INPUT-NUMBER",RFX_DTE_RASTER_INPUT:"RFX-DTE-RASTER-INPUT",RFX_DTE_FEATURE_SELECT:"RFX-DTE-FEATURE-SELECT",RFX_DTEX_RASTER_VARIABLES_LIST:"RFX-DTEX-RASTER-VARIABLES-LIST",RFX_CTE_RANGED_VALUE_EDITOR:"RFX-CTE-RANGED-VALUE-EDITOR",RFX_CTE_GAMMA_EDITOR:"RFX-CTE-GAMMA-EDITOR",RFX_DTE_COLOR_RAMP_SELECTOR:"RFX-DTE-COLOR-RAMP-SELECTOR",RFX_DTE_EXTENT:"RFX-DTE-EXTENT",RFX_DTE_JSON_FILE_UPLOADER:"RFX-DTE-JSON-FILE-UPLOADER",RFX_CTE_FACTOR_FUNCTION_EDITOR:"RFX-CTE-FACTOR-FUNCTION-EDITOR",RFX_CTE_NEIGHBORHOOD_VALUES:"RFX-CTE-NEIGHBORHOOD-VALUES"},o={ANALYSIS:"analysis",EDITOR:"editor"},c={textInput:"text-input",text:"text",raster:"raster-input",number:"number-input",boolean:"check-box",switch:"switch",field:"field-select",color:"color-input",select:"select",icon:"icon"},u={loading:"loading",success:"success",error:"error"}},89920:(e,t,r)=>{r.d(t,{S:()=>o,a:()=>h,b:()=>p,d:()=>d,e:()=>R,f:()=>C,g:()=>g,h:()=>m,i:()=>c,j:()=>u,k:()=>f,l:()=>T,m:()=>y,n:()=>_,p:()=>E,q:()=>O,r:()=>v,s:()=>A,u:()=>b});var a=r(34319),n=r(36676),s=r(77162),i=r(81279),l=r(53248);const o={List:"list",Unit:"linearUnit",Number:"number",Field:"field"};function c(e){const t=!(0,s.i)(e?.isDataset),r=e?.type===s.R;return t&&r}function u(e,t){if((0,s.i)(t))return a.clone(e);const r={};if("object"==typeof e&&null!==e&&!Array.isArray(e)){for(const a in e)e.hasOwnProperty(a)&&t.indexOf(a)<0&&(r[a]=u(e[a],t));return r}return Array.isArray(e)?e.map((e=>u(e,t))):a.clone(e)}function d(e,t){if((0,s.i)(e)||(0,s.i)(t))return;const r=Object.keys(t).find((t=>t.toLowerCase()===e.toLowerCase()));return r?t[r]:void 0}function f(e,t){if(!e)return"";const r=Object.keys(e);return void 0===t&&1===r.length?r[0]:r.find((e=>e.toLowerCase()===t?.toLowerCase()))??""}async function h(e){const t=e?.function?.type?.toLowerCase()?.replace("function",""),r=e?.arguments,a=n.h.rfxNameSpecialCases,i=n.h.localFunctionOperations,l=await(0,n.g)();switch(t){case"local":const e=r?.Operation?.value,n=i.find((t=>t.key===e));if(!(0,s.i)(n))return n.label;if(l.cellStatisticsTypes.some((t=>t.key===e)))return"CellStatistics";break;case"pythonadapter":{const e=r?.ClassName?.value;return e||null}case"gpadapter":{const e=r?.ToolName?.value?.toLowerCase()?.replace("_sa",""),t=a.find((t=>t.key===e));return t?.value||e||null}default:{const e=a.find((e=>e.key===t));return e?.value||t||null}}return null}function p(e){if(e)return e.type===s.b?e:e.value&&e.value.type===s.b?e.value:void 0}function g({schema:e,rfxTemplate:t}){if((0,s.i)(t?.function?.type))return;const r=t.function.type,a=t?.arguments;let n=(0,i.e)(a);return(!n||!e.hasOwnProperty(n)&&e.hasOwnProperty(r))&&(n=r),e[n]}function m(e){if(!e||!e.value)return!1;const t=(e.value.elements?e.value.elements:e.value)[0];return t&&(t.isDataset||t.type===s.b)}function A(e){if(!e||!e[s.A])return!1;if(e.aliases)return!0;const t=e=>{if(!e)return!1;if(e.isPublic)return!0;if(m(e)){const r=e.value&&e.value.elements?e.value.elements:e.value;if(r&&Array.isArray(r))return r.some((e=>t(e)))}const r=p(e);return!!r&&A(r)},r=e[s.A];return(0,s.a)(r)?t(r):Object.keys(r).some((e=>{const a=r[e];if((0,s.a)(a))return t(a)}))}function b(e){if(!e)return!1;const t=e.dataType===n.d.rasterArray,r=Boolean(e.elementInfos),a=e.dataType===n.d.table;return t&&r||a}function R(e,t){return Array.isArray(e)&&e.some((e=>e.toLowerCase()===t.toLowerCase()))}function T(e){if(!e||!e.value)return!1;const t=e.value.elements?e.value.elements:e.value;return!!Array.isArray(t)&&t.some((function(e){return e&&e.type===s.b}))}function C(e){return e?.forEach((e=>{e.key=e.key.toString()})),e}function E(e,t){return e.forEach((e=>{if("field"===e.type){const r=d(e.argumentName,t);e.argumentName=r.name,e.layerArgument=r}else e.type!==n.a.list&&e.type!==n.a.linearUnit||(e.enumStore=C[e.enum])})),e}function y(e,t){let r;const a=d(e.nElementsArgument,t),n=a?.value,s=e.elementInfos;return void 0!==a&&void 0!==n||1!==s.length?(Array.isArray(s)&&s.some((e=>{const t=e.values;if(Array.isArray(t)&&t.indexOf(n)>-1)return r=e.inputArgs,!0})),r):s[0].inputArgs}function _(e){let t=!1;const r=e[s.A];if((0,s.a)(r))return!0;for(const e in r)if(e!==s.T&&(a=r[e])&&(p(a)||T(a)))return t=!0,t;var a;return t}function O({functionSchema:e,rfxTemplate:t}){if(!t)return;const r=[],n=t.arguments,i=n&&n.type;if(function({functionSchema:e,rfxTemplate:t}){const r=e;let a;if(r&&(a=r.rasterFunctionArguments,1===Object.keys(a).length&&!r.hasArgumentsObject))return!0;const n=t.arguments,s=n&&n.type;return!(!s||s!==l.J.RASTER_FUNCTION_TEMPLATE&&s!==l.J.RASTER_FUNCTION_VARIABLE)||void 0}({functionSchema:e,rfxTemplate:t})){const e=a.clone(n);let t;return t=i===l.J.RASTER_FUNCTION_TEMPLATE||e.isDataset?"Raster":"Rasters",r.push({...e,key:t}),r}return Object.keys(n).forEach((e=>{if(e===l.M.MATCH_VARIABLE||e===l.M.UNION_DIMENSION)return;const t=a.clone(n[e]);(0,s.a)(t)&&r.push({...t,key:e})})),r}function v(e,t){const r=t&&t.value;if(null==r)return;let a;return e.some((e=>{if(e.values&&e.values.indexOf(r)>-1)return a=e.inputArgs,!0})),a}},92266:(e,t,r)=>{r.r(t),r.d(t,{rfx_cte_attribute_table:()=>h});var a=r(19451),n=r(48302),s=(r(34319),r(77162)),i=r(64729),l=r(89920),o=r(53248),c=(r(46574),r(46717),r(55139),r(57098),r(78979),r(83345),r(41642));r(86944),r(74656);const u="rasterHelpClickHandler",d="rfx-cte-attribute-table",f={generateTable:`${d}__generate-table`,generateTableContainer:`${d}__generate-table-container`,generateTableSection:`${d}__generate-table-section`,generateTableComponent:`${d}__generate-table-component`},h=class{constructor(e){(0,a.r)(this,e),this.rfxArgumentChange=(0,a.c)(this,"rfxArgumentChange",7),this.customGridDetails={},this.defaultFields=[{name:"ObjectID",type:"esriFieldTypeOID",alias:"OID"},{name:"Value",type:"esriFieldTypeInteger",alias:"Value"},{name:"ClassName",type:"esriFieldTypeString",alias:"ClassName",length:256},{name:"Red",type:"esriFieldTypeInteger",alias:"Red"},{name:"Green",type:"esriFieldTypeInteger",alias:"Green"},{name:"Blue",type:"esriFieldTypeInteger",alias:"Blue"},{name:"Alpha",type:"esriFieldTypeInteger",alias:"Alpha"}],this.gridDefaultFields={Value:o.G.textInput,ClassName:o.G.textInput,Color:o.G.color},this.isRasterArgRFT=!1,this.minMaxDefaults={min:"1",max:"7"},this.helpActionClickEventHandlers=new Map,this.updateValue=e=>{const t=[],{detail:{gridOptions:r=this.gridOptions}}=e??{detail:{}};r.forEach(((e,a)=>{if(a===r.length-1)return;const n={attributes:{ObjectID:a,Value:e.Value?parseInt(e.Value,10):null,ClassName:e.ClassName,Red:e.Color?.[0]??0,Green:e.Color?.[1]??0,Blue:e.Color?.[2]??0,Alpha:e.Color?.[3]??255}};t.push(n)}));const a=this.widgetArgs.inputArgs.AttributeTableAsRecordSet;(0,s.i)(a.fields)&&(a.fields=this.defaultFields),a.features=t,this.rfxArgumentChange.emit({value:t})},this.updateRasterInputArg=e=>{const t=e.detail.value;this.widgetArgs.inputArgs.Raster.value=t},this.createCustomGridOptions=()=>{const{min:e,max:t,className:r,colorRamp:a}=this.customGridDetails,n=t-e+1,s=[],i=(0,c.e)(a,n).reverse();for(let a=e,n=0;a<=t;a++,n++)s.push({id:a+1,Value:a,ClassName:`${r}${a}`,Color:[i[n][1],i[n][2],i[n][3],255]});s.push(this.getDefaultValueObject()),this.gridOptions=s,this.updateValue()},this.gridOptions=void 0,this.widgetArgs=void 0}connectedCallback(){this.processWidgetArgs()}async componentWillLoad(){({strings:this.strings}=await(0,n.b)(this.hostElement,(0,a.g)("."))),this.setupInitialState()}componentDidLoad(){this.attachHelpClickEventHandlers()}processWidgetArgs(){if(!(0,s.i)(this.widgetArgs?.inputArgs)&&((0,l.b)(this.widgetArgs.inputArgs?.Raster)&&(this.isRasterArgRFT=!0),!Object.keys(this.widgetArgs.inputArgs).some((function(e){if("AttributeTableAsRecordSet"===e)return!0})))){const e={name:"AttributeTableAsRecordSet",isPublic:!1,type:"RecordSet"};this.widgetArgs.rfxArgs.AttributeTableAsRecordSet=e,this.widgetArgs.inputArgs.AttributeTableAsRecordSet=e}}setupInitialState(){this.createGridLayout(),this.createGridOptions()}attachHelpClickEventHandlers(){const e=this.widgetArgs.onHelpActionClick({heading:this.strings.raster,referenceElement:this.rasterLabelContainer,helpTextID:this.widgetArgs.helpTextIDs?.attributetable_raster});this.helpActionClickEventHandlers.set(u,e)}createGridLayout(){this.gridLayout={},Object.keys(this.gridDefaultFields).forEach((e=>{this.gridLayout[e]={label:this.strings[e.toLowerCase()],uiType:this.gridDefaultFields[e]}}))}getDefaultValueObject(){return{id:0,Value:0,ClassName:"",Color:[0,0,0,255]}}createGridOptions(){const e=[],t=this.widgetArgs?.inputArgs.AttributeTableAsRecordSet;t?.features?.length>0&&t.features.forEach(((t,r)=>{const a=t.attributes;null!=a.Alpha&&a.Alpha<=1&&(a.Alpha=Math.round(255*a.Alpha));const n={id:r+1,Value:a.Value,ClassName:a.ClassName,Color:[a.Red,a.Green,a.Blue,a.Alpha]};e.push(n)})),0===e.length&&e.push(this.getDefaultValueObject()),this.gridOptions=e}renderGenerateTable(){return(0,a.h)("calcite-block",{class:f.generateTableContainer,heading:this.strings.generate,collapsible:!0},(0,a.h)("div",{class:f.generateTable},(0,a.h)("div",{class:f.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.minValue,hideHelp:!0}),(0,a.h)("div",{class:f.generateTableComponent},(0,a.h)("calcite-input-number",{scale:i.U.Scale,value:this.minMaxDefaults.min,ref:e=>this.customGridDetails.min=Number.parseInt(e.value,10),onCalciteInputNumberChange:e=>this.customGridDetails.min=Number.parseInt(e.target.value,10)}))),(0,a.h)("div",{class:f.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.maxValue,hideHelp:!0}),(0,a.h)("div",{class:f.generateTableComponent},(0,a.h)("calcite-input-number",{scale:i.U.Scale,value:this.minMaxDefaults.max,ref:e=>this.customGridDetails.max=Number.parseInt(e.value,10),onCalciteInputNumberChange:e=>this.customGridDetails.max=Number.parseInt(e.target.value,10)}))),(0,a.h)("div",{class:f.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.classBaseName,hideHelp:!0}),(0,a.h)("div",{class:f.generateTableComponent},(0,a.h)("calcite-input-text",{scale:i.U.Scale,value:this.strings.defaultClassName,ref:e=>this.customGridDetails.className=e.value,onCalciteInputTextChange:e=>this.customGridDetails.className=e.target.value}))),(0,a.h)("div",{class:f.generateTableSection},(0,a.h)("rfx-label",{label:this.strings.colorscheme,hideHelp:!0}),(0,a.h)("div",{class:f.generateTableComponent},(0,a.h)("rfx-dte-color-ramp-selector",{ref:e=>this.customGridDetails.colorRamp=e.value,onRfxArgumentChange:e=>this.customGridDetails.colorRamp=e.target.value})))),(0,a.h)("calcite-button",{scale:i.U.Scale,onClick:this.createCustomGridOptions},this.strings.generate))}renderRasterSelect(){return(0,a.h)("calcite-label",{alignment:"start",scale:i.U.Scale,layout:"default",ref:e=>{this.rasterLabelContainer=e}},(0,a.h)("rfx-label",{label:this.strings.raster,onRfxLabelHelpActionClick:()=>this.helpActionClickEventHandlers?.get(u)()}),(0,a.h)("rfx-dte-raster-input",{inputLayers:this.widgetArgs.inputLayers,allowScalar:this.widgetArgs.allowScalar,rfxVariable:this.widgetArgs.inputArgs.Raster,onRfxArgumentChange:this.updateRasterInputArg,rfxBrowseLayerClick:this.widgetArgs.onRfxBrowseLayerClick}))}render(){return(0,a.h)("div",null,!0!==this.isRasterArgRFT?this.renderRasterSelect():null,(0,a.h)("rfx-grid",{hasHeader:!0,canAdd:!0,canRemove:!0,hasIdColumn:!0,gridLayout:this.gridLayout,gridOptions:this.gridOptions,hasBorder:!0,onRfxGridOptionChange:this.updateValue}),this.renderGenerateTable())}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,a.a)(this)}};h.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh}.rfx-cte-attribute-table__generate-table{width:100%}.rfx-cte-attribute-table__generate-table-container{padding-top:var(--rfx-full-spacing)}.rfx-cte-attribute-table__generate-table-section{padding-bottom:var(--rfx-half-spacing)}.rfx-cte-attribute-table__generate-table-component{padding-top:var(--rfx-half-spacing)}",r(48363),r(36676),r(81279),r(99248),r(16888),r(95323),r(43278)},64729:(e,t,r)=>{r.d(t,{C:()=>n,U:()=>a,a:()=>s});const a={Scale:"s",PopoverTimer:60},n={s:"s",m:"m"},s={absolute:"absolute",fixed:"fixed"}}}]);