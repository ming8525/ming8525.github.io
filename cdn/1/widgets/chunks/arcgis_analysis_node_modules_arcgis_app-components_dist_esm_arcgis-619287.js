"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-619287"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping.entry.js":
/*!***********************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-smart-mapping.entry.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_smart_mapping: () => (/* binding */ ArcgisSmartMapping)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/* harmony import */ var _locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locale-050b6db9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-050b6db9.js");
/* harmony import */ var _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./raster-unique-value-0976ec7f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-unique-value-0976ec7f.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _commonEnums_fcf13661_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./commonEnums-fcf13661.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonEnums-fcf13661.js");
/* harmony import */ var _raster_renderer_a62f152c_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./raster-renderer-a62f152c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-renderer-a62f152c.js");
/* harmony import */ var _location_e26b539f_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./location-e26b539f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/location-e26b539f.js");
/* harmony import */ var _languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./languageUtil-ef0e54b2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-ef0e54b2.js");
/* harmony import */ var _dom_4d367677_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./dom-4d367677.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-4d367677.js");
/* harmony import */ var _index_05956cab_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./index-05956cab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-05956cab.js");
/* harmony import */ var _commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./commonFunctions-b0830e9e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-b0830e9e.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */












async function loadSmartMappingModules() {
    const [AuthoringInfo, SimpleRenderer, AttributeColorInfo, Point, Polyline, Polygon, Graphic, SpatialReference, SimpleMarkerSymbol, SimpleLineSymbol, SimpleFillSymbol, Query, FeatureSet, Field, intl, OpacityVariableCreator, PieChartCreator, ColorCreator, UnivariateColorSizeCreator, DotDensityCreator, HeatmapCreator, LocationCreator, PredominanceCreator, RelationshipCreator, SizeCreator, TypeCreator, RasterFlowCreator, RasterVectorFieldCreator, RasterStretchCreator, RasterRGBCreator, RasterShadedReliefCreator, RasterClassBreaksCreator, RasterColormapCreator, RasterUniqueValueCreator, rasterColorRampUtils, RasterRendererUtils, esriColor, typeSchemes, heatmapSchemes, relationshipSchemes, predominanceSchemes, pieChartSchemes, colorSchemes, dotDensitySchemes, colorUtils, MultipartColorRamp, AlgorithmicColorRamp, flowSchemes, heatmapStatistics, summaryStatistics, histogram, predominantCategories, SizeStop, RotationVariable, SizeVariable, HeatmapColorStop, UniqueValue, UniqueValueClass, UniqueValueGroup, OpacitySlider, HeatmapSlider, ColorSlider, ClassedColorSlider, SizeSlider, ClassedSizeSlider, ColorSizeSlider, BinaryColorSizeSlider, Slider, esriLang, fieldUtils, smartMappingUtils, smartMappingRasterUtils, cimSymbolUtils, previewSymbol2D, reactiveUtils, rendererJsonUtils, rendererSupportUtils, screenUtils, symbolUtils] = await (0,_loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_3__.l)([
        "esri/renderers/support/AuthoringInfo",
        "esri/renderers/SimpleRenderer",
        "esri/renderers/support/AttributeColorInfo",
        "esri/geometry/Point",
        "esri/geometry/Polyline",
        "esri/geometry/Polygon",
        "esri/Graphic",
        "esri/geometry/SpatialReference",
        "esri/symbols/SimpleMarkerSymbol",
        "esri/symbols/SimpleLineSymbol",
        "esri/symbols/SimpleFillSymbol",
        "esri/rest/support/Query",
        "esri/rest/support/FeatureSet",
        //"esri/views/layers/FeatureLayerView",
        "esri/layers/support/Field",
        "esri/intl",
        "esri/smartMapping/renderers/opacity",
        "esri/smartMapping/renderers/pieChart",
        "esri/smartMapping/renderers/color",
        "esri/smartMapping/renderers/univariateColorSize",
        "esri/smartMapping/renderers/dotDensity",
        "esri/smartMapping/renderers/heatmap",
        "esri/smartMapping/renderers/location",
        "esri/smartMapping/renderers/predominance",
        "esri/smartMapping/renderers/relationship",
        "esri/smartMapping/renderers/size",
        "esri/smartMapping/renderers/type",
        "esri/smartMapping/raster/renderers/flow",
        "esri/smartMapping/raster/renderers/vectorField",
        "esri/smartMapping/raster/renderers/stretch",
        "esri/smartMapping/raster/renderers/rgb",
        "esri/smartMapping/raster/renderers/shadedRelief",
        "esri/smartMapping/raster/renderers/classBreaks",
        "esri/smartMapping/raster/renderers/colormap",
        "esri/smartMapping/raster/renderers/uniqueValue",
        "esri/smartMapping/raster/support/colorRamps",
        "esri/smartMapping/raster/support/utils",
        "esri/Color",
        "esri/smartMapping/symbology/type",
        "esri/smartMapping/symbology/heatmap",
        "esri/smartMapping/symbology/relationship",
        "esri/smartMapping/symbology/predominance",
        "esri/smartMapping/symbology/pieChart",
        "esri/smartMapping/symbology/color",
        "esri/smartMapping/symbology/dotDensity",
        "esri/views/support/colorUtils",
        "esri/rest/support/MultipartColorRamp",
        "esri/rest/support/AlgorithmicColorRamp",
        "esri/smartMapping/symbology/flow",
        "esri/smartMapping/statistics/heatmapStatistics",
        "esri/smartMapping/statistics/summaryStatistics",
        "esri/smartMapping/statistics/histogram",
        "esri/smartMapping/statistics/predominantCategories",
        "esri/renderers/visualVariables/support/SizeStop",
        "esri/renderers/visualVariables/RotationVariable",
        "esri/renderers/visualVariables/SizeVariable",
        "esri/renderers/support/HeatmapColorStop",
        "esri/renderers/support/UniqueValue",
        "esri/renderers/support/UniqueValueClass",
        "esri/renderers/support/UniqueValueGroup",
        "esri/widgets/smartMapping/OpacitySlider",
        "esri/widgets/smartMapping/HeatmapSlider",
        "esri/widgets/smartMapping/ColorSlider",
        "esri/widgets/smartMapping/ClassedColorSlider",
        "esri/widgets/smartMapping/SizeSlider",
        "esri/widgets/smartMapping/ClassedSizeSlider",
        "esri/widgets/smartMapping/ColorSizeSlider",
        "esri/widgets/smartMapping/BinaryColorSizeSlider",
        "esri/widgets/Slider",
        "esri/core/lang",
        "esri/layers/support/fieldUtils",
        "esri/widgets/smartMapping/support/utils",
        "esri/smartMapping/raster/support/utils",
        "esri/symbols/support/cimSymbolUtils",
        "esri/symbols/support/previewSymbol2D",
        "esri/core/reactiveUtils",
        "esri/renderers/support/jsonUtils",
        "esri/renderers/support/utils",
        "esri/core/screenUtils",
        "esri/symbols/support/symbolUtils"
    ]);
    _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.modules = {
        AuthoringInfo,
        SimpleRenderer,
        AttributeColorInfo,
        Point,
        Polyline,
        Polygon,
        Graphic,
        SpatialReference,
        SimpleMarkerSymbol,
        SimpleLineSymbol,
        SimpleFillSymbol,
        Query,
        FeatureSet,
        //FeatureLayerView,
        Field,
        intl,
        OpacityVariableCreator,
        PieChartCreator,
        ColorCreator,
        UnivariateColorSizeCreator,
        DotDensityCreator,
        HeatmapCreator,
        LocationCreator,
        PredominanceCreator,
        RelationshipCreator,
        SizeCreator,
        TypeCreator,
        RasterFlowCreator,
        RasterVectorFieldCreator,
        RasterStretchCreator,
        RasterRGBCreator,
        RasterShadedReliefCreator,
        RasterClassBreaksCreator,
        RasterColormapCreator,
        RasterUniqueValueCreator,
        rasterColorRampUtils,
        RasterRendererUtils,
        esriColor,
        typeSchemes,
        heatmapSchemes,
        relationshipSchemes,
        predominanceSchemes,
        pieChartSchemes,
        colorSchemes,
        dotDensitySchemes,
        colorUtils,
        MultipartColorRamp,
        AlgorithmicColorRamp,
        flowSchemes,
        heatmapStatistics,
        summaryStatistics,
        histogram,
        predominantCategories,
        SizeStop,
        RotationVariable,
        SizeVariable,
        HeatmapColorStop,
        UniqueValue,
        UniqueValueClass,
        UniqueValueGroup,
        OpacitySlider,
        HeatmapSlider,
        ColorSlider,
        ClassedColorSlider,
        SizeSlider,
        ClassedSizeSlider,
        ColorSizeSlider,
        BinaryColorSizeSlider,
        Slider,
        esriLang,
        fieldUtils,
        smartMappingUtils,
        smartMappingRasterUtils,
        cimSymbolUtils,
        previewSymbol2D,
        reactiveUtils,
        rendererJsonUtils,
        rendererSupportUtils,
        screenUtils,
        symbolUtils
    };
}

const ArcgisSmartMapping = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisSmartMappingClose = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingClose", 7);
        this.arcgisSmartMappingError = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingError", 7);
        this.arcgisSmartMappingClusterRequiresUpdate = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisSmartMappingClusterRequiresUpdate", 7);
        this.closedViaEvent = false;
        this.allFlowItemComponents = `arcgis-smart-mapping-panels-gallery,
      arcgis-smart-mapping-panels-simple,
      arcgis-smart-mapping-panels-heatmap,
      arcgis-smart-mapping-panels-predominance,
      arcgis-smart-mapping-panels-predominance-size,
      arcgis-smart-mapping-panels-relationship,
      arcgis-smart-mapping-panels-relationship-size,
      arcgis-smart-mapping-panels-size,
      arcgis-smart-mapping-panels-chart,
      arcgis-smart-mapping-panels-chart-size,
      arcgis-smart-mapping-panels-color,
      arcgis-smart-mapping-panels-color-size,
      arcgis-smart-mapping-panels-color-size-univariate,
      arcgis-smart-mapping-panels-compare,
      arcgis-smart-mapping-panels-dot-density,
      arcgis-smart-mapping-panels-type,
      arcgis-smart-mapping-panels-type-size,
      arcgis-smart-mapping-panels-raster-gallery,
      arcgis-smart-mapping-panels-raster-flow,
      arcgis-smart-mapping-panels-raster-vector-field,
      arcgis-smart-mapping-panels-raster-stretch,
      arcgis-smart-mapping-panels-raster-rgb,
      arcgis-smart-mapping-panels-raster-shaded-relief,
      arcgis-smart-mapping-panels-raster-class-breaks,
      arcgis-smart-mapping-panels-raster-colormap,
      arcgis-smart-mapping-panels-raster-unique-value`;
        this.portal = undefined;
        this.config = undefined;
        this.mapView = undefined;
        this.layer = undefined;
        this.skipGallery = false;
        this.stylePart = undefined;
        this.hideLayerTitle = false;
    }
    arcgisSmartMappingCloseHandler() {
        this.closedViaEvent = true;
    }
    //--------------------------------------------------------------------------
    //
    //  Public Methods
    //
    //--------------------------------------------------------------------------
    /**
     * Set focus on component
     */
    async setFocus() {
        this.flowNode.setFocus();
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentWillLoad() {
        var _a;
        const { mapView, layer } = this;
        if (!layer || !mapView) {
            // error
            return;
        }
        await loadSmartMappingModules();
        if (layer.declaredClass === "esri.layers.support.Sublayer") {
            // for predom, age, heatmap+field, and dotDensity:
            //   layer.capabilities?.query?.supportsSqlExpression
            // for bivariate and relationship:
            //   layer.version >= 10.51 && cimVersion >= 1.4
            let supportsArcade = false;
            const cimVersionStr = (_a = layer.layer.sourceJSON) === null || _a === void 0 ? void 0 : _a.cimVersion;
            if (cimVersionStr) {
                const ar = cimVersionStr.split(".");
                const cimVersion = parseFloat(ar.length === 1 ? cimVersionStr : ar[0] + "." + ar[1]);
                supportsArcade =
                    layer.layer.version >= 10.51 && cimVersion >= 1.4;
            }
            _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.mapImageSublayer = layer;
            delete _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.layer;
            await _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.modules.reactiveUtils
                .whenOnce(() => !mapView.updating)
                .then(async () => {
                await _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.mapImageSublayer
                    .createFeatureLayer()
                    .then(async (sublayerFL) => {
                    this.layer = sublayerFL;
                    await sublayerFL.load().then(async () => {
                        await this.loadStore();
                        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.supportsArcade = supportsArcade;
                        this.processLayer();
                    });
                });
            });
        }
        else {
            _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.mapImageSublayer = null;
            await this.loadStore();
            this.processLayer();
        }
    }
    disconnectedCallback() {
        if (!this.closedViaEvent) {
            this.arcgisSmartMappingClose.emit("save");
        }
    }
    async loadStore() {
        const [strings, currentLanguage, currentLanguageFull] = await (0,_locale_050b6db9_js__WEBPACK_IMPORTED_MODULE_1__.g)(this.hostElement);
        // createStore gets called just once in a app session
        // clear a previous state
        (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.c)(_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s);
        const { portal, config, mapView, layer, hideLayerTitle } = this;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.portal = portal;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.config = config;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.mapView = mapView;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.layer = layer;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.hideLayerTitle = hideLayerTitle;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.strings = strings;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.locale = currentLanguage;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.fullLocale = currentLanguageFull;
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.isRTL = (0,_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_7__.g)(this.hostElement) === "rtl";
    }
    // --------------------------------------------------------------------------
    //
    //  Render Methods
    //
    //--------------------------------------------------------------------------
    render() {
        const { skipGallery } = this;
        const { layer, isRTL } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s;
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.H, { class: "calcite-match-height" }, (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-flow", { class: {
                flow: true,
                [_languageUtil_ef0e54b2_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: isRTL
            }, ref: (node) => {
                this.flowNode = node;
            },
            // @ts-ignore
            customItemSelectors: this.allFlowItemComponents }, skipGallery ? (this.renderSkipGallery()) : layer.type === "geo-rss" ? ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-simple", { onArcgisSmartMappingPanelsSimpleClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSimpleBackClick: () => this.arcgisSmartMappingClose.emit("save") })) : (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.i)(layer) ? ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-gallery", { onArcgisSmartMappingPanelsRasterGalleryClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterGalleryError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) })) : ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-gallery", { onArcgisSmartMappingPanelsGalleryClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsGalleryError: ({ detail }) => this.arcgisSmartMappingError.emit(detail), onArcgisSmartMappingPanelsGalleryClusterRequiresUpdate: () => this.arcgisSmartMappingClusterRequiresUpdate.emit() })))));
    }
    renderSkipGallery() {
        const { originalRendererJSON, originalFeatureReduction, stylePart } = this;
        const { layer } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s;
        const rendererType = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.i)(layer)
            ? (0,_raster_renderer_a62f152c_js__WEBPACK_IMPORTED_MODULE_5__.g)()
            : (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.g)();
        switch (rendererType) {
            case "simple":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-simple", { onArcgisSmartMappingPanelsSimpleClose: ({ detail: clickType }) => {
                        if (clickType === "cancel" && originalRendererJSON) {
                            // we had an unsupported renderer that we switched to simple
                            (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.j)(originalRendererJSON, originalFeatureReduction);
                        }
                        this.arcgisSmartMappingClose.emit(clickType);
                    }, onArcgisSmartMappingPanelsSimpleError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "heatmap":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-heatmap", { onArcgisSmartMappingPanelsHeatmapClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsHeatmapError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "color":
            case "color-age":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-color", { onArcgisSmartMappingPanelsColorClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsColorError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "size":
            case "size-age":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-size", { onArcgisSmartMappingPanelsSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "color-size":
            case "color-age-size":
            case "color-size-age":
                const renderer = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.h)(layer);
                const colorVisVar = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.a)(renderer, "color");
                const sizeVisVar = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.a)(renderer, "size");
                if (colorVisVar.field === sizeVisVar.field &&
                    colorVisVar.valueExpression === sizeVisVar.valueExpression &&
                    colorVisVar.valueExpressionTitle === sizeVisVar.valueExpressionTitle) {
                    // same field
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-color-size-univariate", { onArcgisSmartMappingPanelsColorSizeUnivariateClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsColorSizeUnivariateError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else {
                    if (stylePart === "color") {
                        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-color", { onArcgisSmartMappingPanelsColorClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsColorError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                    }
                    else if (stylePart === "size") {
                        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-size", { onArcgisSmartMappingPanelsSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                    }
                    else {
                        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-color-size", { onArcgisSmartMappingPanelsColorSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsColorSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                    }
                }
            case "compare":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-compare", { onArcgisSmartMappingPanelsCompareClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsCompareError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "dot-density":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-dot-density", { onArcgisSmartMappingPanelsDotDensityClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType) }));
            case "relationship":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-relationship", { onArcgisSmartMappingPanelsRelationshipClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRelationshipError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "relationship-size":
                if (stylePart === "color") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-relationship", { onArcgisSmartMappingPanelsRelationshipClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRelationshipError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else if (stylePart === "size") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-size", { onArcgisSmartMappingPanelsSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-relationship-size", { onArcgisSmartMappingPanelsRelationshipSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRelationshipSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
            case "predominance":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-predominance", { onArcgisSmartMappingPanelsPredominanceClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsPredominanceError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "predominance-size":
                if (stylePart === "color") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-predominance", { onArcgisSmartMappingPanelsPredominanceClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsPredominanceError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else if (stylePart === "size") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-size", { onArcgisSmartMappingPanelsSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-predominance-size", { onArcgisSmartMappingPanelsPredominanceSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsPredominanceSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
            case "chart":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-chart", { onArcgisSmartMappingPanelsChartClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsChartError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "chart-size":
                if (stylePart === "color") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-chart", { onArcgisSmartMappingPanelsChartClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsChartError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else if (stylePart === "size") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-size", { onArcgisSmartMappingPanelsSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-chart-size", { onArcgisSmartMappingPanelsChartSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsChartSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
            case "type":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-type", { onArcgisSmartMappingPanelsTypeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsTypeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "type-size":
                if (stylePart === "color") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-type", { onArcgisSmartMappingPanelsTypeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsTypeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else if (stylePart === "size") {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-size", { onArcgisSmartMappingPanelsSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
                else {
                    return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-type-size", { onArcgisSmartMappingPanelsTypeSizeClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsTypeSizeError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
                }
            case "raster-flow":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-flow", { onArcgisSmartMappingPanelsRasterFlowClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterFlowError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "raster-vector-field":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-vector-field", { onArcgisSmartMappingPanelsRasterVectorFieldClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterVectorFieldError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "raster-stretch":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-stretch", { onArcgisSmartMappingPanelsRasterStretchClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterStretchError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "raster-rgb":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-rgb", { onArcgisSmartMappingPanelsRasterRgbClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterRgbError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "raster-shaded-relief":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-shaded-relief", { onArcgisSmartMappingPanelsRasterShadedReliefClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterShadedReliefError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "raster-class-breaks":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-class-breaks", { onArcgisSmartMappingPanelsRasterClassBreaksClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterClassBreaksError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            case "raster-colormap":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-colormap", { onArcgisSmartMappingPanelsRasterColormapClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType) }));
            case "raster-unique-value":
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-raster-unique-value", { onArcgisSmartMappingPanelsRasterUniqueValueClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsRasterUniqueValueError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
            default:
                return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-smart-mapping-panels-simple", { onArcgisSmartMappingPanelsSimpleClose: ({ detail: clickType }) => this.arcgisSmartMappingClose.emit(clickType), onArcgisSmartMappingPanelsSimpleError: ({ detail }) => this.arcgisSmartMappingError.emit(detail) }));
        }
    }
    // --------------------------------------------------------------------------
    //
    //  Private methods
    //
    // --------------------------------------------------------------------------
    async processLayer() {
        const { layer: smLayer, mapImageSublayer, strings, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s;
        let renderer = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.h)(smLayer);
        if (!renderer && (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.i)(smLayer)) {
            const layer = smLayer;
            await modules.smartMappingRasterUtils
                .getSupportedRendererInfo({ layer })
                .then((response) => {
                layer.renderer = response.defaultRenderer;
                renderer = response.defaultRenderer;
            });
        }
        const rendererType = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.i)(smLayer)
            ? (0,_raster_renderer_a62f152c_js__WEBPACK_IMPORTED_MODULE_5__.g)()
            : (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.g)();
        _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.oneFeatureResponseStatus = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.b.MISSING;
        (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.d)().then(() => {
            // supported renderer?
            if (rendererType === "unknown") {
                console.log("unsupported renderer", renderer);
                // save original renderer
                this.originalRendererJSON = renderer.toJSON();
                this.originalFeatureReduction =
                    "featureReduction" in smLayer && smLayer.featureReduction
                        ? modules.esriLang.clone(smLayer.featureReduction)
                        : undefined;
                // create simple renderer
                (0,_location_e26b539f_js__WEBPACK_IMPORTED_MODULE_6__.c)()
                    .then((result) => {
                    (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.e)(modules.esriLang.clone(result.renderer), smLayer);
                    if (mapImageSublayer) {
                        mapImageSublayer.renderer = result.renderer;
                    }
                    _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.selectedFields = [];
                })
                    .catch((err) => {
                    console.log(err);
                });
            }
            else {
                _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.selectedFields = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.f)(smLayer);
                _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_2__.s.selectedFields.forEach((selectedField) => {
                    if (selectedField.expression && !selectedField.expressionTitle) {
                        selectedField.expressionTitle = strings.expression;
                    }
                });
            }
        });
    }
    static get assetsDirs() { return ["assets"]; }
    get hostElement() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};



//# sourceMappingURL=arcgis-smart-mapping.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/location-e26b539f.js":
/*!**************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/location-e26b539f.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ buildOutlineVisVar),
/* harmony export */   b: () => (/* binding */ buildSizeAutoVisVar),
/* harmony export */   c: () => (/* binding */ createSimpleRenderer)
/* harmony export */ });
/* harmony import */ var _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./raster-unique-value-0976ec7f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-unique-value-0976ec7f.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./commonFunctions-b0830e9e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-b0830e9e.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




/**
 * Updates the layer with a Simple renderer with default settings
 * @param options: options
 */
function createSimpleRenderer(options) {
    var _a;
    const { layer: smLayer, mapImageSublayer, mapView, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    const layer = smLayer;
    options = options || {};
    const extras = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.m)((0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.h)(layer));
    return modules.LocationCreator.createRenderer({
        layer,
        view: mapView,
        outlineOptimizationEnabled: mapImageSublayer
            ? false
            : (0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(options.outlineOptimizationEnabled)
                ? options.outlineOptimizationEnabled
                : true,
        sizeOptimizationEnabled: mapImageSublayer
            ? false
            : (0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(options.sizeOptimizationEnabled)
                ? options.sizeOptimizationEnabled
                : true,
        forBinning: ((_a = layer.featureReduction) === null || _a === void 0 ? void 0 : _a.type) === "binning"
    }).then((result) => {
        (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.l)(extras, result.renderer);
        return Promise.resolve(result);
    }, (error) => Promise.reject(error));
}
function buildOutlineVisVar() {
    var _a;
    // TODO - can we just get the visualVariable without a full renderer?
    const { layer: smLayer, mapView, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    const layer = smLayer;
    return modules.LocationCreator.createRenderer({
        layer,
        view: mapView,
        outlineOptimizationEnabled: true,
        forBinning: ((_a = layer.featureReduction) === null || _a === void 0 ? void 0 : _a.type) === "binning"
    }).then((result) => {
        const sizeOutlineVisVar = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.a)(result.renderer, "size", "outline");
        return Promise.resolve(sizeOutlineVisVar);
    });
}
function buildSizeAutoVisVar() {
    var _a;
    const { layer: smLayer, mapView, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    const layer = smLayer;
    return modules.LocationCreator.createRenderer({
        layer,
        view: mapView,
        outlineOptimizationEnabled: false,
        sizeOptimizationEnabled: true,
        forBinning: ((_a = layer.featureReduction) === null || _a === void 0 ? void 0 : _a.type) === "binning"
    }).then((result) => {
        const sizeAutoVisVar = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.a)(result.renderer, "size", "auto");
        return Promise.resolve(sizeAutoVisVar);
    });
}



//# sourceMappingURL=location-e26b539f.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-renderer-a62f152c.js":
/*!*********************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-renderer-a62f152c.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ applyRasterRenderer),
/* harmony export */   g: () => (/* binding */ getRasterRendererType),
/* harmony export */   n: () => (/* binding */ normalizeColorRamp)
/* harmony export */ });
/* harmony import */ var _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./raster-unique-value-0976ec7f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-unique-value-0976ec7f.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _commonEnums_fcf13661_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./commonEnums-fcf13661.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonEnums-fcf13661.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




function getRasterRendererType() {
    var _a, _b;
    const { layer: smLayer } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    const layer = smLayer;
    switch ((_a = layer === null || layer === void 0 ? void 0 : layer.renderer) === null || _a === void 0 ? void 0 : _a.type) {
        case "flow":
            return "raster-flow";
        case "vector-field":
            return "raster-vector-field";
        case "class-breaks":
            return "raster-class-breaks";
        case "unique-value":
            return "raster-unique-value";
        case "raster-stretch":
            return (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.k)(layer) ? "raster-rgb" : "raster-stretch";
        case "raster-shaded-relief":
            return "raster-shaded-relief";
        default:
            return (_b = layer.renderer) === null || _b === void 0 ? void 0 : _b.type;
    }
}
// TODO: add other raster renderer types
function applyRasterRenderer(renderer, layer) {
    if ("renderer" in layer) {
        layer.renderer = renderer;
    }
}
function normalizeColorRamp(colorRamp) {
    const { modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    if (!colorRamp) {
        return [
            new modules.esriColor([0, 0, 0, 1]),
            new modules.esriColor([50, 50, 50, 1]),
            new modules.esriColor([73, 73, 73, 1]),
            new modules.esriColor([140, 140, 140, 1]),
            new modules.esriColor([255, 255, 255, 1])
        ];
    }
    if ((colorRamp === null || colorRamp === void 0 ? void 0 : colorRamp.type) !== "multipart") {
        return [colorRamp.fromColor, colorRamp.toColor];
    }
    const colorRamps = colorRamp.colorRamps;
    const colors = colorRamps.map((colorRamp) => colorRamp.fromColor);
    colors.push(colorRamps[colorRamps.length - 1].toColor);
    return colors;
}



//# sourceMappingURL=raster-renderer-a62f152c.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTYxOTI4Ny5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUM2RztBQUN2QztBQUMwTjtBQUNuTztBQUMxQjtBQUN3QztBQUNSO0FBQ2U7QUFDdkQ7QUFDRTtBQUNVOztBQUV2QztBQUNBLG0wQ0FBbTBDLDJEQUFXO0FBQzkwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLCtEQUFpQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLG1FQUFtQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksVUFBVSxFQUFFLCtEQUFpQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV5Rjs7QUFFekYiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtc21hcnQtbWFwcGluZy5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9sb2NhdGlvbi1lMjZiNTM5Zi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9yYXN0ZXItcmVuZGVyZXItYTYyZjE1MmMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCwgZCBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC1lM2JmN2RhNy5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3MgfSBmcm9tICcuL2xvY2FsZS0wNTBiNmRiOS5qcyc7XG5pbXBvcnQgeyBzIGFzIHNtYXJ0TWFwcGluZ1N0YXRlLCBjIGFzIGNsZWFyU21hcnRNYXBwaW5nU3RhdGUsIGkgYXMgaXNSYXN0ZXJMYXllciwgZyBhcyBnZXRSZW5kZXJlclR5cGUsIGEgYXMgZ2V0VmlzVmFyLCBiIGFzIHN0YXR1cywgZCBhcyBidWlsZEZpZWxkc0xpc3QsIGUgYXMgYXBwbHlSZW5kZXJlciwgZiBhcyBnZXRSZW5kZXJlckZpZWxkSW5mb3MsIGggYXMgZ2V0UmVuZGVyZXIsIGogYXMgYXBwbHlSZW5kZXJlclRvQWxsIH0gZnJvbSAnLi9yYXN0ZXItdW5pcXVlLXZhbHVlLTA5NzZlYzdmLmpzJztcbmltcG9ydCB7IGwgYXMgbG9hZE1vZHVsZXMgfSBmcm9tICcuL2xvYWRNb2R1bGVzLWI0YWMxMjQ3LmpzJztcbmltcG9ydCAnLi9jb21tb25FbnVtcy1mY2YxMzY2MS5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFJhc3RlclJlbmRlcmVyVHlwZSB9IGZyb20gJy4vcmFzdGVyLXJlbmRlcmVyLWE2MmYxNTJjLmpzJztcbmltcG9ydCB7IGMgYXMgY3JlYXRlU2ltcGxlUmVuZGVyZXIgfSBmcm9tICcuL2xvY2F0aW9uLWUyNmI1MzlmLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0RWxlbWVudERpciwgQyBhcyBDU1NfVVRJTElUWSB9IGZyb20gJy4vbGFuZ3VhZ2VVdGlsLWVmMGU1NGIyLmpzJztcbmltcG9ydCAnLi9kb20tNGQzNjc2NzcuanMnO1xuaW1wb3J0ICcuL2luZGV4LTA1OTU2Y2FiLmpzJztcbmltcG9ydCAnLi9jb21tb25GdW5jdGlvbnMtYjA4MzBlOWUuanMnO1xuXG5hc3luYyBmdW5jdGlvbiBsb2FkU21hcnRNYXBwaW5nTW9kdWxlcygpIHtcbiAgICBjb25zdCBbQXV0aG9yaW5nSW5mbywgU2ltcGxlUmVuZGVyZXIsIEF0dHJpYnV0ZUNvbG9ySW5mbywgUG9pbnQsIFBvbHlsaW5lLCBQb2x5Z29uLCBHcmFwaGljLCBTcGF0aWFsUmVmZXJlbmNlLCBTaW1wbGVNYXJrZXJTeW1ib2wsIFNpbXBsZUxpbmVTeW1ib2wsIFNpbXBsZUZpbGxTeW1ib2wsIFF1ZXJ5LCBGZWF0dXJlU2V0LCBGaWVsZCwgaW50bCwgT3BhY2l0eVZhcmlhYmxlQ3JlYXRvciwgUGllQ2hhcnRDcmVhdG9yLCBDb2xvckNyZWF0b3IsIFVuaXZhcmlhdGVDb2xvclNpemVDcmVhdG9yLCBEb3REZW5zaXR5Q3JlYXRvciwgSGVhdG1hcENyZWF0b3IsIExvY2F0aW9uQ3JlYXRvciwgUHJlZG9taW5hbmNlQ3JlYXRvciwgUmVsYXRpb25zaGlwQ3JlYXRvciwgU2l6ZUNyZWF0b3IsIFR5cGVDcmVhdG9yLCBSYXN0ZXJGbG93Q3JlYXRvciwgUmFzdGVyVmVjdG9yRmllbGRDcmVhdG9yLCBSYXN0ZXJTdHJldGNoQ3JlYXRvciwgUmFzdGVyUkdCQ3JlYXRvciwgUmFzdGVyU2hhZGVkUmVsaWVmQ3JlYXRvciwgUmFzdGVyQ2xhc3NCcmVha3NDcmVhdG9yLCBSYXN0ZXJDb2xvcm1hcENyZWF0b3IsIFJhc3RlclVuaXF1ZVZhbHVlQ3JlYXRvciwgcmFzdGVyQ29sb3JSYW1wVXRpbHMsIFJhc3RlclJlbmRlcmVyVXRpbHMsIGVzcmlDb2xvciwgdHlwZVNjaGVtZXMsIGhlYXRtYXBTY2hlbWVzLCByZWxhdGlvbnNoaXBTY2hlbWVzLCBwcmVkb21pbmFuY2VTY2hlbWVzLCBwaWVDaGFydFNjaGVtZXMsIGNvbG9yU2NoZW1lcywgZG90RGVuc2l0eVNjaGVtZXMsIGNvbG9yVXRpbHMsIE11bHRpcGFydENvbG9yUmFtcCwgQWxnb3JpdGhtaWNDb2xvclJhbXAsIGZsb3dTY2hlbWVzLCBoZWF0bWFwU3RhdGlzdGljcywgc3VtbWFyeVN0YXRpc3RpY3MsIGhpc3RvZ3JhbSwgcHJlZG9taW5hbnRDYXRlZ29yaWVzLCBTaXplU3RvcCwgUm90YXRpb25WYXJpYWJsZSwgU2l6ZVZhcmlhYmxlLCBIZWF0bWFwQ29sb3JTdG9wLCBVbmlxdWVWYWx1ZSwgVW5pcXVlVmFsdWVDbGFzcywgVW5pcXVlVmFsdWVHcm91cCwgT3BhY2l0eVNsaWRlciwgSGVhdG1hcFNsaWRlciwgQ29sb3JTbGlkZXIsIENsYXNzZWRDb2xvclNsaWRlciwgU2l6ZVNsaWRlciwgQ2xhc3NlZFNpemVTbGlkZXIsIENvbG9yU2l6ZVNsaWRlciwgQmluYXJ5Q29sb3JTaXplU2xpZGVyLCBTbGlkZXIsIGVzcmlMYW5nLCBmaWVsZFV0aWxzLCBzbWFydE1hcHBpbmdVdGlscywgc21hcnRNYXBwaW5nUmFzdGVyVXRpbHMsIGNpbVN5bWJvbFV0aWxzLCBwcmV2aWV3U3ltYm9sMkQsIHJlYWN0aXZlVXRpbHMsIHJlbmRlcmVySnNvblV0aWxzLCByZW5kZXJlclN1cHBvcnRVdGlscywgc2NyZWVuVXRpbHMsIHN5bWJvbFV0aWxzXSA9IGF3YWl0IGxvYWRNb2R1bGVzKFtcbiAgICAgICAgXCJlc3JpL3JlbmRlcmVycy9zdXBwb3J0L0F1dGhvcmluZ0luZm9cIixcbiAgICAgICAgXCJlc3JpL3JlbmRlcmVycy9TaW1wbGVSZW5kZXJlclwiLFxuICAgICAgICBcImVzcmkvcmVuZGVyZXJzL3N1cHBvcnQvQXR0cmlidXRlQ29sb3JJbmZvXCIsXG4gICAgICAgIFwiZXNyaS9nZW9tZXRyeS9Qb2ludFwiLFxuICAgICAgICBcImVzcmkvZ2VvbWV0cnkvUG9seWxpbmVcIixcbiAgICAgICAgXCJlc3JpL2dlb21ldHJ5L1BvbHlnb25cIixcbiAgICAgICAgXCJlc3JpL0dyYXBoaWNcIixcbiAgICAgICAgXCJlc3JpL2dlb21ldHJ5L1NwYXRpYWxSZWZlcmVuY2VcIixcbiAgICAgICAgXCJlc3JpL3N5bWJvbHMvU2ltcGxlTWFya2VyU3ltYm9sXCIsXG4gICAgICAgIFwiZXNyaS9zeW1ib2xzL1NpbXBsZUxpbmVTeW1ib2xcIixcbiAgICAgICAgXCJlc3JpL3N5bWJvbHMvU2ltcGxlRmlsbFN5bWJvbFwiLFxuICAgICAgICBcImVzcmkvcmVzdC9zdXBwb3J0L1F1ZXJ5XCIsXG4gICAgICAgIFwiZXNyaS9yZXN0L3N1cHBvcnQvRmVhdHVyZVNldFwiLFxuICAgICAgICAvL1wiZXNyaS92aWV3cy9sYXllcnMvRmVhdHVyZUxheWVyVmlld1wiLFxuICAgICAgICBcImVzcmkvbGF5ZXJzL3N1cHBvcnQvRmllbGRcIixcbiAgICAgICAgXCJlc3JpL2ludGxcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yZW5kZXJlcnMvb3BhY2l0eVwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3JlbmRlcmVycy9waWVDaGFydFwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3JlbmRlcmVycy9jb2xvclwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3JlbmRlcmVycy91bml2YXJpYXRlQ29sb3JTaXplXCIsXG4gICAgICAgIFwiZXNyaS9zbWFydE1hcHBpbmcvcmVuZGVyZXJzL2RvdERlbnNpdHlcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yZW5kZXJlcnMvaGVhdG1hcFwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3JlbmRlcmVycy9sb2NhdGlvblwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3JlbmRlcmVycy9wcmVkb21pbmFuY2VcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yZW5kZXJlcnMvcmVsYXRpb25zaGlwXCIsXG4gICAgICAgIFwiZXNyaS9zbWFydE1hcHBpbmcvcmVuZGVyZXJzL3NpemVcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yZW5kZXJlcnMvdHlwZVwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3Jhc3Rlci9yZW5kZXJlcnMvZmxvd1wiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3Jhc3Rlci9yZW5kZXJlcnMvdmVjdG9yRmllbGRcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yYXN0ZXIvcmVuZGVyZXJzL3N0cmV0Y2hcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yYXN0ZXIvcmVuZGVyZXJzL3JnYlwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3Jhc3Rlci9yZW5kZXJlcnMvc2hhZGVkUmVsaWVmXCIsXG4gICAgICAgIFwiZXNyaS9zbWFydE1hcHBpbmcvcmFzdGVyL3JlbmRlcmVycy9jbGFzc0JyZWFrc1wiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3Jhc3Rlci9yZW5kZXJlcnMvY29sb3JtYXBcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yYXN0ZXIvcmVuZGVyZXJzL3VuaXF1ZVZhbHVlXCIsXG4gICAgICAgIFwiZXNyaS9zbWFydE1hcHBpbmcvcmFzdGVyL3N1cHBvcnQvY29sb3JSYW1wc1wiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3Jhc3Rlci9zdXBwb3J0L3V0aWxzXCIsXG4gICAgICAgIFwiZXNyaS9Db2xvclwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3N5bWJvbG9neS90eXBlXCIsXG4gICAgICAgIFwiZXNyaS9zbWFydE1hcHBpbmcvc3ltYm9sb2d5L2hlYXRtYXBcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9zeW1ib2xvZ3kvcmVsYXRpb25zaGlwXCIsXG4gICAgICAgIFwiZXNyaS9zbWFydE1hcHBpbmcvc3ltYm9sb2d5L3ByZWRvbWluYW5jZVwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3N5bWJvbG9neS9waWVDaGFydFwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3N5bWJvbG9neS9jb2xvclwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3N5bWJvbG9neS9kb3REZW5zaXR5XCIsXG4gICAgICAgIFwiZXNyaS92aWV3cy9zdXBwb3J0L2NvbG9yVXRpbHNcIixcbiAgICAgICAgXCJlc3JpL3Jlc3Qvc3VwcG9ydC9NdWx0aXBhcnRDb2xvclJhbXBcIixcbiAgICAgICAgXCJlc3JpL3Jlc3Qvc3VwcG9ydC9BbGdvcml0aG1pY0NvbG9yUmFtcFwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3N5bWJvbG9neS9mbG93XCIsXG4gICAgICAgIFwiZXNyaS9zbWFydE1hcHBpbmcvc3RhdGlzdGljcy9oZWF0bWFwU3RhdGlzdGljc1wiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3N0YXRpc3RpY3Mvc3VtbWFyeVN0YXRpc3RpY3NcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9zdGF0aXN0aWNzL2hpc3RvZ3JhbVwiLFxuICAgICAgICBcImVzcmkvc21hcnRNYXBwaW5nL3N0YXRpc3RpY3MvcHJlZG9taW5hbnRDYXRlZ29yaWVzXCIsXG4gICAgICAgIFwiZXNyaS9yZW5kZXJlcnMvdmlzdWFsVmFyaWFibGVzL3N1cHBvcnQvU2l6ZVN0b3BcIixcbiAgICAgICAgXCJlc3JpL3JlbmRlcmVycy92aXN1YWxWYXJpYWJsZXMvUm90YXRpb25WYXJpYWJsZVwiLFxuICAgICAgICBcImVzcmkvcmVuZGVyZXJzL3Zpc3VhbFZhcmlhYmxlcy9TaXplVmFyaWFibGVcIixcbiAgICAgICAgXCJlc3JpL3JlbmRlcmVycy9zdXBwb3J0L0hlYXRtYXBDb2xvclN0b3BcIixcbiAgICAgICAgXCJlc3JpL3JlbmRlcmVycy9zdXBwb3J0L1VuaXF1ZVZhbHVlXCIsXG4gICAgICAgIFwiZXNyaS9yZW5kZXJlcnMvc3VwcG9ydC9VbmlxdWVWYWx1ZUNsYXNzXCIsXG4gICAgICAgIFwiZXNyaS9yZW5kZXJlcnMvc3VwcG9ydC9VbmlxdWVWYWx1ZUdyb3VwXCIsXG4gICAgICAgIFwiZXNyaS93aWRnZXRzL3NtYXJ0TWFwcGluZy9PcGFjaXR5U2xpZGVyXCIsXG4gICAgICAgIFwiZXNyaS93aWRnZXRzL3NtYXJ0TWFwcGluZy9IZWF0bWFwU2xpZGVyXCIsXG4gICAgICAgIFwiZXNyaS93aWRnZXRzL3NtYXJ0TWFwcGluZy9Db2xvclNsaWRlclwiLFxuICAgICAgICBcImVzcmkvd2lkZ2V0cy9zbWFydE1hcHBpbmcvQ2xhc3NlZENvbG9yU2xpZGVyXCIsXG4gICAgICAgIFwiZXNyaS93aWRnZXRzL3NtYXJ0TWFwcGluZy9TaXplU2xpZGVyXCIsXG4gICAgICAgIFwiZXNyaS93aWRnZXRzL3NtYXJ0TWFwcGluZy9DbGFzc2VkU2l6ZVNsaWRlclwiLFxuICAgICAgICBcImVzcmkvd2lkZ2V0cy9zbWFydE1hcHBpbmcvQ29sb3JTaXplU2xpZGVyXCIsXG4gICAgICAgIFwiZXNyaS93aWRnZXRzL3NtYXJ0TWFwcGluZy9CaW5hcnlDb2xvclNpemVTbGlkZXJcIixcbiAgICAgICAgXCJlc3JpL3dpZGdldHMvU2xpZGVyXCIsXG4gICAgICAgIFwiZXNyaS9jb3JlL2xhbmdcIixcbiAgICAgICAgXCJlc3JpL2xheWVycy9zdXBwb3J0L2ZpZWxkVXRpbHNcIixcbiAgICAgICAgXCJlc3JpL3dpZGdldHMvc21hcnRNYXBwaW5nL3N1cHBvcnQvdXRpbHNcIixcbiAgICAgICAgXCJlc3JpL3NtYXJ0TWFwcGluZy9yYXN0ZXIvc3VwcG9ydC91dGlsc1wiLFxuICAgICAgICBcImVzcmkvc3ltYm9scy9zdXBwb3J0L2NpbVN5bWJvbFV0aWxzXCIsXG4gICAgICAgIFwiZXNyaS9zeW1ib2xzL3N1cHBvcnQvcHJldmlld1N5bWJvbDJEXCIsXG4gICAgICAgIFwiZXNyaS9jb3JlL3JlYWN0aXZlVXRpbHNcIixcbiAgICAgICAgXCJlc3JpL3JlbmRlcmVycy9zdXBwb3J0L2pzb25VdGlsc1wiLFxuICAgICAgICBcImVzcmkvcmVuZGVyZXJzL3N1cHBvcnQvdXRpbHNcIixcbiAgICAgICAgXCJlc3JpL2NvcmUvc2NyZWVuVXRpbHNcIixcbiAgICAgICAgXCJlc3JpL3N5bWJvbHMvc3VwcG9ydC9zeW1ib2xVdGlsc1wiXG4gICAgXSk7XG4gICAgc21hcnRNYXBwaW5nU3RhdGUubW9kdWxlcyA9IHtcbiAgICAgICAgQXV0aG9yaW5nSW5mbyxcbiAgICAgICAgU2ltcGxlUmVuZGVyZXIsXG4gICAgICAgIEF0dHJpYnV0ZUNvbG9ySW5mbyxcbiAgICAgICAgUG9pbnQsXG4gICAgICAgIFBvbHlsaW5lLFxuICAgICAgICBQb2x5Z29uLFxuICAgICAgICBHcmFwaGljLFxuICAgICAgICBTcGF0aWFsUmVmZXJlbmNlLFxuICAgICAgICBTaW1wbGVNYXJrZXJTeW1ib2wsXG4gICAgICAgIFNpbXBsZUxpbmVTeW1ib2wsXG4gICAgICAgIFNpbXBsZUZpbGxTeW1ib2wsXG4gICAgICAgIFF1ZXJ5LFxuICAgICAgICBGZWF0dXJlU2V0LFxuICAgICAgICAvL0ZlYXR1cmVMYXllclZpZXcsXG4gICAgICAgIEZpZWxkLFxuICAgICAgICBpbnRsLFxuICAgICAgICBPcGFjaXR5VmFyaWFibGVDcmVhdG9yLFxuICAgICAgICBQaWVDaGFydENyZWF0b3IsXG4gICAgICAgIENvbG9yQ3JlYXRvcixcbiAgICAgICAgVW5pdmFyaWF0ZUNvbG9yU2l6ZUNyZWF0b3IsXG4gICAgICAgIERvdERlbnNpdHlDcmVhdG9yLFxuICAgICAgICBIZWF0bWFwQ3JlYXRvcixcbiAgICAgICAgTG9jYXRpb25DcmVhdG9yLFxuICAgICAgICBQcmVkb21pbmFuY2VDcmVhdG9yLFxuICAgICAgICBSZWxhdGlvbnNoaXBDcmVhdG9yLFxuICAgICAgICBTaXplQ3JlYXRvcixcbiAgICAgICAgVHlwZUNyZWF0b3IsXG4gICAgICAgIFJhc3RlckZsb3dDcmVhdG9yLFxuICAgICAgICBSYXN0ZXJWZWN0b3JGaWVsZENyZWF0b3IsXG4gICAgICAgIFJhc3RlclN0cmV0Y2hDcmVhdG9yLFxuICAgICAgICBSYXN0ZXJSR0JDcmVhdG9yLFxuICAgICAgICBSYXN0ZXJTaGFkZWRSZWxpZWZDcmVhdG9yLFxuICAgICAgICBSYXN0ZXJDbGFzc0JyZWFrc0NyZWF0b3IsXG4gICAgICAgIFJhc3RlckNvbG9ybWFwQ3JlYXRvcixcbiAgICAgICAgUmFzdGVyVW5pcXVlVmFsdWVDcmVhdG9yLFxuICAgICAgICByYXN0ZXJDb2xvclJhbXBVdGlscyxcbiAgICAgICAgUmFzdGVyUmVuZGVyZXJVdGlscyxcbiAgICAgICAgZXNyaUNvbG9yLFxuICAgICAgICB0eXBlU2NoZW1lcyxcbiAgICAgICAgaGVhdG1hcFNjaGVtZXMsXG4gICAgICAgIHJlbGF0aW9uc2hpcFNjaGVtZXMsXG4gICAgICAgIHByZWRvbWluYW5jZVNjaGVtZXMsXG4gICAgICAgIHBpZUNoYXJ0U2NoZW1lcyxcbiAgICAgICAgY29sb3JTY2hlbWVzLFxuICAgICAgICBkb3REZW5zaXR5U2NoZW1lcyxcbiAgICAgICAgY29sb3JVdGlscyxcbiAgICAgICAgTXVsdGlwYXJ0Q29sb3JSYW1wLFxuICAgICAgICBBbGdvcml0aG1pY0NvbG9yUmFtcCxcbiAgICAgICAgZmxvd1NjaGVtZXMsXG4gICAgICAgIGhlYXRtYXBTdGF0aXN0aWNzLFxuICAgICAgICBzdW1tYXJ5U3RhdGlzdGljcyxcbiAgICAgICAgaGlzdG9ncmFtLFxuICAgICAgICBwcmVkb21pbmFudENhdGVnb3JpZXMsXG4gICAgICAgIFNpemVTdG9wLFxuICAgICAgICBSb3RhdGlvblZhcmlhYmxlLFxuICAgICAgICBTaXplVmFyaWFibGUsXG4gICAgICAgIEhlYXRtYXBDb2xvclN0b3AsXG4gICAgICAgIFVuaXF1ZVZhbHVlLFxuICAgICAgICBVbmlxdWVWYWx1ZUNsYXNzLFxuICAgICAgICBVbmlxdWVWYWx1ZUdyb3VwLFxuICAgICAgICBPcGFjaXR5U2xpZGVyLFxuICAgICAgICBIZWF0bWFwU2xpZGVyLFxuICAgICAgICBDb2xvclNsaWRlcixcbiAgICAgICAgQ2xhc3NlZENvbG9yU2xpZGVyLFxuICAgICAgICBTaXplU2xpZGVyLFxuICAgICAgICBDbGFzc2VkU2l6ZVNsaWRlcixcbiAgICAgICAgQ29sb3JTaXplU2xpZGVyLFxuICAgICAgICBCaW5hcnlDb2xvclNpemVTbGlkZXIsXG4gICAgICAgIFNsaWRlcixcbiAgICAgICAgZXNyaUxhbmcsXG4gICAgICAgIGZpZWxkVXRpbHMsXG4gICAgICAgIHNtYXJ0TWFwcGluZ1V0aWxzLFxuICAgICAgICBzbWFydE1hcHBpbmdSYXN0ZXJVdGlscyxcbiAgICAgICAgY2ltU3ltYm9sVXRpbHMsXG4gICAgICAgIHByZXZpZXdTeW1ib2wyRCxcbiAgICAgICAgcmVhY3RpdmVVdGlscyxcbiAgICAgICAgcmVuZGVyZXJKc29uVXRpbHMsXG4gICAgICAgIHJlbmRlcmVyU3VwcG9ydFV0aWxzLFxuICAgICAgICBzY3JlZW5VdGlscyxcbiAgICAgICAgc3ltYm9sVXRpbHNcbiAgICB9O1xufVxuXG5jb25zdCBBcmNnaXNTbWFydE1hcHBpbmcgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNTbWFydE1hcHBpbmdDbG9zZVwiLCA3KTtcbiAgICAgICAgdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvciA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3JcIiwgNyk7XG4gICAgICAgIHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2x1c3RlclJlcXVpcmVzVXBkYXRlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNTbWFydE1hcHBpbmdDbHVzdGVyUmVxdWlyZXNVcGRhdGVcIiwgNyk7XG4gICAgICAgIHRoaXMuY2xvc2VkVmlhRXZlbnQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5hbGxGbG93SXRlbUNvbXBvbmVudHMgPSBgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWdhbGxlcnksXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtc2ltcGxlLFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWhlYXRtYXAsXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcHJlZG9taW5hbmNlLFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXByZWRvbWluYW5jZS1zaXplLFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJlbGF0aW9uc2hpcCxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yZWxhdGlvbnNoaXAtc2l6ZSxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1zaXplLFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWNoYXJ0LFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWNoYXJ0LXNpemUsXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtY29sb3IsXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtY29sb3Itc2l6ZSxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1jb2xvci1zaXplLXVuaXZhcmlhdGUsXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtY29tcGFyZSxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1kb3QtZGVuc2l0eSxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy10eXBlLFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXR5cGUtc2l6ZSxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yYXN0ZXItZ2FsbGVyeSxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yYXN0ZXItZmxvdyxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yYXN0ZXItdmVjdG9yLWZpZWxkLFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJhc3Rlci1zdHJldGNoLFxuICAgICAgYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJhc3Rlci1yZ2IsXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcmFzdGVyLXNoYWRlZC1yZWxpZWYsXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcmFzdGVyLWNsYXNzLWJyZWFrcyxcbiAgICAgIGFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yYXN0ZXItY29sb3JtYXAsXG4gICAgICBhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcmFzdGVyLXVuaXF1ZS12YWx1ZWA7XG4gICAgICAgIHRoaXMucG9ydGFsID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNvbmZpZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5tYXBWaWV3ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxheWVyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNraXBHYWxsZXJ5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3R5bGVQYXJ0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmhpZGVMYXllclRpdGxlID0gZmFsc2U7XG4gICAgfVxuICAgIGFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlSGFuZGxlcigpIHtcbiAgICAgICAgdGhpcy5jbG9zZWRWaWFFdmVudCA9IHRydWU7XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQdWJsaWMgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8qKlxuICAgICAqIFNldCBmb2N1cyBvbiBjb21wb25lbnRcbiAgICAgKi9cbiAgICBhc3luYyBzZXRGb2N1cygpIHtcbiAgICAgICAgdGhpcy5mbG93Tm9kZS5zZXRGb2N1cygpO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgTGlmZWN5Y2xlXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3QgeyBtYXBWaWV3LCBsYXllciB9ID0gdGhpcztcbiAgICAgICAgaWYgKCFsYXllciB8fCAhbWFwVmlldykge1xuICAgICAgICAgICAgLy8gZXJyb3JcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBsb2FkU21hcnRNYXBwaW5nTW9kdWxlcygpO1xuICAgICAgICBpZiAobGF5ZXIuZGVjbGFyZWRDbGFzcyA9PT0gXCJlc3JpLmxheWVycy5zdXBwb3J0LlN1YmxheWVyXCIpIHtcbiAgICAgICAgICAgIC8vIGZvciBwcmVkb20sIGFnZSwgaGVhdG1hcCtmaWVsZCwgYW5kIGRvdERlbnNpdHk6XG4gICAgICAgICAgICAvLyAgIGxheWVyLmNhcGFiaWxpdGllcz8ucXVlcnk/LnN1cHBvcnRzU3FsRXhwcmVzc2lvblxuICAgICAgICAgICAgLy8gZm9yIGJpdmFyaWF0ZSBhbmQgcmVsYXRpb25zaGlwOlxuICAgICAgICAgICAgLy8gICBsYXllci52ZXJzaW9uID49IDEwLjUxICYmIGNpbVZlcnNpb24gPj0gMS40XG4gICAgICAgICAgICBsZXQgc3VwcG9ydHNBcmNhZGUgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGNpbVZlcnNpb25TdHIgPSAoX2EgPSBsYXllci5sYXllci5zb3VyY2VKU09OKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2ltVmVyc2lvbjtcbiAgICAgICAgICAgIGlmIChjaW1WZXJzaW9uU3RyKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXIgPSBjaW1WZXJzaW9uU3RyLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjaW1WZXJzaW9uID0gcGFyc2VGbG9hdChhci5sZW5ndGggPT09IDEgPyBjaW1WZXJzaW9uU3RyIDogYXJbMF0gKyBcIi5cIiArIGFyWzFdKTtcbiAgICAgICAgICAgICAgICBzdXBwb3J0c0FyY2FkZSA9XG4gICAgICAgICAgICAgICAgICAgIGxheWVyLmxheWVyLnZlcnNpb24gPj0gMTAuNTEgJiYgY2ltVmVyc2lvbiA+PSAxLjQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5tYXBJbWFnZVN1YmxheWVyID0gbGF5ZXI7XG4gICAgICAgICAgICBkZWxldGUgc21hcnRNYXBwaW5nU3RhdGUubGF5ZXI7XG4gICAgICAgICAgICBhd2FpdCBzbWFydE1hcHBpbmdTdGF0ZS5tb2R1bGVzLnJlYWN0aXZlVXRpbHNcbiAgICAgICAgICAgICAgICAud2hlbk9uY2UoKCkgPT4gIW1hcFZpZXcudXBkYXRpbmcpXG4gICAgICAgICAgICAgICAgLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHNtYXJ0TWFwcGluZ1N0YXRlLm1hcEltYWdlU3VibGF5ZXJcbiAgICAgICAgICAgICAgICAgICAgLmNyZWF0ZUZlYXR1cmVMYXllcigpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGFzeW5jIChzdWJsYXllckZMKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGF5ZXIgPSBzdWJsYXllckZMO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBzdWJsYXllckZMLmxvYWQoKS50aGVuKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFN0b3JlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5zdXBwb3J0c0FyY2FkZSA9IHN1cHBvcnRzQXJjYWRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzTGF5ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNtYXJ0TWFwcGluZ1N0YXRlLm1hcEltYWdlU3VibGF5ZXIgPSBudWxsO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkU3RvcmUoKTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0xheWVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgIGlmICghdGhpcy5jbG9zZWRWaWFFdmVudCkge1xuICAgICAgICAgICAgdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KFwic2F2ZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBsb2FkU3RvcmUoKSB7XG4gICAgICAgIGNvbnN0IFtzdHJpbmdzLCBjdXJyZW50TGFuZ3VhZ2UsIGN1cnJlbnRMYW5ndWFnZUZ1bGxdID0gYXdhaXQgZ2V0TG9jYWxlQ29tcG9uZW50U3RyaW5ncyh0aGlzLmhvc3RFbGVtZW50KTtcbiAgICAgICAgLy8gY3JlYXRlU3RvcmUgZ2V0cyBjYWxsZWQganVzdCBvbmNlIGluIGEgYXBwIHNlc3Npb25cbiAgICAgICAgLy8gY2xlYXIgYSBwcmV2aW91cyBzdGF0ZVxuICAgICAgICBjbGVhclNtYXJ0TWFwcGluZ1N0YXRlKHNtYXJ0TWFwcGluZ1N0YXRlKTtcbiAgICAgICAgY29uc3QgeyBwb3J0YWwsIGNvbmZpZywgbWFwVmlldywgbGF5ZXIsIGhpZGVMYXllclRpdGxlIH0gPSB0aGlzO1xuICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5wb3J0YWwgPSBwb3J0YWw7XG4gICAgICAgIHNtYXJ0TWFwcGluZ1N0YXRlLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgc21hcnRNYXBwaW5nU3RhdGUubWFwVmlldyA9IG1hcFZpZXc7XG4gICAgICAgIHNtYXJ0TWFwcGluZ1N0YXRlLmxheWVyID0gbGF5ZXI7XG4gICAgICAgIHNtYXJ0TWFwcGluZ1N0YXRlLmhpZGVMYXllclRpdGxlID0gaGlkZUxheWVyVGl0bGU7XG4gICAgICAgIHNtYXJ0TWFwcGluZ1N0YXRlLnN0cmluZ3MgPSBzdHJpbmdzO1xuICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5sb2NhbGUgPSBjdXJyZW50TGFuZ3VhZ2U7XG4gICAgICAgIHNtYXJ0TWFwcGluZ1N0YXRlLmZ1bGxMb2NhbGUgPSBjdXJyZW50TGFuZ3VhZ2VGdWxsO1xuICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5pc1JUTCA9IGdldEVsZW1lbnREaXIodGhpcy5ob3N0RWxlbWVudCkgPT09IFwicnRsXCI7XG4gICAgfVxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUmVuZGVyIE1ldGhvZHNcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgc2tpcEdhbGxlcnkgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHsgbGF5ZXIsIGlzUlRMIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIHsgY2xhc3M6IFwiY2FsY2l0ZS1tYXRjaC1oZWlnaHRcIiB9LCBoKFwiY2FsY2l0ZS1mbG93XCIsIHsgY2xhc3M6IHtcbiAgICAgICAgICAgICAgICBmbG93OiB0cnVlLFxuICAgICAgICAgICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBpc1JUTFxuICAgICAgICAgICAgfSwgcmVmOiAobm9kZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZmxvd05vZGUgPSBub2RlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGN1c3RvbUl0ZW1TZWxlY3RvcnM6IHRoaXMuYWxsRmxvd0l0ZW1Db21wb25lbnRzIH0sIHNraXBHYWxsZXJ5ID8gKHRoaXMucmVuZGVyU2tpcEdhbGxlcnkoKSkgOiBsYXllci50eXBlID09PSBcImdlby1yc3NcIiA/IChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXNpbXBsZVwiLCB7IG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzU2ltcGxlQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpbXBsZUJhY2tDbGljazogKCkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KFwic2F2ZVwiKSB9KSkgOiBpc1Jhc3RlckxheWVyKGxheWVyKSA/IChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJhc3Rlci1nYWxsZXJ5XCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNSYXN0ZXJHYWxsZXJ5Q2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlckdhbGxlcnlFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKSA6IChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWdhbGxlcnlcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0dhbGxlcnlDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzR2FsbGVyeUVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzR2FsbGVyeUNsdXN0ZXJSZXF1aXJlc1VwZGF0ZTogKCkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbHVzdGVyUmVxdWlyZXNVcGRhdGUuZW1pdCgpIH0pKSkpKTtcbiAgICB9XG4gICAgcmVuZGVyU2tpcEdhbGxlcnkoKSB7XG4gICAgICAgIGNvbnN0IHsgb3JpZ2luYWxSZW5kZXJlckpTT04sIG9yaWdpbmFsRmVhdHVyZVJlZHVjdGlvbiwgc3R5bGVQYXJ0IH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB7IGxheWVyIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICAgICAgY29uc3QgcmVuZGVyZXJUeXBlID0gaXNSYXN0ZXJMYXllcihsYXllcilcbiAgICAgICAgICAgID8gZ2V0UmFzdGVyUmVuZGVyZXJUeXBlKClcbiAgICAgICAgICAgIDogZ2V0UmVuZGVyZXJUeXBlKCk7XG4gICAgICAgIHN3aXRjaCAocmVuZGVyZXJUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIFwic2ltcGxlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXNpbXBsZVwiLCB7IG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzU2ltcGxlQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGlja1R5cGUgPT09IFwiY2FuY2VsXCIgJiYgb3JpZ2luYWxSZW5kZXJlckpTT04pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBoYWQgYW4gdW5zdXBwb3J0ZWQgcmVuZGVyZXIgdGhhdCB3ZSBzd2l0Y2hlZCB0byBzaW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBseVJlbmRlcmVyVG9BbGwob3JpZ2luYWxSZW5kZXJlckpTT04sIG9yaWdpbmFsRmVhdHVyZVJlZHVjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNTaW1wbGVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgIGNhc2UgXCJoZWF0bWFwXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWhlYXRtYXBcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0hlYXRtYXBDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzSGVhdG1hcEVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgY2FzZSBcImNvbG9yXCI6XG4gICAgICAgICAgICBjYXNlIFwiY29sb3ItYWdlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWNvbG9yXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNDb2xvckNsb3NlOiAoeyBkZXRhaWw6IGNsaWNrVHlwZSB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNDb2xvckVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgY2FzZSBcInNpemVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJzaXplLWFnZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1zaXplXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNTaXplQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpemVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgIGNhc2UgXCJjb2xvci1zaXplXCI6XG4gICAgICAgICAgICBjYXNlIFwiY29sb3ItYWdlLXNpemVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJjb2xvci1zaXplLWFnZVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVyID0gZ2V0UmVuZGVyZXIobGF5ZXIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbG9yVmlzVmFyID0gZ2V0VmlzVmFyKHJlbmRlcmVyLCBcImNvbG9yXCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpemVWaXNWYXIgPSBnZXRWaXNWYXIocmVuZGVyZXIsIFwic2l6ZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoY29sb3JWaXNWYXIuZmllbGQgPT09IHNpemVWaXNWYXIuZmllbGQgJiZcbiAgICAgICAgICAgICAgICAgICAgY29sb3JWaXNWYXIudmFsdWVFeHByZXNzaW9uID09PSBzaXplVmlzVmFyLnZhbHVlRXhwcmVzc2lvbiAmJlxuICAgICAgICAgICAgICAgICAgICBjb2xvclZpc1Zhci52YWx1ZUV4cHJlc3Npb25UaXRsZSA9PT0gc2l6ZVZpc1Zhci52YWx1ZUV4cHJlc3Npb25UaXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBzYW1lIGZpZWxkXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1jb2xvci1zaXplLXVuaXZhcmlhdGVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NvbG9yU2l6ZVVuaXZhcmlhdGVDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzQ29sb3JTaXplVW5pdmFyaWF0ZUVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0eWxlUGFydCA9PT0gXCJjb2xvclwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtY29sb3JcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NvbG9yQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NvbG9yRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc3R5bGVQYXJ0ID09PSBcInNpemVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXNpemVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpemVDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzU2l6ZUVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWNvbG9yLXNpemVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NvbG9yU2l6ZUNsb3NlOiAoeyBkZXRhaWw6IGNsaWNrVHlwZSB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNDb2xvclNpemVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgXCJjb21wYXJlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWNvbXBhcmVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NvbXBhcmVDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzQ29tcGFyZUVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgY2FzZSBcImRvdC1kZW5zaXR5XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWRvdC1kZW5zaXR5XCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNEb3REZW5zaXR5Q2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpIH0pKTtcbiAgICAgICAgICAgIGNhc2UgXCJyZWxhdGlvbnNoaXBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcmVsYXRpb25zaGlwXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNSZWxhdGlvbnNoaXBDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzUmVsYXRpb25zaGlwRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICBjYXNlIFwicmVsYXRpb25zaGlwLXNpemVcIjpcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGVQYXJ0ID09PSBcImNvbG9yXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJlbGF0aW9uc2hpcFwiLCB7IG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzUmVsYXRpb25zaGlwQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1JlbGF0aW9uc2hpcEVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHlsZVBhcnQgPT09IFwic2l6ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1zaXplXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNTaXplQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpemVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yZWxhdGlvbnNoaXAtc2l6ZVwiLCB7IG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzUmVsYXRpb25zaGlwU2l6ZUNsb3NlOiAoeyBkZXRhaWw6IGNsaWNrVHlwZSB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNSZWxhdGlvbnNoaXBTaXplRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcInByZWRvbWluYW5jZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1wcmVkb21pbmFuY2VcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1ByZWRvbWluYW5jZUNsb3NlOiAoeyBkZXRhaWw6IGNsaWNrVHlwZSB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNQcmVkb21pbmFuY2VFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgIGNhc2UgXCJwcmVkb21pbmFuY2Utc2l6ZVwiOlxuICAgICAgICAgICAgICAgIGlmIChzdHlsZVBhcnQgPT09IFwiY29sb3JcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcHJlZG9taW5hbmNlXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNQcmVkb21pbmFuY2VDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzUHJlZG9taW5hbmNlRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0eWxlUGFydCA9PT0gXCJzaXplXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXNpemVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpemVDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzU2l6ZUVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXByZWRvbWluYW5jZS1zaXplXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNQcmVkb21pbmFuY2VTaXplQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1ByZWRvbWluYW5jZVNpemVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwiY2hhcnRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtY2hhcnRcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NoYXJ0Q2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NoYXJ0RXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICBjYXNlIFwiY2hhcnQtc2l6ZVwiOlxuICAgICAgICAgICAgICAgIGlmIChzdHlsZVBhcnQgPT09IFwiY29sb3JcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtY2hhcnRcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NoYXJ0Q2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NoYXJ0RXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0eWxlUGFydCA9PT0gXCJzaXplXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXNpemVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpemVDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzU2l6ZUVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLWNoYXJ0LXNpemVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc0NoYXJ0U2l6ZUNsb3NlOiAoeyBkZXRhaWw6IGNsaWNrVHlwZSB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNDaGFydFNpemVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFwidHlwZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy10eXBlXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNUeXBlQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1R5cGVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgIGNhc2UgXCJ0eXBlLXNpemVcIjpcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGVQYXJ0ID09PSBcImNvbG9yXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXR5cGVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1R5cGVDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzVHlwZUVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdHlsZVBhcnQgPT09IFwic2l6ZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1zaXplXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNTaXplQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpemVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy10eXBlLXNpemVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1R5cGVTaXplQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1R5cGVTaXplRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBcInJhc3Rlci1mbG93XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJhc3Rlci1mbG93XCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNSYXN0ZXJGbG93Q2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlckZsb3dFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXN0ZXItdmVjdG9yLWZpZWxkXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJhc3Rlci12ZWN0b3ItZmllbGRcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlclZlY3RvckZpZWxkQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlclZlY3RvckZpZWxkRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICBjYXNlIFwicmFzdGVyLXN0cmV0Y2hcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcmFzdGVyLXN0cmV0Y2hcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlclN0cmV0Y2hDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzUmFzdGVyU3RyZXRjaEVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgY2FzZSBcInJhc3Rlci1yZ2JcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gKGgoXCJhcmNnaXMtc21hcnQtbWFwcGluZy1wYW5lbHMtcmFzdGVyLXJnYlwiLCB7IG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzUmFzdGVyUmdiQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlclJnYkVycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgY2FzZSBcInJhc3Rlci1zaGFkZWQtcmVsaWVmXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJhc3Rlci1zaGFkZWQtcmVsaWVmXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNSYXN0ZXJTaGFkZWRSZWxpZWZDbG9zZTogKHsgZGV0YWlsOiBjbGlja1R5cGUgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdDbG9zZS5lbWl0KGNsaWNrVHlwZSksIG9uQXJjZ2lzU21hcnRNYXBwaW5nUGFuZWxzUmFzdGVyU2hhZGVkUmVsaWVmRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICBjYXNlIFwicmFzdGVyLWNsYXNzLWJyZWFrc1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yYXN0ZXItY2xhc3MtYnJlYWtzXCIsIHsgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNSYXN0ZXJDbGFzc0JyZWFrc0Nsb3NlOiAoeyBkZXRhaWw6IGNsaWNrVHlwZSB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNSYXN0ZXJDbGFzc0JyZWFrc0Vycm9yOiAoeyBkZXRhaWwgfSkgPT4gdGhpcy5hcmNnaXNTbWFydE1hcHBpbmdFcnJvci5lbWl0KGRldGFpbCkgfSkpO1xuICAgICAgICAgICAgY2FzZSBcInJhc3Rlci1jb2xvcm1hcFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1yYXN0ZXItY29sb3JtYXBcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlckNvbG9ybWFwQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpIH0pKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXN0ZXItdW5pcXVlLXZhbHVlXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChoKFwiYXJjZ2lzLXNtYXJ0LW1hcHBpbmctcGFuZWxzLXJhc3Rlci11bmlxdWUtdmFsdWVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlclVuaXF1ZVZhbHVlQ2xvc2U6ICh7IGRldGFpbDogY2xpY2tUeXBlIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nQ2xvc2UuZW1pdChjbGlja1R5cGUpLCBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1Jhc3RlclVuaXF1ZVZhbHVlRXJyb3I6ICh7IGRldGFpbCB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Vycm9yLmVtaXQoZGV0YWlsKSB9KSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAoaChcImFyY2dpcy1zbWFydC1tYXBwaW5nLXBhbmVscy1zaW1wbGVcIiwgeyBvbkFyY2dpc1NtYXJ0TWFwcGluZ1BhbmVsc1NpbXBsZUNsb3NlOiAoeyBkZXRhaWw6IGNsaWNrVHlwZSB9KSA9PiB0aGlzLmFyY2dpc1NtYXJ0TWFwcGluZ0Nsb3NlLmVtaXQoY2xpY2tUeXBlKSwgb25BcmNnaXNTbWFydE1hcHBpbmdQYW5lbHNTaW1wbGVFcnJvcjogKHsgZGV0YWlsIH0pID0+IHRoaXMuYXJjZ2lzU21hcnRNYXBwaW5nRXJyb3IuZW1pdChkZXRhaWwpIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFByaXZhdGUgbWV0aG9kc1xuICAgIC8vXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBhc3luYyBwcm9jZXNzTGF5ZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgbGF5ZXI6IHNtTGF5ZXIsIG1hcEltYWdlU3VibGF5ZXIsIHN0cmluZ3MsIG1vZHVsZXMgfSA9IHNtYXJ0TWFwcGluZ1N0YXRlO1xuICAgICAgICBsZXQgcmVuZGVyZXIgPSBnZXRSZW5kZXJlcihzbUxheWVyKTtcbiAgICAgICAgaWYgKCFyZW5kZXJlciAmJiBpc1Jhc3RlckxheWVyKHNtTGF5ZXIpKSB7XG4gICAgICAgICAgICBjb25zdCBsYXllciA9IHNtTGF5ZXI7XG4gICAgICAgICAgICBhd2FpdCBtb2R1bGVzLnNtYXJ0TWFwcGluZ1Jhc3RlclV0aWxzXG4gICAgICAgICAgICAgICAgLmdldFN1cHBvcnRlZFJlbmRlcmVySW5mbyh7IGxheWVyIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgbGF5ZXIucmVuZGVyZXIgPSByZXNwb25zZS5kZWZhdWx0UmVuZGVyZXI7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXIgPSByZXNwb25zZS5kZWZhdWx0UmVuZGVyZXI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZW5kZXJlclR5cGUgPSBpc1Jhc3RlckxheWVyKHNtTGF5ZXIpXG4gICAgICAgICAgICA/IGdldFJhc3RlclJlbmRlcmVyVHlwZSgpXG4gICAgICAgICAgICA6IGdldFJlbmRlcmVyVHlwZSgpO1xuICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5vbmVGZWF0dXJlUmVzcG9uc2VTdGF0dXMgPSBzdGF0dXMuTUlTU0lORztcbiAgICAgICAgYnVpbGRGaWVsZHNMaXN0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAvLyBzdXBwb3J0ZWQgcmVuZGVyZXI/XG4gICAgICAgICAgICBpZiAocmVuZGVyZXJUeXBlID09PSBcInVua25vd25cIikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidW5zdXBwb3J0ZWQgcmVuZGVyZXJcIiwgcmVuZGVyZXIpO1xuICAgICAgICAgICAgICAgIC8vIHNhdmUgb3JpZ2luYWwgcmVuZGVyZXJcbiAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsUmVuZGVyZXJKU09OID0gcmVuZGVyZXIudG9KU09OKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbEZlYXR1cmVSZWR1Y3Rpb24gPVxuICAgICAgICAgICAgICAgICAgICBcImZlYXR1cmVSZWR1Y3Rpb25cIiBpbiBzbUxheWVyICYmIHNtTGF5ZXIuZmVhdHVyZVJlZHVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgPyBtb2R1bGVzLmVzcmlMYW5nLmNsb25lKHNtTGF5ZXIuZmVhdHVyZVJlZHVjdGlvbilcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBzaW1wbGUgcmVuZGVyZXJcbiAgICAgICAgICAgICAgICBjcmVhdGVTaW1wbGVSZW5kZXJlcigpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlSZW5kZXJlcihtb2R1bGVzLmVzcmlMYW5nLmNsb25lKHJlc3VsdC5yZW5kZXJlciksIHNtTGF5ZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFwSW1hZ2VTdWJsYXllcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFwSW1hZ2VTdWJsYXllci5yZW5kZXJlciA9IHJlc3VsdC5yZW5kZXJlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5zZWxlY3RlZEZpZWxkcyA9IFtdO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5zZWxlY3RlZEZpZWxkcyA9IGdldFJlbmRlcmVyRmllbGRJbmZvcyhzbUxheWVyKTtcbiAgICAgICAgICAgICAgICBzbWFydE1hcHBpbmdTdGF0ZS5zZWxlY3RlZEZpZWxkcy5mb3JFYWNoKChzZWxlY3RlZEZpZWxkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEZpZWxkLmV4cHJlc3Npb24gJiYgIXNlbGVjdGVkRmllbGQuZXhwcmVzc2lvblRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpZWxkLmV4cHJlc3Npb25UaXRsZSA9IHN0cmluZ3MuZXhwcmVzc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIGdldCBhc3NldHNEaXJzKCkgeyByZXR1cm4gW1wiYXNzZXRzXCJdOyB9XG4gICAgZ2V0IGhvc3RFbGVtZW50KCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcblxuZXhwb3J0IHsgQXJjZ2lzU21hcnRNYXBwaW5nIGFzIGFyY2dpc19zbWFydF9tYXBwaW5nIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFyY2dpcy1zbWFydC1tYXBwaW5nLmVudHJ5LmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgbCBhcyBhcHBseUV4dHJhVmlzVmFycywgcyBhcyBzbWFydE1hcHBpbmdTdGF0ZSwgbSBhcyBzYXZlRXh0cmFWaXNWYXJzLCBoIGFzIGdldFJlbmRlcmVyLCBhIGFzIGdldFZpc1ZhciB9IGZyb20gJy4vcmFzdGVyLXVuaXF1ZS12YWx1ZS0wOTc2ZWM3Zi5qcyc7XG5pbXBvcnQgJy4vbG9hZE1vZHVsZXMtYjRhYzEyNDcuanMnO1xuaW1wb3J0IHsgaSBhcyBpc0RlZmluZWQgfSBmcm9tICcuL2NvbW1vbkZ1bmN0aW9ucy1iMDgzMGU5ZS5qcyc7XG5cbi8qKlxuICogVXBkYXRlcyB0aGUgbGF5ZXIgd2l0aCBhIFNpbXBsZSByZW5kZXJlciB3aXRoIGRlZmF1bHQgc2V0dGluZ3NcbiAqIEBwYXJhbSBvcHRpb25zOiBvcHRpb25zXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZVNpbXBsZVJlbmRlcmVyKG9wdGlvbnMpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgeyBsYXllcjogc21MYXllciwgbWFwSW1hZ2VTdWJsYXllciwgbWFwVmlldywgbW9kdWxlcyB9ID0gc21hcnRNYXBwaW5nU3RhdGU7XG4gICAgY29uc3QgbGF5ZXIgPSBzbUxheWVyO1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIGNvbnN0IGV4dHJhcyA9IHNhdmVFeHRyYVZpc1ZhcnMoZ2V0UmVuZGVyZXIobGF5ZXIpKTtcbiAgICByZXR1cm4gbW9kdWxlcy5Mb2NhdGlvbkNyZWF0b3IuY3JlYXRlUmVuZGVyZXIoe1xuICAgICAgICBsYXllcixcbiAgICAgICAgdmlldzogbWFwVmlldyxcbiAgICAgICAgb3V0bGluZU9wdGltaXphdGlvbkVuYWJsZWQ6IG1hcEltYWdlU3VibGF5ZXJcbiAgICAgICAgICAgID8gZmFsc2VcbiAgICAgICAgICAgIDogaXNEZWZpbmVkKG9wdGlvbnMub3V0bGluZU9wdGltaXphdGlvbkVuYWJsZWQpXG4gICAgICAgICAgICAgICAgPyBvcHRpb25zLm91dGxpbmVPcHRpbWl6YXRpb25FbmFibGVkXG4gICAgICAgICAgICAgICAgOiB0cnVlLFxuICAgICAgICBzaXplT3B0aW1pemF0aW9uRW5hYmxlZDogbWFwSW1hZ2VTdWJsYXllclxuICAgICAgICAgICAgPyBmYWxzZVxuICAgICAgICAgICAgOiBpc0RlZmluZWQob3B0aW9ucy5zaXplT3B0aW1pemF0aW9uRW5hYmxlZClcbiAgICAgICAgICAgICAgICA/IG9wdGlvbnMuc2l6ZU9wdGltaXphdGlvbkVuYWJsZWRcbiAgICAgICAgICAgICAgICA6IHRydWUsXG4gICAgICAgIGZvckJpbm5pbmc6ICgoX2EgPSBsYXllci5mZWF0dXJlUmVkdWN0aW9uKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudHlwZSkgPT09IFwiYmlubmluZ1wiXG4gICAgfSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgIGFwcGx5RXh0cmFWaXNWYXJzKGV4dHJhcywgcmVzdWx0LnJlbmRlcmVyKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xuICAgIH0sIChlcnJvcikgPT4gUHJvbWlzZS5yZWplY3QoZXJyb3IpKTtcbn1cbmZ1bmN0aW9uIGJ1aWxkT3V0bGluZVZpc1ZhcigpIHtcbiAgICB2YXIgX2E7XG4gICAgLy8gVE9ETyAtIGNhbiB3ZSBqdXN0IGdldCB0aGUgdmlzdWFsVmFyaWFibGUgd2l0aG91dCBhIGZ1bGwgcmVuZGVyZXI/XG4gICAgY29uc3QgeyBsYXllcjogc21MYXllciwgbWFwVmlldywgbW9kdWxlcyB9ID0gc21hcnRNYXBwaW5nU3RhdGU7XG4gICAgY29uc3QgbGF5ZXIgPSBzbUxheWVyO1xuICAgIHJldHVybiBtb2R1bGVzLkxvY2F0aW9uQ3JlYXRvci5jcmVhdGVSZW5kZXJlcih7XG4gICAgICAgIGxheWVyLFxuICAgICAgICB2aWV3OiBtYXBWaWV3LFxuICAgICAgICBvdXRsaW5lT3B0aW1pemF0aW9uRW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgZm9yQmlubmluZzogKChfYSA9IGxheWVyLmZlYXR1cmVSZWR1Y3Rpb24pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50eXBlKSA9PT0gXCJiaW5uaW5nXCJcbiAgICB9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgY29uc3Qgc2l6ZU91dGxpbmVWaXNWYXIgPSBnZXRWaXNWYXIocmVzdWx0LnJlbmRlcmVyLCBcInNpemVcIiwgXCJvdXRsaW5lXCIpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHNpemVPdXRsaW5lVmlzVmFyKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGJ1aWxkU2l6ZUF1dG9WaXNWYXIoKSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IHsgbGF5ZXI6IHNtTGF5ZXIsIG1hcFZpZXcsIG1vZHVsZXMgfSA9IHNtYXJ0TWFwcGluZ1N0YXRlO1xuICAgIGNvbnN0IGxheWVyID0gc21MYXllcjtcbiAgICByZXR1cm4gbW9kdWxlcy5Mb2NhdGlvbkNyZWF0b3IuY3JlYXRlUmVuZGVyZXIoe1xuICAgICAgICBsYXllcixcbiAgICAgICAgdmlldzogbWFwVmlldyxcbiAgICAgICAgb3V0bGluZU9wdGltaXphdGlvbkVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICBzaXplT3B0aW1pemF0aW9uRW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgZm9yQmlubmluZzogKChfYSA9IGxheWVyLmZlYXR1cmVSZWR1Y3Rpb24pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50eXBlKSA9PT0gXCJiaW5uaW5nXCJcbiAgICB9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgY29uc3Qgc2l6ZUF1dG9WaXNWYXIgPSBnZXRWaXNWYXIocmVzdWx0LnJlbmRlcmVyLCBcInNpemVcIiwgXCJhdXRvXCIpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHNpemVBdXRvVmlzVmFyKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IHsgYnVpbGRPdXRsaW5lVmlzVmFyIGFzIGEsIGJ1aWxkU2l6ZUF1dG9WaXNWYXIgYXMgYiwgY3JlYXRlU2ltcGxlUmVuZGVyZXIgYXMgYyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2NhdGlvbi1lMjZiNTM5Zi5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2NC4wLjU4XG4gKi9cbmltcG9ydCB7IGsgYXMgaXNSYXN0ZXJSR0JSZW5kZXJlciwgcyBhcyBzbWFydE1hcHBpbmdTdGF0ZSB9IGZyb20gJy4vcmFzdGVyLXVuaXF1ZS12YWx1ZS0wOTc2ZWM3Zi5qcyc7XG5pbXBvcnQgJy4vbG9hZE1vZHVsZXMtYjRhYzEyNDcuanMnO1xuaW1wb3J0ICcuL2NvbW1vbkVudW1zLWZjZjEzNjYxLmpzJztcblxuZnVuY3Rpb24gZ2V0UmFzdGVyUmVuZGVyZXJUeXBlKCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgeyBsYXllcjogc21MYXllciB9ID0gc21hcnRNYXBwaW5nU3RhdGU7XG4gICAgY29uc3QgbGF5ZXIgPSBzbUxheWVyO1xuICAgIHN3aXRjaCAoKF9hID0gbGF5ZXIgPT09IG51bGwgfHwgbGF5ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxheWVyLnJlbmRlcmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudHlwZSkge1xuICAgICAgICBjYXNlIFwiZmxvd1wiOlxuICAgICAgICAgICAgcmV0dXJuIFwicmFzdGVyLWZsb3dcIjtcbiAgICAgICAgY2FzZSBcInZlY3Rvci1maWVsZFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwicmFzdGVyLXZlY3Rvci1maWVsZFwiO1xuICAgICAgICBjYXNlIFwiY2xhc3MtYnJlYWtzXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJyYXN0ZXItY2xhc3MtYnJlYWtzXCI7XG4gICAgICAgIGNhc2UgXCJ1bmlxdWUtdmFsdWVcIjpcbiAgICAgICAgICAgIHJldHVybiBcInJhc3Rlci11bmlxdWUtdmFsdWVcIjtcbiAgICAgICAgY2FzZSBcInJhc3Rlci1zdHJldGNoXCI6XG4gICAgICAgICAgICByZXR1cm4gaXNSYXN0ZXJSR0JSZW5kZXJlcihsYXllcikgPyBcInJhc3Rlci1yZ2JcIiA6IFwicmFzdGVyLXN0cmV0Y2hcIjtcbiAgICAgICAgY2FzZSBcInJhc3Rlci1zaGFkZWQtcmVsaWVmXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJyYXN0ZXItc2hhZGVkLXJlbGllZlwiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIChfYiA9IGxheWVyLnJlbmRlcmVyKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IudHlwZTtcbiAgICB9XG59XG4vLyBUT0RPOiBhZGQgb3RoZXIgcmFzdGVyIHJlbmRlcmVyIHR5cGVzXG5mdW5jdGlvbiBhcHBseVJhc3RlclJlbmRlcmVyKHJlbmRlcmVyLCBsYXllcikge1xuICAgIGlmIChcInJlbmRlcmVyXCIgaW4gbGF5ZXIpIHtcbiAgICAgICAgbGF5ZXIucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB9XG59XG5mdW5jdGlvbiBub3JtYWxpemVDb2xvclJhbXAoY29sb3JSYW1wKSB7XG4gICAgY29uc3QgeyBtb2R1bGVzIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICBpZiAoIWNvbG9yUmFtcCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgbmV3IG1vZHVsZXMuZXNyaUNvbG9yKFswLCAwLCAwLCAxXSksXG4gICAgICAgICAgICBuZXcgbW9kdWxlcy5lc3JpQ29sb3IoWzUwLCA1MCwgNTAsIDFdKSxcbiAgICAgICAgICAgIG5ldyBtb2R1bGVzLmVzcmlDb2xvcihbNzMsIDczLCA3MywgMV0pLFxuICAgICAgICAgICAgbmV3IG1vZHVsZXMuZXNyaUNvbG9yKFsxNDAsIDE0MCwgMTQwLCAxXSksXG4gICAgICAgICAgICBuZXcgbW9kdWxlcy5lc3JpQ29sb3IoWzI1NSwgMjU1LCAyNTUsIDFdKVxuICAgICAgICBdO1xuICAgIH1cbiAgICBpZiAoKGNvbG9yUmFtcCA9PT0gbnVsbCB8fCBjb2xvclJhbXAgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbG9yUmFtcC50eXBlKSAhPT0gXCJtdWx0aXBhcnRcIikge1xuICAgICAgICByZXR1cm4gW2NvbG9yUmFtcC5mcm9tQ29sb3IsIGNvbG9yUmFtcC50b0NvbG9yXTtcbiAgICB9XG4gICAgY29uc3QgY29sb3JSYW1wcyA9IGNvbG9yUmFtcC5jb2xvclJhbXBzO1xuICAgIGNvbnN0IGNvbG9ycyA9IGNvbG9yUmFtcHMubWFwKChjb2xvclJhbXApID0+IGNvbG9yUmFtcC5mcm9tQ29sb3IpO1xuICAgIGNvbG9ycy5wdXNoKGNvbG9yUmFtcHNbY29sb3JSYW1wcy5sZW5ndGggLSAxXS50b0NvbG9yKTtcbiAgICByZXR1cm4gY29sb3JzO1xufVxuXG5leHBvcnQgeyBhcHBseVJhc3RlclJlbmRlcmVyIGFzIGEsIGdldFJhc3RlclJlbmRlcmVyVHlwZSBhcyBnLCBub3JtYWxpemVDb2xvclJhbXAgYXMgbiB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yYXN0ZXItcmVuZGVyZXItYTYyZjE1MmMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9