/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_utils--b1abd1.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_utils--b1abd1"],{12046:(e,r,t)=>{t.d(r,{a:()=>i,b:()=>o,c:()=>l,d:()=>c,e:()=>p,f:()=>d,g:()=>I,h:()=>u,i:()=>s,j:()=>y,k:()=>m,l:()=>f,m:()=>h,n:()=>v,o:()=>g,p:()=>w,q:()=>b});var a=t(74689);const n=e=>{var r,t,a;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(t=null!==(r=null==e?void 0:e.roleId)&&void 0!==r?r:null==e?void 0:e.id)&&void 0!==t?t:null===(a=null==e?void 0:e.sourceJSON)||void 0===a?void 0:a.id};function i(e){return e&&!e.orgId}function l(e){return!e.isPortal||!!e.isBackedBySDS}function s(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function o(e){return"org_admin"===n(e)||"account_admin"===n(e)}function u(e){return"org_user"===n(e)||"account_user"===n(e)}function c(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function d(e){var r;return!!(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:admin:updateItemCategorySchema"))}function p(e){var r;return!!(null===(r=null==e?void 0:e.privileges)||void 0===r?void 0:r.includes("portal:admin:updateGroups"))}function y(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function m(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function v(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function h(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function g(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function f(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function I(e,r,t,a){const n=a&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(a.type),i=((null==r?void 0:r.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!r||!o(r)&&!i||!(null==t?void 0:t.isPortal)&&!n)}function b(e){return!!e&&(!c(e)||c(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const w=({items:e,user:r,portal:t})=>{const n=e[0],i=n.owner;if(t.isPortal&&i!==r.username&&i.includes("esri_")&&!["esri_livingatlas"].includes(i))return!1;const l=(0,a.u)(n,r),s=c(r),o=S(r),u=(0,a.c)(n,r)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(r)&&!s&&(function(e,r){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(r)||y(e)||m(e)||!!r.canSharePublic&&v(e)}(r,t)||S(r));return l||u||(0,a.d)(e,r)&&o};function S(e){return f(e)||h(e)||g(e)}},7273:(e,r,t)=>{t.d(r,{a:()=>M,b:()=>d,c:()=>y,d:()=>m,e:()=>J,s:()=>K,u:()=>p});var a=t(82102),n=t(20164),i=t(74689),l=t(88780),s=t(36238),o=t(12046),u=t(30301),c=t(79210);const d=async(e,r,t,s,o=!1)=>{const{portal:u,user:c}=s,d=`${(0,n.g)(u)}content/users/${c.username}/shareItems`;let p=[];const y=r?function(e){switch(e){case"public":return{org:!1,everyone:!0};case"org":return{org:!0,everyone:!1};case"private":case"shared":return{org:!1,everyone:!1};default:return{}}}(r):{};if(e.every((e=>(0,i.i)(e,c))))try{p=(await(0,l.r)(d,u,{body:Object.assign({items:e.map((e=>e.id)).join(","),groups:(null==t?void 0:t.length)?t.join(","):void 0,confirmItemControl:!0},y),usePost:!0})).results}catch(e){return console.error(e),{error:{code:"unhandledError"}}}else p=(await Promise.all(e.map((({id:e})=>async function(e,r,t,i,s=!1){try{const o=`${(0,a.g)(e,i)}/share`,u=Object.assign({groups:(null==t?void 0:t.length)?t.join(","):null,confirmItemControl:!0},r);let c;return c=s?await(0,l.r)(o,i,{body:u,usePost:!0}):await(0,n.r)(o,u,{},"post"),{result:c}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}(e,y,t,u,o))))).map((e=>e.result));return{result:p}},p=async(e,r,t)=>{const{portal:a,user:i}=t,s=`${(0,n.g)(a)}content/users/${i.username}/unshareItems`;try{return{result:(await(0,l.r)(s,a,{body:{items:e.join(","),groups:(null==r?void 0:r.length)?r.join(","):null},usePost:!0})).results}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};function y(e){const{typeKeywords:r,type:t,url:a}=e,n=r&&v.some((e=>r.includes(e))),i="Image Service"===t&&(null==a?void 0:a.includes("://iservices"))&&a.includes("arcgis.com"),l=h.includes(t);return n||i||l}function m(e){var r;const t=null===(r=e.typeKeywords)||void 0===r?void 0:r.includes("Hosted Service");return["Vector Tile Service","Map Service","Scene Service","Feature Service"].includes(e.type)&&t}const v=["Location Tracking Service","Location Tracking View","IoTFeed","IoTFeatureLayer","IoTMapImageLayer","IoTStreamLayer","Administrative Report","EditExtensionIndoorsSpaces","ArcgisWorkflowJobLocation"],h=["Knowledge Graph","Pro Project"],g=async(e,r)=>{const t=e.id;let a,n={items:[],layers:[]};switch(e.type){case"Group Layer":({result:n,error:a}=await f(t,r));break;case"Web Map":case"Web Scene":({result:n,error:a}=await I(t,r));break;case"Web Mapping Application":({result:n,error:a}=await b(t,r));break;case"Web Experience":case"Web Experience Template":({result:n,error:a}=await S(t,e.typeKeywords,r));break;case"Big Data File Share":({result:n,error:a}=await T(e,r));break;case"Data Store":({result:n,error:a}=await L(e,r))}return{result:n,error:a}},f=async(e,r)=>{try{const t=await(0,u.g)(e,r);return{result:{items:[],layers:[Object.assign({},t)]}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},I=async(e,r)=>{var t,a;try{const n=await(0,u.g)(e,r),{operationalLayers:i,baseMap:l,tables:s,ground:o}=n;return{result:{items:[],layers:[...null!=i?i:[],...null!==(t=null==l?void 0:l.baseMapLayers)&&void 0!==t?t:[],...null!==(a=null==o?void 0:o.layers)&&void 0!==a?a:[],...null!=s?s:[]]}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},b=async(e,r)=>{try{const t=await(0,u.g)(e,r);if(!t)return{result:{items:[],layers:[]}};const a=w(t),n=(await Promise.all(a.map((e=>(0,u.a)(e,r))))).map((({result:e})=>e)).filter((e=>e)),i=await Promise.all(n.map((e=>g(e,r)))),{items:l,layers:s}=D(i.map((({result:e})=>e)).flat().filter((e=>e)));return{result:{items:[...n,...l],layers:s}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},w=e=>{var r,t,a,n,i,l,s,o,u,c;return[...(null===(r=null==e?void 0:e.map)||void 0===r?void 0:r.itemId)?[e.map.itemId]:[],...null!==(n=null===(a=null===(t=e.values)||void 0===t?void 0:t.itemCollection)||void 0===a?void 0:a.map((e=>e.id)))&&void 0!==n?n:[],...null!==(s=null===(l=null===(i=e.values)||void 0===i?void 0:i.webmap)||void 0===l?void 0:l.split(","))&&void 0!==s?s:[],...null!==(c=null===(u=null===(o=e.values)||void 0===o?void 0:o.webscene)||void 0===u?void 0:u.split(","))&&void 0!==c?c:[]]},S=async(e,r,t)=>{const n=`${(0,a.g)(e,t)}/resources/config/config.json`,i=(0,u.b)(e,t),s=[];r.includes("status: Draft")?s.push(n):r.includes("status: Changed")?s.push(n,i):s.push(i);try{const e=[],r=[],a=[];return await Promise.all(s.map((async n=>{const i=await(0,l.r)(n,t);if(!(null==i?void 0:i.dataSources)&&!(null==i?void 0:i.utilities))return;const s=(await Promise.all(function(e){const r=e.dataSources||{},t=e.utilities||{};return[...Object.values(r),...Object.values(t)].map((e=>e.itemId)).filter((e=>e))}(i).map((e=>(0,u.a)(e,t))))).map((({result:e})=>e)).filter((e=>e)),o=await Promise.all(s.map((e=>g(e,t)))),{items:c,layers:d}=D(o.flatMap((({result:e})=>e)).filter((e=>e)));a.push(...d),e.push(...c),r.push(...s)}))),{result:{items:[...r,...e],layers:a}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},T=async(e,r)=>{try{const{relatedItems:t}=await(0,l.g)(e.id,r,{relationshipType:"BDFSDataStore2BDFSCatalogService",direction:"reverse"}),a=t[0].typeKeywords;if(a.includes("bigDataFileShare")&&a.includes("dataStore")){const{result:e}=await L(t[0],r),{items:a}=e,n=await(0,u.c)(t[0].id,r);return{result:{items:[...a,n],layers:[]}}}return{result:{items:await Promise.all(t.map((e=>(0,u.c)(e.id,r)))),layers:[]}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},L=async(e,r)=>{try{const{relatedItems:t}=await(0,l.g)(e.id,r,{relationshipType:"CloudDataStore2BDFSDataStore",direction:"reverse"});return{result:{items:await Promise.all(t.map((e=>(0,u.c)(e.id,r)))),layers:[]}}}catch(e){return console.error("error:",e),{error:{code:"unhandledError"}}}},D=e=>({items:e.flatMap((e=>e.items)),layers:e.flatMap((e=>e.layers))});async function E(e,r,t=!1){try{const{result:a}=await(0,u.d)(e,r);return{result:[...a.admin,...a.member,...a.other].filter((e=>t||!e.isFav)).map((e=>e.id))}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const P=e=>!("layerType"in e)&&e.url&&e.popupInfo,O={needsGroupUpdate:!1,needsShareLevelUpdate:!1,canEditShareLevel:!0,premium:!1,bdfsDatastore:!1},U={private:0,shared:1,org:2,public:3},G=async(e,r)=>{const{owningSystemUrl:t}=await(0,n.f)((async()=>(0,n.a)(e)),"portalInfo",e.id);return(await Promise.all(r.map((async e=>{try{const{owningSystemUrl:r}=await(0,n.b)(e);return{owningSystemUrl:r,url:e}}catch(r){return console.error(r),{owningSystemUrl:null,url:e}}})))).filter((({owningSystemUrl:e})=>e===t)).map((({url:e})=>e))},k=async(e,r)=>{const t=e.filter((e=>{return!!(null==e?void 0:e.url)&&(r={layerType:e.layerType},["table","ArcGISFeatureLayer","ArcGISTiledMapServiceLayer","VectorTileLayer","GroupLayer","ArcGISImageServiceLayer","ArcGISTiledImageServiceLayer","SubtypeGroupLayer","ArcGISStreamLayer"].includes(r.layerType));var r})),a=await A(t.map((e=>e.url)),r),i=[],s=[],o=[];await Promise.all(a.map((async e=>{const{result:t,error:a}=await(0,n.f)((()=>(0,l.a)(e,r)),"itemMetadata",`${e}--no-token`);"tokenRequired"!==(null==a?void 0:a.code)?j(t)?i.push(B(t,e)):o.push(t):s.push(e)})));const c=o.map((e=>null==e?void 0:e.serviceItemId)),d=await G(r,s),p=(await Promise.all(d.map((async e=>({response:await(0,l.r)(e,r,{addTokenManually:!0}),url:e}))))).reduce(((e,{response:r,url:t})=>j(r)?(i.push(B(r,t)),e):[...e,null==r?void 0:r.serviceItemId]),[]),y=await Promise.all([...c,...p].map((async e=>e?(0,u.c)(e,r):null))),m=i.length<=0?[]:await k(i.map((e=>({url:e,layerType:"VectorTileLayer"}))),r);return[...y.filter((e=>!!e)),...m]},j=e=>!!(null==e?void 0:e.sources),B=(e,r)=>{var t;const a=null===(t=Object.values(e.sources)[0])||void 0===t?void 0:t.url;return a?a.includes("..")?(({path:e,url:r})=>{const t=r.split("/"),a=e.split("/");return t.slice(0,t.length-a.length).join("/")})({url:r,path:a}):a:null},A=async(e,r)=>{const t=e.filter((e=>!!e&&!!(0,c.p)(e))),a=e.filter((e=>!e||!(0,c.p)(e)));return[...await G(r,t),...a]},M=async(e,r,t,a={clearDataCacheOnDone:!0})=>{if("private"===e.access)return{result:{needEditableLayers:[],needPubliclyEditableLayers:[],needDataCollectionLayers:[],needsShareLevelUpdateLayers:[],premiumLayers:[],notEditableLayers:[],needBDFSDatastoreUpdate:[],needAuthentication:[]}};const{result:i,error:l}=await C(e,r,t);if(l)return{error:l};const s={needEditableLayers:[],needPubliclyEditableLayers:[],needDataCollectionLayers:[],needsShareLevelUpdateLayers:[],premiumLayers:[],notEditableLayers:[],needBDFSDatastoreUpdate:[],needAuthentication:$(e)?[{sourceItem:e,detail:{bdfsDatastore:!1,canEditShareLevel:!0,needsGroupUpdate:!1,needsShareLevelUpdate:!1,premium:!1}}]:[]};return await Promise.all(null==i?void 0:i.map((async t=>{const a=await x({mainItem:e,sharingDetailResult:t,portal:r});a&&s[a].push(t)}))),a.clearDataCacheOnDone&&J.forEach((e=>(0,n.c)(e))),{result:s}},C=async(e,r,t)=>{let a,o=[],d=[...t||[]];if(!(null==d?void 0:d.length)){const{error:t,result:n}=await g(e,r);a=t,d=n.layers,o=n.items}if(a)return{error:a};if(d.length<=0&&o.length<=0)return{error:{code:"dataNotAvailable"}};try{if("Big Data File Share"!==e.type&&"Data Store"!==e.type){const{result:e,error:t}=await(async(e,r)=>{const t=[],a=e=>{if(P(e))t.push({id:e.id,url:e.url,layerType:"table",getType:"normal"});else{if("GroupLayer"===e.layerType)return e.itemId&&t.push({id:e.id,itemId:e.itemId,layerType:"GroupLayer",getType:"normal"}),void e.layers.forEach((e=>{if(P(e)||"GroupLayer"===e.layerType)return void a(e);const r=e.url;if(!r)return void a(e);const t=(0,c.p)(r);a(Object.assign(Object.assign({},e),{url:null!=(null==t?void 0:t.index)?t.baseServerUrl:e.url}))}));if((e=>"VectorTileLayer"===e.layerType&&"styleUrl"in e)(e))t.push({id:e.id,url:e.styleUrl,itemId:e.itemId,layerType:e.layerType,getType:"normal"});else if((e=>"ArcGISTiledMapServiceLayer"===e.layerType)(e)){const r=(e=>"ArcGISTiledMapServiceLayer"===e.layerType&&"layers"in e&&!1===e.layers[0].disablePopup)(e);if(r){const r=e.layers[0];t.push({id:r.id,url:r.layerUrl,getType:"normal",layerType:e.layerType,itemId:r.layerItemId})}t.push({id:e.id,getType:r?"normal":"tile-layer-with-no-popup",itemId:e.itemId,layerType:e.layerType,url:e.url})}else(e.itemId||e.url)&&t.push({id:e.id,url:e.url,itemId:e.itemId,layerType:e.layerType,getType:"normal"})}};e.forEach(a);const i=(0,s.a)(t,(e=>e.itemId?{key:e.itemId,data:{searchType:"item-id",layerType:e.layerType}}:{key:e.url,data:{searchType:"url",layerType:e.layerType}})),o=Object.keys(i).filter((e=>"item-id"===i[e].searchType));try{const e=(await Promise.all(o.map((e=>(0,u.c)(e,r))))).filter((e=>!!e)),a=t.filter((({getType:e,itemId:r})=>"tile-layer-with-no-popup"===e&&!!r)),c=(await Promise.all(a.map((e=>(async(e,r)=>{try{const t=e.itemId,a=await(0,n.f)((()=>(0,u.g)(t,r)),"itemData",t),{layerItemId:i}=null==a?void 0:a.layers[0];return i?{result:await(0,u.c)(i,r)}:{error:{code:"unhandledError"}}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}})(e,r))))).map((({result:e})=>e)),d=e.filter((e=>!(0,l.i)(e.typeKeywords,e.type))),p=await k(d.map((e=>{const{url:r,id:t}=e,a=i[t];return a?{layerType:a.layerType,url:r}:null})),r),y=(0,s.a)(p,(e=>({key:e.url,data:e}))),m=Object.keys(i).map((e=>{const r=i[e];return r&&"url"===r.searchType?{layerType:r.layerType,url:e}:null})).filter((e=>e)),v=await k(m,r),h=[];return e.filter((e=>e)).forEach((e=>{const r=e.url;h.push({sourceItem:e});const t=y[r];t&&e.id!==t.id&&h.push({sourceItem:t})})),[...c,...v].forEach((e=>{e&&h.push({layer:null,sourceItem:e})})),{result:h}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}})(d,r);if(t)return{error:t};o.push(...e.map((({sourceItem:e})=>e)))}const{result:t,error:a}=await E(e.id,r);if(a)return{error:a};const p=(0,s.u)(o,(e=>e.id)),m=await Promise.all(p.map((async a=>{const n=await async function({mainItemAccess:e,mainItemSharingGroups:r,portal:t,sourceItem:a}){const{access:n,itemControl:l}=a,s=Object.assign({},O),o="public"===e;return y(a)&&o?Object.assign(Object.assign({},s),{needsShareLevelUpdate:!0,canEditShareLevel:!1}):("public"!==n?(s.canEditShareLevel=_(l),s.needsGroupUpdate=await F({sourceItem:a,isMainItemSharingToPublic:o,mainItemSharingGroups:r,portal:t}),s.needsShareLevelUpdate=R({mainItemAccess:e,sourceItemAccess:n})):s.premium=function(e){return(0,i.a)(e)||(0,i.b)(e)}(a),s)}({sourceItem:a,mainItemAccess:e.access,mainItemSharingGroups:t,portal:r});return{sourceItem:a,detail:n}})));return{result:m}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},_=e=>"admin"===e,$=e=>e.typeKeywords.includes("DeveloperBasemap"),F=async({sourceItem:e,isMainItemSharingToPublic:r,portal:t,mainItemSharingGroups:a})=>{if(r)return!1;const{result:n}=await E(e.id,t);return!function(e,r){return!(null==e?void 0:e.length)||e.filter((e=>!(r||[]).includes(e))).length<=0}(a,n)},R=({mainItemAccess:e,sourceItemAccess:r})=>!("private"===r&&"shared"===e)&&U[e]>U[r];async function K(e,r,t,a,n=!0){const{user:i}=a,l=n?await Promise.all(r.map((async e=>{const{result:r}=await E(e.id,a);return r}))):[],s=l.flat(1);return d(e,t,s,{portal:a,user:i},!0)}const x=async({mainItem:e,sharingDetailResult:r,portal:t})=>{var a;const{sourceItem:n,detail:i}=r,{canEditShareLevel:l,needsGroupUpdate:s,needsShareLevelUpdate:c,premium:d}=i;if(i.bdfsDatastore)return"needBDFSDatastoreUpdate";if(!s&&!c&&!d)return null;if(!l&&!d)return"notEditableLayers";switch(e.access){case"public":if(d)return"premiumLayers";if("public"!==n.access){if((0,o.i)(t.subscriptionInfo||(null===(a=t.sourceJSON)||void 0===a?void 0:a.subscriptionInfo))&&m(n))return"notEditableLayers";if(await(0,u.i)(n,t))return n.typeKeywords.includes("Public Data Collection")?"needEditableLayers":"needDataCollectionLayers"}return"needsShareLevelUpdateLayers";case"org":case"shared":case"private":return d?null:"needsShareLevelUpdateLayers";default:N(e.access)}},J=["itemData","itemMetadata"],N=e=>{throw new Error(`Unexpected share level ${e}`)}},19719:(e,r,t)=>{t.d(r,{D:()=>v,a:()=>m,b:()=>d,c:()=>p,d:()=>h,e:()=>y,f:()=>T,g:()=>g,h:()=>f,i:()=>L,j:()=>b,k:()=>s,l:()=>u,s:()=>c});var a=t(12046),n=t(36238),i=t(74689),l=t(7273);const s=(e,r)=>o(r)||(0,a.l)(r)&&((e,r)=>{const{username:t,orgId:a}=e;return r.every((({group:e})=>{const r=t===(null==e?void 0:e.owner),n=a===e.orgId;return r||n}))})(r,e),o=e=>!(0,a.h)(e)||function(e){return(e.privileges||[]).includes("portal:user:shareToGroup")}(e),u=(e,r)=>r.some((({selectedByItemIds:r})=>r.length!==e.length)),c=(e,r)=>!(0,a.h)(e)&&!(0,a.j)(e)&&r.some((e=>"private"===e)),d=(e,r,t)=>(0,a.a)(e)&&r.some((e=>"private"===e))&&t.length>0,p=(e,r,t)=>!(0,a.h)(e)&&!(0,a.k)(e)&&(({items:e,groupData:r})=>e.filter((e=>{const r=e.access;return"private"===r||"shared"===r})).reduce(((e,t)=>e||(({item:e,groupData:r})=>r.reduce(((r,t)=>r||!!t.selectedByItemIds&&t.selectedByItemIds.includes(e.id)),!1))({item:t,groupData:r})),!1))({items:r,groupData:t}),y=(e,r,t)=>!(0,a.b)(e)&&!(0,a.h)(e)&&!(0,a.k)(e)&&"private"===r&&Object.keys(t).length>0,m=({shareMode:e,currentUsername:r,user:t,userGroupLookup:a,isPrivate:n})=>{var i;let l,s=[];if(a){let l=[];"admin"===e&&(null===(i=a[r])||void 0===i?void 0:i.length)&&r!==t.username&&(l=[...a[r]]),"admin"===e&&n||a[t.username].forEach((e=>{l.some((r=>r.id===e.id))||l.push(e)})),null==l||l.forEach((e=>{var r;const t=null===(r=e.userMembership)||void 0===r?void 0:r.memberType;!e.isViewOnly||"owner"!==t&&"admin"!==t||s.push(e.id)}))}s.length&&(l=`(isviewonly:false OR id:(${s.join(" OR ")}))`);const o=s.length?` OR id:(${s.join(" OR ")})`:"";switch(e){case"default":return l||`(owner:${r} OR isviewonly:false)`;case"group":return`owner:${r} -capabilities:updateitemcontrol`;case"admin":return t.username===r?`(isviewonly:false${o} OR owner:${t.username}) -capabilities:updateitemcontrol`:`(owner:${r} OR isviewonly:false${o})`;default:return""}},v={needEditableLayers:[],needPubliclyEditableLayers:[],needDataCollectionLayers:[],needsShareLevelUpdateLayers:[],premiumLayers:[],notEditableLayers:[],needAuthentication:[],needBDFSDatastoreUpdate:[]},h=["private","org","public"],g=(e,r)=>{const t=e.filter((e=>!r.some((r=>r.group.id===e.group.id)))),a=r.filter((r=>{const t=e.find((e=>e.group.id===r.group.id));return!t||t.selectedByItemIds.length<r.selectedByItemIds.length}));return{unshareGroupIds:t.map((e=>e.group.id)),shareGroupIds:a.map((e=>e.group.id))}},f=(e,r,t)=>{const n=(0,a.a)(e);let i=h;return n?i=["private","public"]:t.canSharePublic||(0,a.b)(e)||(i=["private","org"]),i=i.filter((a=>I(a,r,e,t))),i},I=(e,r,t,n)=>{var i;if("private"===e)return!0;const s=w(t,r),o=S(t,r),u=(0,a.b)(t)&&!(0,a.d)(t)&&o,c=(0,a.b)(t)&&(0,a.d)(t)&&o,d=(0,a.a)(t);if("org"===e)return!d&&((0,a.k)(t)&&(s||u)||(0,a.m)(t)&&(u||c));if("public"===e){const e=(0,a.i)((null==n?void 0:n.subscriptionInfo)||(null===(i=null==n?void 0:n.sourceJSON)||void 0===i?void 0:i.subscriptionInfo));if(1===r.length&&((0,l.c)(r[0])||e&&(0,l.d)(r[0])))return!1;const o=n.canSharePublic;return d||(0,a.n)(t)&&(s&&o||u)||(0,a.o)(t)&&(u||c)}},b=(e,r,t)=>{var n;const l=e[0];if((0,i.i)(l,r))return"default";const s=!l.orgId&&!(null===(n=l.sourceJSON)||void 0===n?void 0:n.orgId)||S(r,[l]);return(0,a.p)({items:e,user:r,portal:t})&&s?"admin":"group"},w=(e,r)=>r.every((r=>(0,i.i)(r,e))),S=(e,r)=>{const t=null==e?void 0:e.orgId;return r.every((r=>{var a,n;return(0,i.i)(r,e)||r.orgId===t||(null===(a=r.sourceJSON)||void 0===a?void 0:a.orgId)===t||(null===(n=r.portal)||void 0===n?void 0:n.id)===t||r.isOrgItem}))},T=(e,r,t,a)=>e.some(((e,n)=>{const i=r[n];if("shared"===i&&"private"===e){const e=t[n];return!a.some((r=>r.selectedByItemIds.includes(e.id)))}return i!==e})),L=(e,r)=>e.length!==r.length||r.some((r=>{const t=e.find((e=>e.group.id===r.group.id));return!t||!(0,n.f)(t.selectedByItemIds,r.selectedByItemIds)}))}}]);