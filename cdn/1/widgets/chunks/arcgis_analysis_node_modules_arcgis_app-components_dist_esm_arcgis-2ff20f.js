/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f"],{95433:(e,t,i)=>{i.d(t,{c:()=>o,g:()=>d});var n=i(20206),a=i(13337),s=i(8899),l=i(13615),r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i};function o(e,t){var i;const n=(null==e?void 0:e.type)||null,a=(null==t?void 0:t.type)||null;return a&&(a===n||(null===(i={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[n])||void 0===i?void 0:i.indexOf(a))>-1)}function d(e){var t;const{timezone:i,analyzeResults:o,type:d,fieldMappings:p,dataLayer:c,id:u,uidPair:y,addAppendSelectOption:g,sourceDataLayer:m}=e;let h,T;const{publishParameters:v}=o,f=r(o,["publishParameters"]),F="upsert"===g||"update"===g,b=function(e){return e.filter((e=>e.source!==a.N)).map((({source:e,name:t})=>({source:e,name:t})))}(p),O=function(e){return e.map((e=>e.name))}(b),w={dateFieldsTimeReference:{timeZone:i||"UTC",respectsDaylightSaving:!0}},I={sourceTableName:c.name,fieldMappings:(null==b?void 0:b.length)?JSON.stringify(b):null,upsert:F,skipInserts:"update"===g,skipUpdates:!1,useGlobalIds:F&&"esriFieldTypeGlobalID"===(null==y?void 0:y.type),updateGeometry:!F||"attributeAndGeometry"===n.a.addAppendSelectUpdateTypeOption,appendFields:O.length?JSON.stringify(O):null,appendItemId:u,appendUploadFormat:l.a[n.a.type].appendUploadFormat,rollbackOnFailure:!0},D=r(v,["layers"]);if("CSV"===d)v.layerInfo.dateFieldsTimeReference=w.dateFieldsTimeReference,T=Object.assign(Object.assign(Object.assign({},w),v),f);else if("Microsoft Excel"===d){const e=function(e,t){const i=Object.assign({},e);return i.locationType=t.locationType,"address"===i.locationType?(i.addressFields=t.addressFields,i.sourceCountry=t.sourceCountry):"coordinates"===i.locationType&&(i.coordinateFieldType=t.coordinateFieldType,"LatitudeAndLongitude"===i.coordinateFieldType?(i.latitudeFieldName=t.latitudeFieldName,i.longitudeFieldName=t.longitudeFieldName):i.coordinateFieldName=t.coordinateFieldName),i}((0,s.a)({},!0),D);e.dateFieldsTimeReference=w.dateFieldsTimeReference,D.name=c.name,T=Object.assign(Object.assign(Object.assign(Object.assign({},w),{layers:[e]}),D),f)}else T=Object.assign(Object.assign(Object.assign({},w),v),f);return h=Object.assign(Object.assign({},I),{appendSourceInfo:JSON.stringify(T)}),"add"===g?h.upsertMatchingField=m.objectIdField||(null===(t=m.uniqueField)||void 0===t?void 0:t.name):F&&(null==y?void 0:y.isUniqueIndex)&&(h.upsertMatchingField=null==y?void 0:y.name),h}},49367:(e,t,i)=>{i.d(t,{a:()=>l});var n=i(20164),a=i(95433),s=i(62824);async function l(e){var t;const i=(0,a.g)(e),l=`${null===(t=e.existingItem)||void 0===t?void 0:t.url}/${e.sourceDataLayer.id}/append`;try{const t=await(0,n.r)(l,i,{},"post"),{status:a,recordCount:r}=await(0,s.x)(e.id,{},null==t?void 0:t.statusUrl);return{result:{status:a,recordCount:r}}}catch({error:e}){return console.error(e),{error:{code:"unhandledError",message:JSON.stringify(e)}}}}},27627:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_append_select_update:()=>p});var n=i(81149),a=i(49367),s=i(97762),l=i(82102),r=i(20206),o=i(65804),d=i(44300);i(20164),i(69283),i(49853),i(70464),i(79210),i(95433),i(13337),i(8899),i(12046),i(74689),i(73411),i(13615),i(62824),i(12846),i(43237),i(78239),i(88780),i(70105),i(18762),i(49288),i(42577),i(30301),i(14192),i(52787),i(25145),i(41487),i(50202),i(41450),i(70217);const p=class{constructor(e){(0,n.r)(this,e),this.workflowComplete=(0,n.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,n.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,n.c)(this,"newItemDisableCloseButtons",7),this.newItemUpdatePage=(0,n.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,n.c)(this,"newItemPrevPage",7),this.appendOptions={attribute:{icon:"table",updateGeometry:!1},attributeAndGeometry:{icon:"multiple-variables",updateGeometry:!0}},this.updateOptions={uploaded:{icon:"upload-to",keepDescription:!1},existing:{icon:"feature-details",keepDescription:!0}},this.noticeMessage=null,this.selected=void 0,this.cannotUpdateGeometry=!1,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.error=void 0}async componentWillLoad(){var e;this.selected="append"===o.u.workflow?"attribute":"uploaded",this.i18n=o.u.i18n.appendSelectUpdateType,"append"===o.u.workflow&&(null!==(e=this.noticeMessage)&&void 0!==e||(this.noticeMessage=(0,d.v)({dataLayer:r.a.dataLayer,type:r.a.type,sourceDataLayer:r.a.sourceDataLayer})),this.cannotUpdateGeometry=!!this.noticeMessage),o.u.nextText="updateAppend"}async handleNext(){const e=this.selected;if("update"===o.u.workflow){r.a.addUpdateItemPropertiesOption=e;const t="uploaded"===e;r.a.keepDescription=t,this.handleUpdate()}else r.a.addAppendSelectUpdateTypeOption=e,this.handleAppend()}async handlePrev(e){e.preventDefault(),!this.loading&&this.newItemPrevPage.emit()}async handleUpdate(){this.loading=!0,this.loaderMessage=o.u.i18n.append.appendLoadingMessages.updating;const{file:e,overwrite:t,keepDescription:i,existingItem:n}=r.a,a=await(0,s.b)(n,n.itemOwner.userContentUrl,{file:e,overwrite:t,keepDescription:i});a.success?this.workflowComplete.emit({success:a.success}):(this.loading=!1,this.error={title:o.u.i18n.error,description:o.u.i18n.appendOverwrite.errors.errorWhileUpdate})}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e;this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=o.u.i18n.append.appendLoadingMessages.appendCloseNotice;const t=await(0,a.a)({sourceDataLayer:r.a.sourceDataLayer,existingItem:r.a.existingItem,timezone:r.a.timezone,analyzeResults:r.a.analyzeResults,type:r.a.type,fieldMappings:r.a.fieldMappings,dataLayer:r.a.dataLayer,id:r.a.id,uidPair:r.a.uidPair,addAppendSelectOption:r.a.addAppendSelectOption});if("completed"!==(null===(e=null==t?void 0:t.result)||void 0===e?void 0:e.status.toLowerCase()))this.disableModalButtons(!1),this.loading=!1,this.error={title:o.u.i18n.error,description:o.u.i18n.append.appendErrorMessages.appendError};else{await(0,l.d)(r.a.id,{permanentDelete:!0});const e=Object.assign({appendType:r.a.addAppendSelectOption},t);this.workflowComplete.emit(e)}}render(){const{i18n:e,appendOptions:t,updateOptions:i,noticeMessage:a,error:s}=this;let l=t,r=e.header,d="appendOptions";return"update"===o.u.workflow&&(l=i,r=e.itemPropertiesHeader,d="updateOptions"),(0,n.h)(n.H,{class:{"overflow-hidden":this.loading}},(0,n.h)("arcgis-new-item-description",{header:r}),(0,n.h)("calcite-tile-select-group",{layout:"vertical",class:"tile-select"},Object.keys(l).map((t=>{const{icon:i}=l[t];return(0,n.h)("calcite-tile-select",{key:t,checked:this.selected===t,heading:e[d][t].title,description:e[d][t].description,icon:i,name:"feature-layer-create-mode","input-enabled":!0,width:"full",type:"radio",value:t,disabled:"attributeAndGeometry"===t&&this.cannotUpdateGeometry,onCalciteTileSelectChange:e=>{this.selected=e.target.value}})}))),"append"===o.u.workflow&&this.cannotUpdateGeometry&&(0,n.h)("calcite-notice",{class:"need-geometries-notice",open:!0,icon:"lightbulb"},(0,n.h)("div",{slot:"title"},e[a.title]),(0,n.h)("div",{slot:"message"},e[a.description])),(0,n.h)("arcgis-new-item-loader",{type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,n.h)("arcgis-new-item-alert",{heading:null==s?void 0:s.title,description:null==s?void 0:s.description,link:{href:null==s?void 0:s.link,title:null==s?void 0:s.linkText},active:!!s,onAlertDismiss:()=>this.error=null}))}get el(){return(0,n.d)(this)}};p.style=".tile-select{margin-top:1.25rem}.need-geometries-notice{margin-top:1.5rem}"},44300:(e,t,i)=>{function n(e){var t,i;const{dataLayer:n,type:a,sourceDataLayer:s}=e,l=null!==(t=null==n?void 0:n.geometryType)&&void 0!==t?t:null===(i=null==n?void 0:n.layerInfo)||void 0===i?void 0:i.geometryType;if("Microsoft Excel"===a||"CSV"===a){if(("address"===n.locationType&&n.addressFields||"coordinates"===n.locationType)&&"esriGeometryPoint"===(null==s?void 0:s.geometryType))return null;if(!l||"none"===n.locationType||"Table"===(null==s?void 0:s.type))return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==s?void 0:s.geometryType)!==l)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else if((null==s?void 0:s.geometryType)!==(null==n?void 0:n.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}function a(e,t,i){return"Microsoft Excel"===i||"CSV"===i?"Table"===(null==t?void 0:t.type)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&(!!e.addressFields||"none"!==e.locationType):"Table"===(null==t?void 0:t.type)||(null==e?void 0:e.geometryType)===(null==t?void 0:t.geometryType)}i.d(t,{c:()=>a,v:()=>n})}}]);