"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-b53d4d"],{53248:(e,t,n)=>{n.d(t,{A:()=>o,G:()=>l,J:()=>i,M:()=>a,P:()=>c,U:()=>r,a:()=>u,d:()=>s});const r={IDLE:"idle",VALID:"valid",INVALID:"invalid"},i={RASTER_FUNCTION_TEMPLATE:"RasterFunctionTemplate",RASTER_FUNCTION_VARIABLE:"RasterFunctionVariable",ARGUMENT_ARRAY:"ArgumentArray",RECORD_SET:"RecordSet",ECD_FILE:"ECDFile"},a={MATCH_VARIABLE:"MatchVariable",UNION_DIMENSION:"UnionDimension"},s={name:"Raster",isDataset:!0,isPublic:!1,type:i.RASTER_FUNCTION_VARIABLE},o={RFX_DTEX_COMMON_SELECT:"RFX-DTEX-COMMON-SELECT",RFX_DTE_COMMON_CHECKBOX:"CALCITE-CHECKBOX",RFX_DTE_COMMON_TEXTINPUT:"CALCITE-INPUT-TEXT",RFX_DTE_COMMON_NUMBERINPUT:"CALCITE-INPUT-NUMBER",RFX_DTE_RASTER_INPUT:"RFX-DTE-RASTER-INPUT",RFX_DTE_FEATURE_SELECT:"RFX-DTE-FEATURE-SELECT",RFX_DTEX_RASTER_VARIABLES_LIST:"RFX-DTEX-RASTER-VARIABLES-LIST",RFX_CTE_RANGED_VALUE_EDITOR:"RFX-CTE-RANGED-VALUE-EDITOR",RFX_CTE_GAMMA_EDITOR:"RFX-CTE-GAMMA-EDITOR",RFX_DTE_COLOR_RAMP_SELECTOR:"RFX-DTE-COLOR-RAMP-SELECTOR",RFX_DTE_EXTENT:"RFX-DTE-EXTENT",RFX_DTE_JSON_FILE_UPLOADER:"RFX-DTE-JSON-FILE-UPLOADER",RFX_CTE_FACTOR_FUNCTION_EDITOR:"RFX-CTE-FACTOR-FUNCTION-EDITOR",RFX_CTE_NEIGHBORHOOD_VALUES:"RFX-CTE-NEIGHBORHOOD-VALUES"},u={ANALYSIS:"analysis",EDITOR:"editor"},l={textInput:"text-input",text:"text",raster:"raster-input",number:"number-input",boolean:"check-box",switch:"switch",field:"field-select",color:"color-input",select:"select",icon:"icon"},c={loading:"loading",success:"success",error:"error"}},5660:(e,t,n)=>{n.d(t,{a:()=>O,b:()=>F,c:()=>N,d:()=>D,e:()=>b,f:()=>L,g:()=>S,h:()=>x,i:()=>w,j:()=>k,k:()=>U,l:()=>X,n:()=>M,o:()=>P});var r=n(46574),i=n(34319),a=n(46717),s=n(55139),o=n(57098),u=(n(78979),n(95876)),l=n(77162),c=n(53248),f=n(32804),h=n(48363),p=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,d=/^\w*$/;function A(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var s=e.apply(this,r);return n.cache=a.set(i,s)||a,s};return n.cache=new(A.Cache||f.M),n}A.Cache=f.M;var m,g,E,y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,T=(m=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(y,(function(e,n,r,i){t.push(r?i.replace(C,"$1"):n||e)})),t},g=A(m,(function(e){return 500===E.size&&E.clear(),e})),E=g.cache,g);var R=1/0;function v(e){if("string"==typeof e||(0,u.c)(e))return e;var t=e+"";return"0"==t&&1/e==-R?"-0":t}function _(e,t,n){return null==e?e:function(e,t,n,r){if(!(0,h.j)(e))return e;for(var i=-1,a=(t=function(e,t){return(0,h.a)(e)?e:function(e,t){if((0,h.a)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!(0,u.c)(e))||d.test(e)||!p.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:T((0,u.d)(e))}(t,e)).length,s=a-1,o=e;null!=o&&++i<a;){var l=v(t[i]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=s){var A=o[l];void 0===(c=void 0)&&(c=(0,h.j)(A)?A:(0,f.i)(t[i+1])?[]:{})}(0,f.a)(o,l,c),o=o[l]}return e}(e,t,n)}function N(e){return i.clone(e)}function O(){return i.clone(c.d)}function I(e){return a.urlToObject(e).path}function S(e){return e?.indexOf("?token=")>0&&(e=e.slice(0,e.indexOf("?token="))),e}function F(e){let t=S(e?.url);"feature"===e.type&&(t=`${t}/${e.layerId??0}`);const n=r.default.findCredential(e.url);return void 0!==n&&(t=`${t}?token=${n.token}`),t}function D(e){const t={url:F(e),name:e.title};if((0,l.i)(e.renderingRule)||(t.renderingRule=e.renderingRule.toJSON()),(0,l.i)(e.definitionExpression))(0,l.i)(e.mosaicRule)||(t.mosaicRule=e.mosaicRule.toJSON?.());else{let n=e.mosaicRule;(0,l.i)(n)||(n=n.clone(),n.where=e.definitionExpression,t.mosaicRule=n.toJSON())}return t}function b(e,t){if((0,l.i)(e?.url)||(0,l.i)(t))return;const n=I(e.url),r=t.find((e=>e.url===n))?.id;return r}async function L(e){if((0,l.i)(e?.url))return;const t=i.clone(e);let n;t.name||(t.name=function(e){const t=e.split("/");return t[t.length-2]}(t.url));try{n=await s.default.fromArcGISServerUrl({url:I(e.url),properties:{renderingRule:e.renderingRule,mosaicRule:e.mosaicRule}}),n.name=e.name}catch(e){}return n}async function x(e){const t=e?.url,n=e?.name;if((0,l.i)(t))return;let r;try{r=await s.default.fromArcGISServerUrl({url:I(t)}),r.name=n}catch(e){console.error("Failed to load feature layer from RFT JSON.")}return r}function w(e){return e?.toLocaleLowerCase().indexOf("f")>=0}function k(e){const t=e&&(e.extent||e.fullExtent);if((0,l.i)(t))return;const{xmin:n,ymin:r,xmax:i,ymax:a,spatialReference:s}=t,{wkid:o,latestWkid:u,wkt:c}=s,f={xmin:n,ymin:r,xmax:i,ymax:a};return(0,l.i)(o)||_(f,"spatialReference.wkid",o),(0,l.i)(u)||_(f,"spatialReference.latestWkid",u),(0,l.i)(c)||_(f,"spatialReference.wkt",c),f}async function U(e){if((0,l.i)(e))return Promise.resolve(void 0);const t=await e.queryFeatures({returnGeometry:!0,where:"1 = 1"});if((0,l.i)(t))return Promise.resolve(void 0);const n=t.features?.map((e=>e?.geometry));return n}function X(e){const t=e?.rasterInfo?.keyProperties?.ChangeAnalysisParameters,n=t?.AnalysisType;return"CCDC"===n}function M(e){return e.filter((e=>function(e){let t=!0;return!1===e.sourceJSON?.allowAnalysis&&(t=!1),(e.portalItem?.typeKeywords?.includes("Hosted Service")??!1)&&(t=!!e.portalItem.isOrgItem||t),t}(e)))}function P(e,t){const n=JSON.stringify(t);return new o.default({url:e,raster:btoa((0,u.t)(n))})}},89920:(e,t,n)=>{n.d(t,{S:()=>u,a:()=>p,b:()=>d,d:()=>f,e:()=>y,f:()=>T,g:()=>A,h:()=>m,i:()=>l,j:()=>c,k:()=>h,l:()=>C,m:()=>v,n:()=>_,p:()=>R,q:()=>N,r:()=>O,s:()=>g,u:()=>E});var r=n(34319),i=n(36676),a=n(77162),s=n(81279),o=n(53248);const u={List:"list",Unit:"linearUnit",Number:"number",Field:"field"};function l(e){const t=!(0,a.i)(e?.isDataset),n=e?.type===a.R;return t&&n}function c(e,t){if((0,a.i)(t))return r.clone(e);const n={};if("object"==typeof e&&null!==e&&!Array.isArray(e)){for(const r in e)e.hasOwnProperty(r)&&t.indexOf(r)<0&&(n[r]=c(e[r],t));return n}return Array.isArray(e)?e.map((e=>c(e,t))):r.clone(e)}function f(e,t){if((0,a.i)(e)||(0,a.i)(t))return;const n=Object.keys(t).find((t=>t.toLowerCase()===e.toLowerCase()));return n?t[n]:void 0}function h(e,t){if(!e)return"";const n=Object.keys(e);return void 0===t&&1===n.length?n[0]:n.find((e=>e.toLowerCase()===t?.toLowerCase()))??""}async function p(e){const t=e?.function?.type?.toLowerCase()?.replace("function",""),n=e?.arguments,r=i.h.rfxNameSpecialCases,s=i.h.localFunctionOperations,o=await(0,i.g)();switch(t){case"local":const e=n?.Operation?.value,i=s.find((t=>t.key===e));if(!(0,a.i)(i))return i.label;if(o.cellStatisticsTypes.some((t=>t.key===e)))return"CellStatistics";break;case"pythonadapter":{const e=n?.ClassName?.value;return e||null}case"gpadapter":{const e=n?.ToolName?.value?.toLowerCase()?.replace("_sa",""),t=r.find((t=>t.key===e));return t?.value||e||null}default:{const e=r.find((e=>e.key===t));return e?.value||t||null}}return null}function d(e){if(e)return e.type===a.b?e:e.value&&e.value.type===a.b?e.value:void 0}function A({schema:e,rfxTemplate:t}){if((0,a.i)(t?.function?.type))return;const n=t.function.type,r=t?.arguments;let i=(0,s.e)(r);return(!i||!e.hasOwnProperty(i)&&e.hasOwnProperty(n))&&(i=n),e[i]}function m(e){if(!e||!e.value)return!1;const t=(e.value.elements?e.value.elements:e.value)[0];return t&&(t.isDataset||t.type===a.b)}function g(e){if(!e||!e[a.A])return!1;if(e.aliases)return!0;const t=e=>{if(!e)return!1;if(e.isPublic)return!0;if(m(e)){const n=e.value&&e.value.elements?e.value.elements:e.value;if(n&&Array.isArray(n))return n.some((e=>t(e)))}const n=d(e);return!!n&&g(n)},n=e[a.A];return(0,a.a)(n)?t(n):Object.keys(n).some((e=>{const r=n[e];if((0,a.a)(r))return t(r)}))}function E(e){if(!e)return!1;const t=e.dataType===i.d.rasterArray,n=Boolean(e.elementInfos),r=e.dataType===i.d.table;return t&&n||r}function y(e,t){return Array.isArray(e)&&e.some((e=>e.toLowerCase()===t.toLowerCase()))}function C(e){if(!e||!e.value)return!1;const t=e.value.elements?e.value.elements:e.value;return!!Array.isArray(t)&&t.some((function(e){return e&&e.type===a.b}))}function T(e){return e?.forEach((e=>{e.key=e.key.toString()})),e}function R(e,t){return e.forEach((e=>{if("field"===e.type){const n=f(e.argumentName,t);e.argumentName=n.name,e.layerArgument=n}else e.type!==i.a.list&&e.type!==i.a.linearUnit||(e.enumStore=T[e.enum])})),e}function v(e,t){let n;const r=f(e.nElementsArgument,t),i=r?.value,a=e.elementInfos;return void 0!==r&&void 0!==i||1!==a.length?(Array.isArray(a)&&a.some((e=>{const t=e.values;if(Array.isArray(t)&&t.indexOf(i)>-1)return n=e.inputArgs,!0})),n):a[0].inputArgs}function _(e){let t=!1;const n=e[a.A];if((0,a.a)(n))return!0;for(const e in n)if(e!==a.T&&(r=n[e])&&(d(r)||C(r)))return t=!0,t;var r;return t}function N({functionSchema:e,rfxTemplate:t}){if(!t)return;const n=[],i=t.arguments,s=i&&i.type;if(function({functionSchema:e,rfxTemplate:t}){const n=e;let r;if(n&&(r=n.rasterFunctionArguments,1===Object.keys(r).length&&!n.hasArgumentsObject))return!0;const i=t.arguments,a=i&&i.type;return!(!a||a!==o.J.RASTER_FUNCTION_TEMPLATE&&a!==o.J.RASTER_FUNCTION_VARIABLE)||void 0}({functionSchema:e,rfxTemplate:t})){const e=r.clone(i);let t;return t=s===o.J.RASTER_FUNCTION_TEMPLATE||e.isDataset?"Raster":"Rasters",n.push({...e,key:t}),n}return Object.keys(i).forEach((e=>{if(e===o.M.MATCH_VARIABLE||e===o.M.UNION_DIMENSION)return;const t=r.clone(i[e]);(0,a.a)(t)&&n.push({...t,key:e})})),n}function O(e,t){const n=t&&t.value;if(null==n)return;let r;return e.some((e=>{if(e.values&&e.values.indexOf(n)>-1)return r=e.inputArgs,!0})),r}},5976:(e,t,n)=>{n.r(t),n.d(t,{rfx_cte_detect_change_type_picker:()=>f});var r=n(19451),i=n(81279),a=n(64729),s=n(77162),o=n(89920),u=n(5660),l=(n(99248),n(16888),n(95323),n(43278),n(34751));n(86944),n(83345),n(74656);const c="changeTypeHelpClickHandler",f=class{constructor(e){(0,r.r)(this,e),this.rfxArgumentChange=(0,r.c)(this,"rfxArgumentChange",7),this.alteredStateEnum=["0","1","2","3"],this.helpActionClickEventHandlers=new Map,this.handleInputChange=e=>{e.stopPropagation();const t=e.target,n=(0,l.p)(t.value);this.inputArg.value=n,this.value=n,this.rfxArgumentChange.emit({value:n})},this.value=void 0,this.widgetArgs=void 0,this.store=[]}connectedCallback(){this.processWidgetArgs(this.widgetArgs)}async componentWillLoad(){await this.setupInitialState(this.widgetArgs)}componentDidLoad(){this.attachHelpClickEventHandlers()}processWidgetArgs({inputArgs:e,triggerArgs:t}){const n=e.ChangeType;this.inputArg=n,n.input=this.hostElement,this.value=n.value;const r=t.Raster;this.rasterArg=r,r.input?.addEventListener("rfxArgumentChange",this.handleRasterChange.bind(this))}async setupInitialState({rfxArgs:e,rasterFunctions:t,triggerArgs:n}){this.value=this.inputArg.value;const r=t[(0,i.e)(e)],a=r?.rasterFunctionArguments,l=this.inputArg.name;this.value=this.inputArg.value;const c=a?.[l]?.domain;if("list"===c?.type){const e=c.enum;this.store=(0,o.j)(e)}else console.error("Invalid inputArg! Check Schema");this.store?.forEach((e=>{e.key=e.key.toString()})),this.initialStore=(0,o.j)(this.store),(0,s.i)(this.store)&&console.error("Domain list Enum not set! Check Schema");const f=n.Raster,h=f?.input,p=await(h?.getSelectedLayer?.());(0,u.l)(p)?this.handleIsChangeAnalysisTypeCCDC():this.handleIsChangeAnalysisTypeNotCCDC(),this.rfxArgumentChange.emit({value:this.value})}attachHelpClickEventHandlers(){const e=this.widgetArgs.onHelpActionClick({heading:this.inputArg.displayName,referenceElement:this.widgetContainer,helpTextID:this.widgetArgs.helpTextIDs?.detectchange_changetype});this.helpActionClickEventHandlers.set(c,e)}async handleRasterChange(){const e=this.rasterArg?.input,t=await(e?.getSelectedLayer?.());(0,u.l)(t)?this.handleIsChangeAnalysisTypeCCDC():this.handleIsChangeAnalysisTypeNotCCDC(),this.rfxArgumentChange.emit({value:this.value})}handleIsChangeAnalysisTypeCCDC(){this.widgetArgs.inputArgs.changeAnalysisType.value="CCDC",this.applyFilterToStore(this.alteredStateEnum)}handleIsChangeAnalysisTypeNotCCDC(){this.widgetArgs.inputArgs.changeAnalysisType.value="",this.resetStore()}applyFilterToStore(e){const t=((e,t)=>e.filter((e=>t.some((t=>e.key===t)))))(this.initialStore,e);this.store=t}resetStore(){this.store=this.initialStore}render(){return(0,r.h)("div",null,(0,r.h)("calcite-label",{alignment:"start",scale:a.U.Scale,layout:"default",ref:e=>{this.widgetContainer=e}},(0,r.h)("rfx-label",{label:this.inputArg.displayName,onRfxLabelHelpActionClick:()=>this.helpActionClickEventHandlers?.get(c)()}),(0,r.h)("rfx-dtex-common-select",{options:this.store,value:String(this.value),onRfxArgumentChange:this.handleInputChange})))}get hostElement(){return(0,r.a)(this)}};n(34319),n(36676),n(48302),n(48363),n(53248),n(46574),n(46717),n(55139),n(57098),n(78979),n(95876),n(32804)},34751:(e,t,n)=>{n.d(t,{a:()=>l,f:()=>u,i:()=>a,p:()=>o,s:()=>s});var r=n(48302),i=n(77162);function a(e){return null!=e&&!1===Number.isNaN(e)&&!0===Number.isFinite(e)}function s(e,t){let n;if(null!==e){const r="string"==typeof e?Number.parseFloat(e):e;a(r)?n=r:a(t)&&(n=t)}return void 0===n?"":`${n}`}function o(e){if(""!==e)return Number.parseFloat(e)}function u(e,t=3){if(!(0,i.i)(e))return Number.parseFloat(e.toFixed(t))}function l(e,t){let n="";if(!(0,i.i)(e)&&!Number.isNaN(e)){const i=(0,r.g)().locale;n=Intl.NumberFormat(i,t).format(Number(e))}return n}},64729:(e,t,n)=>{n.d(t,{C:()=>i,U:()=>r,a:()=>a});const r={Scale:"s",PopoverTimer:60},i={s:"s",m:"m"},a={absolute:"absolute",fixed:"fixed"}}}]);