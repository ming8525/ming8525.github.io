/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81f2ea.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81f2ea"],{24347:(e,t,s)=>{s.r(t),s.d(t,{arcgis_smart_mapping_panels_raster_class_breaks:()=>m,arcgis_smart_mapping_panels_raster_colormap:()=>g,arcgis_smart_mapping_panels_raster_flow:()=>b,arcgis_smart_mapping_panels_raster_rgb:()=>y,arcgis_smart_mapping_panels_raster_shaded_relief:()=>k,arcgis_smart_mapping_panels_raster_stretch:()=>I,arcgis_smart_mapping_panels_raster_unique_value:()=>x,arcgis_smart_mapping_panels_raster_vector_field:()=>E});var a=s(81149),n=s(9225),l=s(5996),r=(s(69283),s(49306),s(63723)),i=s(92656),o=s(89),c=s(3164),d=s(51837),h=s(36238),u=s(14221),p=s(69135);s(82218),s(42577),s(70464),s(10519),s(7659);const m=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterClassBreaksClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksClose",7),this.arcgisSmartMappingPanelsRasterClassBreaksBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksBackClick",7),this.arcgisSmartMappingPanelsRasterClassBreaksError=(0,a.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksError",7),this.symbolNodes=[],this.labelNodes=[],this.inputNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,s=t;(0,r.a)(e,s),this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t}=n.s,s=e,a=s.renderer;this.originalRendererObj=t.esriLang.clone(s.renderer),this.defaultColorRamp=a.classBreakInfos.map((e=>e.symbol.color))}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.classBreaks.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterClassBreaksBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"class-breaks-block",heading:e.panels.classBreaks.classBreaks,open:!0},this.renderFieldSelector(),this.renderMethod(),this.renderClasses(),this.renderDefinedInterval(),this.renderColorScheme(),this.renderColorSlider(),this.renderValues())}renderFieldSelector(){var e;const{layer:t,strings:s}=n.s,l=t.renderer.field||s.panels.classBreaks.value,r=(0,c.g)(),i=r.map((e=>({label:e.alias,layerField:e,simpleFieldType:n.w.STRING}))),o=r.find((e=>e.name===l));return(0,a.h)("arcgis-smart-mapping-attribute-input",{label:s.panels.classBreaks.field,fieldList:i,selectedField:{field:null!==(e=null==o?void 0:o.name)&&void 0!==e?e:s.panels.classBreaks.value,simpleFieldType:n.w.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderMethod(){const{layer:e}=n.s,t=e,s=t.renderer;return(0,a.h)("arcgis-smart-mapping-method-button",{key:s.authoringInfo.classificationMethod,showDefinedInterval:!0,onArcgisSmartMappingMethodButtonBeforeOpen:()=>(0,n.E)(),onArcgisSmartMappingMethodButtonChange:e=>{var s,r;const i=t.renderer;if("manual"===e.detail)i.authoringInfo.classificationMethod="manual",(0,n.ab)(),(0,a.f)(this.hostElement),setTimeout((()=>this.methodButtonNode.setFocus()),300);else{let t,n=(null===(s=null==i?void 0:i.authoringInfo)||void 0===s?void 0:s.numClasses)||(null===(r=i.classBreakInfos)||void 0===r?void 0:r.length);if("defined-interval"===e.detail){const e=i.classBreakInfos;t=(e[e.length-1].maxValue-e[0].minValue)/5,n=Math.ceil((i.classBreakInfos[n-1].maxValue-i.classBreakInfos[0].minValue)/t)}(0,l.r)((0,c.b)({classificationMethod:e.detail,numClasses:n,definedInterval:t}),this.flowItemNode).then((e=>{this.updateRenderer(e.renderer),(0,a.f)(this.hostElement),setTimeout((()=>this.methodButtonNode.setFocus()),300)}),(e=>{(0,a.f)(this.methodButtonNode),this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}},ref:e=>{e&&(this.methodButtonNode=e)}})}renderClasses(){const{layer:e,strings:t}=n.s,s=e.renderer,l=s.classBreakInfos.length,r=s.authoringInfo.classificationMethod;return(0,a.h)("calcite-label",null,t.panels.classBreaks.classifyClasses,(0,a.h)("calcite-input-number",{tabindex:"0",value:`${l}`,disabled:"defined-interval"===r,min:1,max:10,step:1,scale:"s",onCalciteInputNumberInput:(0,h.d)((()=>{const e=parseInt(this.classesNode.value);e!==l&&(!e||e<this.classesNode.min||e>this.classesNode.max?this.classesChangeHandle=setTimeout((()=>this.handleClassesChange()),3e3):(clearTimeout(this.classesChangeHandle),this.handleClassesChange()))}),300),ref:e=>{e&&(this.classesNode=e)}}))}renderDefinedInterval(){const{layer:e,strings:t}=n.s,s=e.renderer;if("defined-interval"!==s.authoringInfo.classificationMethod)return null;const l=s.classBreakInfos[0].maxValue-s.classBreakInfos[0].minValue,r=Math.floor((s.classBreakInfos[s.classBreakInfos.length-1].maxValue-s.classBreakInfos[0].minValue)/9.1),i=s.classBreakInfos[s.classBreakInfos.length-1].maxValue-s.classBreakInfos[0].minValue;return(0,a.h)("calcite-label",null,t.panels.classBreaks.definedInterval,(0,a.h)("calcite-input-number",{tabIndex:0,value:""+Math.round(100*l)/100,min:r,max:i,step:.1,scale:"s",onCalciteInputNumberInput:e=>{const t=e.target,s=parseFloat(t.value);!t.value||s<t.min||s>t.max?this.definedIntervalChangeHandle=setTimeout((()=>this.handleDefinedIntervalChange()),3e3):(clearTimeout(this.definedIntervalChangeHandle),this.handleDefinedIntervalChange())},ref:e=>this.definedIntervalNode=e}))}renderColorScheme(){const{layer:e,strings:t}=n.s,s=e,l=s.renderer.classBreakInfos.map((e=>(0,n.t)(e.symbol)));return(0,a.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.classBreaks.colorScheme,type:"raster-class-breaks",rampType:"discrete",colors:l,onArcgisSmartMappingSymbolButtonSymbolChange:e=>{const t=e.target,l=s.renderer;this.defaultColorRamp=l.classBreakInfos.map((e=>e.symbol.color)),(0,n.ab)(),(0,a.f)(this.hostElement),(0,a.f)(this.sliderNode),(0,a.f)(t)},ref:e=>this.symbolButtonNode=e})}renderColorSlider(){const{layer:e}=n.s,t=e;return(0,a.h)("arcgis-smart-mapping-class-breaks-color-slider",{onArcgisSmartMappingClassBreaksColorSliderChange:e=>{const s=t.renderer,n=e.detail;(null==n?void 0:n.updateValues)&&(s.authoringInfo.classificationMethod="manual"),(null==n?void 0:n.invertColors)&&(0,a.f)(this.symbolButtonNode),(0,a.f)(this.hostElement),(0,a.f)(this.sliderNode),this.defaultColorRamp=s.classBreakInfos.map((e=>e.symbol.color))},ref:e=>this.sliderNode=e})}renderValues(){const{layer:e}=n.s,t=e.renderer;return this.labelNodes=[],this.inputNodes=[],(0,a.h)("calcite-list",null,t.classBreakInfos.map(((e,t)=>this.renderValue(e,t))).reverse())}renderValue(e,t){return(0,a.h)("calcite-list-item",null,(0,a.h)("div",{class:"symbol-container",slot:"actions-start"},this.renderSymbolNode(e,t)),this.renderTextNode(e,t))}renderSymbolNode(e,t){const{layer:s,strings:l}=n.s;let r=s.renderer.classBreakInfos[t].symbol.clone();const i={"symbol-is-white":(0,n.aq)(r),symbol:!0};return(0,a.h)("div",{class:i,tabindex:"0","aria-label":l.panels.classBreaks.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&this.symbolNodes.unshift(e)},onClick:()=>{this.popoverNode?(this.symbolNodes[this.selectedPopoverIdx].classList.remove("selected"),this.selectedPopoverIdx===t?((0,n.E)(),this.popoverNode=null,this.selectedPopoverIdx=null):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleValueSymbolClick(t))}},(0,a.h)("div",{ref:e=>{e&&this.afterCreateValueSymbol(e,t)}}))}renderTextNode(e,t){const{strings:s}=n.s;return(0,a.h)(a.F,null,(0,a.h)("div",{class:"label",slot:"content",tabindex:"0",ref:e=>{e&&this.labelNodes.unshift(e)},"aria-label":s.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{let s=this.inputNodes[t];s.classList.remove("hidden"),s.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){let s=this.inputNodes[t];s.classList.remove("hidden"),s.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,a.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",tabindex:"0",ref:e=>{e&&this.inputNodes.unshift(e)},value:e.label,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:s=>{if("Escape"===s.key||"Enter"===s.key){this.inputNodes[t].classList.add("hidden");const a=s.currentTarget;a.value=e.label||"",a.disabled=!0,this.handleValueTextChange(t,s),this.labelNodes[t].classList.remove("hidden"),a.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){const{layer:t}=n.s,s=t.renderer;(0,l.r)((0,c.b)({field:e}),this.flowItemNode).then((e=>this.updateRenderer(e.renderer)),(e=>{this.fieldNode.value=s.field,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}handleDefinedIntervalChange(){const{layer:e}=n.s,t=e.renderer,s=t.classBreakInfos[0].maxValue-t.classBreakInfos[0].minValue;let a=parseFloat(this.definedIntervalNode.value);a!==s&&(isNaN(a)||a<this.definedIntervalNode.min?a=this.definedIntervalNode.min:a>this.definedIntervalNode.max&&(a=this.definedIntervalNode.max),a=parseFloat(a.toFixed(2)),this.definedIntervalNode.value=`${a}`,(0,l.r)((0,c.b)({definedInterval:a}),this.flowItemNode).then((e=>this.updateRenderer(e.renderer)),(e=>{this.definedIntervalNode.value=`${s}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)})))}handleClassesChange(){(0,n.E)();const{layer:e}=n.s,t=e.renderer,s=t.classBreakInfos.length,{authoringInfo:a}=t||{};a.numClasses=this.classesNode.value?Number.parseInt(this.classesNode.value,10):0,"manual"===a.classificationMethod&&(a.classificationMethod="equal-interval");const r=Math.min(Math.max(parseInt(this.classesNode.value),1),10)||5;`${r}`!==this.classesNode.value&&(this.classesNode.value=`${r}`),(0,l.r)((0,c.b)({numClasses:r}),this.flowItemNode).then((e=>this.updateRenderer(e.renderer)),(e=>{this.classesNode.value=`${s}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}afterCreateValueSymbol(e,t){var s;const{layer:a,modules:l}=n.s;let r=a.renderer.classBreakInfos[t].symbol.clone();for(-1===t&&r.outline&&(r.outline.width=0),(0,n.aq)(r)&&(r.outline=new l.SimpleLineSymbol({color:"#bdc3c7",width:.75}));null===(s=null==e?void 0:e.childNodes)||void 0===s?void 0:s.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:i}=l;r&&i.renderPreviewHTML(r,{size:(0,n.ar)(r),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>null==e?void 0:e.appendChild(t)))}handleValueSymbolClick(e){(0,n.E)();const{strings:t}=n.s,s=(0,o.c)({referenceElement:this.flowItemNode,heading:t.panels.classBreaks.colorScheme});s.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,o.r)(s),setTimeout((()=>{this.symbolNodes[e].focus(),this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),s.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,o.r)(s),setTimeout((()=>{this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),n.s.classedSymbolSelectedIdx=e,(0,i.b)({popoverNode:s,onChange:()=>{(0,n.ab)(),(0,a.f)(this.hostElement),(0,a.f)(this.sliderNode)}}),this.popoverNode=s,this.symbolNodes[e].classList.add("selected")}handleValueTextChange(e,t){const{layer:s}=n.s,l=s.renderer,r=t.currentTarget;if(l.classBreakInfos[e].label=r.value,""===r.value){const t=l.classBreakInfos[e];t.label=`${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`,this.inputNodes[e].value=this.labelNodes[e].textContent}(0,n.ab)(),(0,a.f)(this.hostElement)}handleInversionStatus(e){const{modules:t}=n.s;if(JSON.stringify(this.defaultColorRamp[0])!==JSON.stringify(e.classBreakInfos[0].symbol.color)){let s=e.classBreakInfos.map((e=>(0,n.t)(e.symbol)||new t.esriColor({r:64,g:64,b:64,a:1})));s=s.reverse(),e.classBreakInfos.map(((e,t)=>{(0,n.t)(e.symbol)&&(0,n.r)(e.symbol,s[t])}))}else this.defaultColorRamp=e.classBreakInfos.map((e=>e.symbol.color))}updateRenderer(e){const{layer:t}=n.s,s=t;this.handleInversionStatus(e),(0,r.a)(e,s),(0,n.ab)(),(0,a.f)(this.hostElement),(0,a.f)(this.sliderNode)}get hostElement(){return(0,a.d)(this)}};m.style=":host{width:100%}.flow-item{height:100%}.class-breaks-block{overflow-x:hidden;overflow-wrap:anywhere}.hidden{display:none}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.label,.symbol-container{padding-top:5px;padding-bottom:5px}.selected{outline:1px solid var(--calcite-color-brand)}";const g=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterColormapClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterColormapClose",7),this.arcgisSmartMappingPanelsRasterColormapBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterColormapBackClick",7),this.inputNodes=[],this.labelNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterColormapClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,s=t;(0,r.a)(e,s),this.arcgisSmartMappingPanelsRasterColormapClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t}=n.s,s=e,a=s.renderer;this.originalRendererObj=t.esriLang.clone(s.renderer),a.colormapInfos.forEach(((e,t)=>{e.label||(a.colormapInfos[t].label=" ")})),(0,n.ab)()}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.colormap.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterColormapBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"colormap-block",heading:e.panels.colormap.colormap,open:!0},this.renderColormapTable())}renderColormapTable(){const{layer:e,strings:t}=n.s,s=e.renderer;this.labelNodes=[],this.inputNodes=[];const l=s.colormapInfos.map(((e,t)=>this.renderColormapRow(e,t)));return(0,a.h)("calcite-table",{class:"table",caption:t.panels.colormap.colormapTable},(0,a.h)("calcite-table-row",{slot:"table-header"},(0,a.h)("calcite-table-header",{heading:t.panels.colormap.color,alignment:"center"}),(0,a.h)("calcite-table-header",{heading:t.panels.colormap.value,alignment:"center"}),(0,a.h)("calcite-table-header",{heading:t.panels.colormap.label,alignment:"center"})),l)}renderColormapRow(e,t){return(0,a.h)("calcite-table-row",null,(0,a.h)("calcite-table-cell",{alignment:"center"},this.renderColorNode(e)),(0,a.h)("calcite-table-cell",{alignment:"center"},e.value),(0,a.h)("calcite-table-cell",{alignment:"center"},this.renderLabelNode(e,t)))}renderColorNode(e){return(0,a.h)("div",{class:"color",ref:t=>{t&&this.afterCreateColor(t,e)}})}renderLabelNode(e,t){const{strings:s}=n.s;return(0,a.h)(a.F,null,(0,a.h)("div",{class:"label",tabindex:"0",ref:e=>{e&&(this.labelNodes[t]=e)},"aria-label":s.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{let s=this.inputNodes[t];s.classList.remove("hidden"),s.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){let s=this.inputNodes[t];s.classList.remove("hidden"),s.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,a.h)("calcite-input",{class:"hidden",tabindex:"0",ref:e=>{e&&(this.inputNodes[t]=e)},value:e.label,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:s=>{if("Escape"===s.key||"Enter"===s.key){this.inputNodes[t].classList.add("hidden");const a=s.currentTarget;a.value=e.label||"",a.disabled=!0,this.handleValueTextChange(t,s),this.labelNodes[t].classList.remove("hidden"),a.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}afterCreateColor(e,t){var s;const{modules:a}=n.s;for(;null===(s=null==e?void 0:e.childNodes)||void 0===s?void 0:s.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:l}=a,r=l.renderColorRampPreviewHTML([t.color.clone()],{gradient:!1,width:20,height:20});r.classList.add("colorblock"),e.appendChild(r)}handleValueTextChange(e,t){const{layer:s}=n.s,l=s.renderer,r=t.currentTarget;""===r.value?this.inputNodes[e].value=this.labelNodes[e].textContent:l.colormapInfos[e].label=r.value,(0,n.ab)(),(0,a.f)(this.hostElement)}get hostElement(){return(0,a.d)(this)}};g.style=":host{width:100%}.flow-item{height:100%}.colormap-block{overflow-x:hidden}.table{width:100%;overflow-wrap:anywhere}.color{display:flex;justify-content:center}.colorblock{border:1px solid #000}.hidden{display:none}.label{padding-top:5px;padding-bottom:5px}.label:focus{outline:2px solid var(--calcite-color-brand)}";const b=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterFlowClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterFlowClose",7),this.arcgisSmartMappingPanelsRasterFlowBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterFlowBackClick",7),this.arcgisSmartMappingPanelsRasterFlowError=(0,a.c)(this,"arcgisSmartMappingPanelsRasterFlowError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterFlowClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t}=this,{layer:s}=n.s,a=s;a.effect=t,(0,r.a)(e,a),this.arcgisSmartMappingPanelsRasterFlowClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e}=n.s,t=e;this.originalRendererObj=t.renderer,this.originalEffect=t.effect}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.flow.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterFlowBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"flow-block",heading:e.panels.flow.flowStyle,open:!0},this.renderMode(),this.renderSpeed(),this.renderDensity(),this.renderLength(),this.renderWidth(),this.renderColor(),this.renderColorSlider(),this.renderDirection(),this.renderRoundCaps(),this.renderShowInLegend(),this.renderEffects())}renderMode(){const{layer:e,strings:t}=n.s,s=e.renderer,l=s.authoringInfo,r=(null==l?void 0:l.flowTheme)?"wave-front"===(null==l?void 0:l.flowTheme):s.trailLength<1;return(0,a.h)("div",{class:"block-content-padding-large"},(0,a.h)("calcite-chip",{value:"flowline",appearance:r?"outline-fill":"solid",kind:r?"neutral":"brand",class:r?"mode-hover":"",scale:"s",onClick:()=>this.handleModeChange("flowline")},t.panels.flow.flowline),(0,a.h)("span",null," "),(0,a.h)("calcite-chip",{value:"wavefront",appearance:r?"solid":"outline-fill",kind:r?"brand":"neutral",class:r?"":"mode-hover",scale:"s",onClick:()=>this.handleModeChange("wavefront")},t.panels.flow.wavefront))}renderSpeed(){const{layer:e,strings:t}=n.s,s=e.renderer,l="wave-front"===s.authoringInfo.flowTheme,{flowSpeed:r}=s;return(0,a.h)("calcite-label",null,t.panels.flow.speed,(0,a.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"speed",min:0,max:l?20:40,values:[r],precision:1,minLabel:t.panels.flow.slow,maxLabel:t.panels.flow.fast}))}renderDensity(){const{layer:e,strings:t}=n.s,s=e.renderer,{density:l}=s;return(0,a.h)("calcite-label",null,t.panels.flow.density,(0,a.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"density",min:.1,max:1,values:[l],precision:1,minLabel:t.panels.flow.low,maxLabel:t.panels.flow.high}))}renderLength(){const{layer:e,strings:t}=n.s,s=e.renderer,l="wave-front"===s.authoringInfo.flowTheme,{trailLength:r}=s;return(0,a.h)("calcite-label",null,t.panels.flow.length,(0,a.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"trail-length",min:l?.1:1,max:l?50:200,values:[r/.75],precision:l?1:0,minLabel:t.panels.flow.short,maxLabel:t.panels.flow.long}))}renderWidth(){const{layer:e,strings:t}=n.s,s=e,l=s.renderer,r="wave-front"===l.authoringInfo.flowTheme,{trailWidth:i}=l,o=Math.round(i/.75*10)/10;return(0,a.h)("div",{class:"block-content-padding-large"},(0,a.h)("calcite-label",null,t.panels.flow.width),(0,a.h)("arcgis-smart-mapping-slider-input",{min:r?Math.min(5,Math.floor(o)):.1,max:r?Math.max(12,Math.ceil(o)):Math.max(5,Math.ceil(o)),values:[o],precision:1,suffixText:t.panels.flow.px,onArcgisSmartMappingSliderInputChange:e=>{const t=s.renderer,a=e.detail,{trailWidth:l}=t;a!==Math.round(l/.75*10)/10&&(t.trailWidth=.75*a,(0,n.ab)())}}))}renderColor(){const{layer:e,strings:t}=n.s,s=e.renderer,l=(0,n.a)(s,"color");return(0,a.h)("calcite-radio-button-group",{class:"block-content-padding",name:"colorType",layout:"vertical",onCalciteRadioButtonGroupChange:e=>this.handleColorTypeChange(e.target.selectedItem.value)},(0,a.h)("div",null,(0,a.h)("calcite-label",{layout:"inline"},(0,a.h)("calcite-radio-button",{checked:!l,value:"singleColor",ref:e=>this.singleColorNode=e}),t.panels.flow.singleColor),!l&&this.renderSingleColor()),(0,a.h)("div",null,(0,a.h)("calcite-label",{layout:"inline"},(0,a.h)("calcite-radio-button",{checked:!!l,value:"colorRamp",ref:e=>this.colorRampNode=e}),t.panels.flow.colorRamp),l&&this.renderColorRamp()))}renderSingleColor(){const{layer:e}=n.s,t=e.renderer,{color:s}=t,l=(0,n.aj)();return l.color=s,l.outline.color=s,(0,a.h)("div",{class:"symbol-button-padding"},(0,a.h)("arcgis-smart-mapping-symbol-button",{symbol:l,hideLabel:!0,type:"raster-flow",rampType:"continuous",onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,a.f)(this.hostElement)}}))}renderColorRamp(){const{layer:e}=n.s,t=e.renderer,s=(0,n.a)(t,"color");if(!s)return;const l=s.stops.map((e=>{const t=e.color.clone();return t.a=1,t}));return(0,a.h)("div",{class:"symbol-button-padding"},(0,a.h)("arcgis-smart-mapping-symbol-button",{colors:l,hideLabel:!0,type:"raster-flow",rampType:"continuous",ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,a.f)(this.hostElement),this.flowColorSliderNode&&(0,a.f)(this.flowColorSliderNode)}}))}renderColorSlider(){const{layer:e}=n.s,t=e.renderer;return(0,n.a)(t,"color")?(0,a.h)("arcgis-smart-mapping-flow-color-slider",{ref:e=>{e&&(this.flowColorSliderNode=e)},onArcgisSmartMappingFlowColorSliderChange:()=>{(0,a.f)(this.hostElement),this.symbolButtonNode&&(0,a.f)(this.symbolButtonNode)},onArcgisSmartMappingFlowColorSliderError:e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e.detail)}):null}renderDirection(){const{layer:e,strings:t}=n.s,s=e.renderer,{flowRepresentation:l}=s;return(0,a.h)("calcite-label",{layout:"inline-space-between",class:"block-content-padding"},t.panels.flow.flowDirection,(0,a.h)("calcite-segmented-control",{layout:"horizontal",appearance:"solid",onCalciteSegmentedControlChange:e=>this.handleDirectionChange(e.target.selectedItem.value)},(0,a.h)("calcite-segmented-control-item",{value:"to",checked:"flow-from"!==l},t.panels.flow.to),(0,a.h)("calcite-segmented-control-item",{value:"from",checked:"flow-from"===l},t.panels.flow.from)))}renderRoundCaps(){const{layer:e,strings:t}=n.s,s=e.renderer,{trailWidth:l,authoringInfo:r}=s,i="flow-line"===r.flowTheme,o="round"===s.trailCap,c=Math.round(1e3*l)/1e3>3;return(0,a.h)("div",{class:"toggles block-content-padding"},(0,a.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},t.panels.flow.roundEndCaps,(0,a.h)("calcite-switch",{ref:e=>{e&&(this.roundCapToggleNode=e)},disabled:!c,scale:"s",checked:o,onCalciteSwitchChange:()=>this.handleRoundCapsToggle()})),i?(0,a.h)("div",{class:"hint-text "+(c?"":"disabled")},t.panels.flow.forWideLines):null)}renderShowInLegend(){const{layer:e,strings:t}=n.s,s=e.renderer,l=(0,n.a)(s,"color");if(!l)return null;const r=l.legendOptions,i=!r||!1!==r.showLegend;return(0,a.h)("calcite-label",{layout:"inline-space-between",class:"toggle-text toggles block-content-padding"},t.panels.flow.includeInLegend,(0,a.h)("calcite-switch",{scale:"s",checked:i,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderEffects(){const{layer:e,strings:t}=n.s,s=e;return(0,a.h)("div",{class:"toggles block-content-padding"},(0,a.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},t.panels.flow.layerEffects,(0,a.h)("calcite-switch",{scale:"s",checked:!!s.effect,onCalciteSwitchChange:()=>this.handleEffectToggle()})),(0,a.h)("div",{class:"hint-text"},t.panels.flow.adjustEffects))}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleModeChange(e){const{layer:t}=n.s,s=t,r=s.renderer.authoringInfo,i="wave-front"===r.flowTheme,o="wave-front"===r.flowTheme?"flow-line":"wave-front";(!i&&"wavefront"===e||i&&"flowline"===e)&&((0,n.E)(),(0,l.r)((0,u.a)({flowTheme:o}),this.flowItemNode).then((e=>{s.renderer=e.renderer.clone(),this.roundCapToggleNode.checked=!1,(0,a.f)(this.hostElement)}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e))))}handleColorTypeChange(e){(0,n.E)();const{layer:t}=n.s,s=t,r={includeColorVariable:"colorRamp"===e};"colorRamp"!==e?this.lastFlowTheme=(0,u.f)():this.lastFlowTheme&&(r.flowScheme=this.lastFlowTheme),(0,l.r)((0,u.a)(r),this.flowItemNode).then((e=>{s.renderer=e.renderer.clone(),(0,n.ab)(),(0,a.f)(this.hostElement)}),(e=>{this.singleColorNode.checked?(this.singleColorNode.checked=!1,this.colorRampNode.checked=!0):(this.colorRampNode.checked=!1,this.singleColorNode.checked=!0),this.arcgisSmartMappingPanelsRasterFlowError.emit(e)}))}handleDirectionChange(e){const{layer:t}=n.s;t.renderer.flowRepresentation="from"===e?"flow-from":"flow-to",(0,n.ab)()}handleRoundCapsToggle(){const{layer:e}=n.s,t=e.renderer;t.trailCap="round"===t.trailCap?"butt":"round",(0,n.ab)()}handleIncludeInLegendToggle(){const{layer:e}=n.s,t=e.renderer,s=(0,n.a)(t,"color"),a=s.legendOptions;a&&!1===a.showLegend?a.title?a.showLegend=!0:s.legendOptions=void 0:(s.legendOptions=a||{},s.legendOptions.showLegend=!1),(0,n.ab)()}handleEffectToggle(){const{layer:e}=n.s,t=e,s=t.renderer;if(t.effect)t.effect=void 0;else{const e=s.authoringInfo;(0,u.c)({flowTheme:e.flowTheme}).then((e=>{t.effect=e.layerEffect,(0,n.ab)()}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e)))}}get hostElement(){return(0,a.d)(this)}};var f;b.style=":host{width:100%}.flow-item{height:100%}.flow-block{overflow-x:hidden}.block-content-padding{padding-bottom:10px}.block-content-padding-large{padding-bottom:20px}.symbol-button-padding{padding-bottom:12px}.mode-hover{cursor:pointer}.toggles{padding-top:10px}.toggle-text{width:100%}.hint-text{font-size:smaller;margin-top:-8px}.hint-text.disabled{opacity:0.5}",function(e){e[e.ALL=-1]="ALL",e[e.RED=0]="RED",e[e.GREEN=1]="GREEN",e[e.BLUE=2]="BLUE"}(f||(f={}));const v={min:0,max:65535,avg:0,stddev:0},y=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterRgbClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterRgbClose",7),this.arcgisSmartMappingPanelsRasterRgbBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterRgbBackClick",7),this.arcgisSmartMappingPanelsRasterRgbError=(0,a.c)(this,"arcgisSmartMappingPanelsRasterRgbError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterRgbClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:s,originalStatistics:a}=this,{layer:l}=n.s,i=l;i.effect=t,i.bandIds=s,i.rasterInfo.statistics=a,(0,r.a)(e,i),this.arcgisSmartMappingPanelsRasterRgbClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){var e,t;const{layer:s,modules:a}=n.s,l=s,{statistics:r}=l.rasterInfo;l.bandIds||(l.bandIds=await(0,n.as)(l)),this.originalRendererObj=a.esriLang.clone(l.renderer),this.originalEffect=l.effect,this.originalBandCombination=l.bandIds,this.originalStatistics=null!==(e=a.esriLang.clone(r))&&void 0!==e?e:[],this.currentStatistics=null!==(t=a.esriLang.clone(r))&&void 0!==t?t:[];const i=l.renderer;(0,n.ac)(r)||(0,n.ac)(i.statistics[0])||(i.statistics=new Array(3).fill(v),this.currentStatistics=a.esriLang.clone(i.statistics)),!Array.isArray(i.statistics)||i.statistics.length||i.dynamicRangeAdjustment||(i.statistics=l.bandIds.map((e=>this.originalStatistics[e]))),this.rendererStatisticsSelection=l.bandIds[0],this.changeIndividualGamma=!1,this.percentLabelFlip=(0,n.at)(this.hostElement)}componentDidLoad(){const{layer:e}=n.s,t=e.renderer;t.dynamicRangeAdjustment||this.updateStatisticsDisplay(t.statistics[0]),requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.rgb.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterRgbBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"rgb-block",heading:e.panels.rgb.rgb,open:!0},this.renderRgbBandSelectors(),this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderGammaBlock(),this.renderIndividualGammaToggle(),this.renderRangeAdjustmentToggle(),this.renderStatistics())}renderRgbBandSelectors(){const{layer:e,strings:t}=n.s,s=e,{rasterInfo:l}=s,{bandInfos:r}=l,i=r.map((e=>e.name)),{red:o,green:c,blue:d}=t.panels.rgb,h=[o,c,d].map(((e,t)=>(0,a.h)("calcite-label",null,e,(0,a.h)("calcite-combobox",{label:e,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:a=>{const l=a.target,r=s.renderer;s.bandIds[t]=i.indexOf(l.value);const o=s.bandIds[t];r.statistics[t]=this.currentStatistics[o],this.statisticsControlNode&&e===this.statisticsControlNode.value&&(this.rendererStatisticsSelection=o,this.updateStatisticsDisplay(r.statistics[t])),(0,n.ab)()}},i.map(((e,s)=>this.renderBandOptions(e,s,t)))))));return(0,a.h)(a.F,null,h)}renderBandOptions(e,t,s){const{layer:l}=n.s,r=l.bandIds[s];return(0,a.h)("calcite-combobox-item",{textLabel:e,value:e,selected:r===t})}renderStretchTypeSelector(){const{layer:e}=n.s,t=e;return(0,a.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,n.E)(),onArcgisSmartMappingStretchTypeButtonChange:e=>{const s=e.target;(0,l.r)((0,n.au)({stretchType:e.detail}),this.flowItemNode).then((l=>{"none"===e.detail&&(l.renderer.dynamicRangeAdjustment=!1),this.rendererStatisticsSelection=t.bandIds[0],(0,r.a)(l.renderer,t),(0,n.ab)(),(0,a.f)(this.hostElement),(0,a.f)(s)}),(e=>this.arcgisSmartMappingPanelsRasterRgbError.emit(e)))}})}renderStandardDeviationSection(){const{layer:e,strings:t}=n.s,s=e.renderer,{stretchType:l=n.aw.STRETCH_TYPE}=s||{};if(l!==n.av.STANDARD_DEVIATION)return null;let{numberOfStandardDeviations:r}=s||{};return(0,n.ac)(r)&&0!==r||(r=n.aw.STD_DEV),(0,a.h)("calcite-label",null,t.panels.rgb.stddev,(0,a.h)("calcite-input-number",{label:t.panels.rgb.stddev,scale:"s",tabindex:"0",min:1,max:100,step:.1,value:`${r}`,onCalciteInputNumberInput:e=>{const t=e.target,s=parseFloat(t.value);t.value&&s>=t.min&&s<=t.max?this.handlePercentOrStddevChange(t,"stddev"):setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const{layer:e}=n.s,t=e.renderer,{stretchType:s=n.aw.STRETCH_TYPE}=t||{};if(s!==n.av.PERCENT_CLIP)return null;let{minPercent:l,maxPercent:r}=t||{};return(!(0,n.ac)(l)||l<=0||l>=100)&&(l=n.aw.MIN_PERCENT),(!(0,n.ac)(r)||r<=0||r>=100)&&(r=n.aw.MAX_PERCENT),l=parseFloat(l.toFixed(1)),r=parseFloat(r.toFixed(1)),t.minPercent=l,t.maxPercent=r,(0,n.ab)(),(0,a.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",l),this.renderPercentClipSectionInput("max",r))}renderPercentClipSectionInput(e,t){const{percentLabelFlip:s}=this,{strings:l}=n.s;return(0,a.h)("div",{class:"percent-clip-section-input"},(0,a.h)("calcite-label",null,l.panels.rgb[e],(0,a.h)("calcite-input-number",{label:l.panels.rgb[e],scale:"s",min:.1,max:99.9,step:.1,prefixText:s?"%":void 0,suffixText:s?void 0:"%",value:`${t}`,onCalciteInputNumberInput:t=>{const s=t.target,a=parseFloat(s.value);s.value&&a>=s.min&&a<=s.max?this.handlePercentOrStddevChange(s,e):setTimeout((()=>this.handlePercentOrStddevChange(s,e)),3e3)}})))}renderIndividualGammaToggle(){const{strings:e}=n.s;return(0,a.h)("calcite-label",{layout:"inline-space-between",class:"individual-gamma-label"},e.panels.rgb.individualGamma,(0,a.h)("calcite-switch",{scale:"s",checked:this.changeIndividualGamma,onCalciteSwitchChange:()=>{this.changeIndividualGamma=!this.changeIndividualGamma,(0,a.f)(this.hostElement)}}))}renderGammaBlock(){const{layer:e,strings:t}=n.s,s=e.renderer,{gamma:l=n.aw.GAMMA}=s||{},r=Array.isArray(s.gamma)?s.gamma[0]:s.gamma,i=l[f.RED]||r,o=l[f.GREEN]||r,c=l[f.BLUE]||r;return(0,a.h)("calcite-label",null,t.panels.rgb.gamma,this.changeIndividualGamma?(0,a.h)("div",{class:"individual-gamma-selection"},this.renderIndividualGamma(i,"red"),this.renderIndividualGamma(o,"green"),this.renderIndividualGamma(c,"blue")):(0,a.h)("arcgis-smart-mapping-gamma-slider",{gamma:Array.isArray(l)?l[0]:l,rendererType:"raster-rgb"}))}renderIndividualGamma(e,t){const{strings:s}=n.s;return(0,a.h)("div",{class:"individual-gamma-selection-value"},(0,a.h)("calcite-label",null,s.panels.rgb[t],(0,a.h)("calcite-input-number",{label:s.panels.rgb[t],numberButtonType:"none",tabindex:"0",scale:"s",value:`${e}`,min:.1,max:10,step:.1,onCalciteInputNumberInput:e=>{const s=e.target,a=parseFloat(s.value);s.value&&a>=s.min&&a<=s.max?this.handleIndividualGammaChange(s,t):setTimeout((()=>this.handleIndividualGammaChange(s,t)),3e3)}})))}renderRangeAdjustmentToggle(){const{layer:e,strings:t}=n.s,s=e.renderer,{dynamicRangeAdjustment:l}=s,{stretchType:r=n.aw.STRETCH_TYPE}=s||{};return r===n.av.NONE?null:(0,a.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},t.panels.rgb.dynamicRangeAdjustment,(0,a.h)("calcite-switch",{scale:"s",checked:l,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,a.f)(this.hostElement)}}))}renderStatistics(){const{layer:e,strings:t}=n.s,s=e,l=s.renderer,{stretchType:r=n.aw.STRETCH_TYPE}=l||{},i=r===n.av.PERCENT_CLIP,o=r===n.av.NONE,{dynamicRangeAdjustment:c}=l;return c||o||i?null:(0,a.h)(a.F,null,(0,a.h)("calcite-label",null,t.panels.rgb.statistics,(0,a.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const a=s.renderer,n=e.target.value,l=n===t.panels.rgb.red?s.bandIds[0]:n===t.panels.rgb.green?s.bandIds[1]:s.bandIds[2],r=n===t.panels.rgb.red?a.statistics[0]:n===t.panels.rgb.green?a.statistics[1]:a.statistics[2];this.rendererStatisticsSelection=l,this.updateStatisticsDisplay(r)},ref:e=>this.statisticsControlNode=e},(0,a.h)("calcite-segmented-control-item",{value:t.panels.rgb.red,checked:this.rendererStatisticsSelection===s.bandIds[0]},t.panels.rgb.red),(0,a.h)("calcite-segmented-control-item",{value:t.panels.rgb.green,checked:this.rendererStatisticsSelection===s.bandIds[1]&&this.rendererStatisticsSelection!==s.bandIds[0]},t.panels.rgb.green),(0,a.h)("calcite-segmented-control-item",{value:t.panels.rgb.blue,checked:this.rendererStatisticsSelection===s.bandIds[2]&&this.rendererStatisticsSelection!==s.bandIds[0]&&this.rendererStatisticsSelection!==s.bandIds[1]},t.panels.rgb.blue))),this.renderStatisticsDisplay())}renderStatisticsDisplay(){var e,t;const{originalStatistics:s}=this,{layer:l,modules:r,strings:i}=n.s,o=l,c=o.renderer,{stretchType:d=n.aw.STRETCH_TYPE}=c||{},u=d===n.av.PERCENT_CLIP,p=d===n.av.STANDARD_DEVIATION,m=null!==o.rasterInfo.statistics;let{statistics:g}=c||{};(!g||Array.isArray(g)&&g.length<1)&&(g=r.esriLang.clone(s));const b=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0,f=(!m||u)&&!p,{min:v=0,max:y=255,avg:C=0,stddev:S=0}=(null===(t=this.currentStatistics)||void 0===t?void 0:t[null!=b?b:0])||{};return(0,a.h)(a.F,null,(0,a.h)("calcite-label",null,i.panels.rgb.min,(0,a.h)("calcite-input-number",{label:i.panels.rgb.min,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(v)?this.round(v):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e;const t=parseFloat(this.minNode.value),s=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;!isNaN(t)&&t<=this.currentStatistics[s].max?(this.minNode.value=`${t}`,this.handleStatisticsChange(t,s,"min")):setTimeout((()=>{const e=this.currentStatistics[s].min;this.minNode.value=`${this.round(e)}`}),3e3)}),300),ref:e=>this.minNode=e})),(0,a.h)("calcite-label",null,i.panels.rgb.max,(0,a.h)("calcite-input-number",{label:i.panels.rgb.max,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(y)?this.round(y):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e;const t=parseFloat(this.maxNode.value),s=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;!isNaN(t)&&t>=this.currentStatistics[s].min?(this.maxNode.value=`${t}`,this.handleStatisticsChange(t,s,"max")):setTimeout((()=>{const e=this.currentStatistics[s].max;this.maxNode.value=`${this.round(e)}`}),3e3)}),300),ref:e=>this.maxNode=e})),(0,a.h)("calcite-label",null,i.panels.rgb.mean,(0,a.h)("calcite-input-number",{label:i.panels.rgb.mean,scale:"s",step:.1,disabled:f,numberButtonType:"none",value:`${(0,n.ac)(C)?this.round(C):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e;const t=parseFloat(this.avgNode.value),s=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;isNaN(t)?setTimeout((()=>{const e=this.currentStatistics[s].avg;this.avgNode.value=`${this.round(e)}`}),3e3):(this.avgNode.value=`${t}`,this.handleStatisticsChange(t,s,"avg"))}),300),ref:e=>this.avgNode=e})),(0,a.h)("calcite-label",null,i.panels.rgb.stddev,(0,a.h)("calcite-input-number",{label:i.panels.rgb.stddev,scale:"s",step:.1,disabled:f,numberButtonType:"none",value:`${(0,n.ac)(S)?this.round(S):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{var e;const t=parseFloat(this.stddevNode.value),s=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0;isNaN(t)?setTimeout((()=>{const e=this.currentStatistics[s].stddev;this.stddevNode.value=`${this.round(e)}`}),3e3):(this.stddevNode.value=`${t}`,this.handleStatisticsChange(t,s,"stddev"))}),300),ref:e=>this.stddevNode=e})))}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handlePercentOrStddevChange(e,t){const{layer:s}=n.s,a=s.renderer;let l=parseFloat(e.value);isNaN(l)||l<e.min?l=e.min:l>e.max&&(l=e.max),l=parseFloat(l.toFixed(1)),e.value=`${l}`,"min"===t?a.minPercent=l:"max"===t?a.maxPercent=l:a.numberOfStandardDeviations=l,(0,n.ab)()}handleIndividualGammaChange(e,t){const{layer:s}=n.s,a=s.renderer;let l=parseFloat(e.value);isNaN(l)||l<e.min?l=e.min:l>e.max&&(l=e.max),l=parseFloat(l.toFixed(1)),e.value=`${l}`,"red"===t?a.gamma[f.RED]=l:"green"===t?a.gamma[f.GREEN]=l:a.gamma[f.BLUE]=l,a.useGamma=!0,(0,n.ab)()}handleDRAToggle(e){const{layer:t}=n.s,s=t,a=s.renderer;if(a.dynamicRangeAdjustment=e,e)a.statistics=[];else{const e=s.bandIds.map((e=>this.currentStatistics[e]));a.statistics=e}(0,n.ab)()}handleStatisticsChange(e,t,s){const{layer:a}=n.s,l=a,r=l.renderer;this.currentStatistics[t][s]=e;const i=[];l.bandIds.forEach(((e,s)=>{e===t&&i.push(s)})),i.forEach((e=>r.statistics[e]=this.currentStatistics[t])),(0,n.ab)()}updateStatisticsDisplay(e){const{min:t,max:s,avg:a,stddev:l}=e;this.minNode.value=`${(0,n.ac)(t)?this.round(t):""}`,this.maxNode.value=`${(0,n.ac)(s)?this.round(s):""}`,this.avgNode.value=`${(0,n.ac)(a)?this.round(a):""}`,this.stddevNode.value=`${(0,n.ac)(l)?this.round(l):""}`}round(e){return Math.round(1e3*e)/1e3}get hostElement(){return(0,a.d)(this)}};y.style=":host{width:100%}.flow-item{height:100%}.rgb-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.individual-gamma-label,.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}.individual-gamma-selection{display:flex;justify-content:space-between}.individual-gamma-selection-value{display:flex;flex-flow:column;justify-content:space-between;width:30%}";const C="traditional",S="multi-directional",w="none",N={azimuth:315,altitude:45,pixelSizePower:.664,pixelSizeFactor:.024,zFactor:1},k=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterShadedReliefClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefClose",7),this.arcgisSmartMappingPanelsRasterShadedReliefBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefBackClick",7),this.arcgisSmartMappingPanelsRasterShadedReliefError=(0,a.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefError",7),this.handles=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,s=t;(0,r.a)(e,s),this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,modules:t}=n.s,s=e;this.originalRendererObj=t.esriLang.clone(s.renderer)}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.shadedRelief.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterShadedReliefBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"shaded-relief-block",heading:e.panels.shadedRelief.shadedRelief,open:!0},this.renderHillshadeTypeSelector(),this.renderColorScheme(),this.renderAzimuthSlider(),this.renderAltitudeSlider(),this.renderScalingSelector(),this.renderZFactorAndPixelInputs())}renderHillshadeTypeSelector(){const{layer:e}=n.s,t=e;return(0,a.h)("arcgis-smart-mapping-hillshade-type-button",{onArcgisSmartMappingHillshadeTypeButtonBeforeOpen:()=>(0,n.E)(),onArcgisSmartMappingHillshadeTypeButtonChange:e=>{const s=e.target,l=e.detail;t.renderer.hillshadeType=l,(0,n.ab)(),(0,a.f)(this.hostElement),(0,a.f)(s)}})}renderColorScheme(){const{layer:e,strings:t}=n.s,s=e.renderer,{colorRamp:l}=s||{},i=(0,r.n)(l);return(0,a.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.shadedRelief.colorScheme,type:"raster-shaded-relief",rampType:"continuous",colors:i,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,a.f)(this.hostElement)}})}renderAzimuthSlider(){const{layer:e,strings:t}=n.s,s=e.renderer,{hillshadeType:l=S,azimuth:r=N.azimuth}=s||{};return l===C?(0,a.h)("calcite-label",null,t.panels.shadedRelief.azimuth,(0,a.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"azimuth",min:0,max:360,values:[r],precision:1,minLabel:"0",maxLabel:"360"})):null}renderAltitudeSlider(){const{layer:e,strings:t}=n.s,s=e.renderer,{hillshadeType:l=S,altitude:r=N.altitude}=s||{};return l===C?(0,a.h)("calcite-label",null,t.panels.shadedRelief.altitude,(0,a.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"altitude",min:0,max:90,values:[r],precision:1,minLabel:"0",maxLabel:"90"})):null}renderScalingSelector(){const{layer:e,strings:t}=n.s,s=e.renderer,{scalingType:l=w}=s||{},r=t.panels.shadedRelief.scalingOptions;return(0,a.h)("calcite-label",null,t.panels.shadedRelief.scaling,(0,a.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const t=e.target;this.handleScalingOptionChange(t.value)}},(0,a.h)("calcite-segmented-control-item",{value:"none",checked:"none"===l},r.none),(0,a.h)("calcite-segmented-control-item",{value:"adjusted",checked:"adjusted"===l},r.adjusted)))}renderZFactorAndPixelInputs(){const{layer:e,strings:t}=n.s,s=e.renderer,{scalingType:l=w}=s||{},r=["zFactor"];return"adjusted"===l&&(r.push("pixelSizePower"),r.push("pixelSizeFactor")),(0,a.h)(a.F,null,r.map(((e,n)=>{var l;return(0,a.h)("calcite-label",null,t.panels.shadedRelief[e],(0,a.h)("calcite-input-number",{label:t.panels.shadedRelief[e],tabindex:"0",min:0,step:.1,scale:"s",value:`${null!==(l=s[e])&&void 0!==l?l:N[e]}`,onCalciteInputNumberInput:t=>{const s=t.target;""===s.value||parseFloat(s.value)<0?this.handles[n]=setTimeout((()=>this.handleZFactorOrPixelChange(s,e)),3e3):(clearTimeout(this.handles[n]),setTimeout((()=>this.handleZFactorOrPixelChange(s,e)),300))}}))})))}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleScalingOptionChange(e){const{layer:t}=n.s;t.renderer.scalingType=e,(0,n.ab)(),(0,a.f)(this.hostElement)}handleZFactorOrPixelChange(e,t){const{layer:s}=n.s,a=s.renderer;let l=parseFloat(e.value);(isNaN(l)||l<e.min)&&(l=e.min),e.value=`${l}`,a[t]=l,(0,n.ab)()}get hostElement(){return(0,a.d)(this)}};k.style=":host{width:100%}.flow-item{height:100%}.shaded-relief-block{overflow-x:hidden}";const I=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterStretchClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterStretchClose",7),this.arcgisSmartMappingPanelsRasterStretchBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterStretchBackClick",7),this.arcgisSmartMappingPanelsRasterStretchError=(0,a.c)(this,"arcgisSmartMappingPanelsRasterStretchError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterStretchClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:s,originalStatistics:a}=this,{layer:l}=n.s,i=l;i.effect=t,i.bandIds=s,i.rasterInfo.statistics=a,(0,r.a)(e,i),this.arcgisSmartMappingPanelsRasterStretchClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){var e,t,s,a;const{layer:l,modules:r}=n.s,i=l,o=i.renderer,{statistics:c}=i.rasterInfo;this.originalRendererObj=r.esriLang.clone(i.renderer),this.originalEffect=i.effect,this.originalBandCombination=i.bandIds,this.originalStatistics=null!==(e=r.esriLang.clone(c))&&void 0!==e?e:[],this.currentStatistics=null!==(t=r.esriLang.clone(c))&&void 0!==t?t:[],1!==(null===(s=i.bandIds)||void 0===s?void 0:s.length)&&(i.bandIds=[0]),this.isAnEmptyArray(o.statistics)&&(o.statistics=[this.originalStatistics[0]]);const d=null!==(a=i.bandIds[0])&&void 0!==a?a:n.ax.BAND_INDEX;(0,n.ac)(c)||(0,n.ac)(o.statistics[0])||(o.statistics[0]={min:0,max:255,avg:0,stddev:0},this.currentStatistics[d]=o.statistics[0]);const h=o.statistics;this.isAnEmptyArray(h)&&!o.dynamicRangeAdjustment?(this.currentStatistics[d]={min:0,max:255,avg:0,stddev:0},o.statistics=[this.currentStatistics[d]]):this.currentStatistics[d]=o.statistics[0]}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.stretch.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterStretchBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"stretch-block",heading:e.panels.stretch.stretch,open:!0},this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderBandSelector(),this.renderGammaSlider(),this.renderColorScheme(),this.renderRangeAdjustmentToggle(),this.renderStatisticsTable())}renderStretchTypeSelector(){const{layer:e}=n.s,t=e;return(0,a.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,n.E)(),onArcgisSmartMappingStretchTypeButtonChange:e=>{const s=e.target,i=e.detail;(0,l.r)((0,n.ay)({stretchType:i}),this.flowItemNode).then((e=>{var l;const o=null!==(l=t.bandIds[0])&&void 0!==l?l:n.ax.BAND_INDEX;(0,n.ac)(this.currentStatistics)&&(e.renderer.statistics=[this.currentStatistics[o]]),"none"===i&&(e.renderer.dynamicRangeAdjustment=!1,e.renderer.colorRamp=null),(0,r.a)(e.renderer,t),(0,n.ab)(),(0,a.f)(this.hostElement),(0,a.f)(s)}),(e=>{(0,a.f)(s),this.arcgisSmartMappingPanelsRasterStretchError.emit(e)}))}})}renderStandardDeviationSection(){const{layer:e,strings:t}=n.s,s=e.renderer,{stretchType:l=n.ax.STRETCH_TYPE}=s||{};if(l!==n.az.STANDARD_DEVIATION)return null;let{numberOfStandardDeviations:r}=s||{};return(0,n.ac)(r)&&0!==r||(r=n.ax.STD_DEV),(0,a.h)("calcite-label",null,t.panels.stretch.stddev,(0,a.h)("calcite-input-number",{label:t.panels.stretch.stddev,scale:"s",tabindex:"0",min:1,max:100,step:.1,value:`${r}`,onCalciteInputNumberInput:e=>{const t=e.target,s=parseFloat(t.value);t.value&&s>=t.min&&s<=t.max?this.handlePercentOrStddevChange(t,"stddev"):setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const{layer:e}=n.s,t=e.renderer,{stretchType:s=n.ax.STRETCH_TYPE}=t||{};if(s!==n.az.PERCENT_CLIP)return null;let{minPercent:l,maxPercent:r}=t||{};return(!(0,n.ac)(l)||l<=0||l>=100)&&(l=n.ax.MIN_PERCENT),(!(0,n.ac)(r)||r<=0||r>=100)&&(r=n.ax.MAX_PERCENT),l=parseFloat(l.toFixed(1)),r=parseFloat(r.toFixed(1)),t.minPercent=l,t.maxPercent=r,(0,n.ab)(),(0,a.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",l),this.renderPercentClipSectionInput("max",r))}renderPercentClipSectionInput(e,t){const{strings:s}=n.s;return(0,a.h)("div",{class:"percent-clip-section-input"},(0,a.h)("calcite-label",null,s.panels.stretch[e],(0,a.h)("calcite-input-number",{label:s.panels.stretch[e],scale:"s",min:.1,max:99.9,step:.1,suffixText:"%",value:`${t}`,onCalciteInputNumberInput:t=>{const s=t.target,a=parseFloat(s.value);s.value&&a>=s.min&&a<=s.max?this.handlePercentOrStddevChange(s,e):setTimeout((()=>this.handlePercentOrStddevChange(s,e)),3e3)}})))}renderBandSelector(){const{layer:e,strings:t}=n.s,s=e,{bandCount:l}=s.rasterInfo;if(!(l>1))return null;const{bandInfos:r}=s.rasterInfo,i=r.map((e=>e.name));return(0,a.h)("calcite-label",null,t.panels.stretch.band,(0,a.h)("calcite-combobox",{label:t.panels.stretch.band,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:e=>{var t;const l=e.target,r=s.renderer;s.bandIds=[i.indexOf(l.value)];const o=null!==(t=s.bandIds[0])&&void 0!==t?t:n.ax.BAND_INDEX;r.statistics=[this.currentStatistics[o]],(0,n.ab)(),(0,a.f)(this.hostElement)}},i.map(((e,t)=>this.renderBandOptions(e,t)))))}renderBandOptions(e,t){var s;const{layer:l}=n.s,r=null!==(s=l.bandIds[0])&&void 0!==s?s:n.ax.BAND_INDEX;return(0,a.h)("calcite-combobox-item",{textLabel:e,value:e,selected:r===t})}renderGammaSlider(){var e;const{layer:t,strings:s}=n.s,l=t.renderer;let{gamma:r=n.ax.GAMMA}=l||{};(0,n.ac)(r)||(r=n.ax.GAMMA),Array.isArray(r)&&(r=null!==(e=r[0])&&void 0!==e?e:n.ax.GAMMA);const{stretchType:i=n.ax.STRETCH_TYPE}=l||{};return i===n.az.NONE?null:(0,a.h)("calcite-label",null,s.panels.stretch.gamma,(0,a.h)("arcgis-smart-mapping-gamma-slider",{gamma:r,rendererType:"raster-stretch"}))}renderColorScheme(){const{layer:e,strings:t}=n.s,s=e.renderer,{stretchType:l=n.ax.STRETCH_TYPE}=s||{};if(l===n.az.NONE)return null;const{colorRamp:i}=s||{},o=(0,r.n)(i);return(0,a.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.stretch.colorScheme,type:"raster-stretch",rampType:"continuous",colors:o,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,a.f)(this.hostElement)}})}renderRangeAdjustmentToggle(){const{layer:e,strings:t}=n.s,s=e.renderer,{dynamicRangeAdjustment:l}=s,{stretchType:r=n.ax.STRETCH_TYPE}=s||{};return r===n.az.NONE?null:(0,a.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},t.panels.stretch.dynamicRangeAdjustment,(0,a.h)("calcite-switch",{scale:"s",checked:l,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,a.f)(this.hostElement)}}))}renderStatisticsTable(){var e;const{originalStatistics:t}=this,{layer:s,modules:l,strings:r}=n.s,i=s,o=i.renderer,{stretchType:c=n.ax.STRETCH_TYPE}=o||{},d=c===n.az.PERCENT_CLIP,u=c===n.az.NONE,p=c===n.az.STANDARD_DEVIATION,{dynamicRangeAdjustment:m}=o;if(m||u||d)return null;const g=null!==i.rasterInfo.statistics;let{statistics:b}=o||{};(!b||Array.isArray(b)&&b.length<1)&&(b=l.esriLang.clone(t));const f=null!==(e=i.bandIds[0])&&void 0!==e?e:n.ax.BAND_INDEX,v=(!g||d)&&!p,{min:y=0,max:C=255,avg:S=0,stddev:w=0}=(null==b?void 0:b[0])||{};return(0,a.h)(a.F,null,(0,a.h)("calcite-label",null,r.panels.stretch.statistics),(0,a.h)("calcite-label",null,r.panels.stretch.min,(0,a.h)("calcite-input-number",{label:r.panels.stretch.min,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(y)?this.round(y):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{const e=parseFloat(this.minNode.value);!isNaN(e)&&e<=this.currentStatistics[f].max?(this.minNode.value=`${e}`,this.handleStatisticsChange(e,f,"min")):setTimeout((()=>{const e=this.round(this.currentStatistics[f].min);this.minNode.value=`${e}`}),3e3)}),300),ref:e=>this.minNode=e})),(0,a.h)("calcite-label",null,r.panels.stretch.max,(0,a.h)("calcite-input-number",{label:r.panels.stretch.max,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.ac)(C)?this.round(C):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{const e=parseFloat(this.maxNode.value);!isNaN(e)&&e>=this.currentStatistics[f].min?(this.maxNode.value=`${e}`,this.handleStatisticsChange(e,f,"max")):setTimeout((()=>{const e=this.round(this.currentStatistics[f].max);this.maxNode.value=`${e}`}),3e3)}),300),ref:e=>this.maxNode=e})),(0,a.h)("calcite-label",null,r.panels.stretch.mean,(0,a.h)("calcite-input-number",{label:r.panels.stretch.mean,scale:"s",step:.1,disabled:v,numberButtonType:"none",value:`${(0,n.ac)(S)?this.round(S):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{const e=parseFloat(this.avgNode.value);isNaN(e)?setTimeout((()=>{const e=this.round(this.currentStatistics[f].avg);this.avgNode.value=`${e}`}),3e3):(this.avgNode.value=`${e}`,this.handleStatisticsChange(e,f,"avg"))}),300),ref:e=>this.avgNode=e})),(0,a.h)("calcite-label",null,r.panels.stretch.stddev,(0,a.h)("calcite-input-number",{label:r.panels.stretch.stddev,scale:"s",step:.1,disabled:v,numberButtonType:"none",value:`${(0,n.ac)(w)?this.round(w):""}`,onCalciteInputNumberInput:(0,h.d)((()=>{const e=parseFloat(this.stddevNode.value);isNaN(e)?setTimeout((()=>{const e=this.round(this.currentStatistics[f].stddev);this.stddevNode.value=`${e}`}),3e3):(this.stddevNode.value=`${e}`,this.handleStatisticsChange(e,f,"stddev"))}),300),ref:e=>this.stddevNode=e})))}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handlePercentOrStddevChange(e,t){const{layer:s}=n.s,a=s.renderer;let l=parseFloat(e.value);isNaN(l)||l<e.min?l=e.min:l>e.max&&(l=e.max),l=parseFloat(l.toFixed(1)),e.value=`${l}`,"min"===t?a.minPercent=l:"max"===t?a.maxPercent=l:a.numberOfStandardDeviations=l,(0,n.ab)()}handleDRAToggle(e){var t;const{layer:s}=n.s,a=s,l=a.renderer,r=null!==(t=a.bandIds[0])&&void 0!==t?t:n.ax.BAND_INDEX;l.dynamicRangeAdjustment=e,l.statistics=e?[]:[this.currentStatistics[r]],(0,n.ab)()}handleStatisticsChange(e,t,s){const{layer:a}=n.s,l=a.renderer;this.currentStatistics[t][s]=e,l.statistics=[this.currentStatistics[t]],(0,n.ab)()}isAnEmptyArray(e){return Array.isArray(e)?0===e.length:null==e}round(e){return Math.round(1e3*e)/1e3}get hostElement(){return(0,a.d)(this)}};I.style=":host{width:100%}.flow-item{height:100%}.stretch-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}";const x=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterUniqueValueClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueClose",7),this.arcgisSmartMappingPanelsRasterUniqueValueBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueBackClick",7),this.arcgisSmartMappingPanelsRasterUniqueValueError=(0,a.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueError",7),this.inputNodes=[],this.labelNodes=[],this.colorNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,s=t;(0,r.a)(e,s),this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e,mapView:t,modules:s,strings:a}=n.s,l=e,i=l.renderer,o=(0,r.g)();n.s.lastDefault={defaultSymbol:i.defaultSymbol||(0,n.S)(l,t,o),defaultLabel:i.defaultLabel||a.panels.uniqueValue.other},this.originalRendererObj=s.esriLang.clone(l.renderer)}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){(0,n.ae)()}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.uniqueValue.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterUniqueValueBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"unique-value-block",heading:e.panels.uniqueValue.uniqueValue,open:!0},this.renderFieldSelector(),this.renderColorScheme(),this.renderValues())}renderFieldSelector(){var e;const{layer:t,strings:s}=n.s,l=t.renderer.field||s.panels.uniqueValue.value,r=(0,n.aA)(),i=r.map((e=>({label:e.alias,layerField:e,simpleFieldType:n.w.STRING}))),o=r.find((e=>e.name===l));return(0,a.h)("arcgis-smart-mapping-attribute-input",{label:s.panels.uniqueValue.field,fieldList:i,selectedField:{field:null!==(e=null==o?void 0:o.name)&&void 0!==e?e:s.panels.uniqueValue.value,simpleFieldType:n.w.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderColorScheme(){const{layer:e,mapView:t,modules:s,strings:l}=n.s,r=e.renderer.uniqueValueInfos;if(!r.length)return null;const i=s.typeSchemes.getSchemes({basemap:t.map.basemap,geometryType:"polygon"}),o=(0,n.a9)(i,Math.min(r.length,10))[0].colors,c=[];return c.push(...(null==r?void 0:r.length)?r.map(((e,t)=>(0,n.t)(e.symbol)||new s.esriColor(o[t%o.length]))):[]),(0,a.h)("arcgis-smart-mapping-symbol-button",{label:l.panels.uniqueValue.colorScheme,type:"raster-unique-value",rampType:"continuous",colors:s.esriLang.clone(c).reverse(),onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.ab)(),(0,a.f)(this.hostElement),(0,a.f)(this.symbolButtonNode)},ref:e=>this.symbolButtonNode=e})}renderValues(){const{layer:e}=n.s,t=e.renderer;return this.labelNodes=[],this.inputNodes=[],(0,a.h)(a.F,null,(0,a.h)("calcite-label",null,t.field),(0,a.h)("calcite-list",{group:"unique-value-items",class:"gray-border",dragEnabled:!0,onCalciteListOrderChange:e=>{if(e.detail.toEl){const s=e.detail.dragEl;if("other-values-list"===e.detail.toEl.id){const e=t.uniqueValueInfos.filter(((e,t)=>t!==parseInt(s.label)));t.uniqueValueInfos=e}}const s=Array.from(e.target.children);this.handleSortValues(s)}},t.uniqueValueInfos.map(((e,t)=>this.renderValue(e,t)))),this.renderDefaultValue(),(0,a.h)("calcite-list",{id:"other-values-list",dragEnabled:!0,group:"unique-value-items"}))}renderValue(e,t){return(0,a.h)("calcite-list-item",{key:`values-${e.value}`,value:`${e.value}`,label:`${t}`},(0,a.h)("div",{slot:"actions-start"},this.renderColorNode(e,t)),this.renderTextNode(e,t))}renderColorNode(e,t){const{strings:s}=n.s;let l=e.symbol.clone();const r={"symbol-is-white":(0,n.aq)(l),symbol:!0};return-1!==t&&this.colorNodes.length&&(this.colorNodes=[]),(0,a.h)("div",{class:r,tabindex:"0","aria-label":s.panels.uniqueValue.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&(-1===t?this.defaultColorNode=e:this.colorNodes.push(e))},onClick:()=>{this.popoverNode?((-1===this.selectedPopoverIdx?this.defaultColorNode:this.colorNodes[this.selectedPopoverIdx]).classList.remove("selected"),this.selectedPopoverIdx===t?((0,n.E)(),this.popoverNode=null,this.selectedPopoverIdx=null):(this.selectedPopoverIdx=t,this.handleColorClick(t))):(this.selectedPopoverIdx=t,this.handleColorClick(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleColorClick(t))}},(0,a.h)("div",{ref:e=>{e&&this.afterCreateColorNode(e,t)}}))}renderTextNode(e,t){const{strings:s}=n.s;return(0,a.h)(a.F,null,(0,a.h)("div",{class:(-1===t?"default-label":"")+" label",slot:"content",tabindex:"0",ref:e=>{e&&(-1===t?this.defaultLabelNode=e:this.labelNodes[t]=e)},"aria-label":s.panels.uniqueValue.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>this.handleLabelEdit(t,e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleLabelEdit(t,e)}},e.label),(0,a.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",tabindex:"0",ref:e=>{var s;e&&(-1===t?this.defaultInputNode=e:this.inputNodes[t]=e,null===(s=this.defaultInputNode)||void 0===s||s.classList.add("default-input-padding"))},value:e.label,onCalciteInputChange:e=>{const s=-1===t?this.defaultInputNode:this.inputNodes[t],a=-1===t?this.defaultLabelNode:this.labelNodes[t];s.classList.add("hidden"),a.classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{const s=-1===t?this.defaultInputNode:this.inputNodes[t],a=-1===t?this.defaultLabelNode:this.labelNodes[t];s.classList.add("hidden"),a.classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:s=>{if("Escape"===s.key||"Enter"===s.key){(-1===t?this.defaultInputNode:this.inputNodes[t]).classList.add("hidden");const a=s.currentTarget;a.value=e.label||"",a.disabled=!0,this.handleValueTextChange(t,s);const n=-1===t?this.defaultLabelNode:this.labelNodes[t];n.classList.remove("hidden"),a.disabled=!1,setTimeout((()=>n.focus()),300)}}}))}renderDefaultValue(){const{layer:e,mapView:t,strings:s}=n.s,l=e,i=l.renderer,o=(0,r.g)(),c={symbol:i.defaultSymbol||(0,n.S)(l,t,o),label:i.defaultLabel||s.panels.uniqueValue.other};return(0,a.h)("calcite-list",{class:"default-list-padding"},(0,a.h)("calcite-list-item",null,(0,a.h)("calcite-checkbox",{class:"checkbox",slot:"actions-start",scale:"m",tabIndex:0,checked:!!i.defaultSymbol,onClick:e=>this.handleCheckboxClick(e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleCheckboxClick(e))},onMouseOver:()=>(0,n.af)(this.checkboxNode,s.panels.uniqueValue.otherTooltip),onMouseOut:()=>(0,n.ae)(),onFocus:()=>(0,n.af)(this.checkboxNode,s.panels.uniqueValue.otherTooltip),onFocusout:()=>(0,n.ae)(),ref:e=>{e&&(this.checkboxNode=e)}}),(0,a.h)("div",{slot:"content-start",class:"symbol-container"},this.renderColorNode(c,-1)),this.renderTextNode(c,-1)))}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){const{layer:t}=n.s,s=t,i=s.renderer;(0,l.r)((0,n.aB)({field:e}),this.flowItemNode).then((e=>{(0,r.a)(e.renderer,s),(0,n.ab)(),(0,a.f)(this.hostElement)}),(e=>{this.fieldNode.value=i.field,this.arcgisSmartMappingPanelsRasterUniqueValueError.emit(e)}))}handleSortValues(e){const{layer:t,mapView:s,modules:l,strings:i}=n.s,o=(0,r.g)(),c=t,d=c.renderer;(0,n.E)();const h=e.map((e=>e.value)),u=d.uniqueValueInfos.map((e=>l.esriLang.clone(e)));u.sort(((e,t)=>h.indexOf(`${e.value}`)-h.indexOf(`${t.value}`))),u.length?d.uniqueValueInfos=u:(d.defaultSymbol=(0,n.S)(c,s,o),d.defaultLabel=i.panels.uniqueValue.other),(0,n.ab)(),(0,a.f)(this.hostElement)}afterCreateColorNode(e,t){var s;const{layer:a,mapView:l,modules:i}=n.s,o=a,c=o.renderer,d=(0,r.g)(),h=-1===t?c.defaultSymbol||(0,n.S)(o,l,d):c.uniqueValueInfos[t].symbol.clone();for(-1===t&&h.outline&&(h.outline.width=0),(0,n.aq)(h)&&(h.outline=new i.SimpleLineSymbol({color:"#bdc3c7",width:.75}));null===(s=null==e?void 0:e.childNodes)||void 0===s?void 0:s.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:u}=i;h&&u.renderPreviewHTML(h,{size:(0,n.ar)(h),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>null==e?void 0:e.appendChild(t)))}handleColorClick(e){(0,n.E)();const{strings:t}=n.s,s=(0,o.c)({referenceElement:this.flowItemNode,heading:t.panels.uniqueValue.colorScheme});s.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>this.handleRemoveColorFocus(s,e,!1))),s.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>this.handleRemoveColorFocus(s,e,!0))),n.s.selectedValue=e,(0,i.a)({popoverNode:s,onChange:()=>{const{layer:s}=n.s,l=s.renderer;-1!==e||l.defaultLabel||(l.defaultLabel=t.panels.uniqueValue.other),(0,n.ab)(),(0,a.f)(this.hostElement),this.symbolButtonNode&&(0,a.f)(this.symbolButtonNode)}}),this.popoverNode=s,-1===e?this.defaultColorNode.classList.add("selected"):this.colorNodes[e].classList.add("selected")}handleRemoveColorFocus(e,t,s){(0,o.r)(e),setTimeout((()=>{const e=-1===t?this.defaultColorNode:this.colorNodes[t];s||e.focus(),e.classList.remove("selected"),this.popoverNode=null}),300)}handleLabelEdit(e,t){const s=-1===e?this.defaultInputNode:this.inputNodes[e];s.classList.remove("hidden"),s.setFocus(),t.target.classList.add("hidden")}handleValueTextChange(e,t){const{layer:s,strings:l}=n.s,r=s.renderer;if(-1===e&&!r.defaultLabel)return this.defaultInputNode.value=l.panels.uniqueValue.other,this.defaultLabelNode.textContent=l.panels.uniqueValue.other,(0,n.ab)(),void(0,a.f)(this.hostElement);const i=t.target;-1===e?r.defaultLabel=i.value:r.uniqueValueInfos[e].label=i.value,""===i.value?-1===e?(r.defaultLabel=l.panels.uniqueValue.other,this.defaultInputNode.value=l.panels.uniqueValue.other,this.defaultLabelNode.textContent=l.panels.uniqueValue.other):(r.uniqueValueInfos[e].label=`${r.uniqueValueInfos[e].value}`,this.inputNodes[e].value=r.uniqueValueInfos[e].label):-1===e&&(this.defaultInputNode.value=r.defaultLabel,this.defaultLabelNode.textContent=r.defaultLabel),(0,n.ab)(),(0,a.f)(this.hostElement)}handleCheckboxClick(e){const{layer:t,lastDefault:s,strings:l}=n.s,r=t.renderer;(0,o.r)(this.popoverNode),this.popoverNode=null,(0,n.E)(),r.uniqueValueInfos.length?(r.defaultSymbol?(r.defaultSymbol=void 0,r.defaultLabel=void 0,this.defaultLabelNode.textContent=l.panels.uniqueValue.other,this.defaultInputNode.value=l.panels.uniqueValue.other):(r.defaultSymbol=s.defaultSymbol,r.defaultLabel=this.defaultLabelNode.textContent),(0,n.ab)(),(0,a.f)(this.hostElement)):e.target.checked=!0}get hostElement(){return(0,a.d)(this)}};x.style=":host{width:100%}.flow-item{height:100%}.unique-value-block{overflow-x:hidden;overflow-wrap:anywhere}.label{padding:5px auto}.symbol{width:19px;height:19px}.symbol:focus,.label:focus{outline:2px solid var(--calcite-color-brand)}.symbol-container{cursor:pointer}.selected{outline:1px solid var(--calcite-color-brand)}.hidden{display:none}.gray-border{border-top:1px solid #e0e0e0;border-bottom:1px solid #e0e0e0}.checkbox{margin:0px 5.5px}.default-list-padding{padding-top:8px}";const{strings:B}=n.s,R=B.panels.vectorField.unitOptions,T=[{key:"meter-per-second",title:R.esriMetersPerSecond,selected:!1},{key:"kilometer-per-hour",title:R.esriKilometersPerHour,selected:!1},{key:"knots",title:R.esriKnots,selected:!1},{key:"feet-per-second",title:R.esriFeetPerSecond,selected:!1},{key:"mile-per-hour",title:R.esriMilesPerHour,selected:!1}],E=class{constructor(e){(0,a.r)(this,e),this.arcgisSmartMappingPanelsRasterVectorFieldClose=(0,a.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldClose",7),this.arcgisSmartMappingPanelsRasterVectorFieldBackClick=(0,a.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldBackClick",7),this.arcgisSmartMappingPanelsRasterVectorFieldError=(0,a.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldError",7),this.documentClickHandler=void 0,this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this,{layer:t}=n.s,s=t;(0,r.a)(e,s),this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e}=n.s,t=e;this.originalRendererObj=t.renderer}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.currentInput=this.inputUnitNode.value,this.currentOutput=this.outputUnitNode.value}render(){const{hideLayerTitle:e,layer:t,strings:s,isRTL:l}=n.s,r=t.title;return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-flow-item",{heading:s.panels.vectorField.styleOptions,description:e?void 0:r,class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,n.aa)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterVectorFieldBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,a.h)("calcite-block",{class:"vector-field-block",heading:e.panels.vectorField.vectorField,open:!0},this.renderSymbolStyleSelector(),this.renderSymbolDensitySlider(),this.renderSymbolScalingSlider(),this.renderInvertSymbols(),this.renderMagnitudeRange(),this.renderUnitSelectors())}renderSymbolStyleSelector(){return(0,a.h)("arcgis-smart-mapping-vector-symbol-button",{ref:e=>this.selectNode=e,onArcgisSmartMappingSelectBeforeOpen:()=>{var e;null===(e=this.popoverNode)||void 0===e||e.parentElement.removeChild(this.popoverNode),this.popoverNode=null,this.popoverOpen=!1},onArcgisSmartMappingSelectChange:e=>{const{layer:t}=n.s,s=t,r=s.renderer;let i=e.detail;i.includes("beaufort")&&(i=this.getExactBeaufortUnit(r.outputUnit)),this.resetOutputUnit(i,r),(0,l.r)((0,c.d)({style:i}),this.flowItemNode).then((e=>{s.renderer=e.renderer,(0,n.ab)(),(0,a.f)(this.hostElement),this.selectNode&&(0,a.f)(this.selectNode)}),(e=>{(0,a.f)(this.selectNode),this.arcgisSmartMappingPanelsRasterVectorFieldError.emit(e)}))}})}renderSymbolDensitySlider(){const{layer:e,strings:t}=n.s,s=e.renderer,{symbolTileSize:l}=s||{},r=100/l;return(0,a.h)("calcite-label",null,t.panels.vectorField.symbolDensity,(0,a.h)("arcgis-smart-mapping-raster-slider",{rendererType:"vector-field",type:"density",min:1,max:5,values:[Math.round(10*r)/10],precision:1,minLabel:t.panels.flow.low,maxLabel:t.panels.flow.high}))}renderSymbolScalingSlider(){const{layer:e,strings:t}=n.s,s=e.renderer,l=(0,n.a)(s,"size"),{minSize:r,maxSize:i}=l;return(0,a.h)("calcite-label",null,t.panels.vectorField.symbolScaling,(0,a.h)("calcite-slider",{min:0,minValue:null!==r?r:20,max:100,maxValue:null!==i?i:80,step:1,labelHandles:!0,labelTicks:!0,precise:!0,snap:!0,onCalciteSliderInput:(0,h.d)((()=>{const e=this.symbolScalingSliderNode.minValue,t=this.symbolScalingSliderNode.maxValue;this.handleSymbolScaleChange(e,t)}),300),ref:e=>this.symbolScalingSliderNode=e}))}renderInvertSymbols(){const{layer:e,isRTL:t,strings:s}=n.s;let l="flow-from"!==e.renderer.flowRepresentation;return(0,a.h)("div",{class:"invert-symbol-wrapper"},(0,a.h)("calcite-label",{layout:"inline-space-between"},(0,a.h)("section",null,s.panels.vectorField.invertSymbols,(0,a.h)("calcite-button",{class:{"invert-symbol-margin":!0,[d.C.rtl]:t},"icon-start":"information",scale:"s",appearance:"transparent",kind:"neutral",onClick:()=>{this.popoverOpen?(this.removePopover(),this.buttonNode.setFocus()):this.togglePopover()},ref:e=>this.buttonNode=e}))),(0,a.h)("calcite-switch",{class:"invert-symbol-switch",scale:"s",label:s.panels.vectorField.invertSymbols,checked:l,onCalciteSwitchChange:e=>this.handleInvertSymbolsChange(e.currentTarget.checked?"flow-to":"flow-from")}))}renderMagnitudeRange(){return(0,a.h)("arcgis-smart-mapping-magnitude-range-slider",null)}renderUnitSelectors(){const{strings:e}=n.s;return(0,a.h)(a.F,null,(0,a.h)("calcite-label",null,e.panels.vectorField.convertMagnitude),(0,a.h)("calcite-label",null,e.panels.vectorField.inputUnits,this.renderUnitSelector("input")),(0,a.h)("calcite-label",null,e.panels.vectorField.outputUnits,this.renderUnitSelector("output")))}renderUnitSelector(e){const{layer:t,strings:s}=n.s,l=t.renderer,r="output"===e&&["wind-barb","ocean-current-kn","ocean-current-m"].indexOf(l.style)>-1;return(0,a.h)("calcite-combobox",{disabled:r,key:"input"===e?l.inputUnit:l.outputUnit,label:"input"===e?s.panels.vectorField.inputUnits:s.panels.vectorField.outputUnits,clearDisabled:!0,scale:"s",selectionMode:"single",ref:t=>{t&&("output"===e?this.outputUnitNode=t:this.inputUnitNode=t)},onCalciteComboboxChange:()=>{"input"===e?(""===this.inputUnitNode.value?this.inputUnitNode.value=this.currentInput:this.currentInput=this.inputUnitNode.value,this.handleUnitSelectClick("input")):(""===this.outputUnitNode.value?this.outputUnitNode.value=this.currentOutput:this.currentOutput=this.outputUnitNode.value,this.handleUnitSelectClick("output"))}},T.map((t=>this.renderUnitOption(e,t))))}renderUnitOption(e,t){const{layer:s}=n.s,l=s.renderer,r=T.find((t=>"input"===e?t.key===l.inputUnit:t.key===l.outputUnit));return(0,a.h)("calcite-combobox-item",{value:t.key,textLabel:t.title,selected:!!r&&t===r})}renderDoneButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,a.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}getExactBeaufortUnit(e){switch(e=null!=e?e:"meter-per-second"){case"knots":return"beaufort-kn";case"meter-per-second":return"beaufort-m";case"mile-per-hour":return"beaufort-mi";case"kilometer-per-hour":return"beaufort-km";case"feet-per-second":return"beaufort-ft"}}resetOutputUnit(e,t){let s;switch(e){case"ocean-current-kn":case"wind-barb":s="knots";break;case"ocean-current-m":s="meter-per-second"}s&&(t.outputUnit=s)}handleSymbolScaleChange(e,t){const{layer:s}=n.s,a=s.renderer,l=(0,n.a)(a,"size");l.minSize=e,l.maxSize=t,(0,n.ab)()}handleInvertSymbolsChange(e){const{layer:t}=n.s;t.renderer.flowRepresentation=e,(0,n.ab)()}handleUnitSelectClick(e){const{layer:t}=n.s,s=t.renderer;"input"===e?s.inputUnit=this.inputUnitNode.value:(s.outputUnit=this.outputUnitNode.value,s.style.includes("beaufort")&&(s.style=this.getExactBeaufortUnit(s.outputUnit))),(0,n.ab)()}togglePopover(){const{flowItemNode:e}=this,{strings:t}=n.s;this.popoverNode=document.createElement("arcgis-smart-mapping-info-popover"),this.popoverNode.props={title:t.panels.vectorField.invertSymbols,flowItemNode:e,moreInfo:t.panels.vectorField.invertSymbolsTip},this.popoverNode.referenceElement=this.buttonNode,this.popoverNode.addEventListener("arcgisSmartMappingInfoPopoverClose",(e=>{e.stopPropagation(),this.removePopover(),this.buttonNode.setFocus()})),document.body.appendChild(this.popoverNode),this.popoverNode.setOpen(!0),this.popoverOpen=!0,setTimeout((()=>{this.documentClickHandler=e=>{(0,p.i)(e.target)||this.removePopover()},document.addEventListener("click",this.documentClickHandler)}))}removePopover(){document.body.querySelectorAll(".arcgis-smart-mapping-popover").forEach((e=>document.body.removeChild(e))),this.popoverNode=null,this.popoverOpen=!1,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0)}get hostElement(){return(0,a.d)(this)}};E.style=":host{width:100%}.flow-item{height:100%}.vector-field-block{overflow-x:hidden}.invert-symbol-wrapper{display:flex;justify-content:space-between}.invert-symbol-margin{margin-right:inherit;margin-left:0.35rem}.arcgis--rtl .invert-symbol-margin{margin-left:inherit;margin-right:0.35rem}.invert-symbol-switch{padding-top:6px}.magnitude-input-section{display:flex;justify-content:space-between;margin-top:-10px;margin-bottom:16px}.magnitude-input{width:48%}"},36238:(e,t,s)=>{s.d(t,{a:()=>c,b:()=>u,c:()=>n,d:()=>a,e:()=>l,f:()=>d,g:()=>p,i:()=>r,m:()=>i,t:()=>o,u:()=>h});const a=(e,t)=>{let s,a="idle";const n=(...n)=>new Promise((l=>{switch(a){case"flushed":a="idle",s?(clearTimeout(s),l(e(...n))):l(null);break;case"invoked":clearTimeout(s),a="idle",l(e(...n));break;case"cancelled":clearTimeout(s),a="idle",l(null);break;default:s&&clearTimeout(s),a="pending",s=setTimeout((()=>(a="idle",l(e(...n)))),t)}}));return n.flush=function(...e){return a="flushed",n(...e)},n.invoke=function(...e){return a="invoked",n(...e)},n.cancel=function(...e){return a="cancelled",n(...e)},n.getStatus=function(){return a},n},n=(e,t)=>{let s;return(...a)=>new Promise((n=>{s||(s=setTimeout((()=>{clearTimeout(s),s=void 0,n(e(...a))}),t))}))};function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r(e){return null!=e}async function i(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:s,data:a}=t(e);return[s,a]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,s)=>e&&t.indexOf(s)>-1),!0);function h(e,t){const s=[],a={};return e.forEach((e=>{const n=t(e);null==a[n]&&(a[n]=e,s.push(e))})),s}function u(e){const t={boolean:{},number:{},string:{}},s=[];return e.filter((e=>{let a=typeof e;return a in t?!t[a].hasOwnProperty(e)&&(t[a][e]=!0):!(s.indexOf(e)>=0)&&s.push(e)}))}const p=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((s,a)=>e.slice(t*a,t+t*a)))},5996:(e,t,s)=>{let a,n;function l(e){e.loading=!1}function r(e,t){return function(e){e.loading=!0,n=!1,a&&clearTimeout(a),a=setTimeout((()=>{l(e),n=!0}),6e4)}(t),e.then((e=>(l(t),n?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(l(t),Promise.reject(e))))}s.d(t,{r:()=>r})},69135:(e,t,s)=>{function a(e){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===(null==e?void 0:e.tagName))return!0;{let t=null==e?void 0:e.parentElement;for(;t;){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===t.tagName)return!0;t=t.parentElement}}return!1}s.d(t,{i:()=>a})},3164:(e,t,s)=>{s.d(t,{a:()=>l,b:()=>o,c:()=>i,d:()=>r,g:()=>c});var a=s(9225),n=(s(69283),s(49306),s(92656));function l(){const{layer:e,modules:t}=a.s,s=e,n="imagery"===s.type?s.rasterFunction:void 0;return t.RasterVectorFieldCreator.createRenderer({layer:s,rasterFunction:n}).then((e=>(s.effect=void 0,s.renderer=e.renderer,Promise.resolve(e))),(e=>Promise.reject(e)))}function r(e){const{layer:t,modules:s}=a.s,n=t,l=n.renderer,r="imagery"===n.type?n.rasterFunction:void 0;return e=e||{},s.RasterVectorFieldCreator.createRenderer({layer:n,rasterFunction:r,style:e.style||l.style}).then((e=>{e.renderer.symbolTileSize=l.symbolTileSize;const t=(0,a.a)(l,"size");return e.renderer.visualVariables=(0,a.n)(e.renderer,"size")||[],e.renderer.visualVariables.push(t),e.renderer.flowRepresentation=l.flowRepresentation,e.renderer.inputUnit=l.inputUnit,e.renderer.outputUnit=l.outputUnit,Promise.resolve(e)}),(e=>Promise.reject(e)))}function i(){const{layer:e,modules:t}=a.s,s=e,l="imagery"===s.type?s.rasterFunction:void 0,r=(0,n.c)([[245,245,0],[255,0,0]].map((e=>new t.esriColor(e))));return t.RasterClassBreaksCreator.createRenderer({layer:s,rasterFunction:l,colorRamp:r}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),Promise.resolve(e))))}function o(e){const{layer:t,modules:s}=a.s,n=t,l=n.renderer,r="imagery"===n.type?n.rasterFunction:void 0;return s.RasterClassBreaksCreator.createRenderer({layer:n,rasterFunction:r,field:e.field||l.field,classificationMethod:e.classificationMethod||l.authoringInfo.classificationMethod,numClasses:e.numClasses||l.classBreakInfos.length,colorRamp:l.authoringInfo.colorRamp,definedInterval:e.definedInterval}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),Promise.resolve(e))))}function c(){var e;const{layer:t,modules:s,strings:n}=a.s,l=t;let r;const{rasterInfo:i}=l,o=null===(e=null==i?void 0:i.attributeTable)||void 0===e?void 0:e.fields;return r=o?o.filter((e=>"oid"!==e.type&&"string"!==e.type)):[new s.Field({name:"value",alias:n.panels.classBreaks.value})],r}},14221:(e,t,s)=>{s.d(t,{a:()=>l,c:()=>n,f:()=>r});var a=s(9225);function n(e){const{layer:t,mapView:s,modules:n}=a.s,l=t;return e=e||{},n.RasterFlowCreator.createRenderer({layer:l,view:s,theme:e.flowTheme||"flow-line",includeColorVariable:e.includeColorVariable,legendOptions:e.legendOptions,flowRepresentation:e.flowRepresentation,flowScheme:e.flowScheme||r()}).then((t=>(t.layerEffect&&-1===t.layerEffect.indexOf("drop-shadow")&&(l.effect=t.layerEffect),t.renderer.color=t.renderer.color&&(e.color||t.renderer.color),l.renderer=t.renderer,Promise.resolve(t))),(e=>Promise.reject(e)))}function l(e){var t;const{layer:s,mapView:n,modules:l}=a.s,i=s;e=e||{};const o=i.renderer,c=(0,a.a)(o,"color"),d=o.authoringInfo,h=e.flowTheme||(null==d?void 0:d.flowTheme)||"flow-line";return l.RasterFlowCreator.createRenderer({layer:i,view:n,theme:h,includeColorVariable:null!==(t=e.includeColorVariable)&&void 0!==t?t:!!c,legendOptions:e.legendOptions||(null==c?void 0:c.legendOptions),flowRepresentation:e.flowRepresentation||o.flowRepresentation,flowScheme:e.flowScheme}).then((t=>{const s=(0,a.p)(o,"color"),n=(0,a.p)(t.renderer,"color");(null==s?void 0:s.minSliderValue)&&(null==s?void 0:s.maxSliderValue)&&n&&(n.minSliderValue=s.minSliderValue,n.maxSliderValue=s.maxSliderValue);const c=(0,a.a)(i.renderer,"color"),u=(0,a.a)(t.renderer,"color");return c&&u&&c.stops.forEach(((e,t)=>{u.stops[t].value=e.value})),t.renderer.color=t.renderer.color&&(e.color||o.color||t.renderer.color),(e.flowScheme||r())&&c&&u&&c.stops.forEach(((e,t)=>{u.stops[t].color=new l.esriColor(e.color.toJSON())})),h===d.flowTheme&&(t.renderer.flowSpeed=o.flowSpeed,t.renderer.density=o.density,t.renderer.trailLength=o.trailLength,t.renderer.trailWidth=o.trailWidth,t.renderer.trailCap=o.trailCap),Promise.resolve(t)}),(e=>Promise.reject(e)))}function r(){const{layer:e,mapView:t,modules:s}=a.s,n=e.renderer,l=(0,a.a)(n,"color");if(!l)return null;const r=l.stops.map((e=>e.color)),i=s.flowSchemes.getSchemes({basemap:t.map.basemap||"topo"}),o=[i.primaryScheme].concat(i.secondarySchemes),c=[];return o.forEach((e=>{let t=r.some(((t,s)=>!(0,a.a4)(e.colors[s],t)));t?(e.colors=e.colors.reverse(),t=r.some(((t,s)=>!(0,a.a4)(e.colors[s],t))),t||c.push(e)):c.push(e)})),c.length?c[0]:null}s(69283),s(49306)}}]);