/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c13757.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c13757"],{1918:(e,t,i)=>{i.r(t),i.d(t,{arcgis_schema_editor_category:()=>l,arcgis_schema_editor_category_row:()=>d});var a=i(81149),r=i(45449),o=i(85984),n=i(90406),s=i(36238);const c="arcgis-schema-editor-category-row__drag-handle",l=class{constructor(e){(0,a.r)(this,e),this.arcgisSchemaEditorInternalDeleteClick=(0,a.c)(this,"arcgisSchemaEditorInternalDeleteClick",7),this.listOrderChanged=(0,a.c)(this,"listOrderChanged",7),this.itemRefs={},this.isMaxDepth=!1,this.isRoot=!1,this.renderCategoryContainer=()=>{const{category:e,canAddCategory:t,isRoot:i,isCollapsed:r,isAddingCategory:n,isBeingDragged:s,canEditCategory:c,saveNewTitle:l,saveNewCategory:d,maxDepth:g,i18n:h,isMoveValid:u,canDeleteCategory:y,newCategoryMode:p,isMaxDepth:C}=this,m=e.path,f=r||s;return(0,a.h)("ul",{class:{"arcgis-schema-editor-category__category-container":!0,"arcgis-schema-editor-category__category-container__hidden":f,"arcgis-schema-editor-category__category-container--root":i},ref:e=>this.dragContainerRef=e},e.categories.map((e=>{const i=e.path;return(0,a.h)("li",{key:i},(0,a.h)("arcgis-schema-editor-category",{category:e,newCategoryMode:p,canAddCategory:t,canDeleteCategory:y,canEditCategory:c,i18n:h,maxDepth:g,isMoveValid:u,saveNewTitle:l,saveNewCategory:d,ref:e=>this.itemRefs[i]=e}))})),(0,a.h)("arcgis-schema-editor-category-row",{class:{"arcgis-schema-editor-category__new-category--hide":!n},category:{categories:[],count:0,path:(0,o.a)(m,{title:"new-category"}),title:""},isCollapsible:!1,isCollapsed:!0,isNewCategory:!0,canDeleteCategory:!1,canEditCategory:()=>!0,i18n:h,onArcgisSchemaEditorInternalCancelClick:()=>this.isAddingCategory=!1,saveNewTitle:async e=>{const t=await d(e);return t&&(this.isAddingCategory=!1),t},ref:e=>this.newCategoryRef=e}),(0,a.h)("calcite-button",{appearance:"transparent",kind:"neutral",onClick:()=>this.isAddingCategory=!0,iconStart:"plus-circle",ref:e=>this.addCategoryButtonRef=e,class:{"arcgis-schema-editor-category__add-category-btn--hide":n||C||s||!t||r}}),(0,a.h)("calcite-tooltip",{referenceElement:this.addCategoryButtonRef},(0,a.h)("div",null,i?h.categoryItem.addCategory:h.categoryItem.addSubcategory)))},this.category=void 0,this.canAddCategory=void 0,this.canDeleteCategory=void 0,this.newCategoryMode=void 0,this.showInputByDefault=!1,this.canEditCategory=void 0,this.maxDepth=void 0,this.i18n=void 0,this.isMoveValid=void 0,this.saveNewTitle=void 0,this.saveNewCategory=void 0,this.isCollapsed=!1,this.isBeingDragged=!1,this.isAddingCategory=!1,this.addCategoryButtonRef=void 0}componentWillLoad(){const e=this.category.path;this.isRoot=null===e,this.isMaxDepth=!this.isRoot&&(0,n.f)(e)>this.maxDepth,this.isCollapsed=this.newCategoryMode&&!this.isRoot}componentDidLoad(){this.onShowInputByDefaultChange(),new r.S(this.dragContainerRef,{group:"arcgis-schema-editor",animation:200,handle:`.${c}`,chosenClass:"arcgis-schema-editor-category-row--dragging",onSort:e=>{const{from:t,to:i,oldIndex:a,newIndex:r,item:o}=e,n={fromCategory:t.closest("arcgis-schema-editor-category").category,toCategory:i.closest("arcgis-schema-editor-category").category,fromItemCategory:o.querySelector("arcgis-schema-editor-category").category,fromIndex:a,toIndex:r},s=!this.isMoveValid||this.isMoveValid(n);null!==s&&(s?this.listOrderChanged.emit(n):t.insertBefore(o,t.children[a>r?a+1:a]))},setData:e=>{e.setData("foo","bar")}})}onShowInputByDefaultChange(){this.isAddingCategory=this.newCategoryMode&&this.isRoot&&this.showInputByDefault}onIsAddingCategoryChange(){var e;null===(e=this.newCategoryRef)||void 0===e||e.reset()}async expandOrCollapseAll(e){this.isRoot||(this.isCollapsed=e),Object.values(this.itemRefs).forEach((t=>{null==t||t.expandOrCollapseAll(e)}))}async setIsBeingDragged(e){this.category.categories.length>0&&(this.isBeingDragged=e)}render(){const{category:e,canDeleteCategory:t,canEditCategory:i,isRoot:r,isMaxDepth:o,isCollapsed:n,i18n:s,renderCategoryContainer:c,saveNewTitle:l,arcgisSchemaEditorInternalDeleteClick:d}=this;return(0,a.h)(a.H,null,!r&&(0,a.h)("arcgis-schema-editor-category-row",{category:e,isCollapsible:!o,isCollapsed:n,canDeleteCategory:t,canEditCategory:e=>i({category:e,parentCategory:this.category}),i18n:s,onArcgisSchemaEditorInternalDeleteClick:e=>{e.stopPropagation(),d.emit(e.detail)},onArcgisSchemaEditorInternalExpandClick:e=>this.isCollapsed=e.detail.isCollapsed,saveNewTitle:l}),c())}get el(){return(0,a.d)(this)}static get watchers(){return{showInputByDefault:["onShowInputByDefaultChange"],isAddingCategory:["onIsAddingCategoryChange"]}}};l.style=".arcgis-schema-editor-category__category-container{list-style-type:none;margin-top:0px;margin-bottom:0px;margin-bottom:0.25rem;padding-inline-start:1rem;margin-inline-start:1rem;border-left:1px solid var(--calcite-color-border-2)}.arcgis-schema-editor-category__category-container--root{margin-left:0px;margin-right:0px;padding-left:0px;padding-right:0px;border-width:0px}.arcgis-schema-editor-category__category-container__hidden{display:none}.arcgis-schema-editor-category__add-category-btn--hide,.arcgis-schema-editor-category__new-category--hide{display:none}";const d=class{constructor(e){(0,a.r)(this,e),this.arcgisSchemaEditorInternalDeleteClick=(0,a.c)(this,"arcgisSchemaEditorInternalDeleteClick",7),this.arcgisSchemaEditorInternalExpandClick=(0,a.c)(this,"arcgisSchemaEditorInternalExpandClick",7),this.arcgisSchemaEditorInternalCancelClick=(0,a.c)(this,"arcgisSchemaEditorInternalCancelClick",7),this.onCancelEdit=()=>{const{arcgisSchemaEditorInternalCancelClick:e,isNewCategory:t}=this;t||(this.isEditing=!1),this.editedCategoryTitle=this.category.title,e.emit()},this.onSaveEdit=async()=>{const{category:e,editInputRef:t,editedCategoryTitle:i,saveNewTitle:a,setInvalid:r,isNewCategory:o}=this;if(!i)return r(),!1;if(i===e.title&&!o)return this.isEditing=!1,!0;t.status="idle";try{return await a({newTitle:i,path:e.path,categoryCount:e.count})?(o||(this.isEditing=!1),!0):(r(),!1)}catch(e){return o||(this.isEditing=!1),console.error(e),!1}},this.setInvalid=()=>{const{editInputRef:e}=this;e.status="invalid",e.setFocus()},this.category=void 0,this.i18n=void 0,this.isNewCategory=!1,this.canEditCategory=void 0,this.canDeleteCategory=void 0,this.isCollapsible=void 0,this.isCollapsed=void 0,this.saveNewTitle=void 0,this.isEditing=this.isNewCategory,this.editedCategoryTitle=this.category.title,this.expandCollapseButtonRef=void 0,this.deleteButtonRef=void 0,this.editInputRef=void 0,this.cantEditIconRef=void 0}async reset(){const{isNewCategory:e,category:t,canEditReason:i}=this;e&&!0===i&&(this.editedCategoryTitle=t.title,this.editInputRef.status="idle",this.isEditing=!1,await(0,s.t)(50),this.isEditing=!0,this.editInputRef.setFocus())}async setFocus(){this.editInputRef.setFocus()}componentWillLoad(){var e,t;this.canEditReason=null===(t=null===(e=this.canEditCategory)||void 0===e?void 0:e.call(this,this.category))||void 0===t||t}render(){const{category:e,isCollapsed:t,isEditing:i,isCollapsible:r,canDeleteCategory:o,canEditReason:n,i18n:s,editedCategoryTitle:l,onCancelEdit:d,onSaveEdit:g,arcgisSchemaEditorInternalExpandClick:h,isNewCategory:u}=this,y=e.count,p=i?l:`${l} ${y?`(${y})`:""}`,C=!0===n,m=C&&!i&&!u&&o;return(0,a.h)(a.H,null,(0,a.h)("div",{class:"arcgis-schema-editor-category-row"},!u&&!i&&(0,a.h)("calcite-button",{appearance:"transparent",kind:"neutral",iconStart:"drag",class:c}),r&&(0,a.h)(a.F,null,(0,a.h)("calcite-button",{appearance:"transparent",kind:"neutral",onClick:()=>h.emit({isCollapsed:!t}),iconStart:t||i?"chevron-up":"chevron-down",class:"cta",ref:e=>this.expandCollapseButtonRef=e}),(0,a.h)("calcite-tooltip",{referenceElement:this.expandCollapseButtonRef},(0,a.h)("div",{class:"btn-popover"},t?s.categoryItem.expand:s.categoryItem.collapse))),C?(0,a.h)("calcite-inline-editable",{class:"arcgis-schema-editor-category-row__inline-input",controls:!0,editingEnabled:i,afterConfirm:async()=>{if(!1===await g())throw new Error},onCalciteInlineEditableEditCancel:e=>{e.stopPropagation(),d()},onCalciteInternalInlineEditableEnableEditingChange:()=>this.isEditing=!0},(0,a.h)("calcite-input",{value:p,onCalciteInputInput:e=>this.editedCategoryTitle=e.target.value,required:!0,ref:e=>this.editInputRef=e})):(0,a.h)(a.F,null,(0,a.h)("div",{class:"arcgis-schema-editor-category-row__inline-input"},p),(0,a.h)("calcite-action",{class:"arcgis-schema-editor-category-row__cant-edit-reason",icon:"exclamation-mark-triangle-f",appearance:"transparent",label:n,ref:e=>this.cantEditIconRef=e,text:"",textEnabled:!1}),(0,a.h)("calcite-tooltip",{referenceElement:this.cantEditIconRef},(0,a.h)("div",{class:"btn-popover"},n))),m&&(0,a.h)(a.F,null,(0,a.h)("calcite-button",{appearance:"transparent",kind:"danger",onClick:()=>this.arcgisSchemaEditorInternalDeleteClick.emit({path:e.path,categoryCount:y}),iconStart:"trash",class:"cta",ref:e=>this.deleteButtonRef=e}),(0,a.h)("calcite-tooltip",{referenceElement:this.deleteButtonRef},(0,a.h)("div",{class:"btn-popover"},s.categoryItem.deleteCategory)))))}get el(){return(0,a.d)(this)}};d.style=".arcgis-schema-editor-category-row{display:flex;align-items:center;background-color:var(--calcite-color-foreground-1);height:2.5rem;margin-bottom:0.25rem}.arcgis-schema-editor-category-row--editing{padding-left:0.5rem;padding-right:0.5rem}.arcgis-schema-editor-category-row__inline-input{font-size:0.875rem;width:100%}.arcgis-schema-editor-category-row__cta{display:flex;align-items:center;justify-content:center;height:100%;width:2.5rem}.arcgis-schema-editor-category-row__drag-handle{height:100%}.arcgis-schema-editor-category-row__btn-popover{white-space:nowrap;padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem}.arcgis-schema-editor-category-row__cant-edit-reason{--calcite-ui-icon-color:var(--calcite-color-status-warning)}.arcgis-schema-editor-category-row--dragging{opacity:0.25}"},85984:(e,t,i)=>{i.d(t,{C:()=>a,U:()=>r,a:()=>o,g:()=>n});const a="/categories",r="/Categories",o=(e,t,i=!0)=>{const a=null!=e?e:"";return`${a}${a.endsWith("/")?"":"/"}${i?t.title.toLocaleLowerCase():t.title}`};function n(e){var t;let i=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return i&&"/"!==i.charAt(0)&&(i=`/${i}`),i||r}},36238:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>h,c:()=>r,d:()=>a,e:()=>o,f:()=>d,g:()=>u,i:()=>n,m:()=>s,t:()=>c,u:()=>g});const a=(e,t)=>{let i,a="idle";const r=(...r)=>new Promise((o=>{switch(a){case"flushed":a="idle",i?(clearTimeout(i),o(e(...r))):o(null);break;case"invoked":clearTimeout(i),a="idle",o(e(...r));break;case"cancelled":clearTimeout(i),a="idle",o(null);break;default:i&&clearTimeout(i),a="pending",i=setTimeout((()=>(a="idle",o(e(...r)))),t)}}));return r.flush=function(...e){return a="flushed",r(...e)},r.invoke=function(...e){return a="invoked",r(...e)},r.cancel=function(...e){return a="cancelled",r(...e)},r.getStatus=function(){return a},r},r=(e,t)=>{let i;return(...a)=>new Promise((r=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,r(e(...a))}),t))}))};function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return null!=e}async function s(e,t){return await Promise.all([e,c(t)]),e}function c(e){return new Promise((t=>setTimeout(t,e)))}const l=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:a}=t(e);return[i,a]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function g(e,t){const i=[],a={};return e.forEach((e=>{const r=t(e);null==a[r]&&(a[r]=e,i.push(e))})),i}function h(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let a=typeof e;return a in t?!t[a].hasOwnProperty(e)&&(t[a][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const u=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,a)=>e.slice(t*a,t+t*a)))},90406:(e,t,i)=>{i.d(t,{M:()=>C,a:()=>s,b:()=>l,c:()=>p,d:()=>o,e:()=>n,f:()=>c,g:()=>r,h:()=>d,i:()=>y});var a=i(85984);const r=(e,{fromCategory:{path:t},toCategory:{path:i},fromIndex:a,toIndex:r})=>{const o=structuredClone(e),n=l(o,t);let s=n;t!==i&&(s=l(o,i));const[c]=n.targetCategory.categories.splice(a,1);return s.targetCategory.categories.splice(r,0,c),g(o)},o=(e,{newTitle:t,path:i})=>{const a=structuredClone(e);return l(a,i).targetCategory.title=t,g(a)},n=(e,{newTitle:t,path:i})=>{const a=structuredClone(e),r=i.replace(/\/[^/]+$/,"");if(r){const{targetCategory:e}=l(a,r);e.categories.push({title:t,categories:[],count:0,path:null})}else a.categories.push({title:t,categories:[],count:0,path:null});return g(a)},s=(e,{path:t})=>{const i=structuredClone(e),{targetIndex:a,parentCategory:r}=l(i,t);return null==r||r.categories.splice(a,1),g(i)},c=e=>{var t;return null!==(t=null==e?void 0:e.replace(a.C,"").slice(1).split("/").length)&&void 0!==t?t:0},l=(e,t)=>{if(null==t||t===a.C)return{targetCategory:e,targetIndex:1,parentCategory:null};const i=t.slice(1).split("/");let r=0===t.indexOf(a.C)?(0,a.a)("",{title:i.shift()}):"",o=null,n=e,s=0;do{r=(0,a.a)(r,{title:i.shift()}),o=n,s=n.categories.findIndex((e=>e.path===r)),n=n.categories[s]}while(i.length>0&&n.categories.length);return{targetCategory:n,targetIndex:s,parentCategory:o}},d=(e,t)=>{var i,r;return{title:"",path:null,count:null!==(r=null===(i=t.fieldValues.find((e=>e.value===a.C)))||void 0===i?void 0:i.count)&&void 0!==r?r:0,categories:u(null,e,t)}},g=e=>e.categories.map(h),h=e=>({title:e.title,categories:e.categories.map(h)}),u=(e,t,i)=>t.map((t=>{var r,o;const n=(0,a.a)(null!=e?e:a.C,t),s=null===(r=i.fieldValues.find((e=>e.value===n)))||void 0===r?void 0:r.count,c=u(n,null!==(o=t.categories)&&void 0!==o?o:[],i);return{title:t.title,path:n,count:null!=s?s:0,categories:c}})),y=e=>e.reduce(((e,t)=>{var i;return e+1+y(null!==(i=t.categories)&&void 0!==i?i:[])}),0),p=({targetCategory:e,targetParentCategory:t})=>{var i;const a=null===(i=e.title.toLocaleLowerCase())||void 0===i?void 0:i.trim();return a?a.length>C?"maxCharacter":t.categories.some((t=>t.title.toLowerCase()===a&&t.path!==e.path))?"destinationHasSameName":null:"emptyTitle"},C=100}}]);