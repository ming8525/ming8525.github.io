"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_privil-794759"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-5c382f61.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-5c382f61.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ isPublicUser),
/* harmony export */   b: () => (/* binding */ isOrgAdmin),
/* harmony export */   c: () => (/* binding */ isHostedPortal),
/* harmony export */   d: () => (/* binding */ isCustomRole),
/* harmony export */   e: () => (/* binding */ canUpdateOrgGroups),
/* harmony export */   f: () => (/* binding */ canUpdateItemCategories),
/* harmony export */   g: () => (/* binding */ canManageCollaborations),
/* harmony export */   h: () => (/* binding */ isOrgUser),
/* harmony export */   i: () => (/* binding */ isDeveloper),
/* harmony export */   j: () => (/* binding */ canShareItemToGroup),
/* harmony export */   k: () => (/* binding */ canShareItemToOrg),
/* harmony export */   l: () => (/* binding */ adminCanShareOthersItemToGroup),
/* harmony export */   m: () => (/* binding */ canShareOthersItemsToOrg),
/* harmony export */   n: () => (/* binding */ canShareItemToPublic),
/* harmony export */   o: () => (/* binding */ canShareOthersItemsToPublic),
/* harmony export */   p: () => (/* binding */ hasAdminSharePrivilege),
/* harmony export */   q: () => (/* binding */ canViewOthersOrgItems)
/* harmony export */ });
/* harmony import */ var _item_3535552d_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./item-3535552d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-3535552d.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const getUserRole = (user) => {
    var _a, _b, _c;
    return typeof (user === null || user === void 0 ? void 0 : user.role) === "string" && !!(user === null || user === void 0 ? void 0 : user.role)
        ? user === null || user === void 0 ? void 0 : user.role
        : (_b = (_a = user === null || user === void 0 ? void 0 : user.roleId) !== null && _a !== void 0 ? _a : user === null || user === void 0 ? void 0 : user.id) !== null && _b !== void 0 ? _b : (_c = user === null || user === void 0 ? void 0 : user.sourceJSON) === null || _c === void 0 ? void 0 : _c.id;
};
function isPublicUser(user) {
    return user && !user.orgId;
}
function isHostedPortal(portal) {
    return !portal.isPortal || !!portal.isBackedBySDS;
}
function isDeveloper(subscriptionInfo) {
    const devSubscriptionTypes = ["Trial Developer", "Developer", "Developer Subscription"];
    return devSubscriptionTypes.includes(subscriptionInfo === null || subscriptionInfo === void 0 ? void 0 : subscriptionInfo.type);
}
function isOrgAdmin(user) {
    return getUserRole(user) === "org_admin" || getUserRole(user) === "account_admin";
}
function isOrgUser(user) {
    return getUserRole(user) === "org_user" || getUserRole(user) === "account_user";
}
function isCustomRole(user) {
    // The Home App collapse the `roleId` and `role` into a single `id` property, that's why
    //  https://devtopia.esri.com/WebGIS/arcgis-portal-app/blob/master/src/js/arcgisonline/sharing/dijit/Role.ts#L469 works
    // In practice, we only need to check if `roleId` exist
    //  https://devtopia.esri.com/WebGIS/arcgis-portal-app/issues/44682#issuecomment-4146866
    return !!(user === null || user === void 0 ? void 0 : user.roleId) && user.roleId.length > 0;
}
/**
 * Checks whether the privilege "portal:admin:updateItemCategorySchema" is granted.
 */
function canUpdateItemCategories(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:updateItemCategorySchema"));
}
/**
 * Checks whether the privilege "portal:admin:updateGroups" is granted.
 */
function canUpdateOrgGroups(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:updateGroups"));
}
/**
 * Checks whether the user is allowed to update other user's items in their organization.
 */
function canUpdateOrgItems(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:admin:updateItems");
}
/**
 * Checks to ensure the portal is an organization portal
 */
function isOrgPortal(portal) {
    return !!(portal.urlKey && portal.customBaseUrl) || !!portal.isPortal;
}
/**
 * Checks whether the user is allowed to share their item to groups
 */
function canShareItemToGroup(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:user:shareToGroup");
}
/**
 * Checks whether the user can share an item on a given portal
 */
function canShare(user, portal) {
    return (!isOrgPortal(portal) ||
        canShareItemToGroup(user) ||
        canShareItemToOrg(user) ||
        (!!portal.canSharePublic && canShareItemToPublic(user)));
}
/**
 * Checks whether the user is allowed to share their item ot the organization.
 */
function canShareItemToOrg(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:user:shareToOrg");
}
/**
 * Checks whether the user is allowed to share their item to public
 */
function canShareItemToPublic(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:user:shareToPublic");
}
/**
 * Checks whether the user can share other user's items
 */
function canShareOthersItemsToOrg(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:admin:shareToOrg");
}
/**
 * Checks whether the user can share other user's items
 */
function canShareOthersItemsToPublic(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:admin:shareToPublic");
}
/**
 * Checks whether the user can share other user's items
 */
function adminCanShareOthersItemToGroup(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:admin:shareToGroup");
}
/**
 * Checks whether the user is in an allowed organization and has the power to manage collaborations
 */
function canManageCollaborations(config, user, portal, subscriptionInfo) {
    const excludedOrgTypes = ["Trial", "Trial Press", "Trial Developer", "Developer Subscription", "Evaluation"];
    const isValidOrgType = subscriptionInfo && !excludedOrgTypes.includes(subscriptionInfo.type);
    const hasPrivilege = ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:admin:manageCollaborations");
    return !!((config === null || config === void 0 ? void 0 : config.collaborationsEnabled) &&
        user &&
        (isOrgAdmin(user) || hasPrivilege) &&
        ((portal === null || portal === void 0 ? void 0 : portal.isPortal) || isValidOrgType));
}
/**
 * Checks whether the user can view other organization users' items
 */
function canViewOrgItems(user) {
    return ((user === null || user === void 0 ? void 0 : user.privileges) || []).includes("portal:admin:viewItems");
}
/**
 * Checks whether the user can view other organization users' items
 */
function canViewOthersOrgItems(user) {
    return !!user && (!isCustomRole(user) || (isCustomRole(user) && canViewOrgItems(user)));
}
// TODO: add unit tests
const hasAdminSharePrivilege = ({ items, user, portal }) => {
    const item = items[0];
    // enterprise incorrectly returns items owned by "esri_" as item control admin (WebGIS/arcgis-portal-app#38695)
    const owner = item.owner;
    const whitelistOwner = ["esri_livingatlas"];
    if (portal.isPortal && owner !== user.username && owner.includes("esri_") && !whitelistOwner.includes(owner)) {
        return false;
    }
    const isOwnerOrAdmin = (0,_item_3535552d_js__WEBPACK_IMPORTED_MODULE_0__.u)(item, user);
    const isCustom = isCustomRole(user);
    const canShareOrgItems = canShareOthersItems(user);
    const canUpdateAndShare = (0,_item_3535552d_js__WEBPACK_IMPORTED_MODULE_0__.c)(item, user) &&
        canUpdateOrgItems(user) &&
        !isCustom &&
        (canShare(user, portal) || canShareOthersItems(user));
    // if it's the item owner or admin, or custom admin who can share
    return isOwnerOrAdmin || canUpdateAndShare || ((0,_item_3535552d_js__WEBPACK_IMPORTED_MODULE_0__.d)(items, user) && canShareOrgItems);
};
/**
 * Checks whether the user can share other user's items
 */
function canShareOthersItems(user) {
    return adminCanShareOthersItemToGroup(user) || canShareOthersItemsToOrg(user) || canShareOthersItemsToPublic(user);
}



//# sourceMappingURL=privileges-5c382f61.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-74639dae.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-74639dae.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ canPublishType),
/* harmony export */   b: () => (/* binding */ canPublishFeatures),
/* harmony export */   c: () => (/* binding */ canPublishFromCloud),
/* harmony export */   d: () => (/* binding */ canCreateDeveloperCredentials),
/* harmony export */   e: () => (/* binding */ canPublishImageCollection),
/* harmony export */   f: () => (/* binding */ fetchUserLicensedItems),
/* harmony export */   g: () => (/* binding */ canPublishTiles),
/* harmony export */   h: () => (/* binding */ canPublishScenes),
/* harmony export */   i: () => (/* binding */ canCreateLocatorView),
/* harmony export */   j: () => (/* binding */ canCreateLocator),
/* harmony export */   k: () => (/* binding */ canCreateDataStore),
/* harmony export */   l: () => (/* binding */ canCreateItems),
/* harmony export */   m: () => (/* binding */ canGeocode),
/* harmony export */   n: () => (/* binding */ canReceiveItems),
/* harmony export */   o: () => (/* binding */ canShowTotalCredits),
/* harmony export */   p: () => (/* binding */ canAddAPIKey),
/* harmony export */   q: () => (/* binding */ getWorldGeocoderUrl),
/* harmony export */   r: () => (/* binding */ canCreateNotebooks),
/* harmony export */   s: () => (/* binding */ canCreateAdvancedNotebooks),
/* harmony export */   t: () => (/* binding */ canViewOrgGroups),
/* harmony export */   u: () => (/* binding */ canManageItems)
/* harmony export */ });
/* harmony import */ var _portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./portal-d518b571.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-d518b571.js");
/* harmony import */ var _privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./privileges-5c382f61.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-5c382f61.js");
/* harmony import */ var _config_75adf962_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config-75adf962.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-75adf962.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




async function getWorldGeocoderUrl() {
    return new Promise(async (resolve) => {
        const { portal } = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_2__.c;
        if (!(portal === null || portal === void 0 ? void 0 : portal.isPortal)) {
            const env = getEnvironment(portal);
            resolve(`https://geocode${env}.arcgis.com/arcgis/rest/services/World/GeocodeServer`);
        }
        else {
            const geocoders = portal.helperServices.geocode;
            const url = await getWorldGeocoderUrlFromProxies(geocoders);
            resolve(url);
        }
    });
}
function getEnvironment(portal) {
    const hostname = portal === null || portal === void 0 ? void 0 : portal.portalHostname;
    if (hostname.indexOf("dev") !== -1) {
        return "dev";
    }
    else if (hostname.indexOf("qa") !== -1) {
        return "qa";
    }
    return "";
}
function getWorldGeocoderUrlFromProxies(geocoders) {
    const { config, portal } = _config_75adf962_js__WEBPACK_IMPORTED_MODULE_2__.c;
    return new Promise(async (resolve, reject) => {
        const esriBatchGeocoder = geocoders
            .filter((geocoder) => isServiceProxyGeocoder(geocoder.url, portal))
            .filter((proxy) => proxy.isEsriBatchGeocoder)[0];
        if (esriBatchGeocoder) {
            // Make sure world geocoder is configured
            const id = parseGeocoderItemId(esriBatchGeocoder);
            const url = `${config.restBaseUrl}/content/items/${id}`;
            try {
                const geocoderItem = await (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.r)(url);
                resolve(geocoderItem.url);
            }
            catch (err) {
                reject(err);
            }
        }
        else {
            reject("No world geocoder configured");
        }
    });
}
function isServiceProxyGeocoder(url = "", portal) {
    var _a;
    const isPortal = portal.isPortal;
    const lowerUrl = url.toLowerCase(), hasProxiedGeocodePaths = lowerUrl.indexOf("/geocodeserver") > -1 && lowerUrl.indexOf("/rest/services/") > -1;
    const isPortalProxy = isPortal && lowerUrl.indexOf((_a = portal.portalHostname) === null || _a === void 0 ? void 0 : _a.toLowerCase()) > -1;
    const isAGOLProxy = !isPortal && lowerUrl.indexOf("utility") && lowerUrl.indexOf(".arcgis.com") > -1;
    return hasProxiedGeocodePaths && (isPortalProxy || isAGOLProxy);
}
function parseGeocoderItemId(geocoder) {
    return geocoder.url.split("/servers/")[1].split("/rest/services/")[0];
}

function canPublish(user, portal, userLicensedItems) {
    return (!(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) &&
        !!portal.supportsHostedServices &&
        canCreateItems(user) &&
        (canPublishTiles(user, portal) ||
            canPublishFeatures(user, portal) ||
            canPublishScenes(user) ||
            canPublishVectorTiles(user) ||
            canPublishImageCollection(user, portal, userLicensedItems)));
}
function canCreateItems(user) {
    return (0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) || (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:user:createItem"));
}
function canReceiveItems(user) {
    return (0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) || (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:user:receiveItems"));
}
function canPublishFeatures(user, portal) {
    return (!(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) &&
        (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:publisher:publishFeatures")) &&
        (!portal.isPortal || portal.isBackedBySDS));
}
function canPublishTiles(user, portal) {
    return (!(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) &&
        (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:publisher:publishTiles")) &&
        (!portal.isPortal || portal.isBackedBySDS));
}
function canPublishVectorTiles(user) {
    return !(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) && true; // this privilege doesn't exist yet
}
function canPublishScenes(user) {
    var _a;
    return !(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) && ((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:publishScenes"));
}
const canCreateDeveloperCredentials = (user) => !(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user);
function canPublishImageCollection(user, portal, userLicensedItems) {
    var _a, _b;
    const serverSupportsRasterAnalytics = !!((_b = (_a = portal.helperServices) === null || _a === void 0 ? void 0 : _a.rasterAnalytics) === null || _b === void 0 ? void 0 : _b.url);
    const canPublishDynamic = canPublishDynamicImagery(user, portal, userLicensedItems);
    const canPublish = portal.isPortal
        ? canPublishDynamic
        : canPublishDynamic || canPublishTiledImagery(user, portal, userLicensedItems);
    return serverSupportsRasterAnalytics && canPublish;
}
function canPublishDynamicImagery(user, portal, userLicensedItems) {
    var _a;
    return (((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:publishDynamicImagery")) &&
        (portal.isPortal || hasImageEntitlement(userLicensedItems)));
}
function canPublishTiledImagery(user, portal, userLicensedItems) {
    var _a;
    return (((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:publishTiledImagery")) &&
        !portal.isPortal &&
        hasImageEntitlement(userLicensedItems));
}
function hasImageEntitlement(userLicensedItems) {
    return userLicensedItems === null || userLicensedItems === void 0 ? void 0 : userLicensedItems.some((licensedItem) => { var _a; return (_a = licensedItem.entitlements) === null || _a === void 0 ? void 0 : _a.some((entitlement) => entitlement.toLowerCase() === "image"); });
}
async function fetchUserLicensedItems(portal) {
    var _a;
    const { userLicensedItems } = await (0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.r)(`${(_a = portal.restUrl) !== null && _a !== void 0 ? _a : portal.portalUrl}/community/self?returnUserLicensedItems=true`);
    return userLicensedItems;
}
function canCreateLocatorView(user, portal) {
    var _a, _b;
    const hasWorldGeocoder = (_a = portal.helperServices) === null || _a === void 0 ? void 0 : _a.geocode.some(({ url }) => isServiceProxyGeocoder(url, portal));
    const privileges = (_b = user === null || user === void 0 ? void 0 : user.privileges) !== null && _b !== void 0 ? _b : [];
    return (!(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) &&
        hasWorldGeocoder &&
        (!portal.isPortal ||
            (!(0,_portal_d518b571_js__WEBPACK_IMPORTED_MODULE_0__.i)(portal) &&
                // https://devtopia.esri.com/WebGIS/arcgis-portal-app/issues/40338
                privileges.includes("portal:user:viewOrgItems") &&
                privileges.includes("portal:user:createItem"))));
}
const canCreateLocator = (user) => !(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user);
function canCreateAdvancedNotebooks(user) {
    return user === null || user === void 0 ? void 0 : user.privileges.includes("premium:publisher:createAdvancedNotebooks");
}
function canCreateNotebooks(user) {
    return user === null || user === void 0 ? void 0 : user.privileges.includes("premium:publisher:createNotebooks");
}
function canCreateDataStore(user, portal) {
    var _a;
    return !!portal.isPortal && !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:registerDataStores"));
}
function canGeocode(user) {
    return !(0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.a)(user) && (user === null || user === void 0 ? void 0 : user.privileges.includes("premium:user:geocode"));
}
function canPublishFromCloud(user, portal, userLicensedItems) {
    return !portal.isPortal && canPublishFeatures(user, portal) && canPublish(user, portal, userLicensedItems);
}
function canPublishServiceDefinition(user, portal) {
    return canPublishFeatures(user, portal) && canPublishTiles(user, portal);
}
function canPublishType(user, type, portal) {
    switch (type) {
        case "CSV":
        case "GeoJson":
        case "Microsoft Excel":
        case "Shapefile":
        case "File Geodatabase":
        case "Photos with Locations":
            return canPublishFeatures(user, portal);
        case "Tile Package":
            return canPublishTiles(user, portal);
        case "Vector Tile Package":
            return canPublishVectorTiles(user);
        case "Scene Package":
            return canPublishScenes(user);
        case "Service Definition":
            return canPublishServiceDefinition(user, portal);
        default:
            return true;
    }
}
function canManageCredits(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:manageCredits"));
}
function canShowTotalCredits(user, portal) {
    var _a, _b, _c;
    return ((0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.b)(user) ||
        canManageCredits(user) ||
        !!(((_a = user === null || user === void 0 ? void 0 : user.assignedCredits) !== null && _a !== void 0 ? _a : (_b = user === null || user === void 0 ? void 0 : user.sourceJSON) === null || _b === void 0 ? void 0 : _b.assignedCredits) > -1 &&
            ((_c = portal === null || portal === void 0 ? void 0 : portal.portalProperties) === null || _c === void 0 ? void 0 : _c.showCreditsOnProfile)));
}
const canAddAPIKey = (_) => false;
// temporarily disable for now https://devtopia.esri.com/WebGIS/arcgis-portal-app/issues/42863
// ["Trial Developer", "Developer", "Developer Subscription"].includes(subscriptionType);
function canViewOrgGroups(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:viewGroups"));
}
function canViewOrgItems(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:viewItems"));
}
function canViewUsers(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:viewUsers"));
}
function canUpdateOrgItems(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:updateItems"));
}
function canDeleteOrgItems(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:deleteItems"));
}
function canReassignOrgItems(user) {
    var _a;
    return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:reassignItems"));
}
function canManageItems(user) {
    return ((0,_privileges_5c382f61_js__WEBPACK_IMPORTED_MODULE_1__.b)(user) ||
        (canViewUsers(user) &&
            canViewOrgItems(user) &&
            (canUpdateOrgItems(user) || canDeleteOrgItems(user) || canReassignOrgItems(user))));
}



//# sourceMappingURL=privileges-74639dae.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fcHJpdmlsLTc5NDc1OS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUN5Rzs7QUFFekc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxxQkFBcUI7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsb0RBQWU7QUFDMUM7QUFDQTtBQUNBLDhCQUE4QixvREFBYTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxvREFBb0I7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXliOztBQUV6Yjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzlKQTtBQUNBO0FBQ0E7QUFDQTtBQUN3RTtBQUNNO0FBQ3RCOztBQUV4RDtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVMsRUFBRSxrREFBVztBQUN0QztBQUNBO0FBQ0Esc0NBQXNDLElBQUk7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksaUJBQWlCLEVBQUUsa0RBQVc7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsbUJBQW1CLGlCQUFpQixHQUFHO0FBQ2xFO0FBQ0EsMkNBQTJDLHNEQUFPO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLDBEQUFZO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMERBQVk7QUFDdkI7QUFDQTtBQUNBLFdBQVcsMERBQVk7QUFDdkI7QUFDQTtBQUNBLGFBQWEsMERBQVk7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDBEQUFZO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwwREFBWSxnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsWUFBWSwwREFBWTtBQUN4QjtBQUNBLGlEQUFpRCwwREFBWTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0SEFBNEgsUUFBUSwrSUFBK0k7QUFDblI7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvQkFBb0IsUUFBUSxzREFBTyxJQUFJLHdFQUF3RTtBQUMzSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtIQUFrSCxLQUFLO0FBQ3ZIO0FBQ0EsYUFBYSwwREFBWTtBQUN6QjtBQUNBO0FBQ0EsY0FBYyxzREFBYTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywwREFBWTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwwREFBWTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMERBQVU7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMERBQVU7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7O0FBRW9oQjs7QUFFcGhCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vcHJpdmlsZWdlcy01YzM4MmY2MS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9wcml2aWxlZ2VzLTc0NjM5ZGFlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgdSBhcyB1c2VySXNJdGVtQWRtaW4sIGMgYXMgY2FuVXBkYXRlSXRlbSwgZCBhcyBpdGVtc0JlbG9uZ1RvVXNlck9yZyB9IGZyb20gJy4vaXRlbS0zNTM1NTUyZC5qcyc7XG5cbmNvbnN0IGdldFVzZXJSb2xlID0gKHVzZXIpID0+IHtcbiAgICB2YXIgX2EsIF9iLCBfYztcbiAgICByZXR1cm4gdHlwZW9mICh1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucm9sZSkgPT09IFwic3RyaW5nXCIgJiYgISEodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnJvbGUpXG4gICAgICAgID8gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnJvbGVcbiAgICAgICAgOiAoX2IgPSAoX2EgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucm9sZUlkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIuaWQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IChfYyA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5zb3VyY2VKU09OKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuaWQ7XG59O1xuZnVuY3Rpb24gaXNQdWJsaWNVc2VyKHVzZXIpIHtcbiAgICByZXR1cm4gdXNlciAmJiAhdXNlci5vcmdJZDtcbn1cbmZ1bmN0aW9uIGlzSG9zdGVkUG9ydGFsKHBvcnRhbCkge1xuICAgIHJldHVybiAhcG9ydGFsLmlzUG9ydGFsIHx8ICEhcG9ydGFsLmlzQmFja2VkQnlTRFM7XG59XG5mdW5jdGlvbiBpc0RldmVsb3BlcihzdWJzY3JpcHRpb25JbmZvKSB7XG4gICAgY29uc3QgZGV2U3Vic2NyaXB0aW9uVHlwZXMgPSBbXCJUcmlhbCBEZXZlbG9wZXJcIiwgXCJEZXZlbG9wZXJcIiwgXCJEZXZlbG9wZXIgU3Vic2NyaXB0aW9uXCJdO1xuICAgIHJldHVybiBkZXZTdWJzY3JpcHRpb25UeXBlcy5pbmNsdWRlcyhzdWJzY3JpcHRpb25JbmZvID09PSBudWxsIHx8IHN1YnNjcmlwdGlvbkluZm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN1YnNjcmlwdGlvbkluZm8udHlwZSk7XG59XG5mdW5jdGlvbiBpc09yZ0FkbWluKHVzZXIpIHtcbiAgICByZXR1cm4gZ2V0VXNlclJvbGUodXNlcikgPT09IFwib3JnX2FkbWluXCIgfHwgZ2V0VXNlclJvbGUodXNlcikgPT09IFwiYWNjb3VudF9hZG1pblwiO1xufVxuZnVuY3Rpb24gaXNPcmdVc2VyKHVzZXIpIHtcbiAgICByZXR1cm4gZ2V0VXNlclJvbGUodXNlcikgPT09IFwib3JnX3VzZXJcIiB8fCBnZXRVc2VyUm9sZSh1c2VyKSA9PT0gXCJhY2NvdW50X3VzZXJcIjtcbn1cbmZ1bmN0aW9uIGlzQ3VzdG9tUm9sZSh1c2VyKSB7XG4gICAgLy8gVGhlIEhvbWUgQXBwIGNvbGxhcHNlIHRoZSBgcm9sZUlkYCBhbmQgYHJvbGVgIGludG8gYSBzaW5nbGUgYGlkYCBwcm9wZXJ0eSwgdGhhdCdzIHdoeVxuICAgIC8vICBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtcG9ydGFsLWFwcC9ibG9iL21hc3Rlci9zcmMvanMvYXJjZ2lzb25saW5lL3NoYXJpbmcvZGlqaXQvUm9sZS50cyNMNDY5IHdvcmtzXG4gICAgLy8gSW4gcHJhY3RpY2UsIHdlIG9ubHkgbmVlZCB0byBjaGVjayBpZiBgcm9sZUlkYCBleGlzdFxuICAgIC8vICBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtcG9ydGFsLWFwcC9pc3N1ZXMvNDQ2ODIjaXNzdWVjb21tZW50LTQxNDY4NjZcbiAgICByZXR1cm4gISEodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnJvbGVJZCkgJiYgdXNlci5yb2xlSWQubGVuZ3RoID4gMDtcbn1cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIHByaXZpbGVnZSBcInBvcnRhbDphZG1pbjp1cGRhdGVJdGVtQ2F0ZWdvcnlTY2hlbWFcIiBpcyBncmFudGVkLlxuICovXG5mdW5jdGlvbiBjYW5VcGRhdGVJdGVtQ2F0ZWdvcmllcyh1c2VyKSB7XG4gICAgdmFyIF9hO1xuICAgIHJldHVybiAhISgoX2EgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwicG9ydGFsOmFkbWluOnVwZGF0ZUl0ZW1DYXRlZ29yeVNjaGVtYVwiKSk7XG59XG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSBwcml2aWxlZ2UgXCJwb3J0YWw6YWRtaW46dXBkYXRlR3JvdXBzXCIgaXMgZ3JhbnRlZC5cbiAqL1xuZnVuY3Rpb24gY2FuVXBkYXRlT3JnR3JvdXBzKHVzZXIpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46dXBkYXRlR3JvdXBzXCIpKTtcbn1cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIHVzZXIgaXMgYWxsb3dlZCB0byB1cGRhdGUgb3RoZXIgdXNlcidzIGl0ZW1zIGluIHRoZWlyIG9yZ2FuaXphdGlvbi5cbiAqL1xuZnVuY3Rpb24gY2FuVXBkYXRlT3JnSXRlbXModXNlcikge1xuICAgIHJldHVybiAoKHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSB8fCBbXSkuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46dXBkYXRlSXRlbXNcIik7XG59XG4vKipcbiAqIENoZWNrcyB0byBlbnN1cmUgdGhlIHBvcnRhbCBpcyBhbiBvcmdhbml6YXRpb24gcG9ydGFsXG4gKi9cbmZ1bmN0aW9uIGlzT3JnUG9ydGFsKHBvcnRhbCkge1xuICAgIHJldHVybiAhIShwb3J0YWwudXJsS2V5ICYmIHBvcnRhbC5jdXN0b21CYXNlVXJsKSB8fCAhIXBvcnRhbC5pc1BvcnRhbDtcbn1cbi8qKlxuICogQ2hlY2tzIHdoZXRoZXIgdGhlIHVzZXIgaXMgYWxsb3dlZCB0byBzaGFyZSB0aGVpciBpdGVtIHRvIGdyb3Vwc1xuICovXG5mdW5jdGlvbiBjYW5TaGFyZUl0ZW1Ub0dyb3VwKHVzZXIpIHtcbiAgICByZXR1cm4gKCh1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgfHwgW10pLmluY2x1ZGVzKFwicG9ydGFsOnVzZXI6c2hhcmVUb0dyb3VwXCIpO1xufVxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgdXNlciBjYW4gc2hhcmUgYW4gaXRlbSBvbiBhIGdpdmVuIHBvcnRhbFxuICovXG5mdW5jdGlvbiBjYW5TaGFyZSh1c2VyLCBwb3J0YWwpIHtcbiAgICByZXR1cm4gKCFpc09yZ1BvcnRhbChwb3J0YWwpIHx8XG4gICAgICAgIGNhblNoYXJlSXRlbVRvR3JvdXAodXNlcikgfHxcbiAgICAgICAgY2FuU2hhcmVJdGVtVG9PcmcodXNlcikgfHxcbiAgICAgICAgKCEhcG9ydGFsLmNhblNoYXJlUHVibGljICYmIGNhblNoYXJlSXRlbVRvUHVibGljKHVzZXIpKSk7XG59XG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSB1c2VyIGlzIGFsbG93ZWQgdG8gc2hhcmUgdGhlaXIgaXRlbSBvdCB0aGUgb3JnYW5pemF0aW9uLlxuICovXG5mdW5jdGlvbiBjYW5TaGFyZUl0ZW1Ub09yZyh1c2VyKSB7XG4gICAgcmV0dXJuICgodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpIHx8IFtdKS5pbmNsdWRlcyhcInBvcnRhbDp1c2VyOnNoYXJlVG9PcmdcIik7XG59XG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSB1c2VyIGlzIGFsbG93ZWQgdG8gc2hhcmUgdGhlaXIgaXRlbSB0byBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gY2FuU2hhcmVJdGVtVG9QdWJsaWModXNlcikge1xuICAgIHJldHVybiAoKHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSB8fCBbXSkuaW5jbHVkZXMoXCJwb3J0YWw6dXNlcjpzaGFyZVRvUHVibGljXCIpO1xufVxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgdXNlciBjYW4gc2hhcmUgb3RoZXIgdXNlcidzIGl0ZW1zXG4gKi9cbmZ1bmN0aW9uIGNhblNoYXJlT3RoZXJzSXRlbXNUb09yZyh1c2VyKSB7XG4gICAgcmV0dXJuICgodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpIHx8IFtdKS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjpzaGFyZVRvT3JnXCIpO1xufVxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgdXNlciBjYW4gc2hhcmUgb3RoZXIgdXNlcidzIGl0ZW1zXG4gKi9cbmZ1bmN0aW9uIGNhblNoYXJlT3RoZXJzSXRlbXNUb1B1YmxpYyh1c2VyKSB7XG4gICAgcmV0dXJuICgodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpIHx8IFtdKS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjpzaGFyZVRvUHVibGljXCIpO1xufVxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgdXNlciBjYW4gc2hhcmUgb3RoZXIgdXNlcidzIGl0ZW1zXG4gKi9cbmZ1bmN0aW9uIGFkbWluQ2FuU2hhcmVPdGhlcnNJdGVtVG9Hcm91cCh1c2VyKSB7XG4gICAgcmV0dXJuICgodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpIHx8IFtdKS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjpzaGFyZVRvR3JvdXBcIik7XG59XG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSB1c2VyIGlzIGluIGFuIGFsbG93ZWQgb3JnYW5pemF0aW9uIGFuZCBoYXMgdGhlIHBvd2VyIHRvIG1hbmFnZSBjb2xsYWJvcmF0aW9uc1xuICovXG5mdW5jdGlvbiBjYW5NYW5hZ2VDb2xsYWJvcmF0aW9ucyhjb25maWcsIHVzZXIsIHBvcnRhbCwgc3Vic2NyaXB0aW9uSW5mbykge1xuICAgIGNvbnN0IGV4Y2x1ZGVkT3JnVHlwZXMgPSBbXCJUcmlhbFwiLCBcIlRyaWFsIFByZXNzXCIsIFwiVHJpYWwgRGV2ZWxvcGVyXCIsIFwiRGV2ZWxvcGVyIFN1YnNjcmlwdGlvblwiLCBcIkV2YWx1YXRpb25cIl07XG4gICAgY29uc3QgaXNWYWxpZE9yZ1R5cGUgPSBzdWJzY3JpcHRpb25JbmZvICYmICFleGNsdWRlZE9yZ1R5cGVzLmluY2x1ZGVzKHN1YnNjcmlwdGlvbkluZm8udHlwZSk7XG4gICAgY29uc3QgaGFzUHJpdmlsZWdlID0gKCh1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgfHwgW10pLmluY2x1ZGVzKFwicG9ydGFsOmFkbWluOm1hbmFnZUNvbGxhYm9yYXRpb25zXCIpO1xuICAgIHJldHVybiAhISgoY29uZmlnID09PSBudWxsIHx8IGNvbmZpZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uZmlnLmNvbGxhYm9yYXRpb25zRW5hYmxlZCkgJiZcbiAgICAgICAgdXNlciAmJlxuICAgICAgICAoaXNPcmdBZG1pbih1c2VyKSB8fCBoYXNQcml2aWxlZ2UpICYmXG4gICAgICAgICgocG9ydGFsID09PSBudWxsIHx8IHBvcnRhbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcG9ydGFsLmlzUG9ydGFsKSB8fCBpc1ZhbGlkT3JnVHlwZSkpO1xufVxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgdXNlciBjYW4gdmlldyBvdGhlciBvcmdhbml6YXRpb24gdXNlcnMnIGl0ZW1zXG4gKi9cbmZ1bmN0aW9uIGNhblZpZXdPcmdJdGVtcyh1c2VyKSB7XG4gICAgcmV0dXJuICgodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpIHx8IFtdKS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjp2aWV3SXRlbXNcIik7XG59XG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSB1c2VyIGNhbiB2aWV3IG90aGVyIG9yZ2FuaXphdGlvbiB1c2VycycgaXRlbXNcbiAqL1xuZnVuY3Rpb24gY2FuVmlld090aGVyc09yZ0l0ZW1zKHVzZXIpIHtcbiAgICByZXR1cm4gISF1c2VyICYmICghaXNDdXN0b21Sb2xlKHVzZXIpIHx8IChpc0N1c3RvbVJvbGUodXNlcikgJiYgY2FuVmlld09yZ0l0ZW1zKHVzZXIpKSk7XG59XG4vLyBUT0RPOiBhZGQgdW5pdCB0ZXN0c1xuY29uc3QgaGFzQWRtaW5TaGFyZVByaXZpbGVnZSA9ICh7IGl0ZW1zLCB1c2VyLCBwb3J0YWwgfSkgPT4ge1xuICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1swXTtcbiAgICAvLyBlbnRlcnByaXNlIGluY29ycmVjdGx5IHJldHVybnMgaXRlbXMgb3duZWQgYnkgXCJlc3JpX1wiIGFzIGl0ZW0gY29udHJvbCBhZG1pbiAoV2ViR0lTL2FyY2dpcy1wb3J0YWwtYXBwIzM4Njk1KVxuICAgIGNvbnN0IG93bmVyID0gaXRlbS5vd25lcjtcbiAgICBjb25zdCB3aGl0ZWxpc3RPd25lciA9IFtcImVzcmlfbGl2aW5nYXRsYXNcIl07XG4gICAgaWYgKHBvcnRhbC5pc1BvcnRhbCAmJiBvd25lciAhPT0gdXNlci51c2VybmFtZSAmJiBvd25lci5pbmNsdWRlcyhcImVzcmlfXCIpICYmICF3aGl0ZWxpc3RPd25lci5pbmNsdWRlcyhvd25lcikpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBpc093bmVyT3JBZG1pbiA9IHVzZXJJc0l0ZW1BZG1pbihpdGVtLCB1c2VyKTtcbiAgICBjb25zdCBpc0N1c3RvbSA9IGlzQ3VzdG9tUm9sZSh1c2VyKTtcbiAgICBjb25zdCBjYW5TaGFyZU9yZ0l0ZW1zID0gY2FuU2hhcmVPdGhlcnNJdGVtcyh1c2VyKTtcbiAgICBjb25zdCBjYW5VcGRhdGVBbmRTaGFyZSA9IGNhblVwZGF0ZUl0ZW0oaXRlbSwgdXNlcikgJiZcbiAgICAgICAgY2FuVXBkYXRlT3JnSXRlbXModXNlcikgJiZcbiAgICAgICAgIWlzQ3VzdG9tICYmXG4gICAgICAgIChjYW5TaGFyZSh1c2VyLCBwb3J0YWwpIHx8IGNhblNoYXJlT3RoZXJzSXRlbXModXNlcikpO1xuICAgIC8vIGlmIGl0J3MgdGhlIGl0ZW0gb3duZXIgb3IgYWRtaW4sIG9yIGN1c3RvbSBhZG1pbiB3aG8gY2FuIHNoYXJlXG4gICAgcmV0dXJuIGlzT3duZXJPckFkbWluIHx8IGNhblVwZGF0ZUFuZFNoYXJlIHx8IChpdGVtc0JlbG9uZ1RvVXNlck9yZyhpdGVtcywgdXNlcikgJiYgY2FuU2hhcmVPcmdJdGVtcyk7XG59O1xuLyoqXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgdXNlciBjYW4gc2hhcmUgb3RoZXIgdXNlcidzIGl0ZW1zXG4gKi9cbmZ1bmN0aW9uIGNhblNoYXJlT3RoZXJzSXRlbXModXNlcikge1xuICAgIHJldHVybiBhZG1pbkNhblNoYXJlT3RoZXJzSXRlbVRvR3JvdXAodXNlcikgfHwgY2FuU2hhcmVPdGhlcnNJdGVtc1RvT3JnKHVzZXIpIHx8IGNhblNoYXJlT3RoZXJzSXRlbXNUb1B1YmxpYyh1c2VyKTtcbn1cblxuZXhwb3J0IHsgaXNQdWJsaWNVc2VyIGFzIGEsIGlzT3JnQWRtaW4gYXMgYiwgaXNIb3N0ZWRQb3J0YWwgYXMgYywgaXNDdXN0b21Sb2xlIGFzIGQsIGNhblVwZGF0ZU9yZ0dyb3VwcyBhcyBlLCBjYW5VcGRhdGVJdGVtQ2F0ZWdvcmllcyBhcyBmLCBjYW5NYW5hZ2VDb2xsYWJvcmF0aW9ucyBhcyBnLCBpc09yZ1VzZXIgYXMgaCwgaXNEZXZlbG9wZXIgYXMgaSwgY2FuU2hhcmVJdGVtVG9Hcm91cCBhcyBqLCBjYW5TaGFyZUl0ZW1Ub09yZyBhcyBrLCBhZG1pbkNhblNoYXJlT3RoZXJzSXRlbVRvR3JvdXAgYXMgbCwgY2FuU2hhcmVPdGhlcnNJdGVtc1RvT3JnIGFzIG0sIGNhblNoYXJlSXRlbVRvUHVibGljIGFzIG4sIGNhblNoYXJlT3RoZXJzSXRlbXNUb1B1YmxpYyBhcyBvLCBoYXNBZG1pblNoYXJlUHJpdmlsZWdlIGFzIHAsIGNhblZpZXdPdGhlcnNPcmdJdGVtcyBhcyBxIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByaXZpbGVnZXMtNWMzODJmNjEuanMubWFwIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyByIGFzIHJlcXVlc3QsIGkgYXMgaXNXZWJUaWVyQXV0aCB9IGZyb20gJy4vcG9ydGFsLWQ1MThiNTcxLmpzJztcbmltcG9ydCB7IGEgYXMgaXNQdWJsaWNVc2VyLCBiIGFzIGlzT3JnQWRtaW4gfSBmcm9tICcuL3ByaXZpbGVnZXMtNWMzODJmNjEuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25maWdTdGF0ZSB9IGZyb20gJy4vY29uZmlnLTc1YWRmOTYyLmpzJztcblxuYXN5bmMgZnVuY3Rpb24gZ2V0V29ybGRHZW9jb2RlclVybCgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUpID0+IHtcbiAgICAgICAgY29uc3QgeyBwb3J0YWwgfSA9IGNvbmZpZ1N0YXRlO1xuICAgICAgICBpZiAoIShwb3J0YWwgPT09IG51bGwgfHwgcG9ydGFsID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwb3J0YWwuaXNQb3J0YWwpKSB7XG4gICAgICAgICAgICBjb25zdCBlbnYgPSBnZXRFbnZpcm9ubWVudChwb3J0YWwpO1xuICAgICAgICAgICAgcmVzb2x2ZShgaHR0cHM6Ly9nZW9jb2RlJHtlbnZ9LmFyY2dpcy5jb20vYXJjZ2lzL3Jlc3Qvc2VydmljZXMvV29ybGQvR2VvY29kZVNlcnZlcmApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZ2VvY29kZXJzID0gcG9ydGFsLmhlbHBlclNlcnZpY2VzLmdlb2NvZGU7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBhd2FpdCBnZXRXb3JsZEdlb2NvZGVyVXJsRnJvbVByb3hpZXMoZ2VvY29kZXJzKTtcbiAgICAgICAgICAgIHJlc29sdmUodXJsKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZnVuY3Rpb24gZ2V0RW52aXJvbm1lbnQocG9ydGFsKSB7XG4gICAgY29uc3QgaG9zdG5hbWUgPSBwb3J0YWwgPT09IG51bGwgfHwgcG9ydGFsID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwb3J0YWwucG9ydGFsSG9zdG5hbWU7XG4gICAgaWYgKGhvc3RuYW1lLmluZGV4T2YoXCJkZXZcIikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiBcImRldlwiO1xuICAgIH1cbiAgICBlbHNlIGlmIChob3N0bmFtZS5pbmRleE9mKFwicWFcIikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiBcInFhXCI7XG4gICAgfVxuICAgIHJldHVybiBcIlwiO1xufVxuZnVuY3Rpb24gZ2V0V29ybGRHZW9jb2RlclVybEZyb21Qcm94aWVzKGdlb2NvZGVycykge1xuICAgIGNvbnN0IHsgY29uZmlnLCBwb3J0YWwgfSA9IGNvbmZpZ1N0YXRlO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IGVzcmlCYXRjaEdlb2NvZGVyID0gZ2VvY29kZXJzXG4gICAgICAgICAgICAuZmlsdGVyKChnZW9jb2RlcikgPT4gaXNTZXJ2aWNlUHJveHlHZW9jb2RlcihnZW9jb2Rlci51cmwsIHBvcnRhbCkpXG4gICAgICAgICAgICAuZmlsdGVyKChwcm94eSkgPT4gcHJveHkuaXNFc3JpQmF0Y2hHZW9jb2RlcilbMF07XG4gICAgICAgIGlmIChlc3JpQmF0Y2hHZW9jb2Rlcikge1xuICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHdvcmxkIGdlb2NvZGVyIGlzIGNvbmZpZ3VyZWRcbiAgICAgICAgICAgIGNvbnN0IGlkID0gcGFyc2VHZW9jb2Rlckl0ZW1JZChlc3JpQmF0Y2hHZW9jb2Rlcik7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBgJHtjb25maWcucmVzdEJhc2VVcmx9L2NvbnRlbnQvaXRlbXMvJHtpZH1gO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBnZW9jb2Rlckl0ZW0gPSBhd2FpdCByZXF1ZXN0KHVybCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShnZW9jb2Rlckl0ZW0udXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChcIk5vIHdvcmxkIGdlb2NvZGVyIGNvbmZpZ3VyZWRcIik7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGlzU2VydmljZVByb3h5R2VvY29kZXIodXJsID0gXCJcIiwgcG9ydGFsKSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGlzUG9ydGFsID0gcG9ydGFsLmlzUG9ydGFsO1xuICAgIGNvbnN0IGxvd2VyVXJsID0gdXJsLnRvTG93ZXJDYXNlKCksIGhhc1Byb3hpZWRHZW9jb2RlUGF0aHMgPSBsb3dlclVybC5pbmRleE9mKFwiL2dlb2NvZGVzZXJ2ZXJcIikgPiAtMSAmJiBsb3dlclVybC5pbmRleE9mKFwiL3Jlc3Qvc2VydmljZXMvXCIpID4gLTE7XG4gICAgY29uc3QgaXNQb3J0YWxQcm94eSA9IGlzUG9ydGFsICYmIGxvd2VyVXJsLmluZGV4T2YoKF9hID0gcG9ydGFsLnBvcnRhbEhvc3RuYW1lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudG9Mb3dlckNhc2UoKSkgPiAtMTtcbiAgICBjb25zdCBpc0FHT0xQcm94eSA9ICFpc1BvcnRhbCAmJiBsb3dlclVybC5pbmRleE9mKFwidXRpbGl0eVwiKSAmJiBsb3dlclVybC5pbmRleE9mKFwiLmFyY2dpcy5jb21cIikgPiAtMTtcbiAgICByZXR1cm4gaGFzUHJveGllZEdlb2NvZGVQYXRocyAmJiAoaXNQb3J0YWxQcm94eSB8fCBpc0FHT0xQcm94eSk7XG59XG5mdW5jdGlvbiBwYXJzZUdlb2NvZGVySXRlbUlkKGdlb2NvZGVyKSB7XG4gICAgcmV0dXJuIGdlb2NvZGVyLnVybC5zcGxpdChcIi9zZXJ2ZXJzL1wiKVsxXS5zcGxpdChcIi9yZXN0L3NlcnZpY2VzL1wiKVswXTtcbn1cblxuZnVuY3Rpb24gY2FuUHVibGlzaCh1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKSB7XG4gICAgcmV0dXJuICghaXNQdWJsaWNVc2VyKHVzZXIpICYmXG4gICAgICAgICEhcG9ydGFsLnN1cHBvcnRzSG9zdGVkU2VydmljZXMgJiZcbiAgICAgICAgY2FuQ3JlYXRlSXRlbXModXNlcikgJiZcbiAgICAgICAgKGNhblB1Ymxpc2hUaWxlcyh1c2VyLCBwb3J0YWwpIHx8XG4gICAgICAgICAgICBjYW5QdWJsaXNoRmVhdHVyZXModXNlciwgcG9ydGFsKSB8fFxuICAgICAgICAgICAgY2FuUHVibGlzaFNjZW5lcyh1c2VyKSB8fFxuICAgICAgICAgICAgY2FuUHVibGlzaFZlY3RvclRpbGVzKHVzZXIpIHx8XG4gICAgICAgICAgICBjYW5QdWJsaXNoSW1hZ2VDb2xsZWN0aW9uKHVzZXIsIHBvcnRhbCwgdXNlckxpY2Vuc2VkSXRlbXMpKSk7XG59XG5mdW5jdGlvbiBjYW5DcmVhdGVJdGVtcyh1c2VyKSB7XG4gICAgcmV0dXJuIGlzUHVibGljVXNlcih1c2VyKSB8fCAodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwb3J0YWw6dXNlcjpjcmVhdGVJdGVtXCIpKTtcbn1cbmZ1bmN0aW9uIGNhblJlY2VpdmVJdGVtcyh1c2VyKSB7XG4gICAgcmV0dXJuIGlzUHVibGljVXNlcih1c2VyKSB8fCAodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwb3J0YWw6dXNlcjpyZWNlaXZlSXRlbXNcIikpO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaEZlYXR1cmVzKHVzZXIsIHBvcnRhbCkge1xuICAgIHJldHVybiAoIWlzUHVibGljVXNlcih1c2VyKSAmJlxuICAgICAgICAodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwb3J0YWw6cHVibGlzaGVyOnB1Ymxpc2hGZWF0dXJlc1wiKSkgJiZcbiAgICAgICAgKCFwb3J0YWwuaXNQb3J0YWwgfHwgcG9ydGFsLmlzQmFja2VkQnlTRFMpKTtcbn1cbmZ1bmN0aW9uIGNhblB1Ymxpc2hUaWxlcyh1c2VyLCBwb3J0YWwpIHtcbiAgICByZXR1cm4gKCFpc1B1YmxpY1VzZXIodXNlcikgJiZcbiAgICAgICAgKHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzLmluY2x1ZGVzKFwicG9ydGFsOnB1Ymxpc2hlcjpwdWJsaXNoVGlsZXNcIikpICYmXG4gICAgICAgICghcG9ydGFsLmlzUG9ydGFsIHx8IHBvcnRhbC5pc0JhY2tlZEJ5U0RTKSk7XG59XG5mdW5jdGlvbiBjYW5QdWJsaXNoVmVjdG9yVGlsZXModXNlcikge1xuICAgIHJldHVybiAhaXNQdWJsaWNVc2VyKHVzZXIpICYmIHRydWU7IC8vIHRoaXMgcHJpdmlsZWdlIGRvZXNuJ3QgZXhpc3QgeWV0XG59XG5mdW5jdGlvbiBjYW5QdWJsaXNoU2NlbmVzKHVzZXIpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuICFpc1B1YmxpY1VzZXIodXNlcikgJiYgKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6cHVibGlzaGVyOnB1Ymxpc2hTY2VuZXNcIikpO1xufVxuY29uc3QgY2FuQ3JlYXRlRGV2ZWxvcGVyQ3JlZGVudGlhbHMgPSAodXNlcikgPT4gIWlzUHVibGljVXNlcih1c2VyKTtcbmZ1bmN0aW9uIGNhblB1Ymxpc2hJbWFnZUNvbGxlY3Rpb24odXNlciwgcG9ydGFsLCB1c2VyTGljZW5zZWRJdGVtcykge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3Qgc2VydmVyU3VwcG9ydHNSYXN0ZXJBbmFseXRpY3MgPSAhISgoX2IgPSAoX2EgPSBwb3J0YWwuaGVscGVyU2VydmljZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yYXN0ZXJBbmFseXRpY3MpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi51cmwpO1xuICAgIGNvbnN0IGNhblB1Ymxpc2hEeW5hbWljID0gY2FuUHVibGlzaER5bmFtaWNJbWFnZXJ5KHVzZXIsIHBvcnRhbCwgdXNlckxpY2Vuc2VkSXRlbXMpO1xuICAgIGNvbnN0IGNhblB1Ymxpc2ggPSBwb3J0YWwuaXNQb3J0YWxcbiAgICAgICAgPyBjYW5QdWJsaXNoRHluYW1pY1xuICAgICAgICA6IGNhblB1Ymxpc2hEeW5hbWljIHx8IGNhblB1Ymxpc2hUaWxlZEltYWdlcnkodXNlciwgcG9ydGFsLCB1c2VyTGljZW5zZWRJdGVtcyk7XG4gICAgcmV0dXJuIHNlcnZlclN1cHBvcnRzUmFzdGVyQW5hbHl0aWNzICYmIGNhblB1Ymxpc2g7XG59XG5mdW5jdGlvbiBjYW5QdWJsaXNoRHluYW1pY0ltYWdlcnkodXNlciwgcG9ydGFsLCB1c2VyTGljZW5zZWRJdGVtcykge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gKCgoX2EgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwicG9ydGFsOnB1Ymxpc2hlcjpwdWJsaXNoRHluYW1pY0ltYWdlcnlcIikpICYmXG4gICAgICAgIChwb3J0YWwuaXNQb3J0YWwgfHwgaGFzSW1hZ2VFbnRpdGxlbWVudCh1c2VyTGljZW5zZWRJdGVtcykpKTtcbn1cbmZ1bmN0aW9uIGNhblB1Ymxpc2hUaWxlZEltYWdlcnkodXNlciwgcG9ydGFsLCB1c2VyTGljZW5zZWRJdGVtcykge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gKCgoX2EgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwicG9ydGFsOnB1Ymxpc2hlcjpwdWJsaXNoVGlsZWRJbWFnZXJ5XCIpKSAmJlxuICAgICAgICAhcG9ydGFsLmlzUG9ydGFsICYmXG4gICAgICAgIGhhc0ltYWdlRW50aXRsZW1lbnQodXNlckxpY2Vuc2VkSXRlbXMpKTtcbn1cbmZ1bmN0aW9uIGhhc0ltYWdlRW50aXRsZW1lbnQodXNlckxpY2Vuc2VkSXRlbXMpIHtcbiAgICByZXR1cm4gdXNlckxpY2Vuc2VkSXRlbXMgPT09IG51bGwgfHwgdXNlckxpY2Vuc2VkSXRlbXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXJMaWNlbnNlZEl0ZW1zLnNvbWUoKGxpY2Vuc2VkSXRlbSkgPT4geyB2YXIgX2E7IHJldHVybiAoX2EgPSBsaWNlbnNlZEl0ZW0uZW50aXRsZW1lbnRzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc29tZSgoZW50aXRsZW1lbnQpID0+IGVudGl0bGVtZW50LnRvTG93ZXJDYXNlKCkgPT09IFwiaW1hZ2VcIik7IH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hVc2VyTGljZW5zZWRJdGVtcyhwb3J0YWwpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgeyB1c2VyTGljZW5zZWRJdGVtcyB9ID0gYXdhaXQgcmVxdWVzdChgJHsoX2EgPSBwb3J0YWwucmVzdFVybCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogcG9ydGFsLnBvcnRhbFVybH0vY29tbXVuaXR5L3NlbGY/cmV0dXJuVXNlckxpY2Vuc2VkSXRlbXM9dHJ1ZWApO1xuICAgIHJldHVybiB1c2VyTGljZW5zZWRJdGVtcztcbn1cbmZ1bmN0aW9uIGNhbkNyZWF0ZUxvY2F0b3JWaWV3KHVzZXIsIHBvcnRhbCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgaGFzV29ybGRHZW9jb2RlciA9IChfYSA9IHBvcnRhbC5oZWxwZXJTZXJ2aWNlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmdlb2NvZGUuc29tZSgoeyB1cmwgfSkgPT4gaXNTZXJ2aWNlUHJveHlHZW9jb2Rlcih1cmwsIHBvcnRhbCkpO1xuICAgIGNvbnN0IHByaXZpbGVnZXMgPSAoX2IgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogW107XG4gICAgcmV0dXJuICghaXNQdWJsaWNVc2VyKHVzZXIpICYmXG4gICAgICAgIGhhc1dvcmxkR2VvY29kZXIgJiZcbiAgICAgICAgKCFwb3J0YWwuaXNQb3J0YWwgfHxcbiAgICAgICAgICAgICghaXNXZWJUaWVyQXV0aChwb3J0YWwpICYmXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZ0b3BpYS5lc3JpLmNvbS9XZWJHSVMvYXJjZ2lzLXBvcnRhbC1hcHAvaXNzdWVzLzQwMzM4XG4gICAgICAgICAgICAgICAgcHJpdmlsZWdlcy5pbmNsdWRlcyhcInBvcnRhbDp1c2VyOnZpZXdPcmdJdGVtc1wiKSAmJlxuICAgICAgICAgICAgICAgIHByaXZpbGVnZXMuaW5jbHVkZXMoXCJwb3J0YWw6dXNlcjpjcmVhdGVJdGVtXCIpKSkpO1xufVxuY29uc3QgY2FuQ3JlYXRlTG9jYXRvciA9ICh1c2VyKSA9PiAhaXNQdWJsaWNVc2VyKHVzZXIpO1xuZnVuY3Rpb24gY2FuQ3JlYXRlQWR2YW5jZWROb3RlYm9va3ModXNlcikge1xuICAgIHJldHVybiB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcy5pbmNsdWRlcyhcInByZW1pdW06cHVibGlzaGVyOmNyZWF0ZUFkdmFuY2VkTm90ZWJvb2tzXCIpO1xufVxuZnVuY3Rpb24gY2FuQ3JlYXRlTm90ZWJvb2tzKHVzZXIpIHtcbiAgICByZXR1cm4gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwcmVtaXVtOnB1Ymxpc2hlcjpjcmVhdGVOb3RlYm9va3NcIik7XG59XG5mdW5jdGlvbiBjYW5DcmVhdGVEYXRhU3RvcmUodXNlciwgcG9ydGFsKSB7XG4gICAgdmFyIF9hO1xuICAgIHJldHVybiAhIXBvcnRhbC5pc1BvcnRhbCAmJiAhISgoX2EgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwicG9ydGFsOnB1Ymxpc2hlcjpyZWdpc3RlckRhdGFTdG9yZXNcIikpO1xufVxuZnVuY3Rpb24gY2FuR2VvY29kZSh1c2VyKSB7XG4gICAgcmV0dXJuICFpc1B1YmxpY1VzZXIodXNlcikgJiYgKHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzLmluY2x1ZGVzKFwicHJlbWl1bTp1c2VyOmdlb2NvZGVcIikpO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaEZyb21DbG91ZCh1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKSB7XG4gICAgcmV0dXJuICFwb3J0YWwuaXNQb3J0YWwgJiYgY2FuUHVibGlzaEZlYXR1cmVzKHVzZXIsIHBvcnRhbCkgJiYgY2FuUHVibGlzaCh1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKTtcbn1cbmZ1bmN0aW9uIGNhblB1Ymxpc2hTZXJ2aWNlRGVmaW5pdGlvbih1c2VyLCBwb3J0YWwpIHtcbiAgICByZXR1cm4gY2FuUHVibGlzaEZlYXR1cmVzKHVzZXIsIHBvcnRhbCkgJiYgY2FuUHVibGlzaFRpbGVzKHVzZXIsIHBvcnRhbCk7XG59XG5mdW5jdGlvbiBjYW5QdWJsaXNoVHlwZSh1c2VyLCB0eXBlLCBwb3J0YWwpIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcIkNTVlwiOlxuICAgICAgICBjYXNlIFwiR2VvSnNvblwiOlxuICAgICAgICBjYXNlIFwiTWljcm9zb2Z0IEV4Y2VsXCI6XG4gICAgICAgIGNhc2UgXCJTaGFwZWZpbGVcIjpcbiAgICAgICAgY2FzZSBcIkZpbGUgR2VvZGF0YWJhc2VcIjpcbiAgICAgICAgY2FzZSBcIlBob3RvcyB3aXRoIExvY2F0aW9uc1wiOlxuICAgICAgICAgICAgcmV0dXJuIGNhblB1Ymxpc2hGZWF0dXJlcyh1c2VyLCBwb3J0YWwpO1xuICAgICAgICBjYXNlIFwiVGlsZSBQYWNrYWdlXCI6XG4gICAgICAgICAgICByZXR1cm4gY2FuUHVibGlzaFRpbGVzKHVzZXIsIHBvcnRhbCk7XG4gICAgICAgIGNhc2UgXCJWZWN0b3IgVGlsZSBQYWNrYWdlXCI6XG4gICAgICAgICAgICByZXR1cm4gY2FuUHVibGlzaFZlY3RvclRpbGVzKHVzZXIpO1xuICAgICAgICBjYXNlIFwiU2NlbmUgUGFja2FnZVwiOlxuICAgICAgICAgICAgcmV0dXJuIGNhblB1Ymxpc2hTY2VuZXModXNlcik7XG4gICAgICAgIGNhc2UgXCJTZXJ2aWNlIERlZmluaXRpb25cIjpcbiAgICAgICAgICAgIHJldHVybiBjYW5QdWJsaXNoU2VydmljZURlZmluaXRpb24odXNlciwgcG9ydGFsKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNhbk1hbmFnZUNyZWRpdHModXNlcikge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gISEoKF9hID0gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjptYW5hZ2VDcmVkaXRzXCIpKTtcbn1cbmZ1bmN0aW9uIGNhblNob3dUb3RhbENyZWRpdHModXNlciwgcG9ydGFsKSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgcmV0dXJuIChpc09yZ0FkbWluKHVzZXIpIHx8XG4gICAgICAgIGNhbk1hbmFnZUNyZWRpdHModXNlcikgfHxcbiAgICAgICAgISEoKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5hc3NpZ25lZENyZWRpdHMpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYiA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5zb3VyY2VKU09OKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuYXNzaWduZWRDcmVkaXRzKSA+IC0xICYmXG4gICAgICAgICAgICAoKF9jID0gcG9ydGFsID09PSBudWxsIHx8IHBvcnRhbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcG9ydGFsLnBvcnRhbFByb3BlcnRpZXMpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5zaG93Q3JlZGl0c09uUHJvZmlsZSkpKTtcbn1cbmNvbnN0IGNhbkFkZEFQSUtleSA9IChfKSA9PiBmYWxzZTtcbi8vIHRlbXBvcmFyaWx5IGRpc2FibGUgZm9yIG5vdyBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtcG9ydGFsLWFwcC9pc3N1ZXMvNDI4NjNcbi8vIFtcIlRyaWFsIERldmVsb3BlclwiLCBcIkRldmVsb3BlclwiLCBcIkRldmVsb3BlciBTdWJzY3JpcHRpb25cIl0uaW5jbHVkZXMoc3Vic2NyaXB0aW9uVHlwZSk7XG5mdW5jdGlvbiBjYW5WaWV3T3JnR3JvdXBzKHVzZXIpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46dmlld0dyb3Vwc1wiKSk7XG59XG5mdW5jdGlvbiBjYW5WaWV3T3JnSXRlbXModXNlcikge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gISEoKF9hID0gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjp2aWV3SXRlbXNcIikpO1xufVxuZnVuY3Rpb24gY2FuVmlld1VzZXJzKHVzZXIpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46dmlld1VzZXJzXCIpKTtcbn1cbmZ1bmN0aW9uIGNhblVwZGF0ZU9yZ0l0ZW1zKHVzZXIpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46dXBkYXRlSXRlbXNcIikpO1xufVxuZnVuY3Rpb24gY2FuRGVsZXRlT3JnSXRlbXModXNlcikge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gISEoKF9hID0gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjpkZWxldGVJdGVtc1wiKSk7XG59XG5mdW5jdGlvbiBjYW5SZWFzc2lnbk9yZ0l0ZW1zKHVzZXIpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46cmVhc3NpZ25JdGVtc1wiKSk7XG59XG5mdW5jdGlvbiBjYW5NYW5hZ2VJdGVtcyh1c2VyKSB7XG4gICAgcmV0dXJuIChpc09yZ0FkbWluKHVzZXIpIHx8XG4gICAgICAgIChjYW5WaWV3VXNlcnModXNlcikgJiZcbiAgICAgICAgICAgIGNhblZpZXdPcmdJdGVtcyh1c2VyKSAmJlxuICAgICAgICAgICAgKGNhblVwZGF0ZU9yZ0l0ZW1zKHVzZXIpIHx8IGNhbkRlbGV0ZU9yZ0l0ZW1zKHVzZXIpIHx8IGNhblJlYXNzaWduT3JnSXRlbXModXNlcikpKSk7XG59XG5cbmV4cG9ydCB7IGNhblB1Ymxpc2hUeXBlIGFzIGEsIGNhblB1Ymxpc2hGZWF0dXJlcyBhcyBiLCBjYW5QdWJsaXNoRnJvbUNsb3VkIGFzIGMsIGNhbkNyZWF0ZURldmVsb3BlckNyZWRlbnRpYWxzIGFzIGQsIGNhblB1Ymxpc2hJbWFnZUNvbGxlY3Rpb24gYXMgZSwgZmV0Y2hVc2VyTGljZW5zZWRJdGVtcyBhcyBmLCBjYW5QdWJsaXNoVGlsZXMgYXMgZywgY2FuUHVibGlzaFNjZW5lcyBhcyBoLCBjYW5DcmVhdGVMb2NhdG9yVmlldyBhcyBpLCBjYW5DcmVhdGVMb2NhdG9yIGFzIGosIGNhbkNyZWF0ZURhdGFTdG9yZSBhcyBrLCBjYW5DcmVhdGVJdGVtcyBhcyBsLCBjYW5HZW9jb2RlIGFzIG0sIGNhblJlY2VpdmVJdGVtcyBhcyBuLCBjYW5TaG93VG90YWxDcmVkaXRzIGFzIG8sIGNhbkFkZEFQSUtleSBhcyBwLCBnZXRXb3JsZEdlb2NvZGVyVXJsIGFzIHEsIGNhbkNyZWF0ZU5vdGVib29rcyBhcyByLCBjYW5DcmVhdGVBZHZhbmNlZE5vdGVib29rcyBhcyBzLCBjYW5WaWV3T3JnR3JvdXBzIGFzIHQsIGNhbk1hbmFnZUl0ZW1zIGFzIHUgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJpdmlsZWdlcy03NDYzOWRhZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=