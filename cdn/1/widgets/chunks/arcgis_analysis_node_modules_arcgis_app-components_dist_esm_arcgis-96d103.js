/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103"],{20206:(e,t,i)=>{i.d(t,{a:()=>s,b:()=>n,c:()=>o,d:()=>r});const r=(0,i(70464).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),s=r.state,o=r.state,n=r.state},25989:(e,t,i)=>{i.r(t),i.d(t,{arcgis_categories_picker:()=>v,arcgis_folder_picker:()=>m,arcgis_item_properties:()=>b,arcgis_summary_input:()=>y,arcgis_tags_picker:()=>x,arcgis_title_input:()=>T});var r=i(81149),s=i(66495),o=i(85984),n=i(49853),l=i(36238),a=i(82218),c=i(12846),d=i(70105),u=i(82102),h=i(64606),p=i(20164),g=i(41487);i(92638),i(79210),i(12046),i(74689),i(70464),i(42577),i(51837),i(69283),i(20206),i(65804),i(13615);const v=class{constructor(e){(0,r.r)(this,e),this.arcgisCategoriesPickerChange=(0,r.c)(this,"arcgisCategoriesPickerChange",7),this.renderCombobox=()=>{const{i18n:e,scale:t,schema:i,label:s}=this;return(0,r.h)("calcite-combobox",{label:null!=s?s:e.categories,maxItems:5,selectionMode:"ancestors",placeholder:e.assignCategories,scale:t,ref:e=>this.combobox=e},this.renderNestedCategories(i))},this.api=void 0,this.portal=void 0,this.scale=void 0,this.label=void 0,this.hideLabel=void 0,this.categories=void 0,this.schema=[],this.rootCategoryPath=o.U}async componentWillLoad(){var e,t,i,r;const s=await(0,a.g)(this.el);this.i18n=s[0],null!==(e=this.portal)&&void 0!==e||(this.portal=n.c.portal),null!==(t=this.scale)&&void 0!==t||(this.scale=n.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=n.c.api),null!==(r=this.categories)&&void 0!==r||(this.categories=c.i.categories),c.a.on("reset",(()=>{this.categories=c.i.categories}))}async componentDidLoad(){var e,t,i;const{portal:r,schema:n}=this;if(r&&!(null==n?void 0:n.length))if(r.categories)this.schema=null===(e=r.categories[0])||void 0===e?void 0:e.categories;else{const e=await(0,s.f)(r);this.schema=null===(i=null===(t=e.categorySchema)||void 0===t?void 0:t[0])||void 0===i?void 0:i.categories,this.rootCategoryPath=(0,o.g)(e.categorySchema)}}updateCategories(){this.arcgisCategoriesPickerChange.emit(this.categories)}categoriesPickerChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];(0,l.f)(r,this.categories)||(this.categories=r)}renderNestedCategories(e,t){return e.map((e=>{const i=t?`${t}/${e.title}`:`${this.rootCategoryPath}/${e.title}`;return(0,r.h)("calcite-combobox-item",{value:i,textLabel:e.title,selected:this.categories.some((e=>e===i||e.toLocaleLowerCase()===i.toLocaleLowerCase()))},e.categories&&this.renderNestedCategories(e.categories,i))}))}render(){const{i18n:e,scale:t,schema:i,hideLabel:s,label:o,renderCombobox:n}=this;return s?n():!!i&&(0,r.h)("calcite-label",{scale:t},(0,r.h)("p",{class:"label"},null!=o?o:e.categories),n())}get el(){return(0,r.d)(this)}static get watchers(){return{categories:["updateCategories"]}}};v.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}";const m=class{constructor(e){(0,r.r)(this,e),this.arcgisFolderPickerChange=(0,r.c)(this,"arcgisFolderPickerChange",7),this.arcgisFolderPickerLoad=(0,r.c)(this,"arcgisFolderPickerLoad",7),this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.folder=void 0,this.folders=[],this.newFolderActive=!1,this.emptyFilterList=!1,this.filterText=void 0,this.newFolderInput=void 0,this.createFolderText=void 0,this.showError=!1,this.errorString=void 0,this.newFolderInputElement=void 0,this.comboboxElement=void 0,this.loading=!1}async componentWillLoad(){var e,t,i,r,s,o,l,d;const u=await(0,a.g)(this.el);this.i18n=u[0],null!==(e=this.portal)&&void 0!==e||(this.portal=n.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=n.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=n.c.scale),null!==(r=this.api)&&void 0!==r||(this.api=n.c.api),null!==(s=this.folder)&&void 0!==s||(this.folder=null!==(l=null!==(o=c.i.folder)&&void 0!==o?o:n.c.initialFolder)&&void 0!==l?l:null===(d=this.folders)||void 0===d?void 0:d[0]),this.createFolderText=this.i18n.createNewFolder,c.a.on("reset",(()=>{var e,t,i;this.folder=null!==(t=null!==(e=c.i.folder)&&void 0!==e?e:n.c.initialFolder)&&void 0!==t?t:null===(i=this.folders)||void 0===i?void 0:i[0]}))}async componentDidLoad(){this.folders.length||await this.loadFolders(this.user)}async handleUserChange(e,t){t&&e.username!==t.username&&(await this.loadFolders(e),this.folder=this.getHomeFolder())}handleFolderChange(){this.arcgisFolderPickerChange.emit(this.folder)}async loadFolders(e){var t;this.loading=!0,this.folders=await(0,d.g)(e),this.arcgisFolderPickerLoad.emit([...this.folders]),(null===(t=this.folder)||void 0===t?void 0:t.id)||(this.folder=this.getHomeFolder()),this.loading=!1}getHomeFolder(){return this.folders.find((e=>e.title===e.id))}setNewFolderActive(){var e;null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),this.newFolderInputElement||(this.showError=!1,this.newFolderInput="")}checkForEmptySuggestions(e){var t;e.stopPropagation();const i=this.comboboxElement.shadowRoot.querySelector("input").value,{i18n:r}=this;this.emptyFilterList=(null===(t=this.comboboxElement.filteredItems)||void 0===t?void 0:t.length)<=1,this.createFolderText=this.emptyFilterList?r.noFoldersFoundCreate.replace("${folder}",i):r.createNewFolder,this.filterText=i}handleComboboxChange(e){var t,i,r;e.stopPropagation();const s=null===(t=this.comboboxElement)||void 0===t?void 0:t.value;if("create-folder"===s)return this.showError=!1,void(this.emptyFilterList?this.createNewFolder(this.filterText):this.newFolderActive=!0);this.folder=null!==(r=null!==(i=this.folders.find((e=>e.id===s)))&&void 0!==i?i:this.folder)&&void 0!==r?r:this.getHomeFolder()}closeNewFolderInput(e){e.stopPropagation(),this.newFolderActive=!1}async saveActiveFolder(){if(!this.newFolderActive)return!0;try{await this.createNewFolder(this.newFolderInput)}catch(e){return this.errorString}return!this.showError}async createNewFolder(e){var t;const i=e.trim(),{i18n:r,user:s}=this;try{const{folder:e}=await(0,d.c)(i,s);this.folder=e,this.folders=[this.folder,...this.folders],n.c.folders=this.folders,this.newFolderActive=!1,this.showError=!1,await(0,l.t)(100);const r=null===(t=this.el.shadowRoot)||void 0===t?void 0:t.querySelector(`calcite-combobox-item[data-id="${this.folder.id}"]`);r&&(r.selected=!0)}catch(e){throw!i||(null==i?void 0:i.length)<=0?this.errorString=r.error.noName:this.folders.map((e=>e.title)).includes(i)?this.errorString=r.error.folderAlreadyExists.replace("${folder}",i):i.indexOf(">")>=0||i.indexOf("<")>=0?this.errorString=r.error.invalidCharacters:(console.error(e),this.errorString=e.message),this.showError=!0,e}}render(){var e;const{i18n:t,scale:i}=this;return(0,r.h)("calcite-label",{scale:i,class:"input-height"},(0,r.h)("p",{class:"label"},null!==(e=this.label)&&void 0!==e?e:t.folder),(0,r.h)("div",null,this.newFolderActive?(0,r.h)("calcite-inline-editable",{controls:!0,"editing-enabled":!0,afterConfirm:async()=>{var e;try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(t){throw null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),t}},scale:i},(0,r.h)("calcite-input",{placeholder:t.enterFolder,value:this.newFolderInput,maxLength:250,scale:i,onCalciteInputInput:e=>this.newFolderInput=e.target.value,onKeyDown:e=>{switch(e.stopPropagation(),this.showError=!1,e.key){case"Enter":this.createNewFolder(this.newFolderInput);break;case"Escape":this.newFolderActive=!1,this.showError=!1}},ref:e=>this.newFolderInputElement=e,status:this.showError?"invalid":"idle"})):(0,r.h)("div",{class:"combobox-wrapper"},this.loading&&(0,r.h)("calcite-progress",{type:"indeterminate",class:"progress"}),(0,r.h)("calcite-combobox",{label:t.folder,selectionMode:"single",maxItems:5,placeholder:this.loading?t.loading:t.searchFolders,scale:i,ref:e=>this.comboboxElement=e,disabled:this.loading,clearDisabled:!0,onCalciteComboboxChange:e=>this.handleComboboxChange(e),onCalciteComboboxBeforeClose:()=>{this.comboboxElement.selectedItems.length||(this.comboboxElement.value=this.folder.id)}},!this.loading&&(0,r.h)(r.F,null,this.user&&(0,r.h)("calcite-combobox-item",{class:"create-folder",value:"create-folder",textLabel:this.createFolderText,selected:!1,icon:"folder-plus",filterDisabled:!0}),this.folders.map((({id:e,username:t,title:i})=>{const s=this.folders.map((e=>e.id)).includes(this.folder.id)?this.folder:this.getHomeFolder();return(0,r.h)("calcite-combobox-item",{"data-id":e,value:e,textLabel:i,selected:"all"!==(null==s?void 0:s.id)?e===(null==s?void 0:s.id):e===t,icon:e===t?"home":"folder"})})))))),(0,r.h)("calcite-input-message",{status:"invalid",hidden:!this.showError,icon:this.showError,scale:i},this.errorString))}get el(){return(0,r.d)(this)}static get watchers(){return{user:["handleUserChange"],folder:["handleFolderChange"],newFolderInputElement:["setNewFolderActive"]}}};var f;m.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.create-folder{--calcite-color-text-1:var(--calcite-color-text-link);--calcite-color-text-3:var(--calcite-color-text-link)}.combobox-wrapper{position:relative}.progress{position:absolute;top:0px;z-index:1}",function(e){e.arcgisTitleInputChange="title",e.arcgisFolderPickerChange="folder",e.arcgisSummaryInputChange="snippet",e.arcgisTagsPickerChange="tags",e.arcgisCategoriesPickerChange="categories"}(f||(f={}));const b=class{constructor(e){(0,r.r)(this,e),this.arcgisItemPropertiesChange=(0,r.c)(this,"arcgisItemPropertiesChange",7),this.portal=void 0,this.user=void 0,this.api=void 0,this.config=void 0,this.itemId=void 0,this.type=void 0,this.scale=void 0}async resetItemPropertiesStore(){c.a.reset()}handleItemPropertiesChange(e){const{detail:t,type:i}=e;c.i[f[i]]=t,this.arcgisItemPropertiesChange.emit(Object.assign({},c.i))}async componentWillLoad(){var e,t;this.portal&&(n.c.portal=this.portal),this.user&&(n.c.user=this.user),this.api&&(n.c.api=this.api),this.config&&(n.c.config=this.config),this.itemId&&({result:c.i.item}=await(0,u.a)(this.itemId,this.portal)),this.type&&(c.i.type=null!==(e=this.type)&&void 0!==e?e:null===(t=c.i.item)||void 0===t?void 0:t.type),this.scale&&(n.c.scale=this.scale)}render(){return(0,r.h)(r.H,null,(0,r.h)("slot",null))}disconnectedCallback(){c.a.reset()}get el(){return(0,r.d)(this)}},y=class{constructor(e){(0,r.r)(this,e),this.arcgisSummaryInputChange=(0,r.c)(this,"arcgisSummaryInputChange",7),this.updateLiveRegion=(0,l.d)((e=>{this.liveRegionText=this.getCharactersText(e)}),1500),this.scale=void 0,this.label=void 0,this.summary=void 0,this.liveRegionText=void 0,this.valid=!0}async getErrorMessage(){return this.valid?null:{code:"summaryInvalid",translatedMessage:this.i18n.invalid}}async componentWillLoad(){var e,t;const i=await(0,a.g)(this.el);this.i18n=i[0],null!==(e=this.scale)&&void 0!==e||(this.scale=n.c.scale),null!==(t=this.summary)&&void 0!==t||(this.summary=c.i.snippet),this.liveRegionText=this.getCharactersText(this.summary),c.a.on("reset",(()=>{this.summary=c.i.snippet}))}componentDidRender(){var e,t,i;const r=null===(i=null===(t=null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("calcite-input"))||void 0===t?void 0:t.shadowRoot)||void 0===i?void 0:i.querySelector("textarea");r&&(r.style.resize="vertical")}getCharactersText(e){return this.i18n.charactersLeft.replace("${num}",""+(2048-e.length))}validate(){this.valid=!/>|</.test(this.summary)}render(){const{i18n:e,summary:t,label:i,scale:s,liveRegionText:o,valid:n}=this;return(0,r.h)("div",{class:`container-${s}`},(0,r.h)("calcite-label",{scale:s,class:"label"},(0,r.h)("p",{class:"label-text"},null!=i?i:e.summary),(0,r.h)("calcite-input",{type:"textarea",id:"summary-input",placeholder:e.addSummary,value:t,maxLength:2048,scale:s,status:n?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation();const t=e.target;this.summary=t.value,this.arcgisSummaryInputChange.emit(this.summary),this.updateLiveRegion(t.value),this.validate()}}),(0,r.h)("calcite-input-message",{hidden:n,icon:!0,scale:s,status:n?"idle":"invalid"},e.invalid),(0,r.h)("span",{class:"screen-readers-only","aria-live":"polite"},o)),n&&(0,r.h)("span",{class:"count","aria-hidden":"true"},this.getCharactersText(t)))}get el(){return(0,r.d)(this)}};async function w(e){null!=e||(e=n.c.user);const t=e.url+"/tags";try{return(await(0,p.r)(t)).tags}catch(e){console.error(e)}}y.style=":host{--arcgis-label-margin-bottom:1rem}.container-s{margin-bottom:0.5rem}.container-m{margin-bottom:0.75rem}.container-l{margin-bottom:1rem}.label{--calcite-label-margin-bottom:0}.label-text{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}.count{font-size:0.75rem;color:var(--calcite-color-text-1);opacity:0.75}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const x=class{constructor(e){(0,r.r)(this,e),this.arcgisTagsPickerChange=(0,r.c)(this,"arcgisTagsPickerChange",7),this.isTag=e=>void 0!==e.tag&&void 0!==e.count,this.controlledTags=[],this.mapItemValue=e=>e.map((e=>e.value)),this.handleKeydown=e=>{var t;if(","===e.key){const i=e.target,r=null===(t=null==i?void 0:i.shadowRoot)||void 0===t?void 0:t.querySelector("input");if(null==r?void 0:r.value){e.preventDefault();const t=i.querySelector(`calcite-combobox-item[value="${r.value}"]`);if(t)t.selected=!0;else{const e=document.createElement("calcite-combobox-item");e.value=r.value,e.textLabel=r.value,e.selected=!0,null==i||i.appendChild(e)}r.value=""}}},this.api=void 0,this.user=void 0,this.scale=void 0,this.activeTags=void 0,this.knownTags=[],this.label=void 0,this.placeholder=void 0,this.hideLabel=void 0}async componentWillLoad(){var e,t,i,r,s,o;const l=await(0,a.g)(this.el);this.i18n=l[0],null!==(e=this.user)&&void 0!==e||(this.user=n.c.user),null!==(t=this.scale)&&void 0!==t||(this.scale=n.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=n.c.api),null!==(r=this.activeTags)&&void 0!==r||(this.activeTags=c.i.tags),this.activeTags=(0,h.f)(this.activeTags),this.knownTags=(0,h.f)([...null!==(s=this.knownTags)&&void 0!==s?s:[],...null!==(o=this.activeTags)&&void 0!==o?o:[]]),c.a.on("reset",(()=>{this.activeTags=c.i.tags}))}async componentDidLoad(){var e,t,i;const{user:r}=this;if(r){const s=null!==(e=r.contentTags)&&void 0!==e?e:r.tags;!(null==s?void 0:s.length)||(null==s?void 0:s.length)>0&&!this.isTag(s[0])?this.knownTags=[...this.knownTags,...(await w(r)).map((e=>e.tag))]:this.knownTags=[...this.knownTags,...s.map((e=>e.tag))],this.knownTags=(0,h.f)([...null!==(t=this.activeTags)&&void 0!==t?t:[],...null!==(i=this.knownTags)&&void 0!==i?i:[]])}}itemPropertiesTagsChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];this.arcgisTagsPickerChange.emit((0,h.f)(r));const s=Array.from(this.combobox.children),o=this.combobox.selectedItems;s.forEach((e=>{this.controlledTags.includes(e.value)||e.remove()})),this.knownTags=this.mapItemValue(s),this.activeTags=this.mapItemValue(o)}renderFormattedTags(){const{i18n:e,scale:t,handleKeydown:i,placeholder:s}=this;this.knownTags.forEach((e=>{this.controlledTags.includes(e)||this.controlledTags.push(e)}));const o=this.knownTags.map((e=>{var t;return(0,r.h)("calcite-combobox-item",{key:e,value:e,textLabel:e.length>36?`${e.slice(0,36)}...`:e,selected:(null===(t=this.activeTags)||void 0===t?void 0:t.indexOf(e))>=0})}));return(0,r.h)("calcite-combobox",{label:e.tags,maxItems:5,"allow-custom-values":!0,placeholder:null!=s?s:e.addTags,scale:t,onKeyDown:i,ref:e=>this.combobox=e},o)}async setFocus(){var e;null===(e=this.combobox)||void 0===e||e.setFocus()}render(){const{i18n:e,scale:t,hideLabel:i,label:s}=this;return(0,r.h)("calcite-label",{scale:t},(0,r.h)("p",{class:{label:!0,"screen-reader-only":i}},null!=s?s:e.tags),this.renderFormattedTags())}get el(){return(0,r.d)(this)}};x.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.screen-reader-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const T=class{constructor(e){(0,r.r)(this,e),this.arcgisTitleInputChange=(0,r.c)(this,"arcgisTitleInputChange",7),this.debouncedInput=(0,l.d)((()=>this.handleTitleValidation()),400),this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.itemTitle=void 0,this.currentFolder=void 0,this.type=void 0,this.update=!1,this.enablePublishing=void 0,this.titleError=void 0}async focusMainInput(){var e,t;null===(t=(e=this.mainInputRef).setFocus)||void 0===t||t.call(e)}async validateTitle(){return this.debouncedInput.invoke()}async handleTitleValidation(){const{type:e,itemTitle:t,enablePublishing:i,portal:r,user:s,update:o}=this,{extension:n}=(0,g.a)(t);if(e)return this.titleError=await async function({portal:e,user:t,title:i,itemType:r,folder:s,extension:o,enablePublishing:n=!1,update:l=!1}){if(!t||!e)return{code:"missingUserOrPortal"};if(!i||i.length<=0)return{code:"titleRequired"};if("Data Store"===r&&(/[\s.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"dataStoreTitleInvalid"};if(!n&&(/<|>/gi.test(i)||i.length>250))return{code:"titleInvalid"};if(n&&(/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"serviceNameInvalid"};const a=n?function(e){switch(e){case"CSV":case"Microsoft Excel":case"GeoJson":case"Shapefile":case"File Geodatabase":case"Image Collection":case"GeoPackage":case"Service Definition":case"Feature Collection":return"Feature Service";case"Tile Package":return"Map Service";case"Vector Tile Package":return"Vector Tile Service";case"Scene Package":return"Scene Service";case"3DTiles Package":return"3DTiles Service"}return e}(r):r,{itemURLList:c}=await(0,u.s)(i,a,s,o,t,e)||{};if(c&&!l)return{code:"itemExists",itemUrl:c[0]};if(n){const t=await(0,p.r)(`${(0,p.g)(e)}portals/${e.id}/isServiceNameAvailable`,{name:i.replace(/\s/g,"_"),type:a});if(!(null==t?void 0:t.available))return{code:"titleInUseService",layerName:i}}return null}({portal:r,user:s,title:t,itemType:e,folder:this.currentFolder,extension:n,enablePublishing:i,update:o}),this.getErrorMessage();console.error("No item type found. Skipping title validation")}getErrorMessage(){const{itemTitle:e,titleError:t,i18n:i}=this;return e||(this.titleError={code:"titleRequired",translatedMessage:this.i18n.validation.titleRequired}),t&&(t.translatedMessage=i.validation[this.titleError.code].replace("${name}",e)),t}async componentWillLoad(){var e,t,i,r,s,o,l;const d=await(0,a.g)(this.el);this.i18n=d[0],null!==(e=this.portal)&&void 0!==e||(this.portal=n.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=n.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=n.c.scale),null!==(r=this.api)&&void 0!==r||(this.api=n.c.api),null!==(s=this.type)&&void 0!==s||(this.type=c.i.type),null!==(o=this.itemTitle)&&void 0!==o||(this.itemTitle=c.i.title),null!==(l=this.currentFolder)&&void 0!==l||(this.currentFolder=c.i.folder),this.itemTitle&&this.handleTitleValidation(),c.i.title=this.itemTitle,c.a.on("reset",(()=>{this.itemTitle=c.i.title}))}render(){var e;const{i18n:t,itemTitle:i,scale:s}=this,{translatedMessage:o,code:n}=this.titleError||{},l=!o;return(0,r.h)("calcite-label",{scale:s},(0,r.h)("p",{class:"label"},null!==(e=this.label)&&void 0!==e?e:t.title),(0,r.h)("calcite-input",{id:"item-properties-title",placeholder:t.addTitle,value:i,scale:s,onInput:this.debouncedInput,max:250,ref:e=>this.mainInputRef=e,status:l?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation(),this.itemTitle=e.target.value,this.arcgisTitleInputChange.emit(this.itemTitle)}}),(0,r.h)("calcite-input-message",{icon:!0,hidden:l,status:l?"idle":"invalid"},o||t[n]||t.title))}get el(){return(0,r.d)(this)}static get watchers(){return{currentFolder:["handleTitleValidation"]}}};T.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}"},66495:(e,t,i)=>{i.d(t,{a:()=>d,b:()=>c,f:()=>a,g:()=>l,u:()=>u});var r=i(20164),s=i(49853),o=i(92638),n=i(12046);const l=async({portal:e,user:t,group:i,useCache:r=!1})=>{var s;try{const o=await(i?c(i.id,e,r):a(e,t,r));return{result:null!==(s=null==o?void 0:o.categorySchema)&&void 0!==s?s:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function a(e,t,i=!0){if(null!=e||(e=s.c.portal),null!=t||(t=s.c.user),!(null==e?void 0:e.id)||t&&(0,n.a)(t))return null;const o=()=>(0,r.r)(`${(0,r.g)(e)}portals/${e.id}/categorySchema`);return i?(0,r.f)(o,"categorySchema",e.id):o()}async function c(e,t,i=!0){if(null!=t||(t=null===s.c||void 0===s.c?void 0:s.c.portal),!e||!t)return null;const n=()=>(0,r.r)(`${(0,o.g)(t,{id:e})}categorySchema`);return i?(0,r.f)(n,"categorySchema",e):n()}async function d(e,t,i=!0){const s=()=>async function(e,t){var i;const s=(0,r.g)(e),o=await(0,r.r)(`${s}portals/self`),n=await(0,r.r)(`${s}community/groups?q=${o.contentCategorySetsGroupQuery}`),l=null===(i=null==n?void 0:n.results)||void 0===i?void 0:i[0],a=(await(0,r.r)(`${s}content/groups/${l.id}/search`,{q:`typekeywords: ${t}`})).results[0];return(0,r.r)(`${s}content/items/${a.id}/data`)}(e,t);return i?(0,r.f)(s,"categorySchema",t):s()}async function u({categories:e,itemIds:t,portal:i}){try{const s=`${(0,r.g)(i)}/content/updateItems`,o=JSON.stringify(t.map((t=>({[t]:{categories:Array.isArray(e)?e:e[t]}}))));return{result:await(0,r.r)(s,{items:o},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}},85984:(e,t,i)=>{i.d(t,{C:()=>r,U:()=>s,a:()=>o,g:()=>n});const r="/categories",s="/Categories",o=(e,t,i=!0)=>{const r=null!=e?e:"";return`${r}${r.endsWith("/")?"":"/"}${i?t.title.toLocaleLowerCase():t.title}`};function n(e){var t;let i=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return i&&"/"!==i.charAt(0)&&(i=`/${i}`),i||s}},41487:(e,t,i)=>{i.d(t,{a:()=>o,f:()=>c,g:()=>a,s:()=>n,v:()=>l});var r=i(13615),s=i(31500);function o(e,t){const i=/(?:\.([^.]+))?$/;let r=e.replace(/^.*(\\|\/|:)/,""),o=r&&i.exec(r)[1]?i.exec(r)[1].toLowerCase():"",n="";if(r.indexOf(".rft.")>-1){const[e,t]=r.split(".rft.");o=`rft.${t}`,n=e}return r&&!n&&(n=-1===r.lastIndexOf(".")?r:r.substring(0,r.lastIndexOf("."))),n=n.replace(/\.|-/g,"_"),t&&(n=function(e){return`${e}_${(0,s.g)()}`}(n),r=`${n}.${o}`),{title:n,fileName:r,extension:o}}function n(e,t){return o(e.name,!!t)}function l(e,t){let i=e;const r=e.lastIndexOf("\\");return r>-1&&(i=i.substring(r+1,i.length)),i.replace(/\ /g,"_")===t.replace(/\ /g,"_")}function a(e){return r.a[e]?r.a[e]:r.a[Object.keys(r.a).find((t=>r.a[t].type===e))]}function c(e){if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["B","KB","MB","GB","TB"][t]}`}},64606:(e,t,i)=>{i.d(t,{a:()=>s,f:()=>o,s:()=>l});var r=i(36238);const s=e=>(null==e?void 0:e.replace(/(\s+|:)/g,"_"))||"",o=e=>{const t=e=>e.split(",").map((e=>e.trim())).filter((e=>e));return e?"string"==typeof e?(0,r.b)(t(e)):(0,r.b)(e.flatMap((e=>[...t(e)]))):[]},n=async e=>new Promise(((t,i)=>{for(let r=0;r<e.length;r++)e[r].then((i=>{const s=[...e];s.splice(r,1),t({remainingPromises:s,result:i})})).catch(i)}));async function l(e,t){var i,r;const s=[],{getBatchSize:o,onPromiseCompleted:l,onPromiseThrow:a,shouldContinue:c}=null!=t?t:{};let d=[];for(let t=0;t<(null!==(i=null==o?void 0:o())&&void 0!==i?i:1);t++)try{const t=e();t&&d.push(t)}catch(e){null==a||a(e)}let u=null;for(;d.length>0&&(!c||c(u));)try{const{remainingPromises:t,result:i}=await n(d);d=t,u=i,i&&s.push(i),null==l||l(i);const a=null!==(r=null==o?void 0:o())&&void 0!==r?r:1;for(;d.length<a;){const t=e();if(t&&d.push(t),null==t)break}}catch(e){null==a||a(e)}return s}},92638:(e,t,i)=>{i.d(t,{g:()=>o});var r=i(20164),s=i(79210);const o=(e,t)=>(0,s.a)(`${(0,r.g)(e)}/community/groups/${t.id}`)},31500:(e,t,i)=>{i.d(t,{g:()=>r});const r=()=>[2,1,1,1,3].map((e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t})).join("-")},74689:(e,t,i)=>{i.d(t,{a:()=>n,b:()=>o,c:()=>a,d:()=>d,g:()=>u,i:()=>l,u:()=>c});var r=i(79210);function s(e){var t;return!!(null===(t=e.owner)||void 0===t?void 0:t.toLowerCase().includes("esri"))}function o(e){var t;return s(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Credits"))}function n(e){var t;return s(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Subscription"))}function l(e,t){return e.owner===t.username}function a(e,t){return c(e,t)||"update"===e.itemControl}function c(e,t){return l(e,t)||function(e,t){var i;if(null!=e.isAdmin)return!!e.isAdmin;const r=e.owner,s="admin"===e.itemControl;return!((null===(i=e.portal)||void 0===i?void 0:i.isPortal)&&!l(e,t)&&s&&r.includes("esri_")&&!["esri_livingatlas","esri_demographics","esri_boundaries"].includes(r))&&s}(e,t)}const d=(e,t)=>!!t.orgId&&e.every((e=>e.isOrgItem)),u=(e,t)=>`${(0,r.a)(t)}item.html?id=${e}`},12846:(e,t,i)=>{i.d(t,{a:()=>r,i:()=>s});const r=(0,i(70464).c)({title:"",snippet:"",tags:[],categories:[]}),s=r.state},12046:(e,t,i)=>{i.d(t,{a:()=>o,b:()=>a,c:()=>n,d:()=>d,e:()=>h,f:()=>u,g:()=>y,h:()=>c,i:()=>l,j:()=>p,k:()=>g,l:()=>b,m:()=>m,n:()=>v,o:()=>f,p:()=>x,q:()=>w});var r=i(74689);const s=e=>{var t,i,r;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(i=null!==(t=null==e?void 0:e.roleId)&&void 0!==t?t:null==e?void 0:e.id)&&void 0!==i?i:null===(r=null==e?void 0:e.sourceJSON)||void 0===r?void 0:r.id};function o(e){return e&&!e.orgId}function n(e){return!e.isPortal||!!e.isBackedBySDS}function l(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function a(e){return"org_admin"===s(e)||"account_admin"===s(e)}function c(e){return"org_user"===s(e)||"account_user"===s(e)}function d(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function u(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItemCategorySchema"))}function h(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateGroups"))}function p(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function g(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function v(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function m(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function f(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function b(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function y(e,t,i,r){const s=r&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(r.type),o=((null==t?void 0:t.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!t||!a(t)&&!o||!(null==i?void 0:i.isPortal)&&!s)}function w(e){return!!e&&(!d(e)||d(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const x=({items:e,user:t,portal:i})=>{const s=e[0],o=s.owner;if(i.isPortal&&o!==t.username&&o.includes("esri_")&&!["esri_livingatlas"].includes(o))return!1;const n=(0,r.u)(s,t),l=d(t),a=T(t),c=(0,r.c)(s,t)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(t)&&!l&&(function(e,t){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(t)||p(e)||g(e)||!!t.canSharePublic&&v(e)}(t,i)||T(t));return n||c||(0,r.d)(e,t)&&a};function T(e){return b(e)||m(e)||f(e)}},82102:(e,t,i)=>{i.d(t,{a:()=>m,b:()=>F,c:()=>$,d:()=>y,e:()=>f,f:()=>u,g:()=>v,h:()=>h,i:()=>p,j:()=>T,k:()=>g,l:()=>C,m:()=>b,n:()=>x,s:()=>I,u:()=>w});var r=i(20164),s=i(49853),o=i(74689),n=i(12846),l=i(20206),a=i(65804),c=i(64606),d=i(13615);function u({title:e,snippet:t,tags:i}){return{title:e,snippet:t,tags:(0,c.f)(i).join(",")}}const h=(e,t)=>{var i;const{file:r,type:s,extension:o,dataUrl:n,properties:l,typeKeywords:a}=t,c=u(e),h=[...null===(i=d.a[s])||void 0===i?void 0:i.typeKeywords,...a?[a]:[],o].join(", "),p=Object.assign({type:s,extension:o},l?{properties:JSON.stringify(l)}:{}),g=r?{file:r}:{dataUrl:n.includes('httpHeaders={"Authorization"')?n:encodeURI(n)};return Object.assign(Object.assign(Object.assign(Object.assign({},p),g),c),{typeKeywords:h})},p=(e,t)=>{const i=h(e,t),r=!!t.addAsUniqueFile,s=new FormData;return s.append("f","json"),s.append("async","true"),Object.keys(i).forEach((e=>{if(r&&"file"===e){const r=t.fileName;s.append(e,i[e],r)}else s.append(e,i[e])})),s},g=(e,t)=>{const i=(null==t?void 0:t.id)&&!function(e){return["all","recycle"].includes(e.id)||e.id===e.username}(t)?`/${t.id}`:"";return`${e.userContentUrl}${i}/addItem`},v=(e,t)=>`${(0,r.g)(t)}content/items/${e}`,m=async(e,t)=>{try{const i=v(e,t);return{result:await(0,r.r)(i)}}catch(e){return console.warn("error getting item",e),{error:{code:"unhandledError"}}}},f=async(e,t)=>{const i=new FormData;switch(t.type){case"base64":i.append("data",t.data);break;case"url":i.append("url",t.url);break;case"file":i.append("file",t.file)}return i.append("f","json"),i.append("token",(0,r.e)(s.c.portal)),await(0,r.d)(`${(0,r.g)()}content/users/${s.c.user.username}/items/${e}/updateThumbnail`,i,{},"post")};async function b(e,t){const i=`${s.c.user.userContentUrl}/moveItems`;return await(0,r.r)(i,{items:e,folder:t},{},"post")}async function y(e,{permanentDelete:t=!1}={}){const i=`${s.c.user.userContentUrl}/items/${e}/delete`;return await(0,r.r)(i,{permanentDelete:t},{},"post")}async function w(e,t,i){var o;const n=null!==(o=null!=i?i:s.c.user)&&void 0!==o?o:s.c.portal.user,c=`${"append"===a.u.workflow?l.a.existingItem.itemOwner.userContentUrl:n.userContentUrl}/items/${e}/update`;return(0,r.r)(c,t,{},"post")}const x=(e,t)=>{const i=`${(0,r.g)(t)}content/items/${e}/data`;return(0,r.r)(i)},T=async(e,t)=>{const i=`${s.c.user.userContentUrl}/items/${e}/commit`,o=p(n.i,t);return o.delete("file"),await(0,r.d)(i,o,{},"post")},C=async e=>{const t=`${s.c.user.userContentUrl}/items/${e}/cancel`;return await(0,r.r)(t,{},{},"post")},F=async e=>{const t=g(s.c.user,n.i.folder),i=u(n.i),o=Object.assign({},e);return delete o.initialFolders,delete o.initialTitle,delete o.newItemMode,delete o.serviceInfo,delete o.allowStoredAuth,delete o.isSecured,delete o.checkAuth,delete o.agsType,delete o.developerCredentialsType,delete o.applicationEnvironment,delete o.apiKeyReferrerUrls,delete o.developerCredentialsRedirectUrls,delete o.developerPrivileges,await(0,r.r)(t,Object.assign(Object.assign(Object.assign(Object.assign({},o),(e=>e.url&&!!e.serviceInfo)(e)?{serviceInfo:JSON.stringify(e.serviceInfo)}:{}),{typeKeywords:JSON.stringify(e.typeKeywords)}),i),{},"post")};async function I(e,t,i,n,l,a){null!=l||(l=s.c.user),null!=a||(a=s.c.portal);const c=i&&i.id!==l.username?i.id:"root",d=e.replace(`.${n}`,"");if("featurecollection"===n||"Microsoft Excel"===t)return null;const u=[`title: "${d}"`,`type: "${t}"`,`owner: "${l.username}"`,`ownerfolder: "${c}"`],h=await(0,r.r)(`${(0,r.g)(a)}search`,{filter:u.join(" AND "),num:1});return(null==h?void 0:h.total)>0?{num:h.num,itemURLList:h.results.map((e=>(0,o.g)(e.id,s.c.config.baseUrl)))}:null}async function $(e,t){const i=(0,c.a)(e),{user:l,config:a,portal:d}=s.c,{folder:u}=n.i,h=u&&u.id!==l.username?u.id:"root",p=[`owner: "${l.username}"`,`ownerfolder: "${h}"`];t&&p.push(`type: "${t}"`);let g,v=1;for(let e=0;e<10&&!g&&v>-1;e++){const{nextStart:e,results:t}=await(0,r.r)(`${(0,r.g)()}search`,{[d.isPortal?"q":"filter"]:p.join(" AND "),num:100,start:v});g=t.find((e=>e.name===i)),v=e}return g?(0,o.g)(g.id,a.baseUrl):null}},65804:(e,t,i)=>{i.d(t,{a:()=>r,u:()=>s});const r=(0,i(70464).c)({nextText:"next",workflow:"content",scale:"m",disableScroll:!1,featureFlags:{}}),s=r.state},70105:(e,t,i)=>{i.d(t,{a:()=>u,b:()=>h,c:()=>p,d:()=>l,e:()=>a,f:()=>o,g:()=>d,u:()=>g});var r=i(20164),s=i(49853);async function o(e,t){return(0,r.r)(`${(0,r.g)(t)}/community/users/${e}`)}async function n(){return(0,r.r)(`${(0,r.g)()}/community/self`)}async function l(){var e;const t=null===s.c||void 0===s.c?void 0:s.c.user;if(!t)return[];const i=await(0,r.f)((()=>n()),"communitySelf",t.username);return null!==(e=null==i?void 0:i.groups)&&void 0!==e?e:[]}async function a(){const e=null===s.c||void 0===s.c?void 0:s.c.user;return e?(await(0,r.f)((()=>n()),"communitySelf",e.username)).favGroupId:null}function c(e,t){var i;return null!==(i=null==e?void 0:e.userContentUrl)&&void 0!==i?i:`${null==t?void 0:t.restUrl}/content/users/${e.username}`}async function d(e){var t;const i=null!==(t=null!=e?e:s.c.user)&&void 0!==t?t:s.c.portal.user,{folders:o}=await async function(e){var t;const i=c(null!==(t=null!=e?e:s.c.user)&&void 0!==t?t:s.c.portal.user,s.c.portal),o=await(0,r.r)(i,{num:1});return Promise.resolve(o)}(i),{username:n}=i;return[{username:n,id:n,title:n,created:"now"},...o.sort(((e,t)=>e.title.localeCompare(t.title)))]}async function u(e,t){var i;const r=null!==(i=null!=t?t:s.c.user)&&void 0!==i?i:s.c.portal.user;return(await d(r)).find((t=>t.id===e))}function h(e){return{username:e,id:e,title:e,created:"now"}}async function p(e,t){var i;const o=`${c(null!==(i=null!=t?t:s.c.user)&&void 0!==i?i:s.c.portal.user,s.c.portal)}/createFolder`;return await(0,r.r)(o,{title:e},{},"post")}async function g(e,t,i){var o;const n=`${c(null!==(o=null!=i?i:s.c.user)&&void 0!==o?o:s.c.portal.user,s.c.portal)}/${e}/updateFolder`;try{return{result:await(0,r.r)(n,{newTitle:t},{},"post")}}catch(e){return{error:{code:"unhandledError"}}}}}}]);