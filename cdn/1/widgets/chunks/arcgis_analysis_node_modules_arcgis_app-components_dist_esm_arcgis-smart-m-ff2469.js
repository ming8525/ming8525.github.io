/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-smart-m-ff2469.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-smart-m-ff2469"],{14928:(e,o,i)=>{i.r(o),i.d(o,{arcgis_smart_mapping_relationship_focus_button:()=>a});var t=i(81149),s=i(9225),n=i(5996),l=(i(69283),i(49306),i(67214));i(51837),i(42577),i(82218),i(70464),i(10519);const a=class{constructor(e){(0,t.r)(this,e),this.arcgisSmartMappingRelationshipFocusButtonChange=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonChange",7),this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonBeforeOpen",7),this.arcgisSmartMappingRelationshipFocusButtonError=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonError",7),this.open=!1,this.flowItemNode=void 0,this.selectedFocusInfo=void 0}async setFocus(){this.buttonNode.focus()}componentWillLoad(){const{layer:e,strings:o}=s.s,i=(0,s.h)(e);this.focusInfos=[{focus:"HH",title:o.relationshipFocusButton.focusHighHigh,msg:o.relationshipFocusButton.focusHighHighMsg,selected:!1,iconPath:null},{focus:"HL",title:o.relationshipFocusButton.focusHighLow,msg:o.relationshipFocusButton.focusHighLowMsg,selected:!1,iconPath:null},{focus:"LH",title:o.relationshipFocusButton.focusLowHigh,msg:o.relationshipFocusButton.focusLowHighMsg,selected:!1,iconPath:null},{focus:"LL",title:o.relationshipFocusButton.focusLowLow,msg:o.relationshipFocusButton.focusLowLowMsg,selected:!1,iconPath:null},{focus:"none",title:o.relationshipFocusButton.none,msg:o.relationshipFocusButton.focusNoneMsg,selected:!1,iconPath:null}],this.setSelectedFocus(i.authoringInfo.focus)}render(){const{strings:e}=s.s;return(0,t.h)(t.H,null,(0,t.h)("calcite-label",{class:"focus-margin"},e.relationshipFocusButton.focus,(0,t.h)("div",{class:"focus-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.relationshipFocusButton.focus,ref:e=>{e&&(this.buttonNode=e)},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openFocusDropdown())},onClick:()=>this.openFocusDropdown()},(0,t.h)("div",{class:"focus-content"},(0,t.h)("div",{class:"focus-button-text"},(0,t.h)("div",{class:"focus-button-title"},this.selectedFocusInfo.title),(0,t.h)("div",{class:"focus-button-msg"},this.selectedFocusInfo.msg)),(0,t.h)("div",null,(0,t.h)("calcite-icon",{scale:"s",icon:"chevron-down"}))))))}closePopover(){var e;this.open=!1,this.dropdownNode&&(null===(e=this.dropdownNode.parentNode)||void 0===e||e.removeChild(this.dropdownNode),this.dropdownNode=null,this.buttonNode.classList.remove("active"))}openFocusDropdown(){if(this.open)this.open=!1;else{this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen.emit();const e=document.createElement("arcgis-smart-mapping-dropdown");e.buttonNode=this.buttonNode,e.infos=this.focusInfos,this.dropdownNode=e,e.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closePopover(),"Escape"===e.detail&&this.setFocus()})),e.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setNewFocus(e.detail))),this.buttonNode.classList.add("active"),document.body.appendChild(e),this.open=!0}}setNewFocus(e){const{layer:o}=s.s,i=(0,s.h)(o).authoringInfo.focus,t=e.focus;if(t===i)return this.closePopover(),void setTimeout((()=>this.setFocus()),300);(0,n.r)((0,l.u)({focus:t}),this.flowItemNode).then((i=>{this.setSelectedFocus(e.focus),(0,s.e)(i,o),(0,s.ab)(),setTimeout((()=>this.setFocus()),300),this.arcgisSmartMappingRelationshipFocusButtonChange.emit()})),this.closePopover()}setSelectedFocus(e){this.focusInfos.forEach((o=>{o.focus===e?(this.selectedFocusInfo=o,o.selected=!0):o.selected=!1}))}get hostElement(){return(0,t.d)(this)}};a.style=".focus-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:2px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.focus-button:active{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.focus-button:focus{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.focus-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.focus-content{justify-content:space-between;display:flex;align-items:center;width:100%}.focus-button-text{display:inline-block;padding:0 10px}.focus-button-title{font-weight:bold}.focus-button-msg{font-size:80%;line-height:16px}.focus-margin{margin:12px 0}"},5996:(e,o,i)=>{let t,s;function n(e){e.loading=!1}function l(e,o){return function(e){e.loading=!0,s=!1,t&&clearTimeout(t),t=setTimeout((()=>{n(e),s=!0}),6e4)}(o),e.then((e=>(n(o),s?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(n(o),Promise.reject(e))))}i.d(o,{r:()=>l})},67214:(e,o,i)=>{i.d(o,{a:()=>l,c:()=>n,u:()=>a});var t=i(9225),s=(i(69283),i(10519));function n(e){var o,i;const{layer:n,mapImageSublayer:l,mapView:a,modules:r}=t.s,c=n,u=(0,t.g)();let d=e.relationshipScheme;if(!d&&["relationship","relationship-size"].indexOf(u)>-1&&(d=(0,t.a0)()),e=e||{},"relationship-size"===u){const i=(0,t.h)(c).clone(),s=i.authoringInfo;if(s&&(null===(o=e.fieldInfos)||void 0===o?void 0:o.length)>1&&e.fieldInfos[0].field==s.field1.field&&e.fieldInfos[1].field==s.field2.field){if(i.visualVariables=(0,t.n)(i,"size"),i.authoringInfo.visualVariables=(0,t.o)(i,"size"),(0,t.q)(c)){const e=(0,t.S)(c,a),o=i.uniqueValueInfos.slice();o.map((o=>{const i=(0,t.t)(o.symbol);o.symbol=e.clone(),(0,t.r)(o.symbol,i)})),i.uniqueValueInfos=o}return Promise.resolve({renderer:i})}}const f=(0,t.m)((0,t.h)(c)),h={layer:c,view:a,field1:{field:e.fieldInfos[0].field},field2:{field:e.fieldInfos[1].field},classificationMethod:"quantile",numClasses:3,focus:"HH",relationshipScheme:d,outlineOptimizationEnabled:!l&&(!(0,s.i)(e.outlineOptimizationEnabled)||e.outlineOptimizationEnabled),sizeOptimizationEnabled:!l&&(!(0,s.i)(e.sizeOptimizationEnabled)||e.sizeOptimizationEnabled),legendOptions:e.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===(null===(i=c.featureReduction)||void 0===i?void 0:i.type)};return r.RelationshipCreator.createRenderer(h).then((e=>((0,t.l)(f,e.renderer),Promise.resolve(e))),(e=>Promise.reject(e)))}function l(e){var o;const{layer:i,mapImageSublayer:n,mapView:l,modules:a}=t.s,r=i;e=e||{};const c=(0,t.h)(r),u=(0,t.g)(),d=c.authoringInfo,f=(0,t.a)(c,"size");if(e.fieldInfos&&e.fieldInfos.length>1&&e.fieldInfos[0].field==d.field1.field&&e.normalizationField1===d.field1.normalizationField&&e.fieldInfos[1].field==d.field2.field&&e.normalizationField2===d.field2.normalizationField&&(delete e.fieldInfos,delete e.normalizationField1,delete e.normalizationField2,(0,t.R)(e)&&!f))return Promise.resolve({renderer:c.clone()});let h=e.relationshipScheme;!h&&["relationship","relationship-size"].indexOf(u)>-1&&(h=(0,t.a0)());const p=(0,t.m)(c);let m=e.fieldInfos?e.fieldInfos[0]:{field:d.field1.field,simpleFieldType:t.w.NUMBER},g=e.fieldInfos?e.fieldInfos[1]:{field:d.field2.field,simpleFieldType:t.w.NUMBER};const b=void 0!==e.normalizationField1?e.normalizationField1:d.field1.normalizationField,v=void 0!==e.normalizationField2?e.normalizationField2:d.field2.normalizationField,F=c.uniqueValueInfos&&c.uniqueValueInfos.length?c.uniqueValueInfos[0].symbol:null,w=c.defaultSymbol,z=c.defaultLabel,y=e.numClasses?e.numClasses:d.numClasses;return a.RelationshipCreator.createRenderer({layer:r,view:l,field1:{field:m?m.field:c.field,normalizationField:b},field2:{field:g?g.field:c.field,normalizationField:v},classificationMethod:e.classificationMethod?e.classificationMethod:"manual"!==d.classificationMethod?d.classificationMethod:"quantile",numClasses:y,focus:e.focus?e.focus:d.focus,relationshipScheme:h,outlineOptimizationEnabled:!n&&((0,s.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!!p.sizeOutlineVisVar),sizeOptimizationEnabled:!n&&((0,s.i)(e.sizeOptimizationEnabled)?e.sizeOptimizationEnabled:!!p.sizeAutoVisVar),legendOptions:e.legendOptions?e.legendOptions:c.legendOptions,defaultSymbolEnabled:(0,s.i)(e.defaultSymbolEnabled)?e.defaultSymbolEnabled:!!c.defaultSymbol,forBinning:"binning"===(null===(o=r.featureReduction)||void 0===o?void 0:o.type)}).then((o=>((0,t.l)(p,o.renderer),F&&o.renderer.uniqueValueInfos.forEach((e=>{const o=F.clone();(0,t.r)(o,(0,t.t)(e.symbol)),e.symbol=o})),e.numClasses&&e.numClasses!==d.numClasses||(0,t.h)(r).uniqueValueInfos.forEach((e=>{o.renderer.uniqueValueInfos.forEach((o=>{e.value===o.value&&(o.label=e.label)}))})),w&&(o.renderer.defaultSymbol=w,o.renderer.defaultLabel=z),Promise.resolve(o))),(e=>Promise.reject(e)))}function a(e){const{layer:o,modules:i}=t.s;e=e||{};const s=(0,t.h)(o),n=s.authoringInfo;return i.RelationshipCreator.updateRenderer({field1:n.field1,field2:n.field2,numClasses:e.numClasses?e.numClasses:n.numClasses,focus:e.focus?"none"===e.focus?null:e.focus:n.focus,colors:e.colors,renderer:s})}}}]);