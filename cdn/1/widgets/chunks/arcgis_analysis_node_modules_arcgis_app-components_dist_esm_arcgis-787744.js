/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-787744.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-787744"],{28219:(e,t,i)=>{i.r(t),i.d(t,{arcgis_image_collection_explorer:()=>o});var a=i(81149),l=i(82218),n=i(51837),s=i(69283),r=i(59224);i(42577);const o=class{constructor(e){(0,a.r)(this,e),this.arcgisImageItemExplorerDismissedChange=(0,a.c)(this,"arcgisImageItemExplorerDismissedChange",7),this.handleCloseClick=()=>{this.arcgisImageItemExplorerDismissedChange.emit()},this.handleActiveTabChange=e=>{this.activeTab=e},this.handleImageItemQueryApplied=async()=>{var e,t,i,a;this.isShowingFilteredImageItemResultsPane=!0;const{view:l,layer:n,selectedAOI:s,activeQueryField:o,isOverviewsIncluded:c,selectedQueryFieldValues:d}=this;this.isQueryingImageItems=!0,this.clearImageItemSelection(),this.imageItemCardDisplayedFieldNames=[];const u=(0,r.b)(n,o,d,s,c,l.extent);let m,h;try{s===r.A.Visible?(h=await(0,r.g)(n,l,u),m=null!==(t=null===(e=null==h?void 0:h.features)||void 0===e?void 0:e.length)&&void 0!==t?t:0):(m=await(0,r.a)(n,u),h=await(0,r.c)(n,u)),this.totalImageItemCount=m}catch(e){this.totalImageItemCount=0,this.imageItems=null}finally{this.isQueryingImageItems=!1}if(!Array.isArray(null==h?void 0:h.features))return this.imageItems=null,void(this.inspectImageItemObjectId=null);const p=n.objectIdField,g=(null===(i=this.selectedImageItemObjectIds)||void 0===i?void 0:i.length)>0?this.selectedImageItemObjectIds[0]:null===(a=h.features[0])||void 0===a?void 0:a.attributes[p];this.imageItems=h,this.inspectImageItemObjectId=g,this.handleDisplayedFieldsInImageItemCardChange(o.name),this.refreshImageItemInfo(g)},this.handleSelectedImageItemChange=e=>{this.inspectImageItemObjectId=e,this.refreshImageItemInfo(e)},this.handleSelectNextImageItem=()=>{const{selectedImageItemObjectIds:e,inspectImageItemObjectId:t,imageItems:i,layer:a}=this,l=a.objectIdField,n=e.length>0?e:i.features.map((e=>e.attributes[l])),s=n.findIndex((e=>e===t)),r=n[s+1===n.length?0:s+1];this.inspectImageItemObjectId=r,this.refreshImageItemInfo(r)},this.handleSelectPrevImageItem=()=>{const{selectedImageItemObjectIds:e,inspectImageItemObjectId:t,imageItems:i,layer:a}=this,l=a.objectIdField,n=e.length>0?e:i.features.map((e=>e.attributes[l])),s=n.findIndex((e=>e===t)),r=n[s-1<0?n.length-1:s-1];this.inspectImageItemObjectId=r,this.refreshImageItemInfo(r)},this.refreshImageItemInfo=async e=>{const{layer:t}=this,i=await t.getCatalogItemRasterInfo(e);this.imageItemInfo=i},this.handleDisplayedFieldsInImageItemCardChange=e=>{const{imageItemCardDisplayedFieldNames:t,layer:i,activeQueryField:a}=this;let l=[];t.includes(e)||(l=[...t,e]),(0,r.d)(i,a).forEach((e=>{l.includes(e.name)||l.push(e.name)})),this.imageItemCardDisplayedFieldNames=l},this.handleOpenConfigResultsModal=()=>{const{isShowingConfigResultsModal:e}=this;this.isShowingConfigResultsModal=!e},this.handleImageItemCardMouseOver=async e=>{const{view:t,imageItemExtentGraphic:i,imageItemExtentGraphicLayer:a,modules:l}=this,{Color:n,Graphic:s,GraphicsLayer:r,SimpleFillSymbol:o}=l;if(!a){const e=new r;t.map.add(e),this.imageItemExtentGraphicLayer=e}if(this.imageItemExtentGraphic)this.imageItemExtentGraphicLayer.removeAll(),i.geometry=e,this.imageItemExtentGraphicLayer.add(i);else{const t=new s({geometry:e,symbol:new o({outline:{color:new n([214,137,16]),width:2},color:new n([249,231,159,.5])})});this.imageItemExtentGraphic=t,this.imageItemExtentGraphicLayer.add(t)}},this.handleImageItemCardMouseOut=()=>{var e;this.imageItemExtentGraphic=null,null===(e=this.imageItemExtentGraphicLayer)||void 0===e||e.removeAll()},this.getLayerAttributeValues=async e=>{var t,i;const{layer:a,view:l,selectedAOI:n,fetchAbortController:s}=this;s&&s.abort();let o=[];try{this.fetchAbortController=new AbortController,this.isQueryingFieldValues=!0,this.fieldValuesForInput=[],this.selectedQueryFieldValues=[];const[s,c]=await(0,r.e)(a,e,n,l.extent,null===(t=this.fetchAbortController)||void 0===t?void 0:t.signal);this.fieldMinMaxValuesForInput=[s,c],o=await(0,r.f)(a,e,n,l.extent,null===(i=this.fetchAbortController)||void 0===i?void 0:i.signal),this.isQueryingFieldValues=!1}catch(e){this.isQueryingFieldValues=!!(0,r.i)(e)}this.fieldValuesForInput=o},this.clearImageItemSelection=()=>{this.selectedImageItemObjectIds=[]},this.showTooltip=e=>{this.dismissTooltip(),this.tooltipEl=document.createElement("calcite-tooltip"),this.tooltipEl.placement="auto",this.tooltipEl.referenceElement=e.referenceElement,this.tooltipEl.overlayPositioning="fixed",this.tooltipEl.innerHTML=e.innerHTML,this.tooltipEl.open=!0,this.hostElement.parentElement.appendChild(this.tooltipEl)},this.dismissTooltip=()=>{var e;(null===(e=this.tooltipEl)||void 0===e?void 0:e.parentNode)&&(this.tooltipEl.parentNode.removeChild(this.tooltipEl),this.tooltipEl=void 0)},this.jsapiUrl=void 0,this.portal=void 0,this.layer=void 0,this.view=void 0,this.activeTab=r.N.Select,this.activeQueryField=void 0,this.selectedAOI=r.A.Visible,this.totalImageItemCount=0,this.imageItems=void 0,this.selectedImageItemObjectIds=[],this.inspectImageItemObjectId=void 0,this.imageItemInfo=void 0,this.imageItemCardDisplayedFieldNames=[],this.isShowingFilteredImageItemResultsPane=!1,this.isShowingConfigResultsModal=!1,this.isShowingThumbnails=!1,this.isOverviewsIncluded=!1,this.isQueryingImageItems=!1,this.isQueryingFieldValues=!1,this.selectedQueryFieldValues=[],this.fieldValuesForInput=[],this.fieldMinMaxValuesForInput=[],this.isRangeValueModeSelected=!0}handleConfigCardResultsModalClosed(){this.isShowingConfigResultsModal=!1}handleConfigCardResultsModalSaved(e){const{selectedFieldNames:t,isShowingThumbnails:i}=e.detail;this.isShowingThumbnails=i,this.imageItemCardDisplayedFieldNames=t}async setFocus(){var e;null===(e=this.refCloseButtonNode)||void 0===e||e.setFocus()}async componentWillLoad(){var e;[this.strings]=await(0,l.g)(this.hostElement);const[t,i,a,n,o]=await(0,s.l)(["esri/Color","esri/identity/IdentityManager","esri/Graphic","esri/layers/GraphicsLayer","esri/symbols/SimpleFillSymbol"]);this.modules={Color:t,IdentityManager:i,Graphic:a,GraphicsLayer:n,SimpleFillSymbol:o};const c=(0,r.h)(null===(e=this.layer)||void 0===e?void 0:e.fields),d=(0,r.j)(c),u=this.activeQueryField||d;this.activeQueryField=u,this.getLayerAttributeValues(u.name)}render(){const{activeTab:e,strings:t,inspectImageItemObjectId:i,imageItemInfo:l,imageItemCardDisplayedFieldNames:s,isShowingFilteredImageItemResultsPane:o,isShowingThumbnails:c,layer:d}=this,u="rtl"===(0,n.g)(this.hostElement),m=!(null==d?void 0:d.loaded);return(0,a.h)(a.H,{class:"calcite-match-height"},(0,a.h)("calcite-panel",{loading:m,heading:t.imageCollectionExplorer,class:{panel:!0,[n.C.rtl]:u}},this.renderClose(),this.renderActionGroup(),e===r.N.Select&&(0,a.h)("div",null,this.renderSelectInput(),o&&this.renderSelectResults(),(0,a.h)("arcgis-config-image-item-card-results-modal",{open:this.isShowingConfigResultsModal,fields:d.fields,preSelectedFieldNames:s,isShowingThumbnails:c})),e===r.N.Inspect&&(i&&i>0?(0,a.h)("div",null,this.renderImageItemSelectDropdown(),this.renderImageItemPreviewView(),l&&this.renderImageItemInfoTables()):(0,a.h)("div",null,t.noSelectedItemToInspectCoachMessage))))}renderClose(){const{strings:e}=this;return(0,a.h)("calcite-action",{text:e.close,icon:"x",slot:"header-actions-end",onClick:this.handleCloseClick,ref:e=>this.refCloseButtonNode=e})}renderActionGroup(){const{strings:e,activeTab:t}=this;return(0,a.h)("calcite-action-group",{layout:"grid",scale:"l",columns:2},(0,a.h)("calcite-action",{"data-label":r.N.Select,active:t===r.N.Select,text:e.select,textEnabled:!0,alignment:"center",onClick:()=>this.handleActiveTabChange(r.N.Select)}),(0,a.h)("calcite-action",{"data-label":r.N.Inspect,active:t===r.N.Inspect,text:e.inspect,textEnabled:!0,alignment:"center",onClick:()=>this.handleActiveTabChange(r.N.Inspect)}))}renderSelectInput(){const{strings:e}=this;return(0,a.h)("calcite-block",{collapsible:!0,heading:e.filters,open:!0},(0,a.h)("div",null,this.renderAOISelectDropdown(),this.renderAttributeSelectDropdown(),this.renderAttributeInputField(),this.renderIncludeOverviewSwitchButton(),this.renderApplyButton()))}renderAOISelectDropdown(){const{strings:e,selectedAOI:t}=this,i=[{name:r.A.Visible,label:e.visible,description:e.visibleDesc},{name:r.A.DisplayExtent,label:e.displayExtent,description:e.displayExtentDesc},{name:r.A.All,label:e.all,description:e.allDesc}],l=i.find((e=>e.name===t)),n=i.map((e=>(0,a.h)("calcite-dropdown-item",{"data-value":e.name,selected:e.name===l.name},(0,a.h)("strong",null,e.label),(0,a.h)("div",null,e.description))));return(0,a.h)("calcite-label",null,e.areaOfInterest,(0,a.h)("calcite-dropdown",{widthScale:"m",placement:"bottom",onCalciteDropdownSelect:e=>{var t,i;const a=e.currentTarget,l=null===(i=null===(t=null==a?void 0:a.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.getAttribute("data-value");this.selectedAOI=l}},(0,a.h)("calcite-button",{class:"aoi-select-button",slot:"trigger",alignment:"space-between","icon-end":"chevron-down",appearance:"transparent",kind:"neutral",width:"full"},l.label),(0,a.h)("calcite-dropdown-group",null,n)))}renderAttributeSelectDropdown(){const{strings:e,activeQueryField:t,layer:i}=this,l=(0,r.h)(null==i?void 0:i.fields),n=l.map((e=>(0,a.h)("calcite-option",{value:e.name,label:e.alias,selected:e.name===t.name})));return(0,a.h)("calcite-label",null,e.attribute,(0,a.h)("calcite-select",{label:e.attribute,onCalciteSelectChange:e=>{const t=e.currentTarget.selectedOption.value;this.activeQueryField=l.find((e=>e.name===t)),this.getLayerAttributeValues(t)}},n))}renderAttributeInputField(){const{activeQueryField:e}=this,t=e.type;return(0,r.k)(t)||"date"===t?this.renderAttributeSliderInput():this.renderAttributeDropdownInput()}renderSliderSelectedVals(){const{selectedQueryFieldValues:e,fieldMinMaxValuesForInput:t,activeQueryField:i}=this,l=e.length>0?e:t;let n,s;return 2===l.length?([n,s]=l,"date"===i.type&&(n=(0,r.l)(n),s=(0,r.l)(s)),(0,a.h)("div",null,`${n} - ${s}`)):1===l.length?([n]=l,"date"===i.type&&(n=(0,r.l)(n)),(0,a.h)("div",null,`${n}`)):null}renderAttributeSliderInput(){var e;const{strings:t,fieldMinMaxValuesForInput:i,isRangeValueModeSelected:l}=this,n=i.filter((e=>"number"==typeof e)),s=2===n.length&&n[0]!==n[1];if(2===n.length&&n[0]===n[1]){const[i]=n;return(0,a.h)("calcite-select",{label:t.select,onCalciteSelectChange:e=>{const t=e.currentTarget.selectedOption.value;this.selectedQueryFieldValues=[t]}},(0,a.h)("calcite-option",{value:i.toString(),label:i.toString(),selected:(null===(e=this.selectedQueryFieldValues)||void 0===e?void 0:e.length)>0&&i.toString()===this.selectedQueryFieldValues[0].toString()}))}if(s){const e=n[0],t=n[1];return(0,a.h)("div",null,this.renderRangeModeSwitchButton(),this.renderSliderSelectedVals(),l?(0,a.h)("calcite-slider",{minValue:e,maxValue:t,min:e,max:t,snap:!0,precise:!0,onCalciteSliderChange:e=>{const t=e.target;Array.isArray(t.value)?this.selectedQueryFieldValues=[t.value[0],t.value[1]]:this.selectedQueryFieldValues=[t.value]}}):(0,a.h)("calcite-slider",{value:n[1],min:n[0],max:n[1],snap:!0,precise:!0,onCalciteSliderChange:e=>{const t=e.target;Array.isArray(t.value)?this.selectedQueryFieldValues=[t.value[0],t.value[1]]:this.selectedQueryFieldValues=[t.value]}}))}}renderAttributeDropdownInput(){const{strings:e,fieldValuesForInput:t,isQueryingFieldValues:i}=this,l=t.map((e=>{var t;return(0,a.h)("calcite-option",{value:e.toString(),label:e.toString(),selected:(null===(t=this.selectedQueryFieldValues)||void 0===t?void 0:t.length)>0&&e.toString()===this.selectedQueryFieldValues[0].toString()})}));return(0,a.h)("calcite-select",{label:e.select,disabled:i,width:"full",onCalciteSelectChange:e=>{let t=e.currentTarget.selectedOption.value;this.selectedQueryFieldValues=[t]}},l)}renderRangeModeSwitchButton(){const{strings:e,isRangeValueModeSelected:t,fieldMinMaxValuesForInput:i}=this;return(0,a.h)("div",{class:"switch-button-wrapper"},(0,a.h)("calcite-label",{layout:"inline",scale:"m",style:{width:"100%"}},e.rangeMode,(0,a.h)("calcite-action",{icon:"information",scale:"s",text:e.rangeMode,ref:e=>this.rangeModeHelpIconActionEl=e,onMouseOver:()=>this.showTooltip({referenceElement:this.rangeModeHelpIconActionEl,innerHTML:e.rangeModelHelpMessage}),onMouseOut:()=>this.dismissTooltip(),onClick:e=>{e.stopPropagation()},id:"rangeMode"}),(0,a.h)("div",{style:{marginInlineStart:"auto"}},(0,a.h)("calcite-switch",{checked:t,scale:"m",onCalciteSwitchChange:e=>{const t=e.target.checked;this.isRangeValueModeSelected=t;const a=i.filter((e=>"number"==typeof e));this.selectedQueryFieldValues=t?[a[0],a[1]]:[a[0]]}}))))}renderIncludeOverviewSwitchButton(){const{strings:e,isOverviewsIncluded:t}=this;return(0,a.h)("div",{class:"include-overviews-switch-button-wrapper"},(0,a.h)("calcite-label",{layout:"inline",scale:"m",style:{width:"100%"}},e.includeOverviews,(0,a.h)("calcite-action",{icon:"information",scale:"s",text:e.includeOverviewsHelpMessage,ref:e=>this.isIncludeOverviewsHelpIconActionEl=e,onMouseOver:()=>this.showTooltip({referenceElement:this.isIncludeOverviewsHelpIconActionEl,innerHTML:e.includeOverviewsHelpMessage}),onMouseOut:()=>this.dismissTooltip(),onClick:e=>{e.stopPropagation()},id:"includeOverviews"}),(0,a.h)("div",{style:{marginInlineStart:"auto"}},(0,a.h)("calcite-switch",{checked:t,scale:"m",onCalciteSwitchChange:e=>{const t=e.target.checked;this.isOverviewsIncluded=t}}))))}renderApplyButton(){const{strings:e,isQueryingFieldValues:t,isQueryingImageItems:i}=this;return(0,a.h)("div",{class:"apply-button-wrapper"},(0,a.h)("calcite-button",{label:e.apply,onClick:this.handleImageItemQueryApplied,appearance:"solid",width:"half",disabled:t||i},e.apply))}renderSelectResults(){const{strings:e,isQueryingImageItems:t,totalImageItemCount:i,imageItems:l}=this;return(0,a.h)("calcite-block",{collapsible:!0,open:!0,heading:e.results},t?(0,a.h)("calcite-loader",{label:e.loading,scale:"m"}):(0,a.h)("div",null,!(i>0)&&(0,a.h)("div",null,e.emptyList),i>0?this.renderImageItemListButtonGroup():null,l?this.renderImageItemCardList():null))}renderSelectedImageItemCount(){const{strings:e,totalImageItemCount:t,selectedImageItemObjectIds:i}=this,l=i.length,n=e.selectedAndTotalImageItemCountInfo.replace("${totalCount}",t.toString()).replace("${selectedCount}",l.toString());return(0,a.h)("div",{class:"image-item-count-chip "+(l>0?"selected":"")},n,l>0&&(0,a.h)("calcite-button",{appearance:"solid",kind:"brand","icon-start":"x",scale:"s",onClick:()=>this.clearImageItemSelection()}))}renderImageItemListButtonGroup(){const{strings:e,selectedImageItemObjectIds:t}=this,i=t.length>0;return(0,a.h)("div",{class:"image-collection-item-card-list-header"},this.renderSelectedImageItemCount(),(0,a.h)("div",{style:{display:"flex"}},i&&(0,a.h)("div",null,(0,a.h)("calcite-button",{"aria-label":e.lockItems,appearance:"transparent","icon-start":"lock",kind:"neutral",scale:"s"}),(0,a.h)("calcite-button",{"aria-label":e.unlockItems,appearance:"transparent","icon-start":"unlock",kind:"neutral",scale:"s"})),(0,a.h)("calcite-button",{"aria-label":e.configureResults,appearance:"transparent","icon-start":"sliders-horizontal",kind:"neutral",scale:"s",onClick:this.handleOpenConfigResultsModal})))}renderImageItemCardList(){const{imageItems:e,selectedImageItemObjectIds:t,layer:i,isShowingThumbnails:l}=this;if(!(null==e?void 0:e.features))return null;const n=i.objectIdField,s=e.features.map((e=>{const i=e.attributes[n],s=this.selectedImageItemObjectIds.includes(i),r=e.geometry;return(0,a.h)("li",{onMouseOver:()=>this.handleImageItemCardMouseOver(r),onMouseOut:()=>this.handleImageItemCardMouseOut()},(0,a.h)("calcite-card",{class:"image-item-card",selectable:!0,selected:s,onCalciteCardSelect:()=>{const e=s?t.filter((e=>e!==i)):[...t,i];this.selectedImageItemObjectIds=e.sort()}},(0,a.h)("div",{class:"image-item-card-content-wrapper"},l?this.renderPreviewThumbnail(i):null,this.renderFeatureAttributesInImageItemCard(e)),(0,a.h)("div",{slot:"footer-start"}),(0,a.h)("div",{slot:"footer-end"},(0,a.h)("calcite-button",{kind:"neutral","icon-start":"add-layer",appearance:"transparent"}),(0,a.h)("calcite-button",{kind:"neutral","icon-start":"lock",appearance:"transparent"}))))}));return(0,a.h)("ul",{class:"image-item-card-list"},s)}renderImageItemSelectDropdown(){var e;const{strings:t,layer:i,imageItems:l,inspectImageItemObjectId:n,selectedImageItemObjectIds:s}=this,r=i.objectIdField,o=(s.length>0?null==l?void 0:l.features.filter((e=>s.includes(e.attributes[r]))).map((e=>e.attributes)):null!==(e=null==l?void 0:l.features.map((e=>e.attributes)))&&void 0!==e?e:[]).map((e=>(0,a.h)("calcite-option",{value:e[r].toString(),label:`${e[r]}: ${e.Name}`,selected:e[r]===n})));return(0,a.h)("div",{class:"image-item-select-block"},(0,a.h)("calcite-label",null,t.selectedImages,(0,a.h)("div",{class:"image-item-select-wrapper"},(0,a.h)("calcite-icon",{scale:"s",icon:"chevron-left",onClick:this.handleSelectPrevImageItem}),(0,a.h)("calcite-select",{width:"full",label:t.selectedImages,onCalciteSelectChange:e=>{const t=e.currentTarget.selectedOption.value;this.handleSelectedImageItemChange(Number(t))}},o),(0,a.h)("calcite-icon",{scale:"s",icon:"chevron-right",onClick:this.handleSelectNextImageItem}))))}renderImageItemPreviewView(){const{strings:e,layer:t,jsapiUrl:i,inspectImageItemObjectId:l}=this;return(0,a.h)("calcite-block",{collapsible:!0,open:!0,heading:e.preview},(0,a.h)("div",{class:"image-item-preview-wrapper"},(0,a.h)("arcgis-image-item-preview",{jsapiUrl:i,previewLayerUrl:t.url,previewImageItemObjectId:l})))}renderImageItemInfoTables(){const{imageItemInfo:e}=this,{extent:t,statistics:i}=e||{};return(0,a.h)("div",null,e?this.renderImageItemInspectButtonGroup():null,e?this.renderImageItemRasterInformationTable():null,e?this.renderImageItemRasterMetadataTable():null,t?this.renderImageItemExtentInfoTable():null,e?this.renderImageItemSpatialReferenceTable():null,i?this.renderImageItemStatisticsInfoTable():null)}renderImageItemRasterInformationTable(){const{strings:e,imageItemInfo:t}=this,i=[{accessor:"property",header:e.property},{accessor:"value",header:e.value}],{bandCount:l,height:n,width:s,pixelType:r,pixelSize:o,dataType:c,colormap:d}=t,u=[{property:e.columns,value:s},{property:e.rows,value:n},{property:e.bandNumber,value:l},{property:e.cellSizeX,value:null==o?void 0:o.x},{property:e.cellSizeY,value:null==o?void 0:o.y},{property:e.sourceType,value:c},{property:e.pixelType,value:r},{property:e.pixelDepth,value:l},{property:e.colormap,value:d}].filter((e=>!!e.value));return u.length>0&&(0,a.h)("calcite-block",{collapsible:!0,open:!0,heading:e.rasterInformation},(0,a.h)("div",{class:"image-item-info-table-wrapper"},(0,a.h)("arcgis-image-item-info-table",{columns:i,data:u})))}renderImageItemRasterMetadataTable(){const{strings:e,imageItemInfo:t}=this,i=[{accessor:"property",header:e.property},{accessor:"value",header:e.value}],{SensorName:l,ProductName:n,CloudCover:s,AcquisitionDate:r,SunAzimuth:o,SunElevation:c,ELLIPSOID:d}=t.keyProperties||{},u=r?`${new Date(r).toLocaleDateString()} ${new Date(r).toLocaleTimeString()}`:null,m=[{property:e.sensorName,value:l},{property:e.productName,value:n},{property:e.acquisitionDate,value:u},{property:e.cloudCover,value:s},{property:e.sunAzimuth,value:o},{property:e.sunElevation,value:c},{property:e.spheroid,value:d}].filter((e=>!!e.value));return m.length>0&&(0,a.h)("calcite-block",{collapsible:!0,open:!0,heading:e.rasterMetadata},(0,a.h)("div",{class:"image-item-info-table-wrapper"},(0,a.h)("arcgis-image-item-info-table",{columns:i,data:m})))}renderImageItemExtentInfoTable(){const{strings:e,imageItemInfo:t}=this,i=[{accessor:"property",header:e.property},{accessor:"value",header:e.value}],{extent:l}=t,{xmin:n,xmax:s,ymin:r,ymax:o}=l,c=[{property:e.top,value:o},{property:e.bottom,value:r},{property:e.left,value:n},{property:e.right,value:s}].filter((e=>!!e.value));return c.length>0&&(0,a.h)("calcite-block",{collapsible:!0,open:!0,heading:e.extent},(0,a.h)("arcgis-image-item-info-table",{columns:i,data:c}))}renderImageItemStatisticsInfoTable(){const{strings:e,imageItemInfo:t}=this,i=[{accessor:"bandName",header:e.bandName},{accessor:"min",header:e.min},{accessor:"max",header:e.max},{accessor:"avg",header:e.mean},{accessor:"stddev",header:e.std}],{bandInfos:l,statistics:n}=t,s=l.map(((e,t)=>{const i=n[t];return Object.assign({bandName:e.name},i)}));return s.length>0&&(0,a.h)("calcite-block",{collapsible:!0,open:!0,heading:e.statistics},(0,a.h)("div",{class:"image-item-info-table-wrapper"},(0,a.h)("arcgis-image-item-info-table",{columns:i,data:s})))}renderImageItemSpatialReferenceTable(){const{strings:e,imageItemInfo:t}=this,i=[{accessor:"property",header:e.property},{accessor:"value",header:e.value}],{keyProperties:l,spatialReference:n}=t,s=[{property:e.projectedCoordinateSystem,value:""},{property:e.projection,value:""},{property:e.wkid,value:null==n?void 0:n.wkid},{property:e.datum,value:null==l?void 0:l.DATUM},{property:e.spheroid,value:null==l?void 0:l.ELLIPSOID}].filter((e=>!!e.value));return s.length>0&&(0,a.h)("calcite-block",{collapsible:!0,open:!0,heading:e.spatialReference},(0,a.h)("div",{class:"image-item-info-table-wrapper"},(0,a.h)("arcgis-image-item-info-table",{columns:i,data:s})))}renderImageItemInspectButtonGroup(){const{strings:e}=this;return(0,a.h)("div",{class:"image-item-inspect-button-group"},(0,a.h)("calcite-button",{"aria-label":e.addLayer,appearance:"transparent","icon-start":"add-layer",kind:"neutral",scale:"s"}),(0,a.h)("calcite-button",{"aria-label":e.zoomToItem,appearance:"transparent","icon-start":"layer-zoom-to",kind:"neutral",scale:"s"}))}renderPreviewThumbnail(e){const{layer:t,modules:i}=this,{IdentityManager:l}=i,n=l.findCredential(t.url),{token:s}=n||{},r=`${t.url}/${e}/thumbnail${s?`?token=${s}`:""}`;return(0,a.h)("img",{slot:"thumbnail",src:r})}renderFeatureAttributesInImageItemCard(e){const{imageItemCardDisplayedFieldNames:t}=this,i=t.map((t=>(0,a.h)("li",null,(0,a.h)("strong",null,t),`: ${e.attributes[t]}`)));return(0,a.h)("ul",{class:"image-item-card-displayed-field-list"},i)}get hostElement(){return(0,a.d)(this)}};o.style=":host{display:flex;flex:1 1 auto;overflow:hidden}.switch-button-wrapper{padding:0.5rem 0}.apply-button-wrapper{display:flex;justify-content:center}.image-item-preview-wrapper{width:100%;height:300px}.image-item-card-list{width:100%;padding:0;overflow-y:auto;list-style:none}.image-item-card-content-wrapper{display:flex;gap:1rem}.image-item-card-content-wrapper>img{height:70px;width:70px}.image-collection-item-card-list-header{display:flex;justify-content:space-between;align-items:center}.image-item-count-chip{display:inline-block;padding:0.375rem;border-radius:9999px;background-color:var(--calcite-color-foreground-3)}.image-item-count-chip.selected{background-color:var(--calcite-color-brand);color:var(--calcite-color-text-inverse)}.image-item-card:hover{border:1px solid var(--calcite-color-status-info)}.image-item-inspect-button-group{text-align:start}.image-item-select-wrapper{display:flex;align-items:center;padding:0 2rem}.image-item-select-block{padding:10px;padding-bottom:0}.image-item-card-displayed-field-list{list-style-type:none;padding:0;margin:0;word-break:break-word}.aoi-select-button{border:1px solid var(--calcite-color-border-input)}.aoi-select-opt-wrapper{display:flex;flex-direction:column}.image-item-info-table-wrapper{display:block;overflow-x:auto}.dropdown-container{display:flex;justify-content:space-between;gap:1rem}"},36238:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>m,c:()=>l,d:()=>a,e:()=>n,f:()=>d,g:()=>h,i:()=>s,m:()=>r,t:()=>o,u:()=>u});const a=(e,t)=>{let i,a="idle";const l=(...l)=>new Promise((n=>{switch(a){case"flushed":a="idle",i?(clearTimeout(i),n(e(...l))):n(null);break;case"invoked":clearTimeout(i),a="idle",n(e(...l));break;case"cancelled":clearTimeout(i),a="idle",n(null);break;default:i&&clearTimeout(i),a="pending",i=setTimeout((()=>(a="idle",n(e(...l)))),t)}}));return l.flush=function(...e){return a="flushed",l(...e)},l.invoke=function(...e){return a="invoked",l(...e)},l.cancel=function(...e){return a="cancelled",l(...e)},l.getStatus=function(){return a},l},l=(e,t)=>{let i;return(...a)=>new Promise((l=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,l(e(...a))}),t))}))};function n(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function s(e){return null!=e}async function r(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:a}=t(e);return[i,a]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function u(e,t){const i=[],a={};return e.forEach((e=>{const l=t(e);null==a[l]&&(a[l]=e,i.push(e))})),i}function m(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let a=typeof e;return a in t?!t[a].hasOwnProperty(e)&&(t[a][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const h=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,a)=>e.slice(t*a,t+t*a)))},59224:(e,t,i)=>{i.d(t,{A:()=>l,N:()=>a,a:()=>m,b:()=>v,c:()=>h,d:()=>g,e:()=>b,f:()=>y,g:()=>f,h:()=>I,i:()=>r,j:()=>u,k:()=>o,l:()=>c,m:()=>p});var a,l,n=i(69283),s=i(36238);function r(e){return"AbortError"===(null==e?void 0:e.name)}function o(e){return["small-integer","big-integer","integer","single","double","oid"].includes(e)}function c(e){const t=new Date(e);return`${t.getFullYear()}-${d((t.getMonth()+1).toString(),2,"0")}-${d(t.getDate().toString(),2,"0")} ${d(t.getHours().toString(),2,"0")}:${d(t.getMinutes().toString(),2,"0")}:${d(t.getSeconds().toString(),2,"0")}`}function d(e,t,i){for(i=i||" ";e.length<t;)e=i+e;return e}function u(e){const t=e.find((e=>"best"===e.name.toLowerCase()));if(t)return t;const i=e.find((e=>"acquisitiondate"===e.name.toLowerCase()));if(i)return i;const a=e.find((e=>"date"===e.name.toLowerCase()));return a||e.find((e=>"double"===e.type||"integer"===e.type))}async function m(e,t){let i;try{i=await e.queryRasterCount(t)}catch(e){console.log(e)}return Number.isInteger(i)?i:null}async function h(e,t){t.outFields=["*"],t.returnGeometry=!0;const i=await e.queryRasters(t);return Array.isArray(null==i?void 0:i.features)?i:null}async function p(e,t){var i;const a=e.createQuery();let l;a.where=`${e.objectIdField} = ${t}`,a.returnGeometry=!0;try{l=await e.queryRasters(a)}catch(e){console.log(e)}return(null===(i=null==l?void 0:l.features)||void 0===i?void 0:i[0].geometry)||null}function g(e,t){const i=e.fields,a=e.objectIdField;let l=i.find((e=>"name"===e.name.toLowerCase()));return l||(l=i.find((e=>e.name===a))),l&&l.name!==t.name?[l,t]:[t]}function I(e){const t=["small-integer","big-integer","integer","single","double","date","oid","string"];return Array.isArray(e)?e.filter((e=>t.includes(e.type))):[]}function v(e,t,i,a,n,s){const r=e.createQuery();if((null==i?void 0:i.length)>0){let e="";if("date"===t.type){if(1===i.length){const a=new Date(i[0]),l=a.setSeconds(a.getSeconds()+1);e=e=`${t.name} BETWEEN timestamp '${c(i[0])}' AND timestamp '${c(l)}'`}2===i.length&&(e=`${t.name} BETWEEN timestamp '${c(i[0])}' AND timestamp '${c(i[1])}'`)}else 1===i.length&&(e="string"==typeof i[0]?`${t.name}='${i[0]}'`:`${t.name}=${i[0]}`),2===i.length&&(e="string"==typeof i[0]?`${t.name} BETWEEN '${i[0]}' AND '${i[1]}'`:`${t.name} BETWEEN ${i[0]} AND ${i[1]}`);r.where=e}const o="(Category <> 2)";if(n)r.where=r.where.replace(o,"");else{const e=o+(r.where?" AND "+r.where:"");r.where=e}return r.geometry=a===l.DisplayExtent?s:null,r.spatialRelationship=a===l.DisplayExtent?"intersects":null,r}async function y(e,t,i,a,n,r=!1){var o,c;if(!t)return[];const d=e.createQuery();d.where="1=1";const u=i===l.DisplayExtent||i===l.Visible;d.geometry=u?a:null,d.spatialRelationship=u?"intersects":null,d.outFields=[t],d.orderByFields=[`${t} ASC`],d.returnExceededLimitFeatures=!0,d.returnGeometry=!1;const m=[];if(r){let i=!0;for(;i;){const a=await e.queryRasters(d,{signal:n});if(i=null==a?void 0:a.exceededTransferLimit,(null===(o=a.features)||void 0===o?void 0:o.length)>0){const e=(0,s.b)(a.features.map((e=>e.attributes[t])));m.push(...e)}}return m}const h=await e.queryRasters(d,{signal:n});return(null===(c=null==h?void 0:h.features)||void 0===c?void 0:c.length)>0?(0,s.b)(h.features.map((e=>e.attributes[t]))):[]}async function b(e,t,i,a,n){var s;if(!t)return[];const r=e.createQuery();r.where="1=1";const o=i===l.DisplayExtent||i===l.Visible;r.geometry=o?a:null,r.spatialRelationship=o?"intersects":null,r.returnGeometry=!1,r.outStatistics=[{statisticType:"min",onStatisticField:t,outStatisticFieldName:"MIN_FIELD_VALUE"},{statisticType:"max",onStatisticField:t,outStatisticFieldName:"MAX_FIELD_VALUE"}];const c=await e.queryRasters(r,{signal:n});if((null===(s=null==c?void 0:c.features)||void 0===s?void 0:s.length)>0){const[e]=c.features;return[e.attributes.MIN_FIELD_VALUE,e.attributes.MAX_FIELD_VALUE]}return[]}async function f(e,t,i){var a;let l=[];const s=await async function(e,t){const[i,a,l]=await(0,n.l)(["esri/geometry/Polygon","esri/geometry/Point","esri/rest/support/ImageIdentifyParameters"]),{extent:s,width:r,height:o}=t,c=new i(s.spatialReference);c.addRing([[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]);const d=new a((s.xmax-s.xmin)/r,(s.ymax-s.ymin)/o,s.spatialReference),u=new l;u.geometry=c,u.returnGeometry=!1,u.pixelSize=d;const m=e.mosaicRule.clone();return e.definitionExpression&&(m.where=e.definitionExpression),u.mosaicRule=m,u}(e,t);if(e.visible){const t=await e.identify(s);if(!(null===(a=null==t?void 0:t.catalogItems)||void 0===a?void 0:a.features)||!(null==t?void 0:t.catalogItemVisibilities))return null;const n=e.objectIdField;for(let e=0;e<t.catalogItems.features.length;e++)t.catalogItemVisibilities[e]>0&&l.push(t.catalogItems.features[e].attributes[n]);if(0===l.length)return null;const r=`${e.objectIdField} in (${l.map((e=>`${e}`)).join(",")})`;i.where=`${i.where} AND ${r}`,i.outFields=["*"],i.returnGeometry=!0;const o=await e.queryRasters(i);return Array.isArray(null==o?void 0:o.features)?o:null}}!function(e){e.Inspect="inspect",e.Select="select"}(a||(a={})),function(e){e.Visible="visible",e.DisplayExtent="displayExtent",e.All="all"}(l||(l={}))}}]);