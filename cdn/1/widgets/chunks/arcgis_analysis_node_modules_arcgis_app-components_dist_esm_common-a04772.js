/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_common-a04772.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_common-a04772"],{49306:(e,t,n)=>{var i,r,a,s,l,o;n.d(t,{L:()=>o,a:()=>l,f:()=>r,i:()=>i,l:()=>a,s:()=>s}),function(e){e.sourceUrl="sourceUrl",e.title="title",e.caption="caption",e.linkUrl="linkUrl",e.altText="altText"}(i||(i={})),function(e){e.expression="expression/",e.relationship="relationships/",e.raster="Raster."}(r||(r={})),function(e){e.feature="feature",e.cluster="cluster",e.mapNotes="mapNotes"}(a||(a={})),function(e){e.feature="feature",e.mapImage="map-image",e.scene="scene",e.ogcFeature="ogc-feature",e.imagery="imagery",e.wfs="wfs",e.wms="wms",e.csv="csv",e.geojson="geojson",e.stream="stream",e.imageryTile="imagery-tile",e.tile="tile",e.subtype="subtype"}(s||(s={})),function(e){e.integer="integer",e.smallInteger="small-integer",e.bigInteger="big-integer",e.single="single",e.double="double",e.long="long",e.string="string",e.date="date",e.dateOnly="date-only",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e.oid="oid",e.guid="guid",e.globalId="global-id",e.number="number"}(l||(l={})),function(e){e.default="default",e.display="display",e.type="type",e.field="field"}(o||(o={}))},10519:(e,t,n)=>{n.d(t,{a:()=>p,b:()=>a,c:()=>c,d:()=>l,e:()=>s,f:()=>b,g:()=>m,h:()=>y,i:()=>h,j:()=>f,k:()=>g,l:()=>x,m:()=>o,n:()=>v,o:()=>F,p:()=>d,q:()=>w});var i=n(49306),r=n(69283);function a(e,t){if(-1!==e.fieldName.indexOf(i.f.expression)){const n=t.get(e.fieldName);return(null==n?void 0:n.title)?n.title:e.fieldName}return e.label?e.label:e.fieldName}function s(e){const t=new Map;return(null==e?void 0:e.expressionInfos)&&e.expressionInfos.forEach((e=>{const n=`${i.f.expression}${e.name}`;t.set(n,e)})),t}async function l(e){return new Map((await f(e)).filter((e=>e.visible)).map((e=>[e.name,e])))}async function o(e,t){var n,r,a,s,l,o,d,f,y;try{const p=c(e);if(p===i.s.mapImage&&e.layer.version>=10.5&&!(null===(r=null===(n=e.layer.capabilities)||void 0===n?void 0:n.operations)||void 0===r?void 0:r.supportsQuery)&&(null===(s=null===(a=e.layer.capabilities)||void 0===a?void 0:a.operations)||void 0===s?void 0:s.supportsIdentify))return{features:[await b(e,t)||await u(e)]};if(p===i.s.scene&&!(null===(o=null===(l=e.capabilities)||void 0===l?void 0:l.operations)||void 0===o?void 0:o.supportsQuery))return{features:[await u(e)]};const m=p===i.s.ogcFeature||p===i.s.stream?await t.whenLayerView(e):e,v=m.createQuery();v.where=m.definitionExpression||"1=1",v.outFields=["*"],v.returnM="hasM"in e&&e.hasM,v.returnZ="hasZ"in e&&e.hasZ,((null===(f=null===(d=m.sourceJSON)||void 0===d?void 0:d.advancedQueryCapabilities)||void 0===f?void 0:f.supportsPagination)||p===i.s.ogcFeature)&&(v.start=0,v.num=1),v.outSpatialReference=t.spatialReference;const g=await m.queryFeatures(v);return 0===(null===(y=null==g?void 0:g.features)||void 0===y?void 0:y.length)&&(g.features[0]=await u(e)),g}catch(e){console.error(e)}}async function u(e){return new Promise(((t,n)=>{(0,r.l)(["esri/Graphic","esri/geometry/Geometry"]).then((([n,i])=>{var r;const a=new n;if(null===(r=e.fields)||void 0===r?void 0:r.length){const t={};e.fields.forEach((e=>{t[e.name]=e.defaultValue})),a.attributes=t}if(e.geometryType){const t=new i;t.type=e.geometryType,a.geometry=t}t(a)}),(e=>{n(e)}))}))}function c(e){var t,n,r;return"map-image"===(null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.type)?i.s.mapImage:"subtype-sublayer"===(null==e?void 0:e.type)?i.s.subtype:"tile"===(null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.type)?i.s.tile:"scene"===(null==e?void 0:e.type)?i.s.scene:"ogc-feature"===(null==e?void 0:e.type)?i.s.ogcFeature:"imagery"===(null==e?void 0:e.type)?i.s.imagery:"imagery-tile"===(null==e?void 0:e.type)?i.s.imageryTile:"wfs"===(null==e?void 0:e.type)?i.s.wfs:"wms"===(null===(r=null==e?void 0:e.layer)||void 0===r?void 0:r.type)?i.s.wms:"csv"===(null==e?void 0:e.type)?i.s.csv:"geojson"===(null==e?void 0:e.type)?i.s.geojson:"stream"===(null==e?void 0:e.type)?i.s.stream:i.s.feature}function d(e){const t=c(e);let n;return t===i.s.wms||t===i.s.mapImage?n=null==e?void 0:e.layer.version:t!==i.s.imagery&&t!==i.s.feature&&t!==i.s.scene||(n=e.version),Number.parseFloat(n)}async function f(e){return new Promise((async(t,n)=>{var r,a,s,l;switch(c(e)){case i.s.feature:case i.s.ogcFeature:case i.s.stream:t(e.fields);break;case i.s.mapImage:if((null===(r=null==e?void 0:e.layer)||void 0===r?void 0:r.portalItem)&&(null===(a=e.layer)||void 0===a?void 0:a.url.indexOf("https://demographics"))>-1&&(null===(s=e.layer)||void 0===s?void 0:s.url.indexOf(".arcgis.com"))>-1)try{const n=await(null===(l=e.layer.portalItem)||void 0===l?void 0:l.fetchData());if(null==n?void 0:n.thematicGroup){const i=new Map(e.fields.map((e=>[e.name,e]))),r=n.thematicGroup.fieldNames,a=[];r.forEach((e=>{i.has(e)&&a.push(i.get(e))})),t(a)}else t(e.fields)}catch(e){n(e)}else t(e.fields);break;case i.s.imagery:const o=e;t((o.fields||[]).concat(o.rasterFields||[]));break;case i.s.imageryTile:t(e.rasterFields);break;default:t("fields"in e&&e.fields)}}))}async function y(e){return new Promise((async t=>{var n,r,a,s,l;if(c(e)===i.s.stream)t("point");else if(e.geometryType)t(e.geometryType);else if(c(e)===i.s.mapImage&&(null===(r=null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.sourceJSON)||void 0===r?void 0:r.layers)){const n=null===(s=null===(a=e.layer.sourceJSON.layers.find((t=>{if(t.id===e.id)return t})))||void 0===a?void 0:a.geometryType)||void 0===s?void 0:s.toLowerCase();if(n)n.indexOf("point")>-1?t("point"):n.indexOf("line")>-1?t("polyline"):n.indexOf("polygon")>-1?t("polygon"):t(n);else{const n=null===(l=null==e?void 0:e.layer)||void 0===l?void 0:l.findSublayerById(e.id);n?await(null==n?void 0:n.createFeatureLayer().then((async e=>{const n=await(null==e?void 0:e.load());t(null==n?void 0:n.geometryType)}))):t(null)}}else t(null)}))}function p(e,t,n){let i="";if(/^raster.(item|service)pixelvalue/i.test(e))i="number";else if(t.has(e)){const n=t.get(e);i=n.type?n.type.toLowerCase():""}else if(n.has(e)){const t=n.get(e);i=t.returnType?t.returnType.toLowerCase():""}else i="number";return i}async function m(e,t){return"feature"!==e.type||e.url?"feature"===e.type||"csv"===e.type||"scene"===e.type||"wfs"===e.type||"geojson"===e.type?await e.queryFeatureCount():!t||"stream"!==e.type&&"ogc-feature"!==e.type?void 0:async function(e,t){return(await t.whenLayerView(e)).queryFeatureCount()}(e,t):async function(e){var t;const n=e.createQuery();n.outFields=["*"];const i=await e.queryFeatures(n);if(null===(t=i.features)||void 0===t?void 0:t.length)return i.features.length;throw new Error("could not get feature count")}(e)}async function v(e){if(!e.url)throw new Error("could not get layer.url");const[t]=await(0,r.l)(["esri/rest/query/executeForCount"]),n=await t.executeForCount(e.url,{});if(n)return n;throw new Error("could not get raster count")}const g=(e,t)=>{let n=[];return null==e||e.fieldInfos.forEach((e=>{e.fieldName.includes(i.f.expression)?t&&n.push({name:e.fieldName.slice(i.f.expression.length),alias:e.fieldName.slice(i.f.expression.length),type:"string"}):n.push({name:e.fieldName,alias:e.label,type:"string"})})),n};function w(e,t){let n=0===t.indexOf("#"),i=0===t.indexOf(".");for((i||n)&&(t=t.slice(1));e;){if(n){if(e.id===t)return e}else if(i){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement}return null}function h(e){return null!=e}const b=async(e,t)=>{var n,i;const[a,s]=await(0,r.l)(["esri/rest/identify","esri/rest/support/IdentifyParameters"]),l=new s;l.geometry=t.extent,l.mapExtent=t.extent,l.returnGeometry=!0,l.tolerance=6,l.layerOption="popup",l.width=t.width,l.height=t.height,l.layerIds=[e.id];const o=null===(n=await a.identify(e.layer.url,l))||void 0===n?void 0:n.results;return null===(i=null==o?void 0:o[0])||void 0===i?void 0:i.feature},x=async(e,t,n)=>{var i;const r=await e.whenLayerView(t),a=await r.queryAggregates();return await I(n,null===(i=a.features)||void 0===i?void 0:i[0])},I=async(e,t)=>{const[n,i]=await(0,r.l)(["esri/Graphic","esri/geometry/Point"]);let a;if(t)a=t.clone();else{a=new n;const t=g(e,!1);if(null==t?void 0:t.length){const e={};t.forEach((t=>{e[t.name]=""})),a.attributes=e}const r=new i;a.geometry=r}return a};function F(e){var t;if(!e)return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return null===(t=e.extent)||void 0===t?void 0:t.center;default:return null}}}}]);