/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d5954a.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d5954a"],{30473:(e,t,l)=>{l.r(t),l.d(t,{arcgis_smart_mapping_panels_chart:()=>c});var i=l(81149),a=l(9225),r=l(5996),o=(l(69283),l(49306),l(89)),s=l(86478),n=l(36238),d=l(51837);l(82218),l(42577),l(70464),l(10519),l(7659);const c=class{constructor(e){(0,i.r)(this,e),this.arcgisSmartMappingPanelsChartBackClick=(0,i.c)(this,"arcgisSmartMappingPanelsChartBackClick",7),this.arcgisSmartMappingPanelsChartClose=(0,i.c)(this,"arcgisSmartMappingPanelsChartClose",7),this.arcgisSmartMappingPanelsChartError=(0,i.c)(this,"arcgisSmartMappingPanelsChartError",7),this.inputNodes={},this.labelNodes={},this.popoverSettings={index:null,popoverNode:null},this.valueSymbolNodes={},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentDidLoad(){const{config:e}=a.s;this.hostElement.shadowRoot.firstElementChild.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${e.jsapiUrl}/themes/light/main.css" />`),requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}componentWillLoad(){var e,t,l;const{layer:i,modules:r,strings:o}=a.s,s=(0,a.h)(i);this.originalRendererJSON=s.toJSON(),this.originalFeatureReduction="featureReduction"in i&&i.featureReduction?r.esriLang.clone(i.featureReduction):void 0,s.defaultLabel||(s.defaultLabel=o.panels.chart.noData),a.s.lastDefault={otherColor:null===(e=s.othersCategory)||void 0===e?void 0:e.color,otherLabel:(null===(t=s.othersCategory)||void 0===t?void 0:t.label)||o.panels.chart.other,threshold:null===(l=s.othersCategory)||void 0===l?void 0:l.threshold,defaultColor:s.defaultColor,defaultLabel:s.defaultLabel}}disconnectedCallback(){var e;null===(e=this.sizeSliderWatchHandle)||void 0===e||e.remove(),a.s.lastDefault=void 0,a.s.selectedAttribute=void 0,(0,a.ae)()}render(){var e;const{hideLayerTitle:t,isRTL:l,layer:r,mapImageSublayer:o,strings:s}=a.s,n=t?void 0:null!==(e=null==o?void 0:o.title)&&void 0!==e?e:r.title;return(0,i.h)(i.H,{class:"calcite-match-height"},(0,i.h)("calcite-flow-item",{class:{"flow-item":!0,[d.C.rtl]:l},closable:(0,a.aa)(this.hostElement),heading:s.panels.styleOptions,description:n,menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsChartBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=a.s,t="chart-size"===(0,a.g)();return(0,i.h)("calcite-block",{class:"chart-block",heading:t?e.panels.chart.chartStyleColor:e.panels.chart.chartStyle,open:!0,collapsible:!1},this.renderChartSymbol(),this.renderValues(),this.renderChartSize(),this.renderShape(),this.renderMinSlice(),this.renderBackgroundStyle())}renderChartSymbol(){const{layer:e,mapView:t,modules:l}=a.s,r=(0,a.h)(e).attributes,o=l.pieChartSchemes.getSchemes({basemap:t.map.basemap,geometryType:(0,a.D)(e),numColors:r.length}),s=(0,a.a9)(o,Math.min(r.length,10))[0].colors;let n=(null==r?void 0:r.length)?r.slice(0,10).map(((e,t)=>e.color?new l.esriColor(e.color):new l.esriColor(s[t%s.length]))):[];return(0,i.h)("arcgis-smart-mapping-symbol-button",{type:"chart-ramp",colors:n,rampType:"discrete",onArcgisSmartMappingSymbolButtonSymbolChange:()=>(0,i.f)(this.hostElement)})}renderValues(){const{layer:e,strings:t}=a.s,l=(0,a.h)(e);return(0,i.h)("calcite-label",{class:"top-padding"},t.panels.chart.fieldName,(0,i.h)("calcite-list",{class:"top-grey-border"},(0,i.h)("calcite-list",{"drag-enabled":!0,onCalciteListOrderChange:e=>{let t=Array.from(e.target.children);this.handleSortLegend(t)}},l.attributes.map(((e,t)=>this.renderValue(e,t)))),this.renderOtherValue(),this.renderNullValue()))}renderValue(e,t){return(0,i.h)("calcite-list-item",{key:e.field,value:e.field},this.renderSymbolNode(e,t),this.renderTextNode(e,t))}renderSymbolNode(e,t){const{layer:l,mapView:r,modules:o,selectedAttribute:s,strings:n}=a.s,d=(0,a.S)(l,r);d.color=new o.esriColor(e.color),d.outline=void 0;const c={"value-symbol":!0,"symbol-is-white":(0,a.aq)(d)},h={"symbol-icon":!0,selected:s===t};return(0,i.h)("div",{class:c,slot:"content-start",role:"button","aria-label":n.panels.chart.accessibility.editSymbolFor.replace("${value}",e.label),"aria-haspopup":"true","aria-expanded":s===t,onClick:()=>this.handleValueSymbolClick(t),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleValueSymbolClick(t)}},(0,i.h)("div",{class:h,tabIndex:0,"aria-hidden":"true",ref:e=>{var l,i,r,o;e&&(this.valueSymbolNodes[t]=e,(0,a.aE)(d)?(e.style.backgroundColor=null,e.style.opacity=null):(e.style.backgroundColor=null!==(i=null===(l=d.color)||void 0===l?void 0:l.toHex())&&void 0!==i?i:"#ffffff",e.style.opacity=null!==(o=null===(r=d.color)||void 0===r?void 0:r.a)&&void 0!==o?o:0))}}))}renderOtherValue(){var e,t;const{lastDefault:l,layer:r,mapView:o,modules:s,selectedAttribute:n,strings:d}=a.s,c=(0,a.h)(r),h=(null===(e=c.othersCategory)||void 0===e?void 0:e.color)||l.otherColor,u=(0,a.S)(r,o);u.color=new s.esriColor(h),u.outline=void 0;const p=(null===(t=c.othersCategory)||void 0===t?void 0:t.label)||l.otherLabel,m={"other-symbol":!0,"symbol-is-white":(0,a.aq)(u)},b={"symbol-icon":!0,selected:-1===n};return(0,i.h)("calcite-list-item",{class:"top-grey-border other-null-list-item"},(0,i.h)("div",{class:m,slot:"content-start",role:"button",tabIndex:0,"aria-haspopup":"true","aria-expanded":-1===n,"aria-label":d.panels.chart.accessibility.editSymbolFor.replace("${fieldName}",p),onClick:()=>this.handleValueSymbolClick(-1),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleValueSymbolClick(-1)}},(0,i.h)("div",{class:b,tabIndex:0,"aria-hidden":"true",ref:e=>{var t,l,i,r;e&&(this.valueSymbolNodes[-1]=e,(0,a.aE)(u)?(e.style.backgroundColor=null,e.style.opacity=null):(e.style.backgroundColor=null!==(l=null===(t=u.color)||void 0===t?void 0:t.toHex())&&void 0!==l?l:"#ffffff",e.style.opacity=null!==(r=null===(i=u.color)||void 0===i?void 0:i.a)&&void 0!==r?r:0))}})),this.renderTextNode({symbol:u,label:p},-1))}renderTextNode(e,t){const{strings:l}=a.s;return(0,i.h)(i.F,null,(0,i.h)("div",{"aria-label":l.panels.chart.accessibility.editLabelFor.replace("${fieldName}",e.label),class:"label text-wrap",slot:"content",tabIndex:0,onClick:e=>{(0,a.E)(),e.target.classList.add("hidden"),this.inputNodes[t].classList.remove("hidden"),this.inputNodes[t].setFocus()},onKeyDown:e=>{(0,a.E)()," "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),e.target.classList.add("hidden"),this.inputNodes[t].classList.remove("hidden"),this.inputNodes[t].setFocus())},ref:e=>{this.labelNodes[t]=e}},e.label),(0,i.h)("calcite-input",{class:"hidden",slot:"content",tabIndex:0,value:e.label,onFocusout:e=>{const l=e.target;this.handleValueTextChange(t,l.value)},onKeyDown:e=>{if(e.stopPropagation(),"Escape"===e.key||"Enter"===e.key){e.preventDefault();const l=e.currentTarget;this.handleValueTextChange(t,l.value)}},ref:e=>{this.inputNodes[t]=e}}))}renderNullValue(){const{lastDefault:e,layer:t,mapView:l,modules:r,selectedAttribute:o,strings:s}=a.s,n=(0,a.h)(t),d=n.defaultColor||e.defaultColor,c=(0,a.S)(t,l);c.color=new r.esriColor(d),c.outline=void 0;const h=n.defaultLabel||e.defaultLabel,u=(0,a.aE)(c),p={symbol:!0,"symbol-is-white":(0,a.aq)(c)},m={"symbol-icon":!0,selected:-2===o};return(0,i.h)("calcite-list-item",{class:"other-null-list-item"},(0,i.h)("calcite-checkbox",{disabled:u,slot:"actions-start",class:"checkbox",tabIndex:0,checked:!!n.defaultColor&&!u,onClick:()=>this.handleNullValueCheckChange()}),(0,i.h)("div",{class:p,slot:"content-start",role:"button",tabIndex:0,"aria-haspopup":"true","aria-expanded":-2===o,"aria-label":s.panels.chart.accessibility.editSymbolFor.replace("${fieldName}",h),onClick:()=>this.handleValueSymbolClick(-2),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleValueSymbolClick(2)}},(0,i.h)("div",{class:m,tabIndex:0,"aria-hidden":"true",ref:e=>{var t,l,i,a;e&&(this.valueSymbolNodes[-2]=e,u?(e.style.backgroundColor=null,e.style.opacity=null):(e.style.backgroundColor=null!==(l=null===(t=c.color)||void 0===t?void 0:t.toHex())&&void 0!==l?l:"#ffffff",e.style.opacity=null!==(a=null===(i=c.color)||void 0===i?void 0:i.a)&&void 0!==a?a:0))}})),this.renderTextNode({symbol:c,label:h},-2))}renderChartSize(){const{layer:e,mapView:t,strings:l}=a.s,r=(0,a.h)(e);if((0,a.a)(r,"size"))return null;const o=(0,a.a)(r,"size","auto"),s=this.getSizeValue(),d=Math.round(s/.75);return(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,l.panels.chart.chartSize),(0,i.h)("arcgis-smart-mapping-slider-input",{min:10,max:120,values:[d],precision:0,suffixText:l.panels.chart.px,onArcgisSmartMappingSliderInputChange:e=>this.handleChartSizeChange(e.detail)}),(0,i.h)("calcite-label",{scale:"s",layout:"inline"},(0,i.h)("calcite-checkbox",{scale:"s",checked:!!o,onCalciteCheckboxChange:e=>{this.handleAutoSizeChange(e.target.checked?"automatic":"fixed")},ref:e=>{this.adjustSizeNode=e,this.sizeSliderWatchHandle=t.watch("scale",(0,n.d)((()=>(0,i.f)(this.hostElement)),100))}}),l.panels.chart.adjustChartSizeAutomatically))}renderShape(){var e,t;const{layer:l,modules:r,strings:o}=a.s,s=(0,a.h)(l);if(this.shapeSlider){let e={values:[null!==(t=s.holePercentage)&&void 0!==t?t:.5]};this.shapeSlider.set(e)}else{const t={min:0,max:Math.max(.9,s.holePercentage),values:[null!==(e=s.holePercentage)&&void 0!==e?e:.5],precision:1};this.shapeSlider=new r.Slider(t),this.shapeSlider.on("thumb-drag",(e=>{(0,a.h)(l).holePercentage=e.value,(0,a.ab)()})),this.shapeSlider.on("thumb-change",(e=>{(0,a.h)(l).holePercentage=e.value,(0,a.ab)()}))}return(0,i.h)("div",{class:"top-padding"},(0,i.h)("calcite-label",null,o.panels.chart.shape),(0,i.h)("div",{class:"shape-slider slider-bottom-label",ref:e=>{e.style.width="100%",this.shapeSlider&&(this.shapeSlider.container=e)}}),(0,i.h)("div",{class:"slider-labels space-between","aria-hidden":"true"},(0,i.h)("calcite-label",null,o.panels.chart.pie),(0,i.h)("calcite-label",null,o.panels.chart.donut)))}renderMinSlice(){const{isRTL:e,layer:t,strings:l}=a.s,r=(0,a.h)(t),{threshold:o=.04}=r.othersCategory;let s=l.panels.chart.percentValue.endsWith("%");return e&&(s=!s),(0,i.h)("div",{class:"top-padding"},(0,i.h)("div",{class:"space-between"},(0,i.h)("calcite-label",{layout:"inline"},l.panels.chart.grouping),(0,i.h)("calcite-icon",{scale:"s",icon:"information",role:"button",ref:e=>{var t;(0,a.af)(e,`<div>${l.panels.chart.groupingInfo.replace("${other}",(null===(t=r.othersCategory)||void 0===t?void 0:t.label)||l.panels.chart.other)}</div>`,!1)}})),(0,i.h)("arcgis-smart-mapping-slider-input",{disabled:!r.othersCategory,min:0,max:50,values:[Math.round(100*o)],precision:0,prefixText:s?void 0:"%",suffixText:s?"%":void 0,onArcgisSmartMappingSliderInputChange:e=>{(0,a.h)(t).othersCategory.threshold=e.detail/100,(0,a.ab)()}}))}renderBackgroundStyle(){return(0,i.h)("arcgis-smart-mapping-background-symbol",null)}renderDoneButton(){const{strings:e}=a.s;return(0,i.h)("calcite-button",{slot:"footer",label:e.done,onClick:()=>this.arcgisSmartMappingPanelsChartClose.emit("save"),appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=a.s;return(0,i.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:()=>{const{originalRendererJSON:e,originalFeatureReduction:t}=this;(0,a.E)(),(0,a.j)(e,t),this.arcgisSmartMappingPanelsChartClose.emit("cancel")},appearance:"outline-fill",width:"half"},e.cancel)}getSizeByScale(e,t){const l=e.stops,i=l.length-1,a=l[0].value,r=l[i].value;if(t<=a)return l[0].size;if(t>=r)return l[i].size;for(let e=0;e<=i;e++){const i=l[e],a=l[e+1];if(t>=i.value&&t<a.value){const e=a.value-i.value,l=i.size-a.size,r=(t-i.value)/e,o=i.size-l*r;return Math.round(100*o)/100}}return 1}getSizeValue(){const{mapView:e,layer:t}=a.s,l=(0,a.h)(t),i=(0,a.a)(l,"size","auto");if(i){const t=e.scale,l=i.stops;let a=0,r=!1;for(let e=0;e<l.length;e++){const i=l[e];if(t<=i.value){if(r=!0,e>0){let r=l[e-1];const o=(t-r.value)/(i.value-r.value);a=r.size+(i.size-r.size)*o}else a=l[0].size;break}}return r||(a=l[l.length-1].size),a}return l.size}handleAutoSizeChange(e){const{layer:t}=a.s,l=(0,a.h)(t);if("fixed"===e){const e=(0,a.n)(l,"size","auto");(null==e?void 0:e.length)?l.visualVariables=e:l.visualVariables=void 0,(0,a.ab)()}else(0,r.r)((0,s.a)({sizeOptimizationEnabled:!0}),this.flowItemNode).then((e=>{(0,a.e)(e.renderer,t),(0,a.ab)()}),(e=>{this.adjustSizeNode.checked=!1,this.arcgisSmartMappingPanelsChartError.emit(e)}))}handleChartSizeChange(e){const{layer:t,mapView:l}=a.s,i=(0,a.h)(t);let r=Math.max(e,.1);const o=(0,a.a)(i,"size","auto");if(o){const e=r/this.getSizeByScale(o,l.scale);this.updateAutoSizeStops(o,e)}else i.size=r;(0,a.ab)()}handleNullValueCheckChange(){const{layer:e,lastDefault:t}=a.s,l=(0,a.h)(e);l.defaultColor?(t.defaultColor=l.defaultColor,l.defaultColor=void 0):l.defaultColor=t.defaultColor,(0,a.ab)(),(0,i.f)(this.hostElement)}handleSortLegend(e){const{layer:t}=a.s,l=(0,a.h)(t),r=l.attributes.map((e=>e.clone())),o=e.map((e=>e.value));r.sort(((e,t)=>o.indexOf(e.field)-o.indexOf(t.field))),l.attributes=r,(0,a.ab)(),(0,i.f)(this.hostElement)}handleValueSymbolClick(e){var t;(null===(t=this.popoverSettings)||void 0===t?void 0:t.popoverNode)?(this.valueSymbolNodes[e].classList.remove("selected"),this.popoverSettings.index===e?((0,a.E)(),this.popoverSettings.popoverNode=null,this.popoverSettings.index=null,this.valueSymbolNodes[e].focus()):(this.popoverSettings.index=e,this.openSymbolStylerForValue(e))):(this.popoverSettings.index=e,this.openSymbolStylerForValue(e))}handleValueTextChange(e,t){var l,r;const{lastDefault:o,layer:s,modules:n,strings:d}=a.s,c=(0,a.h)(s),h=n.rendererJsonUtils.fromJSON(this.originalRendererJSON);if(this.inputNodes[e].classList.add("hidden"),!t.length)if(-1===e)t=(null===(l=h.othersCategory)||void 0===l?void 0:l.label)||d.panels.chart.other;else if(-2===e)t=d.panels.chart.noData;else{let l=h.attributes.find((t=>t.field===c.attributes[e].field));t=l.label}-1===e?(c.othersCategory=c.othersCategory||{color:null==o?void 0:o.otherColor,threshold:null!==(r=null==o?void 0:o.threshold)&&void 0!==r?r:0},c.othersCategory.label=t,o.otherLabel=t):-2===e?(c.defaultLabel=t,o.defaultLabel=t):c.attributes=c.attributes.map(((l,i)=>(i===e&&(l.label=t),l))),(0,a.ab)(),(0,i.f)(this.hostElement),this.labelNodes[e].classList.remove("hidden"),this.labelNodes[e].innerHTML=t,this.inputNodes[e].value=t,setTimeout((()=>{this.labelNodes[e].focus()}),100)}openSymbolStylerForValue(e){(0,a.E)(),this.popoverSettings.popoverNode=(0,o.c)({referenceElement:this.flowItemNode,heading:a.s.strings.styler.symbolStyle}),this.popoverSettings.popoverNode.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,o.r)(this.popoverSettings.popoverNode),this.popoverSettings.popoverNode=null,this.valueSymbolNodes[e].classList.remove("selected"),setTimeout((()=>{this.valueSymbolNodes[e].focus()}),100)})),this.popoverSettings.popoverNode.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,o.r)(this.popoverSettings.popoverNode),this.popoverSettings.popoverNode=null,this.valueSymbolNodes[e].classList.remove("selected")})),a.s.selectedAttribute=e,(0,o.a)({popoverNode:this.popoverSettings.popoverNode,onChange:()=>{(0,a.ab)(),(0,i.f)(this.hostElement)}}),this.valueSymbolNodes[e].classList.add("selected")}updateAutoSizeStops(e,t){e.stops.forEach((e=>{e.size*=t}))}get hostElement(){return(0,i.d)(this)}};c.style=":host{width:100%}.flow-item{height:100%}.chart-block{overflow-x:hidden}.checkbox{margin:6px}.hidden{display:none}.top-grey-border{border-top:1.5px solid #e0e0e0}.top-padding{margin-top:12px}.label{font-size:var(--calcite-font-size--1);padding-top:5px;padding-bottom:5px}.label:focus,.symbol-icon:focus{outline:2px solid var(--calcite-color-brand)}.selected{outline:1px solid var(--calcite-color-brand)}.other-null-list-item{min-height:45px}.other-symbol{margin-left:27px}.null-value-actions{display:contents}.shape-slider{background-color:transparent;position:relative;width:100%;padding:0 4px}.slider-labels{margin-top:10px}.space-between{display:flex;justify-content:space-between}.symbol-icon{width:19px;height:19px;margin:2px}.symbol-is-white{background-color:#f3f3f3}.text-wrap{overflow-wrap:anywhere}"},86478:(e,t,l)=>{l.d(t,{a:()=>o,c:()=>r});var i=l(9225),a=(l(69283),l(10519));function r(e){var t;const{layer:l,mapView:r,selectedFields:o,modules:n}=i.s,d=l;e=e||{};const c=(0,i.m)((0,i.h)(d)),h=!!(0,a.i)(e.includeSizeVariable)&&e.includeSizeVariable;return n.PieChartCreator.createRenderer({layer:d,view:r,attributes:s(e.fieldInfos),pieChartScheme:e.pieChartScheme||(0,i.Z)(),includeSizeVariable:h,outlineOptimizationEnabled:(0,a.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!(!(0,i.q)(d)||!h),sizeOptimizationEnabled:!(0,a.i)(e.sizeOptimizationEnabled)||e.sizeOptimizationEnabled,legendOptions:e.legendOptions,forBinning:"binning"===(null===(t=d.featureReduction)||void 0===t?void 0:t.type)}).then((e=>{(0,i.l)(c,e.renderer,{notOpacity:!0});const t=(0,i.g)();if(["chart","chart-size"].indexOf(t)>-1){const t=(0,i.f)(d),l=o.map((e=>e.field)),a=t.map((e=>e.field)),r=l.toString()===a.toString(),s=n.esriLang.clone(l),c=n.esriLang.clone(a);s.sort(),c.sort(),s.toString()===c.toString()&&(e.renderer.attributes=(0,i.h)(d).attributes,r||e.renderer.attributes.sort(((e,t)=>l.indexOf(e.field)-l.indexOf(t.field))),e.renderer.othersCategory=(0,i.h)(d).othersCategory,e.renderer.holePercentage=(0,i.h)(d).holePercentage)}return Promise.resolve(e)}),(e=>Promise.reject(e)))}function o(e){var t,l;const{layer:r,mapView:o,modules:n}=i.s,d=r;e=e||{};const c=(0,i.h)(d),h=(0,i.a)(c,"size"),u=(0,i.p)(c,"size"),p=(0,i.m)(c);let m,b=e.fieldInfos?e.fieldInfos:c.attributes.map((e=>({field:e.field,simpleFieldType:i.w.NUMBER}))),g=!0;if(e.fieldInfos&&(c.attributes.forEach(((t,l)=>{t.field!==e.fieldInfos[l].field&&(g=!1)})),g&&(delete e.fieldInfos,(0,i.R)(e)))){const e=c.clone();return Promise.resolve({renderer:e})}g&&(m=c.attributes.map((e=>e.field)));const f=(0,i.h)(d),v=(null===(t=f.attributes)||void 0===t?void 0:t.length)?f.attributes[0].color:null,y=c.backgroundFillSymbol;let S=!1;h&&(S=h.minSize.stops?h.minSize.stops[0].size>h.maxSize.stops[0].size:h.minSize>h.maxSize);const C=b[0];return b[0]=b[1],b[1]=C,n.PieChartCreator.createRenderer({layer:d,view:o,attributes:s(b),pieChartScheme:e.pieChartScheme||(0,i.Z)(),includeSizeVariable:(0,a.i)(e.includeSizeVariable)?e.includeSizeVariable:!!h,outlineOptimizationEnabled:(0,a.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!!p.sizeOutlineVisVar,sizeOptimizationEnabled:(0,a.i)(e.sizeOptimizationEnabled)?e.sizeOptimizationEnabled:!!p.sizeAutoVisVar,legendOptions:void 0,forBinning:"binning"===(null===(l=d.featureReduction)||void 0===l?void 0:l.type)}).then((t=>{var l;if(!e.fieldInfos&&h){const e=(0,i.a)(t.renderer,"size");if(e.minDataValue=h.minDataValue,e.maxDataValue=h.maxDataValue,u){const e=(0,i.p)(t.renderer,"size");e.minSliderValue=u.minSliderValue,e.maxSliderValue=u.maxSliderValue}}if(g&&p.opacityVisVar&&p.authOpacityVisVar&&(t.renderer.visualVariables=(0,i.n)(t.renderer,"opacity"),t.renderer.authoringInfo.visualVariables=(0,i.o)(t.renderer,"opacity"),t.renderer.visualVariables.push(p.opacityVisVar),t.renderer.authoringInfo.visualVariables=t.renderer.authoringInfo.visualVariables||[],t.renderer.authoringInfo.visualVariables.push(p.authOpacityVisVar)),(0,i.l)(p,t.renderer,{notOpacity:!0}),m&&t.renderer.attributes.sort(((e,t)=>{const l=m.indexOf(e.field),i=m.indexOf(t.field);return l>-1&&i>-1&&l<i?-1:l>-1&&i>-1&&l>i?1:l>-1?-1:i>-1?1:0})),g&&t.renderer.attributes.forEach(((e,t)=>{e.label=c.attributes[t].label})),t.renderer.size=c.size,t.renderer.holePercentage=c.holePercentage,t.renderer.othersCategory=c.othersCategory,v&&(null===(l=t.renderer.attributes)||void 0===l?void 0:l.length)&&t.renderer.attributes.map(((e,t)=>{g&&(e.color=c.attributes[t].color)})),y&&(t.renderer.backgroundFillSymbol=y),S){const e=(0,i.a)(t.renderer,"size"),l=e.minSize;e.minSize=e.maxSize,e.maxSize=l}return Promise.resolve(t)}),(e=>Promise.reject(e)))}function s(e){return e.map((e=>({field:e.field,label:n(e.field)})))}function n(e){const t=i.s.fields.filter((t=>t.layerField.name===e));return t.length?t[0].label:""}},36238:(e,t,l)=>{l.d(t,{a:()=>d,b:()=>u,c:()=>a,d:()=>i,e:()=>r,f:()=>c,g:()=>p,i:()=>o,m:()=>s,t:()=>n,u:()=>h});const i=(e,t)=>{let l,i="idle";const a=(...a)=>new Promise((r=>{switch(i){case"flushed":i="idle",l?(clearTimeout(l),r(e(...a))):r(null);break;case"invoked":clearTimeout(l),i="idle",r(e(...a));break;case"cancelled":clearTimeout(l),i="idle",r(null);break;default:l&&clearTimeout(l),i="pending",l=setTimeout((()=>(i="idle",r(e(...a)))),t)}}));return a.flush=function(...e){return i="flushed",a(...e)},a.invoke=function(...e){return i="invoked",a(...e)},a.cancel=function(...e){return i="cancelled",a(...e)},a.getStatus=function(){return i},a},a=(e,t)=>{let l;return(...i)=>new Promise((a=>{l||(l=setTimeout((()=>{clearTimeout(l),l=void 0,a(e(...i))}),t))}))};function r(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(e){return null!=e}async function s(e,t){return await Promise.all([e,n(t)]),e}function n(e){return new Promise((t=>setTimeout(t,e)))}const d=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:l,data:i}=t(e);return[l,i]}))),c=(e,t)=>e.length===t.length&&e.reduce(((e,l)=>e&&t.indexOf(l)>-1),!0);function h(e,t){const l=[],i={};return e.forEach((e=>{const a=t(e);null==i[a]&&(i[a]=e,l.push(e))})),l}function u(e){const t={boolean:{},number:{},string:{}},l=[];return e.filter((e=>{let i=typeof e;return i in t?!t[i].hasOwnProperty(e)&&(t[i][e]=!0):!(l.indexOf(e)>=0)&&l.push(e)}))}const p=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((l,i)=>e.slice(t*i,t+t*i)))},5996:(e,t,l)=>{let i,a;function r(e){e.loading=!1}function o(e,t){return function(e){e.loading=!0,a=!1,i&&clearTimeout(i),i=setTimeout((()=>{r(e),a=!0}),6e4)}(t),e.then((e=>(r(t),a?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(r(t),Promise.reject(e))))}l.d(t,{r:()=>o})}}]);