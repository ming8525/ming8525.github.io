"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_ba-infographic_node_modules_arcgis_business-analyst-components_dis-7e0a0d"],{

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-tooltip_3.entry.js":
/*!********************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-tooltip_3.entry.js ***!
  \********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calcite_tooltip: () => (/* binding */ Tooltip),
/* harmony export */   calcite_tree: () => (/* binding */ Tree),
/* harmony export */   calcite_tree_item: () => (/* binding */ TreeItem)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-1997bfaf.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/dom-1997bfaf.js");
/* harmony import */ var _floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./floating-ui-0f98fc53.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/floating-ui-0f98fc53.js");
/* harmony import */ var _guid_88a3729f_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./guid-88a3729f.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/guid-88a3729f.js");
/* harmony import */ var _openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./openCloseComponent-7d58834c.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/openCloseComponent-7d58834c.js");
/* harmony import */ var _conditionalSlot_a4837caf_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./conditionalSlot-a4837caf.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/conditionalSlot-a4837caf.js");
/* harmony import */ var _interactive_29995522_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./interactive-29995522.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/interactive-29995522.js");
/* harmony import */ var _resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./resources-48436eea.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/resources-48436eea.js");












/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const CSS$1 = {
  container: "container",
  arrow: "arrow"
};
const TOOLTIP_DELAY_MS = 500;
const ARIA_DESCRIBED_BY = "aria-describedby";

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
function getEffectiveReferenceElement(tooltip) {
  const { referenceElement } = tooltip;
  return ((typeof referenceElement === "string" ? (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.q)(tooltip, { id: referenceElement }) : referenceElement) ||
    null);
}

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
class TooltipManager {
  constructor() {
    // --------------------------------------------------------------------------
    //
    //  Private Properties
    //
    // --------------------------------------------------------------------------
    this.registeredElements = new WeakMap();
    this.hoverTimeout = null;
    this.registeredElementCount = 0;
    // --------------------------------------------------------------------------
    //
    //  Private Methods
    //
    // --------------------------------------------------------------------------
    this.queryTooltip = (composedPath) => {
      const { registeredElements } = this;
      const registeredElement = composedPath.find((pathEl) => registeredElements.has(pathEl));
      return registeredElements.get(registeredElement);
    };
    this.keyDownHandler = (event) => {
      if (event.key === "Escape" && !event.defaultPrevented) {
        const { activeTooltipEl } = this;
        if (activeTooltipEl && activeTooltipEl.open) {
          this.clearHoverTimeout();
          this.toggleTooltip(activeTooltipEl, false);
          const referenceElement = getEffectiveReferenceElement(activeTooltipEl);
          if (referenceElement instanceof Element && referenceElement.contains(event.target)) {
            event.preventDefault();
          }
        }
      }
    };
    this.queryHoveredTooltip = (composedPath) => {
      const { activeTooltipEl } = this;
      if (activeTooltipEl && composedPath.includes(activeTooltipEl)) {
        this.clearHoverTimeout();
        return;
      }
      const tooltip = this.queryTooltip(composedPath);
      if (tooltip) {
        this.toggleHoveredTooltip(tooltip, true);
      }
      else if (activeTooltipEl) {
        this.toggleHoveredTooltip(activeTooltipEl, false);
      }
    };
    this.pointerMoveHandler = (event) => {
      const composedPath = event.composedPath();
      this.clearHoverTimeout();
      this.hoverTimeout = window.setTimeout(() => this.queryHoveredTooltip(composedPath), TOOLTIP_DELAY_MS );
    };
    this.pointerDownHandler = (event) => {
      if (!(0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.i)(event)) {
        return;
      }
      const clickedTooltip = this.queryTooltip(event.composedPath());
      this.clickedTooltip = clickedTooltip;
      if (clickedTooltip?.closeOnClick) {
        this.toggleTooltip(clickedTooltip, false);
        this.clearHoverTimeout();
      }
    };
    this.focusInHandler = (event) => {
      this.queryFocusedTooltip(event, true);
    };
    this.focusOutHandler = (event) => {
      this.queryFocusedTooltip(event, false);
    };
    this.toggleHoveredTooltip = (tooltip, value) => {
      if (value) {
        this.closeExistingTooltip();
      }
      this.toggleTooltip(tooltip, value);
    };
  }
  // --------------------------------------------------------------------------
  //
  //  Public Methods
  //
  // --------------------------------------------------------------------------
  registerElement(referenceEl, tooltip) {
    this.registeredElementCount++;
    this.registeredElements.set(referenceEl, tooltip);
    if (this.registeredElementCount === 1) {
      this.addListeners();
    }
  }
  unregisterElement(referenceEl) {
    if (this.registeredElements.delete(referenceEl)) {
      this.registeredElementCount--;
    }
    if (this.registeredElementCount === 0) {
      this.removeListeners();
    }
  }
  addListeners() {
    document.addEventListener("keydown", this.keyDownHandler, { capture: true });
    document.addEventListener("pointermove", this.pointerMoveHandler, { capture: true });
    document.addEventListener("pointerdown", this.pointerDownHandler, { capture: true });
    document.addEventListener("focusin", this.focusInHandler, { capture: true });
    document.addEventListener("focusout", this.focusOutHandler, { capture: true });
  }
  removeListeners() {
    document.removeEventListener("keydown", this.keyDownHandler, { capture: true });
    document.removeEventListener("pointermove", this.pointerMoveHandler, { capture: true });
    document.removeEventListener("pointerdown", this.pointerDownHandler, { capture: true });
    document.removeEventListener("focusin", this.focusInHandler, { capture: true });
    document.removeEventListener("focusout", this.focusOutHandler, { capture: true });
  }
  clearHoverTimeout() {
    window.clearTimeout(this.hoverTimeout);
  }
  closeExistingTooltip() {
    const { activeTooltipEl } = this;
    if (activeTooltipEl) {
      this.toggleTooltip(activeTooltipEl, false);
    }
  }
  toggleFocusedTooltip(tooltip, value) {
    this.closeExistingTooltip();
    if (value) {
      this.clearHoverTimeout();
    }
    this.toggleTooltip(tooltip, value);
  }
  toggleTooltip(tooltip, value) {
    tooltip.open = value;
    if (value) {
      this.activeTooltipEl = tooltip;
    }
  }
  queryFocusedTooltip(event, value) {
    const tooltip = this.queryTooltip(event.composedPath());
    if (!tooltip || tooltip === this.clickedTooltip) {
      this.clickedTooltip = null;
      return;
    }
    this.toggleFocusedTooltip(tooltip, value);
  }
}

const tooltipCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{--calcite-floating-ui-z-index:var(--calcite-tooltip-z-index, 901);display:block;position:absolute;z-index:var(--calcite-floating-ui-z-index)}.calcite-floating-ui-anim{position:relative;transition:var(--calcite-floating-ui-transition);transition-property:transform, visibility, opacity;opacity:0;box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);z-index:1;border-radius:0.25rem}:host([data-placement^=bottom]) .calcite-floating-ui-anim{transform:translateY(-5px)}:host([data-placement^=top]) .calcite-floating-ui-anim{transform:translateY(5px)}:host([data-placement^=left]) .calcite-floating-ui-anim{transform:translateX(5px)}:host([data-placement^=right]) .calcite-floating-ui-anim{transform:translateX(-5px)}:host([data-placement]) .calcite-floating-ui-anim--active{opacity:1;transform:translate(0)}:host([calcite-hydrated-hidden]){visibility:hidden !important;pointer-events:none}.arrow,.arrow::before{position:absolute;inline-size:8px;block-size:8px;z-index:-1}.arrow::before{content:\"\";--tw-shadow:0 4px 8px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);--tw-shadow-colored:0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transform:rotate(45deg);background:var(--calcite-ui-foreground-1)}:host([data-placement^=top]) .arrow{inset-block-end:-4px}:host([data-placement^=bottom]) .arrow{inset-block-start:-4px}:host([data-placement^=right]) .arrow,:host([data-placement^=left]) .arrow{direction:ltr;text-align:start}:host([data-placement^=left]) .arrow{inset-inline-end:-4px}:host([data-placement^=right]) .arrow{inset-inline-start:-4px}.container{position:relative;overflow:hidden;border-radius:0.25rem;background-color:var(--calcite-ui-foreground-1);padding-block:0.75rem;padding-inline:1rem;font-size:var(--calcite-font-size--2);line-height:1.375;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1);max-inline-size:20rem;max-block-size:20rem;text-align:start}.calcite-floating-ui-anim{border-radius:0.25rem;border-width:1px;border-style:solid;border-color:var(--calcite-ui-border-3);background-color:var(--calcite-ui-foreground-1)}.arrow::before{outline:1px solid var(--calcite-ui-border-3)}";

const manager = new TooltipManager();
const Tooltip = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.r)(this, hostRef);
    this.calciteTooltipBeforeClose = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipBeforeClose", 6);
    this.calciteTooltipClose = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipClose", 6);
    this.calciteTooltipBeforeOpen = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipBeforeOpen", 6);
    this.calciteTooltipOpen = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipOpen", 6);
    this.guid = `calcite-tooltip-${(0,_guid_88a3729f_js__WEBPACK_IMPORTED_MODULE_2__.g)()}`;
    this.hasLoaded = false;
    this.openTransitionProp = "opacity";
    this.setTransitionEl = (el) => {
      this.transitionEl = el;
      (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    };
    this.setUpReferenceElement = (warn = true) => {
      this.removeReferences();
      this.effectiveReferenceElement = getEffectiveReferenceElement(this.el);
      (0,_floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__.c)(this, this.effectiveReferenceElement, this.el);
      const { el, referenceElement, effectiveReferenceElement } = this;
      if (warn && referenceElement && !effectiveReferenceElement) {
        console.warn(`${el.tagName}: reference-element id "${referenceElement}" was not found.`, {
          el
        });
      }
      this.addReferences();
    };
    this.getId = () => {
      return this.el.id || this.guid;
    };
    this.addReferences = () => {
      const { effectiveReferenceElement } = this;
      if (!effectiveReferenceElement) {
        return;
      }
      const id = this.getId();
      if ("setAttribute" in effectiveReferenceElement) {
        effectiveReferenceElement.setAttribute(ARIA_DESCRIBED_BY, id);
      }
      manager.registerElement(effectiveReferenceElement, this.el);
    };
    this.removeReferences = () => {
      const { effectiveReferenceElement } = this;
      if (!effectiveReferenceElement) {
        return;
      }
      if ("removeAttribute" in effectiveReferenceElement) {
        effectiveReferenceElement.removeAttribute(ARIA_DESCRIBED_BY);
      }
      manager.unregisterElement(effectiveReferenceElement);
    };
    this.closeOnClick = false;
    this.label = undefined;
    this.offsetDistance = _floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__.b;
    this.offsetSkidding = 0;
    this.open = false;
    this.overlayPositioning = "absolute";
    this.placement = "auto";
    this.referenceElement = undefined;
    this.effectiveReferenceElement = undefined;
  }
  offsetDistanceOffsetHandler() {
    this.reposition(true);
  }
  offsetSkiddingHandler() {
    this.reposition(true);
  }
  openHandler(value) {
    if (value) {
      this.reposition(true);
    }
    else {
      (0,_floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__.u)(this.el);
    }
  }
  overlayPositioningHandler() {
    this.reposition(true);
  }
  placementHandler() {
    this.reposition(true);
  }
  referenceElementHandler() {
    this.setUpReferenceElement();
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  connectedCallback() {
    (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    this.setUpReferenceElement(this.hasLoaded);
  }
  componentDidLoad() {
    if (this.referenceElement && !this.effectiveReferenceElement) {
      this.setUpReferenceElement();
    }
    this.reposition(true);
    this.hasLoaded = true;
  }
  disconnectedCallback() {
    this.removeReferences();
    (0,_floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__.a)(this, this.effectiveReferenceElement, this.el);
    (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
  }
  // --------------------------------------------------------------------------
  //
  //  Public Methods
  //
  // --------------------------------------------------------------------------
  /**
   * Updates the position of the component.
   *
   * @param delayed
   */
  async reposition(delayed = false) {
    const { el, effectiveReferenceElement, placement, overlayPositioning, offsetDistance, offsetSkidding, arrowEl } = this;
    return (0,_floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__.r)(this, {
      floatingEl: el,
      referenceEl: effectiveReferenceElement,
      overlayPositioning,
      placement,
      offsetDistance,
      offsetSkidding,
      includeArrow: true,
      arrowEl,
      type: "tooltip"
    }, delayed);
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  // --------------------------------------------------------------------------
  onBeforeOpen() {
    this.calciteTooltipBeforeOpen.emit();
  }
  onOpen() {
    this.calciteTooltipOpen.emit();
  }
  onBeforeClose() {
    this.calciteTooltipBeforeClose.emit();
  }
  onClose() {
    this.calciteTooltipClose.emit();
  }
  // --------------------------------------------------------------------------
  //
  //  Render Methods
  //
  // --------------------------------------------------------------------------
  render() {
    const { effectiveReferenceElement, label, open } = this;
    const displayed = effectiveReferenceElement && open;
    const hidden = !displayed;
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.H, { "aria-hidden": (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.t)(hidden), "aria-label": label, "aria-live": "polite", "calcite-hydrated-hidden": hidden, id: this.getId(), role: "tooltip" }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: {
        [_floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__.F.animation]: true,
        [_floating_ui_0f98fc53_js__WEBPACK_IMPORTED_MODULE_4__.F.animationActive]: displayed
      }, ref: this.setTransitionEl }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: CSS$1.arrow, ref: (arrowEl) => (this.arrowEl = arrowEl) }), (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: CSS$1.container }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", null)))));
  }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.g)(this); }
  static get watchers() { return {
    "offsetDistance": ["offsetDistanceOffsetHandler"],
    "offsetSkidding": ["offsetSkiddingHandler"],
    "open": ["openHandler"],
    "overlayPositioning": ["overlayPositioningHandler"],
    "placement": ["placementHandler"],
    "referenceElement": ["referenceElementHandler"]
  }; }
};
Tooltip.style = tooltipCss;

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
function isTreeItem(element) {
  return element?.matches("calcite-tree-item");
}
function getEnabledSiblingItem(el, direction) {
  const directionProp = direction === "down" ? "nextElementSibling" : "previousElementSibling";
  let currentEl = el;
  let enabledEl = null;
  while (isTreeItem(currentEl)) {
    if (!currentEl.disabled) {
      enabledEl = currentEl;
      break;
    }
    currentEl = currentEl[directionProp];
  }
  return enabledEl;
}

const treeCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{display:block}:host(:focus){outline:2px solid transparent;outline-offset:2px}";

const Tree = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.r)(this, hostRef);
    this.calciteTreeSelect = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTreeSelect", 6);
    this.lines = false;
    this.child = undefined;
    this.scale = "m";
    this.selectionMode = "single";
    this.selectedItems = [];
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  componentWillRender() {
    const parent = this.el.parentElement?.closest("calcite-tree");
    this.lines = parent ? parent.lines : this.lines;
    this.scale = parent ? parent.scale : this.scale;
    this.selectionMode = parent ? parent.selectionMode : this.selectionMode;
    this.child = !!parent;
  }
  render() {
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.H, { "aria-multiselectable": this.child
        ? undefined
        : (this.selectionMode === "multiple" || this.selectionMode === "multichildren").toString(), role: !this.child ? "tree" : undefined, tabIndex: this.getRootTabIndex() }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", null)));
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  onFocus() {
    if (!this.child) {
      const focusTarget = this.el.querySelector("calcite-tree-item[selected]:not([disabled])") || this.el.querySelector("calcite-tree-item:not([disabled])");
      (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.h)(focusTarget);
    }
  }
  onFocusIn(event) {
    const focusedFromRootOrOutsideTree = event.relatedTarget === this.el || !this.el.contains(event.relatedTarget);
    if (focusedFromRootOrOutsideTree) {
      // gives user the ability to tab into external elements (modifying tabindex property will not work in firefox)
      this.el.removeAttribute("tabindex");
    }
  }
  onFocusOut(event) {
    const willFocusOutsideTree = !this.el.contains(event.relatedTarget);
    if (willFocusOutsideTree) {
      this.el.tabIndex = this.getRootTabIndex();
    }
  }
  onClick(event) {
    const target = event.target;
    const childItems = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(target.querySelectorAll("calcite-tree-item"));
    if (this.child) {
      return;
    }
    if (!this.child) {
      event.preventDefault();
      event.stopPropagation();
    }
    if (this.selectionMode === "ancestors" && !this.child) {
      this.updateAncestorTree(event);
      return;
    }
    const isNoneSelectionMode = this.selectionMode === "none";
    const shouldSelect = this.selectionMode !== null &&
      (!target.hasChildren ||
        (target.hasChildren &&
          (this.selectionMode === "children" || this.selectionMode === "multichildren")));
    const shouldModifyToCurrentSelection = !isNoneSelectionMode &&
      event.detail.modifyCurrentSelection &&
      (this.selectionMode === "multiple" || this.selectionMode === "multichildren");
    const shouldSelectChildren = this.selectionMode === "multichildren" || this.selectionMode === "children";
    const shouldClearCurrentSelection = !shouldModifyToCurrentSelection &&
      (((this.selectionMode === "single" || this.selectionMode === "multiple") &&
        childItems.length <= 0) ||
        this.selectionMode === "children" ||
        this.selectionMode === "multichildren");
    const shouldExpandTarget = this.selectionMode === "children" || this.selectionMode === "multichildren";
    if (!this.child) {
      const targetItems = [];
      if (shouldSelect) {
        targetItems.push(target);
      }
      if (shouldSelectChildren) {
        childItems.forEach((treeItem) => {
          targetItems.push(treeItem);
        });
      }
      if (shouldClearCurrentSelection) {
        const selectedItems = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.querySelectorAll("calcite-tree-item[selected]"));
        selectedItems.forEach((treeItem) => {
          if (!targetItems.includes(treeItem)) {
            treeItem.selected = false;
          }
        });
      }
      if (shouldExpandTarget && !event.detail.forceToggle) {
        target.expanded = true;
      }
      if (shouldModifyToCurrentSelection) {
        window.getSelection().removeAllRanges();
      }
      if ((shouldModifyToCurrentSelection && target.selected) ||
        (shouldSelectChildren && event.detail.forceToggle)) {
        targetItems.forEach((treeItem) => {
          if (!treeItem.disabled) {
            treeItem.selected = false;
          }
        });
      }
      else if (!isNoneSelectionMode) {
        targetItems.forEach((treeItem) => {
          if (!treeItem.disabled) {
            treeItem.selected = true;
          }
        });
      }
    }
    this.selectedItems = isNoneSelectionMode
      ? [target]
      : (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.querySelectorAll("calcite-tree-item")).filter((i) => i.selected);
    this.calciteTreeSelect.emit();
    event.stopPropagation();
  }
  keyDownHandler(event) {
    const root = this.el.closest("calcite-tree:not([child])");
    const target = event.target;
    if (!(root === this.el && target.tagName === "CALCITE-TREE-ITEM" && this.el.contains(target))) {
      return;
    }
    if (event.key === "ArrowDown") {
      const next = getEnabledSiblingItem(target.nextElementSibling, "down");
      if (next) {
        next.focus();
        event.preventDefault();
      }
      return;
    }
    if (event.key === "ArrowUp") {
      const previous = getEnabledSiblingItem(target.previousElementSibling, "up");
      if (previous) {
        previous.focus();
        event.preventDefault();
      }
    }
    if (event.key === "ArrowLeft" && !target.disabled) {
      // When focus is on an open node, closes the node.
      if (target.hasChildren && target.expanded) {
        target.expanded = false;
        event.preventDefault();
        return;
      }
      // When focus is on a child node that is also either an end node or a closed node, moves focus to its parent node.
      const parentItem = target.parentElement.closest("calcite-tree-item");
      if (parentItem && (!target.hasChildren || target.expanded === false)) {
        parentItem.focus();
        event.preventDefault();
        return;
      }
      // When focus is on a root node that is also either an end node or a closed node, does nothing.
      return;
    }
    if (event.key === "ArrowRight" && !target.disabled) {
      if (target.hasChildren) {
        if (target.expanded && (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.u)(this.el).activeElement === target) {
          // When focus is on an open node, moves focus to the first child node.
          getEnabledSiblingItem(target.querySelector("calcite-tree-item"), "down")?.focus();
          event.preventDefault();
        }
        else {
          // When focus is on a closed node, opens the node; focus does not move.
          target.expanded = true;
          event.preventDefault();
        }
      }
      return;
    }
  }
  updateAncestorTree(event) {
    const item = event.target;
    if (item.disabled) {
      return;
    }
    const ancestors = [];
    let parent = item.parentElement.closest("calcite-tree-item");
    while (parent) {
      ancestors.push(parent);
      parent = parent.parentElement.closest("calcite-tree-item");
    }
    const childItems = Array.from(item.querySelectorAll("calcite-tree-item:not([disabled])"));
    const childItemsWithNoChildren = childItems.filter((child) => !child.hasChildren);
    const childItemsWithChildren = childItems.filter((child) => child.hasChildren);
    const futureSelected = item.hasChildren
      ? !(item.selected || item.indeterminate)
      : !item.selected;
    childItemsWithNoChildren.forEach((el) => {
      el.selected = futureSelected;
      el.indeterminate = false;
    });
    function updateItemState(childItems, item) {
      const selected = childItems.filter((child) => child.selected);
      const unselected = childItems.filter((child) => !child.selected);
      item.selected = selected.length === childItems.length;
      item.indeterminate = selected.length > 0 && unselected.length > 0;
    }
    childItemsWithChildren.forEach((el) => {
      const directChildItems = Array.from(el.querySelectorAll(":scope > calcite-tree > calcite-tree-item"));
      updateItemState(directChildItems, el);
    });
    if (item.hasChildren) {
      updateItemState(childItems, item);
    }
    else {
      item.selected = futureSelected;
      item.indeterminate = false;
    }
    ancestors.forEach((ancestor) => {
      const descendants = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(ancestor.querySelectorAll("calcite-tree-item"));
      const activeDescendants = descendants.filter((el) => el.selected);
      if (activeDescendants.length === 0) {
        ancestor.selected = false;
        ancestor.indeterminate = false;
        return;
      }
      const indeterminate = activeDescendants.length < descendants.length;
      ancestor.indeterminate = indeterminate;
      ancestor.selected = !indeterminate;
    });
    this.selectedItems = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.querySelectorAll("calcite-tree-item")).filter((i) => i.selected);
    this.calciteTreeSelect.emit();
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  getRootTabIndex() {
    return !this.child ? 0 : -1;
  }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.g)(this); }
};
Tree.style = treeCss;

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const CSS = {
  actionsEnd: "actions-end",
  checkboxLabel: "checkbox-label",
  checkbox: "checkbox",
  chevron: "chevron",
  nodeContainer: "node-container",
  childrenContainer: "children-container",
  bulletPointIcon: "bullet-point",
  checkmarkIcon: "checkmark",
  itemExpanded: "item--expanded",
  iconStart: "icon-start"
};
const SLOTS = {
  actionsEnd: "actions-end",
  children: "children"
};
const ICONS = {
  bulletPoint: "bullet-point",
  checkmark: "check",
  chevronRight: "chevron-right",
  blank: "blank"
};

const treeItemCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host{display:block;max-inline-size:100%;cursor:pointer;color:var(--calcite-ui-text-3)}[hidden]{display:none}:host([calcite-hydrated-hidden]){visibility:hidden !important;pointer-events:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([scale=s]){font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) .node-container{--calcite-tree-padding-y:0.25rem}:host([scale=s]) .node-container .checkbox,:host([scale=s]) .node-container .chevron,:host([scale=s]) .node-container .checkmark,:host([scale=s]) .node-container .bullet-point{margin-inline:0.25rem}:host([scale=s]) .node-container .icon-start,:host([scale=s]) .node-container .actions-end{margin-inline:0.25rem}:host([scale=m]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) .node-container{--calcite-tree-padding-y:0.5rem}:host([scale=m]) .node-container .checkbox,:host([scale=m]) .node-container .chevron,:host([scale=m]) .node-container .checkmark,:host([scale=m]) .node-container .bullet-point{margin-inline:0.5rem}:host([scale=m]) .node-container .icon-start,:host([scale=m]) .node-container .actions-end{margin-inline:0.5rem}:host([scale=l]){font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .node-container{--calcite-tree-padding-y:0.75rem}:host([scale=l]) .node-container .checkbox,:host([scale=l]) .node-container .chevron,:host([scale=l]) .node-container .checkmark,:host([scale=l]) .node-container .bullet-point{margin-inline:0.75rem}:host([scale=l]) .node-container .icon-start,:host([scale=l]) .node-container .actions-end{margin-inline:0.75rem}:host([lines]) .children-container:after{position:absolute;inset-block-start:0px;z-index:1;inline-size:1px;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;block-size:96%;content:\"\";background-color:var(--calcite-ui-border-2)}:host(:not([lines])) .node-container:after{display:none}::slotted(*){min-inline-size:0px;max-inline-size:100%;overflow-wrap:break-word;color:inherit;text-decoration:none !important}::slotted(*):hover{text-decoration:none !important}::slotted(a){inline-size:100%;text-decoration-line:none}:host{outline-color:transparent}:host(:focus){outline:2px solid transparent;outline:2px solid var(--calcite-ui-brand);outline-offset:-2px}slot[name=actions-end]::slotted(*),.actions-end{display:flex;flex-direction:row;align-items:center;align-self:stretch;overflow:visible}.checkbox{line-height:0}.checkbox-label{pointer-events:none;display:flex;align-items:center}.checkbox:focus{outline:2px solid transparent;outline-offset:2px}.children-container{position:relative;block-size:0px;overflow:hidden;margin-inline-start:1.25rem;transform:scaleY(0);opacity:0;transition:var(--calcite-animation-timing) cubic-bezier(0.215, 0.44, 0.42, 0.88), opacity var(--calcite-animation-timing) cubic-bezier(0.215, 0.44, 0.42, 0.88), all var(--calcite-animation-timing) ease-in-out;transform-origin:top}.item--expanded>.children-container{overflow:visible;opacity:1;block-size:auto}.node-container{position:relative;display:flex;align-items:center;padding-block:var(--calcite-tree-padding-y);padding-inline:0}.node-container .checkmark,.node-container .bullet-point{opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;color:var(--calcite-ui-border-1)}.node-container:hover .checkmark,.node-container:hover .bullet-point,:host([selected]) .node-container:hover .checkmark,:host([selected]) .node-container:hover .bullet-point,:host(:focus:not([disabled])) .node-container .checkmark,:host(:focus:not([disabled])) .node-container .bullet-point{opacity:1}:host([selected]) .node-container,:host([selected]) .node-container:hover{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1)}:host([selected]) .node-container .bullet-point,:host([selected]) .node-container .checkmark,:host([selected]) .node-container:hover .bullet-point,:host([selected]) .node-container:hover .checkmark{opacity:1;color:var(--calcite-ui-brand)}:host([selection-mode=none]:not([has-children])):host([scale=s]) .node-container{padding-inline-start:0.5rem}:host([selection-mode=none]:not([has-children])):host([scale=m]) .node-container{padding-inline-start:1rem}:host([selection-mode=none]:not([has-children])):host([scale=l]) .node-container{padding-inline-start:1.5rem}:host(:not([has-children])):host([scale=s]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.25rem}:host(:not([has-children])):host([scale=m]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.5rem}:host(:not([has-children])):host([scale=l]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.75rem}:host([has-children]) .node-container[data-selection-mode=ancestors] .checkbox{margin-inline-start:0}:host([has-children]) .node-container .bullet-point,:host([has-children]) .node-container .checkmark{display:none}:host([has-children][expanded]:not([selected]):not([selection-mode=none])) .node-container ::slotted(*){font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1)}:host([has-children][selected]) .node-container[data-selection-mode=children],:host([has-children][selected]) .node-container[data-selection-mode=multichildren]{color:var(--calcite-ui-brand)}.chevron{position:relative;align-self:center;color:var(--calcite-ui-text-3);transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;flex:0 0 auto;transform:rotate(0deg)}.calcite--rtl .chevron{transform:rotate(180deg)}.item--expanded>.node-container>.chevron{transform:rotate(90deg)}:host([selected]) .checkmark,:host([selected]) .bullet-point{color:var(--calcite-ui-brand)}";

const TreeItem = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.r)(this, hostRef);
    this.calciteInternalTreeItemSelect = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteInternalTreeItemSelect", 6);
    this.openTransitionProp = "opacity";
    this.transitionProp = "expanded";
    this.iconClickHandler = (event) => {
      event.stopPropagation();
      this.expanded = !this.expanded;
    };
    this.childrenClickHandler = (event) => event.stopPropagation();
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    this.updateParentIsExpanded = (el, expanded) => {
      const items = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.g)(el, SLOTS.children, {
        all: true,
        selector: "calcite-tree-item"
      });
      items.forEach((item) => (item.parentExpanded = expanded));
    };
    this.updateAncestorTree = () => {
      if (this.selected && this.selectionMode === "ancestors") {
        const ancestors = [];
        let parent = this.parentTreeItem;
        while (parent) {
          ancestors.push(parent);
          parent = parent.parentElement?.closest("calcite-tree-item");
        }
        ancestors.forEach((item) => (item.indeterminate = true));
        return;
      }
    };
    this.actionsEndSlotChangeHandler = (event) => {
      this.hasEndActions = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.s)(event);
    };
    this.disabled = false;
    this.expanded = false;
    this.iconFlipRtl = undefined;
    this.iconStart = undefined;
    this.selected = false;
    this.parentExpanded = false;
    this.depth = -1;
    this.hasChildren = null;
    this.lines = undefined;
    this.scale = undefined;
    this.indeterminate = undefined;
    this.selectionMode = undefined;
    this.updateAfterInitialRender = false;
    this.hasEndActions = false;
  }
  expandedHandler(newValue) {
    this.updateParentIsExpanded(this.el, newValue);
    (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.o)(this, true);
  }
  getselectionMode() {
    this.isSelectionMultiLike =
      this.selectionMode === "multiple" || this.selectionMode === "multichildren";
  }
  /**
   * Defines method for `beforeOpen` event handler.
   */
  onBeforeOpen() {
    this.transitionEl.style.transform = "scaleY(1)";
  }
  /**
   * Defines method for `open` event handler:
   */
  onOpen() {
    this.transitionEl.style.transform = "none";
  }
  /**
   * Defines method for `beforeClose` event handler:
   */
  onBeforeClose() {
    // pattern needs to be defined on how we emit events for components without `open` prop.
  }
  /**
   * Defines method for `close` event handler:
   */
  onClose() {
    this.transitionEl.style.transform = "scaleY(0)";
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  connectedCallback() {
    this.parentTreeItem = this.el.parentElement?.closest("calcite-tree-item");
    if (this.parentTreeItem) {
      const { expanded } = this.parentTreeItem;
      this.updateParentIsExpanded(this.parentTreeItem, expanded);
    }
    (0,_conditionalSlot_a4837caf_js__WEBPACK_IMPORTED_MODULE_5__.c)(this);
  }
  disconnectedCallback() {
    (0,_conditionalSlot_a4837caf_js__WEBPACK_IMPORTED_MODULE_5__.d)(this);
  }
  componentWillRender() {
    this.hasChildren = !!this.el.querySelector("calcite-tree");
    this.depth = 0;
    let parentTree = this.el.closest("calcite-tree");
    if (!parentTree) {
      return;
    }
    this.selectionMode = parentTree.selectionMode;
    this.scale = parentTree.scale || "m";
    this.lines = parentTree.lines;
    let nextParentTree;
    while (parentTree) {
      nextParentTree = parentTree.parentElement?.closest("calcite-tree");
      if (nextParentTree === parentTree) {
        break;
      }
      else {
        parentTree = nextParentTree;
        this.depth = this.depth + 1;
      }
    }
  }
  componentWillLoad() {
    if (this.expanded) {
      (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.o)(this, true);
    }
    requestAnimationFrame(() => (this.updateAfterInitialRender = true));
  }
  componentDidLoad() {
    this.updateAncestorTree();
  }
  componentDidRender() {
    (0,_interactive_29995522_js__WEBPACK_IMPORTED_MODULE_6__.u)(this, () => this.parentExpanded || this.depth === 1);
  }
  render() {
    const rtl = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.b)(this.el) === "rtl";
    const showBulletPoint = this.selectionMode === "single" || this.selectionMode === "children";
    const showCheckmark = this.selectionMode === "multiple" || this.selectionMode === "multichildren";
    const showBlank = this.selectionMode === "none" && !this.hasChildren;
    const chevron = this.hasChildren ? ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-icon", { class: {
        [CSS.chevron]: true,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, "data-test-id": "icon", icon: ICONS.chevronRight, onClick: this.iconClickHandler, scale: this.scale === "l" ? "m" : "s" })) : null;
    const defaultSlotNode = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", { key: "default-slot" });
    const checkbox = this.selectionMode === "ancestors" ? ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("label", { class: CSS.checkboxLabel, key: "checkbox-label" }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-checkbox", { checked: this.selected, class: CSS.checkbox, "data-test-id": "checkbox", indeterminate: this.hasChildren && this.indeterminate, scale: this.scale, tabIndex: -1 }), defaultSlotNode)) : null;
    const selectedIcon = showBulletPoint
      ? ICONS.bulletPoint
      : showCheckmark
        ? ICONS.checkmark
        : showBlank
          ? ICONS.blank
          : null;
    const itemIndicator = selectedIcon ? ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-icon", { class: {
        [CSS.bulletPointIcon]: selectedIcon === ICONS.bulletPoint,
        [CSS.checkmarkIcon]: selectedIcon === ICONS.checkmark,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, icon: selectedIcon, scale: this.scale === "l" ? "m" : "s" })) : null;
    const hidden = !(this.parentExpanded || this.depth === 1);
    const isExpanded = this.updateAfterInitialRender && this.expanded;
    const { hasEndActions } = this;
    const slotNode = ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", { key: "actionsEndSlot", name: SLOTS.actionsEnd, onSlotchange: this.actionsEndSlotChangeHandler }));
    const iconStartEl = ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-icon", { class: CSS.iconStart, flipRtl: this.iconFlipRtl === "start" || this.iconFlipRtl === "both", icon: this.iconStart, scale: this.scale === "l" ? "m" : "s" }));
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.H, { "aria-expanded": this.hasChildren ? (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.t)(isExpanded) : undefined, "aria-hidden": (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.t)(hidden), "aria-selected": this.selected ? "true" : showCheckmark ? "false" : undefined, "calcite-hydrated-hidden": hidden, role: "treeitem" }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: { [CSS.itemExpanded]: isExpanded } }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: {
        [CSS.nodeContainer]: true,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, "data-selection-mode": this.selectionMode, ref: (el) => (this.defaultSlotWrapper = el) }, chevron, itemIndicator, this.iconStart ? iconStartEl : null, checkbox ? checkbox : defaultSlotNode, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: CSS.actionsEnd, hidden: !hasEndActions }, slotNode)), (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: {
        [CSS.childrenContainer]: true,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, "data-test-id": "calcite-tree-children", onClick: this.childrenClickHandler, ref: (el) => this.setTransitionEl(el), role: this.hasChildren ? "group" : undefined }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", { name: SLOTS.children })))));
  }
  setTransitionEl(el) {
    this.transitionEl = el;
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  onClick(event) {
    // Solve for if the item is clicked somewhere outside the slotted anchor.
    // Anchor is triggered anywhere you click
    const [link] = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.r)(this.el, "a");
    if (link && event.composedPath()[0].tagName.toLowerCase() !== "a") {
      const target = link.target === "" ? "_self" : link.target;
      window.open(link.href, target);
    }
    this.calciteInternalTreeItemSelect.emit({
      modifyCurrentSelection: this.selectionMode === "ancestors" || this.isSelectionMultiLike,
      forceToggle: false
    });
  }
  keyDownHandler(event) {
    let root;
    switch (event.key) {
      case " ":
        if (this.selectionMode === "none") {
          return;
        }
        this.calciteInternalTreeItemSelect.emit({
          modifyCurrentSelection: this.isSelectionMultiLike,
          forceToggle: false
        });
        event.preventDefault();
        break;
      case "Enter":
        if (this.selectionMode === "none") {
          return;
        }
        // activates a node, i.e., performs its default action. For parent nodes, one possible default action is to open or close the node. In single-select trees where selection does not follow focus (see note below), the default action is typically to select the focused node.
        const link = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.children).find((el) => el.matches("a"));
        if (link) {
          link.click();
          this.selected = true;
        }
        else {
          this.calciteInternalTreeItemSelect.emit({
            modifyCurrentSelection: this.isSelectionMultiLike,
            forceToggle: false
          });
        }
        event.preventDefault();
        break;
      case "Home":
        root = this.el.closest("calcite-tree:not([child])");
        const firstNode = root.querySelector("calcite-tree-item");
        firstNode?.focus();
        break;
      case "End":
        root = this.el.closest("calcite-tree:not([child])");
        let currentNode = root.children[root.children.length - 1]; // last child
        let currentTree = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(currentNode.children).find((el) => el.matches("calcite-tree"));
        while (currentTree) {
          currentNode = currentTree.children[root.children.length - 1];
          currentTree = (0,_dom_1997bfaf_js__WEBPACK_IMPORTED_MODULE_0__.n)(currentNode.children).find((el) => el.matches("calcite-tree"));
        }
        currentNode?.focus();
        break;
    }
  }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.g)(this); }
  static get watchers() { return {
    "expanded": ["expandedHandler"],
    "selectionMode": ["getselectionMode"]
  }; }
};
TreeItem.style = treeItemCss;



//# sourceMappingURL=calcite-tooltip_3.entry.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/conditionalSlot-a4837caf.js":
/*!*********************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/conditionalSlot-a4837caf.js ***!
  \*********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ connectConditionalSlotComponent),
/* harmony export */   d: () => (/* binding */ disconnectConditionalSlotComponent)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _observers_56740e99_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observers-56740e99.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/observers-56740e99.js");



/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const observed = new Set();
let mutationObserver;
const observerOptions = { childList: true };
/**
 * Helper to set up a conditional slot component on connectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function connectConditionalSlotComponent(component) {
  if (!mutationObserver) {
    mutationObserver = (0,_observers_56740e99_js__WEBPACK_IMPORTED_MODULE_0__.c)("mutation", processMutations);
  }
  mutationObserver.observe(component.el, observerOptions);
}
/**
 * Helper to tear down a conditional slot component on disconnectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function disconnectConditionalSlotComponent(component) {
  observed.delete(component.el);
  // we explicitly process queued mutations and disconnect and reconnect
  // the observer until MutationObserver gets an `unobserve` method
  // see https://github.com/whatwg/dom/issues/126
  processMutations(mutationObserver.takeRecords());
  mutationObserver.disconnect();
  for (const [element] of observed.entries()) {
    mutationObserver.observe(element, observerOptions);
  }
}
function processMutations(mutations) {
  mutations.forEach(({ target }) => {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.f)(target);
  });
}



//# sourceMappingURL=conditionalSlot-a4837caf.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/interactive-29995522.js":
/*!*****************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/interactive-29995522.js ***!
  \*****************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   u: () => (/* binding */ updateHostInteraction)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
function noopClick() {
  /** noop */
}
/**
 * This helper updates the host element to prevent keyboard interaction on its subtree and sets the appropriate aria attribute for accessibility.
 *
 * This should be used in the `componentDidRender` lifecycle hook.
 *
 * **Notes**
 *
 * this util is not needed for simple components whose root element or elements are an interactive component (custom element or native control). For those cases, set the `disabled` props on the root components instead.
 * technically, users can override `tabindex` and restore keyboard navigation, but this will be considered user error
 *
 * @param component
 * @param hostIsTabbable
 */
function updateHostInteraction(component, hostIsTabbable = false) {
  if (component.disabled) {
    component.el.setAttribute("tabindex", "-1");
    component.el.setAttribute("aria-disabled", "true");
    if (component.el.contains(document.activeElement)) {
      document.activeElement.blur();
    }
    component.el.click = noopClick;
    return;
  }
  component.el.click = HTMLElement.prototype.click;
  if (typeof hostIsTabbable === "function") {
    component.el.setAttribute("tabindex", hostIsTabbable.call(component) ? "0" : "-1");
  }
  else if (hostIsTabbable === true) {
    component.el.setAttribute("tabindex", "0");
  }
  else if (hostIsTabbable === false) {
    component.el.removeAttribute("tabindex");
  }
  else ;
  component.el.removeAttribute("aria-disabled");
}



//# sourceMappingURL=interactive-29995522.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/observers-56740e99.js":
/*!***************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/observers-56740e99.js ***!
  \***************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createObserver)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
/**
 * This utility ensures observers are created only for browser contexts.
 *
 * @param type - the type of observer to create
 * @param callback - the observer callback
 * @param options - the observer options
 */
function createObserver(type, callback, options) {
  const Observer = getObserver(type);
  return new Observer(callback, options);
}
function getObserver(type) {
  // based on https://github.com/whatwg/dom/issues/126#issuecomment-1049814948
  class ExtendedMutationObserver extends window.MutationObserver {
    constructor(callback) {
      super(callback);
      this.observedEntry = [];
      this.callback = callback;
    }
    observe(target, options) {
      this.observedEntry.push({ target, options });
      return super.observe(target, options);
    }
    unobserve(target) {
      const newObservedEntries = this.observedEntry.filter((observed) => observed.target !== target);
      this.observedEntry = [];
      this.callback(super.takeRecords(), this);
      this.disconnect();
      newObservedEntries.forEach((observed) => this.observe(observed.target, observed.options));
    }
  }
  return (function () {
    return (type === "intersection"
      ? window.IntersectionObserver
      : type === "mutation"
        ? ExtendedMutationObserver
        : window.ResizeObserver);
  })();
}



//# sourceMappingURL=observers-56740e99.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYmEtaW5mb2dyYXBoaWNfbm9kZV9tb2R1bGVzX2FyY2dpc19idXNpbmVzcy1hbmFseXN0LWNvbXBvbmVudHNfZGlzLTdlMGEwZC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE2RztBQUM2SjtBQUN0RjtBQUNySTtBQUN1RztBQUN4QjtBQUN2RDtBQUNaO0FBQzFCO0FBQ0Q7QUFDQzs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1CQUFtQjtBQUM3QixrREFBa0QsbURBQWlCLFlBQVksc0JBQXNCO0FBQ3JHO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxxQkFBcUI7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsa0JBQWtCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsbURBQXNCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3RUFBd0U7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixRQUFRO0FBQy9CLElBQUkscURBQVc7QUFDZixHQUFHO0FBQ0g7O0FBRXlGOztBQUV6Rjs7Ozs7Ozs7Ozs7Ozs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc0M7O0FBRXRDOzs7Ozs7Ozs7Ozs7OztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxpQkFBaUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRStCOztBQUUvQiIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYmEtaW5mb2dyYXBoaWMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYnVzaW5lc3MtYW5hbHlzdC1jb21wb25lbnRzL2Rpc3Qvc3RlbmNpbC1jb21wb25lbnRzL2Rpc3QvZXNtL2NhbGNpdGUtdG9vbHRpcF8zLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYmEtaW5mb2dyYXBoaWMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYnVzaW5lc3MtYW5hbHlzdC1jb21wb25lbnRzL2Rpc3Qvc3RlbmNpbC1jb21wb25lbnRzL2Rpc3QvZXNtL2NvbmRpdGlvbmFsU2xvdC1hNDgzN2NhZi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS9pbnRlcmFjdGl2ZS0yOTk5NTUyMi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS9vYnNlcnZlcnMtNTY3NDBlOTkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBIIGFzIEhvc3QsIGcgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtNGU2NDc0MTEuanMnO1xuaW1wb3J0IHsgcSBhcyBxdWVyeUVsZW1lbnRSb290cywgaSBhcyBpc1ByaW1hcnlQb2ludGVyQnV0dG9uLCB0IGFzIHRvQXJpYUJvb2xlYW4sIGggYXMgZm9jdXNFbGVtZW50LCBuIGFzIG5vZGVMaXN0VG9BcnJheSwgdSBhcyBnZXRSb290Tm9kZSwgZyBhcyBnZXRTbG90dGVkLCBzIGFzIHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQsIGIgYXMgZ2V0RWxlbWVudERpciwgciBhcyBmaWx0ZXJEaXJlY3RDaGlsZHJlbiB9IGZyb20gJy4vZG9tLTE5OTdiZmFmLmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdEZsb2F0aW5nVUksIGIgYXMgZGVmYXVsdE9mZnNldERpc3RhbmNlLCB1IGFzIHVwZGF0ZUFmdGVyQ2xvc2UsIGEgYXMgZGlzY29ubmVjdEZsb2F0aW5nVUksIHIgYXMgcmVwb3NpdGlvbiwgRiBhcyBGbG9hdGluZ0NTUyB9IGZyb20gJy4vZmxvYXRpbmctdWktMGY5OGZjNTMuanMnO1xuaW1wb3J0IHsgZyBhcyBndWlkIH0gZnJvbSAnLi9ndWlkLTg4YTM3MjlmLmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdE9wZW5DbG9zZUNvbXBvbmVudCwgZCBhcyBkaXNjb25uZWN0T3BlbkNsb3NlQ29tcG9uZW50LCBvIGFzIG9uVG9nZ2xlT3BlbkNsb3NlQ29tcG9uZW50IH0gZnJvbSAnLi9vcGVuQ2xvc2VDb21wb25lbnQtN2Q1ODgzNGMuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50LCBkIGFzIGRpc2Nvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQgfSBmcm9tICcuL2NvbmRpdGlvbmFsU2xvdC1hNDgzN2NhZi5qcyc7XG5pbXBvcnQgeyB1IGFzIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbiB9IGZyb20gJy4vaW50ZXJhY3RpdmUtMjk5OTU1MjIuanMnO1xuaW1wb3J0IHsgQyBhcyBDU1NfVVRJTElUWSB9IGZyb20gJy4vcmVzb3VyY2VzLTQ4NDM2ZWVhLmpzJztcbmltcG9ydCAnLi9pbmRleC5lc20tNjdmMGYyNWEuanMnO1xuaW1wb3J0ICcuL2RlYm91bmNlLTA0N2UwOWY0LmpzJztcbmltcG9ydCAnLi9vYnNlcnZlcnMtNTY3NDBlOTkuanMnO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuY29uc3QgQ1NTJDEgPSB7XG4gIGNvbnRhaW5lcjogXCJjb250YWluZXJcIixcbiAgYXJyb3c6IFwiYXJyb3dcIlxufTtcbmNvbnN0IFRPT0xUSVBfREVMQVlfTVMgPSA1MDA7XG5jb25zdCBBUklBX0RFU0NSSUJFRF9CWSA9IFwiYXJpYS1kZXNjcmliZWRieVwiO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuZnVuY3Rpb24gZ2V0RWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCh0b29sdGlwKSB7XG4gIGNvbnN0IHsgcmVmZXJlbmNlRWxlbWVudCB9ID0gdG9vbHRpcDtcbiAgcmV0dXJuICgodHlwZW9mIHJlZmVyZW5jZUVsZW1lbnQgPT09IFwic3RyaW5nXCIgPyBxdWVyeUVsZW1lbnRSb290cyh0b29sdGlwLCB7IGlkOiByZWZlcmVuY2VFbGVtZW50IH0pIDogcmVmZXJlbmNlRWxlbWVudCkgfHxcbiAgICBudWxsKTtcbn1cblxuLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtY29tcG9uZW50cy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuMC41XG4gKi9cbmNsYXNzIFRvb2x0aXBNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIFByb3BlcnRpZXNcbiAgICAvL1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdGhpcy5yZWdpc3RlcmVkRWxlbWVudHMgPSBuZXcgV2Vha01hcCgpO1xuICAgIHRoaXMuaG92ZXJUaW1lb3V0ID0gbnVsbDtcbiAgICB0aGlzLnJlZ2lzdGVyZWRFbGVtZW50Q291bnQgPSAwO1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMucXVlcnlUb29sdGlwID0gKGNvbXBvc2VkUGF0aCkgPT4ge1xuICAgICAgY29uc3QgeyByZWdpc3RlcmVkRWxlbWVudHMgfSA9IHRoaXM7XG4gICAgICBjb25zdCByZWdpc3RlcmVkRWxlbWVudCA9IGNvbXBvc2VkUGF0aC5maW5kKChwYXRoRWwpID0+IHJlZ2lzdGVyZWRFbGVtZW50cy5oYXMocGF0aEVsKSk7XG4gICAgICByZXR1cm4gcmVnaXN0ZXJlZEVsZW1lbnRzLmdldChyZWdpc3RlcmVkRWxlbWVudCk7XG4gICAgfTtcbiAgICB0aGlzLmtleURvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiICYmICFldmVudC5kZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICAgIGNvbnN0IHsgYWN0aXZlVG9vbHRpcEVsIH0gPSB0aGlzO1xuICAgICAgICBpZiAoYWN0aXZlVG9vbHRpcEVsICYmIGFjdGl2ZVRvb2x0aXBFbC5vcGVuKSB7XG4gICAgICAgICAgdGhpcy5jbGVhckhvdmVyVGltZW91dCgpO1xuICAgICAgICAgIHRoaXMudG9nZ2xlVG9vbHRpcChhY3RpdmVUb29sdGlwRWwsIGZhbHNlKTtcbiAgICAgICAgICBjb25zdCByZWZlcmVuY2VFbGVtZW50ID0gZ2V0RWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudChhY3RpdmVUb29sdGlwRWwpO1xuICAgICAgICAgIGlmIChyZWZlcmVuY2VFbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCAmJiByZWZlcmVuY2VFbGVtZW50LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnF1ZXJ5SG92ZXJlZFRvb2x0aXAgPSAoY29tcG9zZWRQYXRoKSA9PiB7XG4gICAgICBjb25zdCB7IGFjdGl2ZVRvb2x0aXBFbCB9ID0gdGhpcztcbiAgICAgIGlmIChhY3RpdmVUb29sdGlwRWwgJiYgY29tcG9zZWRQYXRoLmluY2x1ZGVzKGFjdGl2ZVRvb2x0aXBFbCkpIHtcbiAgICAgICAgdGhpcy5jbGVhckhvdmVyVGltZW91dCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB0b29sdGlwID0gdGhpcy5xdWVyeVRvb2x0aXAoY29tcG9zZWRQYXRoKTtcbiAgICAgIGlmICh0b29sdGlwKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlSG92ZXJlZFRvb2x0aXAodG9vbHRpcCwgdHJ1ZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChhY3RpdmVUb29sdGlwRWwpIHtcbiAgICAgICAgdGhpcy50b2dnbGVIb3ZlcmVkVG9vbHRpcChhY3RpdmVUb29sdGlwRWwsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMucG9pbnRlck1vdmVIYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBjb21wb3NlZFBhdGggPSBldmVudC5jb21wb3NlZFBhdGgoKTtcbiAgICAgIHRoaXMuY2xlYXJIb3ZlclRpbWVvdXQoKTtcbiAgICAgIHRoaXMuaG92ZXJUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5xdWVyeUhvdmVyZWRUb29sdGlwKGNvbXBvc2VkUGF0aCksIFRPT0xUSVBfREVMQVlfTVMgKTtcbiAgICB9O1xuICAgIHRoaXMucG9pbnRlckRvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIWlzUHJpbWFyeVBvaW50ZXJCdXR0b24oZXZlbnQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNsaWNrZWRUb29sdGlwID0gdGhpcy5xdWVyeVRvb2x0aXAoZXZlbnQuY29tcG9zZWRQYXRoKCkpO1xuICAgICAgdGhpcy5jbGlja2VkVG9vbHRpcCA9IGNsaWNrZWRUb29sdGlwO1xuICAgICAgaWYgKGNsaWNrZWRUb29sdGlwPy5jbG9zZU9uQ2xpY2spIHtcbiAgICAgICAgdGhpcy50b2dnbGVUb29sdGlwKGNsaWNrZWRUb29sdGlwLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuY2xlYXJIb3ZlclRpbWVvdXQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuZm9jdXNJbkhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMucXVlcnlGb2N1c2VkVG9vbHRpcChldmVudCwgdHJ1ZSk7XG4gICAgfTtcbiAgICB0aGlzLmZvY3VzT3V0SGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5xdWVyeUZvY3VzZWRUb29sdGlwKGV2ZW50LCBmYWxzZSk7XG4gICAgfTtcbiAgICB0aGlzLnRvZ2dsZUhvdmVyZWRUb29sdGlwID0gKHRvb2x0aXAsIHZhbHVlKSA9PiB7XG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5jbG9zZUV4aXN0aW5nVG9vbHRpcCgpO1xuICAgICAgfVxuICAgICAgdGhpcy50b2dnbGVUb29sdGlwKHRvb2x0aXAsIHZhbHVlKTtcbiAgICB9O1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQdWJsaWMgTWV0aG9kc1xuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICByZWdpc3RlckVsZW1lbnQocmVmZXJlbmNlRWwsIHRvb2x0aXApIHtcbiAgICB0aGlzLnJlZ2lzdGVyZWRFbGVtZW50Q291bnQrKztcbiAgICB0aGlzLnJlZ2lzdGVyZWRFbGVtZW50cy5zZXQocmVmZXJlbmNlRWwsIHRvb2x0aXApO1xuICAgIGlmICh0aGlzLnJlZ2lzdGVyZWRFbGVtZW50Q291bnQgPT09IDEpIHtcbiAgICAgIHRoaXMuYWRkTGlzdGVuZXJzKCk7XG4gICAgfVxuICB9XG4gIHVucmVnaXN0ZXJFbGVtZW50KHJlZmVyZW5jZUVsKSB7XG4gICAgaWYgKHRoaXMucmVnaXN0ZXJlZEVsZW1lbnRzLmRlbGV0ZShyZWZlcmVuY2VFbCkpIHtcbiAgICAgIHRoaXMucmVnaXN0ZXJlZEVsZW1lbnRDb3VudC0tO1xuICAgIH1cbiAgICBpZiAodGhpcy5yZWdpc3RlcmVkRWxlbWVudENvdW50ID09PSAwKSB7XG4gICAgICB0aGlzLnJlbW92ZUxpc3RlbmVycygpO1xuICAgIH1cbiAgfVxuICBhZGRMaXN0ZW5lcnMoKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5rZXlEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLnBvaW50ZXJNb3ZlSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCB0aGlzLnBvaW50ZXJEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c2luXCIsIHRoaXMuZm9jdXNJbkhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgdGhpcy5mb2N1c091dEhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgfVxuICByZW1vdmVMaXN0ZW5lcnMoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5rZXlEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLnBvaW50ZXJNb3ZlSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCB0aGlzLnBvaW50ZXJEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c2luXCIsIHRoaXMuZm9jdXNJbkhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgdGhpcy5mb2N1c091dEhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgfVxuICBjbGVhckhvdmVyVGltZW91dCgpIHtcbiAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuaG92ZXJUaW1lb3V0KTtcbiAgfVxuICBjbG9zZUV4aXN0aW5nVG9vbHRpcCgpIHtcbiAgICBjb25zdCB7IGFjdGl2ZVRvb2x0aXBFbCB9ID0gdGhpcztcbiAgICBpZiAoYWN0aXZlVG9vbHRpcEVsKSB7XG4gICAgICB0aGlzLnRvZ2dsZVRvb2x0aXAoYWN0aXZlVG9vbHRpcEVsLCBmYWxzZSk7XG4gICAgfVxuICB9XG4gIHRvZ2dsZUZvY3VzZWRUb29sdGlwKHRvb2x0aXAsIHZhbHVlKSB7XG4gICAgdGhpcy5jbG9zZUV4aXN0aW5nVG9vbHRpcCgpO1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5jbGVhckhvdmVyVGltZW91dCgpO1xuICAgIH1cbiAgICB0aGlzLnRvZ2dsZVRvb2x0aXAodG9vbHRpcCwgdmFsdWUpO1xuICB9XG4gIHRvZ2dsZVRvb2x0aXAodG9vbHRpcCwgdmFsdWUpIHtcbiAgICB0b29sdGlwLm9wZW4gPSB2YWx1ZTtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuYWN0aXZlVG9vbHRpcEVsID0gdG9vbHRpcDtcbiAgICB9XG4gIH1cbiAgcXVlcnlGb2N1c2VkVG9vbHRpcChldmVudCwgdmFsdWUpIHtcbiAgICBjb25zdCB0b29sdGlwID0gdGhpcy5xdWVyeVRvb2x0aXAoZXZlbnQuY29tcG9zZWRQYXRoKCkpO1xuICAgIGlmICghdG9vbHRpcCB8fCB0b29sdGlwID09PSB0aGlzLmNsaWNrZWRUb29sdGlwKSB7XG4gICAgICB0aGlzLmNsaWNrZWRUb29sdGlwID0gbnVsbDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy50b2dnbGVGb2N1c2VkVG9vbHRpcCh0b29sdGlwLCB2YWx1ZSk7XG4gIH1cbn1cblxuY29uc3QgdG9vbHRpcENzcyA9IFwiQGtleWZyYW1lcyBpbnswJXtvcGFjaXR5OjB9MTAwJXtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgaW4tZG93bnswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIC01cHgsIDApfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAwLCAwKX19QGtleWZyYW1lcyBpbi11cHswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDVweCwgMCl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDAsIDApfX1Aa2V5ZnJhbWVzIGluLXNjYWxlezAle29wYWNpdHk6MDt0cmFuc2Zvcm06c2NhbGUzRCgwLjk1LCAwLjk1LCAxKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06c2NhbGUzRCgxLCAxLCAxKX19OnJvb3R7LS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmc6Y2FsYygxNTBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3Rvcjp2YXIoLS1jYWxjaXRlLWR1cmF0aW9uLWZhY3RvciwgMSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctZmFzdDpjYWxjKDEwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKTstLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1tZWRpdW06Y2FsYygyMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctc2xvdzpjYWxjKDMwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKX0uY2FsY2l0ZS1hbmltYXRle29wYWNpdHk6MDthbmltYXRpb24tZmlsbC1tb2RlOmJvdGg7YW5pbWF0aW9uLWR1cmF0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyl9LmNhbGNpdGUtYW5pbWF0ZV9faW57YW5pbWF0aW9uLW5hbWU6aW59LmNhbGNpdGUtYW5pbWF0ZV9faW4tZG93bnthbmltYXRpb24tbmFtZTppbi1kb3dufS5jYWxjaXRlLWFuaW1hdGVfX2luLXVwe2FuaW1hdGlvbi1uYW1lOmluLXVwfS5jYWxjaXRlLWFuaW1hdGVfX2luLXNjYWxle2FuaW1hdGlvbi1uYW1lOmluLXNjYWxlfUBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKXs6cm9vdHstLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yOjB9fTpyb290ey0tY2FsY2l0ZS1mbG9hdGluZy11aS10cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyk7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXotaW5kZXg6NjAwfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9Omhvc3R7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXotaW5kZXg6dmFyKC0tY2FsY2l0ZS10b29sdGlwLXotaW5kZXgsIDkwMSk7ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OnZhcigtLWNhbGNpdGUtZmxvYXRpbmctdWktei1pbmRleCl9LmNhbGNpdGUtZmxvYXRpbmctdWktYW5pbXtwb3NpdGlvbjpyZWxhdGl2ZTt0cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtZmxvYXRpbmctdWktdHJhbnNpdGlvbik7dHJhbnNpdGlvbi1wcm9wZXJ0eTp0cmFuc2Zvcm0sIHZpc2liaWxpdHksIG9wYWNpdHk7b3BhY2l0eTowO2JveC1zaGFkb3c6MCAwIDE2cHggMCByZ2JhKDAsIDAsIDAsIDAuMTYpO3otaW5kZXg6MTtib3JkZXItcmFkaXVzOjAuMjVyZW19Omhvc3QoW2RhdGEtcGxhY2VtZW50Xj1ib3R0b21dKSAuY2FsY2l0ZS1mbG9hdGluZy11aS1hbmlte3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01cHgpfTpob3N0KFtkYXRhLXBsYWNlbWVudF49dG9wXSkgLmNhbGNpdGUtZmxvYXRpbmctdWktYW5pbXt0cmFuc2Zvcm06dHJhbnNsYXRlWSg1cHgpfTpob3N0KFtkYXRhLXBsYWNlbWVudF49bGVmdF0pIC5jYWxjaXRlLWZsb2F0aW5nLXVpLWFuaW17dHJhbnNmb3JtOnRyYW5zbGF0ZVgoNXB4KX06aG9zdChbZGF0YS1wbGFjZW1lbnRePXJpZ2h0XSkgLmNhbGNpdGUtZmxvYXRpbmctdWktYW5pbXt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNXB4KX06aG9zdChbZGF0YS1wbGFjZW1lbnRdKSAuY2FsY2l0ZS1mbG9hdGluZy11aS1hbmltLS1hY3RpdmV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUoMCl9Omhvc3QoW2NhbGNpdGUtaHlkcmF0ZWQtaGlkZGVuXSl7dmlzaWJpbGl0eTpoaWRkZW4gIWltcG9ydGFudDtwb2ludGVyLWV2ZW50czpub25lfS5hcnJvdywuYXJyb3c6OmJlZm9yZXtwb3NpdGlvbjphYnNvbHV0ZTtpbmxpbmUtc2l6ZTo4cHg7YmxvY2stc2l6ZTo4cHg7ei1pbmRleDotMX0uYXJyb3c6OmJlZm9yZXtjb250ZW50OlxcXCJcXFwiOy0tdHctc2hhZG93OjAgNHB4IDhweCAtMXB4IHJnYmEoMCwgMCwgMCwgMC4wOCksIDAgMnB4IDRweCAtMXB4IHJnYmEoMCwgMCwgMCwgMC4wNCk7LS10dy1zaGFkb3ctY29sb3JlZDowIDRweCA4cHggLTFweCB2YXIoLS10dy1zaGFkb3ctY29sb3IpLCAwIDJweCA0cHggLTFweCB2YXIoLS10dy1zaGFkb3ctY29sb3IpO2JveC1zaGFkb3c6dmFyKC0tdHctcmluZy1vZmZzZXQtc2hhZG93LCAwIDAgIzAwMDApLCB2YXIoLS10dy1yaW5nLXNoYWRvdywgMCAwICMwMDAwKSwgdmFyKC0tdHctc2hhZG93KTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKTtiYWNrZ3JvdW5kOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKX06aG9zdChbZGF0YS1wbGFjZW1lbnRePXRvcF0pIC5hcnJvd3tpbnNldC1ibG9jay1lbmQ6LTRweH06aG9zdChbZGF0YS1wbGFjZW1lbnRePWJvdHRvbV0pIC5hcnJvd3tpbnNldC1ibG9jay1zdGFydDotNHB4fTpob3N0KFtkYXRhLXBsYWNlbWVudF49cmlnaHRdKSAuYXJyb3csOmhvc3QoW2RhdGEtcGxhY2VtZW50Xj1sZWZ0XSkgLmFycm93e2RpcmVjdGlvbjpsdHI7dGV4dC1hbGlnbjpzdGFydH06aG9zdChbZGF0YS1wbGFjZW1lbnRePWxlZnRdKSAuYXJyb3d7aW5zZXQtaW5saW5lLWVuZDotNHB4fTpob3N0KFtkYXRhLXBsYWNlbWVudF49cmlnaHRdKSAuYXJyb3d7aW5zZXQtaW5saW5lLXN0YXJ0Oi00cHh9LmNvbnRhaW5lcntwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW47Ym9yZGVyLXJhZGl1czowLjI1cmVtO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1mb3JlZ3JvdW5kLTEpO3BhZGRpbmctYmxvY2s6MC43NXJlbTtwYWRkaW5nLWlubGluZToxcmVtO2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMik7bGluZS1oZWlnaHQ6MS4zNzU7Zm9udC13ZWlnaHQ6dmFyKC0tY2FsY2l0ZS1mb250LXdlaWdodC1tZWRpdW0pO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0xKTttYXgtaW5saW5lLXNpemU6MjByZW07bWF4LWJsb2NrLXNpemU6MjByZW07dGV4dC1hbGlnbjpzdGFydH0uY2FsY2l0ZS1mbG9hdGluZy11aS1hbmlte2JvcmRlci1yYWRpdXM6MC4yNXJlbTtib3JkZXItd2lkdGg6MXB4O2JvcmRlci1zdHlsZTpzb2xpZDtib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMyk7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWZvcmVncm91bmQtMSl9LmFycm93OjpiZWZvcmV7b3V0bGluZToxcHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMyl9XCI7XG5cbmNvbnN0IG1hbmFnZXIgPSBuZXcgVG9vbHRpcE1hbmFnZXIoKTtcbmNvbnN0IFRvb2x0aXAgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgIHRoaXMuY2FsY2l0ZVRvb2x0aXBCZWZvcmVDbG9zZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZVRvb2x0aXBCZWZvcmVDbG9zZVwiLCA2KTtcbiAgICB0aGlzLmNhbGNpdGVUb29sdGlwQ2xvc2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVUb29sdGlwQ2xvc2VcIiwgNik7XG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcEJlZm9yZU9wZW4gPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVUb29sdGlwQmVmb3JlT3BlblwiLCA2KTtcbiAgICB0aGlzLmNhbGNpdGVUb29sdGlwT3BlbiA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZVRvb2x0aXBPcGVuXCIsIDYpO1xuICAgIHRoaXMuZ3VpZCA9IGBjYWxjaXRlLXRvb2x0aXAtJHtndWlkKCl9YDtcbiAgICB0aGlzLmhhc0xvYWRlZCA9IGZhbHNlO1xuICAgIHRoaXMub3BlblRyYW5zaXRpb25Qcm9wID0gXCJvcGFjaXR5XCI7XG4gICAgdGhpcy5zZXRUcmFuc2l0aW9uRWwgPSAoZWwpID0+IHtcbiAgICAgIHRoaXMudHJhbnNpdGlvbkVsID0gZWw7XG4gICAgICBjb25uZWN0T3BlbkNsb3NlQ29tcG9uZW50KHRoaXMpO1xuICAgIH07XG4gICAgdGhpcy5zZXRVcFJlZmVyZW5jZUVsZW1lbnQgPSAod2FybiA9IHRydWUpID0+IHtcbiAgICAgIHRoaXMucmVtb3ZlUmVmZXJlbmNlcygpO1xuICAgICAgdGhpcy5lZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50ID0gZ2V0RWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCh0aGlzLmVsKTtcbiAgICAgIGNvbm5lY3RGbG9hdGluZ1VJKHRoaXMsIHRoaXMuZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCwgdGhpcy5lbCk7XG4gICAgICBjb25zdCB7IGVsLCByZWZlcmVuY2VFbGVtZW50LCBlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50IH0gPSB0aGlzO1xuICAgICAgaWYgKHdhcm4gJiYgcmVmZXJlbmNlRWxlbWVudCAmJiAhZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCkge1xuICAgICAgICBjb25zb2xlLndhcm4oYCR7ZWwudGFnTmFtZX06IHJlZmVyZW5jZS1lbGVtZW50IGlkIFwiJHtyZWZlcmVuY2VFbGVtZW50fVwiIHdhcyBub3QgZm91bmQuYCwge1xuICAgICAgICAgIGVsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy5hZGRSZWZlcmVuY2VzKCk7XG4gICAgfTtcbiAgICB0aGlzLmdldElkID0gKCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuZWwuaWQgfHwgdGhpcy5ndWlkO1xuICAgIH07XG4gICAgdGhpcy5hZGRSZWZlcmVuY2VzID0gKCkgPT4ge1xuICAgICAgY29uc3QgeyBlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50IH0gPSB0aGlzO1xuICAgICAgaWYgKCFlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRJZCgpO1xuICAgICAgaWYgKFwic2V0QXR0cmlidXRlXCIgaW4gZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCkge1xuICAgICAgICBlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50LnNldEF0dHJpYnV0ZShBUklBX0RFU0NSSUJFRF9CWSwgaWQpO1xuICAgICAgfVxuICAgICAgbWFuYWdlci5yZWdpc3RlckVsZW1lbnQoZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCwgdGhpcy5lbCk7XG4gICAgfTtcbiAgICB0aGlzLnJlbW92ZVJlZmVyZW5jZXMgPSAoKSA9PiB7XG4gICAgICBjb25zdCB7IGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQgfSA9IHRoaXM7XG4gICAgICBpZiAoIWVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKFwicmVtb3ZlQXR0cmlidXRlXCIgaW4gZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCkge1xuICAgICAgICBlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShBUklBX0RFU0NSSUJFRF9CWSk7XG4gICAgICB9XG4gICAgICBtYW5hZ2VyLnVucmVnaXN0ZXJFbGVtZW50KGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQpO1xuICAgIH07XG4gICAgdGhpcy5jbG9zZU9uQ2xpY2sgPSBmYWxzZTtcbiAgICB0aGlzLmxhYmVsID0gdW5kZWZpbmVkO1xuICAgIHRoaXMub2Zmc2V0RGlzdGFuY2UgPSBkZWZhdWx0T2Zmc2V0RGlzdGFuY2U7XG4gICAgdGhpcy5vZmZzZXRTa2lkZGluZyA9IDA7XG4gICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgdGhpcy5vdmVybGF5UG9zaXRpb25pbmcgPSBcImFic29sdXRlXCI7XG4gICAgdGhpcy5wbGFjZW1lbnQgPSBcImF1dG9cIjtcbiAgICB0aGlzLnJlZmVyZW5jZUVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5lZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50ID0gdW5kZWZpbmVkO1xuICB9XG4gIG9mZnNldERpc3RhbmNlT2Zmc2V0SGFuZGxlcigpIHtcbiAgICB0aGlzLnJlcG9zaXRpb24odHJ1ZSk7XG4gIH1cbiAgb2Zmc2V0U2tpZGRpbmdIYW5kbGVyKCkge1xuICAgIHRoaXMucmVwb3NpdGlvbih0cnVlKTtcbiAgfVxuICBvcGVuSGFuZGxlcih2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5yZXBvc2l0aW9uKHRydWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHVwZGF0ZUFmdGVyQ2xvc2UodGhpcy5lbCk7XG4gICAgfVxuICB9XG4gIG92ZXJsYXlQb3NpdGlvbmluZ0hhbmRsZXIoKSB7XG4gICAgdGhpcy5yZXBvc2l0aW9uKHRydWUpO1xuICB9XG4gIHBsYWNlbWVudEhhbmRsZXIoKSB7XG4gICAgdGhpcy5yZXBvc2l0aW9uKHRydWUpO1xuICB9XG4gIHJlZmVyZW5jZUVsZW1lbnRIYW5kbGVyKCkge1xuICAgIHRoaXMuc2V0VXBSZWZlcmVuY2VFbGVtZW50KCk7XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIExpZmVjeWNsZVxuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBjb25uZWN0T3BlbkNsb3NlQ29tcG9uZW50KHRoaXMpO1xuICAgIHRoaXMuc2V0VXBSZWZlcmVuY2VFbGVtZW50KHRoaXMuaGFzTG9hZGVkKTtcbiAgfVxuICBjb21wb25lbnREaWRMb2FkKCkge1xuICAgIGlmICh0aGlzLnJlZmVyZW5jZUVsZW1lbnQgJiYgIXRoaXMuZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCkge1xuICAgICAgdGhpcy5zZXRVcFJlZmVyZW5jZUVsZW1lbnQoKTtcbiAgICB9XG4gICAgdGhpcy5yZXBvc2l0aW9uKHRydWUpO1xuICAgIHRoaXMuaGFzTG9hZGVkID0gdHJ1ZTtcbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLnJlbW92ZVJlZmVyZW5jZXMoKTtcbiAgICBkaXNjb25uZWN0RmxvYXRpbmdVSSh0aGlzLCB0aGlzLmVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQsIHRoaXMuZWwpO1xuICAgIGRpc2Nvbm5lY3RPcGVuQ2xvc2VDb21wb25lbnQodGhpcyk7XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFB1YmxpYyBNZXRob2RzXG4gIC8vXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBwb3NpdGlvbiBvZiB0aGUgY29tcG9uZW50LlxuICAgKlxuICAgKiBAcGFyYW0gZGVsYXllZFxuICAgKi9cbiAgYXN5bmMgcmVwb3NpdGlvbihkZWxheWVkID0gZmFsc2UpIHtcbiAgICBjb25zdCB7IGVsLCBlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50LCBwbGFjZW1lbnQsIG92ZXJsYXlQb3NpdGlvbmluZywgb2Zmc2V0RGlzdGFuY2UsIG9mZnNldFNraWRkaW5nLCBhcnJvd0VsIH0gPSB0aGlzO1xuICAgIHJldHVybiByZXBvc2l0aW9uKHRoaXMsIHtcbiAgICAgIGZsb2F0aW5nRWw6IGVsLFxuICAgICAgcmVmZXJlbmNlRWw6IGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQsXG4gICAgICBvdmVybGF5UG9zaXRpb25pbmcsXG4gICAgICBwbGFjZW1lbnQsXG4gICAgICBvZmZzZXREaXN0YW5jZSxcbiAgICAgIG9mZnNldFNraWRkaW5nLFxuICAgICAgaW5jbHVkZUFycm93OiB0cnVlLFxuICAgICAgYXJyb3dFbCxcbiAgICAgIHR5cGU6IFwidG9vbHRpcFwiXG4gICAgfSwgZGVsYXllZCk7XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBvbkJlZm9yZU9wZW4oKSB7XG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcEJlZm9yZU9wZW4uZW1pdCgpO1xuICB9XG4gIG9uT3BlbigpIHtcbiAgICB0aGlzLmNhbGNpdGVUb29sdGlwT3Blbi5lbWl0KCk7XG4gIH1cbiAgb25CZWZvcmVDbG9zZSgpIHtcbiAgICB0aGlzLmNhbGNpdGVUb29sdGlwQmVmb3JlQ2xvc2UuZW1pdCgpO1xuICB9XG4gIG9uQ2xvc2UoKSB7XG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcENsb3NlLmVtaXQoKTtcbiAgfVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUmVuZGVyIE1ldGhvZHNcbiAgLy9cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCwgbGFiZWwsIG9wZW4gfSA9IHRoaXM7XG4gICAgY29uc3QgZGlzcGxheWVkID0gZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCAmJiBvcGVuO1xuICAgIGNvbnN0IGhpZGRlbiA9ICFkaXNwbGF5ZWQ7XG4gICAgcmV0dXJuIChoKEhvc3QsIHsgXCJhcmlhLWhpZGRlblwiOiB0b0FyaWFCb29sZWFuKGhpZGRlbiksIFwiYXJpYS1sYWJlbFwiOiBsYWJlbCwgXCJhcmlhLWxpdmVcIjogXCJwb2xpdGVcIiwgXCJjYWxjaXRlLWh5ZHJhdGVkLWhpZGRlblwiOiBoaWRkZW4sIGlkOiB0aGlzLmdldElkKCksIHJvbGU6IFwidG9vbHRpcFwiIH0sIGgoXCJkaXZcIiwgeyBjbGFzczoge1xuICAgICAgICBbRmxvYXRpbmdDU1MuYW5pbWF0aW9uXTogdHJ1ZSxcbiAgICAgICAgW0Zsb2F0aW5nQ1NTLmFuaW1hdGlvbkFjdGl2ZV06IGRpc3BsYXllZFxuICAgICAgfSwgcmVmOiB0aGlzLnNldFRyYW5zaXRpb25FbCB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IENTUyQxLmFycm93LCByZWY6IChhcnJvd0VsKSA9PiAodGhpcy5hcnJvd0VsID0gYXJyb3dFbCkgfSksIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTJDEuY29udGFpbmVyIH0sIGgoXCJzbG90XCIsIG51bGwpKSkpKTtcbiAgfVxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgXCJvZmZzZXREaXN0YW5jZVwiOiBbXCJvZmZzZXREaXN0YW5jZU9mZnNldEhhbmRsZXJcIl0sXG4gICAgXCJvZmZzZXRTa2lkZGluZ1wiOiBbXCJvZmZzZXRTa2lkZGluZ0hhbmRsZXJcIl0sXG4gICAgXCJvcGVuXCI6IFtcIm9wZW5IYW5kbGVyXCJdLFxuICAgIFwib3ZlcmxheVBvc2l0aW9uaW5nXCI6IFtcIm92ZXJsYXlQb3NpdGlvbmluZ0hhbmRsZXJcIl0sXG4gICAgXCJwbGFjZW1lbnRcIjogW1wicGxhY2VtZW50SGFuZGxlclwiXSxcbiAgICBcInJlZmVyZW5jZUVsZW1lbnRcIjogW1wicmVmZXJlbmNlRWxlbWVudEhhbmRsZXJcIl1cbiAgfTsgfVxufTtcblRvb2x0aXAuc3R5bGUgPSB0b29sdGlwQ3NzO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuZnVuY3Rpb24gaXNUcmVlSXRlbShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50Py5tYXRjaGVzKFwiY2FsY2l0ZS10cmVlLWl0ZW1cIik7XG59XG5mdW5jdGlvbiBnZXRFbmFibGVkU2libGluZ0l0ZW0oZWwsIGRpcmVjdGlvbikge1xuICBjb25zdCBkaXJlY3Rpb25Qcm9wID0gZGlyZWN0aW9uID09PSBcImRvd25cIiA/IFwibmV4dEVsZW1lbnRTaWJsaW5nXCIgOiBcInByZXZpb3VzRWxlbWVudFNpYmxpbmdcIjtcbiAgbGV0IGN1cnJlbnRFbCA9IGVsO1xuICBsZXQgZW5hYmxlZEVsID0gbnVsbDtcbiAgd2hpbGUgKGlzVHJlZUl0ZW0oY3VycmVudEVsKSkge1xuICAgIGlmICghY3VycmVudEVsLmRpc2FibGVkKSB7XG4gICAgICBlbmFibGVkRWwgPSBjdXJyZW50RWw7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgY3VycmVudEVsID0gY3VycmVudEVsW2RpcmVjdGlvblByb3BdO1xuICB9XG4gIHJldHVybiBlbmFibGVkRWw7XG59XG5cbmNvbnN0IHRyZWVDc3MgPSBcIkBrZXlmcmFtZXMgaW57MCV7b3BhY2l0eTowfTEwMCV7b3BhY2l0eToxfX1Aa2V5ZnJhbWVzIGluLWRvd257MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAtNXB4LCAwKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlM0QoMCwgMCwgMCl9fUBrZXlmcmFtZXMgaW4tdXB7MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCA1cHgsIDApfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAwLCAwKX19QGtleWZyYW1lcyBpbi1zY2FsZXswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnNjYWxlM0QoMC45NSwgMC45NSwgMSl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnNjYWxlM0QoMSwgMSwgMSl9fTpyb290ey0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nOmNhbGMoMTUwbXMgKiB2YXIoLS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcikpOy0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3I6dmFyKC0tY2FsY2l0ZS1kdXJhdGlvbi1mYWN0b3IsIDEpOy0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLWZhc3Q6Y2FsYygxMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctbWVkaXVtOmNhbGMoMjAwbXMgKiB2YXIoLS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcikpOy0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3c6Y2FsYygzMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSl9LmNhbGNpdGUtYW5pbWF0ZXtvcGFjaXR5OjA7YW5pbWF0aW9uLWZpbGwtbW9kZTpib3RoO2FuaW1hdGlvbi1kdXJhdGlvbjp2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpfS5jYWxjaXRlLWFuaW1hdGVfX2lue2FuaW1hdGlvbi1uYW1lOmlufS5jYWxjaXRlLWFuaW1hdGVfX2luLWRvd257YW5pbWF0aW9uLW5hbWU6aW4tZG93bn0uY2FsY2l0ZS1hbmltYXRlX19pbi11cHthbmltYXRpb24tbmFtZTppbi11cH0uY2FsY2l0ZS1hbmltYXRlX19pbi1zY2FsZXthbmltYXRpb24tbmFtZTppbi1zY2FsZX1AbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSl7OnJvb3R7LS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcjowfX06cm9vdHstLWNhbGNpdGUtZmxvYXRpbmctdWktdHJhbnNpdGlvbjp2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpOy0tY2FsY2l0ZS1mbG9hdGluZy11aS16LWluZGV4OjYwMH06aG9zdChbaGlkZGVuXSl7ZGlzcGxheTpub25lfTpob3N0e2Rpc3BsYXk6YmxvY2t9Omhvc3QoOmZvY3VzKXtvdXRsaW5lOjJweCBzb2xpZCB0cmFuc3BhcmVudDtvdXRsaW5lLW9mZnNldDoycHh9XCI7XG5cbmNvbnN0IFRyZWUgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgIHRoaXMuY2FsY2l0ZVRyZWVTZWxlY3QgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVUcmVlU2VsZWN0XCIsIDYpO1xuICAgIHRoaXMubGluZXMgPSBmYWxzZTtcbiAgICB0aGlzLmNoaWxkID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2NhbGUgPSBcIm1cIjtcbiAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPSBcInNpbmdsZVwiO1xuICAgIHRoaXMuc2VsZWN0ZWRJdGVtcyA9IFtdO1xuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIExpZmVjeWNsZVxuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGNvbXBvbmVudFdpbGxSZW5kZXIoKSB7XG4gICAgY29uc3QgcGFyZW50ID0gdGhpcy5lbC5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlXCIpO1xuICAgIHRoaXMubGluZXMgPSBwYXJlbnQgPyBwYXJlbnQubGluZXMgOiB0aGlzLmxpbmVzO1xuICAgIHRoaXMuc2NhbGUgPSBwYXJlbnQgPyBwYXJlbnQuc2NhbGUgOiB0aGlzLnNjYWxlO1xuICAgIHRoaXMuc2VsZWN0aW9uTW9kZSA9IHBhcmVudCA/IHBhcmVudC5zZWxlY3Rpb25Nb2RlIDogdGhpcy5zZWxlY3Rpb25Nb2RlO1xuICAgIHRoaXMuY2hpbGQgPSAhIXBhcmVudDtcbiAgfVxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChoKEhvc3QsIHsgXCJhcmlhLW11bHRpc2VsZWN0YWJsZVwiOiB0aGlzLmNoaWxkXG4gICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgIDogKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aXBsZVwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIpLnRvU3RyaW5nKCksIHJvbGU6ICF0aGlzLmNoaWxkID8gXCJ0cmVlXCIgOiB1bmRlZmluZWQsIHRhYkluZGV4OiB0aGlzLmdldFJvb3RUYWJJbmRleCgpIH0sIGgoXCJzbG90XCIsIG51bGwpKSk7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgRXZlbnQgTGlzdGVuZXJzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgb25Gb2N1cygpIHtcbiAgICBpZiAoIXRoaXMuY2hpbGQpIHtcbiAgICAgIGNvbnN0IGZvY3VzVGFyZ2V0ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiY2FsY2l0ZS10cmVlLWl0ZW1bc2VsZWN0ZWRdOm5vdChbZGlzYWJsZWRdKVwiKSB8fCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCJjYWxjaXRlLXRyZWUtaXRlbTpub3QoW2Rpc2FibGVkXSlcIik7XG4gICAgICBmb2N1c0VsZW1lbnQoZm9jdXNUYXJnZXQpO1xuICAgIH1cbiAgfVxuICBvbkZvY3VzSW4oZXZlbnQpIHtcbiAgICBjb25zdCBmb2N1c2VkRnJvbVJvb3RPck91dHNpZGVUcmVlID0gZXZlbnQucmVsYXRlZFRhcmdldCA9PT0gdGhpcy5lbCB8fCAhdGhpcy5lbC5jb250YWlucyhldmVudC5yZWxhdGVkVGFyZ2V0KTtcbiAgICBpZiAoZm9jdXNlZEZyb21Sb290T3JPdXRzaWRlVHJlZSkge1xuICAgICAgLy8gZ2l2ZXMgdXNlciB0aGUgYWJpbGl0eSB0byB0YWIgaW50byBleHRlcm5hbCBlbGVtZW50cyAobW9kaWZ5aW5nIHRhYmluZGV4IHByb3BlcnR5IHdpbGwgbm90IHdvcmsgaW4gZmlyZWZveClcbiAgICAgIHRoaXMuZWwucmVtb3ZlQXR0cmlidXRlKFwidGFiaW5kZXhcIik7XG4gICAgfVxuICB9XG4gIG9uRm9jdXNPdXQoZXZlbnQpIHtcbiAgICBjb25zdCB3aWxsRm9jdXNPdXRzaWRlVHJlZSA9ICF0aGlzLmVsLmNvbnRhaW5zKGV2ZW50LnJlbGF0ZWRUYXJnZXQpO1xuICAgIGlmICh3aWxsRm9jdXNPdXRzaWRlVHJlZSkge1xuICAgICAgdGhpcy5lbC50YWJJbmRleCA9IHRoaXMuZ2V0Um9vdFRhYkluZGV4KCk7XG4gICAgfVxuICB9XG4gIG9uQ2xpY2soZXZlbnQpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgY29uc3QgY2hpbGRJdGVtcyA9IG5vZGVMaXN0VG9BcnJheSh0YXJnZXQucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtXCIpKTtcbiAgICBpZiAodGhpcy5jaGlsZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuY2hpbGQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJhbmNlc3RvcnNcIiAmJiAhdGhpcy5jaGlsZCkge1xuICAgICAgdGhpcy51cGRhdGVBbmNlc3RvclRyZWUoZXZlbnQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc05vbmVTZWxlY3Rpb25Nb2RlID0gdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm5vbmVcIjtcbiAgICBjb25zdCBzaG91bGRTZWxlY3QgPSB0aGlzLnNlbGVjdGlvbk1vZGUgIT09IG51bGwgJiZcbiAgICAgICghdGFyZ2V0Lmhhc0NoaWxkcmVuIHx8XG4gICAgICAgICh0YXJnZXQuaGFzQ2hpbGRyZW4gJiZcbiAgICAgICAgICAodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImNoaWxkcmVuXCIgfHwgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpY2hpbGRyZW5cIikpKTtcbiAgICBjb25zdCBzaG91bGRNb2RpZnlUb0N1cnJlbnRTZWxlY3Rpb24gPSAhaXNOb25lU2VsZWN0aW9uTW9kZSAmJlxuICAgICAgZXZlbnQuZGV0YWlsLm1vZGlmeUN1cnJlbnRTZWxlY3Rpb24gJiZcbiAgICAgICh0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGlwbGVcIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiKTtcbiAgICBjb25zdCBzaG91bGRTZWxlY3RDaGlsZHJlbiA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIgfHwgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImNoaWxkcmVuXCI7XG4gICAgY29uc3Qgc2hvdWxkQ2xlYXJDdXJyZW50U2VsZWN0aW9uID0gIXNob3VsZE1vZGlmeVRvQ3VycmVudFNlbGVjdGlvbiAmJlxuICAgICAgKCgodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcInNpbmdsZVwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aXBsZVwiKSAmJlxuICAgICAgICBjaGlsZEl0ZW1zLmxlbmd0aCA8PSAwKSB8fFxuICAgICAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwiY2hpbGRyZW5cIiB8fFxuICAgICAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiKTtcbiAgICBjb25zdCBzaG91bGRFeHBhbmRUYXJnZXQgPSB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwiY2hpbGRyZW5cIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiO1xuICAgIGlmICghdGhpcy5jaGlsZCkge1xuICAgICAgY29uc3QgdGFyZ2V0SXRlbXMgPSBbXTtcbiAgICAgIGlmIChzaG91bGRTZWxlY3QpIHtcbiAgICAgICAgdGFyZ2V0SXRlbXMucHVzaCh0YXJnZXQpO1xuICAgICAgfVxuICAgICAgaWYgKHNob3VsZFNlbGVjdENoaWxkcmVuKSB7XG4gICAgICAgIGNoaWxkSXRlbXMuZm9yRWFjaCgodHJlZUl0ZW0pID0+IHtcbiAgICAgICAgICB0YXJnZXRJdGVtcy5wdXNoKHRyZWVJdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoc2hvdWxkQ2xlYXJDdXJyZW50U2VsZWN0aW9uKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSXRlbXMgPSBub2RlTGlzdFRvQXJyYXkodGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS10cmVlLWl0ZW1bc2VsZWN0ZWRdXCIpKTtcbiAgICAgICAgc2VsZWN0ZWRJdGVtcy5mb3JFYWNoKCh0cmVlSXRlbSkgPT4ge1xuICAgICAgICAgIGlmICghdGFyZ2V0SXRlbXMuaW5jbHVkZXModHJlZUl0ZW0pKSB7XG4gICAgICAgICAgICB0cmVlSXRlbS5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoc2hvdWxkRXhwYW5kVGFyZ2V0ICYmICFldmVudC5kZXRhaWwuZm9yY2VUb2dnbGUpIHtcbiAgICAgICAgdGFyZ2V0LmV4cGFuZGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChzaG91bGRNb2RpZnlUb0N1cnJlbnRTZWxlY3Rpb24pIHtcbiAgICAgICAgd2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgfVxuICAgICAgaWYgKChzaG91bGRNb2RpZnlUb0N1cnJlbnRTZWxlY3Rpb24gJiYgdGFyZ2V0LnNlbGVjdGVkKSB8fFxuICAgICAgICAoc2hvdWxkU2VsZWN0Q2hpbGRyZW4gJiYgZXZlbnQuZGV0YWlsLmZvcmNlVG9nZ2xlKSkge1xuICAgICAgICB0YXJnZXRJdGVtcy5mb3JFYWNoKCh0cmVlSXRlbSkgPT4ge1xuICAgICAgICAgIGlmICghdHJlZUl0ZW0uZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRyZWVJdGVtLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKCFpc05vbmVTZWxlY3Rpb25Nb2RlKSB7XG4gICAgICAgIHRhcmdldEl0ZW1zLmZvckVhY2goKHRyZWVJdGVtKSA9PiB7XG4gICAgICAgICAgaWYgKCF0cmVlSXRlbS5kaXNhYmxlZCkge1xuICAgICAgICAgICAgdHJlZUl0ZW0uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuc2VsZWN0ZWRJdGVtcyA9IGlzTm9uZVNlbGVjdGlvbk1vZGVcbiAgICAgID8gW3RhcmdldF1cbiAgICAgIDogbm9kZUxpc3RUb0FycmF5KHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtXCIpKS5maWx0ZXIoKGkpID0+IGkuc2VsZWN0ZWQpO1xuICAgIHRoaXMuY2FsY2l0ZVRyZWVTZWxlY3QuZW1pdCgpO1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICB9XG4gIGtleURvd25IYW5kbGVyKGV2ZW50KSB7XG4gICAgY29uc3Qgcm9vdCA9IHRoaXMuZWwuY2xvc2VzdChcImNhbGNpdGUtdHJlZTpub3QoW2NoaWxkXSlcIik7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIGlmICghKHJvb3QgPT09IHRoaXMuZWwgJiYgdGFyZ2V0LnRhZ05hbWUgPT09IFwiQ0FMQ0lURS1UUkVFLUlURU1cIiAmJiB0aGlzLmVsLmNvbnRhaW5zKHRhcmdldCkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dEb3duXCIpIHtcbiAgICAgIGNvbnN0IG5leHQgPSBnZXRFbmFibGVkU2libGluZ0l0ZW0odGFyZ2V0Lm5leHRFbGVtZW50U2libGluZywgXCJkb3duXCIpO1xuICAgICAgaWYgKG5leHQpIHtcbiAgICAgICAgbmV4dC5mb2N1cygpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93VXBcIikge1xuICAgICAgY29uc3QgcHJldmlvdXMgPSBnZXRFbmFibGVkU2libGluZ0l0ZW0odGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcsIFwidXBcIik7XG4gICAgICBpZiAocHJldmlvdXMpIHtcbiAgICAgICAgcHJldmlvdXMuZm9jdXMoKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd0xlZnRcIiAmJiAhdGFyZ2V0LmRpc2FibGVkKSB7XG4gICAgICAvLyBXaGVuIGZvY3VzIGlzIG9uIGFuIG9wZW4gbm9kZSwgY2xvc2VzIHRoZSBub2RlLlxuICAgICAgaWYgKHRhcmdldC5oYXNDaGlsZHJlbiAmJiB0YXJnZXQuZXhwYW5kZWQpIHtcbiAgICAgICAgdGFyZ2V0LmV4cGFuZGVkID0gZmFsc2U7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vIFdoZW4gZm9jdXMgaXMgb24gYSBjaGlsZCBub2RlIHRoYXQgaXMgYWxzbyBlaXRoZXIgYW4gZW5kIG5vZGUgb3IgYSBjbG9zZWQgbm9kZSwgbW92ZXMgZm9jdXMgdG8gaXRzIHBhcmVudCBub2RlLlxuICAgICAgY29uc3QgcGFyZW50SXRlbSA9IHRhcmdldC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKTtcbiAgICAgIGlmIChwYXJlbnRJdGVtICYmICghdGFyZ2V0Lmhhc0NoaWxkcmVuIHx8IHRhcmdldC5leHBhbmRlZCA9PT0gZmFsc2UpKSB7XG4gICAgICAgIHBhcmVudEl0ZW0uZm9jdXMoKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gV2hlbiBmb2N1cyBpcyBvbiBhIHJvb3Qgbm9kZSB0aGF0IGlzIGFsc28gZWl0aGVyIGFuIGVuZCBub2RlIG9yIGEgY2xvc2VkIG5vZGUsIGRvZXMgbm90aGluZy5cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd1JpZ2h0XCIgJiYgIXRhcmdldC5kaXNhYmxlZCkge1xuICAgICAgaWYgKHRhcmdldC5oYXNDaGlsZHJlbikge1xuICAgICAgICBpZiAodGFyZ2V0LmV4cGFuZGVkICYmIGdldFJvb3ROb2RlKHRoaXMuZWwpLmFjdGl2ZUVsZW1lbnQgPT09IHRhcmdldCkge1xuICAgICAgICAgIC8vIFdoZW4gZm9jdXMgaXMgb24gYW4gb3BlbiBub2RlLCBtb3ZlcyBmb2N1cyB0byB0aGUgZmlyc3QgY2hpbGQgbm9kZS5cbiAgICAgICAgICBnZXRFbmFibGVkU2libGluZ0l0ZW0odGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKSwgXCJkb3duXCIpPy5mb2N1cygpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gV2hlbiBmb2N1cyBpcyBvbiBhIGNsb3NlZCBub2RlLCBvcGVucyB0aGUgbm9kZTsgZm9jdXMgZG9lcyBub3QgbW92ZS5cbiAgICAgICAgICB0YXJnZXQuZXhwYW5kZWQgPSB0cnVlO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cbiAgdXBkYXRlQW5jZXN0b3JUcmVlKGV2ZW50KSB7XG4gICAgY29uc3QgaXRlbSA9IGV2ZW50LnRhcmdldDtcbiAgICBpZiAoaXRlbS5kaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBhbmNlc3RvcnMgPSBbXTtcbiAgICBsZXQgcGFyZW50ID0gaXRlbS5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKTtcbiAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICBhbmNlc3RvcnMucHVzaChwYXJlbnQpO1xuICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudEVsZW1lbnQuY2xvc2VzdChcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xuICAgIH1cbiAgICBjb25zdCBjaGlsZEl0ZW1zID0gQXJyYXkuZnJvbShpdGVtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJjYWxjaXRlLXRyZWUtaXRlbTpub3QoW2Rpc2FibGVkXSlcIikpO1xuICAgIGNvbnN0IGNoaWxkSXRlbXNXaXRoTm9DaGlsZHJlbiA9IGNoaWxkSXRlbXMuZmlsdGVyKChjaGlsZCkgPT4gIWNoaWxkLmhhc0NoaWxkcmVuKTtcbiAgICBjb25zdCBjaGlsZEl0ZW1zV2l0aENoaWxkcmVuID0gY2hpbGRJdGVtcy5maWx0ZXIoKGNoaWxkKSA9PiBjaGlsZC5oYXNDaGlsZHJlbik7XG4gICAgY29uc3QgZnV0dXJlU2VsZWN0ZWQgPSBpdGVtLmhhc0NoaWxkcmVuXG4gICAgICA/ICEoaXRlbS5zZWxlY3RlZCB8fCBpdGVtLmluZGV0ZXJtaW5hdGUpXG4gICAgICA6ICFpdGVtLnNlbGVjdGVkO1xuICAgIGNoaWxkSXRlbXNXaXRoTm9DaGlsZHJlbi5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgZWwuc2VsZWN0ZWQgPSBmdXR1cmVTZWxlY3RlZDtcbiAgICAgIGVsLmluZGV0ZXJtaW5hdGUgPSBmYWxzZTtcbiAgICB9KTtcbiAgICBmdW5jdGlvbiB1cGRhdGVJdGVtU3RhdGUoY2hpbGRJdGVtcywgaXRlbSkge1xuICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBjaGlsZEl0ZW1zLmZpbHRlcigoY2hpbGQpID0+IGNoaWxkLnNlbGVjdGVkKTtcbiAgICAgIGNvbnN0IHVuc2VsZWN0ZWQgPSBjaGlsZEl0ZW1zLmZpbHRlcigoY2hpbGQpID0+ICFjaGlsZC5zZWxlY3RlZCk7XG4gICAgICBpdGVtLnNlbGVjdGVkID0gc2VsZWN0ZWQubGVuZ3RoID09PSBjaGlsZEl0ZW1zLmxlbmd0aDtcbiAgICAgIGl0ZW0uaW5kZXRlcm1pbmF0ZSA9IHNlbGVjdGVkLmxlbmd0aCA+IDAgJiYgdW5zZWxlY3RlZC5sZW5ndGggPiAwO1xuICAgIH1cbiAgICBjaGlsZEl0ZW1zV2l0aENoaWxkcmVuLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICBjb25zdCBkaXJlY3RDaGlsZEl0ZW1zID0gQXJyYXkuZnJvbShlbC5xdWVyeVNlbGVjdG9yQWxsKFwiOnNjb3BlID4gY2FsY2l0ZS10cmVlID4gY2FsY2l0ZS10cmVlLWl0ZW1cIikpO1xuICAgICAgdXBkYXRlSXRlbVN0YXRlKGRpcmVjdENoaWxkSXRlbXMsIGVsKTtcbiAgICB9KTtcbiAgICBpZiAoaXRlbS5oYXNDaGlsZHJlbikge1xuICAgICAgdXBkYXRlSXRlbVN0YXRlKGNoaWxkSXRlbXMsIGl0ZW0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGl0ZW0uc2VsZWN0ZWQgPSBmdXR1cmVTZWxlY3RlZDtcbiAgICAgIGl0ZW0uaW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xuICAgIH1cbiAgICBhbmNlc3RvcnMuZm9yRWFjaCgoYW5jZXN0b3IpID0+IHtcbiAgICAgIGNvbnN0IGRlc2NlbmRhbnRzID0gbm9kZUxpc3RUb0FycmF5KGFuY2VzdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKSk7XG4gICAgICBjb25zdCBhY3RpdmVEZXNjZW5kYW50cyA9IGRlc2NlbmRhbnRzLmZpbHRlcigoZWwpID0+IGVsLnNlbGVjdGVkKTtcbiAgICAgIGlmIChhY3RpdmVEZXNjZW5kYW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgYW5jZXN0b3Iuc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgYW5jZXN0b3IuaW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBpbmRldGVybWluYXRlID0gYWN0aXZlRGVzY2VuZGFudHMubGVuZ3RoIDwgZGVzY2VuZGFudHMubGVuZ3RoO1xuICAgICAgYW5jZXN0b3IuaW5kZXRlcm1pbmF0ZSA9IGluZGV0ZXJtaW5hdGU7XG4gICAgICBhbmNlc3Rvci5zZWxlY3RlZCA9ICFpbmRldGVybWluYXRlO1xuICAgIH0pO1xuICAgIHRoaXMuc2VsZWN0ZWRJdGVtcyA9IG5vZGVMaXN0VG9BcnJheSh0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKSkuZmlsdGVyKChpKSA9PiBpLnNlbGVjdGVkKTtcbiAgICB0aGlzLmNhbGNpdGVUcmVlU2VsZWN0LmVtaXQoKTtcbiAgfVxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgZ2V0Um9vdFRhYkluZGV4KCkge1xuICAgIHJldHVybiAhdGhpcy5jaGlsZCA/IDAgOiAtMTtcbiAgfVxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG59O1xuVHJlZS5zdHlsZSA9IHRyZWVDc3M7XG5cbi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjAuNVxuICovXG5jb25zdCBDU1MgPSB7XG4gIGFjdGlvbnNFbmQ6IFwiYWN0aW9ucy1lbmRcIixcbiAgY2hlY2tib3hMYWJlbDogXCJjaGVja2JveC1sYWJlbFwiLFxuICBjaGVja2JveDogXCJjaGVja2JveFwiLFxuICBjaGV2cm9uOiBcImNoZXZyb25cIixcbiAgbm9kZUNvbnRhaW5lcjogXCJub2RlLWNvbnRhaW5lclwiLFxuICBjaGlsZHJlbkNvbnRhaW5lcjogXCJjaGlsZHJlbi1jb250YWluZXJcIixcbiAgYnVsbGV0UG9pbnRJY29uOiBcImJ1bGxldC1wb2ludFwiLFxuICBjaGVja21hcmtJY29uOiBcImNoZWNrbWFya1wiLFxuICBpdGVtRXhwYW5kZWQ6IFwiaXRlbS0tZXhwYW5kZWRcIixcbiAgaWNvblN0YXJ0OiBcImljb24tc3RhcnRcIlxufTtcbmNvbnN0IFNMT1RTID0ge1xuICBhY3Rpb25zRW5kOiBcImFjdGlvbnMtZW5kXCIsXG4gIGNoaWxkcmVuOiBcImNoaWxkcmVuXCJcbn07XG5jb25zdCBJQ09OUyA9IHtcbiAgYnVsbGV0UG9pbnQ6IFwiYnVsbGV0LXBvaW50XCIsXG4gIGNoZWNrbWFyazogXCJjaGVja1wiLFxuICBjaGV2cm9uUmlnaHQ6IFwiY2hldnJvbi1yaWdodFwiLFxuICBibGFuazogXCJibGFua1wiXG59O1xuXG5jb25zdCB0cmVlSXRlbUNzcyA9IFwiQGtleWZyYW1lcyBpbnswJXtvcGFjaXR5OjB9MTAwJXtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgaW4tZG93bnswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIC01cHgsIDApfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAwLCAwKX19QGtleWZyYW1lcyBpbi11cHswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDVweCwgMCl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDAsIDApfX1Aa2V5ZnJhbWVzIGluLXNjYWxlezAle29wYWNpdHk6MDt0cmFuc2Zvcm06c2NhbGUzRCgwLjk1LCAwLjk1LCAxKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06c2NhbGUzRCgxLCAxLCAxKX19OnJvb3R7LS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmc6Y2FsYygxNTBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3Rvcjp2YXIoLS1jYWxjaXRlLWR1cmF0aW9uLWZhY3RvciwgMSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctZmFzdDpjYWxjKDEwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKTstLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1tZWRpdW06Y2FsYygyMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctc2xvdzpjYWxjKDMwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKX0uY2FsY2l0ZS1hbmltYXRle29wYWNpdHk6MDthbmltYXRpb24tZmlsbC1tb2RlOmJvdGg7YW5pbWF0aW9uLWR1cmF0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyl9LmNhbGNpdGUtYW5pbWF0ZV9faW57YW5pbWF0aW9uLW5hbWU6aW59LmNhbGNpdGUtYW5pbWF0ZV9faW4tZG93bnthbmltYXRpb24tbmFtZTppbi1kb3dufS5jYWxjaXRlLWFuaW1hdGVfX2luLXVwe2FuaW1hdGlvbi1uYW1lOmluLXVwfS5jYWxjaXRlLWFuaW1hdGVfX2luLXNjYWxle2FuaW1hdGlvbi1uYW1lOmluLXNjYWxlfUBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKXs6cm9vdHstLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yOjB9fTpyb290ey0tY2FsY2l0ZS1mbG9hdGluZy11aS10cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyk7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXotaW5kZXg6NjAwfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9Omhvc3QoW2Rpc2FibGVkXSl7cG9pbnRlci1ldmVudHM6bm9uZTtjdXJzb3I6ZGVmYXVsdDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7dXNlci1zZWxlY3Q6bm9uZTtvcGFjaXR5OnZhcigtLWNhbGNpdGUtdWktb3BhY2l0eS1kaXNhYmxlZCl9Omhvc3R7ZGlzcGxheTpibG9jazttYXgtaW5saW5lLXNpemU6MTAwJTtjdXJzb3I6cG9pbnRlcjtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMyl9W2hpZGRlbl17ZGlzcGxheTpub25lfTpob3N0KFtjYWxjaXRlLWh5ZHJhdGVkLWhpZGRlbl0pe3Zpc2liaWxpdHk6aGlkZGVuICFpbXBvcnRhbnQ7cG9pbnRlci1ldmVudHM6bm9uZX06aG9zdChbZGlzYWJsZWRdKSA6OnNsb3R0ZWQoW2NhbGNpdGUtaHlkcmF0ZWRdW2Rpc2FibGVkXSksOmhvc3QoW2Rpc2FibGVkXSkgW2NhbGNpdGUtaHlkcmF0ZWRdW2Rpc2FibGVkXXtvcGFjaXR5OjF9Omhvc3QoW3NjYWxlPXNdKXtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTIpO2xpbmUtaGVpZ2h0OjFyZW19Omhvc3QoW3NjYWxlPXNdKSAubm9kZS1jb250YWluZXJ7LS1jYWxjaXRlLXRyZWUtcGFkZGluZy15OjAuMjVyZW19Omhvc3QoW3NjYWxlPXNdKSAubm9kZS1jb250YWluZXIgLmNoZWNrYm94LDpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyIC5jaGV2cm9uLDpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyIC5jaGVja21hcmssOmhvc3QoW3NjYWxlPXNdKSAubm9kZS1jb250YWluZXIgLmJ1bGxldC1wb2ludHttYXJnaW4taW5saW5lOjAuMjVyZW19Omhvc3QoW3NjYWxlPXNdKSAubm9kZS1jb250YWluZXIgLmljb24tc3RhcnQsOmhvc3QoW3NjYWxlPXNdKSAubm9kZS1jb250YWluZXIgLmFjdGlvbnMtZW5ke21hcmdpbi1pbmxpbmU6MC4yNXJlbX06aG9zdChbc2NhbGU9bV0pe2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMSk7bGluZS1oZWlnaHQ6MXJlbX06aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lcnstLWNhbGNpdGUtdHJlZS1wYWRkaW5nLXk6MC41cmVtfTpob3N0KFtzY2FsZT1tXSkgLm5vZGUtY29udGFpbmVyIC5jaGVja2JveCw6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lciAuY2hldnJvbiw6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJrLDpob3N0KFtzY2FsZT1tXSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7bWFyZ2luLWlubGluZTowLjVyZW19Omhvc3QoW3NjYWxlPW1dKSAubm9kZS1jb250YWluZXIgLmljb24tc3RhcnQsOmhvc3QoW3NjYWxlPW1dKSAubm9kZS1jb250YWluZXIgLmFjdGlvbnMtZW5ke21hcmdpbi1pbmxpbmU6MC41cmVtfTpob3N0KFtzY2FsZT1sXSl7Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLTApO2xpbmUtaGVpZ2h0OjEuMjVyZW19Omhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXJ7LS1jYWxjaXRlLXRyZWUtcGFkZGluZy15OjAuNzVyZW19Omhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXIgLmNoZWNrYm94LDpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVyIC5jaGV2cm9uLDpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVyIC5jaGVja21hcmssOmhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXIgLmJ1bGxldC1wb2ludHttYXJnaW4taW5saW5lOjAuNzVyZW19Omhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXIgLmljb24tc3RhcnQsOmhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXIgLmFjdGlvbnMtZW5ke21hcmdpbi1pbmxpbmU6MC43NXJlbX06aG9zdChbbGluZXNdKSAuY2hpbGRyZW4tY29udGFpbmVyOmFmdGVye3Bvc2l0aW9uOmFic29sdXRlO2luc2V0LWJsb2NrLXN0YXJ0OjBweDt6LWluZGV4OjE7aW5saW5lLXNpemU6MXB4O3RyYW5zaXRpb24tcHJvcGVydHk6Y29sb3IsIGJhY2tncm91bmQtY29sb3IsIGJvcmRlci1jb2xvciwgdGV4dC1kZWNvcmF0aW9uLWNvbG9yLCBmaWxsLCBzdHJva2U7dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDAuNCwgMCwgMC4yLCAxKTt0cmFuc2l0aW9uLWR1cmF0aW9uOjE1MG1zO3RyYW5zaXRpb246YWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQgMHMsIG91dGxpbmUgMHMsIG91dGxpbmUtb2Zmc2V0IDBzO2Jsb2NrLXNpemU6OTYlO2NvbnRlbnQ6XFxcIlxcXCI7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0yKX06aG9zdCg6bm90KFtsaW5lc10pKSAubm9kZS1jb250YWluZXI6YWZ0ZXJ7ZGlzcGxheTpub25lfTo6c2xvdHRlZCgqKXttaW4taW5saW5lLXNpemU6MHB4O21heC1pbmxpbmUtc2l6ZToxMDAlO292ZXJmbG93LXdyYXA6YnJlYWstd29yZDtjb2xvcjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjpub25lICFpbXBvcnRhbnR9OjpzbG90dGVkKCopOmhvdmVye3RleHQtZGVjb3JhdGlvbjpub25lICFpbXBvcnRhbnR9OjpzbG90dGVkKGEpe2lubGluZS1zaXplOjEwMCU7dGV4dC1kZWNvcmF0aW9uLWxpbmU6bm9uZX06aG9zdHtvdXRsaW5lLWNvbG9yOnRyYW5zcGFyZW50fTpob3N0KDpmb2N1cyl7b3V0bGluZToycHggc29saWQgdHJhbnNwYXJlbnQ7b3V0bGluZToycHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1icmFuZCk7b3V0bGluZS1vZmZzZXQ6LTJweH1zbG90W25hbWU9YWN0aW9ucy1lbmRdOjpzbG90dGVkKCopLC5hY3Rpb25zLWVuZHtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93O2FsaWduLWl0ZW1zOmNlbnRlcjthbGlnbi1zZWxmOnN0cmV0Y2g7b3ZlcmZsb3c6dmlzaWJsZX0uY2hlY2tib3h7bGluZS1oZWlnaHQ6MH0uY2hlY2tib3gtbGFiZWx7cG9pbnRlci1ldmVudHM6bm9uZTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyfS5jaGVja2JveDpmb2N1c3tvdXRsaW5lOjJweCBzb2xpZCB0cmFuc3BhcmVudDtvdXRsaW5lLW9mZnNldDoycHh9LmNoaWxkcmVuLWNvbnRhaW5lcntwb3NpdGlvbjpyZWxhdGl2ZTtibG9jay1zaXplOjBweDtvdmVyZmxvdzpoaWRkZW47bWFyZ2luLWlubGluZS1zdGFydDoxLjI1cmVtO3RyYW5zZm9ybTpzY2FsZVkoMCk7b3BhY2l0eTowO3RyYW5zaXRpb246dmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBjdWJpYy1iZXppZXIoMC4yMTUsIDAuNDQsIDAuNDIsIDAuODgpLCBvcGFjaXR5IHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgY3ViaWMtYmV6aWVyKDAuMjE1LCAwLjQ0LCAwLjQyLCAwLjg4KSwgYWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQ7dHJhbnNmb3JtLW9yaWdpbjp0b3B9Lml0ZW0tLWV4cGFuZGVkPi5jaGlsZHJlbi1jb250YWluZXJ7b3ZlcmZsb3c6dmlzaWJsZTtvcGFjaXR5OjE7YmxvY2stc2l6ZTphdXRvfS5ub2RlLWNvbnRhaW5lcntwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmctYmxvY2s6dmFyKC0tY2FsY2l0ZS10cmVlLXBhZGRpbmcteSk7cGFkZGluZy1pbmxpbmU6MH0ubm9kZS1jb250YWluZXIgLmNoZWNrbWFyaywubm9kZS1jb250YWluZXIgLmJ1bGxldC1wb2ludHtvcGFjaXR5OjA7dHJhbnNpdGlvbjphbGwgdmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBlYXNlLWluLW91dCAwcywgb3V0bGluZSAwcywgb3V0bGluZS1vZmZzZXQgMHM7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMSl9Lm5vZGUtY29udGFpbmVyOmhvdmVyIC5jaGVja21hcmssLm5vZGUtY29udGFpbmVyOmhvdmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyOmhvdmVyIC5jaGVja21hcmssOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyOmhvdmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoOmZvY3VzOm5vdChbZGlzYWJsZWRdKSkgLm5vZGUtY29udGFpbmVyIC5jaGVja21hcmssOmhvc3QoOmZvY3VzOm5vdChbZGlzYWJsZWRdKSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7b3BhY2l0eToxfTpob3N0KFtzZWxlY3RlZF0pIC5ub2RlLWNvbnRhaW5lciw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXI6aG92ZXJ7Zm9udC13ZWlnaHQ6dmFyKC0tY2FsY2l0ZS1mb250LXdlaWdodC1tZWRpdW0pO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0xKX06aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXIgLmJ1bGxldC1wb2ludCw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXIgLmNoZWNrbWFyayw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXI6aG92ZXIgLmJ1bGxldC1wb2ludCw6aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXI6aG92ZXIgLmNoZWNrbWFya3tvcGFjaXR5OjE7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS1icmFuZCl9Omhvc3QoW3NlbGVjdGlvbi1tb2RlPW5vbmVdOm5vdChbaGFzLWNoaWxkcmVuXSkpOmhvc3QoW3NjYWxlPXNdKSAubm9kZS1jb250YWluZXJ7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MC41cmVtfTpob3N0KFtzZWxlY3Rpb24tbW9kZT1ub25lXTpub3QoW2hhcy1jaGlsZHJlbl0pKTpob3N0KFtzY2FsZT1tXSkgLm5vZGUtY29udGFpbmVye3BhZGRpbmctaW5saW5lLXN0YXJ0OjFyZW19Omhvc3QoW3NlbGVjdGlvbi1tb2RlPW5vbmVdOm5vdChbaGFzLWNoaWxkcmVuXSkpOmhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXJ7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MS41cmVtfTpob3N0KDpub3QoW2hhcy1jaGlsZHJlbl0pKTpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyW2RhdGEtc2VsZWN0aW9uLW1vZGU9YW5jZXN0b3JzXSAuY2hlY2tib3h7cGFkZGluZy1pbmxpbmUtc3RhcnQ6MS4yNXJlbX06aG9zdCg6bm90KFtoYXMtY2hpbGRyZW5dKSk6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lcltkYXRhLXNlbGVjdGlvbi1tb2RlPWFuY2VzdG9yc10gLmNoZWNrYm94e3BhZGRpbmctaW5saW5lLXN0YXJ0OjEuNXJlbX06aG9zdCg6bm90KFtoYXMtY2hpbGRyZW5dKSk6aG9zdChbc2NhbGU9bF0pIC5ub2RlLWNvbnRhaW5lcltkYXRhLXNlbGVjdGlvbi1tb2RlPWFuY2VzdG9yc10gLmNoZWNrYm94e3BhZGRpbmctaW5saW5lLXN0YXJ0OjEuNzVyZW19Omhvc3QoW2hhcy1jaGlsZHJlbl0pIC5ub2RlLWNvbnRhaW5lcltkYXRhLXNlbGVjdGlvbi1tb2RlPWFuY2VzdG9yc10gLmNoZWNrYm94e21hcmdpbi1pbmxpbmUtc3RhcnQ6MH06aG9zdChbaGFzLWNoaWxkcmVuXSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoW2hhcy1jaGlsZHJlbl0pIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJre2Rpc3BsYXk6bm9uZX06aG9zdChbaGFzLWNoaWxkcmVuXVtleHBhbmRlZF06bm90KFtzZWxlY3RlZF0pOm5vdChbc2VsZWN0aW9uLW1vZGU9bm9uZV0pKSAubm9kZS1jb250YWluZXIgOjpzbG90dGVkKCope2ZvbnQtd2VpZ2h0OnZhcigtLWNhbGNpdGUtZm9udC13ZWlnaHQtbWVkaXVtKTtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMSl9Omhvc3QoW2hhcy1jaGlsZHJlbl1bc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXJbZGF0YS1zZWxlY3Rpb24tbW9kZT1jaGlsZHJlbl0sOmhvc3QoW2hhcy1jaGlsZHJlbl1bc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXJbZGF0YS1zZWxlY3Rpb24tbW9kZT1tdWx0aWNoaWxkcmVuXXtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJyYW5kKX0uY2hldnJvbntwb3NpdGlvbjpyZWxhdGl2ZTthbGlnbi1zZWxmOmNlbnRlcjtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMyk7dHJhbnNpdGlvbjphbGwgdmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKSBlYXNlLWluLW91dCAwcywgb3V0bGluZSAwcywgb3V0bGluZS1vZmZzZXQgMHM7ZmxleDowIDAgYXV0bzt0cmFuc2Zvcm06cm90YXRlKDBkZWcpfS5jYWxjaXRlLS1ydGwgLmNoZXZyb257dHJhbnNmb3JtOnJvdGF0ZSgxODBkZWcpfS5pdGVtLS1leHBhbmRlZD4ubm9kZS1jb250YWluZXI+LmNoZXZyb257dHJhbnNmb3JtOnJvdGF0ZSg5MGRlZyl9Omhvc3QoW3NlbGVjdGVkXSkgLmNoZWNrbWFyayw6aG9zdChbc2VsZWN0ZWRdKSAuYnVsbGV0LXBvaW50e2NvbG9yOnZhcigtLWNhbGNpdGUtdWktYnJhbmQpfVwiO1xuXG5jb25zdCBUcmVlSXRlbSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxUcmVlSXRlbVNlbGVjdCA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiY2FsY2l0ZUludGVybmFsVHJlZUl0ZW1TZWxlY3RcIiwgNik7XG4gICAgdGhpcy5vcGVuVHJhbnNpdGlvblByb3AgPSBcIm9wYWNpdHlcIjtcbiAgICB0aGlzLnRyYW5zaXRpb25Qcm9wID0gXCJleHBhbmRlZFwiO1xuICAgIHRoaXMuaWNvbkNsaWNrSGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLmV4cGFuZGVkID0gIXRoaXMuZXhwYW5kZWQ7XG4gICAgfTtcbiAgICB0aGlzLmNoaWxkcmVuQ2xpY2tIYW5kbGVyID0gKGV2ZW50KSA9PiBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdGhpcy51cGRhdGVQYXJlbnRJc0V4cGFuZGVkID0gKGVsLCBleHBhbmRlZCkgPT4ge1xuICAgICAgY29uc3QgaXRlbXMgPSBnZXRTbG90dGVkKGVsLCBTTE9UUy5jaGlsZHJlbiwge1xuICAgICAgICBhbGw6IHRydWUsXG4gICAgICAgIHNlbGVjdG9yOiBcImNhbGNpdGUtdHJlZS1pdGVtXCJcbiAgICAgIH0pO1xuICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gKGl0ZW0ucGFyZW50RXhwYW5kZWQgPSBleHBhbmRlZCkpO1xuICAgIH07XG4gICAgdGhpcy51cGRhdGVBbmNlc3RvclRyZWUgPSAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5zZWxlY3RlZCAmJiB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwiYW5jZXN0b3JzXCIpIHtcbiAgICAgICAgY29uc3QgYW5jZXN0b3JzID0gW107XG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLnBhcmVudFRyZWVJdGVtO1xuICAgICAgICB3aGlsZSAocGFyZW50KSB7XG4gICAgICAgICAgYW5jZXN0b3JzLnB1c2gocGFyZW50KTtcbiAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50RWxlbWVudD8uY2xvc2VzdChcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xuICAgICAgICB9XG4gICAgICAgIGFuY2VzdG9ycy5mb3JFYWNoKChpdGVtKSA9PiAoaXRlbS5pbmRldGVybWluYXRlID0gdHJ1ZSkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmFjdGlvbnNFbmRTbG90Q2hhbmdlSGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5oYXNFbmRBY3Rpb25zID0gc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudChldmVudCk7XG4gICAgfTtcbiAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5leHBhbmRlZCA9IGZhbHNlO1xuICAgIHRoaXMuaWNvbkZsaXBSdGwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5pY29uU3RhcnQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zZWxlY3RlZCA9IGZhbHNlO1xuICAgIHRoaXMucGFyZW50RXhwYW5kZWQgPSBmYWxzZTtcbiAgICB0aGlzLmRlcHRoID0gLTE7XG4gICAgdGhpcy5oYXNDaGlsZHJlbiA9IG51bGw7XG4gICAgdGhpcy5saW5lcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjYWxlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuaW5kZXRlcm1pbmF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy51cGRhdGVBZnRlckluaXRpYWxSZW5kZXIgPSBmYWxzZTtcbiAgICB0aGlzLmhhc0VuZEFjdGlvbnMgPSBmYWxzZTtcbiAgfVxuICBleHBhbmRlZEhhbmRsZXIobmV3VmFsdWUpIHtcbiAgICB0aGlzLnVwZGF0ZVBhcmVudElzRXhwYW5kZWQodGhpcy5lbCwgbmV3VmFsdWUpO1xuICAgIG9uVG9nZ2xlT3BlbkNsb3NlQ29tcG9uZW50KHRoaXMsIHRydWUpO1xuICB9XG4gIGdldHNlbGVjdGlvbk1vZGUoKSB7XG4gICAgdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSA9XG4gICAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGlwbGVcIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiO1xuICB9XG4gIC8qKlxuICAgKiBEZWZpbmVzIG1ldGhvZCBmb3IgYGJlZm9yZU9wZW5gIGV2ZW50IGhhbmRsZXIuXG4gICAqL1xuICBvbkJlZm9yZU9wZW4oKSB7XG4gICAgdGhpcy50cmFuc2l0aW9uRWwuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZVkoMSlcIjtcbiAgfVxuICAvKipcbiAgICogRGVmaW5lcyBtZXRob2QgZm9yIGBvcGVuYCBldmVudCBoYW5kbGVyOlxuICAgKi9cbiAgb25PcGVuKCkge1xuICAgIHRoaXMudHJhbnNpdGlvbkVsLnN0eWxlLnRyYW5zZm9ybSA9IFwibm9uZVwiO1xuICB9XG4gIC8qKlxuICAgKiBEZWZpbmVzIG1ldGhvZCBmb3IgYGJlZm9yZUNsb3NlYCBldmVudCBoYW5kbGVyOlxuICAgKi9cbiAgb25CZWZvcmVDbG9zZSgpIHtcbiAgICAvLyBwYXR0ZXJuIG5lZWRzIHRvIGJlIGRlZmluZWQgb24gaG93IHdlIGVtaXQgZXZlbnRzIGZvciBjb21wb25lbnRzIHdpdGhvdXQgYG9wZW5gIHByb3AuXG4gIH1cbiAgLyoqXG4gICAqIERlZmluZXMgbWV0aG9kIGZvciBgY2xvc2VgIGV2ZW50IGhhbmRsZXI6XG4gICAqL1xuICBvbkNsb3NlKCkge1xuICAgIHRoaXMudHJhbnNpdGlvbkVsLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGVZKDApXCI7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgTGlmZWN5Y2xlXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5wYXJlbnRUcmVlSXRlbSA9IHRoaXMuZWwucGFyZW50RWxlbWVudD8uY2xvc2VzdChcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xuICAgIGlmICh0aGlzLnBhcmVudFRyZWVJdGVtKSB7XG4gICAgICBjb25zdCB7IGV4cGFuZGVkIH0gPSB0aGlzLnBhcmVudFRyZWVJdGVtO1xuICAgICAgdGhpcy51cGRhdGVQYXJlbnRJc0V4cGFuZGVkKHRoaXMucGFyZW50VHJlZUl0ZW0sIGV4cGFuZGVkKTtcbiAgICB9XG4gICAgY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCh0aGlzKTtcbiAgfVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBkaXNjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50KHRoaXMpO1xuICB9XG4gIGNvbXBvbmVudFdpbGxSZW5kZXIoKSB7XG4gICAgdGhpcy5oYXNDaGlsZHJlbiA9ICEhdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiY2FsY2l0ZS10cmVlXCIpO1xuICAgIHRoaXMuZGVwdGggPSAwO1xuICAgIGxldCBwYXJlbnRUcmVlID0gdGhpcy5lbC5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlXCIpO1xuICAgIGlmICghcGFyZW50VHJlZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPSBwYXJlbnRUcmVlLnNlbGVjdGlvbk1vZGU7XG4gICAgdGhpcy5zY2FsZSA9IHBhcmVudFRyZWUuc2NhbGUgfHwgXCJtXCI7XG4gICAgdGhpcy5saW5lcyA9IHBhcmVudFRyZWUubGluZXM7XG4gICAgbGV0IG5leHRQYXJlbnRUcmVlO1xuICAgIHdoaWxlIChwYXJlbnRUcmVlKSB7XG4gICAgICBuZXh0UGFyZW50VHJlZSA9IHBhcmVudFRyZWUucGFyZW50RWxlbWVudD8uY2xvc2VzdChcImNhbGNpdGUtdHJlZVwiKTtcbiAgICAgIGlmIChuZXh0UGFyZW50VHJlZSA9PT0gcGFyZW50VHJlZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBwYXJlbnRUcmVlID0gbmV4dFBhcmVudFRyZWU7XG4gICAgICAgIHRoaXMuZGVwdGggPSB0aGlzLmRlcHRoICsgMTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgaWYgKHRoaXMuZXhwYW5kZWQpIHtcbiAgICAgIG9uVG9nZ2xlT3BlbkNsb3NlQ29tcG9uZW50KHRoaXMsIHRydWUpO1xuICAgIH1cbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gKHRoaXMudXBkYXRlQWZ0ZXJJbml0aWFsUmVuZGVyID0gdHJ1ZSkpO1xuICB9XG4gIGNvbXBvbmVudERpZExvYWQoKSB7XG4gICAgdGhpcy51cGRhdGVBbmNlc3RvclRyZWUoKTtcbiAgfVxuICBjb21wb25lbnREaWRSZW5kZXIoKSB7XG4gICAgdXBkYXRlSG9zdEludGVyYWN0aW9uKHRoaXMsICgpID0+IHRoaXMucGFyZW50RXhwYW5kZWQgfHwgdGhpcy5kZXB0aCA9PT0gMSk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHJ0bCA9IGdldEVsZW1lbnREaXIodGhpcy5lbCkgPT09IFwicnRsXCI7XG4gICAgY29uc3Qgc2hvd0J1bGxldFBvaW50ID0gdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcInNpbmdsZVwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJjaGlsZHJlblwiO1xuICAgIGNvbnN0IHNob3dDaGVja21hcmsgPSB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGlwbGVcIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiO1xuICAgIGNvbnN0IHNob3dCbGFuayA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJub25lXCIgJiYgIXRoaXMuaGFzQ2hpbGRyZW47XG4gICAgY29uc3QgY2hldnJvbiA9IHRoaXMuaGFzQ2hpbGRyZW4gPyAoaChcImNhbGNpdGUtaWNvblwiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1MuY2hldnJvbl06IHRydWUsXG4gICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBydGxcbiAgICAgIH0sIFwiZGF0YS10ZXN0LWlkXCI6IFwiaWNvblwiLCBpY29uOiBJQ09OUy5jaGV2cm9uUmlnaHQsIG9uQ2xpY2s6IHRoaXMuaWNvbkNsaWNrSGFuZGxlciwgc2NhbGU6IHRoaXMuc2NhbGUgPT09IFwibFwiID8gXCJtXCIgOiBcInNcIiB9KSkgOiBudWxsO1xuICAgIGNvbnN0IGRlZmF1bHRTbG90Tm9kZSA9IGgoXCJzbG90XCIsIHsga2V5OiBcImRlZmF1bHQtc2xvdFwiIH0pO1xuICAgIGNvbnN0IGNoZWNrYm94ID0gdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImFuY2VzdG9yc1wiID8gKGgoXCJsYWJlbFwiLCB7IGNsYXNzOiBDU1MuY2hlY2tib3hMYWJlbCwga2V5OiBcImNoZWNrYm94LWxhYmVsXCIgfSwgaChcImNhbGNpdGUtY2hlY2tib3hcIiwgeyBjaGVja2VkOiB0aGlzLnNlbGVjdGVkLCBjbGFzczogQ1NTLmNoZWNrYm94LCBcImRhdGEtdGVzdC1pZFwiOiBcImNoZWNrYm94XCIsIGluZGV0ZXJtaW5hdGU6IHRoaXMuaGFzQ2hpbGRyZW4gJiYgdGhpcy5pbmRldGVybWluYXRlLCBzY2FsZTogdGhpcy5zY2FsZSwgdGFiSW5kZXg6IC0xIH0pLCBkZWZhdWx0U2xvdE5vZGUpKSA6IG51bGw7XG4gICAgY29uc3Qgc2VsZWN0ZWRJY29uID0gc2hvd0J1bGxldFBvaW50XG4gICAgICA/IElDT05TLmJ1bGxldFBvaW50XG4gICAgICA6IHNob3dDaGVja21hcmtcbiAgICAgICAgPyBJQ09OUy5jaGVja21hcmtcbiAgICAgICAgOiBzaG93QmxhbmtcbiAgICAgICAgICA/IElDT05TLmJsYW5rXG4gICAgICAgICAgOiBudWxsO1xuICAgIGNvbnN0IGl0ZW1JbmRpY2F0b3IgPSBzZWxlY3RlZEljb24gPyAoaChcImNhbGNpdGUtaWNvblwiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1MuYnVsbGV0UG9pbnRJY29uXTogc2VsZWN0ZWRJY29uID09PSBJQ09OUy5idWxsZXRQb2ludCxcbiAgICAgICAgW0NTUy5jaGVja21hcmtJY29uXTogc2VsZWN0ZWRJY29uID09PSBJQ09OUy5jaGVja21hcmssXG4gICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBydGxcbiAgICAgIH0sIGljb246IHNlbGVjdGVkSWNvbiwgc2NhbGU6IHRoaXMuc2NhbGUgPT09IFwibFwiID8gXCJtXCIgOiBcInNcIiB9KSkgOiBudWxsO1xuICAgIGNvbnN0IGhpZGRlbiA9ICEodGhpcy5wYXJlbnRFeHBhbmRlZCB8fCB0aGlzLmRlcHRoID09PSAxKTtcbiAgICBjb25zdCBpc0V4cGFuZGVkID0gdGhpcy51cGRhdGVBZnRlckluaXRpYWxSZW5kZXIgJiYgdGhpcy5leHBhbmRlZDtcbiAgICBjb25zdCB7IGhhc0VuZEFjdGlvbnMgfSA9IHRoaXM7XG4gICAgY29uc3Qgc2xvdE5vZGUgPSAoaChcInNsb3RcIiwgeyBrZXk6IFwiYWN0aW9uc0VuZFNsb3RcIiwgbmFtZTogU0xPVFMuYWN0aW9uc0VuZCwgb25TbG90Y2hhbmdlOiB0aGlzLmFjdGlvbnNFbmRTbG90Q2hhbmdlSGFuZGxlciB9KSk7XG4gICAgY29uc3QgaWNvblN0YXJ0RWwgPSAoaChcImNhbGNpdGUtaWNvblwiLCB7IGNsYXNzOiBDU1MuaWNvblN0YXJ0LCBmbGlwUnRsOiB0aGlzLmljb25GbGlwUnRsID09PSBcInN0YXJ0XCIgfHwgdGhpcy5pY29uRmxpcFJ0bCA9PT0gXCJib3RoXCIsIGljb246IHRoaXMuaWNvblN0YXJ0LCBzY2FsZTogdGhpcy5zY2FsZSA9PT0gXCJsXCIgPyBcIm1cIiA6IFwic1wiIH0pKTtcbiAgICByZXR1cm4gKGgoSG9zdCwgeyBcImFyaWEtZXhwYW5kZWRcIjogdGhpcy5oYXNDaGlsZHJlbiA/IHRvQXJpYUJvb2xlYW4oaXNFeHBhbmRlZCkgOiB1bmRlZmluZWQsIFwiYXJpYS1oaWRkZW5cIjogdG9BcmlhQm9vbGVhbihoaWRkZW4pLCBcImFyaWEtc2VsZWN0ZWRcIjogdGhpcy5zZWxlY3RlZCA/IFwidHJ1ZVwiIDogc2hvd0NoZWNrbWFyayA/IFwiZmFsc2VcIiA6IHVuZGVmaW5lZCwgXCJjYWxjaXRlLWh5ZHJhdGVkLWhpZGRlblwiOiBoaWRkZW4sIHJvbGU6IFwidHJlZWl0ZW1cIiB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IHsgW0NTUy5pdGVtRXhwYW5kZWRdOiBpc0V4cGFuZGVkIH0gfSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1Mubm9kZUNvbnRhaW5lcl06IHRydWUsXG4gICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBydGxcbiAgICAgIH0sIFwiZGF0YS1zZWxlY3Rpb24tbW9kZVwiOiB0aGlzLnNlbGVjdGlvbk1vZGUsIHJlZjogKGVsKSA9PiAodGhpcy5kZWZhdWx0U2xvdFdyYXBwZXIgPSBlbCkgfSwgY2hldnJvbiwgaXRlbUluZGljYXRvciwgdGhpcy5pY29uU3RhcnQgPyBpY29uU3RhcnRFbCA6IG51bGwsIGNoZWNrYm94ID8gY2hlY2tib3ggOiBkZWZhdWx0U2xvdE5vZGUsIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLmFjdGlvbnNFbmQsIGhpZGRlbjogIWhhc0VuZEFjdGlvbnMgfSwgc2xvdE5vZGUpKSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XG4gICAgICAgIFtDU1MuY2hpbGRyZW5Db250YWluZXJdOiB0cnVlLFxuICAgICAgICBbQ1NTX1VUSUxJVFkucnRsXTogcnRsXG4gICAgICB9LCBcImRhdGEtdGVzdC1pZFwiOiBcImNhbGNpdGUtdHJlZS1jaGlsZHJlblwiLCBvbkNsaWNrOiB0aGlzLmNoaWxkcmVuQ2xpY2tIYW5kbGVyLCByZWY6IChlbCkgPT4gdGhpcy5zZXRUcmFuc2l0aW9uRWwoZWwpLCByb2xlOiB0aGlzLmhhc0NoaWxkcmVuID8gXCJncm91cFwiIDogdW5kZWZpbmVkIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogU0xPVFMuY2hpbGRyZW4gfSkpKSkpO1xuICB9XG4gIHNldFRyYW5zaXRpb25FbChlbCkge1xuICAgIHRoaXMudHJhbnNpdGlvbkVsID0gZWw7XG4gIH1cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvL1xuICAvLyAgRXZlbnQgTGlzdGVuZXJzXG4gIC8vXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgb25DbGljayhldmVudCkge1xuICAgIC8vIFNvbHZlIGZvciBpZiB0aGUgaXRlbSBpcyBjbGlja2VkIHNvbWV3aGVyZSBvdXRzaWRlIHRoZSBzbG90dGVkIGFuY2hvci5cbiAgICAvLyBBbmNob3IgaXMgdHJpZ2dlcmVkIGFueXdoZXJlIHlvdSBjbGlja1xuICAgIGNvbnN0IFtsaW5rXSA9IGZpbHRlckRpcmVjdENoaWxkcmVuKHRoaXMuZWwsIFwiYVwiKTtcbiAgICBpZiAobGluayAmJiBldmVudC5jb21wb3NlZFBhdGgoKVswXS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09IFwiYVwiKSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSBsaW5rLnRhcmdldCA9PT0gXCJcIiA/IFwiX3NlbGZcIiA6IGxpbmsudGFyZ2V0O1xuICAgICAgd2luZG93Lm9wZW4obGluay5ocmVmLCB0YXJnZXQpO1xuICAgIH1cbiAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xuICAgICAgbW9kaWZ5Q3VycmVudFNlbGVjdGlvbjogdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImFuY2VzdG9yc1wiIHx8IHRoaXMuaXNTZWxlY3Rpb25NdWx0aUxpa2UsXG4gICAgICBmb3JjZVRvZ2dsZTogZmFsc2VcbiAgICB9KTtcbiAgfVxuICBrZXlEb3duSGFuZGxlcihldmVudCkge1xuICAgIGxldCByb290O1xuICAgIHN3aXRjaCAoZXZlbnQua2V5KSB7XG4gICAgICBjYXNlIFwiIFwiOlxuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm5vbmVcIikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xuICAgICAgICAgIG1vZGlmeUN1cnJlbnRTZWxlY3Rpb246IHRoaXMuaXNTZWxlY3Rpb25NdWx0aUxpa2UsXG4gICAgICAgICAgZm9yY2VUb2dnbGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJFbnRlclwiOlxuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm5vbmVcIikge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBhY3RpdmF0ZXMgYSBub2RlLCBpLmUuLCBwZXJmb3JtcyBpdHMgZGVmYXVsdCBhY3Rpb24uIEZvciBwYXJlbnQgbm9kZXMsIG9uZSBwb3NzaWJsZSBkZWZhdWx0IGFjdGlvbiBpcyB0byBvcGVuIG9yIGNsb3NlIHRoZSBub2RlLiBJbiBzaW5nbGUtc2VsZWN0IHRyZWVzIHdoZXJlIHNlbGVjdGlvbiBkb2VzIG5vdCBmb2xsb3cgZm9jdXMgKHNlZSBub3RlIGJlbG93KSwgdGhlIGRlZmF1bHQgYWN0aW9uIGlzIHR5cGljYWxseSB0byBzZWxlY3QgdGhlIGZvY3VzZWQgbm9kZS5cbiAgICAgICAgY29uc3QgbGluayA9IG5vZGVMaXN0VG9BcnJheSh0aGlzLmVsLmNoaWxkcmVuKS5maW5kKChlbCkgPT4gZWwubWF0Y2hlcyhcImFcIikpO1xuICAgICAgICBpZiAobGluaykge1xuICAgICAgICAgIGxpbmsuY2xpY2soKTtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xuICAgICAgICAgICAgbW9kaWZ5Q3VycmVudFNlbGVjdGlvbjogdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSxcbiAgICAgICAgICAgIGZvcmNlVG9nZ2xlOiBmYWxzZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIkhvbWVcIjpcbiAgICAgICAgcm9vdCA9IHRoaXMuZWwuY2xvc2VzdChcImNhbGNpdGUtdHJlZTpub3QoW2NoaWxkXSlcIik7XG4gICAgICAgIGNvbnN0IGZpcnN0Tm9kZSA9IHJvb3QucXVlcnlTZWxlY3RvcihcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xuICAgICAgICBmaXJzdE5vZGU/LmZvY3VzKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIkVuZFwiOlxuICAgICAgICByb290ID0gdGhpcy5lbC5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlOm5vdChbY2hpbGRdKVwiKTtcbiAgICAgICAgbGV0IGN1cnJlbnROb2RlID0gcm9vdC5jaGlsZHJlbltyb290LmNoaWxkcmVuLmxlbmd0aCAtIDFdOyAvLyBsYXN0IGNoaWxkXG4gICAgICAgIGxldCBjdXJyZW50VHJlZSA9IG5vZGVMaXN0VG9BcnJheShjdXJyZW50Tm9kZS5jaGlsZHJlbikuZmluZCgoZWwpID0+IGVsLm1hdGNoZXMoXCJjYWxjaXRlLXRyZWVcIikpO1xuICAgICAgICB3aGlsZSAoY3VycmVudFRyZWUpIHtcbiAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnRUcmVlLmNoaWxkcmVuW3Jvb3QuY2hpbGRyZW4ubGVuZ3RoIC0gMV07XG4gICAgICAgICAgY3VycmVudFRyZWUgPSBub2RlTGlzdFRvQXJyYXkoY3VycmVudE5vZGUuY2hpbGRyZW4pLmZpbmQoKGVsKSA9PiBlbC5tYXRjaGVzKFwiY2FsY2l0ZS10cmVlXCIpKTtcbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50Tm9kZT8uZm9jdXMoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICBcImV4cGFuZGVkXCI6IFtcImV4cGFuZGVkSGFuZGxlclwiXSxcbiAgICBcInNlbGVjdGlvbk1vZGVcIjogW1wiZ2V0c2VsZWN0aW9uTW9kZVwiXVxuICB9OyB9XG59O1xuVHJlZUl0ZW0uc3R5bGUgPSB0cmVlSXRlbUNzcztcblxuZXhwb3J0IHsgVG9vbHRpcCBhcyBjYWxjaXRlX3Rvb2x0aXAsIFRyZWUgYXMgY2FsY2l0ZV90cmVlLCBUcmVlSXRlbSBhcyBjYWxjaXRlX3RyZWVfaXRlbSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jYWxjaXRlLXRvb2x0aXBfMy5lbnRyeS5qcy5tYXAiLCJpbXBvcnQgeyBmIGFzIGZvcmNlVXBkYXRlIH0gZnJvbSAnLi9pbmRleC00ZTY0NzQxMS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZU9ic2VydmVyIH0gZnJvbSAnLi9vYnNlcnZlcnMtNTY3NDBlOTkuanMnO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuY29uc3Qgb2JzZXJ2ZWQgPSBuZXcgU2V0KCk7XG5sZXQgbXV0YXRpb25PYnNlcnZlcjtcbmNvbnN0IG9ic2VydmVyT3B0aW9ucyA9IHsgY2hpbGRMaXN0OiB0cnVlIH07XG4vKipcbiAqIEhlbHBlciB0byBzZXQgdXAgYSBjb25kaXRpb25hbCBzbG90IGNvbXBvbmVudCBvbiBjb25uZWN0ZWRDYWxsYmFjay5cbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50XG4gKiBAZGVwcmVjYXRlZCBVc2UgYG9uU2xvdGNoYW5nZWAgZXZlbnQgd2l0aCBgc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudGAgRE9NIHV0aWxpdHkgaW5zdGVhZC5cbiAqXG4gKiBgYGBcbiAqIDxzbG90IG9uU2xvdGNoYW5nZT17KGV2ZW50KSA9PiB0aGlzLm15U2xvdEhhc0VsZW1lbnQgPSBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50KGV2ZW50KX0gLz59XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudChjb21wb25lbnQpIHtcbiAgaWYgKCFtdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgbXV0YXRpb25PYnNlcnZlciA9IGNyZWF0ZU9ic2VydmVyKFwibXV0YXRpb25cIiwgcHJvY2Vzc011dGF0aW9ucyk7XG4gIH1cbiAgbXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKGNvbXBvbmVudC5lbCwgb2JzZXJ2ZXJPcHRpb25zKTtcbn1cbi8qKlxuICogSGVscGVyIHRvIHRlYXIgZG93biBhIGNvbmRpdGlvbmFsIHNsb3QgY29tcG9uZW50IG9uIGRpc2Nvbm5lY3RlZENhbGxiYWNrLlxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqIEBkZXByZWNhdGVkIFVzZSBgb25TbG90Y2hhbmdlYCBldmVudCB3aXRoIGBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50YCBET00gdXRpbGl0eSBpbnN0ZWFkLlxuICpcbiAqIGBgYFxuICogPHNsb3Qgb25TbG90Y2hhbmdlPXsoZXZlbnQpID0+IHRoaXMubXlTbG90SGFzRWxlbWVudCA9IHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQoZXZlbnQpfSAvPn1cbiAqIGBgYFxuICovXG5mdW5jdGlvbiBkaXNjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50KGNvbXBvbmVudCkge1xuICBvYnNlcnZlZC5kZWxldGUoY29tcG9uZW50LmVsKTtcbiAgLy8gd2UgZXhwbGljaXRseSBwcm9jZXNzIHF1ZXVlZCBtdXRhdGlvbnMgYW5kIGRpc2Nvbm5lY3QgYW5kIHJlY29ubmVjdFxuICAvLyB0aGUgb2JzZXJ2ZXIgdW50aWwgTXV0YXRpb25PYnNlcnZlciBnZXRzIGFuIGB1bm9ic2VydmVgIG1ldGhvZFxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3doYXR3Zy9kb20vaXNzdWVzLzEyNlxuICBwcm9jZXNzTXV0YXRpb25zKG11dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKSk7XG4gIG11dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICBmb3IgKGNvbnN0IFtlbGVtZW50XSBvZiBvYnNlcnZlZC5lbnRyaWVzKCkpIHtcbiAgICBtdXRhdGlvbk9ic2VydmVyLm9ic2VydmUoZWxlbWVudCwgb2JzZXJ2ZXJPcHRpb25zKTtcbiAgfVxufVxuZnVuY3Rpb24gcHJvY2Vzc011dGF0aW9ucyhtdXRhdGlvbnMpIHtcbiAgbXV0YXRpb25zLmZvckVhY2goKHsgdGFyZ2V0IH0pID0+IHtcbiAgICBmb3JjZVVwZGF0ZSh0YXJnZXQpO1xuICB9KTtcbn1cblxuZXhwb3J0IHsgY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCBhcyBjLCBkaXNjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50IGFzIGQgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uZGl0aW9uYWxTbG90LWE0ODM3Y2FmLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjAuNVxuICovXG5mdW5jdGlvbiBub29wQ2xpY2soKSB7XG4gIC8qKiBub29wICovXG59XG4vKipcbiAqIFRoaXMgaGVscGVyIHVwZGF0ZXMgdGhlIGhvc3QgZWxlbWVudCB0byBwcmV2ZW50IGtleWJvYXJkIGludGVyYWN0aW9uIG9uIGl0cyBzdWJ0cmVlIGFuZCBzZXRzIHRoZSBhcHByb3ByaWF0ZSBhcmlhIGF0dHJpYnV0ZSBmb3IgYWNjZXNzaWJpbGl0eS5cbiAqXG4gKiBUaGlzIHNob3VsZCBiZSB1c2VkIGluIHRoZSBgY29tcG9uZW50RGlkUmVuZGVyYCBsaWZlY3ljbGUgaG9vay5cbiAqXG4gKiAqKk5vdGVzKipcbiAqXG4gKiB0aGlzIHV0aWwgaXMgbm90IG5lZWRlZCBmb3Igc2ltcGxlIGNvbXBvbmVudHMgd2hvc2Ugcm9vdCBlbGVtZW50IG9yIGVsZW1lbnRzIGFyZSBhbiBpbnRlcmFjdGl2ZSBjb21wb25lbnQgKGN1c3RvbSBlbGVtZW50IG9yIG5hdGl2ZSBjb250cm9sKS4gRm9yIHRob3NlIGNhc2VzLCBzZXQgdGhlIGBkaXNhYmxlZGAgcHJvcHMgb24gdGhlIHJvb3QgY29tcG9uZW50cyBpbnN0ZWFkLlxuICogdGVjaG5pY2FsbHksIHVzZXJzIGNhbiBvdmVycmlkZSBgdGFiaW5kZXhgIGFuZCByZXN0b3JlIGtleWJvYXJkIG5hdmlnYXRpb24sIGJ1dCB0aGlzIHdpbGwgYmUgY29uc2lkZXJlZCB1c2VyIGVycm9yXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICogQHBhcmFtIGhvc3RJc1RhYmJhYmxlXG4gKi9cbmZ1bmN0aW9uIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbihjb21wb25lbnQsIGhvc3RJc1RhYmJhYmxlID0gZmFsc2UpIHtcbiAgaWYgKGNvbXBvbmVudC5kaXNhYmxlZCkge1xuICAgIGNvbXBvbmVudC5lbC5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCBcIi0xXCIpO1xuICAgIGNvbXBvbmVudC5lbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcbiAgICBpZiAoY29tcG9uZW50LmVsLmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpKSB7XG4gICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICB9XG4gICAgY29tcG9uZW50LmVsLmNsaWNrID0gbm9vcENsaWNrO1xuICAgIHJldHVybjtcbiAgfVxuICBjb21wb25lbnQuZWwuY2xpY2sgPSBIVE1MRWxlbWVudC5wcm90b3R5cGUuY2xpY2s7XG4gIGlmICh0eXBlb2YgaG9zdElzVGFiYmFibGUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgIGNvbXBvbmVudC5lbC5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCBob3N0SXNUYWJiYWJsZS5jYWxsKGNvbXBvbmVudCkgPyBcIjBcIiA6IFwiLTFcIik7XG4gIH1cbiAgZWxzZSBpZiAoaG9zdElzVGFiYmFibGUgPT09IHRydWUpIHtcbiAgICBjb21wb25lbnQuZWwuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgXCIwXCIpO1xuICB9XG4gIGVsc2UgaWYgKGhvc3RJc1RhYmJhYmxlID09PSBmYWxzZSkge1xuICAgIGNvbXBvbmVudC5lbC5yZW1vdmVBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiKTtcbiAgfVxuICBlbHNlIDtcbiAgY29tcG9uZW50LmVsLnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtZGlzYWJsZWRcIik7XG59XG5cbmV4cG9ydCB7IHVwZGF0ZUhvc3RJbnRlcmFjdGlvbiBhcyB1IH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWludGVyYWN0aXZlLTI5OTk1NTIyLmpzLm1hcCIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjAuNVxuICovXG4vKipcbiAqIFRoaXMgdXRpbGl0eSBlbnN1cmVzIG9ic2VydmVycyBhcmUgY3JlYXRlZCBvbmx5IGZvciBicm93c2VyIGNvbnRleHRzLlxuICpcbiAqIEBwYXJhbSB0eXBlIC0gdGhlIHR5cGUgb2Ygb2JzZXJ2ZXIgdG8gY3JlYXRlXG4gKiBAcGFyYW0gY2FsbGJhY2sgLSB0aGUgb2JzZXJ2ZXIgY2FsbGJhY2tcbiAqIEBwYXJhbSBvcHRpb25zIC0gdGhlIG9ic2VydmVyIG9wdGlvbnNcbiAqL1xuZnVuY3Rpb24gY3JlYXRlT2JzZXJ2ZXIodHlwZSwgY2FsbGJhY2ssIG9wdGlvbnMpIHtcbiAgY29uc3QgT2JzZXJ2ZXIgPSBnZXRPYnNlcnZlcih0eXBlKTtcbiAgcmV0dXJuIG5ldyBPYnNlcnZlcihjYWxsYmFjaywgb3B0aW9ucyk7XG59XG5mdW5jdGlvbiBnZXRPYnNlcnZlcih0eXBlKSB7XG4gIC8vIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS93aGF0d2cvZG9tL2lzc3Vlcy8xMjYjaXNzdWVjb21tZW50LTEwNDk4MTQ5NDhcbiAgY2xhc3MgRXh0ZW5kZWRNdXRhdGlvbk9ic2VydmVyIGV4dGVuZHMgd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKGNhbGxiYWNrKSB7XG4gICAgICBzdXBlcihjYWxsYmFjayk7XG4gICAgICB0aGlzLm9ic2VydmVkRW50cnkgPSBbXTtcbiAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG4gICAgb2JzZXJ2ZSh0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZWRFbnRyeS5wdXNoKHsgdGFyZ2V0LCBvcHRpb25zIH0pO1xuICAgICAgcmV0dXJuIHN1cGVyLm9ic2VydmUodGFyZ2V0LCBvcHRpb25zKTtcbiAgICB9XG4gICAgdW5vYnNlcnZlKHRhcmdldCkge1xuICAgICAgY29uc3QgbmV3T2JzZXJ2ZWRFbnRyaWVzID0gdGhpcy5vYnNlcnZlZEVudHJ5LmZpbHRlcigob2JzZXJ2ZWQpID0+IG9ic2VydmVkLnRhcmdldCAhPT0gdGFyZ2V0KTtcbiAgICAgIHRoaXMub2JzZXJ2ZWRFbnRyeSA9IFtdO1xuICAgICAgdGhpcy5jYWxsYmFjayhzdXBlci50YWtlUmVjb3JkcygpLCB0aGlzKTtcbiAgICAgIHRoaXMuZGlzY29ubmVjdCgpO1xuICAgICAgbmV3T2JzZXJ2ZWRFbnRyaWVzLmZvckVhY2goKG9ic2VydmVkKSA9PiB0aGlzLm9ic2VydmUob2JzZXJ2ZWQudGFyZ2V0LCBvYnNlcnZlZC5vcHRpb25zKSk7XG4gICAgfVxuICB9XG4gIHJldHVybiAoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAodHlwZSA9PT0gXCJpbnRlcnNlY3Rpb25cIlxuICAgICAgPyB3aW5kb3cuSW50ZXJzZWN0aW9uT2JzZXJ2ZXJcbiAgICAgIDogdHlwZSA9PT0gXCJtdXRhdGlvblwiXG4gICAgICAgID8gRXh0ZW5kZWRNdXRhdGlvbk9ic2VydmVyXG4gICAgICAgIDogd2luZG93LlJlc2l6ZU9ic2VydmVyKTtcbiAgfSkoKTtcbn1cblxuZXhwb3J0IHsgY3JlYXRlT2JzZXJ2ZXIgYXMgYyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZlcnMtNTY3NDBlOTkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9