"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-1b7d85"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-cte-weighted-overlay-table-editor-7b97df1d.js":
/*!**********************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-cte-weighted-overlay-table-editor-7b97df1d.js ***!
  \**********************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   R: () => (/* binding */ RfxCteWeightedOverlayTableEditor)
/* harmony export */ });
/* harmony import */ var _index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-da1b7138.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/index-da1b7138.js");
/* harmony import */ var _arcgis_core_core_lang_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @arcgis/core/core/lang.js */ "@arcgis/core/core/lang.js");
/* harmony import */ var _localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./localization-helper-4819b67d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/localization-helper-4819b67d.js");
/* harmony import */ var _type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./type-gaurds-1840747f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/type-gaurds-1840747f.js");
/* harmony import */ var _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ui-utils-928a4096.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/ui-utils-928a4096.js");
/* harmony import */ var _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./interfaces-d0c68944.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-d0c68944.js");
/* harmony import */ var _layer_helper_3867eef7_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./layer-helper-3867eef7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/layer-helper-3867eef7.js");
/* harmony import */ var _arcgis_core_rest_support_AlgorithmicColorRamp_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @arcgis/core/rest/support/AlgorithmicColorRamp.js */ "@arcgis/core/rest/support/AlgorithmicColorRamp.js");
/* harmony import */ var _arcgis_core_rest_support_MultipartColorRamp_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @arcgis/core/rest/support/MultipartColorRamp.js */ "@arcgis/core/rest/support/MultipartColorRamp.js");
/* harmony import */ var _arcgis_core_Color_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @arcgis/core/Color.js */ "@arcgis/core/Color.js");
/* harmony import */ var _colorRampUtils_8bdd46c5_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./colorRampUtils-8bdd46c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/colorRampUtils-8bdd46c5.js");
/* harmony import */ var _sanitize_number_d84114f7_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./sanitize-number-d84114f7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/sanitize-number-d84114f7.js");
/* harmony import */ var _arcgis_core_rest_geoprocessor_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @arcgis/core/rest/geoprocessor.js */ "@arcgis/core/rest/geoprocessor.js");
/* harmony import */ var _arcgis_core_request_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @arcgis/core/request.js */ "@arcgis/core/request.js");
/* harmony import */ var _arcgis_core_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @arcgis/core/portal/PortalItem.js */ "@arcgis/core/portal/PortalItem.js");
















const component = "rfx-cte-weighted-overlay-table-editor";
const HTMLClasses = {
    colorRed: `${component}__color-red`,
    grid: `${component}__grid`,
    layerColumn: `${component}__layer-column`,
    influenceColumn: `${component}__influence-column`,
    fieldColumn: `${component}__field-column`,
    valueColumn: `${component}__value-column`,
    scaleColumn: `${component}__scale-column`
};
const HelpClickHandlerKeys = {
    weightedOverlayTableHelpClickHandler: "weightedOverlayTableHelpClickHandler",
    remapTableHelpClickHandler: "remapTableHelpClickHandler",
    scalesHelpClickHandler: "scalesHelpClickHandler"
};
const DefaultScalesOptions = [
    { key: "1-3", label: "1-3" },
    { key: "1-5", label: "1-5" },
    { key: "1-7", label: "1-7" },
    { key: "1-9", label: "1-9" },
    { key: "1-10", label: "1-10" },
    { key: "1-20", label: "1-20" },
    { key: "1-25", label: "1-25" },
    { key: "1-50", label: "1-50" },
    { key: "1-75", label: "1-75" },
    { key: "1-100", label: "1-100" }
];

const rfxCteWeightedOverlayTableEditorCss = ":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh}.rfx-cte-weighted-overlay-table-editor__grid table{width:100%;table-layout:fixed}.rfx-cte-weighted-overlay-table-editor__grid table thead tr th:first-child{width:7%}.rfx-cte-weighted-overlay-table-editor__grid table thead tr th:last-child{width:7%}.rfx-cte-weighted-overlay-table-editor__grid table tbody tr td:first-child{width:7%}.rfx-cte-weighted-overlay-table-editor__grid table tbody tr td:last-child{width:7%}.rfx-cte-weighted-overlay-table-editor__color-red{color:red}.rfx-cte-weighted-overlay-table-editor__layer-column{width:40%}.rfx-cte-weighted-overlay-table-editor__influence-column{width:16%}.rfx-cte-weighted-overlay-table-editor__field-column{width:30%}.rfx-cte-weighted-overlay-table-editor__scale-column{width:30%}";

const RfxCteWeightedOverlayTableEditor = class {
    constructor(hostRef) {
        (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.rfxArgumentChange = (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "rfxArgumentChange", 7);
        /**
         * Stores event handlers for help action click, stored in connected callback to avoid
         * fetching function on each render ( to avoid common bad practice )
         */
        this.helpActionClickEventHandlers = new Map();
        /**
         * scales options for scales select
         */
        this.scalesOptions = DefaultScalesOptions;
        // Refresh the remaps grid when this.selectedRowId is changed or the corresponding layer/field is changed
        this.refreshRemapsGrid = () => {
            const remapsGridOptions = this.getRemapGridData();
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(remapsGridOptions)) {
                return;
            }
            this.remapsGridSchema = {
                ...this.remapsGridSchema,
                gridOptions: remapsGridOptions
            };
        };
        // Event handler for grid row click
        this.handleGridRowClick = (event) => {
            const { detail: { gridOptions, rowIndex } } = event;
            if (rowIndex < 0 || rowIndex > gridOptions?.length - 1) {
                return;
            }
            this.selectedRowId = rowIndex;
            this.refreshRemapsGrid();
        };
        // Event handler for grid options change on weighted overlay table
        this.updateValue_weightedOverlayTable = async (event) => {
            const { detail: { gridOptions, rowIndex } } = event;
            const inputArgs = this.inputArgs;
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(gridOptions) || (0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(inputArgs)) {
                return;
            }
            const rastersValueElements = [], influenceValues = [], fieldValues = [];
            let sumOfInfluence = 0, hasSumOfInfluenceChanged = false;
            gridOptions.forEach((dataObj, index) => {
                if (index === gridOptions.length - 1) {
                    return; // last is a placeholder
                }
                const { layer, influence, field } = dataObj;
                if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(layer) || (0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(field)) {
                    return;
                }
                rastersValueElements.push(layer);
                fieldValues.push(field);
                let influenceVal = (0,_sanitize_number_d84114f7_js__WEBPACK_IMPORTED_MODULE_11__.p)(influence);
                if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(influenceVal) || isNaN(influenceVal)) {
                    // set default value for influence
                    influenceVal = index === 0 ? 100 : 0;
                }
                sumOfInfluence += influenceVal;
                influenceValues.push(influenceVal / 100); // in RFT JSON, the influence values are in decimals
            });
            if (sumOfInfluence !== this.sumOfInfluence) {
                hasSumOfInfluenceChanged = true;
                this.updateSumOfInfluenceElement(sumOfInfluence);
            }
            // Set inputArgs for Raster Function Template
            const rasters = inputArgs.Rasters, influences = inputArgs.Influences, fields = inputArgs.Fields, remaps = inputArgs.Remaps;
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(rasters.value)) {
                rasters.value = { elements: rastersValueElements, type: "ArgumentArray" };
            }
            else {
                rasters.value.elements = rastersValueElements;
            }
            influences.value = influenceValues;
            fields.value = fieldValues;
            // check difference happened in weighted overlay grid, and update remaps grid
            let updatedDataObj;
            // when a new row has been added
            if (gridOptions.length > this.weightedOverlayGridOptionsLength) {
                updatedDataObj = gridOptions[rowIndex];
            }
            // when some row has been deleted
            else if (gridOptions.length < this.weightedOverlayGridOptionsLength) {
                this.deleteLayerRemapStr(rowIndex);
                this.selectedRowId = rowIndex + 1;
            }
            // when some row has been updated
            else if (gridOptions.length === this.weightedOverlayGridOptionsLength) {
                if (!hasSumOfInfluenceChanged) {
                    // when either layer or field has been changed
                    updatedDataObj = gridOptions[rowIndex];
                }
            }
            // only initialize remapStr for newly added or changed layer, keep other layers' remapStrs as they were
            if (remaps?.value && updatedDataObj?.layer?.value) {
                this.selectedRowId = rowIndex;
                // initialize remapStr for dataObj layer, and update/insert remapStr into remaps.value
                const dataLength = gridOptions.length - 1;
                await this.initLayerRemapStr(updatedDataObj, rowIndex, dataLength);
            }
            // refresh remaps table
            this.refreshRemapsGrid();
            // update the temp this.weightedOverlayGridOptionsLength
            this.weightedOverlayGridOptionsLength = gridOptions.length;
        };
        // Event handler for grid options change on remaps table
        this.updateValue_remapTable = (event) => {
            const { detail: { gridOptions } } = event;
            const inputArgs = this.inputArgs;
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(gridOptions) || (0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(inputArgs)) {
                return;
            }
            const remaps = inputArgs.Remaps, remapsValueLength = remaps?.value?.length;
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(remapsValueLength) ||
                remapsValueLength < 1 ||
                this.selectedRowId < 0 ||
                this.selectedRowId > remapsValueLength - 1) {
                return;
            }
            // update remaps.value[this.selectedRowId] (typeof string)
            let remapStr = "";
            const dataLength = gridOptions.length - 1;
            gridOptions.forEach(function (dataObj, index) {
                const { value, scale } = dataObj;
                if (!(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(value) && !(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(scale?.value)) {
                    let valueStr = value;
                    const scaleStr = scale.value;
                    if (typeof value === "string") {
                        // add single quotes around those string-type remapValues which contains spaces
                        valueStr = value.indexOf(" ") > -1 ? "'" + value + "'" : value;
                    }
                    remapStr += valueStr + " " + scaleStr;
                    if (index < dataLength - 1) {
                        remapStr += " ; ";
                    }
                }
            });
            remaps.value[this.selectedRowId] = remapStr;
        };
        // Event handler for scales select value change
        this.updateValue_scales = async (event) => {
            event.stopPropagation();
            const element = event.target;
            const value = element.value;
            // get the pair of evalFrom and evalTo, such as ["1", "9"]
            const evalValues = value.replace(/\s/g, "").split("-");
            if (evalValues.length !== 2) {
                return;
            }
            const evalFrom = parseInt(evalValues[0], 10), evalTo = parseInt(evalValues[1], 10);
            if (isNaN(evalFrom) || isNaN(evalTo) || evalFrom > evalTo) {
                return;
            }
            this.evalScales = {
                evalFrom: evalFrom,
                evalTo: evalTo
            };
            this.inputArgs.EvalFrom.value = evalFrom;
            this.inputArgs.EvalTo.value = evalTo;
            const rowIndex = this.selectedRowId;
            const dataObj = this.weightedOverlayGridSchema.gridOptions?.[rowIndex];
            const dataLength = this.weightedOverlayGridSchema.gridOptions?.length;
            await this.initLayerRemapStr(dataObj, rowIndex, dataLength);
            this.refreshRemapsGrid();
        };
        this.weightedOverlayGridSchema = {
            canAdd: true,
            gridLayout: {},
            gridOptions: [],
            hasBorder: true,
            hasHeader: true,
            hasIdColumn: true
        };
        this.remapsGridSchema = {
            canAdd: true,
            gridLayout: {},
            gridOptions: [],
            hasBorder: true,
            hasHeader: true,
            hasIdColumn: true
        };
        this.sumOfInfluence = 0;
        this.evalScales = undefined;
        this.widgetArgs = undefined;
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    async componentWillLoad() {
        ({ strings: this.strings, dir: this.direction } = await (0,_localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_2__.b)(this.hostElement, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.g)(".")));
        const { inputArgs, inputLayers } = this.widgetArgs;
        this.inputArgs = inputArgs;
        this.inputLayers = inputLayers;
        this.initScalesSelectOptions();
        this.initGrids();
    }
    componentDidLoad() {
        this.attachHelpClickEventHandlers();
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    attachHelpClickEventHandlers() {
        const weightedOverlayTableHelpClickHandler = this.widgetArgs.onHelpActionClick({
            heading: this.strings.weightedOverlayTable,
            referenceElement: this.weightedOverlayTableLabelElement,
            helpTextID: this.widgetArgs.helpTextIDs?.weightedoverlay_weightedoverlaytable
        });
        this.helpActionClickEventHandlers.set(HelpClickHandlerKeys.weightedOverlayTableHelpClickHandler, weightedOverlayTableHelpClickHandler);
        const remapTableHelpClickHandler = this.widgetArgs.onHelpActionClick({
            heading: this.strings.remapTable,
            referenceElement: this.remapTableLabelElement,
            helpTextID: this.widgetArgs.helpTextIDs?.weightedoverlay_remaptable
        });
        this.helpActionClickEventHandlers.set(HelpClickHandlerKeys.remapTableHelpClickHandler, remapTableHelpClickHandler);
        const scalesHelpClickHandler = this.widgetArgs.onHelpActionClick({
            heading: this.strings.scales,
            referenceElement: this.scalesLabelElement,
            helpTextID: this.widgetArgs.helpTextIDs?.weightedoverlay_scales
        });
        this.helpActionClickEventHandlers.set(HelpClickHandlerKeys.scalesHelpClickHandler, scalesHelpClickHandler);
    }
    async getSelectedLayer(url) {
        const sanitizedUrl = (0,_layer_helper_3867eef7_js__WEBPACK_IMPORTED_MODULE_6__.g)(url);
        const selectedLayer = this.inputLayers.find((layer) => layer.url === sanitizedUrl);
        if (selectedLayer) {
            await selectedLayer.load();
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.l)(selectedLayer)) {
                // calculate necessary info and add to the ImageryLayerArg for other widgets to use
                try {
                    // use ImageryLayer.rasterFunction instead of renderingRule as it is deprecated since 4.27
                    selectedLayer.rasterInfo = await selectedLayer.generateRasterInfo(selectedLayer.rasterFunction);
                }
                catch (error) {
                    console.error(error);
                }
            }
        }
        return selectedLayer;
    }
    getScaleOptions() {
        const scaleOptions = [];
        for (let i = this.evalScales.evalFrom; i <= this.evalScales.evalTo; i++) {
            scaleOptions.push({ key: i.toString(), label: i.toString() });
        }
        scaleOptions.push({ key: "NODATA", label: "NODATA" });
        scaleOptions.push({ key: "RESTRICTED", label: "RESTRICTED" });
        return scaleOptions;
    }
    getDefaultGridOption_weightedOverlayTable() {
        return {
            id: 0,
            layer: undefined,
            field: undefined,
            influence: 0
        };
    }
    getDefaultGridOption_remapTable() {
        return {
            id: 0,
            value: undefined,
            scale: { options: this.getScaleOptions(), value: undefined }
        };
    }
    // get the corresponding data from inputArgs.Remaps for displaying on remap grid
    getRemapGridData() {
        const remaps = this.inputArgs?.Remaps, selectedIndex = this.selectedRowId, data = [];
        if (selectedIndex < 0 || selectedIndex > remaps?.value?.length - 1) {
            return data;
        }
        if (remaps?.value?.[selectedIndex]) {
            const remapStr = remaps.value[selectedIndex], remapArr = remapStr.split(";");
            remapArr.forEach((remapPairStr, index) => {
                // trim each remapPairStr then split by spaces but skip those in single quotes
                const remapPairArr = remapPairStr.trim().match(/(?:[^\s']+|'[^']*')+/g);
                if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(remapPairArr) || remapPairArr.length !== 2) {
                    return;
                }
                let remapValue = remapPairArr[0];
                const remapScale = remapPairArr[1];
                if (remapValue.indexOf("'") > -1) {
                    // remove single quotes before displaying on grid
                    remapValue = remapValue.replace(/[']+/g, "");
                }
                data.push({
                    id: index,
                    value: remapValue,
                    scale: { options: this.getScaleOptions(), value: remapScale }
                });
            });
            // add a blank data object as the last row on remaps grid
            const dataLength = data.length;
            data.push({
                id: dataLength,
                value: undefined,
                scale: { options: this.getScaleOptions(), value: undefined }
            });
        }
        else {
            // add a blank data object
            data.push(this.getDefaultGridOption_remapTable());
        }
        return data;
    }
    /**
     * Read inputArgs and create an array of data objects as grid options based on the input args values.
     * @returns {any[]} The result array of data objects as grid options.
     */
    readArgValues() {
        if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(this.inputArgs)) {
            return;
        }
        const inputArgs = this.inputArgs;
        const weightedOverlayGridOptions = [], // gridOptions of weightedOverlayGrid (Rasters, Influences, Fields)
        rasters = inputArgs.Rasters, fields = inputArgs.Fields, influences = inputArgs.Influences, remaps = inputArgs.Remaps;
        let remapsGridOptions = [], // gridOptions of remapsGrid for each corresponding row on weightedOverlayGrid
        dataLength = 0, idx = 0;
        if (!(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(rasters) &&
            !(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(fields) &&
            !(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(influences) &&
            !(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(remaps)) {
            dataLength = Math.max(rasters.value?.elements?.length || 0, fields.value?.length || 0, influences.value?.length || 0, remaps.value?.length || 0);
            remaps.value = remaps.value ?? [];
        }
        if (dataLength === 0 || isNaN(dataLength)) {
            // add blank data object to each grid
            weightedOverlayGridOptions.push(this.getDefaultGridOption_weightedOverlayTable());
            remapsGridOptions.push(this.getDefaultGridOption_remapTable());
            return [weightedOverlayGridOptions, remapsGridOptions];
        }
        while (idx < dataLength) {
            weightedOverlayGridOptions.push({
                id: idx,
                layer: rasters?.value?.elements?.[idx],
                field: fields?.value?.[idx],
                influence: influences?.value && ((influences.value[idx] * 100).toFixed(2) || (idx > 0 ? 0 : 100))
            });
            idx += 1;
        }
        if (remaps?.value?.length > 0) {
            // push remaps[0] data to remapsGridOptions as an array
            if (weightedOverlayGridOptions?.length > 0 &&
                weightedOverlayGridOptions[0]?.layer?.value &&
                weightedOverlayGridOptions[0]?.field) {
                this.selectedRowId = 0;
                remapsGridOptions = this.getRemapGridData();
            }
        }
        else {
            // initialize remaps.value if empty
            for (let i = 0; i < dataLength; i++) {
                remaps.value.push("");
            }
        }
        return [weightedOverlayGridOptions, remapsGridOptions];
    }
    initGrids() {
        const weightedOverlayGridLayout = {
            layer: {
                allowScalar: false,
                label: this.strings.layer,
                uiType: _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_5__.G.raster,
                style: HTMLClasses.layerColumn
            },
            influence: {
                label: this.strings.influence,
                uiType: _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_5__.G.number,
                style: HTMLClasses.influenceColumn
            },
            field: {
                label: this.strings.field,
                uiType: _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_5__.G.field,
                style: HTMLClasses.fieldColumn
            }
        };
        const remapsGridLayout = {
            value: {
                label: this.strings.value,
                uiType: _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_5__.G.textInput,
                style: HTMLClasses.valueColumn
            },
            scale: {
                label: this.strings.scale,
                uiType: _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_5__.G.select,
                style: HTMLClasses.scaleColumn
            }
        };
        const dataArray = this.readArgValues();
        const weightedOverlayGridOptions = dataArray[0], remapsGridOptions = dataArray[1];
        this.weightedOverlayGridOptionsLength = weightedOverlayGridOptions?.length ?? 0;
        this.weightedOverlayGridSchema = {
            ...this.weightedOverlayGridSchema,
            gridLayout: weightedOverlayGridLayout,
            gridOptions: weightedOverlayGridOptions
        };
        this.remapsGridSchema = {
            ...this.remapsGridSchema,
            gridLayout: remapsGridLayout,
            gridOptions: remapsGridOptions
        };
    }
    initScalesSelectOptions() {
        if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(this.inputArgs)) {
            return;
        }
        const { EvalFrom, EvalTo } = this.inputArgs;
        const evalFromValue = EvalFrom?.value ?? 1, //defaultValue from schema is 1
        evalToValue = EvalTo?.value ?? 9; //defaultValue from schema is 9
        this.evalScales = {
            evalFrom: evalFromValue,
            evalTo: evalToValue
        };
        const scalesStr = `${evalFromValue}-${evalToValue}`;
        if (!this.scalesOptions.some((scalesOption) => scalesOption.key === scalesStr)) {
            this.scalesOptions.push({ key: scalesStr, label: scalesStr });
        }
    }
    updateSumOfInfluenceElement(sumOfInfluence) {
        this.sumOfInfluence = sumOfInfluence;
        // change color to red if sumOfInfluence > 100
        if (sumOfInfluence > 100) {
            this.sumOfInfluenceElement.classList.add(HTMLClasses.colorRed);
        }
        else {
            this.sumOfInfluenceElement.classList.remove(HTMLClasses.colorRed);
        }
    }
    // initialize the remap string for newly added/selected layer
    async initLayerRemapStr(dataObj, rowIndex, dataLength) {
        if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(dataObj) || rowIndex < 0 || dataLength <= 0 || rowIndex > dataLength - 1) {
            return;
        }
        const { layer, field } = dataObj;
        const { evalFrom, evalTo } = this.evalScales;
        if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(layer) || (0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(field)) {
            return;
        }
        const layerObj = await this.getSelectedLayer(layer.value?.url);
        if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(layerObj)) {
            return;
        }
        let remapStr = "";
        // If newly added/selected layer has RAT, automatically update the corresponding remap string
        // Since JSAPI-4.14 `hasRasterAttributeTable` moved to under `layer.sourceJSON`
        if (layerObj.sourceJSON?.hasRasterAttributeTable && field) {
            const rat = (0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.l)(layerObj)
                ? layerObj.serviceRasterInfo.attributeTable
                : layerObj.rasterInfo.attributeTable;
            const features = rat?.features;
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_3__.i)(features)) {
                return;
            }
            const remapValues = features
                .map((feature) => feature.attributes[field])
                .filter(function (val, pos, self) {
                return self.indexOf(val) === pos;
            });
            // sort the remapValues array if values are numbers
            if (remapValues?.length > 1 && !isNaN(remapValues[0])) {
                remapValues.sort(function (a, b) {
                    return a - b;
                });
            }
            const remapArr = remapValues.map(function (val, pos) {
                if (typeof val === "string") {
                    // add single quotes around those string-type remapValues which contains spaces
                    val = val.indexOf(" ") > -1 ? "'" + val + "'" : val;
                }
                const scale = pos + evalFrom <= evalTo ? pos + evalFrom : evalFrom;
                return `${val} ${scale}`;
            });
            remapStr = remapArr.join(" ; ");
            // remap string example:
            // "Brush/transitional 1 ; Water 2 ; 'Barren land' 3 ; 'Built up' 4 ; Agriculture 5 ; Forest 6 ; Wetlands 7"
        }
        // After async returns, replace the corresponding remapStr in remaps
        const idx = rowIndex, remaps = this.inputArgs.Remaps, fields = this.inputArgs.Fields;
        // update field in inputArgs after async returns
        fields.value.splice(idx, 1, field);
        if (remaps.value.length === dataLength) {
            // when a row's Layer or Field has been changed, replace the corresponding remapStr in remaps
            remaps.value.splice(idx, 1, remapStr);
        }
        if (remaps.value.length < dataLength) {
            // when a new row has been added, insert the new remapStr to remaps
            remaps.value.splice(idx, 0, remapStr);
        }
    }
    // Delete the remap str of layer at rowIndex
    deleteLayerRemapStr(idx) {
        const remaps = this.inputArgs.Remaps;
        remaps.value.splice(idx, 1);
    }
    render() {
        return ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", null, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { alignment: "start", scale: _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_4__.U.Scale, layout: "default", ref: (e) => {
                this.weightedOverlayTableLabelElement = e;
            } }, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-label", { label: this.strings.weightedOverlayTable, onRfxLabelHelpActionClick: () => this.helpActionClickEventHandlers?.get(HelpClickHandlerKeys.weightedOverlayTableHelpClickHandler)() }), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-grid", { canAdd: this.weightedOverlayGridSchema.canAdd, class: HTMLClasses.grid, gridLayout: this.weightedOverlayGridSchema.gridLayout, gridOptions: this.weightedOverlayGridSchema.gridOptions, hasBorder: this.weightedOverlayGridSchema.hasBorder, hasHeader: this.weightedOverlayGridSchema.hasHeader, hasIdColumn: this.weightedOverlayGridSchema.hasIdColumn, inputLayers: this.widgetArgs.inputLayers, onRfxGridRowClick: this.handleGridRowClick, onRfxGridOptionChange: this.updateValue_weightedOverlayTable, rfxBrowseLayerClick: this.widgetArgs.onRfxBrowseLayerClick })), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { alignment: "start", scale: _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_4__.U.Scale, layout: "inline-space-between" }, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", null, this.strings.sumOfInfluence), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { ref: (e) => {
                this.sumOfInfluenceElement = e;
            } }, this.sumOfInfluence)), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { alignment: "start", scale: _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_4__.U.Scale, layout: "default", ref: (e) => {
                this.remapTableLabelElement = e;
            } }, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-label", { label: this.strings.remapTable, onRfxLabelHelpActionClick: () => this.helpActionClickEventHandlers?.get(HelpClickHandlerKeys.remapTableHelpClickHandler)() }), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-grid", { canAdd: this.remapsGridSchema.canAdd, class: HTMLClasses.grid, gridLayout: this.remapsGridSchema.gridLayout, gridOptions: this.remapsGridSchema.gridOptions, hasBorder: this.remapsGridSchema.hasBorder, hasHeader: this.remapsGridSchema.hasHeader, hasIdColumn: this.remapsGridSchema.hasIdColumn, onRfxGridOptionChange: this.updateValue_remapTable })), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { alignment: "start", scale: _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_4__.U.Scale, layout: "default", ref: (e) => {
                this.scalesLabelElement = e;
            } }, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-label", { label: this.strings.scales, onRfxLabelHelpActionClick: () => this.helpActionClickEventHandlers?.get(HelpClickHandlerKeys.scalesHelpClickHandler)() }), (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-dtex-common-select", { allowCustomValues: true, options: this.scalesOptions, onRfxArgumentChange: this.updateValue_scales, value: `${this.evalScales.evalFrom}-${this.evalScales.evalTo}` }))));
    }
    static get assetsDirs() { return ["t9n"]; }
    get hostElement() { return (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.a)(this); }
};
RfxCteWeightedOverlayTableEditor.style = rfxCteWeightedOverlayTableEditorCss;



//# sourceMappingURL=rfx-cte-weighted-overlay-table-editor-7b97df1d.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-cte-weighted-overlay-table-editor.entry.js":
/*!*******************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-cte-weighted-overlay-table-editor.entry.js ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   rfx_cte_weighted_overlay_table_editor: () => (/* reexport safe */ _rfx_cte_weighted_overlay_table_editor_7b97df1d_js__WEBPACK_IMPORTED_MODULE_0__.R)
/* harmony export */ });
/* harmony import */ var _rfx_cte_weighted_overlay_table_editor_7b97df1d_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rfx-cte-weighted-overlay-table-editor-7b97df1d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-cte-weighted-overlay-table-editor-7b97df1d.js");
/* harmony import */ var _index_da1b7138_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-da1b7138.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/index-da1b7138.js");
/* harmony import */ var _arcgis_core_core_lang_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @arcgis/core/core/lang.js */ "@arcgis/core/core/lang.js");
/* harmony import */ var _localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./localization-helper-4819b67d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/localization-helper-4819b67d.js");
/* harmony import */ var _type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./type-gaurds-1840747f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/type-gaurds-1840747f.js");
/* harmony import */ var _getTag_96af029d_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_getTag-96af029d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/_getTag-96af029d.js");
/* harmony import */ var _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ui-utils-928a4096.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/ui-utils-928a4096.js");
/* harmony import */ var _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./interfaces-d0c68944.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-d0c68944.js");
/* harmony import */ var _layer_helper_3867eef7_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./layer-helper-3867eef7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/layer-helper-3867eef7.js");
/* harmony import */ var _arcgis_core_identity_IdentityManager_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @arcgis/core/identity/IdentityManager.js */ "@arcgis/core/identity/IdentityManager.js");
/* harmony import */ var _arcgis_core_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @arcgis/core/core/urlUtils.js */ "@arcgis/core/core/urlUtils.js");
/* harmony import */ var _arcgis_core_layers_Layer_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @arcgis/core/layers/Layer.js */ "@arcgis/core/layers/Layer.js");
/* harmony import */ var _arcgis_core_layers_ImageryLayer_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @arcgis/core/layers/ImageryLayer.js */ "@arcgis/core/layers/ImageryLayer.js");
/* harmony import */ var _arcgis_core_smartMapping_raster_renderers_stretch_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @arcgis/core/smartMapping/raster/renderers/stretch.js */ "@arcgis/core/smartMapping/raster/renderers/stretch.js");
/* harmony import */ var _common_fda1462e_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./common-fda1462e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/common-fda1462e.js");
/* harmony import */ var _arcgis_core_request_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @arcgis/core/request.js */ "@arcgis/core/request.js");
/* harmony import */ var _Uint8Array_68e1e3f9_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./_Uint8Array-68e1e3f9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/_Uint8Array-68e1e3f9.js");
/* harmony import */ var _arcgis_core_rest_support_AlgorithmicColorRamp_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @arcgis/core/rest/support/AlgorithmicColorRamp.js */ "@arcgis/core/rest/support/AlgorithmicColorRamp.js");
/* harmony import */ var _arcgis_core_rest_support_MultipartColorRamp_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @arcgis/core/rest/support/MultipartColorRamp.js */ "@arcgis/core/rest/support/MultipartColorRamp.js");
/* harmony import */ var _arcgis_core_Color_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @arcgis/core/Color.js */ "@arcgis/core/Color.js");
/* harmony import */ var _colorRampUtils_8bdd46c5_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./colorRampUtils-8bdd46c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/colorRampUtils-8bdd46c5.js");
/* harmony import */ var _sanitize_number_d84114f7_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./sanitize-number-d84114f7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/sanitize-number-d84114f7.js");
/* harmony import */ var _arcgis_core_rest_geoprocessor_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @arcgis/core/rest/geoprocessor.js */ "@arcgis/core/rest/geoprocessor.js");
/* harmony import */ var _arcgis_core_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! @arcgis/core/portal/PortalItem.js */ "@arcgis/core/portal/PortalItem.js");

























//# sourceMappingURL=rfx-cte-weighted-overlay-table-editor.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/sanitize-number-d84114f7.js":
/*!************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/sanitize-number-d84114f7.js ***!
  \************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ formatNumberToLocale),
/* harmony export */   f: () => (/* binding */ formatNumber),
/* harmony export */   i: () => (/* binding */ isValidNumber),
/* harmony export */   p: () => (/* binding */ parseNumber),
/* harmony export */   s: () => (/* binding */ sanitizeNumber)
/* harmony export */ });
/* harmony import */ var _localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./localization-helper-4819b67d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/localization-helper-4819b67d.js");
/* harmony import */ var _type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./type-gaurds-1840747f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/type-gaurds-1840747f.js");



/**
 * Indicates if a provided number value is valid.
 * An invalid value is: undefined | NaN | Infinite | -Infinite | null
 * See for more details:
 *   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isFinite
 *   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isNaN
 * @param {number | undefined | null} value value to check
 * @returns {boolean} if valid or not
 */
function isValidNumber(value) {
    return value !== undefined && value !== null && Number.isNaN(value) === false && Number.isFinite(value) === true;
}
/**
 * Returns a string representation of the provided number for use with calcite-input. It also
 * guards against invalid types following this logic:
 *   - If the value is valid (not NaN, finite), the value is returned as a string
 *   - If not and if a valid default value is provided, the default value is returned as a string
 *   - If not, an empty string is returned
 * @param value
 * @param defaultValue
 * @returns a sanitized string
 */
function sanitizeNumber(value, defaultValue) {
    let returnedValue;
    if (value !== null) {
        const testedValue = typeof value === "string" ? Number.parseFloat(value) : value;
        if (isValidNumber(testedValue))
            returnedValue = testedValue;
        else if (isValidNumber(defaultValue))
            returnedValue = defaultValue;
    }
    return returnedValue === undefined ? "" : `${returnedValue}`;
}
/**
 * Parses a value string to a number for use with calcite-input. If the string is empty, it will return undefined.
 * If the string is otherwise invalid, it will return NaN.
 * @param value calcite-input value
 * @returns {number | undefined} the parsed number
 */
function parseNumber(value) {
    if (value === "")
        return undefined;
    return Number.parseFloat(value);
}
/**
 * Formats a number to a specified number of decimal places.
 *
 * @param {number} value - The number to format.
 * @param {number} [fractionDigits=3] - The number of decimal places to include in the formatted number. Defaults to 3.
 * @returns {number|undefined} - The formatted number, or undefined if the input value is empty.
 */
function formatNumber(value, fractionDigits = 3) {
    if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_1__.i)(value))
        return undefined;
    return Number.parseFloat(value.toFixed(fractionDigits));
}
/**
 * Formats a number or string representing a number according to the locale, passing Intl number format options
 * https://developer.mozilla.org/en-US/docs/Web/JavaScript/ReferenceGlobal_Objects/Intl/NumberFormat/NumberFormat#options
 * @param {number | string | undefined} value to be formatted and localized
 * @param {Intl.NumberFormatOptions} formatOptions options object matching Intl.NumberFormat
 * @returns {string} localized / rounded string
 */
function formatNumberToLocale(value, formatOptions) {
    let formattedValue = "";
    if (!(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_1__.i)(value) && !Number.isNaN(value)) {
        const localeCode = (0,_localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_0__.g)().locale;
        formattedValue = Intl.NumberFormat(localeCode, formatOptions).format(Number(value));
    }
    return formattedValue;
}



//# sourceMappingURL=sanitize-number-d84114f7.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/ui-utils-928a4096.js":
/*!*****************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/ui-utils-928a4096.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CalciteScale),
/* harmony export */   U: () => (/* binding */ UIDefaults),
/* harmony export */   a: () => (/* binding */ CalciteOverlayPositioning)
/* harmony export */ });
const UIDefaults = {
    Scale: "s",
    PopoverTimer: 60
};
const CalciteScale = {
    s: "s",
    m: "m"
};
const CalciteOverlayPositioning = {
    absolute: "absolute",
    fixed: "fixed"
};



//# sourceMappingURL=ui-utils-928a4096.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3JfLTFiN2Q4NS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXFIO0FBQ2xGO0FBQ2tEO0FBQ0M7QUFDN0I7QUFDRTtBQUNlO0FBQ2Y7QUFDRjtBQUMxQjtBQUNPO0FBQzJCO0FBQ3RCO0FBQ1Y7QUFDVTs7QUFFM0M7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCLGFBQWEsVUFBVTtBQUN2QixvQkFBb0IsVUFBVTtBQUM5Qix3QkFBd0IsVUFBVTtBQUNsQyxvQkFBb0IsVUFBVTtBQUM5QixvQkFBb0IsVUFBVTtBQUM5QixvQkFBb0IsVUFBVTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sMEJBQTBCO0FBQ2hDLE1BQU0sMEJBQTBCO0FBQ2hDLE1BQU0sMEJBQTBCO0FBQ2hDLE1BQU0sMEJBQTBCO0FBQ2hDLE1BQU0sNEJBQTRCO0FBQ2xDLE1BQU0sNEJBQTRCO0FBQ2xDLE1BQU0sNEJBQTRCO0FBQ2xDLE1BQU0sNEJBQTRCO0FBQ2xDLE1BQU0sNEJBQTRCO0FBQ2xDLE1BQU07QUFDTjs7QUFFQSxtREFBbUQsOEJBQThCLG9DQUFvQyxvQ0FBb0Msb0NBQW9DLHVDQUF1Qyx1Q0FBdUMsc0NBQXNDLDRDQUE0Qyw0Q0FBNEMsbUNBQW1DLHFDQUFxQyxxQ0FBcUMscUNBQXFDLCtCQUErQiwrQkFBK0IsK0JBQStCLHFDQUFxQyxrQ0FBa0MsaUNBQWlDLGlDQUFpQyxpQ0FBaUMscUNBQXFDLDhCQUE4QiwwQkFBMEIsb0NBQW9DLHdCQUF3QixtQ0FBbUMsb0RBQW9ELHNDQUFzQyxzQ0FBc0Msa0NBQWtDLGlDQUFpQyxtREFBbUQsV0FBVyxtQkFBbUIsMkVBQTJFLFNBQVMsMEVBQTBFLFNBQVMsMkVBQTJFLFNBQVMsMEVBQTBFLFNBQVMsa0RBQWtELFVBQVUs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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixhQUFhLGtCQUFrQjtBQUMvQjtBQUNBO0FBQ0EsUUFBUSwyREFBZTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDZCQUE2QjtBQUN4QyxXQUFXLDBCQUEwQjtBQUNyQyxhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0EsU0FBUywyREFBZTtBQUN4QiwyQkFBMkIsbUVBQWE7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7O0FBRW1IOztBQUVuSDs7Ozs7Ozs7Ozs7Ozs7OztBQzdFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRThFOztBQUU5RSIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FyY2dpcy1yYXN0ZXItZnVuY3Rpb24tZWRpdG9yL2Rpc3QvZXNtL3JmeC1jdGUtd2VpZ2h0ZWQtb3ZlcmxheS10YWJsZS1lZGl0b3ItN2I5N2RmMWQuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3IvZGlzdC9lc20vcmZ4LWN0ZS13ZWlnaHRlZC1vdmVybGF5LXRhYmxlLWVkaXRvci5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcmNnaXMtcmFzdGVyLWZ1bmN0aW9uLWVkaXRvci9kaXN0L2VzbS9zYW5pdGl6ZS1udW1iZXItZDg0MTE0ZjcuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3IvZGlzdC9lc20vdWktdXRpbHMtOTI4YTQwOTYuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBnIGFzIGdldEFzc2V0UGF0aCwgaCwgYSBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC1kYTFiNzEzOC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9jb3JlL2xhbmcuanMnO1xuaW1wb3J0IHsgYiBhcyBmZXRjaENvbXBvbmVudExvY2FsZVN0cmluZ3MgfSBmcm9tICcuL2xvY2FsaXphdGlvbi1oZWxwZXItNDgxOWI2N2QuanMnO1xuaW1wb3J0IHsgaSBhcyBpc0VtcHR5RGF0YUl0ZW0sIGwgYXMgaXNJbWFnZXJ5TGF5ZXIgfSBmcm9tICcuL3R5cGUtZ2F1cmRzLTE4NDA3NDdmLmpzJztcbmltcG9ydCB7IFUgYXMgVUlEZWZhdWx0cyB9IGZyb20gJy4vdWktdXRpbHMtOTI4YTQwOTYuanMnO1xuaW1wb3J0IHsgRyBhcyBHcmlkQ29sdW1uIH0gZnJvbSAnLi9pbnRlcmZhY2VzLWQwYzY4OTQ0LmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0TGF5ZXJVcmxXaXRob3V0VG9rZW4gfSBmcm9tICcuL2xheWVyLWhlbHBlci0zODY3ZWVmNy5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXN0L3N1cHBvcnQvQWxnb3JpdGhtaWNDb2xvclJhbXAuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVzdC9zdXBwb3J0L011bHRpcGFydENvbG9yUmFtcC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9Db2xvci5qcyc7XG5pbXBvcnQgJy4vY29sb3JSYW1wVXRpbHMtOGJkZDQ2YzUuanMnO1xuaW1wb3J0IHsgcCBhcyBwYXJzZU51bWJlciB9IGZyb20gJy4vc2FuaXRpemUtbnVtYmVyLWQ4NDExNGY3LmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL3Jlc3QvZ2VvcHJvY2Vzc29yLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL3JlcXVlc3QuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcG9ydGFsL1BvcnRhbEl0ZW0uanMnO1xuXG5jb25zdCBjb21wb25lbnQgPSBcInJmeC1jdGUtd2VpZ2h0ZWQtb3ZlcmxheS10YWJsZS1lZGl0b3JcIjtcbmNvbnN0IEhUTUxDbGFzc2VzID0ge1xuICAgIGNvbG9yUmVkOiBgJHtjb21wb25lbnR9X19jb2xvci1yZWRgLFxuICAgIGdyaWQ6IGAke2NvbXBvbmVudH1fX2dyaWRgLFxuICAgIGxheWVyQ29sdW1uOiBgJHtjb21wb25lbnR9X19sYXllci1jb2x1bW5gLFxuICAgIGluZmx1ZW5jZUNvbHVtbjogYCR7Y29tcG9uZW50fV9faW5mbHVlbmNlLWNvbHVtbmAsXG4gICAgZmllbGRDb2x1bW46IGAke2NvbXBvbmVudH1fX2ZpZWxkLWNvbHVtbmAsXG4gICAgdmFsdWVDb2x1bW46IGAke2NvbXBvbmVudH1fX3ZhbHVlLWNvbHVtbmAsXG4gICAgc2NhbGVDb2x1bW46IGAke2NvbXBvbmVudH1fX3NjYWxlLWNvbHVtbmBcbn07XG5jb25zdCBIZWxwQ2xpY2tIYW5kbGVyS2V5cyA9IHtcbiAgICB3ZWlnaHRlZE92ZXJsYXlUYWJsZUhlbHBDbGlja0hhbmRsZXI6IFwid2VpZ2h0ZWRPdmVybGF5VGFibGVIZWxwQ2xpY2tIYW5kbGVyXCIsXG4gICAgcmVtYXBUYWJsZUhlbHBDbGlja0hhbmRsZXI6IFwicmVtYXBUYWJsZUhlbHBDbGlja0hhbmRsZXJcIixcbiAgICBzY2FsZXNIZWxwQ2xpY2tIYW5kbGVyOiBcInNjYWxlc0hlbHBDbGlja0hhbmRsZXJcIlxufTtcbmNvbnN0IERlZmF1bHRTY2FsZXNPcHRpb25zID0gW1xuICAgIHsga2V5OiBcIjEtM1wiLCBsYWJlbDogXCIxLTNcIiB9LFxuICAgIHsga2V5OiBcIjEtNVwiLCBsYWJlbDogXCIxLTVcIiB9LFxuICAgIHsga2V5OiBcIjEtN1wiLCBsYWJlbDogXCIxLTdcIiB9LFxuICAgIHsga2V5OiBcIjEtOVwiLCBsYWJlbDogXCIxLTlcIiB9LFxuICAgIHsga2V5OiBcIjEtMTBcIiwgbGFiZWw6IFwiMS0xMFwiIH0sXG4gICAgeyBrZXk6IFwiMS0yMFwiLCBsYWJlbDogXCIxLTIwXCIgfSxcbiAgICB7IGtleTogXCIxLTI1XCIsIGxhYmVsOiBcIjEtMjVcIiB9LFxuICAgIHsga2V5OiBcIjEtNTBcIiwgbGFiZWw6IFwiMS01MFwiIH0sXG4gICAgeyBrZXk6IFwiMS03NVwiLCBsYWJlbDogXCIxLTc1XCIgfSxcbiAgICB7IGtleTogXCIxLTEwMFwiLCBsYWJlbDogXCIxLTEwMFwiIH1cbl07XG5cbmNvbnN0IHJmeEN0ZVdlaWdodGVkT3ZlcmxheVRhYmxlRWRpdG9yQ3NzID0gXCI6cm9vdHstLWNhbGNpdGUtY29sb3ItYnJhbmQ6IzAwN2FjMjstLWNhbGNpdGUtY29sb3ItYnJhbmQtaG92ZXI6IzAwNjE5YjstLWNhbGNpdGUtY29sb3ItYnJhbmQtcHJlc3M6IzAwNDg3NDstLWNhbGNpdGUtY29sb3Itc3RhdHVzLWluZm86IzAwNjE5YjstLWNhbGNpdGUtY29sb3Itc3RhdHVzLXN1Y2Nlc3M6IzM1YWM0NjstLWNhbGNpdGUtY29sb3Itc3RhdHVzLXdhcm5pbmc6I2VkZDMxNzstLWNhbGNpdGUtY29sb3Itc3RhdHVzLWRhbmdlcjojZDgzMDIwOy0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtZGFuZ2VyLWhvdmVyOiNhODJiMWU7LS1jYWxjaXRlLWNvbG9yLXN0YXR1cy1kYW5nZXItcHJlc3M6IzdjMWQxMzstLWNhbGNpdGUtY29sb3ItYmFja2dyb3VuZDojZjhmOGY4Oy0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTE6I2ZmZmZmZjstLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0yOiNmM2YzZjM7LS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMzojZWFlYWVhOy0tY2FsY2l0ZS1jb2xvci10ZXh0LTE6IzE1MTUxNTstLWNhbGNpdGUtY29sb3ItdGV4dC0yOiM0YTRhNGE7LS1jYWxjaXRlLWNvbG9yLXRleHQtMzojNmE2YTZhOy0tY2FsY2l0ZS1jb2xvci10ZXh0LWludmVyc2U6I2ZmZmZmZjstLWNhbGNpdGUtY29sb3ItdGV4dC1saW5rOiMwMDYxOWI7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci0xOiNjYWNhY2E7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci0yOiNkNGQ0ZDQ7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci0zOiNkZmRmZGY7LS1jYWxjaXRlLWNvbG9yLWJvcmRlci1pbnB1dDojOTQ5NDk0Oy0tcmZ4LXF1YXJ0ZXItc3BhY2luZzowLjI1cmVtOy0tcmZ4LWhhbGYtc3BhY2luZzowLjVyZW07LS1yZngtdGhyZWUtcXVhcnRlci1zcGFjaW5nOjAuNzVyZW07LS1yZngtZnVsbC1zcGFjaW5nOjFyZW07LS1yZngtY29tcG9uZW50LWRlZmF1bHQtd2lkdGg6MTAwJTstLXJmeC11aS1ib3JkZXItaW5wdXQ6dmFyKC0tY2FsY2l0ZS1jb2xvci1ib3JkZXItMik7LS1yZngtcG9wb3Zlci1jb250ZW50LW1pbi1oZWlnaHQ6MzB2aDstLXJmeC1wb3BvdmVyLWNvbnRlbnQtbWF4LWhlaWdodDo2MHZoOy0tcmZ4LXBvcG92ZXItY29udGVudC1oZWlnaHQ6NDV2aDstLXJmeC13aWRnZXQtY29udGVudC1oZWlnaHQ6MzB2aH0ucmZ4LWN0ZS13ZWlnaHRlZC1vdmVybGF5LXRhYmxlLWVkaXRvcl9fZ3JpZCB0YWJsZXt3aWR0aDoxMDAlO3RhYmxlLWxheW91dDpmaXhlZH0ucmZ4LWN0ZS13ZWlnaHRlZC1vdmVybGF5LXRhYmxlLWVkaXRvcl9fZ3JpZCB0YWJsZSB0aGVhZCB0ciB0aDpmaXJzdC1jaGlsZHt3aWR0aDo3JX0ucmZ4LWN0ZS13ZWlnaHRlZC1vdmVybGF5LXRhYmxlLWVkaXRvcl9fZ3JpZCB0YWJsZSB0aGVhZCB0ciB0aDpsYXN0LWNoaWxke3dpZHRoOjclfS5yZngtY3RlLXdlaWdodGVkLW92ZXJsYXktdGFibGUtZWRpdG9yX19ncmlkIHRhYmxlIHRib2R5IHRyIHRkOmZpcnN0LWNoaWxke3dpZHRoOjclfS5yZngtY3RlLXdlaWdodGVkLW92ZXJsYXktdGFibGUtZWRpdG9yX19ncmlkIHRhYmxlIHRib2R5IHRyIHRkOmxhc3QtY2hpbGR7d2lkdGg6NyV9LnJmeC1jdGUtd2VpZ2h0ZWQtb3ZlcmxheS10YWJsZS1lZGl0b3JfX2NvbG9yLXJlZHtjb2xvcjpyZWR9LnJmeC1jdGUtd2VpZ2h0ZWQtb3ZlcmxheS10YWJsZS1lZGl0b3JfX2xheWVyLWNvbHVtbnt3aWR0aDo0MCV9LnJmeC1jdGUtd2VpZ2h0ZWQtb3ZlcmxheS10YWJsZS1lZGl0b3JfX2luZmx1ZW5jZS1jb2x1bW57d2lkdGg6MTYlfS5yZngtY3RlLXdlaWdodGVkLW92ZXJsYXktdGFibGUtZWRpdG9yX19maWVsZC1jb2x1bW57d2lkdGg6MzAlfS5yZngtY3RlLXdlaWdodGVkLW92ZXJsYXktdGFibGUtZWRpdG9yX19zY2FsZS1jb2x1bW57d2lkdGg6MzAlfVwiO1xuXG5jb25zdCBSZnhDdGVXZWlnaHRlZE92ZXJsYXlUYWJsZUVkaXRvciA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIHRoaXMucmZ4QXJndW1lbnRDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcInJmeEFyZ3VtZW50Q2hhbmdlXCIsIDcpO1xuICAgICAgICAvKipcbiAgICAgICAgICogU3RvcmVzIGV2ZW50IGhhbmRsZXJzIGZvciBoZWxwIGFjdGlvbiBjbGljaywgc3RvcmVkIGluIGNvbm5lY3RlZCBjYWxsYmFjayB0byBhdm9pZFxuICAgICAgICAgKiBmZXRjaGluZyBmdW5jdGlvbiBvbiBlYWNoIHJlbmRlciAoIHRvIGF2b2lkIGNvbW1vbiBiYWQgcHJhY3RpY2UgKVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oZWxwQWN0aW9uQ2xpY2tFdmVudEhhbmRsZXJzID0gbmV3IE1hcCgpO1xuICAgICAgICAvKipcbiAgICAgICAgICogc2NhbGVzIG9wdGlvbnMgZm9yIHNjYWxlcyBzZWxlY3RcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2NhbGVzT3B0aW9ucyA9IERlZmF1bHRTY2FsZXNPcHRpb25zO1xuICAgICAgICAvLyBSZWZyZXNoIHRoZSByZW1hcHMgZ3JpZCB3aGVuIHRoaXMuc2VsZWN0ZWRSb3dJZCBpcyBjaGFuZ2VkIG9yIHRoZSBjb3JyZXNwb25kaW5nIGxheWVyL2ZpZWxkIGlzIGNoYW5nZWRcbiAgICAgICAgdGhpcy5yZWZyZXNoUmVtYXBzR3JpZCA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlbWFwc0dyaWRPcHRpb25zID0gdGhpcy5nZXRSZW1hcEdyaWREYXRhKCk7XG4gICAgICAgICAgICBpZiAoaXNFbXB0eURhdGFJdGVtKHJlbWFwc0dyaWRPcHRpb25zKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVtYXBzR3JpZFNjaGVtYSA9IHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLnJlbWFwc0dyaWRTY2hlbWEsXG4gICAgICAgICAgICAgICAgZ3JpZE9wdGlvbnM6IHJlbWFwc0dyaWRPcHRpb25zXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICAvLyBFdmVudCBoYW5kbGVyIGZvciBncmlkIHJvdyBjbGlja1xuICAgICAgICB0aGlzLmhhbmRsZUdyaWRSb3dDbGljayA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBkZXRhaWw6IHsgZ3JpZE9wdGlvbnMsIHJvd0luZGV4IH0gfSA9IGV2ZW50O1xuICAgICAgICAgICAgaWYgKHJvd0luZGV4IDwgMCB8fCByb3dJbmRleCA+IGdyaWRPcHRpb25zPy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0lkID0gcm93SW5kZXg7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hSZW1hcHNHcmlkKCk7XG4gICAgICAgIH07XG4gICAgICAgIC8vIEV2ZW50IGhhbmRsZXIgZm9yIGdyaWQgb3B0aW9ucyBjaGFuZ2Ugb24gd2VpZ2h0ZWQgb3ZlcmxheSB0YWJsZVxuICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlX3dlaWdodGVkT3ZlcmxheVRhYmxlID0gYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGRldGFpbDogeyBncmlkT3B0aW9ucywgcm93SW5kZXggfSB9ID0gZXZlbnQ7XG4gICAgICAgICAgICBjb25zdCBpbnB1dEFyZ3MgPSB0aGlzLmlucHV0QXJncztcbiAgICAgICAgICAgIGlmIChpc0VtcHR5RGF0YUl0ZW0oZ3JpZE9wdGlvbnMpIHx8IGlzRW1wdHlEYXRhSXRlbShpbnB1dEFyZ3MpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmFzdGVyc1ZhbHVlRWxlbWVudHMgPSBbXSwgaW5mbHVlbmNlVmFsdWVzID0gW10sIGZpZWxkVmFsdWVzID0gW107XG4gICAgICAgICAgICBsZXQgc3VtT2ZJbmZsdWVuY2UgPSAwLCBoYXNTdW1PZkluZmx1ZW5jZUNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGdyaWRPcHRpb25zLmZvckVhY2goKGRhdGFPYmosIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSBncmlkT3B0aW9ucy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gbGFzdCBpcyBhIHBsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHsgbGF5ZXIsIGluZmx1ZW5jZSwgZmllbGQgfSA9IGRhdGFPYmo7XG4gICAgICAgICAgICAgICAgaWYgKGlzRW1wdHlEYXRhSXRlbShsYXllcikgfHwgaXNFbXB0eURhdGFJdGVtKGZpZWxkKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJhc3RlcnNWYWx1ZUVsZW1lbnRzLnB1c2gobGF5ZXIpO1xuICAgICAgICAgICAgICAgIGZpZWxkVmFsdWVzLnB1c2goZmllbGQpO1xuICAgICAgICAgICAgICAgIGxldCBpbmZsdWVuY2VWYWwgPSBwYXJzZU51bWJlcihpbmZsdWVuY2UpO1xuICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5RGF0YUl0ZW0oaW5mbHVlbmNlVmFsKSB8fCBpc05hTihpbmZsdWVuY2VWYWwpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCBkZWZhdWx0IHZhbHVlIGZvciBpbmZsdWVuY2VcbiAgICAgICAgICAgICAgICAgICAgaW5mbHVlbmNlVmFsID0gaW5kZXggPT09IDAgPyAxMDAgOiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdW1PZkluZmx1ZW5jZSArPSBpbmZsdWVuY2VWYWw7XG4gICAgICAgICAgICAgICAgaW5mbHVlbmNlVmFsdWVzLnB1c2goaW5mbHVlbmNlVmFsIC8gMTAwKTsgLy8gaW4gUkZUIEpTT04sIHRoZSBpbmZsdWVuY2UgdmFsdWVzIGFyZSBpbiBkZWNpbWFsc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoc3VtT2ZJbmZsdWVuY2UgIT09IHRoaXMuc3VtT2ZJbmZsdWVuY2UpIHtcbiAgICAgICAgICAgICAgICBoYXNTdW1PZkluZmx1ZW5jZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3VtT2ZJbmZsdWVuY2VFbGVtZW50KHN1bU9mSW5mbHVlbmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFNldCBpbnB1dEFyZ3MgZm9yIFJhc3RlciBGdW5jdGlvbiBUZW1wbGF0ZVxuICAgICAgICAgICAgY29uc3QgcmFzdGVycyA9IGlucHV0QXJncy5SYXN0ZXJzLCBpbmZsdWVuY2VzID0gaW5wdXRBcmdzLkluZmx1ZW5jZXMsIGZpZWxkcyA9IGlucHV0QXJncy5GaWVsZHMsIHJlbWFwcyA9IGlucHV0QXJncy5SZW1hcHM7XG4gICAgICAgICAgICBpZiAoaXNFbXB0eURhdGFJdGVtKHJhc3RlcnMudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmFzdGVycy52YWx1ZSA9IHsgZWxlbWVudHM6IHJhc3RlcnNWYWx1ZUVsZW1lbnRzLCB0eXBlOiBcIkFyZ3VtZW50QXJyYXlcIiB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmFzdGVycy52YWx1ZS5lbGVtZW50cyA9IHJhc3RlcnNWYWx1ZUVsZW1lbnRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5mbHVlbmNlcy52YWx1ZSA9IGluZmx1ZW5jZVZhbHVlcztcbiAgICAgICAgICAgIGZpZWxkcy52YWx1ZSA9IGZpZWxkVmFsdWVzO1xuICAgICAgICAgICAgLy8gY2hlY2sgZGlmZmVyZW5jZSBoYXBwZW5lZCBpbiB3ZWlnaHRlZCBvdmVybGF5IGdyaWQsIGFuZCB1cGRhdGUgcmVtYXBzIGdyaWRcbiAgICAgICAgICAgIGxldCB1cGRhdGVkRGF0YU9iajtcbiAgICAgICAgICAgIC8vIHdoZW4gYSBuZXcgcm93IGhhcyBiZWVuIGFkZGVkXG4gICAgICAgICAgICBpZiAoZ3JpZE9wdGlvbnMubGVuZ3RoID4gdGhpcy53ZWlnaHRlZE92ZXJsYXlHcmlkT3B0aW9uc0xlbmd0aCkge1xuICAgICAgICAgICAgICAgIHVwZGF0ZWREYXRhT2JqID0gZ3JpZE9wdGlvbnNbcm93SW5kZXhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gd2hlbiBzb21lIHJvdyBoYXMgYmVlbiBkZWxldGVkXG4gICAgICAgICAgICBlbHNlIGlmIChncmlkT3B0aW9ucy5sZW5ndGggPCB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRPcHRpb25zTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMYXllclJlbWFwU3RyKHJvd0luZGV4KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93SWQgPSByb3dJbmRleCArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB3aGVuIHNvbWUgcm93IGhhcyBiZWVuIHVwZGF0ZWRcbiAgICAgICAgICAgIGVsc2UgaWYgKGdyaWRPcHRpb25zLmxlbmd0aCA9PT0gdGhpcy53ZWlnaHRlZE92ZXJsYXlHcmlkT3B0aW9uc0xlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmICghaGFzU3VtT2ZJbmZsdWVuY2VDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZW4gZWl0aGVyIGxheWVyIG9yIGZpZWxkIGhhcyBiZWVuIGNoYW5nZWRcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZERhdGFPYmogPSBncmlkT3B0aW9uc1tyb3dJbmRleF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gb25seSBpbml0aWFsaXplIHJlbWFwU3RyIGZvciBuZXdseSBhZGRlZCBvciBjaGFuZ2VkIGxheWVyLCBrZWVwIG90aGVyIGxheWVycycgcmVtYXBTdHJzIGFzIHRoZXkgd2VyZVxuICAgICAgICAgICAgaWYgKHJlbWFwcz8udmFsdWUgJiYgdXBkYXRlZERhdGFPYmo/LmxheWVyPy52YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dJZCA9IHJvd0luZGV4O1xuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgcmVtYXBTdHIgZm9yIGRhdGFPYmogbGF5ZXIsIGFuZCB1cGRhdGUvaW5zZXJ0IHJlbWFwU3RyIGludG8gcmVtYXBzLnZhbHVlXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YUxlbmd0aCA9IGdyaWRPcHRpb25zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5pbml0TGF5ZXJSZW1hcFN0cih1cGRhdGVkRGF0YU9iaiwgcm93SW5kZXgsIGRhdGFMZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gcmVmcmVzaCByZW1hcHMgdGFibGVcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFJlbWFwc0dyaWQoKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgdGVtcCB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRPcHRpb25zTGVuZ3RoXG4gICAgICAgICAgICB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRPcHRpb25zTGVuZ3RoID0gZ3JpZE9wdGlvbnMubGVuZ3RoO1xuICAgICAgICB9O1xuICAgICAgICAvLyBFdmVudCBoYW5kbGVyIGZvciBncmlkIG9wdGlvbnMgY2hhbmdlIG9uIHJlbWFwcyB0YWJsZVxuICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlX3JlbWFwVGFibGUgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgZGV0YWlsOiB7IGdyaWRPcHRpb25zIH0gfSA9IGV2ZW50O1xuICAgICAgICAgICAgY29uc3QgaW5wdXRBcmdzID0gdGhpcy5pbnB1dEFyZ3M7XG4gICAgICAgICAgICBpZiAoaXNFbXB0eURhdGFJdGVtKGdyaWRPcHRpb25zKSB8fCBpc0VtcHR5RGF0YUl0ZW0oaW5wdXRBcmdzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlbWFwcyA9IGlucHV0QXJncy5SZW1hcHMsIHJlbWFwc1ZhbHVlTGVuZ3RoID0gcmVtYXBzPy52YWx1ZT8ubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGlzRW1wdHlEYXRhSXRlbShyZW1hcHNWYWx1ZUxlbmd0aCkgfHxcbiAgICAgICAgICAgICAgICByZW1hcHNWYWx1ZUxlbmd0aCA8IDEgfHxcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93SWQgPCAwIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0lkID4gcmVtYXBzVmFsdWVMZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdXBkYXRlIHJlbWFwcy52YWx1ZVt0aGlzLnNlbGVjdGVkUm93SWRdICh0eXBlb2Ygc3RyaW5nKVxuICAgICAgICAgICAgbGV0IHJlbWFwU3RyID0gXCJcIjtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFMZW5ndGggPSBncmlkT3B0aW9ucy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgZ3JpZE9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YU9iaiwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHZhbHVlLCBzY2FsZSB9ID0gZGF0YU9iajtcbiAgICAgICAgICAgICAgICBpZiAoIWlzRW1wdHlEYXRhSXRlbSh2YWx1ZSkgJiYgIWlzRW1wdHlEYXRhSXRlbShzY2FsZT8udmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZVN0ciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzY2FsZVN0ciA9IHNjYWxlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGQgc2luZ2xlIHF1b3RlcyBhcm91bmQgdGhvc2Ugc3RyaW5nLXR5cGUgcmVtYXBWYWx1ZXMgd2hpY2ggY29udGFpbnMgc3BhY2VzXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZVN0ciA9IHZhbHVlLmluZGV4T2YoXCIgXCIpID4gLTEgPyBcIidcIiArIHZhbHVlICsgXCInXCIgOiB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZW1hcFN0ciArPSB2YWx1ZVN0ciArIFwiIFwiICsgc2NhbGVTdHI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA8IGRhdGFMZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1hcFN0ciArPSBcIiA7IFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZW1hcHMudmFsdWVbdGhpcy5zZWxlY3RlZFJvd0lkXSA9IHJlbWFwU3RyO1xuICAgICAgICB9O1xuICAgICAgICAvLyBFdmVudCBoYW5kbGVyIGZvciBzY2FsZXMgc2VsZWN0IHZhbHVlIGNoYW5nZVxuICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlX3NjYWxlcyA9IGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBlbGVtZW50LnZhbHVlO1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBwYWlyIG9mIGV2YWxGcm9tIGFuZCBldmFsVG8sIHN1Y2ggYXMgW1wiMVwiLCBcIjlcIl1cbiAgICAgICAgICAgIGNvbnN0IGV2YWxWYWx1ZXMgPSB2YWx1ZS5yZXBsYWNlKC9cXHMvZywgXCJcIikuc3BsaXQoXCItXCIpO1xuICAgICAgICAgICAgaWYgKGV2YWxWYWx1ZXMubGVuZ3RoICE9PSAyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZXZhbEZyb20gPSBwYXJzZUludChldmFsVmFsdWVzWzBdLCAxMCksIGV2YWxUbyA9IHBhcnNlSW50KGV2YWxWYWx1ZXNbMV0sIDEwKTtcbiAgICAgICAgICAgIGlmIChpc05hTihldmFsRnJvbSkgfHwgaXNOYU4oZXZhbFRvKSB8fCBldmFsRnJvbSA+IGV2YWxUbykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZXZhbFNjYWxlcyA9IHtcbiAgICAgICAgICAgICAgICBldmFsRnJvbTogZXZhbEZyb20sXG4gICAgICAgICAgICAgICAgZXZhbFRvOiBldmFsVG9cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmlucHV0QXJncy5FdmFsRnJvbS52YWx1ZSA9IGV2YWxGcm9tO1xuICAgICAgICAgICAgdGhpcy5pbnB1dEFyZ3MuRXZhbFRvLnZhbHVlID0gZXZhbFRvO1xuICAgICAgICAgICAgY29uc3Qgcm93SW5kZXggPSB0aGlzLnNlbGVjdGVkUm93SWQ7XG4gICAgICAgICAgICBjb25zdCBkYXRhT2JqID0gdGhpcy53ZWlnaHRlZE92ZXJsYXlHcmlkU2NoZW1hLmdyaWRPcHRpb25zPy5bcm93SW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgZGF0YUxlbmd0aCA9IHRoaXMud2VpZ2h0ZWRPdmVybGF5R3JpZFNjaGVtYS5ncmlkT3B0aW9ucz8ubGVuZ3RoO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5pbml0TGF5ZXJSZW1hcFN0cihkYXRhT2JqLCByb3dJbmRleCwgZGF0YUxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hSZW1hcHNHcmlkKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMud2VpZ2h0ZWRPdmVybGF5R3JpZFNjaGVtYSA9IHtcbiAgICAgICAgICAgIGNhbkFkZDogdHJ1ZSxcbiAgICAgICAgICAgIGdyaWRMYXlvdXQ6IHt9LFxuICAgICAgICAgICAgZ3JpZE9wdGlvbnM6IFtdLFxuICAgICAgICAgICAgaGFzQm9yZGVyOiB0cnVlLFxuICAgICAgICAgICAgaGFzSGVhZGVyOiB0cnVlLFxuICAgICAgICAgICAgaGFzSWRDb2x1bW46IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZW1hcHNHcmlkU2NoZW1hID0ge1xuICAgICAgICAgICAgY2FuQWRkOiB0cnVlLFxuICAgICAgICAgICAgZ3JpZExheW91dDoge30sXG4gICAgICAgICAgICBncmlkT3B0aW9uczogW10sXG4gICAgICAgICAgICBoYXNCb3JkZXI6IHRydWUsXG4gICAgICAgICAgICBoYXNIZWFkZXI6IHRydWUsXG4gICAgICAgICAgICBoYXNJZENvbHVtbjogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnN1bU9mSW5mbHVlbmNlID0gMDtcbiAgICAgICAgdGhpcy5ldmFsU2NhbGVzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLndpZGdldEFyZ3MgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBMaWZlY3ljbGVcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICAgICAgKHsgc3RyaW5nczogdGhpcy5zdHJpbmdzLCBkaXI6IHRoaXMuZGlyZWN0aW9uIH0gPSBhd2FpdCBmZXRjaENvbXBvbmVudExvY2FsZVN0cmluZ3ModGhpcy5ob3N0RWxlbWVudCwgZ2V0QXNzZXRQYXRoKFwiLlwiKSkpO1xuICAgICAgICBjb25zdCB7IGlucHV0QXJncywgaW5wdXRMYXllcnMgfSA9IHRoaXMud2lkZ2V0QXJncztcbiAgICAgICAgdGhpcy5pbnB1dEFyZ3MgPSBpbnB1dEFyZ3M7XG4gICAgICAgIHRoaXMuaW5wdXRMYXllcnMgPSBpbnB1dExheWVycztcbiAgICAgICAgdGhpcy5pbml0U2NhbGVzU2VsZWN0T3B0aW9ucygpO1xuICAgICAgICB0aGlzLmluaXRHcmlkcygpO1xuICAgIH1cbiAgICBjb21wb25lbnREaWRMb2FkKCkge1xuICAgICAgICB0aGlzLmF0dGFjaEhlbHBDbGlja0V2ZW50SGFuZGxlcnMoKTtcbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGF0dGFjaEhlbHBDbGlja0V2ZW50SGFuZGxlcnMoKSB7XG4gICAgICAgIGNvbnN0IHdlaWdodGVkT3ZlcmxheVRhYmxlSGVscENsaWNrSGFuZGxlciA9IHRoaXMud2lkZ2V0QXJncy5vbkhlbHBBY3Rpb25DbGljayh7XG4gICAgICAgICAgICBoZWFkaW5nOiB0aGlzLnN0cmluZ3Mud2VpZ2h0ZWRPdmVybGF5VGFibGUsXG4gICAgICAgICAgICByZWZlcmVuY2VFbGVtZW50OiB0aGlzLndlaWdodGVkT3ZlcmxheVRhYmxlTGFiZWxFbGVtZW50LFxuICAgICAgICAgICAgaGVscFRleHRJRDogdGhpcy53aWRnZXRBcmdzLmhlbHBUZXh0SURzPy53ZWlnaHRlZG92ZXJsYXlfd2VpZ2h0ZWRvdmVybGF5dGFibGVcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaGVscEFjdGlvbkNsaWNrRXZlbnRIYW5kbGVycy5zZXQoSGVscENsaWNrSGFuZGxlcktleXMud2VpZ2h0ZWRPdmVybGF5VGFibGVIZWxwQ2xpY2tIYW5kbGVyLCB3ZWlnaHRlZE92ZXJsYXlUYWJsZUhlbHBDbGlja0hhbmRsZXIpO1xuICAgICAgICBjb25zdCByZW1hcFRhYmxlSGVscENsaWNrSGFuZGxlciA9IHRoaXMud2lkZ2V0QXJncy5vbkhlbHBBY3Rpb25DbGljayh7XG4gICAgICAgICAgICBoZWFkaW5nOiB0aGlzLnN0cmluZ3MucmVtYXBUYWJsZSxcbiAgICAgICAgICAgIHJlZmVyZW5jZUVsZW1lbnQ6IHRoaXMucmVtYXBUYWJsZUxhYmVsRWxlbWVudCxcbiAgICAgICAgICAgIGhlbHBUZXh0SUQ6IHRoaXMud2lkZ2V0QXJncy5oZWxwVGV4dElEcz8ud2VpZ2h0ZWRvdmVybGF5X3JlbWFwdGFibGVcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaGVscEFjdGlvbkNsaWNrRXZlbnRIYW5kbGVycy5zZXQoSGVscENsaWNrSGFuZGxlcktleXMucmVtYXBUYWJsZUhlbHBDbGlja0hhbmRsZXIsIHJlbWFwVGFibGVIZWxwQ2xpY2tIYW5kbGVyKTtcbiAgICAgICAgY29uc3Qgc2NhbGVzSGVscENsaWNrSGFuZGxlciA9IHRoaXMud2lkZ2V0QXJncy5vbkhlbHBBY3Rpb25DbGljayh7XG4gICAgICAgICAgICBoZWFkaW5nOiB0aGlzLnN0cmluZ3Muc2NhbGVzLFxuICAgICAgICAgICAgcmVmZXJlbmNlRWxlbWVudDogdGhpcy5zY2FsZXNMYWJlbEVsZW1lbnQsXG4gICAgICAgICAgICBoZWxwVGV4dElEOiB0aGlzLndpZGdldEFyZ3MuaGVscFRleHRJRHM/LndlaWdodGVkb3ZlcmxheV9zY2FsZXNcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaGVscEFjdGlvbkNsaWNrRXZlbnRIYW5kbGVycy5zZXQoSGVscENsaWNrSGFuZGxlcktleXMuc2NhbGVzSGVscENsaWNrSGFuZGxlciwgc2NhbGVzSGVscENsaWNrSGFuZGxlcik7XG4gICAgfVxuICAgIGFzeW5jIGdldFNlbGVjdGVkTGF5ZXIodXJsKSB7XG4gICAgICAgIGNvbnN0IHNhbml0aXplZFVybCA9IGdldExheWVyVXJsV2l0aG91dFRva2VuKHVybCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTGF5ZXIgPSB0aGlzLmlucHV0TGF5ZXJzLmZpbmQoKGxheWVyKSA9PiBsYXllci51cmwgPT09IHNhbml0aXplZFVybCk7XG4gICAgICAgIGlmIChzZWxlY3RlZExheWVyKSB7XG4gICAgICAgICAgICBhd2FpdCBzZWxlY3RlZExheWVyLmxvYWQoKTtcbiAgICAgICAgICAgIGlmIChpc0ltYWdlcnlMYXllcihzZWxlY3RlZExheWVyKSkge1xuICAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBuZWNlc3NhcnkgaW5mbyBhbmQgYWRkIHRvIHRoZSBJbWFnZXJ5TGF5ZXJBcmcgZm9yIG90aGVyIHdpZGdldHMgdG8gdXNlXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdXNlIEltYWdlcnlMYXllci5yYXN0ZXJGdW5jdGlvbiBpbnN0ZWFkIG9mIHJlbmRlcmluZ1J1bGUgYXMgaXQgaXMgZGVwcmVjYXRlZCBzaW5jZSA0LjI3XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkTGF5ZXIucmFzdGVySW5mbyA9IGF3YWl0IHNlbGVjdGVkTGF5ZXIuZ2VuZXJhdGVSYXN0ZXJJbmZvKHNlbGVjdGVkTGF5ZXIucmFzdGVyRnVuY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxlY3RlZExheWVyO1xuICAgIH1cbiAgICBnZXRTY2FsZU9wdGlvbnMoKSB7XG4gICAgICAgIGNvbnN0IHNjYWxlT3B0aW9ucyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5ldmFsU2NhbGVzLmV2YWxGcm9tOyBpIDw9IHRoaXMuZXZhbFNjYWxlcy5ldmFsVG87IGkrKykge1xuICAgICAgICAgICAgc2NhbGVPcHRpb25zLnB1c2goeyBrZXk6IGkudG9TdHJpbmcoKSwgbGFiZWw6IGkudG9TdHJpbmcoKSB9KTtcbiAgICAgICAgfVxuICAgICAgICBzY2FsZU9wdGlvbnMucHVzaCh7IGtleTogXCJOT0RBVEFcIiwgbGFiZWw6IFwiTk9EQVRBXCIgfSk7XG4gICAgICAgIHNjYWxlT3B0aW9ucy5wdXNoKHsga2V5OiBcIlJFU1RSSUNURURcIiwgbGFiZWw6IFwiUkVTVFJJQ1RFRFwiIH0pO1xuICAgICAgICByZXR1cm4gc2NhbGVPcHRpb25zO1xuICAgIH1cbiAgICBnZXREZWZhdWx0R3JpZE9wdGlvbl93ZWlnaHRlZE92ZXJsYXlUYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiAwLFxuICAgICAgICAgICAgbGF5ZXI6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGZpZWxkOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBpbmZsdWVuY2U6IDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0RGVmYXVsdEdyaWRPcHRpb25fcmVtYXBUYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiAwLFxuICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHNjYWxlOiB7IG9wdGlvbnM6IHRoaXMuZ2V0U2NhbGVPcHRpb25zKCksIHZhbHVlOiB1bmRlZmluZWQgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvLyBnZXQgdGhlIGNvcnJlc3BvbmRpbmcgZGF0YSBmcm9tIGlucHV0QXJncy5SZW1hcHMgZm9yIGRpc3BsYXlpbmcgb24gcmVtYXAgZ3JpZFxuICAgIGdldFJlbWFwR3JpZERhdGEoKSB7XG4gICAgICAgIGNvbnN0IHJlbWFwcyA9IHRoaXMuaW5wdXRBcmdzPy5SZW1hcHMsIHNlbGVjdGVkSW5kZXggPSB0aGlzLnNlbGVjdGVkUm93SWQsIGRhdGEgPSBbXTtcbiAgICAgICAgaWYgKHNlbGVjdGVkSW5kZXggPCAwIHx8IHNlbGVjdGVkSW5kZXggPiByZW1hcHM/LnZhbHVlPy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtYXBzPy52YWx1ZT8uW3NlbGVjdGVkSW5kZXhdKSB7XG4gICAgICAgICAgICBjb25zdCByZW1hcFN0ciA9IHJlbWFwcy52YWx1ZVtzZWxlY3RlZEluZGV4XSwgcmVtYXBBcnIgPSByZW1hcFN0ci5zcGxpdChcIjtcIik7XG4gICAgICAgICAgICByZW1hcEFyci5mb3JFYWNoKChyZW1hcFBhaXJTdHIsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gdHJpbSBlYWNoIHJlbWFwUGFpclN0ciB0aGVuIHNwbGl0IGJ5IHNwYWNlcyBidXQgc2tpcCB0aG9zZSBpbiBzaW5nbGUgcXVvdGVzXG4gICAgICAgICAgICAgICAgY29uc3QgcmVtYXBQYWlyQXJyID0gcmVtYXBQYWlyU3RyLnRyaW0oKS5tYXRjaCgvKD86W15cXHMnXSt8J1teJ10qJykrL2cpO1xuICAgICAgICAgICAgICAgIGlmIChpc0VtcHR5RGF0YUl0ZW0ocmVtYXBQYWlyQXJyKSB8fCByZW1hcFBhaXJBcnIubGVuZ3RoICE9PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IHJlbWFwVmFsdWUgPSByZW1hcFBhaXJBcnJbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgcmVtYXBTY2FsZSA9IHJlbWFwUGFpckFyclsxXTtcbiAgICAgICAgICAgICAgICBpZiAocmVtYXBWYWx1ZS5pbmRleE9mKFwiJ1wiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBzaW5nbGUgcXVvdGVzIGJlZm9yZSBkaXNwbGF5aW5nIG9uIGdyaWRcbiAgICAgICAgICAgICAgICAgICAgcmVtYXBWYWx1ZSA9IHJlbWFwVmFsdWUucmVwbGFjZSgvWyddKy9nLCBcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGluZGV4LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcmVtYXBWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgc2NhbGU6IHsgb3B0aW9uczogdGhpcy5nZXRTY2FsZU9wdGlvbnMoKSwgdmFsdWU6IHJlbWFwU2NhbGUgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBhZGQgYSBibGFuayBkYXRhIG9iamVjdCBhcyB0aGUgbGFzdCByb3cgb24gcmVtYXBzIGdyaWRcbiAgICAgICAgICAgIGNvbnN0IGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgICAgIGRhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGRhdGFMZW5ndGgsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBzY2FsZTogeyBvcHRpb25zOiB0aGlzLmdldFNjYWxlT3B0aW9ucygpLCB2YWx1ZTogdW5kZWZpbmVkIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gYWRkIGEgYmxhbmsgZGF0YSBvYmplY3RcbiAgICAgICAgICAgIGRhdGEucHVzaCh0aGlzLmdldERlZmF1bHRHcmlkT3B0aW9uX3JlbWFwVGFibGUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWQgaW5wdXRBcmdzIGFuZCBjcmVhdGUgYW4gYXJyYXkgb2YgZGF0YSBvYmplY3RzIGFzIGdyaWQgb3B0aW9ucyBiYXNlZCBvbiB0aGUgaW5wdXQgYXJncyB2YWx1ZXMuXG4gICAgICogQHJldHVybnMge2FueVtdfSBUaGUgcmVzdWx0IGFycmF5IG9mIGRhdGEgb2JqZWN0cyBhcyBncmlkIG9wdGlvbnMuXG4gICAgICovXG4gICAgcmVhZEFyZ1ZhbHVlcygpIHtcbiAgICAgICAgaWYgKGlzRW1wdHlEYXRhSXRlbSh0aGlzLmlucHV0QXJncykpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbnB1dEFyZ3MgPSB0aGlzLmlucHV0QXJncztcbiAgICAgICAgY29uc3Qgd2VpZ2h0ZWRPdmVybGF5R3JpZE9wdGlvbnMgPSBbXSwgLy8gZ3JpZE9wdGlvbnMgb2Ygd2VpZ2h0ZWRPdmVybGF5R3JpZCAoUmFzdGVycywgSW5mbHVlbmNlcywgRmllbGRzKVxuICAgICAgICByYXN0ZXJzID0gaW5wdXRBcmdzLlJhc3RlcnMsIGZpZWxkcyA9IGlucHV0QXJncy5GaWVsZHMsIGluZmx1ZW5jZXMgPSBpbnB1dEFyZ3MuSW5mbHVlbmNlcywgcmVtYXBzID0gaW5wdXRBcmdzLlJlbWFwcztcbiAgICAgICAgbGV0IHJlbWFwc0dyaWRPcHRpb25zID0gW10sIC8vIGdyaWRPcHRpb25zIG9mIHJlbWFwc0dyaWQgZm9yIGVhY2ggY29ycmVzcG9uZGluZyByb3cgb24gd2VpZ2h0ZWRPdmVybGF5R3JpZFxuICAgICAgICBkYXRhTGVuZ3RoID0gMCwgaWR4ID0gMDtcbiAgICAgICAgaWYgKCFpc0VtcHR5RGF0YUl0ZW0ocmFzdGVycykgJiZcbiAgICAgICAgICAgICFpc0VtcHR5RGF0YUl0ZW0oZmllbGRzKSAmJlxuICAgICAgICAgICAgIWlzRW1wdHlEYXRhSXRlbShpbmZsdWVuY2VzKSAmJlxuICAgICAgICAgICAgIWlzRW1wdHlEYXRhSXRlbShyZW1hcHMpKSB7XG4gICAgICAgICAgICBkYXRhTGVuZ3RoID0gTWF0aC5tYXgocmFzdGVycy52YWx1ZT8uZWxlbWVudHM/Lmxlbmd0aCB8fCAwLCBmaWVsZHMudmFsdWU/Lmxlbmd0aCB8fCAwLCBpbmZsdWVuY2VzLnZhbHVlPy5sZW5ndGggfHwgMCwgcmVtYXBzLnZhbHVlPy5sZW5ndGggfHwgMCk7XG4gICAgICAgICAgICByZW1hcHMudmFsdWUgPSByZW1hcHMudmFsdWUgPz8gW107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGFMZW5ndGggPT09IDAgfHwgaXNOYU4oZGF0YUxlbmd0aCkpIHtcbiAgICAgICAgICAgIC8vIGFkZCBibGFuayBkYXRhIG9iamVjdCB0byBlYWNoIGdyaWRcbiAgICAgICAgICAgIHdlaWdodGVkT3ZlcmxheUdyaWRPcHRpb25zLnB1c2godGhpcy5nZXREZWZhdWx0R3JpZE9wdGlvbl93ZWlnaHRlZE92ZXJsYXlUYWJsZSgpKTtcbiAgICAgICAgICAgIHJlbWFwc0dyaWRPcHRpb25zLnB1c2godGhpcy5nZXREZWZhdWx0R3JpZE9wdGlvbl9yZW1hcFRhYmxlKCkpO1xuICAgICAgICAgICAgcmV0dXJuIFt3ZWlnaHRlZE92ZXJsYXlHcmlkT3B0aW9ucywgcmVtYXBzR3JpZE9wdGlvbnNdO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChpZHggPCBkYXRhTGVuZ3RoKSB7XG4gICAgICAgICAgICB3ZWlnaHRlZE92ZXJsYXlHcmlkT3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogaWR4LFxuICAgICAgICAgICAgICAgIGxheWVyOiByYXN0ZXJzPy52YWx1ZT8uZWxlbWVudHM/LltpZHhdLFxuICAgICAgICAgICAgICAgIGZpZWxkOiBmaWVsZHM/LnZhbHVlPy5baWR4XSxcbiAgICAgICAgICAgICAgICBpbmZsdWVuY2U6IGluZmx1ZW5jZXM/LnZhbHVlICYmICgoaW5mbHVlbmNlcy52YWx1ZVtpZHhdICogMTAwKS50b0ZpeGVkKDIpIHx8IChpZHggPiAwID8gMCA6IDEwMCkpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZW1hcHM/LnZhbHVlPy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBwdXNoIHJlbWFwc1swXSBkYXRhIHRvIHJlbWFwc0dyaWRPcHRpb25zIGFzIGFuIGFycmF5XG4gICAgICAgICAgICBpZiAod2VpZ2h0ZWRPdmVybGF5R3JpZE9wdGlvbnM/Lmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgICAgICB3ZWlnaHRlZE92ZXJsYXlHcmlkT3B0aW9uc1swXT8ubGF5ZXI/LnZhbHVlICYmXG4gICAgICAgICAgICAgICAgd2VpZ2h0ZWRPdmVybGF5R3JpZE9wdGlvbnNbMF0/LmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJvd0lkID0gMDtcbiAgICAgICAgICAgICAgICByZW1hcHNHcmlkT3B0aW9ucyA9IHRoaXMuZ2V0UmVtYXBHcmlkRGF0YSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSByZW1hcHMudmFsdWUgaWYgZW1wdHlcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmVtYXBzLnZhbHVlLnB1c2goXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt3ZWlnaHRlZE92ZXJsYXlHcmlkT3B0aW9ucywgcmVtYXBzR3JpZE9wdGlvbnNdO1xuICAgIH1cbiAgICBpbml0R3JpZHMoKSB7XG4gICAgICAgIGNvbnN0IHdlaWdodGVkT3ZlcmxheUdyaWRMYXlvdXQgPSB7XG4gICAgICAgICAgICBsYXllcjoge1xuICAgICAgICAgICAgICAgIGFsbG93U2NhbGFyOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBsYWJlbDogdGhpcy5zdHJpbmdzLmxheWVyLFxuICAgICAgICAgICAgICAgIHVpVHlwZTogR3JpZENvbHVtbi5yYXN0ZXIsXG4gICAgICAgICAgICAgICAgc3R5bGU6IEhUTUxDbGFzc2VzLmxheWVyQ29sdW1uXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5mbHVlbmNlOiB7XG4gICAgICAgICAgICAgICAgbGFiZWw6IHRoaXMuc3RyaW5ncy5pbmZsdWVuY2UsXG4gICAgICAgICAgICAgICAgdWlUeXBlOiBHcmlkQ29sdW1uLm51bWJlcixcbiAgICAgICAgICAgICAgICBzdHlsZTogSFRNTENsYXNzZXMuaW5mbHVlbmNlQ29sdW1uXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmllbGQ6IHtcbiAgICAgICAgICAgICAgICBsYWJlbDogdGhpcy5zdHJpbmdzLmZpZWxkLFxuICAgICAgICAgICAgICAgIHVpVHlwZTogR3JpZENvbHVtbi5maWVsZCxcbiAgICAgICAgICAgICAgICBzdHlsZTogSFRNTENsYXNzZXMuZmllbGRDb2x1bW5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgcmVtYXBzR3JpZExheW91dCA9IHtcbiAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgbGFiZWw6IHRoaXMuc3RyaW5ncy52YWx1ZSxcbiAgICAgICAgICAgICAgICB1aVR5cGU6IEdyaWRDb2x1bW4udGV4dElucHV0LFxuICAgICAgICAgICAgICAgIHN0eWxlOiBIVE1MQ2xhc3Nlcy52YWx1ZUNvbHVtblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNjYWxlOiB7XG4gICAgICAgICAgICAgICAgbGFiZWw6IHRoaXMuc3RyaW5ncy5zY2FsZSxcbiAgICAgICAgICAgICAgICB1aVR5cGU6IEdyaWRDb2x1bW4uc2VsZWN0LFxuICAgICAgICAgICAgICAgIHN0eWxlOiBIVE1MQ2xhc3Nlcy5zY2FsZUNvbHVtblxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYXRhQXJyYXkgPSB0aGlzLnJlYWRBcmdWYWx1ZXMoKTtcbiAgICAgICAgY29uc3Qgd2VpZ2h0ZWRPdmVybGF5R3JpZE9wdGlvbnMgPSBkYXRhQXJyYXlbMF0sIHJlbWFwc0dyaWRPcHRpb25zID0gZGF0YUFycmF5WzFdO1xuICAgICAgICB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRPcHRpb25zTGVuZ3RoID0gd2VpZ2h0ZWRPdmVybGF5R3JpZE9wdGlvbnM/Lmxlbmd0aCA/PyAwO1xuICAgICAgICB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRTY2hlbWEgPSB7XG4gICAgICAgICAgICAuLi50aGlzLndlaWdodGVkT3ZlcmxheUdyaWRTY2hlbWEsXG4gICAgICAgICAgICBncmlkTGF5b3V0OiB3ZWlnaHRlZE92ZXJsYXlHcmlkTGF5b3V0LFxuICAgICAgICAgICAgZ3JpZE9wdGlvbnM6IHdlaWdodGVkT3ZlcmxheUdyaWRPcHRpb25zXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVtYXBzR3JpZFNjaGVtYSA9IHtcbiAgICAgICAgICAgIC4uLnRoaXMucmVtYXBzR3JpZFNjaGVtYSxcbiAgICAgICAgICAgIGdyaWRMYXlvdXQ6IHJlbWFwc0dyaWRMYXlvdXQsXG4gICAgICAgICAgICBncmlkT3B0aW9uczogcmVtYXBzR3JpZE9wdGlvbnNcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaW5pdFNjYWxlc1NlbGVjdE9wdGlvbnMoKSB7XG4gICAgICAgIGlmIChpc0VtcHR5RGF0YUl0ZW0odGhpcy5pbnB1dEFyZ3MpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBFdmFsRnJvbSwgRXZhbFRvIH0gPSB0aGlzLmlucHV0QXJncztcbiAgICAgICAgY29uc3QgZXZhbEZyb21WYWx1ZSA9IEV2YWxGcm9tPy52YWx1ZSA/PyAxLCAvL2RlZmF1bHRWYWx1ZSBmcm9tIHNjaGVtYSBpcyAxXG4gICAgICAgIGV2YWxUb1ZhbHVlID0gRXZhbFRvPy52YWx1ZSA/PyA5OyAvL2RlZmF1bHRWYWx1ZSBmcm9tIHNjaGVtYSBpcyA5XG4gICAgICAgIHRoaXMuZXZhbFNjYWxlcyA9IHtcbiAgICAgICAgICAgIGV2YWxGcm9tOiBldmFsRnJvbVZhbHVlLFxuICAgICAgICAgICAgZXZhbFRvOiBldmFsVG9WYWx1ZVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBzY2FsZXNTdHIgPSBgJHtldmFsRnJvbVZhbHVlfS0ke2V2YWxUb1ZhbHVlfWA7XG4gICAgICAgIGlmICghdGhpcy5zY2FsZXNPcHRpb25zLnNvbWUoKHNjYWxlc09wdGlvbikgPT4gc2NhbGVzT3B0aW9uLmtleSA9PT0gc2NhbGVzU3RyKSkge1xuICAgICAgICAgICAgdGhpcy5zY2FsZXNPcHRpb25zLnB1c2goeyBrZXk6IHNjYWxlc1N0ciwgbGFiZWw6IHNjYWxlc1N0ciB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVTdW1PZkluZmx1ZW5jZUVsZW1lbnQoc3VtT2ZJbmZsdWVuY2UpIHtcbiAgICAgICAgdGhpcy5zdW1PZkluZmx1ZW5jZSA9IHN1bU9mSW5mbHVlbmNlO1xuICAgICAgICAvLyBjaGFuZ2UgY29sb3IgdG8gcmVkIGlmIHN1bU9mSW5mbHVlbmNlID4gMTAwXG4gICAgICAgIGlmIChzdW1PZkluZmx1ZW5jZSA+IDEwMCkge1xuICAgICAgICAgICAgdGhpcy5zdW1PZkluZmx1ZW5jZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChIVE1MQ2xhc3Nlcy5jb2xvclJlZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN1bU9mSW5mbHVlbmNlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKEhUTUxDbGFzc2VzLmNvbG9yUmVkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBpbml0aWFsaXplIHRoZSByZW1hcCBzdHJpbmcgZm9yIG5ld2x5IGFkZGVkL3NlbGVjdGVkIGxheWVyXG4gICAgYXN5bmMgaW5pdExheWVyUmVtYXBTdHIoZGF0YU9iaiwgcm93SW5kZXgsIGRhdGFMZW5ndGgpIHtcbiAgICAgICAgaWYgKGlzRW1wdHlEYXRhSXRlbShkYXRhT2JqKSB8fCByb3dJbmRleCA8IDAgfHwgZGF0YUxlbmd0aCA8PSAwIHx8IHJvd0luZGV4ID4gZGF0YUxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGxheWVyLCBmaWVsZCB9ID0gZGF0YU9iajtcbiAgICAgICAgY29uc3QgeyBldmFsRnJvbSwgZXZhbFRvIH0gPSB0aGlzLmV2YWxTY2FsZXM7XG4gICAgICAgIGlmIChpc0VtcHR5RGF0YUl0ZW0obGF5ZXIpIHx8IGlzRW1wdHlEYXRhSXRlbShmaWVsZCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsYXllck9iaiA9IGF3YWl0IHRoaXMuZ2V0U2VsZWN0ZWRMYXllcihsYXllci52YWx1ZT8udXJsKTtcbiAgICAgICAgaWYgKGlzRW1wdHlEYXRhSXRlbShsYXllck9iaikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVtYXBTdHIgPSBcIlwiO1xuICAgICAgICAvLyBJZiBuZXdseSBhZGRlZC9zZWxlY3RlZCBsYXllciBoYXMgUkFULCBhdXRvbWF0aWNhbGx5IHVwZGF0ZSB0aGUgY29ycmVzcG9uZGluZyByZW1hcCBzdHJpbmdcbiAgICAgICAgLy8gU2luY2UgSlNBUEktNC4xNCBgaGFzUmFzdGVyQXR0cmlidXRlVGFibGVgIG1vdmVkIHRvIHVuZGVyIGBsYXllci5zb3VyY2VKU09OYFxuICAgICAgICBpZiAobGF5ZXJPYmouc291cmNlSlNPTj8uaGFzUmFzdGVyQXR0cmlidXRlVGFibGUgJiYgZmllbGQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJhdCA9IGlzSW1hZ2VyeUxheWVyKGxheWVyT2JqKVxuICAgICAgICAgICAgICAgID8gbGF5ZXJPYmouc2VydmljZVJhc3RlckluZm8uYXR0cmlidXRlVGFibGVcbiAgICAgICAgICAgICAgICA6IGxheWVyT2JqLnJhc3RlckluZm8uYXR0cmlidXRlVGFibGU7XG4gICAgICAgICAgICBjb25zdCBmZWF0dXJlcyA9IHJhdD8uZmVhdHVyZXM7XG4gICAgICAgICAgICBpZiAoaXNFbXB0eURhdGFJdGVtKGZlYXR1cmVzKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlbWFwVmFsdWVzID0gZmVhdHVyZXNcbiAgICAgICAgICAgICAgICAubWFwKChmZWF0dXJlKSA9PiBmZWF0dXJlLmF0dHJpYnV0ZXNbZmllbGRdKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHZhbCwgcG9zLCBzZWxmKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuaW5kZXhPZih2YWwpID09PSBwb3M7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHNvcnQgdGhlIHJlbWFwVmFsdWVzIGFycmF5IGlmIHZhbHVlcyBhcmUgbnVtYmVyc1xuICAgICAgICAgICAgaWYgKHJlbWFwVmFsdWVzPy5sZW5ndGggPiAxICYmICFpc05hTihyZW1hcFZhbHVlc1swXSkpIHtcbiAgICAgICAgICAgICAgICByZW1hcFZhbHVlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhIC0gYjtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHJlbWFwQXJyID0gcmVtYXBWYWx1ZXMubWFwKGZ1bmN0aW9uICh2YWwsIHBvcykge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBzaW5nbGUgcXVvdGVzIGFyb3VuZCB0aG9zZSBzdHJpbmctdHlwZSByZW1hcFZhbHVlcyB3aGljaCBjb250YWlucyBzcGFjZXNcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsLmluZGV4T2YoXCIgXCIpID4gLTEgPyBcIidcIiArIHZhbCArIFwiJ1wiIDogdmFsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBzY2FsZSA9IHBvcyArIGV2YWxGcm9tIDw9IGV2YWxUbyA/IHBvcyArIGV2YWxGcm9tIDogZXZhbEZyb207XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke3ZhbH0gJHtzY2FsZX1gO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZW1hcFN0ciA9IHJlbWFwQXJyLmpvaW4oXCIgOyBcIik7XG4gICAgICAgICAgICAvLyByZW1hcCBzdHJpbmcgZXhhbXBsZTpcbiAgICAgICAgICAgIC8vIFwiQnJ1c2gvdHJhbnNpdGlvbmFsIDEgOyBXYXRlciAyIDsgJ0JhcnJlbiBsYW5kJyAzIDsgJ0J1aWx0IHVwJyA0IDsgQWdyaWN1bHR1cmUgNSA7IEZvcmVzdCA2IDsgV2V0bGFuZHMgN1wiXG4gICAgICAgIH1cbiAgICAgICAgLy8gQWZ0ZXIgYXN5bmMgcmV0dXJucywgcmVwbGFjZSB0aGUgY29ycmVzcG9uZGluZyByZW1hcFN0ciBpbiByZW1hcHNcbiAgICAgICAgY29uc3QgaWR4ID0gcm93SW5kZXgsIHJlbWFwcyA9IHRoaXMuaW5wdXRBcmdzLlJlbWFwcywgZmllbGRzID0gdGhpcy5pbnB1dEFyZ3MuRmllbGRzO1xuICAgICAgICAvLyB1cGRhdGUgZmllbGQgaW4gaW5wdXRBcmdzIGFmdGVyIGFzeW5jIHJldHVybnNcbiAgICAgICAgZmllbGRzLnZhbHVlLnNwbGljZShpZHgsIDEsIGZpZWxkKTtcbiAgICAgICAgaWYgKHJlbWFwcy52YWx1ZS5sZW5ndGggPT09IGRhdGFMZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIHdoZW4gYSByb3cncyBMYXllciBvciBGaWVsZCBoYXMgYmVlbiBjaGFuZ2VkLCByZXBsYWNlIHRoZSBjb3JyZXNwb25kaW5nIHJlbWFwU3RyIGluIHJlbWFwc1xuICAgICAgICAgICAgcmVtYXBzLnZhbHVlLnNwbGljZShpZHgsIDEsIHJlbWFwU3RyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtYXBzLnZhbHVlLmxlbmd0aCA8IGRhdGFMZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIHdoZW4gYSBuZXcgcm93IGhhcyBiZWVuIGFkZGVkLCBpbnNlcnQgdGhlIG5ldyByZW1hcFN0ciB0byByZW1hcHNcbiAgICAgICAgICAgIHJlbWFwcy52YWx1ZS5zcGxpY2UoaWR4LCAwLCByZW1hcFN0cik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gRGVsZXRlIHRoZSByZW1hcCBzdHIgb2YgbGF5ZXIgYXQgcm93SW5kZXhcbiAgICBkZWxldGVMYXllclJlbWFwU3RyKGlkeCkge1xuICAgICAgICBjb25zdCByZW1hcHMgPSB0aGlzLmlucHV0QXJncy5SZW1hcHM7XG4gICAgICAgIHJlbWFwcy52YWx1ZS5zcGxpY2UoaWR4LCAxKTtcbiAgICB9XG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gKGgoXCJkaXZcIiwgbnVsbCwgaChcImNhbGNpdGUtbGFiZWxcIiwgeyBhbGlnbm1lbnQ6IFwic3RhcnRcIiwgc2NhbGU6IFVJRGVmYXVsdHMuU2NhbGUsIGxheW91dDogXCJkZWZhdWx0XCIsIHJlZjogKGUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndlaWdodGVkT3ZlcmxheVRhYmxlTGFiZWxFbGVtZW50ID0gZTtcbiAgICAgICAgICAgIH0gfSwgaChcInJmeC1sYWJlbFwiLCB7IGxhYmVsOiB0aGlzLnN0cmluZ3Mud2VpZ2h0ZWRPdmVybGF5VGFibGUsIG9uUmZ4TGFiZWxIZWxwQWN0aW9uQ2xpY2s6ICgpID0+IHRoaXMuaGVscEFjdGlvbkNsaWNrRXZlbnRIYW5kbGVycz8uZ2V0KEhlbHBDbGlja0hhbmRsZXJLZXlzLndlaWdodGVkT3ZlcmxheVRhYmxlSGVscENsaWNrSGFuZGxlcikoKSB9KSwgaChcInJmeC1ncmlkXCIsIHsgY2FuQWRkOiB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRTY2hlbWEuY2FuQWRkLCBjbGFzczogSFRNTENsYXNzZXMuZ3JpZCwgZ3JpZExheW91dDogdGhpcy53ZWlnaHRlZE92ZXJsYXlHcmlkU2NoZW1hLmdyaWRMYXlvdXQsIGdyaWRPcHRpb25zOiB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRTY2hlbWEuZ3JpZE9wdGlvbnMsIGhhc0JvcmRlcjogdGhpcy53ZWlnaHRlZE92ZXJsYXlHcmlkU2NoZW1hLmhhc0JvcmRlciwgaGFzSGVhZGVyOiB0aGlzLndlaWdodGVkT3ZlcmxheUdyaWRTY2hlbWEuaGFzSGVhZGVyLCBoYXNJZENvbHVtbjogdGhpcy53ZWlnaHRlZE92ZXJsYXlHcmlkU2NoZW1hLmhhc0lkQ29sdW1uLCBpbnB1dExheWVyczogdGhpcy53aWRnZXRBcmdzLmlucHV0TGF5ZXJzLCBvblJmeEdyaWRSb3dDbGljazogdGhpcy5oYW5kbGVHcmlkUm93Q2xpY2ssIG9uUmZ4R3JpZE9wdGlvbkNoYW5nZTogdGhpcy51cGRhdGVWYWx1ZV93ZWlnaHRlZE92ZXJsYXlUYWJsZSwgcmZ4QnJvd3NlTGF5ZXJDbGljazogdGhpcy53aWRnZXRBcmdzLm9uUmZ4QnJvd3NlTGF5ZXJDbGljayB9KSksIGgoXCJjYWxjaXRlLWxhYmVsXCIsIHsgYWxpZ25tZW50OiBcInN0YXJ0XCIsIHNjYWxlOiBVSURlZmF1bHRzLlNjYWxlLCBsYXlvdXQ6IFwiaW5saW5lLXNwYWNlLWJldHdlZW5cIiB9LCBoKFwic3BhblwiLCBudWxsLCB0aGlzLnN0cmluZ3Muc3VtT2ZJbmZsdWVuY2UpLCBoKFwic3BhblwiLCB7IHJlZjogKGUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1bU9mSW5mbHVlbmNlRWxlbWVudCA9IGU7XG4gICAgICAgICAgICB9IH0sIHRoaXMuc3VtT2ZJbmZsdWVuY2UpKSwgaChcImNhbGNpdGUtbGFiZWxcIiwgeyBhbGlnbm1lbnQ6IFwic3RhcnRcIiwgc2NhbGU6IFVJRGVmYXVsdHMuU2NhbGUsIGxheW91dDogXCJkZWZhdWx0XCIsIHJlZjogKGUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbWFwVGFibGVMYWJlbEVsZW1lbnQgPSBlO1xuICAgICAgICAgICAgfSB9LCBoKFwicmZ4LWxhYmVsXCIsIHsgbGFiZWw6IHRoaXMuc3RyaW5ncy5yZW1hcFRhYmxlLCBvblJmeExhYmVsSGVscEFjdGlvbkNsaWNrOiAoKSA9PiB0aGlzLmhlbHBBY3Rpb25DbGlja0V2ZW50SGFuZGxlcnM/LmdldChIZWxwQ2xpY2tIYW5kbGVyS2V5cy5yZW1hcFRhYmxlSGVscENsaWNrSGFuZGxlcikoKSB9KSwgaChcInJmeC1ncmlkXCIsIHsgY2FuQWRkOiB0aGlzLnJlbWFwc0dyaWRTY2hlbWEuY2FuQWRkLCBjbGFzczogSFRNTENsYXNzZXMuZ3JpZCwgZ3JpZExheW91dDogdGhpcy5yZW1hcHNHcmlkU2NoZW1hLmdyaWRMYXlvdXQsIGdyaWRPcHRpb25zOiB0aGlzLnJlbWFwc0dyaWRTY2hlbWEuZ3JpZE9wdGlvbnMsIGhhc0JvcmRlcjogdGhpcy5yZW1hcHNHcmlkU2NoZW1hLmhhc0JvcmRlciwgaGFzSGVhZGVyOiB0aGlzLnJlbWFwc0dyaWRTY2hlbWEuaGFzSGVhZGVyLCBoYXNJZENvbHVtbjogdGhpcy5yZW1hcHNHcmlkU2NoZW1hLmhhc0lkQ29sdW1uLCBvblJmeEdyaWRPcHRpb25DaGFuZ2U6IHRoaXMudXBkYXRlVmFsdWVfcmVtYXBUYWJsZSB9KSksIGgoXCJjYWxjaXRlLWxhYmVsXCIsIHsgYWxpZ25tZW50OiBcInN0YXJ0XCIsIHNjYWxlOiBVSURlZmF1bHRzLlNjYWxlLCBsYXlvdXQ6IFwiZGVmYXVsdFwiLCByZWY6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FsZXNMYWJlbEVsZW1lbnQgPSBlO1xuICAgICAgICAgICAgfSB9LCBoKFwicmZ4LWxhYmVsXCIsIHsgbGFiZWw6IHRoaXMuc3RyaW5ncy5zY2FsZXMsIG9uUmZ4TGFiZWxIZWxwQWN0aW9uQ2xpY2s6ICgpID0+IHRoaXMuaGVscEFjdGlvbkNsaWNrRXZlbnRIYW5kbGVycz8uZ2V0KEhlbHBDbGlja0hhbmRsZXJLZXlzLnNjYWxlc0hlbHBDbGlja0hhbmRsZXIpKCkgfSksIGgoXCJyZngtZHRleC1jb21tb24tc2VsZWN0XCIsIHsgYWxsb3dDdXN0b21WYWx1ZXM6IHRydWUsIG9wdGlvbnM6IHRoaXMuc2NhbGVzT3B0aW9ucywgb25SZnhBcmd1bWVudENoYW5nZTogdGhpcy51cGRhdGVWYWx1ZV9zY2FsZXMsIHZhbHVlOiBgJHt0aGlzLmV2YWxTY2FsZXMuZXZhbEZyb219LSR7dGhpcy5ldmFsU2NhbGVzLmV2YWxUb31gIH0pKSkpO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IGFzc2V0c0RpcnMoKSB7IHJldHVybiBbXCJ0OW5cIl07IH1cbiAgICBnZXQgaG9zdEVsZW1lbnQoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG59O1xuUmZ4Q3RlV2VpZ2h0ZWRPdmVybGF5VGFibGVFZGl0b3Iuc3R5bGUgPSByZnhDdGVXZWlnaHRlZE92ZXJsYXlUYWJsZUVkaXRvckNzcztcblxuZXhwb3J0IHsgUmZ4Q3RlV2VpZ2h0ZWRPdmVybGF5VGFibGVFZGl0b3IgYXMgUiB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZngtY3RlLXdlaWdodGVkLW92ZXJsYXktdGFibGUtZWRpdG9yLTdiOTdkZjFkLmpzLm1hcCIsImV4cG9ydCB7IFIgYXMgcmZ4X2N0ZV93ZWlnaHRlZF9vdmVybGF5X3RhYmxlX2VkaXRvciB9IGZyb20gJy4vcmZ4LWN0ZS13ZWlnaHRlZC1vdmVybGF5LXRhYmxlLWVkaXRvci03Yjk3ZGYxZC5qcyc7XG5pbXBvcnQgJy4vaW5kZXgtZGExYjcxMzguanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvY29yZS9sYW5nLmpzJztcbmltcG9ydCAnLi9sb2NhbGl6YXRpb24taGVscGVyLTQ4MTliNjdkLmpzJztcbmltcG9ydCAnLi90eXBlLWdhdXJkcy0xODQwNzQ3Zi5qcyc7XG5pbXBvcnQgJy4vX2dldFRhZy05NmFmMDI5ZC5qcyc7XG5pbXBvcnQgJy4vdWktdXRpbHMtOTI4YTQwOTYuanMnO1xuaW1wb3J0ICcuL2ludGVyZmFjZXMtZDBjNjg5NDQuanMnO1xuaW1wb3J0ICcuL2xheWVyLWhlbHBlci0zODY3ZWVmNy5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9pZGVudGl0eS9JZGVudGl0eU1hbmFnZXIuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvY29yZS91cmxVdGlscy5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9sYXllcnMvTGF5ZXIuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvbGF5ZXJzL0ltYWdlcnlMYXllci5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9zbWFydE1hcHBpbmcvcmFzdGVyL3JlbmRlcmVycy9zdHJldGNoLmpzJztcbmltcG9ydCAnLi9jb21tb24tZmRhMTQ2MmUuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVxdWVzdC5qcyc7XG5pbXBvcnQgJy4vX1VpbnQ4QXJyYXktNjhlMWUzZjkuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVzdC9zdXBwb3J0L0FsZ29yaXRobWljQ29sb3JSYW1wLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL3Jlc3Qvc3VwcG9ydC9NdWx0aXBhcnRDb2xvclJhbXAuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvQ29sb3IuanMnO1xuaW1wb3J0ICcuL2NvbG9yUmFtcFV0aWxzLThiZGQ0NmM1LmpzJztcbmltcG9ydCAnLi9zYW5pdGl6ZS1udW1iZXItZDg0MTE0ZjcuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVzdC9nZW9wcm9jZXNzb3IuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcG9ydGFsL1BvcnRhbEl0ZW0uanMnO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZngtY3RlLXdlaWdodGVkLW92ZXJsYXktdGFibGUtZWRpdG9yLmVudHJ5LmpzLm1hcCIsImltcG9ydCB7IGcgYXMgZ2V0TG9jYWxlSW5mbyB9IGZyb20gJy4vbG9jYWxpemF0aW9uLWhlbHBlci00ODE5YjY3ZC5qcyc7XG5pbXBvcnQgeyBpIGFzIGlzRW1wdHlEYXRhSXRlbSB9IGZyb20gJy4vdHlwZS1nYXVyZHMtMTg0MDc0N2YuanMnO1xuXG4vKipcbiAqIEluZGljYXRlcyBpZiBhIHByb3ZpZGVkIG51bWJlciB2YWx1ZSBpcyB2YWxpZC5cbiAqIEFuIGludmFsaWQgdmFsdWUgaXM6IHVuZGVmaW5lZCB8IE5hTiB8IEluZmluaXRlIHwgLUluZmluaXRlIHwgbnVsbFxuICogU2VlIGZvciBtb3JlIGRldGFpbHM6XG4gKiAgIC0gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvTnVtYmVyL2lzRmluaXRlXG4gKiAgIC0gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvTnVtYmVyL2lzTmFOXG4gKiBAcGFyYW0ge251bWJlciB8IHVuZGVmaW5lZCB8IG51bGx9IHZhbHVlIHZhbHVlIHRvIGNoZWNrXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gaWYgdmFsaWQgb3Igbm90XG4gKi9cbmZ1bmN0aW9uIGlzVmFsaWROdW1iZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCAmJiBOdW1iZXIuaXNOYU4odmFsdWUpID09PSBmYWxzZSAmJiBOdW1iZXIuaXNGaW5pdGUodmFsdWUpID09PSB0cnVlO1xufVxuLyoqXG4gKiBSZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBwcm92aWRlZCBudW1iZXIgZm9yIHVzZSB3aXRoIGNhbGNpdGUtaW5wdXQuIEl0IGFsc29cbiAqIGd1YXJkcyBhZ2FpbnN0IGludmFsaWQgdHlwZXMgZm9sbG93aW5nIHRoaXMgbG9naWM6XG4gKiAgIC0gSWYgdGhlIHZhbHVlIGlzIHZhbGlkIChub3QgTmFOLCBmaW5pdGUpLCB0aGUgdmFsdWUgaXMgcmV0dXJuZWQgYXMgYSBzdHJpbmdcbiAqICAgLSBJZiBub3QgYW5kIGlmIGEgdmFsaWQgZGVmYXVsdCB2YWx1ZSBpcyBwcm92aWRlZCwgdGhlIGRlZmF1bHQgdmFsdWUgaXMgcmV0dXJuZWQgYXMgYSBzdHJpbmdcbiAqICAgLSBJZiBub3QsIGFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZFxuICogQHBhcmFtIHZhbHVlXG4gKiBAcGFyYW0gZGVmYXVsdFZhbHVlXG4gKiBAcmV0dXJucyBhIHNhbml0aXplZCBzdHJpbmdcbiAqL1xuZnVuY3Rpb24gc2FuaXRpemVOdW1iZXIodmFsdWUsIGRlZmF1bHRWYWx1ZSkge1xuICAgIGxldCByZXR1cm5lZFZhbHVlO1xuICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCB0ZXN0ZWRWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiA/IE51bWJlci5wYXJzZUZsb2F0KHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICBpZiAoaXNWYWxpZE51bWJlcih0ZXN0ZWRWYWx1ZSkpXG4gICAgICAgICAgICByZXR1cm5lZFZhbHVlID0gdGVzdGVkVmFsdWU7XG4gICAgICAgIGVsc2UgaWYgKGlzVmFsaWROdW1iZXIoZGVmYXVsdFZhbHVlKSlcbiAgICAgICAgICAgIHJldHVybmVkVmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5lZFZhbHVlID09PSB1bmRlZmluZWQgPyBcIlwiIDogYCR7cmV0dXJuZWRWYWx1ZX1gO1xufVxuLyoqXG4gKiBQYXJzZXMgYSB2YWx1ZSBzdHJpbmcgdG8gYSBudW1iZXIgZm9yIHVzZSB3aXRoIGNhbGNpdGUtaW5wdXQuIElmIHRoZSBzdHJpbmcgaXMgZW1wdHksIGl0IHdpbGwgcmV0dXJuIHVuZGVmaW5lZC5cbiAqIElmIHRoZSBzdHJpbmcgaXMgb3RoZXJ3aXNlIGludmFsaWQsIGl0IHdpbGwgcmV0dXJuIE5hTi5cbiAqIEBwYXJhbSB2YWx1ZSBjYWxjaXRlLWlucHV0IHZhbHVlXG4gKiBAcmV0dXJucyB7bnVtYmVyIHwgdW5kZWZpbmVkfSB0aGUgcGFyc2VkIG51bWJlclxuICovXG5mdW5jdGlvbiBwYXJzZU51bWJlcih2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gXCJcIilcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICByZXR1cm4gTnVtYmVyLnBhcnNlRmxvYXQodmFsdWUpO1xufVxuLyoqXG4gKiBGb3JtYXRzIGEgbnVtYmVyIHRvIGEgc3BlY2lmaWVkIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlcy5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gdmFsdWUgLSBUaGUgbnVtYmVyIHRvIGZvcm1hdC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBbZnJhY3Rpb25EaWdpdHM9M10gLSBUaGUgbnVtYmVyIG9mIGRlY2ltYWwgcGxhY2VzIHRvIGluY2x1ZGUgaW4gdGhlIGZvcm1hdHRlZCBudW1iZXIuIERlZmF1bHRzIHRvIDMuXG4gKiBAcmV0dXJucyB7bnVtYmVyfHVuZGVmaW5lZH0gLSBUaGUgZm9ybWF0dGVkIG51bWJlciwgb3IgdW5kZWZpbmVkIGlmIHRoZSBpbnB1dCB2YWx1ZSBpcyBlbXB0eS5cbiAqL1xuZnVuY3Rpb24gZm9ybWF0TnVtYmVyKHZhbHVlLCBmcmFjdGlvbkRpZ2l0cyA9IDMpIHtcbiAgICBpZiAoaXNFbXB0eURhdGFJdGVtKHZhbHVlKSlcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICByZXR1cm4gTnVtYmVyLnBhcnNlRmxvYXQodmFsdWUudG9GaXhlZChmcmFjdGlvbkRpZ2l0cykpO1xufVxuLyoqXG4gKiBGb3JtYXRzIGEgbnVtYmVyIG9yIHN0cmluZyByZXByZXNlbnRpbmcgYSBudW1iZXIgYWNjb3JkaW5nIHRvIHRoZSBsb2NhbGUsIHBhc3NpbmcgSW50bCBudW1iZXIgZm9ybWF0IG9wdGlvbnNcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlR2xvYmFsX09iamVjdHMvSW50bC9OdW1iZXJGb3JtYXQvTnVtYmVyRm9ybWF0I29wdGlvbnNcbiAqIEBwYXJhbSB7bnVtYmVyIHwgc3RyaW5nIHwgdW5kZWZpbmVkfSB2YWx1ZSB0byBiZSBmb3JtYXR0ZWQgYW5kIGxvY2FsaXplZFxuICogQHBhcmFtIHtJbnRsLk51bWJlckZvcm1hdE9wdGlvbnN9IGZvcm1hdE9wdGlvbnMgb3B0aW9ucyBvYmplY3QgbWF0Y2hpbmcgSW50bC5OdW1iZXJGb3JtYXRcbiAqIEByZXR1cm5zIHtzdHJpbmd9IGxvY2FsaXplZCAvIHJvdW5kZWQgc3RyaW5nXG4gKi9cbmZ1bmN0aW9uIGZvcm1hdE51bWJlclRvTG9jYWxlKHZhbHVlLCBmb3JtYXRPcHRpb25zKSB7XG4gICAgbGV0IGZvcm1hdHRlZFZhbHVlID0gXCJcIjtcbiAgICBpZiAoIWlzRW1wdHlEYXRhSXRlbSh2YWx1ZSkgJiYgIU51bWJlci5pc05hTih2YWx1ZSkpIHtcbiAgICAgICAgY29uc3QgbG9jYWxlQ29kZSA9IGdldExvY2FsZUluZm8oKS5sb2NhbGU7XG4gICAgICAgIGZvcm1hdHRlZFZhbHVlID0gSW50bC5OdW1iZXJGb3JtYXQobG9jYWxlQ29kZSwgZm9ybWF0T3B0aW9ucykuZm9ybWF0KE51bWJlcih2YWx1ZSkpO1xuICAgIH1cbiAgICByZXR1cm4gZm9ybWF0dGVkVmFsdWU7XG59XG5cbmV4cG9ydCB7IGZvcm1hdE51bWJlclRvTG9jYWxlIGFzIGEsIGZvcm1hdE51bWJlciBhcyBmLCBpc1ZhbGlkTnVtYmVyIGFzIGksIHBhcnNlTnVtYmVyIGFzIHAsIHNhbml0aXplTnVtYmVyIGFzIHMgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2FuaXRpemUtbnVtYmVyLWQ4NDExNGY3LmpzLm1hcCIsImNvbnN0IFVJRGVmYXVsdHMgPSB7XG4gICAgU2NhbGU6IFwic1wiLFxuICAgIFBvcG92ZXJUaW1lcjogNjBcbn07XG5jb25zdCBDYWxjaXRlU2NhbGUgPSB7XG4gICAgczogXCJzXCIsXG4gICAgbTogXCJtXCJcbn07XG5jb25zdCBDYWxjaXRlT3ZlcmxheVBvc2l0aW9uaW5nID0ge1xuICAgIGFic29sdXRlOiBcImFic29sdXRlXCIsXG4gICAgZml4ZWQ6IFwiZml4ZWRcIlxufTtcblxuZXhwb3J0IHsgQ2FsY2l0ZVNjYWxlIGFzIEMsIFVJRGVmYXVsdHMgYXMgVSwgQ2FsY2l0ZU92ZXJsYXlQb3NpdGlvbmluZyBhcyBhIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXVpLXV0aWxzLTkyOGE0MDk2LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==