"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-lazy-lo-5b7d4e"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-lazy-loading-select.entry.js":
/*!*****************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-lazy-loading-select.entry.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_lazy_loading_select: () => (/* binding */ ArcgisLazyLoadingSelect)
/* harmony export */ });
/* harmony import */ var _index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-e3bf7da7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-e3bf7da7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */


const arcgisLazyLoadingSelectCss = ":host{width:100%;overflow:hidden}.lazy-select-button{--calcite-color-foreground-3:var(--calcite-color-border-input)}";

const ArcgisLazyLoadingSelect = class {
    constructor(hostRef) {
        (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.arcgisLazyLoadingSelectChange = (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisLazyLoadingSelectChange", 7);
        this.handleOutsideClick = (event) => {
            if (!this.open) {
                return;
            }
            // when list has single item, simply close
            if (this.list.length > 1) {
                const paths = event.composedPath();
                if (paths.includes(this.hostElement) || paths.includes(this.menuPopOver)) {
                    return;
                }
            }
            this.closeMenuPopOverAndDisconnectHandles();
        };
        this.handleResize = () => this.open && this.closeMenuPopOverAndDisconnectHandles();
        this.list = undefined;
        this.selectedIndex = 0;
        this.containerTop = 0;
        this.containerBottom = undefined;
        this.pageSize = 500;
        this.accumulatePages = true;
        this.strings = undefined;
        this.ariaLabeledBy = undefined;
        this.showFilterLength = 20;
        this.pageId = 0;
        this.open = false;
    }
    watchSelectedIndex(newValue) {
        if (this.menuPopOver) {
            this.menuPopOver.selectedIndex = newValue;
        }
    }
    watchPageSize(newValue) {
        if (this.menuPopOver) {
            this.menuPopOver.pageSize = newValue;
        }
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    disconnectedCallback() {
        this.closeMenuPopOverAndDisconnectHandles();
    }
    // --------------------------------------------------------------------------
    //
    //  Render Methods
    //
    //--------------------------------------------------------------------------
    render() {
        var _a;
        const { selectedIndex, list } = this;
        const selected = selectedIndex >= list.length ? list[0] : list[selectedIndex];
        return ((0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { scale: "s", width: "full", appearance: "outline-fill", kind: this.open ? "brand" : "neutral", class: this.open ? undefined : "lazy-select-button", alignment: "icon-end-space-between", iconEnd: this.open ? "chevron-up" : "chevron-down", "aria-haspopup": "true", "aria-expanded": this.open ? "true" : "false", "aria-label": this.ariaLabeledBy ? undefined : (_a = this.strings) === null || _a === void 0 ? void 0 : _a.selectLabel, "aria-labelledby": this.ariaLabeledBy || undefined, onClick: () => this.renderSelectMenu(), ref: (node) => (this.refNode = node) }, selected.label));
    }
    renderSelectMenu() {
        if (this.menuPopOver) {
            this.closeMenuPopOverAndDisconnectHandles();
            return;
        }
        this.open = true;
        document.addEventListener("pointerdown", this.handleOutsideClick);
        window.addEventListener("resize", this.handleOutsideClick);
        const menuPopOver = document.createElement("arcgis-lazy-loading-list");
        const { height: hostHeight, top: hostTop } = this.hostElement.getBoundingClientRect();
        const { width, left, bottom, top, height: triggerHeight } = this.refNode.getBoundingClientRect();
        const height = hostHeight - triggerHeight - (bottom - hostTop);
        menuPopOver.popoverProps = {
            width,
            left,
            top,
            bottom,
            height,
            containerTop: this.containerTop,
            containerBottom: this.containerBottom
        };
        // fly out to the root container is good when the list requires container wider element that goes beyond select's controller,
        // it's visible without horizontal scrolling, similar to browser's native select control.
        menuPopOver.flyOut = true;
        menuPopOver.strings = this.strings;
        menuPopOver.showFilter = this.list.length >= this.showFilterLength;
        menuPopOver.pageSize = this.pageSize;
        menuPopOver.accumulatePages = this.accumulatePages;
        this.menuPopOver = menuPopOver;
        menuPopOver.addEventListener("arcgisLazyLoadingListChange", (evt) => {
            this.selectedIndex = evt.detail.selectedIndex;
            this.arcgisLazyLoadingSelectChange.emit(evt.detail);
            this.closeMenuPopOverAndDisconnectHandles();
        });
        document.body.appendChild(menuPopOver);
        this.menuPopOver.list = this.list;
        this.menuPopOver.selectedIndex = this.selectedIndex;
        this.setupMarginObservers();
    }
    // --------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    closeMenuPopOverAndDisconnectHandles() {
        this.disconnectObservers();
        document.removeEventListener("pointerdown", this.handleOutsideClick);
        window.removeEventListener("resize", this.handleOutsideClick);
        if (this.menuPopOver) {
            setTimeout(() => {
                document.body.removeChild(this.menuPopOver);
                this.menuPopOver = null;
            }, 100);
        }
        this.open = false;
    }
    setupMarginObservers() {
        const { top: selectTop, bottom: selectBottom } = this.refNode.getBoundingClientRect();
        const { clientHeight } = document.body;
        this.disconnectObservers();
        const rootMarginForTop = `0px 0px ${selectBottom - clientHeight}px 0px`;
        this.topObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (!entry.isIntersecting) {
                    this.closeMenuPopOverAndDisconnectHandles();
                }
            });
        }, { rootMargin: rootMarginForTop });
        const rootMarginForBottom = `${-selectTop}px 0px 0px 0px`;
        this.bottomObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (!entry.isIntersecting) {
                    this.closeMenuPopOverAndDisconnectHandles();
                }
            });
        }, { rootMargin: rootMarginForBottom });
        this.topObserver.observe(this.refNode);
        this.bottomObserver.observe(this.refNode);
    }
    disconnectObservers() {
        var _a, _b;
        (_a = this.topObserver) === null || _a === void 0 ? void 0 : _a.disconnect();
        (_b = this.bottomObserver) === null || _b === void 0 ? void 0 : _b.disconnect();
        this.topObserver = null;
        this.bottomObserver = null;
    }
    get hostElement() { return (0,_index_e3bf7da7_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
    static get watchers() { return {
        "selectedIndex": ["watchSelectedIndex"],
        "pageSize": ["watchPageSize"]
    }; }
};
ArcgisLazyLoadingSelect.style = arcgisLazyLoadingSelectCss;



//# sourceMappingURL=arcgis-lazy-loading-select.entry.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLWxhenktbG8tNWI3ZDRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDa0c7O0FBRWxHLDBDQUEwQyxXQUFXLGdCQUFnQixvQkFBb0IsK0RBQStEOztBQUV4SjtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEIsNkNBQTZDLHFEQUFXO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixzQkFBc0I7QUFDdEM7QUFDQSxnQkFBZ0IscURBQUMscUJBQXFCLDhpQkFBOGlCO0FBQ3BsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixtQ0FBbUM7QUFDbkQsZ0JBQWdCLGtEQUFrRDtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsdUNBQXVDO0FBQ3ZELGdCQUFnQixlQUFlO0FBQy9CO0FBQ0EsNENBQTRDLDRCQUE0QjtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVMsSUFBSSw4QkFBOEI7QUFDM0MsdUNBQXVDLFdBQVc7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTLElBQUksaUNBQWlDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLE9BQU8scURBQVU7QUFDekMsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWlFOztBQUVqRSIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1sYXp5LWxvYWRpbmctc2VsZWN0LmVudHJ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHY0LjAuNThcbiAqL1xuaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBkIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LWUzYmY3ZGE3LmpzJztcblxuY29uc3QgYXJjZ2lzTGF6eUxvYWRpbmdTZWxlY3RDc3MgPSBcIjpob3N0e3dpZHRoOjEwMCU7b3ZlcmZsb3c6aGlkZGVufS5sYXp5LXNlbGVjdC1idXR0b257LS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMzp2YXIoLS1jYWxjaXRlLWNvbG9yLWJvcmRlci1pbnB1dCl9XCI7XG5cbmNvbnN0IEFyY2dpc0xhenlMb2FkaW5nU2VsZWN0ID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgdGhpcy5hcmNnaXNMYXp5TG9hZGluZ1NlbGVjdENoYW5nZSA9IGNyZWF0ZUV2ZW50KHRoaXMsIFwiYXJjZ2lzTGF6eUxvYWRpbmdTZWxlY3RDaGFuZ2VcIiwgNyk7XG4gICAgICAgIHRoaXMuaGFuZGxlT3V0c2lkZUNsaWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMub3Blbikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHdoZW4gbGlzdCBoYXMgc2luZ2xlIGl0ZW0sIHNpbXBseSBjbG9zZVxuICAgICAgICAgICAgaWYgKHRoaXMubGlzdC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGF0aHMgPSBldmVudC5jb21wb3NlZFBhdGgoKTtcbiAgICAgICAgICAgICAgICBpZiAocGF0aHMuaW5jbHVkZXModGhpcy5ob3N0RWxlbWVudCkgfHwgcGF0aHMuaW5jbHVkZXModGhpcy5tZW51UG9wT3ZlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2xvc2VNZW51UG9wT3ZlckFuZERpc2Nvbm5lY3RIYW5kbGVzKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlUmVzaXplID0gKCkgPT4gdGhpcy5vcGVuICYmIHRoaXMuY2xvc2VNZW51UG9wT3ZlckFuZERpc2Nvbm5lY3RIYW5kbGVzKCk7XG4gICAgICAgIHRoaXMubGlzdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5jb250YWluZXJUb3AgPSAwO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckJvdHRvbSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wYWdlU2l6ZSA9IDUwMDtcbiAgICAgICAgdGhpcy5hY2N1bXVsYXRlUGFnZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLnN0cmluZ3MgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuYXJpYUxhYmVsZWRCeSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zaG93RmlsdGVyTGVuZ3RoID0gMjA7XG4gICAgICAgIHRoaXMucGFnZUlkID0gMDtcbiAgICAgICAgdGhpcy5vcGVuID0gZmFsc2U7XG4gICAgfVxuICAgIHdhdGNoU2VsZWN0ZWRJbmRleChuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5tZW51UG9wT3Zlcikge1xuICAgICAgICAgICAgdGhpcy5tZW51UG9wT3Zlci5zZWxlY3RlZEluZGV4ID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd2F0Y2hQYWdlU2l6ZShuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5tZW51UG9wT3Zlcikge1xuICAgICAgICAgICAgdGhpcy5tZW51UG9wT3Zlci5wYWdlU2l6ZSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBMaWZlY3ljbGVcbiAgICAvL1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgdGhpcy5jbG9zZU1lbnVQb3BPdmVyQW5kRGlzY29ubmVjdEhhbmRsZXMoKTtcbiAgICB9XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBSZW5kZXIgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBjb25zdCB7IHNlbGVjdGVkSW5kZXgsIGxpc3QgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkID0gc2VsZWN0ZWRJbmRleCA+PSBsaXN0Lmxlbmd0aCA/IGxpc3RbMF0gOiBsaXN0W3NlbGVjdGVkSW5kZXhdO1xuICAgICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWJ1dHRvblwiLCB7IHNjYWxlOiBcInNcIiwgd2lkdGg6IFwiZnVsbFwiLCBhcHBlYXJhbmNlOiBcIm91dGxpbmUtZmlsbFwiLCBraW5kOiB0aGlzLm9wZW4gPyBcImJyYW5kXCIgOiBcIm5ldXRyYWxcIiwgY2xhc3M6IHRoaXMub3BlbiA/IHVuZGVmaW5lZCA6IFwibGF6eS1zZWxlY3QtYnV0dG9uXCIsIGFsaWdubWVudDogXCJpY29uLWVuZC1zcGFjZS1iZXR3ZWVuXCIsIGljb25FbmQ6IHRoaXMub3BlbiA/IFwiY2hldnJvbi11cFwiIDogXCJjaGV2cm9uLWRvd25cIiwgXCJhcmlhLWhhc3BvcHVwXCI6IFwidHJ1ZVwiLCBcImFyaWEtZXhwYW5kZWRcIjogdGhpcy5vcGVuID8gXCJ0cnVlXCIgOiBcImZhbHNlXCIsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLmFyaWFMYWJlbGVkQnkgPyB1bmRlZmluZWQgOiAoX2EgPSB0aGlzLnN0cmluZ3MpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZWxlY3RMYWJlbCwgXCJhcmlhLWxhYmVsbGVkYnlcIjogdGhpcy5hcmlhTGFiZWxlZEJ5IHx8IHVuZGVmaW5lZCwgb25DbGljazogKCkgPT4gdGhpcy5yZW5kZXJTZWxlY3RNZW51KCksIHJlZjogKG5vZGUpID0+ICh0aGlzLnJlZk5vZGUgPSBub2RlKSB9LCBzZWxlY3RlZC5sYWJlbCkpO1xuICAgIH1cbiAgICByZW5kZXJTZWxlY3RNZW51KCkge1xuICAgICAgICBpZiAodGhpcy5tZW51UG9wT3Zlcikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZU1lbnVQb3BPdmVyQW5kRGlzY29ubmVjdEhhbmRsZXMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9wZW4gPSB0cnVlO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgdGhpcy5oYW5kbGVPdXRzaWRlQ2xpY2spO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLmhhbmRsZU91dHNpZGVDbGljayk7XG4gICAgICAgIGNvbnN0IG1lbnVQb3BPdmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFyY2dpcy1sYXp5LWxvYWRpbmctbGlzdFwiKTtcbiAgICAgICAgY29uc3QgeyBoZWlnaHQ6IGhvc3RIZWlnaHQsIHRvcDogaG9zdFRvcCB9ID0gdGhpcy5ob3N0RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgbGVmdCwgYm90dG9tLCB0b3AsIGhlaWdodDogdHJpZ2dlckhlaWdodCB9ID0gdGhpcy5yZWZOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBob3N0SGVpZ2h0IC0gdHJpZ2dlckhlaWdodCAtIChib3R0b20gLSBob3N0VG9wKTtcbiAgICAgICAgbWVudVBvcE92ZXIucG9wb3ZlclByb3BzID0ge1xuICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICBsZWZ0LFxuICAgICAgICAgICAgdG9wLFxuICAgICAgICAgICAgYm90dG9tLFxuICAgICAgICAgICAgaGVpZ2h0LFxuICAgICAgICAgICAgY29udGFpbmVyVG9wOiB0aGlzLmNvbnRhaW5lclRvcCxcbiAgICAgICAgICAgIGNvbnRhaW5lckJvdHRvbTogdGhpcy5jb250YWluZXJCb3R0b21cbiAgICAgICAgfTtcbiAgICAgICAgLy8gZmx5IG91dCB0byB0aGUgcm9vdCBjb250YWluZXIgaXMgZ29vZCB3aGVuIHRoZSBsaXN0IHJlcXVpcmVzIGNvbnRhaW5lciB3aWRlciBlbGVtZW50IHRoYXQgZ29lcyBiZXlvbmQgc2VsZWN0J3MgY29udHJvbGxlcixcbiAgICAgICAgLy8gaXQncyB2aXNpYmxlIHdpdGhvdXQgaG9yaXpvbnRhbCBzY3JvbGxpbmcsIHNpbWlsYXIgdG8gYnJvd3NlcidzIG5hdGl2ZSBzZWxlY3QgY29udHJvbC5cbiAgICAgICAgbWVudVBvcE92ZXIuZmx5T3V0ID0gdHJ1ZTtcbiAgICAgICAgbWVudVBvcE92ZXIuc3RyaW5ncyA9IHRoaXMuc3RyaW5ncztcbiAgICAgICAgbWVudVBvcE92ZXIuc2hvd0ZpbHRlciA9IHRoaXMubGlzdC5sZW5ndGggPj0gdGhpcy5zaG93RmlsdGVyTGVuZ3RoO1xuICAgICAgICBtZW51UG9wT3Zlci5wYWdlU2l6ZSA9IHRoaXMucGFnZVNpemU7XG4gICAgICAgIG1lbnVQb3BPdmVyLmFjY3VtdWxhdGVQYWdlcyA9IHRoaXMuYWNjdW11bGF0ZVBhZ2VzO1xuICAgICAgICB0aGlzLm1lbnVQb3BPdmVyID0gbWVudVBvcE92ZXI7XG4gICAgICAgIG1lbnVQb3BPdmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJhcmNnaXNMYXp5TG9hZGluZ0xpc3RDaGFuZ2VcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gZXZ0LmRldGFpbC5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgdGhpcy5hcmNnaXNMYXp5TG9hZGluZ1NlbGVjdENoYW5nZS5lbWl0KGV2dC5kZXRhaWwpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZU1lbnVQb3BPdmVyQW5kRGlzY29ubmVjdEhhbmRsZXMoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWVudVBvcE92ZXIpO1xuICAgICAgICB0aGlzLm1lbnVQb3BPdmVyLmxpc3QgPSB0aGlzLmxpc3Q7XG4gICAgICAgIHRoaXMubWVudVBvcE92ZXIuc2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdGhpcy5zZXR1cE1hcmdpbk9ic2VydmVycygpO1xuICAgIH1cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIFByaXZhdGUgTWV0aG9kc1xuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGNsb3NlTWVudVBvcE92ZXJBbmREaXNjb25uZWN0SGFuZGxlcygpIHtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0T2JzZXJ2ZXJzKCk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCB0aGlzLmhhbmRsZU91dHNpZGVDbGljayk7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuaGFuZGxlT3V0c2lkZUNsaWNrKTtcbiAgICAgICAgaWYgKHRoaXMubWVudVBvcE92ZXIpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5tZW51UG9wT3Zlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51UG9wT3ZlciA9IG51bGw7XG4gICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuICAgIH1cbiAgICBzZXR1cE1hcmdpbk9ic2VydmVycygpIHtcbiAgICAgICAgY29uc3QgeyB0b3A6IHNlbGVjdFRvcCwgYm90dG9tOiBzZWxlY3RCb3R0b20gfSA9IHRoaXMucmVmTm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgeyBjbGllbnRIZWlnaHQgfSA9IGRvY3VtZW50LmJvZHk7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdE9ic2VydmVycygpO1xuICAgICAgICBjb25zdCByb290TWFyZ2luRm9yVG9wID0gYDBweCAwcHggJHtzZWxlY3RCb3R0b20gLSBjbGllbnRIZWlnaHR9cHggMHB4YDtcbiAgICAgICAgdGhpcy50b3BPYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcigoZW50cmllcykgPT4ge1xuICAgICAgICAgICAgZW50cmllcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghZW50cnkuaXNJbnRlcnNlY3RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZU1lbnVQb3BPdmVyQW5kRGlzY29ubmVjdEhhbmRsZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgeyByb290TWFyZ2luOiByb290TWFyZ2luRm9yVG9wIH0pO1xuICAgICAgICBjb25zdCByb290TWFyZ2luRm9yQm90dG9tID0gYCR7LXNlbGVjdFRvcH1weCAwcHggMHB4IDBweGA7XG4gICAgICAgIHRoaXMuYm90dG9tT2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHtcbiAgICAgICAgICAgIGVudHJpZXMuZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VNZW51UG9wT3ZlckFuZERpc2Nvbm5lY3RIYW5kbGVzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIHsgcm9vdE1hcmdpbjogcm9vdE1hcmdpbkZvckJvdHRvbSB9KTtcbiAgICAgICAgdGhpcy50b3BPYnNlcnZlci5vYnNlcnZlKHRoaXMucmVmTm9kZSk7XG4gICAgICAgIHRoaXMuYm90dG9tT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLnJlZk5vZGUpO1xuICAgIH1cbiAgICBkaXNjb25uZWN0T2JzZXJ2ZXJzKCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAoX2EgPSB0aGlzLnRvcE9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZGlzY29ubmVjdCgpO1xuICAgICAgICAoX2IgPSB0aGlzLmJvdHRvbU9ic2VydmVyKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLnRvcE9ic2VydmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5ib3R0b21PYnNlcnZlciA9IG51bGw7XG4gICAgfVxuICAgIGdldCBob3N0RWxlbWVudCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgICAgICBcInNlbGVjdGVkSW5kZXhcIjogW1wid2F0Y2hTZWxlY3RlZEluZGV4XCJdLFxuICAgICAgICBcInBhZ2VTaXplXCI6IFtcIndhdGNoUGFnZVNpemVcIl1cbiAgICB9OyB9XG59O1xuQXJjZ2lzTGF6eUxvYWRpbmdTZWxlY3Quc3R5bGUgPSBhcmNnaXNMYXp5TG9hZGluZ1NlbGVjdENzcztcblxuZXhwb3J0IHsgQXJjZ2lzTGF6eUxvYWRpbmdTZWxlY3QgYXMgYXJjZ2lzX2xhenlfbG9hZGluZ19zZWxlY3QgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXJjZ2lzLWxhenktbG9hZGluZy1zZWxlY3QuZW50cnkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9