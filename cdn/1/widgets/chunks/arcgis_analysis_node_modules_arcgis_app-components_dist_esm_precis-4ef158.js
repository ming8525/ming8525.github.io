"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_precis-4ef158"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/precision-06a73672.js":
/*!***************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/precision-06a73672.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getCurrentPrecisionValue),
/* harmony export */   b: () => (/* binding */ buildPrecisionsList),
/* harmony export */   g: () => (/* binding */ getStopPrecision),
/* harmony export */   u: () => (/* binding */ updateValuesWithPrecision)
/* harmony export */ });
/* harmony import */ var _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./raster-unique-value-0976ec7f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/raster-unique-value-0976ec7f.js");
/* harmony import */ var _loadModules_b4ac1247_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadModules-b4ac1247.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-b4ac1247.js");
/* harmony import */ var _commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./commonFunctions-b0830e9e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-b0830e9e.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v4.0.58
 */




function updateValuesWithPrecision(precision) {
    const { layer, modules } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    const renderer = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.h)(layer);
    const infos = modules.esriLang.clone(renderer.classBreakInfos);
    renderer.classBreakInfos = [];
    infos.forEach((info, idx) => {
        info = _updateMinMax(info, precision, idx, idx === 0 ? "first" : idx === infos.length - 1 ? "last" : undefined);
        //renderer.removeClassBreakInfo(info.minValue, info.maxValue);
        renderer.addClassBreakInfo({
            minValue: info.minValue,
            maxValue: info.maxValue,
            symbol: info.symbol,
            label: info.label
        });
    });
}
function buildPrecisionsList(decimalPlaces) {
    const { layer } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    const renderer = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.h)(layer);
    const infos = renderer.classBreakInfos;
    let places = decimalPlaces;
    let minInfoRange = Infinity;
    infos.forEach((info) => {
        if (!places) {
            places = Math.max(_getDecimalPrecision(info.minValue), _getDecimalPrecision(info.maxValue));
        }
        minInfoRange = Math.min(minInfoRange, info.maxValue - info.minValue);
    });
    const values = [];
    if (minInfoRange > 10000000) {
        values.push(10000000);
        values.push(1000000);
        values.push(100000);
        values.push(10000);
        values.push(1000);
        values.push(100);
        values.push(10);
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
    }
    else if (minInfoRange > 1000000) {
        values.push(1000000);
        values.push(100000);
        values.push(10000);
        values.push(1000);
        values.push(100);
        values.push(10);
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
    }
    else if (minInfoRange > 100000) {
        values.push(100000);
        values.push(10000);
        values.push(1000);
        values.push(100);
        values.push(10);
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
    }
    else if (minInfoRange > 10000) {
        values.push(10000);
        values.push(1000);
        values.push(100);
        values.push(10);
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
    }
    else if (minInfoRange > 1000) {
        values.push(1000);
        values.push(100);
        values.push(10);
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
        if (places > 3) {
            values.push(0.001);
        }
    }
    else if (minInfoRange > 100) {
        values.push(100);
        values.push(10);
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
        if (places > 3) {
            values.push(0.001);
        }
        if (places > 4) {
            values.push(0.0001);
        }
        if (places > 5) {
            values.push(0.00001);
        }
    }
    else if (minInfoRange > 10) {
        values.push(10);
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
        if (places > 3) {
            values.push(0.001);
        }
        if (places > 4) {
            values.push(0.0001);
        }
        if (places > 5) {
            values.push(0.00001);
        }
        if (places > 6) {
            values.push(0.000001);
        }
    }
    else if (minInfoRange > 1) {
        if (places > 0) {
            values.push(1);
        }
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
        if (places > 3) {
            values.push(0.001);
        }
        if (places > 4) {
            values.push(0.0001);
        }
        if (places > 5) {
            values.push(0.00001);
        }
        if (places > 6) {
            values.push(0.000001);
        }
    }
    else if (minInfoRange > 0.1) {
        if (places > 1) {
            values.push(0.1);
        }
        if (places > 2) {
            values.push(0.01);
        }
        if (places > 3) {
            values.push(0.001);
        }
        if (places > 4) {
            values.push(0.0001);
        }
        if (places > 5) {
            values.push(0.00001);
        }
        if (places > 6) {
            values.push(0.000001);
        }
    }
    else if (minInfoRange > 0.01) {
        if (places > 2) {
            values.push(0.01);
        }
        if (places > 3) {
            values.push(0.001);
        }
        if (places > 4) {
            values.push(0.0001);
        }
        if (places > 5) {
            values.push(0.00001);
        }
        if (places > 6) {
            values.push(0.000001);
        }
    }
    else if (minInfoRange > 0.001) {
        if (places > 3) {
            values.push(0.001);
        }
        if (places > 4) {
            values.push(0.0001);
        }
        if (places > 5) {
            values.push(0.00001);
        }
        if (places > 6) {
            values.push(0.000001);
        }
        if (places > 7) {
            values.push(0.0000001);
        }
    }
    else if (minInfoRange > 0.0001) {
        if (places > 4) {
            values.push(0.0001);
        }
        if (places > 5) {
            values.push(0.00001);
        }
        if (places > 6) {
            values.push(0.000001);
        }
        if (places > 7) {
            values.push(0.0000001);
        }
        if (places > 8) {
            values.push(0.00000001);
        }
    }
    else if (minInfoRange > 0.00001) {
        if (places > 5) {
            values.push(0.00001);
        }
        if (places > 6) {
            values.push(0.000001);
        }
        if (places > 7) {
            values.push(0.0000001);
        }
        if (places > 8) {
            values.push(0.00000001);
        }
        if (places > 9) {
            values.push(0.000000001);
        }
    }
    return values;
}
function getCurrentPrecisionValue() {
    const { layer } = _raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s;
    const renderer = (0,_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.h)(layer);
    let precisionValue = 10000000000;
    renderer.classBreakInfos.forEach((info) => {
        precisionValue = Math.min(precisionValue, _getValuePrecision(info.minValue));
        precisionValue = Math.min(precisionValue, _getValuePrecision(info.maxValue));
    });
    return precisionValue;
}
function _updateMinMax(info, precision, pos, type) {
    // type: ["first"|"last"|undefined]
    if ((0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(precision)) {
        /*
        if (renderer.normalizationType === "percent-of-total") {
          if (precision === 0) {
    
          } else if (precision < 1) {
            // to prevent rounding issues
            var divider = Math.round(1/precision);
            if (type === "first") {
              info.minValue = Math.floor(info.minValue/precision)/divider;
            } else {
              info.minValue = Math.round(info.minValue/precision)/divider;
            }
            if (type === "last") {
              info.maxValue = Math.ceil(info.maxValue/precision)/divider;
            } else {
              info.maxValue = Math.round(info.maxValue/precision)/divider;
            }
            info.label = ((pos > 0) ? "> " : "") + String.substitute(this.i18n.percentValue,{num: number.format(info.minValue, {pattern: this.pattern})}) + " " + this.i18n.to + " " + string.substitute(this.i18n.percentValue,{num: number.format(info.maxValue, {pattern: this.pattern})});
          } else {
            if (type === "first") {
              info.minValue = Math.floor(info.minValue/precision)*precision;
            } else {
              info.minValue = Math.round(info.minValue/precision)*precision;
            }
            if (type === "last") {
              info.maxValue = Math.ceil(info.maxValue/precision)*precision;
            } else {
              info.maxValue = Math.round(info.maxValue/precision)*precision;
            }
            info.label = ((pos > 0) ? "> " : "") + string.substitute(this.i18n.percentValue,{num: number.format(info.minValue, {pattern: this.pattern})}) + " " + this.i18n.to + " " + string.substitute(this.i18n.percentValue,{num: number.format(info.maxValue, {pattern: this.pattern})});
          }
        } else {
      */
        if (precision === 0) ;
        else if (precision < 1) {
            // to prevent rounding issues
            const divider = Math.round(1 / precision);
            if (type === "first") {
                info.minValue = Math.floor(info.minValue / precision) / divider;
            }
            else {
                info.minValue = Math.round(info.minValue / precision) / divider;
            }
            if (type === "last") {
                info.maxValue = Math.ceil(info.maxValue / precision) / divider;
            }
            else {
                info.maxValue = Math.round(info.maxValue / precision) / divider;
            }
            info.label = `${pos > 0 ? "> " : ""}${info.minValue.toLocaleString(_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s.fullLocale, {
                maximumSignificantDigits: 15
            })} - ${info.maxValue.toLocaleString(_raster_unique_value_0976ec7f_js__WEBPACK_IMPORTED_MODULE_0__.s.fullLocale, {
                maximumSignificantDigits: 15
            })}`;
        }
        else {
            if (type === "first") {
                info.minValue = Math.floor(info.minValue / precision) * precision;
            }
            else {
                info.minValue = Math.round(info.minValue / precision) * precision;
            }
            if (type === "last") {
                info.maxValue = Math.ceil(info.maxValue / precision) * precision;
            }
            else {
                info.maxValue = Math.round(info.maxValue / precision) * precision;
            }
            info.label = (pos > 0 ? "> " : "") + info.minValue.toLocaleString() + " - " + info.maxValue.toLocaleString();
        }
        //}
    }
    return info;
}
/*
function disableOptionsBelow(select, val) {

  array.forEach(select.options, function(option) {
    var item = option.item;
    if (item.type[0] !== "select" && parseFloat(item.name[0]) < val) {
      option.disabled = true;
    }
  });
  select.startup();
}

function enableAllOptions(select) {

  array.forEach(select.options, function(option) {
    delete option.disabled;
  });
  select.startup();
},
*/
function _getDecimalPrecision(value) {
    let e = 1;
    while (Math.round(value * e) / e !== value)
        e *= 10;
    return Math.log(e) / Math.LN10;
}
function _getValuePrecision(value) {
    let precision = 0.00000001;
    while (_fixNumber(Math.round(value / precision) * precision) === value) {
        precision *= 10;
    }
    return precision / 10;
}
function _fixNumber(number) {
    // 0.00009999999999999999 -> 0.0001
    // 3.4000000000000004 -> 3.4
    return parseFloat(number.toPrecision(12));
}
function getStopPrecision(stops) {
    var _a, _b, _c, _d, _e, _f, _g, _h;
    let precision = 0;
    stops.forEach((info) => {
        if ((0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(info.value)) {
            precision = Math.max(_getDecimalPrecision(_fixNumber(info.value)), precision);
        }
        else {
            if ((0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(info.minValue)) {
                precision = Math.max(_getDecimalPrecision(_fixNumber(info.minValue)), precision);
            }
            if ((0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(info.maxValue)) {
                precision = Math.max(_getDecimalPrecision(_fixNumber(info.maxValue)), precision);
            }
            if ((0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(info.min)) {
                precision = Math.max(_getDecimalPrecision(_fixNumber(info.min)), precision);
            }
            if ((0,_commonFunctions_b0830e9e_js__WEBPACK_IMPORTED_MODULE_2__.i)(info.max)) {
                precision = Math.max(_getDecimalPrecision(_fixNumber(info.max)), precision);
            }
        }
    });
    // never show more than 3 decimals on slider, unless <see below>
    precision = Math.min(precision, 3);
    // make sure precision fits to range of values
    const first = stops[0];
    const last = stops[stops.length - 1];
    const min = Math.min((_b = (_a = first.minValue) !== null && _a !== void 0 ? _a : first.min) !== null && _b !== void 0 ? _b : first.value, (_d = (_c = last.minValue) !== null && _c !== void 0 ? _c : last.min) !== null && _d !== void 0 ? _d : last.value);
    const max = Math.max((_f = (_e = first.maxValue) !== null && _e !== void 0 ? _e : first.max) !== null && _f !== void 0 ? _f : first.value, (_h = (_g = last.maxValue) !== null && _g !== void 0 ? _g : last.max) !== null && _h !== void 0 ? _h : last.value);
    const range = max - min;
    if (range / stops.length < 0.0000002) {
        precision = 8;
    }
    else if (range / stops.length < 0.000002) {
        precision = 7;
    }
    else if (range / stops.length < 0.00002) {
        precision = 6;
    }
    else if (range / stops.length < 0.0002) {
        precision = 5;
    }
    else if (range / stops.length < 0.002) {
        precision = 4;
    }
    else if (range / stops.length < 0.02) {
        precision = 3;
    }
    else if (range / stops.length < 0.2) {
        precision = Math.max(precision, 2);
    }
    else if (range / stops.length < 2) {
        precision = Math.max(precision, 1);
    }
    return Math.round(precision);
}



//# sourceMappingURL=precision-06a73672.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fcHJlY2lzLTRlZjE1OC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDNkY7QUFDMUQ7QUFDNEI7O0FBRS9EO0FBQ0EsWUFBWSxpQkFBaUIsRUFBRSwrREFBaUI7QUFDaEQscUJBQXFCLG1FQUFXO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWSxRQUFRLEVBQUUsK0RBQWlCO0FBQ3ZDLHFCQUFxQixtRUFBVztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxRQUFRLEVBQUUsK0RBQWlCO0FBQ3ZDLHFCQUFxQixtRUFBVztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQVM7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBLDZGQUE2RixtQ0FBbUMsc0JBQXNCLEVBQUUseUVBQXlFLG1DQUFtQyxzQkFBc0IsRUFBRTtBQUM1UixZQUFZO0FBQ1o7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsNkZBQTZGLG1DQUFtQyxzQkFBc0IsRUFBRSx5RUFBeUUsbUNBQW1DLHNCQUFzQixFQUFFO0FBQzVSO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsb0JBQW9CLEVBQUUsNkJBQTZCLCtEQUFpQjtBQUNoRztBQUNBLGFBQWEsR0FBRyxJQUFJLDZCQUE2QiwrREFBaUI7QUFDbEU7QUFDQSxhQUFhLEVBQUU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwrREFBUztBQUNyQjtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsK0RBQVM7QUFDekI7QUFDQTtBQUNBLGdCQUFnQiwrREFBUztBQUN6QjtBQUNBO0FBQ0EsZ0JBQWdCLCtEQUFTO0FBQ3pCO0FBQ0E7QUFDQSxnQkFBZ0IsK0RBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUUwSDs7QUFFMUgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9wcmVjaXNpb24tMDZhNzM2NzIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjQuMC41OFxuICovXG5pbXBvcnQgeyBzIGFzIHNtYXJ0TWFwcGluZ1N0YXRlLCBoIGFzIGdldFJlbmRlcmVyIH0gZnJvbSAnLi9yYXN0ZXItdW5pcXVlLXZhbHVlLTA5NzZlYzdmLmpzJztcbmltcG9ydCAnLi9sb2FkTW9kdWxlcy1iNGFjMTI0Ny5qcyc7XG5pbXBvcnQgeyBpIGFzIGlzRGVmaW5lZCB9IGZyb20gJy4vY29tbW9uRnVuY3Rpb25zLWIwODMwZTllLmpzJztcblxuZnVuY3Rpb24gdXBkYXRlVmFsdWVzV2l0aFByZWNpc2lvbihwcmVjaXNpb24pIHtcbiAgICBjb25zdCB7IGxheWVyLCBtb2R1bGVzIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICBjb25zdCByZW5kZXJlciA9IGdldFJlbmRlcmVyKGxheWVyKTtcbiAgICBjb25zdCBpbmZvcyA9IG1vZHVsZXMuZXNyaUxhbmcuY2xvbmUocmVuZGVyZXIuY2xhc3NCcmVha0luZm9zKTtcbiAgICByZW5kZXJlci5jbGFzc0JyZWFrSW5mb3MgPSBbXTtcbiAgICBpbmZvcy5mb3JFYWNoKChpbmZvLCBpZHgpID0+IHtcbiAgICAgICAgaW5mbyA9IF91cGRhdGVNaW5NYXgoaW5mbywgcHJlY2lzaW9uLCBpZHgsIGlkeCA9PT0gMCA/IFwiZmlyc3RcIiA6IGlkeCA9PT0gaW5mb3MubGVuZ3RoIC0gMSA/IFwibGFzdFwiIDogdW5kZWZpbmVkKTtcbiAgICAgICAgLy9yZW5kZXJlci5yZW1vdmVDbGFzc0JyZWFrSW5mbyhpbmZvLm1pblZhbHVlLCBpbmZvLm1heFZhbHVlKTtcbiAgICAgICAgcmVuZGVyZXIuYWRkQ2xhc3NCcmVha0luZm8oe1xuICAgICAgICAgICAgbWluVmFsdWU6IGluZm8ubWluVmFsdWUsXG4gICAgICAgICAgICBtYXhWYWx1ZTogaW5mby5tYXhWYWx1ZSxcbiAgICAgICAgICAgIHN5bWJvbDogaW5mby5zeW1ib2wsXG4gICAgICAgICAgICBsYWJlbDogaW5mby5sYWJlbFxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGJ1aWxkUHJlY2lzaW9uc0xpc3QoZGVjaW1hbFBsYWNlcykge1xuICAgIGNvbnN0IHsgbGF5ZXIgfSA9IHNtYXJ0TWFwcGluZ1N0YXRlO1xuICAgIGNvbnN0IHJlbmRlcmVyID0gZ2V0UmVuZGVyZXIobGF5ZXIpO1xuICAgIGNvbnN0IGluZm9zID0gcmVuZGVyZXIuY2xhc3NCcmVha0luZm9zO1xuICAgIGxldCBwbGFjZXMgPSBkZWNpbWFsUGxhY2VzO1xuICAgIGxldCBtaW5JbmZvUmFuZ2UgPSBJbmZpbml0eTtcbiAgICBpbmZvcy5mb3JFYWNoKChpbmZvKSA9PiB7XG4gICAgICAgIGlmICghcGxhY2VzKSB7XG4gICAgICAgICAgICBwbGFjZXMgPSBNYXRoLm1heChfZ2V0RGVjaW1hbFByZWNpc2lvbihpbmZvLm1pblZhbHVlKSwgX2dldERlY2ltYWxQcmVjaXNpb24oaW5mby5tYXhWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIG1pbkluZm9SYW5nZSA9IE1hdGgubWluKG1pbkluZm9SYW5nZSwgaW5mby5tYXhWYWx1ZSAtIGluZm8ubWluVmFsdWUpO1xuICAgIH0pO1xuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGlmIChtaW5JbmZvUmFuZ2UgPiAxMDAwMDAwMCkge1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwMDAwMCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKDEwMDAwMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwMCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKDEwMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMCk7XG4gICAgICAgIGlmIChwbGFjZXMgPiAwKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMSkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4xKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMikge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobWluSW5mb1JhbmdlID4gMTAwMDAwMCkge1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwMDAwKTtcbiAgICAgICAgdmFsdWVzLnB1c2goMTAwMDAwKTtcbiAgICAgICAgdmFsdWVzLnB1c2goMTAwMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwKTtcbiAgICAgICAgdmFsdWVzLnB1c2goMTAwKTtcbiAgICAgICAgdmFsdWVzLnB1c2goMTApO1xuICAgICAgICBpZiAocGxhY2VzID4gMCkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDEpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDIpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG1pbkluZm9SYW5nZSA+IDEwMDAwMCkge1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwMCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKDEwMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMCk7XG4gICAgICAgIGlmIChwbGFjZXMgPiAwKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMSkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4xKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMikge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobWluSW5mb1JhbmdlID4gMTAwMDApIHtcbiAgICAgICAgdmFsdWVzLnB1c2goMTAwMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDAwKTtcbiAgICAgICAgdmFsdWVzLnB1c2goMTAwKTtcbiAgICAgICAgdmFsdWVzLnB1c2goMTApO1xuICAgICAgICBpZiAocGxhY2VzID4gMCkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDEpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDIpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG1pbkluZm9SYW5nZSA+IDEwMDApIHtcbiAgICAgICAgdmFsdWVzLnB1c2goMTAwMCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKDEwMCk7XG4gICAgICAgIHZhbHVlcy5wdXNoKDEwKTtcbiAgICAgICAgaWYgKHBsYWNlcyA+IDApIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiAxKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiAyKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMykge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG1pbkluZm9SYW5nZSA+IDEwMCkge1xuICAgICAgICB2YWx1ZXMucHVzaCgxMDApO1xuICAgICAgICB2YWx1ZXMucHVzaCgxMCk7XG4gICAgICAgIGlmIChwbGFjZXMgPiAwKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMSkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4xKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMikge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDMpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gNCkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gNSkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDAwMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobWluSW5mb1JhbmdlID4gMTApIHtcbiAgICAgICAgdmFsdWVzLnB1c2goMTApO1xuICAgICAgICBpZiAocGxhY2VzID4gMCkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDEpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDIpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiAzKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDQpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDUpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA2KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDAwMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobWluSW5mb1JhbmdlID4gMSkge1xuICAgICAgICBpZiAocGxhY2VzID4gMCkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDEpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDIpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiAzKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDQpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDUpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA2KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDAwMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobWluSW5mb1JhbmdlID4gMC4xKSB7XG4gICAgICAgIGlmIChwbGFjZXMgPiAxKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiAyKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gMykge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA0KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA1KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gNikge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDAwMDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG1pbkluZm9SYW5nZSA+IDAuMDEpIHtcbiAgICAgICAgaWYgKHBsYWNlcyA+IDIpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiAzKSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDQpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDUpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA2KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDAwMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobWluSW5mb1JhbmdlID4gMC4wMDEpIHtcbiAgICAgICAgaWYgKHBsYWNlcyA+IDMpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gNCkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gNSkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDYpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDAxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhY2VzID4gNykge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goMC4wMDAwMDAxKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChtaW5JbmZvUmFuZ2UgPiAwLjAwMDEpIHtcbiAgICAgICAgaWYgKHBsYWNlcyA+IDQpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDUpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA2KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDcpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDgpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDAwMDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG1pbkluZm9SYW5nZSA+IDAuMDAwMDEpIHtcbiAgICAgICAgaWYgKHBsYWNlcyA+IDUpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA2KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDcpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDAwMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBsYWNlcyA+IDgpIHtcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKDAuMDAwMDAwMDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGFjZXMgPiA5KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaCgwLjAwMDAwMDAwMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlcztcbn1cbmZ1bmN0aW9uIGdldEN1cnJlbnRQcmVjaXNpb25WYWx1ZSgpIHtcbiAgICBjb25zdCB7IGxheWVyIH0gPSBzbWFydE1hcHBpbmdTdGF0ZTtcbiAgICBjb25zdCByZW5kZXJlciA9IGdldFJlbmRlcmVyKGxheWVyKTtcbiAgICBsZXQgcHJlY2lzaW9uVmFsdWUgPSAxMDAwMDAwMDAwMDtcbiAgICByZW5kZXJlci5jbGFzc0JyZWFrSW5mb3MuZm9yRWFjaCgoaW5mbykgPT4ge1xuICAgICAgICBwcmVjaXNpb25WYWx1ZSA9IE1hdGgubWluKHByZWNpc2lvblZhbHVlLCBfZ2V0VmFsdWVQcmVjaXNpb24oaW5mby5taW5WYWx1ZSkpO1xuICAgICAgICBwcmVjaXNpb25WYWx1ZSA9IE1hdGgubWluKHByZWNpc2lvblZhbHVlLCBfZ2V0VmFsdWVQcmVjaXNpb24oaW5mby5tYXhWYWx1ZSkpO1xuICAgIH0pO1xuICAgIHJldHVybiBwcmVjaXNpb25WYWx1ZTtcbn1cbmZ1bmN0aW9uIF91cGRhdGVNaW5NYXgoaW5mbywgcHJlY2lzaW9uLCBwb3MsIHR5cGUpIHtcbiAgICAvLyB0eXBlOiBbXCJmaXJzdFwifFwibGFzdFwifHVuZGVmaW5lZF1cbiAgICBpZiAoaXNEZWZpbmVkKHByZWNpc2lvbikpIHtcbiAgICAgICAgLypcbiAgICAgICAgaWYgKHJlbmRlcmVyLm5vcm1hbGl6YXRpb25UeXBlID09PSBcInBlcmNlbnQtb2YtdG90YWxcIikge1xuICAgICAgICAgIGlmIChwcmVjaXNpb24gPT09IDApIHtcbiAgICBcbiAgICAgICAgICB9IGVsc2UgaWYgKHByZWNpc2lvbiA8IDEpIHtcbiAgICAgICAgICAgIC8vIHRvIHByZXZlbnQgcm91bmRpbmcgaXNzdWVzXG4gICAgICAgICAgICB2YXIgZGl2aWRlciA9IE1hdGgucm91bmQoMS9wcmVjaXNpb24pO1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwiZmlyc3RcIikge1xuICAgICAgICAgICAgICBpbmZvLm1pblZhbHVlID0gTWF0aC5mbG9vcihpbmZvLm1pblZhbHVlL3ByZWNpc2lvbikvZGl2aWRlcjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGluZm8ubWluVmFsdWUgPSBNYXRoLnJvdW5kKGluZm8ubWluVmFsdWUvcHJlY2lzaW9uKS9kaXZpZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwibGFzdFwiKSB7XG4gICAgICAgICAgICAgIGluZm8ubWF4VmFsdWUgPSBNYXRoLmNlaWwoaW5mby5tYXhWYWx1ZS9wcmVjaXNpb24pL2RpdmlkZXI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpbmZvLm1heFZhbHVlID0gTWF0aC5yb3VuZChpbmZvLm1heFZhbHVlL3ByZWNpc2lvbikvZGl2aWRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluZm8ubGFiZWwgPSAoKHBvcyA+IDApID8gXCI+IFwiIDogXCJcIikgKyBTdHJpbmcuc3Vic3RpdHV0ZSh0aGlzLmkxOG4ucGVyY2VudFZhbHVlLHtudW06IG51bWJlci5mb3JtYXQoaW5mby5taW5WYWx1ZSwge3BhdHRlcm46IHRoaXMucGF0dGVybn0pfSkgKyBcIiBcIiArIHRoaXMuaTE4bi50byArIFwiIFwiICsgc3RyaW5nLnN1YnN0aXR1dGUodGhpcy5pMThuLnBlcmNlbnRWYWx1ZSx7bnVtOiBudW1iZXIuZm9ybWF0KGluZm8ubWF4VmFsdWUsIHtwYXR0ZXJuOiB0aGlzLnBhdHRlcm59KX0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJmaXJzdFwiKSB7XG4gICAgICAgICAgICAgIGluZm8ubWluVmFsdWUgPSBNYXRoLmZsb29yKGluZm8ubWluVmFsdWUvcHJlY2lzaW9uKSpwcmVjaXNpb247XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpbmZvLm1pblZhbHVlID0gTWF0aC5yb3VuZChpbmZvLm1pblZhbHVlL3ByZWNpc2lvbikqcHJlY2lzaW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwibGFzdFwiKSB7XG4gICAgICAgICAgICAgIGluZm8ubWF4VmFsdWUgPSBNYXRoLmNlaWwoaW5mby5tYXhWYWx1ZS9wcmVjaXNpb24pKnByZWNpc2lvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGluZm8ubWF4VmFsdWUgPSBNYXRoLnJvdW5kKGluZm8ubWF4VmFsdWUvcHJlY2lzaW9uKSpwcmVjaXNpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbmZvLmxhYmVsID0gKChwb3MgPiAwKSA/IFwiPiBcIiA6IFwiXCIpICsgc3RyaW5nLnN1YnN0aXR1dGUodGhpcy5pMThuLnBlcmNlbnRWYWx1ZSx7bnVtOiBudW1iZXIuZm9ybWF0KGluZm8ubWluVmFsdWUsIHtwYXR0ZXJuOiB0aGlzLnBhdHRlcm59KX0pICsgXCIgXCIgKyB0aGlzLmkxOG4udG8gKyBcIiBcIiArIHN0cmluZy5zdWJzdGl0dXRlKHRoaXMuaTE4bi5wZXJjZW50VmFsdWUse251bTogbnVtYmVyLmZvcm1hdChpbmZvLm1heFZhbHVlLCB7cGF0dGVybjogdGhpcy5wYXR0ZXJufSl9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAqL1xuICAgICAgICBpZiAocHJlY2lzaW9uID09PSAwKSA7XG4gICAgICAgIGVsc2UgaWYgKHByZWNpc2lvbiA8IDEpIHtcbiAgICAgICAgICAgIC8vIHRvIHByZXZlbnQgcm91bmRpbmcgaXNzdWVzXG4gICAgICAgICAgICBjb25zdCBkaXZpZGVyID0gTWF0aC5yb3VuZCgxIC8gcHJlY2lzaW9uKTtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBcImZpcnN0XCIpIHtcbiAgICAgICAgICAgICAgICBpbmZvLm1pblZhbHVlID0gTWF0aC5mbG9vcihpbmZvLm1pblZhbHVlIC8gcHJlY2lzaW9uKSAvIGRpdmlkZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmZvLm1pblZhbHVlID0gTWF0aC5yb3VuZChpbmZvLm1pblZhbHVlIC8gcHJlY2lzaW9uKSAvIGRpdmlkZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJsYXN0XCIpIHtcbiAgICAgICAgICAgICAgICBpbmZvLm1heFZhbHVlID0gTWF0aC5jZWlsKGluZm8ubWF4VmFsdWUgLyBwcmVjaXNpb24pIC8gZGl2aWRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZm8ubWF4VmFsdWUgPSBNYXRoLnJvdW5kKGluZm8ubWF4VmFsdWUgLyBwcmVjaXNpb24pIC8gZGl2aWRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluZm8ubGFiZWwgPSBgJHtwb3MgPiAwID8gXCI+IFwiIDogXCJcIn0ke2luZm8ubWluVmFsdWUudG9Mb2NhbGVTdHJpbmcoc21hcnRNYXBwaW5nU3RhdGUuZnVsbExvY2FsZSwge1xuICAgICAgICAgICAgICAgIG1heGltdW1TaWduaWZpY2FudERpZ2l0czogMTVcbiAgICAgICAgICAgIH0pfSAtICR7aW5mby5tYXhWYWx1ZS50b0xvY2FsZVN0cmluZyhzbWFydE1hcHBpbmdTdGF0ZS5mdWxsTG9jYWxlLCB7XG4gICAgICAgICAgICAgICAgbWF4aW11bVNpZ25pZmljYW50RGlnaXRzOiAxNVxuICAgICAgICAgICAgfSl9YDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBcImZpcnN0XCIpIHtcbiAgICAgICAgICAgICAgICBpbmZvLm1pblZhbHVlID0gTWF0aC5mbG9vcihpbmZvLm1pblZhbHVlIC8gcHJlY2lzaW9uKSAqIHByZWNpc2lvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZm8ubWluVmFsdWUgPSBNYXRoLnJvdW5kKGluZm8ubWluVmFsdWUgLyBwcmVjaXNpb24pICogcHJlY2lzaW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwibGFzdFwiKSB7XG4gICAgICAgICAgICAgICAgaW5mby5tYXhWYWx1ZSA9IE1hdGguY2VpbChpbmZvLm1heFZhbHVlIC8gcHJlY2lzaW9uKSAqIHByZWNpc2lvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZm8ubWF4VmFsdWUgPSBNYXRoLnJvdW5kKGluZm8ubWF4VmFsdWUgLyBwcmVjaXNpb24pICogcHJlY2lzaW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5mby5sYWJlbCA9IChwb3MgPiAwID8gXCI+IFwiIDogXCJcIikgKyBpbmZvLm1pblZhbHVlLnRvTG9jYWxlU3RyaW5nKCkgKyBcIiAtIFwiICsgaW5mby5tYXhWYWx1ZS50b0xvY2FsZVN0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIC8vfVxuICAgIH1cbiAgICByZXR1cm4gaW5mbztcbn1cbi8qXG5mdW5jdGlvbiBkaXNhYmxlT3B0aW9uc0JlbG93KHNlbGVjdCwgdmFsKSB7XG5cbiAgYXJyYXkuZm9yRWFjaChzZWxlY3Qub3B0aW9ucywgZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgdmFyIGl0ZW0gPSBvcHRpb24uaXRlbTtcbiAgICBpZiAoaXRlbS50eXBlWzBdICE9PSBcInNlbGVjdFwiICYmIHBhcnNlRmxvYXQoaXRlbS5uYW1lWzBdKSA8IHZhbCkge1xuICAgICAgb3B0aW9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuICBzZWxlY3Quc3RhcnR1cCgpO1xufVxuXG5mdW5jdGlvbiBlbmFibGVBbGxPcHRpb25zKHNlbGVjdCkge1xuXG4gIGFycmF5LmZvckVhY2goc2VsZWN0Lm9wdGlvbnMsIGZ1bmN0aW9uKG9wdGlvbikge1xuICAgIGRlbGV0ZSBvcHRpb24uZGlzYWJsZWQ7XG4gIH0pO1xuICBzZWxlY3Quc3RhcnR1cCgpO1xufSxcbiovXG5mdW5jdGlvbiBfZ2V0RGVjaW1hbFByZWNpc2lvbih2YWx1ZSkge1xuICAgIGxldCBlID0gMTtcbiAgICB3aGlsZSAoTWF0aC5yb3VuZCh2YWx1ZSAqIGUpIC8gZSAhPT0gdmFsdWUpXG4gICAgICAgIGUgKj0gMTA7XG4gICAgcmV0dXJuIE1hdGgubG9nKGUpIC8gTWF0aC5MTjEwO1xufVxuZnVuY3Rpb24gX2dldFZhbHVlUHJlY2lzaW9uKHZhbHVlKSB7XG4gICAgbGV0IHByZWNpc2lvbiA9IDAuMDAwMDAwMDE7XG4gICAgd2hpbGUgKF9maXhOdW1iZXIoTWF0aC5yb3VuZCh2YWx1ZSAvIHByZWNpc2lvbikgKiBwcmVjaXNpb24pID09PSB2YWx1ZSkge1xuICAgICAgICBwcmVjaXNpb24gKj0gMTA7XG4gICAgfVxuICAgIHJldHVybiBwcmVjaXNpb24gLyAxMDtcbn1cbmZ1bmN0aW9uIF9maXhOdW1iZXIobnVtYmVyKSB7XG4gICAgLy8gMC4wMDAwOTk5OTk5OTk5OTk5OTk5OSAtPiAwLjAwMDFcbiAgICAvLyAzLjQwMDAwMDAwMDAwMDAwMDQgLT4gMy40XG4gICAgcmV0dXJuIHBhcnNlRmxvYXQobnVtYmVyLnRvUHJlY2lzaW9uKDEyKSk7XG59XG5mdW5jdGlvbiBnZXRTdG9wUHJlY2lzaW9uKHN0b3BzKSB7XG4gICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nLCBfaDtcbiAgICBsZXQgcHJlY2lzaW9uID0gMDtcbiAgICBzdG9wcy5mb3JFYWNoKChpbmZvKSA9PiB7XG4gICAgICAgIGlmIChpc0RlZmluZWQoaW5mby52YWx1ZSkpIHtcbiAgICAgICAgICAgIHByZWNpc2lvbiA9IE1hdGgubWF4KF9nZXREZWNpbWFsUHJlY2lzaW9uKF9maXhOdW1iZXIoaW5mby52YWx1ZSkpLCBwcmVjaXNpb24pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGlzRGVmaW5lZChpbmZvLm1pblZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHByZWNpc2lvbiA9IE1hdGgubWF4KF9nZXREZWNpbWFsUHJlY2lzaW9uKF9maXhOdW1iZXIoaW5mby5taW5WYWx1ZSkpLCBwcmVjaXNpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzRGVmaW5lZChpbmZvLm1heFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHByZWNpc2lvbiA9IE1hdGgubWF4KF9nZXREZWNpbWFsUHJlY2lzaW9uKF9maXhOdW1iZXIoaW5mby5tYXhWYWx1ZSkpLCBwcmVjaXNpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzRGVmaW5lZChpbmZvLm1pbikpIHtcbiAgICAgICAgICAgICAgICBwcmVjaXNpb24gPSBNYXRoLm1heChfZ2V0RGVjaW1hbFByZWNpc2lvbihfZml4TnVtYmVyKGluZm8ubWluKSksIHByZWNpc2lvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNEZWZpbmVkKGluZm8ubWF4KSkge1xuICAgICAgICAgICAgICAgIHByZWNpc2lvbiA9IE1hdGgubWF4KF9nZXREZWNpbWFsUHJlY2lzaW9uKF9maXhOdW1iZXIoaW5mby5tYXgpKSwgcHJlY2lzaW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8vIG5ldmVyIHNob3cgbW9yZSB0aGFuIDMgZGVjaW1hbHMgb24gc2xpZGVyLCB1bmxlc3MgPHNlZSBiZWxvdz5cbiAgICBwcmVjaXNpb24gPSBNYXRoLm1pbihwcmVjaXNpb24sIDMpO1xuICAgIC8vIG1ha2Ugc3VyZSBwcmVjaXNpb24gZml0cyB0byByYW5nZSBvZiB2YWx1ZXNcbiAgICBjb25zdCBmaXJzdCA9IHN0b3BzWzBdO1xuICAgIGNvbnN0IGxhc3QgPSBzdG9wc1tzdG9wcy5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBtaW4gPSBNYXRoLm1pbigoX2IgPSAoX2EgPSBmaXJzdC5taW5WYWx1ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogZmlyc3QubWluKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBmaXJzdC52YWx1ZSwgKF9kID0gKF9jID0gbGFzdC5taW5WYWx1ZSkgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogbGFzdC5taW4pICE9PSBudWxsICYmIF9kICE9PSB2b2lkIDAgPyBfZCA6IGxhc3QudmFsdWUpO1xuICAgIGNvbnN0IG1heCA9IE1hdGgubWF4KChfZiA9IChfZSA9IGZpcnN0Lm1heFZhbHVlKSAhPT0gbnVsbCAmJiBfZSAhPT0gdm9pZCAwID8gX2UgOiBmaXJzdC5tYXgpICE9PSBudWxsICYmIF9mICE9PSB2b2lkIDAgPyBfZiA6IGZpcnN0LnZhbHVlLCAoX2ggPSAoX2cgPSBsYXN0Lm1heFZhbHVlKSAhPT0gbnVsbCAmJiBfZyAhPT0gdm9pZCAwID8gX2cgOiBsYXN0Lm1heCkgIT09IG51bGwgJiYgX2ggIT09IHZvaWQgMCA/IF9oIDogbGFzdC52YWx1ZSk7XG4gICAgY29uc3QgcmFuZ2UgPSBtYXggLSBtaW47XG4gICAgaWYgKHJhbmdlIC8gc3RvcHMubGVuZ3RoIDwgMC4wMDAwMDAyKSB7XG4gICAgICAgIHByZWNpc2lvbiA9IDg7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJhbmdlIC8gc3RvcHMubGVuZ3RoIDwgMC4wMDAwMDIpIHtcbiAgICAgICAgcHJlY2lzaW9uID0gNztcbiAgICB9XG4gICAgZWxzZSBpZiAocmFuZ2UgLyBzdG9wcy5sZW5ndGggPCAwLjAwMDAyKSB7XG4gICAgICAgIHByZWNpc2lvbiA9IDY7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJhbmdlIC8gc3RvcHMubGVuZ3RoIDwgMC4wMDAyKSB7XG4gICAgICAgIHByZWNpc2lvbiA9IDU7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJhbmdlIC8gc3RvcHMubGVuZ3RoIDwgMC4wMDIpIHtcbiAgICAgICAgcHJlY2lzaW9uID0gNDtcbiAgICB9XG4gICAgZWxzZSBpZiAocmFuZ2UgLyBzdG9wcy5sZW5ndGggPCAwLjAyKSB7XG4gICAgICAgIHByZWNpc2lvbiA9IDM7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJhbmdlIC8gc3RvcHMubGVuZ3RoIDwgMC4yKSB7XG4gICAgICAgIHByZWNpc2lvbiA9IE1hdGgubWF4KHByZWNpc2lvbiwgMik7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJhbmdlIC8gc3RvcHMubGVuZ3RoIDwgMikge1xuICAgICAgICBwcmVjaXNpb24gPSBNYXRoLm1heChwcmVjaXNpb24sIDEpO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5yb3VuZChwcmVjaXNpb24pO1xufVxuXG5leHBvcnQgeyBnZXRDdXJyZW50UHJlY2lzaW9uVmFsdWUgYXMgYSwgYnVpbGRQcmVjaXNpb25zTGlzdCBhcyBiLCBnZXRTdG9wUHJlY2lzaW9uIGFzIGcsIHVwZGF0ZVZhbHVlc1dpdGhQcmVjaXNpb24gYXMgdSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcmVjaXNpb24tMDZhNzM2NzIuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9