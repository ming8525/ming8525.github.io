"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-c3d16a"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-simple-matrix.entry.js":
/*!***********************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-simple-matrix.entry.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   rfx_simple_matrix: () => (/* binding */ RfxSimpleMatrix)
/* harmony export */ });
/* harmony import */ var _index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-da1b7138.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/index-da1b7138.js");
/* harmony import */ var _arcgis_core_core_lang_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @arcgis/core/core/lang.js */ "@arcgis/core/core/lang.js");
/* harmony import */ var _type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./type-gaurds-1840747f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/type-gaurds-1840747f.js");
/* harmony import */ var _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./interfaces-d0c68944.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/interfaces-d0c68944.js");
/* harmony import */ var _arcgis_core_identity_IdentityManager_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @arcgis/core/identity/IdentityManager.js */ "@arcgis/core/identity/IdentityManager.js");
/* harmony import */ var _arcgis_core_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @arcgis/core/core/urlUtils.js */ "@arcgis/core/core/urlUtils.js");
/* harmony import */ var _arcgis_core_layers_Layer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @arcgis/core/layers/Layer.js */ "@arcgis/core/layers/Layer.js");
/* harmony import */ var _arcgis_core_layers_ImageryLayer_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @arcgis/core/layers/ImageryLayer.js */ "@arcgis/core/layers/ImageryLayer.js");
/* harmony import */ var _arcgis_core_smartMapping_raster_renderers_stretch_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @arcgis/core/smartMapping/raster/renderers/stretch.js */ "@arcgis/core/smartMapping/raster/renderers/stretch.js");
/* harmony import */ var _arcgis_core_request_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @arcgis/core/request.js */ "@arcgis/core/request.js");
/* harmony import */ var _arcgis_core_rest_support_AlgorithmicColorRamp_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @arcgis/core/rest/support/AlgorithmicColorRamp.js */ "@arcgis/core/rest/support/AlgorithmicColorRamp.js");
/* harmony import */ var _arcgis_core_rest_support_MultipartColorRamp_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @arcgis/core/rest/support/MultipartColorRamp.js */ "@arcgis/core/rest/support/MultipartColorRamp.js");
/* harmony import */ var _arcgis_core_Color_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @arcgis/core/Color.js */ "@arcgis/core/Color.js");
/* harmony import */ var _colorRampUtils_8bdd46c5_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./colorRampUtils-8bdd46c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/colorRampUtils-8bdd46c5.js");
/* harmony import */ var _arcgis_core_rest_geoprocessor_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @arcgis/core/rest/geoprocessor.js */ "@arcgis/core/rest/geoprocessor.js");
/* harmony import */ var _arcgis_core_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @arcgis/core/portal/PortalItem.js */ "@arcgis/core/portal/PortalItem.js");
/* harmony import */ var _sanitize_number_d84114f7_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./sanitize-number-d84114f7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/sanitize-number-d84114f7.js");
/* harmony import */ var _multidimensional_helper_fc8fbe0e_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./multidimensional-helper-fc8fbe0e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/multidimensional-helper-fc8fbe0e.js");
/* harmony import */ var _getTag_96af029d_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./_getTag-96af029d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/_getTag-96af029d.js");
/* harmony import */ var _localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./localization-helper-4819b67d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/localization-helper-4819b67d.js");
/* harmony import */ var _Uint8Array_68e1e3f9_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./_Uint8Array-68e1e3f9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/_Uint8Array-68e1e3f9.js");






















/**
 * Creates a matrix schema for the grid layout.
 * @param {number} columns - The number of columns in the matrix.
 * @param {GridColumnType} dataType - The data type of the matrix cells.
 * @returns {Object} The matrix schema for the grid layout.
 */
const createMatrixSchema = ({ columns, dataType, style }) => {
    const gridLayout = {};
    for (let i = 1; i <= columns; i++) {
        gridLayout[i.toString()] = {
            label: i.toString(),
            uiType: dataType,
            style
        };
    }
    return gridLayout;
};
/**
 * Private function
 * Creates an array with specified size and default value.
 * @param {number} size - The size of the array.
 * @param {number} defaultValue - The default value for the array elements.
 * @returns {number[]} The created array.
 */
function createArrayOfSize(size, defaultValue) {
    return Array.from({ length: size }, () => defaultValue);
}
/**
 * Private function
 * Generates an updated value array based on the specified rows and columns.
 * @param {number} rows - The number of rows.
 * @param {number} columns - The number of columns.
 * @param {any[]} value - The existing value array.
 * @returns {any[]} The updated value array.
 */
function generateUpdatedValue(rows, columns, value) {
    const gridSize = rows * columns;
    if (!value) {
        return createArrayOfSize(gridSize, 0);
    }
    if (value.length < gridSize) {
        const additionalCount = Math.abs(gridSize - value.length);
        const addOn = createArrayOfSize(additionalCount, 0);
        return value.concat(addOn);
    }
    if (value.length > gridSize) {
        const additionalCount = Math.abs(gridSize - value.length);
        const toPreserve = value.length - additionalCount;
        return value.slice(0, toPreserve);
    }
    // case value.length === gridSize
    return value;
}
/**
 * Creates a matrix object from an array of values.
 * @param {number} rows - The number of rows.
 * @param {number} columns - The number of columns.
 * @param {any[]} value - The array of value.
 * @returns {object[]} The array of matrix objects.
 */
const createMatrixDataObject = ({ columns, rows, value }) => {
    const matrix = [];
    const updatedValue = generateUpdatedValue(rows, columns, value);
    let idCounter = 0;
    while (updatedValue.length > 0) {
        const groupedValues = updatedValue.splice(0, columns);
        const dataObject = {
            id: idCounter
        };
        idCounter += 1;
        groupedValues.forEach((val, index) => {
            dataObject[index + 1] = val;
        });
        matrix.push(dataObject);
    }
    return matrix;
};
/**
 * Parses matrix data and flattens the values of each key (excluding "id") into a single array.
 * @param {Object[]} data - The array of objects containing matrix data.
 * @returns {any[]} The flattened array of values from the matrix data.
 */
const parseMatrixData = (data) => {
    const result = [];
    data.forEach((obj) => {
        Object.keys(obj).forEach((key) => {
            if (key !== "id") {
                result.push((0,_sanitize_number_d84114f7_js__WEBPACK_IMPORTED_MODULE_16__.p)(obj[key].toString()));
            }
        });
    });
    return result;
};

const component = "rfx-simple-matrix";
const HTMLClasses = {
    gridContainer: `${component}__grid-container`,
    gridColumn: `${component}__grid-column`
};

const rfxSimpleMatrixCss = ":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh}.rfx-simple-matrix__grid-container{display:flex;flex-direction:column;width:100%;max-width:100%;overflow:auto;max-height:var(--rfx-widget-content-height)}.rfx-simple-matrix__grid-column{min-width:3rem}";

const RfxSimpleMatrix = class {
    constructor(hostRef) {
        (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        this.rfxArgumentChange = (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "rfxArgumentChange", 7);
        this.updateGridValue = (event) => {
            const { detail: { gridOptions } } = event;
            if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_2__.i)(gridOptions)) {
                return;
            }
            this.gridSchema = {
                ...this.gridSchema,
                gridOptions
            };
            this.setWidgetValue();
        };
        this.gridSchema = {
            gridLayout: {},
            gridOptions: [],
            hasBorder: true,
            hasHeader: true,
            canAdd: false,
            hasIdColumn: false,
            canRemove: false,
            isStacked: false
        };
        this.columns = undefined;
        this.rows = undefined;
        this.value = undefined;
    }
    //--------------------------------------------------------------------------
    //
    //  Lifecycle
    //
    //--------------------------------------------------------------------------
    componentWillRender() {
        this.initGrid();
        this.setWidgetValue();
    }
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    initGrid() {
        const gridLayout = createMatrixSchema({
            columns: this.columns,
            dataType: _interfaces_d0c68944_js__WEBPACK_IMPORTED_MODULE_3__.G.number,
            style: HTMLClasses.gridColumn
        });
        // set when data is persisted & whenever factor function type is changed
        const gridOptions = createMatrixDataObject({
            columns: this.columns,
            rows: this.rows,
            value: (0,_multidimensional_helper_fc8fbe0e_js__WEBPACK_IMPORTED_MODULE_17__.c)(this.value)
        });
        this.gridSchema = {
            ...this.gridSchema,
            gridLayout,
            gridOptions
        };
    }
    setWidgetValue() {
        const matrixData = parseMatrixData(this.gridSchema?.gridOptions);
        this.value = matrixData;
        this.rfxArgumentChange.emit({ value: this.value });
    }
    render() {
        return ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-grid", { ref: (e) => {
                this.widgetContainer = e;
            }, class: HTMLClasses.gridContainer, hasHeader: this.gridSchema.hasHeader, canAdd: this.gridSchema.canAdd, hasIdColumn: this.gridSchema.hasIdColumn, gridLayout: this.gridSchema.gridLayout, gridOptions: this.gridSchema.gridOptions, hasBorder: this.gridSchema.hasBorder, canRemove: this.gridSchema.canRemove, isStacked: this.gridSchema.isStacked, onRfxGridOptionChange: this.updateGridValue }));
    }
    get hostElement() { return (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.a)(this); }
};
RfxSimpleMatrix.style = rfxSimpleMatrixCss;



//# sourceMappingURL=rfx-simple-matrix.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/sanitize-number-d84114f7.js":
/*!************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/sanitize-number-d84114f7.js ***!
  \************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ formatNumberToLocale),
/* harmony export */   f: () => (/* binding */ formatNumber),
/* harmony export */   i: () => (/* binding */ isValidNumber),
/* harmony export */   p: () => (/* binding */ parseNumber),
/* harmony export */   s: () => (/* binding */ sanitizeNumber)
/* harmony export */ });
/* harmony import */ var _localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./localization-helper-4819b67d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/localization-helper-4819b67d.js");
/* harmony import */ var _type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./type-gaurds-1840747f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/type-gaurds-1840747f.js");



/**
 * Indicates if a provided number value is valid.
 * An invalid value is: undefined | NaN | Infinite | -Infinite | null
 * See for more details:
 *   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isFinite
 *   - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isNaN
 * @param {number | undefined | null} value value to check
 * @returns {boolean} if valid or not
 */
function isValidNumber(value) {
    return value !== undefined && value !== null && Number.isNaN(value) === false && Number.isFinite(value) === true;
}
/**
 * Returns a string representation of the provided number for use with calcite-input. It also
 * guards against invalid types following this logic:
 *   - If the value is valid (not NaN, finite), the value is returned as a string
 *   - If not and if a valid default value is provided, the default value is returned as a string
 *   - If not, an empty string is returned
 * @param value
 * @param defaultValue
 * @returns a sanitized string
 */
function sanitizeNumber(value, defaultValue) {
    let returnedValue;
    if (value !== null) {
        const testedValue = typeof value === "string" ? Number.parseFloat(value) : value;
        if (isValidNumber(testedValue))
            returnedValue = testedValue;
        else if (isValidNumber(defaultValue))
            returnedValue = defaultValue;
    }
    return returnedValue === undefined ? "" : `${returnedValue}`;
}
/**
 * Parses a value string to a number for use with calcite-input. If the string is empty, it will return undefined.
 * If the string is otherwise invalid, it will return NaN.
 * @param value calcite-input value
 * @returns {number | undefined} the parsed number
 */
function parseNumber(value) {
    if (value === "")
        return undefined;
    return Number.parseFloat(value);
}
/**
 * Formats a number to a specified number of decimal places.
 *
 * @param {number} value - The number to format.
 * @param {number} [fractionDigits=3] - The number of decimal places to include in the formatted number. Defaults to 3.
 * @returns {number|undefined} - The formatted number, or undefined if the input value is empty.
 */
function formatNumber(value, fractionDigits = 3) {
    if ((0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_1__.i)(value))
        return undefined;
    return Number.parseFloat(value.toFixed(fractionDigits));
}
/**
 * Formats a number or string representing a number according to the locale, passing Intl number format options
 * https://developer.mozilla.org/en-US/docs/Web/JavaScript/ReferenceGlobal_Objects/Intl/NumberFormat/NumberFormat#options
 * @param {number | string | undefined} value to be formatted and localized
 * @param {Intl.NumberFormatOptions} formatOptions options object matching Intl.NumberFormat
 * @returns {string} localized / rounded string
 */
function formatNumberToLocale(value, formatOptions) {
    let formattedValue = "";
    if (!(0,_type_gaurds_1840747f_js__WEBPACK_IMPORTED_MODULE_1__.i)(value) && !Number.isNaN(value)) {
        const localeCode = (0,_localization_helper_4819b67d_js__WEBPACK_IMPORTED_MODULE_0__.g)().locale;
        formattedValue = Intl.NumberFormat(localeCode, formatOptions).format(Number(value));
    }
    return formattedValue;
}



//# sourceMappingURL=sanitize-number-d84114f7.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3JfLWMzZDE2YS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWtHO0FBQy9EO0FBQzhCO0FBQ047QUFDVDtBQUNYO0FBQ0Q7QUFDTztBQUNrQjtBQUM5QjtBQUMwQjtBQUNGO0FBQzFCO0FBQ087QUFDSztBQUNBO0FBQ3NCO0FBQ007QUFDeEM7QUFDWTtBQUNSOztBQUVuQztBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsZ0JBQWdCO0FBQzNCLGFBQWEsUUFBUTtBQUNyQjtBQUNBLDhCQUE4QiwwQkFBMEI7QUFDeEQ7QUFDQSxvQkFBb0IsY0FBYztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixhQUFhLFVBQVU7QUFDdkI7QUFDQTtBQUNBLHdCQUF3QixjQUFjO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsVUFBVTtBQUN2QjtBQUNBLGtDQUFrQyxzQkFBc0I7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFVBQVU7QUFDckIsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnRUFBVztBQUN2QztBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0JBQXNCLFVBQVU7QUFDaEMsbUJBQW1CLFVBQVU7QUFDN0I7O0FBRUEsa0NBQWtDLDhCQUE4QixvQ0FBb0Msb0NBQW9DLG9DQUFvQyx1Q0FBdUMsdUNBQXVDLHNDQUFzQyw0Q0FBNEMsNENBQTRDLG1DQUFtQyxxQ0FBcUMscUNBQXFDLHFDQUFxQywrQkFBK0IsK0JBQStCLCtCQUErQixxQ0FBcUMsa0NBQWtDLGlDQUFpQyxpQ0FBaUMsaUNBQWlDLHFDQUFxQyw4QkFBOEIsMEJBQTBCLG9DQUFvQyx3QkFBd0IsbUNBQW1DLG9EQUFvRCxzQ0FBc0Msc0NBQXNDLGtDQUFrQyxpQ0FBaUMsbUNBQW1DLGFBQWEsc0JBQXNCLFdBQVcsZUFBZSxjQUFjLDRDQUE0QyxnQ0FBZ0MsZUFBZTs7QUFFejFDO0FBQ0E7QUFDQSxRQUFRLHFEQUFnQjtBQUN4QixpQ0FBaUMscURBQVc7QUFDNUM7QUFDQSxvQkFBb0IsVUFBVSxnQkFBZ0I7QUFDOUMsZ0JBQWdCLDJEQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHNEQUFVO0FBQ2hDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHdFQUFTO0FBQzVCLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsbUJBQW1CO0FBQ3pEO0FBQ0E7QUFDQSxnQkFBZ0IscURBQUMsZUFBZTtBQUNoQztBQUNBLGFBQWEscVlBQXFZO0FBQ2xaO0FBQ0Esd0JBQXdCLE9BQU8scURBQVU7QUFDekM7QUFDQTs7QUFFZ0Q7O0FBRWhEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3pNdUU7QUFDTjs7QUFFakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywyQkFBMkI7QUFDdEMsYUFBYSxTQUFTO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsY0FBYztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsUUFBUTtBQUNuQixhQUFhLGtCQUFrQjtBQUMvQjtBQUNBO0FBQ0EsUUFBUSwyREFBZTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDZCQUE2QjtBQUN4QyxXQUFXLDBCQUEwQjtBQUNyQyxhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0EsU0FBUywyREFBZTtBQUN4QiwyQkFBMkIsbUVBQWE7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7O0FBRW1IOztBQUVuSCIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FyY2dpcy1yYXN0ZXItZnVuY3Rpb24tZWRpdG9yL2Rpc3QvZXNtL3JmeC1zaW1wbGUtbWF0cml4LmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FyY2dpcy1yYXN0ZXItZnVuY3Rpb24tZWRpdG9yL2Rpc3QvZXNtL3Nhbml0aXplLW51bWJlci1kODQxMTRmNy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIGEgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtZGExYjcxMzguanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvY29yZS9sYW5nLmpzJztcbmltcG9ydCB7IGkgYXMgaXNFbXB0eURhdGFJdGVtIH0gZnJvbSAnLi90eXBlLWdhdXJkcy0xODQwNzQ3Zi5qcyc7XG5pbXBvcnQgeyBHIGFzIEdyaWRDb2x1bW4gfSBmcm9tICcuL2ludGVyZmFjZXMtZDBjNjg5NDQuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvaWRlbnRpdHkvSWRlbnRpdHlNYW5hZ2VyLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2NvcmUvdXJsVXRpbHMuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvbGF5ZXJzL0xheWVyLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2xheWVycy9JbWFnZXJ5TGF5ZXIuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvc21hcnRNYXBwaW5nL3Jhc3Rlci9yZW5kZXJlcnMvc3RyZXRjaC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXF1ZXN0LmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL3Jlc3Qvc3VwcG9ydC9BbGdvcml0aG1pY0NvbG9yUmFtcC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXN0L3N1cHBvcnQvTXVsdGlwYXJ0Q29sb3JSYW1wLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL0NvbG9yLmpzJztcbmltcG9ydCAnLi9jb2xvclJhbXBVdGlscy04YmRkNDZjNS5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXN0L2dlb3Byb2Nlc3Nvci5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9wb3J0YWwvUG9ydGFsSXRlbS5qcyc7XG5pbXBvcnQgeyBwIGFzIHBhcnNlTnVtYmVyIH0gZnJvbSAnLi9zYW5pdGl6ZS1udW1iZXItZDg0MTE0ZjcuanMnO1xuaW1wb3J0IHsgYyBhcyBjbG9uZURhdGEgfSBmcm9tICcuL211bHRpZGltZW5zaW9uYWwtaGVscGVyLWZjOGZiZTBlLmpzJztcbmltcG9ydCAnLi9fZ2V0VGFnLTk2YWYwMjlkLmpzJztcbmltcG9ydCAnLi9sb2NhbGl6YXRpb24taGVscGVyLTQ4MTliNjdkLmpzJztcbmltcG9ydCAnLi9fVWludDhBcnJheS02OGUxZTNmOS5qcyc7XG5cbi8qKlxuICogQ3JlYXRlcyBhIG1hdHJpeCBzY2hlbWEgZm9yIHRoZSBncmlkIGxheW91dC5cbiAqIEBwYXJhbSB7bnVtYmVyfSBjb2x1bW5zIC0gVGhlIG51bWJlciBvZiBjb2x1bW5zIGluIHRoZSBtYXRyaXguXG4gKiBAcGFyYW0ge0dyaWRDb2x1bW5UeXBlfSBkYXRhVHlwZSAtIFRoZSBkYXRhIHR5cGUgb2YgdGhlIG1hdHJpeCBjZWxscy5cbiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBtYXRyaXggc2NoZW1hIGZvciB0aGUgZ3JpZCBsYXlvdXQuXG4gKi9cbmNvbnN0IGNyZWF0ZU1hdHJpeFNjaGVtYSA9ICh7IGNvbHVtbnMsIGRhdGFUeXBlLCBzdHlsZSB9KSA9PiB7XG4gICAgY29uc3QgZ3JpZExheW91dCA9IHt9O1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGNvbHVtbnM7IGkrKykge1xuICAgICAgICBncmlkTGF5b3V0W2kudG9TdHJpbmcoKV0gPSB7XG4gICAgICAgICAgICBsYWJlbDogaS50b1N0cmluZygpLFxuICAgICAgICAgICAgdWlUeXBlOiBkYXRhVHlwZSxcbiAgICAgICAgICAgIHN0eWxlXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBncmlkTGF5b3V0O1xufTtcbi8qKlxuICogUHJpdmF0ZSBmdW5jdGlvblxuICogQ3JlYXRlcyBhbiBhcnJheSB3aXRoIHNwZWNpZmllZCBzaXplIGFuZCBkZWZhdWx0IHZhbHVlLlxuICogQHBhcmFtIHtudW1iZXJ9IHNpemUgLSBUaGUgc2l6ZSBvZiB0aGUgYXJyYXkuXG4gKiBAcGFyYW0ge251bWJlcn0gZGVmYXVsdFZhbHVlIC0gVGhlIGRlZmF1bHQgdmFsdWUgZm9yIHRoZSBhcnJheSBlbGVtZW50cy5cbiAqIEByZXR1cm5zIHtudW1iZXJbXX0gVGhlIGNyZWF0ZWQgYXJyYXkuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUFycmF5T2ZTaXplKHNpemUsIGRlZmF1bHRWYWx1ZSkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoOiBzaXplIH0sICgpID0+IGRlZmF1bHRWYWx1ZSk7XG59XG4vKipcbiAqIFByaXZhdGUgZnVuY3Rpb25cbiAqIEdlbmVyYXRlcyBhbiB1cGRhdGVkIHZhbHVlIGFycmF5IGJhc2VkIG9uIHRoZSBzcGVjaWZpZWQgcm93cyBhbmQgY29sdW1ucy5cbiAqIEBwYXJhbSB7bnVtYmVyfSByb3dzIC0gVGhlIG51bWJlciBvZiByb3dzLlxuICogQHBhcmFtIHtudW1iZXJ9IGNvbHVtbnMgLSBUaGUgbnVtYmVyIG9mIGNvbHVtbnMuXG4gKiBAcGFyYW0ge2FueVtdfSB2YWx1ZSAtIFRoZSBleGlzdGluZyB2YWx1ZSBhcnJheS5cbiAqIEByZXR1cm5zIHthbnlbXX0gVGhlIHVwZGF0ZWQgdmFsdWUgYXJyYXkuXG4gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlVXBkYXRlZFZhbHVlKHJvd3MsIGNvbHVtbnMsIHZhbHVlKSB7XG4gICAgY29uc3QgZ3JpZFNpemUgPSByb3dzICogY29sdW1ucztcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVBcnJheU9mU2l6ZShncmlkU2l6ZSwgMCk7XG4gICAgfVxuICAgIGlmICh2YWx1ZS5sZW5ndGggPCBncmlkU2l6ZSkge1xuICAgICAgICBjb25zdCBhZGRpdGlvbmFsQ291bnQgPSBNYXRoLmFicyhncmlkU2l6ZSAtIHZhbHVlLmxlbmd0aCk7XG4gICAgICAgIGNvbnN0IGFkZE9uID0gY3JlYXRlQXJyYXlPZlNpemUoYWRkaXRpb25hbENvdW50LCAwKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmNvbmNhdChhZGRPbik7XG4gICAgfVxuICAgIGlmICh2YWx1ZS5sZW5ndGggPiBncmlkU2l6ZSkge1xuICAgICAgICBjb25zdCBhZGRpdGlvbmFsQ291bnQgPSBNYXRoLmFicyhncmlkU2l6ZSAtIHZhbHVlLmxlbmd0aCk7XG4gICAgICAgIGNvbnN0IHRvUHJlc2VydmUgPSB2YWx1ZS5sZW5ndGggLSBhZGRpdGlvbmFsQ291bnQ7XG4gICAgICAgIHJldHVybiB2YWx1ZS5zbGljZSgwLCB0b1ByZXNlcnZlKTtcbiAgICB9XG4gICAgLy8gY2FzZSB2YWx1ZS5sZW5ndGggPT09IGdyaWRTaXplXG4gICAgcmV0dXJuIHZhbHVlO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgbWF0cml4IG9iamVjdCBmcm9tIGFuIGFycmF5IG9mIHZhbHVlcy5cbiAqIEBwYXJhbSB7bnVtYmVyfSByb3dzIC0gVGhlIG51bWJlciBvZiByb3dzLlxuICogQHBhcmFtIHtudW1iZXJ9IGNvbHVtbnMgLSBUaGUgbnVtYmVyIG9mIGNvbHVtbnMuXG4gKiBAcGFyYW0ge2FueVtdfSB2YWx1ZSAtIFRoZSBhcnJheSBvZiB2YWx1ZS5cbiAqIEByZXR1cm5zIHtvYmplY3RbXX0gVGhlIGFycmF5IG9mIG1hdHJpeCBvYmplY3RzLlxuICovXG5jb25zdCBjcmVhdGVNYXRyaXhEYXRhT2JqZWN0ID0gKHsgY29sdW1ucywgcm93cywgdmFsdWUgfSkgPT4ge1xuICAgIGNvbnN0IG1hdHJpeCA9IFtdO1xuICAgIGNvbnN0IHVwZGF0ZWRWYWx1ZSA9IGdlbmVyYXRlVXBkYXRlZFZhbHVlKHJvd3MsIGNvbHVtbnMsIHZhbHVlKTtcbiAgICBsZXQgaWRDb3VudGVyID0gMDtcbiAgICB3aGlsZSAodXBkYXRlZFZhbHVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgZ3JvdXBlZFZhbHVlcyA9IHVwZGF0ZWRWYWx1ZS5zcGxpY2UoMCwgY29sdW1ucyk7XG4gICAgICAgIGNvbnN0IGRhdGFPYmplY3QgPSB7XG4gICAgICAgICAgICBpZDogaWRDb3VudGVyXG4gICAgICAgIH07XG4gICAgICAgIGlkQ291bnRlciArPSAxO1xuICAgICAgICBncm91cGVkVmFsdWVzLmZvckVhY2goKHZhbCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGRhdGFPYmplY3RbaW5kZXggKyAxXSA9IHZhbDtcbiAgICAgICAgfSk7XG4gICAgICAgIG1hdHJpeC5wdXNoKGRhdGFPYmplY3QpO1xuICAgIH1cbiAgICByZXR1cm4gbWF0cml4O1xufTtcbi8qKlxuICogUGFyc2VzIG1hdHJpeCBkYXRhIGFuZCBmbGF0dGVucyB0aGUgdmFsdWVzIG9mIGVhY2gga2V5IChleGNsdWRpbmcgXCJpZFwiKSBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICogQHBhcmFtIHtPYmplY3RbXX0gZGF0YSAtIFRoZSBhcnJheSBvZiBvYmplY3RzIGNvbnRhaW5pbmcgbWF0cml4IGRhdGEuXG4gKiBAcmV0dXJucyB7YW55W119IFRoZSBmbGF0dGVuZWQgYXJyYXkgb2YgdmFsdWVzIGZyb20gdGhlIG1hdHJpeCBkYXRhLlxuICovXG5jb25zdCBwYXJzZU1hdHJpeERhdGEgPSAoZGF0YSkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuICAgIGRhdGEuZm9yRWFjaCgob2JqKSA9PiB7XG4gICAgICAgIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBpZiAoa2V5ICE9PSBcImlkXCIpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChwYXJzZU51bWJlcihvYmpba2V5XS50b1N0cmluZygpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5jb25zdCBjb21wb25lbnQgPSBcInJmeC1zaW1wbGUtbWF0cml4XCI7XG5jb25zdCBIVE1MQ2xhc3NlcyA9IHtcbiAgICBncmlkQ29udGFpbmVyOiBgJHtjb21wb25lbnR9X19ncmlkLWNvbnRhaW5lcmAsXG4gICAgZ3JpZENvbHVtbjogYCR7Y29tcG9uZW50fV9fZ3JpZC1jb2x1bW5gXG59O1xuXG5jb25zdCByZnhTaW1wbGVNYXRyaXhDc3MgPSBcIjpyb290ey0tY2FsY2l0ZS1jb2xvci1icmFuZDojMDA3YWMyOy0tY2FsY2l0ZS1jb2xvci1icmFuZC1ob3ZlcjojMDA2MTliOy0tY2FsY2l0ZS1jb2xvci1icmFuZC1wcmVzczojMDA0ODc0Oy0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtaW5mbzojMDA2MTliOy0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtc3VjY2VzczojMzVhYzQ2Oy0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtd2FybmluZzojZWRkMzE3Oy0tY2FsY2l0ZS1jb2xvci1zdGF0dXMtZGFuZ2VyOiNkODMwMjA7LS1jYWxjaXRlLWNvbG9yLXN0YXR1cy1kYW5nZXItaG92ZXI6I2E4MmIxZTstLWNhbGNpdGUtY29sb3Itc3RhdHVzLWRhbmdlci1wcmVzczojN2MxZDEzOy0tY2FsY2l0ZS1jb2xvci1iYWNrZ3JvdW5kOiNmOGY4Zjg7LS1jYWxjaXRlLWNvbG9yLWZvcmVncm91bmQtMTojZmZmZmZmOy0tY2FsY2l0ZS1jb2xvci1mb3JlZ3JvdW5kLTI6I2YzZjNmMzstLWNhbGNpdGUtY29sb3ItZm9yZWdyb3VuZC0zOiNlYWVhZWE7LS1jYWxjaXRlLWNvbG9yLXRleHQtMTojMTUxNTE1Oy0tY2FsY2l0ZS1jb2xvci10ZXh0LTI6IzRhNGE0YTstLWNhbGNpdGUtY29sb3ItdGV4dC0zOiM2YTZhNmE7LS1jYWxjaXRlLWNvbG9yLXRleHQtaW52ZXJzZTojZmZmZmZmOy0tY2FsY2l0ZS1jb2xvci10ZXh0LWxpbms6IzAwNjE5YjstLWNhbGNpdGUtY29sb3ItYm9yZGVyLTE6I2NhY2FjYTstLWNhbGNpdGUtY29sb3ItYm9yZGVyLTI6I2Q0ZDRkNDstLWNhbGNpdGUtY29sb3ItYm9yZGVyLTM6I2RmZGZkZjstLWNhbGNpdGUtY29sb3ItYm9yZGVyLWlucHV0OiM5NDk0OTQ7LS1yZngtcXVhcnRlci1zcGFjaW5nOjAuMjVyZW07LS1yZngtaGFsZi1zcGFjaW5nOjAuNXJlbTstLXJmeC10aHJlZS1xdWFydGVyLXNwYWNpbmc6MC43NXJlbTstLXJmeC1mdWxsLXNwYWNpbmc6MXJlbTstLXJmeC1jb21wb25lbnQtZGVmYXVsdC13aWR0aDoxMDAlOy0tcmZ4LXVpLWJvcmRlci1pbnB1dDp2YXIoLS1jYWxjaXRlLWNvbG9yLWJvcmRlci0yKTstLXJmeC1wb3BvdmVyLWNvbnRlbnQtbWluLWhlaWdodDozMHZoOy0tcmZ4LXBvcG92ZXItY29udGVudC1tYXgtaGVpZ2h0OjYwdmg7LS1yZngtcG9wb3Zlci1jb250ZW50LWhlaWdodDo0NXZoOy0tcmZ4LXdpZGdldC1jb250ZW50LWhlaWdodDozMHZofS5yZngtc2ltcGxlLW1hdHJpeF9fZ3JpZC1jb250YWluZXJ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjt3aWR0aDoxMDAlO21heC13aWR0aDoxMDAlO292ZXJmbG93OmF1dG87bWF4LWhlaWdodDp2YXIoLS1yZngtd2lkZ2V0LWNvbnRlbnQtaGVpZ2h0KX0ucmZ4LXNpbXBsZS1tYXRyaXhfX2dyaWQtY29sdW1ue21pbi13aWR0aDozcmVtfVwiO1xuXG5jb25zdCBSZnhTaW1wbGVNYXRyaXggPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICB0aGlzLnJmeEFyZ3VtZW50Q2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJyZnhBcmd1bWVudENoYW5nZVwiLCA3KTtcbiAgICAgICAgdGhpcy51cGRhdGVHcmlkVmFsdWUgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgZGV0YWlsOiB7IGdyaWRPcHRpb25zIH0gfSA9IGV2ZW50O1xuICAgICAgICAgICAgaWYgKGlzRW1wdHlEYXRhSXRlbShncmlkT3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmdyaWRTY2hlbWEgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy5ncmlkU2NoZW1hLFxuICAgICAgICAgICAgICAgIGdyaWRPcHRpb25zXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5zZXRXaWRnZXRWYWx1ZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmdyaWRTY2hlbWEgPSB7XG4gICAgICAgICAgICBncmlkTGF5b3V0OiB7fSxcbiAgICAgICAgICAgIGdyaWRPcHRpb25zOiBbXSxcbiAgICAgICAgICAgIGhhc0JvcmRlcjogdHJ1ZSxcbiAgICAgICAgICAgIGhhc0hlYWRlcjogdHJ1ZSxcbiAgICAgICAgICAgIGNhbkFkZDogZmFsc2UsXG4gICAgICAgICAgICBoYXNJZENvbHVtbjogZmFsc2UsXG4gICAgICAgICAgICBjYW5SZW1vdmU6IGZhbHNlLFxuICAgICAgICAgICAgaXNTdGFja2VkOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNvbHVtbnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucm93cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gIExpZmVjeWNsZVxuICAgIC8vXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGNvbXBvbmVudFdpbGxSZW5kZXIoKSB7XG4gICAgICAgIHRoaXMuaW5pdEdyaWQoKTtcbiAgICAgICAgdGhpcy5zZXRXaWRnZXRWYWx1ZSgpO1xuICAgIH1cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgaW5pdEdyaWQoKSB7XG4gICAgICAgIGNvbnN0IGdyaWRMYXlvdXQgPSBjcmVhdGVNYXRyaXhTY2hlbWEoe1xuICAgICAgICAgICAgY29sdW1uczogdGhpcy5jb2x1bW5zLFxuICAgICAgICAgICAgZGF0YVR5cGU6IEdyaWRDb2x1bW4ubnVtYmVyLFxuICAgICAgICAgICAgc3R5bGU6IEhUTUxDbGFzc2VzLmdyaWRDb2x1bW5cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIHNldCB3aGVuIGRhdGEgaXMgcGVyc2lzdGVkICYgd2hlbmV2ZXIgZmFjdG9yIGZ1bmN0aW9uIHR5cGUgaXMgY2hhbmdlZFxuICAgICAgICBjb25zdCBncmlkT3B0aW9ucyA9IGNyZWF0ZU1hdHJpeERhdGFPYmplY3Qoe1xuICAgICAgICAgICAgY29sdW1uczogdGhpcy5jb2x1bW5zLFxuICAgICAgICAgICAgcm93czogdGhpcy5yb3dzLFxuICAgICAgICAgICAgdmFsdWU6IGNsb25lRGF0YSh0aGlzLnZhbHVlKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ncmlkU2NoZW1hID0ge1xuICAgICAgICAgICAgLi4udGhpcy5ncmlkU2NoZW1hLFxuICAgICAgICAgICAgZ3JpZExheW91dCxcbiAgICAgICAgICAgIGdyaWRPcHRpb25zXG4gICAgICAgIH07XG4gICAgfVxuICAgIHNldFdpZGdldFZhbHVlKCkge1xuICAgICAgICBjb25zdCBtYXRyaXhEYXRhID0gcGFyc2VNYXRyaXhEYXRhKHRoaXMuZ3JpZFNjaGVtYT8uZ3JpZE9wdGlvbnMpO1xuICAgICAgICB0aGlzLnZhbHVlID0gbWF0cml4RGF0YTtcbiAgICAgICAgdGhpcy5yZnhBcmd1bWVudENoYW5nZS5lbWl0KHsgdmFsdWU6IHRoaXMudmFsdWUgfSk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIChoKFwicmZ4LWdyaWRcIiwgeyByZWY6IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy53aWRnZXRDb250YWluZXIgPSBlO1xuICAgICAgICAgICAgfSwgY2xhc3M6IEhUTUxDbGFzc2VzLmdyaWRDb250YWluZXIsIGhhc0hlYWRlcjogdGhpcy5ncmlkU2NoZW1hLmhhc0hlYWRlciwgY2FuQWRkOiB0aGlzLmdyaWRTY2hlbWEuY2FuQWRkLCBoYXNJZENvbHVtbjogdGhpcy5ncmlkU2NoZW1hLmhhc0lkQ29sdW1uLCBncmlkTGF5b3V0OiB0aGlzLmdyaWRTY2hlbWEuZ3JpZExheW91dCwgZ3JpZE9wdGlvbnM6IHRoaXMuZ3JpZFNjaGVtYS5ncmlkT3B0aW9ucywgaGFzQm9yZGVyOiB0aGlzLmdyaWRTY2hlbWEuaGFzQm9yZGVyLCBjYW5SZW1vdmU6IHRoaXMuZ3JpZFNjaGVtYS5jYW5SZW1vdmUsIGlzU3RhY2tlZDogdGhpcy5ncmlkU2NoZW1hLmlzU3RhY2tlZCwgb25SZnhHcmlkT3B0aW9uQ2hhbmdlOiB0aGlzLnVwZGF0ZUdyaWRWYWx1ZSB9KSk7XG4gICAgfVxuICAgIGdldCBob3N0RWxlbWVudCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5SZnhTaW1wbGVNYXRyaXguc3R5bGUgPSByZnhTaW1wbGVNYXRyaXhDc3M7XG5cbmV4cG9ydCB7IFJmeFNpbXBsZU1hdHJpeCBhcyByZnhfc2ltcGxlX21hdHJpeCB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZngtc2ltcGxlLW1hdHJpeC5lbnRyeS5qcy5tYXAiLCJpbXBvcnQgeyBnIGFzIGdldExvY2FsZUluZm8gfSBmcm9tICcuL2xvY2FsaXphdGlvbi1oZWxwZXItNDgxOWI2N2QuanMnO1xuaW1wb3J0IHsgaSBhcyBpc0VtcHR5RGF0YUl0ZW0gfSBmcm9tICcuL3R5cGUtZ2F1cmRzLTE4NDA3NDdmLmpzJztcblxuLyoqXG4gKiBJbmRpY2F0ZXMgaWYgYSBwcm92aWRlZCBudW1iZXIgdmFsdWUgaXMgdmFsaWQuXG4gKiBBbiBpbnZhbGlkIHZhbHVlIGlzOiB1bmRlZmluZWQgfCBOYU4gfCBJbmZpbml0ZSB8IC1JbmZpbml0ZSB8IG51bGxcbiAqIFNlZSBmb3IgbW9yZSBkZXRhaWxzOlxuICogICAtIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL051bWJlci9pc0Zpbml0ZVxuICogICAtIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL051bWJlci9pc05hTlxuICogQHBhcmFtIHtudW1iZXIgfCB1bmRlZmluZWQgfCBudWxsfSB2YWx1ZSB2YWx1ZSB0byBjaGVja1xuICogQHJldHVybnMge2Jvb2xlYW59IGlmIHZhbGlkIG9yIG5vdFxuICovXG5mdW5jdGlvbiBpc1ZhbGlkTnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwgJiYgTnVtYmVyLmlzTmFOKHZhbHVlKSA9PT0gZmFsc2UgJiYgTnVtYmVyLmlzRmluaXRlKHZhbHVlKSA9PT0gdHJ1ZTtcbn1cbi8qKlxuICogUmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgcHJvdmlkZWQgbnVtYmVyIGZvciB1c2Ugd2l0aCBjYWxjaXRlLWlucHV0LiBJdCBhbHNvXG4gKiBndWFyZHMgYWdhaW5zdCBpbnZhbGlkIHR5cGVzIGZvbGxvd2luZyB0aGlzIGxvZ2ljOlxuICogICAtIElmIHRoZSB2YWx1ZSBpcyB2YWxpZCAobm90IE5hTiwgZmluaXRlKSwgdGhlIHZhbHVlIGlzIHJldHVybmVkIGFzIGEgc3RyaW5nXG4gKiAgIC0gSWYgbm90IGFuZCBpZiBhIHZhbGlkIGRlZmF1bHQgdmFsdWUgaXMgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IHZhbHVlIGlzIHJldHVybmVkIGFzIGEgc3RyaW5nXG4gKiAgIC0gSWYgbm90LCBhbiBlbXB0eSBzdHJpbmcgaXMgcmV0dXJuZWRcbiAqIEBwYXJhbSB2YWx1ZVxuICogQHBhcmFtIGRlZmF1bHRWYWx1ZVxuICogQHJldHVybnMgYSBzYW5pdGl6ZWQgc3RyaW5nXG4gKi9cbmZ1bmN0aW9uIHNhbml0aXplTnVtYmVyKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcbiAgICBsZXQgcmV0dXJuZWRWYWx1ZTtcbiAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgdGVzdGVkVmFsdWUgPSB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgPyBOdW1iZXIucGFyc2VGbG9hdCh2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgaWYgKGlzVmFsaWROdW1iZXIodGVzdGVkVmFsdWUpKVxuICAgICAgICAgICAgcmV0dXJuZWRWYWx1ZSA9IHRlc3RlZFZhbHVlO1xuICAgICAgICBlbHNlIGlmIChpc1ZhbGlkTnVtYmVyKGRlZmF1bHRWYWx1ZSkpXG4gICAgICAgICAgICByZXR1cm5lZFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuZWRWYWx1ZSA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IGAke3JldHVybmVkVmFsdWV9YDtcbn1cbi8qKlxuICogUGFyc2VzIGEgdmFsdWUgc3RyaW5nIHRvIGEgbnVtYmVyIGZvciB1c2Ugd2l0aCBjYWxjaXRlLWlucHV0LiBJZiB0aGUgc3RyaW5nIGlzIGVtcHR5LCBpdCB3aWxsIHJldHVybiB1bmRlZmluZWQuXG4gKiBJZiB0aGUgc3RyaW5nIGlzIG90aGVyd2lzZSBpbnZhbGlkLCBpdCB3aWxsIHJldHVybiBOYU4uXG4gKiBAcGFyYW0gdmFsdWUgY2FsY2l0ZS1pbnB1dCB2YWx1ZVxuICogQHJldHVybnMge251bWJlciB8IHVuZGVmaW5lZH0gdGhlIHBhcnNlZCBudW1iZXJcbiAqL1xuZnVuY3Rpb24gcGFyc2VOdW1iZXIodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IFwiXCIpXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHZhbHVlKTtcbn1cbi8qKlxuICogRm9ybWF0cyBhIG51bWJlciB0byBhIHNwZWNpZmllZCBudW1iZXIgb2YgZGVjaW1hbCBwbGFjZXMuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIC0gVGhlIG51bWJlciB0byBmb3JtYXQuXG4gKiBAcGFyYW0ge251bWJlcn0gW2ZyYWN0aW9uRGlnaXRzPTNdIC0gVGhlIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlcyB0byBpbmNsdWRlIGluIHRoZSBmb3JtYXR0ZWQgbnVtYmVyLiBEZWZhdWx0cyB0byAzLlxuICogQHJldHVybnMge251bWJlcnx1bmRlZmluZWR9IC0gVGhlIGZvcm1hdHRlZCBudW1iZXIsIG9yIHVuZGVmaW5lZCBpZiB0aGUgaW5wdXQgdmFsdWUgaXMgZW1wdHkuXG4gKi9cbmZ1bmN0aW9uIGZvcm1hdE51bWJlcih2YWx1ZSwgZnJhY3Rpb25EaWdpdHMgPSAzKSB7XG4gICAgaWYgKGlzRW1wdHlEYXRhSXRlbSh2YWx1ZSkpXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIE51bWJlci5wYXJzZUZsb2F0KHZhbHVlLnRvRml4ZWQoZnJhY3Rpb25EaWdpdHMpKTtcbn1cbi8qKlxuICogRm9ybWF0cyBhIG51bWJlciBvciBzdHJpbmcgcmVwcmVzZW50aW5nIGEgbnVtYmVyIGFjY29yZGluZyB0byB0aGUgbG9jYWxlLCBwYXNzaW5nIEludGwgbnVtYmVyIGZvcm1hdCBvcHRpb25zXG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZUdsb2JhbF9PYmplY3RzL0ludGwvTnVtYmVyRm9ybWF0L051bWJlckZvcm1hdCNvcHRpb25zXG4gKiBAcGFyYW0ge251bWJlciB8IHN0cmluZyB8IHVuZGVmaW5lZH0gdmFsdWUgdG8gYmUgZm9ybWF0dGVkIGFuZCBsb2NhbGl6ZWRcbiAqIEBwYXJhbSB7SW50bC5OdW1iZXJGb3JtYXRPcHRpb25zfSBmb3JtYXRPcHRpb25zIG9wdGlvbnMgb2JqZWN0IG1hdGNoaW5nIEludGwuTnVtYmVyRm9ybWF0XG4gKiBAcmV0dXJucyB7c3RyaW5nfSBsb2NhbGl6ZWQgLyByb3VuZGVkIHN0cmluZ1xuICovXG5mdW5jdGlvbiBmb3JtYXROdW1iZXJUb0xvY2FsZSh2YWx1ZSwgZm9ybWF0T3B0aW9ucykge1xuICAgIGxldCBmb3JtYXR0ZWRWYWx1ZSA9IFwiXCI7XG4gICAgaWYgKCFpc0VtcHR5RGF0YUl0ZW0odmFsdWUpICYmICFOdW1iZXIuaXNOYU4odmFsdWUpKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsZUNvZGUgPSBnZXRMb2NhbGVJbmZvKCkubG9jYWxlO1xuICAgICAgICBmb3JtYXR0ZWRWYWx1ZSA9IEludGwuTnVtYmVyRm9ybWF0KGxvY2FsZUNvZGUsIGZvcm1hdE9wdGlvbnMpLmZvcm1hdChOdW1iZXIodmFsdWUpKTtcbiAgICB9XG4gICAgcmV0dXJuIGZvcm1hdHRlZFZhbHVlO1xufVxuXG5leHBvcnQgeyBmb3JtYXROdW1iZXJUb0xvY2FsZSBhcyBhLCBmb3JtYXROdW1iZXIgYXMgZiwgaXNWYWxpZE51bWJlciBhcyBpLCBwYXJzZU51bWJlciBhcyBwLCBzYW5pdGl6ZU51bWJlciBhcyBzIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNhbml0aXplLW51bWJlci1kODQxMTRmNy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=