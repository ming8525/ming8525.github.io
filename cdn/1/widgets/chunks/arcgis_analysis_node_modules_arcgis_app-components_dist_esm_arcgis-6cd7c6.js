/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6cd7c6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6cd7c6"],{14526:(e,r,l)=>{l.r(r),l.d(r,{arcgis_smart_mapping_flow_color_slider:()=>n});var o=l(81149),s=l(9225),i=l(5996),t=(l(69283),l(41267)),a=(l(49306),l(14221));l(51837),l(42577),l(82218),l(70464),l(10519);const n=class{constructor(e){(0,o.r)(this,e),this.arcgisSmartMappingFlowColorSliderChange=(0,o.c)(this,"arcgisSmartMappingFlowColorSliderChange",7),this.arcgisSmartMappingFlowColorSliderError=(0,o.c)(this,"arcgisSmartMappingFlowColorSliderError",7),this.currentStopValues=[],this.styleSheetStatus="not-loaded"}componentDidLoad(){this.flowItemNode=(0,s.F)(this.hostElement,"calcite-flow-item")}render(){const{config:e}=s.s;return(0,o.h)(o.H,null,(0,o.h)("link",{rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,o.f)(this.hostElement)},onError:()=>{this.styleSheetStatus="failed",(0,o.f)(this.hostElement)}}),"loaded"===this.styleSheetStatus?this.renderFlowColorSlider():"not-loaded"===this.styleSheetStatus?this.renderFlowColorSliderLoading():null)}renderFlowColorSlider(){var e,r;const{layer:l,strings:i}=s.s,t=l,a=t.renderer,n=(0,s.a)(a,"color");if(!n)return;const{sourceJSON:h}=t,{minValues:u,maxValues:d}=h,c=(0,s.p)(a,"color"),p=null!==(e=null==c?void 0:c.minSliderValue)&&void 0!==e?e:null==u?void 0:u[0],m=null!==(r=null==c?void 0:c.maxSliderValue)&&void 0!==r?r:null==d?void 0:d[0];if((0,s.ac)(p)&&(0,s.ac)(m)&&p!==m&&1!==(null==n?void 0:n.stops.length)){const e=this.prepareFlowColorSlider();return n.stops.forEach(((e,r)=>{this.currentStopValues[r]=e.value})),e||this.flowColorSlider?(0,o.h)("div",{class:"slider-box"},(0,o.h)("calcite-label",null,i.panels.flow.dataRange),(0,o.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),(0,o.h)("div",null,"Â "),this.renderResetButton()),(0,o.h)("div",{ref:e=>{e&&this.afterFlowColorSliderCreate(e)}})):this.renderFlowColorSliderLoading()}this.flowColorSlider&&(this.flowColorSlider.destroy(),this.flowColorSlider=void 0)}renderFlowColorSliderLoading(){const{strings:e}=s.s;return(0,o.h)("div",{class:"slider-box"},(0,o.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=s.s;return(0,o.h)("arcgis-smart-mapping-action",{text:e.panels.flow.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderResetButton(){const{strings:e}=s.s;return(0,o.h)("arcgis-smart-mapping-action",{text:e.panels.flow.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareFlowColorSlider(){var e,r,l,o;const{layer:i,modules:a}=s.s,n=i,h=n.renderer,u=(0,s.a)(h,"color"),{sourceJSON:d}=n,{minValues:c,maxValues:p}=d,m=(0,s.p)(h,"color"),f=null!==(e=null==m?void 0:m.minSliderValue)&&void 0!==e?e:null==c?void 0:c[0],S=null!==(r=null==m?void 0:m.maxSliderValue)&&void 0!==r?r:null==p?void 0:p[0],g=m?(0,s.aD)(m.theme,u.stops):void 0;if(!this.flowColorSlider||!u&&this.flowColorSlider.stops){null===(l=this.flowColorSlider)||void 0===l||l.destroy();let e={min:f,max:S};e=Object.assign(Object.assign({},e),g),e.stops=u.stops,e.precision=(0,t.g)(u.stops),e.labelFormatFunction=r=>r.toFixed(e.precision),this.flowColorSlider=new a.ColorSlider(e),this.createFlowColorSliderChangeEvents()}else{if("dragging"===(null===(o=this.flowColorSlider.slider)||void 0===o?void 0:o.state))return!0;let e={min:f,max:S};e=Object.assign(Object.assign({},e),g),e.stops=u.stops,e.precision=(0,t.g)(u.stops),this.flowColorSlider.set(e)}return(0,s.ac)(this.flowColorSlider)}handleInvertSlider(){const{layer:e}=s.s,r=e.renderer,l=(0,s.a)(r,"color");let i=l.stops.map((e=>e.color));i=i.reverse(),l.stops.forEach(((e,r)=>{e.color=i[r]})),(0,s.ab)(),(0,o.f)(this.hostElement),this.arcgisSmartMappingFlowColorSliderChange.emit()}handleResetSlider(){const{layer:e}=s.s,r=e,l=r.renderer;(0,i.r)((0,a.c)({includeColorVariable:!0}),this.flowItemNode).then((e=>{const i=(0,s.a)(r.renderer,"color"),t=(0,s.p)(l,"color"),a=(0,s.a)(e.renderer,"color"),n=(0,s.p)(e.renderer,"color");t.minSliderValue=n.minSliderValue,t.maxSliderValue=n.maxSliderValue,i.stops.forEach(((e,r)=>{e.value=a.stops[r].value})),(0,s.ab)(),(0,o.f)(this.hostElement)}),(e=>this.arcgisSmartMappingFlowColorSliderError.emit(e)))}afterFlowColorSliderCreate(e){if(!this.flowColorSlider.container){const r=document.createElement("div");e.append(r),this.flowColorSlider.container=r}}createFlowColorSliderChangeEvents(){this.flowColorSlider&&(this.flowColorSlider.on("min-change",(e=>{e.value>this.currentStopValues[0]?(this.flowColorSlider.stops.forEach(((e,r)=>{e.value=this.currentStopValues[r]})),this.handleMinMaxChange(this.currentStopValues[0],this.flowColorSlider.max)):this.handleMinMaxChange(e.value,this.flowColorSlider.max)})),this.flowColorSlider.on("max-change",(e=>{e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.flowColorSlider.stops.forEach(((e,r)=>{e.value=this.currentStopValues[r]})),this.handleMinMaxChange(this.flowColorSlider.min,this.currentStopValues[this.currentStopValues.length-1])):this.handleMinMaxChange(this.flowColorSlider.min,e.value)})),this.flowColorSlider.on("thumb-change",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("thumb-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("segment-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))))}handleMinMaxChange(e,r){const{layer:l}=s.s,i=l.renderer,t=(0,s.p)(i,"color")||{};t.minSliderValue=e,t.maxSliderValue=r,i.authoringInfo.classificationMethod="manual",(0,s.ab)(),(0,o.f)(this.hostElement),this.arcgisSmartMappingFlowColorSliderChange.emit()}updateRendererStops(e){const{layer:r}=s.s,l=r.renderer,o=(0,s.a)(l,"color");o.stops=e,o.stops.forEach(((e,r)=>{this.currentStopValues[r]=e.value})),(0,s.ab)(),this.arcgisSmartMappingFlowColorSliderChange.emit()}get hostElement(){return(0,o.d)(this)}};n.style=".slider-box{height:275px}.slider-box .esri-color-slider{min-width:200px}.slider-box .esri-color-slider .esri-slider .esri-slider__content{height:130px}.slider-box .esri-color-slider .esri-slider .esri-slider__label,.slider-box .esri-color-slider .esri-slider .esri-slider__min,.slider-box .esri-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.slider-box .esri-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-box-buttons-front{display:flex}"},5996:(e,r,l)=>{let o,s;function i(e){e.loading=!1}function t(e,r){return function(e){e.loading=!0,s=!1,o&&clearTimeout(o),o=setTimeout((()=>{i(e),s=!0}),6e4)}(r),e.then((e=>(i(r),s?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(i(r),Promise.reject(e))))}l.d(r,{r:()=>t})},41267:(e,r,l)=>{l.d(r,{a:()=>a,b:()=>t,g:()=>d,u:()=>i});var o=l(9225),s=(l(69283),l(10519));function i(e){const{layer:r,modules:l}=o.s,i=(0,o.h)(r),t=l.esriLang.clone(i.classBreakInfos);i.classBreakInfos=[],t.forEach(((r,l)=>{r=function(e,r,l,i){if((0,s.i)(r))if(0===r);else if(r<1){const s=Math.round(1/r);e.minValue="first"===i?Math.floor(e.minValue/r)/s:Math.round(e.minValue/r)/s,e.maxValue="last"===i?Math.ceil(e.maxValue/r)/s:Math.round(e.maxValue/r)/s,e.label=`${l>0?"> ":""}${e.minValue.toLocaleString(o.s.fullLocale,{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(o.s.fullLocale,{maximumSignificantDigits:15})}`}else e.minValue="first"===i?Math.floor(e.minValue/r)*r:Math.round(e.minValue/r)*r,e.maxValue="last"===i?Math.ceil(e.maxValue/r)*r:Math.round(e.maxValue/r)*r,e.label=(l>0?"> ":"")+e.minValue.toLocaleString()+" - "+e.maxValue.toLocaleString();return e}(r,e,l,0===l?"first":l===t.length-1?"last":void 0),i.addClassBreakInfo({minValue:r.minValue,maxValue:r.maxValue,symbol:r.symbol,label:r.label})}))}function t(e){const{layer:r}=o.s,l=(0,o.h)(r).classBreakInfos;let s=e,i=1/0;l.forEach((e=>{s||(s=Math.max(n(e.minValue),n(e.maxValue))),i=Math.min(i,e.maxValue-e.minValue)}));const t=[];return i>1e7?(t.push(1e7),t.push(1e6),t.push(1e5),t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e6?(t.push(1e6),t.push(1e5),t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e5?(t.push(1e5),t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e4?(t.push(1e4),t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01)):i>1e3?(t.push(1e3),t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001)):i>100?(t.push(100),t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5)):i>10?(t.push(10),s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>1?(s>0&&t.push(1),s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>.1?(s>1&&t.push(.1),s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>.01?(s>2&&t.push(.01),s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6)):i>.001?(s>3&&t.push(.001),s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6),s>7&&t.push(1e-7)):i>1e-4?(s>4&&t.push(1e-4),s>5&&t.push(1e-5),s>6&&t.push(1e-6),s>7&&t.push(1e-7),s>8&&t.push(1e-8)):i>1e-5&&(s>5&&t.push(1e-5),s>6&&t.push(1e-6),s>7&&t.push(1e-7),s>8&&t.push(1e-8),s>9&&t.push(1e-9)),t}function a(){const{layer:e}=o.s,r=(0,o.h)(e);let l=1e10;return r.classBreakInfos.forEach((e=>{l=Math.min(l,h(e.minValue)),l=Math.min(l,h(e.maxValue))})),l}function n(e){let r=1;for(;Math.round(e*r)/r!==e;)r*=10;return Math.log(r)/Math.LN10}function h(e){let r=1e-8;for(;u(Math.round(e/r)*r)===e;)r*=10;return r/10}function u(e){return parseFloat(e.toPrecision(12))}function d(e){var r,l,o,i,t,a,h,d;let c=0;e.forEach((e=>{(0,s.i)(e.value)?c=Math.max(n(u(e.value)),c):((0,s.i)(e.minValue)&&(c=Math.max(n(u(e.minValue)),c)),(0,s.i)(e.maxValue)&&(c=Math.max(n(u(e.maxValue)),c)),(0,s.i)(e.min)&&(c=Math.max(n(u(e.min)),c)),(0,s.i)(e.max)&&(c=Math.max(n(u(e.max)),c)))})),c=Math.min(c,3);const p=e[0],m=e[e.length-1],f=Math.min(null!==(l=null!==(r=p.minValue)&&void 0!==r?r:p.min)&&void 0!==l?l:p.value,null!==(i=null!==(o=m.minValue)&&void 0!==o?o:m.min)&&void 0!==i?i:m.value),S=Math.max(null!==(a=null!==(t=p.maxValue)&&void 0!==t?t:p.max)&&void 0!==a?a:p.value,null!==(d=null!==(h=m.maxValue)&&void 0!==h?h:m.max)&&void 0!==d?d:m.value)-f;return S/e.length<2e-7?c=8:S/e.length<2e-6?c=7:S/e.length<2e-5?c=6:S/e.length<2e-4?c=5:S/e.length<.002?c=4:S/e.length<.02?c=3:S/e.length<.2?c=Math.max(c,2):S/e.length<2&&(c=Math.max(c,1)),Math.round(c)}},14221:(e,r,l)=>{l.d(r,{a:()=>i,c:()=>s,f:()=>t});var o=l(9225);function s(e){const{layer:r,mapView:l,modules:s}=o.s,i=r;return e=e||{},s.RasterFlowCreator.createRenderer({layer:i,view:l,theme:e.flowTheme||"flow-line",includeColorVariable:e.includeColorVariable,legendOptions:e.legendOptions,flowRepresentation:e.flowRepresentation,flowScheme:e.flowScheme||t()}).then((r=>(r.layerEffect&&-1===r.layerEffect.indexOf("drop-shadow")&&(i.effect=r.layerEffect),r.renderer.color=r.renderer.color&&(e.color||r.renderer.color),i.renderer=r.renderer,Promise.resolve(r))),(e=>Promise.reject(e)))}function i(e){var r;const{layer:l,mapView:s,modules:i}=o.s,a=l;e=e||{};const n=a.renderer,h=(0,o.a)(n,"color"),u=n.authoringInfo,d=e.flowTheme||(null==u?void 0:u.flowTheme)||"flow-line";return i.RasterFlowCreator.createRenderer({layer:a,view:s,theme:d,includeColorVariable:null!==(r=e.includeColorVariable)&&void 0!==r?r:!!h,legendOptions:e.legendOptions||(null==h?void 0:h.legendOptions),flowRepresentation:e.flowRepresentation||n.flowRepresentation,flowScheme:e.flowScheme}).then((r=>{const l=(0,o.p)(n,"color"),s=(0,o.p)(r.renderer,"color");(null==l?void 0:l.minSliderValue)&&(null==l?void 0:l.maxSliderValue)&&s&&(s.minSliderValue=l.minSliderValue,s.maxSliderValue=l.maxSliderValue);const h=(0,o.a)(a.renderer,"color"),c=(0,o.a)(r.renderer,"color");return h&&c&&h.stops.forEach(((e,r)=>{c.stops[r].value=e.value})),r.renderer.color=r.renderer.color&&(e.color||n.color||r.renderer.color),(e.flowScheme||t())&&h&&c&&h.stops.forEach(((e,r)=>{c.stops[r].color=new i.esriColor(e.color.toJSON())})),d===u.flowTheme&&(r.renderer.flowSpeed=n.flowSpeed,r.renderer.density=n.density,r.renderer.trailLength=n.trailLength,r.renderer.trailWidth=n.trailWidth,r.renderer.trailCap=n.trailCap),Promise.resolve(r)}),(e=>Promise.reject(e)))}function t(){const{layer:e,mapView:r,modules:l}=o.s,s=e.renderer,i=(0,o.a)(s,"color");if(!i)return null;const t=i.stops.map((e=>e.color)),a=l.flowSchemes.getSchemes({basemap:r.map.basemap||"topo"}),n=[a.primaryScheme].concat(a.secondarySchemes),h=[];return n.forEach((e=>{let r=t.some(((r,l)=>!(0,o.a4)(e.colors[l],r)));r?(e.colors=e.colors.reverse(),r=t.some(((r,l)=>!(0,o.a4)(e.colors[l],r))),r||h.push(e)):h.push(e)})),h.length?h[0]:null}l(69283),l(49306)}}]);