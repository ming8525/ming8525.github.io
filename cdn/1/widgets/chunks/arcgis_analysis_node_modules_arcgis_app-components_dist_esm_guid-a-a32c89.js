/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_guid-a-a32c89.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_guid-a-a32c89"],{18762:(t,n,e)=>{e.d(n,{a:()=>u,b:()=>g,c:()=>c,d:()=>d,e:()=>v,f:()=>h,g:()=>a,h:()=>m,i:()=>w,j:()=>o,k:()=>p,q:()=>f,u:()=>b});var r=e(20164),i=e(49853);const s='owner:"esri" AND title:"AppSwitcher Config" AND type: "Application Configuration"';async function o(t){const n=(0,r.g)(t);if(!n)return;const e=`${n}portals/self/settings`;return(0,r.f)((()=>$(e)),"portalSettings",n)}async function a(){var t;const n=await o();return(null===(t=null==n?void 0:n.portalConfigProperties)||void 0===t?void 0:t.showInAppLauncher)||[]}async function l(t){const n=(0,r.g)();if(n&&t)return $(`${n}content/items/${t}/data`)}async function u(){var t;const{portal:n,user:e}=i.c;if(!(null==n?void 0:n.id)||!e)return;const o=await async function(){const t=(0,r.g)();if(t)return $(`${t}search`,{num:1,start:0,sortField:"title",sortOrder:"asc",q:s})}(),a=null===(t=null==o?void 0:o.results)||void 0===t?void 0:t[0];if(!a)return;const u=a.id;return await l(u)}async function c(){const{user:t}=i.c;return $(`${(0,r.g)()}community/users/${t.username}/properties`)}async function d(){const{portal:t}=i.c;return $(`${(0,r.g)()}portals/${t.id}/approvedApps`,{returnAllApps:!1})}async function p(t,n,e="results"){let r,i,s,o,a=1,l=[];n.start=a,n.num||(n.num=100);try{const u=await $(t,n);if(!(null==u?void 0:u[e]))return l;for(l=[...l,...u[e]],a=u.nextStart,r=u.total-l.length,i=Math.ceil(r/100),s=[],o=0;o<i;o++)n.start=a+100*o,s.push($(t,n));try{return(await Promise.all(s)).forEach((t=>{l=[...l,...t[e]]})),l}catch(t){return l}}catch(t){return l}}async function g(){const{user:t}=i.c;return p(`${(0,r.g)()}community/users/${t.username}/provisionedListings`,{returnAppClientIds:!0,returnAllProvisions:!0},"provisionedListings")}async function v(){const t=`${(0,r.g)()}portals/self/subscriptionInfo`;try{const n=await $(t);return(null==n?void 0:n.orgCapabilities)||[]}catch(t){return[]}}async function f(t,n){if(n&&(null==t?void 0:t.length))return $(`${(0,r.g)()}search`,{num:100,q:`id:(${t.map((t=>`"${t.itemId}"`)).join(" OR ")})`})}const y='owner:"esri" AND title:"BlockedApps Config" AND type: "Application Configuration"';async function m(){var t,n;const e=`${(0,r.g)()}search`;try{const r=await $(e,{num:10,start:0,sortField:"title",sortOrder:"asc",q:y});if(!r)return[];const i=(null===(n=null===(t=r.results)||void 0===t?void 0:t[0])||void 0===n?void 0:n.id)||"",s=await l(i);return(null==s?void 0:s.blockedApps)||[]}catch(t){return[]}}async function w(){const t=`${(0,r.g)()}portals/self/servers`,n=await $(t);return(null==n?void 0:n.servers)||[]}async function h(){const t=`${(0,r.g)()}portals/self/signinSettings`;return await $(t)}async function $(t,n){n||(n={}),n.f="json";const e=(0,r.e)();e&&(n.token=e);const i=new URL(t);Object.keys(n).forEach((t=>i.searchParams.append(t,n[t])));const s=await fetch(i);return await s.json()}async function b(t){const{user:n}=i.c,e=function(t){let n=(0,r.g)();return"/"!==n.slice(-1)&&(n+="/"),`${n}${t}`}(`community/users/${n.username}/setProperties`),s=new FormData;return s.append("properties",JSON.stringify(t)),async function(t,n){n.append("f","json");const e=(0,r.e)();e&&n.append("token",e),fetch(t,{method:"POST",body:n})}(e,s)}},31500:(t,n,e)=>{e.d(n,{g:()=>r});const r=()=>[2,1,1,1,3].map((t=>{let n="";for(let e=0;e<t;e++)n+=(65536*(1+Math.random())|0).toString(16).substring(1);return n})).join("-")},79759:(t,n,e)=>{e.d(n,{H:()=>r});const r='-type:"Code Attachment" -type:"Featured Items" -type:"Symbol Set" -type:"Color Set" -type:"Windows Viewer Add In" -type:"Windows Viewer Configuration" -type:"Map Area" -typekeywords:"MapAreaPackage" -type:"Indoors Map Configuration" -typekeywords:"SMX"'},49288:(t,n,e)=>{e.d(n,{c:()=>i});var r=e(42577);function i(t=""){return(0,r.s)(t).replace(/[<>\/\\[\]\?]/g,"\\$&").trim()}},78239:(t,n,e)=>{e.d(n,{a:()=>f,b:()=>m,c:()=>j,d:()=>g,e:()=>$,f:()=>k,g:()=>S,h:()=>A,i:()=>h,j:()=>C,k:()=>O,q:()=>y});var r=e(81149),i=e(20164),s=e(88780),o=e(70105),a=e(79759),l=e(36238),u=e(18762),c=e(49288),d=e(30301),p=e(82102);const g=["nonspatial","point","polygon","multipoint","polyline"];let v;function f(t,n,e){var r;const i={};null===(r=t.results)||void 0===r||r.forEach((t=>{t.tags.forEach((t=>{t&&(i[t]=(i[t]||0)+1)}))}));const s=Object.entries(i).sort(((t,n)=>n[1]-t[1])).map((([t])=>t));return(0,l.b)([...n||[],...s||[],...e||[]])}async function y({portal:t,query:n,user:e,store:r,config:l,allowedSubscriptionContentTypes:u,groupId:p}){var f,y,m,O,j,S,A;let k=(0,i.g)(t),C={};const{num:I,start:P,sortOrder:q,sortField:L,filters:F,baseQuery:_,baseFilter:E,searchTerm:M,bucket:D,allowedGeometries:T}=n;if((null==v?void 0:v.signal)&&v.abort(),r.state.recycleBin)return v=new AbortController,"my"===D?async function({query:t,portal:n,user:e}){return b(t,`${(0,i.g)(n)}content/users/${e.username}/`)}({query:n,portal:t,user:e}):async function({query:t,portal:n}){return b(t,`${(0,i.g)(n)}content/portals/${n.id}/`)}({query:n,portal:t});const R=p||"group"===D&&(null===(f=null==F?void 0:F.group)||void 0===f?void 0:f.id)&&"all"!==(null===(y=null==F?void 0:F.group)||void 0===y?void 0:y.group)&&(null===(m=null==F?void 0:F.group)||void 0===m?void 0:m.group)||"living atlas"===D&&(null!==(O=null==r?void 0:r.state.livingAtlasGroupId)&&void 0!==O?O:await async function(t,n){var e,r;const s=(null===(r=null===(e=(await(0,i.q)({q:t.livingAtlasGroupQuery,num:1,sortField:"title",sortOrder:"asc"},t)).results)||void 0===e?void 0:e[0])||void 0===r?void 0:r.id)||"";return n&&(n.state.livingAtlasGroupId=s),s}(t,r))||"living atlas analysis"===D&&(null!==(j=null==r?void 0:r.state.livingAtlasAnalysisGroupId)&&void 0!==j?j:await async function(t,n){var e,r;const s=(null===(r=null===(e=(await(0,i.q)({q:w(t),num:1,sortField:"title",sortOrder:"asc"},t)).results)||void 0===e?void 0:e[0])||void 0===r?void 0:r.id)||"";return n&&(n.state.livingAtlasAnalysisGroupId=s),s}(t,r));if("subscription content"===D)return async function(t,n,e){return(0,i.f)((async()=>{const r=await $(n,t);if(!(null==r?void 0:r.length))return{total:0,results:[],start:-1,num:100,nextStart:0};const i=null==r?void 0:r.map((t=>t.itemId)),o=await Promise.all(i.map((n=>(0,d.c)(n,t)))),a=await Promise.all(null==i?void 0:i.map((n=>async function(t,n){var e;return null!==(e=(await(0,s.g)(t,n,{relationshipType:"Listed2ImplicitlyListed",direction:"forward"})).relatedItems)&&void 0!==e?e:[]}(n,t)))),l=a.reduce(((t,n)=>t.concat(n)),o).filter((t=>function(t,n){return null!=n||(n=["Map Service","Image Service","Feature Service","Stream Service","Vector Tile Service","WMS","WFS","WMTS","KML","Feature Collection","Feed"]),n.includes(t.type)}(t,e)));return{total:l.length,results:l,start:l.length?1:0,num:100,nextStart:0}}),"subscriptionContent",`${t.id}-${n.username}`)}(t,e,u);await h(t,D)&&(k="https://www.arcgis.com/sharing/rest/",C.addTokenManually=!1);const x=R?`content/groups/${R}/`:"",G=`${k}${x}search`,N=function(t,n){return!t||t.length===(null==g?void 0:g.length)||(null==n?void 0:n.isPortal)?"":`((-typekeywords:"Hosted Service") OR (typekeywords:"Hosted Service" AND geometrytype:(${t.map((t=>`"${t}"`)).join(" OR ")})))`}(T,t),H=Object.keys(F||{}),U=D?await async function({bucket:t,user:n,portal:e,filters:r}){switch(t){case"my":return`owner: ${n.username}`;case"org":return`orgid:${e.id} ${e.isPortal?"-owner:esri_apps":""}`;case"favorites":return`group: ${await(0,o.e)()}`;case"group":if(!(null==r?void 0:r.group)||"all"===(null==r?void 0:r.group.group)){const t=await(0,o.d)();return`group:(${null==t?void 0:t.map((({id:t})=>t)).join(" OR ")})`}default:return""}}({bucket:D,user:e,portal:t,store:r,filters:F}):"",W=M?`(${(0,c.c)(M)}) `:"",B=!(!(null==l?void 0:l.semanticSearchEnabled)||!(null===(S=null==t?void 0:t.portalProperties)||void 0===S?void 0:S.semanticSearchEnabled))||e&&!e.orgId,V=Object.assign(Object.assign(Object.assign({},E?{filter:`${E}`}:{}),B?{enriched:!0}:{}),{q:`${_||""} ${N} ${U} ${W} ${a.H}`,displaySublayers:!0,displayHighlights:!0}),J=[],Q=H.reduce(((t,n)=>{const{param:e,value:r,additionalParams:i}=F[n];if(D&&"group"===n&&"group"!==D||"group"===n&&x||"folder"===n&&"my"!==D||"region"===n&&!["living atlas","living atlas analysis"].includes(D))return t;"categories"===n&&r&&J.push(F[n].category),"region"===n&&r&&J.push(F[n].categoryValue);const s="categories"===e?{}:{[e]:`${t[e]||""} ${r}`};return Object.assign(Object.assign(Object.assign({},t),s),null!=i?i:{})}),V),K=Object.assign(Object.assign({num:I,start:P},"relevance"===L?{}:{sortField:L,sortOrder:q}),Q||{}),X=J.length?J.map((t=>`categories=${JSON.stringify([t])}`)).join("&"):"",z=J.length?"?":"";try{const t=await(0,i.r)(`${G}${z}${X}`,K,C);return Object.assign(Object.assign({},t),{queryParams:K})}catch(t){if(498===(null===(A=null==t?void 0:t.details)||void 0===A?void 0:A.httpStatus)&&"Invalid token."===(null==t?void 0:t.message)){const t=await(0,i.r)(`${G}${z}${X}`,K,Object.assign(Object.assign({},C),{addTokenManually:!1}));return Object.assign(Object.assign({},t),{queryParams:K})}}}function m(t,n){if(!n.deepLayerSearchEnabled)return{};const e={};return(t.highlights||[]).forEach((n=>{var r;const i=null===(r=t.results)||void 0===r?void 0:r.find((t=>t.id===n.id));if(!(null==i?void 0:i.sublayers))return;const s=Object.keys(n).filter((t=>"id"!==t&&t.includes("sublayers."))).reduce(((t,e)=>(t[e.replace("sublayers.","")]=n[e].map((t=>t.replaceAll("<em>","").replaceAll("</em>",""))),t)),{}),o=i.sublayers.filter((t=>Object.keys(t).some((n=>{var e;return null===(e=s[n])||void 0===e?void 0:e.some((e=>t[n].includes(e)))})))).map((t=>t.id));e[n.id]=Object.assign(Object.assign({},n),{sublayers:o})})),e}function w(t){return'title:"Living Atlas Analysis Layers" AND owner:'+(!0===t.isPortal?"esri_livingatlas":"esri")}async function h(t,n){var e;if((null==t?void 0:t.isPortal)&&"all"===n){const n=await(0,u.j)(t);if(null===(e=null==n?void 0:n.portalConfigProperties)||void 0===e?void 0:e.searchArcGISOnlineEnabled)return!0}return!1}async function $(t,n){return t&&n?(0,i.f)((async()=>{const e=`${(0,i.g)(n)}community/users/${t.username}/provisionedListings`;return(0,u.k)(e,{},"provisionedListings")}),"provisionedListings",`${n.id}-${t.username}`):[]}async function b(t,n){return new Promise((async(e,r)=>{var s;null===(s=null==v?void 0:v.signal)||void 0===s||s.addEventListener("abort",(()=>{r(new DOMException("Aborted","AbortError"))}));const{start:o,num:a,sortField:l,sortOrder:u}=t,c=await(0,i.r)(n,{foldersContent:!0,inRecycleBin:!0,start:o,num:a,sortField:l,sortOrder:u});return e(Object.assign(Object.assign({},c),{results:c.items,queryParams:t}))}))}async function O(t,n,e,r){var s;const o=await h(n,r.state.bucket),a=o?`https://www.arcgis.com/sharing/rest/content/items/${t.id}`:(0,p.g)(t.id,n),l=o||!e?{disableIdentityLookup:!0,addTokenManually:!1}:{};try{return{result:await(0,i.r)(a,{},l)}}catch(t){if("SB_0005"===(null===(s=null==t?void 0:t.details)||void 0===s?void 0:s.messageCode))return{error:{code:"disabledSubscription"}}}return{error:{code:"unhandledError"}}}function j(t,n){const e=Object.assign({},t);return"my"!==n&&delete e.folder,"group"!==n&&delete e.group,e}function S(t,n,e,r){null!=e||(e=(0,i.g)(t));const s=(0,i.e)(t),o=s&&!r?`token=${s}`:"",a=`${e}content/items/${n.id}`;return n.thumbnail?n.thumbnailUrl?n.thumbnailUrl:`${a}/info/${n.thumbnail}?w=400${s?"&":""}${o}`:"Image"!==n.type||r?k(n):`${a}/data?${o}`}async function A(t,n,e){return await h(t,e)?S(t,n,"https://www.arcgis.com/sharing/rest/",!0):S(t,n)}function k(t){var n;const e="notebook"!==(null===(n=t.type)||void 0===n?void 0:n.toLowerCase())?"default_thumb.png":"notebook-thumb.png";return(0,r.a)(`./assets/arcgis-item-browser-card-thumbnail/${e}`)}function C(t){if(!t)return!0;const n=document.createElement("canvas"),e=n.getContext("2d");n.height=t.naturalHeight,n.width=t.naturalWidth,e.fillStyle="#ffffff",e.fillRect(0,0,t.naturalWidth,t.naturalHeight);const r=n.toDataURL("image/jpeg");return e.drawImage(t,0,0),r===n.toDataURL("image/jpeg")}},70105:(t,n,e)=>{e.d(n,{a:()=>d,b:()=>p,c:()=>g,d:()=>a,e:()=>l,f:()=>s,g:()=>c,u:()=>v});var r=e(20164),i=e(49853);async function s(t,n){return(0,r.r)(`${(0,r.g)(n)}/community/users/${t}`)}async function o(){return(0,r.r)(`${(0,r.g)()}/community/self`)}async function a(){var t;const n=null===i.c||void 0===i.c?void 0:i.c.user;if(!n)return[];const e=await(0,r.f)((()=>o()),"communitySelf",n.username);return null!==(t=null==e?void 0:e.groups)&&void 0!==t?t:[]}async function l(){const t=null===i.c||void 0===i.c?void 0:i.c.user;return t?(await(0,r.f)((()=>o()),"communitySelf",t.username)).favGroupId:null}function u(t,n){var e;return null!==(e=null==t?void 0:t.userContentUrl)&&void 0!==e?e:`${null==n?void 0:n.restUrl}/content/users/${t.username}`}async function c(t){var n;const e=null!==(n=null!=t?t:i.c.user)&&void 0!==n?n:i.c.portal.user,{folders:s}=await async function(t){var n;const e=u(null!==(n=null!=t?t:i.c.user)&&void 0!==n?n:i.c.portal.user,i.c.portal),s=await(0,r.r)(e,{num:1});return Promise.resolve(s)}(e),{username:o}=e;return[{username:o,id:o,title:o,created:"now"},...s.sort(((t,n)=>t.title.localeCompare(n.title)))]}async function d(t,n){var e;const r=null!==(e=null!=n?n:i.c.user)&&void 0!==e?e:i.c.portal.user;return(await c(r)).find((n=>n.id===t))}function p(t){return{username:t,id:t,title:t,created:"now"}}async function g(t,n){var e;const s=`${u(null!==(e=null!=n?n:i.c.user)&&void 0!==e?e:i.c.portal.user,i.c.portal)}/createFolder`;return await(0,r.r)(s,{title:t},{},"post")}async function v(t,n,e){var s;const o=`${u(null!==(s=null!=e?e:i.c.user)&&void 0!==s?s:i.c.portal.user,i.c.portal)}/${t}/updateFolder`;try{return{result:await(0,r.r)(o,{newTitle:n},{},"post")}}catch(t){return{error:{code:"unhandledError"}}}}}}]);