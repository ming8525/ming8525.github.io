/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-39480b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-39480b"],{31913:(e,i,t)=>{t.r(i),t.d(i,{arcgis_smart_mapping_color_slider:()=>m});var s=t(81149),o=t(9225),l=t(95129),a=t(5996),r=(t(69283),t(41267)),n=(t(49306),t(74537)),d=t(25902),u=t(21747),h=t(98371);t(51837),t(42577),t(82218),t(70464),t(10519);const m=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingColorSliderChange=(0,s.c)(this,"arcgisSmartMappingColorSliderChange",7),this.arcgisSmartMappingColorSliderError=(0,s.c)(this,"arcgisSmartMappingColorSliderError",7),this.currentStopValues=[],this.currentBreakValues=[],this.zigzagClick=!1,this.styleSheetStatus="not-loaded",this.histogramStatus=o.b.MISSING,this.statisticsStatus=o.b.MISSING,this.sliderZoomed=!1,this.cap=void 0}async updateStatistics(){var e;this.statisticsStatus=o.b.MISSING,this.statistics=null,this.histogramStatus=o.b.MISSING,this.histogram=null,null===(e=this.colorSlider)||void 0===e||e.destroy(),this.colorSlider=void 0,this.sliderZoomed=!1,this.getStatistics()}componentWillLoad(){this.getStatistics()}componentDidLoad(){this.flowItemNode=(0,o.F)(this.hostElement,"calcite-flow-item")}render(){const{config:e}=o.s;return(0,s.h)(s.H,null,(0,s.h)("link",{rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.hostElement)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.hostElement)}}),"loaded"===this.styleSheetStatus?this.renderColorSlider():"not-loaded"===this.styleSheetStatus?this.renderColorSliderLoading():null)}renderColorSlider(){const{statisticsStatus:e,histogramStatus:i,sliderZoomed:t}=this,{layer:l,strings:a}=o.s,r=(0,o.h)(l),n=(0,o.a)(r,"color");if(!(e===o.b.FAILED||e===o.b.MISSING||n&&1===n.stops.length||!n&&1===r.classBreakInfos.length)){if(e===o.b.IN_PROGRESS||i===o.b.IN_PROGRESS&&!this.colorSlider)return this.renderColorSliderLoading();{const e=this.prepareColorSlider();let i=!1;if(n&&!t){const e=(0,o.p)(r,"color"),t=(0,o.aC)(n.stops,null==e?void 0:e.minSliderValue,null==e?void 0:e.maxSliderValue);((null==t?void 0:t.minMaxSame)||!(0,o.ac)(null==t?void 0:t.min)&&!(0,o.ac)(null==t?void 0:t.max))&&(i=!0,this.zoomButtonNode&&(this.zoomButtonNode.disabled=!0))}return n?this.currentStopValues=n.stops.map((e=>e.value)):this.currentBreakValues=r.classBreakInfos.map((e=>({min:e.minValue,max:e.maxValue}))),e||this.colorSlider?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,a.panels.color.dataRange),(0,s.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),n&&(0,s.h)(s.F,null,(0,s.h)("div",null," "),this.renderZoomButton(i),(0,s.h)("div",null," "),this.renderResetButton())),(0,s.h)("div",{ref:e=>{e&&this.afterColorSliderCreate(e)}})):this.renderColorSliderLoading()}}this.colorSlider&&(this.colorSlider.destroy(),this.colorSlider=void 0)}renderColorSliderLoading(){const{strings:e}=o.s;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=o.s;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.color.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderZoomButton(e){const{strings:i}=o.s,{sliderZoomed:t}=this;return(0,s.h)("arcgis-smart-mapping-action",{text:i.panels.color.zoomSlider,icon:t?"magnifyingGlassMinus":"magnifyingGlassPlus",disabled:e,onClick:()=>this.handleZoomSlider(),ref:e=>this.zoomButtonNode=e})}renderResetButton(){const{strings:e}=o.s;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.color.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareColorSlider(){var e,i;const{statistics:t,histogram:s,histogramStatus:a,sliderZoomed:u}=this,{layer:h,mapView:m,modules:c}=o.s,p=(0,o.h)(h),g=(0,o.g)(),S=["color-age","color-age-size"].indexOf(g)>-1,f=this.getFieldInfo().simpleFieldType===o.w.DATE,x=(0,o.a)(p,"color"),b=(0,o.p)(p,"color");let v,V,C;if(b?(v=(0,o.aD)(b.theme,x.stops),V=b.minSliderValue,C=b.maxSliderValue):(V=p.classBreakInfos[0].minValue,C=p.classBreakInfos[p.classBreakInfos.length-1].maxValue),({min:V,max:C}=(0,o.ad)({min:V,max:C})),a===o.b.IN_PROGRESS)return!1;if(!this.colorSlider||x&&this.colorSlider.breaks||!x&&this.colorSlider.stops){null===(e=this.colorSlider)||void 0===e||e.destroy(),this.colorSliderBars=[];let i={histogramConfig:{bins:null==s?void 0:s.bins,average:Math.round(10*t.avg)/10,standardDeviation:t.stddev,standardDeviationCount:1},min:null!=V?V:t.min,max:null!=C?C:t.max};x?(i=Object.assign(Object.assign({},i),v),f&&!S&&(i.hasTimeData=!0,(0,l.a)(i,m.timeZone)),i.stops=x.stops,i.precision=(0,r.g)(x.stops),i.histogramConfig.barCreatedFunction=s&&n.b.bind(this,x,s,this.colorSliderBars),this.colorSlider=new c.ColorSlider(i)):(i.histogramConfig.min=p.classBreakInfos[0].minValue,i.histogramConfig.max=p.classBreakInfos[p.classBreakInfos.length-1].maxValue,this.sliderZoomed=!1,i.breaks=(0,d.g)(),i.precision=(0,r.g)(i.breaks),i.histogramConfig.barCreatedFunction=s&&n.b.bind(this,i.breaks,s,this.colorSliderBars),this.colorSlider=new c.ClassedColorSlider(i),(0,n.u)(this.colorSlider,this.colorSliderBars,i.breaks,s)),this.createColorSliderChangeEvents()}else{const e=this.colorSlider;if("dragging"===(null===(i=e.slider)||void 0===i?void 0:i.state))return!0;let a={histogramConfig:{bins:null==s?void 0:s.bins,average:Math.round(10*t.avg)/10,standardDeviation:t.stddev,standardDeviationCount:1},min:null!=V?V:t.min,max:null!=C?C:t.max};x?(a=Object.assign(Object.assign({},a),v),a.stops=x.stops,a.precision=(0,r.g)(x.stops),a.hasTimeData=f&&!S,f&&!S&&(0,l.a)(a,m.timeZone),u?this.zigzagClick||(a.zoomOptions=(0,o.aC)(x.stops,null==b?void 0:b.minSliderValue,null==b?void 0:b.maxSliderValue)):a.zoomOptions=null,a.histogramConfig.barCreatedFunction=s&&n.b.bind(this,x,s,this.colorSliderBars),(0,n.u)(e,this.colorSliderBars,x,s)):(a.breaks=(0,d.g)(),a.precision=(0,r.g)(a.breaks),a.histogramConfig.barCreatedFunction=s&&n.b.bind(this,a.breaks,s,this.colorSliderBars),(0,n.u)(e,this.colorSliderBars,a.breaks,s)),this.sliderZoomed&&this.adjustedZoomOptions&&!this.zigzagClick&&(a.zoomOptions=this.adjustedZoomOptions,"min"===this.zoomAdjustment?(this.colorSlider.slider.min=a.zoomOptions.min,a.zoomOptions.min=null):(this.colorSlider.slider.max=a.zoomOptions.max,a.zoomOptions.max=null)),this.adjustedZoomOptions=null,this.zoomAdjustment=null,this.colorSlider.set(a),this.zigzagClick=!1}return(0,o.ac)(this.colorSlider)}handleInvertSlider(){const{layer:e,modules:i}=o.s,t=(0,o.h)(e),l=(0,o.a)(t,"color");if((0,n.u)(this.colorSlider,this.colorSliderBars,l||(0,d.g)(),this.histogram),l){let e=l.stops.map((e=>e.color));e=e.reverse(),l.stops.forEach(((i,t)=>{i.color=e[t]}))}else{let e=t.classBreakInfos.map((e=>(0,o.t)(e.symbol)||new i.esriColor({r:64,g:64,b:64,a:1})));e=e.reverse(),t.classBreakInfos.map(((i,t)=>{(0,o.t)(i.symbol)&&(0,o.r)(i.symbol,e[t])}))}(0,o.ab)(),(0,s.f)(this.hostElement),this.arcgisSmartMappingColorSliderChange.emit()}handleZoomSlider(e){var i,t,s,l;if(this.cap=this.colorSlider.slider.max,this.histogramStatus===o.b.IN_PROGRESS)return;const{statistics:a}=this,{layer:r}=o.s,n=(0,o.h)(r);this.sliderZoomed=(0,o.ac)(e)?e:!this.sliderZoomed;const d=(0,o.a)(n,"color");d||(this.sliderZoomed=!1);const u=(0,o.p)(n,"color"),h=this.sliderZoomed?(0,o.aC)(d.stops,null!==(i=null==u?void 0:u.minSliderValue)&&void 0!==i?i:a.min,null!==(t=null==u?void 0:u.maxSliderValue)&&void 0!==t?t:a.max):null;this.getHistogram({field:d.field,expression:d.valueExpression,expressionTitle:d.valueExpressionTitle,simpleFieldType:o.w.NUMBER},d.normalizationField,a,h&&h.min||(null!==(s=null==u?void 0:u.minSliderValue)&&void 0!==s?s:a.min),h&&h.max||(null!==(l=null==u?void 0:u.maxSliderValue)&&void 0!==l?l:a.max))}handleResetSlider(){const{layer:e}=o.s,i=(0,o.h)(e),t=(0,o.g)();this.sliderZoomed=!1;let s=(0,o.a)(i,"color");const l=(0,o.p)(i,"color"),r=null==l?void 0:l.theme,n=this.getFieldInfo(),m=s?s.normalizationField:i.normalizationField;let c;"color"===t?c=d.b:"color-age"===t?(n.field=l.field,c=d.d):"color-age-size"===t?(n.field=l.field,c=h.h):"color-size-age"===t?c=h.i:"color-size"===t?c=h.j:"compare"===t&&(c=u.a),(0,a.r)(c({fieldInfos:(0,o.f)(e),normalizationField:m,noReuse:!0,theme:r,discardMinMax:!0},"color"),this.flowItemNode).then((e=>{var i;if(0===(null===(i=e.statistics)||void 0===i?void 0:i.count)){const[i,t]=this.getDefaultDataRange(n),s=(null==l?void 0:l.minSliderValue)||i,a=(null==l?void 0:l.maxSliderValue)||t;e.statistics.min=s,e.statistics.max=a,e.statistics.avg=(a+s)/2,this.statistics=e.statistics,this.statisticsStatus=o.b.SUCCESS}else e.statistics&&(0,o.ac)(e.statistics.min)&&(0,o.ac)(e.statistics.max)&&e.statistics.min<=e.statistics.max?(this.statistics=e.statistics,this.statisticsStatus=o.b.SUCCESS,this.getHistogram(n,m,e.statistics,e.statistics.min,e.statistics.max)):this.statisticsStatus=o.b.FAILED;l.minSliderValue=this.statistics.min,l.maxSliderValue=this.statistics.max,(0,o.ab)()}),(e=>this.arcgisSmartMappingColorSliderError.emit(e)))}afterColorSliderCreate(e){if(!this.colorSlider.container){const i=document.createElement("div");e.append(i),this.colorSlider.container=i}}getStatistics(){var e;const{layer:i,mapView:t,modules:s}=o.s,l=i,a=(0,o.h)(l);let r,n;const d=this.getFieldInfo(),u=(0,o.a)(a,"color"),h=u?u.normalizationField:a.normalizationField,m=(0,o.p)(a,"color")||{};r=m.minSliderValue,n=m.maxSliderValue;const c=a.authoringInfo;if("equal-interval"===(null==c?void 0:c.classificationMethod)){const e=a.classBreakInfos;r=e[0].minValue,n=e[e.length-1].maxValue}this.statisticsStatus=o.b.IN_PROGRESS,this.statistics||s.summaryStatistics({layer:l,view:t,field:d.field,valueExpression:d.expression,normalizationField:h,forBinning:"featureReduction"in l&&"binning"===(null===(e=l.featureReduction)||void 0===e?void 0:e.type)}).then((e=>{if(0===e.count){const[i,t]=this.getDefaultDataRange(d),s=m.minSliderValue||i,l=m.maxSliderValue||t;e.min=s,e.max=l,e.avg=(l+s)/2,(0,o.ac)(m.minSliderValue)||(m.minSliderValue=s,m.maxSliderValue=l)}else if(!(0,o.ac)(e.avg)||!(0,o.ac)(e.min)||!(0,o.ac)(e.max))return void(this.statisticsStatus=o.b.FAILED);e=(0,o.ad)(e),r=null!=r?r:e.min,n=null!=n?n:e.max,this.statistics=e,this.statisticsStatus=o.b.SUCCESS,this.getHistogram(d,h,e,r,n)}),(e=>{console.log(e),this.statisticsStatus=o.b.FAILED}))}getHistogram(e,i,t,s,l){var a;const{layer:r,mapView:n,modules:d}=o.s,u=r;(t=t||this.statistics)&&0!==t.count&&(this.histogramStatus=o.b.IN_PROGRESS,d.histogram({layer:u,view:n,field:e.field,valueExpression:e.expression,numBins:50,minValue:(0,o.ac)(s)?s:t.min,maxValue:(0,o.ac)(l)?l:t.max,normalizationField:i,forBinning:"featureReduction"in u&&"binning"===(null===(a=u.featureReduction)||void 0===a?void 0:a.type)}).then((e=>{this.histogram=e,this.histogramStatus=o.b.SUCCESS}),(e=>{console.log(e),this.histogramStatus=o.b.FAILED})))}onMinMaxChange(e,i,t){const{statistics:s}=this,{layer:l}=o.s,a=(0,o.h)(l),r=(0,o.a)(a,"color"),u=(0,o.p)(a,"color")||{};if(!r){let t=a.classBreakInfos[0],s=a.classBreakInfos[a.classBreakInfos.length-1];t.minValue=e,t.label=t.minValue.toLocaleString()+" - "+t.maxValue.toLocaleString(),s.maxValue=i,s.label="> "+s.minValue.toLocaleString()+" - "+s.maxValue.toLocaleString()}"min"===t?u.minSliderValue=e:u.maxSliderValue=i;const h=(0,o.aC)(null==r?void 0:r.stops,u.minSliderValue,u.maxSliderValue);this.zoomButtonNode&&(this.sliderZoomed?this.zoomButtonNode.disabled=!1:!h||h.minMaxSame||!(0,o.ac)(h.min)&&!(0,o.ac)(h.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1),this.sliderZoomed&&(this.adjustedZoomOptions=this.colorSlider.zoomOptions,"min"===t?(this.adjustedZoomOptions.min=e,this.zoomAdjustment="min"):(this.adjustedZoomOptions.max=i,this.zoomAdjustment="max"));const m=this.getFieldInfo(),c=r?r.normalizationField:a.normalizationField;this.getHistogram(m,c,s,e,i),(0,n.u)(this.colorSlider,this.colorSliderBars,r||(0,d.g)(),this.histogram),e===u.minSliderValue&&i===u.maxSliderValue&&(this.sliderZoomed=!1),a.authoringInfo.classificationMethod="manual",this.arcgisSmartMappingColorSliderChange.emit()}createColorSliderChangeEvents(){const{layer:e}=o.s,i=(0,o.h)(e),t=(0,o.a)(i,"color");this.colorSlider&&(this.colorSlider.watch("zoomOptions",((e,i)=>{this.sliderZoomed&&((null==i?void 0:i.min)&&!(null==e?void 0:e.min)||(null==i?void 0:i.max)&&!(null==e?void 0:e.max))&&(this.zigzagClick=!0,this.handleZigzagClick(e))})),this.colorSlider.on("min-change",(e=>{t?e.value>this.currentStopValues[0]?(this.colorSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.currentStopValues[0],this.colorSlider.slider.max,"min")):this.onMinMaxChange(e.value,this.colorSlider.slider.max,"min"):e.value>this.currentBreakValues[0].max?this.onMinMaxChange(this.currentBreakValues[0].max,this.colorSlider.slider.max,"min"):this.onMinMaxChange(e.value,this.colorSlider.slider.max,"min")})),this.colorSlider.on("max-change",(e=>{t?e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.colorSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.colorSlider.slider.min,this.currentStopValues[this.currentStopValues.length-1],"max")):this.onMinMaxChange(this.colorSlider.slider.min,e.value,"max"):e.value<this.currentBreakValues[this.currentBreakValues.length-1].min?this.onMinMaxChange(this.colorSlider.slider.min,this.currentBreakValues[this.currentBreakValues.length-1].min,"max"):this.onMinMaxChange(this.colorSlider.slider.min,e.value,"max")})),this.colorSlider.on("thumb-change",(e=>{if(t){const i=this.getFieldInfo();if((0,o.aH)(i)&&0===e.value)return void(0,s.f)(this.hostElement);const t=this.colorSlider.stops;this.updateRendererStops(t)}else this.updateRendererBreaks(this.colorSlider.breaks);this.arcgisSmartMappingColorSliderChange.emit()})),this.colorSlider.on("thumb-drag",(()=>{if(t){const e=this.colorSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.colorSlider.breaks);this.arcgisSmartMappingColorSliderChange.emit()})),this.colorSlider.on("segment-drag",(()=>{if(t){const e=this.colorSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.colorSlider.breaks);this.arcgisSmartMappingColorSliderChange.emit()})))}updateRendererStops(e){const{layer:i}=o.s,t=(0,o.h)(i),s=(0,o.a)(t,"color"),l=(0,o.p)(t,"color");s.stops=e,this.currentStopValues=s.stops.map((e=>e.value));const a=(0,o.aC)(null==s?void 0:s.stops,null==l?void 0:l.minSliderValue,null==l?void 0:l.maxSliderValue);this.sliderZoomed?this.zoomButtonNode.disabled=!1:!a||a.minMaxSame||!(0,o.ac)(a.min)&&!(0,o.ac)(a.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1,(0,n.u)(this.colorSlider,this.colorSliderBars,s,this.histogram),(0,o.ab)()}updateRendererBreaks(e){const{layer:i}=o.s,t=(0,o.h)(i);t.authoringInfo.classificationMethod="manual",t.classBreakInfos.forEach(((i,t)=>{if(i.minValue!==e[t].min||i.maxValue!==e[t].max){i.minValue=e[t].min,i.maxValue=e[t].max;const s=t>0?"> ":"";i.label=`${s} ${i.minValue.toLocaleString()} - ${i.maxValue.toLocaleString()}`,this.currentBreakValues[t].min=e[t].min,this.currentBreakValues[t].max=e[t].max}})),(0,n.u)(this.colorSlider,this.colorSliderBars,(0,d.g)(),this.histogram),(0,o.ab)(),this.arcgisSmartMappingColorSliderChange.emit()}getDefaultDataRange(e){if(e.simpleFieldType===o.w.DATE){const e=(new Date).getFullYear();return[new Date(`1/1/${e}`).getTime(),new Date(`12/31/${e}`).getTime()]}return[0,100]}getFieldInfo(){const{layer:e}=o.s,i=(0,o.h)(e),t=(0,o.a)(i,"color"),s=(0,o.u)(t?t.field:i.field);return{field:(null==t?void 0:t.field)||i.field,expression:(null==t?void 0:t.valueExpression)||i.valueExpression,expressionTitle:(null==t?void 0:t.valueExpressionTitle)||i.valueExpressionTitle,simpleFieldType:s?s.simpleFieldType:o.w.NUMBER}}handleZigzagClick(e){var i,t;const{statistics:s}=this,{layer:l}=o.s,a=(0,o.h)(l),r=(0,o.a)(a,"color"),n=(0,o.p)(a,"color"),d=this.getFieldInfo(),u=r?r.normalizationField:a.normalizationField;this.getHistogram(d,u,s,null!==(i=null==e?void 0:e.min)&&void 0!==i?i:n.minSliderValue,null!==(t=null==e?void 0:e.max)&&void 0!==t?t:n.maxSliderValue),e||(this.sliderZoomed=!1)}get hostElement(){return(0,s.d)(this)}};m.style=".slider-box{height:320px}.slider-box .esri-color-slider,.slider-box .esri-classed-color-slider{min-width:200px}.slider-box .esri-color-slider .esri-slider .esri-slider__content,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__content{height:175px}.slider-box .esri-color-slider__histogram-container,.slider-box .esri-classed-color-slider__histogram-container{width:85px}.slider-box .esri-color-slider .esri-slider .esri-slider__label,.slider-box .esri-color-slider .esri-slider .esri-slider__min,.slider-box .esri-color-slider .esri-slider .esri-slider__max,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__label,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__min,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.slider-box .esri-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__max:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-classed-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-box-buttons-front{display:flex}"},21747:(e,i,t)=>{t.d(i,{a:()=>a,c:()=>l});var s=t(9225),o=(t(69283),t(10519));function l(e){var i;const{layer:t,mapImageSublayer:l,mapView:a,modules:r}=s.s,n=t;e=e||{};const d=(0,s.m)((0,s.h)(n));return r.ColorCreator.createContinuousRenderer({layer:n,view:a,field:e.fieldInfos[0].field,theme:"above-and-below",colorScheme:(0,s.P)("above-and-below"),normalizationField:e.fieldInfos[1].field,outlineOptimizationEnabled:!l&&((0,o.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:(0,s.q)(n)),sizeOptimizationEnabled:!l&&(!(0,o.i)(e.sizeOptimizationEnabled)||e.sizeOptimizationEnabled),legendOptions:e.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===(null===(i=n.featureReduction)||void 0===i?void 0:i.type)}).then((e=>(((0,s.p)(e.renderer,"color")||{}).style="ratio",(0,s.l)(d,e.renderer),Promise.resolve(e))),(e=>Promise.reject(e)))}function a(e){var i,t,l,a;const{layer:r,mapImageSublayer:n,mapView:d,modules:u}=s.s,h=r;e=e||{};const m=(0,s.h)(h),c=(0,s.a)(m,"color");if(c&&e.fieldInfo&&e.fieldInfo.field==c.field&&e.normalizationField===c.normalizationField&&(delete e.fieldInfos,(0,s.R)(e)))return Promise.resolve({renderer:m.clone()});const p=(0,s.p)(m,"color"),g=(0,s.m)(m);let S=e.fieldInfos?e.fieldInfos[0]:c?{field:c.field,expression:c.valueExpression,expressionTitle:c.valueExpressionTitle,simpleFieldType:s.w.NUMBER}:{field:m.field,expression:m.valueExpression,expressionTitle:m.valueExpressionTitle,simpleFieldType:s.w.NUMBER};const f=e.normalizationField?e.normalizationField:c?c.normalizationField:m.normalizationField,x=m.classBreakInfos&&m.classBreakInfos.length?m.classBreakInfos[0].symbol:null,b=m.defaultSymbol,v=m.defaultLabel;let V=!1;(null===e.normalizationField||e.normalizationField||e.fieldInfo)&&(V=!0);const C=e.discardMinMax?void 0:(0,o.i)(e.min)?e.min:V?void 0:p?p.minSliderValue:m.classBreakInfos[0].minValue,z=e.discardMinMax?void 0:(0,o.i)(e.max)?e.max:V?void 0:p?p.maxSliderValue:m.classBreakInfos[m.classBreakInfos.length-1].maxValue;return u.ColorCreator.createContinuousRenderer({layer:h,view:d,field:S?S.field:m.field,theme:"above-and-below",colorScheme:(0,s.P)("above-and-below"),normalizationField:f,minValue:C,maxValue:z,outlineOptimizationEnabled:!n&&((0,o.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!!g.sizeOutlineVisVar),sizeOptimizationEnabled:!n&&((0,o.i)(e.sizeOptimizationEnabled)?e.sizeOptimizationEnabled:!!g.sizeAutoVisVar),legendOptions:(null===(i=e.legendOptions)||void 0===i?void 0:i.toJSON())||(null===(t=null==c?void 0:c.legendOptions)||void 0===t?void 0:t.toJSON())||(null===(l=m.legendOptions)||void 0===l?void 0:l.toJSON()),defaultSymbolEnabled:(0,o.i)(e.defaultSymbolEnabled)?e.defaultSymbolEnabled:!!m.defaultSymbol,forBinning:"binning"===(null===(a=h.featureReduction)||void 0===a?void 0:a.type)}).then((i=>{if(e.discardMinMax){const e=(0,s.a)(m,"color"),t=(0,s.a)(i.renderer,"color");e.stops.forEach(((e,i)=>e.value=t.stops[i].value))}return((0,s.p)(i.renderer,"color")||{}).style="ratio",(0,s.l)(g,i.renderer),x&&i.renderer.classBreakInfos&&i.renderer.classBreakInfos.length&&(i.renderer.classBreakInfos[0].symbol=x),b&&(i.renderer.defaultSymbol=b,i.renderer.defaultLabel=v),Promise.resolve(i)}),(e=>Promise.reject(e)))}},95129:(e,i,t)=>{t.d(i,{a:()=>o,b:()=>a,d:()=>r,u:()=>l});var s=t(9225);function o(e,i){e.labelFormatFunction=e=>n(e,i,"short-date"),e.inputFormatFunction=e=>n(e,i,"short-date"),e.inputParseFunction=e=>function(e,i){if(!e)return e;let t;if(i&&"system"!==i)if("unknown"===i)t=e;else{const s=new Date;t=e+(new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime())}else t=e+6e4*(new Date).getTimezoneOffset();return console.log("mapTZToUTC",e," - ",new Date(e).toISOString()," - ",new Date(t).toISOString()),t}(Date.parse(e),i)}function l(e,i){let t;if(i&&"system"!==i)if("unknown"===i)t=new Date(e).toISOString();else{const s=(new Date).getTimezoneOffset(),o=new Date(e).toLocaleString("en-US",{timeZone:i});t=new Date(new Date(o).getTime()-6e4*s).toISOString()}else{const i=(new Date).getTimezoneOffset();t=new Date(e-6e4*i).toISOString()}return t}function a(e,i,t){let s;if(i&&"system"!==i)if("unknown"===i)s=new Date(e).toISOString();else{const t=(new Date).getTimezoneOffset(),o=new Date(e).toLocaleString("en-US",{timeZone:i});s=new Date(new Date(o).getTime()-6e4*t).toISOString()}else{const i=(new Date).getTimezoneOffset();s=new Date(e-6e4*i).toISOString()}return s=t?s.substring(11,19):s.substring(11,16),s}function r(e,i){let t,s=new Date(e);if(s=new Date(s.getTime()-6e4*s.getTimezoneOffset()),i&&"system"!==i)if("unknown"===i)t=s.getTime();else{const e=new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime();t=s.getTime()+e}else t=s.getTime()+6e4*s.getTimezoneOffset();return t}function n(e,i,t){const{modules:o}=s.s;let l;return l="unknown"===i?o.intl.formatDate(e,Object.assign(Object.assign({},o.intl.convertDateFormatToIntlOptions(t||"short-date-short-time")),{timeZone:"utc",timeZoneName:"shortOffset"})):o.intl.formatDate(e,Object.assign(Object.assign({},o.intl.convertDateFormatToIntlOptions(t||"short-date-short-time")),{timeZone:i})),l}t(69283),t(49306)},5996:(e,i,t)=>{let s,o;function l(e){e.loading=!1}function a(e,i){return function(e){e.loading=!0,o=!1,s&&clearTimeout(s),s=setTimeout((()=>{l(e),o=!0}),6e4)}(i),e.then((e=>(l(i),o?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(l(i),Promise.reject(e))))}t.d(i,{r:()=>a})},41267:(e,i,t)=>{t.d(i,{a:()=>r,b:()=>a,g:()=>h,u:()=>l});var s=t(9225),o=(t(69283),t(10519));function l(e){const{layer:i,modules:t}=s.s,l=(0,s.h)(i),a=t.esriLang.clone(l.classBreakInfos);l.classBreakInfos=[],a.forEach(((i,t)=>{i=function(e,i,t,l){if((0,o.i)(i))if(0===i);else if(i<1){const o=Math.round(1/i);e.minValue="first"===l?Math.floor(e.minValue/i)/o:Math.round(e.minValue/i)/o,e.maxValue="last"===l?Math.ceil(e.maxValue/i)/o:Math.round(e.maxValue/i)/o,e.label=`${t>0?"> ":""}${e.minValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})}`}else e.minValue="first"===l?Math.floor(e.minValue/i)*i:Math.round(e.minValue/i)*i,e.maxValue="last"===l?Math.ceil(e.maxValue/i)*i:Math.round(e.maxValue/i)*i,e.label=(t>0?"> ":"")+e.minValue.toLocaleString()+" - "+e.maxValue.toLocaleString();return e}(i,e,t,0===t?"first":t===a.length-1?"last":void 0),l.addClassBreakInfo({minValue:i.minValue,maxValue:i.maxValue,symbol:i.symbol,label:i.label})}))}function a(e){const{layer:i}=s.s,t=(0,s.h)(i).classBreakInfos;let o=e,l=1/0;t.forEach((e=>{o||(o=Math.max(n(e.minValue),n(e.maxValue))),l=Math.min(l,e.maxValue-e.minValue)}));const a=[];return l>1e7?(a.push(1e7),a.push(1e6),a.push(1e5),a.push(1e4),a.push(1e3),a.push(100),a.push(10),o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01)):l>1e6?(a.push(1e6),a.push(1e5),a.push(1e4),a.push(1e3),a.push(100),a.push(10),o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01)):l>1e5?(a.push(1e5),a.push(1e4),a.push(1e3),a.push(100),a.push(10),o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01)):l>1e4?(a.push(1e4),a.push(1e3),a.push(100),a.push(10),o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01)):l>1e3?(a.push(1e3),a.push(100),a.push(10),o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01),o>3&&a.push(.001)):l>100?(a.push(100),a.push(10),o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01),o>3&&a.push(.001),o>4&&a.push(1e-4),o>5&&a.push(1e-5)):l>10?(a.push(10),o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01),o>3&&a.push(.001),o>4&&a.push(1e-4),o>5&&a.push(1e-5),o>6&&a.push(1e-6)):l>1?(o>0&&a.push(1),o>1&&a.push(.1),o>2&&a.push(.01),o>3&&a.push(.001),o>4&&a.push(1e-4),o>5&&a.push(1e-5),o>6&&a.push(1e-6)):l>.1?(o>1&&a.push(.1),o>2&&a.push(.01),o>3&&a.push(.001),o>4&&a.push(1e-4),o>5&&a.push(1e-5),o>6&&a.push(1e-6)):l>.01?(o>2&&a.push(.01),o>3&&a.push(.001),o>4&&a.push(1e-4),o>5&&a.push(1e-5),o>6&&a.push(1e-6)):l>.001?(o>3&&a.push(.001),o>4&&a.push(1e-4),o>5&&a.push(1e-5),o>6&&a.push(1e-6),o>7&&a.push(1e-7)):l>1e-4?(o>4&&a.push(1e-4),o>5&&a.push(1e-5),o>6&&a.push(1e-6),o>7&&a.push(1e-7),o>8&&a.push(1e-8)):l>1e-5&&(o>5&&a.push(1e-5),o>6&&a.push(1e-6),o>7&&a.push(1e-7),o>8&&a.push(1e-8),o>9&&a.push(1e-9)),a}function r(){const{layer:e}=s.s,i=(0,s.h)(e);let t=1e10;return i.classBreakInfos.forEach((e=>{t=Math.min(t,d(e.minValue)),t=Math.min(t,d(e.maxValue))})),t}function n(e){let i=1;for(;Math.round(e*i)/i!==e;)i*=10;return Math.log(i)/Math.LN10}function d(e){let i=1e-8;for(;u(Math.round(e/i)*i)===e;)i*=10;return i/10}function u(e){return parseFloat(e.toPrecision(12))}function h(e){var i,t,s,l,a,r,d,h;let m=0;e.forEach((e=>{(0,o.i)(e.value)?m=Math.max(n(u(e.value)),m):((0,o.i)(e.minValue)&&(m=Math.max(n(u(e.minValue)),m)),(0,o.i)(e.maxValue)&&(m=Math.max(n(u(e.maxValue)),m)),(0,o.i)(e.min)&&(m=Math.max(n(u(e.min)),m)),(0,o.i)(e.max)&&(m=Math.max(n(u(e.max)),m)))})),m=Math.min(m,3);const c=e[0],p=e[e.length-1],g=Math.min(null!==(t=null!==(i=c.minValue)&&void 0!==i?i:c.min)&&void 0!==t?t:c.value,null!==(l=null!==(s=p.minValue)&&void 0!==s?s:p.min)&&void 0!==l?l:p.value),S=Math.max(null!==(r=null!==(a=c.maxValue)&&void 0!==a?a:c.max)&&void 0!==r?r:c.value,null!==(h=null!==(d=p.maxValue)&&void 0!==d?d:p.max)&&void 0!==h?h:p.value)-g;return S/e.length<2e-7?m=8:S/e.length<2e-6?m=7:S/e.length<2e-5?m=6:S/e.length<2e-4?m=5:S/e.length<.002?m=4:S/e.length<.02?m=3:S/e.length<.2?m=Math.max(m,2):S/e.length<2&&(m=Math.max(m,1)),Math.round(m)}},74537:(e,i,t)=>{t.d(i,{b:()=>o,u:()=>l});var s=t(9225);function o(e,i,t,s,o){const l=(null==e?void 0:e.length)?r(e,i.bins[s]):a(e.stops,i.bins[s]);l&&o.setAttribute("fill",l.toHex()),l&&o.setAttribute("opacity",`${Math.max(l.a,.2)}`),t.push(o)}function l(e,i,t,s){null==i||i.forEach(((i,o)=>{const l=(s||e.histogramConfig).bins[o],n=e.breaks?r(t||e.breaks,l):a((t||e).stops,l);n&&i.setAttribute("fill",n.toHex()),n&&i.setAttribute("opacity",`${Math.max(n.a,.2)}`)}))}function a(e,i){const{modules:t}=s.s;if(!i)return;const o=(i.maxValue-i.minValue)/2+i.minValue;let l=e[0],a=e[e.length-1];const r=l.value,n=a.value;if(o<r)return l.color;if(o>n)return a.color;const d=e.filter((e=>e.value===o));if(d.length>0)return d[0].color;l=null,a=null,e.forEach(((i,t)=>{!l&&!a&&i.value>=o&&(l=e[t-1],a=i)}));const u=(o-l.value)/(a.value-l.value);return t.esriColor.blendColors(l.color,a.color,u)}function r(e,i){if(!i)return;const t=(i.maxValue-i.minValue)/2+i.minValue;let s=e[0],o=e[e.length-1];if(t<s.min||t>o.max)return;const l=e.filter((e=>e.min===t));return l.length>0?l[0].color:(s=e[e.length-1],o=null,e.forEach(((i,l)=>{!o&&i.min>=t&&(s=e[l-1],o=i)})),s.color)}t(69283),t(49306)}}]);