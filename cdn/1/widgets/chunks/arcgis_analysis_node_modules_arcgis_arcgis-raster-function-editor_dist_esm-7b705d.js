"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_dist_esm-7b705d"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/popover-utils-725493d7.js":
/*!**********************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/popover-utils-725493d7.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createNodeInteractionPopover),
/* harmony export */   r: () => (/* binding */ removeOpenableDomElement),
/* harmony export */   s: () => (/* binding */ showHelp)
/* harmony export */ });
/**
 * @param {OpenableHtmlElement | undefined} element the element to close and remove
 */
function removeOpenableDomElement(element) {
    if (element !== undefined) {
        element.open = false;
        element.remove();
    }
}
/**
 * @param {Document} document used to append
 * @param {OpenableHtmlElement} element the element to add to the dom and open
 */
/**
 *
 * @param document
 * @param element
 */
function addOpenableDomElement(document, element) {
    if (document.body.contains(element) === false) {
        document.body.appendChild(element);
        element.open = true;
    }
}
/**
 * creates  help popover component.
 * @param CreateHelpPopoverParams
 * @param {CreateHelpPopoverParams} params  parameters for creating help popover
 * @returns HTMLRfxHelpPopoverElement
 */
function createHelpPopover(params) {
    const { helpUrl, helpId, heading, referenceElement, portal, helpSrcdoc, learnMoreUrl, placement, offsetDistance, offsetSkidding } = params;
    const popover = document.createElement("rfx-help-popover");
    popover.helpUrl = helpUrl;
    popover.helpId = helpId;
    popover.heading = heading;
    popover.referenceElement = referenceElement;
    popover.placement = placement ?? "leading-start";
    popover.portal = portal;
    popover.helpSrcdoc = helpSrcdoc;
    popover.learnMoreUrl = learnMoreUrl;
    if (offsetDistance !== undefined) {
        popover.offsetDistance = offsetDistance;
    }
    if (offsetSkidding !== undefined) {
        popover.offsetSkidding = offsetSkidding;
    }
    return popover;
}
/**
 *  show help popover for helpId
 *  @param {HTMLRfxHelpPopoverElement} toolHelpPopover
 *  @param {CreateHelpPopoverParams} params needed parameters for help
 *  @returns {HTMLRfxHelpPopoverElement}  helpPopover instance
 */
function showHelp(toolHelpPopover, params) {
    const { helpUrl, helpId, heading, referenceElement, portal, helpSrcdoc, helpFileName, learnMoreUrl, offsetDistance, offsetSkidding } = params;
    if (toolHelpPopover !== undefined) {
        removeOpenableDomElement(toolHelpPopover);
        toolHelpPopover = undefined;
    }
    toolHelpPopover = createHelpPopover({
        helpUrl,
        helpId,
        heading,
        referenceElement,
        portal,
        helpSrcdoc,
        helpFileName,
        learnMoreUrl,
        offsetDistance,
        offsetSkidding
    });
    addOpenableDomElement(document, toolHelpPopover);
    return toolHelpPopover;
}
/**
 * creates  Node Interaction popover component.
 * @param CreateNodeInteractionPopoverParams
 * @param {CreateNodeInteractionPopoverParams} params  parameters for creating node Interaction popover
 * @returns HTMLCalcitePopoverElement
 */
function createNodeInteractionPopover(popover, params) {
    const { referenceElement, label, direction, offsetDistance, offsetSkidding, showPropertiesAction, handleNodeDuplicate, handleNodeRename, handleNodeDelete, handleNodeEditProperties } = params;
    if (popover !== undefined) {
        removeOpenableDomElement(popover);
        popover = undefined;
    }
    popover = document.createElement("calcite-popover");
    const popoverProps = {
        overlayPositioning: "absolute",
        autoClose: true,
        dir: direction,
        focusTrapDisabled: true,
        triggerDisabled: true,
        pointerDisabled: true,
        placement: "top",
        closable: false,
        open: true,
        referenceElement: referenceElement,
        label: label,
        offsetDistance: offsetDistance,
        offsetSkidding: offsetSkidding
    };
    Object.assign(popover, popoverProps);
    const nodeInteractionToolbar = document.createElement("rfx-node-interaction-toolbar");
    const nodeInteractionToolbarProps = {
        showPropertiesAction,
        handleNodeDuplicate,
        handleNodeRename,
        handleNodeDelete,
        handleNodeEditProperties
    };
    Object.assign(nodeInteractionToolbar, nodeInteractionToolbarProps);
    popover.append(nodeInteractionToolbar);
    addOpenableDomElement(document, popover);
    return popover;
}



//# sourceMappingURL=popover-utils-725493d7.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-container.entry.js":
/*!*******************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/rfx-container.entry.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   rfx_container: () => (/* binding */ RFxContainer)
/* harmony export */ });
/* harmony import */ var _index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-da1b7138.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/index-da1b7138.js");
/* harmony import */ var _arcgis_core_core_lang_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @arcgis/core/core/lang.js */ "@arcgis/core/core/lang.js");
/* harmony import */ var _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui-utils-928a4096.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/ui-utils-928a4096.js");
/* harmony import */ var _arcgis_core_identity_IdentityManager_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @arcgis/core/identity/IdentityManager.js */ "@arcgis/core/identity/IdentityManager.js");
/* harmony import */ var _arcgis_core_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @arcgis/core/core/urlUtils.js */ "@arcgis/core/core/urlUtils.js");
/* harmony import */ var _arcgis_core_layers_Layer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @arcgis/core/layers/Layer.js */ "@arcgis/core/layers/Layer.js");
/* harmony import */ var _arcgis_core_layers_ImageryLayer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @arcgis/core/layers/ImageryLayer.js */ "@arcgis/core/layers/ImageryLayer.js");
/* harmony import */ var _arcgis_core_smartMapping_raster_renderers_stretch_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @arcgis/core/smartMapping/raster/renderers/stretch.js */ "@arcgis/core/smartMapping/raster/renderers/stretch.js");
/* harmony import */ var _arcgis_core_request_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @arcgis/core/request.js */ "@arcgis/core/request.js");
/* harmony import */ var _arcgis_core_rest_support_AlgorithmicColorRamp_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @arcgis/core/rest/support/AlgorithmicColorRamp.js */ "@arcgis/core/rest/support/AlgorithmicColorRamp.js");
/* harmony import */ var _arcgis_core_rest_support_MultipartColorRamp_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @arcgis/core/rest/support/MultipartColorRamp.js */ "@arcgis/core/rest/support/MultipartColorRamp.js");
/* harmony import */ var _arcgis_core_Color_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @arcgis/core/Color.js */ "@arcgis/core/Color.js");
/* harmony import */ var _colorRampUtils_8bdd46c5_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./colorRampUtils-8bdd46c5.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/colorRampUtils-8bdd46c5.js");
/* harmony import */ var _arcgis_core_rest_geoprocessor_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @arcgis/core/rest/geoprocessor.js */ "@arcgis/core/rest/geoprocessor.js");
/* harmony import */ var _arcgis_core_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @arcgis/core/portal/PortalItem.js */ "@arcgis/core/portal/PortalItem.js");
/* harmony import */ var _popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./popover-utils-725493d7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/popover-utils-725493d7.js");

















const RFxContainer = class {
    constructor(hostRef) {
        (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
        /**
         * Handles the change event of Analysis Help Popover close
         * @category Private
         */
        this.handleAnalysisHelpPopoverClose = () => {
            (0,_popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_15__.r)(this.toolHelpPopover);
        };
        /**
         * Handles the change event of Analysis RFx Help Popover
         * @param {CustomEvent} evt - The custom event object containing reference element, help source document, and heading.
         * @category Private
         */
        this.handleRFxHelpPopoverChange = (evt) => {
            evt.stopPropagation();
            const { referenceElement, helpSrcdoc, heading } = evt.detail;
            this.toolHelpPopover = (0,_popover_utils_725493d7_js__WEBPACK_IMPORTED_MODULE_15__.s)(this.toolHelpPopover, {
                helpId: "param.name",
                helpSrcdoc,
                heading,
                referenceElement,
                offsetDistance: 30
            });
            this.toolHelpPopover.addEventListener("rfxHelpPopoverClose", this.handleAnalysisHelpPopoverClose);
        };
        /**
         * called when the close button is clicked
         */
        this.handleClose = () => {
            this.panelMode = 0;
        };
        /**
         * called when the done button is clicked
         */
        this._handleDone = async () => {
            this.panelMode = 0;
            const rftJSON = await this.editorComponent.getUpdatedRFTWithValues();
            console.log("updated JSON..", rftJSON);
        };
        this.panelMode = 0;
        this.mapLayers = undefined;
        this.customRFT = undefined;
    }
    /**
     * Gets called  to show the function UI
     * @category Private
     */
    _renderFunctionUI() {
        return ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", null, (0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-analysis-wrapper", { ref: (el) => (this.editorComponent = el), functionName: this.functionName, mapLayers: this.mapLayers, usePanel: true, onAnalysisToolclose: this.handleClose, rfxTemplate: this.customRFT, onAnalysisUnsupportedFunction: () => {
                console.log("has unsupported function in this RFT, set showUnsupportedFunction as true in analysis-wrapper to see the function chain");
                this.handleClose();
            }, onAnalysisRFxHelpPopoverChange: this.handleRFxHelpPopoverChange }), this._renderDoneButton()));
    }
    /**
     * called to render the done button
     * @category private
     */
    _renderDoneButton() {
        return ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { alignment: "start", appearance: "solid", kind: "brand", scale: _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_2__.U.Scale, href: "", onClick: this._handleDone }, "done"));
    }
    /**
     * @category Lifecycle
     * Render lifecycle method
     */
    render() {
        return ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-flow-item", { id: "rfx-container", key: "rfx-container", heading: "Raster Functions" }, this.panelMode === 0 && ((0,_index_da1b7138_js__WEBPACK_IMPORTED_MODULE_0__.h)("rfx-list-view", { scale: _ui_utils_928a4096_js__WEBPACK_IMPORTED_MODULE_2__.C.m, onTriggerSelectFunction: (event) => {
                this.functionName = event.detail;
                this.panelMode = 1;
            } })), this.panelMode === 1 && this._renderFunctionUI()));
    }
};



//# sourceMappingURL=rfx-container.entry.js.map

/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/ui-utils-928a4096.js":
/*!*****************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/arcgis-raster-function-editor/dist/esm/ui-utils-928a4096.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CalciteScale),
/* harmony export */   U: () => (/* binding */ UIDefaults),
/* harmony export */   a: () => (/* binding */ CalciteOverlayPositioning)
/* harmony export */ });
const UIDefaults = {
    Scale: "s",
    PopoverTimer: 60
};
const CalciteScale = {
    s: "s",
    m: "m"
};
const CalciteOverlayPositioning = {
    absolute: "absolute",
    fixed: "fixed"
};



//# sourceMappingURL=ui-utils-928a4096.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3JfZGlzdF9lc20tN2I3MDVkLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0EsV0FBVyxpQ0FBaUM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsVUFBVTtBQUNyQixXQUFXLHFCQUFxQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLHlCQUF5QjtBQUNwQztBQUNBO0FBQ0E7QUFDQSxZQUFZLDBIQUEwSDtBQUN0STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkJBQTJCO0FBQ3ZDLFlBQVkseUJBQXlCO0FBQ3JDLGNBQWMsNEJBQTRCO0FBQzFDO0FBQ0E7QUFDQSxZQUFZLDZIQUE2SDtBQUN6STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxvQ0FBb0M7QUFDL0M7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4S0FBOEs7QUFDMUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTJGOztBQUUzRjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDekgrRDtBQUM1QjtBQUN5QztBQUMxQjtBQUNYO0FBQ0Q7QUFDTztBQUNrQjtBQUM5QjtBQUMwQjtBQUNGO0FBQzFCO0FBQ087QUFDSztBQUNBO0FBQ2dEOztBQUUzRjtBQUNBO0FBQ0EsUUFBUSxxREFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksOERBQXdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixhQUFhO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHdDQUF3QztBQUM1RCxtQ0FBbUMsOERBQVE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxREFBQyxjQUFjLHFEQUFDLDJCQUEyQjtBQUMzRDtBQUNBO0FBQ0EsYUFBYSxtRUFBbUU7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHFEQUFDLHFCQUFxQiwrREFBK0Qsb0RBQVUsNkNBQTZDO0FBQzVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixxREFBQyx3QkFBd0Isd0VBQXdFLDJCQUEyQixxREFBQyxvQkFBb0IsT0FBTyxvREFBWTtBQUNwTDtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7O0FBRXlDOztBQUV6Qzs7Ozs7Ozs7Ozs7Ozs7OztBQzdGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRThFOztBQUU5RSIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FyY2dpcy1yYXN0ZXItZnVuY3Rpb24tZWRpdG9yL2Rpc3QvZXNtL3BvcG92ZXItdXRpbHMtNzI1NDkzZDcuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXJjZ2lzLXJhc3Rlci1mdW5jdGlvbi1lZGl0b3IvZGlzdC9lc20vcmZ4LWNvbnRhaW5lci5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcmNnaXMtcmFzdGVyLWZ1bmN0aW9uLWVkaXRvci9kaXN0L2VzbS91aS11dGlscy05MjhhNDA5Ni5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBwYXJhbSB7T3BlbmFibGVIdG1sRWxlbWVudCB8IHVuZGVmaW5lZH0gZWxlbWVudCB0aGUgZWxlbWVudCB0byBjbG9zZSBhbmQgcmVtb3ZlXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZU9wZW5hYmxlRG9tRWxlbWVudChlbGVtZW50KSB7XG4gICAgaWYgKGVsZW1lbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBlbGVtZW50Lm9wZW4gPSBmYWxzZTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcbiAgICB9XG59XG4vKipcbiAqIEBwYXJhbSB7RG9jdW1lbnR9IGRvY3VtZW50IHVzZWQgdG8gYXBwZW5kXG4gKiBAcGFyYW0ge09wZW5hYmxlSHRtbEVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdG8gYWRkIHRvIHRoZSBkb20gYW5kIG9wZW5cbiAqL1xuLyoqXG4gKlxuICogQHBhcmFtIGRvY3VtZW50XG4gKiBAcGFyYW0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBhZGRPcGVuYWJsZURvbUVsZW1lbnQoZG9jdW1lbnQsIGVsZW1lbnQpIHtcbiAgICBpZiAoZG9jdW1lbnQuYm9keS5jb250YWlucyhlbGVtZW50KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICAgICAgZWxlbWVudC5vcGVuID0gdHJ1ZTtcbiAgICB9XG59XG4vKipcbiAqIGNyZWF0ZXMgIGhlbHAgcG9wb3ZlciBjb21wb25lbnQuXG4gKiBAcGFyYW0gQ3JlYXRlSGVscFBvcG92ZXJQYXJhbXNcbiAqIEBwYXJhbSB7Q3JlYXRlSGVscFBvcG92ZXJQYXJhbXN9IHBhcmFtcyAgcGFyYW1ldGVycyBmb3IgY3JlYXRpbmcgaGVscCBwb3BvdmVyXG4gKiBAcmV0dXJucyBIVE1MUmZ4SGVscFBvcG92ZXJFbGVtZW50XG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUhlbHBQb3BvdmVyKHBhcmFtcykge1xuICAgIGNvbnN0IHsgaGVscFVybCwgaGVscElkLCBoZWFkaW5nLCByZWZlcmVuY2VFbGVtZW50LCBwb3J0YWwsIGhlbHBTcmNkb2MsIGxlYXJuTW9yZVVybCwgcGxhY2VtZW50LCBvZmZzZXREaXN0YW5jZSwgb2Zmc2V0U2tpZGRpbmcgfSA9IHBhcmFtcztcbiAgICBjb25zdCBwb3BvdmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInJmeC1oZWxwLXBvcG92ZXJcIik7XG4gICAgcG9wb3Zlci5oZWxwVXJsID0gaGVscFVybDtcbiAgICBwb3BvdmVyLmhlbHBJZCA9IGhlbHBJZDtcbiAgICBwb3BvdmVyLmhlYWRpbmcgPSBoZWFkaW5nO1xuICAgIHBvcG92ZXIucmVmZXJlbmNlRWxlbWVudCA9IHJlZmVyZW5jZUVsZW1lbnQ7XG4gICAgcG9wb3Zlci5wbGFjZW1lbnQgPSBwbGFjZW1lbnQgPz8gXCJsZWFkaW5nLXN0YXJ0XCI7XG4gICAgcG9wb3Zlci5wb3J0YWwgPSBwb3J0YWw7XG4gICAgcG9wb3Zlci5oZWxwU3JjZG9jID0gaGVscFNyY2RvYztcbiAgICBwb3BvdmVyLmxlYXJuTW9yZVVybCA9IGxlYXJuTW9yZVVybDtcbiAgICBpZiAob2Zmc2V0RGlzdGFuY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBwb3BvdmVyLm9mZnNldERpc3RhbmNlID0gb2Zmc2V0RGlzdGFuY2U7XG4gICAgfVxuICAgIGlmIChvZmZzZXRTa2lkZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHBvcG92ZXIub2Zmc2V0U2tpZGRpbmcgPSBvZmZzZXRTa2lkZGluZztcbiAgICB9XG4gICAgcmV0dXJuIHBvcG92ZXI7XG59XG4vKipcbiAqICBzaG93IGhlbHAgcG9wb3ZlciBmb3IgaGVscElkXG4gKiAgQHBhcmFtIHtIVE1MUmZ4SGVscFBvcG92ZXJFbGVtZW50fSB0b29sSGVscFBvcG92ZXJcbiAqICBAcGFyYW0ge0NyZWF0ZUhlbHBQb3BvdmVyUGFyYW1zfSBwYXJhbXMgbmVlZGVkIHBhcmFtZXRlcnMgZm9yIGhlbHBcbiAqICBAcmV0dXJucyB7SFRNTFJmeEhlbHBQb3BvdmVyRWxlbWVudH0gIGhlbHBQb3BvdmVyIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIHNob3dIZWxwKHRvb2xIZWxwUG9wb3ZlciwgcGFyYW1zKSB7XG4gICAgY29uc3QgeyBoZWxwVXJsLCBoZWxwSWQsIGhlYWRpbmcsIHJlZmVyZW5jZUVsZW1lbnQsIHBvcnRhbCwgaGVscFNyY2RvYywgaGVscEZpbGVOYW1lLCBsZWFybk1vcmVVcmwsIG9mZnNldERpc3RhbmNlLCBvZmZzZXRTa2lkZGluZyB9ID0gcGFyYW1zO1xuICAgIGlmICh0b29sSGVscFBvcG92ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQodG9vbEhlbHBQb3BvdmVyKTtcbiAgICAgICAgdG9vbEhlbHBQb3BvdmVyID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0b29sSGVscFBvcG92ZXIgPSBjcmVhdGVIZWxwUG9wb3Zlcih7XG4gICAgICAgIGhlbHBVcmwsXG4gICAgICAgIGhlbHBJZCxcbiAgICAgICAgaGVhZGluZyxcbiAgICAgICAgcmVmZXJlbmNlRWxlbWVudCxcbiAgICAgICAgcG9ydGFsLFxuICAgICAgICBoZWxwU3JjZG9jLFxuICAgICAgICBoZWxwRmlsZU5hbWUsXG4gICAgICAgIGxlYXJuTW9yZVVybCxcbiAgICAgICAgb2Zmc2V0RGlzdGFuY2UsXG4gICAgICAgIG9mZnNldFNraWRkaW5nXG4gICAgfSk7XG4gICAgYWRkT3BlbmFibGVEb21FbGVtZW50KGRvY3VtZW50LCB0b29sSGVscFBvcG92ZXIpO1xuICAgIHJldHVybiB0b29sSGVscFBvcG92ZXI7XG59XG4vKipcbiAqIGNyZWF0ZXMgIE5vZGUgSW50ZXJhY3Rpb24gcG9wb3ZlciBjb21wb25lbnQuXG4gKiBAcGFyYW0gQ3JlYXRlTm9kZUludGVyYWN0aW9uUG9wb3ZlclBhcmFtc1xuICogQHBhcmFtIHtDcmVhdGVOb2RlSW50ZXJhY3Rpb25Qb3BvdmVyUGFyYW1zfSBwYXJhbXMgIHBhcmFtZXRlcnMgZm9yIGNyZWF0aW5nIG5vZGUgSW50ZXJhY3Rpb24gcG9wb3ZlclxuICogQHJldHVybnMgSFRNTENhbGNpdGVQb3BvdmVyRWxlbWVudFxuICovXG5mdW5jdGlvbiBjcmVhdGVOb2RlSW50ZXJhY3Rpb25Qb3BvdmVyKHBvcG92ZXIsIHBhcmFtcykge1xuICAgIGNvbnN0IHsgcmVmZXJlbmNlRWxlbWVudCwgbGFiZWwsIGRpcmVjdGlvbiwgb2Zmc2V0RGlzdGFuY2UsIG9mZnNldFNraWRkaW5nLCBzaG93UHJvcGVydGllc0FjdGlvbiwgaGFuZGxlTm9kZUR1cGxpY2F0ZSwgaGFuZGxlTm9kZVJlbmFtZSwgaGFuZGxlTm9kZURlbGV0ZSwgaGFuZGxlTm9kZUVkaXRQcm9wZXJ0aWVzIH0gPSBwYXJhbXM7XG4gICAgaWYgKHBvcG92ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQocG9wb3Zlcik7XG4gICAgICAgIHBvcG92ZXIgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHBvcG92ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FsY2l0ZS1wb3BvdmVyXCIpO1xuICAgIGNvbnN0IHBvcG92ZXJQcm9wcyA9IHtcbiAgICAgICAgb3ZlcmxheVBvc2l0aW9uaW5nOiBcImFic29sdXRlXCIsXG4gICAgICAgIGF1dG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgZGlyOiBkaXJlY3Rpb24sXG4gICAgICAgIGZvY3VzVHJhcERpc2FibGVkOiB0cnVlLFxuICAgICAgICB0cmlnZ2VyRGlzYWJsZWQ6IHRydWUsXG4gICAgICAgIHBvaW50ZXJEaXNhYmxlZDogdHJ1ZSxcbiAgICAgICAgcGxhY2VtZW50OiBcInRvcFwiLFxuICAgICAgICBjbG9zYWJsZTogZmFsc2UsXG4gICAgICAgIG9wZW46IHRydWUsXG4gICAgICAgIHJlZmVyZW5jZUVsZW1lbnQ6IHJlZmVyZW5jZUVsZW1lbnQsXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgb2Zmc2V0RGlzdGFuY2U6IG9mZnNldERpc3RhbmNlLFxuICAgICAgICBvZmZzZXRTa2lkZGluZzogb2Zmc2V0U2tpZGRpbmdcbiAgICB9O1xuICAgIE9iamVjdC5hc3NpZ24ocG9wb3ZlciwgcG9wb3ZlclByb3BzKTtcbiAgICBjb25zdCBub2RlSW50ZXJhY3Rpb25Ub29sYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInJmeC1ub2RlLWludGVyYWN0aW9uLXRvb2xiYXJcIik7XG4gICAgY29uc3Qgbm9kZUludGVyYWN0aW9uVG9vbGJhclByb3BzID0ge1xuICAgICAgICBzaG93UHJvcGVydGllc0FjdGlvbixcbiAgICAgICAgaGFuZGxlTm9kZUR1cGxpY2F0ZSxcbiAgICAgICAgaGFuZGxlTm9kZVJlbmFtZSxcbiAgICAgICAgaGFuZGxlTm9kZURlbGV0ZSxcbiAgICAgICAgaGFuZGxlTm9kZUVkaXRQcm9wZXJ0aWVzXG4gICAgfTtcbiAgICBPYmplY3QuYXNzaWduKG5vZGVJbnRlcmFjdGlvblRvb2xiYXIsIG5vZGVJbnRlcmFjdGlvblRvb2xiYXJQcm9wcyk7XG4gICAgcG9wb3Zlci5hcHBlbmQobm9kZUludGVyYWN0aW9uVG9vbGJhcik7XG4gICAgYWRkT3BlbmFibGVEb21FbGVtZW50KGRvY3VtZW50LCBwb3BvdmVyKTtcbiAgICByZXR1cm4gcG9wb3Zlcjtcbn1cblxuZXhwb3J0IHsgY3JlYXRlTm9kZUludGVyYWN0aW9uUG9wb3ZlciBhcyBjLCByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQgYXMgciwgc2hvd0hlbHAgYXMgcyB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wb3BvdmVyLXV0aWxzLTcyNTQ5M2Q3LmpzLm1hcCIsImltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgaCB9IGZyb20gJy4vaW5kZXgtZGExYjcxMzguanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvY29yZS9sYW5nLmpzJztcbmltcG9ydCB7IEMgYXMgQ2FsY2l0ZVNjYWxlLCBVIGFzIFVJRGVmYXVsdHMgfSBmcm9tICcuL3VpLXV0aWxzLTkyOGE0MDk2LmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2lkZW50aXR5L0lkZW50aXR5TWFuYWdlci5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9jb3JlL3VybFV0aWxzLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL2xheWVycy9MYXllci5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9sYXllcnMvSW1hZ2VyeUxheWVyLmpzJztcbmltcG9ydCAnQGFyY2dpcy9jb3JlL3NtYXJ0TWFwcGluZy9yYXN0ZXIvcmVuZGVyZXJzL3N0cmV0Y2guanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVxdWVzdC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9yZXN0L3N1cHBvcnQvQWxnb3JpdGhtaWNDb2xvclJhbXAuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVzdC9zdXBwb3J0L011bHRpcGFydENvbG9yUmFtcC5qcyc7XG5pbXBvcnQgJ0BhcmNnaXMvY29yZS9Db2xvci5qcyc7XG5pbXBvcnQgJy4vY29sb3JSYW1wVXRpbHMtOGJkZDQ2YzUuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcmVzdC9nZW9wcm9jZXNzb3IuanMnO1xuaW1wb3J0ICdAYXJjZ2lzL2NvcmUvcG9ydGFsL1BvcnRhbEl0ZW0uanMnO1xuaW1wb3J0IHsgciBhcyByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQsIHMgYXMgc2hvd0hlbHAgfSBmcm9tICcuL3BvcG92ZXItdXRpbHMtNzI1NDkzZDcuanMnO1xuXG5jb25zdCBSRnhDb250YWluZXIgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlcyB0aGUgY2hhbmdlIGV2ZW50IG9mIEFuYWx5c2lzIEhlbHAgUG9wb3ZlciBjbG9zZVxuICAgICAgICAgKiBAY2F0ZWdvcnkgUHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVBbmFseXNpc0hlbHBQb3BvdmVyQ2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICByZW1vdmVPcGVuYWJsZURvbUVsZW1lbnQodGhpcy50b29sSGVscFBvcG92ZXIpO1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlcyB0aGUgY2hhbmdlIGV2ZW50IG9mIEFuYWx5c2lzIFJGeCBIZWxwIFBvcG92ZXJcbiAgICAgICAgICogQHBhcmFtIHtDdXN0b21FdmVudH0gZXZ0IC0gVGhlIGN1c3RvbSBldmVudCBvYmplY3QgY29udGFpbmluZyByZWZlcmVuY2UgZWxlbWVudCwgaGVscCBzb3VyY2UgZG9jdW1lbnQsIGFuZCBoZWFkaW5nLlxuICAgICAgICAgKiBAY2F0ZWdvcnkgUHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVSRnhIZWxwUG9wb3ZlckNoYW5nZSA9IChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHsgcmVmZXJlbmNlRWxlbWVudCwgaGVscFNyY2RvYywgaGVhZGluZyB9ID0gZXZ0LmRldGFpbDtcbiAgICAgICAgICAgIHRoaXMudG9vbEhlbHBQb3BvdmVyID0gc2hvd0hlbHAodGhpcy50b29sSGVscFBvcG92ZXIsIHtcbiAgICAgICAgICAgICAgICBoZWxwSWQ6IFwicGFyYW0ubmFtZVwiLFxuICAgICAgICAgICAgICAgIGhlbHBTcmNkb2MsXG4gICAgICAgICAgICAgICAgaGVhZGluZyxcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VFbGVtZW50LFxuICAgICAgICAgICAgICAgIG9mZnNldERpc3RhbmNlOiAzMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnRvb2xIZWxwUG9wb3Zlci5hZGRFdmVudExpc3RlbmVyKFwicmZ4SGVscFBvcG92ZXJDbG9zZVwiLCB0aGlzLmhhbmRsZUFuYWx5c2lzSGVscFBvcG92ZXJDbG9zZSk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjYWxsZWQgd2hlbiB0aGUgY2xvc2UgYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGFuZGxlQ2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBhbmVsTW9kZSA9IDA7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjYWxsZWQgd2hlbiB0aGUgZG9uZSBidXR0b24gaXMgY2xpY2tlZFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faGFuZGxlRG9uZSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGFuZWxNb2RlID0gMDtcbiAgICAgICAgICAgIGNvbnN0IHJmdEpTT04gPSBhd2FpdCB0aGlzLmVkaXRvckNvbXBvbmVudC5nZXRVcGRhdGVkUkZUV2l0aFZhbHVlcygpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGVkIEpTT04uLlwiLCByZnRKU09OKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wYW5lbE1vZGUgPSAwO1xuICAgICAgICB0aGlzLm1hcExheWVycyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jdXN0b21SRlQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgY2FsbGVkICB0byBzaG93IHRoZSBmdW5jdGlvbiBVSVxuICAgICAqIEBjYXRlZ29yeSBQcml2YXRlXG4gICAgICovXG4gICAgX3JlbmRlckZ1bmN0aW9uVUkoKSB7XG4gICAgICAgIHJldHVybiAoaChcImRpdlwiLCBudWxsLCBoKFwicmZ4LWFuYWx5c2lzLXdyYXBwZXJcIiwgeyByZWY6IChlbCkgPT4gKHRoaXMuZWRpdG9yQ29tcG9uZW50ID0gZWwpLCBmdW5jdGlvbk5hbWU6IHRoaXMuZnVuY3Rpb25OYW1lLCBtYXBMYXllcnM6IHRoaXMubWFwTGF5ZXJzLCB1c2VQYW5lbDogdHJ1ZSwgb25BbmFseXNpc1Rvb2xjbG9zZTogdGhpcy5oYW5kbGVDbG9zZSwgcmZ4VGVtcGxhdGU6IHRoaXMuY3VzdG9tUkZULCBvbkFuYWx5c2lzVW5zdXBwb3J0ZWRGdW5jdGlvbjogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaGFzIHVuc3VwcG9ydGVkIGZ1bmN0aW9uIGluIHRoaXMgUkZULCBzZXQgc2hvd1Vuc3VwcG9ydGVkRnVuY3Rpb24gYXMgdHJ1ZSBpbiBhbmFseXNpcy13cmFwcGVyIHRvIHNlZSB0aGUgZnVuY3Rpb24gY2hhaW5cIik7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDbG9zZSgpO1xuICAgICAgICAgICAgfSwgb25BbmFseXNpc1JGeEhlbHBQb3BvdmVyQ2hhbmdlOiB0aGlzLmhhbmRsZVJGeEhlbHBQb3BvdmVyQ2hhbmdlIH0pLCB0aGlzLl9yZW5kZXJEb25lQnV0dG9uKCkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogY2FsbGVkIHRvIHJlbmRlciB0aGUgZG9uZSBidXR0b25cbiAgICAgKiBAY2F0ZWdvcnkgcHJpdmF0ZVxuICAgICAqL1xuICAgIF9yZW5kZXJEb25lQnV0dG9uKCkge1xuICAgICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWJ1dHRvblwiLCB7IGFsaWdubWVudDogXCJzdGFydFwiLCBhcHBlYXJhbmNlOiBcInNvbGlkXCIsIGtpbmQ6IFwiYnJhbmRcIiwgc2NhbGU6IFVJRGVmYXVsdHMuU2NhbGUsIGhyZWY6IFwiXCIsIG9uQ2xpY2s6IHRoaXMuX2hhbmRsZURvbmUgfSwgXCJkb25lXCIpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGNhdGVnb3J5IExpZmVjeWNsZVxuICAgICAqIFJlbmRlciBsaWZlY3ljbGUgbWV0aG9kXG4gICAgICovXG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLWZsb3ctaXRlbVwiLCB7IGlkOiBcInJmeC1jb250YWluZXJcIiwga2V5OiBcInJmeC1jb250YWluZXJcIiwgaGVhZGluZzogXCJSYXN0ZXIgRnVuY3Rpb25zXCIgfSwgdGhpcy5wYW5lbE1vZGUgPT09IDAgJiYgKGgoXCJyZngtbGlzdC12aWV3XCIsIHsgc2NhbGU6IENhbGNpdGVTY2FsZS5tLCBvblRyaWdnZXJTZWxlY3RGdW5jdGlvbjogKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5mdW5jdGlvbk5hbWUgPSBldmVudC5kZXRhaWw7XG4gICAgICAgICAgICAgICAgdGhpcy5wYW5lbE1vZGUgPSAxO1xuICAgICAgICAgICAgfSB9KSksIHRoaXMucGFuZWxNb2RlID09PSAxICYmIHRoaXMuX3JlbmRlckZ1bmN0aW9uVUkoKSkpO1xuICAgIH1cbn07XG5cbmV4cG9ydCB7IFJGeENvbnRhaW5lciBhcyByZnhfY29udGFpbmVyIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJmeC1jb250YWluZXIuZW50cnkuanMubWFwIiwiY29uc3QgVUlEZWZhdWx0cyA9IHtcbiAgICBTY2FsZTogXCJzXCIsXG4gICAgUG9wb3ZlclRpbWVyOiA2MFxufTtcbmNvbnN0IENhbGNpdGVTY2FsZSA9IHtcbiAgICBzOiBcInNcIixcbiAgICBtOiBcIm1cIlxufTtcbmNvbnN0IENhbGNpdGVPdmVybGF5UG9zaXRpb25pbmcgPSB7XG4gICAgYWJzb2x1dGU6IFwiYWJzb2x1dGVcIixcbiAgICBmaXhlZDogXCJmaXhlZFwiXG59O1xuXG5leHBvcnQgeyBDYWxjaXRlU2NhbGUgYXMgQywgVUlEZWZhdWx0cyBhcyBVLCBDYWxjaXRlT3ZlcmxheVBvc2l0aW9uaW5nIGFzIGEgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dWktdXRpbHMtOTI4YTQwOTYuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9